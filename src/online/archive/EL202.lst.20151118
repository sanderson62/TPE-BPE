* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page   1
* EL202.cbl
* Options: int("EL202.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL202.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL202.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL202.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2*****************************************************************
     3*                                                               *
     4* Copyright (c) 2014 by Central States Health and Life          *
     5* All rights reserved.                                          *
     6*                                                               *
     7*****************************************************************
     8 identification division.
     9 program-id. EL202.
    10*
    11*AUTHOR.    Cowtown.
    12*           Colleyville, TEXAS.
    13*REMARKS.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page   2
* EL202.cbl
    14***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
    15***                                                            ***
    16***  This program is waken up by a webservice request/http     ***
    17***  request and is passed a remit id. The program will next   ***
    18***  read tables CUC_Logic_Remittance and CUC_Logic_Remittance_***
    19***  cert using the remit id passed and will in turn generate  ***
    20***  a ERPYAJ record, ERPNDB and ERPNDM records.               ***
    21***                                                            ***
    22***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    23******************************************************************
    24*                   C H A N G E   L O G
    25*
    26* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    27*-----------------------------------------------------------------
    28*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    29* EFFECTIVE    NUMBER
    30*-----------------------------------------------------------------
    31* 091114  CR2013121800001  PEMA  NEW PROGRAM
    32*-----------------------------------------------------------------
    33 environment division.
    34 data division.
    35 working-storage section.
    36 01  DFH-START PIC X(04).
    37 77  s1                          pic s999 comp-3 value +0.
    38 77  s2                          pic s999 comp-3 value +0.
    39 77  i1                          pic s999 comp-3 value +0.
    40 77  o1                          pic s999 comp-3 value +0.
    41 77  ws-bin-current-dt           pic xx value low-values.
    42 77  ws-bin-eom-dt               pic xx value low-values.
    43 77  ws-table-sw                 pic x    value spaces.
    44     88  table-found               value 'Y'.
    45 77  ws-sql-code                 pic s9(7) value zeros.
    46 77  ws-dis-sql-code             pic -9999999 value zeros.
    47 77  ws-remit-sw                 pic x value ' '.
    48     88  ws-remit-not-found        value 'N'.
    49 77  work-seq-no                 pic s9(8) comp-3 value +0.
    50 77  ws-rollback-sw              pic x  value spaces.
    51     88  rollback-needed            value 'Y'.
    52 77  ws-commit-sw                pic x  value spaces.
    53     88  commit-needed              value 'Y'.
    54 77  ROLL-BACK                   PIC X(08) VALUE 'ROLLBACK'.
    55 01  P pointer.
    56 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    57 01  var-ptr pointer.
    58 01  env-var-len                 pic 9(4)  binary.
    59 01  rc                          pic 9(9)  binary.
    60 01  WS-KIXSYS.
    61     05  WS-KIX-FIL1             PIC X(10).
    62     05  WS-KIX-APPS             PIC X(10).
    63     05  WS-KIX-ENV              PIC X(10).
    64     05  WS-KIX-MYENV            PIC X(10).
    65     05  WS-KIX-SYS              PIC X(10).
*   66 EXEC SQL
*   67    INCLUDE SQLDA
*   68 END-EXEC
    69 01 SQLDA sync.
    70    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    71    05 SQLDABC               PIC S9(9) COMP-5 value 0.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page   3
* EL202.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
    72    05 SQLN                  PIC S9(4) COMP-5 value 0.
    73    05 SQLD                  PIC S9(4) COMP-5 value 0.
    74    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    75       10 SQLTYPE            PIC S9(4) COMP-5.
    76       10 SQLLEN             PIC S9(4) COMP-5.
    77$IF P64 SET
    78X      *> For 64-bit environments, ensure that SQLDATA is
    79X      *> aligned on an 8-byte boundary.
    80X      10 FILLER             PIC S9(9) COMP-5.
    81$END
    82       10 SQLDATA            USAGE POINTER.
    83       10 SQLIND             USAGE POINTER.
    84       10 SQLNAME.
    85          15 SQLNAMEL        PIC S9(4) COMP-5.
    86          15 SQLNAMEC        PIC X(30).
    87
    88* Values for SQLTYPE
    89
    90 78  ESQL-DATE-CHAR              VALUE 384.
    91 78  ESQL-DATE-CHAR-NULL         VALUE 385.
    92 78  ESQL-DATE-REC               VALUE 386.
    93 78  ESQL-DATE-REC-NULL          VALUE 387.
    94 78  ESQL-TIME-CHAR              VALUE 388.
    95 78  ESQL-TIME-CHAR-NULL         VALUE 389.
    96 78  ESQL-TIME-REC               VALUE 390.
    97 78  ESQL-TIME-REC-NULL          VALUE 391.
    98 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
    99 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   100 78  ESQL-TIMESTAMP-REC          VALUE 394.
   101 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   102 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   103 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   104 78  ESQL-TS-OFFSET-REC          VALUE 398.
   105 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   106 78  ESQL-LONGVARBINARY          VALUE 404.
   107 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   108 78  ESQL-LONGVARCHAR            VALUE 408.
   109 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   110 78  ESQL-BINARY                 VALUE 444.
   111 78  ESQL-BINARY-NULL            VALUE 445.
   112 78  ESQL-VARBINARY              VALUE 446.
   113 78  ESQL-VARBINARY-NULL         VALUE 447.
   114 78  ESQL-VARCHAR                VALUE 448.
   115 78  ESQL-VARCHAR-NULL           VALUE 449.
   116
   117 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   118 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   119
   120 78  ESQL-CHAR                   VALUE 452.
   121 78  ESQL-CHAR-NULL              VALUE 453.
   122
   123 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   124 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   125
   126 78  ESQL-DOUBLE                 VALUE 480.
   127 78  ESQL-DOUBLE-NULL            VALUE 481.
   128 78  ESQL-REAL                   VALUE 482.
   129 78  ESQL-REAL-NULL              VALUE 483.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page   4
* EL202.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-DECIMAL                VALUE 484.
   131 78  ESQL-DECIMAL-NULL           VALUE 485.
   132 78  ESQL-INTEGER                VALUE 496.
   133 78  ESQL-INTEGER-NULL           VALUE 497.
   134 78  ESQL-SMALLINT               VALUE 500.
   135 78  ESQL-SMALLINT-NULL          VALUE 501.
   136 78  ESQL-TINYINT                VALUE 502.
   137 78  ESQL-TINYINT-NULL           VALUE 503.
*  138 EXEC SQL
*  139    INCLUDE SQLCA
*  140 END-EXEC
   141 01 SQLCA.
   142     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   143     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   144     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   145     05  SQLERRM.
   146         49  SQLERRML    PIC S9(4) COMP-5.
   147         49  SQLERRMC    PIC X(70).
   148     05  SQLERRP         PIC X(8).
   149     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   150     05  SQLWARN.
   151         10  SQLWARN0    PIC X.
   152         10  SQLWARN1    PIC X.
   153         10  SQLWARN2    PIC X.
   154         10  SQLWARN3    PIC X.
   155         10  SQLWARN4    PIC X.
   156         10  SQLWARN5    PIC X.
   157         10  SQLWARN6    PIC X.
   158         10  SQLWARN7    PIC X.
   159     05  SQLEXT.
   160         10  SQLWARN8    PIC X.
   161         10  SQLWARN9    PIC X.
   162         10  SQLWARN10   PIC X.
   163         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   164     05  SQLSTATE    PIC X(5).
   165 EXEC SQL
   166    BEGIN DECLARE SECTION
   167 END-EXEC
   168 01  ws-remit-id-a               pic x(10).
   169 01  ws-remit-id redefines
   170     ws-remit-id-a               pic 9(10).
   171 01  ws-key-stuff.
   172     05  ws-batch-no             pic x(6) value zeros.
   173     05  ws-batch-no-n redefines
   174         ws-batch-no             pic 9(6).
   175     05  ws-check-key            pic 9(7).
   176     05  ws-check-no             pic x(7).
   177     05  ws-compid               pic xxx.
   178     05  ws-carrier              pic x.
   179     05  ws-grouping             pic x(6).
   180     05  ws-state                pic xx.
   181     05  ws-account              pic x(10).
   182     05  ws-eff-date             pic x(10).
   183     05  ws-certificate          pic x(10).
   184     05  ws-cert-sfx             pic x.
   185     05  ws-seq-no               pic 999.
   186     05  ws-type                 pic 999.
   187 01  ws-status-code-a            pic x(7) value zeros.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page   5
* EL202.cbl
   188 01  ws-status-code redefines
   189     ws-status-code-a            pic 9(7).
   190 01  ws-error-message            pic x(50) value spaces.
   191 01  ws-status-date              pic x(10).
   192 01  sqlcmd                      pic x(1024).
   193 01  svr                         pic x(32).
   194 01  usr                         pic x(32).
   195 01  pass                        pic x(32).
   196 01  usr-pass                    pic x(64).
   197 01  ws-disp-code                pic s9(11).
   198***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   199***                                                            ***
   200***  These indicators are used to determine if a variable      ***
   201***  is        null.           The indicator will be -1        ***
   202***  if the value        is null  and +0 if the value is       ***
   203***  something other than null.  Here is an example on how     ***
   204***  to use the indicator variables.                           ***
   205***                                                            ***
   206***     EXEC SQL                                               ***
   207***        fetch checkapp into                                 ***
   208***           :db-app-status :nu-app-status,                   ***
   209***           :db-app-by     :nu-app-by,                       ***
   210***           :db-app-date   :nu-app-date,                     ***
   211***           :db-app-batch  :nu-app-batch                     ***
   212***     END-EXEC                                               ***
   213***                                                            ***
   214***           OR This way on an update                         ***
   215***                                                            ***
   216***     EXEC SQL                                               ***
   217***        UPDATE                                              ***
   218***           CUC_Logic_Remittance                             ***
   219***        SET                                                 ***
   220***           LogicStatus     = :ws-status-code,               ***
   221***           LogicStatusDate = :ws-status-date,               ***
   222***           BatchNumber     = :ws-batch-no :nu-batchno       ***
   223***        WHERE                                               ***
   224***           RemitId = :ws-remit-id                           ***
   225***     END-EXEC                                               ***
   226***                                                            ***
   227***    Also, when the table has a column with a data type of   ***
   228***  "BIT" and used as true/false move the 1 byte receiving    ***
   229***  field to ws-bit and check out ws-bit-comp. if = zeros,    ***
   230***  then its false. I think true would be 256.                ***
   231***                                                            ***
   232***                                                            ***
   233***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   234 01  ws-bit                      pic x.
   235 01  ws-bit-comp redefines ws-bit pic s9(4) comp.
   236 01  indicator-vaiables-for-nulls.
   237     05  nu-app-status           pic s9(4) comp value +0.
   238     05  nu-app-by               pic s9(4) comp value +0.
   239     05  nu-app-date             pic s9(4) comp value +0.
   240     05  nu-app-batch            pic s9(4) comp value +0.
   241     05  nu-fincar               pic s9(4) comp value +0.
   242     05  nu-batchno              pic s9(4) comp value +0.
   243     05  nu-error-message        pic s9(4) comp value +0.
   244 01  sql-remit-record.
   245     05  sql-py-RemitId          pic 9(9).
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page   6
* EL202.cbl
   246     05  sql-py-Carrier          pic x.
   247     05  sql-py-Group            pic x(6).
   248     05  sql-py-State            pic xx.
   249     05  sql-py-AccountNumber    pic x(10).
   250     05  sql-py-Name             pic x(50).
   251     05  sql-py-Addr1            pic x(50).
   252     05  sql-py-Addr2            pic x(50).
   253     05  sql-py-AddrCity         pic x(50).
   254     05  sql-py-AddrState        pic xx.
   255     05  sql-py-AddrZIP          pic x(9).
   256     05  sql-py-ResponsibleCarrier
   257                                 pic x.
   258     05  sql-py-ResponsibleNumber
   259                                 pic x(10).
   260     05  sql-py-LogicStatus      pic 9(7).
   261     05  sql-py-LogicStatusDate  pic x(30).
   262     05  sql-py-company          pic xxx.
   263     05  sql-py-tot-prem         pic x(12).
   264     05  sql-py-tot-prem-n redefines
   265         sql-py-tot-prem         pic 9(9).99.
   266     05  sql-is-ach              pic x.
   267 01  sql-cert-records.
   268     05  sql-pb-CertId           pic 9(9).
   269     05  sql-pb-RemitId          pic 9(9).
   270     05  sql-pb-CertNumber       pic x(11).
   271     05  sql-pb-EffectiveDate    pic x(30).
   272     05  sql-pb-FirstPaymentDate pic x(30).
   273     05  sql-pb-FirstName        pic x(30).
   274     05  sql-pb-LastName         pic x(30).
   275     05  sql-pb-CashIndicator    pic x.
   276     05  sql-pb-LivesCovered     pic 9(7).
   277     05  sql-pb-LfBenCode        pic xx.
   278     05  sql-pb-LfTerm           pic 999.
   279     05  sql-pb-LfBenefit        pic x(12).
   280     05  sql-pb-lfbenefit-n redefines
   281         sql-pb-lfbenefit        pic 9(9).99.
   282     05  sql-pb-LfPremium        pic x(10).
   283     05  sql-pb-lfpremium-n redefines
   284         sql-pb-lfpremium        pic 9(7).99.
   285     05  sql-pb-AhBenCode        pic xx.
   286     05  sql-pb-AhTerm           pic 999.
   287     05  sql-pb-AhBenefit        pic x(10).
   288     05  sql-pb-ahbenefit-n redefines
   289         sql-pb-ahbenefit        pic 9(7).99.
   290     05  sql-pb-AhPremium        pic x(10).
   291     05  sql-pb-ahpremium-n redefines
   292         sql-pb-ahpremium        pic 9(7).99.
   293     05  sql-pb-ErrorMessage     pic x(50).
   294 EXEC SQL
   295    END DECLARE SECTION
   296 END-EXEC
   297 01  ws-roll-back-keys.
   298     05  ws-rb-erpyaj-key        pic x(33) value spaces.
   299 01  ws-batch-header-work-area.
   300     05  ws-lf-iss-premium          pic s9(9)v99 comp-3 value +0.
   301     05  ws-ah-iss-premium          pic s9(9)v99 comp-3 value +0.
   302     05  ws-iss-cnt                 pic s9(3) comp-3 value +0.
   303     05  ws-cnc-cnt                 pic s9(3) comp-3 value +0.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page   7
* EL202.cbl
   304     05  ws-highest-seq-no          pic s9(4) comp value +0.
   305 01  FILE-KEYS.
   306     12  ELCNTL-KEY.
   307         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   308         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   309         16 ELCNTL-ACCESS.
   310             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   311             20  FILLER              PIC X       VALUE SPACES.
   312             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   313         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   314 01  ws-init-erpndb-rec          pic x(585) value spaces.
   315 01  ws-init-erpndm              pic x(374) value spaces.
   316 01  f.
   317     05  ws-batch-seq-no         pic s9(4) comp value +0.
   318     05  ws-connect-sw               pic x  value ' '.
   319         88  connected-to-db             value 'Y'.
   320     05  ws-comp-id              pic xxx.
   321     05  ws-comp-cd              pic x.
   322 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   323     88  RESP-NORMAL                    VALUE +0.
   324     88  resp-file-notfnd               value +12.
   325     88  RESP-NOTFND                    VALUE +13.
   326     88  resp-duprec                    value +14.
   327     88  resp-dupkey                    value +15.
   328     88  resp-invreq                    value +16.
   329     88  RESP-NOTOPEN                   VALUE +19.
   330     88  RESP-ENDFILE                   VALUE +20.
   331     88  resp-lengtherr                 value +22.
   332 01  ws-display-response         pic s9(5) value zeros.
   333 01  ws-work-time-a              pic x(6).
   334 01  ws-work-time redefines ws-work-time-a
   335                                 pic 9(6).
   336 01  ws-work-amt-alpha           pic x(11).
   337 01  ws-work-amt-num redefines ws-work-amt-alpha
   338                                 pic 9(9)v99.
   339 01  ws-qry-string               pic x(80) value spaces.
   340 01  ws-qrystr-len               pic s9(8) comp value +60.
   341 01  ws-var-alpha                pic x(10).
   342 01  ws-seq-alpha                pic x(5).
   343 01  ws-seq-no-num redefines ws-seq-alpha
   344                                 pic 9(5).
   345*                                copy ELCFUNDT.
   346*****************************************************************
   347*                                                               *
   348*                            ELCFUNDT.                          *
   349*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   350*                            VMOD=2.001                         *
   351*                                                               *
   352*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   353*                                                               *
   354*****************************************************************
   355
   356
   357 01  FUNCTION-DATE.
   358     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   359     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   360         10  WS-FN-CCYR            PIC 9(4).
   361         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page   8
* EL202.cbl
   362             15  WS-FN-CC          PIC 99.
   363             15  WS-FN-YR          PIC 99.
   364         10  WS-FN-MO              PIC 99.
   365         10  WS-FN-DA              PIC 99.
   366     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   367     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   368     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   369     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   370     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   371         88  WS-BEHIND-GMT                     VALUE '-'.
   372         88  WS-AFTER-GMT                      VALUE '+'.
   373         88  WS-NO-GMT                         VALUE ZERO.
   374     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   375     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   376*                                COPY ELCDATE.
   377******************************************************************
   378*                                                                *
   379*                                                                *
   380*                            ELCDATE.                            *
   381*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   382*                            VMOD=2.003
   383*                                                                *
   384*                                                                *
   385*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   386*                 LENGTH = 200                                   *
   387******************************************************************
   388
   389 01  DATE-CONVERSION-DATA.
   390     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   391     12  DC-OPTION-CODE                PIC X.
   392         88  BIN-TO-GREG                VALUE ' '.
   393         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   394         88  EDIT-GREG-TO-BIN           VALUE '2'.
   395         88  YMD-GREG-TO-BIN            VALUE '3'.
   396         88  MDY-GREG-TO-BIN            VALUE '4'.
   397         88  JULIAN-TO-BIN              VALUE '5'.
   398         88  BIN-PLUS-ELAPSED           VALUE '6'.
   399         88  FIND-CENTURY               VALUE '7'.
   400         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   401         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   402         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   403         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   404         88  JULIAN-TO-BIN-3            VALUE 'C'.
   405         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   406         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   407         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   408         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   409         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   410         88  CHECK-LEAP-YEAR            VALUE 'H'.
   411         88  BIN-3-TO-GREG              VALUE 'I'.
   412         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   413         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   414         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   415         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   416         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   417         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   418         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   419         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page   9
* EL202.cbl
   420         88  THREE-CHARACTER-BIN
   421                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   422         88  GREGORIAN-TO-BIN
   423                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   424         88  BIN-TO-GREGORIAN
   425                  VALUES ' ' '1' 'I' '8' 'G'.
   426         88  JULIAN-TO-BINARY
   427                  VALUES '5' 'C' 'E' 'F'.
   428     12  DC-ERROR-CODE                 PIC X.
   429         88  NO-CONVERSION-ERROR        VALUE ' '.
   430         88  DATE-CONVERSION-ERROR
   431                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   432         88  DATE-IS-ZERO               VALUE '1'.
   433         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   434         88  DATE-IS-INVALID            VALUE '3'.
   435         88  DATE1-GREATER-DATE2        VALUE '4'.
   436         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   437         88  DATE-INVALID-OPTION        VALUE '9'.
   438         88  INVALID-CENTURY            VALUE 'A'.
   439         88  ONLY-CENTURY               VALUE 'B'.
   440         88  ONLY-LEAP-YEAR             VALUE 'C'.
   441         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   442     12  DC-END-OF-MONTH               PIC X.
   443         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   444     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   445         88  USE-NORMAL-PROCESS         VALUE ' '.
   446         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   447         88  ADJUST-UP-100-YRS          VALUE '2'.
   448     12  FILLER                        PIC X.
   449     12  DC-CONVERSION-DATES.
   450         16  DC-BIN-DATE-1             PIC XX.
   451         16  DC-BIN-DATE-2             PIC XX.
   452         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   453         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   454                       DC-GREG-DATE-1-EDIT.
   455             20  DC-EDIT1-MONTH        PIC 99.
   456             20  SLASH1-1              PIC X.
   457             20  DC-EDIT1-DAY          PIC 99.
   458             20  SLASH1-2              PIC X.
   459             20  DC-EDIT1-YEAR         PIC 99.
   460         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   461         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   462                     DC-GREG-DATE-2-EDIT.
   463             20  DC-EDIT2-MONTH        PIC 99.
   464             20  SLASH2-1              PIC X.
   465             20  DC-EDIT2-DAY          PIC 99.
   466             20  SLASH2-2              PIC X.
   467             20  DC-EDIT2-YEAR         PIC 99.
   468         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   469         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   470                     DC-GREG-DATE-1-YMD.
   471             20  DC-YMD-YEAR           PIC 99.
   472             20  DC-YMD-MONTH          PIC 99.
   473             20  DC-YMD-DAY            PIC 99.
   474         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   475         16  DC-GREG-DATE-1-MDY-R REDEFINES
   476                      DC-GREG-DATE-1-MDY.
   477             20  DC-MDY-MONTH          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  10
* EL202.cbl
   478             20  DC-MDY-DAY            PIC 99.
   479             20  DC-MDY-YEAR           PIC 99.
   480         16  DC-GREG-DATE-1-ALPHA.
   481             20  DC-ALPHA-MONTH        PIC X(10).
   482             20  DC-ALPHA-DAY          PIC 99.
   483             20  FILLER                PIC XX.
   484             20  DC-ALPHA-CENTURY.
   485                 24 DC-ALPHA-CEN-N     PIC 99.
   486             20  DC-ALPHA-YEAR         PIC 99.
   487         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   488         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   489         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   490         16  DC-JULIAN-DATE            PIC 9(05).
   491         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   492                                       PIC 9(05).
   493         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   494             20  DC-JULIAN-YEAR        PIC 99.
   495             20  DC-JULIAN-DAYS        PIC 999.
   496         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   497         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   498         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   499     12  DATE-CONVERSION-VARIBLES.
   500         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   501         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   502             20  FILLER                PIC 9(3).
   503             20  HOLD-CEN-1-CCYY.
   504                 24  HOLD-CEN-1-CC     PIC 99.
   505                 24  HOLD-CEN-1-YY     PIC 99.
   506             20  HOLD-CEN-1-MO         PIC 99.
   507             20  HOLD-CEN-1-DA         PIC 99.
   508         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   509             20  HOLD-CEN-1-R-MO       PIC 99.
   510             20  HOLD-CEN-1-R-DA       PIC 99.
   511             20  HOLD-CEN-1-R-CCYY.
   512                 24  HOLD-CEN-1-R-CC   PIC 99.
   513                 24  HOLD-CEN-1-R-YY   PIC 99.
   514             20  FILLER                PIC 9(3).
   515         16  HOLD-CENTURY-1-X.
   516             20  FILLER                PIC X(3)  VALUE SPACES.
   517             20  HOLD-CEN-1-X-CCYY.
   518                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   519                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   520             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   521             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   522         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   523             20  HOLD-CEN-1-R-X-MO     PIC XX.
   524             20  HOLD-CEN-1-R-X-DA     PIC XX.
   525             20  HOLD-CEN-1-R-X-CCYY.
   526                 24  HOLD-CEN-1-R-X-CC PIC XX.
   527                 24  HOLD-CEN-1-R-X-YY PIC XX.
   528             20  FILLER                PIC XXX.
   529         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   530         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   531         16  DC-JULIAN-DATE-1          PIC 9(07).
   532         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   533             20  DC-JULIAN-1-CCYY.
   534                 24  DC-JULIAN-1-CC    PIC 99.
   535                 24  DC-JULIAN-1-YR    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  11
* EL202.cbl
   536             20  DC-JULIAN-DA-1        PIC 999.
   537         16  DC-JULIAN-DATE-2          PIC 9(07).
   538         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   539             20  DC-JULIAN-2-CCYY.
   540                 24  DC-JULIAN-2-CC    PIC 99.
   541                 24  DC-JULIAN-2-YR    PIC 99.
   542             20  DC-JULIAN-DA-2        PIC 999.
   543         16  DC-GREG-DATE-A-EDIT.
   544             20  DC-EDITA-MONTH        PIC 99.
   545             20  SLASHA-1              PIC X VALUE '/'.
   546             20  DC-EDITA-DAY          PIC 99.
   547             20  SLASHA-2              PIC X VALUE '/'.
   548             20  DC-EDITA-CCYY.
   549                 24  DC-EDITA-CENT     PIC 99.
   550                 24  DC-EDITA-YEAR     PIC 99.
   551         16  DC-GREG-DATE-B-EDIT.
   552             20  DC-EDITB-MONTH        PIC 99.
   553             20  SLASHB-1              PIC X VALUE '/'.
   554             20  DC-EDITB-DAY          PIC 99.
   555             20  SLASHB-2              PIC X VALUE '/'.
   556             20  DC-EDITB-CCYY.
   557                 24  DC-EDITB-CENT     PIC 99.
   558                 24  DC-EDITB-YEAR     PIC 99.
   559         16  DC-GREG-DATE-CYMD         PIC 9(08).
   560         16  DC-GREG-DATE-CYMD-R REDEFINES
   561                              DC-GREG-DATE-CYMD.
   562             20  DC-CYMD-CEN           PIC 99.
   563             20  DC-CYMD-YEAR          PIC 99.
   564             20  DC-CYMD-MONTH         PIC 99.
   565             20  DC-CYMD-DAY           PIC 99.
   566         16  DC-GREG-DATE-MDCY         PIC 9(08).
   567         16  DC-GREG-DATE-MDCY-R REDEFINES
   568                              DC-GREG-DATE-MDCY.
   569             20  DC-MDCY-MONTH         PIC 99.
   570             20  DC-MDCY-DAY           PIC 99.
   571             20  DC-MDCY-CEN           PIC 99.
   572             20  DC-MDCY-YEAR          PIC 99.
   573    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   574        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   575    12  DC-EL310-DATE                  PIC X(21).
   576    12  FILLER                         PIC X(28).
   577*                                COPY ELCCNTL.
   578******************************************************************
   579*                                                                *
   580*                                                                *
   581*                            ELCCNTL.                            *
   582*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   583*                            VMOD=2.059                          *
   584*                                                                *
   585*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   586*                                                                *
   587*   FILE TYPE = VSAM,KSDS                                        *
   588*   RECORD SIZE = 750  RECFORM = FIXED                           *
   589*                                                                *
   590*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   591*       ALTERNATE INDEX = NONE                                   *
   592*                                                                *
   593*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  12
* EL202.cbl
   594*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   595******************************************************************
   596*                   C H A N G E   L O G
   597*
   598* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   599*-----------------------------------------------------------------
   600*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   601* EFFECTIVE    NUMBER
   602*-----------------------------------------------------------------
   603* 082503                   PEMA  ADD BENEFIT GROUP
   604* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   605* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   606* 092705    2005050300006  PEMA  ADD SPP LEASES
   607* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   608* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   609* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   610* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   611* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   612* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   613* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   614* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   615* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   616* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   617******************************************************************
   618*
   619 01  CONTROL-FILE.
   620     12  CF-RECORD-ID                       PIC XX.
   621         88  VALID-CF-ID                        VALUE 'CF'.
   622
   623     12  CF-CONTROL-PRIMARY.
   624         16  CF-COMPANY-ID                  PIC XXX.
   625         16  CF-RECORD-TYPE                 PIC X.
   626             88  CF-COMPANY-MASTER              VALUE '1'.
   627             88  CF-PROCESSOR-MASTER            VALUE '2'.
   628             88  CF-STATE-MASTER                VALUE '3'.
   629             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   630             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   631             88  CF-CARRIER-MASTER              VALUE '6'.
   632             88  CF-MORTALITY-MASTER            VALUE '7'.
   633             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   634             88  CF-TERMINAL-MASTER             VALUE '9'.
   635             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   636             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   637             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   638             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   639             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   640             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   641             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   642             88  CF-REMINDERS-MASTER            VALUE 'R'.
   643             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   644         16  CF-ACCESS-CD-GENL              PIC X(4).
   645         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   646             20  CF-PROCESSOR               PIC X(4).
   647         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   648             20  CF-STATE-CODE              PIC XX.
   649             20  FILLER                     PIC XX.
   650         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   651             20  FILLER                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  13
* EL202.cbl
   652             20  CF-HI-BEN-IN-REC           PIC XX.
   653         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   654             20  FILLER                     PIC XXX.
   655             20  CF-CARRIER-CNTL            PIC X.
   656         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   657             20  FILLER                     PIC XX.
   658             20  CF-HI-TYPE-IN-REC          PIC 99.
   659         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   660             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   661                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   662             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   663             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   664         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   665             20  FILLER                     PIC X.
   666             20  CF-CUSTOM-REPORT-NO        PIC 999.
   667         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   668             20  FILLER                     PIC XX.
   669             20  CF-MORTGAGE-PLAN           PIC XX.
   670         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   671
   672     12  CF-LAST-MAINT-DT                   PIC XX.
   673     12  CF-LAST-MAINT-BY                   PIC X(4).
   674     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   675
   676     12  CF-RECORD-BODY                     PIC X(728).
   677
   678
   679****************************************************************
   680*             COMPANY MASTER RECORD                            *
   681****************************************************************
   682
   683     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   684         16  CF-COMPANY-ADDRESS.
   685             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   686             20  CF-CL-IN-CARE-OF           PIC X(30).
   687             20  CF-CL-ADDR-LINE-1          PIC X(30).
   688             20  CF-CL-ADDR-LINE-2          PIC X(30).
   689             20  CF-CL-CITY-STATE           PIC X(30).
   690             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   691             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   692         16  CF-COMPANY-CD                  PIC X.
   693         16  CF-COMPANY-PASSWORD            PIC X(8).
   694         16  CF-SECURITY-OPTION             PIC X.
   695             88  ALL-SECURITY                   VALUE '1'.
   696             88  COMPANY-VERIFY                 VALUE '2'.
   697             88  PROCESSOR-VERIFY               VALUE '3'.
   698             88  NO-SECURITY                    VALUE '4'.
   699             88  ALL-BUT-TERM                   VALUE '5'.
   700         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   701             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   702         16  CF-LGX-INTERFACE-CNTL          PIC X.
   703             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   704         16  CF-INFORCE-LOCATION            PIC X.
   705             88  CERTS-ARE-ONLINE               VALUE '1'.
   706             88  CERTS-ARE-OFFLINE              VALUE '2'.
   707             88  NO-CERTS-AVAILABLE             VALUE '3'.
   708         16  CF-LOWER-CASE-LETTERS          PIC X.
   709         16  CF-CERT-ACCESS-CONTROL         PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  14
* EL202.cbl
   710             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   711             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   712             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   713             88  CF-ACCNT-CNTL                  VALUE '3'.
   714             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   715
   716         16  CF-FORMS-PRINTER-ID            PIC X(4).
   717         16  CF-CHECK-PRINTER-ID            PIC X(4).
   718
   719         16  CF-LGX-CREDIT-USER             PIC X.
   720             88  CO-IS-NOT-USER                 VALUE 'N'.
   721             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   722
   723         16 CF-CREDIT-CALC-CODES.
   724             20  CF-CR-REM-TERM-CALC PIC X.
   725               88  CR-EARN-AFTER-15TH           VALUE '1'.
   726               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   727               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   728               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   729               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   730               88  CR-EARN-AFTER-14TH           VALUE '6'.
   731               88  CR-EARN-AFTER-16TH           VALUE '7'.
   732             20  CF-CR-R78-METHOD           PIC X.
   733               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   734               88  DONT-USE-PLUS-ONE            VALUE '1'.
   735
   736         16  CF-CLAIM-CONTROL-COUNTS.
   737             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   738                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   739
   740             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   741                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   742
   743             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   744                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   745
   746             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   747                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   748
   749         16  CF-CURRENT-MONTH-END           PIC XX.
   750
   751         16  CF-CO-CALC-QUOTE-TOLERANCE.
   752             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   753             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   754             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   755             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   756                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   757                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   758             20  CF-CO-PREM-REJECT-SW       PIC X.
   759                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   760                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   761             20  CF-CO-REF-REJECT-SW        PIC X.
   762                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   763                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   764
   765         16  CF-CO-REPORTING-DT             PIC XX.
   766         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   767         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  15
* EL202.cbl
   768           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   769           88  CF-CO-MONTH-END                  VALUE '1'.
   770
   771         16  CF-LGX-CLAIM-USER              PIC X.
   772             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   773             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   774
   775         16  CF-CREDIT-EDIT-CONTROLS.
   776             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   777             20  CF-MIN-AGE                 PIC 99.
   778             20  CF-DEFAULT-AGE             PIC 99.
   779             20  CF-MIN-TERM                PIC S999      COMP-3.
   780             20  CF-MAX-TERM                PIC S999      COMP-3.
   781             20  CF-DEFAULT-SEX             PIC X.
   782             20  CF-JOINT-AGE-INPUT         PIC X.
   783                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   784             20  CF-BIRTH-DATE-INPUT        PIC X.
   785                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   786             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   787                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   788                 88  CF-ZERO-CARRIER            VALUE '1'.
   789                 88  CF-ZERO-GROUPING           VALUE '2'.
   790                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   791             20  CF-EDIT-SW                 PIC X.
   792                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   793             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   794             20  CF-CR-PR-METHOD            PIC X.
   795               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   796               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   797             20  FILLER                     PIC X.
   798
   799         16  CF-CREDIT-MISC-CONTROLS.
   800             20  CF-REIN-TABLE-SW           PIC X.
   801                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   802             20  CF-COMP-TABLE-SW           PIC X.
   803                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   804             20  CF-EXPERIENCE-RETENTION-AGE
   805                                            PIC S9        COMP-3.
   806             20  CF-CONVERSION-DT           PIC XX.
   807             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   808             20  CF-RUN-FREQUENCY-SW        PIC X.
   809                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   810                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   811
   812             20  CF-CR-CHECK-NO-CONTROL.
   813                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   814                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   815                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   816                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   817                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   818                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   819
   820                 24  CF-CR-CHECK-COUNT       REDEFINES
   821                     CF-CR-CHECK-COUNTER      PIC X(4).
   822
   823                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   824                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   825
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  16
* EL202.cbl
   826                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   827                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   828                 24  CF-MAIL-PROCESSING       PIC X.
   829                     88  MAIL-PROCESSING          VALUE 'Y'.
   830
   831         16  CF-MISC-SYSTEM-CONTROL.
   832             20  CF-SYSTEM-C                 PIC X.
   833                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   834             20  CF-SYSTEM-D                 PIC X.
   835                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   836             20  CF-SOC-SEC-NO-SW            PIC X.
   837                 88  SOC-SEC-NO-USED             VALUE '1'.
   838             20  CF-MEMBER-NO-SW             PIC X.
   839                 88  MEMBER-NO-USED              VALUE '1'.
   840             20  CF-TAX-ID-NUMBER            PIC X(11).
   841             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   842             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   843                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   844                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   845                 88  CF-ALL-APPROVED             VALUE 'Y'.
   846                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   847             20  CF-SYSTEM-E                 PIC X.
   848                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   849
   850         16  CF-LGX-LIFE-USER               PIC X.
   851             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   852             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   853
   854         16  CF-CR-MONTH-END-DT             PIC XX.
   855
   856         16  CF-FILE-MAINT-DATES.
   857             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   858                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   859             20  CF-LAST-BATCH       REDEFINES
   860                 CF-LAST-BATCH-NO               PIC X(4).
   861             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   862             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   863             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   864             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   865             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
   866             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
   867             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   868             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
   869             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   870             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   871
   872         16  CF-NEXT-COMPANY-ID             PIC XXX.
   873         16  FILLER                         PIC X.
   874
   875         16  CF-ALT-MORT-CODE               PIC X(4).
   876         16  CF-MEMBER-CAPTION              PIC X(10).
   877
   878         16  CF-LIFE-ACCESS-CONTROL         PIC X.
   879             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
   880             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
   881             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
   882             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
   883             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  17
* EL202.cbl
   884
   885         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
   886
   887         16  CF-LIFE-OVERRIDE-L1            PIC X.
   888         16  CF-LIFE-OVERRIDE-L2            PIC XX.
   889         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
   890         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
   891
   892         16  CF-AH-OVERRIDE-L1              PIC X.
   893         16  CF-AH-OVERRIDE-L2              PIC XX.
   894         16  CF-AH-OVERRIDE-L6              PIC X(6).
   895         16  CF-AH-OVERRIDE-L12             PIC X(12).
   896
   897         16  CF-REPORT-CD1-CAPTION          PIC X(10).
   898         16  CF-REPORT-CD2-CAPTION          PIC X(10).
   899
   900         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
   901         16  CF-AR-LAST-EL860-DT            PIC XX.
   902         16  CF-MP-MONTH-END-DT             PIC XX.
   903
   904         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
   905         16  CF-CLAIM-PAID-THRU-TO          PIC X.
   906             88  CF-CLAIM-PAID-TO               VALUE '1'.
   907
   908         16  CF-AR-MONTH-END-DT             PIC XX.
   909
   910         16  CF-CRDTCRD-USER                PIC X.
   911             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
   912             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
   913
   914         16  CF-CC-MONTH-END-DT             PIC XX.
   915
   916         16  CF-PRINT-ADDRESS-LABELS        PIC X.
   917
   918         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
   919             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
   920             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
   921             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
   922         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
   923         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
   924         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
   925         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
   926             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
   927             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
   928         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
   929         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
   930         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
   931             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
   932         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
   933
   934         16  CF-CL-ZIP-CODE.
   935             20  CF-CL-ZIP-PRIME.
   936                 24  CF-CL-ZIP-1ST          PIC X.
   937                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
   938                 24  FILLER                 PIC X(4).
   939             20  CF-CL-ZIP-PLUS4            PIC X(4).
   940         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
   941             20  CF-CL-CAN-POSTAL-1         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  18
* EL202.cbl
   942             20  CF-CL-CAN-POSTAL-2         PIC XXX.
   943             20  FILLER                     PIC XXX.
   944
   945         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
   946         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
   947         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
   948         16  CF-CO-OPTION-START-DATE        PIC XX.
   949         16  CF-REM-TRM-CALC-OPTION         PIC X.
   950           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
   951                                                      '3' '4'.
   952           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
   953           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
   954           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
   955           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
   956           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
   957           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
   958
   959         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
   960
   961         16  CF-PAYMENT-APPROVAL-LEVELS.
   962             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
   963             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
   964             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
   965             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
   966             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
   967             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
   968
   969         16  CF-END-USER-REPORTING-USER     PIC X.
   970             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
   971             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
   972
   973         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
   974             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
   975             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
   976
   977         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
   978
   979         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
   980         16  FILLER                         PIC X.
   981
   982         16  CF-CREDIT-ARCHIVE-CNTL.
   983             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
   984             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
   985             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
   986
   987         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
   988
   989         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
   990             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
   991             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
   992
   993         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
   994             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
   995             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
   996
   997         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
   998
   999         16  CF-CO-ACH-ID-CODE              PIC  X.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  19
* EL202.cbl
  1000             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1001             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1002             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1003         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1004         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1005         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1006         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1007         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1008         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1009         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1010         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1011         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1012                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1013         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1014                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1015
  1016         16  CF-CO-OVER-SHORT.
  1017             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1018             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1019
  1020*         16  FILLER                         PIC X(102).
  1021         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1022             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1023             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1024
  1025         16  CF-AH-APPROVAL-DAYS.
  1026             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1027             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1028             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1029             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1030
  1031         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1032
  1033         16  CF-APPROV-LEV-5.
  1034             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1035             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1036             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1037
  1038         16  FILLER                         PIC X(68).
  1039****************************************************************
  1040*             PROCESSOR/USER RECORD                            *
  1041****************************************************************
  1042
  1043     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1044         16  CF-PROCESSOR-NAME              PIC X(30).
  1045         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1046         16  CF-PROCESSOR-TITLE             PIC X(26).
  1047         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1048                 88  MESSAGE-YES                VALUE 'Y'.
  1049                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1050
  1051*****************************************************
  1052****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1053****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1054****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1055****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1056*****************************************************
  1057
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  20
* EL202.cbl
  1058         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1059             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1060             20  CF-APPLICATION-FORCE       PIC X.
  1061             20  CF-INDIVIDUAL-APP.
  1062                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1063                     28  CF-BROWSE-APP      PIC X.
  1064                     28  CF-UPDATE-APP      PIC X.
  1065
  1066         16  CF-CURRENT-TERM-ON             PIC X(4).
  1067         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1068             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1069             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1070             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1071             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1072             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1073             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1074             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1075         16  CF-PROCESSOR-CARRIER           PIC X.
  1076             88  NO-CARRIER-SECURITY            VALUE ' '.
  1077         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1078             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1079         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1080             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1081         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1082             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1083
  1084         16  CF-PROC-SYS-ACCESS-SW.
  1085             20  CF-PROC-CREDIT-CLAIMS-SW.
  1086                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1087                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1088                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1089                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1090             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1091                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1092                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1093             20  CF-PROC-LIFE-GNRLDGR-SW.
  1094                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1095                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1096                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1097                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1098             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1099                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1100                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1101         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1102             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1103             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1104         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1105
  1106         16  CF-APPROVAL-LEVEL                  PIC X.
  1107             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1108             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1109             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1110             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1111             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1112
  1113         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1114
  1115         16  CF-LANGUAGE-TYPE                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  21
* EL202.cbl
  1116             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1117             88  CF-LANG-IS-FR                      VALUE 'F'.
  1118
  1119         16  CF-CSR-IND                         PIC X.
  1120         16  FILLER                             PIC X(239).
  1121
  1122****************************************************************
  1123*             PROCESSOR/REMINDERS RECORD                       *
  1124****************************************************************
  1125
  1126     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1127         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1128             20  CF-START-REMIND-DT         PIC XX.
  1129             20  CF-END-REMIND-DT           PIC XX.
  1130             20  CF-REMINDER-TEXT           PIC X(50).
  1131         16  FILLER                         PIC X(296).
  1132
  1133
  1134****************************************************************
  1135*             STATE MASTER RECORD                              *
  1136****************************************************************
  1137
  1138     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1139         16  CF-STATE-ABBREVIATION          PIC XX.
  1140         16  CF-STATE-NAME                  PIC X(25).
  1141         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1142         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1143             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1144             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1145             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1146             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1147                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1148                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1149             20  CF-ST-PREM-REJECT-SW       PIC X.
  1150                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1151                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1152             20  CF-ST-REF-REJECT-SW        PIC X.
  1153                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1154                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1155         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1156         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1157         16  CF-ST-REFUND-RULES.
  1158             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1159             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1160             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1161         16  CF-ST-FST-PMT-EXTENSION.
  1162             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1163             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1164                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1165                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1166                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1167                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1168         16  CF-ST-STATE-CALL.
  1169             20  CF-ST-CALL-UNEARNED        PIC X.
  1170             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1171             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1172         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1173             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  22
* EL202.cbl
  1174             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1175         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1176         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1177         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1178         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1179         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1180         16  FILLER                         PIC X.
  1181         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1182             20  CF-ST-BENEFIT-CD           PIC XX.
  1183             20  CF-ST-BENEFIT-KIND         PIC X.
  1184                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1185                 88  CF-ST-AH-KIND              VALUE 'A'.
  1186             20  CF-ST-REM-TERM-CALC        PIC X.
  1187                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1188                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1189                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1190                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1191                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1192                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1193                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1194                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1195
  1196             20  CF-ST-REFUND-CALC          PIC X.
  1197                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1198                 88  ST-REFD-BY-R78             VALUE '1'.
  1199                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1200                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1201                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1202                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1203                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1204                 88  ST-REFD-UTAH               VALUE '7'.
  1205                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1206                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1207                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1208
  1209             20  CF-ST-EARNING-CALC         PIC X.
  1210                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1211                 88  ST-EARN-BY-R78             VALUE '1'.
  1212                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1213                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1214                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1215                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1216                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1217                 88  ST-EARN-MEAN               VALUE '8'.
  1218                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1219
  1220             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1221                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1222                 88  ST-OVRD-BY-R78             VALUE '1'.
  1223                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1224                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1225                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1226                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1227                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1228                 88  ST-OVRD-MEAN               VALUE '8'.
  1229                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1230             20  cf-st-extra-periods        pic 9.
  1231*            20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  23
* EL202.cbl
  1232
  1233         16  CF-ST-COMMISSION-CAPS.
  1234             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1235             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1236             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1237             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1238         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1239                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1240
  1241         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1242
  1243         16  CF-ST-STATUTORY-INTEREST.
  1244             20  CF-ST-STAT-DATE-FROM       PIC X.
  1245                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1246                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1247             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1248             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1249             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1250             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1251             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1252
  1253         16  CF-ST-OVER-SHORT.
  1254             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1255             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1256
  1257         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1258
  1259         16  CF-ST-RT-CALC                  PIC X.
  1260
  1261         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1262         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1263         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1264         16  CF-ST-RF-LR-CALC               PIC X.
  1265         16  CF-ST-RF-LL-CALC               PIC X.
  1266         16  CF-ST-RF-LN-CALC               PIC X.
  1267         16  CF-ST-RF-AH-CALC               PIC X.
  1268         16  CF-ST-RF-CP-CALC               PIC X.
  1269*        16  FILLER                         PIC X(206).
  1270*CIDMOD         16  FILLER                         PIC X(192).
  1271         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1272             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1273         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1274         16  CF-ST-VFY-2ND-BENE             PIC X.
  1275         16  CF-ST-CAUSAL-STATE             PIC X.
  1276         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1277         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1278         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1279             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1280         16  CF-ST-NET-ONLY-STATE           PIC X.
  1281             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1282         16  FILLER                         PIC X(181).
  1283
  1284****************************************************************
  1285*             BENEFIT MASTER RECORD                            *
  1286****************************************************************
  1287
  1288     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1289         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  24
* EL202.cbl
  1290             20  CF-BENEFIT-CODE            PIC XX.
  1291             20  CF-BENEFIT-NUMERIC  REDEFINES
  1292                 CF-BENEFIT-CODE            PIC XX.
  1293             20  CF-BENEFIT-ALPHA           PIC XXX.
  1294             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1295             20  CF-BENEFIT-COMMENT         PIC X(10).
  1296
  1297             20  CF-LF-COVERAGE-TYPE        PIC X.
  1298                 88  CF-REDUCING                VALUE 'R'.
  1299                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1300
  1301             20  CF-SPECIAL-CALC-CD         PIC X.
  1302                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1303                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1304                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1305                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1306                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1307                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1308                 88  CF-FARM-PLAN               VALUE 'F'.
  1309                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1310                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1311                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1312                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1313                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1314                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1315                 88  CF-PRUDENTIAL              VALUE 'P'.
  1316                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1317                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1318                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1319                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1320                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1321                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1322
  1323             20  CF-JOINT-INDICATOR         PIC X.
  1324                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1325
  1326*            20  FILLER                     PIC X(12).
  1327             20  cf-maximum-benefits        pic s999 comp-3.
  1328             20  FILLER                     PIC X(09).
  1329             20  CF-BENEFIT-CATEGORY        PIC X.
  1330             20  CF-LOAN-TYPE               PIC X(8).
  1331
  1332             20  CF-CO-REM-TERM-CALC        PIC X.
  1333                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1334                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1335                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1336                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1337                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1338
  1339             20  CF-CO-EARNINGS-CALC        PIC X.
  1340                 88  CO-EARN-BY-R78             VALUE '1'.
  1341                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1342                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1343                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1344                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1345                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1346                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1347                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  25
* EL202.cbl
  1348
  1349             20  CF-CO-REFUND-CALC          PIC X.
  1350                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1351                 88  CO-REFD-BY-R78             VALUE '1'.
  1352                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1353                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1354                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1355                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1356                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1357                 88  CO-REFD-MEAN               VALUE '8'.
  1358                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1359                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1360                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1361
  1362             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1363                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1364                 88  CO-OVRD-BY-R78             VALUE '1'.
  1365                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1366                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1367                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1368                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1369                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1370                 88  CO-OVRD-MEAN               VALUE '8'.
  1371                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1372
  1373             20  CF-CO-BEN-I-G-CD           PIC X.
  1374                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1375                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1376                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1377
  1378         16  FILLER                         PIC X(304).
  1379
  1380
  1381****************************************************************
  1382*             CARRIER MASTER RECORD                            *
  1383****************************************************************
  1384
  1385     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1386         16  CF-ADDRESS-DATA.
  1387             20  CF-MAIL-TO-NAME            PIC X(30).
  1388             20  CF-IN-CARE-OF              PIC X(30).
  1389             20  CF-ADDRESS-LINE-1          PIC X(30).
  1390             20  CF-ADDRESS-LINE-2          PIC X(30).
  1391             20  CF-CITY-STATE              PIC X(30).
  1392             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1393             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1394
  1395         16  CF-CLAIM-NO-CONTROL.
  1396             20  CF-CLAIM-NO-METHOD         PIC X.
  1397                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1398                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1399                 88  CLAIM-NO-SEQ               VALUE '3'.
  1400                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1401             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1402                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1403                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1404                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1405
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  26
* EL202.cbl
  1406         16  CF-CHECK-NO-CONTROL.
  1407             20  CF-CHECK-NO-METHOD         PIC X.
  1408                 88  CHECK-NO-MANUAL            VALUE '1'.
  1409                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1410                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1411                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1412             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1413                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1414
  1415         16  CF-DOMICILE-STATE              PIC XX.
  1416
  1417         16  CF-EXPENSE-CONTROLS.
  1418             20  CF-EXPENSE-METHOD          PIC X.
  1419                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1420                 88  DOLLARS-PER-PMT            VALUE '2'.
  1421                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1422                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1423             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1424             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1425
  1426         16  CF-CORRESPONDENCE-CONTROL.
  1427             20  CF-LETTER-RESEND-OPT       PIC X.
  1428                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1429                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1430             20  FILLER                     PIC X(4).
  1431
  1432         16  CF-RESERVE-CONTROLS.
  1433             20  CF-MANUAL-SW               PIC X.
  1434                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1435             20  CF-FUTURE-SW               PIC X.
  1436                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1437             20  CF-PTC-SW                  PIC X.
  1438                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1439             20  CF-IBNR-SW                 PIC X.
  1440                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1441             20  CF-PTC-LF-SW               PIC X.
  1442                 88  CF-LF-PTC-USED             VALUE '1'.
  1443             20  CF-CDT-ACCESS-METHOD       PIC X.
  1444                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1445                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1446                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1447             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1448
  1449         16  CF-CLAIM-CALC-METHOD           PIC X.
  1450             88  360-PLUS-MONTHS                VALUE '1'.
  1451             88  365-PLUS-MONTHS                VALUE '2'.
  1452             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1453             88  360-DAILY                      VALUE '4'.
  1454             88  365-DAILY                      VALUE '5'.
  1455
  1456         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1457         16  FILLER                         PIC X(11).
  1458
  1459         16  CF-LIMIT-AMOUNTS.
  1460             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1461             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1462             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1463             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  27
* EL202.cbl
  1464             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1465             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1466             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1467             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1468             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1469             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1470
  1471         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1472         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1473         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1474
  1475         16  CF-ZIP-CODE.
  1476             20  CF-ZIP-PRIME.
  1477                 24  CF-ZIP-1ST             PIC X.
  1478                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1479                 24  FILLER                 PIC X(4).
  1480             20  CF-ZIP-PLUS4               PIC X(4).
  1481         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1482             20  CF-CAN-POSTAL-1            PIC XXX.
  1483             20  CF-CAN-POSTAL-2            PIC XXX.
  1484             20  FILLER                     PIC XXX.
  1485
  1486         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1487         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1488         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1489
  1490         16  CF-RATING-SWITCH               PIC X.
  1491             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1492             88  CF-NO-RATING                   VALUE 'N'.
  1493
  1494         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1495
  1496         16  CF-CARRIER-OVER-SHORT.
  1497             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1498             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1499
  1500         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1501         16  CF-SECPAY-SWITCH               PIC X.
  1502             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1503             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1504         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1505         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1506         16  FILLER                         PIC X(444).
  1507*        16  FILLER                         PIC X(452).
  1508
  1509
  1510****************************************************************
  1511*             MORTALITY MASTER RECORD                          *
  1512****************************************************************
  1513
  1514     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1515         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1516                                INDEXED BY CF-MORT-NDX.
  1517             20  CF-MORT-TABLE              PIC X(5).
  1518             20  CF-MORT-TABLE-TYPE         PIC X.
  1519                 88  CF-MORT-JOINT              VALUE 'J'.
  1520                 88  CF-MORT-SINGLE             VALUE 'S'.
  1521                 88  CF-MORT-COMBINED           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  28
* EL202.cbl
  1522                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1523                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1524             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1525             20  CF-MORT-AGE-METHOD         PIC XX.
  1526                 88  CF-AGE-LAST                VALUE 'AL'.
  1527                 88  CF-AGE-NEAR                VALUE 'AN'.
  1528             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1529             20  CF-MORT-ADJUSTMENT-DIRECTION
  1530                                            PIC X.
  1531                 88  CF-MINUS                   VALUE '-'.
  1532                 88  CF-PLUS                    VALUE '+'.
  1533             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1534             20  CF-MORT-JOINT-CODE         PIC X.
  1535                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1536             20  CF-MORT-PC-Q               PIC X.
  1537                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1538             20  CF-MORT-TABLE-CODE         PIC X(4).
  1539             20  CF-MORT-COMMENTS           PIC X(15).
  1540             20  FILLER                     PIC X(14).
  1541
  1542         16  FILLER                         PIC X(251).
  1543
  1544
  1545****************************************************************
  1546*             BUSSINESS TYPE MASTER RECORD                     *
  1547****************************************************************
  1548
  1549     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1550* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1551* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1552* AND RECORD 05 IS TYPES 81-99
  1553         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1554             20  CF-BUSINESS-TITLE          PIC  X(19).
  1555             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1556                                            PIC S9V9(4) COMP-3.
  1557             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1558             20  FILLER                     PIC  X.
  1559         16  FILLER                         PIC  X(248).
  1560
  1561
  1562****************************************************************
  1563*             TERMINAL MASTER RECORD                           *
  1564****************************************************************
  1565
  1566     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1567
  1568         16  CF-COMPANY-TERMINALS.
  1569             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1570                                  PIC X(4).
  1571         16  FILLER               PIC X(248).
  1572
  1573
  1574****************************************************************
  1575*             LIFE EDIT MASTER RECORD                          *
  1576****************************************************************
  1577
  1578     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1579         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  29
* EL202.cbl
  1580             20  CF-LIFE-CODE-IN            PIC XX.
  1581             20  CF-LIFE-CODE-OUT           PIC XX.
  1582         16  FILLER                         PIC X(248).
  1583
  1584
  1585****************************************************************
  1586*             AH EDIT MASTER RECORD                            *
  1587****************************************************************
  1588
  1589     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1590         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1591             20  CF-AH-CODE-IN              PIC XXX.
  1592             20  CF-AH-CODE-OUT             PIC XX.
  1593         16  FILLER                         PIC X(248).
  1594
  1595
  1596****************************************************************
  1597*             CREDIBILITY TABLES                               *
  1598****************************************************************
  1599
  1600     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1601         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1602                             INDEXED BY CF-CRDB-NDX.
  1603             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1604             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1605             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1606         16  FILLER                         PIC  X(332).
  1607
  1608
  1609****************************************************************
  1610*             REPORT CUSTOMIZATION RECORD                      *
  1611****************************************************************
  1612
  1613     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1614         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1615             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1616             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1617             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1618**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1619****       A T-TRANSFER.                                   ****
  1620             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1621
  1622         16  FILLER                         PIC XX.
  1623
  1624         16  CF-CARRIER-CNTL-OPT.
  1625             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1626                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1627                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1628             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1629                                            PIC X.
  1630         16  CF-GROUP-CNTL-OPT.
  1631             20  CF-GROUP-OPT-SEQ           PIC 9.
  1632                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1633                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1634             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1635                                            PIC X(6).
  1636         16  CF-STATE-CNTL-OPT.
  1637             20  CF-STATE-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  30
* EL202.cbl
  1638                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1639                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1640             20  CF-STATE-SELECT OCCURS 3 TIMES
  1641                                            PIC XX.
  1642         16  CF-ACCOUNT-CNTL-OPT.
  1643             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1644                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1645                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1646             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1647                                            PIC X(10).
  1648         16  CF-BUS-TYP-CNTL-OPT.
  1649             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1650                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1651                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1652             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1653                                            PIC XX.
  1654         16  CF-LF-TYP-CNTL-OPT.
  1655             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1656                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1657                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1658             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1659                                            PIC XX.
  1660         16  CF-AH-TYP-CNTL-OPT.
  1661             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1662                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1663                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1664             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1665                                            PIC XX.
  1666         16  CF-REPTCD1-CNTL-OPT.
  1667             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1668                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1669                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1670             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1671                                            PIC X(10).
  1672         16  CF-REPTCD2-CNTL-OPT.
  1673             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1674                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1675                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1676             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1677                                            PIC X(10).
  1678         16  CF-USER1-CNTL-OPT.
  1679             20  CF-USER1-OPT-SEQ           PIC 9.
  1680                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1681                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1682             20  CF-USER1-SELECT OCCURS 3 TIMES
  1683                                            PIC X(10).
  1684         16  CF-USER2-CNTL-OPT.
  1685             20  CF-USER2-OPT-SEQ           PIC 9.
  1686                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1687                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1688             20  CF-USER2-SELECT OCCURS 3 TIMES
  1689                                            PIC X(10).
  1690         16  CF-USER3-CNTL-OPT.
  1691             20  CF-USER3-OPT-SEQ           PIC 9.
  1692                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1693                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1694             20  CF-USER3-SELECT OCCURS 3 TIMES
  1695                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  31
* EL202.cbl
  1696         16  CF-USER4-CNTL-OPT.
  1697             20  CF-USER4-OPT-SEQ           PIC 9.
  1698                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1699                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1700             20  CF-USER4-SELECT OCCURS 3 TIMES
  1701                                            PIC X(10).
  1702         16  CF-USER5-CNTL-OPT.
  1703             20  CF-USER5-OPT-SEQ           PIC 9.
  1704                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1705                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1706             20  CF-USER5-SELECT OCCURS 3 TIMES
  1707                                            PIC X(10).
  1708         16  CF-REINS-CNTL-OPT.
  1709             20  CF-REINS-OPT-SEQ           PIC 9.
  1710                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1711                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1712             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1713                 24  CF-REINS-PRIME         PIC XXX.
  1714                 24  CF-REINS-SUB           PIC XXX.
  1715
  1716         16  CF-AGENT-CNTL-OPT.
  1717             20  CF-AGENT-OPT-SEQ           PIC 9.
  1718                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1719                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1720             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1721                                            PIC X(10).
  1722
  1723         16  FILLER                         PIC X(43).
  1724
  1725         16  CF-LOSS-RATIO-SELECT.
  1726             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1727             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1728         16  CF-ENTRY-DATE-SELECT.
  1729             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1730             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1731         16  CF-EFFECTIVE-DATE-SELECT.
  1732             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1733             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1734
  1735         16  CF-EXCEPTION-LIST-IND          PIC X.
  1736             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1737
  1738         16  FILLER                         PIC X(318).
  1739
  1740****************************************************************
  1741*                  EXCEPTION REPORTING RECORD                  *
  1742****************************************************************
  1743
  1744     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1745         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1746             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1747
  1748         16  CF-COMBINED-LIFE-AH-OPT.
  1749             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1750             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1751             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1752             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1753
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  32
* EL202.cbl
  1754         16  CF-LIFE-OPT.
  1755             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1756             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1757             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1758             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1759             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1760             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1761             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1762             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1763             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1764             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1765
  1766         16  CF-AH-OPT.
  1767             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1768             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1769             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1770             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1771             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1772             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1773             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1774             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1775             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1776             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1777
  1778         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1779             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1780             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1781             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1782
  1783         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1784
  1785         16  FILLER                         PIC X(673).
  1786
  1787
  1788****************************************************************
  1789*             MORTGAGE SYSTEM PLAN RECORD                      *
  1790****************************************************************
  1791
  1792     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1793         16  CF-PLAN-TYPE                   PIC X.
  1794             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1795             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1796             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1797         16  CF-PLAN-ABBREV                 PIC XXX.
  1798         16  CF-PLAN-DESCRIPT               PIC X(10).
  1799         16  CF-PLAN-NOTES                  PIC X(20).
  1800         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1801         16  CF-PLAN-UNDERWRITING.
  1802             20  CF-PLAN-TERM-DATA.
  1803                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1804                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1805             20  CF-PLAN-AGE-DATA.
  1806                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1807                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1808                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1809             20  CF-PLAN-BENEFIT-DATA.
  1810                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1811                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  33
* EL202.cbl
  1812                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1813                                            PIC S9(7)V99  COMP-3.
  1814         16  CF-PLAN-POLICY-FORMS.
  1815             20  CF-POLICY-FORM             PIC X(12).
  1816             20  CF-MASTER-APPLICATION      PIC X(12).
  1817             20  CF-MASTER-POLICY           PIC X(12).
  1818         16  CF-PLAN-RATING.
  1819             20  CF-RATE-CODE               PIC X(5).
  1820             20  CF-SEX-RATING              PIC X.
  1821                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1822                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1823             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1824             20  CF-SUB-STD-TYPE            PIC X.
  1825                 88  CF-PCT-OF-PREM            VALUE '1'.
  1826                 88  CF-PCT-OF-BENE            VALUE '2'.
  1827         16  CF-PLAN-PREM-TOLERANCES.
  1828             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1829             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1830         16  CF-PLAN-PYMT-TOLERANCES.
  1831             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1832             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1833         16  CF-PLAN-MISC-DATA.
  1834             20  FILLER                     PIC X.
  1835             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1836             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1837         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1838         16  CF-PLAN-IND-GRP                PIC X.
  1839             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1840                                                     '1'.
  1841             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1842                                                     '2'.
  1843         16  CF-MIB-SEARCH-SW               PIC X.
  1844             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1845             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1846             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1847             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1848         16  CF-ALPHA-SEARCH-SW             PIC X.
  1849             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1850             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1851             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1852             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1853             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1854             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1855             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1856             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1857             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1858             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1859                                                     'A' 'B' 'C'
  1860                                                     'X' 'Y' 'Z'.
  1861         16  CF-EFF-DT-RULE-SW              PIC X.
  1862             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1863             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1864             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1865             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1866             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1867         16  FILLER                         PIC X(4).
  1868         16  CF-HEALTH-QUESTIONS            PIC X.
  1869             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  34
* EL202.cbl
  1870         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1871         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  1872         16  CF-PLAN-SNGL-JNT               PIC X.
  1873             88  CF-COMBINED-PLAN              VALUE 'C'.
  1874             88  CF-JNT-PLAN                   VALUE 'J'.
  1875             88  CF-SNGL-PLAN                  VALUE 'S'.
  1876         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1877         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1878         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1879         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1880         16  CF-RERATE-CNTL                 PIC  X.
  1881             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  1882             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  1883             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  1884             88  CF-AUTO-RECALC                 VALUE '4'.
  1885         16  CF-BENEFIT-TYPE                PIC  X.
  1886             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  1887             88  CF-BENEFIT-REDUCES             VALUE '2'.
  1888         16  CF-POLICY-FEE                  PIC S999V99
  1889                                                    COMP-3.
  1890         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  1891         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  1892         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  1893         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  1894         16  FILLER                         PIC  X(32).
  1895         16  CF-TERMINATION-FORM            PIC  X(04).
  1896         16  FILLER                         PIC  X(08).
  1897         16  CF-CLAIM-CAP                   PIC S9(7)V99
  1898                                                       COMP-3.
  1899         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  1900         16  CF-ISSUE-LETTER                PIC  X(4).
  1901         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  1902         16  CF-DEPENDENT-COVERAGE          PIC  X.
  1903             88  CF-YES-DEP-COV                 VALUE 'Y'.
  1904             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  1905         16  CF-MP-REFUND-CALC              PIC X.
  1906             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  1907             88  CF-MP-REFD-BY-R78              VALUE '1'.
  1908             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  1909             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  1910             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  1911             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  1912             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  1913             88  CF-MP-REFD-MEAN                VALUE '8'.
  1914         16  CF-ALT-RATE-CODE               PIC  X(5).
  1915
  1916
  1917         16  FILLER                         PIC X(498).
  1918****************************************************************
  1919*             MORTGAGE COMPANY MASTER RECORD                   *
  1920****************************************************************
  1921
  1922     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1923         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  1924         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  1925             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  1926             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  1927             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  35
* EL202.cbl
  1928             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  1929             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  1930
  1931         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  1932         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  1933         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  1934         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  1935         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  1936
  1937         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  1938             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  1939         16  CF-MP-RECON-USE-IND            PIC X(1).
  1940             88  CF-MP-USE-RECON             VALUE 'Y'.
  1941         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  1942             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  1943         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  1944             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  1945             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  1946         16  FILLER                         PIC X(1).
  1947         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  1948             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  1949         16  CF-MORTG-MIB-VERSION           PIC X.
  1950             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  1951             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  1952             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  1953         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  1954             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  1955                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  1956             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  1957                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  1958             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  1959                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  1960             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  1961                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  1962             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  1963                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  1964             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  1965                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  1966         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  1967         16  FILLER                         PIC X(7).
  1968         16  CF-MORTG-DESTINATION-SYMBOL.
  1969             20  CF-MORTG-MIB-COMM          PIC X(5).
  1970             20  CF-MORTG-MIB-TERM          PIC X(5).
  1971         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  1972             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  1973         16  FILLER                         PIC X(03).
  1974         16  CF-MP-CHECK-NO-CONTROL.
  1975             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  1976                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  1977                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  1978                                                ' ' LOW-VALUES.
  1979                 88  CF-MP-CHECK-NO-PRE-PRINTED
  1980                                               VALUE '3'.
  1981         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  1982         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  1983         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  1984             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  1985                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  36
* EL202.cbl
  1986             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  1987                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  1988             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  1989                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  1990             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  1991                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  1992             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  1993                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  1994             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  1995                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  1996         16  CF-MORTG-BILLING-AREA.
  1997             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  1998                                            PIC X.
  1999         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2000         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2001         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2002         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2003             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2004             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2005         16  FILLER                         PIC X.
  2006         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2007             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2008             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2009         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2010         16  FILLER                         PIC X(8).
  2011         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2012         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2013         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2014         16  CF-ACH-COMPANY-ID.
  2015             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2016                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2017                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2018                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2019             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2020         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2021             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2022         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2023             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2024             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2025         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2026         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2027         16  FILLER                         PIC X(536).
  2028
  2029****************************************************************
  2030*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2031****************************************************************
  2032
  2033     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2034         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2035             20  CF-FEMALE-HEIGHT.
  2036                 24  CF-FEMALE-FT           PIC 99.
  2037                 24  CF-FEMALE-IN           PIC 99.
  2038             20  CF-FEMALE-MIN-WT           PIC 999.
  2039             20  CF-FEMALE-MAX-WT           PIC 999.
  2040         16  FILLER                         PIC X(428).
  2041
  2042     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2043         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  37
* EL202.cbl
  2044             20  CF-MALE-HEIGHT.
  2045                 24  CF-MALE-FT             PIC 99.
  2046                 24  CF-MALE-IN             PIC 99.
  2047             20  CF-MALE-MIN-WT             PIC 999.
  2048             20  CF-MALE-MAX-WT             PIC 999.
  2049         16  FILLER                         PIC X(428).
  2050******************************************************************
  2051*             AUTOMATIC ACTIVITY RECORD                          *
  2052******************************************************************
  2053     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2054         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2055             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2056             20  CF-SYS-LETTER-ID           PIC X(04).
  2057             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2058             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2059             20  CF-SYS-RESET-SW            PIC X(01).
  2060             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2061             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2062
  2063         16  FILLER                         PIC X(50).
  2064
  2065         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2066             20  CF-USER-ACTIVE-SW          PIC X(01).
  2067             20  CF-USER-LETTER-ID          PIC X(04).
  2068             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2069             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2070             20  CF-USER-RESET-SW           PIC X(01).
  2071             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2072             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2073             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2074
  2075         16  FILLER                         PIC X(246).
  2076*                                copy ERCPYAJ.
  2077******************************************************************
  2078*                                                                *
  2079*                            ERCPYAJ                             *
  2080*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2081*                            VMOD=2.015                          *
  2082*                                                                *
  2083*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  2084*                                                                *
  2085*                                                                *
  2086*   FILE TYPE = VSAM,KSDS                                        *
  2087*   RECORD SIZE = 200  RECFORM = FIXED                           *
  2088*                                                                *
  2089*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  2090*       ALTERNATE PATHS = NONE                                   *
  2091*                                                                *
  2092*   LOG = YES                                                    *
  2093*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2094******************************************************************
  2095******************************************************************
  2096*                   C H A N G E   L O G
  2097*
  2098* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2099*-----------------------------------------------------------------
  2100*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2101* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  38
* EL202.cbl
  2102*-----------------------------------------------------------------
  2103* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  2104* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  2105******************************************************************
  2106
  2107 01  PENDING-PAY-ADJ.
  2108     12  PY-RECORD-ID                     PIC XX.
  2109         88  VALID-PY-ID                        VALUE 'PY'.
  2110
  2111     12  PY-CONTROL-PRIMARY.
  2112         16  PY-COMPANY-CD                PIC X.
  2113         16  PY-CARRIER                   PIC X.
  2114         16  PY-GROUPING                  PIC X(6).
  2115         16  PY-FIN-RESP                  PIC X(10).
  2116         16  PY-ACCOUNT                   PIC X(10).
  2117         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  2118                                          PIC X(10).
  2119         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  2120         16  PY-RECORD-TYPE               PIC X.
  2121             88  PY-REMIT-RECEIVED            VALUE 'R'.
  2122             88  PY-DEPOSIT                   VALUE 'D'.
  2123             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  2124             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  2125             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  2126             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  2127             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  2128             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  2129             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  2130             88  PY-FICA-ENTRY                VALUE 'F'.
  2131             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  2132             88  PY-POLICY-FEE                VALUE 'W'.
  2133             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  2134
  2135     12  PY-PYMT-TYPE                     PIC X.
  2136             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  2137             88  PY-REINS-PYMT                VALUE 'R'.
  2138             88  PY-EXP-PYMT                  VALUE 'E'.
  2139
  2140     12  PY-BIL-INV                       PIC X(6).
  2141     12  PY-REF-NO                        PIC X(12).
  2142
  2143     12  PY-LAST-MAINT-DT                 PIC XX.
  2144     12  PY-LAST-MAINT-BY                 PIC X(4).
  2145     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2146
  2147     12  PY-PYADJ-RECORD.
  2148         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  2149         16  PY-ENTRY-COMMENT             PIC X(30).
  2150         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  2151             20  PY-GL-ACCOUNT            PIC X(10).
  2152             20  PY-GL-STATE              PIC X(02).
  2153             20  PY-GL-CANC-SW            PIC X(01).
  2154                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  2155                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  2156             20  PY-GL-COMMENT            PIC X(10).
  2157             20  FILLER      REDEFINES PY-GL-COMMENT.
  2158                 24  PY-GL-CHECK-NO       PIC 9(06).
  2159                 24  FILLER               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  39
* EL202.cbl
  2160             20  FILLER                   PIC X(07).
  2161         16  PY-SAVE-ACCOUNT              PIC X(10).
  2162         16  PY-SAVE-TYPE                 PIC X(01).
  2163
  2164         16  PY-LETTERS.
  2165             20  PY-LETTER OCCURS 3 TIMES
  2166                           INDEXED BY PY-LET-NDX
  2167                                          PIC X(04).
  2168
  2169         16  PY-ERCOMP-TYPE               PIC X.
  2170             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  2171             88  PY-GA-TYPE                   VALUE 'G'.
  2172             88  PY-BANK-TYPE                 VALUE 'B'.
  2173         16  FILLER                       PIC X(05).
  2174
  2175     12  PY-RECORD-STATUS.
  2176         16  PY-CREDIT-SELECT-DT          PIC XX.
  2177         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  2178         16  PY-BILLED-DATE               PIC XX.
  2179         16  PY-REPORTED-DT               PIC XX.
  2180         16  PY-PMT-APPLIED               PIC X.
  2181             88  PY-ACCOUNT-PMT               VALUE 'A'.
  2182             88  PY-GA-PMT                    VALUE 'G'.
  2183             88  PY-OVWRITE-PMT               VALUE 'O'.
  2184             88  PY-NON-AR-PMT                VALUE 'N'.
  2185         16  FILLER                       PIC X(5).
  2186         16  PY-INPUT-DT                  PIC XX.
  2187         16  PY-CHECK-NUMBER              PIC X(6).
  2188         16  PY-VOID-SW                   PIC X.
  2189             88  PY-CHECK-VOIDED              VALUE 'V'.
  2190         16  PY-CHECK-ORIGIN-SW           PIC X.
  2191             88  PY-BILLING-CHECK             VALUE 'B'.
  2192             88  PY-REFUND-CHECK              VALUE 'R'.
  2193             88  PY-GA-CHECK                  VALUE 'G'.
  2194             88  PY-CHECK-WRITTEN             VALUE 'W'.
  2195             88  PY-CHECK-REVERSAL            VALUE 'V'.
  2196         16  PY-CHECK-WRITTEN-DT          PIC XX.
  2197         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  2198         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  2199         16  PY-BILL-FLAG                 PIC X.
  2200             88  PY-BILLED                    VALUE 'B'.
  2201         16  PY-AR-FLAG                   PIC X.
  2202             88  PY-AR-CYCLE                  VALUE 'C'.
  2203             88  PY-AR-MONTH-END              VALUE 'M'.
  2204         16  PY-AR-DATE                   PIC XX.
  2205
  2206     12  PY-GL-CODES.
  2207         16  PY-GL-DB                     PIC X(14).
  2208         16  PY-GL-CR                     PIC X(14).
  2209         16  PY-GL-FLAG                   PIC X.
  2210         16  PY-GL-DATE                   PIC XX.
  2211
  2212     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  2213     12  FILLER                           PIC X(3).
  2214******************************************************************
  2215*                                copy ERCPNDB.
  2216******************************************************************
  2217*                                                                *
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  40
* EL202.cbl
  2218*                                                                *
  2219*                            ERCPNDB.                            *
  2220*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2221*                            VMOD=2.025                          *
  2222*                                                                *
  2223*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  2224*                                                                *
  2225******************************************************************
  2226*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  2227*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  2228******************************************************************
  2229*                                                                *
  2230*                                                                *
  2231*   FILE TYPE = VSAM,KSDS                                        *
  2232*   RECORD SIZE = 585  RECFORM = FIXED                           *
  2233*                                                                *
  2234*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  2235*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  2236*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  2237*                                                 RKP=13,LEN=36  *
  2238*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  2239*                                      AND CHG-SEQ.)             *
  2240*                                                RKP=49,LEN=11   *
  2241*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  2242*                                      AND CHG-SEQ.)             *
  2243*                                                RKP=60,LEN=15   *
  2244*                                                                *
  2245*   LOG = NO                                                     *
  2246*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2247******************************************************************
  2248******************************************************************
  2249*                   C H A N G E   L O G
  2250*
  2251* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2252*-----------------------------------------------------------------
  2253*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2254* EFFECTIVE    NUMBER
  2255*-----------------------------------------------------------------
  2256* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2257* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2258* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2259* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2260* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  2261* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2262* 032306                   PEMA  ADD BOW LOAN NUMBER
  2263* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  2264* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  2265* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2266* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2267* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  2268* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  2269* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2270* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2271* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  2272******************************************************************
  2273
  2274 01  PENDING-BUSINESS.
  2275     12  PB-RECORD-ID                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  41
* EL202.cbl
  2276         88  VALID-PB-ID                        VALUE 'PB'.
  2277
  2278     12  PB-CONTROL-PRIMARY.
  2279         16  PB-COMPANY-CD                PIC X.
  2280         16  PB-ENTRY-BATCH               PIC X(6).
  2281         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  2282         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  2283
  2284     12  PB-CONTROL-BY-ACCOUNT.
  2285         16  PB-COMPANY-CD-A1             PIC X.
  2286         16  PB-CARRIER                   PIC X.
  2287         16  PB-GROUPING.
  2288             20  PB-GROUPING-PREFIX       PIC XXX.
  2289             20  PB-GROUPING-PRIME        PIC XXX.
  2290         16  PB-STATE                     PIC XX.
  2291         16  PB-ACCOUNT.
  2292             20  PB-ACCOUNT-PREFIX        PIC X(4).
  2293             20  PB-ACCOUNT-PRIME         PIC X(6).
  2294         16  PB-CERT-EFF-DT               PIC XX.
  2295         16  PB-CERT-NO.
  2296             20  PB-CERT-PRIME            PIC X(10).
  2297             20  PB-CERT-SFX              PIC X.
  2298         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  2299
  2300         16  PB-RECORD-TYPE               PIC X.
  2301             88  PB-MAILING-DATA                VALUE '0'.
  2302             88  PB-ISSUE                       VALUE '1'.
  2303             88  PB-CANCELLATION                VALUE '2'.
  2304             88  PB-BATCH-TRAILER               VALUE '9'.
  2305
  2306     12  PB-CONTROL-BY-ORIG-BATCH.
  2307         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  2308         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  2309         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  2310         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  2311
  2312     12  PB-CONTROL-BY-CSR.
  2313         16  PB-CSR-COMPANY-CD            PIC X.
  2314         16  PB-CSR-ID                    PIC X(4).
  2315         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  2316         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  2317         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  2318******************************************************************
  2319*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  2320******************************************************************
  2321
  2322     12  PB-LAST-MAINT-DT                 PIC XX.
  2323     12  PB-LAST-MAINT-BY                 PIC X(4).
  2324     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2325
  2326     12  PB-RECORD-BODY                   PIC X(375).
  2327
  2328     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  2329         16  PB-CERT-ORIGIN               PIC X.
  2330             88  CLASIC-CREATED-CERT         VALUE '1'.
  2331         16  PB-I-NAME.
  2332             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  2333             20  PB-I-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  42
* EL202.cbl
  2334                 24  PB-I-INSURED-1ST-INIT PIC X.
  2335                 24  FILLER                PIC X(9).
  2336             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  2337         16  PB-I-AGE                     PIC S99   COMP-3.
  2338         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  2339         16  PB-I-BIRTHDAY                PIC XX.
  2340         16  PB-I-INSURED-SEX             PIC X.
  2341             88  PB-SEX-MALE     VALUE 'M'.
  2342             88  PB-SEX-FEMALE   VALUE 'F'.
  2343
  2344         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  2345         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  2346         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  2347         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  2348         16  PB-I-SKIP-CODE               PIC X.
  2349             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  2350             88  PB-SKIP-JULY              VALUE '1'.
  2351             88  PB-SKIP-AUGUST            VALUE '2'.
  2352             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  2353             88  PB-SKIP-JULY-AUG          VALUE '4'.
  2354             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  2355             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  2356             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  2357             88  PB-SKIP-JUNE              VALUE '8'.
  2358             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  2359             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  2360             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  2361         16  PB-I-TERM-TYPE               PIC X.
  2362             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  2363             88  PB-PAID-WEEKLY            VALUE 'W'.
  2364             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  2365             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  2366             88  PB-PAID-13-YEARLY         VALUE 'T'.
  2367         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  2368         16  PB-I-POLICY-FORM-NO          PIC X(12).
  2369         16  PB-I-DATA-ENTRY-SW           PIC X.
  2370             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  2371             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  2372             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  2373             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  2374         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  2375         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  2376*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  2377         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  2378         16  FILLER                       PIC X.
  2379
  2380         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  2381             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  2382             88  PB-INVALID-LIFE             VALUE '  ' '00'
  2383                                                   '90' THRU '99'.
  2384         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  2385                                          PIC XX.
  2386         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2387         16  PB-I-AMOUNT-FINANCED REDEFINES
  2388                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  2389         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  2390         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  2391                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  43
* EL202.cbl
  2392         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2393         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  2394         16  PB-I-CLP-AMOUNT REDEFINES
  2395                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  2396         16  PB-I-LF-CALC-FLAG            PIC X.
  2397             88 PB-COMP-LF-PREM               VALUE '?'.
  2398         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  2399         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  2400         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2401         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2402         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2403         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2404         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2405         16  PB-I-LF-ABBR                 PIC XXX.
  2406         16  PB-I-LF-INPUT-CD             PIC XX.
  2407
  2408         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2409             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2410             88  PB-INVALID-AH               VALUE '  ' '00'
  2411                                                   '90' THRU '99'.
  2412         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2413         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2414         16  PB-I-AH-CALC-FLAG            PIC X.
  2415             88 PB-COMP-AH-PREM                  VALUE '?'.
  2416         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2417         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2418         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2419         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2420         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2421         16  PB-I-AH-ABBR                 PIC XXX.
  2422         16  PB-I-AH-INPUT-CD             PIC XXX.
  2423
  2424         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2425         16  PB-I-REIN-TABLE              PIC XXX.
  2426         16  PB-I-BUSINESS-TYPE           PIC 99.
  2427         16  PB-I-INDV-GRP-CD             PIC X.
  2428         16  PB-I-MORT-CODE.
  2429             20  PB-I-TABLE               PIC X.
  2430             20  PB-I-INTEREST            PIC XX.
  2431             20  PB-I-MORT-TYP            PIC X.
  2432         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2433         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2434         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2435         16  PB-I-INDV-GRP-OVRD           PIC X.
  2436         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2437         16  PB-I-SIG-SW                  PIC X.
  2438             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2439         16  PB-I-RATE-CLASS              PIC XX.
  2440         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2441         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2442         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2443         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2444         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2445         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2446         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  2447         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2448         16  PB-I-OB-FLAG                 PIC X.
  2449             88  PB-I-OB                      VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  44
* EL202.cbl
  2450             88  PB-I-SUMMARY                 VALUE 'Z'.
  2451         16  PB-I-ENTRY-STATUS            PIC X.
  2452             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2453                                              'M' '5' '9' '2'.
  2454             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2455             88  PB-I-POLICY-PENDING          VALUE '2'.
  2456             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2457             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2458             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  2459             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2460             88  PB-I-REIN-ONLY               VALUE '9'.
  2461             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2462             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2463             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2464             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2465         16  PB-I-INT-CODE                PIC X.
  2466             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2467             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2468         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2469         16  PB-I-SOC-SEC-NO              PIC X(11).
  2470         16  PB-I-MEMBER-NO               PIC X(12).
  2471         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2472*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2473         16  PB-I-OLD-LOF                 PIC XXX.
  2474         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2475         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2476         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2477         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2478         16  PB-I-LIFE-INDICATOR          PIC X.
  2479             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2480         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2481         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2482                                          PIC S9(5)V99    COMP-3.
  2483         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2484             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2485             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2486         16  PB-I-1ST-PMT-DT              PIC XX.
  2487         16  PB-I-JOINT-INSURED.
  2488             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2489             20 PB-I-JOINT-FIRST-NAME.
  2490                24  PB-I-JOINT-FIRST-INIT PIC X.
  2491                24  FILLER                PIC X(9).
  2492             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2493*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2494         16  PB-I-BENEFICIARY-NAME.
  2495             20  PB-I-BANK-NUMBER         PIC X(10).
  2496             20  FILLER                   PIC X(15).
  2497         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2498         16  PB-I-REFERENCE               PIC X(12).
  2499         16  FILLER REDEFINES PB-I-REFERENCE.
  2500             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2501             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2502             20  PB-I-CLP-STATE           PIC XX.
  2503         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2504             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2505             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  2506             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2507         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  45
* EL202.cbl
  2508         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2509         16  PB-I-RESIDENT-STATE          PIC XX.
  2510         16  PB-I-RATE-CODE               PIC X(4).
  2511         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2512         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2513         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2514         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2515         16  PB-I-BANK-NOCHRGB            PIC 99.
  2516         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2517         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2518
  2519     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2520         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2521             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2522         16  PB-C-CANCEL-ORIGIN           PIC X.
  2523             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2524         16  PB-C-LF-CANCEL-DT            PIC XX.
  2525         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2526         16  PB-C-LF-CALC-REQ             PIC X.
  2527             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2528         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2529         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2530         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2531             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2532         16  PB-C-AH-CANCEL-DT            PIC XX.
  2533         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2534         16  PB-C-AH-CALC-REQ             PIC X.
  2535             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2536         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2537         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2538         16  PB-C-LAST-NAME               PIC X(15).
  2539         16  PB-C-REFUND-SW               PIC X.
  2540             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2541             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2542         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2543         16  PB-C-PAYEE-CODE              PIC X(6).
  2544         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2545         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2546         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2547         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2548         16  PB-C-REFERENCE               PIC X(12).
  2549         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2550         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2551         16  PB-C-POST-CARD-IND           PIC X.
  2552         16  PB-C-CANCEL-REASON           PIC X.
  2553         16  PB-C-REF-INTERFACE-SW        PIC X.
  2554         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2555         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2556         16  FILLER                       PIC X(01).
  2557*        16  FILLER                       PIC X(18).
  2558         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2559*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2560         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2561         16  PB-CANCELED-CERT-DATA.
  2562             20  PB-CI-INSURED-NAME.
  2563                 24  PB-CI-LAST-NAME      PIC X(15).
  2564                 24  PB-CI-INITIALS       PIC XX.
  2565             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  46
* EL202.cbl
  2566             20  PB-CI-INSURED-SEX        PIC X.
  2567             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2568             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2569             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2570             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2571             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2572             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2573             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2574             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2575             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2576             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2577             20  PB-CI-RATE-CLASS         PIC XX.
  2578             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2579             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2580             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2581             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2582             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2583             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2584             20  PB-CI-LF-ABBR            PIC X(3).
  2585             20  PB-CI-AH-ABBR            PIC X(3).
  2586             20  PB-CI-OB-FLAG            PIC X.
  2587                 88  PB-CI-OB                VALUE 'B'.
  2588             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2589                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2590                                           'M' '4' '5' '9' '2'.
  2591                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2592                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2593                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2594                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2595                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2596                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  2597                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2598                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2599                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2600                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2601                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2602                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2603                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2604             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2605                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2606                                           'M' '4' '5' '9' '2'.
  2607                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2608                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2609                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2610                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2611                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2612                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  2613                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2614                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2615                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2616                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2617                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2618                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2619                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2620             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2621             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2622             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2623             20  PB-CI-MEMBER-NO          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  47
* EL202.cbl
  2624             20  PB-CI-INT-CODE           PIC X.
  2625                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2626                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2627             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2628             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2629             20  PB-CI-COMP-EXCP-SW       PIC X.
  2630                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2631                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2632             20  PB-CI-ENTRY-STATUS       PIC X.
  2633             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2634             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2635             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2636             20  PB-CI-DEATH-DT           PIC XX.
  2637             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2638             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2639             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2640             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2641             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2642             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2643             20  PB-CI-ENTRY-DT              PIC XX.
  2644             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2645             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2646             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2647             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2648             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2649             20  PB-CI-OLD-LOF               PIC XXX.
  2650*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2651             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2652             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2653             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2654             20  PB-CI-INDV-GRP-CD           PIC X.
  2655             20  PB-CI-BENEFICIARY-NAME.
  2656                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2657                 24  FILLER                  PIC X(15).
  2658             20  PB-CI-NOTE-SW               PIC X.
  2659             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2660             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2661             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2662             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2663             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2664             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2665             20  PB-CI-FIRST-NAME            PIC X(10).
  2666             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2667
  2668         16  FILLER                       PIC X(13).
  2669*032306  16  FILLER                       PIC X(27).
  2670*        16  FILLER                       PIC X(46).
  2671
  2672     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2673         16  FILLER                       PIC X(10).
  2674         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2675         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2676         16  PB-M-INSURED-MID-INIT        PIC X.
  2677         16  PB-M-INSURED-AGE             PIC 99.
  2678         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2679         16  PB-M-INSURED-SEX             PIC X.
  2680         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2681         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  48
* EL202.cbl
  2682         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2683         16  PB-M-INSURED-CITY-STATE.
  2684             20  PB-M-INSURED-CITY        PIC X(28).
  2685             20  PB-M-INSURED-STATE       PIC XX.
  2686         16  PB-M-INSURED-ZIP-CODE.
  2687             20  PB-M-INSURED-ZIP-PRIME.
  2688                 24  PB-M-INSURED-ZIP-1   PIC X.
  2689                     88  PB-M-CANADIAN-POST-CODE
  2690                                             VALUE 'A' THRU 'Z'.
  2691                 24  FILLER               PIC X(4).
  2692             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2693         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2694                                        PB-M-INSURED-ZIP-CODE.
  2695             20  PM-M-INS-CAN-POST1       PIC XXX.
  2696             20  PM-M-INS-CAN-POST2       PIC XXX.
  2697             20  FILLER                   PIC XXX.
  2698         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2699         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2700         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2701         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2702         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2703         16  PB-M-CRED-BENE-CITYST.
  2704             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2705             20  PB-M-CRED-BENE-STATE     PIC XX.
  2706         16  FILLER                       PIC X(92).
  2707
  2708     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2709         16  FILLER                       PIC X(10).
  2710         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2711         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2712         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2713         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2714         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2715         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2716         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2717         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2718         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2719         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2720         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2721         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2722         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2723         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2724         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2725         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2726         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2727         16  PB-ACCOUNT-NAME              PIC X(30).
  2728         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2729         16  PB-REFERENCE                 PIC X(12).
  2730         16  PB-B-RECEIVED-DT             PIC XX.
  2731         16  FILLER                       PIC X(234).
  2732
  2733     12  PB-RECORD-STATUS.
  2734         16  PB-CREDIT-SELECT-DT          PIC XX.
  2735         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2736         16  PB-BILLED-DT                 PIC XX.
  2737         16  PB-BILLING-STATUS            PIC X.
  2738             88  PB-ENTRY-REVERSED            VALUE 'R'.
  2739             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  49
* EL202.cbl
  2740             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2741         16  PB-RECORD-BILL               PIC X.
  2742             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2743             88  PB-RECORD-RETURNED           VALUE 'R'.
  2744             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2745             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2746             88  PB-OVERRIDE-AH               VALUE 'A'.
  2747             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2748         16  PB-BATCH-ENTRY               PIC X.
  2749             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2750             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2751             88  PB-REISSUED-CERT             VALUE 'E'.
  2752             88  PB-CASH-CERT                 VALUE 'C'.
  2753             88  PB-MONTHLY-CERT              VALUE 'M'.
  2754             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2755             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2756             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2757         16  PB-FORCE-CODE                PIC X.
  2758             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2759             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2760             88  PB-CANCEL-FORCE              VALUE '8'.
  2761             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2762             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2763             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2764             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2765             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2766             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2767             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2768         16  PB-FATAL-FLAG                PIC X.
  2769             88  PB-FATAL-ERRORS              VALUE 'X'.
  2770         16  PB-FORCE-ER-CD               PIC X.
  2771             88  PB-FORCE-ERRORS              VALUE 'F'.
  2772             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2773         16  PB-WARN-ER-CD                PIC X.
  2774             88  PB-WARNING-ERRORS            VALUE 'W'.
  2775         16  FILLER                       PIC X.
  2776         16  PB-OUT-BAL-CD                PIC X.
  2777             88  PB-OUT-OF-BAL                VALUE 'O'.
  2778         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2779         16  PB-AH-OVERRIDE-L1            PIC X.
  2780         16  PB-INPUT-DT                  PIC XX.
  2781         16  PB-INPUT-BY                  PIC X(4).
  2782         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2783         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2784         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2785         16  PB-LF-EARNING-METHOD         PIC X.
  2786         16  PB-AH-EARNING-METHOD         PIC X.
  2787         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2788         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2789         16  PB-REIN-CD                   PIC XXX.
  2790         16  PB-LF-REFUND-TYPE            PIC X.
  2791         16  PB-AH-REFUND-TYPE            PIC X.
  2792         16  PB-ACCT-EFF-DT               PIC XX.
  2793         16  PB-ACCT-EXP-DT               PIC XX.
  2794         16  PB-COMPANY-ID                PIC X(3).
  2795         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2796         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2797         16  PB-SV-CARRIER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  50
* EL202.cbl
  2798         16  PB-SV-GROUPING               PIC X(6).
  2799         16  PB-SV-STATE                  PIC XX.
  2800         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2801         16  PB-GA-BILLING-INFO.
  2802             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2803                                          PIC XX.
  2804         16  PB-SV-REMIT-TO  REDEFINES
  2805             PB-GA-BILLING-INFO           PIC X(10).
  2806         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2807         16  PB-I-LOAN-OFFICER            PIC X(5).
  2808         16  PB-I-VIN                     PIC X(17).
  2809
  2810         16  FILLER                       PIC X(04).
  2811         16  IMNET-BYPASS-SW              PIC X.
  2812
  2813******************************************************************
  2814*                COMMON EDIT ERRORS                              *
  2815******************************************************************
  2816
  2817     12  PB-COMMON-ERRORS.
  2818         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2819                                           PIC S9(4)     COMP.
  2820
  2821******************************************************************
  2822*                                copy ERCPNDM.
  2823******************************************************************
  2824*                                                                *
  2825*                                                                *
  2826*                            ERCPNDM                             *
  2827*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2828*                            VMOD=2.003                          *
  2829*                                                                *
  2830*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2831*                                                                *
  2832*   FILE TYPE = VSAM,KSDS                                        *
  2833*   RECORD SIZE = 374   RECFORM = FIX                            *
  2834*                                                                *
  2835*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2836*   ALTERNATE PATH    = NOT USED                                 *
  2837*                                                                *
  2838*   LOG = YES                                                    *
  2839*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2840******************************************************************
  2841*                   C H A N G E   L O G
  2842*
  2843* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2844*-----------------------------------------------------------------
  2845*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2846* EFFECTIVE    NUMBER
  2847*-----------------------------------------------------------------
  2848* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2849* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2850* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2851******************************************************************
  2852
  2853 01  PENDING-MAILING-DATA.
  2854     12  PM-RECORD-ID                      PIC XX.
  2855         88  VALID-MA-ID                       VALUE 'PM'.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  51
* EL202.cbl
  2856
  2857     12  PM-CONTROL-PRIMARY.
  2858         16  PM-COMPANY-CD                 PIC X.
  2859         16  PM-ENTRY-BATCH                PIC X(6).
  2860         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2861         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2862
  2863     12  FILLER                            PIC X(14).
  2864
  2865     12  PM-ACCESS-CONTROL.
  2866         16  PM-SOURCE-SYSTEM              PIC XX.
  2867             88  PM-FROM-CREDIT                VALUE 'CR'.
  2868             88  PM-FROM-VSI                   VALUE 'VS'.
  2869             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2870             88  PM-FROM-OTHER                 VALUE 'OT'.
  2871         16  PM-RECORD-ADD-DT              PIC XX.
  2872         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2873         16  PM-LAST-MAINT-DT              PIC XX.
  2874         16  PM-LAST-MAINT-BY              PIC XXXX.
  2875         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2876
  2877     12  PM-PROFILE-INFO.
  2878         16  PM-QUALIFY-CODE-1             PIC XX.
  2879         16  PM-QUALIFY-CODE-2             PIC XX.
  2880         16  PM-QUALIFY-CODE-3             PIC XX.
  2881         16  PM-QUALIFY-CODE-4             PIC XX.
  2882         16  PM-QUALIFY-CODE-5             PIC XX.
  2883
  2884         16  PM-INSURED-LAST-NAME          PIC X(15).
  2885         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2886         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2887         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2888         16  PM-INSURED-BIRTH-DT           PIC XX.
  2889         16  PM-INSURED-SEX                PIC X.
  2890             88  PM-SEX-MALE                   VALUE 'M'.
  2891             88  PM-SEX-FEMALE                 VALUE 'F'.
  2892         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2893
  2894         16  PM-ADDRESS-CORRECTED          PIC X.
  2895         16  PM-JOINT-BIRTH-DT             PIC XX.
  2896*        16  FILLER                        PIC X(12).
  2897
  2898         16  PM-ADDRESS-LINE-1             PIC X(30).
  2899         16  PM-ADDRESS-LINE-2             PIC X(30).
  2900         16  PM-CITY-STATE.
  2901             20  PM-CITY                   PIC X(28).
  2902             20  PM-STATE                  PIC XX.
  2903         16  PM-ZIP.
  2904             20  PM-ZIP-CODE.
  2905                 24  PM-ZIP-1              PIC X.
  2906                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2907                 24  FILLER                PIC X(4).
  2908             20  PM-ZIP-PLUS4              PIC X(4).
  2909         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2910             20  PM-CAN-POST1              PIC XXX.
  2911             20  PM-CAN-POST2              PIC XXX.
  2912             20  FILLER                    PIC XXX.
  2913
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  52
* EL202.cbl
  2914         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2915
  2916         16  FILLER                        PIC X(03).
  2917
  2918     12  PM-CRED-BENE-INFO.
  2919         16  PM-CRED-BENE-NAME             PIC X(25).
  2920         16  PM-CRED-BENE-ADDR             PIC X(30).
  2921         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2922         16  PM-CRED-BENE-CTYST.
  2923             20  PM-CRED-BENE-CITY         PIC X(28).
  2924             20  PM-CRED-BENE-STATE        PIC XX.
  2925         16  PM-CRED-BENE-ZIP.
  2926             20  PM-CB-ZIP-CODE.
  2927                 24  PM-CB-ZIP-1           PIC X.
  2928                     88  PM-CB-CANADIAN-POST-CODE
  2929                                  VALUE 'A' THRU 'Z'.
  2930                 24  FILLER                PIC X(4).
  2931             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2932         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2933             20  PM-CB-CAN-POST1           PIC XXX.
  2934             20  PM-CB-CAN-POST2           PIC XXX.
  2935             20  FILLER                    PIC XXX.
  2936     12  PM-POST-CARD-MAIL-DATA.
  2937         16  PM-MAIL-DATA OCCURS 7.
  2938             20  PM-MAIL-TYPE              PIC X.
  2939                 88  PM-12MO-MAILING           VALUE '1'.
  2940                 88  PM-EXP-MAILING            VALUE '2'.
  2941             20  PM-MAIL-STATUS            PIC X.
  2942                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2943                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2944                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2945             20  PM-MAIL-DATE              PIC XX.
  2946     12  FILLER                            PIC XX.
  2947     12  FILLER                            PIC X(12).
  2948*    12  FILLER                            PIC X(30).
  2949
  2950******************************************************************
  2951 01  w-doctoken                  pic x(16).
  2952 01  BATCH-TO-PROCESS.
  2953     05  EDIT-COMPANY-CD         PIC X       VALUE LOW-VALUES.
  2954     05  EDIT-BATCH              PIC X(6)    VALUE SPACES.
  2955     05  EDIT-COMPANY-ID         PIC XXX     VALUE SPACES.
  2956     05  EDIT-RESTART-BATCH      PIC X(6)    VALUE SPACES.
  2957 01 output-data.
  2958    05  filler                   pic x(6) value "TITLE=".
  2959    05  output-title             pic x(26) value 'Check Posting'.
  2960    05  filler                   pic x(8) value "&COMPID=".
  2961    05  out-comp-id              pic xxx.
  2962    05  filler                   pic x(5) value "&MSG=".
  2963    05  output-msg               pic x(50).
  2964****************************************************************
  2965*
  2966* Copyright (c) 2007 by Clerity Solutions, Inc.
  2967* All rights reserved.
  2968*
  2969****************************************************************
  2970 01  DFHEIV.
  2971   02  DFHEIV0               PIC X(35).
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  53
* EL202.cbl
  2972   02  DFHEIV1               PIC X(08).
  2973   02  DFHEIV2               PIC X(08).
  2974   02  DFHEIV3               PIC X(08).
  2975   02  DFHEIV4               PIC X(06).
  2976   02  DFHEIV5               PIC X(04).
  2977   02  DFHEIV6               PIC X(04).
  2978   02  DFHEIV7               PIC X(02).
  2979   02  DFHEIV8               PIC X(02).
  2980   02  DFHEIV9               PIC X(01).
  2981   02  DFHEIV10              PIC S9(7) COMP-3.
  2982   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2983   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2984   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2985   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2986   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2987   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2988   02  DFHEIV17              PIC X(04).
  2989   02  DFHEIV18              PIC X(04).
  2990   02  DFHEIV19              PIC X(04).
  2991   02  DFHEIV20              USAGE IS POINTER.
  2992   02  DFHEIV21              USAGE IS POINTER.
  2993   02  DFHEIV22              USAGE IS POINTER.
  2994   02  DFHEIV23              USAGE IS POINTER.
  2995   02  DFHEIV24              USAGE IS POINTER.
  2996   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2997   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2998   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2999   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3000   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3001   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3002   02  FILLER                PIC X(02).
  3003   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3004   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3005   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3006   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3007   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3008 LINKAGE  SECTION.
  3009*****************************************************************
  3010*                                                               *
  3011* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3012* All rights reserved.                                          *
  3013*                                                               *
  3014*****************************************************************
  3015 01  dfheiblk.
  3016     02  eibtime          pic s9(7) comp-3.
  3017     02  eibdate          pic s9(7) comp-3.
  3018     02  eibtrnid         pic x(4).
  3019     02  eibtaskn         pic s9(7) comp-3.
  3020     02  eibtrmid         pic x(4).
  3021     02  dfheigdi         pic s9(4) comp.
  3022     02  eibcposn         pic s9(4) comp.
  3023     02  eibcalen         pic s9(4) comp.
  3024     02  eibaid           pic x(1).
  3025     02  eibfiller1       pic x(1).
  3026     02  eibfn            pic x(2).
  3027     02  eibfiller2       pic x(2).
  3028     02  eibrcode         pic x(6).
  3029     02  eibfiller3       pic x(2).
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  54
* EL202.cbl
  3030     02  eibds            pic x(8).
  3031     02  eibreqid         pic x(8).
  3032     02  eibrsrce         pic x(8).
  3033     02  eibsync          pic x(1).
  3034     02  eibfree          pic x(1).
  3035     02  eibrecv          pic x(1).
  3036     02  eibsend          pic x(1).
  3037     02  eibatt           pic x(1).
  3038     02  eibeoc           pic x(1).
  3039     02  eibfmh           pic x(1).
  3040     02  eibcompl         pic x(1).
  3041     02  eibsig           pic x(1).
  3042     02  eibconf          pic x(1).
  3043     02  eiberr           pic x(1).
  3044     02  eibrldbk         pic x(1).
  3045     02  eiberrcd         pic x(4).
  3046     02  eibsynrb         pic x(1).
  3047     02  eibnodat         pic x(1).
  3048     02  eibfiller5       pic x(2).
  3049     02  eibresp          pic 9(09) comp.
  3050     02  eibresp2         pic 9(09) comp.
  3051     02  dfheigdj         pic s9(4) comp.
  3052     02  dfheigdk         pic s9(4) comp.
  3053 01  DFHCOMMAREA                     PIC X(1024).
  3054 01  var  pic x(30).
  3055 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  3056 0000-DFHEXIT SECTION.
  3057     MOVE '9#                    $   ' TO DFHEIV0.
  3058     MOVE 'EL202' TO DFHEIV1.
  3059     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3060***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3061***                                                            ***
  3062***                                                We don't    ***
  3063***  have any form fields to browse through, we are getting    ***
  3064***  the information we need through the variables that are    ***
  3065***  included in the URL. These variables are retrieved by     ***
  3066***  the           exec cics web extract                       ***
  3067***                   querystring  (data-value)                ***
  3068***                   querystrlen  (data-value)                ***
  3069***                end-exec                                    ***
  3070***  BTW, you must provide the length, it isn't passed to you. ***
  3071***  Allow for extra on the length or you will get a length    ***
  3072***  error instead of just truncation.                         ***
  3073***                                                            ***
  3074***  This program is expecting                                 ***
  3075*** http://logictest:5002/cics/cwba/EL202?comp=DCC&remit=00001 ***
  3076***http://slunikix:7001/cics/cwba/EL202?comp=DCC&remit=0000000001*
  3077***                                                            ***
  3078***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3079     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  3080     string ws-fn-hours ws-fn-minutes ws-fn-seconds
  3081        delimited by size into ws-work-time-a
  3082     end-string
  3083     string ws-fn-mo     '/'
  3084            ws-fn-da     '/'
  3085            ws-fn-ccyr
  3086        delimited by size into ws-status-date
  3087     end-string
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  55
* EL202.cbl
  3088     move ws-fn-cymd             to dc-greg-date-cymd
  3089     move 'L'                    to dc-option-code
  3090     perform 9700-date-convert   thru 9700-exit
  3091     if no-conversion-error
  3092        move dc-bin-date-1       to ws-bin-current-dt
  3093     else
  3094        display ' error current dt invalid ' dc-error-code
  3095     end-if
  3096     set P to address of KIXSYS
  3097     CALL "getenv" using by value P returning var-ptr
  3098     if var-ptr = null then
  3099        display ' kixsys not set '
  3100     else
  3101        set address of var to var-ptr
  3102        move 0 to env-var-len
  3103        inspect var tallying env-var-len
  3104          for characters before X'00'
  3105        unstring var (1:env-var-len) delimited by '/'
  3106           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  3107              WS-KIX-SYS
  3108        end-unstring
  3109     end-if
  3110
  3111* exec cics web extract
  3112*       querystring  (ws-qry-string)
  3113*       querystrlen  (ws-qrystr-len)
  3114*    end-exec
  3115*    MOVE 'X0  QL                .   #00003013' TO DFHEIV0
  3116     MOVE X'58302020514C202020202020' TO DFHEIV0(1:12)
  3117     MOVE X'202020202020202020202E20' TO DFHEIV0(13:12)
  3118     MOVE X'2020233030303033303133' TO DFHEIV0(25:11)
  3119     CALL 'kxdfhei1' USING DFHEIV0,
  3120           DFHEIV99,
  3121           DFHEIV99,
  3122           ws-qry-string,
  3123           ws-qrystr-len,
  3124           DFHEIV99,
  3125           DFHEIV99,
  3126           DFHEIV99,
  3127           DFHEIV99,
  3128           DFHEIV99,
  3129           DFHEIV99,
  3130           DFHEIV99,
  3131           DFHEIV99,
  3132           DFHEIV99
  3133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3134     display ' qry string ' ws-qry-string
  3135     display ' gry len    ' ws-qrystr-len
  3136     move ws-qry-string (6:3)    to ws-comp-id
  3137     move ws-qry-string (16:10)  to ws-var-alpha
  3138     move zeros                  to ws-remit-id-a
  3139     move +10                    to o1
  3140     perform varying i1 from +10 by -1 until i1 < +1
  3141        if ws-var-alpha (i1:1) numeric
  3142           move ws-var-alpha (i1:1) to ws-remit-id-a (o1:1)
  3143           subtract +1 from o1
  3144        end-if
  3145     end-perform
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  56
* EL202.cbl
  3146     move 'Successful Run   '    to output-msg
  3147     move ws-comp-id             to elcntl-key
  3148     move '1'                    to elcntl-rec-type
  3149     move +0                     to elcntl-seq
  3150
  3151* exec cics read
  3152*       dataset  ('ELCNTL')
  3153*       into     (control-file)
  3154*       ridfld   (elcntl-key)
  3155*       resp     (ws-response)
  3156*    end-exec
  3157     MOVE LENGTH OF
  3158      control-file
  3159       TO DFHEIV11
  3160     MOVE 'ELCNTL' TO DFHEIV1
  3161*    MOVE '&"IL       E          (  N#00003033' TO DFHEIV0
  3162     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3163     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3164     MOVE X'204E233030303033303333' TO DFHEIV0(25:11)
  3165     CALL 'kxdfhei1' USING DFHEIV0,
  3166           DFHEIV1,
  3167           control-file,
  3168           DFHEIV11,
  3169           elcntl-key,
  3170           DFHEIV99,
  3171           DFHEIV99,
  3172           DFHEIV99
  3173     MOVE EIBRESP  TO ws-response
  3174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3175     if resp-normal
  3176        display ' good cntl read '
  3177        move cf-cr-month-end-dt  to ws-bin-eom-dt
  3178        move cf-company-cd       to ws-comp-cd
  3179     else
  3180        move 'Company Rec not found ' to output-msg
  3181        display ' error elcntl read ' ws-response ' '
  3182           elcntl-key (1:8)
  3183        go to 0000-return
  3184     end-if
  3185     perform 0010-connect-db     thru 0010-exit
  3186     perform 0020-process-remit  thru 0020-exit
  3187     perform 0050-open-cursor    thru 0050-exit
  3188     perform 0060-process-input  thru 0060-exit
  3189     perform 0130-start-edit     thru 0130-exit
  3190     perform 0226-update-remit-table
  3191                                 thru 0226-exit
  3192     perform 0225-commit-work    thru 0225-exit
  3193     .
  3194 0000-return.
  3195     if connected-to-db
  3196        perform 0230-disconnect  thru 0230-exit
  3197     end-if
  3198     perform 0220-send-form      thru 0220-exit
  3199     if rollback-needed
  3200        display ' executing roll back '
  3201        perform 0005-rollback    thru 0005-exit
  3202*       CALL 'kixvsam' USING ROLL-BACK
  3203*       exec cics syncpoint
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  57
* EL202.cbl
  3204*          rollback
  3205*          resp (ws-response)
  3206*       end-exec
  3207*       display ' rollback resp ' ws-response
  3208     end-if
  3209
  3210* exec cics
  3211*       return
  3212*    end-exec
  3213*    MOVE '.(                    ''   #00003073' TO DFHEIV0
  3214     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3215     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3216     MOVE X'2020233030303033303733' TO DFHEIV0(25:11)
  3217     CALL 'kxdfhei1' USING DFHEIV0,
  3218           DFHEIV99,
  3219           DFHEIV99,
  3220           DFHEIV99,
  3221           DFHEIV99,
  3222           DFHEIV99,
  3223           DFHEIV99
  3224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3225
  3226* goback
  3227
  3228     MOVE '9%                    "   ' TO DFHEIV0
  3229     MOVE 'EL202' TO DFHEIV1
  3230     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3231     goback
  3232     .
  3233 0005-rollback.
  3234     if ws-rb-erpyaj-key not = spaces
  3235        move ws-rb-erpyaj-key    to py-control-primary
  3236
  3237* EXEC CICS DELETE
  3238*          DATASET  ('ERPYAJ')
  3239*          RIDFLD   (PY-CONTROL-PRIMARY)
  3240*          resp     (ws-response)
  3241*       END-EXEC
  3242     MOVE 'ERPYAJ' TO DFHEIV1
  3243*    MOVE '&(  R                 &  N#00003081' TO DFHEIV0
  3244     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3245     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3246     MOVE X'204E233030303033303831' TO DFHEIV0(25:11)
  3247     CALL 'kxdfhei1' USING DFHEIV0,
  3248           DFHEIV1,
  3249           PY-CONTROL-PRIMARY,
  3250           DFHEIV99,
  3251           DFHEIV99,
  3252           DFHEIV99
  3253     MOVE EIBRESP  TO ws-response
  3254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3255        if resp-normal
  3256           display ' good delete on erpyaj '
  3257        else
  3258           display ' bad delete on erpyaj ' ws-response
  3259        end-if
  3260     end-if
  3261     if ws-batch-no not = zeros
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  58
* EL202.cbl
  3262        move ws-comp-cd          to pb-company-cd
  3263        move ws-batch-no         to pb-entry-batch
  3264        move +0                  to pb-batch-seq-no
  3265                                    pb-batch-chg-seq-no
  3266
  3267* exec cics delete
  3268*          dataset   ('ERPNDB')
  3269*          ridfld    (pb-control-primary)
  3270*          keylength (7)
  3271*          generic
  3272*          resp     (ws-response)
  3273*       end-exec
  3274     MOVE 'ERPNDB' TO DFHEIV1
  3275     MOVE 7
  3276       TO DFHEIV11
  3277*    MOVE '&(  RKG               &  N#00003097' TO DFHEIV0
  3278     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  3279     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3280     MOVE X'204E233030303033303937' TO DFHEIV0(25:11)
  3281     CALL 'kxdfhei1' USING DFHEIV0,
  3282           DFHEIV1,
  3283           pb-control-primary,
  3284           DFHEIV11,
  3285           DFHEIV99,
  3286           DFHEIV99
  3287     MOVE EIBRESP  TO ws-response
  3288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3289        if resp-normal
  3290           display ' good delete on erpndb '
  3291        else
  3292           display ' bad delete on erpndp ' ws-response
  3293        end-if
  3294     end-if
  3295     if ws-batch-no not = zeros
  3296        move ws-comp-cd          to pm-company-cd
  3297        move ws-batch-no         to pm-entry-batch
  3298        move +0                  to pm-batch-seq-no
  3299                                    pm-batch-chg-seq-no
  3300
  3301* exec cics delete
  3302*          dataset   ('ERPNDM')
  3303*          ridfld    (pm-control-primary)
  3304*          keylength (7)
  3305*          generic
  3306*          resp     (ws-response)
  3307*       end-exec
  3308     MOVE 'ERPNDM' TO DFHEIV1
  3309     MOVE 7
  3310       TO DFHEIV11
  3311*    MOVE '&(  RKG               &  N#00003115' TO DFHEIV0
  3312     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  3313     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3314     MOVE X'204E233030303033313135' TO DFHEIV0(25:11)
  3315     CALL 'kxdfhei1' USING DFHEIV0,
  3316           DFHEIV1,
  3317           pm-control-primary,
  3318           DFHEIV11,
  3319           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  59
* EL202.cbl
  3320           DFHEIV99
  3321     MOVE EIBRESP  TO ws-response
  3322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3323        if resp-normal
  3324           display ' good delete on erpndm '
  3325        else
  3326           display ' bad delete on erpndm ' ws-response
  3327        end-if
  3328     end-if
  3329     .
  3330 0005-exit.
  3331     exit.
  3332 0010-CONNECT-DB.
  3333***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3334***                                                            ***
  3335***  Even though it's on ntcso2, CUConnect is the test DB      ***
  3336***  The production DB is ezLink_Prod.  The table names are    ***
  3337***  the same.                                                 ***
  3338***                                                            ***
  3339***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3340     move 'NTCSO2_CUConnect'     to svr
  3341     move 'sa'                   to usr
  3342     move 'ntcso2'               to pass
  3343     if ws-kix-myenv = 'cid1p'
  3344        move 'NTCSO2_ezLink_Prod' to svr
  3345        move 'sa'                to usr
  3346        move 'ntcso2'            to pass
  3347     end-if
  3348     string
  3349         usr delimited space
  3350         "." delimited size
  3351         pass delimited space into usr-pass
  3352     end-string
  3353     display ' About to connect to ' svr ' ' usr-pass
  3354     EXEC SQL
  3355        CONNECT TO :svr USER :usr-pass
  3356     END-EXEC
  3357     if sqlcode not = 0
  3358        display "Error: cannot connect to " svr
  3359        display sqlcode
  3360        display sqlerrmc
  3361        move 'Failed to connect to DB'
  3362                                 to output-msg
  3363        go to 0000-return
  3364     else
  3365        set connected-to-db to true
  3366        display ' Successful Connect ' sqlcode
  3367     end-if
  3368     .
  3369 0010-EXIT.
  3370     EXIT.
  3371 0020-process-remit.
  3372     perform 0030-get-tbl-row    thru 0030-exit
  3373     perform 0040-build-erpyaj   thru 0040-exit
  3374     .
  3375 0020-exit.
  3376     exit.
  3377 0030-get-tbl-row.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  60
* EL202.cbl
  3378***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3379***                                                            ***
  3380***  I'm only expecting one row so no cursor is declared       ***
  3381***                                                            ***
  3382***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3383     display ' about to get table row ' ws-remit-id
  3384     move ' '                    to ws-remit-sw
  3385*    exec sql
  3386*       SELECT
  3387*          RemitId,
  3388*          Carrier,
  3389*          Group,
  3390*          State,
  3391*          AccountNumber,
  3392*          Name,
  3393*          Addr1,
  3394*          Addr2,
  3395*          AddrCity,
  3396*          AddrState,
  3397*          AddrZIP,
  3398*          ResponsibleCarrier,
  3399*          ResponsibleNumber,
  3400*          LogicStatus,
  3401*          LogicStatusDate,
  3402*          Company,
  3403*          TotalPremium
  3404*       INTO
  3405*          :sql-py-RemitId,
  3406*          :sql-py-Carrier,
  3407*          :sql-py-Group,
  3408*          :sql-py-State,
  3409*          :sql-py-AccountNumber,
  3410*          :sql-py-Name,
  3411*          :sql-py-Addr1,
  3412*          :sql-py-Addr2,
  3413*          :sql-py-AddrCity,
  3414*          :sql-py-AddrState,
  3415*          :sql-py-AddrZIP,
  3416*          :sql-py-ResponsibleCarrier,
  3417*          :sql-py-ResponsibleNumber,
  3418*          :sql-py-LogicStatus,
  3419*          :sql-py-LogicStatusDate,
  3420*          :sql-py-company,
  3421*          :sql-py-tot-prem
  3422*       FROM
  3423*          CUC_Logic_Remittance
  3424*       WHERE
  3425*          RemitId = :ws-remit-id
  3426*    end-exec
  3427     exec sql
  3428        SELECT
  3429           CUC_Logic_Remittance.RemitId,
  3430           Carrier,
  3431           [Group],
  3432           [State],
  3433           AccountNumber,
  3434           Name,
  3435           Addr1,
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  61
* EL202.cbl
  3436           Addr2,
  3437           AddrCity,
  3438           AddrState,
  3439           AddrZIP,
  3440           ResponsibleCarrier,
  3441           ResponsibleNumber,
  3442           LogicStatus,
  3443           Company,
  3444           TotalPremium,
  3445           CUC_Remittance.IsACH
  3446        INTO
  3447           :sql-py-RemitId,
  3448           :sql-py-Carrier,
  3449           :sql-py-Group,
  3450           :sql-py-State,
  3451           :sql-py-AccountNumber,
  3452           :sql-py-Name,
  3453           :sql-py-Addr1,
  3454           :sql-py-Addr2,
  3455           :sql-py-AddrCity,
  3456           :sql-py-AddrState,
  3457           :sql-py-AddrZIP,
  3458           :sql-py-ResponsibleCarrier,
  3459           :sql-py-ResponsibleNumber,
  3460           :sql-py-LogicStatus,
  3461           :sql-py-company,
  3462           :sql-py-tot-prem,
  3463           :sql-is-ach
  3464        FROM
  3465           CUC_Logic_Remittance inner join CUC_Remittance on
  3466              CUC_Logic_Remittance.RemitId =
  3467                 CUC_Remittance.RemitId
  3468        WHERE
  3469           CUC_Logic_Remittance.RemitId = :ws-remit-id
  3470     end-exec
  3471     if sqlcode not = 0
  3472        set ws-remit-not-found   to true
  3473        move sqlcode             to ws-sql-code
  3474        move ws-sql-code         to ws-dis-sql-code
  3475        display ' dis sql code ' ws-dis-sql-code
  3476        display "Error: cannot read row "
  3477        display ' sql return code ' sqlcode
  3478        display ' sql err mess    ' sqlerrmc
  3479        move ' Remittance Not Found '
  3480                                 to output-msg
  3481        go to 0000-return
  3482     end-if
  3483     display ' good get on table ' sqlcode
  3484     if sql-py-LogicStatus = 2
  3485        move 'Remit previously processed '
  3486                                 to output-msg
  3487        go to 0000-return
  3488     end-if
  3489     .
  3490 0030-exit.
  3491     exit.
  3492 0040-build-erpyaj.
  3493     compute work-seq-no = ws-work-time * 3
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  62
* EL202.cbl
  3494     MOVE 'PY'                   TO pending-pay-adj
  3495     move zeros                  to py-file-seq-no
  3496                                    py-last-maint-hhmmss
  3497                                    py-entry-amt
  3498                                    py-check-que-control
  3499                                    py-check-que-sequence
  3500     move low-values             to py-last-maint-dt
  3501                                    py-credit-select-dt
  3502                                    py-credit-accept-dt
  3503                                    py-billed-date
  3504                                    py-reported-dt
  3505                                    py-input-dt
  3506                                    py-check-written-dt
  3507                                    py-ar-date
  3508                                    py-gl-date
  3509     MOVE cf-COMPANY-CD          TO PY-COMPANY-CD
  3510     MOVE sql-py-responsiblecarrier
  3511                                 TO PY-CARRIER
  3512     MOVE sql-py-group           TO PY-GROUPING
  3513     MOVE sql-py-responsiblenumber
  3514                                 TO PY-FIN-RESP
  3515     MOVE sql-py-accountnumber   TO PY-ACCOUNT
  3516     ADD +1                      TO WORK-SEQ-NO.
  3517     MOVE WORK-SEQ-NO            TO PY-FILE-SEQ-NO.
  3518     move 'R'                    to py-record-type
  3519     move 'E202'                 to py-last-maint-by
  3520     move ws-bin-current-dt      to py-last-maint-dt
  3521                                    py-input-dt
  3522     move ws-work-time           to py-last-maint-hhmmss
  3523*    move +20.00                 to py-entry-amt
  3524     move ws-bin-eom-dt          to py-credit-select-dt
  3525     move 'A'                    to py-ercomp-type
  3526     move sql-is-ach             to ws-bit
  3527     display ' bit comp ' ws-bit-comp
  3528     evaluate true
  3529        when (ws-comp-id = 'DCC')
  3530           and (py-carrier = '9')
  3531           and (ws-bit-comp = zeros)      *> ACH FALSE
  3532           move '2725040310'     to py-gl-account
  3533        when (ws-comp-id = 'DCC')
  3534           and (py-carrier = '7')
  3535           and (ws-bit-comp not = zeros)  *> ACH TRUE
  3536           move '1108121010'     to py-gl-account
  3537        when (ws-comp-id = 'DCC')
  3538           and (py-carrier = '9')
  3539           and (ws-bit-comp not = zeros)  *> ACH TRUE
  3540           move '1108121250'     to py-gl-account
  3541        when (ws-comp-id = 'CID')
  3542           and (ws-bit-comp not = zeros)  *> ACH TRUE
  3543           move '1108121010'     to py-gl-account
  3544        when (ws-comp-id = 'DCC')
  3545           move '1825013400'     to py-gl-account
  3546        when other
  3547           move '1825099050'     to py-gl-account
  3548     end-evaluate
  3549     if ws-bit-comp not = zeros     *>  ACH TRUE
  3550        move 'ACH'               to py-gl-comment
  3551     end-if
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  63
* EL202.cbl
  3552*    if ws-comp-id = 'CID'
  3553*       move '1825099050'        to py-gl-account
  3554*    else
  3555*       move '1825013400'        to py-gl-account
  3556*    end-if
  3557     move +11                    to s2
  3558     move zeros                  to ws-work-amt-alpha
  3559     perform varying s1 from +11 by -1 until s1 < +1
  3560        if sql-py-tot-prem (s1:1) numeric
  3561           move sql-py-tot-prem (s1:1)
  3562                                 to ws-work-amt-alpha (s2:1)
  3563           subtract +1 from s2
  3564        end-if
  3565     end-perform
  3566     display ' tot premium ' ws-work-amt-num
  3567     move ws-work-amt-num        to py-entry-amt
  3568     .
  3569 0040-write.
  3570     display ' about to write pyaj '
  3571
  3572* EXEC CICS WRITE
  3573*        DATASET  ('ERPYAJ')
  3574*        FROM     (PENDING-PAY-ADJ)
  3575*        RIDFLD   (PY-CONTROL-PRIMARY)
  3576*        resp     (ws-response)
  3577*    END-EXEC
  3578     MOVE LENGTH OF
  3579      PENDING-PAY-ADJ
  3580       TO DFHEIV11
  3581     MOVE 'ERPYAJ' TO DFHEIV1
  3582*    MOVE '&$ L                  ''  N#00003370' TO DFHEIV0
  3583     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3584     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3585     MOVE X'204E233030303033333730' TO DFHEIV0(25:11)
  3586     CALL 'kxdfhei1' USING DFHEIV0,
  3587           DFHEIV1,
  3588           PENDING-PAY-ADJ,
  3589           DFHEIV11,
  3590           PY-CONTROL-PRIMARY,
  3591           DFHEIV99,
  3592           DFHEIV99
  3593     MOVE EIBRESP  TO ws-response
  3594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3595     if resp-normal
  3596        move py-control-primary  to ws-rb-erpyaj-key
  3597        move 2                   to ws-status-code
  3598     else
  3599        if resp-duprec
  3600           add +1                to py-file-seq-no
  3601           go to 0040-write
  3602        else
  3603           move 3                to ws-status-code
  3604           move ws-response      to ws-display-response
  3605           move spaces           to ws-error-message
  3606           string ' Bad write on ERPYAJ FILE ' ws-display-response
  3607              delimited by size into ws-error-message
  3608           end-string
  3609           perform 0226-update-remit-table
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  64
* EL202.cbl
  3610                                 thru 0226-exit
  3611           perform 0225-commit-work
  3612                                 thru 0225-exit
  3613           go to 0000-return
  3614        end-if
  3615     end-if
  3616     .
  3617 0040-exit.
  3618     exit.
  3619 0050-open-cursor.
  3620*    display ' declare cursor ' ws-begin-dt ' ' ws-end-dt
  3621***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3622***                                                            ***
  3623***  The dates on the sql table have values in the time        ***
  3624***  so I convert it to a string and just use mm/dd/yyyy       ***
  3625***  to perform the comparison.                                ***
  3626***                                                            ***
  3627***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3628     EXEC SQL
  3629        DECLARE
  3630           remitcerts cursor for
  3631        SELECT
  3632           CertId,
  3633           RemitId,
  3634           CertNumber,
  3635           EffectiveDate,
  3636           FirstPaymentDate,
  3637           FirstName,
  3638           LastName,
  3639           CashIndicator,
  3640           LivesCovered,
  3641           LfBenCode,
  3642           LfTerm,
  3643           LfBenefit,
  3644           LfPremium,
  3645           AhBenCode,
  3646           AhTerm,
  3647           AhBenefit,
  3648           AhPremium,
  3649           ErrorMessage
  3650        FROM
  3651           CUC_Logic_Remittance_Cert
  3652        WHERE
  3653           RemitId = :ws-remit-id
  3654     end-exec
  3655     if sqlcode not = 0
  3656        display "Error: cannot declare cursor "
  3657        display ' sql retrun code ' sqlcode
  3658        display ' sql err mess    ' sqlerrmc
  3659        move ' Error declaring cursor '
  3660                                 to output-msg
  3661        move 3                   to ws-status-code
  3662        move sqlcode             to ws-display-response
  3663        move spaces              to ws-error-message
  3664        string ' Error declaring cursor   ' ws-display-response
  3665           delimited by size into ws-error-message
  3666        end-string
  3667        perform 0226-update-remit-table
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  65
* EL202.cbl
  3668                                 thru 0226-exit
  3669        perform 0225-commit-work thru 0225-exit
  3670        go to 0000-return
  3671     end-if
  3672     display ' good declare cursor ' ws-remit-id
  3673     EXEC SQL
  3674        open remitcerts
  3675     END-EXEC
  3676     if sqlcode not = 0
  3677        display "Error: cannot open cursor "
  3678        display ' sql retrun code ' sqlcode
  3679        display ' sql err mess    ' sqlerrmc
  3680        move ' Error opening cursor '
  3681                                 to output-msg
  3682        move 3                   to ws-status-code
  3683        move sqlcode             to ws-display-response
  3684        move spaces              to ws-error-message
  3685        string ' Error openning cursor    ' ws-display-response
  3686           delimited by size into ws-error-message
  3687        end-string
  3688        perform 0226-update-remit-table
  3689                                 thru 0226-exit
  3690        perform 0225-commit-work thru 0225-exit
  3691        go to 0000-return
  3692     end-if
  3693     display ' good open cursor ' ws-remit-id
  3694     .
  3695 0050-exit.
  3696     exit.
  3697 0060-process-input.
  3698     perform until sqlcode not = 0
  3699        EXEC SQL
  3700           fetch remitcerts into
  3701              :sql-pb-CertId,
  3702              :sql-pb-RemitId,
  3703              :sql-pb-CertNumber,
  3704              :sql-pb-EffectiveDate,
  3705              :sql-pb-FirstPaymentDate,
  3706              :sql-pb-FirstName,
  3707              :sql-pb-LastName,
  3708              :sql-pb-CashIndicator,
  3709              :sql-pb-LivesCovered,
  3710              :sql-pb-LfBenCode,
  3711              :sql-pb-LfTerm,
  3712              :sql-pb-LfBenefit,
  3713              :sql-pb-LfPremium,
  3714              :sql-pb-AhBenCode,
  3715              :sql-pb-AhTerm,
  3716              :sql-pb-AhBenefit,
  3717              :sql-pb-AhPremium,
  3718              :sql-pb-ErrorMessage
  3719        END-EXEC
  3720        if sqlcode = 0
  3721           perform 0070-bld-erpndb
  3722                                 thru 0070-exit
  3723           perform 0110-write-erpndb
  3724                                 thru 0110-exit
  3725           perform 0120-write-erpndm
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  66
* EL202.cbl
  3726                                 thru 0120-exit
  3727        else
  3728           if sqlcode not = 0 and 100
  3729              display "Error: cannot fetch row "
  3730              display ' sql return code ' sqlcode
  3731              display ' sql err mess    ' sqlerrmc
  3732              move ' Error fetching cursor '
  3733                                 to output-msg
  3734              set rollback-needed to true
  3735              move 3             to ws-status-code
  3736              move sqlcode       to ws-display-response
  3737              move spaces        to ws-error-message
  3738              string ' Error during fetch cursor '
  3739                ws-display-response
  3740                 delimited by size into ws-error-message
  3741              end-string
  3742              perform 0226-update-remit-table
  3743                                 thru 0226-exit
  3744              perform 0225-commit-work
  3745                                 thru 0225-exit
  3746              go to 0000-return
  3747           end-if
  3748        end-if
  3749     end-perform
  3750     if sqlcode = 100
  3751        display ' Normal end of record set '
  3752        perform 0100-build-batch-hdr
  3753                                 thru 0100-exit
  3754        perform 0110-write-erpndb
  3755                                 thru 0110-exit
  3756     end-if
  3757     EXEC SQL
  3758         close remitcerts
  3759     END-EXEC
  3760     if sqlcode not = 0
  3761        display "Error: cannot close cursor "
  3762        display ' sql retrun code ' sqlcode
  3763        display ' sql err mess    ' sqlerrmc
  3764     end-if
  3765     .
  3766 0060-exit.
  3767     exit.
  3768 0070-bld-erpndb.
  3769     if ws-batch-no-n = zeros
  3770        perform 0080-get-batch-no thru 0080-exit
  3771     end-if
  3772     move ws-init-erpndb-rec     to pending-business
  3773     move ws-batch-no            to pb-entry-batch
  3774                                    pb-original-entry-batch
  3775                                    pb-csr-entry-batch
  3776     add +1 to ws-batch-seq-no
  3777     move ws-batch-seq-no        to pb-batch-seq-no
  3778                                    pb-original-seq-no
  3779                                    pb-csr-batch-seq-no
  3780     move sql-pb-certnumber      to pb-cert-no
  3781     string sql-pb-effectivedate (1:4)
  3782            sql-pb-effectivedate (6:2)
  3783            sql-pb-effectivedate (9:2)
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  67
* EL202.cbl
  3784        delimited by size into dc-greg-date-cymd-r
  3785     end-string
  3786     move 'L'                    to dc-option-code
  3787     perform 9700-date-convert   thru 9700-exit
  3788     if no-conversion-error
  3789        move dc-bin-date-1       to pb-cert-eff-dt
  3790     else
  3791        display ' error cvtdte eff dt ' sql-pb-effectivedate
  3792           ' ' dc-error-code
  3793     end-if
  3794     move function upper-case(sql-pb-lastname)
  3795                                 to pb-i-insured-last-name
  3796     move function upper-case(sql-pb-firstname)
  3797                                 to pb-i-insured-first-name
  3798     if sql-pb-lfbencode = zeros
  3799        move spaces              to sql-pb-lfbencode
  3800     end-if
  3801     move sql-pb-lfbencode       to pb-i-life-benefit-cd
  3802                                    pb-i-lf-input-cd
  3803     if pb-i-life-benefit-cd = spaces
  3804        move zeros               to pb-i-life-benefit-cd
  3805     end-if
  3806     move sql-pb-lfterm          to pb-i-lf-term
  3807     move 'L'                    to pb-ah-override-l1
  3808     move +11                    to s2
  3809     move zeros                  to ws-work-amt-alpha
  3810     perform varying s1 from +12 by -1 until s1 < +1
  3811        if sql-pb-lfbenefit (s1:1) numeric
  3812           move sql-pb-lfbenefit (s1:1)
  3813                                 to ws-work-amt-alpha (s2:1)
  3814           subtract +1 from s2
  3815        end-if
  3816     end-perform
  3817     display ' lf benefit  ' ws-work-amt-num
  3818     move ws-work-amt-num        to pb-i-lf-benefit-amt
  3819     move +11                    to s2
  3820     move zeros                  to ws-work-amt-alpha
  3821     perform varying s1 from +10 by -1 until s1 < +1
  3822        if sql-pb-lfpremium (s1:1) numeric
  3823           move sql-pb-lfpremium (s1:1)
  3824                                 to ws-work-amt-alpha (s2:1)
  3825           subtract +1 from s2
  3826        end-if
  3827     end-perform
  3828     display ' lf premium  ' ws-work-amt-num
  3829     move ws-work-amt-num        to pb-i-lf-premium-amt
  3830     if sql-pb-ahbencode = zeros
  3831        move spaces              to sql-pb-ahbencode
  3832     end-if
  3833     move sql-pb-ahbencode       to pb-i-ah-benefit-cd
  3834                                    pb-i-ah-input-cd
  3835     if pb-i-ah-benefit-cd = spaces
  3836        move zeros               to pb-i-ah-benefit-cd
  3837     end-if
  3838     move 'A'                    to pb-ah-override-l1
  3839     move sql-pb-ahterm          to pb-i-ah-term
  3840     move +11                    to s2
  3841     move zeros                  to ws-work-amt-alpha
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  68
* EL202.cbl
  3842     perform varying s1 from +10 by -1 until s1 < +1
  3843        if sql-pb-ahbenefit (s1:1) numeric
  3844           move sql-pb-ahbenefit (s1:1)
  3845                                 to ws-work-amt-alpha (s2:1)
  3846           subtract +1 from s2
  3847        end-if
  3848     end-perform
  3849     display ' ah benefit  ' ws-work-amt-num
  3850     move ws-work-amt-num        to pb-i-ah-benefit-amt
  3851     move +11                    to s2
  3852     move zeros                  to ws-work-amt-alpha
  3853     perform varying s1 from +10 by -1 until s1 < +1
  3854        if sql-pb-ahpremium (s1:1) numeric
  3855           move sql-pb-ahpremium (s1:1)
  3856                                 to ws-work-amt-alpha (s2:1)
  3857           subtract +1 from s2
  3858        end-if
  3859     end-perform
  3860     display ' ah premium  ' ws-work-amt-num
  3861     move ws-bin-eom-dt          to pb-credit-select-dt
  3862     move ws-work-amt-num        to pb-i-ah-premium-amt
  3863     move sql-pb-LivesCovered    to pb-i-lives
  3864     move sql-pb-CashIndicator   to pb-i-entry-status
  3865                                    pb-batch-entry
  3866     compute ws-lf-iss-premium =
  3867        ws-lf-iss-premium + pb-i-lf-premium-amt
  3868     compute ws-ah-iss-premium =
  3869        ws-ah-iss-premium + pb-i-ah-premium-amt
  3870     move 'A'                    to pb-force-code
  3871     compute ws-iss-cnt = ws-iss-cnt + +1
  3872     move pb-batch-seq-no           to ws-highest-seq-no
  3873*    display ' sql-pb-CertId           ' sql-pb-CertId
  3874*    display ' sql-pb-RemitId          ' sql-pb-RemitId
  3875*    display ' sql-pb-CertNumber       ' sql-pb-CertNumber
  3876*    display ' sql-pb-EffectiveDate    ' sql-pb-EffectiveDate
  3877*    display ' sql-pb-FirstPaymentDate ' sql-pb-FirstPaymentDate
  3878*    display ' sql-pb-FirstName        ' sql-pb-FirstName
  3879*    display ' sql-pb-LastName         ' sql-pb-LastName
  3880*    display ' sql-pb-CashIndicator    ' sql-pb-CashIndicator
  3881*    display ' sql-pb-LivesCovered     ' sql-pb-LivesCovered
  3882*    display ' sql-pb-LfBenCode        ' sql-pb-LfBenCode
  3883*    display ' sql-pb-LfTerm           ' sql-pb-LfTerm
  3884*    display ' sql-pb-LfBenefit        ' sql-pb-LfBenefit
  3885*    display ' sql-pb-LfPremium        ' sql-pb-LfPremium
  3886*    display ' sql-pb-AhBenCode        ' sql-pb-AhBenCode
  3887*    display ' sql-pb-AhTerm           ' sql-pb-AhTerm
  3888*    display ' sql-pb-AhBenefit        ' sql-pb-AhBenefit
  3889*    display ' sql-pb-AhPremium        ' sql-pb-AhPremium
  3890*    display ' sql-pb-ErrorMessage     ' sql-pb-ErrorMessage
  3891     .
  3892 0070-exit.
  3893     exit.
  3894 0080-get-batch-no.
  3895     perform 0090-init-erpndb    thru 0090-exit
  3896     perform 0240-init-erpndm    thru 0240-exit
  3897     move ws-comp-id             to elcntl-key
  3898     move '1'                    to elcntl-rec-type
  3899     move +0                     to elcntl-seq
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  69
* EL202.cbl
  3900
  3901* exec cics read update
  3902*       dataset  ('ELCNTL')
  3903*       into     (control-file)
  3904*       ridfld   (elcntl-key)
  3905*       resp     (ws-response)
  3906*    end-exec
  3907     MOVE LENGTH OF
  3908      control-file
  3909       TO DFHEIV11
  3910     MOVE 'ELCNTL' TO DFHEIV1
  3911*    MOVE '&"IL       EU         (  N#00003681' TO DFHEIV0
  3912     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3913     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3914     MOVE X'204E233030303033363831' TO DFHEIV0(25:11)
  3915     CALL 'kxdfhei1' USING DFHEIV0,
  3916           DFHEIV1,
  3917           control-file,
  3918           DFHEIV11,
  3919           elcntl-key,
  3920           DFHEIV99,
  3921           DFHEIV99,
  3922           DFHEIV99
  3923     MOVE EIBRESP  TO ws-response
  3924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3925     if resp-normal
  3926        add +1                   to cf-last-batch-no
  3927        move cf-last-batch-no    to ws-batch-no-n
  3928        move +0                  to ws-batch-seq-no
  3929
  3930* exec cics rewrite
  3931*          dataset  ('ELCNTL')
  3932*          from     (control-file)
  3933*          resp     (ws-response)
  3934*       end-exec
  3935     MOVE LENGTH OF
  3936      control-file
  3937       TO DFHEIV11
  3938     MOVE 'ELCNTL' TO DFHEIV1
  3939*    MOVE '&& L                  %  N#00003691' TO DFHEIV0
  3940     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3941     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3942     MOVE X'204E233030303033363931' TO DFHEIV0(25:11)
  3943     CALL 'kxdfhei1' USING DFHEIV0,
  3944           DFHEIV1,
  3945           control-file,
  3946           DFHEIV11,
  3947           DFHEIV99
  3948     MOVE EIBRESP  TO ws-response
  3949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3950        if not resp-normal
  3951           display ' bad rewrite on cntl - batch no '
  3952              ws-batch-no-n
  3953           move ' Error rewrite ELCNTL '
  3954                                 to output-msg
  3955           set rollback-needed   to true
  3956           move ws-response         to ws-display-response
  3957           move spaces              to ws-error-message
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  70
* EL202.cbl
  3958           string ' Bad rewrite  ELCNTL FILE '
  3959              ws-display-response
  3960              delimited by size into ws-error-message
  3961           end-string
  3962           move 3                to ws-status-code
  3963           perform 0226-update-remit-table
  3964                                 thru 0226-exit
  3965           perform 0225-commit-work
  3966                                 thru 0225-exit
  3967           go to 0000-return
  3968        end-if
  3969     else
  3970        display ' bad read upde on cntl - batch no '
  3971              elcntl-key (1:4)
  3972     end-if
  3973     .
  3974 0080-exit.
  3975     exit.
  3976 0090-init-erpndb.
  3977     move 'PB'                   to pending-business
  3978     INITIALIZE PB-issue-RECORD
  3979     initialize pb-record-status
  3980     move low-values             to pb-i-lf-expire-dt
  3981                                    pb-i-ah-expire-dt
  3982                                    pb-i-1st-pmt-dt
  3983                                    pb-i-last-add-on-dt
  3984                                    pb-i-birthday
  3985                                    pb-i-joint-birthday
  3986                                    pb-credit-select-dt
  3987                                    pb-credit-accept-dt
  3988                                    pb-billed-dt
  3989                                    pb-input-dt
  3990                                    pb-acct-eff-dt
  3991                                    pb-acct-exp-dt
  3992                                    pb-confirmation-rept-dt
  3993                                    pb-ga-bill-dt (1)
  3994                                    pb-ga-bill-dt (2)
  3995                                    pb-ga-bill-dt (3)
  3996                                    pb-ga-bill-dt (4)
  3997                                    pb-ga-bill-dt (5)
  3998     move ws-comp-id             to pb-company-id
  3999     move ws-comp-cd             to pb-company-cd
  4000                                    pb-company-cd-a1
  4001                                    pb-original-company-cd
  4002                                    pb-csr-company-cd
  4003     move zeros                  to pb-chg-count
  4004                                    pb-batch-chg-seq-no
  4005                                    pb-alt-chg-seq-no
  4006                                    pb-original-chg-seq-no
  4007                                    pb-csr-batch-chg-seq-no
  4008                                    pb-i-rate-deviation-lf
  4009                                    pb-i-rate-deviation-ah
  4010                                    pb-no-of-errors
  4011                                    pb-lf-billed-amts
  4012                                    pb-ah-billed-amts
  4013     move sql-py-carrier         to pb-carrier
  4014                                    pb-sv-carrier
  4015     move sql-py-group           to pb-grouping
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  71
* EL202.cbl
  4016                                    pb-sv-grouping
  4017     move sql-py-state           to pb-state
  4018                                    pb-sv-state
  4019     move sql-py-accountnumber   to pb-account
  4020     move '1'                    to pb-record-type
  4021     move 'E202'                 to pb-last-maint-by
  4022                                    pb-input-by
  4023     move ws-bin-current-dt      to pb-last-maint-dt
  4024                                    pb-input-dt
  4025     move ws-work-time           to pb-last-maint-hhmmss
  4026     perform varying s1 from +1 by +1 until s1 > +10
  4027        move +0                  to pb-common-error (s1)
  4028     end-perform
  4029     move pending-business       to ws-init-erpndb-rec
  4030     .
  4031 0090-exit.
  4032     exit.
  4033 0100-BUILD-BATCH-HDR.
  4034     display ' about to build batch hdr '
  4035     move ws-init-erpndb-rec     to pending-business
  4036     move ws-batch-no            to pb-entry-batch
  4037                                    pb-original-entry-batch
  4038                                    pb-csr-entry-batch
  4039                                    pb-cert-no
  4040     add +1 to ws-batch-seq-no
  4041     move 9999                   to pb-batch-seq-no
  4042                                    pb-original-seq-no
  4043                                    pb-csr-batch-seq-no
  4044     move high-values            to pb-cert-eff-dt
  4045     move zeros                  to PB-B-LF-ISS-PRM-REMITTED
  4046                                    PB-B-LF-ISS-PRM-ENTERED
  4047                                    PB-B-LF-ISS-PRM-COMPUTED
  4048                                    PB-B-LF-CAN-PRM-REMITTED
  4049                                    PB-B-LF-CAN-PRM-ENTERED
  4050                                    PB-B-LF-CAN-PRM-COMPUTED
  4051                                    PB-B-AH-ISS-PRM-REMITTED
  4052                                    PB-B-AH-ISS-PRM-ENTERED
  4053                                    PB-B-AH-ISS-PRM-COMPUTED
  4054                                    PB-B-AH-CAN-PRM-REMITTED
  4055                                    PB-B-AH-CAN-PRM-ENTERED
  4056                                    PB-B-AH-CAN-PRM-COMPUTED
  4057                                    PB-B-ISSUE-CNT-REMITTED
  4058                                    PB-B-ISSUE-CNT-ENTERED
  4059                                    PB-B-CANCEL-CNT-REMITTED
  4060                                    PB-B-CANCEL-CNT-ENTERED
  4061                                    PB-B-HIGHEST-SEQ-NO
  4062                                    PB-LF-BILLED-AMTS
  4063                                    PB-AH-BILLED-AMTS
  4064                                    PB-CHG-COUNT
  4065                                    PB-CALC-TOLERANCE
  4066     move spaces                 to pb-account-name
  4067                                    pb-prem-ref-rpt-flag
  4068                                    pb-reference
  4069     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
  4070                                    PB-BILLED-DT
  4071                                    PB-ACCT-EFF-DT
  4072                                    PB-ACCT-EXP-DT
  4073     MOVE '9'                    TO PB-RECORD-TYPE
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  72
* EL202.cbl
  4074     move ws-iss-cnt             to pb-b-issue-cnt-remitted
  4075     move ws-lf-iss-premium      to pb-b-lf-iss-prm-remitted
  4076     move ws-ah-iss-premium      to pb-b-ah-iss-prm-remitted
  4077     move ws-highest-seq-no      to pb-b-highest-seq-no
  4078     move ws-bin-current-dt      to pb-b-received-dt
  4079     move ws-bin-eom-dt          to pb-credit-select-dt
  4080     move function upper-case(sql-py-Name)
  4081                                 to PB-ACCOUNT-NAME
  4082     .
  4083 0100-EXIT.
  4084     EXIT.
  4085 0110-write-erpndb.
  4086     display ' about to write pend bus ' pb-record-type
  4087
  4088* EXEC CICS WRITE
  4089*        DATASET  ('ERPNDB')
  4090*        FROM     (PENDING-BUSINESS)
  4091*        RIDFLD   (PB-CONTROL-PRIMARY)
  4092*        RESP     (WS-RESPONSE)
  4093*    END-EXEC
  4094     MOVE LENGTH OF
  4095      PENDING-BUSINESS
  4096       TO DFHEIV11
  4097     MOVE 'ERPNDB' TO DFHEIV1
  4098*    MOVE '&$ L                  ''  N#00003833' TO DFHEIV0
  4099     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4100     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4101     MOVE X'204E233030303033383333' TO DFHEIV0(25:11)
  4102     CALL 'kxdfhei1' USING DFHEIV0,
  4103           DFHEIV1,
  4104           PENDING-BUSINESS,
  4105           DFHEIV11,
  4106           PB-CONTROL-PRIMARY,
  4107           DFHEIV99,
  4108           DFHEIV99
  4109     MOVE EIBRESP  TO WS-RESPONSE
  4110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4111     IF NOT RESP-NORMAL
  4112        DISPLAY ' ERPNDB BTCH WRITE ERROR ' WS-RESPONSE
  4113        move ' Error writing erpndb  '
  4114                           to output-msg
  4115        set rollback-needed to true
  4116        move ws-response         to ws-display-response
  4117        move spaces              to ws-error-message
  4118        string ' Bad write on ERPNDB FILE ' ws-display-response
  4119           delimited by size into ws-error-message
  4120        end-string
  4121        move 3             to ws-status-code
  4122        perform 0226-update-remit-table
  4123                           thru 0226-exit
  4124        perform 0225-commit-work
  4125                           thru 0225-exit
  4126        go to 0000-return
  4127     END-IF
  4128     .
  4129 0110-exit.
  4130     exit.
  4131 0120-write-erpndm.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  73
* EL202.cbl
  4132     display ' about to write pend mail '
  4133     move ws-init-erpndm         to pending-mailing-data
  4134     move pb-control-primary     to pm-control-primary
  4135     move function upper-case(sql-py-Name)
  4136                                 to PM-CRED-BENE-NAME
  4137     move function upper-case(sql-py-Addr1)
  4138                                 to PM-CRED-BENE-ADDR
  4139     move function upper-case(sql-py-Addr2)
  4140                                 to PM-CRED-BENE-ADDR2
  4141     move function upper-case(sql-py-AddrCity)
  4142                                 to PM-CRED-BENE-CITY
  4143     move function upper-case(sql-py-AddrState)
  4144                                 to pm-cred-bene-state
  4145     move sql-py-AddrZIP         to pm-cred-bene-zip
  4146
  4147* EXEC CICS WRITE
  4148*        DATASET  ('ERPNDM')
  4149*        FROM     (PENDING-MAILING-DATA)
  4150*        RIDFLD   (PM-CONTROL-PRIMARY)
  4151*        RESP     (WS-RESPONSE)
  4152*    END-EXEC
  4153     MOVE LENGTH OF
  4154      PENDING-MAILING-DATA
  4155       TO DFHEIV11
  4156     MOVE 'ERPNDM' TO DFHEIV1
  4157*    MOVE '&$ L                  ''  N#00003874' TO DFHEIV0
  4158     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4159     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4160     MOVE X'204E233030303033383734' TO DFHEIV0(25:11)
  4161     CALL 'kxdfhei1' USING DFHEIV0,
  4162           DFHEIV1,
  4163           PENDING-MAILING-DATA,
  4164           DFHEIV11,
  4165           PM-CONTROL-PRIMARY,
  4166           DFHEIV99,
  4167           DFHEIV99
  4168     MOVE EIBRESP  TO WS-RESPONSE
  4169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4170     IF NOT RESP-NORMAL
  4171        move ' Error writing erpndm  '
  4172                                 to output-msg
  4173        set rollback-needed to true
  4174        move ws-response         to ws-display-response
  4175        move spaces              to ws-error-message
  4176        string ' Bad write on ERPNDM FILE ' ws-display-response
  4177           delimited by size into ws-error-message
  4178        end-string
  4179        move 3                   to ws-status-code
  4180        perform 0226-update-remit-table
  4181                                 thru 0226-exit
  4182        perform 0225-commit-work
  4183                                 thru 0225-exit
  4184        go to 0000-return
  4185        DISPLAY ' ERPNDM WRITE ERROR ' WS-RESPONSE
  4186     END-IF
  4187     .
  4188 0120-exit.
  4189     exit.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  74
* EL202.cbl
  4190 0130-start-edit.
  4191     display ' about to start edit '
  4192     MOVE ws-comp-cd             TO EDIT-COMPANY-CD
  4193     MOVE WS-BATCH-NO            TO EDIT-BATCH
  4194     MOVE ws-comp-id             TO EDIT-COMPANY-ID
  4195     MOVE SPACES                 TO EDIT-RESTART-BATCH
  4196
  4197* EXEC CICS START
  4198*         TRANSID       ('EXEB')
  4199*         FROM          (BATCH-TO-PROCESS)
  4200*    END-EXEC
  4201     MOVE LENGTH OF
  4202      BATCH-TO-PROCESS
  4203       TO DFHEIV11
  4204     MOVE 'EXEB' TO DFHEIV5
  4205*    MOVE '0( LF                 1   #00003906' TO DFHEIV0
  4206     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  4207     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  4208     MOVE X'2020233030303033393036' TO DFHEIV0(25:11)
  4209     CALL 'kxdfhei1' USING DFHEIV0,
  4210           DFHEIV99,
  4211           DFHEIV5,
  4212           DFHEIV99,
  4213           BATCH-TO-PROCESS,
  4214           DFHEIV11,
  4215           DFHEIV99,
  4216           DFHEIV99,
  4217           DFHEIV99,
  4218           DFHEIV99,
  4219           DFHEIV99,
  4220           DFHEIV99,
  4221           DFHEIV99,
  4222           DFHEIV99,
  4223           DFHEIV99,
  4224           DFHEIV99,
  4225           DFHEIV99
  4226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4227
  4228* EXEC CICS DELAY
  4229*       INTERVAL    (02)
  4230*    END-EXEC
  4231     MOVE 02 TO DFHEIV10
  4232*    MOVE '0$I                   &   #00003910' TO DFHEIV0
  4233     MOVE X'302449202020202020202020' TO DFHEIV0(1:12)
  4234     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4235     MOVE X'2020233030303033393130' TO DFHEIV0(25:11)
  4236     CALL 'kxdfhei1' USING DFHEIV0,
  4237           DFHEIV10,
  4238           DFHEIV99,
  4239           DFHEIV99,
  4240           DFHEIV99,
  4241           DFHEIV99
  4242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4243     .
  4244 0130-exit.
  4245     exit.
  4246 0220-send-form.
  4247     move ws-comp-id             to out-comp-id
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  75
* EL202.cbl
  4248     move 'CU CONNECT '          to output-title
  4249     display ' about to send form '
  4250
  4251* exec cics document create
  4252*       doctoken   (w-doctoken)
  4253*       template   ('WCHECKS')
  4254*       symbollist (output-data)
  4255*       listlength (length of output-data)
  4256*    end-exec
  4257     MOVE 'WCHECKS'
  4258      TO DFHEIVL0
  4259     MOVE LENGTH OF
  4260      output-data TO DFHEIV16
  4261*    MOVE '\"D tSL               )   #00003920' TO DFHEIV0
  4262     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  4263     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4264     MOVE X'2020233030303033393230' TO DFHEIV0(25:11)
  4265     CALL 'kxdfhei1' USING DFHEIV0,
  4266           w-doctoken,
  4267           DFHEIV99,
  4268           DFHEIVL0,
  4269           output-data,
  4270           DFHEIV16,
  4271           DFHEIV99,
  4272           DFHEIV99,
  4273           DFHEIV99
  4274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4275
  4276* exec cics web send
  4277*       doctoken(w-doctoken)
  4278*    end-exec
  4279*    MOVE 'X$D                   *   #00003926' TO DFHEIV0
  4280     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  4281     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  4282     MOVE X'2020233030303033393236' TO DFHEIV0(25:11)
  4283     CALL 'kxdfhei1' USING DFHEIV0,
  4284           w-doctoken,
  4285           DFHEIV99,
  4286           DFHEIV99,
  4287           DFHEIV99,
  4288           DFHEIV99,
  4289           DFHEIV99,
  4290           DFHEIV99,
  4291           DFHEIV99,
  4292           DFHEIV99
  4293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4294     .
  4295 0220-exit.
  4296     exit.
  4297 0225-commit-work.
  4298     display ' about to commit work   '
  4299     if connected-to-db
  4300        EXEC SQL
  4301            commit work
  4302        END-EXEC
  4303     end-if
  4304     .
  4305 0225-exit.
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  76
* EL202.cbl
  4306     exit.
  4307 0226-update-remit-table.
  4308     if ws-batch-no = zeros
  4309        move -1                  to nu-batchno
  4310     else
  4311        move +0                  to nu-batchno
  4312     end-if
  4313     if ws-error-message = spaces
  4314        move -1                  to nu-error-message
  4315     else
  4316        move +0                  to nu-error-message
  4317     end-if
  4318     EXEC SQL
  4319        UPDATE
  4320           CUC_Logic_Remittance
  4321        SET
  4322           LogicStatus = :ws-status-code,
  4323           LogicStatusDate = :ws-status-date,
  4324           BatchNumber = :ws-batch-no :nu-batchno,
  4325           ErrorMessage = :ws-error-message :nu-error-message
  4326        WHERE
  4327           RemitId = :ws-remit-id
  4328     END-EXEC
  4329     .
  4330 0226-exit.
  4331     exit.
  4332 0230-disconnect.
  4333     display ' about to disconnect DB '
  4334     if connected-to-db
  4335        EXEC SQL
  4336            disconnect all
  4337        END-EXEC
  4338        move ' ' to ws-connect-sw
  4339     end-if
  4340     .
  4341 0230-exit.
  4342     exit.
  4343 0240-init-erpndm.
  4344     display ' made it to init pndm '
  4345     move spaces                 to pending-mailing-data
  4346     move 'PM'                   to pm-record-id
  4347     move zeros                  to pm-batch-seq-no
  4348                                    pm-batch-chg-seq-no
  4349                                    pm-last-maint-hhmmss
  4350                                    pm-insured-issue-age
  4351                                    pm-phone-no
  4352     move low-values             to pm-record-add-dt
  4353                                    pm-last-maint-dt
  4354                                    pm-insured-birth-dt
  4355                                    pm-joint-birth-dt
  4356     perform varying s1 from +1 by +1 until s1 > +7
  4357        move low-values          to pm-mail-date (s1)
  4358     end-perform
  4359     move 'CR'                   to pm-source-system
  4360     move ws-bin-current-dt      to pm-record-add-dt
  4361                                    pm-last-maint-dt
  4362     move 'E202'                 to pm-last-maint-by
  4363                                    pm-record-added-by
* Micro Focus Server Express         V5.1 revision 000 09-Nov-15 15:38 Page  77
* EL202.cbl
  4364     move ws-work-time           to pm-last-maint-hhmmss
  4365     move pending-mailing-data   to ws-init-erpndm
  4366     .
  4367 0240-exit.
  4368     exit.
  4369 9700-DATE-CONVERT.
  4370
  4371* EXEC CICS LINK
  4372*         PROGRAM  ('ELDATCV')
  4373*         COMMAREA (DATE-CONVERSION-DATA)
  4374*         LENGTH   (DC-COMM-LENGTH)
  4375*    END-EXEC.
  4376     MOVE 'ELDATCV' TO DFHEIV1
  4377*    MOVE '."C                   (   #00004005' TO DFHEIV0
  4378     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4379     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4380     MOVE X'2020233030303034303035' TO DFHEIV0(25:11)
  4381     CALL 'kxdfhei1' USING DFHEIV0,
  4382           DFHEIV1,
  4383           DATE-CONVERSION-DATA,
  4384           DC-COMM-LENGTH,
  4385           DFHEIV99,
  4386           DFHEIV99,
  4387           DFHEIV99,
  4388           DFHEIV99
  4389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4390
  4391 9700-EXIT.
  4392      EXIT.
  4393
  4394 9999-DFHBACK SECTION.
  4395     MOVE '9%                    "   ' TO DFHEIV0
  4396     MOVE 'EL202' TO DFHEIV1
  4397     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4398     GOBACK.
  4399 9999-DFHEXIT.
  4400     IF DFHEIGDJ EQUAL 0001
  4401         NEXT SENTENCE.
  4402     MOVE '9%                    "   ' TO DFHEIV0
  4403     MOVE 'EL202' TO DFHEIV1
  4404     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4405     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      138620     Code:       17376
