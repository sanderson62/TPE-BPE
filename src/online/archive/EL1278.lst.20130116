* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page   1
* EL1278.cbl
* Options: int("EL1278.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1278.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1278.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1278.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1278.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/21/94 14:09:26.
     7*                            VMOD=2.030.
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page   2
* EL1278.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXXA - CANCELLATION QUOTE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101201    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37* 070105    2005063000003  PEMA  COMMENT OUT CODE THAT ADDS 1
    38*         TO THE TERM AND REMAINING TERM
    39* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    40* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    41* 111907  CR2004020600011  PEMA  FORCE FP TO REFUND AS FP
    42* 022608  CR2008010200006  PEMA  CHANGE MO RTERM MTHOD
    43* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
    44* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
    45* 021710  IR2010021000002  PEMA  ADD CANCEL DATE EDIT
    46* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
    47* 042011  CR2010030900001  PEMA ADD CLM PROCESSING ON QUOTES
    48* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    49* 010412  CR2011022800001  AJRA  NAPERSOFT CANCEL PROCESSING
    50* 032912  CR2011110200001  PEMA  AHL CHANGES
    51* 062712  CR2011022800001  AJRA NAPERSOFT
    52* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    53* 102212  CR2012013100001  PEMA  ALLOW MN OVERRIDE RF
    54* 112612  CR2012101700002  AJRA  FIX CANCEL WHEN DEATH CLAIM
    55******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page   3
* EL1278.cbl
    57 ENVIRONMENT DIVISION.
    58 DATA DIVISION.
    59 WORKING-STORAGE SECTION.
    60 01  DFH-START PIC X(04).
    61 77  FILLER  PIC  X(32) VALUE '********************************'.
    62 77  FILLER  PIC  X(32) VALUE '*    EL1278 WORKING STORAGE    *'.
    63 77  FILLER  PIC  X(32) VALUE '*********** VMOD=2.030 *********'.
    64 77  S1                          PIC S999 COMP-3 VALUE +0.
    65 77  P1                          PIC S999 COMP-3 VALUE +0.
    66 77  P2                          PIC S999 COMP-3 VALUE +0.
    67 77  C0                          PIC S999 COMP-3 VALUE +0.
    68 77  C1                          PIC S999 COMP-3 VALUE +0.
    69 77  C2                          PIC S999 COMP-3 VALUE +0.
    70 77  C3                          PIC S999 COMP-3 VALUE +0.
    71 77  WS-STOP-SW                  PIC X  VALUE ' '.
    72     88  I-SAY-TO-STOP      VALUE 'Y'.
    73 77  WS-OPEN-LF-CLAIM            PIC X  VALUE ' '.
    74     88  OPEN-LF-CLAIM              VALUE 'Y'.
    75 77  WS-CLOSED-LF-CLAIM          PIC X  VALUE ' '.
    76     88  CLOSED-LF-CLAIM            VALUE 'Y'.
    77 77  WS-OPEN-AH-CLAIM            PIC X  VALUE ' '.
    78     88  OPEN-AH-CLAIM              VALUE 'Y'.
    79 77  WS-CLOSED-AH-CLAIM          PIC X  VALUE ' '.
    80     88  CLOSED-AH-CLAIM            VALUE 'Y'.
    81 77  WS-FOUND-A-CLAIM            PIC X  VALUE ' '.
    82     88  FOUND-A-CLAIM              VALUE 'Y'.
    83 77  WS-ST-REF-IND               PIC X.
    84 77  WS-LF-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    85 77  WS-AH-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    86 77  WS-AH-PAID-THRU-DT          PIC XX  VALUE LOW-VALUES.
    87 77  WS-LF-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    88 77  WS-AH-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    89 77  DD-IU-SW                    PIC X   VALUE ' '.
    90     88  DD-IU-PRESENT                 VALUE 'Y'.
    91 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    92 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    93 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    94 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    95 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    96 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    97 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    98 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    99 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
   100     88  NO-CERT-RW                 VALUE 'N'.
   101     88  CERT-RW                    VALUE 'Y'.
   102 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   103     88  ERMAIL-FOUND                 VALUE 'Y'.
   104
   105*                            COPY ELCSCTM.
   106******************************************************************
   107*                                                                *
   108*                                                                *
   109*                            ELCSCTM                             *
   110*                            VMOD=2.001                          *
   111*                                                                *
   112*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   113*                                                                *
   114******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page   4
* EL1278.cbl
   115 01  SECURITY-MESSAGE.
   116     12  FILLER                          PIC X(30)
   117            VALUE '** LOGIC SECURITY VIOLATION -'.
   118     12  SM-READ                         PIC X(6).
   119     12  FILLER                          PIC X(5)
   120            VALUE ' PGM='.
   121     12  SM-PGM                          PIC X(6).
   122     12  FILLER                          PIC X(5)
   123            VALUE ' OPR='.
   124     12  SM-PROCESSOR-ID                 PIC X(4).
   125     12  FILLER                          PIC X(6)
   126            VALUE ' TERM='.
   127     12  SM-TERMID                       PIC X(4).
   128     12  FILLER                          PIC XX   VALUE SPACE.
   129     12  SM-JUL-DATE                     PIC 9(5).
   130     12  FILLER                          PIC X    VALUE SPACE.
   131     12  SM-TIME                         PIC 99.99.
   132
   133
   134*                            COPY ELCSCRTY.
   135******************************************************************
   136*                                                                *
   137*                                                                *
   138*                            ELCSCRTY                            *
   139*                            VMOD=2.001                          *
   140*                                                                *
   141*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   142*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   143*        SAVED IN PI-SECURITY-ADDRESS.                           *
   144*                                                                *
   145******************************************************************
   146 01  SECURITY-CONTROL.
   147     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   148     12  FILLER                       PIC XX    VALUE 'SC'.
   149     12  SC-CREDIT-CODES.
   150         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   151             20  SC-CREDIT-DISPLAY    PIC X.
   152             20  SC-CREDIT-UPDATE     PIC X.
   153     12  SC-CLAIMS-CODES.
   154         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   155             20  SC-CLAIMS-DISPLAY    PIC X.
   156             20  SC-CLAIMS-UPDATE     PIC X.
   157
   158 01  FILLER          COMP-3.
   159     12  WS-BALLOON-RTRM         PIC S9(03)      VALUE ZERO.
   160     12  WS-ELAPSED-MONTHS       PIC S9(03)      VALUE ZERO.
   161     12  WS-TOT-AH-PREM          PIC S9(9)V99    VALUE ZERO.
   162     12  WS-TOT-LF-PREM          PIC S9(9)V99    VALUE ZERO.
   163     12  WS-TOT-AH-RFND          PIC S9(9)V99    VALUE ZERO.
   164     12  WS-TOT-LF-RFND          PIC S9(9)V99    VALUE ZERO.
   165     12  WS-TOT-PREM             PIC S9(9)V99    VALUE ZERO.
   166     12  WS-TOT-RFND             PIC S9(9)V99    VALUE ZERO.
   167     12  WS-TOT-ITDR             PIC S9(9)V99    VALUE ZERO.
   168
   169 01  WS-DATE-AREA.
   170     12  SAVE-DATE               PIC  X(08)      VALUE SPACES.
   171     12  SAVE-BIN-DATE           PIC  X(02)      VALUE SPACES.
   172     12  WS-LF-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page   5
* EL1278.cbl
   173     12  WS-AH-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   174     12  WS-LF-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   175     12  WS-AH-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   176
   177 01  ERPDEF-KEY-SAVE             PIC X(18).
   178 01  ERPDEF-KEY.
   179     12  ERPDEF-COMPANY-CD       PIC X.
   180     12  ERPDEF-STATE            PIC XX.
   181     12  ERPDEF-PROD-CD          PIC XXX.
   182     12  F                       PIC X(7).
   183     12  ERPDEF-BEN-TYPE         PIC X.
   184     12  ERPDEF-BEN-CODE         PIC XX.
   185     12  ERPDEF-EXP-DT           PIC XX.
   186 01  ELMSTR-KEY.
   187     12  ELMSTR-COMP-CD          PIC X.
   188     12  ELMSTR-CERT-NO          PIC X(11).
   189 01  ELCRTO-KEY.
   190     05  ELCRTO-COMPANY-CD       PIC X.
   191     05  ELCRTO-CARRIER          PIC X.
   192     05  ELCRTO-GROUPING         PIC X(6).
   193     05  ELCRTO-STATE            PIC XX.
   194     05  ELCRTO-ACCOUNT          PIC X(10).
   195     05  ELCRTO-CERT-EFF-DT      PIC XX.
   196     05  ELCRTO-CERT-NO.
   197         10  ELCRTO-CERT-PRIME   PIC X(10).
   198         10  ELCRTO-CERT-SFX     PIC X.
   199     05  ELCRTO-RECORD-TYPE      PIC X.
   200     05  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   201
   202 01  STANDARD-AREAS.
   203     12  SC-ITEM                 PIC S9(04) COMP VALUE +0001.
   204     12  SUB3                    PIC S9(04) COMP VALUE +0.
   205     12  SUB4                    PIC S9(04) COMP VALUE +0.
   206     12  GETMAIN-SPACE           PIC  X(01)      VALUE SPACE.
   207     12  MAP-NAME                PIC  X(08)      VALUE 'EL127H'.
   208     12  MAPSET-NAME             PIC  X(08)      VALUE 'EL1278S'.
   209     12  SCREEN-NUMBER           PIC  X(04)      VALUE '127H'.
   210     12  TRANS-ID                PIC  X(04)      VALUE 'EXXA'.
   211     12  THIS-PGM                PIC  X(08)      VALUE 'EL1278'.
   212     12  PGM-NAME                PIC  X(08).
   213     12  TIME-IN                 PIC S9(07).
   214     12  TIME-OUT-R  REDEFINES  TIME-IN.
   215         16  FILLER              PIC  X(01).
   216         16  TIME-OUT            PIC  9(02)V99.
   217         16  FILLER              PIC  X(02).
   218     12  XCTL-005                PIC  X(08)      VALUE 'EL005'.
   219     12  XCTL-010                PIC  X(08)      VALUE 'EL010'.
   220     12  XCTL-126                PIC  X(08)      VALUE 'EL126'.
   221     12  LINK-001                PIC  X(08)      VALUE 'EL001'.
   222     12  LINK-004                PIC  X(08)      VALUE 'EL004'.
   223     12  LINK-ELDATCV            PIC  X(08)      VALUE 'ELDATCV'.
   224     12  ELRTRM-ID               PIC  X(08)      VALUE 'ELRTRM'.
   225     12  ELRAMT-ID               PIC  X(08)      VALUE 'ELRAMT'.
   226     12  ELRFND-ID               PIC  X(08)      VALUE 'ELRFND'.
   227     12  ELCNTL-ID               PIC  X(08)      VALUE 'ELCNTL'.
   228     12  ERACCT-ID               PIC  X(08)      VALUE 'ERACCT'.
   229     12  ELCERT-ID               PIC  X(08)      VALUE 'ELCERT'.
   230     12  ERMAIL-ID               PIC  X(08)      VALUE 'ERMAIL'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page   6
* EL1278.cbl
   231     12  ERFORM-ID               PIC  X(08)      VALUE 'ERFORM'.
   232     12  ERNOTE-ID               PIC  X(08)      VALUE 'ERCNOT'.
   233     12  DATE-RANGE-SW           PIC  X(01)      VALUE SPACE.
   234     12  WS-REFUND-SEARCH-SW     PIC  X(01)      VALUE ' '.
   235         88  LIFE-REFUND-SEARCH                  VALUE 'L'.
   236     12  WS-BROWSE-STARTED-SW    PIC  X(01)      VALUE SPACE.
   237         88  BROWSE-STARTED                      VALUE 'Y'.
   238     12  WS-FORM-RECORD-SW       PIC  X(01)      VALUE SPACE.
   239         88  FORM-FOUND                          VALUE 'Y'.
   240     12  BEN-SEARCH-SW           PIC  X(01)      VALUE SPACE.
   241         88  NO-BENEFIT-FOUND                    VALUE 'N'.
   242     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   243         88  WS-REDUCING                         VALUE 'R'.
   244         88  WS-LEVEL                            VALUE 'L'  'P'.
   245     12  WS-NEW-LF-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   246         88  WS-NEW-LF-CANCEL                    VALUE 'Y'.
   247     12  WS-NEW-AH-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   248         88  WS-NEW-AH-CANCEL                    VALUE 'Y'.
   249     12  WS-BENEFIT-DESCRIP      PIC  X(10)      VALUE SPACES.
   250     12  WS-PMT-DESCRIP          PIC  X(10)      VALUE
   251         'CLAIM PMTS'.
   252     12  WS-REFUND-DESCRIP       PIC  X(10)      VALUE
   253         'ITD REFUND'.
   254     12  WS-ACCESS.
   255         16  FILLER              PIC  X(02).
   256         16  WS-BEN-CD           PIC  X(02).
   257     12  WS-KIND                 PIC  X(03)      VALUE SPACES.
   258     12  WS-LF-KIND              PIC  X(03)      VALUE SPACES.
   259     12  WS-AH-KIND              PIC  X(03)      VALUE SPACES.
   260     12  WS-LOOKUP-TYPE          PIC  X(01).
   261     12  WS-BENEFIT-NO           PIC  X(02)      VALUE ZERO.
   262     12  WS-STATE-ABBREVIATION   PIC  X(02)      VALUE SPACES.
   263     12  WS-CALC-CD              PIC  X(01).
   264     12  DEEDIT-FIELD            PIC  X(15).
   265     12  DEEDIT-FIELD-V0  REDEFINES
   266         DEEDIT-FIELD            PIC S9(15).
   267     12  WS-CURRENT-DATE         PIC  X(02)  VALUE LOW-VALUES.
   268     12  RETURN-FROM             PIC  X(08).
   269     12  QID.
   270         16  QID-TERM            PIC  X(04).
   271         16  FILLER              PIC  X(04)      VALUE '127H'.
   272     12  WS-FIRST-ENTRY-SW       PIC  X(01)      VALUE SPACE.
   273         88  FIRST-ENTRY                         VALUE 'Y'.
   274     12  WS-PDEF-RECORD-SW       PIC X           VALUE ' '.
   275         88  PDEF-FOUND                          VALUE 'Y'.
   276     12  WS-CERT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   277         88  CERT-FOUND                          VALUE 'Y'.
   278         88  CERT-NOT-FOUND                      VALUE 'N'.
   279     12  WS-CNTL-RECORD-SW       PIC  X(01)      VALUE SPACE.
   280         88  CNTL-FOUND                          VALUE 'Y'.
   281         88  CNTL-NOT-FOUND                      VALUE 'N'.
   282     12  WS-BEN-RECORD-SW        PIC  X(01)      VALUE SPACE.
   283         88  BEN-FOUND                           VALUE 'Y'.
   284     12  WS-STATE-RECORD-SW      PIC  X(01)      VALUE SPACE.
   285         88  STATE-FOUND                         VALUE 'Y'.
   286     12  WS-ST-BEN-RECORD-SW     PIC  X(01)      VALUE SPACE.
   287         88  ST-BEN-FOUND                        VALUE 'Y'.
   288     12  WS-ACCT-RECORD-SW       PIC  X(01)      VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page   7
* EL1278.cbl
   289         88  ACCT-FOUND                          VALUE 'Y'.
   290     12  WS-DUPREC-SW            PIC  X(01)      VALUE SPACE.
   291         88  DUPLICATE-RECORD-FOUND              VALUE 'Y'.
   292     12  WS-NOT-FOUND            PIC S9(01) COMP-3
   293                                                 VALUE ZERO.
   294         88  BENEFIT-FOUND                       VALUE +1.
   295     12  WS-CALC-REFUND          PIC S9(07)V99 COMP-3
   296                                                 VALUE ZERO.
   297     12  WS-LIFE-PREMIUM         PIC S9(07)V99 COMP-3
   298                                                 VALUE ZERO.
   299     12  WS-INDEX                PIC S9(04) COMP VALUE ZERO.
   300     12  WS-SUB1                 PIC S99    COMP.
   301     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   302     12  WS-CF-DEFAULT-APR       PIC  S9(03)V9(04) COMP-3.
   303     12  WS-CF-CR-R78-METHOD     PIC  X(01)      VALUE SPACE.
   304     12  WS-CF-CR-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   305     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   306     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   307     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   308     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   309     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   310     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   311     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   312     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   313     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   314     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   315     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   316     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   317     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   318     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   319     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   320     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   321     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   322     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   323     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   324     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   325     12  ERROR-MESSAGES.
   326         16  ER-0000             PIC  X(04)      VALUE '0000'.
   327         16  ER-0004             PIC  X(04)      VALUE '0004'.
   328         16  ER-0008             PIC  X(04)      VALUE '0008'.
   329         16  ER-0028             PIC  X(04)      VALUE '0028'.
   330         16  ER-0029             PIC  X(04)      VALUE '0029'.
   331         16  ER-0070             PIC  X(04)      VALUE '0070'.
   332         16  ER-0142             PIC  X(04)      VALUE '0142'.
   333         16  ER-0214             PIC  X(04)      VALUE '0214'.
   334         16  ER-0681             PIC  X(04)      VALUE '0681'.
   335         16  ER-0682             PIC  X(04)      VALUE '0682'.
   336         16  ER-0683             PIC  X(04)      VALUE '0683'.
   337         16  ER-0684             PIC  X(04)      VALUE '0684'.
   338         16  ER-2227             PIC  X(04)      VALUE '2227'.
   339         16  ER-2601             PIC  X(04)      VALUE '2601'.
   340         16  ER-2616             PIC  X(04)      VALUE '2616'.
   341         16  ER-2617             PIC  X(04)      VALUE '2617'.
   342         16  ER-2619             PIC  X(04)      VALUE '2619'.
   343         16  ER-2740             PIC  X(04)      VALUE '2740'.
   344         16  ER-2756             PIC  X(04)      VALUE '2756'.
   345         16  ER-2768             PIC  X(04)      VALUE '2768'.
   346         16  ER-2774             PIC  X(04)      VALUE '2774'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page   8
* EL1278.cbl
   347         16  ER-2775             PIC  X(04)      VALUE '2775'.
   348         16  ER-2965             PIC  X(04)      VALUE '2965'.
   349         16  ER-2966             PIC  X(04)      VALUE '2966'.
   350         16  ER-2967             PIC  X(04)      VALUE '2967'.
   351         16  ER-2968             PIC  X(04)      VALUE '2968'.
   352         16  ER-2969             PIC  X(04)      VALUE '2969'.
   353         16  ER-3037             PIC  X(04)      VALUE '3037'.
   354         16  ER-3038             PIC  X(04)      VALUE '3038'.
   355         16  ER-3039             PIC  X(04)      VALUE '3039'.
   356         16  ER-3780             PIC  X(04)      VALUE '3780'.
   357         16  ER-3781             PIC  X(04)      VALUE '3781'.
   358         16  ER-3830             PIC  X(04)      VALUE '3830'.
   359         16  ER-8160             PIC  X(04)      VALUE '8160'.
   360         16  ER-8161             PIC  X(04)      VALUE '8161'.
   361         16  ER-9999             PIC  X(04)      VALUE '9999'.
   362     12  WS-CF-LIFE-OVERRIDE-L1  PIC  X(01).
   363     12  WS-CF-LIFE-OVERRIDE-L2  PIC  X(02).
   364     12  WS-CF-AH-OVERRIDE-L1    PIC  X(01).
   365     12  WS-CF-AH-OVERRIDE-L2    PIC  X(02).
   366
   367     12  WS-RESPONSE             PIC S9(8)       COMP.
   368         88  WS-RESP-NORMAL                      VALUE +00.
   369         88  WS-RESP-NOTFND                      VALUE +13.
   370         88  WS-RESP-DUPREC                      VALUE +14.
   371         88  WS-RESP-DUPKEY                      VALUE +15.
   372         88  WS-RESP-NOTOPEN                     VALUE +19.
   373         88  WS-RESP-ENDFILE                     VALUE +20.
   374
   375     12  WS-01-CANCEL-ERR        PIC X(25)
   376         VALUE 'CANCEL DATE ERROR'.
   377     12  WS-02-CANCEL-ERR        PIC X(25)
   378         VALUE 'CERT NOT FOUND'.
   379     12  WS-04-CANCEL-ERR        PIC X(25)
   380         VALUE 'CANCEL AMOUNT ERROR'.
   381     12  WS-05-CANCEL-ERR        PIC X(25)
   382         VALUE 'CANCEL OPTION ERROR'.
   383     12  WS-06-CANCEL-ERR        PIC X(25)
   384         VALUE 'PREVIOUSLY CANCELLED'.
   385     12  WS-07-CANCEL-ERR        PIC X(25)
   386         VALUE 'INVALID DATA'.
   387     12  WS-08-CANCEL-ERR        PIC X(25)
   388         VALUE 'NO ACCOUNT MASTER'.
   389     12  WS-09-CANCEL-ERR        PIC X(25)
   390         VALUE 'SUFFIX ALREADY EXISTS'.
   391     12  WS-99-CANCEL-ERR        PIC X(25)
   392         VALUE 'MISC CANCEL ERROR'.
   393
   394 01  WS-SAVE-ALLOWABLE-BENEFIT.
   395     16  WS-SAVE-BENEFIT-CODE      PIC XX.
   396     16  WS-SAVE-BENEFIT-TYPE      PIC X.
   397     16  WS-SAVE-BENEFIT-REVISION  PIC XXX.
   398     16  WS-SAVE-BENEFIT-REM-TERM  PIC X.
   399     16  WS-SAVE-BENEFIT-RETRO-Y-N PIC X.
   400     16  FILLER                    PIC XX.
   401 01  CTBL-KEY-SAVE               PIC X(5).
   402 01  CTBL-KEY.
   403     05  CTBL-COMPANY-CD         PIC X.
   404     05  CTBL-TABLE              PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page   9
* EL1278.cbl
   405     05  CTBL-BEN-TYPE           PIC X.
   406     05  CTBL-BEN-CODE           PIC XX.
   407 01  CANCEL-GEN-PASS-AREA.
   408     05  CG-OPTION-CODE          PIC X.
   409         88  CG-VALID-OPTION       VALUE '1' '2' '3'.
   410         88  CG-FLAT-CANCEL        VALUE '1'.
   411         88  CG-CANCEL             VALUE '2'.
   412         88  CG-CANCEL-REISSUE     VALUE '3'.
   413     05  CG-ERROR-CODE           PIC 99.
   414         88  CG-SUCCESS            VALUE 00.
   415         88  CG-DATE-ERROR         VALUE 01.
   416         88  CG-CERT-NOT-FOUND     VALUE 02.
   417         88  CG-AMOUNT-ERROR       VALUE 04.
   418         88  CG-OPTION-ERROR       VALUE 05.
   419         88  CG-PREV-CAN           VALUE 06.
   420         88  CG-INVALID-DATA       VALUE 07.
   421         88  CG-NO-ACCT-MSTR       VALUE 08.
   422         88  CG-SFX-A-EXIST        VALUE 09.
   423         88  CG-MISC-ERROR         VALUE 99.
   424     05  CG-COMPANY-ID           PIC XXX.
   425     05  CG-PROC-ID              PIC XXXX.
   426     05  CG-CURRENT-DT           PIC XX.
   427     05  CG-MONTH-END-DT         PIC XX.
   428     05  CG-CERT-KEY.
   429         10  CG-CERT-COMPANY-CD  PIC X.
   430         10  CG-CERT-CARRIER     PIC X.
   431         10  CG-CERT-GROUP       PIC X(6).
   432         10  CG-CERT-STATE       PIC XX.
   433         10  CG-CERT-ACCOUNT     PIC X(10).
   434         10  CG-CERT-EFF-DT      PIC XX.
   435         10  CG-CERT-CERT-NO     PIC X(11).
   436     05  CG-LF-CAN-DATA.
   437         10  CG-LF-CAN-DT        PIC XX.
   438         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   439     05  CG-AH-CAN-DATA.
   440         10  CG-AH-CAN-DT        PIC XX.
   441         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   442     05  CG-CERT-PROFILE-DATA.
   443         10  CG-INS-LNAME        PIC X(15).
   444         10  CG-INS-FNAME        PIC X(10).
   445         10  CG-INS-MID-INIT     PIC X.
   446         10  CG-INS-AGE          PIC 99.
   447         10  CG-JNT-LNAME        PIC X(15).
   448         10  CG-JNT-FNAME        PIC X(10).
   449         10  CG-JNT-MID-INIT     PIC X.
   450         10  CG-JNT-AGE          PIC 99.
   451     05  CG-LF-ISS-DATA.
   452         10  CG-LF-BENCD         PIC XX.
   453         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   454         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   455     05  CG-AH-ISS-DATA.
   456         10  CG-AH-BENCD         PIC XX.
   457         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   458     05  CG-BATCH-NO             PIC X(6).
   459     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   460     05  FILLER                  PIC X(306).
   461 01  WS-CAN-QUOTE-NOTE.
   462     12  WS-CN-DT-QUOTED         PIC  X(09).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  10
* EL1278.cbl
   463     12  FILLER                  PIC  X(10)      VALUE
   464         'RF QUOTE: '.
   465     12  WS-CN-LIFE-AMT-RF       PIC  Z,ZZ9.99.
   466     12  FILLER                  PIC  X(4)       VALUE
   467         ' LF '.
   468     12  WS-CN-LF-REF-METH       PIC  X.
   469     12  FILLER                  PIC  X          VALUE ','.
   470     12  WS-CN-AH-AMT-RF         PIC  Z,ZZ9.99.
   471     12  FILLER                  PIC  X(5)       VALUE
   472         ' AH '.
   473     12  WS-CN-AH-REF-METH       PIC  X.
   474     12  FILLER                  PIC  XX         VALUE ','.
   475     12  FILLER                  PIC  X(6)       VALUE
   476         'TOTAL '.
   477     12  WS-CN-TOTAL-RF          PIC  Z,ZZ9.99.
   478     12  FILLER                  PIC  X(01)      VALUE ' '.
   479     12  WS-CN-CANCEL-DT         PIC  X(08).
   480     12  FILLER                  PIC  X(01)      VALUE ';'.
   481     12  WS-CN-PROCESSOR-ID      PIC  X(04).
   482
   483 01  WS-CM-CONTROL-PRIMARY.
   484     12  WS-CM-COMPANY-CD        PIC  X(01).
   485     12  WS-CM-CARRIER           PIC  X(01).
   486     12  WS-CM-GROUPING          PIC  X(06).
   487     12  WS-CM-STATE             PIC  X(02).
   488     12  WS-CM-ACCOUNT           PIC  X(10).
   489     12  WS-CM-CERT-EFF-DT       PIC  X(02).
   490     12  WS-CM-CERT-NO.
   491         16  WS-CM-CERT-PRIME    PIC  X(10).
   492         16  WS-CM-CERT-SFX      PIC  X(01).
   493
   494 01  WS-MA-CONTROL-PRIMARY.
   495     12  WS-MA-COMPANY-CD        PIC  X(01).
   496     12  WS-MA-CARRIER           PIC  X(01).
   497     12  WS-MA-GROUPING          PIC  X(06).
   498     12  WS-MA-STATE             PIC  X(02).
   499     12  WS-MA-ACCOUNT           PIC  X(10).
   500     12  WS-MA-CERT-EFF-DT       PIC  X(02).
   501     12  WS-MA-CERT-NO.
   502         16  WS-MA-CERT-PRIME    PIC  X(10).
   503         16  WS-MA-CERT-SFX      PIC  X(01).
   504 01  WS-CF-CONTROL-PRIMARY.
   505     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   506     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   507*        88  COMPANY-MASTER                      VALUE '1'.
   508*        88  STATE-MASTER                        VALUE '3'.
   509*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   510*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   511     12  WS-CF-ACCESS.
   512         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   513         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   514             20  FILLER          PIC  X(01).
   515             20  WS-CF-CARRIER   PIC  X(01).
   516     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   517
   518 01  WS-AM-CONTROL-PRIMARY.
   519     12  WS-AM-COMPANY-CD        PIC  X(01).
   520     12  WS-AM-CARRIER           PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  11
* EL1278.cbl
   521     12  WS-AM-GROUPING          PIC  X(06).
   522     12  WS-AM-STATE             PIC  X(02).
   523     12  WS-AM-ACCOUNT           PIC  X(10).
   524     12  WS-AM-EXPIRATION-DT     PIC  X(02).
   525     12  WS-AM-FILLER            PIC  X(04).
   526
   527 01  WS-CN-CONTROL-PRIMARY.
   528     12  WS-CN-COMPANY-CD        PIC  X(01).
   529     12  WS-CN-CARRIER           PIC  X(01).
   530     12  WS-CN-GROUPING          PIC  X(06).
   531     12  WS-CN-STATE             PIC  X(02).
   532     12  WS-CN-ACCOUNT           PIC  X(10).
   533     12  WS-CN-CERT-EFF-DT       PIC  X(02).
   534     12  WS-CN-CERT-NO.
   535         16  WS-CN-CERT-PRIME    PIC  X(10).
   536         16  WS-CN-CERT-SFX      PIC  X.
   537     12  WS-CN-REC-TYPE          PIC X.
   538     12  WS-CN-SEQ-NO            PIC 9(4) BINARY.
   539
   540 01  WS-FO-CONTROL-PRIMARY.
   541     12  WS-FO-COMPANY-CD        PIC  X(01).
   542     12  WS-FO-STATE             PIC  X(02).
   543     12  WS-FO-FORM-ID           PIC  X(12).
   544     12  WS-FO-EXP-DT            PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  12
* EL1278.cbl
   546*                            COPY ERCCNOT.
   547******************************************************************
   548*                                                                *
   549*                            ERCCNOT                             *
   550*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   551*                            VMOD=2.003                          *
   552*                                                                *
   553*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
   554*                                                                *
   555*        FILE TYPE= VSAM,KSDS                                    *
   556*        RECORD SIZE = 150    RECFORM = FIXED                    *
   557*                                                                *
   558*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
   559*                                                                *
   560*        LOG = YES                                               *
   561*        SERVREQ = DELETE,UPDATE,NEWREC                          *
   562*                                                                *
   563******************************************************************
   564*                   C H A N G E   L O G
   565*
   566* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   567*-----------------------------------------------------------------
   568*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   569* EFFECTIVE    NUMBER
   570*-----------------------------------------------------------------
   571* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
   572******************************************************************
   573
   574 01  CERT-NOTE-FILE.
   575     12  CZ-RECORD-ID                PIC  XX.
   576         88  VALID-CZ-ID                  VALUE 'CZ'.
   577
   578     12  CZ-CONTROL-PRIMARY.
   579         16  CZ-COMPANY-CD           PIC X.
   580         16  CZ-CARRIER              PIC X.
   581         16  CZ-GROUPING.
   582             20 CZ-GROUPING-PREFIX   PIC XXX.
   583             20 CZ-GROUPING-PRIME    PIC XXX.
   584         16  CZ-STATE                PIC XX.
   585         16  CZ-ACCOUNT.
   586             20 CZ-ACCOUNT-PREFIX    PIC X(4).
   587             20 CZ-ACCOUNT-PRIME     PIC X(6).
   588         16  CZ-CERT-EFF-DT          PIC XX.
   589         16  CZ-CERT-NO.
   590             20  CZ-CERT-PRIME       PIC X(10).
   591             20  CZ-CERT-SFX         PIC X.
   592         16  CZ-RECORD-TYPE          PIC X.
   593             88  CERT-NOTE           VALUE '1'.
   594             88  CLAIM-CERT-NOTE     VALUE '2'.
   595         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
   596
   597     12  CZ-LAST-MAINT-DT            PIC XX.
   598     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
   599     12  CZ-LAST-MAINT-USER          PIC X(4).
   600
   601     12  CZ-NOTE-INFORMATION.
   602         16  CZ-NOTE                 PIC X(63).
   603         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  13
* EL1278.cbl
   604******************************************************************
   605*                            COPY ELCDATE.
   606******************************************************************
   607*                                                                *
   608*                                                                *
   609*                            ELCDATE.                            *
   610*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   611*                            VMOD=2.003
   612*                                                                *
   613*                                                                *
   614*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   615*                 LENGTH = 200                                   *
   616******************************************************************
   617
   618 01  DATE-CONVERSION-DATA.
   619     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   620     12  DC-OPTION-CODE                PIC X.
   621         88  BIN-TO-GREG                VALUE ' '.
   622         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   623         88  EDIT-GREG-TO-BIN           VALUE '2'.
   624         88  YMD-GREG-TO-BIN            VALUE '3'.
   625         88  MDY-GREG-TO-BIN            VALUE '4'.
   626         88  JULIAN-TO-BIN              VALUE '5'.
   627         88  BIN-PLUS-ELAPSED           VALUE '6'.
   628         88  FIND-CENTURY               VALUE '7'.
   629         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   630         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   631         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   632         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   633         88  JULIAN-TO-BIN-3            VALUE 'C'.
   634         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   635         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   636         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   637         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   638         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   639         88  CHECK-LEAP-YEAR            VALUE 'H'.
   640         88  BIN-3-TO-GREG              VALUE 'I'.
   641         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   642         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   643         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   644         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   645         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   646         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   647         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   648         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   649         88  THREE-CHARACTER-BIN
   650                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   651         88  GREGORIAN-TO-BIN
   652                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   653         88  BIN-TO-GREGORIAN
   654                  VALUES ' ' '1' 'I' '8' 'G'.
   655         88  JULIAN-TO-BINARY
   656                  VALUES '5' 'C' 'E' 'F'.
   657     12  DC-ERROR-CODE                 PIC X.
   658         88  NO-CONVERSION-ERROR        VALUE ' '.
   659         88  DATE-CONVERSION-ERROR
   660                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   661         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  14
* EL1278.cbl
   662         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   663         88  DATE-IS-INVALID            VALUE '3'.
   664         88  DATE1-GREATER-DATE2        VALUE '4'.
   665         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   666         88  DATE-INVALID-OPTION        VALUE '9'.
   667         88  INVALID-CENTURY            VALUE 'A'.
   668         88  ONLY-CENTURY               VALUE 'B'.
   669         88  ONLY-LEAP-YEAR             VALUE 'C'.
   670         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   671     12  DC-END-OF-MONTH               PIC X.
   672         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   673     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   674         88  USE-NORMAL-PROCESS         VALUE ' '.
   675         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   676         88  ADJUST-UP-100-YRS          VALUE '2'.
   677     12  FILLER                        PIC X.
   678     12  DC-CONVERSION-DATES.
   679         16  DC-BIN-DATE-1             PIC XX.
   680         16  DC-BIN-DATE-2             PIC XX.
   681         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   682         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   683                       DC-GREG-DATE-1-EDIT.
   684             20  DC-EDIT1-MONTH        PIC 99.
   685             20  SLASH1-1              PIC X.
   686             20  DC-EDIT1-DAY          PIC 99.
   687             20  SLASH1-2              PIC X.
   688             20  DC-EDIT1-YEAR         PIC 99.
   689         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   690         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   691                     DC-GREG-DATE-2-EDIT.
   692             20  DC-EDIT2-MONTH        PIC 99.
   693             20  SLASH2-1              PIC X.
   694             20  DC-EDIT2-DAY          PIC 99.
   695             20  SLASH2-2              PIC X.
   696             20  DC-EDIT2-YEAR         PIC 99.
   697         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   698         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   699                     DC-GREG-DATE-1-YMD.
   700             20  DC-YMD-YEAR           PIC 99.
   701             20  DC-YMD-MONTH          PIC 99.
   702             20  DC-YMD-DAY            PIC 99.
   703         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   704         16  DC-GREG-DATE-1-MDY-R REDEFINES
   705                      DC-GREG-DATE-1-MDY.
   706             20  DC-MDY-MONTH          PIC 99.
   707             20  DC-MDY-DAY            PIC 99.
   708             20  DC-MDY-YEAR           PIC 99.
   709         16  DC-GREG-DATE-1-ALPHA.
   710             20  DC-ALPHA-MONTH        PIC X(10).
   711             20  DC-ALPHA-DAY          PIC 99.
   712             20  FILLER                PIC XX.
   713             20  DC-ALPHA-CENTURY.
   714                 24 DC-ALPHA-CEN-N     PIC 99.
   715             20  DC-ALPHA-YEAR         PIC 99.
   716         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   717         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   718         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   719         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  15
* EL1278.cbl
   720         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   721                                       PIC 9(05).
   722         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   723             20  DC-JULIAN-YEAR        PIC 99.
   724             20  DC-JULIAN-DAYS        PIC 999.
   725         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   726         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   727         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   728     12  DATE-CONVERSION-VARIBLES.
   729         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   730         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   731             20  FILLER                PIC 9(3).
   732             20  HOLD-CEN-1-CCYY.
   733                 24  HOLD-CEN-1-CC     PIC 99.
   734                 24  HOLD-CEN-1-YY     PIC 99.
   735             20  HOLD-CEN-1-MO         PIC 99.
   736             20  HOLD-CEN-1-DA         PIC 99.
   737         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   738             20  HOLD-CEN-1-R-MO       PIC 99.
   739             20  HOLD-CEN-1-R-DA       PIC 99.
   740             20  HOLD-CEN-1-R-CCYY.
   741                 24  HOLD-CEN-1-R-CC   PIC 99.
   742                 24  HOLD-CEN-1-R-YY   PIC 99.
   743             20  FILLER                PIC 9(3).
   744         16  HOLD-CENTURY-1-X.
   745             20  FILLER                PIC X(3)  VALUE SPACES.
   746             20  HOLD-CEN-1-X-CCYY.
   747                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   748                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   749             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   750             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   751         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   752             20  HOLD-CEN-1-R-X-MO     PIC XX.
   753             20  HOLD-CEN-1-R-X-DA     PIC XX.
   754             20  HOLD-CEN-1-R-X-CCYY.
   755                 24  HOLD-CEN-1-R-X-CC PIC XX.
   756                 24  HOLD-CEN-1-R-X-YY PIC XX.
   757             20  FILLER                PIC XXX.
   758         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   759         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   760         16  DC-JULIAN-DATE-1          PIC 9(07).
   761         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   762             20  DC-JULIAN-1-CCYY.
   763                 24  DC-JULIAN-1-CC    PIC 99.
   764                 24  DC-JULIAN-1-YR    PIC 99.
   765             20  DC-JULIAN-DA-1        PIC 999.
   766         16  DC-JULIAN-DATE-2          PIC 9(07).
   767         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   768             20  DC-JULIAN-2-CCYY.
   769                 24  DC-JULIAN-2-CC    PIC 99.
   770                 24  DC-JULIAN-2-YR    PIC 99.
   771             20  DC-JULIAN-DA-2        PIC 999.
   772         16  DC-GREG-DATE-A-EDIT.
   773             20  DC-EDITA-MONTH        PIC 99.
   774             20  SLASHA-1              PIC X VALUE '/'.
   775             20  DC-EDITA-DAY          PIC 99.
   776             20  SLASHA-2              PIC X VALUE '/'.
   777             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  16
* EL1278.cbl
   778                 24  DC-EDITA-CENT     PIC 99.
   779                 24  DC-EDITA-YEAR     PIC 99.
   780         16  DC-GREG-DATE-B-EDIT.
   781             20  DC-EDITB-MONTH        PIC 99.
   782             20  SLASHB-1              PIC X VALUE '/'.
   783             20  DC-EDITB-DAY          PIC 99.
   784             20  SLASHB-2              PIC X VALUE '/'.
   785             20  DC-EDITB-CCYY.
   786                 24  DC-EDITB-CENT     PIC 99.
   787                 24  DC-EDITB-YEAR     PIC 99.
   788         16  DC-GREG-DATE-CYMD         PIC 9(08).
   789         16  DC-GREG-DATE-CYMD-R REDEFINES
   790                              DC-GREG-DATE-CYMD.
   791             20  DC-CYMD-CEN           PIC 99.
   792             20  DC-CYMD-YEAR          PIC 99.
   793             20  DC-CYMD-MONTH         PIC 99.
   794             20  DC-CYMD-DAY           PIC 99.
   795         16  DC-GREG-DATE-MDCY         PIC 9(08).
   796         16  DC-GREG-DATE-MDCY-R REDEFINES
   797                              DC-GREG-DATE-MDCY.
   798             20  DC-MDCY-MONTH         PIC 99.
   799             20  DC-MDCY-DAY           PIC 99.
   800             20  DC-MDCY-CEN           PIC 99.
   801             20  DC-MDCY-YEAR          PIC 99.
   802    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   803        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   804    12  DC-EL310-DATE                  PIC X(21).
   805    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  17
* EL1278.cbl
   807*                            COPY ELCLOGOF.
   808******************************************************************
   809*                                                                *
   810*                                                                *
   811*                            ELCLOGOF.                           *
   812*                            VMOD=2.001                          *
   813*                                                                *
   814*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   815*                                                                *
   816******************************************************************
   817 01  CLASIC-LOGOFF.
   818     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   819     12  LOGOFF-TEXT.
   820         16  FILLER          PIC X(5)    VALUE SPACES.
   821         16  LOGOFF-MSG.
   822             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   823             20  FILLER      PIC X       VALUE SPACES.
   824             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   825         16  FILLER          PIC X(80)
   826           VALUE '* YOU ARE NOW LOGGED OFF'.
   827         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   828         16  FILLER          PIC X       VALUE QUOTE.
   829         16  LOGOFF-SYS-MSG  PIC X(17)
   830           VALUE 'S CLAS-IC SYSTEM '.
   831     12  TEXT-MESSAGES.
   832         16  UNACCESS-MSG    PIC X(29)
   833             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   834         16  PGMIDERR-MSG    PIC X(17)
   835             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  18
* EL1278.cbl
   837*                            COPY ELCATTR.
   838******************************************************************
   839*                                                                *
   840*                            ELCATTR.                            *
   841*                            VMOD=2.001                          *
   842*                                                                *
   843*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   844*                                                                *
   845*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   846*                                                                *
   847*                   POS 1   P=PROTECTED                          *
   848*                           U=UNPROTECTED                        *
   849*                           S=ASKIP                              *
   850*                   POS 2   A=ALPHA/NUMERIC                      *
   851*                           N=NUMERIC                            *
   852*                   POS 3   N=NORMAL                             *
   853*                           B=BRIGHT                             *
   854*                           D=DARK                               *
   855*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   856*                           OF=MODIFIED DATA TAG OFF             *
   857*                                                                *
   858*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   859******************************************************************
   860 01  ATTRIBUTE-LIST.
   861     12  AL-PABOF            PIC X       VALUE 'Y'.
   862     12  AL-PABON            PIC X       VALUE 'Z'.
   863     12  AL-PADOF            PIC X       VALUE '%'.
   864     12  AL-PADON            PIC X       VALUE '_'.
   865     12  AL-PANOF            PIC X       VALUE '-'.
   866     12  AL-PANON            PIC X       VALUE '/'.
   867     12  AL-SABOF            PIC X       VALUE '8'.
   868     12  AL-SABON            PIC X       VALUE '9'.
   869     12  AL-SADOF            PIC X       VALUE '@'.
   870     12  AL-SADON            PIC X       VALUE QUOTE.
   871     12  AL-SANOF            PIC X       VALUE '0'.
   872     12  AL-SANON            PIC X       VALUE '1'.
   873     12  AL-UABOF            PIC X       VALUE 'H'.
   874     12  AL-UABON            PIC X       VALUE 'I'.
   875     12  AL-UADOF            PIC X       VALUE '<'.
   876     12  AL-UADON            PIC X       VALUE '('.
   877     12  AL-UANOF            PIC X       VALUE ' '.
   878     12  AL-UANON            PIC X       VALUE 'A'.
   879     12  AL-UNBOF            PIC X       VALUE 'Q'.
   880     12  AL-UNBON            PIC X       VALUE 'R'.
   881     12  AL-UNDOF            PIC X       VALUE '*'.
   882     12  AL-UNDON            PIC X       VALUE ')'.
   883     12  AL-UNNOF            PIC X       VALUE '&'.
   884     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  19
* EL1278.cbl
   886*                            COPY ELCEMIB.
   887******************************************************************
   888*                                                                *
   889*                                                                *
   890*                            ELCEMIB.                            *
   891*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   892*                            VMOD=2.005                          *
   893*                                                                *
   894*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   895*                                                                *
   896******************************************************************
   897 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   898     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   899     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   900     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   901     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   902     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   903     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   904     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   905     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   906     12  EMI-SWITCH1             PIC X        VALUE '1'.
   907         88  EMI-NO-ERRORS                    VALUE '1'.
   908         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   909         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   910     12  EMI-SWITCH2             PIC X        VALUE '1'.
   911         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   912     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   913         88  EMI-AREA1-EMPTY                  VALUE '1'.
   914         88  EMI-AREA1-FULL                   VALUE '2'.
   915     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   916         88  EMI-AREA2-EMPTY                  VALUE '1'.
   917         88  EMI-AREA2-FULL                   VALUE '2'.
   918     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   919         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   920         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   921         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   922         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   923         88  EMI-BYPASS-FATALS                VALUE 'X'.
   924     12  EMI-ERROR-LINES.
   925         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   926         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   927         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   928         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   929             20  EMI-ERR-CODES OCCURS 10 TIMES.
   930                 24  EMI-ERR-NUM         PIC X(4).
   931                 24  EMI-FILLER          PIC X.
   932                 24  EMI-SEV             PIC X.
   933                 24  FILLER              PIC X.
   934             20  FILLER                  PIC X(02).
   935     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   936         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   937             20  EMI-ERROR-NUMBER    PIC X(4).
   938             20  EMI-FILL            PIC X.
   939             20  EMI-SEVERITY        PIC X.
   940             20  FILLER              PIC X.
   941             20  EMI-ERROR-TEXT.
   942                 24  EMI-TEXT-VARIABLE   PIC X(10).
   943                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  20
* EL1278.cbl
   944     12  EMI-SEVERITY-SAVE           PIC X.
   945         88  EMI-NOTE                    VALUE 'N'.
   946         88  EMI-WARNING                 VALUE 'W'.
   947         88  EMI-FORCABLE                VALUE 'F'.
   948         88  EMI-FATAL                   VALUE 'X'.
   949     12  EMI-MESSAGE-FLAG            PIC X.
   950         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   951         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   952     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   953     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   954         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   955         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   956         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   957     12  FILLER                      PIC X(137)  VALUE SPACES.
   958     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   959     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   960     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   961     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  21
* EL1278.cbl
   963 01  WS-PASS-631.
   964     12  WS-PASS-WORK-AREA         PIC X(384).
   965     12  WS-PASS-PROGRAM-WORK-AREA PIC X(640).
   966     12  FILLER REDEFINES WS-PASS-PROGRAM-WORK-AREA.
   967*        COPY ELC631PI.
   968******************************************************************
   969*                                                                *
   970*                                                                *
   971*                            ELC631PI                            *
   972*                            VMOD=2.012                          *
   973*                                                                *
   974*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   975*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
   976*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   977*                                                                *
   978*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   979*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   980*    BETWEEN PROGRAMS.                                           *
   981*                                                                *
   982*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   983*                                                                *
   984*               EL631 - EL6311 - EL6312 - EL6313                 *
   985*                                                                *
   986******************************************************************
   987
   988         16  PI-631-DATA.
   989             20  PI-ERPNDB-KEY.
   990                 24  PI-PB-COMPANY-CD     PIC X.
   991                 24  PI-PB-ENTRY-BATCH    PIC X(6).
   992                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
   993                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
   994
   995             20  PI-ERPNDB-ALT-KEY.
   996                 24  PI-PB-COMPANY-CD-A1  PIC X.
   997                 24  PI-PB-CARRIER        PIC X.
   998                 24  PI-PB-GROUPING       PIC X(6).
   999                 24  PI-PB-STATE          PIC XX.
  1000                 24  PI-PB-ACCOUNT        PIC X(10).
  1001                 24  PI-PB-CERT-EFF-DT    PIC XX.
  1002                 24  PI-PB-CERT-NO.
  1003                     28  PI-PB-CERT-PRIME PIC X(10).
  1004                     28  PI-PB-CERT-SFX   PIC X.
  1005                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  1006                 24  PI-PB-RECORD-TYPE    PIC X.
  1007
  1008             20  PI-ERPNDB-CSR-KEY.
  1009                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  1010                 24  PI-PB-CSR-ID             PIC X(4).
  1011                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  1012                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  1013                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  1014
  1015             20  PI-BROWSE-TYPE               PIC X.
  1016                 88  PI-FILE-BROWSE             VALUE ' '.
  1017                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  1018                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  1019                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  1020                 88  PI-CSR-BROWSE              VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  22
* EL1278.cbl
  1021
  1022             20  PI-MAINT-FUNCTION            PIC X.
  1023                 88  PI-ADD-FUNCTION            VALUE 'A'.
  1024                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  1025                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  1026                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  1027                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  1028                 88  PI-PF5-FUNCTION            VALUE '5'.
  1029                 88  PI-PF6-FUNCTION            VALUE '6'.
  1030
  1031             20  PI-FILE-SWITCHES.
  1032                 24  PI-ALL-ISSUES-SW         PIC X.
  1033                     88  ALL-ISSUES             VALUE 'Y'.
  1034                 24  PI-ALL-CANCELS-SW        PIC X.
  1035                     88  ALL-CANCELS            VALUE 'Y'.
  1036                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  1037                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  1038                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  1039                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  1040                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  1041                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  1042                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  1043                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  1044                 24  PI-HOLD-REC-SW           PIC X.
  1045                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  1046                 24  PI-CHANGE-REC-SW         PIC X.
  1047                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  1048                 24  PI-CHK-REQ-REC-SW        PIC X.
  1049                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  1050                 24  PI-ISSUE-WARNING-SW      PIC X.
  1051                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  1052                 24  PI-CANCEL-WARNING-SW     PIC X.
  1053                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  1054             20  PI-DISPLAY-SCREEN-SW         PIC X.
  1055                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  1056             20  PI-ORIGINAL-BATCH-SW         PIC X.
  1057                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  1058
  1059             20  PI-MAP-NAME                  PIC X(8).
  1060
  1061             20  PI-CURSOR                    PIC S9(4) COMP.
  1062
  1063             20  PI-PREV-ALT-KEY              PIC X(36).
  1064             20  PI-PREV-CSR-KEY              PIC X(15).
  1065             20  PI-PREV-KEY.
  1066                 24  PI-PREV-COMPANY-CD       PIC X.
  1067                 24  PI-PREV-BATCH            PIC X(6).
  1068                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  1069                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  1070             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  1071             20  PI-BROWSE-SW                 PIC X.
  1072                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  1073                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  1074             20  PI-SV-CARRIER                PIC X.
  1075             20  PI-SV-GROUPING               PIC X(6).
  1076             20  PI-SV-STATE                  PIC XX.
  1077             20  PI-EDIT-SW                   PIC X.
  1078             20  PI-DISPLAY-SW                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  23
* EL1278.cbl
  1079                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  1080                 88 PI-DISPLAY-AH          VALUE 'AH'.
  1081             20  PI-CRITERIA-DATA             PIC X(350).
  1082             20  PI-BMODE                     PIC X.
  1083             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  1084             20  PI-BPMTS                     PIC S999     COMP-3.
  1085             20  PI-BTYPE                     PIC XXX OCCURS 2.
  1086             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  1087             20  PI-CSR-SESSION-SW            PIC X.
  1088                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  1089             20  PI-ERRORS-SW                 PIC X.
  1090                 88  FATAL-ERRORS               VALUE 'X'.
  1091*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  1092             20  FILLER                       PIC X(5).
  1093
  1094         16  FILLER                PIC X(94).
  1095
  1096
  1097*                            COPY ELCINTF.
  1098******************************************************************
  1099*                                                                *
  1100*                                                                *
  1101*                            ELCINTF.                            *
  1102*                            VMOD=2.017                          *
  1103*                                                                *
  1104*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1105*                                                                *
  1106*       LENGTH = 1024                                            *
  1107*                                                                *
  1108******************************************************************
  1109*                   C H A N G E   L O G
  1110*
  1111* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1112*-----------------------------------------------------------------
  1113*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1114* EFFECTIVE    NUMBER
  1115*-----------------------------------------------------------------
  1116* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1117******************************************************************
  1118 01  PROGRAM-INTERFACE-BLOCK.
  1119     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1120     12  PI-CALLING-PROGRAM              PIC X(8).
  1121     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1122     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1123     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1124     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1125     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1126     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1127     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1128     12  PI-COMPANY-ID                   PIC XXX.
  1129     12  PI-COMPANY-CD                   PIC X.
  1130
  1131     12  PI-COMPANY-PASSWORD             PIC X(8).
  1132
  1133     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1134
  1135     12  PI-CONTROL-IN-PROGRESS.
  1136         16  PI-CARRIER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  24
* EL1278.cbl
  1137         16  PI-GROUPING                 PIC X(6).
  1138         16  PI-STATE                    PIC XX.
  1139         16  PI-ACCOUNT                  PIC X(10).
  1140         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1141                                         PIC X(10).
  1142         16  PI-CLAIM-CERT-GRP.
  1143             20  PI-CLAIM-NO             PIC X(7).
  1144             20  PI-CERT-NO.
  1145                 25  PI-CERT-PRIME       PIC X(10).
  1146                 25  PI-CERT-SFX         PIC X.
  1147             20  PI-CERT-EFF-DT          PIC XX.
  1148         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1149             20  PI-PLAN-CODE            PIC X(2).
  1150             20  PI-REVISION-NUMBER      PIC X(3).
  1151             20  PI-PLAN-EFF-DT          PIC X(2).
  1152             20  PI-PLAN-EXP-DT          PIC X(2).
  1153             20  FILLER                  PIC X(11).
  1154         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1155             20  PI-OE-REFERENCE-1.
  1156                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1157                 25  PI-OE-REF-1-SUFF    PIC XX.
  1158
  1159     12  PI-SESSION-IN-PROGRESS          PIC X.
  1160         88  CLAIM-SESSION                   VALUE '1'.
  1161         88  CREDIT-SESSION                  VALUE '2'.
  1162         88  WARRANTY-SESSION                VALUE '3'.
  1163         88  MORTGAGE-SESSION                VALUE '4'.
  1164         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1165
  1166
  1167*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1168
  1169     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1170     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1171
  1172     12  PI-CREDIT-USER                  PIC X.
  1173         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1174         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1175
  1176     12  PI-CLAIM-USER                   PIC X.
  1177         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1178         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1179
  1180     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1181         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1182         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1183         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1184         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1185         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1186
  1187     12  PI-PROCESSOR-ID                 PIC X(4).
  1188
  1189     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1190
  1191     12  PI-MEMBER-CAPTION               PIC X(10).
  1192
  1193     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1194         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  25
* EL1278.cbl
  1195
  1196     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1197     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1198     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1199     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1200
  1201     12  PI-AH-OVERRIDE-L1               PIC X.
  1202     12  PI-AH-OVERRIDE-L2               PIC XX.
  1203     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1204     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1205
  1206     12  PI-NEW-SYSTEM                   PIC X(2).
  1207
  1208     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1209     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1210         88  PI-USES-PAID-TO                 VALUE '1'.
  1211     12  PI-CRDTCRD-SYSTEM.
  1212         16  PI-CRDTCRD-USER             PIC X.
  1213             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1214             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1215         16  PI-CC-MONTH-END-DT          PIC XX.
  1216     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1217
  1218     12  PI-OE-REFERENCE-2.
  1219         16  PI-OE-REF-2-PRIME           PIC X(10).
  1220         16  PI-OE-REF-2-SUFF            PIC X.
  1221
  1222     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1223
  1224     12  PI-LANGUAGE-TYPE                PIC X.
  1225             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1226             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1227             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1228
  1229     12  PI-POLICY-LINKAGE-IND           PIC X.
  1230         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1231         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1232                                                   LOW-VALUES.
  1233
  1234     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1235     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1236         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1237         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1238
  1239     12  PI-PROCESSOR-CSR-IND            PIC X.
  1240         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1241         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1242
  1243     12  FILLER                          PIC X(3).
  1244
  1245     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1246
  1247     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1248         PI-SYSTEM-LEVEL.
  1249
  1250         16  PI-ENTRY-CODES.
  1251             20  PI-ENTRY-CD-1           PIC X.
  1252             20  PI-ENTRY-CD-2           PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  26
* EL1278.cbl
  1253
  1254         16  PI-RETURN-CODES.
  1255             20  PI-RETURN-CD-1          PIC X.
  1256             20  PI-RETURN-CD-2          PIC X.
  1257
  1258         16  PI-UPDATE-STATUS-SAVE.
  1259             20  PI-UPDATE-BY            PIC X(4).
  1260             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1261
  1262         16  PI-LOWER-CASE-LETTERS       PIC X.
  1263             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1264
  1265*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1266*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1267*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1268
  1269         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1270             88  ST-ACCNT-CNTL               VALUE ' '.
  1271             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1272             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1273             88  ACCNT-CNTL                  VALUE '3'.
  1274             88  CARR-ACCNT-CNTL             VALUE '4'.
  1275
  1276         16  PI-PROCESSOR-CAP-LIST.
  1277             20  PI-SYSTEM-CONTROLS.
  1278                24 PI-SYSTEM-DISPLAY     PIC X.
  1279                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1280                24 PI-SYSTEM-MODIFY      PIC X.
  1281                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1282             20  FILLER                  PIC XX.
  1283             20  PI-DISPLAY-CAP          PIC X.
  1284                 88  DISPLAY-CAP             VALUE 'Y'.
  1285             20  PI-MODIFY-CAP           PIC X.
  1286                 88  MODIFY-CAP              VALUE 'Y'.
  1287             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1288                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1289             20  PI-FORCE-CAP            PIC X.
  1290                 88  FORCE-CAP               VALUE 'Y'.
  1291
  1292         16  PI-PROGRAM-CONTROLS.
  1293             20  PI-PGM-PRINT-OPT        PIC X.
  1294             20  PI-PGM-FORMAT-OPT       PIC X.
  1295             20  PI-PGM-PROCESS-OPT      PIC X.
  1296             20  PI-PGM-TOTALS-OPT       PIC X.
  1297
  1298         16  PI-HELP-INTERFACE.
  1299             20  PI-LAST-ERROR-NO        PIC X(4).
  1300             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1301
  1302         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1303             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1304
  1305         16  PI-CR-CONTROL-IN-PROGRESS.
  1306             20  PI-CR-CARRIER           PIC X.
  1307             20  PI-CR-GROUPING          PIC X(6).
  1308             20  PI-CR-STATE             PIC XX.
  1309             20  PI-CR-ACCOUNT           PIC X(10).
  1310             20  PI-CR-FIN-RESP          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  27
* EL1278.cbl
  1311             20  PI-CR-TYPE              PIC X.
  1312
  1313         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1314
  1315         16  PI-CR-MONTH-END-DT          PIC XX.
  1316
  1317         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1318             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1319             88  PI-ZERO-CARRIER             VALUE '1'.
  1320             88  PI-ZERO-GROUPING            VALUE '2'.
  1321             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1322
  1323         16  PI-CARRIER-SECURITY         PIC X.
  1324             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1325
  1326         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1327             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1328             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1329
  1330         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1331             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1332                                         INDEXED BY PI-ACCESS-NDX
  1333                                         PIC X.
  1334
  1335         16  PI-GA-BILLING-CONTROL       PIC X.
  1336             88  PI-GA-BILLING               VALUE '1'.
  1337
  1338         16  PI-MAIL-PROCESSING          PIC X.
  1339             88  PI-MAIL-YES                 VALUE 'Y'.
  1340
  1341         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1342
  1343         16  PI-AR-SYSTEM.
  1344             20  PI-AR-PROCESSING-CNTL   PIC X.
  1345                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1346             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1347             20  PI-AR-MONTH-END-DT      PIC XX.
  1348
  1349         16  PI-MP-SYSTEM.
  1350             20  PI-MORTGAGE-USER            PIC X.
  1351                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1352                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1353             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1354                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1355                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1356                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1357                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1358                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1359             20  PI-MP-MONTH-END-DT          PIC XX.
  1360             20  PI-MP-REFERENCE-NO.
  1361                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1362                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1363
  1364         16  PI-LABEL-CONTROL            PIC X(01).
  1365             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1366             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1367
  1368         16  PI-BILL-GROUPING-CODE       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  28
* EL1278.cbl
  1369             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1370
  1371         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1372             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1373             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1374
  1375         16  FILLER                      PIC X(14).
  1376
  1377     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1378******************************************************************
  1379     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1380         16  FILLER                PIC  X(500).
  1381         16  PI-PEND-SW            PIC  X(01).
  1382         16  PI-LF-CANCEL-DATE     PIC  X(02).
  1383         16  PI-AH-CANCEL-DATE     PIC  X(02).
  1384         16  PI-LF-CANCEL-DATE-ED  PIC  X(08).
  1385         16  PI-AH-CANCEL-DATE-ED  PIC  X(08).
  1386         16  PI-EARNING-METHOD-LF  PIC  X.
  1387         16  PI-EARNING-METHOD-AH  PIC  X.
  1388         16  PI-LF-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1389         16  PI-LF-REFUND-METH     PIC  X.
  1390         16  PI-AH-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1391         16  PI-AH-REFUND-METH     PIC  X.
  1392         16  PI-TOTAL-REFUND-AMT   PIC  S9(7)V99 COMP-3.
  1393         16  PI-MODIFY-CERT-CAP    PIC  X.
  1394             88 MODIFY-CERT-CAP    VALUE 'Y'.
  1395         16  PI-CLP-YN             PIC X.
  1396         16  PI-CANCEL-REASON      PIC X.
  1397         16  FILLER                PIC  X(97).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  29
* EL1278.cbl
  1399*                            COPY ELCAID.
  1400******************************************************************
  1401*                                                                *
  1402*                            ELCAID.                             *
  1403*                            VMOD=2.001                          *
  1404*                                                                *
  1405*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1406*                                                                *
  1407*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1408*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1409******************************************************************
  1410
  1411 01  DFHAID.
  1412   02  DFHNULL   PIC  X  VALUE  ' '.
  1413   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1414   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1415   02  DFHPEN    PIC  X  VALUE  '='.
  1416   02  DFHOPID   PIC  X  VALUE  'W'.
  1417   02  DFHPA1    PIC  X  VALUE  '%'.
  1418   02  DFHPA2    PIC  X  VALUE  '>'.
  1419   02  DFHPA3    PIC  X  VALUE  ','.
  1420   02  DFHPF1    PIC  X  VALUE  '1'.
  1421   02  DFHPF2    PIC  X  VALUE  '2'.
  1422   02  DFHPF3    PIC  X  VALUE  '3'.
  1423   02  DFHPF4    PIC  X  VALUE  '4'.
  1424   02  DFHPF5    PIC  X  VALUE  '5'.
  1425   02  DFHPF6    PIC  X  VALUE  '6'.
  1426   02  DFHPF7    PIC  X  VALUE  '7'.
  1427   02  DFHPF8    PIC  X  VALUE  '8'.
  1428   02  DFHPF9    PIC  X  VALUE  '9'.
  1429   02  DFHPF10   PIC  X  VALUE  ':'.
  1430   02  DFHPF11   PIC  X  VALUE  '#'.
  1431   02  DFHPF12   PIC  X  VALUE  '@'.
  1432   02  DFHPF13   PIC  X  VALUE  'A'.
  1433   02  DFHPF14   PIC  X  VALUE  'B'.
  1434   02  DFHPF15   PIC  X  VALUE  'C'.
  1435   02  DFHPF16   PIC  X  VALUE  'D'.
  1436   02  DFHPF17   PIC  X  VALUE  'E'.
  1437   02  DFHPF18   PIC  X  VALUE  'F'.
  1438   02  DFHPF19   PIC  X  VALUE  'G'.
  1439   02  DFHPF20   PIC  X  VALUE  'H'.
  1440   02  DFHPF21   PIC  X  VALUE  'I'.
  1441*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1442   02  DFHPF22   PIC  X  VALUE  '['.
  1443   02  DFHPF23   PIC  X  VALUE  '.'.
  1444   02  DFHPF24   PIC  X  VALUE  '<'.
  1445   02  DFHMSRE   PIC  X  VALUE  'X'.
  1446   02  DFHSTRF   PIC  X  VALUE  'h'.
  1447   02  DFHTRIG   PIC  X  VALUE  '"'.
  1448
  1449 01  FILLER  REDEFINES  DFHAID.
  1450     12  FILLER                  PIC  X(08).
  1451     12  PF-VALUES               PIC  X(01)      OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  30
* EL1278.cbl
  1453*                            COPY EL1278S.
  1454 01  EL127HI.
  1455     05  FILLER            PIC  X(0012).
  1456*    -------------------------------
  1457     05  HDATEL PIC S9(0004) COMP.
  1458     05  HDATEF PIC  X(0001).
  1459     05  FILLER REDEFINES HDATEF.
  1460         10  HDATEA PIC  X(0001).
  1461     05  HDATEI PIC  X(0008).
  1462*    -------------------------------
  1463     05  HTIMEL PIC S9(0004) COMP.
  1464     05  HTIMEF PIC  X(0001).
  1465     05  FILLER REDEFINES HTIMEF.
  1466         10  HTIMEA PIC  X(0001).
  1467     05  HTIMEI PIC  999V99.
  1468*    -------------------------------
  1469     05  CMPNYIDL PIC S9(0004) COMP.
  1470     05  CMPNYIDF PIC  X(0001).
  1471     05  FILLER REDEFINES CMPNYIDF.
  1472         10  CMPNYIDA PIC  X(0001).
  1473     05  CMPNYIDI PIC  X(0003).
  1474*    -------------------------------
  1475     05  USERIDL PIC S9(0004) COMP.
  1476     05  USERIDF PIC  X(0001).
  1477     05  FILLER REDEFINES USERIDF.
  1478         10  USERIDA PIC  X(0001).
  1479     05  USERIDI PIC  X(0004).
  1480*    -------------------------------
  1481     05  HCARIERL PIC S9(0004) COMP.
  1482     05  HCARIERF PIC  X(0001).
  1483     05  FILLER REDEFINES HCARIERF.
  1484         10  HCARIERA PIC  X(0001).
  1485     05  HCARIERI PIC  X(0001).
  1486*    -------------------------------
  1487     05  HGROUPL PIC S9(0004) COMP.
  1488     05  HGROUPF PIC  X(0001).
  1489     05  FILLER REDEFINES HGROUPF.
  1490         10  HGROUPA PIC  X(0001).
  1491     05  HGROUPI PIC  X(0006).
  1492*    -------------------------------
  1493     05  HSTATEL PIC S9(0004) COMP.
  1494     05  HSTATEF PIC  X(0001).
  1495     05  FILLER REDEFINES HSTATEF.
  1496         10  HSTATEA PIC  X(0001).
  1497     05  HSTATEI PIC  X(0002).
  1498*    -------------------------------
  1499     05  HACCTNOL PIC S9(0004) COMP.
  1500     05  HACCTNOF PIC  X(0001).
  1501     05  FILLER REDEFINES HACCTNOF.
  1502         10  HACCTNOA PIC  X(0001).
  1503     05  HACCTNOI PIC  X(0010).
  1504*    -------------------------------
  1505     05  HEFFDTL PIC S9(0004) COMP.
  1506     05  HEFFDTF PIC  X(0001).
  1507     05  FILLER REDEFINES HEFFDTF.
  1508         10  HEFFDTA PIC  X(0001).
  1509     05  HEFFDTI PIC  X(0008).
  1510*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  31
* EL1278.cbl
  1511     05  HCERTNOL PIC S9(0004) COMP.
  1512     05  HCERTNOF PIC  X(0001).
  1513     05  FILLER REDEFINES HCERTNOF.
  1514         10  HCERTNOA PIC  X(0001).
  1515     05  HCERTNOI PIC  X(0010).
  1516*    -------------------------------
  1517     05  HCRTSFXL PIC S9(0004) COMP.
  1518     05  HCRTSFXF PIC  X(0001).
  1519     05  FILLER REDEFINES HCRTSFXF.
  1520         10  HCRTSFXA PIC  X(0001).
  1521     05  HCRTSFXI PIC  X(0001).
  1522*    -------------------------------
  1523     05  HLNAMEL PIC S9(0004) COMP.
  1524     05  HLNAMEF PIC  X(0001).
  1525     05  FILLER REDEFINES HLNAMEF.
  1526         10  HLNAMEA PIC  X(0001).
  1527     05  HLNAMEI PIC  X(0015).
  1528*    -------------------------------
  1529     05  HFNAMEL PIC S9(0004) COMP.
  1530     05  HFNAMEF PIC  X(0001).
  1531     05  FILLER REDEFINES HFNAMEF.
  1532         10  HFNAMEA PIC  X(0001).
  1533     05  HFNAMEI PIC  X(0010).
  1534*    -------------------------------
  1535     05  HINITL PIC S9(0004) COMP.
  1536     05  HINITF PIC  X(0001).
  1537     05  FILLER REDEFINES HINITF.
  1538         10  HINITA PIC  X(0001).
  1539     05  HINITI PIC  X(0001).
  1540*    -------------------------------
  1541     05  LCLMDTHL PIC S9(0004) COMP.
  1542     05  LCLMDTHF PIC  X(0001).
  1543     05  FILLER REDEFINES LCLMDTHF.
  1544         10  LCLMDTHA PIC  X(0001).
  1545     05  LCLMDTHI PIC  X(0022).
  1546*    -------------------------------
  1547     05  LCLMDTL PIC S9(0004) COMP.
  1548     05  LCLMDTF PIC  X(0001).
  1549     05  FILLER REDEFINES LCLMDTF.
  1550         10  LCLMDTA PIC  X(0001).
  1551     05  LCLMDTI PIC  X(0008).
  1552*    -------------------------------
  1553     05  HPCYNL PIC S9(0004) COMP.
  1554     05  HPCYNF PIC  X(0001).
  1555     05  FILLER REDEFINES HPCYNF.
  1556         10  HPCYNA PIC  X(0001).
  1557     05  HPCYNI PIC  X(0001).
  1558*    -------------------------------
  1559     05  ACLMDTHL PIC S9(0004) COMP.
  1560     05  ACLMDTHF PIC  X(0001).
  1561     05  FILLER REDEFINES ACLMDTHF.
  1562         10  ACLMDTHA PIC  X(0001).
  1563     05  ACLMDTHI PIC  X(0023).
  1564*    -------------------------------
  1565     05  ACLMDTL PIC S9(0004) COMP.
  1566     05  ACLMDTF PIC  X(0001).
  1567     05  FILLER REDEFINES ACLMDTF.
  1568         10  ACLMDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  32
* EL1278.cbl
  1569     05  ACLMDTI PIC  X(0008).
  1570*    -------------------------------
  1571     05  PMTHDL PIC S9(0004) COMP.
  1572     05  PMTHDF PIC  X(0001).
  1573     05  FILLER REDEFINES PMTHDF.
  1574         10  PMTHDA PIC  X(0001).
  1575     05  PMTHDI PIC  X(0010).
  1576*    -------------------------------
  1577     05  CNCDTHDL PIC S9(0004) COMP.
  1578     05  CNCDTHDF PIC  X(0001).
  1579     05  FILLER REDEFINES CNCDTHDF.
  1580         10  CNCDTHDA PIC  X(0001).
  1581     05  CNCDTHDI PIC  X(0007).
  1582*    -------------------------------
  1583     05  HLKINDL PIC S9(0004) COMP.
  1584     05  HLKINDF PIC  X(0001).
  1585     05  FILLER REDEFINES HLKINDF.
  1586         10  HLKINDA PIC  X(0001).
  1587     05  HLKINDI PIC  X(0002).
  1588*    -------------------------------
  1589     05  HLCDL PIC S9(0004) COMP.
  1590     05  HLCDF PIC  X(0001).
  1591     05  FILLER REDEFINES HLCDF.
  1592         10  HLCDA PIC  X(0001).
  1593     05  HLCDI PIC  X(0002).
  1594*    -------------------------------
  1595     05  HLEDESCL PIC S9(0004) COMP.
  1596     05  HLEDESCF PIC  X(0001).
  1597     05  FILLER REDEFINES HLEDESCF.
  1598         10  HLEDESCA PIC  X(0001).
  1599     05  HLEDESCI PIC  X(0003).
  1600*    -------------------------------
  1601     05  HLTERML PIC S9(0004) COMP.
  1602     05  HLTERMF PIC  X(0001).
  1603     05  FILLER REDEFINES HLTERMF.
  1604         10  HLTERMA PIC  X(0001).
  1605     05  HLTERMI PIC  9(3).
  1606*    -------------------------------
  1607     05  HLREML PIC S9(0004) COMP.
  1608     05  HLREMF PIC  X(0001).
  1609     05  FILLER REDEFINES HLREMF.
  1610         10  HLREMA PIC  X(0001).
  1611     05  HLREMI PIC  X(0003).
  1612*    -------------------------------
  1613     05  HLPREML PIC S9(0004) COMP.
  1614     05  HLPREMF PIC  X(0001).
  1615     05  FILLER REDEFINES HLPREMF.
  1616         10  HLPREMA PIC  X(0001).
  1617     05  HLPREMI PIC  X(0011).
  1618*    -------------------------------
  1619     05  HLITDRL PIC S9(0004) COMP.
  1620     05  HLITDRF PIC  X(0001).
  1621     05  FILLER REDEFINES HLITDRF.
  1622         10  HLITDRA PIC  X(0001).
  1623     05  HLITDRI PIC  X(0011).
  1624*    -------------------------------
  1625     05  HLREFNDL PIC S9(0004) COMP.
  1626     05  HLREFNDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  33
* EL1278.cbl
  1627     05  FILLER REDEFINES HLREFNDF.
  1628         10  HLREFNDA PIC  X(0001).
  1629     05  HLREFNDI PIC  X(0011).
  1630*    -------------------------------
  1631     05  HLCANCL PIC S9(0004) COMP.
  1632     05  HLCANCF PIC  X(0001).
  1633     05  FILLER REDEFINES HLCANCF.
  1634         10  HLCANCA PIC  X(0001).
  1635     05  HLCANCI PIC  X(0008).
  1636*    -------------------------------
  1637     05  HLCAL1L PIC S9(0004) COMP.
  1638     05  HLCAL1F PIC  X(0001).
  1639     05  FILLER REDEFINES HLCAL1F.
  1640         10  HLCAL1A PIC  X(0001).
  1641     05  HLCAL1I PIC  X(0001).
  1642*    -------------------------------
  1643     05  HLCALCL PIC S9(0004) COMP.
  1644     05  HLCALCF PIC  X(0001).
  1645     05  FILLER REDEFINES HLCALCF.
  1646         10  HLCALCA PIC  X(0001).
  1647     05  HLCALCI PIC  X(0012).
  1648*    -------------------------------
  1649     05  HAKINDL PIC S9(0004) COMP.
  1650     05  HAKINDF PIC  X(0001).
  1651     05  FILLER REDEFINES HAKINDF.
  1652         10  HAKINDA PIC  X(0001).
  1653     05  HAKINDI PIC  X(0002).
  1654*    -------------------------------
  1655     05  HACDL PIC S9(0004) COMP.
  1656     05  HACDF PIC  X(0001).
  1657     05  FILLER REDEFINES HACDF.
  1658         10  HACDA PIC  X(0001).
  1659     05  HACDI PIC  X(0002).
  1660*    -------------------------------
  1661     05  HAEDESCL PIC S9(0004) COMP.
  1662     05  HAEDESCF PIC  X(0001).
  1663     05  FILLER REDEFINES HAEDESCF.
  1664         10  HAEDESCA PIC  X(0001).
  1665     05  HAEDESCI PIC  X(0003).
  1666*    -------------------------------
  1667     05  HATERML PIC S9(0004) COMP.
  1668     05  HATERMF PIC  X(0001).
  1669     05  FILLER REDEFINES HATERMF.
  1670         10  HATERMA PIC  X(0001).
  1671     05  HATERMI PIC  9(3).
  1672*    -------------------------------
  1673     05  HAREML PIC S9(0004) COMP.
  1674     05  HAREMF PIC  X(0001).
  1675     05  FILLER REDEFINES HAREMF.
  1676         10  HAREMA PIC  X(0001).
  1677     05  HAREMI PIC  X(0003).
  1678*    -------------------------------
  1679     05  HAPREML PIC S9(0004) COMP.
  1680     05  HAPREMF PIC  X(0001).
  1681     05  FILLER REDEFINES HAPREMF.
  1682         10  HAPREMA PIC  X(0001).
  1683     05  HAPREMI PIC  X(0011).
  1684*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  34
* EL1278.cbl
  1685     05  HAITDRL PIC S9(0004) COMP.
  1686     05  HAITDRF PIC  X(0001).
  1687     05  FILLER REDEFINES HAITDRF.
  1688         10  HAITDRA PIC  X(0001).
  1689     05  HAITDRI PIC  X(0011).
  1690*    -------------------------------
  1691     05  HAREFNDL PIC S9(0004) COMP.
  1692     05  HAREFNDF PIC  X(0001).
  1693     05  FILLER REDEFINES HAREFNDF.
  1694         10  HAREFNDA PIC  X(0001).
  1695     05  HAREFNDI PIC  X(0011).
  1696*    -------------------------------
  1697     05  HACANCL PIC S9(0004) COMP.
  1698     05  HACANCF PIC  X(0001).
  1699     05  FILLER REDEFINES HACANCF.
  1700         10  HACANCA PIC  X(0001).
  1701     05  HACANCI PIC  X(0008).
  1702*    -------------------------------
  1703     05  HACAL1L PIC S9(0004) COMP.
  1704     05  HACAL1F PIC  X(0001).
  1705     05  FILLER REDEFINES HACAL1F.
  1706         10  HACAL1A PIC  X(0001).
  1707     05  HACAL1I PIC  X(0001).
  1708*    -------------------------------
  1709     05  HACALCL PIC S9(0004) COMP.
  1710     05  HACALCF PIC  X(0001).
  1711     05  FILLER REDEFINES HACALCF.
  1712         10  HACALCA PIC  X(0001).
  1713     05  HACALCI PIC  X(0012).
  1714*    -------------------------------
  1715     05  TOPREML PIC S9(0004) COMP.
  1716     05  TOPREMF PIC  X(0001).
  1717     05  FILLER REDEFINES TOPREMF.
  1718         10  TOPREMA PIC  X(0001).
  1719     05  TOPREMI PIC  X(0011).
  1720*    -------------------------------
  1721     05  TOITDRL PIC S9(0004) COMP.
  1722     05  TOITDRF PIC  X(0001).
  1723     05  FILLER REDEFINES TOITDRF.
  1724         10  TOITDRA PIC  X(0001).
  1725     05  TOITDRI PIC  X(0011).
  1726*    -------------------------------
  1727     05  TORFNDL PIC S9(0004) COMP.
  1728     05  TORFNDF PIC  X(0001).
  1729     05  FILLER REDEFINES TORFNDF.
  1730         10  TORFNDA PIC  X(0001).
  1731     05  TORFNDI PIC  X(0011).
  1732*    -------------------------------
  1733     05  CANREAHL PIC S9(0004) COMP.
  1734     05  CANREAHF PIC  X(0001).
  1735     05  FILLER REDEFINES CANREAHF.
  1736         10  CANREAHA PIC  X(0001).
  1737     05  CANREAHI PIC  X(0015).
  1738*    -------------------------------
  1739     05  CANREAL PIC S9(0004) COMP.
  1740     05  CANREAF PIC  X(0001).
  1741     05  FILLER REDEFINES CANREAF.
  1742         10  CANREAA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  35
* EL1278.cbl
  1743     05  CANREAI PIC  X(0001).
  1744*    -------------------------------
  1745     05  CLPYNHL PIC S9(0004) COMP.
  1746     05  CLPYNHF PIC  X(0001).
  1747     05  FILLER REDEFINES CLPYNHF.
  1748         10  CLPYNHA PIC  X(0001).
  1749     05  CLPYNHI PIC  X(0005).
  1750*    -------------------------------
  1751     05  CLPYNL PIC S9(0004) COMP.
  1752     05  CLPYNF PIC  X(0001).
  1753     05  FILLER REDEFINES CLPYNF.
  1754         10  CLPYNA PIC  X(0001).
  1755     05  CLPYNI PIC  X(0001).
  1756*    -------------------------------
  1757     05  HLREDL PIC S9(0004) COMP.
  1758     05  HLREDF PIC  X(0001).
  1759     05  FILLER REDEFINES HLREDF.
  1760         10  HLREDA PIC  X(0001).
  1761     05  HLREDI PIC  X(0014).
  1762*    -------------------------------
  1763     05  FREMTRML PIC S9(0004) COMP.
  1764     05  FREMTRMF PIC  X(0001).
  1765     05  FILLER REDEFINES FREMTRMF.
  1766         10  FREMTRMA PIC  X(0001).
  1767     05  FREMTRMI PIC  X(0003).
  1768*    -------------------------------
  1769     05  HERMSG1L PIC S9(0004) COMP.
  1770     05  HERMSG1F PIC  X(0001).
  1771     05  FILLER REDEFINES HERMSG1F.
  1772         10  HERMSG1A PIC  X(0001).
  1773     05  HERMSG1I PIC  X(0079).
  1774*    -------------------------------
  1775     05  HERMSG2L PIC S9(0004) COMP.
  1776     05  HERMSG2F PIC  X(0001).
  1777     05  FILLER REDEFINES HERMSG2F.
  1778         10  HERMSG2A PIC  X(0001).
  1779     05  HERMSG2I PIC  X(0079).
  1780*    -------------------------------
  1781     05  HPFKEYL PIC S9(0004) COMP.
  1782     05  HPFKEYF PIC  X(0001).
  1783     05  FILLER REDEFINES HPFKEYF.
  1784         10  HPFKEYA PIC  X(0001).
  1785     05  HPFKEYI PIC  99.
  1786*    -------------------------------
  1787     05  PFKEY11L PIC S9(0004) COMP.
  1788     05  PFKEY11F PIC  X(0001).
  1789     05  FILLER REDEFINES PFKEY11F.
  1790         10  PFKEY11A PIC  X(0001).
  1791     05  PFKEY11I PIC  X(0034).
  1792 01  EL127HO REDEFINES EL127HI.
  1793     05  FILLER            PIC  X(0012).
  1794*    -------------------------------
  1795     05  FILLER            PIC  X(0003).
  1796     05  HDATEO PIC  X(0008).
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  HTIMEO PIC  99.99.
  1800*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  36
* EL1278.cbl
  1801     05  FILLER            PIC  X(0003).
  1802     05  CMPNYIDO PIC  X(0003).
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  USERIDO PIC  X(0004).
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  HCARIERO PIC  X(0001).
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  HGROUPO PIC  X(0006).
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  HSTATEO PIC  X(0002).
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  HACCTNOO PIC  X(0010).
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  HEFFDTO PIC  X(0008).
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  HCERTNOO PIC  X(0010).
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  HCRTSFXO PIC  X(0001).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  HLNAMEO PIC  X(0015).
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  HFNAMEO PIC  X(0010).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  HINITO PIC  X(0001).
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  LCLMDTHO PIC  X(0022).
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  LCLMDTO PIC  X(0008).
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  HPCYNO PIC  X(0001).
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  ACLMDTHO PIC  X(0023).
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  ACLMDTO PIC  X(0008).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  PMTHDO PIC  X(0010).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  CNCDTHDO PIC  X(0007).
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  37
* EL1278.cbl
  1859     05  HLKINDO PIC  X(0002).
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  HLCDO PIC  X(0002).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  HLEDESCO PIC  X(0003).
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  HLTERMO PIC  ZZ9.
  1869*    -------------------------------
  1870     05  FILLER            PIC  X(0003).
  1871     05  HLREMO PIC  ZZ9.
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  HLPREMO PIC  ZZZZ,ZZ9.99.
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  HLITDRO PIC  ZZZZ,ZZ9.99.
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  HLREFNDO PIC  ZZZZ,ZZ9.99.
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  HLCANCO PIC  X(0008).
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  HLCAL1O PIC  X(0001).
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  HLCALCO PIC  X(0012).
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  HAKINDO PIC  X(0002).
  1893*    -------------------------------
  1894     05  FILLER            PIC  X(0003).
  1895     05  HACDO PIC  X(0002).
  1896*    -------------------------------
  1897     05  FILLER            PIC  X(0003).
  1898     05  HAEDESCO PIC  X(0003).
  1899*    -------------------------------
  1900     05  FILLER            PIC  X(0003).
  1901     05  HATERMO PIC  ZZ9.
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  HAREMO PIC  ZZ9.
  1905*    -------------------------------
  1906     05  FILLER            PIC  X(0003).
  1907     05  HAPREMO PIC  ZZZZ,ZZ9.99.
  1908*    -------------------------------
  1909     05  FILLER            PIC  X(0003).
  1910     05  HAITDRO PIC  ZZZZ,ZZ9.99.
  1911*    -------------------------------
  1912     05  FILLER            PIC  X(0003).
  1913     05  HAREFNDO PIC  ZZZZ,ZZ9.99.
  1914*    -------------------------------
  1915     05  FILLER            PIC  X(0003).
  1916     05  HACANCO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  38
* EL1278.cbl
  1917*    -------------------------------
  1918     05  FILLER            PIC  X(0003).
  1919     05  HACAL1O PIC  X(0001).
  1920*    -------------------------------
  1921     05  FILLER            PIC  X(0003).
  1922     05  HACALCO PIC  X(0012).
  1923*    -------------------------------
  1924     05  FILLER            PIC  X(0003).
  1925     05  TOPREMO PIC  ZZZZ,ZZ9.99.
  1926*    -------------------------------
  1927     05  FILLER            PIC  X(0003).
  1928     05  TOITDRO PIC  ZZZZ,ZZ9.99.
  1929*    -------------------------------
  1930     05  FILLER            PIC  X(0003).
  1931     05  TORFNDO PIC  ZZZZ,ZZ9.99.
  1932*    -------------------------------
  1933     05  FILLER            PIC  X(0003).
  1934     05  CANREAHO PIC  X(0015).
  1935*    -------------------------------
  1936     05  FILLER            PIC  X(0003).
  1937     05  CANREAO PIC  X(0001).
  1938*    -------------------------------
  1939     05  FILLER            PIC  X(0003).
  1940     05  CLPYNHO PIC  X(0005).
  1941*    -------------------------------
  1942     05  FILLER            PIC  X(0003).
  1943     05  CLPYNO PIC  X(0001).
  1944*    -------------------------------
  1945     05  FILLER            PIC  X(0003).
  1946     05  HLREDO PIC  ZZZ,ZZZ,ZZ9.99.
  1947*    -------------------------------
  1948     05  FILLER            PIC  X(0003).
  1949     05  FREMTRMO PIC  ZZ9.
  1950*    -------------------------------
  1951     05  FILLER            PIC  X(0003).
  1952     05  HERMSG1O PIC  X(0079).
  1953*    -------------------------------
  1954     05  FILLER            PIC  X(0003).
  1955     05  HERMSG2O PIC  X(0079).
  1956*    -------------------------------
  1957     05  FILLER            PIC  X(0003).
  1958     05  HPFKEYO PIC  99.
  1959*    -------------------------------
  1960     05  FILLER            PIC  X(0003).
  1961     05  PFKEY11O PIC  X(0034).
  1962*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  39
* EL1278.cbl
  1964*                            COPY ELCCALC.
  1965******************************************************************
  1966*                                                                *
  1967*                           ELCCALC.                            *
  1968*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1969*                            VMOD=2.025                          *
  1970*                                                                *
  1971*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1972*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1973*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1974*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1975*                                                                *
  1976*  PASSED TO ELRTRM                                              *
  1977*  -----------------                                             *
  1978*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1979*  ORIGINAL TERM                                                 *
  1980*  BEGINNING DATE                                                *
  1981*  ENDING DATE                                                   *
  1982*  COMPANY I.D.                                                  *
  1983*  ACCOUNT MASTER USER FIELD                                     *
  1984*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1985*  FREE LOOK DAYS                                                *
  1986*                                                                *
  1987*  RETURNED FROM ELRTRM                                          *
  1988*  ---------------------                                         *
  1989*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1990*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1991*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1992*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1993*----------------------------------------------------------------*
  1994*  PASSED TO ELRAMT                                              *
  1995*  ----------------                                              *
  1996*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1997*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1998*  ORIGINAL AMOUNT                                               *
  1999*  ALTERNATE BENEFIT (BALLON)                                    *
  2000*  A.P.R. - NET PAY ONLY                                         *
  2001*  METHOD
  2002*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2003*  COMPANY I.D.                                                  *
  2004*  BENEFIT TYPE                                                  *
  2005*                                                                *
  2006*  RETURNED FROM ELRAMT                                          *
  2007*  --------------------                                          *
  2008*  REMAINING AMOUNT 1 - CURRENT                                  *
  2009*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2010*  REMAINING AMOUNT FACTOR
  2011*----------------------------------------------------------------*
  2012*  PASSED TO ELRESV                                              *
  2013*  -----------------                                             *
  2014*  CERTIFICATE EFFECTIVE DATE                                    *
  2015*  VALUATION DATE                                                *
  2016*  PAID THRU DATE                                                *
  2017*  BENEFIT                                                       *
  2018*  INCURRED DATE                                                 *
  2019*  REPORTED DATE                                                 *
  2020*  ISSUE AGE                                                     *
  2021*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  40
* EL1278.cbl
  2022*  CDT PERCENT                                                   *
  2023*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2024* *CLAIM TYPE (LIFE, A/H)                                        *
  2025* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2026* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2027*                                                                *
  2028*  RETURNED FROM ELRESV                                          *
  2029*  --------------------                                          *
  2030*  CDT TABLE USED                                                *
  2031*  CDT FACTOR USED                                               *
  2032*  PAY TO CURRENT RESERVE                                        *
  2033*  I.B.N.R. - A/H ONLY                                           *
  2034*  FUTURE (ACCRUED) AH ONLY                                      *
  2035*----------------------------------------------------------------*
  2036*  PASSED TO ELRATE                                              *
  2037*  ----------------                                              *
  2038*  CERT ISSUE DATE                                               *
  2039*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2040*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2041*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2042*  STATE CODE (CLIENT DEFINED)                                   *
  2043*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2044*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2045*  DEVIATION CODE                                                *
  2046*  ISSUE AGE                                                     *
  2047*  ORIGINAL BENEFIT AMOUNT                                       *
  2048*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2049*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2050*  BENEFIT KIND (LIFE OR A/H)                                    *
  2051*  A.P.R.                                                        *
  2052*  METHOD
  2053*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2054*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2055*  COMPANY I.D. (3 CHARACTER)                                    *
  2056*  BENEFIT CODE                                                  *
  2057*  BENEFIT OVERRIDE CODE                                         *
  2058*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2059*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2060*  JOINT INDICATOR (CSL ONLY)                                    *
  2061*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2062*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2063*                                                                *
  2064*  RETURNED FROM ELRATE                                          *
  2065*  --------------------                                          *
  2066*  CALCULATED PREMIUM                                            *
  2067*  PREMIUM RATE                                                  *
  2068*  MORTALITY CODE                                                *
  2069*  MAX ATTAINED AGE                                              *
  2070*  MAX AGE                                                       *
  2071*  MAX TERM                                                      *
  2072*  MAX MONTHLY BENEFIT                                           *
  2073*  MAX TOTAL BENIFIT                                             *
  2074*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2075*----------------------------------------------------------------*
  2076*  PASSED TO ELRFND                                              *
  2077*  ----------------                                              *
  2078*  CERT ISSUE DATE                                               *
  2079*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  41
* EL1278.cbl
  2080*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2081*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2082*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2083*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2084*  STATE CODE (CLIENT DEFINED)                                   *
  2085*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2086*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2087*  DEVIATION CODE                                                *
  2088*  ISSUE AGE                                                     *
  2089*  ORIGINAL BENEFIT AMOUNT                                       *
  2090*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2091*  PROCESS TYPE (CANCEL)                                         *
  2092*  BENEFIT KIND (LIFE OR A/H)                                    *
  2093*  A.P.R.                                                        *
  2094*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2095*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2096*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2097*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2098*  COMPANY I.D. (3 CHARACTER)                                    *
  2099*  BENEFIT CODE                                                  *
  2100*  BENEFIT OVERRIDE CODE                                         *
  2101*                                                                *
  2102*  RETURNED FROM ELRFND                                          *
  2103*  --------------------                                          *
  2104*  CALCULATED REFUND                                             *
  2105*----------------------------------------------------------------*
  2106*  PASSED TO ELEARN                                              *
  2107*  ----------------                                              *
  2108*  CERT ISSUE DATE                                               *
  2109*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2110*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2111*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2112*  STATE CODE (CLIENT DEFINED)                                   *
  2113*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2114*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2115*  DEVIATION CODE                                                *
  2116*  ISSUE AGE                                                     *
  2117*  ORIGINAL BENEFIT AMOUNT                                       *
  2118*  BENEFIT KIND (LIFE OR A/H)                                    *
  2119*  A.P.R.                                                        *
  2120*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2121*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2122*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2123*  COMPANY I.D. (3 CHARACTER)                                    *
  2124*  BENEFIT CODE                                                  *
  2125*  BENEFIT OVERRIDE CODE                                         *
  2126*                                                                *
  2127*  RETURNED FROM ELEARN                                          *
  2128*  --------------------                                          *
  2129*  INDICATED  EARNINGS                                           *
  2130*----------------------------------------------------------------*
  2131*                 LENGTH = 450                                   *
  2132*                                                                *
  2133******************************************************************
  2134******************************************************************
  2135*                   C H A N G E   L O G
  2136*
  2137* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  42
* EL1278.cbl
  2138*-----------------------------------------------------------------
  2139*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2140* EFFECTIVE    NUMBER
  2141*-----------------------------------------------------------------
  2142* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2143* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2144* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2145* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2146* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2147* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2148* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2149* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2150* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2151******************************************************************
  2152
  2153 01  CALCULATION-PASS-AREA.
  2154     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2155                                     COMP.
  2156
  2157     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2158       88  NO-CP-ERROR                             VALUE ZERO.
  2159       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2160                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2161       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2162       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2163       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2164       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2165       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2166       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2167       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2168       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2169       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2170       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2171       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2172       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2173       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2174       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2175       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2176       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2177       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2178
  2179     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2180       88  NO-CP-ERROR-2                           VALUE ZERO.
  2181***********************  INPUT AREAS ****************************
  2182
  2183     12  CP-CALCULATION-AREA.
  2184         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2185         16  CP-CERT-EFF-DT        PIC XX.
  2186         16  CP-VALUATION-DT       PIC XX.
  2187         16  CP-PAID-THRU-DT       PIC XX.
  2188         16  CP-BENEFIT-TYPE       PIC X.
  2189           88  CP-AH                               VALUE 'A' 'D'
  2190                                                   'I' 'U'.
  2191           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2192           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2193         16  CP-INCURRED-DT        PIC XX.
  2194         16  CP-REPORTED-DT        PIC XX.
  2195         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  43
* EL1278.cbl
  2196         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2197         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2198                                     COMP-3.
  2199         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2200                                     COMP-3.
  2201         16  CP-CDT-METHOD         PIC X.
  2202           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2203           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2204           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2205         16  CP-CLAIM-TYPE         PIC X.
  2206           88  CP-AH-CLAIM                         VALUE 'A'.
  2207           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2208         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2209                                     COMP-3.
  2210         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2211                                     COMP-3.
  2212         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2213                                     COMP-3.
  2214         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2215                                     COMP-3.
  2216         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2217                                     COMP-3.
  2218         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2219                                     COMP-3.
  2220         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2221                                     COMP-3.
  2222         16  CP-REM-TERM-METHOD    PIC X.
  2223           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2224           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2225           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2226           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2227           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2228           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2229           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2230         16  CP-EARNING-METHOD     PIC X.
  2231           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2232           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2233           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2234           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2235           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2236           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2237           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2238           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2239           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2240           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2241           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2242           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2243           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2244           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2245         16  CP-PROCESS-TYPE       PIC X.
  2246           88  CP-CLAIM                            VALUE '1'.
  2247           88  CP-CANCEL                           VALUE '2'.
  2248           88  CP-ISSUE                            VALUE '3'.
  2249         16  CP-SPECIAL-CALC-CD    PIC X.
  2250           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2251           88  CP-1-MTH-INTEREST               VALUE ' '.
  2252           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2253           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  44
* EL1278.cbl
  2254           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2255           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2256           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2257           88  CP-FARM-PLAN                    VALUE 'F'.
  2258           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2259           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2260           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2261           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2262           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2263           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2264           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2265           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2266           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2267           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2268                                                     'W' 'X'.
  2269           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2270           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2271           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2272           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2273           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2274           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2275           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2276           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2277           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2278           88  CP-CSL-METH-1                   VALUE '5'.
  2279           88  CP-CSL-METH-2                   VALUE '6'.
  2280           88  CP-CSL-METH-3                   VALUE '7'.
  2281           88  CP-CSL-METH-4                   VALUE '8'.
  2282
  2283         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2284                                     COMP-3.
  2285         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2286         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2287         16  CP-STATE              PIC XX          VALUE SPACE.
  2288         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2289         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2290           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2291               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2292         16  CP-R78-OPTION         PIC X.
  2293           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2294           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2295
  2296         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2297         16  CP-IBNR-RESERVE-SW    PIC X.
  2298         16  CP-CLAIM-STATUS       PIC X.
  2299         16  CP-RATE-FILE          PIC X.
  2300         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2301                                     COMP-3.
  2302
  2303         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2304         16  CP-AH-OVERRIDE-CODE   PIC X.
  2305
  2306         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2307                                     COMP-3.
  2308         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2309                                   PIC S9(5)V99 COMP-3.
  2310         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2311                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  45
* EL1278.cbl
  2312         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2313                                     COMP-3.
  2314         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2315                                     COMP-3.
  2316         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2317                                  PIC S9(7)V99 COMP-3.
  2318
  2319         16  CP-PAID-FROM-DATE     PIC X(02).
  2320         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2321         16  CP-EXT-DAYS-CALC      PIC X.
  2322           88  CP-EXT-NO-CHG                   VALUE ' '.
  2323           88  CP-EXT-CHG-LF                   VALUE '1'.
  2324           88  CP-EXT-CHG-AH                   VALUE '2'.
  2325           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2326         16  CP-DOMICILE-STATE     PIC XX.
  2327         16  CP-CARRIER            PIC X.
  2328         16  CP-REIN-FLAG          PIC X.
  2329         16  CP-REM-TRM-CALC-OPTION PIC X.
  2330           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2331                      '2' '3' '4' '5'.
  2332           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2333           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2334           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2335           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2336           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2337           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2338           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2339           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2340         16  CP-SIG-SWITCH         PIC X.
  2341         16  CP-RATING-METHOD      PIC X.
  2342           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2343           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2344           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2345           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2346           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2347           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2348           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2349           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2350           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2351         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2352                                     COMP-3.
  2353         16  CP-BEN-CATEGORY       PIC X.
  2354         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2355         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2356                                   PIC S99V9(5) COMP-3.
  2357         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2358         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2359                                   PIC S99V9(5) COMP-3.
  2360         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2361         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2362         16  CP-EXPIRE-DT          PIC XX.
  2363         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2364         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2365         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2366         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2367         16  CP-DDF-SPEC-CALC      PIC X.
  2368             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2369             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  46
* EL1278.cbl
  2370         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2371         16  CP-CANCEL-REASON      PIC X.
  2372         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2373         16  CP-PMT-MODE           PIC X.
  2374         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2375         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2376         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2377         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2378         16  FILLER                PIC X.
  2379
  2380***************    OUTPUT FROM ELRESV   ************************
  2381
  2382         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2383
  2384         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2385                                     COMP-3.
  2386         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2387                                     COMP-3.
  2388         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2389                                     COMP-3.
  2390         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2391                                     COMP-3.
  2392         16  FILLER                PIC X(09).
  2393***************    OUTPUT FROM ELRTRM   *************************
  2394
  2395         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2396                                     COMP-3.
  2397         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2398                                     COMP-3.
  2399         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2400                                     COMP-3.
  2401         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2402                                     COMP-3.
  2403         16  FILLER                PIC X(12).
  2404
  2405***************    OUTPUT FROM ELRAMT   *************************
  2406
  2407         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2408                                     COMP-3.
  2409         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2410                                     COMP-3.
  2411         16  FILLER                PIC X(12).
  2412
  2413***************    OUTPUT FROM ELRATE   *************************
  2414
  2415         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2416                                     COMP-3.
  2417         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2418                                     COMP-3.
  2419         16  CP-MORTALITY-CODE     PIC X(4).
  2420         16  CP-RATE-EDIT-FLAG     PIC X.
  2421             88  CP-RATES-NEED-APR                  VALUE '1'.
  2422         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2423                                     COMP-3.
  2424         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2425         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2426         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2427                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  47
* EL1278.cbl
  2428         16  FILLER                PIC X(07).
  2429
  2430***************    OUTPUT FROM ELRFND   *************************
  2431
  2432         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2433                                     COMP-3.
  2434         16  CP-REFUND-TYPE-USED   PIC X.
  2435           88  CP-R-AS-R78                         VALUE '1'.
  2436           88  CP-R-AS-PRORATA                     VALUE '2'.
  2437           88  CP-R-AS-CALIF                       VALUE '3'.
  2438           88  CP-R-AS-TEXAS                       VALUE '4'.
  2439           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2440           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2441           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2442           88  CP-R-AS-MEAN                        VALUE '8'.
  2443           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2444           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2445           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2446           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2447           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2448           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2449         16  FILLER                PIC X(12).
  2450
  2451***************    OUTPUT FROM ELEARN   *************************
  2452
  2453         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2454                                     COMP-3.
  2455         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2456                                     COMP-3.
  2457         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2458                                     COMP-3.
  2459         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2460                                     COMP-3.
  2461         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2462                                     COMP-3.
  2463         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2464                                     COMP-3.
  2465         16  CP-EARNING-TYPE-USED  PIC X.
  2466           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2467           88  CP-E-AS-R78                         VALUE '1'.
  2468           88  CP-E-AS-PRORATA                     VALUE '2'.
  2469           88  CP-E-AS-TEXAS                       VALUE '4'.
  2470           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2471           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2472           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2473           88  CP-E-AS-MEAN                        VALUE '8'.
  2474           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2475         16  FILLER                PIC X(12).
  2476
  2477***************    OUTPUT FROM ELPMNT   *************************
  2478
  2479         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2480                                     COMP-3.
  2481         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2482                                     COMP-3.
  2483         16  FILLER                PIC X(12).
  2484
  2485***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  48
* EL1278.cbl
  2486         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2487                                     COMP-3.
  2488         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2489                                     COMP-3.
  2490         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2491                                     COMP-3.
  2492         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2493                                     COMP-3.
  2494         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2495                                     COMP-3.
  2496         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2497                                     COMP-3.
  2498         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2499             88  OPEN-RATE-FILE                   VALUE 'O'.
  2500             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2501             88  IO-ERROR                         VALUE 'E'.
  2502
  2503         16  CP-FIRST-PAY-DATE     PIC XX.
  2504
  2505         16  CP-JOINT-INDICATOR    PIC X.
  2506
  2507         16  CP-RESERVE-REMAINING-TERM
  2508                                   PIC S9(4)V9    VALUE ZERO
  2509                                     COMP-3.
  2510
  2511         16  CP-INSURED-BIRTH-DT   PIC XX.
  2512
  2513         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2514                                     COMP-3.
  2515
  2516         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2517                                     COMP-3.
  2518
  2519         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2520                                     COMP-3.
  2521
  2522         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2523                                     COMP-3.
  2524
  2525         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2526                                     COMP-3.
  2527
  2528         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2529                                     COMP-3.
  2530
  2531         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2532                                     COMP-3.
  2533
  2534         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2535             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2536
  2537         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2538                                     COMP-3.
  2539         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2540                                     COMP-3.
  2541         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2542         16  FILLER                PIC X(15).
  2543******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  49
* EL1278.cbl
  2545*                            COPY ERCNOTE.
  2546******************************************************************
  2547*                                                                *
  2548*                                                                *
  2549*                            ERCNOTE                             *
  2550*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2551*                            VMOD=2.003                          *
  2552*                                                                *
  2553*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  2554*                                                                *
  2555*        FILE TYPE= VSAM,KSDS                                    *
  2556*        RECORD SIZE = 825    RECFORM = FIXED                    *
  2557*                                                                *
  2558*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  2559*                                                                *
  2560*        LOG = YES                                               *
  2561*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2562*                                                                *
  2563******************************************************************
  2564*                   C H A N G E   L O G
  2565*
  2566* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2567*-----------------------------------------------------------------
  2568*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2569* EFFECTIVE    NUMBER
  2570*-----------------------------------------------------------------
  2571* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  2572*                                FILE WILL CONTAIN BILLING NOTES O
  2573******************************************************************
  2574
  2575 01  CERTIFICATE-NOTE.
  2576     12  CN-RECORD-ID                PIC  XX.
  2577         88  VALID-CN-ID                  VALUE 'CN'.
  2578
  2579     12  CN-CONTROL-PRIMARY.
  2580         16  CN-COMPANY-CD           PIC X.
  2581         16  CN-CARRIER              PIC X.
  2582         16  CN-GROUPING.
  2583             20 CN-GROUPING-PREFIX   PIC XXX.
  2584             20 CN-GROUPING-PRIME    PIC XXX.
  2585         16  CN-STATE                PIC XX.
  2586         16  CN-ACCOUNT.
  2587             20 CN-ACCOUNT-PREFIX    PIC X(4).
  2588             20 CN-ACCOUNT-PRIME     PIC X(6).
  2589         16  CN-CERT-EFF-DT          PIC XX.
  2590         16  CN-CERT-NO.
  2591             20  CN-CERT-PRIME       PIC X(10).
  2592             20  CN-CERT-SFX         PIC X.
  2593
  2594     12  CN-BILLING-START-LINE-NO    PIC 99.
  2595     12  CN-BILLING-END-LINE-NO      PIC 99.
  2596
  2597     12  CN-LINES.
  2598         16  CN-LINE OCCURS 10       PIC X(77).
  2599
  2600     12  CN-LAST-MAINT-DT            PIC XX.
  2601     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2602     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  50
* EL1278.cbl
  2603     12  FILLER                      PIC X(6).
  2604******************************************************************
  2605*                            COPY ERCCTBL.
  2606******************************************************************
  2607*                                                                *
  2608*                                                                *
  2609*                            ERCCTBL                             *
  2610*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2611*                            VMOD=2.003
  2612*                                                                *
  2613*   ONLINE CREDIT SYSTEM                                         *
  2614*                                                                *
  2615*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  2616*                                                                *
  2617*   FILE TYPE = VSAM,KSDS                                        *
  2618*   RECORD SIZE = 200   RECFORM = FIXED                          *
  2619*                                                                *
  2620*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  2621*       ALTERNATE PATH = NONE                                    *
  2622*                                                                *
  2623*   LOG = NO                                                     *
  2624*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2625*                                                                *
  2626*                                                                *
  2627******************************************************************
  2628
  2629 01  COMM-TABLE-RECORD.
  2630     12  CT-RECORD-ID                      PIC XX.
  2631         88  VALID-CT-ID                      VALUE 'CT'.
  2632
  2633     12  CT-CONTROL-PRIMARY.
  2634         16  CT-COMPANY-CD                 PIC X.
  2635         16  CT-TABLE                      PIC XXX.
  2636         16  CT-CNTRL-2.
  2637             20  CT-BEN-TYPE               PIC X.
  2638             20  CT-BEN-CODE               PIC XX.
  2639
  2640     12  CT-MAINT-INFORMATION.
  2641         16  CT-LAST-MAINT-DT              PIC XX.
  2642         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2643         16  CT-LAST-MAINT-USER            PIC X(4).
  2644         16  FILLER                        PIC X(31).
  2645
  2646     12  CT-LIMITS.
  2647         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  2648
  2649         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  2650
  2651         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  2652
  2653     12  CT-RATES.
  2654         16  CT-RTX          OCCURS 27 TIMES.
  2655             20  CT-RT                     PIC SV9(5)     COMP-3.
  2656             20  CT-RT-R   REDEFINES
  2657                 CT-RT                     PIC XXX.
  2658
  2659     12  FILLER                            PIC  X(42).
  2660
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  51
* EL1278.cbl
  2661******************************************************************
  2662
  2663****************************************************************
  2664*
  2665* Copyright (c) 2007 by Clerity Solutions, Inc.
  2666* All rights reserved.
  2667*
  2668****************************************************************
  2669 01  DFHEIV.
  2670   02  DFHEIV0               PIC X(35).
  2671   02  DFHEIV1               PIC X(08).
  2672   02  DFHEIV2               PIC X(08).
  2673   02  DFHEIV3               PIC X(08).
  2674   02  DFHEIV4               PIC X(06).
  2675   02  DFHEIV5               PIC X(04).
  2676   02  DFHEIV6               PIC X(04).
  2677   02  DFHEIV7               PIC X(02).
  2678   02  DFHEIV8               PIC X(02).
  2679   02  DFHEIV9               PIC X(01).
  2680   02  DFHEIV10              PIC S9(7) COMP-3.
  2681   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2682   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2683   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2684   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2685   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2686   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2687   02  DFHEIV17              PIC X(04).
  2688   02  DFHEIV18              PIC X(04).
  2689   02  DFHEIV19              PIC X(04).
  2690   02  DFHEIV20              USAGE IS POINTER.
  2691   02  DFHEIV21              USAGE IS POINTER.
  2692   02  DFHEIV22              USAGE IS POINTER.
  2693   02  DFHEIV23              USAGE IS POINTER.
  2694   02  DFHEIV24              USAGE IS POINTER.
  2695   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2696   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2697   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2698   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2699   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2700   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2701   02  FILLER                PIC X(02).
  2702   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2703   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2704   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2705   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2706   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2707 LINKAGE  SECTION.
  2708*****************************************************************
  2709*                                                               *
  2710* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2711* All rights reserved.                                          *
  2712*                                                               *
  2713*****************************************************************
  2714 01  dfheiblk.
  2715     02  eibtime          pic s9(7) comp-3.
  2716     02  eibdate          pic s9(7) comp-3.
  2717     02  eibtrnid         pic x(4).
  2718     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  52
* EL1278.cbl
  2719     02  eibtrmid         pic x(4).
  2720     02  dfheigdi         pic s9(4) comp.
  2721     02  eibcposn         pic s9(4) comp.
  2722     02  eibcalen         pic s9(4) comp.
  2723     02  eibaid           pic x(1).
  2724     02  eibfiller1       pic x(1).
  2725     02  eibfn            pic x(2).
  2726     02  eibfiller2       pic x(2).
  2727     02  eibrcode         pic x(6).
  2728     02  eibfiller3       pic x(2).
  2729     02  eibds            pic x(8).
  2730     02  eibreqid         pic x(8).
  2731     02  eibrsrce         pic x(8).
  2732     02  eibsync          pic x(1).
  2733     02  eibfree          pic x(1).
  2734     02  eibrecv          pic x(1).
  2735     02  eibsend          pic x(1).
  2736     02  eibatt           pic x(1).
  2737     02  eibeoc           pic x(1).
  2738     02  eibfmh           pic x(1).
  2739     02  eibcompl         pic x(1).
  2740     02  eibsig           pic x(1).
  2741     02  eibconf          pic x(1).
  2742     02  eiberr           pic x(1).
  2743     02  eibrldbk         pic x(1).
  2744     02  eiberrcd         pic x(4).
  2745     02  eibsynrb         pic x(1).
  2746     02  eibnodat         pic x(1).
  2747     02  eibfiller5       pic x(2).
  2748     02  eibresp          pic 9(09) comp.
  2749     02  eibresp2         pic 9(09) comp.
  2750     02  dfheigdj         pic s9(4) comp.
  2751     02  dfheigdk         pic s9(4) comp.
  2752
  2753 01  DFHCOMMAREA                 PIC  X(1024).
  2754
  2755*01 PARMLIST .
  2756*    12  FILLER                  PIC S9(08)      COMP.
  2757*    12  ELCNTL-POINTER          PIC S9(08)      COMP.
  2758*    12  ELACCT-POINTER          PIC S9(08)      COMP.
  2759*    12  ELCERT-POINTER          PIC S9(08)      COMP.
  2760*                            COPY ELCCNTL.
  2761******************************************************************
  2762*                                                                *
  2763*                                                                *
  2764*                            ELCCNTL.                            *
  2765*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2766*                            VMOD=2.059                          *
  2767*                                                                *
  2768*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2769*                                                                *
  2770*   FILE TYPE = VSAM,KSDS                                        *
  2771*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2772*                                                                *
  2773*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2774*       ALTERNATE INDEX = NONE                                   *
  2775*                                                                *
  2776*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  53
* EL1278.cbl
  2777*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2778******************************************************************
  2779*                   C H A N G E   L O G
  2780*
  2781* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2782*-----------------------------------------------------------------
  2783*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2784* EFFECTIVE    NUMBER
  2785*-----------------------------------------------------------------
  2786* 082503                   PEMA  ADD BENEFIT GROUP
  2787* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2788* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2789* 092705    2005050300006  PEMA  ADD SPP LEASES
  2790* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2791* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2792* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2793* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2794* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2795* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2796******************************************************************
  2797*
  2798 01  CONTROL-FILE.
  2799     12  CF-RECORD-ID                       PIC XX.
  2800         88  VALID-CF-ID                        VALUE 'CF'.
  2801
  2802     12  CF-CONTROL-PRIMARY.
  2803         16  CF-COMPANY-ID                  PIC XXX.
  2804         16  CF-RECORD-TYPE                 PIC X.
  2805             88  CF-COMPANY-MASTER              VALUE '1'.
  2806             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2807             88  CF-STATE-MASTER                VALUE '3'.
  2808             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2809             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2810             88  CF-CARRIER-MASTER              VALUE '6'.
  2811             88  CF-MORTALITY-MASTER            VALUE '7'.
  2812             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2813             88  CF-TERMINAL-MASTER             VALUE '9'.
  2814             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2815             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2816             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2817             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2818             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2819             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2820             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2821             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2822             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2823         16  CF-ACCESS-CD-GENL              PIC X(4).
  2824         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2825             20  CF-PROCESSOR               PIC X(4).
  2826         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2827             20  CF-STATE-CODE              PIC XX.
  2828             20  FILLER                     PIC XX.
  2829         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2830             20  FILLER                     PIC XX.
  2831             20  CF-HI-BEN-IN-REC           PIC XX.
  2832         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2833             20  FILLER                     PIC XXX.
  2834             20  CF-CARRIER-CNTL            PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  54
* EL1278.cbl
  2835         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2836             20  FILLER                     PIC XX.
  2837             20  CF-HI-TYPE-IN-REC          PIC 99.
  2838         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2839             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2840                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2841             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2842             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2843         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2844             20  FILLER                     PIC X.
  2845             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2846         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2847             20  FILLER                     PIC XX.
  2848             20  CF-MORTGAGE-PLAN           PIC XX.
  2849         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2850
  2851     12  CF-LAST-MAINT-DT                   PIC XX.
  2852     12  CF-LAST-MAINT-BY                   PIC X(4).
  2853     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2854
  2855     12  CF-RECORD-BODY                     PIC X(728).
  2856
  2857
  2858****************************************************************
  2859*             COMPANY MASTER RECORD                            *
  2860****************************************************************
  2861
  2862     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2863         16  CF-COMPANY-ADDRESS.
  2864             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2865             20  CF-CL-IN-CARE-OF           PIC X(30).
  2866             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2867             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2868             20  CF-CL-CITY-STATE           PIC X(30).
  2869             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2870             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2871         16  CF-COMPANY-CD                  PIC X.
  2872         16  CF-COMPANY-PASSWORD            PIC X(8).
  2873         16  CF-SECURITY-OPTION             PIC X.
  2874             88  ALL-SECURITY                   VALUE '1'.
  2875             88  COMPANY-VERIFY                 VALUE '2'.
  2876             88  PROCESSOR-VERIFY               VALUE '3'.
  2877             88  NO-SECURITY                    VALUE '4'.
  2878             88  ALL-BUT-TERM                   VALUE '5'.
  2879         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2880             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2881         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2882             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2883         16  CF-INFORCE-LOCATION            PIC X.
  2884             88  CERTS-ARE-ONLINE               VALUE '1'.
  2885             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2886             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2887         16  CF-LOWER-CASE-LETTERS          PIC X.
  2888         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2889             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2890             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2891             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2892             88  CF-ACCNT-CNTL                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  55
* EL1278.cbl
  2893             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2894
  2895         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2896         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2897
  2898         16  CF-LGX-CREDIT-USER             PIC X.
  2899             88  CO-IS-NOT-USER                 VALUE 'N'.
  2900             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2901
  2902         16 CF-CREDIT-CALC-CODES.
  2903             20  CF-CR-REM-TERM-CALC PIC X.
  2904               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2905               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2906               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2907               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2908               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2909               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2910               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2911             20  CF-CR-R78-METHOD           PIC X.
  2912               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2913               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2914
  2915         16  CF-CLAIM-CONTROL-COUNTS.
  2916             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2917                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2918
  2919             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2920                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2921
  2922             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2923                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2924
  2925             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2926                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2927
  2928         16  CF-CURRENT-MONTH-END           PIC XX.
  2929
  2930         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2931             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2932             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2933             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2934             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2935                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2936                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2937             20  CF-CO-PREM-REJECT-SW       PIC X.
  2938                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2939                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2940             20  CF-CO-REF-REJECT-SW        PIC X.
  2941                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2942                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2943
  2944         16  CF-CO-REPORTING-DT             PIC XX.
  2945         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2946         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2947           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2948           88  CF-CO-MONTH-END                  VALUE '1'.
  2949
  2950         16  CF-LGX-CLAIM-USER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  56
* EL1278.cbl
  2951             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2952             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2953
  2954         16  CF-CREDIT-EDIT-CONTROLS.
  2955             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2956             20  CF-MIN-AGE                 PIC 99.
  2957             20  CF-DEFAULT-AGE             PIC 99.
  2958             20  CF-MIN-TERM                PIC S999      COMP-3.
  2959             20  CF-MAX-TERM                PIC S999      COMP-3.
  2960             20  CF-DEFAULT-SEX             PIC X.
  2961             20  CF-JOINT-AGE-INPUT         PIC X.
  2962                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2963             20  CF-BIRTH-DATE-INPUT        PIC X.
  2964                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2965             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2966                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2967                 88  CF-ZERO-CARRIER            VALUE '1'.
  2968                 88  CF-ZERO-GROUPING           VALUE '2'.
  2969                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2970             20  CF-EDIT-SW                 PIC X.
  2971                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2972             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2973             20  CF-CR-PR-METHOD            PIC X.
  2974               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2975               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2976             20  FILLER                     PIC X.
  2977
  2978         16  CF-CREDIT-MISC-CONTROLS.
  2979             20  CF-REIN-TABLE-SW           PIC X.
  2980                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2981             20  CF-COMP-TABLE-SW           PIC X.
  2982                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2983             20  CF-EXPERIENCE-RETENTION-AGE
  2984                                            PIC S9        COMP-3.
  2985             20  CF-CONVERSION-DT           PIC XX.
  2986             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2987             20  CF-RUN-FREQUENCY-SW        PIC X.
  2988                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2989                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2990
  2991             20  CF-CR-CHECK-NO-CONTROL.
  2992                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2993                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2994                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2995                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2996                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2997                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2998
  2999                 24  CF-CR-CHECK-COUNT       REDEFINES
  3000                     CF-CR-CHECK-COUNTER      PIC X(4).
  3001
  3002                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3003                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3004
  3005                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3006                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3007                 24  CF-MAIL-PROCESSING       PIC X.
  3008                     88  MAIL-PROCESSING          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  57
* EL1278.cbl
  3009
  3010         16  CF-MISC-SYSTEM-CONTROL.
  3011             20  CF-SYSTEM-C                 PIC X.
  3012                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3013             20  CF-SYSTEM-D                 PIC X.
  3014                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3015             20  CF-SOC-SEC-NO-SW            PIC X.
  3016                 88  SOC-SEC-NO-USED             VALUE '1'.
  3017             20  CF-MEMBER-NO-SW             PIC X.
  3018                 88  MEMBER-NO-USED              VALUE '1'.
  3019             20  CF-TAX-ID-NUMBER            PIC X(11).
  3020             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3021             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3022                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3023                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3024                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3025                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3026             20  CF-SYSTEM-E                 PIC X.
  3027                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3028
  3029         16  CF-LGX-LIFE-USER               PIC X.
  3030             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3031             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3032
  3033         16  CF-CR-MONTH-END-DT             PIC XX.
  3034
  3035         16  CF-FILE-MAINT-DATES.
  3036             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3037                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3038             20  CF-LAST-BATCH       REDEFINES
  3039                 CF-LAST-BATCH-NO               PIC X(4).
  3040             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3041             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3042             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3043             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3044             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3045             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3046             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3047             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3048             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3049             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3050
  3051         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3052         16  FILLER                         PIC X.
  3053
  3054         16  CF-ALT-MORT-CODE               PIC X(4).
  3055         16  CF-MEMBER-CAPTION              PIC X(10).
  3056
  3057         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3058             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3059             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3060             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3061             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3062             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3063
  3064         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3065
  3066         16  CF-LIFE-OVERRIDE-L1            PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  58
* EL1278.cbl
  3067         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3068         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3069         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3070
  3071         16  CF-AH-OVERRIDE-L1              PIC X.
  3072         16  CF-AH-OVERRIDE-L2              PIC XX.
  3073         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3074         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3075
  3076         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3077         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3078
  3079         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3080         16  CF-AR-LAST-EL860-DT            PIC XX.
  3081         16  CF-MP-MONTH-END-DT             PIC XX.
  3082
  3083         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3084         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3085             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3086
  3087         16  CF-AR-MONTH-END-DT             PIC XX.
  3088
  3089         16  CF-CRDTCRD-USER                PIC X.
  3090             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3091             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3092
  3093         16  CF-CC-MONTH-END-DT             PIC XX.
  3094
  3095         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3096
  3097         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3098             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3099             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3100             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3101         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3102         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3103         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3104         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3105             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3106             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3107         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3108         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3109         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3110             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3111         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3112
  3113         16  CF-CL-ZIP-CODE.
  3114             20  CF-CL-ZIP-PRIME.
  3115                 24  CF-CL-ZIP-1ST          PIC X.
  3116                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3117                 24  FILLER                 PIC X(4).
  3118             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3119         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3120             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3121             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3122             20  FILLER                     PIC XXX.
  3123
  3124         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  59
* EL1278.cbl
  3125         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3126         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3127         16  CF-CO-OPTION-START-DATE        PIC XX.
  3128         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3129           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3130                                                      '3' '4'.
  3131           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3132           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3133           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3134           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3135           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3136           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3137
  3138         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3139
  3140         16  CF-PAYMENT-APPROVAL-LEVELS.
  3141             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3142             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3143             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3144             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3145             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3146             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3147
  3148         16  CF-END-USER-REPORTING-USER     PIC X.
  3149             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3150             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3151
  3152         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3153             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3154             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3155
  3156         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3157
  3158         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3159         16  FILLER                         PIC X.
  3160
  3161         16  CF-CREDIT-ARCHIVE-CNTL.
  3162             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3163             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3164             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3165
  3166         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3167
  3168         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3169             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3170             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3171
  3172         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3173             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3174             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3175
  3176         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3177
  3178         16  CF-CO-ACH-ID-CODE              PIC  X.
  3179             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3180             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3181             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3182         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  60
* EL1278.cbl
  3183         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3184         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3185         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3186         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3187         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3188         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3189         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3190         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3191                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3192         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3193                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3194
  3195         16  CF-CO-OVER-SHORT.
  3196             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3197             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3198
  3199*         16  FILLER                         PIC X(102).
  3200         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3201             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3202             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3203
  3204         16  CF-AH-APPROVAL-DAYS.
  3205             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3206             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3207             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3208             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3209
  3210         16  FILLER                         PIC X(82).
  3211****************************************************************
  3212*             PROCESSOR/USER RECORD                            *
  3213****************************************************************
  3214
  3215     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3216         16  CF-PROCESSOR-NAME              PIC X(30).
  3217         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3218         16  CF-PROCESSOR-TITLE             PIC X(26).
  3219         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3220                 88  MESSAGE-YES                VALUE 'Y'.
  3221                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3222
  3223*****************************************************
  3224****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3225****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3226****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3227****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3228*****************************************************
  3229
  3230         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3231             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3232             20  CF-APPLICATION-FORCE       PIC X.
  3233             20  CF-INDIVIDUAL-APP.
  3234                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3235                     28  CF-BROWSE-APP      PIC X.
  3236                     28  CF-UPDATE-APP      PIC X.
  3237
  3238         16  CF-CURRENT-TERM-ON             PIC X(4).
  3239         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3240             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  61
* EL1278.cbl
  3241             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3242             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3243             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3244             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3245             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3246             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3247         16  CF-PROCESSOR-CARRIER           PIC X.
  3248             88  NO-CARRIER-SECURITY            VALUE ' '.
  3249         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3250             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3251         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3252             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3253         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3254             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3255
  3256         16  CF-PROC-SYS-ACCESS-SW.
  3257             20  CF-PROC-CREDIT-CLAIMS-SW.
  3258                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3259                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3260                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3261                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3262             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3263                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3264                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3265             20  CF-PROC-LIFE-GNRLDGR-SW.
  3266                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3267                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3268                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3269                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3270             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3271                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3272                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3273         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3274             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3275             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3276         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3277
  3278         16  CF-APPROVAL-LEVEL                  PIC X.
  3279             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3280             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3281             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3282             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3283
  3284         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3285
  3286         16  CF-LANGUAGE-TYPE                   PIC X.
  3287             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3288             88  CF-LANG-IS-FR                      VALUE 'F'.
  3289
  3290         16  CF-CSR-IND                         PIC X.
  3291         16  FILLER                             PIC X(239).
  3292
  3293****************************************************************
  3294*             PROCESSOR/REMINDERS RECORD                       *
  3295****************************************************************
  3296
  3297     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3298         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  62
* EL1278.cbl
  3299             20  CF-START-REMIND-DT         PIC XX.
  3300             20  CF-END-REMIND-DT           PIC XX.
  3301             20  CF-REMINDER-TEXT           PIC X(50).
  3302         16  FILLER                         PIC X(296).
  3303
  3304
  3305****************************************************************
  3306*             STATE MASTER RECORD                              *
  3307****************************************************************
  3308
  3309     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3310         16  CF-STATE-ABBREVIATION          PIC XX.
  3311         16  CF-STATE-NAME                  PIC X(25).
  3312         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3313         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3314             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3315             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3316             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3317             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3318                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3319                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3320             20  CF-ST-PREM-REJECT-SW       PIC X.
  3321                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3322                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3323             20  CF-ST-REF-REJECT-SW        PIC X.
  3324                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3325                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3326         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3327         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3328         16  CF-ST-REFUND-RULES.
  3329             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3330             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3331             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3332         16  CF-ST-FST-PMT-EXTENSION.
  3333             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3334             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3335                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3336                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3337                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3338                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3339         16  CF-ST-STATE-CALL.
  3340             20  CF-ST-CALL-UNEARNED        PIC X.
  3341             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3342             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3343         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3344             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3345             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3346         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3347         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3348         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3349         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3350         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3351         16  FILLER                         PIC X.
  3352         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3353             20  CF-ST-BENEFIT-CD           PIC XX.
  3354             20  CF-ST-BENEFIT-KIND         PIC X.
  3355                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3356                 88  CF-ST-AH-KIND              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  63
* EL1278.cbl
  3357             20  CF-ST-REM-TERM-CALC        PIC X.
  3358                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3359                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3360                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3361                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3362                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3363                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3364                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3365                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3366
  3367             20  CF-ST-REFUND-CALC          PIC X.
  3368                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3369                 88  ST-REFD-BY-R78             VALUE '1'.
  3370                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3371                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3372                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3373                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3374                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3375                 88  ST-REFD-UTAH               VALUE '7'.
  3376                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3377                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3378                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3379
  3380             20  CF-ST-EARNING-CALC         PIC X.
  3381                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3382                 88  ST-EARN-BY-R78             VALUE '1'.
  3383                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3384                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3385                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3386                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3387                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3388                 88  ST-EARN-MEAN               VALUE '8'.
  3389                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3390
  3391             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3392                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3393                 88  ST-OVRD-BY-R78             VALUE '1'.
  3394                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3395                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3396                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3397                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3398                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3399                 88  ST-OVRD-MEAN               VALUE '8'.
  3400                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3401             20  FILLER                     PIC X.
  3402
  3403         16  CF-ST-COMMISSION-CAPS.
  3404             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3405             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3406             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3407             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3408         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3409                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3410
  3411         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3412
  3413         16  CF-ST-STATUTORY-INTEREST.
  3414             20  CF-ST-STAT-DATE-FROM       PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  64
* EL1278.cbl
  3415                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3416                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3417             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3418             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3419             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3420             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3421             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3422
  3423         16  CF-ST-OVER-SHORT.
  3424             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3425             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3426
  3427         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3428
  3429         16  CF-ST-RT-CALC                  PIC X.
  3430
  3431         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3432         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3433         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3434         16  CF-ST-RF-LR-CALC               PIC X.
  3435         16  CF-ST-RF-LL-CALC               PIC X.
  3436         16  CF-ST-RF-LN-CALC               PIC X.
  3437         16  CF-ST-RF-AH-CALC               PIC X.
  3438         16  CF-ST-RF-CP-CALC               PIC X.
  3439*        16  FILLER                         PIC X(206).
  3440*CIDMOD         16  FILLER                         PIC X(192).
  3441         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3442             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3443         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3444         16  CF-ST-VFY-2ND-BENE             PIC X.
  3445         16  FILLER                         PIC X(186).
  3446
  3447****************************************************************
  3448*             BENEFIT MASTER RECORD                            *
  3449****************************************************************
  3450
  3451     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3452         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3453             20  CF-BENEFIT-CODE            PIC XX.
  3454             20  CF-BENEFIT-NUMERIC  REDEFINES
  3455                 CF-BENEFIT-CODE            PIC XX.
  3456             20  CF-BENEFIT-ALPHA           PIC XXX.
  3457             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3458             20  CF-BENEFIT-COMMENT         PIC X(10).
  3459
  3460             20  CF-LF-COVERAGE-TYPE        PIC X.
  3461                 88  CF-REDUCING                VALUE 'R'.
  3462                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3463
  3464             20  CF-SPECIAL-CALC-CD         PIC X.
  3465                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3466                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3467                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3468                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3469                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3470                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3471                 88  CF-FARM-PLAN               VALUE 'F'.
  3472                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  65
* EL1278.cbl
  3473                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3474                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3475                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3476                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3477                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3478                 88  CF-PRUDENTIAL              VALUE 'P'.
  3479                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3480                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3481                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3482                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3483                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3484                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3485
  3486             20  CF-JOINT-INDICATOR         PIC X.
  3487                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3488
  3489*            20  FILLER                     PIC X(12).
  3490             20  FILLER                     PIC X(11).
  3491             20  CF-BENEFIT-CATEGORY        PIC X.
  3492             20  CF-LOAN-TYPE               PIC X(8).
  3493
  3494             20  CF-CO-REM-TERM-CALC        PIC X.
  3495                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3496                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3497                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3498                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3499                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3500
  3501             20  CF-CO-EARNINGS-CALC        PIC X.
  3502                 88  CO-EARN-BY-R78             VALUE '1'.
  3503                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3504                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3505                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3506                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3507                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3508                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3509                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3510
  3511             20  CF-CO-REFUND-CALC          PIC X.
  3512                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3513                 88  CO-REFD-BY-R78             VALUE '1'.
  3514                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3515                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3516                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3517                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3518                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3519                 88  CO-REFD-MEAN               VALUE '8'.
  3520                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3521                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3522                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3523
  3524             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3525                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3526                 88  CO-OVRD-BY-R78             VALUE '1'.
  3527                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3528                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3529                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3530                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  66
* EL1278.cbl
  3531                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3532                 88  CO-OVRD-MEAN               VALUE '8'.
  3533                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3534
  3535             20  CF-CO-BEN-I-G-CD           PIC X.
  3536                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3537                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3538                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3539
  3540         16  FILLER                         PIC X(304).
  3541
  3542
  3543****************************************************************
  3544*             CARRIER MASTER RECORD                            *
  3545****************************************************************
  3546
  3547     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3548         16  CF-ADDRESS-DATA.
  3549             20  CF-MAIL-TO-NAME            PIC X(30).
  3550             20  CF-IN-CARE-OF              PIC X(30).
  3551             20  CF-ADDRESS-LINE-1          PIC X(30).
  3552             20  CF-ADDRESS-LINE-2          PIC X(30).
  3553             20  CF-CITY-STATE              PIC X(30).
  3554             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3555             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3556
  3557         16  CF-CLAIM-NO-CONTROL.
  3558             20  CF-CLAIM-NO-METHOD         PIC X.
  3559                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3560                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3561                 88  CLAIM-NO-SEQ               VALUE '3'.
  3562                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3563             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3564                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3565                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3566                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3567
  3568         16  CF-CHECK-NO-CONTROL.
  3569             20  CF-CHECK-NO-METHOD         PIC X.
  3570                 88  CHECK-NO-MANUAL            VALUE '1'.
  3571                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3572                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3573                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3574             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3575                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3576
  3577         16  CF-DOMICILE-STATE              PIC XX.
  3578
  3579         16  CF-EXPENSE-CONTROLS.
  3580             20  CF-EXPENSE-METHOD          PIC X.
  3581                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3582                 88  DOLLARS-PER-PMT            VALUE '2'.
  3583                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3584                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3585             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3586             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3587
  3588         16  CF-CORRESPONDENCE-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  67
* EL1278.cbl
  3589             20  CF-LETTER-RESEND-OPT       PIC X.
  3590                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3591                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3592             20  FILLER                     PIC X(4).
  3593
  3594         16  CF-RESERVE-CONTROLS.
  3595             20  CF-MANUAL-SW               PIC X.
  3596                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3597             20  CF-FUTURE-SW               PIC X.
  3598                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3599             20  CF-PTC-SW                  PIC X.
  3600                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3601             20  CF-IBNR-SW                 PIC X.
  3602                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3603             20  CF-PTC-LF-SW               PIC X.
  3604                 88  CF-LF-PTC-USED             VALUE '1'.
  3605             20  CF-CDT-ACCESS-METHOD       PIC X.
  3606                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3607                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3608                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3609             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3610
  3611         16  CF-CLAIM-CALC-METHOD           PIC X.
  3612             88  360-PLUS-MONTHS                VALUE '1'.
  3613             88  365-PLUS-MONTHS                VALUE '2'.
  3614             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3615             88  360-DAILY                      VALUE '4'.
  3616             88  365-DAILY                      VALUE '5'.
  3617
  3618         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3619         16  FILLER                         PIC X(11).
  3620
  3621         16  CF-LIMIT-AMOUNTS.
  3622             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3623             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3624             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3625             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3626             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3627             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3628             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3629             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3630             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3631             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3632
  3633         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3634         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3635         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3636
  3637         16  CF-ZIP-CODE.
  3638             20  CF-ZIP-PRIME.
  3639                 24  CF-ZIP-1ST             PIC X.
  3640                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3641                 24  FILLER                 PIC X(4).
  3642             20  CF-ZIP-PLUS4               PIC X(4).
  3643         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3644             20  CF-CAN-POSTAL-1            PIC XXX.
  3645             20  CF-CAN-POSTAL-2            PIC XXX.
  3646             20  FILLER                     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  68
* EL1278.cbl
  3647
  3648         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3649         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3650         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3651
  3652         16  CF-RATING-SWITCH               PIC X.
  3653             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3654             88  CF-NO-RATING                   VALUE 'N'.
  3655
  3656         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3657
  3658         16  CF-CARRIER-OVER-SHORT.
  3659             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3660             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3661
  3662         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3663         16  CF-SECPAY-SWITCH               PIC X.
  3664             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3665             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3666         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3667         16  FILLER                         PIC X(448).
  3668*        16  FILLER                         PIC X(452).
  3669
  3670
  3671****************************************************************
  3672*             MORTALITY MASTER RECORD                          *
  3673****************************************************************
  3674
  3675     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3676         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3677                                INDEXED BY CF-MORT-NDX.
  3678             20  CF-MORT-TABLE              PIC X(5).
  3679             20  CF-MORT-TABLE-TYPE         PIC X.
  3680                 88  CF-MORT-JOINT              VALUE 'J'.
  3681                 88  CF-MORT-SINGLE             VALUE 'S'.
  3682                 88  CF-MORT-COMBINED           VALUE 'C'.
  3683                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3684                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3685             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3686             20  CF-MORT-AGE-METHOD         PIC XX.
  3687                 88  CF-AGE-LAST                VALUE 'AL'.
  3688                 88  CF-AGE-NEAR                VALUE 'AN'.
  3689             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3690             20  CF-MORT-ADJUSTMENT-DIRECTION
  3691                                            PIC X.
  3692                 88  CF-MINUS                   VALUE '-'.
  3693                 88  CF-PLUS                    VALUE '+'.
  3694             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3695             20  CF-MORT-JOINT-CODE         PIC X.
  3696                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3697             20  CF-MORT-PC-Q               PIC X.
  3698                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3699             20  CF-MORT-TABLE-CODE         PIC X(4).
  3700             20  CF-MORT-COMMENTS           PIC X(15).
  3701             20  FILLER                     PIC X(14).
  3702
  3703         16  FILLER                         PIC X(251).
  3704
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  69
* EL1278.cbl
  3705
  3706****************************************************************
  3707*             BUSSINESS TYPE MASTER RECORD                     *
  3708****************************************************************
  3709
  3710     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3711* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3712* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3713* AND RECORD 05 IS TYPES 81-99
  3714         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3715             20  CF-BUSINESS-TITLE          PIC  X(19).
  3716             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3717                                            PIC S9V9(4) COMP-3.
  3718             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3719             20  FILLER                     PIC  X.
  3720         16  FILLER                         PIC  X(248).
  3721
  3722
  3723****************************************************************
  3724*             TERMINAL MASTER RECORD                           *
  3725****************************************************************
  3726
  3727     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3728
  3729         16  CF-COMPANY-TERMINALS.
  3730             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3731                                  PIC X(4).
  3732         16  FILLER               PIC X(248).
  3733
  3734
  3735****************************************************************
  3736*             LIFE EDIT MASTER RECORD                          *
  3737****************************************************************
  3738
  3739     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3740         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3741             20  CF-LIFE-CODE-IN            PIC XX.
  3742             20  CF-LIFE-CODE-OUT           PIC XX.
  3743         16  FILLER                         PIC X(248).
  3744
  3745
  3746****************************************************************
  3747*             AH EDIT MASTER RECORD                            *
  3748****************************************************************
  3749
  3750     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3751         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3752             20  CF-AH-CODE-IN              PIC XXX.
  3753             20  CF-AH-CODE-OUT             PIC XX.
  3754         16  FILLER                         PIC X(248).
  3755
  3756
  3757****************************************************************
  3758*             CREDIBILITY TABLES                               *
  3759****************************************************************
  3760
  3761     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3762         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  70
* EL1278.cbl
  3763                             INDEXED BY CF-CRDB-NDX.
  3764             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3765             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3766             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3767         16  FILLER                         PIC  X(332).
  3768
  3769
  3770****************************************************************
  3771*             REPORT CUSTOMIZATION RECORD                      *
  3772****************************************************************
  3773
  3774     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3775         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3776             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3777             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3778             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3779**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3780****       A T-TRANSFER.                                   ****
  3781             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3782
  3783         16  FILLER                         PIC XX.
  3784
  3785         16  CF-CARRIER-CNTL-OPT.
  3786             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3787                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3788                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3789             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3790                                            PIC X.
  3791         16  CF-GROUP-CNTL-OPT.
  3792             20  CF-GROUP-OPT-SEQ           PIC 9.
  3793                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3794                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3795             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3796                                            PIC X(6).
  3797         16  CF-STATE-CNTL-OPT.
  3798             20  CF-STATE-OPT-SEQ           PIC 9.
  3799                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3800                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3801             20  CF-STATE-SELECT OCCURS 3 TIMES
  3802                                            PIC XX.
  3803         16  CF-ACCOUNT-CNTL-OPT.
  3804             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3805                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3806                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3807             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3808                                            PIC X(10).
  3809         16  CF-BUS-TYP-CNTL-OPT.
  3810             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3811                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3812                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3813             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3814                                            PIC XX.
  3815         16  CF-LF-TYP-CNTL-OPT.
  3816             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3817                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3818                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3819             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3820                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  71
* EL1278.cbl
  3821         16  CF-AH-TYP-CNTL-OPT.
  3822             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3823                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3824                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3825             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3826                                            PIC XX.
  3827         16  CF-REPTCD1-CNTL-OPT.
  3828             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3829                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3830                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3831             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3832                                            PIC X(10).
  3833         16  CF-REPTCD2-CNTL-OPT.
  3834             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3835                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3836                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3837             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3838                                            PIC X(10).
  3839         16  CF-USER1-CNTL-OPT.
  3840             20  CF-USER1-OPT-SEQ           PIC 9.
  3841                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3842                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3843             20  CF-USER1-SELECT OCCURS 3 TIMES
  3844                                            PIC X(10).
  3845         16  CF-USER2-CNTL-OPT.
  3846             20  CF-USER2-OPT-SEQ           PIC 9.
  3847                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3848                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3849             20  CF-USER2-SELECT OCCURS 3 TIMES
  3850                                            PIC X(10).
  3851         16  CF-USER3-CNTL-OPT.
  3852             20  CF-USER3-OPT-SEQ           PIC 9.
  3853                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3854                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3855             20  CF-USER3-SELECT OCCURS 3 TIMES
  3856                                            PIC X(10).
  3857         16  CF-USER4-CNTL-OPT.
  3858             20  CF-USER4-OPT-SEQ           PIC 9.
  3859                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3860                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3861             20  CF-USER4-SELECT OCCURS 3 TIMES
  3862                                            PIC X(10).
  3863         16  CF-USER5-CNTL-OPT.
  3864             20  CF-USER5-OPT-SEQ           PIC 9.
  3865                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3866                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3867             20  CF-USER5-SELECT OCCURS 3 TIMES
  3868                                            PIC X(10).
  3869         16  CF-REINS-CNTL-OPT.
  3870             20  CF-REINS-OPT-SEQ           PIC 9.
  3871                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3872                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3873             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3874                 24  CF-REINS-PRIME         PIC XXX.
  3875                 24  CF-REINS-SUB           PIC XXX.
  3876
  3877         16  CF-AGENT-CNTL-OPT.
  3878             20  CF-AGENT-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  72
* EL1278.cbl
  3879                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3880                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3881             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3882                                            PIC X(10).
  3883
  3884         16  FILLER                         PIC X(43).
  3885
  3886         16  CF-LOSS-RATIO-SELECT.
  3887             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3888             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3889         16  CF-ENTRY-DATE-SELECT.
  3890             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3891             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3892         16  CF-EFFECTIVE-DATE-SELECT.
  3893             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3894             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3895
  3896         16  CF-EXCEPTION-LIST-IND          PIC X.
  3897             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3898
  3899         16  FILLER                         PIC X(318).
  3900
  3901****************************************************************
  3902*                  EXCEPTION REPORTING RECORD                  *
  3903****************************************************************
  3904
  3905     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3906         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3907             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3908
  3909         16  CF-COMBINED-LIFE-AH-OPT.
  3910             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3911             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3912             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3913             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3914
  3915         16  CF-LIFE-OPT.
  3916             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3917             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3918             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3919             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3920             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3921             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3922             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3923             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3924             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3925             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3926
  3927         16  CF-AH-OPT.
  3928             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3929             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3930             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3931             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3932             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3933             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3934             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3935             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3936             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  73
* EL1278.cbl
  3937             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3938
  3939         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3940             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3941             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3942             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3943
  3944         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3945
  3946         16  FILLER                         PIC X(673).
  3947
  3948
  3949****************************************************************
  3950*             MORTGAGE SYSTEM PLAN RECORD                      *
  3951****************************************************************
  3952
  3953     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3954         16  CF-PLAN-TYPE                   PIC X.
  3955             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3956             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3957             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3958         16  CF-PLAN-ABBREV                 PIC XXX.
  3959         16  CF-PLAN-DESCRIPT               PIC X(10).
  3960         16  CF-PLAN-NOTES                  PIC X(20).
  3961         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3962         16  CF-PLAN-UNDERWRITING.
  3963             20  CF-PLAN-TERM-DATA.
  3964                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3965                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3966             20  CF-PLAN-AGE-DATA.
  3967                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3968                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3969                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3970             20  CF-PLAN-BENEFIT-DATA.
  3971                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3972                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3973                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3974                                            PIC S9(7)V99  COMP-3.
  3975         16  CF-PLAN-POLICY-FORMS.
  3976             20  CF-POLICY-FORM             PIC X(12).
  3977             20  CF-MASTER-APPLICATION      PIC X(12).
  3978             20  CF-MASTER-POLICY           PIC X(12).
  3979         16  CF-PLAN-RATING.
  3980             20  CF-RATE-CODE               PIC X(5).
  3981             20  CF-SEX-RATING              PIC X.
  3982                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3983                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3984             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3985             20  CF-SUB-STD-TYPE            PIC X.
  3986                 88  CF-PCT-OF-PREM            VALUE '1'.
  3987                 88  CF-PCT-OF-BENE            VALUE '2'.
  3988         16  CF-PLAN-PREM-TOLERANCES.
  3989             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3990             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3991         16  CF-PLAN-PYMT-TOLERANCES.
  3992             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3993             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3994         16  CF-PLAN-MISC-DATA.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  74
* EL1278.cbl
  3995             20  FILLER                     PIC X.
  3996             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3997             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3998         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3999         16  CF-PLAN-IND-GRP                PIC X.
  4000             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4001                                                     '1'.
  4002             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4003                                                     '2'.
  4004         16  CF-MIB-SEARCH-SW               PIC X.
  4005             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4006             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4007             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4008             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4009         16  CF-ALPHA-SEARCH-SW             PIC X.
  4010             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4011             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4012             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4013             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4014             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4015             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4016             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4017             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4018             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4019             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4020                                                     'A' 'B' 'C'
  4021                                                     'X' 'Y' 'Z'.
  4022         16  CF-EFF-DT-RULE-SW              PIC X.
  4023             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4024             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4025             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4026             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4027             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4028         16  FILLER                         PIC X(4).
  4029         16  CF-HEALTH-QUESTIONS            PIC X.
  4030             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4031         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4032         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4033         16  CF-PLAN-SNGL-JNT               PIC X.
  4034             88  CF-COMBINED-PLAN              VALUE 'C'.
  4035             88  CF-JNT-PLAN                   VALUE 'J'.
  4036             88  CF-SNGL-PLAN                  VALUE 'S'.
  4037         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4038         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4039         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4040         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4041         16  CF-RERATE-CNTL                 PIC  X.
  4042             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4043             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4044             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4045             88  CF-AUTO-RECALC                 VALUE '4'.
  4046         16  CF-BENEFIT-TYPE                PIC  X.
  4047             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4048             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4049         16  CF-POLICY-FEE                  PIC S999V99
  4050                                                    COMP-3.
  4051         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4052         16  CF-2ND-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  75
* EL1278.cbl
  4053         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4054         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4055         16  FILLER                         PIC  X(32).
  4056         16  CF-TERMINATION-FORM            PIC  X(04).
  4057         16  FILLER                         PIC  X(08).
  4058         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4059                                                       COMP-3.
  4060         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4061         16  CF-ISSUE-LETTER                PIC  X(4).
  4062         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4063         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4064             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4065             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4066         16  CF-MP-REFUND-CALC              PIC X.
  4067             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4068             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4069             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4070             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4071             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4072             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4073             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4074             88  CF-MP-REFD-MEAN                VALUE '8'.
  4075         16  CF-ALT-RATE-CODE               PIC  X(5).
  4076
  4077
  4078         16  FILLER                         PIC X(498).
  4079****************************************************************
  4080*             MORTGAGE COMPANY MASTER RECORD                   *
  4081****************************************************************
  4082
  4083     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4084         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4085         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4086             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4087             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4088             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4089             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4090             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4091
  4092         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4093         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4094         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4095         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4096         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4097
  4098         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4099             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4100         16  CF-MP-RECON-USE-IND            PIC X(1).
  4101             88  CF-MP-USE-RECON             VALUE 'Y'.
  4102         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4103             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4104         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4105             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4106             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4107         16  FILLER                         PIC X(1).
  4108         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4109             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4110         16  CF-MORTG-MIB-VERSION           PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  76
* EL1278.cbl
  4111             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4112             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4113             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4114         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4115             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4116                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4117             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4118                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4119             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4120                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4121             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4122                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4123             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4124                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4125             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4126                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4127         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4128         16  FILLER                         PIC X(7).
  4129         16  CF-MORTG-DESTINATION-SYMBOL.
  4130             20  CF-MORTG-MIB-COMM          PIC X(5).
  4131             20  CF-MORTG-MIB-TERM          PIC X(5).
  4132         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4133             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4134         16  FILLER                         PIC X(03).
  4135         16  CF-MP-CHECK-NO-CONTROL.
  4136             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4137                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4138                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4139                                                ' ' LOW-VALUES.
  4140                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4141                                               VALUE '3'.
  4142         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4143         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4144         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4145             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4146                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4147             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4148                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4149             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4150                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4151             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4152                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4153             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4154                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4155             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4156                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4157         16  CF-MORTG-BILLING-AREA.
  4158             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4159                                            PIC X.
  4160         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4161         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4162         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4163         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4164             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4165             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4166         16  FILLER                         PIC X.
  4167         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4168             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  77
* EL1278.cbl
  4169             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4170         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4171         16  FILLER                         PIC X(8).
  4172         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4173         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4174         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4175         16  CF-ACH-COMPANY-ID.
  4176             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4177                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4178                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4179                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4180             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4181         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4182             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4183         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4184             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4185             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4186         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4187         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4188         16  FILLER                         PIC X(536).
  4189
  4190****************************************************************
  4191*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4192****************************************************************
  4193
  4194     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4195         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4196             20  CF-FEMALE-HEIGHT.
  4197                 24  CF-FEMALE-FT           PIC 99.
  4198                 24  CF-FEMALE-IN           PIC 99.
  4199             20  CF-FEMALE-MIN-WT           PIC 999.
  4200             20  CF-FEMALE-MAX-WT           PIC 999.
  4201         16  FILLER                         PIC X(428).
  4202
  4203     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4204         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4205             20  CF-MALE-HEIGHT.
  4206                 24  CF-MALE-FT             PIC 99.
  4207                 24  CF-MALE-IN             PIC 99.
  4208             20  CF-MALE-MIN-WT             PIC 999.
  4209             20  CF-MALE-MAX-WT             PIC 999.
  4210         16  FILLER                         PIC X(428).
  4211******************************************************************
  4212*             AUTOMATIC ACTIVITY RECORD                          *
  4213******************************************************************
  4214     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4215         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4216             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4217             20  CF-SYS-LETTER-ID           PIC X(04).
  4218             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4219             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4220             20  CF-SYS-RESET-SW            PIC X(01).
  4221             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4222             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4223
  4224         16  FILLER                         PIC X(50).
  4225
  4226         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  78
* EL1278.cbl
  4227             20  CF-USER-ACTIVE-SW          PIC X(01).
  4228             20  CF-USER-LETTER-ID          PIC X(04).
  4229             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4230             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4231             20  CF-USER-RESET-SW           PIC X(01).
  4232             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4233             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4234             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4235
  4236         16  FILLER                         PIC X(246).
  4237*                            COPY ERCACCT.
  4238******************************************************************
  4239*                                                                *
  4240*                                                                *
  4241*                            ERCACCT                             *
  4242*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4243*                            VMOD=2.031                          *
  4244*                                                                *
  4245*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4246*                                                                *
  4247*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4248*   VSAM ACCOUNT MASTER FILES.                                   *
  4249*                                                                *
  4250*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4251*                                                                *
  4252*   FILE TYPE = VSAM,KSDS                                        *
  4253*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4254*                                                                *
  4255*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4256*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4257*                                                                *
  4258*   LOG = NO                                                     *
  4259*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4260*                                                                *
  4261*                                                                *
  4262******************************************************************
  4263*                   C H A N G E   L O G
  4264*
  4265* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4266*-----------------------------------------------------------------
  4267*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4268* EFFECTIVE    NUMBER
  4269*-----------------------------------------------------------------
  4270* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4271* 092705    2005050300006  PEMA  ADD SPP LEASES
  4272* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4273* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4274* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4275* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4276* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4277******************************************************************
  4278
  4279 01  ACCOUNT-MASTER.
  4280     12  AM-RECORD-ID                      PIC XX.
  4281         88  VALID-AM-ID                      VALUE 'AM'.
  4282
  4283     12  AM-CONTROL-PRIMARY.
  4284         16  AM-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  79
* EL1278.cbl
  4285         16  AM-MSTR-CNTRL.
  4286             20  AM-CONTROL-A.
  4287                 24  AM-CARRIER            PIC X.
  4288                 24  AM-GROUPING.
  4289                     28 AM-GROUPING-PREFIX PIC XXX.
  4290                     28 AM-GROUPING-PRIME  PIC XXX.
  4291                 24  AM-STATE              PIC XX.
  4292                 24  AM-ACCOUNT.
  4293                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4294                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4295             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4296                                           PIC X(19).
  4297             20  AM-CNTRL-B.
  4298                 24  AM-EXPIRATION-DT      PIC XX.
  4299                 24  FILLER                PIC X(4).
  4300             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4301                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4302
  4303     12  AM-CONTROL-BY-VAR-GRP.
  4304         16  AM-COMPANY-CD-A1              PIC X.
  4305         16  AM-VG-CARRIER                 PIC X.
  4306         16  AM-VG-GROUPING                PIC X(6).
  4307         16  AM-VG-STATE                   PIC XX.
  4308         16  AM-VG-ACCOUNT                 PIC X(10).
  4309         16  AM-VG-DATE.
  4310             20  AM-VG-EXPIRATION-DT       PIC XX.
  4311             20  FILLER                    PIC X(4).
  4312         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4313                                           PIC 9(11)      COMP-3.
  4314     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4315         16  FILLER                        PIC X(10).
  4316         16  AM-VG-KEY3.
  4317             20  AM-VG3-ACCOUNT            PIC X(10).
  4318             20  AM-VG3-EXP-DT             PIC XX.
  4319         16  FILLER                        PIC X(4).
  4320     12  AM-MAINT-INFORMATION.
  4321         16  AM-LAST-MAINT-DT              PIC XX.
  4322         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4323         16  AM-LAST-MAINT-USER            PIC X(4).
  4324         16  FILLER                        PIC XX.
  4325
  4326     12  AM-EFFECTIVE-DT                   PIC XX.
  4327     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4328
  4329     12  AM-PREV-DATES  COMP-3.
  4330         16  AM-PREV-EXP-DT                PIC 9(11).
  4331         16  AM-PREV-EFF-DT                PIC 9(11).
  4332
  4333     12  AM-REPORT-CODE-1                  PIC X(10).
  4334     12  AM-REPORT-CODE-2                  PIC X(10).
  4335
  4336     12  AM-CITY-CODE                      PIC X(4).
  4337     12  AM-COUNTY-PARISH                  PIC X(6).
  4338
  4339     12  AM-NAME                           PIC X(30).
  4340     12  AM-PERSON                         PIC X(30).
  4341     12  AM-ADDRS                          PIC X(30).
  4342     12  AM-CITY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  80
* EL1278.cbl
  4343         16  AM-ADDR-CITY                  PIC X(28).
  4344         16  AM-ADDR-STATE                 PIC XX.
  4345     12  AM-ZIP.
  4346         16  AM-ZIP-PRIME.
  4347             20  AM-ZIP-PRI-1ST            PIC X.
  4348                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4349             20  FILLER                    PIC X(4).
  4350         16  AM-ZIP-PLUS4                  PIC X(4).
  4351     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4352         16  AM-CAN-POSTAL-1               PIC XXX.
  4353         16  AM-CAN-POSTAL-2               PIC XXX.
  4354         16  FILLER                        PIC XXX.
  4355     12  AM-TEL-NO.
  4356         16  AM-AREA-CODE                  PIC 999.
  4357         16  AM-TEL-PRE                    PIC 999.
  4358         16  AM-TEL-NBR                    PIC 9(4).
  4359     12  AM-TEL-LOC                        PIC X.
  4360         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4361         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4362
  4363     12  AM-COMM-STRUCTURE.
  4364         16  AM-DEFN-1.
  4365             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4366                 24  AM-AGT.
  4367                     28  AM-AGT-PREFIX     PIC X(4).
  4368                     28  AM-AGT-PRIME      PIC X(6).
  4369                 24  AM-COM-TYP            PIC X.
  4370                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4371                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4372                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4373                 24  AM-RECALC-LV-INDIC    PIC X.
  4374                 24  AM-RETRO-LV-INDIC     PIC X.
  4375                 24  AM-GL-CODES           PIC X.
  4376                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4377                 24  FILLER                PIC X(01).
  4378         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4379             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4380                 24  FILLER                PIC X(11).
  4381                 24  AM-L-COMA             PIC XXX.
  4382                 24  AM-J-COMA             PIC XXX.
  4383                 24  AM-A-COMA             PIC XXX.
  4384                 24  FILLER                PIC X(6).
  4385
  4386     12  AM-COMM-CHANGE-STATUS             PIC X.
  4387         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4388
  4389     12  AM-CSR-CODE                       PIC X(4).
  4390
  4391     12  AM-BILLING-STATUS                 PIC X.
  4392         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4393         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4394     12  AM-AUTO-REFUND-SW                 PIC X.
  4395         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4396         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4397     12  AM-GPCD                           PIC 99.
  4398     12  AM-IG                             PIC X.
  4399         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4400         88  AM-HAS-GROUP                     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  81
* EL1278.cbl
  4401     12  AM-STATUS                         PIC X.
  4402         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4403         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4404         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4405         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4406         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4407         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4408     12  AM-REMIT-TO                       PIC 99.
  4409     12  AM-ID-NO                          PIC X(11).
  4410
  4411     12  AM-CAL-TABLE                      PIC XX.
  4412     12  AM-LF-DEVIATION                   PIC XXX.
  4413     12  AM-AH-DEVIATION                   PIC XXX.
  4414     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4415     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4416     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4417     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4418     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4419     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4420
  4421     12  AM-USER-FIELDS.
  4422         16  AM-FLD-1                      PIC XX.
  4423         16  AM-FLD-2                      PIC XX.
  4424         16  AM-FLD-3                      PIC XX.
  4425         16  AM-FLD-4                      PIC XX.
  4426         16  AM-FLD-5                      PIC XX.
  4427
  4428     12  AM-1ST-PROD-DATE.
  4429         16  AM-1ST-PROD-YR                PIC XX.
  4430         16  AM-1ST-PROD-MO                PIC XX.
  4431         16  AM-1ST-PROD-DA                PIC XX.
  4432     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4433     12  AM-CERTS-PURGED-DATE.
  4434         16  AM-PUR-YR                     PIC XX.
  4435         16  AM-PUR-MO                     PIC XX.
  4436         16  AM-PUR-DA                     PIC XX.
  4437     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4438     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4439     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4440     12  AM-INACTIVE-DATE.
  4441         16  AM-INA-MO                     PIC 99.
  4442         16  AM-INA-DA                     PIC 99.
  4443         16  AM-INA-YR                     PIC 99.
  4444     12  AM-AR-HI-CERT-DATE                PIC XX.
  4445
  4446     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4447     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4448
  4449     12  AM-OB-PAYMENT-MODE                PIC X.
  4450         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4451         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4452         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4453         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4454
  4455     12  AM-AH-ONLY-INDICATOR              PIC X.
  4456         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4457         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4458
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  82
* EL1278.cbl
  4459     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4460
  4461     12  AM-OVER-SHORT.
  4462         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4463         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4464
  4465     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4466     12  AM-DCC-CLP-STATE                  PIC XX.
  4467
  4468     12  AM-RECALC-COMM                    PIC X.
  4469     12  AM-RECALC-REIN                    PIC X.
  4470
  4471     12  AM-REI-TABLE                      PIC XXX.
  4472     12  AM-REI-ET-LF                      PIC X.
  4473     12  AM-REI-ET-AH                      PIC X.
  4474     12  AM-REI-PE-LF                      PIC X.
  4475     12  AM-REI-PE-AH                      PIC X.
  4476     12  AM-REI-PRT-ST                     PIC X.
  4477     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4478     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4479     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4480     12  AM-REI-GROUP-A                    PIC X(6).
  4481     12  AM-REI-MORT                       PIC X(4).
  4482     12  AM-REI-PRT-OW                     PIC X.
  4483     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4484     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4485     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4486     12  AM-REI-GROUP-B                    PIC X(6).
  4487
  4488     12  AM-TRUST-TYPE                     PIC X(2).
  4489
  4490     12  AM-EMPLOYER-STMT-USED             PIC X.
  4491     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4492
  4493     12  AM-STD-AH-TYPE                    PIC XX.
  4494     12  AM-EARN-METHODS.
  4495         16  AM-EARN-METHOD-R              PIC X.
  4496             88 AM-REF-RL-R78                 VALUE 'R'.
  4497             88 AM-REF-RL-PR                  VALUE 'P'.
  4498             88 AM-REF-RL-MEAN                VALUE 'M'.
  4499             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4500         16  AM-EARN-METHOD-L              PIC X.
  4501             88 AM-REF-LL-R78                 VALUE 'R'.
  4502             88 AM-REF-LL-PR                  VALUE 'P'.
  4503             88 AM-REF-LL-MEAN                VALUE 'M'.
  4504             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4505         16  AM-EARN-METHOD-A              PIC X.
  4506             88 AM-REF-AH-R78                 VALUE 'R'.
  4507             88 AM-REF-AH-PR                  VALUE 'P'.
  4508             88 AM-REF-AH-MEAN                VALUE 'M'.
  4509             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4510             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4511             88 AM-REF-AH-NET                 VALUE 'N'.
  4512
  4513     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4514     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4515     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4516
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  83
* EL1278.cbl
  4517     12  AM-RET-Y-N                        PIC X.
  4518     12  AM-RET-P-E                        PIC X.
  4519     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4520     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4521     12  AM-RET-GRP                        PIC X(6).
  4522     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4523         16  AM-POOL-PRIME                 PIC XXX.
  4524         16  AM-POOL-SUB                   PIC XXX.
  4525     12  AM-RETRO-EARNINGS.
  4526         16  AM-RET-EARN-R                 PIC X.
  4527         16  AM-RET-EARN-L                 PIC X.
  4528         16  AM-RET-EARN-A                 PIC X.
  4529     12  AM-RET-ST-TAX-USE                 PIC X.
  4530         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4531         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4532     12  AM-RETRO-BEG-EARNINGS.
  4533         16  AM-RET-BEG-EARN-R             PIC X.
  4534         16  AM-RET-BEG-EARN-L             PIC X.
  4535         16  AM-RET-BEG-EARN-A             PIC X.
  4536     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4537     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4538
  4539     12  AM-USER-SELECT-OPTIONS.
  4540         16  AM-USER-SELECT-1              PIC X(10).
  4541         16  AM-USER-SELECT-2              PIC X(10).
  4542         16  AM-USER-SELECT-3              PIC X(10).
  4543         16  AM-USER-SELECT-4              PIC X(10).
  4544         16  AM-USER-SELECT-5              PIC X(10).
  4545
  4546     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4547
  4548     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4549
  4550     12  AM-RPT045A-SWITCH                 PIC X.
  4551         88  RPT045A-OFF                   VALUE 'N'.
  4552
  4553     12  AM-INSURANCE-LIMITS.
  4554         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4555         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4556
  4557     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4558         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4559
  4560     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4561         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4562         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4563
  4564     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4565
  4566     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4567     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4568     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4569     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4570     12  AM-DCC-UEF-STATE                  PIC XX.
  4571     12  FILLER                            PIC XXX.
  4572     12  AM-REPORT-CODE-3                  PIC X(10).
  4573*    12  FILLER                            PIC X(22).
  4574
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  84
* EL1278.cbl
  4575     12  AM-RESERVE-DATE.
  4576         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4577         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4578         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4579
  4580     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4581     12  AM-NOTIFICATION-TYPES.
  4582         16  AM-NOTIF-OF-LETTERS           PIC X.
  4583         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4584         16  AM-NOTIF-OF-REPORTS           PIC X.
  4585         16  AM-NOTIF-OF-STATUS            PIC X.
  4586
  4587     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4588         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4589         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4590         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4591         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4592
  4593     12  AM-BENEFIT-CONTROLS.
  4594         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4595             20  AM-BENEFIT-CODE           PIC XX.
  4596             20  AM-BENEFIT-TYPE           PIC X.
  4597             20  AM-BENEFIT-REVISION       PIC XXX.
  4598             20  AM-BENEFIT-REM-TERM       PIC X.
  4599             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4600             20  FILLER                    PIC XX.
  4601         16  FILLER                        PIC X(80).
  4602
  4603     12  AM-TRANSFER-DATA.
  4604         16  AM-TRANSFERRED-FROM.
  4605             20  AM-TRNFROM-CARRIER        PIC X.
  4606             20  AM-TRNFROM-GROUPING.
  4607                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4608                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4609             20  AM-TRNFROM-STATE          PIC XX.
  4610             20  AM-TRNFROM-ACCOUNT.
  4611                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4612                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4613             20  AM-TRNFROM-DTE            PIC XX.
  4614         16  AM-TRANSFERRED-TO.
  4615             20  AM-TRNTO-CARRIER          PIC X.
  4616             20  AM-TRNTO-GROUPING.
  4617                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4618                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4619             20  AM-TRNTO-STATE            PIC XX.
  4620             20  AM-TRNTO-ACCOUNT.
  4621                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4622                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4623             20  AM-TRNTO-DTE              PIC XX.
  4624         16  FILLER                        PIC X(10).
  4625
  4626     12  AM-SAVED-REMIT-TO                 PIC 99.
  4627
  4628     12  AM-COMM-STRUCTURE-SAVED.
  4629         16  AM-DEFN-1-SAVED.
  4630             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4631                 24  AM-AGT-SV             PIC X(10).
  4632                 24  AM-COM-TYP-SV         PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  85
* EL1278.cbl
  4633                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4634                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4635                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4636                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4637                 24  FILLER                PIC X.
  4638                 24  AM-GL-CODES-SV        PIC X.
  4639                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4640                 24  FILLER                PIC X.
  4641         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4642             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4643                 24  FILLER                PIC X(11).
  4644                 24  AM-L-COMA-SV          PIC XXX.
  4645                 24  AM-J-COMA-SV          PIC XXX.
  4646                 24  AM-A-COMA-SV          PIC XXX.
  4647                 24  FILLER                PIC X(6).
  4648
  4649     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4650         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4651            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4652            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4653            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4654
  4655     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4656     12  FILLER                            PIC X(120).
  4657
  4658     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4659         16  AM-CONTROL-NAME               PIC X(30).
  4660         16  AM-EXECUTIVE-ONE.
  4661             20  AM-EXEC1-NAME             PIC X(15).
  4662             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4663                                                          COMP-3.
  4664             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4665                                                          COMP-3.
  4666         16  AM-EXECUTIVE-TWO.
  4667             20  AM-EXEC2-NAME             PIC X(15).
  4668             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4669                                                          COMP-3.
  4670             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4671                                                          COMP-3.
  4672
  4673     12  AM-RETRO-ADDITIONAL-DATA.
  4674         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4675         16  AM-RETRO-PREM-P-E             PIC X.
  4676         16  AM-RETRO-CLMS-P-I             PIC X.
  4677         16  AM-RETRO-RET-BRACKET-LF.
  4678             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4679                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4680                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4681             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4682                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4683                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4684             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4685                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4686                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4687         16  AM-RETRO-RET-BRACKET-AH.
  4688             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4689                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4690                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  86
* EL1278.cbl
  4691                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4692             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4693                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4694                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4695             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4696                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4697                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4698
  4699     12  AM-COMMENTS.
  4700         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4701
  4702     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4703         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4704         16  AM-FLI-BILLING-CODE           PIC X.
  4705         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4706         16  AM-FLI-UNITED-IDENT           PIC X.
  4707         16  AM-FLI-INTEREST-LOST-DATA.
  4708             20  AM-FLI-BANK-NO            PIC X(5).
  4709             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4710             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4711             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4712         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4713             20  AM-FLI-AGT                PIC X(9).
  4714             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4715             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4716         16  FILLER                        PIC X(102).
  4717
  4718     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4719         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4720             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4721             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4722             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4723             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4724             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4725         16  FILLER                          PIC X(10).
  4726******************************************************************
  4727*                            COPY ELCCERT.
  4728******************************************************************
  4729*                                                                *
  4730*                            ELCCERT.                            *
  4731*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4732*                            VMOD=2.013                          *
  4733*                                                                *
  4734*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4735*                                                                *
  4736*   FILE TYPE = VSAM,KSDS                                        *
  4737*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4738*                                                                *
  4739*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4740*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4741*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4742*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4743*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4744*                                                                *
  4745*   LOG = YES                                                    *
  4746*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4747******************************************************************
  4748*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  87
* EL1278.cbl
  4749*
  4750* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4751*-----------------------------------------------------------------
  4752*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4753* EFFECTIVE    NUMBER
  4754*-----------------------------------------------------------------
  4755* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4756* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4757* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4758* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4759* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4760* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4761* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4762* 032612  CR2011110200001  PEMA  AHL CHANGES
  4763******************************************************************
  4764
  4765 01  CERTIFICATE-MASTER.
  4766     12  CM-RECORD-ID                      PIC XX.
  4767         88  VALID-CM-ID                      VALUE 'CM'.
  4768
  4769     12  CM-CONTROL-PRIMARY.
  4770         16  CM-COMPANY-CD                 PIC X.
  4771         16  CM-CARRIER                    PIC X.
  4772         16  CM-GROUPING.
  4773             20  CM-GROUPING-PREFIX        PIC X(3).
  4774             20  CM-GROUPING-PRIME         PIC X(3).
  4775         16  CM-STATE                      PIC XX.
  4776         16  CM-ACCOUNT.
  4777             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4778             20  CM-ACCOUNT-PRIME          PIC X(6).
  4779         16  CM-CERT-EFF-DT                PIC XX.
  4780         16  CM-CERT-NO.
  4781             20  CM-CERT-PRIME             PIC X(10).
  4782             20  CM-CERT-SFX               PIC X.
  4783
  4784     12  CM-CONTROL-BY-NAME.
  4785         16  CM-COMPANY-CD-A1              PIC X.
  4786         16  CM-INSURED-LAST-NAME          PIC X(15).
  4787         16  CM-INSURED-INITIALS.
  4788             20  CM-INSURED-INITIAL1       PIC X.
  4789             20  CM-INSURED-INITIAL2       PIC X.
  4790
  4791     12  CM-CONTROL-BY-SSN.
  4792         16  CM-COMPANY-CD-A2              PIC X.
  4793         16  CM-SOC-SEC-NO.
  4794             20  CM-SSN-STATE              PIC XX.
  4795             20  CM-SSN-ACCOUNT            PIC X(6).
  4796             20  CM-SSN-LN3.
  4797                 25  CM-INSURED-INITIALS-A2.
  4798                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4799                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4800                 25 CM-PART-LAST-NAME-A2         PIC X.
  4801
  4802     12  CM-CONTROL-BY-CERT-NO.
  4803         16  CM-COMPANY-CD-A4              PIC X.
  4804         16  CM-CERT-NO-A4                 PIC X(11).
  4805
  4806     12  CM-CONTROL-BY-MEMB.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  88
* EL1278.cbl
  4807         16  CM-COMPANY-CD-A5              PIC X.
  4808         16  CM-MEMBER-NO.
  4809             20  CM-MEMB-STATE             PIC XX.
  4810             20  CM-MEMB-ACCOUNT           PIC X(6).
  4811             20  CM-MEMB-LN4.
  4812                 25  CM-INSURED-INITIALS-A5.
  4813                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4814                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4815                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4816
  4817     12  CM-INSURED-PROFILE-DATA.
  4818         16  CM-INSURED-FIRST-NAME.
  4819             20  CM-INSURED-1ST-INIT       PIC X.
  4820             20  FILLER                    PIC X(9).
  4821         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4822         16  CM-INSURED-SEX                PIC X.
  4823             88  CM-SEX-MALE                  VALUE 'M'.
  4824             88  CM-SEX-FEMAL                 VALUE 'F'.
  4825         16  CM-INSURED-JOINT-AGE          PIC 99.
  4826         16  CM-JOINT-INSURED-NAME.
  4827             20  CM-JT-LAST-NAME           PIC X(15).
  4828             20  CM-JT-FIRST-NAME.
  4829                 24  CM-JT-1ST-INIT        PIC X.
  4830                 24  FILLER                PIC X(9).
  4831             20  CM-JT-INITIAL             PIC X.
  4832
  4833     12  CM-LIFE-DATA.
  4834         16  CM-LF-BENEFIT-CD              PIC XX.
  4835         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4836         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4837         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4838         16  CM-LF-DEV-CODE                PIC XXX.
  4839         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4840         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4841         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4842         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4843         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4844         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4845         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4846         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4847         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4848         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4849         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4850         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4851         16  FILLER                        PIC XX.
  4852
  4853     12  CM-AH-DATA.
  4854         16  CM-AH-BENEFIT-CD              PIC XX.
  4855         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4856         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4857         16  CM-AH-DEV-CODE                PIC XXX.
  4858         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4859         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4860         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4861         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4862         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4863         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4864         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  89
* EL1278.cbl
  4865         16  CM-AH-PAID-THRU-DT            PIC XX.
  4866             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4867         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4868         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4869         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4870         16  FILLER                        PIC X.
  4871
  4872     12  CM-LOAN-INFORMATION.
  4873         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4874         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4875                                           PIC S9(5)V99  COMP-3.
  4876         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4877         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4878         16  CM-PAY-FREQUENCY              PIC S99.
  4879         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4880         16  CM-RATE-CLASS                 PIC XX.
  4881         16  CM-BENEFICIARY                PIC X(25).
  4882         16  CM-POLICY-FORM-NO             PIC X(12).
  4883         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4884         16  CM-LAST-ADD-ON-DT             PIC XX.
  4885         16  CM-DEDUCTIBLE-AMOUNTS.
  4886             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4887             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4888         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4889             20  CM-RESIDENT-STATE         PIC XX.
  4890             20  CM-RATE-CODE              PIC X(4).
  4891             20  FILLER                    PIC XX.
  4892         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4893             20  CM-LOAN-OFFICER           PIC X(5).
  4894             20  FILLER                    PIC XXX.
  4895         16  CM-CSR-CODE                   PIC XXX.
  4896         16  CM-UNDERWRITING-CODE          PIC X.
  4897             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4898         16  CM-POST-CARD-IND              PIC X.
  4899         16  CM-NH-INTERFACE-SW            PIC X.
  4900         16  CM-PREMIUM-TYPE               PIC X.
  4901             88  CM-SING-PRM                  VALUE '1'.
  4902             88  CM-O-B-COVERAGE              VALUE '2'.
  4903             88  CM-OPEN-END                  VALUE '3'.
  4904         16  CM-IND-GRP-TYPE               PIC X.
  4905             88  CM-INDIVIDUAL                VALUE 'I'.
  4906             88  CM-GROUP                     VALUE 'G'.
  4907         16  CM-SKIP-CODE                  PIC X.
  4908             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4909             88  SKIP-JULY                    VALUE '1'.
  4910             88  SKIP-AUGUST                  VALUE '2'.
  4911             88  SKIP-SEPTEMBER               VALUE '3'.
  4912             88  SKIP-JULY-AUG                VALUE '4'.
  4913             88  SKIP-AUG-SEPT                VALUE '5'.
  4914             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4915             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4916             88  SKIP-JUNE                    VALUE '8'.
  4917             88  SKIP-JUNE-JULY               VALUE '9'.
  4918             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4919             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4920         16  CM-PAYMENT-MODE               PIC X.
  4921             88  PAY-MONTHLY                  VALUE SPACE.
  4922             88  PAY-WEEKLY                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  90
* EL1278.cbl
  4923             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4924             88  PAY-BI-WEEKLY                VALUE '3'.
  4925             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4926         16  CM-LOAN-NUMBER                PIC X(8).
  4927         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4928         16  CM-OLD-LOF                    PIC XXX.
  4929*        16  CM-LOAN-OFFICER               PIC XXX.
  4930         16  CM-REIN-TABLE                 PIC XXX.
  4931         16  CM-SPECIAL-REIN-CODE          PIC X.
  4932         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4933         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4934         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4935
  4936     12  CM-STATUS-DATA.
  4937         16  CM-ENTRY-STATUS               PIC X.
  4938         16  CM-ENTRY-DT                   PIC XX.
  4939
  4940         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4941         16  CM-LF-CANCEL-DT               PIC XX.
  4942         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4943
  4944         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4945         16  CM-LF-DEATH-DT                PIC XX.
  4946         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4947
  4948         16  CM-LF-CURRENT-STATUS          PIC X.
  4949             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4950                                                'M' '4' '5' '9'.
  4951             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4952             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4953             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4954             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4955             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4956             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4957             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4958             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4959             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4960             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4961             88  CM-LF-DECLINED               VALUE 'D'.
  4962             88  CM-LF-VOIDED                 VALUE 'V'.
  4963
  4964         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4965         16  CM-AH-CANCEL-DT               PIC XX.
  4966         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4967
  4968         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4969         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4970         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4971
  4972         16  CM-AH-CURRENT-STATUS          PIC X.
  4973             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4974                                                'M' '4' '5' '9'.
  4975             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4976             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4977             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4978             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4979             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4980             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  91
* EL1278.cbl
  4981             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4982             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4983             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4984             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4985             88  CM-AH-DECLINED               VALUE 'D'.
  4986             88  CM-AH-VOIDED                 VALUE 'V'.
  4987
  4988         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4989             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4990             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4991             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4992         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4993
  4994         16  CM-ENTRY-BATCH                PIC X(6).
  4995         16  CM-LF-EXIT-BATCH              PIC X(6).
  4996         16  CM-AH-EXIT-BATCH              PIC X(6).
  4997         16  CM-LAST-MONTH-END             PIC XX.
  4998
  4999     12  CM-NOTE-SW                        PIC X.
  5000         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5001         88  CERT-NOTES-PRESENT               VALUE '1'.
  5002         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5003         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5004         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5005         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5006         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5007         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5008     12  CM-COMP-EXCP-SW                   PIC X.
  5009         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5010         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5011     12  CM-INSURED-ADDRESS-SW             PIC X.
  5012         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5013         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5014
  5015*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5016     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5017     12  FILLER                            PIC X.
  5018
  5019*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5020     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5021     12  FILLER                            PIC X.
  5022*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5023     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5024
  5025     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5026         88  CERT-ADDED-BATCH                 VALUE ' '.
  5027         88  CERT-ADDED-ONLINE                VALUE '1'.
  5028         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5029         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5030         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5031     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5032         88  CERT-AS-LOADED                   VALUE ' '.
  5033         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5034         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5035         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5036         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5037         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5038         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  92
* EL1278.cbl
  5039         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5040
  5041     12  CM-ACCOUNT-COMM-PCTS.
  5042         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5043         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5044
  5045     12  CM-USER-FIELD                     PIC X.
  5046     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5047     12  CM-CLP-STATE                      PIC XX.
  5048     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5049     12  CM-USER-RESERVED                  PIC XXX.
  5050     12  FILLER REDEFINES CM-USER-RESERVED.
  5051         16  CM-AH-CLASS-CD                PIC XX.
  5052         16  F                             PIC X.
  5053******************************************************************
  5054*                            COPY ERCMAIL.
  5055******************************************************************
  5056*                                                                *
  5057*                                                                *
  5058*                            ERCMAIL                             *
  5059*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5060*                            VMOD=2.003                          *
  5061*                                                                *
  5062*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5063*                                                                *
  5064*   FILE TYPE = VSAM,KSDS                                        *
  5065*   RECORD SIZE = 374   RECFORM = FIX                            *
  5066*                                                                *
  5067*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5068*   ALTERNATE PATH    = NOT USED                                 *
  5069*                                                                *
  5070*   LOG = YES                                                    *
  5071*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5072******************************************************************
  5073*                   C H A N G E   L O G
  5074*
  5075* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5076*-----------------------------------------------------------------
  5077*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5078* EFFECTIVE    NUMBER
  5079*-----------------------------------------------------------------
  5080* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5081* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5082* 111108                   PEMA  ADD CRED BENE ADDR2
  5083******************************************************************
  5084
  5085 01  MAILING-DATA.
  5086     12  MA-RECORD-ID                      PIC XX.
  5087         88  VALID-MA-ID                       VALUE 'MA'.
  5088
  5089     12  MA-CONTROL-PRIMARY.
  5090         16  MA-COMPANY-CD                 PIC X.
  5091         16  MA-CARRIER                    PIC X.
  5092         16  MA-GROUPING.
  5093             20  MA-GROUPING-PREFIX        PIC XXX.
  5094             20  MA-GROUPING-PRIME         PIC XXX.
  5095         16  MA-STATE                      PIC XX.
  5096         16  MA-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  93
* EL1278.cbl
  5097             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5098             20  MA-ACCOUNT-PRIME          PIC X(6).
  5099         16  MA-CERT-EFF-DT                PIC XX.
  5100         16  MA-CERT-NO.
  5101             20  MA-CERT-PRIME             PIC X(10).
  5102             20  MA-CERT-SFX               PIC X.
  5103
  5104     12  FILLER                            PIC XX.
  5105
  5106     12  MA-ACCESS-CONTROL.
  5107         16  MA-SOURCE-SYSTEM              PIC XX.
  5108             88  MA-FROM-CREDIT                VALUE 'CR'.
  5109             88  MA-FROM-VSI                   VALUE 'VS'.
  5110             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5111             88  MA-FROM-OTHER                 VALUE 'OT'.
  5112         16  MA-RECORD-ADD-DT              PIC XX.
  5113         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5114         16  MA-LAST-MAINT-DT              PIC XX.
  5115         16  MA-LAST-MAINT-BY              PIC XXXX.
  5116         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5117
  5118     12  MA-PROFILE-INFO.
  5119         16  MA-QUALIFY-CODE-1             PIC XX.
  5120         16  MA-QUALIFY-CODE-2             PIC XX.
  5121         16  MA-QUALIFY-CODE-3             PIC XX.
  5122         16  MA-QUALIFY-CODE-4             PIC XX.
  5123         16  MA-QUALIFY-CODE-5             PIC XX.
  5124
  5125         16  MA-INSURED-LAST-NAME          PIC X(15).
  5126         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5127         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5128         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5129         16  MA-INSURED-BIRTH-DT           PIC XX.
  5130         16  MA-INSURED-SEX                PIC X.
  5131             88  MA-SEX-MALE                   VALUE 'M'.
  5132             88  MA-SEX-FEMALE                 VALUE 'F'.
  5133         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5134
  5135         16  MA-ADDRESS-CORRECTED          PIC X.
  5136         16  MA-JOINT-BIRTH-DT             PIC XX.
  5137*        16  FILLER                        PIC X(12).
  5138
  5139         16  MA-ADDRESS-LINE-1             PIC X(30).
  5140         16  MA-ADDRESS-LINE-2             PIC X(30).
  5141         16  MA-CITY-STATE.
  5142             20  MA-CITY                   PIC X(28).
  5143             20  MA-ADDR-STATE             PIC XX.
  5144         16  MA-ZIP.
  5145             20  MA-ZIP-CODE.
  5146                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5147                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5148                 24  FILLER                PIC X(4).
  5149             20  MA-ZIP-PLUS4              PIC X(4).
  5150         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5151             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5152             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5153             20  FILLER                    PIC X(3).
  5154
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  94
* EL1278.cbl
  5155         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5156
  5157         16  FILLER                        PIC XXX.
  5158*        16  FILLER                        PIC X(10).
  5159
  5160     12  MA-CRED-BENE-INFO.
  5161         16  MA-CRED-BENE-NAME                 PIC X(25).
  5162         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5163         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5164         16  MA-CRED-BENE-CTYST.
  5165             20  MA-CRED-BENE-CITY             PIC X(28).
  5166             20  MA-CRED-BENE-STATE            PIC XX.
  5167         16  MA-CRED-BENE-ZIP.
  5168             20  MA-CB-ZIP-CODE.
  5169                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5170                     88  MA-CB-CANADIAN-POST-CODE
  5171                                           VALUE 'A' THRU 'Z'.
  5172                 24  FILLER                    PIC X(4).
  5173             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5174         16  MA-CB-CANADIAN-POSTAL-CODE
  5175                            REDEFINES MA-CRED-BENE-ZIP.
  5176             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5177             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5178             20  FILLER                        PIC X(3).
  5179     12  MA-POST-CARD-MAIL-DATA.
  5180         16  MA-MAIL-DATA OCCURS 7.
  5181             20  MA-MAIL-TYPE              PIC X.
  5182                 88  MA-12MO-MAILING           VALUE '1'.
  5183                 88  MA-EXP-MAILING            VALUE '2'.
  5184             20  MA-MAIL-STATUS            PIC X.
  5185                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5186                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5187                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5188             20  MA-MAIL-DATE              PIC XX.
  5189     12  FILLER                            PIC XX.
  5190     12  FILLER                            PIC XX.
  5191*    12  FILLER                            PIC X(30).
  5192******************************************************************
  5193*                            COPY ELCCRTO.
  5194******************************************************************
  5195*                                                                *
  5196*                            ELCCRTO.                            *
  5197*                                                                *
  5198*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5199*                                                                *
  5200*   FILE TYPE = VSAM,KSDS                                        *
  5201*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5202*                                                                *
  5203*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5204*                                                                *
  5205*   LOG = YES                                                    *
  5206*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5207******************************************************************
  5208*                   C H A N G E   L O G
  5209*
  5210* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5211*-----------------------------------------------------------------
  5212*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  95
* EL1278.cbl
  5213* EFFECTIVE    NUMBER
  5214*-----------------------------------------------------------------
  5215* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5216* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5217* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5218******************************************************************
  5219 01  ORIGINAL-CERTIFICATE.
  5220     12  OC-RECORD-ID                      PIC XX.
  5221         88  VALID-OC-ID                      VALUE 'OC'.
  5222     12  OC-CONTROL-PRIMARY.
  5223         16  OC-COMPANY-CD                 PIC X.
  5224         16  OC-CARRIER                    PIC X.
  5225         16  OC-GROUPING                   PIC X(6).
  5226         16  OC-STATE                      PIC XX.
  5227         16  OC-ACCOUNT                    PIC X(10).
  5228         16  OC-CERT-EFF-DT                PIC XX.
  5229         16  OC-CERT-NO.
  5230             20  OC-CERT-PRIME             PIC X(10).
  5231             20  OC-CERT-SFX               PIC X.
  5232         16  OC-RECORD-TYPE                PIC X.
  5233         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5234     12  OC-LAST-MAINT-DT                  PIC XX.
  5235     12  OC-LAST-MAINT-BY                  PIC X(4).
  5236     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5237     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5238     12  FILLER                            PIC X(49).
  5239     12  OC-ORIG-REC.
  5240         16  OC-INS-LAST-NAME              PIC X(15).
  5241         16  OC-INS-FIRST-NAME             PIC X(10).
  5242         16  OC-INS-MIDDLE-INIT            PIC X.
  5243         16  OC-INS-AGE                    PIC S999     COMP-3.
  5244         16  OC-JNT-LAST-NAME              PIC X(15).
  5245         16  OC-JNT-FIRST-NAME             PIC X(10).
  5246         16  OC-JNT-MIDDLE-INIT            PIC X.
  5247         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5248         16  OC-LF-BENCD                   PIC XX.
  5249         16  OC-LF-TERM                    PIC S999      COMP-3.
  5250         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5251         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5252         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5253         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5254         16  OC-LF-EXP-DT                  PIC XX.
  5255         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5256         16  OC-LF-CANCEL-DT               PIC XX.
  5257         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5258         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5259         16  OC-AH-BENCD                   PIC XX.
  5260         16  OC-AH-TERM                    PIC S999      COMP-3.
  5261         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5262         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5263         16  OC-AH-EXP-DT                  PIC XX.
  5264         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5265         16  OC-AH-CP                      PIC 99.
  5266         16  OC-AH-CANCEL-DT               PIC XX.
  5267         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5268         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5269         16  OC-CRED-BENE-NAME             PIC X(25).
  5270         16  OC-1ST-PMT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  96
* EL1278.cbl
  5271         16  FILLER                        PIC X(215).
  5272
  5273     12  FILLER                            PIC X(50).
  5274******************************************************************
  5275*                            COPY ERCFORM.
  5276******************************************************************
  5277*                                                                *
  5278*                                                                *
  5279*                            ERCFORM.                            *
  5280*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5281*                            VMOD=2.003                          *
  5282*                                                                *
  5283*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  5284*                                                                *
  5285*    FILE TYPE = VSAM,KSDS                                       *
  5286*    RECORD SIZE = 500  RECFORM = FIXED                          *
  5287*                                                                *
  5288*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  5289*                                                                *
  5290*    LOG = YES                                                   *
  5291*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5292******************************************************************
  5293 01  FORM-MASTER.
  5294    12  FO-RECORD-ID                 PIC X(02).
  5295        88  VALID-FO-ID                  VALUE 'FO'.
  5296
  5297    12  FO-CONTROL-PRIMARY.
  5298        16  FO-COMPANY-CD            PIC X(01).
  5299        16  FO-STATE                 PIC X(02).
  5300        16  FO-FORM-ID               PIC X(12).
  5301        16  FO-FORM-EXP-DT           PIC X(02).
  5302
  5303    12  FO-POLICY-FORM-DATA.
  5304        16  FO-IND-GRP-CD            PIC X(01).
  5305        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  5306        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5307        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5308        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5309        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5310        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  5311        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  5312        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  5313        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  5314        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  5315        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5316        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5317        16  FO-DIS-DEF-TYPE          PIC 9(02).
  5318        16  FO-DISMEMBERMENT-CD      PIC X(01).
  5319        16  FO-APP-CERT-USE-CD       PIC X(01).
  5320
  5321    12  FILLER                       PIC X(29).
  5322
  5323    12  FO-FORM-PLAN-TABLE.
  5324        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  5325            20  FO-PLAN-TYPE         PIC X(01).
  5326            20  FO-PLAN-ID           PIC X(02).
  5327            20  FO-PLAN-TERM         PIC 9(03).
  5328            20  FO-PLAN-REFUND-METHOD
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  97
* EL1278.cbl
  5329                                     PIC X.
  5330
  5331    12  FILLER                       PIC X(30).
  5332
  5333    12  FO-COMMENTS-AREA.
  5334        16  FO-COMMENT-LINE-1        PIC X(78).
  5335
  5336    12  FILLER                       PIC X(20).
  5337
  5338    12  FO-MAINT-INFORMATION.
  5339        16  FO-LAST-MAINT-DT         PIC X(02).
  5340        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5341        16  FO-LAST-MAINT-BY         PIC X(04).
  5342*                            COPY ELCMSTR.
  5343******************************************************************
  5344*                                                                *
  5345*                            ELCMSTR.                            *
  5346*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5347*                            VMOD=2.012                          *
  5348*                                                                *
  5349*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  5350*                                                                *
  5351*   FILE TYPE = VSAM,KSDS                                        *
  5352*   RECORD SIZE = 350  RECFORM = FIXED                           *
  5353*                                                                *
  5354*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  5355*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  5356*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  5357*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  5358*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  5359*                                                 RKP=75,LEN=21  *
  5360*                                                                *
  5361*   **** NOTE ****                                               *
  5362*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  5363*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  5364*                                                                *
  5365*   LOG = YES                                                    *
  5366*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5367******************************************************************
  5368*                   C H A N G E   L O G
  5369*
  5370* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5371*-----------------------------------------------------------------
  5372*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5373* EFFECTIVE    NUMBER
  5374*-----------------------------------------------------------------
  5375* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5376* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  5377******************************************************************
  5378 01  CLAIM-MASTER.
  5379     12  CL-RECORD-ID                PIC XX.
  5380         88  VALID-CL-ID         VALUE 'CL'.
  5381
  5382     12  CL-CONTROL-PRIMARY.
  5383         16  CL-COMPANY-CD           PIC X.
  5384         16  CL-CARRIER              PIC X.
  5385         16  CL-CLAIM-NO             PIC X(7).
  5386         16  CL-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  98
* EL1278.cbl
  5387             20  CL-CERT-PRIME       PIC X(10).
  5388             20  CL-CERT-SFX         PIC X.
  5389
  5390     12  CL-CONTROL-BY-NAME.
  5391         16  CL-COMPANY-CD-A1        PIC X.
  5392         16  CL-INSURED-LAST-NAME    PIC X(15).
  5393         16  CL-INSURED-NAME.
  5394             20  CL-INSURED-1ST-NAME PIC X(12).
  5395             20  CL-INSURED-MID-INIT PIC X.
  5396
  5397     12  CL-CONTROL-BY-SSN.
  5398         16  CL-COMPANY-CD-A2        PIC X.
  5399         16  CL-SOC-SEC-NO.
  5400             20  CL-SSN-STATE        PIC XX.
  5401             20  CL-SSN-ACCOUNT      PIC X(6).
  5402             20  CL-SSN-LN3          PIC X(3).
  5403
  5404     12  CL-CONTROL-BY-CERT-NO.
  5405         16  CL-COMPANY-CD-A4        PIC X.
  5406         16  CL-CERT-NO-A4.
  5407             20  CL-CERT-A4-PRIME    PIC X(10).
  5408             20  CL-CERT-A4-SFX      PIC X.
  5409
  5410     12  CL-CONTROL-BY-CCN.
  5411         16  CL-COMPANY-CD-A5        PIC X.
  5412         16  CL-CCN-A5.
  5413             20  CL-CCN.
  5414                 24  CL-CCN-PREFIX-A5 PIC X(4).
  5415                 24  CL-CCN-PRIME-A5 PIC X(12).
  5416             20  CL-CCN-FILLER-A5    PIC X(4).
  5417
  5418     12  CL-INSURED-PROFILE-DATA.
  5419         16  CL-INSURED-BIRTH-DT     PIC XX.
  5420         16  CL-INSURED-SEX-CD       PIC X.
  5421             88  INSURED-IS-MALE        VALUE 'M'.
  5422             88  INSURED-IS-FEMALE      VALUE 'F'.
  5423             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  5424         16  CL-INSURED-OCC-CD       PIC X(6).
  5425         16  FILLER                  PIC X(5).
  5426
  5427     12  CL-PROCESSING-INFO.
  5428         16  CL-PROCESSOR-ID         PIC X(4).
  5429         16  CL-CLAIM-STATUS         PIC X.
  5430             88  CLAIM-IS-OPEN          VALUE 'O'.
  5431             88  CLAIM-IS-CLOSED        VALUE 'C'.
  5432         16  CL-CLAIM-TYPE           PIC X.
  5433*            88  AH-CLAIM               VALUE 'A'.
  5434*            88  LIFE-CLAIM             VALUE 'L'.
  5435*            88  PROPERTY-CLAIM         VALUE 'P'.
  5436*            88  IUI-CLAIM              VALUE 'I'.
  5437*            88  GAP-CLAIM              VALUE 'G'.
  5438         16  CL-CLAIM-PREM-TYPE      PIC X.
  5439             88  SINGLE-PREMIUM         VALUE '1'.
  5440             88  O-B-COVERAGE           VALUE '2'.
  5441             88  OPEN-END-COVERAGE      VALUE '3'.
  5442         16  CL-INCURRED-DT          PIC XX.
  5443         16  CL-REPORTED-DT          PIC XX.
  5444         16  CL-FILE-ESTABLISH-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page  99
* EL1278.cbl
  5445         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  5446         16  CL-LAST-PMT-DT          PIC XX.
  5447         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  5448         16  CL-PAID-THRU-DT         PIC XX.
  5449         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  5450         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  5451         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  5452         16  CL-PMT-CALC-METHOD      PIC X.
  5453             88  CL-360-DAY-YR          VALUE '1'.
  5454             88  CL-365-DAY-YR          VALUE '2'.
  5455             88  CL-FULL-MONTHS         VALUE '3'.
  5456         16  CL-CAUSE-CD             PIC X(6).
  5457
  5458         16  CL-PRIME-CERT-NO.
  5459             20  CL-PRIME-CERT-PRIME PIC X(10).
  5460             20  CL-PRIME-CERT-SFX   PIC X.
  5461
  5462         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  5463             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  5464             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  5465
  5466         16  CL-MICROFILM-NO         PIC X(10).
  5467         16  CL-PROG-FORM-TYPE       PIC X.
  5468         16  CL-LAST-ADD-ON-DT       PIC XX.
  5469
  5470         16  CL-LAST-REOPEN-DT       PIC XX.
  5471         16  CL-LAST-CLOSE-DT        PIC XX.
  5472         16  CL-LAST-CLOSE-REASON    PIC X(01).
  5473             88  FINAL-PAID             VALUE '1'.
  5474             88  CLAIM-DENIED           VALUE '2'.
  5475             88  AUTO-CLOSE             VALUE '3'.
  5476             88  MANUAL-CLOSE           VALUE '4'.
  5477             88  BENEFITS-CHANGED       VALUE 'C'.
  5478             88  SETUP-ERRORS           VALUE 'E'.
  5479         16  CL-ASSOC-CERT-SEQU      PIC S99.
  5480         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  5481         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  5482             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  5483         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  5484         16  FILLER                  PIC X.
  5485
  5486     12  CL-CERTIFICATE-DATA.
  5487         16  CL-CERT-ORIGIN          PIC X.
  5488             88  CERT-WAS-ONLINE        VALUE '1'.
  5489             88  CERT-WAS-CREATED       VALUE '2'.
  5490             88  COVERAGE-WAS-ADDED     VALUE '3'.
  5491         16  CL-CERT-KEY-DATA.
  5492             20  CL-CERT-CARRIER     PIC X.
  5493             20  CL-CERT-GROUPING    PIC X(6).
  5494             20  CL-CERT-STATE       PIC XX.
  5495             20  CL-CERT-ACCOUNT.
  5496                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  5497                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  5498             20  CL-CERT-EFF-DT      PIC XX.
  5499
  5500     12  CL-STATUS-CONTROLS.
  5501         16  CL-PRIORITY-CD          PIC X.
  5502             88  CONFIDENTIAL-DATA      VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 100
* EL1278.cbl
  5503             88  HIGHEST-PRIORITY       VALUE '9'.
  5504         16  CL-SUPV-ATTN-CD         PIC X.
  5505             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  5506             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  5507         16  CL-PURGED-DT            PIC XX.
  5508         16  CL-RESTORED-DT          PIC XX.
  5509         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  5510         16  CL-NEXT-RESEND-DT       PIC XX.
  5511         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  5512         16  FILLER                  PIC XX.
  5513         16  CL-LAST-MAINT-DT        PIC XX.
  5514         16  CL-LAST-MAINT-USER      PIC X(4).
  5515         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  5516         16  CL-LAST-MAINT-TYPE      PIC X.
  5517             88  CLAIM-SET-UP           VALUE ' '.
  5518             88  PAYMENT-MADE           VALUE '1'.
  5519             88  LETTER-SENT            VALUE '2'.
  5520             88  MASTER-WAS-ALTERED     VALUE '3'.
  5521             88  MASTER-WAS-RESTORED    VALUE '4'.
  5522             88  INCURRED-DATE-CHANGED  VALUE '5'.
  5523             88  FILE-CONVERTED         VALUE '6'.
  5524             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  5525             88  ERROR-CORRECTION       VALUE 'E'.
  5526         16  CL-RELATED-CLAIM-NO     PIC X(7).
  5527         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  5528         16  CL-BENEFICIARY          PIC X(10).
  5529         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  5530         16  CL-DENIAL-TYPE          PIC X.
  5531             88  CL-TYPE-DENIAL          VALUE '1'.
  5532             88  CL-TYPE-RESCISSION      VALUE '2'.
  5533             88  CL-TYPE-REFORMATION     VALUE '3'.
  5534             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  5535             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  5536         16  FILLER                  PIC X(5).
  5537
  5538     12  CL-TRAILER-CONTROLS.
  5539         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  5540             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  5541             88  CL-LAST-TRL-AVAIL      VALUE +100.
  5542             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  5543         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  5544         16  FILLER                  PIC XX.
  5545         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  5546         16  CL-ADDRESS-TRAILER-CNT.
  5547             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  5548                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  5549             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  5550                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  5551             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  5552                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  5553             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  5554                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  5555             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  5556                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  5557             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  5558                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  5559             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  5560                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 101
* EL1278.cbl
  5561
  5562     12  CL-CV-REFERENCE-NO.
  5563         16  CL-CV-REFNO-PRIME       PIC X(18).
  5564         16  CL-CV-REFNO-SFX         PIC XX.
  5565
  5566     12  CL-FILE-LOCATION            PIC X(4).
  5567
  5568     12  CL-PROCESS-ERRORS.
  5569         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  5570             88  NO-FATAL-ERRORS        VALUE ZERO.
  5571         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  5572             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  5573
  5574     12  CL-PRODUCT-CD               PIC X.
  5575
  5576     12  CL-CURRENT-KEY-DATA.
  5577         16  CL-CURRENT-CARRIER      PIC X.
  5578         16  CL-CURRENT-GROUPING     PIC X(6).
  5579         16  CL-CURRENT-STATE        PIC XX.
  5580         16  CL-CURRENT-ACCOUNT      PIC X(10).
  5581
  5582     12  CL-ASSOCIATES               PIC X.
  5583         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  5584         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  5585         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  5586         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  5587
  5588     12  CL-ACTIVITY-CODE            PIC 99.
  5589     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  5590     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  5591
  5592     12  CL-LAPSE-REPORT-CODE        PIC 9.
  5593     12  CL-LAG-REPORT-CODE          PIC 9.
  5594     12  CL-LOAN-TYPE                PIC XX.
  5595     12  CL-LEGAL-STATE              PIC XX.
  5596
  5597*    12  FILLER                      PIC X(5).
  5598     12  CL-YESNOSW                  PIC X.
  5599     12  FILLER                      PIC X(4).
  5600*                            COPY ERCPDEF.
  5601******************************************************************
  5602*                                                                *
  5603*                                                                *
  5604*                            ERCPDEF.                            *
  5605*                                                                *
  5606*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5607*                                                                *
  5608*    FILE TYPE = VSAM,KSDS                                       *
  5609*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5610*                                                                *
  5611*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5612*                                                                *
  5613*    LOG = YES                                                   *
  5614*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5615******************************************************************
  5616 01  PRODUCT-MASTER.
  5617    12  PD-RECORD-ID                 PIC X(02).
  5618        88  VALID-PD-ID                  VALUE 'PD'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 102
* EL1278.cbl
  5619    12  PD-CONTROL-PRIMARY.
  5620        16  PD-COMPANY-CD            PIC X.
  5621        16  PD-STATE                 PIC XX.
  5622        16  PD-PRODUCT-CD            PIC XXX.
  5623        16  PD-FILLER                PIC X(7).
  5624        16  PD-BEN-TYPE              PIC X.
  5625        16  PD-BEN-CODE              PIC XX.
  5626        16  PD-PROD-EXP-DT           PIC XX.
  5627    12  FILLER                       PIC X(50).
  5628    12  PD-PRODUCT-DATA OCCURS 8.
  5629        16  PD-PROD-CODE             PIC X.
  5630            88  PD-PROD-LIFE           VALUE 'L'.
  5631            88  PD-PROD-PROP           VALUE 'P'.
  5632            88  PD-PROD-AH             VALUE 'A'.
  5633            88  PD-PROD-IU             VALUE 'I'.
  5634            88  PD-PROD-GAP            VALUE 'G'.
  5635        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5636        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5637        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5638        16  PD-MAX-TERM              PIC S999        COMP-3.
  5639        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5640        16  FILLER                   PIC X.
  5641        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5642        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5643        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5644        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5645        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5646        16  PD-REC-CRIT-PERIOD       PIC X.
  5647        16  PD-RTW-MOS               PIC 99.
  5648        16  FILLER                   PIC X(5).
  5649    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5650    12  PD-TERM-LIMITS OCCURS 15.
  5651        16  PD-LOW-TERM              PIC S999        COMP-3.
  5652        16  PD-HI-TERM               PIC S999        COMP-3.
  5653*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5654    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5655        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5656        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5657    12  PD-EARN-FACTORS.
  5658        16  FILLER OCCURS 15.
  5659            20  FILLER OCCURS 15.
  5660                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5661    12  PD-PRODUCT-DESC              PIC X(80).
  5662    12  PD-TRUNCATED                 PIC X.
  5663    12  FILLER                       PIC X(59).
  5664    12  PD-MAINT-INFORMATION.
  5665        16  PD-LAST-MAINT-DT         PIC X(02).
  5666        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5667        16  PD-LAST-MAINT-BY         PIC X(04).
  5668 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  5669                          ACCOUNT-MASTER CERTIFICATE-MASTER
  5670                          MAILING-DATA ORIGINAL-CERTIFICATE
  5671                          FORM-MASTER CLAIM-MASTER
  5672                          PRODUCT-MASTER.
  5673 0000-DFHEXIT SECTION.
  5674     MOVE '9#                    $   ' TO DFHEIV0.
  5675     MOVE 'EL1278' TO DFHEIV1.
  5676     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 103
* EL1278.cbl
  5677*    SERVICE RELOAD PARMLIST.
  5678
  5679     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5680     MOVE '5'                    TO  DC-OPTION-CODE.
  5681
  5682     PERFORM 9600-DATE-LINK.
  5683
  5684     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5685     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5686     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5687     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5688     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  5689     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  5690     MOVE EIBTRMID               TO  QID-TERM.
  5691
  5692     IF EIBCALEN  IS EQUAL TO  ZERO
  5693         GO TO 8700-UNAUTHORIZED-ACCESS.
  5694
  5695     IF PI-CALLING-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5696         IF PI-RETURN-TO-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5697             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  5698             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  5699             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  5700             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  5701             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  5702             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  5703             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  5704             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  5705         ELSE
  5706             MOVE PI-CALLING-PROGRAM    TO  RETURN-FROM
  5707             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  5708             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  5709             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  5710             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  5711             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  5712             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  5713             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  5714             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  5715
  5716     IF EIBAID  IS EQUAL TO  DFHCLEAR
  5717         GO TO 9300-CLEAR.
  5718
  5719     IF PI-PROCESSOR-ID  IS EQUAL TO  'LGXX'
  5720         NEXT SENTENCE
  5721     ELSE
  5722
  5723* EXEC CICS READQ TS
  5724*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  5725*            INTO    (SECURITY-CONTROL)
  5726*            LENGTH  (SC-COMM-LENGTH)
  5727*            ITEM    (SC-ITEM)
  5728*        END-EXEC
  5729*    MOVE '*$II   L              ''   #00005718' TO DFHEIV0
  5730     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5731     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5732     MOVE X'2020233030303035373138' TO DFHEIV0(25:11)
  5733     CALL 'kxdfhei1' USING DFHEIV0,
  5734           PI-SECURITY-TEMP-STORE-ID,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 104
* EL1278.cbl
  5735           SECURITY-CONTROL,
  5736           SC-COMM-LENGTH,
  5737           SC-ITEM,
  5738           DFHEIV99,
  5739           DFHEIV99
  5740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5741         MOVE SC-CREDIT-DISPLAY (33)
  5742                                 TO  PI-DISPLAY-CAP
  5743         MOVE SC-CREDIT-UPDATE  (33)
  5744                                 TO  PI-MODIFY-CAP
  5745         MOVE SC-CREDIT-UPDATE  (32)
  5746                                 TO  PI-MODIFY-CERT-CAP
  5747         IF NOT  DISPLAY-CAP
  5748             MOVE 'READ'         TO  SM-READ
  5749             PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5750             MOVE ER-0070        TO  EMI-ERROR
  5751             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5752             GO TO 8100-SEND-INITIAL-MAP.
  5753
  5754     IF EIBTRNID  IS NOT EQUAL TO  TRANS-ID
  5755         MOVE 'Y' TO WS-FIRST-ENTRY-SW
  5756         MOVE LOW-VALUES         TO  EL127HI
  5757         MOVE SAVE-BIN-DATE      TO  WS-LF-CANCEL-DATE
  5758                                     PI-LF-CANCEL-DATE
  5759                                     WS-AH-CANCEL-DATE
  5760                                     PI-AH-CANCEL-DATE
  5761         MOVE SAVE-DATE          TO  WS-LF-CANCEL-DATE-ED
  5762                                     PI-LF-CANCEL-DATE-ED
  5763                                     WS-AH-CANCEL-DATE-ED
  5764                                     PI-AH-CANCEL-DATE-ED
  5765         MOVE SPACES             TO  PI-EARNING-METHOD-LF
  5766                                     PI-EARNING-METHOD-AH
  5767         PERFORM 0500-FORMAT-SCREEN
  5768         GO TO 8100-SEND-INITIAL-MAP.
  5769
  5770     IF NOT  MODIFY-CAP
  5771         MOVE 'UPDATE'           TO  SM-READ
  5772         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5773         MOVE ER-0070            TO  EMI-ERROR
  5774         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5775         GO TO 8100-SEND-INITIAL-MAP.
  5776
  5777
  5778* EXEC CICS HANDLE CONDITION
  5779*        PGMIDERR  (9500-PGMID-ERROR)
  5780*        ERROR     (9900-ABEND)
  5781*    END-EXEC.
  5782*    MOVE '"$L.                  ! " #00005760' TO DFHEIV0
  5783     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5784     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5785     MOVE X'2220233030303035373630' TO DFHEIV0(25:11)
  5786     CALL 'kxdfhei1' USING DFHEIV0
  5787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5788
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 105
* EL1278.cbl
  5790 0200-RECEIVE.
  5791     IF EIBAID  IS EQUAL TO  DFHPA1  OR  DFHPA2  OR  DFHPA3
  5792         MOVE ER-0008            TO  EMI-ERROR
  5793         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5794         MOVE -1                 TO  HLCANCL
  5795         GO TO 8200-SEND-DATAONLY.
  5796
  5797
  5798* EXEC CICS RECEIVE
  5799*        MAP     (MAP-NAME)
  5800*        MAPSET  (MAPSET-NAME)
  5801*        INTO    (EL127HI)
  5802*    END-EXEC.
  5803     MOVE LENGTH OF
  5804      EL127HI
  5805       TO DFHEIV11
  5806*    MOVE '8"T I  L              ''   #00005772' TO DFHEIV0
  5807     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5808     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5809     MOVE X'2020233030303035373732' TO DFHEIV0(25:11)
  5810     CALL 'kxdfhei1' USING DFHEIV0,
  5811           MAP-NAME,
  5812           EL127HI,
  5813           DFHEIV11,
  5814           MAPSET-NAME,
  5815           DFHEIV99,
  5816           DFHEIV99
  5817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5818
  5819
  5820     IF HPFKEYL  IS EQUAL TO  ZERO
  5821         GO TO 0300-CHECK-PFKEYS.
  5822
  5823     IF EIBAID  IS NOT EQUAL TO  DFHENTER
  5824         MOVE ER-0004            TO  EMI-ERROR
  5825         GO TO 0320-INPUT-ERROR.
  5826
  5827     IF HPFKEYI NUMERIC
  5828         IF HPFKEYI  IS EQUAL TO  '12'  OR  '23'  OR  '24' OR '11'
  5829             MOVE PF-VALUES (HPFKEYI)
  5830                                 TO  EIBAID
  5831         ELSE
  5832             MOVE ER-0029        TO  EMI-ERROR
  5833             GO TO 0320-INPUT-ERROR.
  5834
  5835 0300-CHECK-PFKEYS.
  5836     IF EIBAID  IS EQUAL TO  DFHPF23
  5837         GO TO 8800-PF23.
  5838
  5839     IF EIBAID  IS EQUAL TO  DFHPF24
  5840         GO TO 9100-RETURN-MAIN-MENU.
  5841
  5842     IF EIBAID = DFHPF11
  5843        GO TO 1700-WRITE-CERT-NOTE
  5844     END-IF
  5845
  5846     IF EIBAID  IS EQUAL TO  DFHPF12
  5847         GO TO 9400-PF12.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 106
* EL1278.cbl
  5848
  5849     IF EIBAID = DFHENTER OR DFHPF10
  5850        GO TO 0400-EDIT-INPUT-DATA
  5851     END-IF
  5852
  5853     MOVE ER-0029                TO  EMI-ERROR.
  5854
  5855 0320-INPUT-ERROR.
  5856     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  5857
  5858     MOVE AL-UNBON               TO  HPFKEYA.
  5859
  5860     IF HPFKEYL  IS EQUAL TO  ZERO
  5861         MOVE -1                 TO  HLCANCL
  5862     ELSE
  5863         MOVE -1                 TO  HPFKEYL.
  5864
  5865     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 107
* EL1278.cbl
  5867 0400-EDIT-INPUT-DATA.
  5868     MOVE 'N'                    TO  WS-NEW-AH-CANCEL-SW
  5869                                     WS-NEW-LF-CANCEL-SW.
  5870
  5871     IF (HPCYNL > 0)
  5872        AND (HPCYNI = 'Y' OR 'N')
  5873        PERFORM 1800-READ-ELCERT-UPDATE
  5874                                 THRU 1800-EXIT
  5875        IF WS-RESP-NORMAL
  5876           MOVE HPCYNI           TO CM-POST-CARD-IND
  5877           PERFORM 1810-REWRITE-ELCERT
  5878                                 THRU 1810-EXIT
  5879        END-IF
  5880     END-IF
  5881     IF HLCAL1L GREATER ZERO
  5882         MOVE HLCAL1I              TO  PI-EARNING-METHOD-LF.
  5883     IF CLPYNI = 'Y'
  5884        MOVE 'Y'                   TO PI-CLP-YN
  5885        MOVE AL-UANON              TO CLPYNA
  5886     ELSE
  5887        MOVE ' '                   TO PI-CLP-YN
  5888        MOVE AL-UANON              TO CLPYNA
  5889     END-IF
  5890     IF CANREAI = 'R'
  5891        MOVE 'R'                 TO PI-CANCEL-REASON
  5892        MOVE AL-UANON            TO CANREAA
  5893     ELSE
  5894        MOVE ' '                 TO PI-CANCEL-REASON
  5895        MOVE AL-UANON            TO CANREAA
  5896     END-IF
  5897
  5898     IF HLCANCL  IS EQUAL TO  ZERO
  5899       AND HACANCL  IS EQUAL TO  ZERO
  5900         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  5901         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  5902         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  5903         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  5904         GO TO 0420-CHECK-ERRORS.
  5905
  5906     IF HLCANCL  IS EQUAL TO  ZERO
  5907         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  5908         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  5909         GO TO 0410-CHECK-AH-DATE.
  5910
  5911     IF HLCANCI = SPACES
  5912        MOVE LOW-VALUES            TO PI-LF-CANCEL-DATE
  5913                                      WS-LF-CANCEL-DATE
  5914        MOVE SPACES                TO PI-LF-CANCEL-DATE-ED
  5915                                      WS-LF-CANCEL-DATE-ED
  5916                                      PI-LF-REFUND-METH
  5917        MOVE +0                    TO PI-LF-REFUND-AMT
  5918        GO TO 0410-CHECK-AH-DATE
  5919     END-IF
  5920
  5921     MOVE AL-UNNON               TO  HLCANCA.
  5922     MOVE HLCANCI                TO  DEEDIT-FIELD.
  5923     MOVE 'Y'                    TO  WS-NEW-LF-CANCEL-SW.
  5924
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 108
* EL1278.cbl
  5925     PERFORM 8600-DEEDIT.
  5926
  5927     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  5928     MOVE '4'                    TO  DC-OPTION-CODE.
  5929
  5930     PERFORM 9600-DATE-LINK.
  5931
  5932     IF DATE-CONVERSION-ERROR
  5933         MOVE -1                 TO  HLCANCL
  5934         MOVE AL-UABON           TO  HLCANCA
  5935         MOVE ER-2227            TO  EMI-ERROR
  5936         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5937     ELSE
  5938        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  5939           MOVE -1               TO  HACANCL
  5940           MOVE AL-UABON         TO  HACANCA
  5941           MOVE ER-2774          TO  EMI-ERROR
  5942           PERFORM 9700-ERROR-FORMAT
  5943                                 THRU  9799-EXIT
  5944        ELSE
  5945           MOVE DC-BIN-DATE-1    TO WS-LF-CANCEL-DATE
  5946                                    PI-LF-CANCEL-DATE
  5947           MOVE DC-GREG-DATE-1-EDIT
  5948                                 TO HLCANCO
  5949                                    WS-LF-CANCEL-DATE-ED
  5950                                    PI-LF-CANCEL-DATE-ED
  5951        END-IF
  5952     END-IF
  5953     .
  5954 0410-CHECK-AH-DATE.
  5955     IF HACAL1L GREATER ZERO
  5956         MOVE HACAL1I              TO  PI-EARNING-METHOD-AH.
  5957
  5958     IF HACANCL  IS EQUAL TO  ZERO
  5959         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  5960         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  5961         GO TO 0420-CHECK-ERRORS.
  5962     IF HACANCI = SPACES
  5963        MOVE LOW-VALUES            TO PI-AH-CANCEL-DATE
  5964                                      WS-AH-CANCEL-DATE
  5965        MOVE SPACES                TO PI-AH-CANCEL-DATE-ED
  5966                                      WS-AH-CANCEL-DATE-ED
  5967                                      PI-AH-REFUND-METH
  5968        MOVE +0                    TO PI-AH-REFUND-AMT
  5969        GO TO 0420-CHECK-ERRORS
  5970     END-IF
  5971
  5972     MOVE AL-UNNON               TO  HACANCA.
  5973     MOVE HACANCI                TO  DEEDIT-FIELD.
  5974     MOVE 'Y'                    TO  WS-NEW-AH-CANCEL-SW.
  5975
  5976     PERFORM 8600-DEEDIT.
  5977
  5978     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  5979     MOVE '4'                    TO  DC-OPTION-CODE.
  5980
  5981     PERFORM 9600-DATE-LINK.
  5982
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 109
* EL1278.cbl
  5983     IF DATE-CONVERSION-ERROR
  5984         MOVE -1                 TO  HACANCL
  5985         MOVE AL-UABON           TO  HACANCA
  5986         MOVE ER-2227            TO  EMI-ERROR
  5987         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5988     ELSE
  5989        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  5990           MOVE -1               TO  HACANCL
  5991           MOVE AL-UABON         TO  HACANCA
  5992           MOVE ER-2775          TO  EMI-ERROR
  5993           PERFORM 9700-ERROR-FORMAT
  5994                                 THRU  9799-EXIT
  5995        ELSE
  5996           MOVE DC-BIN-DATE-1    TO WS-AH-CANCEL-DATE
  5997                                    PI-AH-CANCEL-DATE
  5998           MOVE DC-GREG-DATE-1-EDIT
  5999                                 TO HACANCO
  6000                                    WS-AH-CANCEL-DATE-ED
  6001                                    PI-AH-CANCEL-DATE-ED
  6002        END-IF
  6003     END-IF
  6004     .
  6005 0420-CHECK-ERRORS.
  6006     IF EMI-ERROR  IS EQUAL TO  ZEROS
  6007         NEXT SENTENCE
  6008     ELSE
  6009         GO TO 8200-SEND-DATAONLY.
  6010
  6011     PERFORM 0500-FORMAT-SCREEN.
  6012     IF EIBAID = DFHPF10
  6013        perform 4000-GEN-CANCEL-TRANS
  6014                                 thru 4000-exit
  6015        MOVE PROGRAM-INTERFACE-BLOCK TO WS-PASS-631
  6016        MOVE LOW-VALUES     TO WS-PASS-PROGRAM-WORK-AREA
  6017        MOVE PI-COMPANY-CD  TO PI-PB-COMPANY-CD
  6018        MOVE CG-BATCH-NO    TO PI-PB-ENTRY-BATCH
  6019        MOVE 1              TO PI-PB-BATCH-SEQ-NO
  6020        MOVE 'Y'            TO PI-ALL-ISSUES-SW
  6021                               PI-ALL-CANCELS-SW
  6022        IF PI-PROCESSOR-IS-CSR
  6023            MOVE 'Y'        TO PI-CSR-SESSION-SW
  6024        ELSE
  6025            MOVE ' '        TO PI-CSR-SESSION-SW
  6026        END-IF
  6027        MOVE 'N'            TO PI-ISSUES-IN-ERROR-SW
  6028                               PI-CANCELS-IN-ERROR-SW
  6029                               PI-ONLY-BATCH-HEADERS-SW
  6030                               PI-ALL-OUT-OF-BAL-SW
  6031                               PI-HOLD-REC-SW
  6032                               PI-CHANGE-REC-SW
  6033                               PI-CHK-REQ-REC-SW
  6034                               PI-ISSUE-WARNING-SW
  6035                               PI-CANCEL-WARNING-SW
  6036        MOVE '1'            TO PI-BROWSE-TYPE
  6037        MOVE DFHENTER       TO  EIBAID
  6038
  6039
  6040* EXEC CICS XCTL
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 110
* EL1278.cbl
  6041*           PROGRAM    ('EL6311')
  6042*           COMMAREA   (WS-PASS-631)
  6043*           LENGTH     (1300)
  6044*       END-EXEC
  6045     MOVE 'EL6311' TO DFHEIV1
  6046     MOVE 1300
  6047       TO DFHEIV11
  6048*    MOVE '.$C                   %   #00005997' TO DFHEIV0
  6049     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6050     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6051     MOVE X'2020233030303035393937' TO DFHEIV0(25:11)
  6052     CALL 'kxdfhei1' USING DFHEIV0,
  6053           DFHEIV1,
  6054           WS-PASS-631,
  6055           DFHEIV11,
  6056           DFHEIV99
  6057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6058
  6059*        PERFORM 0500-FORMAT-SCREEN
  6060     END-IF
  6061     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 111
* EL1278.cbl
  6063 0500-FORMAT-SCREEN  SECTION.
  6064     MOVE LOW-VALUES             TO  EL127HO.
  6065     MOVE PI-CARRIER             TO  HCARIERO.
  6066     MOVE PI-GROUPING            TO  HGROUPO.
  6067     MOVE PI-STATE               TO  HSTATEO.
  6068     MOVE PI-ACCOUNT             TO  HACCTNOO.
  6069     MOVE ' '                    TO  DC-OPTION-CODE.
  6070     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6071
  6072     PERFORM 9600-DATE-LINK.
  6073
  6074     MOVE DC-GREG-DATE-1-EDIT    TO  HEFFDTO.
  6075     MOVE PI-CERT-PRIME          TO  HCERTNOO.
  6076     MOVE PI-CERT-SFX            TO  HCRTSFXO.
  6077     MOVE PI-CLP-YN              TO  CLPYNO
  6078     MOVE PI-CANCEL-REASON       TO  CANREAO
  6079     .
  6080 0510-GET-CERT.
  6081     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  6082     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  6083     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  6084     MOVE PI-STATE               TO  WS-CM-STATE.
  6085     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  6086     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  6087     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  6088     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  6089
  6090     PERFORM 0900-READ-CERT-FILE.
  6091
  6092     IF CERT-NOT-FOUND
  6093         MOVE -1                 TO  HLCANCL
  6094         MOVE AL-SANON           TO  HLCANCA
  6095         MOVE ER-0214            TO  EMI-ERROR
  6096         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6097         GO TO 8100-SEND-INITIAL-MAP.
  6098
  6099     IF CM-CLAIM-ATTACHED-COUNT = +0
  6100        GO TO 0510-SKIP-CLAIM-CHECK
  6101     END-IF
  6102*    DISPLAY ' STARTING CLAIM TEST '
  6103     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  6104     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  6105
  6106* EXEC CICS STARTBR
  6107*       DATASET     ('ELMSTR5')
  6108*       RIDFLD      (ELMSTR-KEY)
  6109*       RESP        (WS-RESPONSE)
  6110*    END-EXEC
  6111     MOVE 'ELMSTR5' TO DFHEIV1
  6112     MOVE 0
  6113       TO DFHEIV11
  6114*    MOVE '&,         G          &  N#00006049' TO DFHEIV0
  6115     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6116     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6117     MOVE X'204E233030303036303439' TO DFHEIV0(25:11)
  6118     CALL 'kxdfhei1' USING DFHEIV0,
  6119           DFHEIV1,
  6120           ELMSTR-KEY,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 112
* EL1278.cbl
  6121           DFHEIV99,
  6122           DFHEIV11,
  6123           DFHEIV99
  6124     MOVE EIBRESP  TO WS-RESPONSE
  6125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6126     IF WS-RESP-NORMAL
  6127     PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6128
  6129* EXEC CICS READNEXT
  6130*          DATASET   ('ELMSTR5')
  6131*          RIDFLD    (ELMSTR-KEY)
  6132*          SET       (ADDRESS OF CLAIM-MASTER)
  6133*          RESP      (WS-RESPONSE)
  6134*       END-EXEC
  6135     MOVE 'ELMSTR5' TO DFHEIV1
  6136     MOVE 0
  6137       TO DFHEIV11
  6138*    MOVE '&.S                   )  N#00006056' TO DFHEIV0
  6139     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6140     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6141     MOVE X'204E233030303036303536' TO DFHEIV0(25:11)
  6142     CALL 'kxdfhei1' USING DFHEIV0,
  6143           DFHEIV1,
  6144           DFHEIV20,
  6145           DFHEIV99,
  6146           ELMSTR-KEY,
  6147           DFHEIV99,
  6148           DFHEIV11,
  6149           DFHEIV99,
  6150           DFHEIV99
  6151     SET ADDRESS OF CLAIM-MASTER TO
  6152         DFHEIV20
  6153     MOVE EIBRESP  TO WS-RESPONSE
  6154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6155        IF (WS-RESP-NORMAL OR WS-RESP-DUPKEY)
  6156           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6157           AND (CM-CERT-NO = CL-CERT-NO)
  6158           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6159              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6160              SET FOUND-A-CLAIM  TO TRUE
  6161              IF CL-CLAIM-TYPE = 'L'
  6162                 IF CL-INCURRED-DT > WS-LF-INCUR-DT
  6163                    MOVE CL-INCURRED-DT TO WS-LF-INCUR-DT
  6164                 END-IF
  6165                 IF CLAIM-IS-OPEN
  6166                    SET OPEN-LF-CLAIM TO TRUE
  6167                 ELSE
  6168                    IF CL-LAST-CLOSE-DT > WS-LF-LAST-CLOSE-DT
  6169                       MOVE CL-LAST-CLOSE-DT
  6170                                 TO WS-LF-LAST-CLOSE-DT
  6171                    END-IF
  6172                    SET CLOSED-LF-CLAIM TO TRUE
  6173                 END-IF
  6174              ELSE
  6175                 IF CLAIM-IS-OPEN
  6176                    MOVE CL-PAID-THRU-DT
  6177                                 TO WS-AH-PAID-THRU-DT
  6178                    SET OPEN-AH-CLAIM TO TRUE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 113
* EL1278.cbl
  6179                 ELSE
  6180                    IF CL-PAID-THRU-DT > WS-AH-PAID-THRU-DT
  6181                       MOVE CL-PAID-THRU-DT
  6182                                 TO WS-AH-PAID-THRU-DT
  6183                    END-IF
  6184                    IF CL-LAST-CLOSE-DT > WS-AH-LAST-CLOSE-DT
  6185                       MOVE CL-LAST-CLOSE-DT
  6186                                 TO WS-AH-LAST-CLOSE-DT
  6187                    END-IF
  6188                    SET CLOSED-AH-CLAIM TO TRUE
  6189                 END-IF
  6190              END-IF
  6191           END-IF
  6192        ELSE
  6193           SET I-SAY-TO-STOP TO TRUE
  6194        END-IF
  6195     END-PERFORM
  6196     END-IF
  6197     IF FOUND-A-CLAIM
  6198        IF WS-LF-INCUR-DT NOT = LOW-VALUES
  6199           MOVE WS-LF-INCUR-DT   TO DC-BIN-DATE-1
  6200           MOVE ' '              TO DC-OPTION-CODE
  6201           PERFORM 9600-DATE-LINK
  6202           IF NO-CONVERSION-ERROR
  6203              MOVE DC-GREG-DATE-1-EDIT TO LCLMDTO
  6204              MOVE AL-SANOF      TO LCLMDTHA
  6205           END-IF
  6206        END-IF
  6207        IF WS-AH-PAID-THRU-DT NOT = LOW-VALUES
  6208           MOVE WS-AH-PAID-THRU-DT TO DC-BIN-DATE-1
  6209           MOVE ' '              TO DC-OPTION-CODE
  6210           PERFORM 9600-DATE-LINK
  6211           IF NO-CONVERSION-ERROR
  6212              MOVE DC-GREG-DATE-1-EDIT TO ACLMDTO
  6213              MOVE AL-SANOF      TO ACLMDTHA
  6214           END-IF
  6215        END-IF
  6216        MOVE PI-COMPANY-ID       TO WS-CF-COMPANY-ID
  6217        MOVE '3'                 TO WS-CF-RECORD-TYPE
  6218        MOVE CM-STATE            TO WS-CF-ACCESS
  6219        MOVE +0                  TO WS-CF-SEQUENCE-NO
  6220
  6221* EXEC CICS READ
  6222*          DATASET  (ELCNTL-ID)
  6223*          SET      (ADDRESS OF CONTROL-FILE)
  6224*          RIDFLD   (WS-CF-CONTROL-PRIMARY)
  6225*          RESP     (WS-RESPONSE)
  6226*       END-EXEC
  6227*    MOVE '&"S        E          (  N#00006127' TO DFHEIV0
  6228     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6229     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6230     MOVE X'204E233030303036313237' TO DFHEIV0(25:11)
  6231     CALL 'kxdfhei1' USING DFHEIV0,
  6232           ELCNTL-ID,
  6233           DFHEIV20,
  6234           DFHEIV99,
  6235           WS-CF-CONTROL-PRIMARY,
  6236           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 114
* EL1278.cbl
  6237           DFHEIV99,
  6238           DFHEIV99
  6239     SET ADDRESS OF CONTROL-FILE TO
  6240         DFHEIV20
  6241     MOVE EIBRESP  TO WS-RESPONSE
  6242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6243        IF WS-RESP-NORMAL
  6244           MOVE CF-ST-REF-AH-DEATH-IND
  6245                                 TO WS-ST-REF-IND
  6246        END-IF
  6247     END-IF
  6248     .
  6249 0510-SKIP-CLAIM-CHECK.
  6250     MOVE CM-INSURED-LAST-NAME   TO  HLNAMEO.
  6251     MOVE CM-INSURED-FIRST-NAME  TO  HFNAMEO.
  6252     MOVE CM-INSURED-INITIAL2    TO  HINITO.
  6253     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  6254
  6255* EXEC CICS READ
  6256*        DATASET  (ERMAIL-ID)
  6257*        RIDFLD   (WS-MA-CONTROL-PRIMARY)
  6258*        SET      (ADDRESS OF MAILING-DATA)
  6259*        RESP     (WS-RESPONSE)
  6260*    END-EXEC.
  6261*    MOVE '&"S        E          (  N#00006144' TO DFHEIV0
  6262     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6263     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6264     MOVE X'204E233030303036313434' TO DFHEIV0(25:11)
  6265     CALL 'kxdfhei1' USING DFHEIV0,
  6266           ERMAIL-ID,
  6267           DFHEIV20,
  6268           DFHEIV99,
  6269           WS-MA-CONTROL-PRIMARY,
  6270           DFHEIV99,
  6271           DFHEIV99,
  6272           DFHEIV99
  6273     SET ADDRESS OF MAILING-DATA TO
  6274         DFHEIV20
  6275     MOVE EIBRESP  TO WS-RESPONSE
  6276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6277
  6278     IF WS-RESP-NORMAL
  6279        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6280           (S1 > +7)
  6281           OR (MA-MAIL-STATUS (S1) = '1')
  6282        END-PERFORM
  6283        IF S1 > +7
  6284           MOVE AL-SANOF         TO HPCYNA
  6285        END-IF
  6286     END-IF
  6287     IF CM-POST-CARD-IND = 'Y'
  6288        MOVE 'Y'                 TO HPCYNO
  6289     ELSE
  6290        MOVE 'N'                 TO HPCYNO
  6291     END-IF
  6292     IF ('8' NOT = CM-LF-CURRENT-STATUS AND CM-AH-CURRENT-STATUS)
  6293        OR (NOT CERT-AS-LOADED)
  6294        MOVE AL-SANOF            TO HPCYNA
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 115
* EL1278.cbl
  6295     END-IF
  6296*    IF (CERT-ADDED-BATCH)
  6297*       CONTINUE
  6298*    ELSE
  6299*       MOVE AL-SANOF            TO HPCYNA
  6300*    END-IF
  6301     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  6302     MOVE '5'                    TO  DC-OPTION-CODE.
  6303
  6304     PERFORM 9600-DATE-LINK.
  6305
  6306     MOVE DC-BIN-DATE-1          TO  DC-BIN-DATE-2.
  6307     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6308     MOVE '1'                    TO  DC-OPTION-CODE.
  6309
  6310     PERFORM 9600-DATE-LINK.
  6311
  6312     MOVE DC-ELAPSED-MONTHS      TO  WS-ELAPSED-MONTHS.
  6313
  6314     MOVE ZEROS TO WS-TOT-ITDR.
  6315     MOVE WS-REFUND-DESCRIP TO PMTHDO.
  6316
  6317 0510-CHECK-LF-STATUS.
  6318
  6319     IF (CM-LF-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6320         MOVE LOW-VALUES         TO WS-LF-CANCEL-DATE
  6321                                    PI-LF-CANCEL-DATE
  6322         MOVE SPACES             TO WS-LF-CANCEL-DATE-ED
  6323                                    PI-LF-CANCEL-DATE-ED
  6324                                    PI-LF-REFUND-METH
  6325         MOVE ZEROS              TO PI-LF-REFUND-AMT
  6326         GO TO 0510-CHECK-AH-STATUS.
  6327
  6328     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '8') AND
  6329        (CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6330          MOVE CM-LF-ITD-CANCEL-AMT TO HLITDRO
  6331          ADD  CM-LF-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6332          IF FIRST-ENTRY
  6333              MOVE CM-LF-CANCEL-DT      TO DC-BIN-DATE-1
  6334              MOVE SPACES               TO DC-OPTION-CODE
  6335              PERFORM 9600-DATE-LINK
  6336              IF NOT DATE-CONVERSION-ERROR
  6337                   MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6338                                            PI-LF-CANCEL-DATE-ED
  6339                                            WS-LF-CANCEL-DATE-ED
  6340                   MOVE CM-LF-CANCEL-DT TO  PI-LF-CANCEL-DATE
  6341                                            WS-LF-CANCEL-DATE.
  6342
  6343     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '7')  AND
  6344        (CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES)
  6345          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6346          MOVE CM-LF-ITD-DEATH-AMT  TO HLITDRO
  6347          ADD  CM-LF-ITD-DEATH-AMT TO WS-TOT-ITDR
  6348        IF FIRST-ENTRY
  6349            MOVE CM-LF-DEATH-DT       TO DC-BIN-DATE-1
  6350            MOVE SPACES               TO DC-OPTION-CODE
  6351            PERFORM 9600-DATE-LINK
  6352            IF NOT DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 116
* EL1278.cbl
  6353                 MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6354                                          PI-LF-CANCEL-DATE-ED
  6355                                          WS-LF-CANCEL-DATE-ED
  6356                 MOVE CM-LF-DEATH-DT  TO  PI-LF-CANCEL-DATE
  6357                                          WS-LF-CANCEL-DATE.
  6358
  6359 0510-CHECK-AH-STATUS.
  6360
  6361     IF (CM-AH-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6362         MOVE LOW-VALUES         TO WS-AH-CANCEL-DATE
  6363                                    PI-AH-CANCEL-DATE
  6364         MOVE SPACES             TO WS-AH-CANCEL-DATE-ED
  6365                                    PI-AH-CANCEL-DATE-ED
  6366                                    PI-AH-REFUND-METH
  6367         MOVE ZEROS              TO PI-AH-REFUND-AMT
  6368         GO TO 0510-CONT.
  6369
  6370     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '8')  AND
  6371        (CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6372          MOVE CM-AH-ITD-CANCEL-AMT TO HAITDRO
  6373          ADD  CM-AH-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6374        IF FIRST-ENTRY
  6375            MOVE CM-AH-CANCEL-DT      TO DC-BIN-DATE-1
  6376            MOVE SPACES               TO DC-OPTION-CODE
  6377            PERFORM 9600-DATE-LINK
  6378            IF NOT DATE-CONVERSION-ERROR
  6379                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6380                                            PI-AH-CANCEL-DATE-ED
  6381                                            WS-AH-CANCEL-DATE-ED
  6382                 MOVE CM-AH-CANCEL-DT  TO   PI-AH-CANCEL-DATE
  6383                                            WS-AH-CANCEL-DATE.
  6384
  6385     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '6' OR '7')   AND
  6386        (CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES)
  6387          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6388          MOVE CM-AH-ITD-LUMP-PMT   TO HAITDRO
  6389          ADD  CM-AH-ITD-LUMP-PMT   TO WS-TOT-ITDR
  6390         IF FIRST-ENTRY
  6391             MOVE CM-AH-SETTLEMENT-DT  TO DC-BIN-DATE-1
  6392             MOVE SPACES               TO DC-OPTION-CODE
  6393             PERFORM 9600-DATE-LINK
  6394             IF NOT DATE-CONVERSION-ERROR
  6395                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6396                                            PI-AH-CANCEL-DATE-ED
  6397                                            WS-AH-CANCEL-DATE-ED
  6398                MOVE CM-AH-SETTLEMENT-DT TO PI-AH-CANCEL-DATE
  6399                                            WS-AH-CANCEL-DATE.
  6400
  6401     IF CM-AH-CURRENT-STATUS IS EQUAL TO '8'
  6402         MOVE 'CANC DT'              TO  CNCDTHDO
  6403         GO TO 0510-CONT.
  6404
  6405     IF CM-LF-CURRENT-STATUS IS EQUAL TO '7'
  6406         MOVE 'DTH DT '              TO  CNCDTHDO
  6407         IF FIRST-ENTRY
  6408             MOVE CM-LF-DEATH-DT     TO  DC-BIN-DATE-1
  6409             MOVE ' '                TO  DC-OPTION-CODE
  6410             PERFORM 9600-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 117
* EL1278.cbl
  6411             IF NOT DATE-CONVERSION-ERROR
  6412                 MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6413                                             PI-AH-CANCEL-DATE-ED
  6414                                             WS-AH-CANCEL-DATE-ED
  6415                 MOVE CM-LF-DEATH-DT      TO PI-AH-CANCEL-DATE
  6416                                             WS-AH-CANCEL-DATE.
  6417
  6418 0510-CONT.
  6419
  6420     IF WS-TOT-ITDR GREATER THAN ZEROS
  6421         MOVE WS-TOT-ITDR TO TOITDRO.
  6422
  6423 0520-GET-COMPANY-RECORD.
  6424     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6425     MOVE '1'                    TO  WS-CF-RECORD-TYPE.
  6426     MOVE SPACES                 TO  WS-CF-ACCESS.
  6427     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6428
  6429     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6430
  6431     IF CNTL-NOT-FOUND
  6432         MOVE -1                 TO  HLCANCL
  6433         MOVE AL-SANON           TO  HLCANCA
  6434         MOVE ER-2616            TO  EMI-ERROR
  6435         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6436         GO TO 8100-SEND-INITIAL-MAP.
  6437
  6438     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6439       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6440         MOVE CF-LIFE-OVERRIDE-L1
  6441                                 TO  WS-CF-LIFE-OVERRIDE-L1
  6442         MOVE CF-LIFE-OVERRIDE-L2
  6443                                 TO  WS-CF-LIFE-OVERRIDE-L2
  6444         MOVE CF-AH-OVERRIDE-L1  TO  WS-CF-AH-OVERRIDE-L1
  6445         MOVE CF-AH-OVERRIDE-L2  TO  WS-CF-AH-OVERRIDE-L2
  6446         MOVE CF-CR-REM-TERM-CALC
  6447                                 TO  WS-CF-CR-REM-TERM-CALC
  6448         MOVE CF-CR-R78-METHOD   TO  WS-CF-CR-R78-METHOD
  6449         IF CF-DEFAULT-APR NUMERIC
  6450             MOVE CF-DEFAULT-APR     TO  WS-CF-DEFAULT-APR
  6451             GO TO 0525-GET-LF-BENEFIT
  6452         ELSE
  6453             MOVE ZEROS              TO  WS-CF-DEFAULT-APR
  6454             GO TO 0525-GET-LF-BENEFIT.
  6455
  6456     MOVE -1                     TO  HLCANCL.
  6457     MOVE AL-SANON               TO  HLCANCA.
  6458     MOVE ER-2616                TO  EMI-ERROR.
  6459
  6460     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6461
  6462     GO TO 8100-SEND-INITIAL-MAP.
  6463
  6464 0525-GET-LF-BENEFIT.
  6465
  6466     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  6467        GO TO 0527-GET-AH-BENEFIT
  6468     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 118
* EL1278.cbl
  6469
  6470     MOVE '4'                    TO  WS-CF-RECORD-TYPE.
  6471     MOVE CM-LF-BENEFIT-CD       TO  WS-BENEFIT-NO
  6472                                     HLCDO.
  6473     MOVE WS-CF-LIFE-OVERRIDE-L2
  6474                                 TO  HLKINDO.
  6475
  6476     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6477
  6478     IF BENEFIT-FOUND
  6479         NEXT SENTENCE
  6480     ELSE
  6481         MOVE -1                 TO  HLCDL
  6482         MOVE AL-SANON           TO  HLCDA
  6483         MOVE ER-0028            TO  EMI-ERROR
  6484         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6485         GO TO 8100-SEND-INITIAL-MAP.
  6486
  6487     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6488         MOVE AL-UNNOF           TO  HLTERMA.
  6489
  6490*****MOVE WS-BENEFIT-DESCRIP     TO  HLDESCO.
  6491     MOVE WS-KIND                TO WS-LF-KIND
  6492     MOVE CF-LF-COVERAGE-TYPE (WS-INDEX)
  6493                                 TO  WS-CF-LF-COVERAGE-TYPE.
  6494
  6495     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6496         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6497                                 TO  WS-LF-CO-REM-TERM-CALC.
  6498
  6499     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6500         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6501                                 TO  WS-LF-CO-EARNINGS-CALC
  6502                                     WS-LF-CO-REFUND-CALC.
  6503
  6504     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6505         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6506                                 TO  WS-LF-SPECIAL-CALC-CD.
  6507
  6508     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6509         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6510                                 TO  WS-LF-CO-REFUND-CALC.
  6511
  6512 0527-GET-AH-BENEFIT.
  6513
  6514     IF CM-AH-BENEFIT-CD = '00' OR '  '
  6515        GO TO 0530-GET-STATE-RECORD
  6516     END-IF
  6517
  6518     MOVE '5'                    TO  WS-CF-RECORD-TYPE.
  6519     MOVE CM-AH-BENEFIT-CD       TO  WS-BENEFIT-NO
  6520                                     HACDO.
  6521     MOVE WS-CF-AH-OVERRIDE-L2   TO  HAKINDO.
  6522
  6523     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6524
  6525     IF BENEFIT-FOUND
  6526         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 119
* EL1278.cbl
  6527     ELSE
  6528         MOVE -1                 TO  HACDL
  6529         MOVE AL-SANON           TO  HACDA
  6530         MOVE ER-0028            TO  EMI-ERROR
  6531         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6532         GO TO 8100-SEND-INITIAL-MAP.
  6533
  6534     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6535         MOVE AL-UNNOF           TO  HATERMA.
  6536
  6537*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  6538     MOVE WS-KIND                TO  WS-AH-KIND
  6539
  6540     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6541         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6542                                 TO  WS-AH-CO-REM-TERM-CALC.
  6543
  6544     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6545         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6546                                 TO  WS-AH-CO-EARNINGS-CALC
  6547                                     WS-AH-CO-REFUND-CALC.
  6548
  6549     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6550         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6551                                 TO  WS-AH-SPECIAL-CALC-CD.
  6552
  6553     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6554         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6555                                 TO  WS-AH-CO-REFUND-CALC.
  6556     IF CF-BENEFIT-CATEGORY (WS-INDEX) > ' '
  6557        MOVE CF-BENEFIT-CATEGORY (WS-INDEX)
  6558                                 TO WS-AH-BEN-CATEGORY
  6559     END-IF
  6560     .
  6561 0530-GET-STATE-RECORD.
  6562     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6563     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  6564     MOVE CM-STATE               TO  WS-CF-ACCESS.
  6565     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6566
  6567     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6568
  6569     IF CNTL-NOT-FOUND
  6570         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6571                                     WS-LF-ST-REM-TERM-CALC
  6572         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6573         GO TO 0560-FIND-ACCOUNT.
  6574
  6575     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6576       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6577       AND CM-STATE  IS EQUAL TO  CF-STATE-CODE
  6578         MOVE 'Y'                TO  WS-STATE-RECORD-SW
  6579     ELSE
  6580         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6581                                     WS-LF-ST-REM-TERM-CALC
  6582         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6583         GO TO 0560-FIND-ACCOUNT.
  6584
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 120
* EL1278.cbl
  6585     MOVE CF-STATE-ABBREVIATION  TO  WS-STATE-ABBREVIATION.
  6586     MOVE CF-ST-FST-PMT-DAYS-CHG TO  WS-STATE-EXT-DAYS-CHG
  6587
  6588     IF CM-LF-BENEFIT-CD  = '00'
  6589         GO TO 0550-GET-AH-BEN-IN-STATE.
  6590
  6591 0540-GET-LF-BEN-IN-STATE.
  6592     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  6593     MOVE PI-LIFE-OVERRIDE-L1    TO  WS-LOOKUP-TYPE.
  6594
  6595     MOVE '0'                    TO WS-LF-ST-REM-TERM-CALC
  6596     IF CF-ST-RT-CALC NOT = SPACES
  6597        MOVE CF-ST-RT-CALC       TO WS-LF-ST-REM-TERM-CALC
  6598     END-IF
  6599
  6600     IF WS-CF-LF-COVERAGE-TYPE = 'R'
  6601        IF CF-ST-RF-LR-CALC > '0'
  6602           MOVE CF-ST-RF-LR-CALC TO WS-LF-ST-REFUND-CALC
  6603        END-IF
  6604        IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  6605           IF CF-ST-RF-LN-CALC > '0'
  6606              MOVE CF-ST-RF-LN-CALC
  6607                                 TO WS-LF-ST-REFUND-CALC
  6608           END-IF
  6609        END-IF
  6610     ELSE
  6611        IF CF-ST-RF-LL-CALC > '0'
  6612           MOVE CF-ST-RF-LL-CALC TO WS-LF-ST-REFUND-CALC
  6613        END-IF
  6614     END-IF
  6615
  6616     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6617
  6618     IF NO-BENEFIT-FOUND
  6619*        MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6620         GO TO 0550-GET-AH-BEN-IN-STATE.
  6621
  6622     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6623         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6624                                 TO  WS-LF-ST-REM-TERM-CALC.
  6625
  6626     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6627         MOVE CF-ST-REFUND-CALC (SUB3)
  6628                                 TO  WS-LF-ST-REFUND-CALC.
  6629
  6630 0550-GET-AH-BEN-IN-STATE.
  6631     IF CM-AH-BENEFIT-CD  = '00'
  6632         GO TO 0560-FIND-ACCOUNT.
  6633
  6634     MOVE '0'                    TO WS-AH-ST-REM-TERM-CALC
  6635     IF CF-ST-RT-CALC NOT = SPACES
  6636        MOVE CF-ST-RT-CALC       TO WS-AH-ST-REM-TERM-CALC
  6637     END-IF
  6638
  6639     IF CF-ST-RF-AH-CALC > '0'
  6640        MOVE CF-ST-RF-AH-CALC    TO WS-AH-ST-REFUND-CALC
  6641     END-IF
  6642     IF WS-AH-SPECIAL-CALC-CD = 'C'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 121
* EL1278.cbl
  6643        IF CF-ST-RF-CP-CALC > '0'
  6644           MOVE CF-ST-RF-CP-CALC TO WS-AH-ST-REFUND-CALC
  6645        END-IF
  6646     END-IF
  6647
  6648     MOVE CM-AH-BENEFIT-CD       TO  WS-BEN-CD.
  6649     MOVE PI-AH-OVERRIDE-L1      TO  WS-LOOKUP-TYPE.
  6650
  6651     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6652
  6653     IF NO-BENEFIT-FOUND
  6654*        MOVE '0'                TO  WS-AH-ST-REFUND-CALC
  6655         GO TO 0560-FIND-ACCOUNT.
  6656
  6657     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6658         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6659                                 TO  WS-AH-ST-REM-TERM-CALC.
  6660
  6661     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6662         MOVE CF-ST-REFUND-CALC (SUB3)
  6663                                 TO  WS-AH-ST-REFUND-CALC.
  6664
  6665 0560-FIND-ACCOUNT.
  6666     MOVE CM-COMPANY-CD          TO  WS-AM-COMPANY-CD.
  6667     MOVE CM-CARRIER             TO  WS-AM-CARRIER.
  6668     MOVE CM-GROUPING            TO  WS-AM-GROUPING.
  6669     MOVE CM-STATE               TO  WS-AM-STATE.
  6670     MOVE CM-ACCOUNT             TO  WS-AM-ACCOUNT.
  6671     MOVE CM-CERT-EFF-DT         TO  WS-AM-EXPIRATION-DT.
  6672     MOVE LOW-VALUES             TO  WS-AM-FILLER.
  6673
  6674     PERFORM 1200-START-ACCOUNT-MASTER  THRU  1299-EXIT.
  6675
  6676     IF ACCT-FOUND
  6677         NEXT SENTENCE
  6678     ELSE
  6679         GO TO 0585-NO-ACCT.
  6680
  6681 0570-READ-NEXT-RANGE.
  6682     PERFORM 1300-READ-ACCOUNT-MASTER  THRU  1399-EXIT.
  6683
  6684     IF ACCT-FOUND
  6685         NEXT SENTENCE
  6686     ELSE
  6687         GO TO 0580-ACCT-NOT-FOUND.
  6688
  6689     IF CM-COMPANY-CD  IS EQUAL TO  AM-COMPANY-CD
  6690       AND CM-CARRIER  IS EQUAL TO  AM-CARRIER
  6691       AND CM-GROUPING  IS EQUAL TO  AM-GROUPING
  6692       AND CM-STATE  IS EQUAL TO  AM-STATE
  6693       AND CM-ACCOUNT  IS EQUAL TO  AM-ACCOUNT
  6694         NEXT SENTENCE
  6695     ELSE
  6696         GO TO 0580-ACCT-NOT-FOUND.
  6697
  6698     MOVE 'X'                    TO  DATE-RANGE-SW.
  6699
  6700     IF CM-CERT-EFF-DT  IS LESS THAN  AM-EFFECTIVE-DT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 122
* EL1278.cbl
  6701         MOVE 'X'                TO  DATE-RANGE-SW
  6702         GO TO 0580-ACCT-NOT-FOUND.
  6703
  6704     IF CM-CERT-EFF-DT  IS NOT LESS THAN  AM-EXPIRATION-DT
  6705         GO TO 0570-READ-NEXT-RANGE.
  6706
  6707     IF WS-BROWSE-STARTED-SW = 'Y'
  6708
  6709* EXEC CICS ENDBR
  6710*          DATASET    ('ERACCT')
  6711*       END-EXEC
  6712     MOVE 'ERACCT' TO DFHEIV1
  6713     MOVE 0
  6714       TO DFHEIV11
  6715*    MOVE '&2                    $   #00006580' TO DFHEIV0
  6716     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6717     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6718     MOVE X'2020233030303036353830' TO DFHEIV0(25:11)
  6719     CALL 'kxdfhei1' USING DFHEIV0,
  6720           DFHEIV1,
  6721           DFHEIV11,
  6722           DFHEIV99
  6723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6724        MOVE SPACES             TO  WS-BROWSE-STARTED-SW
  6725     END-IF
  6726     MOVE ' '                    TO  DATE-RANGE-SW.
  6727     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  6728
  6729     GO TO 0590-SET-ACCOUNT.
  6730
  6731 0580-ACCT-NOT-FOUND.
  6732     IF DATE-RANGE-SW  IS NOT EQUAL TO  SPACES
  6733         MOVE ER-2601            TO  EMI-ERROR
  6734     ELSE
  6735         MOVE ER-2619            TO  EMI-ERROR.
  6736
  6737     MOVE 'N'                    TO  WS-ACCT-RECORD-SW.
  6738
  6739     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6740
  6741 0585-NO-ACCT.
  6742     MOVE SPACES                 TO  WS-ACCT-USER-FLD-5.
  6743     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  6744                                     WS-AM-EARN-METHOD-R
  6745                                     WS-AM-EARN-METHOD-A
  6746                                     WS-LF-AM-REM-TERM-CALC
  6747                                     WS-AH-AM-REM-TERM-CALC.
  6748
  6749     GO TO 0600-CHECK-FOR-LIFE.
  6750
  6751 0590-SET-ACCOUNT.
  6752******************************************************************
  6753******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  6754******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  6755******* METHODS.
  6756******************************************************************
  6757     MOVE SPACES              TO WS-LF-FO-REFUND-CALC.
  6758     MOVE SPACES              TO WS-AH-FO-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 123
* EL1278.cbl
  6759     IF PI-COMPANY-ID EQUAL TO 'NCL'
  6760          IF ((CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  6761                 OR (CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  6762                  PERFORM 7000-GET-ERFORM THRU 7000-EXIT
  6763                  IF FORM-FOUND
  6764                      PERFORM 7100-BENEFIT-SEARCH THRU 7100-EXIT.
  6765******************************************************************
  6766
  6767     MOVE AM-FLD-5               TO  WS-ACCT-USER-FLD-5.
  6768     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  6769                                     WS-AM-EARN-METHOD-R
  6770                                     WS-AM-EARN-METHOD-A.
  6771
  6772*    EVALUATE AM-EARN-METHOD-R
  6773*       WHEN 'R'
  6774*           MOVE '1'                TO  WS-AM-EARN-METHOD-R
  6775*       WHEN 'P'
  6776*           MOVE '2'                TO  WS-AM-EARN-METHOD-R
  6777*       WHEN 'C'
  6778*           MOVE '3'                TO  WS-AM-EARN-METHOD-R
  6779*       WHEN 'A'
  6780*           MOVE '6'                TO  WS-AM-EARN-METHOD-R
  6781*       WHEN 'M'
  6782*           MOVE '8'                TO  WS-AM-EARN-METHOD-R
  6783*       WHEN 'S'
  6784*           MOVE '9'                TO  WS-AM-EARN-METHOD-R
  6785*    END-EVALUATE.
  6786
  6787*    EVALUATE AM-EARN-METHOD-L
  6788*       WHEN 'R'
  6789*           MOVE '1'                TO  WS-AM-EARN-METHOD-L
  6790*       WHEN 'P'
  6791*           MOVE '2'                TO  WS-AM-EARN-METHOD-L
  6792*       WHEN 'C'
  6793*           MOVE '3'                TO  WS-AM-EARN-METHOD-L
  6794*       WHEN 'A'
  6795*           MOVE '6'                TO  WS-AM-EARN-METHOD-L
  6796*       WHEN 'M'
  6797*           MOVE '8'                 TO  WS-AM-EARN-METHOD-L
  6798*       WHEN 'S'
  6799*           MOVE '9'                 TO  WS-AM-EARN-METHOD-L
  6800*    END-EVALUATE.
  6801
  6802*    EVALUATE AM-EARN-METHOD-A
  6803*       WHEN 'R'
  6804*           MOVE '1'                TO  WS-AM-EARN-METHOD-A
  6805*       WHEN 'P'
  6806*           MOVE '2'                TO  WS-AM-EARN-METHOD-A
  6807*       WHEN 'C'
  6808*           MOVE '3'                TO  WS-AM-EARN-METHOD-A
  6809*       WHEN 'A'
  6810*           MOVE '6'                TO  WS-AM-EARN-METHOD-A
  6811*       WHEN 'M'
  6812*           MOVE '8'                TO  WS-AM-EARN-METHOD-A
  6813*       WHEN 'N'
  6814*           MOVE '5'                TO  WS-AM-EARN-METHOD-A
  6815*       WHEN 'S'
  6816*           MOVE '9'                TO  WS-AM-EARN-METHOD-A
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 124
* EL1278.cbl
  6817*    END-EVALUATE.
  6818
  6819     MOVE ZEROS                  TO  WS-TOT-AH-PREM
  6820                                     WS-TOT-LF-PREM
  6821                                     WS-TOT-AH-RFND
  6822                                     WS-TOT-LF-RFND.
  6823
  6824 0600-CHECK-FOR-LIFE.
  6825     IF CM-LF-BENEFIT-CD  = '00'
  6826         GO TO 0640-AH-BENEFIT.
  6827
  6828 0610-GET-LIFE-BENEFIT.
  6829
  6830     IF ACCT-FOUND
  6831         MOVE +1                 TO SUB3
  6832         PERFORM 5000-GET-LF-AM-REM-TERM THRU 5900-EXIT.
  6833     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  6834     MOVE WS-LF-KIND             TO  HLEDESCO.
  6835     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  6836     IF WS-LF-CO-EARNINGS-CALC = 'B'
  6837        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  6838                             + CM-LF-ALT-PREMIUM-AMT
  6839     ELSE
  6840        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  6841     END-IF
  6842
  6843     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  6844     EVALUATE TRUE
  6845        WHEN ((OPEN-LF-CLAIM)
  6846           OR (CLOSED-LF-CLAIM))
  6847           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  6848           MOVE ZEROS            TO HLREFNDO  WS-CALC-REFUND
  6849                                    WS-TOT-LF-RFND
  6850                                    PI-LF-REFUND-AMT
  6851           IF CM-AH-BENEFIT-CD NOT = '00'
  6852              MOVE ZEROS         TO HAREFNDO
  6853                                    WS-TOT-AH-RFND
  6854                                    PI-AH-REFUND-AMT
  6855              MOVE SPACES        TO PI-AH-REFUND-METH
  6856           END-IF
  6857           MOVE ER-2965          TO EMI-ERROR
  6858           PERFORM 9700-ERROR-FORMAT
  6859                                 THRU  9799-EXIT
  6860           GO TO 0640-AH-BENEFIT
  6861        WHEN OPEN-LF-CLAIM
  6862           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6863           AND WS-ST-REF-IND = '4'
  6864           MOVE ER-2966          TO EMI-ERROR
  6865           PERFORM 9700-ERROR-FORMAT
  6866                                 THRU  9799-EXIT
  6867        WHEN OPEN-LF-CLAIM
  6868           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6869           AND WS-ST-REF-IND NOT = '4'
  6870           MOVE ER-2967          TO EMI-ERROR
  6871           PERFORM 9700-ERROR-FORMAT
  6872                                 THRU  9799-EXIT
  6873           GO TO 0640-AH-BENEFIT
  6874        WHEN CLOSED-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 125
* EL1278.cbl
  6875           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6876           AND WS-ST-REF-IND = '4'
  6877           MOVE ER-2968          TO EMI-ERROR
  6878           PERFORM 9700-ERROR-FORMAT
  6879                                 THRU  9799-EXIT
  6880        WHEN CLOSED-LF-CLAIM
  6881           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6882           AND WS-ST-REF-IND NOT = '4'
  6883           MOVE ER-2969          TO EMI-ERROR
  6884           PERFORM 9700-ERROR-FORMAT
  6885                                 THRU  9799-EXIT
  6886           GO TO 0640-AH-BENEFIT
  6887        WHEN OTHER
  6888           CONTINUE
  6889     END-EVALUATE
  6890     .
  6891 0620-GET-REM-TERM.
  6892     MOVE WS-CF-LIFE-OVERRIDE-L1
  6893                                 TO  CP-LIFE-OVERRIDE-CODE.
  6894     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  6895     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  6896     MOVE WS-LF-CANCEL-DATE      TO  CP-VALUATION-DT.
  6897     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  6898     MOVE CM-STATE               TO  CP-STATE.
  6899     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  6900     MOVE WS-CF-LF-COVERAGE-TYPE
  6901                                 TO  CP-BENEFIT-TYPE.
  6902     MOVE WS-LF-KIND             TO  HLEDESCO.
  6903     MOVE WS-LF-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  6904     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6905     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6906     MOVE '2'                    TO  CP-PROCESS-TYPE.
  6907     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  6908     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  6909     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  6910     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  6911     MOVE WS-CF-CR-REM-TERM-CALC
  6912                                 TO  CP-REM-TERM-METHOD.
  6913
  6914     IF WS-LF-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  6915         MOVE WS-LF-CO-REM-TERM-CALC
  6916                                 TO  CP-REM-TERM-METHOD.
  6917
  6918     IF WS-LF-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  6919         MOVE WS-LF-ST-REM-TERM-CALC
  6920                                 TO  CP-REM-TERM-METHOD.
  6921
  6922     IF WS-LF-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  6923         MOVE WS-LF-AM-REM-TERM-CALC
  6924                                 TO  CP-REM-TERM-METHOD.
  6925
  6926     IF (PI-COMPANY-ID = 'CID')
  6927        AND (CP-STATE-STD-ABBRV = 'WI')
  6928        MOVE '7'                 TO CP-REM-TERM-METHOD
  6929        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6930     END-IF
  6931     IF (PI-COMPANY-ID = 'CID')
  6932        AND (CP-STATE-STD-ABBRV = 'MO')
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 126
* EL1278.cbl
  6933        AND (CM-CERT-EFF-DT >= X'9B41')
  6934        AND (CM-CERT-EFF-DT <= X'A2FB')
  6935        MOVE '7'                 TO CP-REM-TERM-METHOD
  6936        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6937     END-IF
  6938     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  6939                                     CP-ORIGINAL-TERM
  6940                                     CP-LOAN-TERM.
  6941
  6942     IF CP-TRUNCATED-LIFE
  6943         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  6944
  6945     IF CP-TERM-IS-DAYS
  6946         IF CM-LF-TERM-IN-DAYS  IS NUMERIC
  6947             MOVE CM-LF-TERM-IN-DAYS
  6948                                 TO  CP-TERM-OR-EXT-DAYS
  6949         ELSE
  6950             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS
  6951     ELSE
  6952         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  6953             MOVE CM-PMT-EXTENSION-DAYS
  6954                                 TO  CP-TERM-OR-EXT-DAYS
  6955         ELSE
  6956             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  6957
  6958*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  6959     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6960     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  6961     MOVE CM-STATE               TO  WS-CF-ACCESS.
  6962     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6963
  6964
  6965* EXEC CICS READ
  6966*        DATASET  (ELCNTL-ID)
  6967*        SET      (ADDRESS OF CONTROL-FILE)
  6968*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  6969*        RESP     (WS-RESPONSE)
  6970*    END-EXEC.
  6971*    MOVE '&"S        E          (  N#00006823' TO DFHEIV0
  6972     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6973     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6974     MOVE X'204E233030303036383233' TO DFHEIV0(25:11)
  6975     CALL 'kxdfhei1' USING DFHEIV0,
  6976           ELCNTL-ID,
  6977           DFHEIV20,
  6978           DFHEIV99,
  6979           WS-CF-CONTROL-PRIMARY,
  6980           DFHEIV99,
  6981           DFHEIV99,
  6982           DFHEIV99
  6983     SET ADDRESS OF CONTROL-FILE TO
  6984         DFHEIV20
  6985     MOVE EIBRESP  TO WS-RESPONSE
  6986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6987
  6988
  6989     IF WS-RESP-NOTOPEN
  6990         MOVE ER-2617            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 127
* EL1278.cbl
  6991         GO TO 0320-INPUT-ERROR.
  6992
  6993     IF WS-RESP-NOTFND
  6994         MOVE ZERO               TO  CP-FREE-LOOK
  6995     ELSE
  6996         MOVE CF-ST-FREE-LOOK-PERIOD
  6997                                 TO CP-FREE-LOOK.
  6998
  6999     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7000        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7001        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  7002     END-IF
  7003
  7004     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7005
  7006     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7007        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7008        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  7009        COMPUTE CP-REMAINING-TERM-1 =
  7010                CP-REMAINING-TERM-1 - +1
  7011        COMPUTE CP-REMAINING-TERM-2 =
  7012                CP-REMAINING-TERM-2 - +1
  7013     END-IF
  7014
  7015     IF CP-REMAINING-TERM-1 NEGATIVE
  7016        MOVE ZEROS               TO CP-REMAINING-TERM-1
  7017     END-IF
  7018     IF CP-REMAINING-TERM-2 NEGATIVE
  7019        MOVE ZEROS               TO CP-REMAINING-TERM-2
  7020     END-IF
  7021     MOVE CP-REMAINING-TERM-1    TO  HLREMO.
  7022
  7023     IF PI-LF-CANCEL-DATE = LOW-VALUES
  7024         GO TO 0640-AH-BENEFIT.
  7025*    IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-LF-ORIG-TERM
  7026*        MOVE CM-LF-ORIG-TERM    TO  HLREMO.
  7027
  7028     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '8'
  7029         IF CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7030             MOVE ER-0681        TO  EMI-ERROR
  7031             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7032
  7033     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '7'
  7034         IF CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES
  7035             MOVE ER-0682        TO  EMI-ERROR
  7036             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7037
  7038 0630-CONTINUE-LIFE.
  7039
  7040     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7041        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7042        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7043                                    FREMTRMO
  7044     ELSE
  7045        MOVE CP-REMAINING-TERM-2 TO  CP-REMAINING-TERM
  7046                                     FREMTRMO
  7047     END-IF
  7048     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 128
* EL1278.cbl
  7049     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  7050     if pi-company-id = 'AHL'
  7051        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7052        if cp-class-code = spaces
  7053           move zeros            to cp-class-code
  7054        end-if
  7055     ELSE
  7056        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7057     END-IF
  7058     IF (PI-COMPANY-ID = 'DCC')
  7059        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  7060        MOVE ' '                 TO WS-PDEF-RECORD-SW
  7061        PERFORM 0730-GET-DDF-FACTORS
  7062                                 THRU 0730-EXIT
  7063        IF PDEF-FOUND
  7064           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7065              (P1 > +8)
  7066              OR (PD-PROD-CODE (P1) = 'L')
  7067           END-PERFORM
  7068           IF P1 < +9
  7069              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  7070           END-IF
  7071        END-IF
  7072     END-IF
  7073     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT.
  7074
  7075     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
  7076
  7077     IF WS-LF-CO-EARNINGS-CALC = 'B'
  7078        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  7079                             + CM-LF-ALT-PREMIUM-AMT
  7080     ELSE
  7081        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  7082     END-IF
  7083
  7084     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  7085                                     WS-TOT-LF-PREM.
  7086
  7087     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7088        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7089        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7090     ELSE
  7091        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  7092     END-IF
  7093
  7094     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7095     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7096
  7097     IF WS-LF-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7098         MOVE WS-LF-ST-REFUND-CALC
  7099                                 TO  CP-EARNING-METHOD.
  7100
  7101     IF WS-LF-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7102         MOVE WS-LF-FO-REFUND-CALC
  7103                                 TO  CP-EARNING-METHOD.
  7104
  7105     if (pi-company-id = 'CID')
  7106        and (cp-state-std-abbrv = 'MN' OR 'WA')
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 129
* EL1278.cbl
  7107        continue
  7108     else
  7109        IF CP-RATING-METHOD = '4'
  7110           MOVE '4'              TO CP-EARNING-METHOD
  7111        END-IF
  7112     end-if
  7113*    IF WS-CF-LF-COVERAGE-TYPE = 'R'
  7114*        IF WS-AM-EARN-METHOD-R  IS GREATER THAN  ZERO
  7115*            MOVE WS-AM-EARN-METHOD-R
  7116*                                TO  CP-EARNING-METHOD
  7117*        END-IF
  7118*    ELSE
  7119*        IF WS-AM-EARN-METHOD-L  IS GREATER THAN  ZERO
  7120*            MOVE WS-AM-EARN-METHOD-L
  7121*                                TO  CP-EARNING-METHOD.
  7122
  7123     if pi-company-id = 'AHL'
  7124        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7125        if cp-class-code = spaces
  7126           move zeros            to cp-class-code
  7127        end-if
  7128     ELSE
  7129        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7130     END-IF
  7131     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7132     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7133                                     CP-RATING-BENEFIT-AMT.
  7134     IF CP-STATE-STD-ABBRV = 'OR'
  7135         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7136                                         CM-LF-ALT-BENEFIT-AMT.
  7137****   N O T E   ****
  7138*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  7139*      THE OH HARD CODING IN ELCRFNDP
  7140
  7141     IF PI-COMPANY-ID = 'CID'
  7142        IF CP-STATE-STD-ABBRV = 'OH'
  7143           MOVE WS-LF-CO-EARNINGS-CALC
  7144                                 TO CP-EARNING-METHOD
  7145        END-IF
  7146     END-IF
  7147
  7148****   N O T E   ****
  7149
  7150****   MN   NOTE  ****  CID HAS THE STATE REFUND METHOD SET AS
  7151****      R78 BUT THEY WANT THE BALLOONS REFUNDED WITH A
  7152****      CUSTOM FORMULA THAT IS IN ELRFND SO I AM SETTING
  7153****     THE APPROPRIATE OPTIONS HERE
  7154*    IF PI-COMPANY-ID = 'CID'
  7155*       IF (CP-STATE-STD-ABBRV = 'MN')
  7156*          AND (CM-CERT-EFF-DT > X'A4FF')
  7157*          AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7158*          MOVE '5'              TO CP-EARNING-METHOD
  7159*       END-IF
  7160*    END-IF
  7161     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7162     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7163     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  7164     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 130
* EL1278.cbl
  7165     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7166     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7167
  7168*    IF CP-EARN-AS-NET-PAY
  7169*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7170*           IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7171*               MOVE WS-CF-DEFAULT-APR
  7172*                                TO  CP-LOAN-APR
  7173*               MOVE ER-3780     TO  EMI-ERROR
  7174*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7175*           ELSE
  7176*               MOVE ER-3781     TO  EMI-ERROR
  7177*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7178
  7179*    DISPLAY ' 1278 REM AMT      ' CP-REMAINING-BENEFIT
  7180*    DISPLAY ' 1278 REM TRM      ' CP-REMAINING-TERM
  7181*    DISPLAY ' 1278 EARN METH    ' CP-EARNING-METHOD
  7182*    DISPLAY ' 1278 RATE METH    ' CP-RATING-METHOD
  7183*    DISPLAY ' 1278 CLASS        ' CP-CLASS-CODE
  7184*    DISPLAY ' 1278 BENE CODE    ' CP-BENEFIT-CD
  7185*    DISPLAY ' 1278 ORIG BENE    ' CP-ORIGINAL-BENEFIT
  7186*    DISPLAY ' 1278 RATE BENE    ' CP-RATING-BENEFIT-AMT
  7187*    DISPLAY ' 1278 ORIG PREM    ' CP-ORIGINAL-PREMIUM
  7188*    DISPLAY ' 1278 ISS AGE      ' CP-ISSUE-AGE
  7189*    DISPLAY ' 1278 DEV CODE     ' CP-DEVIATION-CODE
  7190*    DISPLAY ' 1278 DEV PCT      ' CP-RATE-DEV-PCT
  7191*    DISPLAY ' 1278 APR          ' CP-LOAN-APR
  7192*    DISPLAY ' 1278 EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  7193*    DISPLAY ' 1278 LOAN TERM    ' CP-LOAN-TERM
  7194*    DISPLAY ' 1278 SPEC CALC    ' CP-SPECIAL-CALC-CD
  7195*    DISPLAY ' 1278 ST STD ABB   ' CP-STATE-STD-ABBRV
  7196     MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  7197     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7198
  7199     MOVE 'L'                    TO  WS-REFUND-SEARCH-SW.
  7200
  7201     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7202
  7203     IF CP-ERROR-RATE-IS-ZERO
  7204       OR CP-ERROR-RATE-NOT-FOUND
  7205         MOVE ER-2740            TO  EMI-ERROR
  7206         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7207
  7208     IF CP-ERROR-RATE-FILE-NOTOPEN
  7209         MOVE ER-2617            TO  EMI-ERROR
  7210         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7211
  7212     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7213     MOVE CP-CALC-REFUND         TO  HLREFNDO  WS-CALC-REFUND
  7214                                     WS-TOT-LF-RFND
  7215                                     PI-LF-REFUND-AMT.
  7216     MOVE CP-REMAINING-AMT       TO  HLREDO.
  7217
  7218     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7219
  7220     IF WS-LF-CO-EARNINGS-CALC  IS NOT EQUAL TO  'B'
  7221         GO TO 0640-AH-BENEFIT.
  7222
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 131
* EL1278.cbl
  7223*    IF WS-LF-SPECIAL-CALC-CD = 'L'
  7224*        ADD +1                  TO  CP-REMAINING-TERM
  7225*                                    CP-ORIGINAL-TERM.
  7226
  7227     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  7228     MOVE '2'                    TO  CP-EARNING-METHOD
  7229                                     CP-RATING-METHOD.
  7230     IF PI-COMPANY-ID = 'CID'
  7231        IF (CP-STATE-STD-ABBRV = 'MN')
  7232           AND (CM-CERT-EFF-DT > X'A4FF')
  7233           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7234           MOVE '5'              TO CP-EARNING-METHOD
  7235           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  7236        END-IF
  7237     END-IF
  7238     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  7239                                     CP-REMAINING-BENEFIT
  7240                                     CP-RATING-BENEFIT-AMT.
  7241     IF CP-STATE-STD-ABBRV = 'OR'
  7242         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7243                                         CM-LF-ALT-BENEFIT-AMT.
  7244     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  7245     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  7246
  7247     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7248
  7249     IF CP-ERROR-RATE-IS-ZERO
  7250       OR CP-ERROR-RATE-NOT-FOUND
  7251         MOVE ER-2740            TO  EMI-ERROR
  7252         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7253
  7254     IF CP-ERROR-RATE-FILE-NOTOPEN
  7255         MOVE ER-2617            TO  EMI-ERROR
  7256         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7257
  7258     ADD CP-CALC-REFUND          TO  WS-CALC-REFUND.
  7259
  7260     MOVE WS-CALC-REFUND         TO  HLREFNDO
  7261                                     WS-TOT-LF-RFND
  7262                                     PI-LF-REFUND-AMT.
  7263
  7264     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7265
  7266 0640-AH-BENEFIT.
  7267     IF CM-AH-BENEFIT-CD = '00'
  7268         GO TO 0680-CONTINUE.
  7269
  7270 0650-GET-AH-BENEFIT.
  7271     IF ACCT-FOUND
  7272         MOVE +1                 TO SUB3
  7273         PERFORM 6000-GET-AH-AM-REM-TERM THRU 6900-EXIT.
  7274     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7275     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7276     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7277     MOVE WS-AH-KIND             TO  HAEDESCO.
  7278     EVALUATE TRUE
  7279        WHEN ((OPEN-LF-CLAIM)
  7280           OR (CLOSED-LF-CLAIM))
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 132
* EL1278.cbl
  7281           AND (WS-AH-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7282           MOVE ZEROS            TO HAREFNDO  WS-CALC-REFUND
  7283                                    WS-TOT-AH-RFND
  7284                                    PI-AH-REFUND-AMT
  7285           MOVE SPACES           TO PI-AH-REFUND-METH
  7286           MOVE ER-2965          TO EMI-ERROR
  7287           PERFORM 9700-ERROR-FORMAT
  7288                                 THRU  9799-EXIT
  7289           GO TO 0680-CONTINUE
  7290        WHEN (CM-LF-BENEFIT-CD NOT = '00')
  7291           AND ((OPEN-LF-CLAIM) OR (CLOSED-LF-CLAIM))
  7292           AND (EMI-ERROR = ER-2965)
  7293           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7294           MOVE ZEROS            TO HAREFNDO
  7295                                    WS-TOT-AH-RFND
  7296                                    PI-AH-REFUND-AMT
  7297           MOVE SPACES           TO PI-AH-REFUND-METH
  7298           GO TO 0680-CONTINUE
  7299        WHEN (OPEN-AH-CLAIM)
  7300           AND (WS-ST-REF-IND = '1')
  7301           MOVE ZEROS            TO HAREFNDO
  7302                                    WS-TOT-AH-RFND
  7303                                    PI-AH-REFUND-AMT
  7304           MOVE ER-3039          TO EMI-ERROR
  7305           PERFORM 9700-ERROR-FORMAT
  7306                                 THRU  9799-EXIT
  7307           GO TO 0680-CONTINUE
  7308        WHEN (OPEN-AH-CLAIM)
  7309           AND (WS-ST-REF-IND = '2' OR '3' OR '4')
  7310           MOVE ER-3037          TO EMI-ERROR
  7311           PERFORM 9700-ERROR-FORMAT
  7312                                 THRU  9799-EXIT
  7313*          CONTINUE
  7314        WHEN (OPEN-AH-CLAIM)
  7315           AND (WS-ST-REF-IND = '5')
  7316           MOVE ER-3038          TO EMI-ERROR
  7317           PERFORM 9700-ERROR-FORMAT
  7318                                 THRU  9799-EXIT
  7319*          CONTINUE
  7320        WHEN (OPEN-AH-CLAIM)
  7321           AND (WS-ST-REF-IND = ' ')
  7322           MOVE ER-2768          TO EMI-ERROR
  7323           PERFORM 9700-ERROR-FORMAT
  7324                                 THRU  9799-EXIT
  7325        WHEN (CLOSED-AH-CLAIM)
  7326           AND (WS-AH-CANCEL-DATE <= WS-AH-PAID-THRU-DT)
  7327           MOVE ZEROS            TO HAREFNDO
  7328                                    WS-TOT-AH-RFND
  7329                                    PI-AH-REFUND-AMT
  7330           MOVE ER-2756          TO EMI-ERROR
  7331           PERFORM 9700-ERROR-FORMAT
  7332                                 THRU  9799-EXIT
  7333           IF WS-TOT-LF-RFND > 0
  7334              MOVE ZEROS         TO HLREFNDO
  7335                                    WS-TOT-LF-RFND
  7336                                    PI-LF-REFUND-AMT
  7337              MOVE SPACES        TO PI-LF-REFUND-METH
  7338           END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 133
* EL1278.cbl
  7339           GO TO 0680-CONTINUE
  7340*       WHEN OTHER
  7341*          CONTINUE
  7342     END-EVALUATE
  7343     .
  7344 0660-GET-REM-TERM.
  7345     MOVE WS-CF-AH-OVERRIDE-L1   TO  CP-AH-OVERRIDE-CODE.
  7346     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  7347     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  7348     MOVE WS-AH-CANCEL-DATE      TO  CP-VALUATION-DT.
  7349     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7350*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  7351     MOVE WS-AH-KIND             TO  HAEDESCO.
  7352     MOVE CM-STATE               TO  CP-STATE.
  7353     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  7354     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  7355     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  7356     MOVE '2'                    TO  CP-PROCESS-TYPE.
  7357     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  7358     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  7359     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  7360     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  7361     MOVE WS-CF-CR-REM-TERM-CALC
  7362                                 TO  CP-REM-TERM-METHOD.
  7363
  7364     IF WS-AH-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  7365         MOVE WS-AH-CO-REM-TERM-CALC
  7366                                 TO  CP-REM-TERM-METHOD.
  7367
  7368     IF WS-AH-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  7369         MOVE WS-AH-ST-REM-TERM-CALC
  7370                                 TO  CP-REM-TERM-METHOD.
  7371
  7372     IF WS-AH-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  7373         MOVE WS-AH-AM-REM-TERM-CALC
  7374                                 TO  CP-REM-TERM-METHOD.
  7375     IF (PI-COMPANY-ID = 'CID')
  7376        AND (CP-STATE-STD-ABBRV = 'WI')
  7377        MOVE '7'                 TO CP-REM-TERM-METHOD
  7378        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7379     END-IF
  7380     IF (PI-COMPANY-ID = 'CID')
  7381        AND (CP-STATE-STD-ABBRV = 'MO')
  7382        AND (CM-CERT-EFF-DT >= X'9B41')
  7383        AND (CM-CERT-EFF-DT <= X'A2FB')
  7384        MOVE '7'                 TO CP-REM-TERM-METHOD
  7385        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7386     END-IF
  7387
  7388     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7389                                     CP-ORIGINAL-TERM
  7390                                     CP-LOAN-TERM.
  7391
  7392     IF  NOT  CP-TERM-IS-DAYS
  7393         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7394             MOVE CM-PMT-EXTENSION-DAYS
  7395                                 TO  CP-TERM-OR-EXT-DAYS
  7396         ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 134
* EL1278.cbl
  7397             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7398
  7399*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7400     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7401     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7402     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7403     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  7404
  7405
  7406* EXEC CICS READ
  7407*        DATASET  (ELCNTL-ID)
  7408*        SET      (ADDRESS OF CONTROL-FILE)
  7409*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7410*        RESP     (WS-RESPONSE)
  7411*    END-EXEC.
  7412*    MOVE '&"S        E          (  N#00007246' TO DFHEIV0
  7413     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7414     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7415     MOVE X'204E233030303037323436' TO DFHEIV0(25:11)
  7416     CALL 'kxdfhei1' USING DFHEIV0,
  7417           ELCNTL-ID,
  7418           DFHEIV20,
  7419           DFHEIV99,
  7420           WS-CF-CONTROL-PRIMARY,
  7421           DFHEIV99,
  7422           DFHEIV99,
  7423           DFHEIV99
  7424     SET ADDRESS OF CONTROL-FILE TO
  7425         DFHEIV20
  7426     MOVE EIBRESP  TO WS-RESPONSE
  7427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7428
  7429
  7430     IF WS-RESP-NOTOPEN
  7431         MOVE ER-2617            TO  EMI-ERROR
  7432         GO TO 0320-INPUT-ERROR.
  7433
  7434     IF WS-RESP-NOTFND
  7435         MOVE ZERO               TO CP-FREE-LOOK
  7436     ELSE
  7437         MOVE CF-ST-FREE-LOOK-PERIOD
  7438                                 TO CP-FREE-LOOK.
  7439
  7440     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7441
  7442     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7443
  7444     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '8'
  7445         IF CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7446             MOVE ER-0683        TO  EMI-ERROR
  7447             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7448
  7449     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '6'  OR  '7'
  7450         IF CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES
  7451             MOVE ER-0684        TO  EMI-ERROR
  7452             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7453
  7454 0670-CONTINUE-AH.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 135
* EL1278.cbl
  7455     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7456                                     WS-TOT-AH-PREM.
  7457     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7458
  7459     IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-AH-ORIG-TERM
  7460         MOVE CM-AH-ORIG-TERM    TO  HAREMO.
  7461
  7462     IF PI-AH-CANCEL-DATE = LOW-VALUES
  7463        GO TO 0680-CONTINUE.
  7464     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM.
  7465     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7466     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7467
  7468     IF WS-AH-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7469         MOVE WS-AH-ST-REFUND-CALC
  7470                                 TO  CP-EARNING-METHOD.
  7471
  7472     IF WS-AH-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7473         MOVE WS-AH-FO-REFUND-CALC
  7474                                 TO  CP-EARNING-METHOD.
  7475
  7476*    IF WS-AM-EARN-METHOD-A  IS GREATER THAN  ZERO
  7477*        MOVE WS-AM-EARN-METHOD-A
  7478*                                TO  CP-EARNING-METHOD.
  7479
  7480     if pi-company-id = 'AHL'
  7481        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
  7482        if cp-class-code = spaces
  7483           move zeros            to cp-class-code
  7484        end-if
  7485     ELSE
  7486        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7487     END-IF
  7488     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7489     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7490                                     CP-RATING-BENEFIT-AMT.
  7491     IF CP-STATE-STD-ABBRV = 'OR'
  7492         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  7493                                         CM-AH-ORIG-TERM.
  7494     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7495     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  7496     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7497     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  7498     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  7499     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  7500
  7501     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7502     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  7503     MOVE ' '                    TO  DC-OPTION-CODE.
  7504
  7505     PERFORM 9600-DATE-LINK.
  7506
  7507     IF CP-STATE-STD-ABBRV = 'OH'
  7508        IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7509         IF (CP-ORIGINAL-TERM  IS GREATER THAN  60)
  7510           AND (DC-GREG-DATE-1-YMD  IS GREATER THAN  '831101')
  7511           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  7512             MOVE '6'            TO  CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 136
* EL1278.cbl
  7513         END-IF
  7514        END-IF
  7515        IF PI-COMPANY-ID = 'CID'
  7516           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  7517                           LOW-VALUES)
  7518              IF CP-CRITICAL-PERIOD
  7519                 MOVE '2'       TO CP-EARNING-METHOD
  7520              ELSE
  7521                 MOVE '6'       TO CP-EARNING-METHOD
  7522              END-IF
  7523           ELSE
  7524              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  7525                 MOVE '2'       TO CP-EARNING-METHOD
  7526              ELSE
  7527                 IF ((CM-LF-ORIG-TERM > 60) AND
  7528                    (CM-RATE-CLASS NOT = 'L '))
  7529                               OR
  7530                    (WS-LF-CO-EARNINGS-CALC = '5')
  7531                    IF CP-CRITICAL-PERIOD
  7532                       MOVE '2'  TO CP-EARNING-METHOD
  7533                    ELSE
  7534                       MOVE '6'  TO CP-EARNING-METHOD
  7535                    END-IF
  7536                 ELSE
  7537                    MOVE '1'     TO CP-EARNING-METHOD
  7538                 END-IF
  7539              END-IF
  7540           END-IF
  7541        END-IF
  7542     END-IF
  7543
  7544     IF CP-STATE-STD-ABBRV = 'VA'
  7545       IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7546         IF DC-GREG-DATE-1-YMD  IS GREATER THAN  '921231'
  7547            IF CP-ORIGINAL-TERM  IS GREATER THAN  61
  7548                MOVE '6'            TO  CP-EARNING-METHOD
  7549            ELSE
  7550                MOVE '1'            TO  CP-EARNING-METHOD.
  7551
  7552     IF CP-EARN-AS-NET-PAY
  7553         IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7554            IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7555                MOVE WS-CF-DEFAULT-APR
  7556                                 TO  CP-LOAN-APR
  7557                MOVE ER-3780     TO  EMI-ERROR
  7558                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7559            ELSE
  7560                MOVE ER-3781     TO  EMI-ERROR
  7561                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7562     IF PI-COMPANY-ID = 'DCC'
  7563        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  7564           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  7565           MOVE 'S'              TO CP-EARNING-METHOD
  7566        END-IF
  7567     END-IF
  7568     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7569     IF (PI-COMPANY-ID = 'DCC')
  7570        AND (CP-EARNING-METHOD = 'D')
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 137
* EL1278.cbl
  7571        MOVE +0                  TO WS-DDF-ADMIN-FEES
  7572                                    WS-DDF-CSO-ADMIN-FEE
  7573                                    WS-DDF-1ST-YR-TOT-EXP
  7574                                    WS-DDF-COMM-AND-MFEE
  7575        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  7576           S1 > +10
  7577           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  7578              IF (AM-A-COM (S1) NUMERIC)
  7579                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  7580                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  7581              ELSE
  7582                 MOVE +0         TO WS-COMM-PCT C0
  7583                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  7584                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  7585              END-IF
  7586              IF AM-COM-TYP (S1) = 'L' OR 'N'
  7587                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  7588                    + WS-COMM-PCT
  7589              END-IF
  7590              IF AM-COM-TYP (S1) = 'N'
  7591                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  7592                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  7593              END-IF
  7594              IF AM-COM-TYP (S1) = 'J' OR 'L'
  7595                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  7596                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  7597              END-IF
  7598              IF AM-COM-TYP (S1) = 'I'
  7599                 COMPUTE WS-DDF-COMM-AND-MFEE
  7600                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  7601              END-IF
  7602           END-IF
  7603        END-PERFORM
  7604        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  7605        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  7606        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  7607           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  7608     END-IF
  7609     IF (PI-COMPANY-ID = 'DCC')
  7610        AND (CP-EARNING-METHOD = 'D')
  7611        AND (PI-CANCEL-REASON NOT = 'R')
  7612        PERFORM 0730-GET-DDF-FACTORS
  7613                                 THRU 0730-EXIT
  7614        IF NOT PDEF-FOUND
  7615           MOVE ER-9999          TO EMI-ERROR
  7616           PERFORM 9700-ERROR-FORMAT
  7617                                 THRU 9799-EXIT
  7618           GO TO 8200-SEND-DATAONLY
  7619        END-IF
  7620        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  7621                                 TO CP-DDF-LO-FACT
  7622        MOVE PD-UEP-FACTOR (P1 P2)
  7623                                 TO CP-DDF-HI-FACT
  7624        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  7625        MOVE CM-AH-CLP           TO CP-DDF-CLP
  7626        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  7627        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  7628           + PD-1ST-YR-ADMIN-ALLOW
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 138
* EL1278.cbl
  7629        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  7630        IF PI-CLP-YN = 'Y'
  7631           MOVE 'C'              TO CP-DDF-SPEC-CALC
  7632           MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  7633                                    CP-DDF-CLP
  7634           MOVE ZEROS            TO CP-1ST-YR-ALLOW
  7635        END-IF
  7636        IF DD-IU-PRESENT
  7637           MOVE 'I'              TO CP-EARNING-METHOD
  7638        END-IF
  7639        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  7640                                    CP-CLP-RATE-UP
  7641        IF (CP-CALC-GROSS-FEE)
  7642           AND (CP-IU-RATE-UP NOT = ZEROS)
  7643           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  7644              / CP-ORIGINAL-PREMIUM)
  7645           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  7646              / (1 - TEX-FACT-8)
  7647        END-IF
  7648     END-IF
  7649     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT
  7650
  7651     MOVE ' '                    TO  WS-REFUND-SEARCH-SW.
  7652
  7653     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7654
  7655     IF CP-ERROR-RATE-IS-ZERO
  7656       OR CP-ERROR-RATE-NOT-FOUND
  7657         MOVE ER-2740            TO  EMI-ERROR
  7658         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7659
  7660     IF CP-ERROR-RATE-FILE-NOTOPEN
  7661         MOVE ER-2617            TO  EMI-ERROR
  7662         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7663
  7664     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7665     MOVE CP-CALC-REFUND         TO  HAREFNDO  WS-CALC-REFUND
  7666                                     WS-TOT-AH-RFND
  7667                                     PI-AH-REFUND-AMT.
  7668
  7669     MOVE CP-REFUND-TYPE-USED    TO  PI-AH-REFUND-METH.
  7670
  7671     MOVE AL-UANON               TO  HACANCA.
  7672
  7673 0680-CONTINUE.
  7674     IF BROWSE-STARTED
  7675         PERFORM 1500-END-BROWSE  THRU  1599-EXIT
  7676         MOVE SPACES             TO  WS-BROWSE-STARTED-SW.
  7677
  7678     IF CM-LF-BENEFIT-CD = '00'
  7679         MOVE -1                 TO  HACANCL
  7680     ELSE
  7681         MOVE -1                 TO  HLCANCL.
  7682
  7683     ADD WS-TOT-LF-PREM    WS-TOT-AH-PREM GIVING
  7684                           WS-TOT-PREM.
  7685     ADD WS-TOT-LF-RFND    WS-TOT-AH-RFND GIVING
  7686                           WS-TOT-RFND.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 139
* EL1278.cbl
  7687
  7688     MOVE WS-TOT-PREM            TO  TOPREMO.
  7689     MOVE WS-TOT-RFND            TO  TORFNDO.
  7690
  7691 0680-EXIT.
  7692     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 140
* EL1278.cbl
  7694 0700-LINK-REM-TERM SECTION.
  7695
  7696* EXEC CICS LINK
  7697*        PROGRAM   (ELRTRM-ID)
  7698*        COMMAREA  (CALCULATION-PASS-AREA)
  7699*        LENGTH    (CP-COMM-LENGTH)
  7700*    END-EXEC.
  7701*    MOVE '."C                   (   #00007518' TO DFHEIV0
  7702     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7703     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7704     MOVE X'2020233030303037353138' TO DFHEIV0(25:11)
  7705     CALL 'kxdfhei1' USING DFHEIV0,
  7706           ELRTRM-ID,
  7707           CALCULATION-PASS-AREA,
  7708           CP-COMM-LENGTH,
  7709           DFHEIV99,
  7710           DFHEIV99,
  7711           DFHEIV99,
  7712           DFHEIV99
  7713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7714
  7715
  7716 0700-EXIT.
  7717     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 141
* EL1278.cbl
  7719 0710-LINK-REM-AMOUNT SECTION.
  7720
  7721* EXEC CICS LINK
  7722*        PROGRAM   (ELRAMT-ID)
  7723*        COMMAREA  (CALCULATION-PASS-AREA)
  7724*        LENGTH    (CP-COMM-LENGTH)
  7725*    END-EXEC.
  7726*    MOVE '."C                   (   #00007528' TO DFHEIV0
  7727     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7728     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7729     MOVE X'2020233030303037353238' TO DFHEIV0(25:11)
  7730     CALL 'kxdfhei1' USING DFHEIV0,
  7731           ELRAMT-ID,
  7732           CALCULATION-PASS-AREA,
  7733           CP-COMM-LENGTH,
  7734           DFHEIV99,
  7735           DFHEIV99,
  7736           DFHEIV99,
  7737           DFHEIV99
  7738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7739
  7740
  7741 0710-EXIT.
  7742     EXIT.
  7743 0730-GET-DDF-FACTORS.
  7744     MOVE ' '                    TO WS-PDEF-RECORD-SW
  7745     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  7746     MOVE CM-STATE               TO ERPDEF-STATE
  7747     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  7748     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  7749     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  7750     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  7751     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  7752
  7753* EXEC CICS STARTBR
  7754*        DATASET  ('ERPDEF')
  7755*        RIDFLD   (ERPDEF-KEY)
  7756*        GTEQ
  7757*        RESP     (WS-RESPONSE)
  7758*    END-EXEC
  7759     MOVE 'ERPDEF' TO DFHEIV1
  7760     MOVE 0
  7761       TO DFHEIV11
  7762*    MOVE '&,         G          &  N#00007545' TO DFHEIV0
  7763     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7764     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7765     MOVE X'204E233030303037353435' TO DFHEIV0(25:11)
  7766     CALL 'kxdfhei1' USING DFHEIV0,
  7767           DFHEIV1,
  7768           ERPDEF-KEY,
  7769           DFHEIV99,
  7770           DFHEIV11,
  7771           DFHEIV99
  7772     MOVE EIBRESP  TO WS-RESPONSE
  7773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7774     IF NOT WS-RESP-NORMAL
  7775        GO TO 0730-EXIT
  7776     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 142
* EL1278.cbl
  7777     .
  7778 0730-READNEXT.
  7779
  7780* EXEC CICS READNEXT
  7781*       DATASET  ('ERPDEF')
  7782*       SET      (ADDRESS OF PRODUCT-MASTER)
  7783*       RIDFLD   (ERPDEF-KEY)
  7784*       RESP     (WS-RESPONSE)
  7785*    END-EXEC
  7786     MOVE 'ERPDEF' TO DFHEIV1
  7787     MOVE 0
  7788       TO DFHEIV11
  7789*    MOVE '&.S                   )  N#00007556' TO DFHEIV0
  7790     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7791     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7792     MOVE X'204E233030303037353536' TO DFHEIV0(25:11)
  7793     CALL 'kxdfhei1' USING DFHEIV0,
  7794           DFHEIV1,
  7795           DFHEIV20,
  7796           DFHEIV99,
  7797           ERPDEF-KEY,
  7798           DFHEIV99,
  7799           DFHEIV11,
  7800           DFHEIV99,
  7801           DFHEIV99
  7802     SET ADDRESS OF PRODUCT-MASTER TO
  7803         DFHEIV20
  7804     MOVE EIBRESP  TO WS-RESPONSE
  7805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7806     IF NOT WS-RESP-NORMAL
  7807        GO TO 0730-ENDBR
  7808     END-IF
  7809     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  7810        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  7811           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  7812        ELSE
  7813           GO TO 0730-READNEXT
  7814        END-IF
  7815     ELSE
  7816        GO TO 0730-ENDBR
  7817     END-IF
  7818     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7819        (P1 > +8)
  7820        OR (PD-PROD-CODE (P1) = 'I')
  7821     END-PERFORM
  7822     IF P1 < +9
  7823        SET DD-IU-PRESENT        TO TRUE
  7824     END-IF
  7825     IF CM-LOAN-TERM = ZEROS
  7826        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  7827     END-IF
  7828     IF PD-TRUNCATED = 'Y'
  7829        MOVE CM-LOAN-TERM        TO WS-TERM
  7830     ELSE
  7831        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  7832     END-IF
  7833     EVALUATE TRUE
  7834        WHEN WS-TERM > +168
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 143
* EL1278.cbl
  7835           MOVE 15               TO P1
  7836        WHEN WS-TERM > +156
  7837           MOVE 14               TO P1
  7838        WHEN WS-TERM > +144
  7839           MOVE 13               TO P1
  7840        WHEN WS-TERM > +132
  7841           MOVE 12               TO P1
  7842        WHEN WS-TERM > +120
  7843           MOVE 11               TO P1
  7844        WHEN WS-TERM > +108
  7845           MOVE 10               TO P1
  7846        WHEN WS-TERM > +96
  7847           MOVE 9                TO P1
  7848        WHEN WS-TERM > +84
  7849           MOVE 8                TO P1
  7850        WHEN WS-TERM > +72
  7851           MOVE 7                TO P1
  7852        WHEN WS-TERM > +60
  7853           MOVE 6                TO P1
  7854        WHEN WS-TERM > +48
  7855           MOVE 5                TO P1
  7856        WHEN WS-TERM > +36
  7857           MOVE 4                TO P1
  7858        WHEN WS-TERM > +24
  7859           MOVE 3                TO P1
  7860        WHEN WS-TERM > +12
  7861           MOVE 2                TO P1
  7862        WHEN OTHER
  7863           MOVE 1                TO P1
  7864     END-EVALUATE
  7865     EVALUATE TRUE
  7866*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  7867*          AND (DD-IU-PRESENT)
  7868*          MOVE 2                TO P2
  7869*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  7870*          MOVE 1                TO P2
  7871        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  7872           MOVE 2                TO P2
  7873        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  7874           MOVE 3                TO P2
  7875        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  7876           MOVE 4                TO P2
  7877        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  7878           MOVE 5                TO P2
  7879        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  7880           MOVE 6                TO P2
  7881        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  7882           MOVE 7                TO P2
  7883        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  7884           MOVE 8                TO P2
  7885        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  7886           MOVE 9                TO P2
  7887        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  7888           MOVE 10               TO P2
  7889        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  7890           MOVE 11               TO P2
  7891        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  7892           MOVE 12               TO P2
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 144
* EL1278.cbl
  7893        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  7894           MOVE 13               TO P2
  7895        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  7896           MOVE 14               TO P2
  7897        WHEN OTHER
  7898           MOVE 15               TO P2
  7899     END-EVALUATE
  7900     .
  7901 0730-ENDBR.
  7902
  7903* EXEC CICS ENDBR
  7904*       DATASET  ('ERPDEF')
  7905*    END-EXEC
  7906     MOVE 'ERPDEF' TO DFHEIV1
  7907     MOVE 0
  7908       TO DFHEIV11
  7909*    MOVE '&2                    $   #00007658' TO DFHEIV0
  7910     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7911     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7912     MOVE X'2020233030303037363538' TO DFHEIV0(25:11)
  7913     CALL 'kxdfhei1' USING DFHEIV0,
  7914           DFHEIV1,
  7915           DFHEIV11,
  7916           DFHEIV99
  7917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7918     .
  7919 0730-EXIT.
  7920     EXIT.
  7921 0740-GET-ERCTBL.
  7922     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7923     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7924     MOVE 'A'                    TO CTBL-BEN-TYPE
  7925     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  7926     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7927     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7928     IF WS-RESP-NORMAL
  7929        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7930     ELSE
  7931        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7932        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7933        MOVE 'A'                    TO CTBL-BEN-TYPE
  7934        MOVE 'AA'                   TO CTBL-BEN-CODE
  7935        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7936        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7937        IF WS-RESP-NORMAL
  7938           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7939        END-IF
  7940     END-IF
  7941     .
  7942 0740-EXIT.
  7943     EXIT.
  7944 0750-READ-ERCTBL.
  7945
  7946* EXEC CICS READ
  7947*         INTO    (COMM-TABLE-RECORD)
  7948*         DATASET ('ERCTBL')
  7949*         RIDFLD  (CTBL-KEY)
  7950*         RESP    (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 145
* EL1278.cbl
  7951*    END-EXEC
  7952     MOVE LENGTH OF
  7953      COMM-TABLE-RECORD
  7954       TO DFHEIV11
  7955     MOVE 'ERCTBL' TO DFHEIV1
  7956*    MOVE '&"IL       E          (  N#00007688' TO DFHEIV0
  7957     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7958     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7959     MOVE X'204E233030303037363838' TO DFHEIV0(25:11)
  7960     CALL 'kxdfhei1' USING DFHEIV0,
  7961           DFHEIV1,
  7962           COMM-TABLE-RECORD,
  7963           DFHEIV11,
  7964           CTBL-KEY,
  7965           DFHEIV99,
  7966           DFHEIV99,
  7967           DFHEIV99
  7968     MOVE EIBRESP  TO WS-RESPONSE
  7969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7970     .
  7971 0750-EXIT.
  7972     EXIT.
  7973 0760-FIND-COMM.
  7974     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  7975        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  7976        OR (C1 > +3)
  7977     END-PERFORM
  7978     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  7979        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  7980        OR (C2 > +3)
  7981     END-PERFORM
  7982     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  7983        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  7984        OR (C3 > +3)
  7985     END-PERFORM
  7986     IF C1 > +3
  7987        MOVE +1                  TO C1
  7988     END-IF
  7989     IF C2 > +3
  7990        MOVE +1                  TO C2
  7991     END-IF
  7992     IF C3 > +3
  7993        MOVE +1                  TO C3
  7994     END-IF
  7995     IF C1 = +3
  7996        MOVE +18                 TO C0
  7997     ELSE
  7998        IF C1 = +2
  7999           MOVE +9               TO C0
  8000        END-IF
  8001     END-IF
  8002     IF C2 = +3
  8003        ADD +6                   TO C0
  8004     ELSE
  8005        IF C2 = +2
  8006           ADD +3                TO C0
  8007        END-IF
  8008     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 146
* EL1278.cbl
  8009     ADD C3                      TO C0
  8010     MOVE CT-RT (C0)             TO WS-COMM-PCT
  8011     .
  8012 0760-EXIT.
  8013     EXIT.
  8014 0800-LINK-REFUND SECTION.
  8015     IF CP-AH
  8016       IF PI-EARNING-METHOD-AH NOT = SPACES
  8017         MOVE PI-EARNING-METHOD-AH   TO CP-EARNING-METHOD
  8018        ELSE
  8019         NEXT SENTENCE
  8020      ELSE
  8021       IF PI-EARNING-METHOD-LF NOT = SPACES
  8022         MOVE PI-EARNING-METHOD-LF   TO CP-EARNING-METHOD.
  8023
  8024
  8025* EXEC CICS LINK
  8026*        PROGRAM   (ELRFND-ID)
  8027*        COMMAREA  (CALCULATION-PASS-AREA)
  8028*        LENGTH    (CP-COMM-LENGTH)
  8029*    END-EXEC.
  8030*    MOVE '."C                   (   #00007748' TO DFHEIV0
  8031     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8032     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8033     MOVE X'2020233030303037373438' TO DFHEIV0(25:11)
  8034     CALL 'kxdfhei1' USING DFHEIV0,
  8035           ELRFND-ID,
  8036           CALCULATION-PASS-AREA,
  8037           CP-COMM-LENGTH,
  8038           DFHEIV99,
  8039           DFHEIV99,
  8040           DFHEIV99,
  8041           DFHEIV99
  8042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8043
  8044
  8045 0899-EXIT.
  8046     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 147
* EL1278.cbl
  8048 0900-READ-CERT-FILE  SECTION.
  8049
  8050* EXEC CICS HANDLE CONDITION
  8051*        NOTFND  (0910-NOT-FOUND)
  8052*    END-EXEC.
  8053*    MOVE '"$I                   ! # #00007758' TO DFHEIV0
  8054     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8055     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8056     MOVE X'2320233030303037373538' TO DFHEIV0(25:11)
  8057     CALL 'kxdfhei1' USING DFHEIV0
  8058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8059
  8060
  8061
  8062* EXEC CICS READ
  8063*        DATASET  (ELCERT-ID)
  8064*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8065*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8066*    END-EXEC.
  8067*    MOVE '&"S        E          (   #00007762' TO DFHEIV0
  8068     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8069     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8070     MOVE X'2020233030303037373632' TO DFHEIV0(25:11)
  8071     CALL 'kxdfhei1' USING DFHEIV0,
  8072           ELCERT-ID,
  8073           DFHEIV20,
  8074           DFHEIV99,
  8075           WS-CM-CONTROL-PRIMARY,
  8076           DFHEIV99,
  8077           DFHEIV99,
  8078           DFHEIV99
  8079     SET ADDRESS OF CERTIFICATE-MASTER TO
  8080         DFHEIV20
  8081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8082
  8083
  8084*    SERVICE RELOAD CERTIFICATE-MASTER.
  8085
  8086     GO TO 0999-EXIT.
  8087
  8088 0910-NOT-FOUND.
  8089     MOVE 'N'                    TO  WS-CERT-RECORD-SW.
  8090
  8091 0999-EXIT.
  8092     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 148
* EL1278.cbl
  8094 1000-READ-CONTROL  SECTION.
  8095
  8096* EXEC CICS HANDLE CONDITION
  8097*        NOTFND   (1010-NOTFND)
  8098*        NOTOPEN  (1020-NOTOPEN)
  8099*    END-EXEC.
  8100*    MOVE '"$IJ                  ! $ #00007779' TO DFHEIV0
  8101     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8102     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8103     MOVE X'2420233030303037373739' TO DFHEIV0(25:11)
  8104     CALL 'kxdfhei1' USING DFHEIV0
  8105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8106
  8107
  8108
  8109* EXEC CICS READ
  8110*        DATASET  (ELCNTL-ID)
  8111*        SET      (ADDRESS OF CONTROL-FILE)
  8112*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8113*        GTEQ
  8114*    END-EXEC.
  8115*    MOVE '&"S        G          (   #00007784' TO DFHEIV0
  8116     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8117     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8118     MOVE X'2020233030303037373834' TO DFHEIV0(25:11)
  8119     CALL 'kxdfhei1' USING DFHEIV0,
  8120           ELCNTL-ID,
  8121           DFHEIV20,
  8122           DFHEIV99,
  8123           WS-CF-CONTROL-PRIMARY,
  8124           DFHEIV99,
  8125           DFHEIV99,
  8126           DFHEIV99
  8127     SET ADDRESS OF CONTROL-FILE TO
  8128         DFHEIV20
  8129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8130
  8131
  8132*    SERVICE RELOAD CONTROL-FILE.
  8133
  8134     GO TO 1099-EXIT.
  8135
  8136 1010-NOTFND.
  8137     MOVE 'N'                    TO  WS-CNTL-RECORD-SW.
  8138
  8139     GO TO 1099-EXIT.
  8140
  8141 1020-NOTOPEN.
  8142     MOVE ER-2617                TO  EMI-ERROR.
  8143
  8144     GO TO 0320-INPUT-ERROR.
  8145
  8146 1099-EXIT.
  8147     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 149
* EL1278.cbl
  8149 1100-FIND-BENEFIT-IN-STATE  SECTION.
  8150     MOVE 'N'                    TO  BEN-SEARCH-SW.
  8151
  8152     PERFORM 1110-BENEFIT-DUMMY  THRU  1119-EXIT
  8153         VARYING  SUB3  FROM  1  BY  1
  8154             UNTIL  ((SUB3  IS GREATER THAN  50)
  8155               OR ((CF-ST-BENEFIT-CD (SUB3)
  8156                      IS EQUAL TO  WS-BEN-CD)
  8157               AND (WS-LOOKUP-TYPE
  8158                      IS EQUAL TO  CF-ST-BENEFIT-KIND (SUB3)))).
  8159
  8160     IF SUB3  IS NOT EQUAL TO  51
  8161         MOVE 'Y'                TO  BEN-SEARCH-SW.
  8162
  8163     GO TO 1199-EXIT.
  8164
  8165 1110-BENEFIT-DUMMY.
  8166
  8167 1119-EXIT.
  8168     EXIT.
  8169
  8170 1199-EXIT.
  8171     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 150
* EL1278.cbl
  8173 1200-START-ACCOUNT-MASTER  SECTION.
  8174
  8175* EXEC CICS HANDLE CONDITION
  8176*        NOTFND   (1290-ACCT-NOT-FOUND)
  8177*        ENDFILE  (1290-ACCT-NOT-FOUND)
  8178*    END-EXEC.
  8179*    MOVE '"$I''                  ! % #00007833' TO DFHEIV0
  8180     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8181     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8182     MOVE X'2520233030303037383333' TO DFHEIV0(25:11)
  8183     CALL 'kxdfhei1' USING DFHEIV0
  8184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8185
  8186
  8187     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8188
  8189
  8190* EXEC CICS STARTBR
  8191*        DATASET  (ERACCT-ID)
  8192*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8193*        GTEQ
  8194*    END-EXEC.
  8195     MOVE 0
  8196       TO DFHEIV11
  8197*    MOVE '&,         G          &   #00007840' TO DFHEIV0
  8198     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8199     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8200     MOVE X'2020233030303037383430' TO DFHEIV0(25:11)
  8201     CALL 'kxdfhei1' USING DFHEIV0,
  8202           ERACCT-ID,
  8203           WS-AM-CONTROL-PRIMARY,
  8204           DFHEIV99,
  8205           DFHEIV11,
  8206           DFHEIV99
  8207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8208
  8209
  8210     MOVE 'Y'                    TO  WS-BROWSE-STARTED-SW.
  8211     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  8212
  8213     GO TO 1299-EXIT.
  8214
  8215 1290-ACCT-NOT-FOUND.
  8216     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8217
  8218 1299-EXIT.
  8219     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 151
* EL1278.cbl
  8221 1300-READ-ACCOUNT-MASTER  SECTION.
  8222
  8223* EXEC CICS HANDLE CONDITION
  8224*        NOTFND   (0580-ACCT-NOT-FOUND)
  8225*        ENDFILE  (0580-ACCT-NOT-FOUND)
  8226*    END-EXEC.
  8227*    MOVE '"$I''                  ! & #00007858' TO DFHEIV0
  8228     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8229     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8230     MOVE X'2620233030303037383538' TO DFHEIV0(25:11)
  8231     CALL 'kxdfhei1' USING DFHEIV0
  8232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8233
  8234
  8235
  8236* EXEC CICS READNEXT
  8237*        DATASET  (ERACCT-ID)
  8238*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8239*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8240*    END-EXEC.
  8241     MOVE 0
  8242       TO DFHEIV11
  8243*    MOVE '&.S                   )   #00007863' TO DFHEIV0
  8244     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8245     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8246     MOVE X'2020233030303037383633' TO DFHEIV0(25:11)
  8247     CALL 'kxdfhei1' USING DFHEIV0,
  8248           ERACCT-ID,
  8249           DFHEIV20,
  8250           DFHEIV99,
  8251           WS-AM-CONTROL-PRIMARY,
  8252           DFHEIV99,
  8253           DFHEIV11,
  8254           DFHEIV99,
  8255           DFHEIV99
  8256     SET ADDRESS OF ACCOUNT-MASTER TO
  8257         DFHEIV20
  8258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8259
  8260
  8261*    SERVICE RELOAD ACCOUNT-MASTER.
  8262
  8263 1399-EXIT.
  8264     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 152
* EL1278.cbl
  8266 1400-GET-REFUND-TYPE  SECTION.
  8267     IF LIFE-REFUND-SEARCH
  8268         NEXT SENTENCE
  8269     ELSE
  8270         GO TO 1410-AH-REFUND-TYPE.
  8271
  8272     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8273         MOVE SPACES             TO  HLCALCO
  8274                                     HLCAL1O
  8275         GO TO 1499-EXIT.
  8276
  8277     MOVE CP-REFUND-TYPE-USED    TO  HLCAL1O.
  8278
  8279     EVALUATE TRUE
  8280        WHEN CP-R-AS-REPOSSESSION
  8281           MOVE 'REPOSSESSION'     TO  HLCALCO
  8282        WHEN CP-R-AS-R78
  8283           MOVE 'RULE 78'          TO  HLCALCO
  8284        WHEN  CP-R-AS-PRORATA
  8285           MOVE 'PRO RATA'         TO  HLCALCO
  8286        WHEN CP-R-AS-CALIF
  8287           MOVE 'CALIF'            TO  HLCALCO
  8288        WHEN CP-R-AS-TEXAS
  8289           MOVE 'IRREG'            TO  HLCALCO
  8290        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  8291           MOVE 'UTAH'             TO  HLCALCO
  8292        WHEN CP-R-AS-FARM-PLAN
  8293           MOVE 'FARM PLAN'        TO  HLCALCO
  8294        WHEN CP-R-AS-NET-PAY
  8295           MOVE 'NET PAY'          TO  HLCALCO
  8296        WHEN CP-R-AS-ANTICIPATION
  8297           MOVE 'ANTICIPATION'     TO  HLCALCO
  8298        WHEN CP-R-AS-MEAN
  8299           MOVE 'MEAN'             TO  HLCALCO
  8300        WHEN CP-R-AS-SUM-OF-DIGITS
  8301           MOVE 'SUM OF DIGIT'     TO  HLCALCO
  8302        WHEN OTHER
  8303           MOVE 'UNDEFINED'        TO  HLCALCO
  8304     END-EVALUATE.
  8305
  8306     GO TO 1499-EXIT.
  8307
  8308 1410-AH-REFUND-TYPE.
  8309     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8310         MOVE SPACES             TO  HACALCO
  8311                                     HACAL1O
  8312         GO TO 1499-EXIT.
  8313
  8314     MOVE CP-REFUND-TYPE-USED    TO  HACAL1O.
  8315
  8316     EVALUATE TRUE
  8317        WHEN CP-R-AS-REPOSSESSION
  8318           MOVE 'REPOSSESSION'     TO HACALCO
  8319        WHEN CP-R-AS-R78
  8320           MOVE 'RULE 78'          TO HACALCO
  8321        WHEN CP-R-AS-PRORATA
  8322           MOVE 'PRO RATA'         TO HACALCO
  8323        WHEN CP-REFUND-TYPE-USED = '3'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 153
* EL1278.cbl
  8324           MOVE 'CALIF'            TO HACALCO
  8325        WHEN CP-R-AS-TEXAS
  8326           MOVE 'IRREG'            TO HACALCO
  8327        WHEN CP-R-AS-FARM-PLAN
  8328           MOVE 'FARM PLAN'        TO HACALCO
  8329        WHEN CP-R-AS-NET-PAY
  8330           MOVE 'NET PAY'          TO HACALCO
  8331        WHEN CP-R-AS-ANTICIPATION
  8332           MOVE 'ANTICIPATION'     TO HACALCO
  8333        WHEN CP-R-AS-MEAN
  8334           MOVE 'MEAN'             TO HACALCO
  8335        WHEN CP-R-AS-SUM-OF-DIGITS
  8336           MOVE 'SUM OF DIGIT'     TO HACALCO
  8337        WHEN CP-GAP-ACTUARIAL
  8338           MOVE 'SP ACTUARIAL'     TO HACALCO
  8339        WHEN CP-R-AS-SPP-DDF
  8340           MOVE 'SPEC DDF'         TO HACALCO
  8341        WHEN CP-R-AS-SPP-DDF-IU
  8342           MOVE 'SPEC DDF IU'      TO HACALCO
  8343        WHEN OTHER
  8344           MOVE 'UNKNOWN'          TO HLCALCO
  8345     END-EVALUATE
  8346     .
  8347 1499-EXIT.
  8348     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 154
* EL1278.cbl
  8350 1500-END-BROWSE  SECTION.
  8351     IF BROWSE-STARTED
  8352
  8353* EXEC CICS ENDBR
  8354*            DATASET  (ERACCT-ID)
  8355*        END-EXEC.
  8356     MOVE 0
  8357       TO DFHEIV11
  8358*    MOVE '&2                    $   #00007960' TO DFHEIV0
  8359     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8360     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8361     MOVE X'2020233030303037393630' TO DFHEIV0(25:11)
  8362     CALL 'kxdfhei1' USING DFHEIV0,
  8363           ERACCT-ID,
  8364           DFHEIV11,
  8365           DFHEIV99
  8366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8367
  8368
  8369 1599-EXIT.
  8370     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 155
* EL1278.cbl
  8372 1600-LOCATE-BENEFIT  SECTION.
  8373
  8374* EXEC CICS HANDLE CONDITION
  8375*        NOTFND  (1699-EXIT)
  8376*    END-EXEC.
  8377*    MOVE '"$I                   ! '' #00007968' TO DFHEIV0
  8378     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8379     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8380     MOVE X'2720233030303037393638' TO DFHEIV0(25:11)
  8381     CALL 'kxdfhei1' USING DFHEIV0
  8382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8383
  8384
  8385     MOVE SPACES                 TO  WS-KIND.
  8386     MOVE ZERO                   TO  WS-NOT-FOUND.
  8387     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  8388     MOVE SPACES                 TO  WS-CF-STATE.
  8389     MOVE WS-BENEFIT-NO          TO  WS-CF-BENEFIT-NO.
  8390
  8391
  8392* EXEC CICS READ
  8393*        DATASET  (ELCNTL-ID)
  8394*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8395*        SET      (ADDRESS OF CONTROL-FILE)
  8396*        GTEQ
  8397*    END-EXEC.
  8398*    MOVE '&"S        G          (   #00007978' TO DFHEIV0
  8399     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8400     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8401     MOVE X'2020233030303037393738' TO DFHEIV0(25:11)
  8402     CALL 'kxdfhei1' USING DFHEIV0,
  8403           ELCNTL-ID,
  8404           DFHEIV20,
  8405           DFHEIV99,
  8406           WS-CF-CONTROL-PRIMARY,
  8407           DFHEIV99,
  8408           DFHEIV99,
  8409           DFHEIV99
  8410     SET ADDRESS OF CONTROL-FILE TO
  8411         DFHEIV20
  8412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8413
  8414
  8415*    SERVICE RELOAD CONTROL-FILE.
  8416
  8417     IF WS-CF-COMPANY-ID  IS NOT EQUAL TO  CF-COMPANY-ID
  8418       OR WS-CF-RECORD-TYPE  IS NOT EQUAL TO  CF-RECORD-TYPE
  8419         GO TO 1699-EXIT.
  8420
  8421     MOVE +1                     TO  WS-INDEX.
  8422
  8423 1610-LOOKUP-BENEFIT.
  8424     IF WS-BENEFIT-NO  IS EQUAL TO  CF-BENEFIT-CODE (WS-INDEX)
  8425         MOVE CF-BENEFIT-ALPHA (WS-INDEX)
  8426                                 TO  WS-KIND
  8427         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  8428                                 TO  WS-CALC-CD
  8429         MOVE CF-BENEFIT-DESCRIP (WS-INDEX)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 156
* EL1278.cbl
  8430                                 TO  WS-BENEFIT-DESCRIP
  8431         MOVE +1                 TO  WS-NOT-FOUND
  8432         GO TO 1699-EXIT.
  8433
  8434     IF CF-BENEFIT-CODE (WS-INDEX)
  8435             IS NOT LESS THAN  CF-HI-BEN-IN-REC
  8436         GO TO 1699-EXIT.
  8437
  8438     IF WS-INDEX  IS LESS THAN  +8
  8439         ADD +1                  TO  WS-INDEX
  8440         GO TO 1610-LOOKUP-BENEFIT.
  8441
  8442 1699-EXIT.
  8443     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 157
* EL1278.cbl
  8445 1700-WRITE-CERT-NOTE      SECTION.
  8446     IF NOT MODIFY-CERT-CAP
  8447         MOVE 'UPDATE'           TO  SM-READ
  8448         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  8449         MOVE ER-0070            TO  EMI-ERROR
  8450         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  8451         GO TO 8200-SEND-DATAONLY.
  8452
  8453**MOVE CANCEL QUOTE NOTE INFO
  8454     IF PI-LF-REFUND-AMT NUMERIC
  8455        MOVE PI-LF-REFUND-AMT    TO WS-CN-LIFE-AMT-RF
  8456        MOVE PI-LF-REFUND-METH   TO WS-CN-LF-REF-METH
  8457     ELSE
  8458        MOVE ZERO                TO WS-CN-LIFE-AMT-RF
  8459                                    PI-LF-REFUND-AMT
  8460        MOVE SPACE               TO WS-CN-LF-REF-METH
  8461                                    PI-LF-REFUND-METH.
  8462
  8463     IF PI-AH-REFUND-AMT NUMERIC
  8464        MOVE PI-AH-REFUND-AMT    TO WS-CN-AH-AMT-RF
  8465        MOVE PI-AH-REFUND-METH   TO WS-CN-AH-REF-METH
  8466     ELSE
  8467        MOVE ZERO                TO WS-CN-AH-AMT-RF
  8468                                    PI-AH-REFUND-AMT
  8469        MOVE SPACE               TO WS-CN-AH-REF-METH
  8470                                    PI-AH-REFUND-METH.
  8471
  8472     COMPUTE PI-TOTAL-REFUND-AMT = PI-LF-REFUND-AMT +
  8473                                   PI-AH-REFUND-AMT.
  8474
  8475     MOVE PI-TOTAL-REFUND-AMT    TO WS-CN-TOTAL-RF.
  8476
  8477     MOVE SAVE-DATE              TO WS-CN-DT-QUOTED.
  8478     MOVE PI-PROCESSOR-ID        TO WS-CN-PROCESSOR-ID.
  8479     IF PI-LF-CANCEL-DATE-ED NOT EQUAL SPACE
  8480        MOVE PI-LF-CANCEL-DATE-ED
  8481                                 TO WS-CN-CANCEL-DT
  8482     ELSE
  8483        MOVE PI-AH-CANCEL-DATE-ED
  8484                                 TO WS-CN-CANCEL-DT
  8485     END-IF
  8486     MOVE 'CZ'                   TO CERT-NOTE-FILE
  8487     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD
  8488     MOVE PI-CARRIER             TO CZ-CARRIER
  8489     MOVE PI-GROUPING            TO CZ-GROUPING
  8490     MOVE PI-STATE               TO CZ-STATE
  8491     MOVE PI-ACCOUNT             TO CZ-ACCOUNT
  8492     MOVE PI-CERT-EFF-DT         TO CZ-CERT-EFF-DT
  8493     MOVE PI-CERT-PRIME          TO CZ-CERT-PRIME
  8494     MOVE PI-CERT-SFX            TO CZ-CERT-SFX
  8495     MOVE '1'                    TO CZ-RECORD-TYPE
  8496     MOVE +1                     TO CZ-NOTE-SEQUENCE
  8497     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER
  8498     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS
  8499     MOVE SAVE-BIN-DATE          TO CZ-LAST-MAINT-DT
  8500     MOVE WS-CAN-QUOTE-NOTE      TO CZ-NOTE-INFORMATION
  8501     MOVE ' '                    TO WS-STOP-SW
  8502     PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 158
* EL1278.cbl
  8503
  8504* EXEC CICS WRITE
  8505*           FROM      (CERT-NOTE-FILE)
  8506*           DATASET   (ERNOTE-ID)
  8507*           RIDFLD    (CZ-CONTROL-PRIMARY)
  8508*           RESP      (WS-RESPONSE)
  8509*       END-EXEC
  8510     MOVE LENGTH OF
  8511      CERT-NOTE-FILE
  8512       TO DFHEIV11
  8513*    MOVE '&$ L                  ''  N#00008073' TO DFHEIV0
  8514     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8515     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8516     MOVE X'204E233030303038303733' TO DFHEIV0(25:11)
  8517     CALL 'kxdfhei1' USING DFHEIV0,
  8518           ERNOTE-ID,
  8519           CERT-NOTE-FILE,
  8520           DFHEIV11,
  8521           CZ-CONTROL-PRIMARY,
  8522           DFHEIV99,
  8523           DFHEIV99
  8524     MOVE EIBRESP  TO WS-RESPONSE
  8525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8526        IF WS-RESP-DUPREC
  8527           ADD +1                TO CZ-NOTE-SEQUENCE
  8528        ELSE
  8529           SET I-SAY-TO-STOP     TO TRUE
  8530        END-IF
  8531     END-PERFORM
  8532     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8533     IF WS-RESP-NORMAL
  8534        EVALUATE CM-NOTE-SW
  8535           WHEN '1'
  8536           WHEN '3'
  8537           WHEN '5'
  8538           WHEN '7'
  8539              SET NO-CERT-RW     TO TRUE
  8540           WHEN ' '
  8541              MOVE '1'           TO CM-NOTE-SW
  8542           WHEN '2'
  8543              MOVE '3'           TO CM-NOTE-SW
  8544           WHEN '4'
  8545              MOVE '5'           TO CM-NOTE-SW
  8546           WHEN '6'
  8547              MOVE '7'           TO CM-NOTE-SW
  8548        END-EVALUATE
  8549     END-IF
  8550     IF NOT NO-CERT-RW
  8551        PERFORM 1810-REWRITE-ELCERT
  8552                                 THRU 1810-EXIT
  8553     ELSE
  8554
  8555* EXEC CICS UNLOCK
  8556*          DATASET    (ELCERT-ID)
  8557*       END-EXEC
  8558*    MOVE '&*                    #   #00008107' TO DFHEIV0
  8559     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8560     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 159
* EL1278.cbl
  8561     MOVE X'2020233030303038313037' TO DFHEIV0(25:11)
  8562     CALL 'kxdfhei1' USING DFHEIV0,
  8563           ELCERT-ID,
  8564           DFHEIV99
  8565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8566     END-IF
  8567     MOVE ER-8160                TO EMI-ERROR.
  8568     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  8569     GO TO 8200-SEND-DATAONLY.
  8570
  8571 1799-EXIT.
  8572     EXIT.
  8573 1800-READ-ELCERT-UPDATE.
  8574     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8575     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8576     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8577     MOVE PI-STATE               TO  WS-CM-STATE.
  8578     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  8579     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8580     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8581     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8582
  8583* EXEC CICS READ
  8584*        UPDATE
  8585*        DATASET  (ELCERT-ID)
  8586*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8587*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8588*        RESP     (WS-RESPONSE)
  8589*    END-EXEC
  8590*    MOVE '&"S        EU         (  N#00008126' TO DFHEIV0
  8591     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8592     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8593     MOVE X'204E233030303038313236' TO DFHEIV0(25:11)
  8594     CALL 'kxdfhei1' USING DFHEIV0,
  8595           ELCERT-ID,
  8596           DFHEIV20,
  8597           DFHEIV99,
  8598           WS-CM-CONTROL-PRIMARY,
  8599           DFHEIV99,
  8600           DFHEIV99,
  8601           DFHEIV99
  8602     SET ADDRESS OF CERTIFICATE-MASTER TO
  8603         DFHEIV20
  8604     MOVE EIBRESP  TO WS-RESPONSE
  8605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8606     .
  8607 1800-EXIT.
  8608     EXIT.
  8609 1810-REWRITE-ELCERT.
  8610
  8611* EXEC CICS REWRITE
  8612*        FROM      (CERTIFICATE-MASTER)
  8613*        DATASET   (ELCERT-ID)
  8614*        RESP     (WS-RESPONSE)
  8615*    END-EXEC.
  8616     MOVE LENGTH OF
  8617      CERTIFICATE-MASTER
  8618       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 160
* EL1278.cbl
  8619*    MOVE '&& L                  %  N#00008137' TO DFHEIV0
  8620     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8621     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8622     MOVE X'204E233030303038313337' TO DFHEIV0(25:11)
  8623     CALL 'kxdfhei1' USING DFHEIV0,
  8624           ELCERT-ID,
  8625           CERTIFICATE-MASTER,
  8626           DFHEIV11,
  8627           DFHEIV99
  8628     MOVE EIBRESP  TO WS-RESPONSE
  8629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8630
  8631     .
  8632 1810-EXIT.
  8633     EXIT.
  8634 4000-GEN-CANCEL-TRANS.
  8635     IF PI-LF-REFUND-AMT NOT NUMERIC
  8636         MOVE +0 TO PI-LF-REFUND-AMT
  8637     END-IF
  8638     IF PI-AH-REFUND-AMT NOT NUMERIC
  8639         MOVE +0 TO PI-AH-REFUND-AMT
  8640     END-IF
  8641
  8642     PERFORM 4400-ADD-ORIG-REC THRU 4400-EXIT
  8643
  8644     MOVE '2'                    TO CG-OPTION-CODE
  8645     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
  8646     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
  8647     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
  8648     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
  8649     MOVE PI-CARRIER             TO CG-CERT-CARRIER
  8650     MOVE PI-GROUPING            TO CG-CERT-GROUP
  8651     MOVE PI-STATE               TO CG-CERT-STATE
  8652     MOVE PI-ACCOUNT             TO CG-CERT-ACCOUNT
  8653     MOVE PI-CERT-EFF-DT         TO CG-CERT-EFF-DT
  8654     MOVE PI-CERT-NO             TO CG-CERT-CERT-NO
  8655     MOVE SAVE-BIN-DATE          TO CG-CURRENT-DT
  8656     MOVE ZEROS                  TO CG-LF-BENCD
  8657                                    CG-AH-BENCD
  8658                                    CG-LF-CAN-AMT
  8659                                    CG-AH-CAN-AMT
  8660     MOVE LOW-VALUES             TO CG-LF-CAN-DT
  8661                                    CG-AH-CAN-DT
  8662     MOVE SPACES                 TO CG-BATCH-NO
  8663     IF CM-LF-BENEFIT-CD NOT = '00' AND '  ' AND 'DD'
  8664       AND (CM-LF-CANCEL-DT = LOW-VALUES OR SPACES)
  8665        IF (PI-LF-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8666           MOVE CM-LF-BENEFIT-CD  TO CG-LF-BENCD
  8667           MOVE PI-LF-REFUND-AMT  TO CG-LF-CAN-AMT
  8668           MOVE PI-LF-CANCEL-DATE TO CG-LF-CAN-DT
  8669        END-IF
  8670     END-IF
  8671     IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  8672       AND (CM-AH-CANCEL-DT = LOW-VALUES OR SPACES)
  8673        IF (PI-AH-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8674           MOVE CM-AH-BENEFIT-CD  TO CG-AH-BENCD
  8675           MOVE PI-AH-REFUND-AMT  TO CG-AH-CAN-AMT
  8676           MOVE PI-AH-CANCEL-DATE TO CG-AH-CAN-DT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 161
* EL1278.cbl
  8677        END-IF
  8678     END-IF
  8679
  8680* EXEC CICS LINK
  8681*        PROGRAM  ('ELCANC')
  8682*        COMMAREA (CANCEL-GEN-PASS-AREA)
  8683*    END-EXEC
  8684     MOVE LENGTH OF
  8685      CANCEL-GEN-PASS-AREA
  8686       TO DFHEIV11
  8687     MOVE 'ELCANC' TO DFHEIV1
  8688*    MOVE '."C                   (   #00008190' TO DFHEIV0
  8689     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8690     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8691     MOVE X'2020233030303038313930' TO DFHEIV0(25:11)
  8692     CALL 'kxdfhei1' USING DFHEIV0,
  8693           DFHEIV1,
  8694           CANCEL-GEN-PASS-AREA,
  8695           DFHEIV11,
  8696           DFHEIV99,
  8697           DFHEIV99,
  8698           DFHEIV99,
  8699           DFHEIV99
  8700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8701     IF CG-SUCCESS
  8702        CONTINUE
  8703     ELSE
  8704        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
  8705        move '3'                 to emi-switch1
  8706        MOVE CG-ERROR-CODE       TO EMI-TEXT-VARIABLE (1)
  8707        EVALUATE TRUE
  8708           WHEN CG-DATE-ERROR
  8709             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8710           WHEN CG-CERT-NOT-FOUND
  8711             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8712           WHEN CG-AMOUNT-ERROR
  8713             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8714           WHEN CG-OPTION-ERROR
  8715             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8716           WHEN CG-PREV-CAN
  8717             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8718           WHEN CG-INVALID-DATA
  8719             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8720           WHEN CG-NO-ACCT-MSTR
  8721             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8722           WHEN CG-SFX-A-EXIST
  8723             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8724           WHEN CG-MISC-ERROR
  8725             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8726           WHEN OTHER
  8727             move ' error - elcanc - return '
  8728                                 to emi-error-text (1) (12:25)
  8729        END-EVALUATE
  8730        go to 8200-send-dataonly
  8731     end-if
  8732     .
  8733 4000-exit.
  8734     exit.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 162
* EL1278.cbl
  8735
  8736 4400-ADD-ORIG-REC.
  8737
  8738     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8739     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8740     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8741     MOVE PI-STATE               TO  WS-CM-STATE.
  8742     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  8743     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8744     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8745     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8746
  8747
  8748* EXEC CICS READ
  8749*        DATASET  (ELCERT-ID)
  8750*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8751*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8752*        RESP     (WS-RESPONSE)
  8753*    END-EXEC
  8754*    MOVE '&"S        E          (  N#00008240' TO DFHEIV0
  8755     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8756     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8757     MOVE X'204E233030303038323430' TO DFHEIV0(25:11)
  8758     CALL 'kxdfhei1' USING DFHEIV0,
  8759           ELCERT-ID,
  8760           DFHEIV20,
  8761           DFHEIV99,
  8762           WS-CM-CONTROL-PRIMARY,
  8763           DFHEIV99,
  8764           DFHEIV99,
  8765           DFHEIV99
  8766     SET ADDRESS OF CERTIFICATE-MASTER TO
  8767         DFHEIV20
  8768     MOVE EIBRESP  TO WS-RESPONSE
  8769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8770     IF WS-RESP-NORMAL
  8771         CONTINUE
  8772     ELSE
  8773        MOVE ER-0142                TO EMI-ERROR
  8774        PERFORM 9700-ERROR-FORMAT THRU 9799-EXIT
  8775        GO TO 8100-SEND-INITIAL-MAP
  8776     END-IF
  8777
  8778******************************************************************
  8779*            A D D   O R I G   C E R T   I N F O                 *
  8780******************************************************************
  8781
  8782     display ' made it to add orig cert ' WS-CM-CONTROL-PRIMARY
  8783
  8784     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  8785     MOVE ' '                    TO WS-ERMAIL-SW
  8786
  8787
  8788* EXEC CICS READ
  8789*       DATASET   ('ERMAIL')
  8790*       SET       (ADDRESS OF MAILING-DATA)
  8791*       RIDFLD    (WS-MA-CONTROL-PRIMARY)
  8792*       RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 163
* EL1278.cbl
  8793*    END-EXEC
  8794     MOVE 'ERMAIL' TO DFHEIV1
  8795*    MOVE '&"S        E          (  N#00008263' TO DFHEIV0
  8796     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8797     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8798     MOVE X'204E233030303038323633' TO DFHEIV0(25:11)
  8799     CALL 'kxdfhei1' USING DFHEIV0,
  8800           DFHEIV1,
  8801           DFHEIV20,
  8802           DFHEIV99,
  8803           WS-MA-CONTROL-PRIMARY,
  8804           DFHEIV99,
  8805           DFHEIV99,
  8806           DFHEIV99
  8807     SET ADDRESS OF MAILING-DATA TO
  8808         DFHEIV20
  8809     MOVE EIBRESP  TO WS-RESPONSE
  8810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8811
  8812     IF WS-RESP-NORMAL
  8813        SET ERMAIL-FOUND TO TRUE
  8814     END-IF
  8815
  8816     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTO-KEY (1:33)
  8817     MOVE 'I'                 TO ELCRTO-RECORD-TYPE
  8818     MOVE +0                  TO ELCRTO-SEQ-NO
  8819
  8820
  8821* EXEC CICS READ
  8822*       DATASET   ('ELCRTO')
  8823*       SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  8824*       RIDFLD    (ELCRTO-KEY)
  8825*       GTEQ
  8826*       RESP      (WS-RESPONSE)
  8827*    END-EXEC
  8828     MOVE 'ELCRTO' TO DFHEIV1
  8829*    MOVE '&"S        G          (  N#00008278' TO DFHEIV0
  8830     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8831     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8832     MOVE X'204E233030303038323738' TO DFHEIV0(25:11)
  8833     CALL 'kxdfhei1' USING DFHEIV0,
  8834           DFHEIV1,
  8835           DFHEIV20,
  8836           DFHEIV99,
  8837           ELCRTO-KEY,
  8838           DFHEIV99,
  8839           DFHEIV99,
  8840           DFHEIV99
  8841     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  8842         DFHEIV20
  8843     MOVE EIBRESP  TO WS-RESPONSE
  8844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8845
  8846     display ' just read gteq ' ws-response
  8847     IF WS-RESP-NORMAL
  8848        AND (OC-CONTROL-PRIMARY (1:33) =
  8849                 WS-CM-CONTROL-PRIMARY)
  8850        AND (OC-RECORD-TYPE = 'I')
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 164
* EL1278.cbl
  8851        display ' resp norm, key =, type i '
  8852        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
  8853
  8854* EXEC CICS READ
  8855*             DATASET   ('ELCRTO')
  8856*             SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  8857*             RIDFLD    (OC-CONTROL-PRIMARY)
  8858*             UPDATE
  8859*             RESP      (WS-RESPONSE)
  8860*          END-EXEC
  8861     MOVE 'ELCRTO' TO DFHEIV1
  8862*    MOVE '&"S        EU         (  N#00008293' TO DFHEIV0
  8863     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8864     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8865     MOVE X'204E233030303038323933' TO DFHEIV0(25:11)
  8866     CALL 'kxdfhei1' USING DFHEIV0,
  8867           DFHEIV1,
  8868           DFHEIV20,
  8869           DFHEIV99,
  8870           OC-CONTROL-PRIMARY,
  8871           DFHEIV99,
  8872           DFHEIV99,
  8873           DFHEIV99
  8874     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  8875         DFHEIV20
  8876     MOVE EIBRESP  TO WS-RESPONSE
  8877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8878           DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
  8879           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
  8880           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  8881           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  8882           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  8883           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  8884           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  8885           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  8886           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  8887           IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  8888            (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  8889               MOVE SPACES             TO OC-LF-BENCD
  8890               MOVE ZEROS              TO OC-LF-TERM
  8891                                          OC-LF-BEN-AMT
  8892                                          OC-LF-PRM-AMT
  8893                                          OC-LF-ALT-BEN-AMT
  8894                                          OC-LF-ALT-PRM-AMT
  8895                                          OC-LF-COMM-PCT
  8896                                          OC-LF-CANCEL-AMT
  8897               MOVE LOW-VALUES         TO OC-LF-EXP-DT
  8898               MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  8899           ELSE
  8900               MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
  8901               MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
  8902               MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
  8903               MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
  8904               MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
  8905               MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
  8906               MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
  8907               MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
  8908               MOVE PI-LF-REFUND-AMT       TO OC-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 165
* EL1278.cbl
  8909               MOVE PI-LF-CANCEL-DATE      TO OC-LF-CANCEL-DT
  8910           END-IF
  8911           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  8912           IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  8913            (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  8914               MOVE SPACES             TO OC-AH-BENCD
  8915               MOVE ZEROS              TO OC-AH-TERM
  8916                                          OC-AH-BEN-AMT
  8917                                          OC-AH-PRM-AMT
  8918                                          OC-AH-COMM-PCT
  8919                                          OC-AH-CANCEL-AMT
  8920                                          OC-AH-CP
  8921               MOVE LOW-VALUES         TO OC-AH-EXP-DT
  8922               MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  8923           ELSE
  8924               MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  8925               MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  8926               MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  8927               MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  8928               MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  8929               MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  8930               MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  8931               MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  8932               MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  8933           END-IF
  8934           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  8935           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  8936           MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  8937           MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  8938           MOVE EIBDATE                TO DC-JULIAN-YYDDD
  8939           MOVE '5'                    TO DC-OPTION-CODE
  8940           PERFORM 9600-DATE-LINK
  8941           MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  8942           IF ERMAIL-FOUND
  8943               MOVE MA-CRED-BENE-NAME
  8944                           TO OC-CRED-BENE-NAME
  8945           END-IF
  8946
  8947* EXEC CICS REWRITE
  8948*             DATASET   ('ELCRTO')
  8949*             FROM      (ORIGINAL-CERTIFICATE)
  8950*             RESP      (WS-RESPONSE)
  8951*          END-EXEC
  8952     MOVE LENGTH OF
  8953      ORIGINAL-CERTIFICATE
  8954       TO DFHEIV11
  8955     MOVE 'ELCRTO' TO DFHEIV1
  8956*    MOVE '&& L                  %  N#00008368' TO DFHEIV0
  8957     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8958     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8959     MOVE X'204E233030303038333638' TO DFHEIV0(25:11)
  8960     CALL 'kxdfhei1' USING DFHEIV0,
  8961           DFHEIV1,
  8962           ORIGINAL-CERTIFICATE,
  8963           DFHEIV11,
  8964           DFHEIV99
  8965     MOVE EIBRESP  TO WS-RESPONSE
  8966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 166
* EL1278.cbl
  8967           display ' just rewrote ' ws-response
  8968           IF NOT WS-RESP-NORMAL
  8969              MOVE ER-3830          TO EMI-ERROR
  8970              PERFORM 9700-ERROR-FORMAT
  8971                                 THRU 9799-EXIT
  8972              GO TO 8200-SEND-DATAONLY
  8973           END-IF
  8974
  8975           GO TO 4400-EXIT
  8976
  8977        ELSE
  8978           SUBTRACT +1 FROM OC-KEY-SEQ-NO
  8979        END-IF
  8980     ELSE
  8981        MOVE SPACES              TO ORIGINAL-CERTIFICATE
  8982        MOVE 'OC'                TO OC-RECORD-ID
  8983        MOVE WS-CM-CONTROL-PRIMARY TO OC-CONTROL-PRIMARY (1:33)
  8984        MOVE 'I'                 TO OC-RECORD-TYPE
  8985        MOVE +4096               TO OC-KEY-SEQ-NO
  8986     END-IF
  8987
  8988     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
  8989     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  8990     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  8991     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  8992     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  8993     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  8994     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  8995     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  8996     IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  8997      (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  8998         MOVE SPACES             TO OC-LF-BENCD
  8999         MOVE ZEROS              TO OC-LF-TERM
  9000                                    OC-LF-BEN-AMT
  9001                                    OC-LF-PRM-AMT
  9002                                    OC-LF-ALT-BEN-AMT
  9003                                    OC-LF-ALT-PRM-AMT
  9004                                    OC-LF-COMM-PCT
  9005                                    OC-LF-CANCEL-AMT
  9006         MOVE LOW-VALUES         TO OC-LF-EXP-DT
  9007         MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  9008     ELSE
  9009         MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
  9010         MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
  9011         MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
  9012         MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
  9013         MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
  9014         MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
  9015         MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
  9016         MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
  9017         MOVE PI-LF-REFUND-AMT   TO OC-LF-CANCEL-AMT
  9018         MOVE PI-LF-CANCEL-DATE  TO OC-LF-CANCEL-DT
  9019     END-IF
  9020     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  9021     IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9022      (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9023         MOVE SPACES             TO OC-AH-BENCD
  9024         MOVE ZEROS              TO OC-AH-TERM
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 167
* EL1278.cbl
  9025                                    OC-AH-BEN-AMT
  9026                                    OC-AH-PRM-AMT
  9027                                    OC-AH-COMM-PCT
  9028                                    OC-AH-CANCEL-AMT
  9029                                    OC-AH-CP
  9030         MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9031         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9032     ELSE
  9033         MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9034         MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9035         MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9036         MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9037         MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9038         MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9039         MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9040         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9041         MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9042         MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9043     END-IF
  9044     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9045     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9046     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  9047     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  9048     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9049     MOVE '5'                    TO DC-OPTION-CODE
  9050     PERFORM 9600-DATE-LINK
  9051     MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9052     IF ERMAIL-FOUND
  9053         MOVE MA-CRED-BENE-NAME
  9054                     TO OC-CRED-BENE-NAME
  9055     END-IF
  9056     MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
  9057     .
  9058 4400-WRITE-ELCRTO.
  9059
  9060
  9061* EXEC CICS WRITE
  9062*       DATASET   ('ELCRTO')
  9063*       FROM      (ORIGINAL-CERTIFICATE)
  9064*       RIDFLD    (OC-CONTROL-PRIMARY)
  9065*       RESP      (WS-RESPONSE)
  9066*    END-EXEC
  9067     MOVE LENGTH OF
  9068      ORIGINAL-CERTIFICATE
  9069       TO DFHEIV11
  9070     MOVE 'ELCRTO' TO DFHEIV1
  9071*    MOVE '&$ L                  ''  N#00008466' TO DFHEIV0
  9072     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9073     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9074     MOVE X'204E233030303038343636' TO DFHEIV0(25:11)
  9075     CALL 'kxdfhei1' USING DFHEIV0,
  9076           DFHEIV1,
  9077           ORIGINAL-CERTIFICATE,
  9078           DFHEIV11,
  9079           OC-CONTROL-PRIMARY,
  9080           DFHEIV99,
  9081           DFHEIV99
  9082     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 168
* EL1278.cbl
  9083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9084
  9085    IF WS-RESP-DUPKEY OR WS-RESP-DUPREC
  9086        SUBTRACT +1    FROM OC-KEY-SEQ-NO
  9087        GO TO 4400-WRITE-ELCRTO
  9088    ELSE
  9089        IF NOT WS-RESP-NORMAL
  9090           MOVE ER-3830          TO EMI-ERROR
  9091           PERFORM 9700-ERROR-FORMAT
  9092                                 THRU 9799-EXIT
  9093           GO TO 8200-SEND-DATAONLY
  9094        END-IF
  9095    END-IF
  9096
  9097     .
  9098 4400-EXIT.
  9099    EXIT.
  9100
  9101
  9102 5000-GET-LF-AM-REM-TERM.
  9103     MOVE +1                     TO SUB3.
  9104
  9105 5100-GET-LF-AM-REM-TERM.
  9106     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9107        IF CM-LF-BENEFIT-CD = AM-BENEFIT-CODE (SUB3)
  9108           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9109                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9110           GO TO 5300-MOVE-LF-REM-TERM.
  9111
  9112     IF SUB3 LESS THAN +20
  9113        ADD +1                   TO SUB3
  9114        GO TO 5100-GET-LF-AM-REM-TERM.
  9115
  9116     MOVE +1                     TO SUB3.
  9117
  9118     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9119         GO TO 5200-EDIT-FOR-NINETY-LF.
  9120
  9121 5100-GET-LF-DMD-AM-REM-TERM.
  9122
  9123     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9124        IF CM-LF-BENEFIT-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9125           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9126                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9127           GO TO 5300-MOVE-LF-REM-TERM.
  9128
  9129     IF SUB3 LESS THAN +30
  9130        ADD +1                   TO SUB3
  9131        GO TO 5100-GET-LF-DMD-AM-REM-TERM.
  9132
  9133     MOVE +1                     TO SUB3.
  9134
  9135 5200-EDIT-FOR-NINETY-LF.
  9136
  9137***************************************************************
  9138*                                                             *
  9139*    NINETY BENEFIT PLAN TYPES:                               *
  9140*                                                             *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 169
* EL1278.cbl
  9141*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9142*      92 = ALL GROUP REDUCING BENEFITS                       *
  9143*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  9144*      94 = ALL GROUP LEVEL BENEFITS                          *
  9145*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9146*           BENEFIT CONTROLS.                                 *
  9147*      99 = ALL BENEFITS                                      *
  9148*                                                             *
  9149***************************************************************
  9150
  9151     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9152                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9153
  9154     IF (AM-BENEFIT-CODE (SUB3) = '99')
  9155       AND
  9156        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9157           GO TO 5300-MOVE-LF-REM-TERM.
  9158
  9159     IF (AM-BENEFIT-CODE (SUB3) = '91')
  9160       AND
  9161        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9162        IF CF-REDUCING (WS-INDEX)
  9163           IF CM-INDIVIDUAL
  9164               GO TO 5300-MOVE-LF-REM-TERM.
  9165
  9166     IF (AM-BENEFIT-CODE (SUB3) = '92')
  9167       AND
  9168        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9169        IF CF-REDUCING (WS-INDEX)
  9170           IF CM-GROUP
  9171               GO TO 5300-MOVE-LF-REM-TERM.
  9172
  9173     IF (AM-BENEFIT-CODE (SUB3) = '93')
  9174       AND
  9175        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9176        IF CF-LEVEL (WS-INDEX)
  9177           IF CM-INDIVIDUAL
  9178               GO TO 5300-MOVE-LF-REM-TERM.
  9179
  9180     IF (AM-BENEFIT-CODE (SUB3) = '94')
  9181       AND
  9182        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9183        IF CF-LEVEL (WS-INDEX)
  9184           IF CM-GROUP
  9185               GO TO 5300-MOVE-LF-REM-TERM.
  9186
  9187     IF (AM-BENEFIT-CODE (SUB3) = '98')
  9188       AND
  9189        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9190            GO TO 5300-MOVE-LF-REM-TERM.
  9191
  9192     IF SUB3 LESS THAN +20
  9193        ADD +1           TO SUB3
  9194          GO TO 5200-EDIT-FOR-NINETY-LF.
  9195
  9196     MOVE SPACES         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9197
  9198     IF PI-COMPANY-ID NOT EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 170
* EL1278.cbl
  9199         MOVE '0'                 TO WS-LF-AM-REM-TERM-CALC
  9200         GO TO 5900-EXIT.
  9201
  9202     MOVE 1                       TO SUB3.
  9203
  9204 5200-EDIT-FOR-DMD-NINETY-LF.
  9205
  9206     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9207                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9208
  9209     IF (AM-BENEFIT-DMD-CODE (SUB3) = '99')
  9210       AND
  9211        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9212           GO TO 5300-MOVE-LF-REM-TERM.
  9213
  9214     IF (AM-BENEFIT-DMD-CODE (SUB3) = '91')
  9215       AND
  9216        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9217        IF CF-REDUCING (WS-INDEX)
  9218           IF CM-INDIVIDUAL
  9219               GO TO 5300-MOVE-LF-REM-TERM.
  9220
  9221     IF (AM-BENEFIT-DMD-CODE (SUB3) = '92')
  9222       AND
  9223        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9224        IF CF-REDUCING (WS-INDEX)
  9225           IF CM-GROUP
  9226               GO TO 5300-MOVE-LF-REM-TERM.
  9227
  9228     IF (AM-BENEFIT-DMD-CODE (SUB3) = '93')
  9229       AND
  9230        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9231        IF CF-LEVEL (WS-INDEX)
  9232           IF CM-INDIVIDUAL
  9233               GO TO 5300-MOVE-LF-REM-TERM.
  9234
  9235     IF (AM-BENEFIT-DMD-CODE (SUB3) = '94')
  9236       AND
  9237        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9238        IF CF-LEVEL (WS-INDEX)
  9239           IF CM-GROUP
  9240               GO TO 5300-MOVE-LF-REM-TERM.
  9241
  9242     IF (AM-BENEFIT-DMD-CODE (SUB3) = '98')
  9243       AND
  9244        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9245            GO TO 5300-MOVE-LF-REM-TERM.
  9246
  9247     IF SUB3 LESS THAN +30
  9248        ADD +1                   TO SUB3
  9249          GO TO 5200-EDIT-FOR-DMD-NINETY-LF.
  9250
  9251     MOVE '0'                    TO WS-LF-AM-REM-TERM-CALC.
  9252
  9253     GO TO 5900-EXIT.
  9254
  9255 5300-MOVE-LF-REM-TERM.
  9256     MOVE WS-SAVE-BENEFIT-REM-TERM
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 171
* EL1278.cbl
  9257                                 TO WS-LF-AM-REM-TERM-CALC.
  9258
  9259 5900-EXIT.
  9260      EXIT.
  9261
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 172
* EL1278.cbl
  9263
  9264 6000-GET-AH-AM-REM-TERM.
  9265     MOVE +1                     TO SUB3.
  9266
  9267 6100-GET-AH-AM-REM-TERM.
  9268
  9269     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9270        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB3)
  9271           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9272                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9273           GO TO 6300-MOVE-AH-REM-TERM.
  9274
  9275     IF SUB3 LESS THAN +20
  9276        ADD +1                   TO SUB3
  9277        GO TO 6100-GET-AH-AM-REM-TERM.
  9278
  9279     MOVE +1                     TO SUB3.
  9280
  9281     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9282         GO TO 6200-EDIT-FOR-NINETY-AH.
  9283
  9284 6100-GET-AH-AM-DMD-REM-TERM.
  9285     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9286        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9287           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9288                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9289           GO TO 6300-MOVE-AH-REM-TERM.
  9290
  9291     IF SUB3 LESS THAN +30
  9292        ADD +1                   TO SUB3
  9293        GO TO 6100-GET-AH-AM-DMD-REM-TERM.
  9294
  9295     MOVE +1                     TO SUB3.
  9296
  9297 6200-EDIT-FOR-NINETY-AH.
  9298
  9299***************************************************************
  9300*                                                             *
  9301*    NINETY BENEFIT PLAN TYPES:                               *
  9302*                                                             *
  9303*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9304*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9305*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9306*           BENEFIT CONTROLS.                                 *
  9307*      99 = ALL BENEFITS.                                     *
  9308*                                                             *
  9309***************************************************************
  9310
  9311     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9312                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9313
  9314     IF AM-BENEFIT-CODE (SUB3) = '99'
  9315       AND
  9316        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9317           GO TO 6300-MOVE-AH-REM-TERM.
  9318
  9319     IF AM-BENEFIT-CODE (SUB3) = '91'
  9320       AND
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 173
* EL1278.cbl
  9321        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9322           IF CM-INDIVIDUAL
  9323               GO TO 6300-MOVE-AH-REM-TERM.
  9324
  9325     IF AM-BENEFIT-CODE (SUB3) = '92'
  9326       AND
  9327        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9328           IF CM-GROUP
  9329               GO TO 6300-MOVE-AH-REM-TERM.
  9330
  9331     IF AM-BENEFIT-CODE (SUB3) = '98'
  9332       AND
  9333        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9334           GO TO 6300-MOVE-AH-REM-TERM.
  9335
  9336     IF SUB3 LESS THAN +20
  9337        ADD +1                    TO SUB3
  9338        GO TO 6200-EDIT-FOR-NINETY-AH.
  9339
  9340     MOVE +1                      TO SUB3.
  9341
  9342     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9343         MOVE '0'                 TO WS-AH-AM-REM-TERM-CALC
  9344         GO TO 6900-EXIT.
  9345
  9346 6200-EDIT-FOR-DMD-NINETY-AH.
  9347
  9348     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9349                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9350
  9351     IF AM-BENEFIT-DMD-CODE (SUB3) = '99'
  9352       AND
  9353        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9354           GO TO 6300-MOVE-AH-REM-TERM.
  9355
  9356     IF AM-BENEFIT-DMD-CODE (SUB3) = '91'
  9357       AND
  9358        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9359           IF CM-INDIVIDUAL
  9360               GO TO 6300-MOVE-AH-REM-TERM.
  9361
  9362     IF AM-BENEFIT-DMD-CODE (SUB3) = '92'
  9363       AND
  9364        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9365           IF CM-GROUP
  9366               GO TO 6300-MOVE-AH-REM-TERM.
  9367
  9368     IF AM-BENEFIT-DMD-CODE (SUB3) = '98'
  9369       AND
  9370        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9371           GO TO 6300-MOVE-AH-REM-TERM.
  9372
  9373     IF SUB3 LESS THAN +30
  9374        ADD +1                   TO SUB3
  9375        GO TO 6200-EDIT-FOR-DMD-NINETY-AH.
  9376
  9377     MOVE '0'                    TO WS-AH-AM-REM-TERM-CALC.
  9378
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 174
* EL1278.cbl
  9379     GO TO 6900-EXIT.
  9380
  9381 6300-MOVE-AH-REM-TERM.
  9382
  9383     MOVE WS-SAVE-BENEFIT-REM-TERM
  9384                                 TO WS-AH-AM-REM-TERM-CALC.
  9385
  9386 6900-EXIT.
  9387      EXIT.
  9388
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 175
* EL1278.cbl
  9390 7000-GET-ERFORM     SECTION.
  9391
  9392* EXEC CICS HANDLE CONDITION
  9393*        NOTFND  (7000-EXIT)
  9394*    END-EXEC.
  9395*    MOVE '"$I                   ! ( #00008779' TO DFHEIV0
  9396     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9397     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9398     MOVE X'2820233030303038373739' TO DFHEIV0(25:11)
  9399     CALL 'kxdfhei1' USING DFHEIV0
  9400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9401
  9402
  9403     MOVE ' '                    TO  WS-FORM-RECORD-SW.
  9404     MOVE PI-COMPANY-CD          TO  WS-FO-COMPANY-CD.
  9405     MOVE PI-STATE               TO  WS-FO-STATE.
  9406     MOVE CM-POLICY-FORM-NO      TO  WS-FO-FORM-ID.
  9407     MOVE CM-CERT-EFF-DT         TO  WS-FO-EXP-DT.
  9408
  9409
  9410* EXEC CICS READ
  9411*        DATASET  (ERFORM-ID)
  9412*        RIDFLD   (WS-FO-CONTROL-PRIMARY)
  9413*        SET      (ADDRESS OF FORM-MASTER)
  9414*        GTEQ
  9415*    END-EXEC.
  9416*    MOVE '&"S        G          (   #00008789' TO DFHEIV0
  9417     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9418     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9419     MOVE X'2020233030303038373839' TO DFHEIV0(25:11)
  9420     CALL 'kxdfhei1' USING DFHEIV0,
  9421           ERFORM-ID,
  9422           DFHEIV20,
  9423           DFHEIV99,
  9424           WS-FO-CONTROL-PRIMARY,
  9425           DFHEIV99,
  9426           DFHEIV99,
  9427           DFHEIV99
  9428     SET ADDRESS OF FORM-MASTER TO
  9429         DFHEIV20
  9430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9431
  9432
  9433     IF PI-COMPANY-CD     EQUAL FO-COMPANY-CD AND
  9434        PI-STATE          EQUAL FO-STATE      AND
  9435        CM-POLICY-FORM-NO EQUAL FO-FORM-ID
  9436         MOVE 'Y'  TO WS-FORM-RECORD-SW
  9437         GO TO 7000-EXIT.
  9438 7000-EXIT.
  9439     EXIT.
  9440 7100-BENEFIT-SEARCH SECTION.
  9441
  9442     IF CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES
  9443        MOVE +1                  TO  SUB4
  9444        PERFORM 7150-BENEFIT-LIFE-SEARCH THRU 7150-EXIT.
  9445
  9446     IF CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES
  9447        MOVE +1                  TO  SUB4
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 176
* EL1278.cbl
  9448        PERFORM 7250-BENEFIT-AH-SEARCH THRU 7250-EXIT.
  9449 7100-EXIT.
  9450     EXIT.
  9451 7150-BENEFIT-LIFE-SEARCH.
  9452     IF PI-LIFE-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9453       IF CM-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9454         IF (CM-LF-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9455          OR CM-LF-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9456            IF FO-PLAN-REFUND-METHOD (SUB4)
  9457                    IS GREATER THAN SPACES
  9458               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9459                                    WS-LF-FO-REFUND-CALC
  9460               GO TO 7150-EXIT.
  9461
  9462     IF SUB4 LESS THAN +40
  9463         ADD +1              TO SUB4
  9464         GO TO 7150-BENEFIT-LIFE-SEARCH.
  9465
  9466 7150-EXIT.
  9467     EXIT.
  9468 7250-BENEFIT-AH-SEARCH.
  9469     IF PI-AH-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9470       IF CM-AH-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9471         IF (CM-AH-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9472          OR CM-AH-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9473            IF FO-PLAN-REFUND-METHOD (SUB4)
  9474                    IS GREATER THAN SPACES
  9475               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9476                                    WS-AH-FO-REFUND-CALC
  9477               GO TO 7250-EXIT.
  9478
  9479     IF SUB4 LESS THAN +40
  9480         ADD +1              TO SUB4
  9481         GO TO 7250-BENEFIT-AH-SEARCH.
  9482
  9483 7250-EXIT.
  9484     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 177
* EL1278.cbl
  9486
  9487 8100-SEND-INITIAL-MAP  SECTION.
  9488     MOVE SAVE-DATE              TO  HDATEO.
  9489     MOVE EIBTIME                TO  TIME-IN.
  9490     MOVE TIME-OUT               TO  HTIMEO.
  9491     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9492     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9493     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9494     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9495
  9496     IF CM-LF-BENEFIT-CD = '00'
  9497         MOVE -1                 TO  HACANCL
  9498     ELSE
  9499         MOVE -1                 TO  HLCANCL.
  9500
  9501     IF PI-COMPANY-ID NOT = 'DCC'
  9502        MOVE AL-SADOF            TO CANREAHA
  9503                                    CLPYNHA
  9504                                    CANREAA
  9505                                    CLPYNA
  9506     END-IF
  9507
  9508
  9509* EXEC CICS SEND
  9510*        FROM    (EL127HO)
  9511*        MAPSET  (MAPSET-NAME)
  9512*        MAP     (MAP-NAME)
  9513*        CURSOR
  9514*        ERASE
  9515*    END-EXEC.
  9516     MOVE LENGTH OF
  9517      EL127HO
  9518       TO DFHEIV12
  9519     MOVE -1
  9520       TO DFHEIV11
  9521*    MOVE '8$     CT  E    H L F ,   #00008871' TO DFHEIV0
  9522     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9523     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9524     MOVE X'2020233030303038383731' TO DFHEIV0(25:11)
  9525     CALL 'kxdfhei1' USING DFHEIV0,
  9526           MAP-NAME,
  9527           EL127HO,
  9528           DFHEIV12,
  9529           MAPSET-NAME,
  9530           DFHEIV99,
  9531           DFHEIV99,
  9532           DFHEIV99,
  9533           DFHEIV11,
  9534           DFHEIV99,
  9535           DFHEIV99,
  9536           DFHEIV99
  9537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9538
  9539
  9540     GO TO 9000-RETURN-TRAN.
  9541
  9542 8200-SEND-DATAONLY  SECTION.
  9543     IF FIRST-ENTRY
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 178
* EL1278.cbl
  9544         GO TO 8100-SEND-INITIAL-MAP.
  9545
  9546     MOVE SAVE-DATE              TO  HDATEO.
  9547     MOVE EIBTIME                TO  TIME-IN.
  9548     MOVE TIME-OUT               TO  HTIMEO.
  9549     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9550     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9551     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9552     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9553     MOVE -1                     TO  HLCANCL.
  9554
  9555
  9556* EXEC CICS SEND DATAONLY
  9557*        FROM    (EL127HO)
  9558*        MAPSET  (MAPSET-NAME)
  9559*        MAP     (MAP-NAME)
  9560*        CURSOR
  9561*    END-EXEC.
  9562     MOVE LENGTH OF
  9563      EL127HO
  9564       TO DFHEIV12
  9565     MOVE -1
  9566       TO DFHEIV11
  9567*    MOVE '8$D    CT       H L F ,   #00008894' TO DFHEIV0
  9568     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9569     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9570     MOVE X'2020233030303038383934' TO DFHEIV0(25:11)
  9571     CALL 'kxdfhei1' USING DFHEIV0,
  9572           MAP-NAME,
  9573           EL127HO,
  9574           DFHEIV12,
  9575           MAPSET-NAME,
  9576           DFHEIV99,
  9577           DFHEIV99,
  9578           DFHEIV99,
  9579           DFHEIV11,
  9580           DFHEIV99,
  9581           DFHEIV99,
  9582           DFHEIV99
  9583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9584
  9585
  9586     GO TO 9000-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 179
* EL1278.cbl
  9588 8300-SEND-TEXT  SECTION.
  9589
  9590* EXEC CICS SEND TEXT
  9591*        FROM    (LOGOFF-TEXT)
  9592*        LENGTH  (LOGOFF-LENGTH)
  9593*        ERASE
  9594*        FREEKB
  9595*    END-EXEC.
  9596*    MOVE '8&      T  E F  H   F -   #00008904' TO DFHEIV0
  9597     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9598     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9599     MOVE X'2020233030303038393034' TO DFHEIV0(25:11)
  9600     CALL 'kxdfhei1' USING DFHEIV0,
  9601           LOGOFF-TEXT,
  9602           LOGOFF-LENGTH,
  9603           DFHEIV99,
  9604           DFHEIV99,
  9605           DFHEIV99,
  9606           DFHEIV99,
  9607           DFHEIV99,
  9608           DFHEIV99,
  9609           DFHEIV99,
  9610           DFHEIV99,
  9611           DFHEIV99,
  9612           DFHEIV99
  9613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9614
  9615
  9616
  9617* EXEC CICS RETURN
  9618*    END-EXEC.
  9619*    MOVE '.(                    ''   #00008911' TO DFHEIV0
  9620     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9621     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9622     MOVE X'2020233030303038393131' TO DFHEIV0(25:11)
  9623     CALL 'kxdfhei1' USING DFHEIV0,
  9624           DFHEIV99,
  9625           DFHEIV99,
  9626           DFHEIV99,
  9627           DFHEIV99,
  9628           DFHEIV99,
  9629           DFHEIV99
  9630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9631
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 180
* EL1278.cbl
  9633 8600-DEEDIT  SECTION.
  9634
  9635* EXEC CICS BIF DEEDIT
  9636*        FIELD   (DEEDIT-FIELD)
  9637*        LENGTH  (15)
  9638*    END-EXEC.
  9639     MOVE 15
  9640       TO DFHEIV11
  9641*    MOVE '@"L                   #   #00008915' TO DFHEIV0
  9642     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9643     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9644     MOVE X'2020233030303038393135' TO DFHEIV0(25:11)
  9645     CALL 'kxdfhei1' USING DFHEIV0,
  9646           DEEDIT-FIELD,
  9647           DFHEIV11
  9648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9649
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 181
* EL1278.cbl
  9651 8700-UNAUTHORIZED-ACCESS  SECTION.
  9652     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  9653
  9654     GO TO 8300-SEND-TEXT.
  9655
  9656 8800-PF23  SECTION.
  9657     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  9658     MOVE XCTL-005               TO  PGM-NAME.
  9659
  9660     GO TO 9200-XCTL.
  9661
  9662 8900-RETURN-CICS  SECTION.
  9663
  9664* EXEC CICS RETURN
  9665*    END-EXEC.
  9666*    MOVE '.(                    ''   #00008932' TO DFHEIV0
  9667     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9668     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9669     MOVE X'2020233030303038393332' TO DFHEIV0(25:11)
  9670     CALL 'kxdfhei1' USING DFHEIV0,
  9671           DFHEIV99,
  9672           DFHEIV99,
  9673           DFHEIV99,
  9674           DFHEIV99,
  9675           DFHEIV99,
  9676           DFHEIV99
  9677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9678
  9679
  9680 9000-RETURN-TRAN  SECTION.
  9681     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  9682     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  9683
  9684
  9685* EXEC CICS RETURN
  9686*        TRANSID   (TRANS-ID)
  9687*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  9688*        LENGTH    (PI-COMM-LENGTH)
  9689*    END-EXEC.
  9690*    MOVE '.(CT                  ''   #00008939' TO DFHEIV0
  9691     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9692     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9693     MOVE X'2020233030303038393339' TO DFHEIV0(25:11)
  9694     CALL 'kxdfhei1' USING DFHEIV0,
  9695           TRANS-ID,
  9696           PROGRAM-INTERFACE-BLOCK,
  9697           PI-COMM-LENGTH,
  9698           DFHEIV99,
  9699           DFHEIV99,
  9700           DFHEIV99
  9701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9702
  9703
  9704 9100-RETURN-MAIN-MENU  SECTION.
  9705     MOVE XCTL-126               TO  PGM-NAME.
  9706
  9707     GO TO 9200-XCTL.
  9708
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 182
* EL1278.cbl
  9709 9200-XCTL  SECTION.
  9710
  9711* EXEC CICS XCTL
  9712*        PROGRAM   (PGM-NAME)
  9713*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  9714*        LENGTH    (PI-COMM-LENGTH)
  9715*    END-EXEC.
  9716*    MOVE '.$C                   %   #00008951' TO DFHEIV0
  9717     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9718     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9719     MOVE X'2020233030303038393531' TO DFHEIV0(25:11)
  9720     CALL 'kxdfhei1' USING DFHEIV0,
  9721           PGM-NAME,
  9722           PROGRAM-INTERFACE-BLOCK,
  9723           PI-COMM-LENGTH,
  9724           DFHEIV99
  9725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9726
  9727
  9728 9300-CLEAR  SECTION.
  9729     MOVE ' '                    TO  PI-PEND-SW.
  9730     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  9731
  9732     GO TO 9200-XCTL.
  9733
  9734 9400-PF12  SECTION.
  9735     MOVE XCTL-010               TO  PGM-NAME.
  9736
  9737     GO TO 9200-XCTL.
  9738
  9739 9500-PGMID-ERROR  SECTION.
  9740
  9741* EXEC CICS HANDLE CONDITION
  9742*        PGMIDERR  (8300-SEND-TEXT)
  9743*    END-EXEC.
  9744*    MOVE '"$L                   ! ) #00008969' TO DFHEIV0
  9745     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9746     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9747     MOVE X'2920233030303038393639' TO DFHEIV0(25:11)
  9748     CALL 'kxdfhei1' USING DFHEIV0
  9749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9750
  9751
  9752     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  9753     MOVE ' '                    TO  PI-ENTRY-CD-1.
  9754     MOVE XCTL-005               TO  PGM-NAME.
  9755     MOVE PGM-NAME               TO  LOGOFF-PGM.
  9756     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  9757
  9758     GO TO 9200-XCTL.
  9759
  9760 9600-DATE-LINK  SECTION.
  9761     MOVE LINK-ELDATCV           TO  PGM-NAME
  9762
  9763
  9764* EXEC CICS LINK
  9765*        PROGRAM   (PGM-NAME)
  9766*        COMMAREA  (DATE-CONVERSION-DATA)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 183
* EL1278.cbl
  9767*        LENGTH    (DC-COMM-LENGTH)
  9768*    END-EXEC.
  9769*    MOVE '."C                   (   #00008984' TO DFHEIV0
  9770     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9771     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9772     MOVE X'2020233030303038393834' TO DFHEIV0(25:11)
  9773     CALL 'kxdfhei1' USING DFHEIV0,
  9774           PGM-NAME,
  9775           DATE-CONVERSION-DATA,
  9776           DC-COMM-LENGTH,
  9777           DFHEIV99,
  9778           DFHEIV99,
  9779           DFHEIV99,
  9780           DFHEIV99
  9781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9782
  9783
  9784
  9785 9700-ERROR-FORMAT  SECTION.
  9786     IF NOT EMI-ERRORS-COMPLETE
  9787         MOVE LINK-001               TO  PGM-NAME
  9788
  9789* EXEC CICS LINK
  9790*            PROGRAM   (PGM-NAME)
  9791*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  9792*            LENGTH    (EMI-COMM-LENGTH)
  9793*        END-EXEC.
  9794*    MOVE '."C                   (   #00008994' TO DFHEIV0
  9795     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9796     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9797     MOVE X'2020233030303038393934' TO DFHEIV0(25:11)
  9798     CALL 'kxdfhei1' USING DFHEIV0,
  9799           PGM-NAME,
  9800           ERROR-MESSAGE-INTERFACE-BLOCK,
  9801           EMI-COMM-LENGTH,
  9802           DFHEIV99,
  9803           DFHEIV99,
  9804           DFHEIV99,
  9805           DFHEIV99
  9806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9807
  9808
  9809 9799-EXIT.
  9810     EXIT.
  9811
  9812 9800-SECURITY-VIOLATION  SECTION.
  9813*                            COPY ELCSCTP.
  9814******************************************************************
  9815*                                                                *
  9816*                            ELCSCTP                             *
  9817*                            VMOD=2.001                          *
  9818*                                                                *
  9819*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  9820******************************************************************
  9821
  9822
  9823     MOVE EIBDATE          TO SM-JUL-DATE.
  9824     MOVE EIBTRMID         TO SM-TERMID.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 184
* EL1278.cbl
  9825     MOVE THIS-PGM         TO SM-PGM.
  9826     MOVE EIBTIME          TO TIME-IN.
  9827     MOVE TIME-OUT         TO SM-TIME.
  9828     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  9829
  9830
  9831* EXEC CICS LINK
  9832*         PROGRAM  ('EL003')
  9833*         COMMAREA (SECURITY-MESSAGE)
  9834*         LENGTH   (80)
  9835*    END-EXEC.
  9836     MOVE 'EL003' TO DFHEIV1
  9837     MOVE 80
  9838       TO DFHEIV11
  9839*    MOVE '."C                   (   #00009021' TO DFHEIV0
  9840     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9841     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9842     MOVE X'2020233030303039303231' TO DFHEIV0(25:11)
  9843     CALL 'kxdfhei1' USING DFHEIV0,
  9844           DFHEIV1,
  9845           SECURITY-MESSAGE,
  9846           DFHEIV11,
  9847           DFHEIV99,
  9848           DFHEIV99,
  9849           DFHEIV99,
  9850           DFHEIV99
  9851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9852
  9853
  9854******************************************************************
  9855
  9856
  9857 9899-EXIT.
  9858     EXIT.
  9859
  9860 9900-ABEND  SECTION.
  9861     MOVE LINK-004               TO  PGM-NAME.
  9862     MOVE DFHEIBLK               TO  EMI-LINE1.
  9863
  9864
  9865* EXEC CICS LINK
  9866*        PROGRAM   (PGM-NAME)
  9867*        COMMAREA  (EMI-LINE1)
  9868*        LENGTH    (72)
  9869*    END-EXEC.
  9870     MOVE 72
  9871       TO DFHEIV11
  9872*    MOVE '."C                   (   #00009037' TO DFHEIV0
  9873     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9874     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9875     MOVE X'2020233030303039303337' TO DFHEIV0(25:11)
  9876     CALL 'kxdfhei1' USING DFHEIV0,
  9877           PGM-NAME,
  9878           EMI-LINE1,
  9879           DFHEIV11,
  9880           DFHEIV99,
  9881           DFHEIV99,
  9882           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 185
* EL1278.cbl
  9883           DFHEIV99
  9884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9885
  9886
  9887     MOVE -1                     TO  HLCANCL.
  9888
  9889     GO TO 8200-SEND-DATAONLY.
  9890
  9891 9999-LAST-PARAGRAPH.
  9892
  9893* GOBACK.
  9894     MOVE '9%                    "   ' TO DFHEIV0
  9895     MOVE 'EL1278' TO DFHEIV1
  9896     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9897     GOBACK.
  9898
  9899 9999-DFHBACK SECTION.
  9900     MOVE '9%                    "   ' TO DFHEIV0
  9901     MOVE 'EL1278' TO DFHEIV1
  9902     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9903     GOBACK.
  9904 9999-DFHEXIT.
  9905     IF DFHEIGDJ EQUAL 0001
  9906         NEXT SENTENCE
  9907     ELSE IF DFHEIGDJ EQUAL 2
  9908         GO TO 9500-PGMID-ERROR,
  9909               9900-ABEND
  9910         DEPENDING ON DFHEIGDI
  9911     ELSE IF DFHEIGDJ EQUAL 3
  9912         GO TO 0910-NOT-FOUND
  9913         DEPENDING ON DFHEIGDI
  9914     ELSE IF DFHEIGDJ EQUAL 4
  9915         GO TO 1010-NOTFND,
  9916               1020-NOTOPEN
  9917         DEPENDING ON DFHEIGDI
  9918     ELSE IF DFHEIGDJ EQUAL 5
  9919         GO TO 1290-ACCT-NOT-FOUND,
  9920               1290-ACCT-NOT-FOUND
  9921         DEPENDING ON DFHEIGDI
  9922     ELSE IF DFHEIGDJ EQUAL 6
  9923         GO TO 0580-ACCT-NOT-FOUND,
  9924               0580-ACCT-NOT-FOUND
  9925         DEPENDING ON DFHEIGDI
  9926     ELSE IF DFHEIGDJ EQUAL 7
  9927         GO TO 1699-EXIT
  9928         DEPENDING ON DFHEIGDI
  9929     ELSE IF DFHEIGDJ EQUAL 8
  9930         GO TO 7000-EXIT
  9931         DEPENDING ON DFHEIGDI
  9932     ELSE IF DFHEIGDJ EQUAL 9
  9933         GO TO 8300-SEND-TEXT
  9934         DEPENDING ON DFHEIGDI.
  9935     MOVE '9%                    "   ' TO DFHEIV0
  9936     MOVE 'EL1278' TO DFHEIV1
  9937     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9938     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:02 Page 186
* EL1278.cbl
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8548     Code:       26208
