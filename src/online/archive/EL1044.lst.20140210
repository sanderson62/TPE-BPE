* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page   1
* EL1044.cbl
* Options: int("EL1044.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1044.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1044.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1044.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2 PROGRAM-ID.                 EL1044.
     3*
     4*AUTHOR.     PABLO
     5*            OMAHA NE
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF CENTRAL STATES IS EXPRESSLY PROHIBITED       *
    12*            *   WITHOUT THE PRIOR WRITTEN PERMISSION OF         *
    13*            *   CENTRAL STATES                                  *
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page   2
* EL1044.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*REMARKS.
    17*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    18*    FOR THE Z LETTER CONTROLS FOR ACCOUNT SERVICES
    19*    SCREENS     - EL1044Z - LETTER (Z) CONTROL MAINTENANCE
    20*    ENTERED BY  - EL1042 - TEXT MAINT
    21*    EXIT TO     - EL1042 - TEXT MAINT
    22*    INPUT FILE  - ELLETR -              - LETTER TEXT
    23*    OUTPUT FILE - ELLETR -              - LETTER TEXT
    24*    COMMAREA    - PASSED
    25*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL1042. ON
    26*                  FIRST ENTRY, WE READ THE ELLETR FILE USING THE
    27*                  LETTER ID PASSED FROM EL1042.     ON SUBSEQUENT
    28*                  ENTRIES (XCTL FROM CICS VIA     ) THE SCREEN
    29*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    30*                  MAINTENANCE TYPE INDICATED.
    31******************************************************************
    32*                   C H A N G E   L O G
    33*
    34* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    35*-----------------------------------------------------------------
    36*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    37* EFFECTIVE    NUMBER
    38*-----------------------------------------------------------------
    39* 122011    2011022800001  AJRA  ADD ELCZREC COPYBOOK
    40* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
    41* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
    42* 080113    2013062000003  AJRA  ADD BARCODE,RETURN ENV FLAG
    43* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
    44******************************************************************
    45 ENVIRONMENT DIVISION.
    46 DATA DIVISION.
    47 WORKING-STORAGE SECTION.
    48 01  DFH-START PIC X(04).
    49 77  FILLER  PIC X(32)  VALUE '********************************'.
    50 77  FILLER  PIC X(32)  VALUE '*   EL1044 WORKING STORAGE     *'.
    51 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    52 77  M1                          PIC S999 COMP-3 VALUE +0.
    53 77  M2                          PIC S999 COMP-3 VALUE +0.
    54 77  WS-STOP-SW                  PIC X  VALUE ' '.
    55     88  I-SAY-TO-STOP              VALUE 'Y'.
    56 77  WS-FIND-SW                  PIC X  VALUE ' '.
    57     88  WE-FOUND-IT                VALUE 'Y'.
    58 77  WS-SEQ-NO-TO-USE            PIC S9(4) COMP VALUE +0.
    59 01  ACCESS-KEYS.
    60     12  ELLETR-KEY.
    61         16  ELLETR-COMPANY-CD   PIC X.
    62         16  ELLETR-ACCESS-CD    PIC X(12).
    63         16  ELLETR-SEQ-NO       PIC S9(4) COMP.
    64 01  WS-DATE-AREA.
    65     05  SAVE-DATE                   PIC X(08)   VALUE SPACES.
    66     05  SAVE-BIN-DATE               PIC X(02)   VALUE SPACES.
    67 01  MISC-WORK-AREAS.
    68     12  WS-RESPONSE             PIC S9(8)   COMP.
    69         88  RESP-NORMAL              VALUE +00.
    70         88  RESP-ERROR               VALUE +01.
    71         88  RESP-NOTFND              VALUE +13.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page   3
* EL1044.cbl
    72         88  RESP-NOTOPEN             VALUE +19.
    73         88  RESP-ENDFILE             VALUE +20.
    74     12  WS-NUMVAL.
    75         16  WS-NUMVAL-OF-DEEDIT     PIC 9(11) VALUE ZEROS.
    76         16  WS-9V999-OF-DEEDIT REDEFINES
    77             WS-NUMVAL-OF-DEEDIT     PIC 9(8)V999.
    78     12  DEEDIT-FIELD                PIC X(11).
    79     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
    80                                     PIC S9(11).
    81     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
    82                                     PIC S9(09)V99.
    83 01  STANDARD-AREAS.
    84     12  SC-ITEM                     PIC S9(4)   VALUE +1  COMP.
    85     12  TRANS-ID                    PIC X(04)   VALUE 'EX1F'.
    86     12  PGM-NAME                    PIC X(08).
    87     12  TIME-IN                     PIC S9(07).
    88     12  TIME-OUT-R  REDEFINES TIME-IN.
    89         16  FILLER                  PIC X(01).
    90         16  TIME-OUT                PIC 99V99.
    91         16  FILLER                  PIC X(02).
    92     12  XCTL-005                    PIC X(08)   VALUE 'EL005'.
    93     12  XCTL-010                    PIC X(08)   VALUE 'EL010'.
    94     12  XCTL-155                    PIC X(08)   VALUE 'EL155'.
    95     12  XCTL-626                    PIC X(08)   VALUE 'EL626'.
    96     12  LINK-001                    PIC X(08)   VALUE 'EL001'.
    97     12  LINK-004                    PIC X(08)   VALUE 'EL004'.
    98     12  LINK-ELDATCV                PIC X(08)   VALUE 'ELDATCV'.
    99     12  THIS-PGM                    PIC X(08)   VALUE 'EL1044'.
   100     12  ELLETR-FILE-ID              PIC X(08)   VALUE 'ELLETR'.
   101     12  ELLETR-LENGTH               PIC S9(04)  VALUE +100  COMP.
   102     12  SUB                         PIC 9(02).
   103     12  SUB-1                       PIC 9(02).
   104     12  SUB2                        PIC 9(02).
   105     12  GETMAIN-SPACE               PIC X(01)   VALUE SPACE.
   106     12  MAPSET-NAME                 PIC X(08)   VALUE 'EL1044S'.
   107     12  WS-MAP-NAME                 PIC X(08)   VALUE 'EL1044Z'.
   108     12  WS-PF-KEY                   PIC 9(02)   VALUE ZEROS.
   109****  Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
   110*                                    COPY ELCZREC.
   111******************************************************************
   112*                                                                *
   113*                                                                *
   114*                            ELCZREC.                            *
   115*                                                                *
   116*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   117*                                                                *
   118******************************************************************
   119*-----------------------------------------------------------------
   120*                   C H A N G E   L O G
   121*
   122* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   123*-----------------------------------------------------------------
   124*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   125* EFFECTIVE    NUMBER
   126*-----------------------------------------------------------------
   127* 122011    2011022800001  AJRA  NEW FILE
   128* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   129* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page   4
* EL1044.cbl
   130* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   131* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   132*-----------------------------------------------------------------
   133 01  W-Z-CONTROL-DATA.
   134     05  W-NUMBER-OF-COPIES      PIC  9.
   135     05  FILLER                  PIC  X.
   136     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   137     05  FILLER                  PIC  X.
   138     05  W-DAYS-TO-RESEND        PIC  999.
   139     05  FILLER                  PIC  X.
   140     05  W-FORM-TO-RESEND        PIC  X(4).
   141     05  W-ADD-BAR-CODE          PIC  X.
   142     05  W-PROMPT-LETTER         PIC  X.
   143     05  W-HAS-RETURN-ENV        PIC  X.
   144     05  W-ENCLOSURE-CD          PIC  XXX.
   145     05  W-SIG-FLAG-DEFAULT      PIC  X.
   146     05  W-AUTO-CLOSE-IND        PIC  X.
   147     05  FILLER                  PIC  X.
   148     05  W-LETTER-TO-BENE        PIC  X.
   149     05  FILLER                  PIC  X.
   150     05  W-LETTER-TO-ACCT        PIC  X.
   151     05  FILLER                  PIC  X.
   152     05  W-LETTER-TYPE           PIC  X.
   153     05  FILLER                  PIC  X.
   154     05  W-PRINT-CERTIFICATE     PIC  X.
   155     05  FILLER                  PIC  X.
   156     05  W-REFUND-REQUIRED       PIC  X.
   157     05  FILLER                  PIC  X.
   158     05  W-ONBASE-CODE           PIC  XX.
   159     05  FILLER                  PIC  X.
   160     05  W-ACCT-SUMM             PIC  X.
   161     05  FILLER                  PIC  X.
   162     05  W-CSO-SUMM              PIC  X.
   163     05  FILLER                  PIC  X.
   164     05  W-REASONS-REQUIRED      PIC  X.
   165     05  FILLER                  PIC  X(29).
   166*                                    COPY ELCSCTM.
   167******************************************************************
   168*                                                                *
   169*                                                                *
   170*                            ELCSCTM                             *
   171*                            VMOD=2.001                          *
   172*                                                                *
   173*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   174*                                                                *
   175******************************************************************
   176 01  SECURITY-MESSAGE.
   177     12  FILLER                          PIC X(30)
   178            VALUE '** LOGIC SECURITY VIOLATION -'.
   179     12  SM-READ                         PIC X(6).
   180     12  FILLER                          PIC X(5)
   181            VALUE ' PGM='.
   182     12  SM-PGM                          PIC X(6).
   183     12  FILLER                          PIC X(5)
   184            VALUE ' OPR='.
   185     12  SM-PROCESSOR-ID                 PIC X(4).
   186     12  FILLER                          PIC X(6)
   187            VALUE ' TERM='.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page   5
* EL1044.cbl
   188     12  SM-TERMID                       PIC X(4).
   189     12  FILLER                          PIC XX   VALUE SPACE.
   190     12  SM-JUL-DATE                     PIC 9(5).
   191     12  FILLER                          PIC X    VALUE SPACE.
   192     12  SM-TIME                         PIC 99.99.
   193
   194*                                    COPY ELCSCRTY.
   195******************************************************************
   196*                                                                *
   197*                                                                *
   198*                            ELCSCRTY                            *
   199*                            VMOD=2.001                          *
   200*                                                                *
   201*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   202*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   203*        SAVED IN PI-SECURITY-ADDRESS.                           *
   204*                                                                *
   205******************************************************************
   206 01  SECURITY-CONTROL.
   207     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   208     12  FILLER                       PIC XX    VALUE 'SC'.
   209     12  SC-CREDIT-CODES.
   210         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   211             20  SC-CREDIT-DISPLAY    PIC X.
   212             20  SC-CREDIT-UPDATE     PIC X.
   213     12  SC-CLAIMS-CODES.
   214         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   215             20  SC-CLAIMS-DISPLAY    PIC X.
   216             20  SC-CLAIMS-UPDATE     PIC X.
   217 01  ERROR-MESSAGES.
   218     12  ER-0000                     PIC X(04)   VALUE '0000'.
   219     12  ER-0005                     PIC X(04)   VALUE '0005'.
   220     12  ER-0023                     PIC X(04)   VALUE '0023'.
   221     12  ER-0029                     PIC X(04)   VALUE '0029'.
   222     12  ER-0050                     PIC X(04)   VALUE '0050'.
   223     12  ER-0068                     PIC X(04)   VALUE '0068'.
   224     12  ER-0070                     PIC X(04)   VALUE '0070'.
   225     12  ER-0130                     PIC X(04)   VALUE '0130'.
   226     12  ER-0131                     PIC X(04)   VALUE '0131'.
   227     12  ER-0132                     PIC X(04)   VALUE '0132'.
   228     12  ER-0138                     PIC X(04)   VALUE '0138'.
   229     12  ER-0144                     PIC X(04)   VALUE '0144'.
   230     12  ER-0145                     PIC X(04)   VALUE '0145'.
   231     12  ER-0184                     PIC X(04)   VALUE '0184'.
   232     12  ER-0418                     PIC X(04)   VALUE '0418'.
   233     12  ER-0491                     PIC X(04)   VALUE '0491'.
   234     12  ER-0582                     PIC X(04)   VALUE '0582'.
   235     12  ER-0627                     PIC X(04)   VALUE '0627'.
   236     12  ER-0701                     PIC X(04)   VALUE '0701'.
   237     12  ER-0702                     PIC X(04)   VALUE '0702'.
   238     12  ER-0703                     PIC X(04)   VALUE '0703'.
   239     12  ER-0704                     PIC X(04)   VALUE '0704'.
   240     12  ER-0705                     PIC X(04)   VALUE '0705'.
   241     12  ER-0706                     PIC X(04)   VALUE '0706'.
   242     12  ER-0707                     PIC X(04)   VALUE '0707'.
   243     12  ER-0708                     PIC X(04)   VALUE '0708'.
   244     12  ER-0709                     PIC X(04)   VALUE '0709'.
   245     12  ER-0710                     PIC X(04)   VALUE '0710'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page   6
* EL1044.cbl
   246     12  ER-0711                     PIC X(04)   VALUE '0711'.
   247     12  ER-0712                     PIC X(04)   VALUE '0712'.
   248     12  ER-0713                     PIC X(04)   VALUE '0713'.
   249     12  ER-0717                     PIC X(04)   VALUE '0717'.
   250     12  ER-0718                     PIC X(04)   VALUE '0718'.
   251     12  ER-0719                     PIC X(04)   VALUE '0719'.
   252     12  ER-0720                     PIC X(04)   VALUE '0720'.
   253     12  ER-0721                     PIC X(04)   VALUE '0721'.
   254     12  ER-0722                     PIC X(04)   VALUE '0722'.
   255     12  ER-0723                     PIC X(04)   VALUE '0723'.
   256     12  ER-0724                     PIC X(04)   VALUE '0724'.
   257     12  ER-0725                     PIC X(04)   VALUE '0725'.
   258     12  ER-0726                     PIC X(04)   VALUE '0726'.
   259     12  ER-0727                     PIC X(04)   VALUE '0727'.
   260     12  ER-0729                     PIC X(04)   VALUE '0729'.
   261     12  ER-0754                     PIC X(04)   VALUE '0754'.
   262     12  ER-1560                     PIC X(04)   VALUE '1560'.
   263     12  ER-1562                     PIC X(04)   VALUE '1562'.
   264     12  ER-1564                     PIC X(04)   VALUE '1564'.
   265     12  ER-2241                     PIC X(04)   VALUE '2241'.
   266     12  ER-2276                     PIC X(04)   VALUE '2276'.
   267     12  ER-3804                     PIC X(04)   VALUE '3804'.
   268     12  ER-3820                     PIC X(04)   VALUE '3820'.
   269     12  ER-3821                     PIC X(04)   VALUE '3821'.
   270     12  ER-7008                     PIC X(04)   VALUE '7008'.
   271     12  ER-7031                     PIC X(04)   VALUE '7031'.
   272     12  ER-7123                     PIC X(04)   VALUE '7123'.
   273     12  ER-8150                     PIC X(04)   VALUE '8150'.
   274     12  ER-9999                     PIC XXXX    VALUE '9999'.
   275*                                    COPY ELCDATE.
   276******************************************************************
   277*                                                                *
   278*                                                                *
   279*                            ELCDATE.                            *
   280*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   281*                            VMOD=2.003
   282*                                                                *
   283*                                                                *
   284*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   285*                 LENGTH = 200                                   *
   286******************************************************************
   287
   288 01  DATE-CONVERSION-DATA.
   289     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   290     12  DC-OPTION-CODE                PIC X.
   291         88  BIN-TO-GREG                VALUE ' '.
   292         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   293         88  EDIT-GREG-TO-BIN           VALUE '2'.
   294         88  YMD-GREG-TO-BIN            VALUE '3'.
   295         88  MDY-GREG-TO-BIN            VALUE '4'.
   296         88  JULIAN-TO-BIN              VALUE '5'.
   297         88  BIN-PLUS-ELAPSED           VALUE '6'.
   298         88  FIND-CENTURY               VALUE '7'.
   299         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   300         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   301         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   302         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   303         88  JULIAN-TO-BIN-3            VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page   7
* EL1044.cbl
   304         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   305         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   306         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   307         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   308         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   309         88  CHECK-LEAP-YEAR            VALUE 'H'.
   310         88  BIN-3-TO-GREG              VALUE 'I'.
   311         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   312         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   313         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   314         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   315         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   316         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   317         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   318         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   319         88  THREE-CHARACTER-BIN
   320                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   321         88  GREGORIAN-TO-BIN
   322                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   323         88  BIN-TO-GREGORIAN
   324                  VALUES ' ' '1' 'I' '8' 'G'.
   325         88  JULIAN-TO-BINARY
   326                  VALUES '5' 'C' 'E' 'F'.
   327     12  DC-ERROR-CODE                 PIC X.
   328         88  NO-CONVERSION-ERROR        VALUE ' '.
   329         88  DATE-CONVERSION-ERROR
   330                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   331         88  DATE-IS-ZERO               VALUE '1'.
   332         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   333         88  DATE-IS-INVALID            VALUE '3'.
   334         88  DATE1-GREATER-DATE2        VALUE '4'.
   335         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   336         88  DATE-INVALID-OPTION        VALUE '9'.
   337         88  INVALID-CENTURY            VALUE 'A'.
   338         88  ONLY-CENTURY               VALUE 'B'.
   339         88  ONLY-LEAP-YEAR             VALUE 'C'.
   340         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   341     12  DC-END-OF-MONTH               PIC X.
   342         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   343     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   344         88  USE-NORMAL-PROCESS         VALUE ' '.
   345         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   346         88  ADJUST-UP-100-YRS          VALUE '2'.
   347     12  FILLER                        PIC X.
   348     12  DC-CONVERSION-DATES.
   349         16  DC-BIN-DATE-1             PIC XX.
   350         16  DC-BIN-DATE-2             PIC XX.
   351         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   352         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   353                       DC-GREG-DATE-1-EDIT.
   354             20  DC-EDIT1-MONTH        PIC 99.
   355             20  SLASH1-1              PIC X.
   356             20  DC-EDIT1-DAY          PIC 99.
   357             20  SLASH1-2              PIC X.
   358             20  DC-EDIT1-YEAR         PIC 99.
   359         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   360         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   361                     DC-GREG-DATE-2-EDIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page   8
* EL1044.cbl
   362             20  DC-EDIT2-MONTH        PIC 99.
   363             20  SLASH2-1              PIC X.
   364             20  DC-EDIT2-DAY          PIC 99.
   365             20  SLASH2-2              PIC X.
   366             20  DC-EDIT2-YEAR         PIC 99.
   367         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   368         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   369                     DC-GREG-DATE-1-YMD.
   370             20  DC-YMD-YEAR           PIC 99.
   371             20  DC-YMD-MONTH          PIC 99.
   372             20  DC-YMD-DAY            PIC 99.
   373         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   374         16  DC-GREG-DATE-1-MDY-R REDEFINES
   375                      DC-GREG-DATE-1-MDY.
   376             20  DC-MDY-MONTH          PIC 99.
   377             20  DC-MDY-DAY            PIC 99.
   378             20  DC-MDY-YEAR           PIC 99.
   379         16  DC-GREG-DATE-1-ALPHA.
   380             20  DC-ALPHA-MONTH        PIC X(10).
   381             20  DC-ALPHA-DAY          PIC 99.
   382             20  FILLER                PIC XX.
   383             20  DC-ALPHA-CENTURY.
   384                 24 DC-ALPHA-CEN-N     PIC 99.
   385             20  DC-ALPHA-YEAR         PIC 99.
   386         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   387         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   388         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   389         16  DC-JULIAN-DATE            PIC 9(05).
   390         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   391                                       PIC 9(05).
   392         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   393             20  DC-JULIAN-YEAR        PIC 99.
   394             20  DC-JULIAN-DAYS        PIC 999.
   395         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   396         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   397         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   398     12  DATE-CONVERSION-VARIBLES.
   399         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   400         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   401             20  FILLER                PIC 9(3).
   402             20  HOLD-CEN-1-CCYY.
   403                 24  HOLD-CEN-1-CC     PIC 99.
   404                 24  HOLD-CEN-1-YY     PIC 99.
   405             20  HOLD-CEN-1-MO         PIC 99.
   406             20  HOLD-CEN-1-DA         PIC 99.
   407         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   408             20  HOLD-CEN-1-R-MO       PIC 99.
   409             20  HOLD-CEN-1-R-DA       PIC 99.
   410             20  HOLD-CEN-1-R-CCYY.
   411                 24  HOLD-CEN-1-R-CC   PIC 99.
   412                 24  HOLD-CEN-1-R-YY   PIC 99.
   413             20  FILLER                PIC 9(3).
   414         16  HOLD-CENTURY-1-X.
   415             20  FILLER                PIC X(3)  VALUE SPACES.
   416             20  HOLD-CEN-1-X-CCYY.
   417                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   418                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   419             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page   9
* EL1044.cbl
   420             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   421         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   422             20  HOLD-CEN-1-R-X-MO     PIC XX.
   423             20  HOLD-CEN-1-R-X-DA     PIC XX.
   424             20  HOLD-CEN-1-R-X-CCYY.
   425                 24  HOLD-CEN-1-R-X-CC PIC XX.
   426                 24  HOLD-CEN-1-R-X-YY PIC XX.
   427             20  FILLER                PIC XXX.
   428         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   429         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   430         16  DC-JULIAN-DATE-1          PIC 9(07).
   431         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   432             20  DC-JULIAN-1-CCYY.
   433                 24  DC-JULIAN-1-CC    PIC 99.
   434                 24  DC-JULIAN-1-YR    PIC 99.
   435             20  DC-JULIAN-DA-1        PIC 999.
   436         16  DC-JULIAN-DATE-2          PIC 9(07).
   437         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   438             20  DC-JULIAN-2-CCYY.
   439                 24  DC-JULIAN-2-CC    PIC 99.
   440                 24  DC-JULIAN-2-YR    PIC 99.
   441             20  DC-JULIAN-DA-2        PIC 999.
   442         16  DC-GREG-DATE-A-EDIT.
   443             20  DC-EDITA-MONTH        PIC 99.
   444             20  SLASHA-1              PIC X VALUE '/'.
   445             20  DC-EDITA-DAY          PIC 99.
   446             20  SLASHA-2              PIC X VALUE '/'.
   447             20  DC-EDITA-CCYY.
   448                 24  DC-EDITA-CENT     PIC 99.
   449                 24  DC-EDITA-YEAR     PIC 99.
   450         16  DC-GREG-DATE-B-EDIT.
   451             20  DC-EDITB-MONTH        PIC 99.
   452             20  SLASHB-1              PIC X VALUE '/'.
   453             20  DC-EDITB-DAY          PIC 99.
   454             20  SLASHB-2              PIC X VALUE '/'.
   455             20  DC-EDITB-CCYY.
   456                 24  DC-EDITB-CENT     PIC 99.
   457                 24  DC-EDITB-YEAR     PIC 99.
   458         16  DC-GREG-DATE-CYMD         PIC 9(08).
   459         16  DC-GREG-DATE-CYMD-R REDEFINES
   460                              DC-GREG-DATE-CYMD.
   461             20  DC-CYMD-CEN           PIC 99.
   462             20  DC-CYMD-YEAR          PIC 99.
   463             20  DC-CYMD-MONTH         PIC 99.
   464             20  DC-CYMD-DAY           PIC 99.
   465         16  DC-GREG-DATE-MDCY         PIC 9(08).
   466         16  DC-GREG-DATE-MDCY-R REDEFINES
   467                              DC-GREG-DATE-MDCY.
   468             20  DC-MDCY-MONTH         PIC 99.
   469             20  DC-MDCY-DAY           PIC 99.
   470             20  DC-MDCY-CEN           PIC 99.
   471             20  DC-MDCY-YEAR          PIC 99.
   472    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   473        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   474    12  DC-EL310-DATE                  PIC X(21).
   475    12  FILLER                         PIC X(28).
   476*                                    COPY ELCLOGOF.
   477******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  10
* EL1044.cbl
   478*                                                                *
   479*                                                                *
   480*                            ELCLOGOF.                           *
   481*                            VMOD=2.001                          *
   482*                                                                *
   483*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   484*                                                                *
   485******************************************************************
   486 01  CLASIC-LOGOFF.
   487     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   488     12  LOGOFF-TEXT.
   489         16  FILLER          PIC X(5)    VALUE SPACES.
   490         16  LOGOFF-MSG.
   491             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   492             20  FILLER      PIC X       VALUE SPACES.
   493             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   494         16  FILLER          PIC X(80)
   495           VALUE '* YOU ARE NOW LOGGED OFF'.
   496         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   497         16  FILLER          PIC X       VALUE QUOTE.
   498         16  LOGOFF-SYS-MSG  PIC X(17)
   499           VALUE 'S CLAS-IC SYSTEM '.
   500     12  TEXT-MESSAGES.
   501         16  UNACCESS-MSG    PIC X(29)
   502             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   503         16  PGMIDERR-MSG    PIC X(17)
   504             VALUE 'PROGRAM NOT FOUND'.
   505*                                    COPY ELCATTR.
   506******************************************************************
   507*                                                                *
   508*                            ELCATTR.                            *
   509*                            VMOD=2.001                          *
   510*                                                                *
   511*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   512*                                                                *
   513*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   514*                                                                *
   515*                   POS 1   P=PROTECTED                          *
   516*                           U=UNPROTECTED                        *
   517*                           S=ASKIP                              *
   518*                   POS 2   A=ALPHA/NUMERIC                      *
   519*                           N=NUMERIC                            *
   520*                   POS 3   N=NORMAL                             *
   521*                           B=BRIGHT                             *
   522*                           D=DARK                               *
   523*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   524*                           OF=MODIFIED DATA TAG OFF             *
   525*                                                                *
   526*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   527******************************************************************
   528 01  ATTRIBUTE-LIST.
   529     12  AL-PABOF            PIC X       VALUE 'Y'.
   530     12  AL-PABON            PIC X       VALUE 'Z'.
   531     12  AL-PADOF            PIC X       VALUE '%'.
   532     12  AL-PADON            PIC X       VALUE '_'.
   533     12  AL-PANOF            PIC X       VALUE '-'.
   534     12  AL-PANON            PIC X       VALUE '/'.
   535     12  AL-SABOF            PIC X       VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  11
* EL1044.cbl
   536     12  AL-SABON            PIC X       VALUE '9'.
   537     12  AL-SADOF            PIC X       VALUE '@'.
   538     12  AL-SADON            PIC X       VALUE QUOTE.
   539     12  AL-SANOF            PIC X       VALUE '0'.
   540     12  AL-SANON            PIC X       VALUE '1'.
   541     12  AL-UABOF            PIC X       VALUE 'H'.
   542     12  AL-UABON            PIC X       VALUE 'I'.
   543     12  AL-UADOF            PIC X       VALUE '<'.
   544     12  AL-UADON            PIC X       VALUE '('.
   545     12  AL-UANOF            PIC X       VALUE ' '.
   546     12  AL-UANON            PIC X       VALUE 'A'.
   547     12  AL-UNBOF            PIC X       VALUE 'Q'.
   548     12  AL-UNBON            PIC X       VALUE 'R'.
   549     12  AL-UNDOF            PIC X       VALUE '*'.
   550     12  AL-UNDON            PIC X       VALUE ')'.
   551     12  AL-UNNOF            PIC X       VALUE '&'.
   552     12  AL-UNNON            PIC X       VALUE 'J'.
   553*                                    COPY ELCEMIB.
   554******************************************************************
   555*                                                                *
   556*                                                                *
   557*                            ELCEMIB.                            *
   558*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   559*                            VMOD=2.005                          *
   560*                                                                *
   561*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   562*                                                                *
   563******************************************************************
   564 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   565     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   566     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   567     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   568     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   569     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   570     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   571     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   572     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   573     12  EMI-SWITCH1             PIC X        VALUE '1'.
   574         88  EMI-NO-ERRORS                    VALUE '1'.
   575         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   576         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   577     12  EMI-SWITCH2             PIC X        VALUE '1'.
   578         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   579     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   580         88  EMI-AREA1-EMPTY                  VALUE '1'.
   581         88  EMI-AREA1-FULL                   VALUE '2'.
   582     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   583         88  EMI-AREA2-EMPTY                  VALUE '1'.
   584         88  EMI-AREA2-FULL                   VALUE '2'.
   585     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   586         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   587         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   588         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   589         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   590         88  EMI-BYPASS-FATALS                VALUE 'X'.
   591     12  EMI-ERROR-LINES.
   592         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   593         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  12
* EL1044.cbl
   594         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   595         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   596             20  EMI-ERR-CODES OCCURS 10 TIMES.
   597                 24  EMI-ERR-NUM         PIC X(4).
   598                 24  EMI-FILLER          PIC X.
   599                 24  EMI-SEV             PIC X.
   600                 24  FILLER              PIC X.
   601             20  FILLER                  PIC X(02).
   602     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   603         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   604             20  EMI-ERROR-NUMBER    PIC X(4).
   605             20  EMI-FILL            PIC X.
   606             20  EMI-SEVERITY        PIC X.
   607             20  FILLER              PIC X.
   608             20  EMI-ERROR-TEXT.
   609                 24  EMI-TEXT-VARIABLE   PIC X(10).
   610                 24  FILLER          PIC X(55).
   611     12  EMI-SEVERITY-SAVE           PIC X.
   612         88  EMI-NOTE                    VALUE 'N'.
   613         88  EMI-WARNING                 VALUE 'W'.
   614         88  EMI-FORCABLE                VALUE 'F'.
   615         88  EMI-FATAL                   VALUE 'X'.
   616     12  EMI-MESSAGE-FLAG            PIC X.
   617         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   618         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   619     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   620     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   621         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   622         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   623         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   624     12  emi-claim-no                pic x(7).
   625     12  emi-claim-type              pic x(6).
   626     12  FILLER                      PIC X(124)  VALUE SPACES.
   627     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   628     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   629     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   630     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   631*                                    COPY ELCJPFX.
   632******************************************************************
   633*                                                                *
   634*                                                                *
   635*                            ELCJPFX.                            *
   636*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   637*                            VMOD=2.002                          *
   638*                                                                *
   639*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   640*                                                                *
   641*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   642*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   643*        ELCNTL - CONTROL FILE                                   *
   644*        ELMSTR - CLAIM MASTERS                                  *
   645*        ELTRLR - ACTIVITY TRAILERS                              *
   646*        ELCHKQ - CHECK QUE                                      *
   647******************************************************************
   648 01  JOURNAL-RECORD.
   649     12  jp-date                     pic s9(5) comp-3.
   650     12  jp-time                     pic s9(7) comp-3.
   651     12  JP-USER-ID                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  13
* EL1044.cbl
   652     12  JP-FILE-ID                  PIC X(8).
   653     12  JP-PROGRAM-ID               PIC X(8).
   654     12  JP-RECORD-TYPE              PIC X.
   655         88 JP-ADD              VALUE 'A'.
   656         88 JP-BEFORE-CHANGE    VALUE 'B'.
   657         88 JP-AFTER-CHANGE     VALUE 'C'.
   658         88 JP-DELETE           VALUE 'D'.
   659         88 JP-GENERIC-DELETE   VALUE 'G'.
   660         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   661         88 JP-KEY-CHG-ADD      VALUE 'N'.
   662     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   663     12  JP-RECORD-AREA
   664
   665
   666                                     PIC X(530).
   667*                                    COPY ELCINTF.
   668******************************************************************
   669*                                                                *
   670*                                                                *
   671*                            ELCINTF.                            *
   672*                            VMOD=2.017                          *
   673*                                                                *
   674*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   675*                                                                *
   676*       LENGTH = 1024                                            *
   677*                                                                *
   678******************************************************************
   679*                   C H A N G E   L O G
   680*
   681* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   682*-----------------------------------------------------------------
   683*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   684* EFFECTIVE    NUMBER
   685*-----------------------------------------------------------------
   686* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   687******************************************************************
   688 01  PROGRAM-INTERFACE-BLOCK.
   689     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   690     12  PI-CALLING-PROGRAM              PIC X(8).
   691     12  PI-SAVED-PROGRAM-1              PIC X(8).
   692     12  PI-SAVED-PROGRAM-2              PIC X(8).
   693     12  PI-SAVED-PROGRAM-3              PIC X(8).
   694     12  PI-SAVED-PROGRAM-4              PIC X(8).
   695     12  PI-SAVED-PROGRAM-5              PIC X(8).
   696     12  PI-SAVED-PROGRAM-6              PIC X(8).
   697     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   698     12  PI-COMPANY-ID                   PIC XXX.
   699     12  PI-COMPANY-CD                   PIC X.
   700
   701     12  PI-COMPANY-PASSWORD             PIC X(8).
   702
   703     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   704
   705     12  PI-CONTROL-IN-PROGRESS.
   706         16  PI-CARRIER                  PIC X.
   707         16  PI-GROUPING                 PIC X(6).
   708         16  PI-STATE                    PIC XX.
   709         16  PI-ACCOUNT                  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  14
* EL1044.cbl
   710         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   711                                         PIC X(10).
   712         16  PI-CLAIM-CERT-GRP.
   713             20  PI-CLAIM-NO             PIC X(7).
   714             20  PI-CERT-NO.
   715                 25  PI-CERT-PRIME       PIC X(10).
   716                 25  PI-CERT-SFX         PIC X.
   717             20  PI-CERT-EFF-DT          PIC XX.
   718         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   719             20  PI-PLAN-CODE            PIC X(2).
   720             20  PI-REVISION-NUMBER      PIC X(3).
   721             20  PI-PLAN-EFF-DT          PIC X(2).
   722             20  PI-PLAN-EXP-DT          PIC X(2).
   723             20  FILLER                  PIC X(11).
   724         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   725             20  PI-OE-REFERENCE-1.
   726                 25  PI-OE-REF-1-PRIME   PIC X(18).
   727                 25  PI-OE-REF-1-SUFF    PIC XX.
   728
   729     12  PI-SESSION-IN-PROGRESS          PIC X.
   730         88  CLAIM-SESSION                   VALUE '1'.
   731         88  CREDIT-SESSION                  VALUE '2'.
   732         88  WARRANTY-SESSION                VALUE '3'.
   733         88  MORTGAGE-SESSION                VALUE '4'.
   734         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   735
   736
   737*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   738
   739     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   740     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   741
   742     12  PI-CREDIT-USER                  PIC X.
   743         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   744         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   745
   746     12  PI-CLAIM-USER                   PIC X.
   747         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   748         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   749
   750     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   751         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   752         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   753         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   754         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   755         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   756
   757     12  PI-PROCESSOR-ID                 PIC X(4).
   758
   759     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   760
   761     12  PI-MEMBER-CAPTION               PIC X(10).
   762
   763     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   764         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   765
   766     12  PI-LIFE-OVERRIDE-L1             PIC X.
   767     12  PI-LIFE-OVERRIDE-L2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  15
* EL1044.cbl
   768     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   769     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   770
   771     12  PI-AH-OVERRIDE-L1               PIC X.
   772     12  PI-AH-OVERRIDE-L2               PIC XX.
   773     12  PI-AH-OVERRIDE-L6               PIC X(6).
   774     12  PI-AH-OVERRIDE-L12              PIC X(12).
   775
   776     12  PI-NEW-SYSTEM                   PIC X(2).
   777
   778     12  PI-PRIMARY-CERT-NO              PIC X(11).
   779     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   780         88  PI-USES-PAID-TO                 VALUE '1'.
   781     12  PI-CRDTCRD-SYSTEM.
   782         16  PI-CRDTCRD-USER             PIC X.
   783             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   784             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   785         16  PI-CC-MONTH-END-DT          PIC XX.
   786     12  PI-PROCESSOR-PRINTER            PIC X(4).
   787
   788     12  PI-OE-REFERENCE-2.
   789         16  PI-OE-REF-2-PRIME           PIC X(10).
   790         16  PI-OE-REF-2-SUFF            PIC X.
   791
   792     12  PI-REM-TRM-CALC-OPTION          PIC X.
   793
   794     12  PI-LANGUAGE-TYPE                PIC X.
   795             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   796             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   797             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   798
   799     12  PI-POLICY-LINKAGE-IND           PIC X.
   800         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   801         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   802                                                   LOW-VALUES.
   803
   804     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   805     12  PI-CLAIM-PW-SESSION             PIC X(1).
   806         88  PI-CLAIM-CREDIT                 VALUE '1'.
   807         88  PI-CLAIM-CONVEN                 VALUE '2'.
   808
   809     12  PI-PROCESSOR-CSR-IND            PIC X.
   810         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   811         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   812
   813     12  FILLER                          PIC X(3).
   814
   815     12  PI-SYSTEM-LEVEL                 PIC X(145).
   816
   817     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   818         PI-SYSTEM-LEVEL.
   819
   820         16  PI-ENTRY-CODES.
   821             20  PI-ENTRY-CD-1           PIC X.
   822             20  PI-ENTRY-CD-2           PIC X.
   823
   824         16  PI-RETURN-CODES.
   825             20  PI-RETURN-CD-1          PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  16
* EL1044.cbl
   826             20  PI-RETURN-CD-2          PIC X.
   827
   828         16  PI-UPDATE-STATUS-SAVE.
   829             20  PI-UPDATE-BY            PIC X(4).
   830             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   831
   832         16  PI-LOWER-CASE-LETTERS       PIC X.
   833             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   834
   835*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   836*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   837*            88  CARRIER-CLM-CNTL            VALUE '2'.
   838
   839         16  PI-CERT-ACCESS-CONTROL      PIC X.
   840             88  ST-ACCNT-CNTL               VALUE ' '.
   841             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   842             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   843             88  ACCNT-CNTL                  VALUE '3'.
   844             88  CARR-ACCNT-CNTL             VALUE '4'.
   845
   846         16  PI-PROCESSOR-CAP-LIST.
   847             20  PI-SYSTEM-CONTROLS.
   848                24 PI-SYSTEM-DISPLAY     PIC X.
   849                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   850                24 PI-SYSTEM-MODIFY      PIC X.
   851                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   852             20  FILLER                  PIC XX.
   853             20  PI-DISPLAY-CAP          PIC X.
   854                 88  DISPLAY-CAP             VALUE 'Y'.
   855             20  PI-MODIFY-CAP           PIC X.
   856                 88  MODIFY-CAP              VALUE 'Y'.
   857             20  PI-MSG-AT-LOGON-CAP     PIC X.
   858                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   859             20  PI-FORCE-CAP            PIC X.
   860                 88  FORCE-CAP               VALUE 'Y'.
   861
   862         16  PI-PROGRAM-CONTROLS.
   863             20  PI-PGM-PRINT-OPT        PIC X.
   864             20  PI-PGM-FORMAT-OPT       PIC X.
   865             20  PI-PGM-PROCESS-OPT      PIC X.
   866             20  PI-PGM-TOTALS-OPT       PIC X.
   867
   868         16  PI-HELP-INTERFACE.
   869             20  PI-LAST-ERROR-NO        PIC X(4).
   870             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   871
   872         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   873             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   874
   875         16  PI-CR-CONTROL-IN-PROGRESS.
   876             20  PI-CR-CARRIER           PIC X.
   877             20  PI-CR-GROUPING          PIC X(6).
   878             20  PI-CR-STATE             PIC XX.
   879             20  PI-CR-ACCOUNT           PIC X(10).
   880             20  PI-CR-FIN-RESP          PIC X(10).
   881             20  PI-CR-TYPE              PIC X.
   882
   883         16  PI-CR-BATCH-NUMBER          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  17
* EL1044.cbl
   884
   885         16  PI-CR-MONTH-END-DT          PIC XX.
   886
   887         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   888             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   889             88  PI-ZERO-CARRIER             VALUE '1'.
   890             88  PI-ZERO-GROUPING            VALUE '2'.
   891             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   892
   893         16  PI-CARRIER-SECURITY         PIC X.
   894             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   895
   896         16  PI-ACCOUNT-SECURITY         PIC X(10).
   897             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   898             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   899
   900         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   901             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   902                                         INDEXED BY PI-ACCESS-NDX
   903                                         PIC X.
   904
   905         16  PI-GA-BILLING-CONTROL       PIC X.
   906             88  PI-GA-BILLING               VALUE '1'.
   907
   908         16  PI-MAIL-PROCESSING          PIC X.
   909             88  PI-MAIL-YES                 VALUE 'Y'.
   910
   911         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   912
   913         16  PI-AR-SYSTEM.
   914             20  PI-AR-PROCESSING-CNTL   PIC X.
   915                 88  PI-AR-PROCESSING        VALUE 'Y'.
   916             20  PI-AR-SUMMARY-CODE      PIC X(6).
   917             20  PI-AR-MONTH-END-DT      PIC XX.
   918
   919         16  PI-MP-SYSTEM.
   920             20  PI-MORTGAGE-USER            PIC X.
   921                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   922                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   923             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   924                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   925                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   926                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   927                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   928                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   929             20  PI-MP-MONTH-END-DT          PIC XX.
   930             20  PI-MP-REFERENCE-NO.
   931                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   932                 24  PI-MP-REFERENCE-SFX     PIC XX.
   933
   934         16  PI-LABEL-CONTROL            PIC X(01).
   935             88  PI-CREATE-LABELS                    VALUE 'Y'.
   936             88  PI-BYPASS-LABELS                    VALUE 'N'.
   937
   938         16  PI-BILL-GROUPING-CODE       PIC X(01).
   939             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   940
   941         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  18
* EL1044.cbl
   942             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   943             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   944
   945         16  FILLER                      PIC X(14).
   946
   947     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   948******************************************************************
   949     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   950*                                    COPY ELC1042.
   951******************************************************************
   952*                                                                *
   953*                                                                *
   954*                           ELC1042                              *
   955*                            VMOD=2.002                          *
   956*                                                                *
   957*    NOTE                                                        *
   958*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   959*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   960*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   961*        TO THESE PROGRAMS.                                      *
   962*                                                                *
   963*    NOTE                                                        *
   964*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   965*        USE ONLY!                                               *
   966*                                                                *
   967******************************************************************
   968
   969         16  PI-1042-WA.
   970             20  PI-ACTION       PIC  X(01).
   971                 88 PI-SHOW-MODE           VALUE '1'.
   972                 88 PI-CLEAR-MODE          VALUE '2'.
   973                 88 PI-CREATE-MODE         VALUE '3'.
   974             20  PI-COMM-CONTROL PIC  X(12).
   975             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   976             20  PI-EOF-SW       PIC  X(01).
   977                 88  PI-FILE-EOF           VALUE 'Y'.
   978             20  PI-FILETYP      PIC  X(01).
   979             20  PI-FORM-SQUEEZE-CONTROL
   980                                 PIC  X(01).
   981                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   982                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   983             20  PI-LAST-CONTROL PIC  X(12).
   984             20  PI-TEMP-STOR-ITEMS
   985                                 PIC S9(04) COMP.
   986             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   987             20  PI-UPDATE-SW    PIC  9(01).
   988                 88 ANY-UPDATES            VALUE 1.
   989             20  PI-104-SCREEN-SENT-IND
   990                                 PIC  X(01).
   991                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   992                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   993             20  PI-1042-SCREEN-SENT-IND
   994                                 PIC  X(01).
   995                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   996                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
   997             20  PI-1042-ARCHIVE-IND
   998                                 PIC  X(01).
   999                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  19
* EL1044.cbl
  1000             20  FILLER          PIC  X(29).
  1001         16  PI-PREV-LETR-KEY        PIC X(15).
  1002         16  PI-CURR-LETR-KEY        PIC X(15).
  1003         16  PI-UPDATE-DT            PIC XX.
  1004         16  FILLER                  PIC X(556).
  1005*                                    COPY ELCAID.
  1006******************************************************************
  1007*                                                                *
  1008*                            ELCAID.                             *
  1009*                            VMOD=2.001                          *
  1010*                                                                *
  1011*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1012*                                                                *
  1013*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1014*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1015******************************************************************
  1016
  1017 01  DFHAID.
  1018   02  DFHNULL   PIC  X  VALUE  ' '.
  1019   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1020   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1021   02  DFHPEN    PIC  X  VALUE  '='.
  1022   02  DFHOPID   PIC  X  VALUE  'W'.
  1023   02  DFHPA1    PIC  X  VALUE  '%'.
  1024   02  DFHPA2    PIC  X  VALUE  '>'.
  1025   02  DFHPA3    PIC  X  VALUE  ','.
  1026   02  DFHPF1    PIC  X  VALUE  '1'.
  1027   02  DFHPF2    PIC  X  VALUE  '2'.
  1028   02  DFHPF3    PIC  X  VALUE  '3'.
  1029   02  DFHPF4    PIC  X  VALUE  '4'.
  1030   02  DFHPF5    PIC  X  VALUE  '5'.
  1031   02  DFHPF6    PIC  X  VALUE  '6'.
  1032   02  DFHPF7    PIC  X  VALUE  '7'.
  1033   02  DFHPF8    PIC  X  VALUE  '8'.
  1034   02  DFHPF9    PIC  X  VALUE  '9'.
  1035   02  DFHPF10   PIC  X  VALUE  ':'.
  1036   02  DFHPF11   PIC  X  VALUE  '#'.
  1037   02  DFHPF12   PIC  X  VALUE  '@'.
  1038   02  DFHPF13   PIC  X  VALUE  'A'.
  1039   02  DFHPF14   PIC  X  VALUE  'B'.
  1040   02  DFHPF15   PIC  X  VALUE  'C'.
  1041   02  DFHPF16   PIC  X  VALUE  'D'.
  1042   02  DFHPF17   PIC  X  VALUE  'E'.
  1043   02  DFHPF18   PIC  X  VALUE  'F'.
  1044   02  DFHPF19   PIC  X  VALUE  'G'.
  1045   02  DFHPF20   PIC  X  VALUE  'H'.
  1046   02  DFHPF21   PIC  X  VALUE  'I'.
  1047*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1048   02  DFHPF22   PIC  X  VALUE  '['.
  1049   02  DFHPF23   PIC  X  VALUE  '.'.
  1050   02  DFHPF24   PIC  X  VALUE  '<'.
  1051   02  DFHMSRE   PIC  X  VALUE  'X'.
  1052   02  DFHSTRF   PIC  X  VALUE  'h'.
  1053   02  DFHTRIG   PIC  X  VALUE  '"'.
  1054 01  FILLER    REDEFINES DFHAID.
  1055     12  FILLER                      PIC X(08).
  1056     12  PF-VALUES                   PIC X         OCCURS 24.
  1057*                                    COPY EL1044S.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  20
* EL1044.cbl
  1058 01  EL1044ZI.
  1059     05  FILLER            PIC  X(0012).
  1060*    -------------------------------
  1061     05  DATEL PIC S9(0004) COMP.
  1062     05  DATEF PIC  X(0001).
  1063     05  FILLER REDEFINES DATEF.
  1064         10  DATEA PIC  X(0001).
  1065     05  FILLER            PIC  X(3).
  1066     05  DATEI PIC  X(0008).
  1067*    -------------------------------
  1068     05  TIMEL PIC S9(0004) COMP.
  1069     05  TIMEF PIC  X(0001).
  1070     05  FILLER REDEFINES TIMEF.
  1071         10  TIMEA PIC  X(0001).
  1072     05  FILLER            PIC  X(3).
  1073     05  TIMEI PIC  X(0005).
  1074*    -------------------------------
  1075     05  CMPNYIDL PIC S9(0004) COMP.
  1076     05  CMPNYIDF PIC  X(0001).
  1077     05  FILLER REDEFINES CMPNYIDF.
  1078         10  CMPNYIDA PIC  X(0001).
  1079     05  FILLER            PIC  X(3).
  1080     05  CMPNYIDI PIC  X(0003).
  1081*    -------------------------------
  1082     05  USERIDL PIC S9(0004) COMP.
  1083     05  USERIDF PIC  X(0001).
  1084     05  FILLER REDEFINES USERIDF.
  1085         10  USERIDA PIC  X(0001).
  1086     05  FILLER            PIC  X(3).
  1087     05  USERIDI PIC  X(0004).
  1088*    -------------------------------
  1089     05  MAINTL PIC S9(0004) COMP.
  1090     05  MAINTF PIC  X(0001).
  1091     05  FILLER REDEFINES MAINTF.
  1092         10  MAINTA PIC  X(0001).
  1093     05  FILLER            PIC  X(3).
  1094     05  MAINTI PIC  X(0001).
  1095*    -------------------------------
  1096     05  LSTUSRL PIC S9(0004) COMP.
  1097     05  LSTUSRF PIC  X(0001).
  1098     05  FILLER REDEFINES LSTUSRF.
  1099         10  LSTUSRA PIC  X(0001).
  1100     05  FILLER            PIC  X(3).
  1101     05  LSTUSRI PIC  X(0004).
  1102*    -------------------------------
  1103     05  LSTDTEL PIC S9(0004) COMP.
  1104     05  LSTDTEF PIC  X(0001).
  1105     05  FILLER REDEFINES LSTDTEF.
  1106         10  LSTDTEA PIC  X(0001).
  1107     05  FILLER            PIC  X(3).
  1108     05  LSTDTEI PIC  X(0008).
  1109*    -------------------------------
  1110     05  ZLETRL PIC S9(0004) COMP.
  1111     05  ZLETRF PIC  X(0001).
  1112     05  FILLER REDEFINES ZLETRF.
  1113         10  ZLETRA PIC  X(0001).
  1114     05  FILLER            PIC  X(3).
  1115     05  ZLETRI PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  21
* EL1044.cbl
  1116*    -------------------------------
  1117     05  ZCOPIESL PIC S9(0004) COMP.
  1118     05  ZCOPIESF PIC  X(0001).
  1119     05  FILLER REDEFINES ZCOPIESF.
  1120         10  ZCOPIESA PIC  X(0001).
  1121     05  FILLER            PIC  X(3).
  1122     05  ZCOPIESI PIC  X(0001).
  1123*    -------------------------------
  1124     05  ZPROMPTL PIC S9(0004) COMP.
  1125     05  ZPROMPTF PIC  X(0001).
  1126     05  FILLER REDEFINES ZPROMPTF.
  1127         10  ZPROMPTA PIC  X(0001).
  1128     05  FILLER            PIC  X(3).
  1129     05  ZPROMPTI PIC  X(0001).
  1130*    -------------------------------
  1131     05  ZENCCDL PIC S9(0004) COMP.
  1132     05  ZENCCDF PIC  X(0001).
  1133     05  FILLER REDEFINES ZENCCDF.
  1134         10  ZENCCDA PIC  X(0001).
  1135     05  FILLER            PIC  X(3).
  1136     05  ZENCCDI PIC  X(0003).
  1137*    -------------------------------
  1138     05  ZRDAYSL PIC S9(0004) COMP.
  1139     05  ZRDAYSF PIC  X(0001).
  1140     05  FILLER REDEFINES ZRDAYSF.
  1141         10  ZRDAYSA PIC  X(0001).
  1142     05  FILLER            PIC  X(3).
  1143     05  ZRDAYSI PIC  X(0003).
  1144*    -------------------------------
  1145     05  ZFORML PIC S9(0004) COMP.
  1146     05  ZFORMF PIC  X(0001).
  1147     05  FILLER REDEFINES ZFORMF.
  1148         10  ZFORMA PIC  X(0001).
  1149     05  FILLER            PIC  X(3).
  1150     05  ZFORMI PIC  X(0004).
  1151*    -------------------------------
  1152     05  ZBENEL PIC S9(0004) COMP.
  1153     05  ZBENEF PIC  X(0001).
  1154     05  FILLER REDEFINES ZBENEF.
  1155         10  ZBENEA PIC  X(0001).
  1156     05  FILLER            PIC  X(3).
  1157     05  ZBENEI PIC  X(0001).
  1158*    -------------------------------
  1159     05  ZACCTL PIC S9(0004) COMP.
  1160     05  ZACCTF PIC  X(0001).
  1161     05  FILLER REDEFINES ZACCTF.
  1162         10  ZACCTA PIC  X(0001).
  1163     05  FILLER            PIC  X(3).
  1164     05  ZACCTI PIC  X(0001).
  1165*    -------------------------------
  1166     05  ZTYPEL PIC S9(0004) COMP.
  1167     05  ZTYPEF PIC  X(0001).
  1168     05  FILLER REDEFINES ZTYPEF.
  1169         10  ZTYPEA PIC  X(0001).
  1170     05  FILLER            PIC  X(3).
  1171     05  ZTYPEI PIC  X(0001).
  1172*    -------------------------------
  1173     05  ZPRTCRTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  22
* EL1044.cbl
  1174     05  ZPRTCRTF PIC  X(0001).
  1175     05  FILLER REDEFINES ZPRTCRTF.
  1176         10  ZPRTCRTA PIC  X(0001).
  1177     05  FILLER            PIC  X(3).
  1178     05  ZPRTCRTI PIC  X(0001).
  1179*    -------------------------------
  1180     05  ZREFREQL PIC S9(0004) COMP.
  1181     05  ZREFREQF PIC  X(0001).
  1182     05  FILLER REDEFINES ZREFREQF.
  1183         10  ZREFREQA PIC  X(0001).
  1184     05  FILLER            PIC  X(3).
  1185     05  ZREFREQI PIC  X(0001).
  1186*    -------------------------------
  1187     05  ZONBASEL PIC S9(0004) COMP.
  1188     05  ZONBASEF PIC  X(0001).
  1189     05  FILLER REDEFINES ZONBASEF.
  1190         10  ZONBASEA PIC  X(0001).
  1191     05  FILLER            PIC  X(3).
  1192     05  ZONBASEI PIC  X(0002).
  1193*    -------------------------------
  1194     05  ZACTSUML PIC S9(0004) COMP.
  1195     05  ZACTSUMF PIC  X(0001).
  1196     05  FILLER REDEFINES ZACTSUMF.
  1197         10  ZACTSUMA PIC  X(0001).
  1198     05  FILLER            PIC  X(3).
  1199     05  ZACTSUMI PIC  X(0001).
  1200*    -------------------------------
  1201     05  ZCSOSUML PIC S9(0004) COMP.
  1202     05  ZCSOSUMF PIC  X(0001).
  1203     05  FILLER REDEFINES ZCSOSUMF.
  1204         10  ZCSOSUMA PIC  X(0001).
  1205     05  FILLER            PIC  X(3).
  1206     05  ZCSOSUMI PIC  X(0001).
  1207*    -------------------------------
  1208     05  ZREASONL PIC S9(0004) COMP.
  1209     05  ZREASONF PIC  X(0001).
  1210     05  FILLER REDEFINES ZREASONF.
  1211         10  ZREASONA PIC  X(0001).
  1212     05  FILLER            PIC  X(3).
  1213     05  ZREASONI PIC  X(0001).
  1214*    -------------------------------
  1215     05  ZBARCODL PIC S9(0004) COMP.
  1216     05  ZBARCODF PIC  X(0001).
  1217     05  FILLER REDEFINES ZBARCODF.
  1218         10  ZBARCODA PIC  X(0001).
  1219     05  FILLER            PIC  X(3).
  1220     05  ZBARCODI PIC  X(0001).
  1221*    -------------------------------
  1222     05  ZRETENVL PIC S9(0004) COMP.
  1223     05  ZRETENVF PIC  X(0001).
  1224     05  FILLER REDEFINES ZRETENVF.
  1225         10  ZRETENVA PIC  X(0001).
  1226     05  FILLER            PIC  X(3).
  1227     05  ZRETENVI PIC  X(0001).
  1228*    -------------------------------
  1229     05  ZSIGFLGL PIC S9(0004) COMP.
  1230     05  ZSIGFLGF PIC  X(0001).
  1231     05  FILLER REDEFINES ZSIGFLGF.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  23
* EL1044.cbl
  1232         10  ZSIGFLGA PIC  X(0001).
  1233     05  FILLER            PIC  X(3).
  1234     05  ZSIGFLGI PIC  X(0001).
  1235*    -------------------------------
  1236     05  ZFADAYSL PIC S9(0004) COMP.
  1237     05  ZFADAYSF PIC  X(0001).
  1238     05  FILLER REDEFINES ZFADAYSF.
  1239         10  ZFADAYSA PIC  X(0001).
  1240     05  FILLER            PIC  X(3).
  1241     05  ZFADAYSI PIC  X(0003).
  1242*    -------------------------------
  1243     05  ZACLOSEL PIC S9(0004) COMP.
  1244     05  ZACLOSEF PIC  X(0001).
  1245     05  FILLER REDEFINES ZACLOSEF.
  1246         10  ZACLOSEA PIC  X(0001).
  1247     05  FILLER            PIC  X(3).
  1248     05  ZACLOSEI PIC  X(0001).
  1249*    -------------------------------
  1250     05  ERRMSGL PIC S9(0004) COMP.
  1251     05  ERRMSGF PIC  X(0001).
  1252     05  FILLER REDEFINES ERRMSGF.
  1253         10  ERRMSGA PIC  X(0001).
  1254     05  FILLER            PIC  X(3).
  1255     05  ERRMSGI PIC  X(0072).
  1256*    -------------------------------
  1257     05  PFKEYL PIC S9(0004) COMP.
  1258     05  PFKEYF PIC  X(0001).
  1259     05  FILLER REDEFINES PFKEYF.
  1260         10  PFKEYA PIC  X(0001).
  1261     05  FILLER            PIC  X(3).
  1262     05  PFKEYI PIC  99.
  1263 01  EL1044ZO REDEFINES EL1044ZI.
  1264     05  FILLER            PIC  X(0012).
  1265*    -------------------------------
  1266     05  FILLER            PIC  X(3).
  1267     05  DATEC PIC  X(0001).
  1268     05  DATEH PIC  X(0001).
  1269     05  DATEU PIC  X(0001).
  1270     05  DATEO PIC  X(0008).
  1271*    -------------------------------
  1272     05  FILLER            PIC  X(3).
  1273     05  TIMEC PIC  X(0001).
  1274     05  TIMEH PIC  X(0001).
  1275     05  TIMEU PIC  X(0001).
  1276     05  TIMEO PIC  99.99.
  1277*    -------------------------------
  1278     05  FILLER            PIC  X(3).
  1279     05  CMPNYIDC PIC  X(0001).
  1280     05  CMPNYIDH PIC  X(0001).
  1281     05  CMPNYIDU PIC  X(0001).
  1282     05  CMPNYIDO PIC  X(0003).
  1283*    -------------------------------
  1284     05  FILLER            PIC  X(3).
  1285     05  USERIDC PIC  X(0001).
  1286     05  USERIDH PIC  X(0001).
  1287     05  USERIDU PIC  X(0001).
  1288     05  USERIDO PIC  X(0004).
  1289*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  24
* EL1044.cbl
  1290     05  FILLER            PIC  X(3).
  1291     05  MAINTC PIC  X(0001).
  1292     05  MAINTH PIC  X(0001).
  1293     05  MAINTU PIC  X(0001).
  1294     05  MAINTO PIC  X(0001).
  1295*    -------------------------------
  1296     05  FILLER            PIC  X(3).
  1297     05  LSTUSRC PIC  X(0001).
  1298     05  LSTUSRH PIC  X(0001).
  1299     05  LSTUSRU PIC  X(0001).
  1300     05  LSTUSRO PIC  X(0004).
  1301*    -------------------------------
  1302     05  FILLER            PIC  X(3).
  1303     05  LSTDTEC PIC  X(0001).
  1304     05  LSTDTEH PIC  X(0001).
  1305     05  LSTDTEU PIC  X(0001).
  1306     05  LSTDTEO PIC  X(0008).
  1307*    -------------------------------
  1308     05  FILLER            PIC  X(3).
  1309     05  ZLETRC PIC  X(0001).
  1310     05  ZLETRH PIC  X(0001).
  1311     05  ZLETRU PIC  X(0001).
  1312     05  ZLETRO PIC  X(0004).
  1313*    -------------------------------
  1314     05  FILLER            PIC  X(3).
  1315     05  ZCOPIESC PIC  X(0001).
  1316     05  ZCOPIESH PIC  X(0001).
  1317     05  ZCOPIESU PIC  X(0001).
  1318     05  ZCOPIESO PIC  9.
  1319*    -------------------------------
  1320     05  FILLER            PIC  X(3).
  1321     05  ZPROMPTC PIC  X(0001).
  1322     05  ZPROMPTH PIC  X(0001).
  1323     05  ZPROMPTU PIC  X(0001).
  1324     05  ZPROMPTO PIC  X(0001).
  1325*    -------------------------------
  1326     05  FILLER            PIC  X(3).
  1327     05  ZENCCDC PIC  X(0001).
  1328     05  ZENCCDH PIC  X(0001).
  1329     05  ZENCCDU PIC  X(0001).
  1330     05  ZENCCDO PIC  X(0003).
  1331*    -------------------------------
  1332     05  FILLER            PIC  X(3).
  1333     05  ZRDAYSC PIC  X(0001).
  1334     05  ZRDAYSH PIC  X(0001).
  1335     05  ZRDAYSU PIC  X(0001).
  1336     05  ZRDAYSO PIC  999.
  1337*    -------------------------------
  1338     05  FILLER            PIC  X(3).
  1339     05  ZFORMC PIC  X(0001).
  1340     05  ZFORMH PIC  X(0001).
  1341     05  ZFORMU PIC  X(0001).
  1342     05  ZFORMO PIC  X(0004).
  1343*    -------------------------------
  1344     05  FILLER            PIC  X(3).
  1345     05  ZBENEC PIC  X(0001).
  1346     05  ZBENEH PIC  X(0001).
  1347     05  ZBENEU PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  25
* EL1044.cbl
  1348     05  ZBENEO PIC  X(0001).
  1349*    -------------------------------
  1350     05  FILLER            PIC  X(3).
  1351     05  ZACCTC PIC  X(0001).
  1352     05  ZACCTH PIC  X(0001).
  1353     05  ZACCTU PIC  X(0001).
  1354     05  ZACCTO PIC  X(0001).
  1355*    -------------------------------
  1356     05  FILLER            PIC  X(3).
  1357     05  ZTYPEC PIC  X(0001).
  1358     05  ZTYPEH PIC  X(0001).
  1359     05  ZTYPEU PIC  X(0001).
  1360     05  ZTYPEO PIC  X(0001).
  1361*    -------------------------------
  1362     05  FILLER            PIC  X(3).
  1363     05  ZPRTCRTC PIC  X(0001).
  1364     05  ZPRTCRTH PIC  X(0001).
  1365     05  ZPRTCRTU PIC  X(0001).
  1366     05  ZPRTCRTO PIC  X(0001).
  1367*    -------------------------------
  1368     05  FILLER            PIC  X(3).
  1369     05  ZREFREQC PIC  X(0001).
  1370     05  ZREFREQH PIC  X(0001).
  1371     05  ZREFREQU PIC  X(0001).
  1372     05  ZREFREQO PIC  X(0001).
  1373*    -------------------------------
  1374     05  FILLER            PIC  X(3).
  1375     05  ZONBASEC PIC  X(0001).
  1376     05  ZONBASEH PIC  X(0001).
  1377     05  ZONBASEU PIC  X(0001).
  1378     05  ZONBASEO PIC  X(0002).
  1379*    -------------------------------
  1380     05  FILLER            PIC  X(3).
  1381     05  ZACTSUMC PIC  X(0001).
  1382     05  ZACTSUMH PIC  X(0001).
  1383     05  ZACTSUMU PIC  X(0001).
  1384     05  ZACTSUMO PIC  X(0001).
  1385*    -------------------------------
  1386     05  FILLER            PIC  X(3).
  1387     05  ZCSOSUMC PIC  X(0001).
  1388     05  ZCSOSUMH PIC  X(0001).
  1389     05  ZCSOSUMU PIC  X(0001).
  1390     05  ZCSOSUMO PIC  X(0001).
  1391*    -------------------------------
  1392     05  FILLER            PIC  X(3).
  1393     05  ZREASONC PIC  X(0001).
  1394     05  ZREASONH PIC  X(0001).
  1395     05  ZREASONU PIC  X(0001).
  1396     05  ZREASONO PIC  X(0001).
  1397*    -------------------------------
  1398     05  FILLER            PIC  X(3).
  1399     05  ZBARCODC PIC  X(0001).
  1400     05  ZBARCODH PIC  X(0001).
  1401     05  ZBARCODU PIC  X(0001).
  1402     05  ZBARCODO PIC  X(0001).
  1403*    -------------------------------
  1404     05  FILLER            PIC  X(3).
  1405     05  ZRETENVC PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  26
* EL1044.cbl
  1406     05  ZRETENVH PIC  X(0001).
  1407     05  ZRETENVU PIC  X(0001).
  1408     05  ZRETENVO PIC  X(0001).
  1409*    -------------------------------
  1410     05  FILLER            PIC  X(3).
  1411     05  ZSIGFLGC PIC  X(0001).
  1412     05  ZSIGFLGH PIC  X(0001).
  1413     05  ZSIGFLGU PIC  X(0001).
  1414     05  ZSIGFLGO PIC  X(0001).
  1415*    -------------------------------
  1416     05  FILLER            PIC  X(3).
  1417     05  ZFADAYSC PIC  X(0001).
  1418     05  ZFADAYSH PIC  X(0001).
  1419     05  ZFADAYSU PIC  X(0001).
  1420     05  ZFADAYSO PIC  999.
  1421*    -------------------------------
  1422     05  FILLER            PIC  X(3).
  1423     05  ZACLOSEC PIC  X(0001).
  1424     05  ZACLOSEH PIC  X(0001).
  1425     05  ZACLOSEU PIC  X(0001).
  1426     05  ZACLOSEO PIC  X(0001).
  1427*    -------------------------------
  1428     05  FILLER            PIC  X(3).
  1429     05  ERRMSGC PIC  X(0001).
  1430     05  ERRMSGH PIC  X(0001).
  1431     05  ERRMSGU PIC  X(0001).
  1432     05  ERRMSGO PIC  X(0072).
  1433*    -------------------------------
  1434     05  FILLER            PIC  X(3).
  1435     05  PFKEYC PIC  X(0001).
  1436     05  PFKEYH PIC  X(0001).
  1437     05  PFKEYU PIC  X(0001).
  1438     05  PFKEYO PIC  99.
  1439*    -------------------------------
  1440****************************************************************
  1441*
  1442* Copyright (c) 2007 by Clerity Solutions, Inc.
  1443* All rights reserved.
  1444*
  1445****************************************************************
  1446 01  DFHEIV.
  1447   02  DFHEIV0               PIC X(35).
  1448   02  DFHEIV1               PIC X(08).
  1449   02  DFHEIV2               PIC X(08).
  1450   02  DFHEIV3               PIC X(08).
  1451   02  DFHEIV4               PIC X(06).
  1452   02  DFHEIV5               PIC X(04).
  1453   02  DFHEIV6               PIC X(04).
  1454   02  DFHEIV7               PIC X(02).
  1455   02  DFHEIV8               PIC X(02).
  1456   02  DFHEIV9               PIC X(01).
  1457   02  DFHEIV10              PIC S9(7) COMP-3.
  1458   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1459   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1460   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1461   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1462   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1463   02  DFHEIV16              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  27
* EL1044.cbl
  1464   02  DFHEIV17              PIC X(04).
  1465   02  DFHEIV18              PIC X(04).
  1466   02  DFHEIV19              PIC X(04).
  1467   02  DFHEIV20              USAGE IS POINTER.
  1468   02  DFHEIV21              USAGE IS POINTER.
  1469   02  DFHEIV22              USAGE IS POINTER.
  1470   02  DFHEIV23              USAGE IS POINTER.
  1471   02  DFHEIV24              USAGE IS POINTER.
  1472   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1473   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1474   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1475   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1476   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1477   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1478   02  FILLER                PIC X(02).
  1479   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1480   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1481   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1482   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1483   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1484 LINKAGE  SECTION.
  1485*****************************************************************
  1486*                                                               *
  1487* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1488* All rights reserved.                                          *
  1489*                                                               *
  1490*****************************************************************
  1491 01  dfheiblk.
  1492     02  eibtime          pic s9(7) comp-3.
  1493     02  eibdate          pic s9(7) comp-3.
  1494     02  eibtrnid         pic x(4).
  1495     02  eibtaskn         pic s9(7) comp-3.
  1496     02  eibtrmid         pic x(4).
  1497     02  dfheigdi         pic s9(4) comp.
  1498     02  eibcposn         pic s9(4) comp.
  1499     02  eibcalen         pic s9(4) comp.
  1500     02  eibaid           pic x(1).
  1501     02  eibfiller1       pic x(1).
  1502     02  eibfn            pic x(2).
  1503     02  eibfiller2       pic x(2).
  1504     02  eibrcode         pic x(6).
  1505     02  eibfiller3       pic x(2).
  1506     02  eibds            pic x(8).
  1507     02  eibreqid         pic x(8).
  1508     02  eibrsrce         pic x(8).
  1509     02  eibsync          pic x(1).
  1510     02  eibfree          pic x(1).
  1511     02  eibrecv          pic x(1).
  1512     02  eibsend          pic x(1).
  1513     02  eibatt           pic x(1).
  1514     02  eibeoc           pic x(1).
  1515     02  eibfmh           pic x(1).
  1516     02  eibcompl         pic x(1).
  1517     02  eibsig           pic x(1).
  1518     02  eibconf          pic x(1).
  1519     02  eiberr           pic x(1).
  1520     02  eibrldbk         pic x(1).
  1521     02  eiberrcd         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  28
* EL1044.cbl
  1522     02  eibsynrb         pic x(1).
  1523     02  eibnodat         pic x(1).
  1524     02  eibfiller5       pic x(2).
  1525     02  eibresp          pic 9(09) comp.
  1526     02  eibresp2         pic 9(09) comp.
  1527     02  dfheigdj         pic s9(4) comp.
  1528     02  dfheigdk         pic s9(4) comp.
  1529 01  DFHCOMMAREA                     PIC X(1024).
  1530*                                    COPY ELCTEXT.
  1531******************************************************************
  1532*                                                                *
  1533*                                                                *
  1534*                            ELCTEXT.                            *
  1535*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1536*                            VMOD=2.008                          *
  1537*                                                                *
  1538*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1539*                                     FORM LETTERS,              *
  1540*                                     CERT FORM DISPLAY.
  1541*                                                                *
  1542*   FILE TYPE = VSAM,KSDS                                        *
  1543*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1544*                                                                *
  1545*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1546*       ALTERNATE INDEX = NONE                                   *
  1547*                                                                *
  1548*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1549*       ALTERNATE INDEX = NONE                                   *
  1550*                                                                *
  1551*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1552*       ALTERNATE INDEX = NONE                                   *
  1553*                                                                *
  1554*   LOG = NO                                                     *
  1555*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1556******************************************************************
  1557 01  TEXT-FILES.
  1558     12  TEXT-FILE-ID                PIC XX.
  1559         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1560         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1561         88  HELP-FILE-TEXT             VALUE 'TH'.
  1562
  1563     12  TX-CONTROL-PRIMARY.
  1564         16  TX-COMPANY-CD           PIC X.
  1565             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1566         16  TX-ACCESS-CD-GENL       PIC X(12).
  1567
  1568         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1569             20  TX-LETTER-NO        PIC X(4).
  1570             20  FILLER              PIC X(8).
  1571
  1572         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1573             20  TX-FORM-NO          PIC X(12).
  1574
  1575         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1576             20  TX-HELP-TYPE        PIC X.
  1577                 88  HELP-FOR-GENERAL   VALUE ' '.
  1578                 88  HELP-BY-SCREEN     VALUE 'S'.
  1579                 88  HELP-BY-ERROR      VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  29
* EL1044.cbl
  1580             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1581                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1582             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1583                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1584             20  FILLER              PIC X(4).
  1585
  1586         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1587
  1588     12  TX-PROCESS-CONTROL          PIC XX.
  1589         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1590
  1591     12  TX-TEXT-LINE                PIC X(70).
  1592
  1593     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1594         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1595         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1596         88  TX-VALID-FORM-SQUEEZE-VALUE
  1597                                        VALUE 'Y' ' '.
  1598
  1599     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1600         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1601         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1602         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1603         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1604         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1605         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1606         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1607                                              'K' 'N' ' '
  1608                                              'Z'.
  1609
  1610     12  TX-ARCHIVE-SW               PIC X.
  1611         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1612         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1613         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1614
  1615     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1616     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1617
  1618     12  TX-BSR-CODE                 PIC X.
  1619         88  TX-BSR-LETTER              VALUE 'B'.
  1620         88  TX-NON-BSR-LETTER          VALUE ' '.
  1621
  1622     12  FILLER                      PIC X.
  1623*****************************************************************
  1624 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA TEXT-FILES.
  1625 0000-DFHEXIT SECTION.
  1626     MOVE '9#                    $   ' TO DFHEIV0.
  1627     MOVE 'EL1044' TO DFHEIV1.
  1628     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1629     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1630     MOVE '5'                    TO DC-OPTION-CODE
  1631     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  1632     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  1633     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  1634     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  1635     IF EIBCALEN = 0
  1636        GO TO 8800-UNAUTHORIZED-ACCESS.
  1637     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  30
* EL1044.cbl
  1638     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  1639     MOVE 1                      TO EMI-NUMBER-OF-LINES
  1640
  1641* EXEC CICS HANDLE CONDITION
  1642*        DUPREC     (8850-DUPREC)
  1643*        NOTOPEN    (8870-NOTOPEN)
  1644*        NOTFND     (8880-NOT-FOUND)
  1645*        PGMIDERR   (9600-PGMID-ERROR)
  1646*        ERROR      (9990-ABEND)
  1647*    END-EXEC.
  1648*    MOVE '"$%JIL.               ! " #00001636' TO DFHEIV0
  1649     MOVE X'2224254A494C2E2020202020' TO DFHEIV0(1:12)
  1650     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1651     MOVE X'2220233030303031363336' TO DFHEIV0(25:11)
  1652     CALL 'kxdfhei1' USING DFHEIV0
  1653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1654
  1655     .
  1656 0150-SET-PROGRAM-SAVES.
  1657     IF PI-CALLING-PROGRAM NOT EQUAL THIS-PGM
  1658         IF PI-RETURN-TO-PROGRAM NOT EQUAL THIS-PGM
  1659             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1660             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1661             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1662             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1663             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1664             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1665             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1666             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  1667         ELSE
  1668             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1669             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1670             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1671             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1672             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1673             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1674             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1675             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  1676     ELSE
  1677         GO TO 0200-RECEIVE.
  1678*    DISPLAY ' COMM KEY PASSED ' PI-COMM-CONTROL
  1679     MOVE PI-COMPANY-CD          TO ELLETR-KEY
  1680     MOVE PI-COMM-CONTROL        TO ELLETR-KEY (2:12)
  1681     MOVE ZEROS                  TO ELLETR-SEQ-NO
  1682     MOVE ELLETR-KEY             TO PI-CURR-LETR-KEY
  1683                                    PI-PREV-LETR-KEY
  1684     GO TO 1000-SHOW-LETR-RECORD
  1685     .
  1686 0200-RECEIVE.
  1687     IF EIBAID = DFHCLEAR
  1688        GO TO 9400-CLEAR.
  1689     IF EIBAID EQUAL DFHPA1 OR DFHPA2 OR DFHPA3
  1690         MOVE LOW-VALUES             TO  EL1044ZI
  1691         MOVE ER-7008                TO  EMI-ERROR
  1692         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1693         MOVE -1                     TO  MAINTL
  1694         GO TO 8200-SEND-DATAONLY.
  1695     IF PI-PROCESSOR-ID EQUAL 'LGXX'
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  31
* EL1044.cbl
  1696         NEXT SENTENCE
  1697     ELSE
  1698
  1699* EXEC CICS READQ TS
  1700*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  1701*            INTO   (SECURITY-CONTROL)
  1702*            LENGTH (SC-COMM-LENGTH)
  1703*            ITEM   (SC-ITEM)
  1704*        END-EXEC
  1705*    MOVE '*$II   L              ''   #00001686' TO DFHEIV0
  1706     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1707     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1708     MOVE X'2020233030303031363836' TO DFHEIV0(25:11)
  1709     CALL 'kxdfhei1' USING DFHEIV0,
  1710           PI-SECURITY-TEMP-STORE-ID,
  1711           SECURITY-CONTROL,
  1712           SC-COMM-LENGTH,
  1713           SC-ITEM,
  1714           DFHEIV99,
  1715           DFHEIV99
  1716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1717         MOVE SC-CREDIT-DISPLAY (3)  TO  PI-DISPLAY-CAP
  1718         MOVE SC-CREDIT-UPDATE  (3)  TO  PI-MODIFY-CAP.
  1719
  1720* EXEC CICS RECEIVE
  1721*        MAP      (WS-MAP-NAME)
  1722*        MAPSET   (MAPSET-NAME)
  1723*        INTO     (EL1044ZI)
  1724*    END-EXEC
  1725     MOVE LENGTH OF
  1726      EL1044ZI
  1727       TO DFHEIV11
  1728*    MOVE '8"T I  L              ''   #00001694' TO DFHEIV0
  1729     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1730     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1731     MOVE X'2020233030303031363934' TO DFHEIV0(25:11)
  1732     CALL 'kxdfhei1' USING DFHEIV0,
  1733           WS-MAP-NAME,
  1734           EL1044ZI,
  1735           DFHEIV11,
  1736           MAPSET-NAME,
  1737           DFHEIV99,
  1738           DFHEIV99
  1739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1740     IF PFKEYL = +0
  1741         GO TO 0300-CHECK-PFKEYS.
  1742     IF (PFKEYI NUMERIC) AND (PFKEYI GREATER 0 AND LESS 25)
  1743         MOVE PF-VALUES (PFKEYI)     TO  EIBAID
  1744     ELSE
  1745         MOVE ER-0029                TO  EMI-ERROR
  1746         GO TO 0320-INPUT-ERROR.
  1747 0300-CHECK-PFKEYS.
  1748*    DISPLAY ' MADE IT TO 0300 '
  1749     IF EIBAID EQUAL DFHPF23
  1750         GO TO 8810-PF23.
  1751     IF EIBAID EQUAL DFHPF24
  1752         GO TO 9200-RETURN-MAIN-MENU.
  1753     IF EIBAID EQUAL DFHPF12
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  32
* EL1044.cbl
  1754         GO TO 9500-PF12.
  1755     IF (MAINTL <> 0) AND (EIBAID <> DFHENTER)
  1756         MOVE ER-0050            TO EMI-ERROR
  1757         GO TO 0320-INPUT-ERROR.
  1758     IF EIBAID EQUAL DFHENTER
  1759         GO TO 0330-EDIT-DATA.
  1760     MOVE ER-0029                    TO  EMI-ERROR.
  1761 0320-INPUT-ERROR.
  1762*    DISPLAY ' MADE IT TO 0320 '
  1763     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1764     MOVE AL-UNBON                   TO  PFKEYA.
  1765     MOVE -1                         TO  PFKEYL.
  1766     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  33
* EL1044.cbl
  1768 0330-EDIT-DATA.
  1769     IF NOT DISPLAY-CAP
  1770         MOVE 'READ'                 TO  SM-READ
  1771         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1772         MOVE ER-0070                TO  EMI-ERROR
  1773         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1774         MOVE -1                     TO  MAINTL
  1775         GO TO 8100-SEND-INITIAL-MAP.
  1776     IF MAINTI EQUAL 'S'
  1777        GO TO 1000-SHOW-LETR-RECORD.
  1778     IF MAINTI = 'C' OR 'A'
  1779        IF NOT MODIFY-CAP
  1780           PERFORM 9995-SECURITY-VIOLATION
  1781                                 THRU 9995-EXIT
  1782           MOVE ER-0070          TO EMI-ERROR
  1783           PERFORM 9900-ERROR-FORMAT
  1784                                 THRU 9900-EXIT
  1785           MOVE LOW-VALUES       TO EL1044ZO
  1786           MOVE -1               TO MAINTL
  1787           GO TO 8100-SEND-INITIAL-MAP
  1788        END-IF
  1789     END-IF
  1790     IF MAINTI = 'C'
  1791        GO TO 2000-CHANGE-LETR-RECORD
  1792     END-IF
  1793     IF MAINTI = 'A'
  1794        GO TO 3000-ADD-LETR-RECORD
  1795     END-IF
  1796     MOVE ER-0023                    TO  EMI-ERROR.
  1797     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1798     MOVE -1                         TO  MAINTL.
  1799     MOVE AL-UABON                   TO  MAINTA.
  1800     GO TO 8200-SEND-DATAONLY.
  1801 1000-SHOW-LETR-RECORD.
  1802     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1803
  1804* EXEC CICS STARTBR
  1805*        DATASET   (ELLETR-FILE-ID)
  1806*        RIDFLD    (ELLETR-KEY)
  1807*        GTEQ
  1808*        RESP      (WS-RESPONSE)
  1809*    END-EXEC
  1810     MOVE 0
  1811       TO DFHEIV11
  1812*    MOVE '&,         G          &  N#00001762' TO DFHEIV0
  1813     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1814     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1815     MOVE X'204E233030303031373632' TO DFHEIV0(25:11)
  1816     CALL 'kxdfhei1' USING DFHEIV0,
  1817           ELLETR-FILE-ID,
  1818           ELLETR-KEY,
  1819           DFHEIV99,
  1820           DFHEIV11,
  1821           DFHEIV99
  1822     MOVE EIBRESP  TO WS-RESPONSE
  1823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1824     IF RESP-NORMAL
  1825        PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  34
* EL1044.cbl
  1826           OR WE-FOUND-IT
  1827
  1828* EXEC CICS READNEXT
  1829*              DATASET    (ELLETR-FILE-ID)
  1830*              SET        (ADDRESS OF TEXT-FILES)
  1831*              RIDFLD     (ELLETR-KEY)
  1832*              RESP       (WS-RESPONSE)
  1833*          END-EXEC
  1834     MOVE 0
  1835       TO DFHEIV11
  1836*    MOVE '&.S                   )  N#00001771' TO DFHEIV0
  1837     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1838     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1839     MOVE X'204E233030303031373731' TO DFHEIV0(25:11)
  1840     CALL 'kxdfhei1' USING DFHEIV0,
  1841           ELLETR-FILE-ID,
  1842           DFHEIV20,
  1843           DFHEIV99,
  1844           ELLETR-KEY,
  1845           DFHEIV99,
  1846           DFHEIV11,
  1847           DFHEIV99,
  1848           DFHEIV99
  1849     SET ADDRESS OF TEXT-FILES TO
  1850         DFHEIV20
  1851     MOVE EIBRESP  TO WS-RESPONSE
  1852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1853           IF (RESP-NORMAL)
  1854              AND (TX-LETTER-NO = PI-COMM-CONTROL (1:4))
  1855              IF (TX-LINE-SQUEEZE-CONTROL = 'Z')
  1856                 SET WE-FOUND-IT   TO TRUE
  1857              END-IF
  1858           ELSE
  1859              SET I-SAY-TO-STOP  TO TRUE
  1860           END-IF
  1861        END-PERFORM
  1862     END-IF
  1863     IF WE-FOUND-IT
  1864        MOVE TX-CONTROL-PRIMARY  TO PI-CURR-LETR-KEY
  1865                                    PI-PREV-LETR-KEY
  1866        GO TO 7000-BUILD-OUTPUT-MAP
  1867     END-IF
  1868     MOVE ER-0418                TO EMI-ERROR.
  1869     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  1870     MOVE -1                     TO MAINTL
  1871     MOVE 'A'                    TO MAINTI
  1872     MOVE AL-UANON               TO MAINTA
  1873     MOVE PI-COMM-CONTROL (1:4)  TO ZLETRI
  1874     MOVE +4                     TO ZLETRL
  1875     MOVE AL-UANON               TO ZLETRA
  1876     GO TO 8100-SEND-INITIAL-MAP
  1877     .
  1878 2000-CHANGE-LETR-RECORD.
  1879*    display ' made it to 2000 '
  1880*    display ' curr   ' pi-curr-letr-key
  1881*    display ' prev   ' pi-prev-letr-key
  1882     IF PI-CURR-LETR-KEY NOT = PI-PREV-LETR-KEY
  1883        MOVE ER-0145             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  35
* EL1044.cbl
  1884        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1885        MOVE -1                  TO MAINTL
  1886        GO TO 8200-SEND-DATAONLY
  1887     END-IF
  1888     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  1889     IF NOT EMI-NO-ERRORS
  1890         GO TO 8200-SEND-DATAONLY.
  1891     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1892     .
  1893 2000-CHANGE-CONTINUE.
  1894
  1895* EXEC CICS READ
  1896*        DATASET    (ELLETR-FILE-ID)
  1897*        SET        (ADDRESS OF TEXT-FILES)
  1898*        RIDFLD     (ELLETR-KEY)
  1899*        UPDATE
  1900*        RESP       (WS-RESPONSE)
  1901*    END-EXEC
  1902*    MOVE '&"S        EU         (  N#00001818' TO DFHEIV0
  1903     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1904     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1905     MOVE X'204E233030303031383138' TO DFHEIV0(25:11)
  1906     CALL 'kxdfhei1' USING DFHEIV0,
  1907           ELLETR-FILE-ID,
  1908           DFHEIV20,
  1909           DFHEIV99,
  1910           ELLETR-KEY,
  1911           DFHEIV99,
  1912           DFHEIV99,
  1913           DFHEIV99
  1914     SET ADDRESS OF TEXT-FILES TO
  1915         DFHEIV20
  1916     MOVE EIBRESP  TO WS-RESPONSE
  1917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1918     IF RESP-NOTFND
  1919        IF ELLETR-SEQ-NO = +0
  1920           GO TO 2000-CONTINUE-CHANGE
  1921        END-IF
  1922     END-IF
  1923     IF TX-LAST-MAINTENANCED-BY NOT = PI-UPDATE-BY OR
  1924        TX-LAST-MAINTENANCED-DT NOT = PI-UPDATE-DT
  1925
  1926* EXEC CICS UNLOCK
  1927*            DATASET   (ELLETR-FILE-ID)
  1928*        END-EXEC
  1929*    MOVE '&*                    #   #00001832' TO DFHEIV0
  1930     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  1931     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1932     MOVE X'2020233030303031383332' TO DFHEIV0(25:11)
  1933     CALL 'kxdfhei1' USING DFHEIV0,
  1934           ELLETR-FILE-ID,
  1935           DFHEIV99
  1936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1937         MOVE ER-0068                TO  EMI-ERROR
  1938         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1939         GO TO 1000-SHOW-LETR-RECORD.
  1940     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  1941     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  36
* EL1044.cbl
  1942     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  1943     IF ZCOPIESL > +0
  1944        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  1945     END-IF
  1946     IF ZFADAYSL > +0
  1947        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  1948     END-IF
  1949     IF ZRDAYSL > +0
  1950        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND
  1951     END-IF
  1952     IF ZFORML > +0
  1953        MOVE ZFORMI              TO W-FORM-TO-RESEND
  1954     END-IF
  1955     IF ZPROMPTL > +0
  1956        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  1957     END-IF
  1958     IF ZENCCDL > +0
  1959        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  1960     END-IF
  1961     IF ZACLOSEL > +0
  1962        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  1963     END-IF
  1964     IF ZBENEL > +0
  1965        MOVE ZBENEI              TO W-LETTER-TO-BENE
  1966     END-IF
  1967     IF ZACCTL > +0
  1968        MOVE ZACCTI              TO W-LETTER-TO-ACCT
  1969     END-IF
  1970     IF ZTYPEL > +0
  1971        MOVE ZTYPEI              TO W-LETTER-TYPE
  1972     END-IF
  1973     IF ZPRTCRTL > +0
  1974        MOVE ZPRTCRTI            TO W-PRINT-CERTIFICATE
  1975     END-IF
  1976     IF ZREFREQL > +0
  1977        MOVE ZREFREQI            TO W-REFUND-REQUIRED
  1978     END-IF
  1979     IF ZONBASEL > +0
  1980         MOVE ZONBASEI           TO W-ONBASE-CODE
  1981     END-IF
  1982
  1983     IF ZACTSUML > +0
  1984         MOVE ZACTSUMI           TO W-ACCT-SUMM
  1985     END-IF
  1986
  1987     IF ZCSOSUML > +0
  1988         MOVE ZCSOSUMI           TO W-CSO-SUMM
  1989     END-IF
  1990
  1991     IF ZREASONL > +0
  1992        MOVE ZREASONI            TO W-REASONS-REQUIRED
  1993     END-IF
  1994
  1995     IF ZBARCODL > +0
  1996        MOVE ZBARCODI            TO W-ADD-BAR-CODE
  1997     END-IF
  1998
  1999     IF ZRETENVL > +0
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  37
* EL1044.cbl
  2000        MOVE ZRETENVI            TO W-HAS-RETURN-ENV
  2001     END-IF
  2002
  2003     IF ZSIGFLGL > +0
  2004        MOVE ZSIGFLGI            TO W-SIG-FLAG-DEFAULT
  2005     END-IF
  2006     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  2007     .
  2008 2000-CONTINUE-CHANGE.
  2009*    DISPLAY ' ABOUT TO REWRITE '
  2010
  2011* EXEC CICS REWRITE
  2012*        DATASET   (ELLETR-FILE-ID)
  2013*        FROM      (TEXT-FILES)
  2014*    END-EXEC.
  2015     MOVE LENGTH OF
  2016      TEXT-FILES
  2017       TO DFHEIV11
  2018*    MOVE '&& L                  %   #00001908' TO DFHEIV0
  2019     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2020     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2021     MOVE X'2020233030303031393038' TO DFHEIV0(25:11)
  2022     CALL 'kxdfhei1' USING DFHEIV0,
  2023           ELLETR-FILE-ID,
  2024           TEXT-FILES,
  2025           DFHEIV11,
  2026           DFHEIV99
  2027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2028
  2029     MOVE ER-0000                    TO  EMI-ERROR.
  2030     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2031     GO TO 1000-SHOW-LETR-RECORD
  2032     .
  2033 3000-ADD-LETR-RECORD.
  2034*    display ' made it to 3000 '
  2035*    display ' curr   ' pi-curr-letr-key
  2036*    display ' prev   ' pi-prev-letr-key
  2037     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  2038     .
  2039 3000-CONTINUE-ADD.
  2040     IF NOT EMI-NO-ERRORS
  2041        GO TO 8200-SEND-DATAONLY
  2042     END-IF
  2043     MOVE SPACES                 TO ELLETR-KEY
  2044     MOVE PI-COMPANY-CD          TO ELLETR-COMPANY-CD
  2045     MOVE ZLETRI                 TO ELLETR-ACCESS-CD
  2046     MOVE +0                     TO ELLETR-SEQ-NO
  2047
  2048* EXEC CICS READ
  2049*        DATASET    (ELLETR-FILE-ID)
  2050*        SET        (ADDRESS OF TEXT-FILES)
  2051*        RIDFLD     (ELLETR-KEY)
  2052*        GTEQ
  2053*        RESP       (WS-RESPONSE)
  2054*    END-EXEC
  2055*    MOVE '&"S        G          (  N#00001930' TO DFHEIV0
  2056     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  2057     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  38
* EL1044.cbl
  2058     MOVE X'204E233030303031393330' TO DFHEIV0(25:11)
  2059     CALL 'kxdfhei1' USING DFHEIV0,
  2060           ELLETR-FILE-ID,
  2061           DFHEIV20,
  2062           DFHEIV99,
  2063           ELLETR-KEY,
  2064           DFHEIV99,
  2065           DFHEIV99,
  2066           DFHEIV99
  2067     SET ADDRESS OF TEXT-FILES TO
  2068         DFHEIV20
  2069     MOVE EIBRESP  TO WS-RESPONSE
  2070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2071     IF RESP-NORMAL
  2072        IF TX-LETTER-NO = ZLETRI
  2073           IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  2074              MOVE ER-0132       TO EMI-ERROR
  2075              PERFORM 9900-ERROR-FORMAT
  2076                                 THRU 9900-EXIT
  2077              MOVE -1            TO ZLETRL
  2078              MOVE AL-UABON      TO ZLETRA
  2079              GO TO 8200-SEND-DATAONLY
  2080           ELSE
  2081              MOVE +0            TO WS-SEQ-NO-TO-USE
  2082           END-IF
  2083        ELSE
  2084           MOVE +1               TO WS-SEQ-NO-TO-USE
  2085        END-IF
  2086     ELSE
  2087        MOVE +1                  TO WS-SEQ-NO-TO-USE
  2088     END-IF
  2089
  2090* EXEC CICS GETMAIN
  2091*       SET(ADDRESS OF TEXT-FILES)
  2092*       LENGTH(ELLETR-LENGTH)
  2093*    END-EXEC
  2094*    MOVE '," L                  $   #00001955' TO DFHEIV0
  2095     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  2096     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2097     MOVE X'2020233030303031393535' TO DFHEIV0(25:11)
  2098     CALL 'kxdfhei1' USING DFHEIV0,
  2099           DFHEIV20,
  2100           ELLETR-LENGTH,
  2101           DFHEIV99
  2102     SET ADDRESS OF TEXT-FILES TO
  2103         DFHEIV20
  2104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2105     MOVE SPACES                 TO TEXT-FILES
  2106     MOVE 'TL'                   TO TEXT-FILE-ID
  2107     MOVE PI-COMPANY-CD          TO TX-COMPANY-CD
  2108     MOVE ZLETRI                 TO TX-LETTER-NO
  2109     MOVE WS-SEQ-NO-TO-USE       TO TX-LINE-SEQUENCE
  2110     MOVE 'Z'                    TO TX-LINE-SQUEEZE-CONTROL
  2111     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  2112     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
  2113     MOVE SPACES                 TO W-Z-CONTROL-DATA
  2114     IF ZCOPIESL > +0
  2115        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  39
* EL1044.cbl
  2116     ELSE
  2117        MOVE 1                   TO W-NUMBER-OF-COPIES
  2118     END-IF
  2119     IF ZFADAYSL > +0
  2120        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  2121     END-IF
  2122     IF ZRDAYSL > +0
  2123        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND
  2124     ELSE
  2125        MOVE ZEROS               TO W-DAYS-TO-RESEND
  2126     END-IF
  2127     IF ZFORML > +0
  2128        MOVE ZFORMI              TO W-FORM-TO-RESEND
  2129     END-IF
  2130     IF ZPROMPTL > +0
  2131        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  2132     END-IF
  2133     IF ZENCCDL > +0
  2134        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  2135     END-IF
  2136     IF ZACLOSEL > +0
  2137        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  2138     END-IF
  2139     IF ZBENEL > +0
  2140        MOVE ZBENEI              TO W-LETTER-TO-BENE
  2141     END-IF
  2142     IF ZACCTL > +0
  2143        MOVE ZACCTI              TO W-LETTER-TO-ACCT
  2144     END-IF
  2145     IF ZTYPEL > +0
  2146        MOVE ZTYPEI              TO W-LETTER-TYPE
  2147     END-IF
  2148     IF ZPRTCRTL > +0
  2149        MOVE ZPRTCRTI            TO W-PRINT-CERTIFICATE
  2150     END-IF
  2151     IF ZREFREQL > +0
  2152        MOVE ZREFREQI            TO W-REFUND-REQUIRED
  2153     END-IF
  2154     IF ZONBASEL > +0
  2155        MOVE ZONBASEI            TO W-ONBASE-CODE
  2156     END-IF
  2157
  2158     IF ZACTSUML > +0
  2159         MOVE ZACTSUMI           TO W-ACCT-SUMM
  2160     END-IF
  2161
  2162     IF ZCSOSUML > +0
  2163         MOVE ZCSOSUMI           TO W-CSO-SUMM
  2164     END-IF
  2165
  2166     IF ZREASONL > +0
  2167        MOVE ZREASONI            TO W-REASONS-REQUIRED
  2168     END-IF
  2169
  2170     IF ZBARCODL > +0
  2171        MOVE ZBARCODI            TO W-ADD-BAR-CODE
  2172     END-IF
  2173
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  40
* EL1044.cbl
  2174     IF ZRETENVL > +0
  2175        MOVE ZRETENVI            TO W-HAS-RETURN-ENV
  2176     END-IF
  2177
  2178     IF ZSIGFLGL > +0
  2179        MOVE ZSIGFLGI            TO W-SIG-FLAG-DEFAULT
  2180     END-IF
  2181     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  2182*    DISPLAY ' ABOUT TO WRITE '
  2183     MOVE TX-CONTROL-PRIMARY     TO ELLETR-KEY
  2184                                    PI-CURR-LETR-KEY
  2185                                    PI-PREV-LETR-KEY
  2186
  2187* EXEC CICS WRITE
  2188*       DATASET (ELLETR-FILE-ID)
  2189*       FROM    (TEXT-FILES)
  2190*       RIDFLD  (ELLETR-KEY)
  2191*    END-EXEC
  2192     MOVE LENGTH OF
  2193      TEXT-FILES
  2194       TO DFHEIV11
  2195*    MOVE '&$ L                  ''   #00002040' TO DFHEIV0
  2196     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2197     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2198     MOVE X'2020233030303032303430' TO DFHEIV0(25:11)
  2199     CALL 'kxdfhei1' USING DFHEIV0,
  2200           ELLETR-FILE-ID,
  2201           TEXT-FILES,
  2202           DFHEIV11,
  2203           ELLETR-KEY,
  2204           DFHEIV99,
  2205           DFHEIV99
  2206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2207     MOVE ER-0000                    TO  EMI-ERROR.
  2208     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2209     GO TO 1000-SHOW-LETR-RECORD
  2210     .
  2211 5000-FIND-NEXT-PROD-RECORD.
  2212*    MOVE PI-PROD-KEY            TO ELLETR-KEY
  2213*
  2214*    EXEC CICS STARTBR
  2215*        DATASET   (ELLETR-FILE-ID)
  2216*        RIDFLD    (ELLETR-KEY)
  2217*        GTEQ
  2218*        RESP      (WS-RESPONSE)
  2219*    END-EXEC
  2220*
  2221*    IF NOT RESP-NORMAL
  2222*       MOVE -1                  TO PFKEYL
  2223*       MOVE ER-0130             TO EMI-ERROR
  2224*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2225*       GO TO 8200-SEND-DATAONLY
  2226*    END-IF
  2227     .
  2228 5000-READNEXT-LOOP.
  2229*    EXEC CICS READNEXT
  2230*        DATASET   (ELLETR-FILE-ID)
  2231*        SET       (ADDRESS OF PRODUCT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  41
* EL1044.cbl
  2232*        RIDFLD    (ELLETR-KEY)
  2233*        RESP      (WS-RESPONSE)
  2234*    END-EXEC
  2235*
  2236*    IF (NOT RESP-NORMAL)
  2237*       OR (PD-COMPANY-CD NOT = PI-COMPANY-CD)
  2238*       PERFORM 5000-END-BROWSE
  2239*       MOVE -1                  TO PFKEYL
  2240*       MOVE ER-0130             TO EMI-ERROR
  2241*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2242*       GO TO 1000-SHOW-LETR-RECORD
  2243*    END-IF
  2244*
  2245*    IF ELLETR-KEY = PI-PREV-LETR-KEY
  2246*       GO TO 5000-READNEXT-LOOP
  2247*    END-IF
  2248*
  2249*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2250*
  2251*    PERFORM 5000-END-BROWSE
  2252*    GO TO 7000-BUILD-OUTPUT-MAP
  2253     .
  2254 5000-END-BROWSE.
  2255*    EXEC CICS ENDBR
  2256*        DATASET   (ELLETR-FILE-ID)
  2257*    END-EXEC
  2258     .
  2259 5100-FIND-PREV-PROD-RECORD.
  2260*    MOVE PI-PREV-LETR-KEY       TO ELLETR-KEY
  2261*    IF STATEL > +0
  2262*       MOVE STATEI              TO ELLETR-STATE
  2263*    END-IF
  2264*    IF PRODCDL > +0
  2265*       MOVE PRODCDI             TO ELLETR-PROD-CD
  2266*    END-IF
  2267*    IF BENTYPL > +0
  2268*        MOVE BENTYPI                TO  ELLETR-BEN-TYPE.
  2269*    IF BENCODEL > +0
  2270*        MOVE BENCODEI               TO  ELLETR-BEN-CODE.
  2271*    IF EXPDTL IS GREATER THAN +0
  2272*        MOVE EXPDTI                 TO  DEEDIT-FIELD
  2273*        PERFORM 8600-DEEDIT THRU 8600-EXIT
  2274*        IF WS-NUMVAL-OF-DEEDIT >= 999999
  2275*            MOVE HIGH-VALUES        TO  ELLETR-EXP-DT
  2276*        ELSE
  2277*          STRING WS-NUMVAL (8:4) WS-NUMVAL (4:2) WS-NUMVAL (6:12)
  2278*             DELIMITED BY SIZE INTO DC-GREG-DATE-CYMD
  2279*          END-STRING
  2280*           MOVE 'L'                    TO  DC-OPTION-CODE
  2281*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  2282*            IF NO-CONVERSION-ERROR
  2283*                MOVE DC-BIN-DATE-1  TO  ELLETR-EXP-DT
  2284*            ELSE
  2285*                MOVE LOW-VALUES     TO  ELLETR-EXP-DT.
  2286*
  2287*    EXEC CICS HANDLE CONDITION
  2288*        ENDFILE (5100-UNSUCCESSFUL-SEARCH)
  2289*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  42
* EL1044.cbl
  2290*
  2291*    EXEC CICS STARTBR
  2292*        DATASET   (ELLETR-FILE-ID)
  2293*        RIDFLD    (ELLETR-KEY)
  2294*        GTEQ
  2295*    END-EXEC.
  2296 5100-READPREV-LOOP.
  2297*    EXEC CICS READPREV
  2298*        DATASET   (ELLETR-FILE-ID)
  2299*        SET       (ADDRESS OF PRODUCT-MASTER)
  2300*        RIDFLD    (ELLETR-KEY)
  2301*    END-EXEC.
  2302*
  2303*    IF PD-COMPANY-CD  NOT EQUAL PI-COMPANY-CD
  2304*        GO TO 5100-UNSUCCESSFUL-SEARCH.
  2305*
  2306*    IF ELLETR-KEY IS EQUAL TO PI-PREV-LETR-KEY
  2307*        GO TO 5100-READPREV-LOOP.
  2308*
  2309*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2310*
  2311*    GO TO 7000-BUILD-OUTPUT-MAP.
  2312 5100-END-BROWSE.
  2313*    EXEC CICS ENDBR
  2314*        DATASET   (ELLETR-FILE-ID)
  2315*    END-EXEC.
  2316 5100-UNSUCCESSFUL-SEARCH.
  2317     PERFORM 5100-END-BROWSE.
  2318     MOVE ER-0131                    TO  EMI-ERROR.
  2319     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2320     GO TO 1000-SHOW-LETR-RECORD.
  2321     .
  2322 6000-EDIT-INPUT-DATA.
  2323     IF MAINTI = 'A'
  2324        IF ZLETRL > +0
  2325           AND ZLETRI NOT = SPACES
  2326           CONTINUE
  2327        ELSE
  2328           MOVE AL-UNBON         TO ZCOPIESA
  2329           MOVE -1               TO ZCOPIESL
  2330           MOVE ER-0005          TO EMI-ERROR
  2331           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2332        END-IF
  2333     END-IF
  2334     IF ZCOPIESL > +0
  2335        IF ZCOPIESI NUMERIC
  2336           CONTINUE
  2337        ELSE
  2338           MOVE AL-UNBON         TO ZCOPIESA
  2339           MOVE -1               TO ZCOPIESL
  2340           MOVE ER-0184          TO EMI-ERROR
  2341           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2342        END-IF
  2343     END-IF
  2344     IF ZFADAYSL > +0
  2345       IF ZFADAYSI NOT EQUAL SPACES
  2346          IF ZFADAYSI NUMERIC
  2347             CONTINUE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  43
* EL1044.cbl
  2348          ELSE
  2349             MOVE AL-UNBON         TO ZFADAYSA
  2350             MOVE -1               TO ZFADAYSL
  2351             MOVE ER-0491          TO EMI-ERROR
  2352             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2353          END-IF
  2354       END-IF
  2355     END-IF
  2356     IF ZRDAYSL > +0
  2357       IF ZRDAYSI NOT EQUAL SPACES
  2358          IF ZRDAYSI NUMERIC
  2359             CONTINUE
  2360          ELSE
  2361             MOVE AL-UNBON         TO ZRDAYSA
  2362             MOVE -1               TO ZRDAYSL
  2363             MOVE ER-0491          TO EMI-ERROR
  2364             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2365          END-IF
  2366       END-IF
  2367     END-IF
  2368     IF ZPROMPTL > +0
  2369        IF ZPROMPTI = 'Y' OR 'N' OR ' '
  2370           CONTINUE
  2371        ELSE
  2372           MOVE AL-UABON         TO ZPROMPTA
  2373           MOVE -1               TO ZPROMPTL
  2374           MOVE ER-0627          TO EMI-ERROR
  2375           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2376        END-IF
  2377     END-IF
  2378     IF MAINTI = 'A'
  2379        AND ZENCCDL <= 0
  2380        MOVE AL-UABON            TO ZENCCDA
  2381        MOVE -1                  TO ZENCCDL
  2382        MOVE ER-1560             TO EMI-ERROR
  2383        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2384     END-IF
  2385     IF ZENCCDL > +0
  2386        IF ZENCCDI = 'E' OR 'ENV' OR '0' OR '@'
  2387                  OR 'A' OR 'C' OR 'CLM'
  2388                  OR 'RE'
  2389                  OR '1' OR '2' OR '3' OR 'B' OR 'D'
  2390           CONTINUE
  2391        ELSE
  2392           MOVE AL-UABON         TO ZENCCDA
  2393           MOVE -1               TO ZENCCDL
  2394           MOVE ER-1560          TO EMI-ERROR
  2395           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2396        END-IF
  2397     END-IF
  2398     IF MAINTI = 'A'
  2399        AND ZTYPEL <= 0
  2400        MOVE AL-UABON            TO ZTYPEA
  2401        MOVE -1                  TO ZTYPEL
  2402        MOVE ER-1564             TO EMI-ERROR
  2403        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2404     END-IF
  2405     IF ZTYPEL > +0
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  44
* EL1044.cbl
  2406        IF ZTYPEI = 'C' OR 'P' OR 'U'
  2407           CONTINUE
  2408        ELSE
  2409           MOVE -1               TO ZTYPEL
  2410           MOVE AL-UABON         TO ZTYPEA
  2411           MOVE ER-1564          TO EMI-ERROR
  2412           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2413        END-IF
  2414     END-IF
  2415     IF ZACLOSEL > +0
  2416        IF ZACLOSEI = 'S' OR 'C' OR 'B' OR ' '
  2417           CONTINUE
  2418        ELSE
  2419           MOVE -1               TO ZACLOSEL
  2420           MOVE AL-UABON         TO ZACLOSEA
  2421           MOVE ER-1562          TO EMI-ERROR
  2422           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2423        END-IF
  2424     END-IF
  2425     IF ZPRTCRTL > +0
  2426        IF ZPRTCRTI = 'Y' OR 'N' OR ' '
  2427           CONTINUE
  2428        ELSE
  2429           MOVE AL-UABON         TO ZPRTCRTA
  2430           MOVE -1               TO ZPRTCRTL
  2431           MOVE ER-0627          TO EMI-ERROR
  2432           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2433        END-IF
  2434     END-IF
  2435     IF ZREFREQL > +0
  2436        IF ZREFREQI = 'Y' OR 'N' OR ' '
  2437           CONTINUE
  2438        ELSE
  2439           MOVE AL-UABON         TO ZREFREQA
  2440           MOVE -1               TO ZREFREQL
  2441           MOVE ER-0627          TO EMI-ERROR
  2442           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2443        END-IF
  2444     END-IF
  2445     IF MAINTI = 'A'
  2446        AND ZONBASEL <= 0
  2447        MOVE AL-UABON            TO ZONBASEA
  2448        MOVE -1                  TO ZONBASEL
  2449        MOVE ER-3804             TO EMI-ERROR
  2450        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2451     END-IF
  2452     IF ZONBASEL > +0
  2453        IF ZONBASEI = ' '
  2454           MOVE AL-UABON            TO ZONBASEA
  2455           MOVE -1                  TO ZONBASEL
  2456           MOVE ER-3804             TO EMI-ERROR
  2457           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2458        END-IF
  2459     END-IF
  2460
  2461     IF ZACTSUML > +0
  2462        IF ZACTSUMI = '1' OR '2' OR ' '
  2463           CONTINUE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  45
* EL1044.cbl
  2464        ELSE
  2465           MOVE AL-UABON         TO ZACTSUMA
  2466           MOVE -1               TO ZACTSUML
  2467           MOVE ER-3820          TO EMI-ERROR
  2468           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2469        END-IF
  2470     END-IF
  2471
  2472     IF ZCSOSUML > +0
  2473        IF ZCSOSUMI = '3' OR '4' OR ' '
  2474           CONTINUE
  2475        ELSE
  2476           MOVE AL-UABON         TO ZCSOSUMA
  2477           MOVE -1               TO ZCSOSUML
  2478           MOVE ER-3821          TO EMI-ERROR
  2479           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2480        END-IF
  2481     END-IF
  2482
  2483     IF ZREASONL > +0
  2484        IF ZREASONI = 'Y' OR 'N' OR ' '
  2485           CONTINUE
  2486        ELSE
  2487           MOVE AL-UABON         TO ZREASONA
  2488           MOVE -1               TO ZREASONL
  2489           MOVE ER-0627          TO EMI-ERROR
  2490           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2491        END-IF
  2492     END-IF
  2493
  2494     IF ZBARCODL > +0
  2495        IF ZBARCODI = 'Y' OR 'N' OR ' '
  2496           CONTINUE
  2497        ELSE
  2498           MOVE AL-UABON         TO ZBARCODA
  2499           MOVE -1               TO ZBARCODL
  2500           MOVE ER-0627          TO EMI-ERROR
  2501           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2502        END-IF
  2503     END-IF
  2504
  2505     IF ZRETENVL > +0
  2506        IF ZRETENVI = 'Y' OR 'N' OR ' '
  2507           CONTINUE
  2508        ELSE
  2509           MOVE AL-UABON         TO ZRETENVA
  2510           MOVE -1               TO ZRETENVL
  2511           MOVE ER-0627          TO EMI-ERROR
  2512           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2513        END-IF
  2514     END-IF
  2515
  2516     IF ZSIGFLGL > +0
  2517        IF ZSIGFLGI = 'Y' OR 'N' OR ' '
  2518           CONTINUE
  2519        ELSE
  2520           MOVE AL-UABON         TO ZSIGFLGA
  2521           MOVE -1               TO ZSIGFLGL
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  46
* EL1044.cbl
  2522           MOVE ER-0627          TO EMI-ERROR
  2523           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2524        END-IF
  2525     END-IF
  2526
  2527     .
  2528 6000-EXIT.
  2529     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  47
* EL1044.cbl
  2531 7000-BUILD-OUTPUT-MAP.
  2532     MOVE LOW-VALUES             TO EL1044ZO
  2533     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  2534     MOVE TX-LETTER-NO           TO ZLETRO
  2535     MOVE W-NUMBER-OF-COPIES     TO ZCOPIESO
  2536     MOVE W-DAYS-TO-FOLLOW-UP    TO ZFADAYSO
  2537     MOVE W-DAYS-TO-RESEND       TO ZRDAYSO
  2538     MOVE W-FORM-TO-RESEND       TO ZFORMO
  2539     MOVE W-PROMPT-LETTER        TO ZPROMPTO
  2540     MOVE W-ENCLOSURE-CD         TO ZENCCDO
  2541     MOVE W-AUTO-CLOSE-IND       TO ZACLOSEO
  2542     MOVE W-LETTER-TO-BENE       TO ZBENEO
  2543     MOVE W-LETTER-TO-ACCT       TO ZACCTO
  2544     MOVE W-LETTER-TYPE          TO ZTYPEO
  2545     MOVE W-PRINT-CERTIFICATE    TO ZPRTCRTO
  2546     MOVE W-REFUND-REQUIRED      TO ZREFREQO
  2547     MOVE W-ONBASE-CODE          TO ZONBASEO
  2548     MOVE W-ACCT-SUMM            TO ZACTSUMO
  2549     MOVE W-CSO-SUMM             TO ZCSOSUMO
  2550     MOVE W-REASONS-REQUIRED     TO ZREASONO
  2551     MOVE W-ADD-BAR-CODE         TO ZBARCODO
  2552     MOVE W-HAS-RETURN-ENV       TO ZRETENVO
  2553     MOVE W-SIG-FLAG-DEFAULT     TO ZSIGFLGO
  2554     MOVE TX-LAST-MAINTENANCED-BY TO LSTUSRO
  2555                                    PI-UPDATE-BY
  2556     MOVE TX-LAST-MAINTENANCED-DT TO PI-UPDATE-DT
  2557                                    DC-BIN-DATE-1
  2558     MOVE ' '                    TO DC-OPTION-CODE
  2559     MOVE +0                     TO DC-ELAPSED-DAYS
  2560                                     DC-ELAPSED-MONTHS.
  2561     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2562     IF NO-CONVERSION-ERROR
  2563        MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO
  2564     ELSE
  2565        MOVE LOW-VALUES          TO LSTDTEO
  2566     END-IF
  2567     MOVE -1                     TO MAINTL
  2568     .
  2569 8100-SEND-INITIAL-MAP.
  2570     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2571     MOVE EIBTIME                    TO  TIME-IN.
  2572     MOVE SAVE-DATE                  TO  DATEO.
  2573     MOVE TIME-OUT                   TO  TIMEO
  2574     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2575     MOVE PI-PROCESSOR-ID        TO USERIDO
  2576
  2577* EXEC CICS SEND
  2578*        MAP      (WS-MAP-NAME)
  2579*        MAPSET   (MAPSET-NAME)
  2580*        FROM     (EL1044ZO)
  2581*        ERASE
  2582*        CURSOR
  2583*    END-EXEC.
  2584     MOVE LENGTH OF
  2585      EL1044ZO
  2586       TO DFHEIV12
  2587     MOVE -1
  2588       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  48
* EL1044.cbl
  2589*    MOVE '8$     CT  E    H L F ,   #00002414' TO DFHEIV0
  2590     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2591     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2592     MOVE X'2020233030303032343134' TO DFHEIV0(25:11)
  2593     CALL 'kxdfhei1' USING DFHEIV0,
  2594           WS-MAP-NAME,
  2595           EL1044ZO,
  2596           DFHEIV12,
  2597           MAPSET-NAME,
  2598           DFHEIV99,
  2599           DFHEIV99,
  2600           DFHEIV99,
  2601           DFHEIV11,
  2602           DFHEIV99,
  2603           DFHEIV99,
  2604           DFHEIV99
  2605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2606
  2607     MOVE '044Z'                 TO PI-CURRENT-SCREEN-NO
  2608     GO TO 9100-RETURN-TRAN
  2609     .
  2610 8200-SEND-DATAONLY.
  2611*    DISPLAY ' MADE IT TO 8200 '
  2612     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2613     MOVE EIBTIME                    TO  TIME-IN.
  2614     MOVE SAVE-DATE                  TO  DATEO.
  2615     MOVE TIME-OUT                   TO  TIMEO.
  2616     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2617     MOVE PI-PROCESSOR-ID        TO USERIDO
  2618
  2619* EXEC CICS SEND
  2620*        MAP      (WS-MAP-NAME)
  2621*        MAPSET   (MAPSET-NAME)
  2622*        FROM     (EL1044ZO)
  2623*        DATAONLY
  2624*        CURSOR
  2625*    END-EXEC.
  2626     MOVE LENGTH OF
  2627      EL1044ZO
  2628       TO DFHEIV12
  2629     MOVE -1
  2630       TO DFHEIV11
  2631*    MOVE '8$D    CT       H L F ,   #00002432' TO DFHEIV0
  2632     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2633     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2634     MOVE X'2020233030303032343332' TO DFHEIV0(25:11)
  2635     CALL 'kxdfhei1' USING DFHEIV0,
  2636           WS-MAP-NAME,
  2637           EL1044ZO,
  2638           DFHEIV12,
  2639           MAPSET-NAME,
  2640           DFHEIV99,
  2641           DFHEIV99,
  2642           DFHEIV99,
  2643           DFHEIV11,
  2644           DFHEIV99,
  2645           DFHEIV99,
  2646           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  49
* EL1044.cbl
  2647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2648
  2649     GO TO 9100-RETURN-TRAN
  2650     .
  2651 8300-SEND-TEXT.
  2652
  2653* EXEC CICS SEND TEXT
  2654*        FROM  (LOGOFF-TEXT)
  2655*        LENGTH(LOGOFF-LENGTH)
  2656*        ERASE
  2657*        FREEKB
  2658*    END-EXEC.
  2659*    MOVE '8&      T  E F  H   F -   #00002442' TO DFHEIV0
  2660     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2661     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2662     MOVE X'2020233030303032343432' TO DFHEIV0(25:11)
  2663     CALL 'kxdfhei1' USING DFHEIV0,
  2664           LOGOFF-TEXT,
  2665           LOGOFF-LENGTH,
  2666           DFHEIV99,
  2667           DFHEIV99,
  2668           DFHEIV99,
  2669           DFHEIV99,
  2670           DFHEIV99,
  2671           DFHEIV99,
  2672           DFHEIV99,
  2673           DFHEIV99,
  2674           DFHEIV99,
  2675           DFHEIV99
  2676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2677
  2678
  2679* EXEC CICS RETURN
  2680*        END-EXEC.
  2681*    MOVE '.(                    ''   #00002448' TO DFHEIV0
  2682     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2683     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2684     MOVE X'2020233030303032343438' TO DFHEIV0(25:11)
  2685     CALL 'kxdfhei1' USING DFHEIV0,
  2686           DFHEIV99,
  2687           DFHEIV99,
  2688           DFHEIV99,
  2689           DFHEIV99,
  2690           DFHEIV99,
  2691           DFHEIV99
  2692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2693
  2694     .
  2695 8500-DEEDIT.
  2696     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2697                                 TO WS-9V999-OF-DEEDIT
  2698     .
  2699 8500-EXIT.
  2700     EXIT.
  2701 8600-DEEDIT.
  2702     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2703                                 TO WS-NUMVAL-OF-DEEDIT
  2704     .
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  50
* EL1044.cbl
  2705 8600-EXIT.
  2706     EXIT.
  2707 8800-UNAUTHORIZED-ACCESS.
  2708     MOVE UNACCESS-MSG               TO  LOGOFF-MSG.
  2709     GO TO 8300-SEND-TEXT.
  2710 8810-PF23.
  2711     MOVE EIBAID                     TO  PI-ENTRY-CD-1.
  2712     MOVE XCTL-005                   TO  PGM-NAME.
  2713     GO TO 9300-XCTL.
  2714 8850-DUPREC.
  2715     MOVE ER-0132                    TO  EMI-ERROR.
  2716     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2717     MOVE -1                         TO  MAINTL
  2718     MOVE AL-UABON                   TO  ZLETRA
  2719     GO TO 8100-SEND-INITIAL-MAP.
  2720 8870-NOTOPEN.
  2721     MOVE LOW-VALUES                 TO  EL1044ZO.
  2722     MOVE -1                         TO  MAINTL.
  2723     MOVE ER-0701                    TO  EMI-ERROR.
  2724     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2725     GO TO 8100-SEND-INITIAL-MAP.
  2726 8880-NOT-FOUND.
  2727     MOVE ER-0702                    TO  EMI-ERROR.
  2728     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2729     MOVE -1                         TO  MAINTL
  2730     MOVE AL-UABON                   TO  ZLETRA
  2731     GO TO 8100-SEND-INITIAL-MAP.
  2732     .
  2733 9100-RETURN-TRAN.
  2734     MOVE EMI-ERROR-NUMBER (1)       TO  PI-LAST-ERROR-NO.
  2735
  2736* EXEC CICS RETURN
  2737*        TRANSID    (TRANS-ID)
  2738*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2739*        LENGTH     (PI-COMM-LENGTH)
  2740*    END-EXEC.
  2741*    MOVE '.(CT                  ''   #00002491' TO DFHEIV0
  2742     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2743     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2744     MOVE X'2020233030303032343931' TO DFHEIV0(25:11)
  2745     CALL 'kxdfhei1' USING DFHEIV0,
  2746           TRANS-ID,
  2747           PROGRAM-INTERFACE-BLOCK,
  2748           PI-COMM-LENGTH,
  2749           DFHEIV99,
  2750           DFHEIV99,
  2751           DFHEIV99
  2752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2753
  2754 9200-RETURN-MAIN-MENU.
  2755     MOVE XCTL-626                   TO  PGM-NAME.
  2756     GO TO 9300-XCTL.
  2757 9300-XCTL.
  2758
  2759* EXEC CICS XCTL
  2760*        PROGRAM    (PGM-NAME)
  2761*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2762*        LENGTH     (PI-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  51
* EL1044.cbl
  2763*    END-EXEC.
  2764*    MOVE '.$C                   %   #00002500' TO DFHEIV0
  2765     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2766     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2767     MOVE X'2020233030303032353030' TO DFHEIV0(25:11)
  2768     CALL 'kxdfhei1' USING DFHEIV0,
  2769           PGM-NAME,
  2770           PROGRAM-INTERFACE-BLOCK,
  2771           PI-COMM-LENGTH,
  2772           DFHEIV99
  2773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2774
  2775 9400-CLEAR.
  2776     MOVE PI-RETURN-TO-PROGRAM       TO  PGM-NAME.
  2777     GO TO 9300-XCTL.
  2778 9500-PF12.
  2779     MOVE XCTL-010                   TO  PGM-NAME.
  2780     GO TO 9300-XCTL.
  2781 9600-PGMID-ERROR.
  2782
  2783* EXEC CICS HANDLE CONDITION
  2784*        PGMIDERR   (8300-SEND-TEXT)
  2785*    END-EXEC.
  2786*    MOVE '"$L                   ! # #00002512' TO DFHEIV0
  2787     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2788     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2789     MOVE X'2320233030303032353132' TO DFHEIV0(25:11)
  2790     CALL 'kxdfhei1' USING DFHEIV0
  2791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2792
  2793     MOVE PGM-NAME                   TO  PI-CALLING-PROGRAM.
  2794     MOVE ' '                        TO  PI-ENTRY-CD-1.
  2795     MOVE XCTL-005                   TO  PGM-NAME.
  2796     MOVE PGM-NAME                   TO  LOGOFF-PGM.
  2797     MOVE PGMIDERR-MSG               TO  LOGOFF-FILL.
  2798     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  52
* EL1044.cbl
  2800 9700-LINK-DATE-CONVERT.
  2801
  2802* EXEC CICS LINK
  2803*        PROGRAM    ('ELDATCV')
  2804*        COMMAREA   (DATE-CONVERSION-DATA)
  2805*        LENGTH     (DC-COMM-LENGTH)
  2806*    END-EXEC.
  2807     MOVE 'ELDATCV' TO DFHEIV1
  2808*    MOVE '."C                   (   #00002523' TO DFHEIV0
  2809     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2810     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2811     MOVE X'2020233030303032353233' TO DFHEIV0(25:11)
  2812     CALL 'kxdfhei1' USING DFHEIV0,
  2813           DFHEIV1,
  2814           DATE-CONVERSION-DATA,
  2815           DC-COMM-LENGTH,
  2816           DFHEIV99,
  2817           DFHEIV99,
  2818           DFHEIV99,
  2819           DFHEIV99
  2820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2821
  2822 9700-EXIT.
  2823     EXIT.
  2824 9900-ERROR-FORMAT.
  2825     IF NOT EMI-ERRORS-COMPLETE
  2826         MOVE LINK-001               TO  PGM-NAME
  2827
  2828* EXEC CICS LINK
  2829*            PROGRAM    (PGM-NAME)
  2830*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  2831*            LENGTH     (EMI-COMM-LENGTH)
  2832*        END-EXEC.
  2833*    MOVE '."C                   (   #00002533' TO DFHEIV0
  2834     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2835     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2836     MOVE X'2020233030303032353333' TO DFHEIV0(25:11)
  2837     CALL 'kxdfhei1' USING DFHEIV0,
  2838           PGM-NAME,
  2839           ERROR-MESSAGE-INTERFACE-BLOCK,
  2840           EMI-COMM-LENGTH,
  2841           DFHEIV99,
  2842           DFHEIV99,
  2843           DFHEIV99,
  2844           DFHEIV99
  2845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2846
  2847 9900-EXIT.
  2848     EXIT.
  2849 9990-ABEND.
  2850     MOVE LINK-004                   TO  PGM-NAME.
  2851     MOVE DFHEIBLK                   TO  EMI-LINE1.
  2852
  2853* EXEC CICS LINK
  2854*        PROGRAM   (PGM-NAME)
  2855*        COMMAREA  (EMI-LINE1)
  2856*        LENGTH    (72)
  2857*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  53
* EL1044.cbl
  2858     MOVE 72
  2859       TO DFHEIV11
  2860*    MOVE '."C                   (   #00002543' TO DFHEIV0
  2861     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2862     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2863     MOVE X'2020233030303032353433' TO DFHEIV0(25:11)
  2864     CALL 'kxdfhei1' USING DFHEIV0,
  2865           PGM-NAME,
  2866           EMI-LINE1,
  2867           DFHEIV11,
  2868           DFHEIV99,
  2869           DFHEIV99,
  2870           DFHEIV99,
  2871           DFHEIV99
  2872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2873
  2874     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  54
* EL1044.cbl
  2876 9995-SECURITY-VIOLATION.
  2877*                            COPY ELCSCTP.
  2878******************************************************************
  2879*                                                                *
  2880*                            ELCSCTP                             *
  2881*                            VMOD=2.001                          *
  2882*                                                                *
  2883*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2884******************************************************************
  2885
  2886
  2887     MOVE EIBDATE          TO SM-JUL-DATE.
  2888     MOVE EIBTRMID         TO SM-TERMID.
  2889     MOVE THIS-PGM         TO SM-PGM.
  2890     MOVE EIBTIME          TO TIME-IN.
  2891     MOVE TIME-OUT         TO SM-TIME.
  2892     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2893
  2894
  2895* EXEC CICS LINK
  2896*         PROGRAM  ('EL003')
  2897*         COMMAREA (SECURITY-MESSAGE)
  2898*         LENGTH   (80)
  2899*    END-EXEC.
  2900     MOVE 'EL003' TO DFHEIV1
  2901     MOVE 80
  2902       TO DFHEIV11
  2903*    MOVE '."C                   (   #00002568' TO DFHEIV0
  2904     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2905     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2906     MOVE X'2020233030303032353638' TO DFHEIV0(25:11)
  2907     CALL 'kxdfhei1' USING DFHEIV0,
  2908           DFHEIV1,
  2909           SECURITY-MESSAGE,
  2910           DFHEIV11,
  2911           DFHEIV99,
  2912           DFHEIV99,
  2913           DFHEIV99,
  2914           DFHEIV99
  2915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2916
  2917
  2918******************************************************************
  2919
  2920 9995-EXIT.
  2921     EXIT.
  2922
  2923 9999-DFHBACK SECTION.
  2924     MOVE '9%                    "   ' TO DFHEIV0
  2925     MOVE 'EL1044' TO DFHEIV1
  2926     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2927     GOBACK.
  2928 9999-DFHEXIT.
  2929     IF DFHEIGDJ EQUAL 0001
  2930         NEXT SENTENCE
  2931     ELSE IF DFHEIGDJ EQUAL 2
  2932         GO TO 8850-DUPREC,
  2933               8870-NOTOPEN,
* Micro Focus Server Express         V5.1 revision 000 11-Dec-13 07:06 Page  55
* EL1044.cbl
  2934               8880-NOT-FOUND,
  2935               9600-PGMID-ERROR,
  2936               9990-ABEND
  2937         DEPENDING ON DFHEIGDI
  2938     ELSE IF DFHEIGDJ EQUAL 3
  2939         GO TO 8300-SEND-TEXT
  2940         DEPENDING ON DFHEIGDI.
  2941     MOVE '9%                    "   ' TO DFHEIV0
  2942     MOVE 'EL1044' TO DFHEIV1
  2943     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2944     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4640     Code:        7238
