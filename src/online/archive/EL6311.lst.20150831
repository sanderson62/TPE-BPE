* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76******************************************************************
    77
    78 ENVIRONMENT DIVISION.
    79
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   4
* EL6311.cbl
    81 DATA DIVISION.
    82 WORKING-STORAGE SECTION.
    83 01  DFH-START PIC X(04).
    84 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    85 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    86 77  FILLER  PIC X(32)  VALUE '********************************'.
    87 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    88 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    89 77  A1                          PIC S999 COMP-3 VALUE +0.
    90 77  N1                          PIC S999 COMP-3 VALUE +0.
    91 77  N2                          PIC S999 COMP-3 VALUE +0.
    92 77  N3                          PIC S999 COMP-3 VALUE +0.
    93 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    94 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    95 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    96     88  REVERSAL                    VALUE 'Y'.
    97 77  WS-NOTE-SW                  PIC X  VALUE ' '.
    98 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
    99 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   100 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   101 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   102     88  ERMAIL-FOUND                 VALUE 'Y'.
   103 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   104 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   105 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   106 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   107     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   108 77  ws-stop-sw                  pic x value ' '.
   109     88  i-say-stop                 value 'Y'.
   110 77  ws-check-sw                 pic x value ' '.
   111     88  i-have-checks              value 'Y'.
   112 77  ws-proc-check-sw            pic x value ' '.
   113     88  i-have-processed-checks    value 'Y'.
   114 77  ws-chek-browse-sw           pic x value ' '.
   115 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   116 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   117 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   118 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   119
   120*    COPY ELCSCTM.
   121******************************************************************
   122*                                                                *
   123*                                                                *
   124*                            ELCSCTM                             *
   125*                            VMOD=2.001                          *
   126*                                                                *
   127*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   128*                                                                *
   129******************************************************************
   130 01  SECURITY-MESSAGE.
   131     12  FILLER                          PIC X(30)
   132            VALUE '** LOGIC SECURITY VIOLATION -'.
   133     12  SM-READ                         PIC X(6).
   134     12  FILLER                          PIC X(5)
   135            VALUE ' PGM='.
   136     12  SM-PGM                          PIC X(6).
   137     12  FILLER                          PIC X(5)
   138            VALUE ' OPR='.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   5
* EL6311.cbl
   139     12  SM-PROCESSOR-ID                 PIC X(4).
   140     12  FILLER                          PIC X(6)
   141            VALUE ' TERM='.
   142     12  SM-TERMID                       PIC X(4).
   143     12  FILLER                          PIC XX   VALUE SPACE.
   144     12  SM-JUL-DATE                     PIC 9(5).
   145     12  FILLER                          PIC X    VALUE SPACE.
   146     12  SM-TIME                         PIC 99.99.
   147
   148
   149*    COPY ELCSCRTY.
   150******************************************************************
   151*                                                                *
   152*                                                                *
   153*                            ELCSCRTY                            *
   154*                            VMOD=2.001                          *
   155*                                                                *
   156*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   157*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   158*        SAVED IN PI-SECURITY-ADDRESS.                           *
   159*                                                                *
   160******************************************************************
   161 01  SECURITY-CONTROL.
   162     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   163     12  FILLER                       PIC XX    VALUE 'SC'.
   164     12  SC-CREDIT-CODES.
   165         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   166             20  SC-CREDIT-DISPLAY    PIC X.
   167             20  SC-CREDIT-UPDATE     PIC X.
   168     12  SC-CLAIMS-CODES.
   169         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   170             20  SC-CLAIMS-DISPLAY    PIC X.
   171             20  SC-CLAIMS-UPDATE     PIC X.
   172
   173 01  WS-VA-NO-COMM-MESS.
   174     12  FILLER                  PIC X(41) VALUE
   175        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   176 01  WS-OC-MESSAGE.
   177     12  FILLER                  PIC X(43) VALUE
   178        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   179     12  WS-OC-DIS-AMT           PIC -----9.99.
   180     12  FILLER                  PIC X(4) VALUE ' ON '.
   181     12  WS-OC-DATE              PIC X(10).
   182 01  WS-DATE-AREA.
   183     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   184     12  WS-CURRENT-DT.
   185         16  FILLER              PIC X(6)    VALUE SPACES.
   186         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   187     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   188     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   189     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   190
   191 01  STANDARD-AREAS.
   192     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   193     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   194     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   195     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   196     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   6
* EL6311.cbl
   197     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   198     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   199     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   200     12  PGM-NAME                PIC X(8).
   201     12  TIME-IN                 PIC S9(7).
   202     12  TIME-OUT-R  REDEFINES TIME-IN.
   203         16  FILLER              PIC X.
   204         16  TIME-OUT            PIC 99V99.
   205         16  FILLER              PIC XX.
   206     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   207     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   208     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   209     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   210     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   211     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   212     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   213     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   214     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   215     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   216     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   217     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   218     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   219     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   220     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   221     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   222     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   223     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   224     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   225     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   226     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   227     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   228     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   229     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   230     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   231     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   232     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   233     12  FILE-ID                 PIC X(8).
   234     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   235     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   236     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   237     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   238     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   239     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   240     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   241     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   242     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   243     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   244     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   245     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   246     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   247     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   248     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   249
   250 01  WS-PASS-AREA.
   251     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   252     05  WS-PASS-VADS-REC    PIC X(350).
   253*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   254*                                COPY ELCZREC.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   7
* EL6311.cbl
   255******************************************************************
   256*                                                                *
   257*                                                                *
   258*                            ELCZREC.                            *
   259*                                                                *
   260*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   261*                                                                *
   262******************************************************************
   263*-----------------------------------------------------------------
   264*                   C H A N G E   L O G
   265*
   266* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   267*-----------------------------------------------------------------
   268*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   269* EFFECTIVE    NUMBER
   270*-----------------------------------------------------------------
   271* 122011    2011022800001  AJRA  NEW FILE
   272* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   273* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   274* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   275* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   276*-----------------------------------------------------------------
   277 01  W-Z-CONTROL-DATA.
   278     05  W-NUMBER-OF-COPIES      PIC  9.
   279     05  FILLER                  PIC  X.
   280     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   281     05  FILLER                  PIC  X.
   282     05  W-DAYS-TO-RESEND        PIC  999.
   283     05  FILLER                  PIC  X.
   284     05  W-FORM-TO-RESEND        PIC  X(4).
   285     05  W-ADD-BAR-CODE          PIC  X.
   286     05  W-PROMPT-LETTER         PIC  X.
   287     05  W-HAS-RETURN-ENV        PIC  X.
   288     05  W-ENCLOSURE-CD          PIC  XXX.
   289     05  W-SIG-FLAG-DEFAULT      PIC  X.
   290     05  W-AUTO-CLOSE-IND        PIC  X.
   291     05  FILLER                  PIC  X.
   292     05  W-LETTER-TO-BENE        PIC  X.
   293     05  FILLER                  PIC  X.
   294     05  W-LETTER-TO-ACCT        PIC  X.
   295     05  FILLER                  PIC  X.
   296     05  W-LETTER-TYPE           PIC  X.
   297     05  FILLER                  PIC  X.
   298     05  W-PRINT-CERTIFICATE     PIC  X.
   299     05  FILLER                  PIC  X.
   300     05  W-REFUND-REQUIRED       PIC  X.
   301     05  FILLER                  PIC  X.
   302     05  W-ONBASE-CODE           PIC  XX.
   303     05  FILLER                  PIC  X.
   304     05  W-ACCT-SUMM             PIC  X.
   305     05  FILLER                  PIC  X.
   306     05  W-CSO-SUMM              PIC  X.
   307     05  FILLER                  PIC  X.
   308     05  W-REASONS-REQUIRED      PIC  X.
   309     05  FILLER                  PIC  X(29).
   310******************************************************************
   311*                                                                *
   312*              A C C E S S   K E Y S                             *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   8
* EL6311.cbl
   313*                                                                *
   314******************************************************************
   315
   316 01  ACCESS-KEYS.
   317     12  ERPYAJ-KEY.
   318         16  ERPYAJ-COMPANY-CD       PIC X.
   319         16  ERPYAJ-CARRIER          PIC X.
   320         16  ERPYAJ-GROUPING         PIC X(6).
   321         16  ERPYAJ-FIN-RESP         PIC X(10).
   322         16  ERPYAJ-ACCOUNT          PIC X(10).
   323         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   324         16  ERPYAJ-TYPE             PIC X.
   325     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   326     12  ELCERT-KEY.
   327         16  ELCERT-COMPANY-CD       PIC X.
   328         16  ELCERT-CARRIER          PIC X.
   329         16  ELCERT-GROUPING         PIC X(6).
   330         16  ELCERT-STATE            PIC XX.
   331         16  ELCERT-ACCOUNT          PIC X(10).
   332         16  ELCERT-CERT-EFF-DT      PIC XX.
   333         16  ELCERT-CERT-NO.
   334             20  ELCERT-CERT-PRIME   PIC X(10).
   335             20  ELCERT-CERT-SFX     PIC X.
   336
   337     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   338     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   339     12  ELCRTO-KEY.
   340         16  ELCRTO-COMPANY-CD       PIC X.
   341         16  ELCRTO-CARRIER          PIC X.
   342         16  ELCRTO-GROUPING         PIC X(6).
   343         16  ELCRTO-STATE            PIC XX.
   344         16  ELCRTO-ACCOUNT          PIC X(10).
   345         16  ELCRTO-CERT-EFF-DT      PIC XX.
   346         16  ELCRTO-CERT-NO.
   347             20  ELCRTO-CERT-PRIME   PIC X(10).
   348             20  ELCRTO-CERT-SFX     PIC X.
   349         16  ELCRTO-RECORD-TYPE      PIC X.
   350         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   351
   352     12  ELCRTT-KEY.
   353         16  ELCRTT-PRIMARY          PIC X(33).
   354         16  ELCRTT-REC-TYPE         PIC X(1).
   355     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   356     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   357
   358     12  ERPNDB-KEY.
   359         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   360         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   361         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   362         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   363             ERPNDB-BATCH-SEQ-NO     PIC XX.
   364         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   365
   366     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   367     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   368     12  ERCHEK-KEY.
   369         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   370         16  CHEK-CARRIER            PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page   9
* EL6311.cbl
   371         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   372         16  CHEK-STATE              PIC XX      VALUE SPACES.
   373         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   374         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   375         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   376         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   377         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   378     12  ELLETR-KEY.
   379         16  LETR-COMPANY-CD     PIC X.
   380         16  LETR-LETTER-ID      PIC X(4).
   381         16  LETR-FILLER         PIC X(8).
   382         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   383     12  ERPNDM-KEY.
   384         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   385         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   386         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   387         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   388
   389*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   390     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   391*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   392     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   393
   394     12  ERPNDB-ALT-KEY.
   395         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   396         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   397         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   398         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   399         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   400         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   401         16  ERPNDB-CERT-NO.
   402             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   403             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   404         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   405         16  ERPNDB-RECORD-TYPE      PIC X.
   406
   407      12  ERPNDB-CSR-KEY.
   408          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   409          20  ERPNDB-CSR-ID                PIC X(4).
   410          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   411          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   412          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   413
   414     12  ERNOTE-KEY.
   415         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   416         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   417         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   418         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   419         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   420         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   421         16  ERNOTE-CERT-NO.
   422             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   423             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   424
   425     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   426     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   427
   428     12  ERCNOT-KEY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  10
* EL6311.cbl
   429         16  ERCNOT-PART-KEY.
   430             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   431             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   432             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   433             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   434             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   435             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   436             20  ERCNOT-CERT-NO.
   437                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   438                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   439         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   440         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   441
   442     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   443     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   444
   445     12  ERMAIL-KEY.
   446         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   447         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   448         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   449         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   450         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   451         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   452         16  ERMAIL-CERT-NO.
   453             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   454             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   455
   456     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   457     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   458
   459     12  ERRQST-KEY.
   460         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   461         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   462
   463     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   464     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   465
   466     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   467
   468     12  ERLOFC-KEY.
   469         16  ERLOFC-COMPANY-CD          PIC  X.
   470         16  ERLOFC-CARRIER             PIC  X.
   471         16  ERLOFC-GROUPING            PIC  X(6).
   472         16  ERLOFC-STATE               PIC  XX.
   473         16  ERLOFC-ACCOUNT             PIC  X(10).
   474         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   475*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   476
   477     12  ERACCT-KEY.
   478         16  ERACCT-COMPANY-CD          PIC  X.
   479         16  ERACCT-CARRIER             PIC  X.
   480         16  ERACCT-GROUPING            PIC  X(6).
   481         16  ERACCT-STATE               PIC  XX.
   482         16  ERACCT-ACCOUNT             PIC  X(10).
   483         16  ERACCT-EXP-DT.
   484             20  ERACCT-DT              PIC  XX.
   485             20  ERACCT-FILL            PIC  X(4).
   486
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  11
* EL6311.cbl
   487     12  ERENDT-KEY.
   488         16  ENDT-COMPANY-CD       PIC X.
   489         16  ENDT-CARRIER          PIC X.
   490         16  ENDT-GROUPING         PIC X(6).
   491         16  ENDT-STATE            PIC XX.
   492         16  ENDT-ACCOUNT          PIC X(10).
   493         16  ENDT-CERT-EFF-DT      PIC XX.
   494         16  ENDT-CERT-PRIME       PIC X(10).
   495         16  ENDT-CERT-SFX         PIC X.
   496         16  ENDT-RECORD-TYPE      PIC X.
   497         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   498
   499 01  WS-ELMSTR-WORK.
   500     12  ELMSTR-KEY.
   501         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   502         16  MSTR-CERT-NO.
   503             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   504             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   505     12  W-CLAIM-KEY.
   506         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   507         16  W-CL-CERT-NO.
   508             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   509             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   510      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   511 01  CANCEL-GEN-PASS-AREA.
   512     05  CG-OPTION-CODE          PIC X.
   513         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   514         88  CG-FLAT-CANCEL        VALUE '1'.
   515         88  CG-CANCEL             VALUE '2'.
   516         88  CG-CANCEL-REISSUE     VALUE '3'.
   517     05  CG-ERROR-CODE           PIC 99.
   518         88  CG-SUCCESS            VALUE 00.
   519         88  CG-DATE-ERROR         VALUE 01.
   520         88  CG-CERT-NOT-FOUND     VALUE 02.
   521         88  CG-AMOUNT-ERROR       VALUE 04.
   522         88  CG-OPTION-ERROR       VALUE 05.
   523         88  CG-PREV-CAN           VALUE 06.
   524         88  CG-INVALID-DATA       VALUE 07.
   525         88  CG-NO-ACCT-MSTR       VALUE 08.
   526         88  CG-SFX-A-EXIST        VALUE 09.
   527         88  CG-MISC-ERROR         VALUE 99.
   528     05  CG-COMPANY-ID           PIC XXX.
   529     05  CG-PROC-ID              PIC XXXX.
   530     05  CG-CURRENT-DT           PIC XX.
   531     05  CG-MONTH-END-DT         PIC XX.
   532     05  CG-CERT-KEY.
   533         10  CG-CERT-COMPANY-CD  PIC X.
   534         10  CG-CERT-CARRIER     PIC X.
   535         10  CG-CERT-GROUP       PIC X(6).
   536         10  CG-CERT-STATE       PIC XX.
   537         10  CG-CERT-ACCOUNT     PIC X(10).
   538         10  CG-CERT-EFF-DT      PIC XX.
   539         10  CG-CERT-CERT-NO     PIC X(11).
   540     05  CG-LF-CAN-DATA.
   541         10  CG-LF-CAN-DT        PIC XX.
   542         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   543     05  CG-AH-CAN-DATA.
   544         10  CG-AH-CAN-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  12
* EL6311.cbl
   545         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   546     05  CG-CERT-PROFILE-DATA.
   547         10  CG-INS-LNAME        PIC X(15).
   548         10  CG-INS-FNAME        PIC X(10).
   549         10  CG-INS-MID-INIT     PIC X.
   550         10  CG-INS-AGE          PIC 99.
   551         10  CG-JNT-LNAME        PIC X(15).
   552         10  CG-JNT-FNAME        PIC X(10).
   553         10  CG-JNT-MID-INIT     PIC X.
   554         10  CG-JNT-AGE          PIC 99.
   555     05  CG-LF-ISS-DATA.
   556         10  CG-LF-BENCD         PIC XX.
   557         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   558         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   559     05  CG-AH-ISS-DATA.
   560         10  CG-AH-BENCD         PIC XX.
   561         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   562     05  CG-BATCH-NO             PIC X(6).
   563     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   564     05  FILLER                  PIC X(306).
   565******************************************************************
   566*                                                                *
   567*            G E N E R A L   W O R K   A R E A                   *
   568*                                                                *
   569******************************************************************
   570
   571 01  WORK-AREA.
   572     12  WS-RESPONSE             PIC S9(8)   COMP.
   573         88  RESP-NORMAL           VALUE +0.
   574         88  resp-file-notfnd      value +12.
   575         88  RESP-NOTFND           VALUE +13.
   576         88  resp-duprec           value +14.
   577         88  resp-dupkey           value +15.
   578         88  resp-invreq           value +16.
   579         88  RESP-NOTOPEN          VALUE +19.
   580         88  RESP-ENDFILE          VALUE +20.
   581         88  resp-lengtherr        value +22.
   582     12  DEEDIT-FIELD            PIC X(15).
   583     12  FILLER          REDEFINES DEEDIT-FIELD.
   584         16  FILLER              PIC X(4).
   585         16  DEEDIT-FIELD-X11    PIC X(11).
   586     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   587                                 PIC S9(15).
   588     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   589                                 PIC S9(13)V99.
   590     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   591                                 PIC S9(11)V9999.
   592     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   593     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   594     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   595         16  WS-CALC-TERM-WHOLE  PIC S999.
   596         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   597
   598     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   599     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   600         16  WS-HR-MINS          PIC 99V99.
   601         16  FILLER              PIC XX.
   602
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  13
* EL6311.cbl
   603     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   604     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   605
   606     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   607     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   608
   609     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   610     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   611     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   612     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   613     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   614     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   615     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   616
   617     12  QID.
   618         16  QID-TERM            PIC X(4).
   619         16  FILLER              PIC X(4)    VALUE '607B'.
   620
   621     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   622         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   623
   624     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   625         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   626
   627     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   628         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   629                                         'A'.
   630
   631     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   632
   633     12  WS-NUMERIC-SW           PIC X.
   634        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   635
   636     12  WS-EDIT-CSO-FIELD.
   637         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   638                                 PIC X.
   639
   640     12  WS-SAVE-INPUT-FIELDS.
   641         16  WS-BAGE             PIC 99       VALUE ZERO.
   642*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   643         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   644         16  FILLER REDEFINES WS-BAPR.
   645             20  WS-APR-WHOLE-NUM    PIC 99.
   646             20  WS-APR-DEC          PIC 9999.
   647         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   648         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   649
   650         16  WS-B-COVERAGE OCCURS 2 TIMES.
   651             20  WS-TERM-IN-DAYS-SW  PIC X.
   652                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   653             20  WS-BTERM        PIC 999       COMP-3.
   654             20  WS-BALT-TERM    PIC 999       COMP-3.
   655             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   656             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   657             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   658             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   659             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   660             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  14
* EL6311.cbl
   661
   662         16  WS-C-FIELDS COMP-3.
   663             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   664             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   665             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   666
   667         16  WS-D-FIELDS COMP-3.
   668             20  WS-DRISS        PIC S9(5)    VALUE +0.
   669             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   670             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   671             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   672             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   673             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   674
   675     12  WS-SAVE-BIRTH-DATE.
   676         16  FILLER              PIC X(4)   VALUE SPACES.
   677         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   678
   679     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   680     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   681     12  FILLER REDEFINES WS-WORK-BIN-RED.
   682         16  FILLER              PIC X(02).
   683         16  WS-WORK-BIN-DT      PIC X(02).
   684     12  WS-SW-1                 PIC X     VALUE SPACE.
   685     12  WS-SW-2                 PIC X     VALUE SPACE.
   686     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   687         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   688     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   689         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   690
   691     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   692     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   693     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   694     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   695     12  WS-CONVERTED-CANCEL-DATES.
   696         16  WS-CONVERTED-CANDT1                  PIC XX.
   697         16  WS-CONVERTED-CANDT2                  PIC XX.
   698
   699     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   700
   701     12  WS-REC-FOUND-SW         PIC X.
   702         88  RECORD-NOT-FOUND    VALUE 'N'.
   703
   704     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   705         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   706         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   707
   708     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   709         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   710         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   711
   712     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   713         88  BROWSE-STARTED      VALUE 'Y'.
   714
   715     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   716         88  FIRST-TIME          VALUE 'Y'.
   717
   718     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  15
* EL6311.cbl
   719         88  FIRST-ENTRY         VALUE 'Y'.
   720
   721     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   722         88  REC-BILLED          VALUE 'Y'.
   723
   724     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   725         88  NO-CURSOR-SET       VALUE +0.
   726         88  CURSOR-SET          VALUE +1.
   727
   728     12  WS-ERR-SW               PIC X.
   729         88  STD-ERRORS          VALUE 'S'.
   730         88  TRN-ERRORS          VALUE 'T'.
   731
   732     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   733         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   734
   735     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   736         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   737
   738     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   739         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   740
   741     12  WS-ERR-CODE.
   742         16  FILLER              PIC 99.
   743         16  WS-ERROR-SUB        PIC 99.
   744
   745     12  WS-DATE-WORK.
   746         16  WS-WORK-MM          PIC XX.
   747         16  WS-WORK-DD          PIC XX.
   748         16  WS-WORK-YY          PIC XX.
   749
   750     12  WS-MM-YY.
   751         16  WS-MM               PIC XX.
   752         16  FILLER              PIC X     VALUE '/'.
   753         16  WS-YY               PIC XX.
   754
   755     12  WS-CERT-EFF-DT          PIC XX.
   756
   757     12  WS-MEMBER-NO            PIC X(12).
   758     12  FILLER  REDEFINES  WS-MEMBER-NO.
   759         16  WS-MEMBER-NO-1-8    PIC 9(8).
   760         16  FILLER              PIC X(4).
   761
   762     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   763
   764     12  WS-ERPNDB-ALT-KEY.
   765         16  WS-PB-COMPANY-CD-A1         PIC X.
   766         16  WS-PB-CARRIER               PIC X.
   767         16  WS-PB-GROUPING              PIC X(6).
   768         16  WS-PB-STATE                 PIC XX.
   769         16  WS-PB-ACCOUNT               PIC X(10).
   770         16  WS-PB-CERT-EFF-DT           PIC XX.
   771         16  WS-PB-CERT-NO.
   772             20  WS-PB-CERT-PRIME        PIC X(10).
   773             20  WS-PB-CERT-SFX          PIC X.
   774         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   775         16  WS-PB-RECORD-TYPE           PIC X.
   776
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  16
* EL6311.cbl
   777     12  WS-SHOW-SAVE-AREAS.
   778         16  WS-NEW-CERT-NO.
   779             20  WS-NEW-PRIME    PIC X(10).
   780             20  WS-NEW-SUFFIX   PIC X.
   781         16  WS-NEW-CERT-EFF-DT  PIC XX.
   782         16  WS-NEW-RECORD-TYPE  PIC X.
   783         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   784             88   SHOW-RECORD            VALUE 'Y'.
   785
   786     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   787
   788     12  WS-BATCH-NO.
   789         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   790         16  FILLER              PIC X(5) VALUE SPACES.
   791
   792     12  WS-FIRST-NAME.
   793         16  WS-1ST-INIT         PIC X.
   794         16  FILLER              PIC X(9).
   795
   796     12  WS-INITIALS.
   797         16  WS-INITIAL-1        PIC X.
   798         16  WS-INITIAL-2        PIC X.
   799
   800     12  WS-C-HDG.
   801         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   802         16  FILLER              PIC X(4) VALUE '-REF'.
   803
   804     12  WS-D-PREM-HDG.
   805         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   806         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   807
   808     12  WS-D-REFUND-HDG.
   809         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   810         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   811
   812     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   813
   814     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   815     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   816     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   817     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   818     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   819     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   820     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   821
   822     12  WS-01-CANCEL-ERR        PIC X(25)
   823         VALUE 'CANCEL DATE ERROR'.
   824     12  WS-02-CANCEL-ERR        PIC X(25)
   825         VALUE 'CERT NOT FOUND'.
   826     12  WS-04-CANCEL-ERR        PIC X(25)
   827         VALUE 'CANCEL AMOUNT ERROR'.
   828     12  WS-05-CANCEL-ERR        PIC X(25)
   829         VALUE 'CANCEL OPTION ERROR'.
   830     12  WS-06-CANCEL-ERR        PIC X(25)
   831         VALUE 'PREVIOUSLY CANCELLED'.
   832     12  WS-07-CANCEL-ERR        PIC X(25)
   833         VALUE 'INVALID DATA'.
   834     12  WS-08-CANCEL-ERR        PIC X(25)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  17
* EL6311.cbl
   835         VALUE 'NO ACCOUNT MASTER'.
   836     12  WS-09-CANCEL-ERR        PIC X(25)
   837         VALUE 'SUFFIX ALREADY EXISTS'.
   838     12  WS-99-CANCEL-ERR        PIC X(25)
   839         VALUE 'MISC CANCEL ERROR'.
   840
   841     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   842     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   843
   844     12  WS-AGE-FIELDS.
   845         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   846         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   847         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   848         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   849
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  18
* EL6311.cbl
   851
   852******************************************************************
   853*                                                                *
   854*                 B A T C H   T O T A L S                        *
   855*                                                                *
   856******************************************************************
   857
   858     12  WS-BATCH-RECORD.
   859         16  FILLER                       PIC X(10).
   860         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   861         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   862         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   863         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   864         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   865         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   866         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   867         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   868         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   869         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   870         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   871         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   872         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   873         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   874         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   875         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   876         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   877         16  WS-ACCOUNT-NAME              PIC X(30).
   878         16  FILLER                       PIC X.
   879         16  WS-REFERENCE                 PIC X(12).
   880         16  FILLER                       PIC X(197).
   881
   882     12  WS-BATCH-TOTALS.
   883         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   884         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   885         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   886         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   887         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   888         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   889         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   890         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   891         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   892         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   893         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   894         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   895         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   896         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   897         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   898         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   899         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   900         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   901         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   902
   903     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   904
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  19
* EL6311.cbl
   906
   907******************************************************************
   908*                                                                *
   909*                E R R O R   M E S S A G E S                     *
   910*                                                                *
   911******************************************************************
   912
   913 01  ERROR-MESSAGES.
   914     12  ER-0004                 PIC  9(4) VALUE 0004.
   915     12  ER-0008                 PIC  9(4) VALUE 0008.
   916     12  ER-0023                 PIC  9(4) VALUE 0023.
   917     12  ER-0029                 PIC  9(4) VALUE 0029.
   918     12  ER-0033                 PIC  9(4) VALUE 0033.
   919     12  ER-0070                 PIC  9(4) VALUE 0070.
   920     12  ER-0220                 PIC  9(4) VALUE 0220.
   921     12  ER-0248                 PIC  9(4) VALUE 0248.
   922     12  ER-0280                 PIC  9(4) VALUE 0280.
   923     12  ER-0348                 PIC  9(4) VALUE 0348.
   924     12  ER-0582                 PIC  9(4) VALUE 0582.
   925     12  ER-0877                 PIC  9(4) VALUE 0877.
   926     12  ER-1236                 PIC  9(4) VALUE 1236.
   927     12  ER-1570                 PIC  9(4) VALUE 1570.
   928     12  ER-1575                 PIC  9(4) VALUE 1575.
   929     12  ER-1609                 PIC  9(4) VALUE 1609.
   930     12  ER-1819                 PIC  9(4) VALUE 1819.
   931     12  ER-2077                 PIC  9(4) VALUE 2077.
   932     12  ER-2129                 PIC  9(4) VALUE 2129.
   933     12  ER-2188                 PIC  9(4) VALUE 2188.
   934     12  ER-2192                 PIC  9(4) VALUE 2192.
   935     12  ER-2196                 PIC  9(4) VALUE 2196.
   936     12  ER-2197                 PIC  9(4) VALUE 2197.
   937     12  ER-2198                 PIC  9(4) VALUE 2198.
   938     12  ER-2200                 PIC  9(4) VALUE 2200.
   939     12  ER-2212                 PIC  9(4) VALUE 2212.
   940     12  ER-2218                 PIC  9(4) VALUE 2218.
   941     12  ER-2220                 PIC  9(4) VALUE 2220.
   942     12  ER-2222                 PIC  9(4) VALUE 2222.
   943     12  ER-2223                 PIC  9(4) VALUE 2223.
   944     12  ER-2224                 PIC  9(4) VALUE 2224.
   945     12  ER-2225                 PIC  9(4) VALUE 2225.
   946     12  ER-2226                 PIC  9(4) VALUE 2226.
   947     12  ER-2227                 PIC  9(4) VALUE 2227.
   948     12  ER-2228                 PIC  9(4) VALUE 2228.
   949     12  ER-2240                 PIC  9(4) VALUE 2240.
   950     12  ER-2241                 PIC  9(4) VALUE 2241.
   951     12  ER-2242                 PIC  9(4) VALUE 2242.
   952     12  ER-2243                 PIC  9(4) VALUE 2243.
   953     12  ER-2244                 PIC  9(4) VALUE 2244.
   954     12  ER-2245                 PIC  9(4) VALUE 2245.
   955     12  ER-2246                 PIC  9(4) VALUE 2246.
   956     12  ER-2247                 PIC  9(4) VALUE 2247.
   957     12  ER-2251                 PIC  9(4) VALUE 2251.
   958     12  ER-2252                 PIC  9(4) VALUE 2252.
   959     12  ER-2253                 PIC  9(4) VALUE 2253.
   960     12  ER-2254                 PIC  9(4) VALUE 2254.
   961     12  ER-2255                 PIC  9(4) VALUE 2255.
   962     12  ER-2256                 PIC  9(4) VALUE 2256.
   963     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  20
* EL6311.cbl
   964     12  ER-2258                 PIC  9(4) VALUE 2258.
   965     12  ER-2259                 PIC  9(4) VALUE 2259.
   966     12  ER-2260                 PIC  9(4) VALUE 2260.
   967     12  ER-2261                 PIC  9(4) VALUE 2261.
   968     12  ER-2287                 PIC  9(4) VALUE 2287.
   969     12  ER-2336                 PIC  9(4) VALUE 2336.
   970     12  ER-2337                 PIC  9(4) VALUE 2337.
   971     12  ER-2437                 PIC  9(4) VALUE 2437.
   972     12  ER-2471                 PIC  9(4) VALUE 2471.
   973     12  ER-2530                 PIC  9(4) VALUE 2530.
   974     12  ER-2531                 PIC  9(4) VALUE 2531.
   975     12  ER-2532                 PIC  9(4) VALUE 2532.
   976     12  ER-2533                 PIC  9(4) VALUE 2533.
   977     12  ER-2547                 PIC  9(4) VALUE 2547.
   978     12  ER-2591                 PIC  9(4) VALUE 2591.
   979     12  ER-2592                 PIC  9(4) VALUE 2592.
   980     12  ER-2593                 PIC  9(4) VALUE 2593.
   981     12  ER-2600                 PIC  9(4) VALUE 2600.
   982     12  ER-2601                 PIC  9(4) VALUE 2601.
   983     12  ER-2604                 PIC  9(4) VALUE 2604.
   984     12  ER-2605                 PIC  9(4) VALUE 2605.
   985     12  ER-2606                 PIC  9(4) VALUE 2606.
   986     12  ER-2607                 PIC  9(4) VALUE 2607.
   987     12  ER-2622                 PIC  9(4) VALUE 2622.
   988     12  ER-2625                 PIC  9(4) VALUE 2625.
   989     12  ER-2626                 PIC  9(4) VALUE 2626.
   990     12  ER-2627                 PIC  9(4) VALUE 2627.
   991     12  ER-2628                 PIC  9(4) VALUE 2628.
   992     12  ER-2629                 PIC  9(4) VALUE 2629.
   993     12  ER-2630                 PIC  9(4) VALUE 2630.
   994     12  ER-2631                 PIC  9(4) VALUE 2631.
   995     12  ER-2632                 PIC  9(4) VALUE 2632.
   996     12  ER-2633                 PIC  9(4) VALUE 2633.
   997     12  ER-2634                 PIC  9(4) VALUE 2634.
   998     12  ER-2635                 PIC  9(4) VALUE 2635.
   999     12  ER-2636                 PIC  9(4) VALUE 2636.
  1000     12  ER-2639                 PIC  9(4) VALUE 2639.
  1001     12  ER-2640                 PIC  9(4) VALUE 2640.
  1002     12  ER-2647                 PIC  9(4) VALUE 2647.
  1003     12  ER-2648                 PIC  9(4) VALUE 2648.
  1004     12  ER-2649                 PIC  9(4) VALUE 2649.
  1005     12  ER-2650                 PIC  9(4) VALUE 2650.
  1006     12  ER-2653                 PIC  9(4) VALUE 2653.
  1007     12  ER-2654                 PIC  9(4) VALUE 2654.
  1008     12  ER-2655                 PIC  9(4) VALUE 2655.
  1009     12  ER-2656                 PIC  9(4) VALUE 2656.
  1010     12  ER-2657                 PIC  9(4) VALUE 2657.
  1011     12  ER-2660                 PIC  9(4) VALUE 2660.
  1012     12  ER-2661                 PIC  9(4) VALUE 2661.
  1013     12  ER-2662                 PIC  9(4) VALUE 2662.
  1014     12  ER-2663                 PIC  9(4) VALUE 2663.
  1015     12  ER-2664                 PIC  9(4) VALUE 2664.
  1016     12  ER-2667                 PIC  9(4) VALUE 2667.
  1017     12  ER-2668                 PIC  9(4) VALUE 2668.
  1018     12  ER-2669                 PIC  9(4) VALUE 2669.
  1019     12  ER-2670                 PIC  9(4) VALUE 2670.
  1020     12  ER-2671                 PIC  9(4) VALUE 2671.
  1021     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  21
* EL6311.cbl
  1022     12  ER-2673                 PIC  9(4) VALUE 2673.
  1023     12  ER-2677                 PIC  9(4) VALUE 2677.
  1024     12  ER-2678                 PIC  9(4) VALUE 2678.
  1025     12  ER-2679                 PIC  9(4) VALUE 2679.
  1026     12  ER-2680                 PIC  9(4) VALUE 2680.
  1027     12  ER-2681                 PIC  9(4) VALUE 2681.
  1028     12  ER-2682                 PIC  9(4) VALUE 2682.
  1029     12  ER-2683                 PIC  9(4) VALUE 2683.
  1030     12  ER-2684                 PIC  9(4) VALUE 2684.
  1031     12  ER-2686                 PIC  9(4) VALUE 2686.
  1032     12  ER-2689                 PIC  9(4) VALUE 2689.
  1033     12  ER-2690                 PIC  9(4) VALUE 2690.
  1034     12  ER-2693                 PIC  9(4) VALUE 2693.
  1035     12  ER-2695                 PIC  9(4) VALUE 2695.
  1036     12  ER-2701                 PIC  9(4) VALUE 2701.
  1037     12  ER-2720                 PIC  9(4) VALUE 2720.
  1038     12  ER-2709                 PIC  9(4) VALUE 2709.
  1039     12  ER-2704                 PIC  9(4) VALUE 2704.
  1040     12  ER-2725                 PIC  9(4) VALUE 2725.
  1041     12  ER-2726                 PIC  9(4) VALUE 2726.
  1042     12  ER-2728                 PIC  9(4) VALUE 2728.
  1043     12  ER-2729                 PIC  9(4) VALUE 2729.
  1044     12  ER-2731                 PIC  9(4) VALUE 2731.
  1045     12  ER-2732                 PIC  9(4) VALUE 2732.
  1046     12  ER-2733                 PIC  9(4) VALUE 2733.
  1047     12  ER-2735                 PIC  9(4) VALUE 2735.
  1048     12  ER-2738                 PIC  9(4) VALUE 2738.
  1049     12  ER-2742                 PIC  9(4) VALUE 2742.
  1050     12  ER-2743                 PIC  9(4) VALUE 2743.
  1051     12  ER-2744                 PIC  9(4) VALUE 2744.
  1052     12  ER-2747                 PIC  9(4) VALUE 2747.
  1053     12  ER-2749                 PIC  9(4) VALUE 2749.
  1054     12  ER-2753                 PIC  9(4) VALUE 2753.
  1055     12  ER-2755                 PIC  9(4) VALUE 2755.
  1056     12  ER-2757                 PIC  9(4) VALUE 2757.
  1057     12  ER-2771                 PIC  9(4) VALUE 2771.
  1058     12  ER-2774                 PIC  9(4) VALUE 2774.
  1059     12  ER-2775                 PIC  9(4) VALUE 2775.
  1060     12  ER-2776                 PIC  9(4) VALUE 2776.
  1061     12  ER-2777                 PIC  9(4) VALUE 2777.
  1062     12  ER-2794                 PIC  9(4) VALUE 2794.
  1063     12  ER-2799                 PIC  9(4) VALUE 2799.
  1064     12  ER-2900                 PIC  9(4) VALUE 2900.
  1065     12  ER-2902                 PIC  9(4) VALUE 2902.
  1066     12  ER-2945                 PIC  9(4) VALUE 2945.
  1067     12  ER-3000                 PIC  9(4) VALUE 3000.
  1068     12  ER-3006                 PIC  9(4) VALUE 3006.
  1069     12  ER-3054                 PIC  9(4) VALUE 3054.
  1070     12  ER-3224                 PIC  9(4) VALUE 3224.
  1071     12  ER-3269                 PIC  9(4) VALUE 3269.
  1072     12  er-3444                 pic  9(4) value 3444.
  1073     12  er-3446                 pic  9(4) value 3446.
  1074     12  er-3447                 pic  9(4) value 3447.
  1075     12  er-3448                 pic  9(4) value 3448.
  1076     12  er-3449                 pic  9(4) value 3449.
  1077     12  ER-3504                 PIC  9(4) VALUE 3504.
  1078     12  ER-3513                 PIC  9(4) VALUE 3513.
  1079     12  ER-3831                 PIC  9(4) VALUE 3831.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  22
* EL6311.cbl
  1080     12  ER-3834                 PIC  9(4) VALUE 3834.
  1081     12  ER-3835                 PIC  9(4) VALUE 3835.
  1082     12  ER-4005                 PIC  9(4) VALUE 4005.
  1083     12  ER-7144                 PIC  9(4) VALUE 7144.
  1084     12  ER-7401                 PIC  9(4) VALUE 7401.
  1085     12  ER-7402                 PIC  9(4) VALUE 7402.
  1086     12  ER-7403                 PIC  9(4) VALUE 7403.
  1087     12  ER-7404                 PIC  9(4) VALUE 7404.
  1088     12  ER-7423                 PIC  9(4) VALUE 7423.
  1089     12  ER-7424                 PIC  9(4) VALUE 7424.
  1090     12  ER-7433                 PIC  9(4) VALUE 7433.
  1091     12  ER-7450                 PIC  9(4) VALUE 7450.
  1092     12  ER-7451                 PIC  9(4) VALUE 7451.
  1093     12  ER-7530                 PIC  9(4) VALUE 7530.
  1094     12  ER-7573                 PIC  9(4) VALUE 7573.
  1095     12  ER-7631                 PIC  9(4) VALUE 7631.
  1096     12  ER-7632                 PIC  9(4) VALUE 7632.
  1097     12  ER-7633                 PIC  9(4) VALUE 7633.
  1098     12  ER-7537                 PIC  9(4) VALUE 7537.
  1099     12  ER-7538                 PIC  9(4) VALUE 7538.
  1100     12  ER-7574                 PIC  9(4) VALUE 7574.
  1101     12  ER-7997                 PIC  9(4) VALUE 7997.
  1102     12  ER-7998                 PIC  9(4) VALUE 7998.
  1103     12  ER-8148                 PIC  9(4) VALUE 8148.
  1104     12  ER-9063                 PIC  9(4) VALUE 9063.
  1105     12  ER-9076                 PIC  9(4) VALUE 9076.
  1106     12  ER-9618                 PIC  9(4) VALUE 9618.
  1107     12  ER-9841                 PIC  9(4) VALUE 9841.
  1108
  1109*                                COPY ELCTEXT.
  1110******************************************************************
  1111*                                                                *
  1112*                                                                *
  1113*                            ELCTEXT.                            *
  1114*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1115*                            VMOD=2.008                          *
  1116*                                                                *
  1117*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1118*                                     FORM LETTERS,              *
  1119*                                     CERT FORM DISPLAY.
  1120*                                                                *
  1121*   FILE TYPE = VSAM,KSDS                                        *
  1122*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1123*                                                                *
  1124*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1125*       ALTERNATE INDEX = NONE                                   *
  1126*                                                                *
  1127*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1128*       ALTERNATE INDEX = NONE                                   *
  1129*                                                                *
  1130*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1131*       ALTERNATE INDEX = NONE                                   *
  1132*                                                                *
  1133*   LOG = NO                                                     *
  1134*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1135******************************************************************
  1136 01  TEXT-FILES.
  1137     12  TEXT-FILE-ID                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  23
* EL6311.cbl
  1138         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1139         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1140         88  HELP-FILE-TEXT             VALUE 'TH'.
  1141
  1142     12  TX-CONTROL-PRIMARY.
  1143         16  TX-COMPANY-CD           PIC X.
  1144             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1145         16  TX-ACCESS-CD-GENL       PIC X(12).
  1146
  1147         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1148             20  TX-LETTER-NO        PIC X(4).
  1149             20  FILLER              PIC X(8).
  1150
  1151         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1152             20  TX-FORM-NO          PIC X(12).
  1153
  1154         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1155             20  TX-HELP-TYPE        PIC X.
  1156                 88  HELP-FOR-GENERAL   VALUE ' '.
  1157                 88  HELP-BY-SCREEN     VALUE 'S'.
  1158                 88  HELP-BY-ERROR      VALUE 'E'.
  1159             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1160                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1161             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1162                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1163             20  FILLER              PIC X(4).
  1164
  1165         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1166
  1167     12  TX-PROCESS-CONTROL          PIC XX.
  1168         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1169
  1170     12  TX-TEXT-LINE                PIC X(70).
  1171
  1172     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1173         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1174         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1175         88  TX-VALID-FORM-SQUEEZE-VALUE
  1176                                        VALUE 'Y' ' '.
  1177
  1178     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1179         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1180         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1181         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1182         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1183         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1184         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1185         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1186                                              'K' 'N' ' '
  1187                                              'Z'.
  1188
  1189     12  TX-ARCHIVE-SW               PIC X.
  1190         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1191         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1192         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1193
  1194     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1195     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  24
* EL6311.cbl
  1196
  1197     12  TX-BSR-CODE                 PIC X.
  1198         88  TX-BSR-LETTER              VALUE 'B'.
  1199         88  TX-NON-BSR-LETTER          VALUE ' '.
  1200
  1201     12  FILLER                      PIC X.
  1202*****************************************************************
  1203*                                COPY ELCCRTO.
  1204******************************************************************
  1205*                                                                *
  1206*                            ELCCRTO.                            *
  1207*                                                                *
  1208*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1209*                                                                *
  1210*   FILE TYPE = VSAM,KSDS                                        *
  1211*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1212*                                                                *
  1213*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1214*                                                                *
  1215*   LOG = YES                                                    *
  1216*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1217******************************************************************
  1218*                   C H A N G E   L O G
  1219*
  1220* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1221*-----------------------------------------------------------------
  1222*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1223* EFFECTIVE    NUMBER
  1224*-----------------------------------------------------------------
  1225* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1226* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1227* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1228* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1229* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1230******************************************************************
  1231 01  ORIGINAL-CERTIFICATE.
  1232     12  OC-RECORD-ID                      PIC XX.
  1233         88  VALID-OC-ID                      VALUE 'OC'.
  1234     12  OC-CONTROL-PRIMARY.
  1235         16  OC-COMPANY-CD                 PIC X.
  1236         16  OC-CARRIER                    PIC X.
  1237         16  OC-GROUPING                   PIC X(6).
  1238         16  OC-STATE                      PIC XX.
  1239         16  OC-ACCOUNT                    PIC X(10).
  1240         16  OC-CERT-EFF-DT                PIC XX.
  1241         16  OC-CERT-NO.
  1242             20  OC-CERT-PRIME             PIC X(10).
  1243             20  OC-CERT-SFX               PIC X.
  1244         16  OC-RECORD-TYPE                PIC X.
  1245         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1246     12  OC-LAST-MAINT-DT                  PIC XX.
  1247     12  OC-LAST-MAINT-BY                  PIC X(4).
  1248     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1249     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1250     12  FILLER                            PIC X(49).
  1251     12  OC-ORIG-REC.
  1252         16  OC-INS-LAST-NAME              PIC X(15).
  1253         16  OC-INS-FIRST-NAME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  25
* EL6311.cbl
  1254         16  OC-INS-MIDDLE-INIT            PIC X.
  1255         16  OC-INS-AGE                    PIC S999     COMP-3.
  1256         16  OC-JNT-LAST-NAME              PIC X(15).
  1257         16  OC-JNT-FIRST-NAME             PIC X(10).
  1258         16  OC-JNT-MIDDLE-INIT            PIC X.
  1259         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1260         16  OC-LF-BENCD                   PIC XX.
  1261         16  OC-LF-TERM                    PIC S999      COMP-3.
  1262         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1263         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1264         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1265         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1266         16  OC-LF-EXP-DT                  PIC XX.
  1267         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1268         16  OC-LF-CANCEL-DT               PIC XX.
  1269         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1270         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1271         16  OC-AH-BENCD                   PIC XX.
  1272         16  OC-AH-TERM                    PIC S999      COMP-3.
  1273         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1274         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1275         16  OC-AH-EXP-DT                  PIC XX.
  1276         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1277         16  OC-AH-CP                      PIC 99.
  1278         16  OC-AH-CANCEL-DT               PIC XX.
  1279         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1280         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1281         16  OC-CRED-BENE-NAME             PIC X(25).
  1282         16  OC-1ST-PMT-DT                 PIC XX.
  1283         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1284         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1285         16  OC-ISSUE-TRAN-IND             PIC X.
  1286         16  OC-CANCEL-TRAN-IND            PIC X.
  1287         16  FILLER                        PIC X(211).
  1288
  1289     12  FILLER                            PIC X(50).
  1290******************************************************************
  1291*                                COPY ERCACCT.
  1292******************************************************************
  1293*                                                                *
  1294*                                                                *
  1295*                            ERCACCT                             *
  1296*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1297*                            VMOD=2.031                          *
  1298*                                                                *
  1299*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1300*                                                                *
  1301*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1302*   VSAM ACCOUNT MASTER FILES.                                   *
  1303*                                                                *
  1304*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1305*                                                                *
  1306*   FILE TYPE = VSAM,KSDS                                        *
  1307*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1308*                                                                *
  1309*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1310*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1311*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  26
* EL6311.cbl
  1312*   LOG = NO                                                     *
  1313*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1314*                                                                *
  1315*                                                                *
  1316******************************************************************
  1317*                   C H A N G E   L O G
  1318*
  1319* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1320*-----------------------------------------------------------------
  1321*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1322* EFFECTIVE    NUMBER
  1323*-----------------------------------------------------------------
  1324* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1325* 092705    2005050300006  PEMA  ADD SPP LEASES
  1326* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1327* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1328* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1329* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1330* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1331******************************************************************
  1332
  1333 01  ACCOUNT-MASTER.
  1334     12  AM-RECORD-ID                      PIC XX.
  1335         88  VALID-AM-ID                      VALUE 'AM'.
  1336
  1337     12  AM-CONTROL-PRIMARY.
  1338         16  AM-COMPANY-CD                 PIC X.
  1339         16  AM-MSTR-CNTRL.
  1340             20  AM-CONTROL-A.
  1341                 24  AM-CARRIER            PIC X.
  1342                 24  AM-GROUPING.
  1343                     28 AM-GROUPING-PREFIX PIC XXX.
  1344                     28 AM-GROUPING-PRIME  PIC XXX.
  1345                 24  AM-STATE              PIC XX.
  1346                 24  AM-ACCOUNT.
  1347                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1348                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1349             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1350                                           PIC X(19).
  1351             20  AM-CNTRL-B.
  1352                 24  AM-EXPIRATION-DT      PIC XX.
  1353                 24  FILLER                PIC X(4).
  1354             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1355                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1356
  1357     12  AM-CONTROL-BY-VAR-GRP.
  1358         16  AM-COMPANY-CD-A1              PIC X.
  1359         16  AM-VG-CARRIER                 PIC X.
  1360         16  AM-VG-GROUPING                PIC X(6).
  1361         16  AM-VG-STATE                   PIC XX.
  1362         16  AM-VG-ACCOUNT                 PIC X(10).
  1363         16  AM-VG-DATE.
  1364             20  AM-VG-EXPIRATION-DT       PIC XX.
  1365             20  FILLER                    PIC X(4).
  1366         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1367                                           PIC 9(11)      COMP-3.
  1368     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1369         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  27
* EL6311.cbl
  1370         16  AM-VG-KEY3.
  1371             20  AM-VG3-ACCOUNT            PIC X(10).
  1372             20  AM-VG3-EXP-DT             PIC XX.
  1373         16  FILLER                        PIC X(4).
  1374     12  AM-MAINT-INFORMATION.
  1375         16  AM-LAST-MAINT-DT              PIC XX.
  1376         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1377         16  AM-LAST-MAINT-USER            PIC X(4).
  1378         16  FILLER                        PIC XX.
  1379
  1380     12  AM-EFFECTIVE-DT                   PIC XX.
  1381     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1382
  1383     12  AM-PREV-DATES  COMP-3.
  1384         16  AM-PREV-EXP-DT                PIC 9(11).
  1385         16  AM-PREV-EFF-DT                PIC 9(11).
  1386
  1387     12  AM-REPORT-CODE-1                  PIC X(10).
  1388     12  AM-REPORT-CODE-2                  PIC X(10).
  1389
  1390     12  AM-CITY-CODE                      PIC X(4).
  1391     12  AM-COUNTY-PARISH                  PIC X(6).
  1392
  1393     12  AM-NAME                           PIC X(30).
  1394     12  AM-PERSON                         PIC X(30).
  1395     12  AM-ADDRS                          PIC X(30).
  1396     12  AM-CITY.
  1397         16  AM-ADDR-CITY                  PIC X(28).
  1398         16  AM-ADDR-STATE                 PIC XX.
  1399     12  AM-ZIP.
  1400         16  AM-ZIP-PRIME.
  1401             20  AM-ZIP-PRI-1ST            PIC X.
  1402                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1403             20  FILLER                    PIC X(4).
  1404         16  AM-ZIP-PLUS4                  PIC X(4).
  1405     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1406         16  AM-CAN-POSTAL-1               PIC XXX.
  1407         16  AM-CAN-POSTAL-2               PIC XXX.
  1408         16  FILLER                        PIC XXX.
  1409     12  AM-TEL-NO.
  1410         16  AM-AREA-CODE                  PIC 999.
  1411         16  AM-TEL-PRE                    PIC 999.
  1412         16  AM-TEL-NBR                    PIC 9(4).
  1413     12  AM-TEL-LOC                        PIC X.
  1414         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1415         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1416
  1417     12  AM-COMM-STRUCTURE.
  1418         16  AM-DEFN-1.
  1419             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1420                 24  AM-AGT.
  1421                     28  AM-AGT-PREFIX     PIC X(4).
  1422                     28  AM-AGT-PRIME      PIC X(6).
  1423                 24  AM-COM-TYP            PIC X.
  1424                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1425                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1426                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1427                 24  AM-RECALC-LV-INDIC    PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  28
* EL6311.cbl
  1428                 24  AM-RETRO-LV-INDIC     PIC X.
  1429                 24  AM-GL-CODES           PIC X.
  1430                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1431                 24  FILLER                PIC X(01).
  1432         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1433             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1434                 24  FILLER                PIC X(11).
  1435                 24  AM-L-COMA             PIC XXX.
  1436                 24  AM-J-COMA             PIC XXX.
  1437                 24  AM-A-COMA             PIC XXX.
  1438                 24  FILLER                PIC X(6).
  1439
  1440     12  AM-COMM-CHANGE-STATUS             PIC X.
  1441         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1442
  1443     12  AM-CSR-CODE                       PIC X(4).
  1444
  1445     12  AM-BILLING-STATUS                 PIC X.
  1446         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1447         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1448     12  AM-AUTO-REFUND-SW                 PIC X.
  1449         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1450         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1451     12  AM-GPCD                           PIC 99.
  1452     12  AM-IG                             PIC X.
  1453         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1454         88  AM-HAS-GROUP                     VALUE '2'.
  1455     12  AM-STATUS                         PIC X.
  1456         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1457         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1458         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1459         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1460         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1461         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1462     12  AM-REMIT-TO                       PIC 99.
  1463     12  AM-ID-NO                          PIC X(11).
  1464
  1465     12  AM-CAL-TABLE                      PIC XX.
  1466     12  AM-LF-DEVIATION                   PIC XXX.
  1467     12  AM-AH-DEVIATION                   PIC XXX.
  1468     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1469     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1470     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1471     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1472     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1473     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1474
  1475     12  AM-USER-FIELDS.
  1476         16  AM-FLD-1                      PIC XX.
  1477         16  AM-FLD-2                      PIC XX.
  1478         16  AM-FLD-3                      PIC XX.
  1479         16  AM-FLD-4                      PIC XX.
  1480         16  AM-FLD-5                      PIC XX.
  1481
  1482     12  AM-1ST-PROD-DATE.
  1483         16  AM-1ST-PROD-YR                PIC XX.
  1484         16  AM-1ST-PROD-MO                PIC XX.
  1485         16  AM-1ST-PROD-DA                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  29
* EL6311.cbl
  1486     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1487     12  AM-CERTS-PURGED-DATE.
  1488         16  AM-PUR-YR                     PIC XX.
  1489         16  AM-PUR-MO                     PIC XX.
  1490         16  AM-PUR-DA                     PIC XX.
  1491     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1492     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1493     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1494     12  AM-INACTIVE-DATE.
  1495         16  AM-INA-MO                     PIC 99.
  1496         16  AM-INA-DA                     PIC 99.
  1497         16  AM-INA-YR                     PIC 99.
  1498     12  AM-AR-HI-CERT-DATE                PIC XX.
  1499
  1500     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1501     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1502
  1503     12  AM-OB-PAYMENT-MODE                PIC X.
  1504         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1505         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1506         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1507         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1508
  1509     12  AM-AH-ONLY-INDICATOR              PIC X.
  1510         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1511         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1512
  1513     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1514
  1515     12  AM-OVER-SHORT.
  1516         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1517         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1518
  1519     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1520     12  AM-DCC-CLP-STATE                  PIC XX.
  1521
  1522     12  AM-RECALC-COMM                    PIC X.
  1523     12  AM-RECALC-REIN                    PIC X.
  1524
  1525     12  AM-REI-TABLE                      PIC XXX.
  1526     12  AM-REI-ET-LF                      PIC X.
  1527     12  AM-REI-ET-AH                      PIC X.
  1528     12  AM-REI-PE-LF                      PIC X.
  1529     12  AM-REI-PE-AH                      PIC X.
  1530     12  AM-REI-PRT-ST                     PIC X.
  1531     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1532     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1533     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1534     12  AM-REI-GROUP-A                    PIC X(6).
  1535     12  AM-REI-MORT                       PIC X(4).
  1536     12  AM-REI-PRT-OW                     PIC X.
  1537     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1538     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1539     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1540     12  AM-REI-GROUP-B                    PIC X(6).
  1541
  1542     12  AM-TRUST-TYPE                     PIC X(2).
  1543
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  30
* EL6311.cbl
  1544     12  AM-EMPLOYER-STMT-USED             PIC X.
  1545     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1546
  1547     12  AM-STD-AH-TYPE                    PIC XX.
  1548     12  AM-EARN-METHODS.
  1549         16  AM-EARN-METHOD-R              PIC X.
  1550             88 AM-REF-RL-R78                 VALUE 'R'.
  1551             88 AM-REF-RL-PR                  VALUE 'P'.
  1552             88 AM-REF-RL-MEAN                VALUE 'M'.
  1553             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1554         16  AM-EARN-METHOD-L              PIC X.
  1555             88 AM-REF-LL-R78                 VALUE 'R'.
  1556             88 AM-REF-LL-PR                  VALUE 'P'.
  1557             88 AM-REF-LL-MEAN                VALUE 'M'.
  1558             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1559         16  AM-EARN-METHOD-A              PIC X.
  1560             88 AM-REF-AH-R78                 VALUE 'R'.
  1561             88 AM-REF-AH-PR                  VALUE 'P'.
  1562             88 AM-REF-AH-MEAN                VALUE 'M'.
  1563             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1564             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1565             88 AM-REF-AH-NET                 VALUE 'N'.
  1566
  1567     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1568     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1569     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1570
  1571     12  AM-RET-Y-N                        PIC X.
  1572     12  AM-RET-P-E                        PIC X.
  1573     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1574     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1575     12  AM-RET-GRP                        PIC X(6).
  1576     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1577         16  AM-POOL-PRIME                 PIC XXX.
  1578         16  AM-POOL-SUB                   PIC XXX.
  1579     12  AM-RETRO-EARNINGS.
  1580         16  AM-RET-EARN-R                 PIC X.
  1581         16  AM-RET-EARN-L                 PIC X.
  1582         16  AM-RET-EARN-A                 PIC X.
  1583     12  AM-RET-ST-TAX-USE                 PIC X.
  1584         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1585         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1586     12  AM-RETRO-BEG-EARNINGS.
  1587         16  AM-RET-BEG-EARN-R             PIC X.
  1588         16  AM-RET-BEG-EARN-L             PIC X.
  1589         16  AM-RET-BEG-EARN-A             PIC X.
  1590     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1591     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1592
  1593     12  AM-USER-SELECT-OPTIONS.
  1594         16  AM-USER-SELECT-1              PIC X(10).
  1595         16  AM-USER-SELECT-2              PIC X(10).
  1596         16  AM-USER-SELECT-3              PIC X(10).
  1597         16  AM-USER-SELECT-4              PIC X(10).
  1598         16  AM-USER-SELECT-5              PIC X(10).
  1599
  1600     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1601
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  31
* EL6311.cbl
  1602     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1603
  1604     12  AM-RPT045A-SWITCH                 PIC X.
  1605         88  RPT045A-OFF                   VALUE 'N'.
  1606
  1607     12  AM-INSURANCE-LIMITS.
  1608         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1609         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1610
  1611     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1612         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1613
  1614     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1615         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1616         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1617
  1618     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1619
  1620     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1621     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1622     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1623     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1624     12  AM-DCC-UEF-STATE                  PIC XX.
  1625     12  FILLER                            PIC XXX.
  1626     12  AM-REPORT-CODE-3                  PIC X(10).
  1627*    12  FILLER                            PIC X(22).
  1628
  1629     12  AM-RESERVE-DATE.
  1630         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1631         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1632         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1633
  1634     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1635     12  AM-NOTIFICATION-TYPES.
  1636         16  AM-NOTIF-OF-LETTERS           PIC X.
  1637         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1638         16  AM-NOTIF-OF-REPORTS           PIC X.
  1639         16  AM-NOTIF-OF-STATUS            PIC X.
  1640
  1641     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1642         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1643         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1644         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1645         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1646
  1647     12  AM-BENEFIT-CONTROLS.
  1648         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1649             20  AM-BENEFIT-CODE           PIC XX.
  1650             20  AM-BENEFIT-TYPE           PIC X.
  1651             20  AM-BENEFIT-REVISION       PIC XXX.
  1652             20  AM-BENEFIT-REM-TERM       PIC X.
  1653             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1654             20  FILLER                    PIC XX.
  1655         16  FILLER                        PIC X(80).
  1656
  1657     12  AM-TRANSFER-DATA.
  1658         16  AM-TRANSFERRED-FROM.
  1659             20  AM-TRNFROM-CARRIER        PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  32
* EL6311.cbl
  1660             20  AM-TRNFROM-GROUPING.
  1661                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1662                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1663             20  AM-TRNFROM-STATE          PIC XX.
  1664             20  AM-TRNFROM-ACCOUNT.
  1665                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1666                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1667             20  AM-TRNFROM-DTE            PIC XX.
  1668         16  AM-TRANSFERRED-TO.
  1669             20  AM-TRNTO-CARRIER          PIC X.
  1670             20  AM-TRNTO-GROUPING.
  1671                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1672                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1673             20  AM-TRNTO-STATE            PIC XX.
  1674             20  AM-TRNTO-ACCOUNT.
  1675                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1676                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1677             20  AM-TRNTO-DTE              PIC XX.
  1678         16  FILLER                        PIC X(10).
  1679
  1680     12  AM-SAVED-REMIT-TO                 PIC 99.
  1681
  1682     12  AM-COMM-STRUCTURE-SAVED.
  1683         16  AM-DEFN-1-SAVED.
  1684             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1685                 24  AM-AGT-SV             PIC X(10).
  1686                 24  AM-COM-TYP-SV         PIC X.
  1687                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1688                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1689                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1690                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1691                 24  FILLER                PIC X.
  1692                 24  AM-GL-CODES-SV        PIC X.
  1693                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1694                 24  FILLER                PIC X.
  1695         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1696             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1697                 24  FILLER                PIC X(11).
  1698                 24  AM-L-COMA-SV          PIC XXX.
  1699                 24  AM-J-COMA-SV          PIC XXX.
  1700                 24  AM-A-COMA-SV          PIC XXX.
  1701                 24  FILLER                PIC X(6).
  1702
  1703     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1704         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1705            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1706            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1707            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1708
  1709     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1710     12  FILLER                            PIC X(120).
  1711
  1712     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1713         16  AM-CONTROL-NAME               PIC X(30).
  1714         16  AM-EXECUTIVE-ONE.
  1715             20  AM-EXEC1-NAME             PIC X(15).
  1716             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1717                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  33
* EL6311.cbl
  1718             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1719                                                          COMP-3.
  1720         16  AM-EXECUTIVE-TWO.
  1721             20  AM-EXEC2-NAME             PIC X(15).
  1722             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1723                                                          COMP-3.
  1724             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1725                                                          COMP-3.
  1726
  1727     12  AM-RETRO-ADDITIONAL-DATA.
  1728         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1729         16  AM-RETRO-PREM-P-E             PIC X.
  1730         16  AM-RETRO-CLMS-P-I             PIC X.
  1731         16  AM-RETRO-RET-BRACKET-LF.
  1732             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1733                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1734                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1735             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1736                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1737                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1738             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1739                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1740                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1741         16  AM-RETRO-RET-BRACKET-AH.
  1742             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1743                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1744                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1745                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1746             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1747                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1748                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1749             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1750                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1751                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1752
  1753     12  AM-COMMENTS.
  1754         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1755
  1756     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1757         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1758         16  AM-FLI-BILLING-CODE           PIC X.
  1759         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1760         16  AM-FLI-UNITED-IDENT           PIC X.
  1761         16  AM-FLI-INTEREST-LOST-DATA.
  1762             20  AM-FLI-BANK-NO            PIC X(5).
  1763             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1764             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1765             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1766         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1767             20  AM-FLI-AGT                PIC X(9).
  1768             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1769             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1770         16  FILLER                        PIC X(102).
  1771
  1772     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1773         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1774             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1775             20  AM-BENEFIT-DMD-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  34
* EL6311.cbl
  1776             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1777             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1778             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1779         16  FILLER                          PIC X(10).
  1780******************************************************************
  1781*                                COPY ELCVADS.
  1782******************************************************************
  1783*                                                                *
  1784*                                                                *
  1785*                            ELCVADS.                            *
  1786*                                                                *
  1787*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1788*   ELVADS                  LENGTH = 350                         *
  1789******************************************************************
  1790******************************************************************
  1791*                   C H A N G E   L O G
  1792*
  1793* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1794*-----------------------------------------------------------------
  1795*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1796* EFFECTIVE    NUMBER
  1797*-----------------------------------------------------------------
  1798* 100111    2011022800001  AJRA  NAPERSOFT
  1799******************************************************************
  1800
  1801 01  VIRGINIA-DISCLOSURE.
  1802     12  VD-COMPANY-CD              PIC X.
  1803     12  VD-CARRIER                 PIC X.
  1804     12  VD-GROUPING.
  1805         20  VD-GROUPING-PREFIX     PIC XXX.
  1806         20  VD-GROUPING-PRIME      PIC XXX.
  1807     12  VD-STATE                   PIC XX.
  1808     12  VD-ACCOUNT.
  1809         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1810         20  VD-ACCOUNT-PRIME       PIC X(6).
  1811     12  VD-CERT-EFF-DT             PIC XX.
  1812     12  VD-CERT-NO.
  1813         20  VD-CERT-PRIME          PIC X(10).
  1814         20  VD-CERT-SFX            PIC X.
  1815     12  VD-ENTRY-BATCH             PIC X(6).
  1816     12  VD-CSR-ID                  PIC X(4).
  1817     12  VD-NAME.
  1818         20  VD-INSURED-LAST-NAME   PIC X(15).
  1819         20  VD-INSURED-FIRST-NAME.
  1820             24  VD-INSURED-1ST-INIT PIC X.
  1821             24  FILLER             PIC X(9).
  1822         20  VD-INSURED-MIDDLE-INIT PIC X.
  1823     12  VD-JOINT-INSURED.
  1824         20 VD-JOINT-LAST-NAME      PIC X(15).
  1825         20 VD-JOINT-FIRST-NAME.
  1826            24  VD-JOINT-FIRST-INIT PIC X.
  1827            24  FILLER              PIC X(9).
  1828         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1829     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1830     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1831     12  VD-INSURED-CITY-STATE.
  1832         20  VD-INSURED-CITY        PIC X(28).
  1833         20  VD-INSURED-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  35
* EL6311.cbl
  1834     12  VD-INSURED-ZIP-CODE.
  1835         20  VD-INSURED-ZIP-PRIME.
  1836             24  VD-INSURED-ZIP-1   PIC X.
  1837                 88  VD-CANADIAN-POST-CODE
  1838                                       VALUE 'A' THRU 'Z'.
  1839             24  FILLER             PIC X(4).
  1840         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1841     12  VD-BENEFICIARY-NAME        PIC X(30).
  1842     12  VD-ACCOUNT-NAME            PIC X(30).
  1843     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1844     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1845     12  VD-1ST-PMT-DT              PIC XX.
  1846     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1847         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1848         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1849                                             '90' THRU '99'.
  1850     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1851                                    PIC XX.
  1852     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1853     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1854     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1855     12  VD-LF-TERM                 PIC S999   COMP-3.
  1856     12  VD-AH-BENEFIT-CD           PIC XX.
  1857         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1858         88  VD-INVALID-AH             VALUE '  ' '00'
  1859                                             '90' THRU '99'.
  1860     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1861     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1862     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1863     12  VD-AH-TERM                 PIC S999   COMP-3.
  1864     12  VD-LETTER-ID               PIC X(4).
  1865     12  VD-PROC-ID                 PIC X(4).
  1866     12  VD-COMP-ID                 PIC X(3).
  1867     12  VD-CURRENT-DATE            PIC XX.
  1868     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1869     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1870     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  36
* EL6311.cbl
  1872*    COPY ELCDATE.
  1873******************************************************************
  1874*                                                                *
  1875*                                                                *
  1876*                            ELCDATE.                            *
  1877*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1878*                            VMOD=2.003
  1879*                                                                *
  1880*                                                                *
  1881*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1882*                 LENGTH = 200                                   *
  1883******************************************************************
  1884
  1885 01  DATE-CONVERSION-DATA.
  1886     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1887     12  DC-OPTION-CODE                PIC X.
  1888         88  BIN-TO-GREG                VALUE ' '.
  1889         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1890         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1891         88  YMD-GREG-TO-BIN            VALUE '3'.
  1892         88  MDY-GREG-TO-BIN            VALUE '4'.
  1893         88  JULIAN-TO-BIN              VALUE '5'.
  1894         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1895         88  FIND-CENTURY               VALUE '7'.
  1896         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1897         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1898         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1899         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1900         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1901         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1902         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1903         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1904         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1905         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1906         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1907         88  BIN-3-TO-GREG              VALUE 'I'.
  1908         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1909         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1910         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1911         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1912         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1913         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1914         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1915         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1916         88  THREE-CHARACTER-BIN
  1917                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1918         88  GREGORIAN-TO-BIN
  1919                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1920         88  BIN-TO-GREGORIAN
  1921                  VALUES ' ' '1' 'I' '8' 'G'.
  1922         88  JULIAN-TO-BINARY
  1923                  VALUES '5' 'C' 'E' 'F'.
  1924     12  DC-ERROR-CODE                 PIC X.
  1925         88  NO-CONVERSION-ERROR        VALUE ' '.
  1926         88  DATE-CONVERSION-ERROR
  1927                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1928         88  DATE-IS-ZERO               VALUE '1'.
  1929         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  37
* EL6311.cbl
  1930         88  DATE-IS-INVALID            VALUE '3'.
  1931         88  DATE1-GREATER-DATE2        VALUE '4'.
  1932         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1933         88  DATE-INVALID-OPTION        VALUE '9'.
  1934         88  INVALID-CENTURY            VALUE 'A'.
  1935         88  ONLY-CENTURY               VALUE 'B'.
  1936         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1937         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1938     12  DC-END-OF-MONTH               PIC X.
  1939         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1940     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1941         88  USE-NORMAL-PROCESS         VALUE ' '.
  1942         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1943         88  ADJUST-UP-100-YRS          VALUE '2'.
  1944     12  FILLER                        PIC X.
  1945     12  DC-CONVERSION-DATES.
  1946         16  DC-BIN-DATE-1             PIC XX.
  1947         16  DC-BIN-DATE-2             PIC XX.
  1948         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1949         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1950                       DC-GREG-DATE-1-EDIT.
  1951             20  DC-EDIT1-MONTH        PIC 99.
  1952             20  SLASH1-1              PIC X.
  1953             20  DC-EDIT1-DAY          PIC 99.
  1954             20  SLASH1-2              PIC X.
  1955             20  DC-EDIT1-YEAR         PIC 99.
  1956         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1957         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1958                     DC-GREG-DATE-2-EDIT.
  1959             20  DC-EDIT2-MONTH        PIC 99.
  1960             20  SLASH2-1              PIC X.
  1961             20  DC-EDIT2-DAY          PIC 99.
  1962             20  SLASH2-2              PIC X.
  1963             20  DC-EDIT2-YEAR         PIC 99.
  1964         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1965         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1966                     DC-GREG-DATE-1-YMD.
  1967             20  DC-YMD-YEAR           PIC 99.
  1968             20  DC-YMD-MONTH          PIC 99.
  1969             20  DC-YMD-DAY            PIC 99.
  1970         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1971         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1972                      DC-GREG-DATE-1-MDY.
  1973             20  DC-MDY-MONTH          PIC 99.
  1974             20  DC-MDY-DAY            PIC 99.
  1975             20  DC-MDY-YEAR           PIC 99.
  1976         16  DC-GREG-DATE-1-ALPHA.
  1977             20  DC-ALPHA-MONTH        PIC X(10).
  1978             20  DC-ALPHA-DAY          PIC 99.
  1979             20  FILLER                PIC XX.
  1980             20  DC-ALPHA-CENTURY.
  1981                 24 DC-ALPHA-CEN-N     PIC 99.
  1982             20  DC-ALPHA-YEAR         PIC 99.
  1983         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1984         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1985         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1986         16  DC-JULIAN-DATE            PIC 9(05).
  1987         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  38
* EL6311.cbl
  1988                                       PIC 9(05).
  1989         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1990             20  DC-JULIAN-YEAR        PIC 99.
  1991             20  DC-JULIAN-DAYS        PIC 999.
  1992         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1993         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1994         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1995     12  DATE-CONVERSION-VARIBLES.
  1996         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1997         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1998             20  FILLER                PIC 9(3).
  1999             20  HOLD-CEN-1-CCYY.
  2000                 24  HOLD-CEN-1-CC     PIC 99.
  2001                 24  HOLD-CEN-1-YY     PIC 99.
  2002             20  HOLD-CEN-1-MO         PIC 99.
  2003             20  HOLD-CEN-1-DA         PIC 99.
  2004         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2005             20  HOLD-CEN-1-R-MO       PIC 99.
  2006             20  HOLD-CEN-1-R-DA       PIC 99.
  2007             20  HOLD-CEN-1-R-CCYY.
  2008                 24  HOLD-CEN-1-R-CC   PIC 99.
  2009                 24  HOLD-CEN-1-R-YY   PIC 99.
  2010             20  FILLER                PIC 9(3).
  2011         16  HOLD-CENTURY-1-X.
  2012             20  FILLER                PIC X(3)  VALUE SPACES.
  2013             20  HOLD-CEN-1-X-CCYY.
  2014                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2015                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2016             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2017             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2018         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2019             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2020             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2021             20  HOLD-CEN-1-R-X-CCYY.
  2022                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2023                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2024             20  FILLER                PIC XXX.
  2025         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2026         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2027         16  DC-JULIAN-DATE-1          PIC 9(07).
  2028         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2029             20  DC-JULIAN-1-CCYY.
  2030                 24  DC-JULIAN-1-CC    PIC 99.
  2031                 24  DC-JULIAN-1-YR    PIC 99.
  2032             20  DC-JULIAN-DA-1        PIC 999.
  2033         16  DC-JULIAN-DATE-2          PIC 9(07).
  2034         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2035             20  DC-JULIAN-2-CCYY.
  2036                 24  DC-JULIAN-2-CC    PIC 99.
  2037                 24  DC-JULIAN-2-YR    PIC 99.
  2038             20  DC-JULIAN-DA-2        PIC 999.
  2039         16  DC-GREG-DATE-A-EDIT.
  2040             20  DC-EDITA-MONTH        PIC 99.
  2041             20  SLASHA-1              PIC X VALUE '/'.
  2042             20  DC-EDITA-DAY          PIC 99.
  2043             20  SLASHA-2              PIC X VALUE '/'.
  2044             20  DC-EDITA-CCYY.
  2045                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  39
* EL6311.cbl
  2046                 24  DC-EDITA-YEAR     PIC 99.
  2047         16  DC-GREG-DATE-B-EDIT.
  2048             20  DC-EDITB-MONTH        PIC 99.
  2049             20  SLASHB-1              PIC X VALUE '/'.
  2050             20  DC-EDITB-DAY          PIC 99.
  2051             20  SLASHB-2              PIC X VALUE '/'.
  2052             20  DC-EDITB-CCYY.
  2053                 24  DC-EDITB-CENT     PIC 99.
  2054                 24  DC-EDITB-YEAR     PIC 99.
  2055         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2056         16  DC-GREG-DATE-CYMD-R REDEFINES
  2057                              DC-GREG-DATE-CYMD.
  2058             20  DC-CYMD-CEN           PIC 99.
  2059             20  DC-CYMD-YEAR          PIC 99.
  2060             20  DC-CYMD-MONTH         PIC 99.
  2061             20  DC-CYMD-DAY           PIC 99.
  2062         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2063         16  DC-GREG-DATE-MDCY-R REDEFINES
  2064                              DC-GREG-DATE-MDCY.
  2065             20  DC-MDCY-MONTH         PIC 99.
  2066             20  DC-MDCY-DAY           PIC 99.
  2067             20  DC-MDCY-CEN           PIC 99.
  2068             20  DC-MDCY-YEAR          PIC 99.
  2069    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2070        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2071    12  DC-EL310-DATE                  PIC X(21).
  2072    12  FILLER                         PIC X(28).
  2073
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  40
* EL6311.cbl
  2075*    COPY ELCLOGOF.
  2076******************************************************************
  2077*                                                                *
  2078*                                                                *
  2079*                            ELCLOGOF.                           *
  2080*                            VMOD=2.001                          *
  2081*                                                                *
  2082*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2083*                                                                *
  2084******************************************************************
  2085 01  CLASIC-LOGOFF.
  2086     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2087     12  LOGOFF-TEXT.
  2088         16  FILLER          PIC X(5)    VALUE SPACES.
  2089         16  LOGOFF-MSG.
  2090             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2091             20  FILLER      PIC X       VALUE SPACES.
  2092             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2093         16  FILLER          PIC X(80)
  2094           VALUE '* YOU ARE NOW LOGGED OFF'.
  2095         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2096         16  FILLER          PIC X       VALUE QUOTE.
  2097         16  LOGOFF-SYS-MSG  PIC X(17)
  2098           VALUE 'S CLAS-IC SYSTEM '.
  2099     12  TEXT-MESSAGES.
  2100         16  UNACCESS-MSG    PIC X(29)
  2101             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2102         16  PGMIDERR-MSG    PIC X(17)
  2103             VALUE 'PROGRAM NOT FOUND'.
  2104
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  41
* EL6311.cbl
  2106*    COPY ELCATTR.
  2107******************************************************************
  2108*                                                                *
  2109*                            ELCATTR.                            *
  2110*                            VMOD=2.001                          *
  2111*                                                                *
  2112*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2113*                                                                *
  2114*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2115*                                                                *
  2116*                   POS 1   P=PROTECTED                          *
  2117*                           U=UNPROTECTED                        *
  2118*                           S=ASKIP                              *
  2119*                   POS 2   A=ALPHA/NUMERIC                      *
  2120*                           N=NUMERIC                            *
  2121*                   POS 3   N=NORMAL                             *
  2122*                           B=BRIGHT                             *
  2123*                           D=DARK                               *
  2124*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2125*                           OF=MODIFIED DATA TAG OFF             *
  2126*                                                                *
  2127*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2128******************************************************************
  2129 01  ATTRIBUTE-LIST.
  2130     12  AL-PABOF            PIC X       VALUE 'Y'.
  2131     12  AL-PABON            PIC X       VALUE 'Z'.
  2132     12  AL-PADOF            PIC X       VALUE '%'.
  2133     12  AL-PADON            PIC X       VALUE '_'.
  2134     12  AL-PANOF            PIC X       VALUE '-'.
  2135     12  AL-PANON            PIC X       VALUE '/'.
  2136     12  AL-SABOF            PIC X       VALUE '8'.
  2137     12  AL-SABON            PIC X       VALUE '9'.
  2138     12  AL-SADOF            PIC X       VALUE '@'.
  2139     12  AL-SADON            PIC X       VALUE QUOTE.
  2140     12  AL-SANOF            PIC X       VALUE '0'.
  2141     12  AL-SANON            PIC X       VALUE '1'.
  2142     12  AL-UABOF            PIC X       VALUE 'H'.
  2143     12  AL-UABON            PIC X       VALUE 'I'.
  2144     12  AL-UADOF            PIC X       VALUE '<'.
  2145     12  AL-UADON            PIC X       VALUE '('.
  2146     12  AL-UANOF            PIC X       VALUE ' '.
  2147     12  AL-UANON            PIC X       VALUE 'A'.
  2148     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2149     12  AL-UNBON            PIC X       VALUE 'R'.
  2150     12  AL-UNDOF            PIC X       VALUE '*'.
  2151     12  AL-UNDON            PIC X       VALUE ')'.
  2152     12  AL-UNNOF            PIC X       VALUE '&'.
  2153     12  AL-UNNON            PIC X       VALUE 'J'.
  2154
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  42
* EL6311.cbl
  2156*    COPY ELCEMIB.
  2157******************************************************************
  2158*                                                                *
  2159*                                                                *
  2160*                            ELCEMIB.                            *
  2161*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2162*                            VMOD=2.005                          *
  2163*                                                                *
  2164*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2165*                                                                *
  2166******************************************************************
  2167 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2168     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2169     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2170     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2171     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2172     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2173     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2174     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2175     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2176     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2177         88  EMI-NO-ERRORS                    VALUE '1'.
  2178         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2179         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2180     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2181         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2182     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2183         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2184         88  EMI-AREA1-FULL                   VALUE '2'.
  2185     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2186         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2187         88  EMI-AREA2-FULL                   VALUE '2'.
  2188     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2189         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2190         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2191         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2192         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2193         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2194     12  EMI-ERROR-LINES.
  2195         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2196         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2197         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2198         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2199             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2200                 24  EMI-ERR-NUM         PIC X(4).
  2201                 24  EMI-FILLER          PIC X.
  2202                 24  EMI-SEV             PIC X.
  2203                 24  FILLER              PIC X.
  2204             20  FILLER                  PIC X(02).
  2205     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2206         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2207             20  EMI-ERROR-NUMBER    PIC X(4).
  2208             20  EMI-FILL            PIC X.
  2209             20  EMI-SEVERITY        PIC X.
  2210             20  FILLER              PIC X.
  2211             20  EMI-ERROR-TEXT.
  2212                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2213                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  43
* EL6311.cbl
  2214     12  EMI-SEVERITY-SAVE           PIC X.
  2215         88  EMI-NOTE                    VALUE 'N'.
  2216         88  EMI-WARNING                 VALUE 'W'.
  2217         88  EMI-FORCABLE                VALUE 'F'.
  2218         88  EMI-FATAL                   VALUE 'X'.
  2219     12  EMI-MESSAGE-FLAG            PIC X.
  2220         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2221         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2222     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2223     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2224         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2225         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2226         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2227     12  emi-claim-no                pic x(7).
  2228     12  emi-claim-type              pic x(6).
  2229     12  FILLER                      PIC X(124)  VALUE SPACES.
  2230     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2231     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2232     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2233     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2234
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  44
* EL6311.cbl
  2236*    COPY ELCINTF.
  2237******************************************************************
  2238*                                                                *
  2239*                                                                *
  2240*                            ELCINTF.                            *
  2241*                            VMOD=2.017                          *
  2242*                                                                *
  2243*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2244*                                                                *
  2245*       LENGTH = 1024                                            *
  2246*                                                                *
  2247******************************************************************
  2248*                   C H A N G E   L O G
  2249*
  2250* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2251*-----------------------------------------------------------------
  2252*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2253* EFFECTIVE    NUMBER
  2254*-----------------------------------------------------------------
  2255* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2256******************************************************************
  2257 01  PROGRAM-INTERFACE-BLOCK.
  2258     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2259     12  PI-CALLING-PROGRAM              PIC X(8).
  2260     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2261     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2262     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2263     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2264     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2265     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2266     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2267     12  PI-COMPANY-ID                   PIC XXX.
  2268     12  PI-COMPANY-CD                   PIC X.
  2269
  2270     12  PI-COMPANY-PASSWORD             PIC X(8).
  2271
  2272     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2273
  2274     12  PI-CONTROL-IN-PROGRESS.
  2275         16  PI-CARRIER                  PIC X.
  2276         16  PI-GROUPING                 PIC X(6).
  2277         16  PI-STATE                    PIC XX.
  2278         16  PI-ACCOUNT                  PIC X(10).
  2279         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2280                                         PIC X(10).
  2281         16  PI-CLAIM-CERT-GRP.
  2282             20  PI-CLAIM-NO             PIC X(7).
  2283             20  PI-CERT-NO.
  2284                 25  PI-CERT-PRIME       PIC X(10).
  2285                 25  PI-CERT-SFX         PIC X.
  2286             20  PI-CERT-EFF-DT          PIC XX.
  2287         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2288             20  PI-PLAN-CODE            PIC X(2).
  2289             20  PI-REVISION-NUMBER      PIC X(3).
  2290             20  PI-PLAN-EFF-DT          PIC X(2).
  2291             20  PI-PLAN-EXP-DT          PIC X(2).
  2292             20  FILLER                  PIC X(11).
  2293         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  45
* EL6311.cbl
  2294             20  PI-OE-REFERENCE-1.
  2295                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2296                 25  PI-OE-REF-1-SUFF    PIC XX.
  2297
  2298     12  PI-SESSION-IN-PROGRESS          PIC X.
  2299         88  CLAIM-SESSION                   VALUE '1'.
  2300         88  CREDIT-SESSION                  VALUE '2'.
  2301         88  WARRANTY-SESSION                VALUE '3'.
  2302         88  MORTGAGE-SESSION                VALUE '4'.
  2303         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2304
  2305
  2306*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2307
  2308     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2309     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2310
  2311     12  PI-CREDIT-USER                  PIC X.
  2312         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2313         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2314
  2315     12  PI-CLAIM-USER                   PIC X.
  2316         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2317         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2318
  2319     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2320         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2321         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2322         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2323         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2324         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2325
  2326     12  PI-PROCESSOR-ID                 PIC X(4).
  2327
  2328     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2329
  2330     12  PI-MEMBER-CAPTION               PIC X(10).
  2331
  2332     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2333         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2334
  2335     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2336     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2337     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2338     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2339
  2340     12  PI-AH-OVERRIDE-L1               PIC X.
  2341     12  PI-AH-OVERRIDE-L2               PIC XX.
  2342     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2343     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2344
  2345     12  PI-NEW-SYSTEM                   PIC X(2).
  2346
  2347     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2348     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2349         88  PI-USES-PAID-TO                 VALUE '1'.
  2350     12  PI-CRDTCRD-SYSTEM.
  2351         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  46
* EL6311.cbl
  2352             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2353             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2354         16  PI-CC-MONTH-END-DT          PIC XX.
  2355     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2356
  2357     12  PI-OE-REFERENCE-2.
  2358         16  PI-OE-REF-2-PRIME           PIC X(10).
  2359         16  PI-OE-REF-2-SUFF            PIC X.
  2360
  2361     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2362
  2363     12  PI-LANGUAGE-TYPE                PIC X.
  2364             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2365             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2366             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2367
  2368     12  PI-POLICY-LINKAGE-IND           PIC X.
  2369         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2370         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2371                                                   LOW-VALUES.
  2372
  2373     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2374     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2375         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2376         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2377
  2378     12  PI-PROCESSOR-CSR-IND            PIC X.
  2379         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2380         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2381
  2382     12  FILLER                          PIC X(3).
  2383
  2384     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2385
  2386     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2387         PI-SYSTEM-LEVEL.
  2388
  2389         16  PI-ENTRY-CODES.
  2390             20  PI-ENTRY-CD-1           PIC X.
  2391             20  PI-ENTRY-CD-2           PIC X.
  2392
  2393         16  PI-RETURN-CODES.
  2394             20  PI-RETURN-CD-1          PIC X.
  2395             20  PI-RETURN-CD-2          PIC X.
  2396
  2397         16  PI-UPDATE-STATUS-SAVE.
  2398             20  PI-UPDATE-BY            PIC X(4).
  2399             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2400
  2401         16  PI-LOWER-CASE-LETTERS       PIC X.
  2402             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2403
  2404*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2405*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2406*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2407
  2408         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2409             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  47
* EL6311.cbl
  2410             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2411             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2412             88  ACCNT-CNTL                  VALUE '3'.
  2413             88  CARR-ACCNT-CNTL             VALUE '4'.
  2414
  2415         16  PI-PROCESSOR-CAP-LIST.
  2416             20  PI-SYSTEM-CONTROLS.
  2417                24 PI-SYSTEM-DISPLAY     PIC X.
  2418                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2419                24 PI-SYSTEM-MODIFY      PIC X.
  2420                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2421             20  FILLER                  PIC XX.
  2422             20  PI-DISPLAY-CAP          PIC X.
  2423                 88  DISPLAY-CAP             VALUE 'Y'.
  2424             20  PI-MODIFY-CAP           PIC X.
  2425                 88  MODIFY-CAP              VALUE 'Y'.
  2426             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2427                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2428             20  PI-FORCE-CAP            PIC X.
  2429                 88  FORCE-CAP               VALUE 'Y'.
  2430
  2431         16  PI-PROGRAM-CONTROLS.
  2432             20  PI-PGM-PRINT-OPT        PIC X.
  2433             20  PI-PGM-FORMAT-OPT       PIC X.
  2434             20  PI-PGM-PROCESS-OPT      PIC X.
  2435             20  PI-PGM-TOTALS-OPT       PIC X.
  2436
  2437         16  PI-HELP-INTERFACE.
  2438             20  PI-LAST-ERROR-NO        PIC X(4).
  2439             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2440
  2441         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2442             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2443
  2444         16  PI-CR-CONTROL-IN-PROGRESS.
  2445             20  PI-CR-CARRIER           PIC X.
  2446             20  PI-CR-GROUPING          PIC X(6).
  2447             20  PI-CR-STATE             PIC XX.
  2448             20  PI-CR-ACCOUNT           PIC X(10).
  2449             20  PI-CR-FIN-RESP          PIC X(10).
  2450             20  PI-CR-TYPE              PIC X.
  2451
  2452         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2453
  2454         16  PI-CR-MONTH-END-DT          PIC XX.
  2455
  2456         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2457             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2458             88  PI-ZERO-CARRIER             VALUE '1'.
  2459             88  PI-ZERO-GROUPING            VALUE '2'.
  2460             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2461
  2462         16  PI-CARRIER-SECURITY         PIC X.
  2463             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2464
  2465         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2466             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2467             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  48
* EL6311.cbl
  2468
  2469         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2470             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2471                                         INDEXED BY PI-ACCESS-NDX
  2472                                         PIC X.
  2473
  2474         16  PI-GA-BILLING-CONTROL       PIC X.
  2475             88  PI-GA-BILLING               VALUE '1'.
  2476
  2477         16  PI-MAIL-PROCESSING          PIC X.
  2478             88  PI-MAIL-YES                 VALUE 'Y'.
  2479
  2480         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2481
  2482         16  PI-AR-SYSTEM.
  2483             20  PI-AR-PROCESSING-CNTL   PIC X.
  2484                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2485             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2486             20  PI-AR-MONTH-END-DT      PIC XX.
  2487
  2488         16  PI-MP-SYSTEM.
  2489             20  PI-MORTGAGE-USER            PIC X.
  2490                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2491                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2492             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2493                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2494                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2495                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2496                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2497                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2498             20  PI-MP-MONTH-END-DT          PIC XX.
  2499             20  PI-MP-REFERENCE-NO.
  2500                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2501                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2502
  2503         16  PI-LABEL-CONTROL            PIC X(01).
  2504             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2505             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2506
  2507         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2508             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2509
  2510         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2511             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2512             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2513
  2514         16  FILLER                      PIC X(14).
  2515
  2516     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2517******************************************************************
  2518
  2519     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2520*    COPY ELC631PI.
  2521******************************************************************
  2522*                                                                *
  2523*                                                                *
  2524*                            ELC631PI                            *
  2525*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  49
* EL6311.cbl
  2526*                                                                *
  2527*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2528*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2529*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2530*                                                                *
  2531*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2532*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2533*    BETWEEN PROGRAMS.                                           *
  2534*                                                                *
  2535*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2536*                                                                *
  2537*               EL631 - EL6311 - EL6312 - EL6313                 *
  2538*                                                                *
  2539******************************************************************
  2540*                   C H A N G E   L O G
  2541*
  2542* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2543*-----------------------------------------------------------------
  2544*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2545* EFFECTIVE    NUMBER
  2546*-----------------------------------------------------------------
  2547* 021414    2003053000001  PEMA  changes for auto chk request
  2548******************************************************************
  2549
  2550         16  PI-631-DATA.
  2551             20  PI-ERPNDB-KEY.
  2552                 24  PI-PB-COMPANY-CD     PIC X.
  2553                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2554                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2555                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2556
  2557             20  PI-ERPNDB-ALT-KEY.
  2558                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2559                 24  PI-PB-CARRIER        PIC X.
  2560                 24  PI-PB-GROUPING       PIC X(6).
  2561                 24  PI-PB-STATE          PIC XX.
  2562                 24  PI-PB-ACCOUNT        PIC X(10).
  2563                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2564                 24  PI-PB-CERT-NO.
  2565                     28  PI-PB-CERT-PRIME PIC X(10).
  2566                     28  PI-PB-CERT-SFX   PIC X.
  2567                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2568                 24  PI-PB-RECORD-TYPE    PIC X.
  2569
  2570             20  PI-ERPNDB-CSR-KEY.
  2571                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2572                 24  PI-PB-CSR-ID             PIC X(4).
  2573                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2574                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2575                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2576
  2577             20  PI-BROWSE-TYPE               PIC X.
  2578                 88  PI-FILE-BROWSE             VALUE ' '.
  2579                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2580                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2581                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2582                 88  PI-CSR-BROWSE              VALUE '4'.
  2583
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  50
* EL6311.cbl
  2584             20  PI-MAINT-FUNCTION            PIC X.
  2585                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2586                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2587                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2588                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2589                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2590                 88  PI-PF5-FUNCTION            VALUE '5'.
  2591                 88  PI-PF6-FUNCTION            VALUE '6'.
  2592
  2593             20  PI-FILE-SWITCHES.
  2594                 24  PI-ALL-ISSUES-SW         PIC X.
  2595                     88  ALL-ISSUES             VALUE 'Y'.
  2596                 24  PI-ALL-CANCELS-SW        PIC X.
  2597                     88  ALL-CANCELS            VALUE 'Y'.
  2598                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2599                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2600                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2601                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2602                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2603                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2604                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2605                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2606                 24  PI-HOLD-REC-SW           PIC X.
  2607                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2608                 24  PI-CHANGE-REC-SW         PIC X.
  2609                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2610                 24  PI-CHK-REQ-REC-SW        PIC X.
  2611                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2612                 24  PI-ISSUE-WARNING-SW      PIC X.
  2613                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2614                 24  PI-CANCEL-WARNING-SW     PIC X.
  2615                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2616             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2617                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2618             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2619                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2620
  2621             20  PI-MAP-NAME                  PIC X(8).
  2622
  2623             20  PI-CURSOR                    PIC S9(4) COMP.
  2624
  2625             20  PI-PREV-ALT-KEY              PIC X(36).
  2626             20  PI-PREV-CSR-KEY              PIC X(15).
  2627             20  PI-PREV-KEY.
  2628                 24  PI-PREV-COMPANY-CD       PIC X.
  2629                 24  PI-PREV-BATCH            PIC X(6).
  2630                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2631                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2632             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2633             20  PI-BROWSE-SW                 PIC X.
  2634                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2635                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2636             20  PI-SV-CARRIER                PIC X.
  2637             20  PI-SV-GROUPING               PIC X(6).
  2638             20  PI-SV-STATE                  PIC XX.
  2639             20  PI-EDIT-SW                   PIC X.
  2640             20  PI-DISPLAY-SW                PIC XX.
  2641                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  51
* EL6311.cbl
  2642                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2643             20  PI-CRITERIA-DATA             PIC X(350).
  2644             20  PI-BMODE                     PIC X.
  2645             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2646             20  PI-BPMTS                     PIC S999     COMP-3.
  2647             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2648             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2649             20  PI-CSR-SESSION-SW            PIC X.
  2650                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2651             20  PI-ERRORS-SW                 PIC X.
  2652                 88  FATAL-ERRORS               VALUE 'X'.
  2653*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2654             20  pi-unforced-sw               pic x.
  2655                 88  unforced-errors            value 'X'.
  2656             20  FILLER                       PIC X(4).
  2657
  2658        16  FILLER             PIC X(94).
  2659
  2660 01  W-LETTER-COMMUNICATION-AREAS.
  2661*    COPY ELC1042.
  2662******************************************************************
  2663*                                                                *
  2664*                                                                *
  2665*                           ELC1042                              *
  2666*                            VMOD=2.002                          *
  2667*                                                                *
  2668*    NOTE                                                        *
  2669*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2670*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2671*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2672*        TO THESE PROGRAMS.                                      *
  2673*                                                                *
  2674*    NOTE                                                        *
  2675*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2676*        USE ONLY!                                               *
  2677*                                                                *
  2678******************************************************************
  2679
  2680         16  PI-1042-WA.
  2681             20  PI-ACTION       PIC  X(01).
  2682                 88 PI-SHOW-MODE           VALUE '1'.
  2683                 88 PI-CLEAR-MODE          VALUE '2'.
  2684                 88 PI-CREATE-MODE         VALUE '3'.
  2685             20  PI-COMM-CONTROL PIC  X(12).
  2686             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2687             20  PI-EOF-SW       PIC  X(01).
  2688                 88  PI-FILE-EOF           VALUE 'Y'.
  2689             20  PI-FILETYP      PIC  X(01).
  2690             20  PI-FORM-SQUEEZE-CONTROL
  2691                                 PIC  X(01).
  2692                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2693                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2694             20  PI-LAST-CONTROL PIC  X(12).
  2695             20  PI-TEMP-STOR-ITEMS
  2696                                 PIC S9(04) COMP.
  2697             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2698             20  PI-UPDATE-SW    PIC  9(01).
  2699                 88 ANY-UPDATES            VALUE 1.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  52
* EL6311.cbl
  2700             20  PI-104-SCREEN-SENT-IND
  2701                                 PIC  X(01).
  2702                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2703                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2704             20  PI-1042-SCREEN-SENT-IND
  2705                                 PIC  X(01).
  2706                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2707                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2708             20  PI-1042-ARCHIVE-IND
  2709                                 PIC  X(01).
  2710                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2711             20  FILLER          PIC  X(29).
  2712*    COPY ELC689PI.
  2713******************************************************************
  2714*                                                                *
  2715*                            ELC689PI                            *
  2716*                            VMOD=2.003                          *
  2717*                                                                *
  2718*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2719*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2720*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2721*                                                                *
  2722*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2723*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2724*    BETWEEN PROGRAMS.                                           *
  2725*                                                                *
  2726*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2727*                                                                *
  2728*               EL631 - EL689  - EL6891 - EL6892                 *
  2729*                                                                *
  2730******************************************************************
  2731*                   C H A N G E   L O G
  2732*
  2733* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2734*-----------------------------------------------------------------
  2735*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2736* EFFECTIVE    NUMBER
  2737*-----------------------------------------------------------------
  2738* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2739* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2740* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2741******************************************************************
  2742
  2743
  2744         16  PI-689-WORK-AREA.
  2745             20  PI-689-ALT-PRINTER-ID
  2746                                 PIC  X(04).
  2747             20  PI-689-ARCHIVE-NUMBER
  2748                                 PIC  9(08).
  2749             20  PI-689-ARCHIVE-SW
  2750                                 PIC  X(01).
  2751                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2752             20  PI-689-DATA-SOURCE
  2753                                 PIC  X(01).
  2754                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2755                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2756                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2757                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  53
* EL6311.cbl
  2758                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2759             20  PI-689-ERROR-IND
  2760                                 PIC  X(01).
  2761                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2762             20  PI-689-ERROR    PIC  9(04).
  2763                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2764                 88  PI-689-FATAL-ERROR
  2765                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2766                            0042 0047 0051 0066 0067 0070
  2767                            0168 0169 0174 0175 0176 0177 0179
  2768                            0180 0181 0182 0184 0185 0189 0190
  2769                            0191
  2770                            0215 0279 0280
  2771                            0412 0413 0454
  2772                            0533 0537
  2773                            2055 2114 2208 2209 2216 2232 2369
  2774                            2398 2433 2908 2999
  2775                            3000 3770 3771 3775
  2776                            7250 7365 7367 7368 7369 7370 7371
  2777                            7272 7373 7374 7376 7377 7378 7379
  2778                            7381 7388 7390 7393 7395 7396 7398
  2779                            9095 9096 9281 9298 9299 9320 9327
  2780                            9426 9427.
  2781                 88  PI-689-STOP-ERROR
  2782                     VALUES 0004 0008 0013 0023 0029 0033
  2783                            0042 0047 0066 0067 0070
  2784                            0168 0169 0174 0175 0176 0177
  2785                            0181 0182 0184 0185 0189 0190
  2786                            0279 0280
  2787                            0412 0413 0454
  2788                            2055 2208 2209 2216 2232
  2789                            2398 2999
  2790                            3000 3770 3771 3775
  2791                            7250 7365 7369 7370 7371
  2792                            7272 7373 7374 7376 7377 7378 7379
  2793                            7381 7388 7390 7393 7396 7398
  2794                            9095 9096 9299 9320 9426.
  2795             20  PI-689-FOLLOW-UP-DATE
  2796                                 PIC  X(02).
  2797             20  PI-689-FORM-NUMBER
  2798                                 PIC  X(04).
  2799             20  PI-689-LABEL-SOURCE
  2800                                 PIC X(01).
  2801                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2802                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2803                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2804                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2805                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2806                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2807                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2808             20  PI-689-NUMBER-COPIES
  2809                                 PIC  9(01).
  2810             20  PI-689-NUMBER-LABEL-LINES
  2811                                 PIC  9(01).
  2812             20  PI-689-NUMBER-TEXT-RECORDS
  2813                                 PIC  9(03).
  2814             20  PI-689-PRINT-ORDER-SW
  2815                                 PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  54
* EL6311.cbl
  2816                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2817                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2818                 88  PI-689-PRINT-LATER     VALUE '3'.
  2819                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2820             20  PI-689-PRINT-RESTRICTION
  2821                                 PIC  X(01).
  2822                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2823                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2824                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2825             20  PI-689-PRINT-SW PIC  X(01).
  2826                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2827             20  PI-689-RESEND-DATE-1
  2828                                 PIC  X(02).
  2829             20  PI-689-RESEND-LETR-1
  2830                                 PIC X(4).
  2831             20  PI-689-TEMP-STOR-ID
  2832                                 PIC  X(08).
  2833             20  PI-689-USE-SCREEN-IND
  2834                                 PIC  X(01).
  2835                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2836             20  PI-689-ARCH-POINTER
  2837                                 PIC S9(08) COMP.
  2838                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2839             20  PI-689-ARCT-POINTER
  2840                                 PIC S9(08) COMP.
  2841                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2842             20  PI-689-VARIABLE-DATA-GRP.
  2843                 24  PI-689-VARIABLE-DATA-1
  2844                                 PIC  X(30).
  2845                 24  PI-689-VARIABLE-DATA-2
  2846                                 PIC  X(30).
  2847                 24  PI-689-VARIABLE-DATA-3
  2848                                 PIC  X(30).
  2849                 24  PI-689-VARIABLE-DATA-4
  2850                                 PIC  X(30).
  2851
  2852         16  PI-689-KEY-DATA-FIELDS.
  2853             20  PI-689-ACCOUNT  PIC  X(10).
  2854             20  PI-689-CARRIER  PIC  X(01).
  2855             20  PI-689-CERT-NO.
  2856                 24  PI-689-CERT-PRIME
  2857                                 PIC  X(10).
  2858                 24  PI-689-CERT-SFX
  2859                                 PIC  X(01).
  2860             20  PI-689-CHG-SEQ-NO
  2861                                 PIC S9(04)    COMP.
  2862             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2863                                 PIC  X(02).
  2864             20  PI-689-ENTRY-BATCH
  2865                                 PIC  X(06).
  2866             20  PI-689-EFF-DATE PIC  X(02).
  2867             20  PI-689-EXP-DATE PIC  X(02).
  2868             20  PI-689-GROUPING PIC  X(06).
  2869             20  PI-689-RESP-PERSON
  2870                                 PIC  X(10).
  2871             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2872             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2873                                 PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  55
* EL6311.cbl
  2874             20  PI-689-STATE    PIC  X(02).
  2875             20  PI-689-TYPE     PIC  X(01).
  2876             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2877             20  PI-689-ALT-SEQ-NO
  2878                                 PIC S9(04)    COMP.
  2879         16  PI-689-DATE-EDIT    PIC  X(08).
  2880         16  PI-689-FOLLOW-UP-EDIT
  2881                                 PIC  X(08).
  2882         16  PI-689-RESEND1-EDIT PIC  X(08).
  2883         16  PI-689-SEQ-EDIT     PIC  X(08).
  2884         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  2885         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2886             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2887         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2888         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  56
* EL6311.cbl
  2890
  2891 01  WS-EL6315-PASS-AREA.
  2892        16  PI-6315-ISS-CAN-SW      PIC X.
  2893        16  FILLER                  PIC X(120).
  2894        16  PI-RES-REF-CLM-TYPE     PIC X.
  2895        16  FILLER                  PIC X.
  2896        16  PI-6315-PASS-AREA.
  2897            20 FILLER               PIC X(236).
  2898            20 PI-6315-FINALIZED    PIC X.
  2899            20 FILLER               PIC X(280).
  2900
  2901 01  WS-EL6316-PASS-AREA.
  2902        16  PI-ISS-CAN-SW           PIC X.
  2903        16  FILLER                  PIC X(121).
  2904        16  PI-CLM-RESC-IND         PIC X.
  2905        16  PI-6316-PASS-AREA.
  2906            20 FILLER               PIC X(236).
  2907            20 PI-6316-FINALIZED    PIC X.
  2908            20 FILLER               PIC X(280).
  2909
  2910******************************************************************
  2911*                                                                *
  2912*         P A S S   A R E A   F O R   E D I T                    *
  2913*                                                                *
  2914******************************************************************
  2915
  2916 01  PASSED-RECORD.
  2917     12  RECORD-SAVE                  PIC X(585).
  2918* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2919*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2920*                    BY  WK-CURRENT-DATE.
  2921******************************************************************
  2922*                                                                *
  2923*                                                                *
  2924*                             ELC50W1                            *
  2925*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2926*                            VMOD=2.004                          *
  2927*                                                                *
  2928*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2929*                                                                *
  2930*                                                                *
  2931******************************************************************
  2932
  2933     12  WK-WORK-AREA.
  2934         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2935         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2936         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2937         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2938         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2939         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2940         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2941         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2942         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2943         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2944         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2945         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2946         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2947         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  57
* EL6311.cbl
  2948         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2949         16  WK-CREDIT-EDIT-CONTROLS.
  2950             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2951             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2952             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2953             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2954             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2955             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2956         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2957         16  WK-SAVE-REIN-DATA.
  2958             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2959             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2960             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2961         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2962             88  ENTRY-FROM-EL6311       VALUE '6'.
  2963         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2964         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2965     12  WK-RECORD-ADDRESSES.
  2966         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2967         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2968         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2969         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2970         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2971         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2972         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2973         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2974     12  WK-OVER-SHORT-AREA.
  2975         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2976         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  2977         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  2978             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  2979         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  58
* EL6311.cbl
  2981
  2982*    COPY ELCEDITC.
  2983******************************************************************
  2984*                                                                *
  2985*                                                                *
  2986*                            ELCEDITC                            *
  2987*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2988*                            VMOD=2.012                          *
  2989*                                                                *
  2990*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  2991*                     EL6313, EL050 AND EL517.                   *
  2992*                                                                *
  2993******************************************************************
  2994******************************************************************
  2995*                   C H A N G E   L O G
  2996*
  2997* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2998*-----------------------------------------------------------------
  2999*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3000* EFFECTIVE    NUMBER
  3001*-----------------------------------------------------------------
  3002* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3003******************************************************************
  3004
  3005     12  EDIT-CRITERIA-DATA.
  3006         16  EC-CO-MONTH-END-DT       PIC XX.
  3007         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3008         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3009         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3010         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3011         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3012         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3013         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3014         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3015         16  EC-CO-REM-TERM-CALC      PIC X.
  3016               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3017               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3018               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3019               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3020
  3021         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3022               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3023               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3024               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3025               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3026               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3027               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3028               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3029               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3030               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3031               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3032
  3033         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3034               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3035               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3036               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3037               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3038               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  59
* EL6311.cbl
  3039               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3040               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3041               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3042
  3043         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3044                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3045                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3046
  3047         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3048                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3049                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3050                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3051                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3052                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3053                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3054                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3055                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3056
  3057         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3058               88  EC-BR-REDUCING                   VALUE 'R'.
  3059               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3060
  3061         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3062         16  EC-BR-LF-DESC             PIC X(10).
  3063         16  EC-BR-AH-DESC             PIC X(10).
  3064         16  EC-BR-LF-COMMENT          PIC X(10).
  3065         16  EC-BR-AH-COMMENT          PIC X(10).
  3066
  3067         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3068               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3069               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3070               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3071               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3072
  3073         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3074               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3075               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3076               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3077               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3078
  3079         16  EC-BR-LF-REFUND-CALC      PIC X.
  3080                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3081                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3082                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3083                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3084                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3085                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3086                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3087
  3088         16  EC-BR-AH-REFUND-CALC      PIC X.
  3089                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3090                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3091                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3092                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3093                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3094                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3095                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3096                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  60
* EL6311.cbl
  3097
  3098         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3099                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3100                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3101                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3102
  3103         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3104                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3105                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3106                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3107
  3108         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3109         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3110         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3111         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3112
  3113         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3114         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3115                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3116                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3117                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3118                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3119
  3120         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3121               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3122               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3123               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3124               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3125               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3126
  3127         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3128               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3129               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3130               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3131               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3132               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3133
  3134         16  EC-ST-LF-REFUND-CALC      PIC X.
  3135                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3136                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3137                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3138                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3139                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3140                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3141                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3142                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3143
  3144         16  EC-ST-AH-REFUND-CALC      PIC X.
  3145                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3146                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3147                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3148                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3149                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3150                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3151                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3152                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3153
  3154         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  61
* EL6311.cbl
  3155         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3156         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3157         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3158         16  EC-AM-EXPIRATION-DT       PIC XX.
  3159         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3160         16  EC-AM-CLASS-CD            PIC XX.
  3161         16  EC-AM-LF-DEVIATION        PIC XXX.
  3162         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3163         16  EC-AM-AH-DEVIATION        PIC XXX.
  3164         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3165         16  EC-AM-PHONE-NO            PIC X(10).
  3166
  3167         16  EC-AM-LF-REFUND-CALC      PIC X.
  3168                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3169                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3170                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3171                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3172                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3173                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3174                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3175
  3176         16  EC-AM-AH-REFUND-CALC      PIC X.
  3177                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3178                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3179                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3180                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3181                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3182                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3183                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3184
  3185         16  EC-AM-BEN-I-G-CD          PIC X.
  3186                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3187                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3188                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3189
  3190         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3191         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3192         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3193         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3194         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3195         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3196         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3197         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3198         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3199
  3200         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3201         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3202         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3203         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3204         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3205         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3206         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3207         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3208         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3209         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3210         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3211         16  EC-RT-LF-NSP-ST           PIC XX.
  3212         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  62
* EL6311.cbl
  3213         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3214         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3215
  3216         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3217             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3218                                             'M' '5' '9' '2'.
  3219             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3220             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3221             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3222             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3223             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3224             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3225             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3226             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3227             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3228             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3229
  3230         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3231             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3232                                             'M' '5' '9' '2'.
  3233             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3234             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3235             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3236             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3237             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3238             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3239             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3240             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3241             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3242             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3243
  3244         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3245         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3246         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3247         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3248         16  EC-CM-DEATH-DT            PIC XX.
  3249
  3250*DMD CUSTOM CODING FIELDS BELOW
  3251*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3252         16  EC-BR-DMD-RATING-SW       PIC X.
  3253                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3254                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3255                 88  NO-DMD-RATING               VALUE 'N'.
  3256
  3257         16  EC-NEW-CERT               PIC X(11).
  3258         16  EC-NEW-STATE              PIC XX.
  3259         16  FILLER                    PIC X.
  3260*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3261         16  OVER-SHORT-EDIT-FIELDS.
  3262             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3263             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3264             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3265             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3266             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3267             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3268             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3269             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3270             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  63
* EL6311.cbl
  3271         16  FILLER                    PIC X(71).
  3272
  3273******************************************************************
  3274
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  64
* EL6311.cbl
  3276
  3277*    COPY ELCJPFX.
  3278******************************************************************
  3279*                                                                *
  3280*                                                                *
  3281*                            ELCJPFX.                            *
  3282*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3283*                            VMOD=2.002                          *
  3284*                                                                *
  3285*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3286*                                                                *
  3287*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3288*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3289*        ELCNTL - CONTROL FILE                                   *
  3290*        ELMSTR - CLAIM MASTERS                                  *
  3291*        ELTRLR - ACTIVITY TRAILERS                              *
  3292*        ELCHKQ - CHECK QUE                                      *
  3293******************************************************************
  3294 01  JOURNAL-RECORD.
  3295     12  jp-date                     pic s9(5) comp-3.
  3296     12  jp-time                     pic s9(7) comp-3.
  3297     12  JP-USER-ID                  PIC X(4).
  3298     12  JP-FILE-ID                  PIC X(8).
  3299     12  JP-PROGRAM-ID               PIC X(8).
  3300     12  JP-RECORD-TYPE              PIC X.
  3301         88 JP-ADD              VALUE 'A'.
  3302         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3303         88 JP-AFTER-CHANGE     VALUE 'C'.
  3304         88 JP-DELETE           VALUE 'D'.
  3305         88 JP-GENERIC-DELETE   VALUE 'G'.
  3306         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3307         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3308     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3309     12  JP-RECORD-AREA
  3310
  3311
  3312                             PIC X(608).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  65
* EL6311.cbl
  3314*    COPY ELCAID.
  3315******************************************************************
  3316*                                                                *
  3317*                            ELCAID.                             *
  3318*                            VMOD=2.001                          *
  3319*                                                                *
  3320*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3321*                                                                *
  3322*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3323*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3324******************************************************************
  3325
  3326 01  DFHAID.
  3327   02  DFHNULL   PIC  X  VALUE  ' '.
  3328   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3329   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3330   02  DFHPEN    PIC  X  VALUE  '='.
  3331   02  DFHOPID   PIC  X  VALUE  'W'.
  3332   02  DFHPA1    PIC  X  VALUE  '%'.
  3333   02  DFHPA2    PIC  X  VALUE  '>'.
  3334   02  DFHPA3    PIC  X  VALUE  ','.
  3335   02  DFHPF1    PIC  X  VALUE  '1'.
  3336   02  DFHPF2    PIC  X  VALUE  '2'.
  3337   02  DFHPF3    PIC  X  VALUE  '3'.
  3338   02  DFHPF4    PIC  X  VALUE  '4'.
  3339   02  DFHPF5    PIC  X  VALUE  '5'.
  3340   02  DFHPF6    PIC  X  VALUE  '6'.
  3341   02  DFHPF7    PIC  X  VALUE  '7'.
  3342   02  DFHPF8    PIC  X  VALUE  '8'.
  3343   02  DFHPF9    PIC  X  VALUE  '9'.
  3344   02  DFHPF10   PIC  X  VALUE  ':'.
  3345   02  DFHPF11   PIC  X  VALUE  '#'.
  3346   02  DFHPF12   PIC  X  VALUE  '@'.
  3347   02  DFHPF13   PIC  X  VALUE  'A'.
  3348   02  DFHPF14   PIC  X  VALUE  'B'.
  3349   02  DFHPF15   PIC  X  VALUE  'C'.
  3350   02  DFHPF16   PIC  X  VALUE  'D'.
  3351   02  DFHPF17   PIC  X  VALUE  'E'.
  3352   02  DFHPF18   PIC  X  VALUE  'F'.
  3353   02  DFHPF19   PIC  X  VALUE  'G'.
  3354   02  DFHPF20   PIC  X  VALUE  'H'.
  3355   02  DFHPF21   PIC  X  VALUE  'I'.
  3356*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3357   02  DFHPF22   PIC  X  VALUE  '['.
  3358   02  DFHPF23   PIC  X  VALUE  '.'.
  3359   02  DFHPF24   PIC  X  VALUE  '<'.
  3360   02  DFHMSRE   PIC  X  VALUE  'X'.
  3361   02  DFHSTRF   PIC  X  VALUE  'h'.
  3362   02  DFHTRIG   PIC  X  VALUE  '"'.
  3363
  3364 01  FILLER    REDEFINES DFHAID.
  3365     12  FILLER              PIC X(8).
  3366     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3367
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  66
* EL6311.cbl
  3369*    COPY EL6311S.
  3370 01  EL631BI.
  3371     05  FILLER            PIC  X(0012).
  3372*    -------------------------------
  3373     05  BDATEL PIC S9(0004) COMP.
  3374     05  BDATEF PIC  X(0001).
  3375     05  FILLER REDEFINES BDATEF.
  3376         10  BDATEA PIC  X(0001).
  3377     05  BDATEI PIC  X(0008).
  3378*    -------------------------------
  3379     05  BTIMEL PIC S9(0004) COMP.
  3380     05  BTIMEF PIC  X(0001).
  3381     05  FILLER REDEFINES BTIMEF.
  3382         10  BTIMEA PIC  X(0001).
  3383     05  BTIMEI PIC  X(0005).
  3384*    -------------------------------
  3385     05  BHEADL PIC S9(0004) COMP.
  3386     05  BHEADF PIC  X(0001).
  3387     05  FILLER REDEFINES BHEADF.
  3388         10  BHEADA PIC  X(0001).
  3389     05  BHEADI PIC  X(0038).
  3390*    -------------------------------
  3391     05  BNCERTLL PIC S9(0004) COMP.
  3392     05  BNCERTLF PIC  X(0001).
  3393     05  FILLER REDEFINES BNCERTLF.
  3394         10  BNCERTLA PIC  X(0001).
  3395     05  BNCERTLI PIC  X(0008).
  3396*    -------------------------------
  3397     05  BNCERTL PIC S9(0004) COMP.
  3398     05  BNCERTF PIC  X(0001).
  3399     05  FILLER REDEFINES BNCERTF.
  3400         10  BNCERTA PIC  X(0001).
  3401     05  BNCERTI PIC  X(0011).
  3402*    -------------------------------
  3403     05  BNSTATLL PIC S9(0004) COMP.
  3404     05  BNSTATLF PIC  X(0001).
  3405     05  FILLER REDEFINES BNSTATLF.
  3406         10  BNSTATLA PIC  X(0001).
  3407     05  BNSTATLI PIC  X(0009).
  3408*    -------------------------------
  3409     05  BNSTATL PIC S9(0004) COMP.
  3410     05  BNSTATF PIC  X(0001).
  3411     05  FILLER REDEFINES BNSTATF.
  3412         10  BNSTATA PIC  X(0001).
  3413     05  BNSTATI PIC  X(0002).
  3414*    -------------------------------
  3415     05  BCHGTL PIC S9(0004) COMP.
  3416     05  BCHGTF PIC  X(0001).
  3417     05  FILLER REDEFINES BCHGTF.
  3418         10  BCHGTA PIC  X(0001).
  3419     05  BCHGTI PIC  X(0004).
  3420*    -------------------------------
  3421     05  BCHGL PIC S9(0004) COMP.
  3422     05  BCHGF PIC  X(0001).
  3423     05  FILLER REDEFINES BCHGF.
  3424         10  BCHGA PIC  X(0001).
  3425     05  BCHGI PIC  X(0004).
  3426*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  67
* EL6311.cbl
  3427     05  BMAINTL PIC S9(0004) COMP.
  3428     05  BMAINTF PIC  X(0001).
  3429     05  FILLER REDEFINES BMAINTF.
  3430         10  BMAINTA PIC  X(0001).
  3431     05  BMAINTI PIC  X(0001).
  3432*    -------------------------------
  3433     05  BMANTBYL PIC S9(0004) COMP.
  3434     05  BMANTBYF PIC  X(0001).
  3435     05  FILLER REDEFINES BMANTBYF.
  3436         10  BMANTBYA PIC  X(0001).
  3437     05  BMANTBYI PIC  X(0004).
  3438*    -------------------------------
  3439     05  BCHGHDGL PIC S9(0004) COMP.
  3440     05  BCHGHDGF PIC  X(0001).
  3441     05  FILLER REDEFINES BCHGHDGF.
  3442         10  BCHGHDGA PIC  X(0001).
  3443     05  BCHGHDGI PIC  X(0003).
  3444*    -------------------------------
  3445     05  BMANTDTL PIC S9(0004) COMP.
  3446     05  BMANTDTF PIC  X(0001).
  3447     05  FILLER REDEFINES BMANTDTF.
  3448         10  BMANTDTA PIC  X(0001).
  3449     05  BMANTDTI PIC  X(0008).
  3450*    -------------------------------
  3451     05  BMANTATL PIC S9(0004) COMP.
  3452     05  BMANTATF PIC  X(0001).
  3453     05  FILLER REDEFINES BMANTATF.
  3454         10  BMANTATA PIC  X(0001).
  3455     05  BMANTATI PIC  X(0005).
  3456*    -------------------------------
  3457     05  BCSRL PIC S9(0004) COMP.
  3458     05  BCSRF PIC  X(0001).
  3459     05  FILLER REDEFINES BCSRF.
  3460         10  BCSRA PIC  X(0001).
  3461     05  BCSRI PIC  X(0004).
  3462*    -------------------------------
  3463     05  BBATCHL PIC S9(0004) COMP.
  3464     05  BBATCHF PIC  X(0001).
  3465     05  FILLER REDEFINES BBATCHF.
  3466         10  BBATCHA PIC  X(0001).
  3467     05  BBATCHI PIC  X(0006).
  3468*    -------------------------------
  3469     05  BSEQL PIC S9(0004) COMP.
  3470     05  BSEQF PIC  X(0001).
  3471     05  FILLER REDEFINES BSEQF.
  3472         10  BSEQA PIC  X(0001).
  3473     05  BSEQI PIC  X(0004).
  3474*    -------------------------------
  3475     05  BMOENDTL PIC S9(0004) COMP.
  3476     05  BMOENDTF PIC  X(0001).
  3477     05  FILLER REDEFINES BMOENDTF.
  3478         10  BMOENDTA PIC  X(0001).
  3479     05  BMOENDTI PIC  X(0008).
  3480*    -------------------------------
  3481     05  BCARRL PIC S9(0004) COMP.
  3482     05  BCARRF PIC  X(0001).
  3483     05  FILLER REDEFINES BCARRF.
  3484         10  BCARRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  68
* EL6311.cbl
  3485     05  BCARRI PIC  X(0001).
  3486*    -------------------------------
  3487     05  BGROUPL PIC S9(0004) COMP.
  3488     05  BGROUPF PIC  X(0001).
  3489     05  FILLER REDEFINES BGROUPF.
  3490         10  BGROUPA PIC  X(0001).
  3491     05  BGROUPI PIC  X(0006).
  3492*    -------------------------------
  3493     05  BSTATEL PIC S9(0004) COMP.
  3494     05  BSTATEF PIC  X(0001).
  3495     05  FILLER REDEFINES BSTATEF.
  3496         10  BSTATEA PIC  X(0001).
  3497     05  BSTATEI PIC  X(0002).
  3498*    -------------------------------
  3499     05  BACCTL PIC S9(0004) COMP.
  3500     05  BACCTF PIC  X(0001).
  3501     05  FILLER REDEFINES BACCTF.
  3502         10  BACCTA PIC  X(0001).
  3503     05  BACCTI PIC  X(0010).
  3504*    -------------------------------
  3505     05  BVINHL PIC S9(0004) COMP.
  3506     05  BVINHF PIC  X(0001).
  3507     05  FILLER REDEFINES BVINHF.
  3508         10  BVINHA PIC  X(0001).
  3509     05  BVINHI PIC  X(0004).
  3510*    -------------------------------
  3511     05  BVINL PIC S9(0004) COMP.
  3512     05  BVINF PIC  X(0001).
  3513     05  FILLER REDEFINES BVINF.
  3514         10  BVINA PIC  X(0001).
  3515     05  BVINI PIC  X(0017).
  3516*    -------------------------------
  3517     05  BREFHDGL PIC S9(0004) COMP.
  3518     05  BREFHDGF PIC  X(0001).
  3519     05  FILLER REDEFINES BREFHDGF.
  3520         10  BREFHDGA PIC  X(0001).
  3521     05  BREFHDGI PIC  X(0004).
  3522*    -------------------------------
  3523     05  BREFL PIC S9(0004) COMP.
  3524     05  BREFF PIC  X(0001).
  3525     05  FILLER REDEFINES BREFF.
  3526         10  BREFA PIC  X(0001).
  3527     05  BREFI PIC  X(0012).
  3528*    -------------------------------
  3529     05  BAGEDEFL PIC S9(0004) COMP.
  3530     05  BAGEDEFF PIC  X(0001).
  3531     05  FILLER REDEFINES BAGEDEFF.
  3532         10  BAGEDEFA PIC  X(0001).
  3533     05  BAGEDEFI PIC  X(0004).
  3534*    -------------------------------
  3535     05  BCERTNOL PIC S9(0004) COMP.
  3536     05  BCERTNOF PIC  X(0001).
  3537     05  FILLER REDEFINES BCERTNOF.
  3538         10  BCERTNOA PIC  X(0001).
  3539     05  BCERTNOI PIC  X(0010).
  3540*    -------------------------------
  3541     05  BSUFIXL PIC S9(0004) COMP.
  3542     05  BSUFIXF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  69
* EL6311.cbl
  3543     05  FILLER REDEFINES BSUFIXF.
  3544         10  BSUFIXA PIC  X(0001).
  3545     05  BSUFIXI PIC  X(0001).
  3546*    -------------------------------
  3547     05  BEFFDTL PIC S9(0004) COMP.
  3548     05  BEFFDTF PIC  X(0001).
  3549     05  FILLER REDEFINES BEFFDTF.
  3550         10  BEFFDTA PIC  X(0001).
  3551     05  BEFFDTI PIC  X(0008).
  3552*    -------------------------------
  3553     05  BLSTNML PIC S9(0004) COMP.
  3554     05  BLSTNMF PIC  X(0001).
  3555     05  FILLER REDEFINES BLSTNMF.
  3556         10  BLSTNMA PIC  X(0001).
  3557     05  BLSTNMI PIC  X(0015).
  3558*    -------------------------------
  3559     05  B1STNML PIC S9(0004) COMP.
  3560     05  B1STNMF PIC  X(0001).
  3561     05  FILLER REDEFINES B1STNMF.
  3562         10  B1STNMA PIC  X(0001).
  3563     05  B1STNMI PIC  X(0010).
  3564*    -------------------------------
  3565     05  BINITL PIC S9(0004) COMP.
  3566     05  BINITF PIC  X(0001).
  3567     05  FILLER REDEFINES BINITF.
  3568         10  BINITA PIC  X(0001).
  3569     05  BINITI PIC  X(0001).
  3570*    -------------------------------
  3571     05  BSEXL PIC S9(0004) COMP.
  3572     05  BSEXF PIC  X(0001).
  3573     05  FILLER REDEFINES BSEXF.
  3574         10  BSEXA PIC  X(0001).
  3575     05  BSEXI PIC  X(0001).
  3576*    -------------------------------
  3577     05  BAGEL PIC S9(0004) COMP.
  3578     05  BAGEF PIC  X(0001).
  3579     05  FILLER REDEFINES BAGEF.
  3580         10  BAGEA PIC  X(0001).
  3581     05  BAGEI PIC  X(0002).
  3582*    -------------------------------
  3583     05  BBIRTHL PIC S9(0004) COMP.
  3584     05  BBIRTHF PIC  X(0001).
  3585     05  FILLER REDEFINES BBIRTHF.
  3586         10  BBIRTHA PIC  X(0001).
  3587     05  BBIRTHI PIC  X(0008).
  3588*    -------------------------------
  3589     05  B1STPMTL PIC S9(0004) COMP.
  3590     05  B1STPMTF PIC  X(0001).
  3591     05  FILLER REDEFINES B1STPMTF.
  3592         10  B1STPMTA PIC  X(0001).
  3593     05  B1STPMTI PIC  X(0008).
  3594*    -------------------------------
  3595     05  BDAYSL PIC S9(0004) COMP.
  3596     05  BDAYSF PIC  X(0001).
  3597     05  FILLER REDEFINES BDAYSF.
  3598         10  BDAYSA PIC  X(0001).
  3599     05  BDAYSI PIC  X(0003).
  3600*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  70
* EL6311.cbl
  3601     05  BLNTRML PIC S9(0004) COMP.
  3602     05  BLNTRMF PIC  X(0001).
  3603     05  FILLER REDEFINES BLNTRMF.
  3604         10  BLNTRMA PIC  X(0001).
  3605     05  BLNTRMI PIC  X(0003).
  3606*    -------------------------------
  3607     05  BLNOFCRL PIC S9(0004) COMP.
  3608     05  BLNOFCRF PIC  X(0001).
  3609     05  FILLER REDEFINES BLNOFCRF.
  3610         10  BLNOFCRA PIC  X(0001).
  3611     05  BLNOFCRI PIC  X(0005).
  3612*    -------------------------------
  3613     05  BMODEL PIC S9(0004) COMP.
  3614     05  BMODEF PIC  X(0001).
  3615     05  FILLER REDEFINES BMODEF.
  3616         10  BMODEA PIC  X(0001).
  3617     05  BMODEI PIC  X(0001).
  3618*    -------------------------------
  3619     05  BFREQL PIC S9(0004) COMP.
  3620     05  BFREQF PIC  X(0001).
  3621     05  FILLER REDEFINES BFREQF.
  3622         10  BFREQA PIC  X(0001).
  3623     05  BFREQI PIC  X(0002).
  3624*    -------------------------------
  3625     05  BPMTSL PIC S9(0004) COMP.
  3626     05  BPMTSF PIC  X(0001).
  3627     05  FILLER REDEFINES BPMTSF.
  3628         10  BPMTSA PIC  X(0001).
  3629     05  BPMTSI PIC  999.
  3630*    -------------------------------
  3631     05  BPMTAMTL PIC S9(0004) COMP.
  3632     05  BPMTAMTF PIC  X(0001).
  3633     05  FILLER REDEFINES BPMTAMTF.
  3634         10  BPMTAMTA PIC  X(0001).
  3635     05  BPMTAMTI PIC  9(7)V99.
  3636*    -------------------------------
  3637     05  BAPRL PIC S9(0004) COMP.
  3638     05  BAPRF PIC  X(0001).
  3639     05  FILLER REDEFINES BAPRF.
  3640         10  BAPRA PIC  X(0001).
  3641     05  BAPRI PIC  X(7).
  3642*    -------------------------------
  3643     05  BLIVESL PIC S9(0004) COMP.
  3644     05  BLIVESF PIC  X(0001).
  3645     05  FILLER REDEFINES BLIVESF.
  3646         10  BLIVESA PIC  X(0001).
  3647     05  BLIVESI PIC  X(0009).
  3648*    -------------------------------
  3649     05  BMEMCAPL PIC S9(0004) COMP.
  3650     05  BMEMCAPF PIC  X(0001).
  3651     05  FILLER REDEFINES BMEMCAPF.
  3652         10  BMEMCAPA PIC  X(0001).
  3653     05  BMEMCAPI PIC  X(0011).
  3654*    -------------------------------
  3655     05  BORIGHDL PIC S9(0004) COMP.
  3656     05  BORIGHDF PIC  X(0001).
  3657     05  FILLER REDEFINES BORIGHDF.
  3658         10  BORIGHDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  71
* EL6311.cbl
  3659     05  BORIGHDI PIC  X(0009).
  3660*    -------------------------------
  3661     05  DMDBILL PIC S9(0004) COMP.
  3662     05  DMDBILF PIC  X(0001).
  3663     05  FILLER REDEFINES DMDBILF.
  3664         10  DMDBILA PIC  X(0001).
  3665     05  DMDBILI PIC  X(0006).
  3666*    -------------------------------
  3667     05  BFORCEL PIC S9(0004) COMP.
  3668     05  BFORCEF PIC  X(0001).
  3669     05  FILLER REDEFINES BFORCEF.
  3670         10  BFORCEA PIC  X(0001).
  3671     05  BFORCEI PIC  X(0001).
  3672*    -------------------------------
  3673     05  BENTRYL PIC S9(0004) COMP.
  3674     05  BENTRYF PIC  X(0001).
  3675     05  FILLER REDEFINES BENTRYF.
  3676         10  BENTRYA PIC  X(0001).
  3677     05  BENTRYI PIC  X(0001).
  3678*    -------------------------------
  3679     05  BREINL PIC S9(0004) COMP.
  3680     05  BREINF PIC  X(0001).
  3681     05  FILLER REDEFINES BREINF.
  3682         10  BREINA PIC  X(0001).
  3683     05  BREINI PIC  X(0001).
  3684*    -------------------------------
  3685     05  BBILCDL PIC S9(0004) COMP.
  3686     05  BBILCDF PIC  X(0001).
  3687     05  FILLER REDEFINES BBILCDF.
  3688         10  BBILCDA PIC  X(0001).
  3689     05  BBILCDI PIC  X(0001).
  3690*    -------------------------------
  3691     05  BUNWRITL PIC S9(0004) COMP.
  3692     05  BUNWRITF PIC  X(0001).
  3693     05  FILLER REDEFINES BUNWRITF.
  3694         10  BUNWRITA PIC  X(0001).
  3695     05  BUNWRITI PIC  X(0001).
  3696*    -------------------------------
  3697     05  BSKPCDL PIC S9(0004) COMP.
  3698     05  BSKPCDF PIC  X(0001).
  3699     05  FILLER REDEFINES BSKPCDF.
  3700         10  BSKPCDA PIC  X(0001).
  3701     05  BSKPCDI PIC  X(0001).
  3702*    -------------------------------
  3703     05  BINDGRPL PIC S9(0004) COMP.
  3704     05  BINDGRPF PIC  X(0001).
  3705     05  FILLER REDEFINES BINDGRPF.
  3706         10  BINDGRPA PIC  X(0001).
  3707     05  BINDGRPI PIC  X(0001).
  3708*    -------------------------------
  3709     05  BSIGL PIC S9(0004) COMP.
  3710     05  BSIGF PIC  X(0001).
  3711     05  FILLER REDEFINES BSIGF.
  3712         10  BSIGA PIC  X(0001).
  3713     05  BSIGI PIC  X(0001).
  3714*    -------------------------------
  3715     05  BRTCLSL PIC S9(0004) COMP.
  3716     05  BRTCLSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  72
* EL6311.cbl
  3717     05  FILLER REDEFINES BRTCLSF.
  3718         10  BRTCLSA PIC  X(0001).
  3719     05  BRTCLSI PIC  X(0002).
  3720*    -------------------------------
  3721     05  BCHGCNTL PIC S9(0004) COMP.
  3722     05  BCHGCNTF PIC  X(0001).
  3723     05  FILLER REDEFINES BCHGCNTF.
  3724         10  BCHGCNTA PIC  X(0001).
  3725     05  BCHGCNTI PIC  X(0003).
  3726*    -------------------------------
  3727     05  BMEMBERL PIC S9(0004) COMP.
  3728     05  BMEMBERF PIC  X(0001).
  3729     05  FILLER REDEFINES BMEMBERF.
  3730         10  BMEMBERA PIC  X(0001).
  3731     05  BMEMBERI PIC  X(0012).
  3732*    -------------------------------
  3733     05  BORGNOL PIC S9(0004) COMP.
  3734     05  BORGNOF PIC  X(0001).
  3735     05  FILLER REDEFINES BORGNOF.
  3736         10  BORGNOA PIC  X(0001).
  3737     05  BORGNOI PIC  X(0006).
  3738*    -------------------------------
  3739     05  BORGSEQL PIC S9(0004) COMP.
  3740     05  BORGSEQF PIC  X(0001).
  3741     05  FILLER REDEFINES BORGSEQF.
  3742         10  BORGSEQA PIC  X(0001).
  3743     05  BORGSEQI PIC  X(0004).
  3744*    -------------------------------
  3745     05  BBILLEDL PIC S9(0004) COMP.
  3746     05  BBILLEDF PIC  X(0001).
  3747     05  FILLER REDEFINES BBILLEDF.
  3748         10  BBILLEDA PIC  X(0001).
  3749     05  BBILLEDI PIC  9(9).
  3750*    -------------------------------
  3751     05  BKIND1L PIC S9(0004) COMP.
  3752     05  BKIND1F PIC  X(0001).
  3753     05  FILLER REDEFINES BKIND1F.
  3754         10  BKIND1A PIC  X(0001).
  3755     05  BKIND1I PIC  X(0002).
  3756*    -------------------------------
  3757     05  BTYPE1L PIC S9(0004) COMP.
  3758     05  BTYPE1F PIC  X(0001).
  3759     05  FILLER REDEFINES BTYPE1F.
  3760         10  BTYPE1A PIC  X(0001).
  3761     05  BTYPE1I PIC  X(0003).
  3762*    -------------------------------
  3763     05  BTERM1L PIC S9(0004) COMP.
  3764     05  BTERM1F PIC  X(0001).
  3765     05  FILLER REDEFINES BTERM1F.
  3766         10  BTERM1A PIC  X(0001).
  3767     05  BTERM1I PIC  X(0003).
  3768*    -------------------------------
  3769     05  BBEN1L PIC S9(0004) COMP.
  3770     05  BBEN1F PIC  X(0001).
  3771     05  FILLER REDEFINES BBEN1F.
  3772         10  BBEN1A PIC  X(0001).
  3773     05  BBEN1I PIC  X(0012).
  3774*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  73
* EL6311.cbl
  3775     05  BPREM1L PIC S9(0004) COMP.
  3776     05  BPREM1F PIC  X(0001).
  3777     05  FILLER REDEFINES BPREM1F.
  3778         10  BPREM1A PIC  X(0001).
  3779     05  BPREM1I PIC  X(0011).
  3780*    -------------------------------
  3781     05  BEXPIR1L PIC S9(0004) COMP.
  3782     05  BEXPIR1F PIC  X(0001).
  3783     05  FILLER REDEFINES BEXPIR1F.
  3784         10  BEXPIR1A PIC  X(0001).
  3785     05  BEXPIR1I PIC  X(0008).
  3786*    -------------------------------
  3787     05  BCP1L PIC S9(0004) COMP.
  3788     05  BCP1F PIC  X(0001).
  3789     05  FILLER REDEFINES BCP1F.
  3790         10  BCP1A PIC  X(0001).
  3791     05  BCP1I PIC  X(0002).
  3792*    -------------------------------
  3793     05  BALTBN1L PIC S9(0004) COMP.
  3794     05  BALTBN1F PIC  X(0001).
  3795     05  FILLER REDEFINES BALTBN1F.
  3796         10  BALTBN1A PIC  X(0001).
  3797     05  BALTBN1I PIC  X(0012).
  3798*    -------------------------------
  3799     05  BALTPR1L PIC S9(0004) COMP.
  3800     05  BALTPR1F PIC  X(0001).
  3801     05  FILLER REDEFINES BALTPR1F.
  3802         10  BALTPR1A PIC  X(0001).
  3803     05  BALTPR1I PIC  X(0011).
  3804*    -------------------------------
  3805     05  BBNCD1L PIC S9(0004) COMP.
  3806     05  BBNCD1F PIC  X(0001).
  3807     05  FILLER REDEFINES BBNCD1F.
  3808         10  BBNCD1A PIC  X(0001).
  3809     05  BBNCD1I PIC  X(0003).
  3810*    -------------------------------
  3811     05  BCPRM1L PIC S9(0004) COMP.
  3812     05  BCPRM1F PIC  X(0001).
  3813     05  FILLER REDEFINES BCPRM1F.
  3814         10  BCPRM1A PIC  X(0001).
  3815     05  BCPRM1I PIC  X(0011).
  3816*    -------------------------------
  3817     05  BCAPRM1L PIC S9(0004) COMP.
  3818     05  BCAPRM1F PIC  X(0001).
  3819     05  FILLER REDEFINES BCAPRM1F.
  3820         10  BCAPRM1A PIC  X(0001).
  3821     05  BCAPRM1I PIC  X(0011).
  3822*    -------------------------------
  3823     05  BENABR1L PIC S9(0004) COMP.
  3824     05  BENABR1F PIC  X(0001).
  3825     05  FILLER REDEFINES BENABR1F.
  3826         10  BENABR1A PIC  X(0001).
  3827     05  BENABR1I PIC  X(0005).
  3828*    -------------------------------
  3829     05  BDIFF1L PIC S9(0004) COMP.
  3830     05  BDIFF1F PIC  X(0001).
  3831     05  FILLER REDEFINES BDIFF1F.
  3832         10  BDIFF1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  74
* EL6311.cbl
  3833     05  BDIFF1I PIC  X(0011).
  3834*    -------------------------------
  3835     05  BBILIT1L PIC S9(0004) COMP.
  3836     05  BBILIT1F PIC  X(0001).
  3837     05  FILLER REDEFINES BBILIT1F.
  3838         10  BBILIT1A PIC  X(0001).
  3839     05  BBILIT1I PIC  X(0008).
  3840*    -------------------------------
  3841     05  BADIFF1L PIC S9(0004) COMP.
  3842     05  BADIFF1F PIC  X(0001).
  3843     05  FILLER REDEFINES BADIFF1F.
  3844         10  BADIFF1A PIC  X(0001).
  3845     05  BADIFF1I PIC  X(0011).
  3846*    -------------------------------
  3847     05  BKIND2L PIC S9(0004) COMP.
  3848     05  BKIND2F PIC  X(0001).
  3849     05  FILLER REDEFINES BKIND2F.
  3850         10  BKIND2A PIC  X(0001).
  3851     05  BKIND2I PIC  X(0002).
  3852*    -------------------------------
  3853     05  BTYPE2L PIC S9(0004) COMP.
  3854     05  BTYPE2F PIC  X(0001).
  3855     05  FILLER REDEFINES BTYPE2F.
  3856         10  BTYPE2A PIC  X(0001).
  3857     05  BTYPE2I PIC  X(0003).
  3858*    -------------------------------
  3859     05  BTERM2L PIC S9(0004) COMP.
  3860     05  BTERM2F PIC  X(0001).
  3861     05  FILLER REDEFINES BTERM2F.
  3862         10  BTERM2A PIC  X(0001).
  3863     05  BTERM2I PIC  X(0003).
  3864*    -------------------------------
  3865     05  BBEN2L PIC S9(0004) COMP.
  3866     05  BBEN2F PIC  X(0001).
  3867     05  FILLER REDEFINES BBEN2F.
  3868         10  BBEN2A PIC  X(0001).
  3869     05  BBEN2I PIC  X(0012).
  3870*    -------------------------------
  3871     05  BPREM2L PIC S9(0004) COMP.
  3872     05  BPREM2F PIC  X(0001).
  3873     05  FILLER REDEFINES BPREM2F.
  3874         10  BPREM2A PIC  X(0001).
  3875     05  BPREM2I PIC  X(0011).
  3876*    -------------------------------
  3877     05  BEXPIR2L PIC S9(0004) COMP.
  3878     05  BEXPIR2F PIC  X(0001).
  3879     05  FILLER REDEFINES BEXPIR2F.
  3880         10  BEXPIR2A PIC  X(0001).
  3881     05  BEXPIR2I PIC  X(0008).
  3882*    -------------------------------
  3883     05  BCP2L PIC S9(0004) COMP.
  3884     05  BCP2F PIC  X(0001).
  3885     05  FILLER REDEFINES BCP2F.
  3886         10  BCP2A PIC  X(0001).
  3887     05  BCP2I PIC  X(0002).
  3888*    -------------------------------
  3889     05  BALTBN2L PIC S9(0004) COMP.
  3890     05  BALTBN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  75
* EL6311.cbl
  3891     05  FILLER REDEFINES BALTBN2F.
  3892         10  BALTBN2A PIC  X(0001).
  3893     05  BALTBN2I PIC  X(0012).
  3894*    -------------------------------
  3895     05  BALTPR2L PIC S9(0004) COMP.
  3896     05  BALTPR2F PIC  X(0001).
  3897     05  FILLER REDEFINES BALTPR2F.
  3898         10  BALTPR2A PIC  X(0001).
  3899     05  BALTPR2I PIC  X(0011).
  3900*    -------------------------------
  3901     05  BBNCD2L PIC S9(0004) COMP.
  3902     05  BBNCD2F PIC  X(0001).
  3903     05  FILLER REDEFINES BBNCD2F.
  3904         10  BBNCD2A PIC  X(0001).
  3905     05  BBNCD2I PIC  X(0003).
  3906*    -------------------------------
  3907     05  BCPRM2L PIC S9(0004) COMP.
  3908     05  BCPRM2F PIC  X(0001).
  3909     05  FILLER REDEFINES BCPRM2F.
  3910         10  BCPRM2A PIC  X(0001).
  3911     05  BCPRM2I PIC  X(0011).
  3912*    -------------------------------
  3913     05  BCAPRM2L PIC S9(0004) COMP.
  3914     05  BCAPRM2F PIC  X(0001).
  3915     05  FILLER REDEFINES BCAPRM2F.
  3916         10  BCAPRM2A PIC  X(0001).
  3917     05  BCAPRM2I PIC  X(0011).
  3918*    -------------------------------
  3919     05  BENABR2L PIC S9(0004) COMP.
  3920     05  BENABR2F PIC  X(0001).
  3921     05  FILLER REDEFINES BENABR2F.
  3922         10  BENABR2A PIC  X(0001).
  3923     05  BENABR2I PIC  X(0005).
  3924*    -------------------------------
  3925     05  BDIFF2L PIC S9(0004) COMP.
  3926     05  BDIFF2F PIC  X(0001).
  3927     05  FILLER REDEFINES BDIFF2F.
  3928         10  BDIFF2A PIC  X(0001).
  3929     05  BDIFF2I PIC  X(0011).
  3930*    -------------------------------
  3931     05  BBILIT2L PIC S9(0004) COMP.
  3932     05  BBILIT2F PIC  X(0001).
  3933     05  FILLER REDEFINES BBILIT2F.
  3934         10  BBILIT2A PIC  X(0001).
  3935     05  BBILIT2I PIC  X(0008).
  3936*    -------------------------------
  3937     05  BADIFF2L PIC S9(0004) COMP.
  3938     05  BADIFF2F PIC  X(0001).
  3939     05  FILLER REDEFINES BADIFF2F.
  3940         10  BADIFF2A PIC  X(0001).
  3941     05  BADIFF2I PIC  X(0011).
  3942*    -------------------------------
  3943     05  BERMSG1L PIC S9(0004) COMP.
  3944     05  BERMSG1F PIC  X(0001).
  3945     05  FILLER REDEFINES BERMSG1F.
  3946         10  BERMSG1A PIC  X(0001).
  3947     05  BERMSG1I PIC  X(0078).
  3948*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  76
* EL6311.cbl
  3949     05  BERMSG2L PIC S9(0004) COMP.
  3950     05  BERMSG2F PIC  X(0001).
  3951     05  FILLER REDEFINES BERMSG2F.
  3952         10  BERMSG2A PIC  X(0001).
  3953     05  BERMSG2I PIC  X(0078).
  3954*    -------------------------------
  3955     05  BERMSG3L PIC S9(0004) COMP.
  3956     05  BERMSG3F PIC  X(0001).
  3957     05  FILLER REDEFINES BERMSG3F.
  3958         10  BERMSG3A PIC  X(0001).
  3959     05  BERMSG3I PIC  X(0078).
  3960*    -------------------------------
  3961     05  BPFENTRL PIC S9(0004) COMP.
  3962     05  BPFENTRF PIC  X(0001).
  3963     05  FILLER REDEFINES BPFENTRF.
  3964         10  BPFENTRA PIC  X(0001).
  3965     05  BPFENTRI PIC  9(2).
  3966*    -------------------------------
  3967     05  BPF5HDRL PIC S9(0004) COMP.
  3968     05  BPF5HDRF PIC  X(0001).
  3969     05  FILLER REDEFINES BPF5HDRF.
  3970         10  BPF5HDRA PIC  X(0001).
  3971     05  BPF5HDRI PIC  X(0005).
  3972*    -------------------------------
  3973     05  BPF4HDRL PIC S9(0004) COMP.
  3974     05  BPF4HDRF PIC  X(0001).
  3975     05  FILLER REDEFINES BPF4HDRF.
  3976         10  BPF4HDRA PIC  X(0001).
  3977     05  BPF4HDRI PIC  X(0013).
  3978*    -------------------------------
  3979     05  BF15HDRL PIC S9(0004) COMP.
  3980     05  BF15HDRF PIC  X(0001).
  3981     05  FILLER REDEFINES BF15HDRF.
  3982         10  BF15HDRA PIC  X(0001).
  3983     05  BF15HDRI PIC  X(0010).
  3984 01  EL631BO REDEFINES EL631BI.
  3985     05  FILLER            PIC  X(0012).
  3986*    -------------------------------
  3987     05  FILLER            PIC  X(0003).
  3988     05  BDATEO PIC  X(0008).
  3989*    -------------------------------
  3990     05  FILLER            PIC  X(0003).
  3991     05  BTIMEO PIC  99.99.
  3992*    -------------------------------
  3993     05  FILLER            PIC  X(0003).
  3994     05  BHEADO PIC  X(0038).
  3995*    -------------------------------
  3996     05  FILLER            PIC  X(0003).
  3997     05  BNCERTLO PIC  X(0008).
  3998*    -------------------------------
  3999     05  FILLER            PIC  X(0003).
  4000     05  BNCERTO PIC  X(0011).
  4001*    -------------------------------
  4002     05  FILLER            PIC  X(0003).
  4003     05  BNSTATLO PIC  X(0009).
  4004*    -------------------------------
  4005     05  FILLER            PIC  X(0003).
  4006     05  BNSTATO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  77
* EL6311.cbl
  4007*    -------------------------------
  4008     05  FILLER            PIC  X(0003).
  4009     05  BCHGTO PIC  X(0004).
  4010*    -------------------------------
  4011     05  FILLER            PIC  X(0003).
  4012     05  BCHGO PIC  ZZZ9.
  4013*    -------------------------------
  4014     05  FILLER            PIC  X(0003).
  4015     05  BMAINTO PIC  X(0001).
  4016*    -------------------------------
  4017     05  FILLER            PIC  X(0003).
  4018     05  BMANTBYO PIC  X(0004).
  4019*    -------------------------------
  4020     05  FILLER            PIC  X(0003).
  4021     05  BCHGHDGO PIC  X(0003).
  4022*    -------------------------------
  4023     05  FILLER            PIC  X(0003).
  4024     05  BMANTDTO PIC  X(0008).
  4025*    -------------------------------
  4026     05  FILLER            PIC  X(0003).
  4027     05  BMANTATO PIC  99.99.
  4028*    -------------------------------
  4029     05  FILLER            PIC  X(0003).
  4030     05  BCSRO PIC  X(0004).
  4031*    -------------------------------
  4032     05  FILLER            PIC  X(0003).
  4033     05  BBATCHO PIC  X(0006).
  4034*    -------------------------------
  4035     05  FILLER            PIC  X(0003).
  4036     05  BSEQO PIC  X(0004).
  4037*    -------------------------------
  4038     05  FILLER            PIC  X(0003).
  4039     05  BMOENDTO PIC  X(0008).
  4040*    -------------------------------
  4041     05  FILLER            PIC  X(0003).
  4042     05  BCARRO PIC  X(0001).
  4043*    -------------------------------
  4044     05  FILLER            PIC  X(0003).
  4045     05  BGROUPO PIC  X(0006).
  4046*    -------------------------------
  4047     05  FILLER            PIC  X(0003).
  4048     05  BSTATEO PIC  X(0002).
  4049*    -------------------------------
  4050     05  FILLER            PIC  X(0003).
  4051     05  BACCTO PIC  X(0010).
  4052*    -------------------------------
  4053     05  FILLER            PIC  X(0003).
  4054     05  BVINHO PIC  X(0004).
  4055*    -------------------------------
  4056     05  FILLER            PIC  X(0003).
  4057     05  BVINO PIC  X(0017).
  4058*    -------------------------------
  4059     05  FILLER            PIC  X(0003).
  4060     05  BREFHDGO PIC  X(0004).
  4061*    -------------------------------
  4062     05  FILLER            PIC  X(0003).
  4063     05  BREFO PIC  X(0012).
  4064*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  78
* EL6311.cbl
  4065     05  FILLER            PIC  X(0003).
  4066     05  BAGEDEFO PIC  X(0004).
  4067*    -------------------------------
  4068     05  FILLER            PIC  X(0003).
  4069     05  BCERTNOO PIC  X(0010).
  4070*    -------------------------------
  4071     05  FILLER            PIC  X(0003).
  4072     05  BSUFIXO PIC  X(0001).
  4073*    -------------------------------
  4074     05  FILLER            PIC  X(0003).
  4075     05  BEFFDTO PIC  X(0008).
  4076*    -------------------------------
  4077     05  FILLER            PIC  X(0003).
  4078     05  BLSTNMO PIC  X(0015).
  4079*    -------------------------------
  4080     05  FILLER            PIC  X(0003).
  4081     05  B1STNMO PIC  X(0010).
  4082*    -------------------------------
  4083     05  FILLER            PIC  X(0003).
  4084     05  BINITO PIC  X(0001).
  4085*    -------------------------------
  4086     05  FILLER            PIC  X(0003).
  4087     05  BSEXO PIC  X(0001).
  4088*    -------------------------------
  4089     05  FILLER            PIC  X(0003).
  4090     05  BAGEO PIC  X(0002).
  4091*    -------------------------------
  4092     05  FILLER            PIC  X(0003).
  4093     05  BBIRTHO PIC  X(0008).
  4094*    -------------------------------
  4095     05  FILLER            PIC  X(0003).
  4096     05  B1STPMTO PIC  X(0008).
  4097*    -------------------------------
  4098     05  FILLER            PIC  X(0003).
  4099     05  BDAYSO PIC  X(0003).
  4100*    -------------------------------
  4101     05  FILLER            PIC  X(0003).
  4102     05  BLNTRMO PIC  X(0003).
  4103*    -------------------------------
  4104     05  FILLER            PIC  X(0003).
  4105     05  BLNOFCRO PIC  X(0005).
  4106*    -------------------------------
  4107     05  FILLER            PIC  X(0003).
  4108     05  BMODEO PIC  X(0001).
  4109*    -------------------------------
  4110     05  FILLER            PIC  X(0003).
  4111     05  BFREQO PIC  X(0002).
  4112*    -------------------------------
  4113     05  FILLER            PIC  X(0003).
  4114     05  BPMTSO PIC  X(0003).
  4115*    -------------------------------
  4116     05  FILLER            PIC  X(0003).
  4117     05  BPMTAMTO PIC  ZZZZZ9.99.
  4118*    -------------------------------
  4119     05  FILLER            PIC  X(0003).
  4120     05  BAPRO PIC  99.9999.
  4121*    -------------------------------
  4122     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  79
* EL6311.cbl
  4123     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4124*    -------------------------------
  4125     05  FILLER            PIC  X(0003).
  4126     05  BMEMCAPO PIC  X(0011).
  4127*    -------------------------------
  4128     05  FILLER            PIC  X(0003).
  4129     05  BORIGHDO PIC  X(0009).
  4130*    -------------------------------
  4131     05  FILLER            PIC  X(0003).
  4132     05  DMDBILO PIC  X(0006).
  4133*    -------------------------------
  4134     05  FILLER            PIC  X(0003).
  4135     05  BFORCEO PIC  X(0001).
  4136*    -------------------------------
  4137     05  FILLER            PIC  X(0003).
  4138     05  BENTRYO PIC  X(0001).
  4139*    -------------------------------
  4140     05  FILLER            PIC  X(0003).
  4141     05  BREINO PIC  X(0001).
  4142*    -------------------------------
  4143     05  FILLER            PIC  X(0003).
  4144     05  BBILCDO PIC  X(0001).
  4145*    -------------------------------
  4146     05  FILLER            PIC  X(0003).
  4147     05  BUNWRITO PIC  X(0001).
  4148*    -------------------------------
  4149     05  FILLER            PIC  X(0003).
  4150     05  BSKPCDO PIC  X(0001).
  4151*    -------------------------------
  4152     05  FILLER            PIC  X(0003).
  4153     05  BINDGRPO PIC  X(0001).
  4154*    -------------------------------
  4155     05  FILLER            PIC  X(0003).
  4156     05  BSIGO PIC  X(0001).
  4157*    -------------------------------
  4158     05  FILLER            PIC  X(0003).
  4159     05  BRTCLSO PIC  X(0002).
  4160*    -------------------------------
  4161     05  FILLER            PIC  X(0003).
  4162     05  BCHGCNTO PIC  X(0003).
  4163*    -------------------------------
  4164     05  FILLER            PIC  X(0003).
  4165     05  BMEMBERO PIC  X(0012).
  4166*    -------------------------------
  4167     05  FILLER            PIC  X(0003).
  4168     05  BORGNOO PIC  X(0006).
  4169*    -------------------------------
  4170     05  FILLER            PIC  X(0003).
  4171     05  BORGSEQO PIC  X(0004).
  4172*    -------------------------------
  4173     05  FILLER            PIC  X(0003).
  4174     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4175*    -------------------------------
  4176     05  FILLER            PIC  X(0003).
  4177     05  BKIND1O PIC  X(0002).
  4178*    -------------------------------
  4179     05  FILLER            PIC  X(0003).
  4180     05  BTYPE1O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  80
* EL6311.cbl
  4181*    -------------------------------
  4182     05  FILLER            PIC  X(0003).
  4183     05  BTERM1O PIC  X(0003).
  4184*    -------------------------------
  4185     05  FILLER            PIC  X(0003).
  4186     05  BBEN1O PIC  X(0012).
  4187*    -------------------------------
  4188     05  FILLER            PIC  X(0003).
  4189     05  BPREM1O PIC  X(0011).
  4190*    -------------------------------
  4191     05  FILLER            PIC  X(0003).
  4192     05  BEXPIR1O PIC  X(0008).
  4193*    -------------------------------
  4194     05  FILLER            PIC  X(0003).
  4195     05  BCP1O PIC  X(0002).
  4196*    -------------------------------
  4197     05  FILLER            PIC  X(0003).
  4198     05  BALTBN1O PIC  X(0012).
  4199*    -------------------------------
  4200     05  FILLER            PIC  X(0003).
  4201     05  BALTPR1O PIC  X(0011).
  4202*    -------------------------------
  4203     05  FILLER            PIC  X(0003).
  4204     05  BBNCD1O PIC  X(0003).
  4205*    -------------------------------
  4206     05  FILLER            PIC  X(0003).
  4207     05  BCPRM1O PIC  X(0011).
  4208*    -------------------------------
  4209     05  FILLER            PIC  X(0003).
  4210     05  BCAPRM1O PIC  X(0011).
  4211*    -------------------------------
  4212     05  FILLER            PIC  X(0003).
  4213     05  BENABR1O PIC  X(0005).
  4214*    -------------------------------
  4215     05  FILLER            PIC  X(0003).
  4216     05  BDIFF1O PIC  X(0011).
  4217*    -------------------------------
  4218     05  FILLER            PIC  X(0003).
  4219     05  BBILIT1O PIC  X(0008).
  4220*    -------------------------------
  4221     05  FILLER            PIC  X(0003).
  4222     05  BADIFF1O PIC  X(0011).
  4223*    -------------------------------
  4224     05  FILLER            PIC  X(0003).
  4225     05  BKIND2O PIC  X(0002).
  4226*    -------------------------------
  4227     05  FILLER            PIC  X(0003).
  4228     05  BTYPE2O PIC  X(0003).
  4229*    -------------------------------
  4230     05  FILLER            PIC  X(0003).
  4231     05  BTERM2O PIC  X(0003).
  4232*    -------------------------------
  4233     05  FILLER            PIC  X(0003).
  4234     05  BBEN2O PIC  X(0012).
  4235*    -------------------------------
  4236     05  FILLER            PIC  X(0003).
  4237     05  BPREM2O PIC  X(0011).
  4238*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  81
* EL6311.cbl
  4239     05  FILLER            PIC  X(0003).
  4240     05  BEXPIR2O PIC  X(0008).
  4241*    -------------------------------
  4242     05  FILLER            PIC  X(0003).
  4243     05  BCP2O PIC  X(0002).
  4244*    -------------------------------
  4245     05  FILLER            PIC  X(0003).
  4246     05  BALTBN2O PIC  X(0012).
  4247*    -------------------------------
  4248     05  FILLER            PIC  X(0003).
  4249     05  BALTPR2O PIC  X(0011).
  4250*    -------------------------------
  4251     05  FILLER            PIC  X(0003).
  4252     05  BBNCD2O PIC  X(0003).
  4253*    -------------------------------
  4254     05  FILLER            PIC  X(0003).
  4255     05  BCPRM2O PIC  X(0011).
  4256*    -------------------------------
  4257     05  FILLER            PIC  X(0003).
  4258     05  BCAPRM2O PIC  X(0011).
  4259*    -------------------------------
  4260     05  FILLER            PIC  X(0003).
  4261     05  BENABR2O PIC  X(0005).
  4262*    -------------------------------
  4263     05  FILLER            PIC  X(0003).
  4264     05  BDIFF2O PIC  X(0011).
  4265*    -------------------------------
  4266     05  FILLER            PIC  X(0003).
  4267     05  BBILIT2O PIC  X(0008).
  4268*    -------------------------------
  4269     05  FILLER            PIC  X(0003).
  4270     05  BADIFF2O PIC  X(0011).
  4271*    -------------------------------
  4272     05  FILLER            PIC  X(0003).
  4273     05  BERMSG1O PIC  X(0078).
  4274*    -------------------------------
  4275     05  FILLER            PIC  X(0003).
  4276     05  BERMSG2O PIC  X(0078).
  4277*    -------------------------------
  4278     05  FILLER            PIC  X(0003).
  4279     05  BERMSG3O PIC  X(0078).
  4280*    -------------------------------
  4281     05  FILLER            PIC  X(0003).
  4282     05  BPFENTRO PIC  X(0002).
  4283*    -------------------------------
  4284     05  FILLER            PIC  X(0003).
  4285     05  BPF5HDRO PIC  X(0005).
  4286*    -------------------------------
  4287     05  FILLER            PIC  X(0003).
  4288     05  BPF4HDRO PIC  X(0013).
  4289*    -------------------------------
  4290     05  FILLER            PIC  X(0003).
  4291     05  BF15HDRO PIC  X(0010).
  4292*    -------------------------------
  4293 01  EL631CI REDEFINES EL631BI.
  4294     05  FILLER            PIC  X(0012).
  4295*    -------------------------------
  4296     05  CDATEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  82
* EL6311.cbl
  4297     05  CDATEF PIC  X(0001).
  4298     05  FILLER REDEFINES CDATEF.
  4299         10  CDATEA PIC  X(0001).
  4300     05  CDATEI PIC  X(0008).
  4301*    -------------------------------
  4302     05  CTIMEL PIC S9(0004) COMP.
  4303     05  CTIMEF PIC  X(0001).
  4304     05  FILLER REDEFINES CTIMEF.
  4305         10  CTIMEA PIC  X(0001).
  4306     05  CTIMEI PIC  X(0005).
  4307*    -------------------------------
  4308     05  CHEADL PIC S9(0004) COMP.
  4309     05  CHEADF PIC  X(0001).
  4310     05  FILLER REDEFINES CHEADF.
  4311         10  CHEADA PIC  X(0001).
  4312     05  CHEADI PIC  X(0038).
  4313*    -------------------------------
  4314     05  CCHGTL PIC S9(0004) COMP.
  4315     05  CCHGTF PIC  X(0001).
  4316     05  FILLER REDEFINES CCHGTF.
  4317         10  CCHGTA PIC  X(0001).
  4318     05  CCHGTI PIC  X(0004).
  4319*    -------------------------------
  4320     05  CCHGL PIC S9(0004) COMP.
  4321     05  CCHGF PIC  X(0001).
  4322     05  FILLER REDEFINES CCHGF.
  4323         10  CCHGA PIC  X(0001).
  4324     05  CCHGI PIC  X(0004).
  4325*    -------------------------------
  4326     05  CMAINTL PIC S9(0004) COMP.
  4327     05  CMAINTF PIC  X(0001).
  4328     05  FILLER REDEFINES CMAINTF.
  4329         10  CMAINTA PIC  X(0001).
  4330     05  CMAINTI PIC  X(0001).
  4331*    -------------------------------
  4332     05  CMANTBYL PIC S9(0004) COMP.
  4333     05  CMANTBYF PIC  X(0001).
  4334     05  FILLER REDEFINES CMANTBYF.
  4335         10  CMANTBYA PIC  X(0001).
  4336     05  CMANTBYI PIC  X(0004).
  4337*    -------------------------------
  4338     05  CCHGHDGL PIC S9(0004) COMP.
  4339     05  CCHGHDGF PIC  X(0001).
  4340     05  FILLER REDEFINES CCHGHDGF.
  4341         10  CCHGHDGA PIC  X(0001).
  4342     05  CCHGHDGI PIC  X(0003).
  4343*    -------------------------------
  4344     05  CMANTDTL PIC S9(0004) COMP.
  4345     05  CMANTDTF PIC  X(0001).
  4346     05  FILLER REDEFINES CMANTDTF.
  4347         10  CMANTDTA PIC  X(0001).
  4348     05  CMANTDTI PIC  X(0008).
  4349*    -------------------------------
  4350     05  CMANTATL PIC S9(0004) COMP.
  4351     05  CMANTATF PIC  X(0001).
  4352     05  FILLER REDEFINES CMANTATF.
  4353         10  CMANTATA PIC  X(0001).
  4354     05  CMANTATI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  83
* EL6311.cbl
  4355*    -------------------------------
  4356     05  CCSRL PIC S9(0004) COMP.
  4357     05  CCSRF PIC  X(0001).
  4358     05  FILLER REDEFINES CCSRF.
  4359         10  CCSRA PIC  X(0001).
  4360     05  CCSRI PIC  X(0004).
  4361*    -------------------------------
  4362     05  CBATCHL PIC S9(0004) COMP.
  4363     05  CBATCHF PIC  X(0001).
  4364     05  FILLER REDEFINES CBATCHF.
  4365         10  CBATCHA PIC  X(0001).
  4366     05  CBATCHI PIC  X(0006).
  4367*    -------------------------------
  4368     05  CSEQL PIC S9(0004) COMP.
  4369     05  CSEQF PIC  X(0001).
  4370     05  FILLER REDEFINES CSEQF.
  4371         10  CSEQA PIC  X(0001).
  4372     05  CSEQI PIC  X(0004).
  4373*    -------------------------------
  4374     05  CMOENDTL PIC S9(0004) COMP.
  4375     05  CMOENDTF PIC  X(0001).
  4376     05  FILLER REDEFINES CMOENDTF.
  4377         10  CMOENDTA PIC  X(0001).
  4378     05  CMOENDTI PIC  X(0008).
  4379*    -------------------------------
  4380     05  CCARRL PIC S9(0004) COMP.
  4381     05  CCARRF PIC  X(0001).
  4382     05  FILLER REDEFINES CCARRF.
  4383         10  CCARRA PIC  X(0001).
  4384     05  CCARRI PIC  X(0001).
  4385*    -------------------------------
  4386     05  CGROUPL PIC S9(0004) COMP.
  4387     05  CGROUPF PIC  X(0001).
  4388     05  FILLER REDEFINES CGROUPF.
  4389         10  CGROUPA PIC  X(0001).
  4390     05  CGROUPI PIC  X(0006).
  4391*    -------------------------------
  4392     05  CSTATEL PIC S9(0004) COMP.
  4393     05  CSTATEF PIC  X(0001).
  4394     05  FILLER REDEFINES CSTATEF.
  4395         10  CSTATEA PIC  X(0001).
  4396     05  CSTATEI PIC  X(0002).
  4397*    -------------------------------
  4398     05  CACCTL PIC S9(0004) COMP.
  4399     05  CACCTF PIC  X(0001).
  4400     05  FILLER REDEFINES CACCTF.
  4401         10  CACCTA PIC  X(0001).
  4402     05  CACCTI PIC  X(0010).
  4403*    -------------------------------
  4404     05  CORIGHDL PIC S9(0004) COMP.
  4405     05  CORIGHDF PIC  X(0001).
  4406     05  FILLER REDEFINES CORIGHDF.
  4407         10  CORIGHDA PIC  X(0001).
  4408     05  CORIGHDI PIC  X(0011).
  4409*    -------------------------------
  4410     05  CORGNOL PIC S9(0004) COMP.
  4411     05  CORGNOF PIC  X(0001).
  4412     05  FILLER REDEFINES CORGNOF.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  84
* EL6311.cbl
  4413         10  CORGNOA PIC  X(0001).
  4414     05  CORGNOI PIC  X(0006).
  4415*    -------------------------------
  4416     05  CORGSEQL PIC S9(0004) COMP.
  4417     05  CORGSEQF PIC  X(0001).
  4418     05  FILLER REDEFINES CORGSEQF.
  4419         10  CORGSEQA PIC  X(0001).
  4420     05  CORGSEQI PIC  X(0004).
  4421*    -------------------------------
  4422     05  CREFHDGL PIC S9(0004) COMP.
  4423     05  CREFHDGF PIC  X(0001).
  4424     05  FILLER REDEFINES CREFHDGF.
  4425         10  CREFHDGA PIC  X(0001).
  4426     05  CREFHDGI PIC  X(0010).
  4427*    -------------------------------
  4428     05  CREFL PIC S9(0004) COMP.
  4429     05  CREFF PIC  X(0001).
  4430     05  FILLER REDEFINES CREFF.
  4431         10  CREFA PIC  X(0001).
  4432     05  CREFI PIC  X(0012).
  4433*    -------------------------------
  4434     05  CNHINTL PIC S9(0004) COMP.
  4435     05  CNHINTF PIC  X(0001).
  4436     05  FILLER REDEFINES CNHINTF.
  4437         10  CNHINTA PIC  X(0001).
  4438     05  CNHINTI PIC  9(7)V99.
  4439*    -------------------------------
  4440     05  CCERTNOL PIC S9(0004) COMP.
  4441     05  CCERTNOF PIC  X(0001).
  4442     05  FILLER REDEFINES CCERTNOF.
  4443         10  CCERTNOA PIC  X(0001).
  4444     05  CCERTNOI PIC  X(0010).
  4445*    -------------------------------
  4446     05  CSUFIXL PIC S9(0004) COMP.
  4447     05  CSUFIXF PIC  X(0001).
  4448     05  FILLER REDEFINES CSUFIXF.
  4449         10  CSUFIXA PIC  X(0001).
  4450     05  CSUFIXI PIC  X(0001).
  4451*    -------------------------------
  4452     05  CEFFDTL PIC S9(0004) COMP.
  4453     05  CEFFDTF PIC  X(0001).
  4454     05  FILLER REDEFINES CEFFDTF.
  4455         10  CEFFDTA PIC  X(0001).
  4456     05  CEFFDTI PIC  X(0008).
  4457*    -------------------------------
  4458     05  CLSTNML PIC S9(0004) COMP.
  4459     05  CLSTNMF PIC  X(0001).
  4460     05  FILLER REDEFINES CLSTNMF.
  4461         10  CLSTNMA PIC  X(0001).
  4462     05  CLSTNMI PIC  X(0015).
  4463*    -------------------------------
  4464     05  CPCYNL PIC S9(0004) COMP.
  4465     05  CPCYNF PIC  X(0001).
  4466     05  FILLER REDEFINES CPCYNF.
  4467         10  CPCYNA PIC  X(0001).
  4468     05  CPCYNI PIC  X(0001).
  4469*    -------------------------------
  4470     05  CINAMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  85
* EL6311.cbl
  4471     05  CINAMEF PIC  X(0001).
  4472     05  FILLER REDEFINES CINAMEF.
  4473         10  CINAMEA PIC  X(0001).
  4474     05  CINAMEI PIC  X(0015).
  4475*    -------------------------------
  4476     05  CINITSL PIC S9(0004) COMP.
  4477     05  CINITSF PIC  X(0001).
  4478     05  FILLER REDEFINES CINITSF.
  4479         10  CINITSA PIC  X(0001).
  4480     05  CINITSI PIC  X(0010).
  4481*    -------------------------------
  4482     05  CCANREAL PIC S9(0004) COMP.
  4483     05  CCANREAF PIC  X(0001).
  4484     05  FILLER REDEFINES CCANREAF.
  4485         10  CCANREAA PIC  X(0001).
  4486     05  CCANREAI PIC  X(0001).
  4487*    -------------------------------
  4488     05  CKIND1L PIC S9(0004) COMP.
  4489     05  CKIND1F PIC  X(0001).
  4490     05  FILLER REDEFINES CKIND1F.
  4491         10  CKIND1A PIC  X(0001).
  4492     05  CKIND1I PIC  X(0002).
  4493*    -------------------------------
  4494     05  CCANDT1L PIC S9(0004) COMP.
  4495     05  CCANDT1F PIC  X(0001).
  4496     05  FILLER REDEFINES CCANDT1F.
  4497         10  CCANDT1A PIC  X(0001).
  4498     05  CCANDT1I PIC  X(0008).
  4499*    -------------------------------
  4500     05  CREFND1L PIC S9(0004) COMP.
  4501     05  CREFND1F PIC  X(0001).
  4502     05  FILLER REDEFINES CREFND1F.
  4503         10  CREFND1A PIC  X(0001).
  4504     05  CREFND1I PIC  S9(9)V99.
  4505*    -------------------------------
  4506     05  CMTHD1L PIC S9(0004) COMP.
  4507     05  CMTHD1F PIC  X(0001).
  4508     05  FILLER REDEFINES CMTHD1F.
  4509         10  CMTHD1A PIC  X(0001).
  4510     05  CMTHD1I PIC  X(0001).
  4511*    -------------------------------
  4512     05  CKIND2L PIC S9(0004) COMP.
  4513     05  CKIND2F PIC  X(0001).
  4514     05  FILLER REDEFINES CKIND2F.
  4515         10  CKIND2A PIC  X(0001).
  4516     05  CKIND2I PIC  X(0002).
  4517*    -------------------------------
  4518     05  CCANDT2L PIC S9(0004) COMP.
  4519     05  CCANDT2F PIC  X(0001).
  4520     05  FILLER REDEFINES CCANDT2F.
  4521         10  CCANDT2A PIC  X(0001).
  4522     05  CCANDT2I PIC  X(0008).
  4523*    -------------------------------
  4524     05  CREFND2L PIC S9(0004) COMP.
  4525     05  CREFND2F PIC  X(0001).
  4526     05  FILLER REDEFINES CREFND2F.
  4527         10  CREFND2A PIC  X(0001).
  4528     05  CREFND2I PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  86
* EL6311.cbl
  4529*    -------------------------------
  4530     05  CMTHD2L PIC S9(0004) COMP.
  4531     05  CMTHD2F PIC  X(0001).
  4532     05  FILLER REDEFINES CMTHD2F.
  4533         10  CMTHD2A PIC  X(0001).
  4534     05  CMTHD2I PIC  X(0001).
  4535*    -------------------------------
  4536     05  CLIVESL PIC S9(0004) COMP.
  4537     05  CLIVESF PIC  X(0001).
  4538     05  FILLER REDEFINES CLIVESF.
  4539         10  CLIVESA PIC  X(0001).
  4540     05  CLIVESI PIC  X(0003).
  4541*    -------------------------------
  4542     05  CFORCEL PIC S9(0004) COMP.
  4543     05  CFORCEF PIC  X(0001).
  4544     05  FILLER REDEFINES CFORCEF.
  4545         10  CFORCEA PIC  X(0001).
  4546     05  CFORCEI PIC  X(0001).
  4547*    -------------------------------
  4548     05  CBILCDL PIC S9(0004) COMP.
  4549     05  CBILCDF PIC  X(0001).
  4550     05  FILLER REDEFINES CBILCDF.
  4551         10  CBILCDA PIC  X(0001).
  4552     05  CBILCDI PIC  X(0001).
  4553*    -------------------------------
  4554     05  CCRFND1L PIC S9(0004) COMP.
  4555     05  CCRFND1F PIC  X(0001).
  4556     05  FILLER REDEFINES CCRFND1F.
  4557         10  CCRFND1A PIC  X(0001).
  4558     05  CCRFND1I PIC  X(0011).
  4559*    -------------------------------
  4560     05  CCRFND2L PIC S9(0004) COMP.
  4561     05  CCRFND2F PIC  X(0001).
  4562     05  FILLER REDEFINES CCRFND2F.
  4563         10  CCRFND2A PIC  X(0001).
  4564     05  CCRFND2I PIC  X(0011).
  4565*    -------------------------------
  4566     05  CBILIT1L PIC S9(0004) COMP.
  4567     05  CBILIT1F PIC  X(0001).
  4568     05  FILLER REDEFINES CBILIT1F.
  4569         10  CBILIT1A PIC  X(0001).
  4570     05  CBILIT1I PIC  X(0008).
  4571*    -------------------------------
  4572     05  CDRFND1L PIC S9(0004) COMP.
  4573     05  CDRFND1F PIC  X(0001).
  4574     05  FILLER REDEFINES CDRFND1F.
  4575         10  CDRFND1A PIC  X(0001).
  4576     05  CDRFND1I PIC  X(0011).
  4577*    -------------------------------
  4578     05  CBILIT2L PIC S9(0004) COMP.
  4579     05  CBILIT2F PIC  X(0001).
  4580     05  FILLER REDEFINES CBILIT2F.
  4581         10  CBILIT2A PIC  X(0001).
  4582     05  CBILIT2I PIC  X(0008).
  4583*    -------------------------------
  4584     05  CDRFND2L PIC S9(0004) COMP.
  4585     05  CDRFND2F PIC  X(0001).
  4586     05  FILLER REDEFINES CDRFND2F.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  87
* EL6311.cbl
  4587         10  CDRFND2A PIC  X(0001).
  4588     05  CDRFND2I PIC  X(0011).
  4589*    -------------------------------
  4590     05  CCANTXTL PIC S9(0004) COMP.
  4591     05  CCANTXTF PIC  X(0001).
  4592     05  FILLER REDEFINES CCANTXTF.
  4593         10  CCANTXTA PIC  X(0001).
  4594     05  CCANTXTI PIC  X(0005).
  4595*    -------------------------------
  4596     05  CCANFEEL PIC S9(0004) COMP.
  4597     05  CCANFEEF PIC  X(0001).
  4598     05  FILLER REDEFINES CCANFEEF.
  4599         10  CCANFEEA PIC  X(0001).
  4600     05  CCANFEEI PIC  X(0002).
  4601*    -------------------------------
  4602     05  CTERM1L PIC S9(0004) COMP.
  4603     05  CTERM1F PIC  X(0001).
  4604     05  FILLER REDEFINES CTERM1F.
  4605         10  CTERM1A PIC  X(0001).
  4606     05  CTERM1I PIC  X(0003).
  4607*    -------------------------------
  4608     05  CRTERM1L PIC S9(0004) COMP.
  4609     05  CRTERM1F PIC  X(0001).
  4610     05  FILLER REDEFINES CRTERM1F.
  4611         10  CRTERM1A PIC  X(0001).
  4612     05  CRTERM1I PIC  X(0003).
  4613*    -------------------------------
  4614     05  CPREM1L PIC S9(0004) COMP.
  4615     05  CPREM1F PIC  X(0001).
  4616     05  FILLER REDEFINES CPREM1F.
  4617         10  CPREM1A PIC  X(0001).
  4618     05  CPREM1I PIC  X(0011).
  4619*    -------------------------------
  4620     05  CTERM2L PIC S9(0004) COMP.
  4621     05  CTERM2F PIC  X(0001).
  4622     05  FILLER REDEFINES CTERM2F.
  4623         10  CTERM2A PIC  X(0001).
  4624     05  CTERM2I PIC  X(0003).
  4625*    -------------------------------
  4626     05  CRTERM2L PIC S9(0004) COMP.
  4627     05  CRTERM2F PIC  X(0001).
  4628     05  FILLER REDEFINES CRTERM2F.
  4629         10  CRTERM2A PIC  X(0001).
  4630     05  CRTERM2I PIC  X(0003).
  4631*    -------------------------------
  4632     05  CPREM2L PIC S9(0004) COMP.
  4633     05  CPREM2F PIC  X(0001).
  4634     05  FILLER REDEFINES CPREM2F.
  4635         10  CPREM2A PIC  X(0001).
  4636     05  CPREM2I PIC  X(0011).
  4637*    -------------------------------
  4638     05  CENTRDTL PIC S9(0004) COMP.
  4639     05  CENTRDTF PIC  X(0001).
  4640     05  FILLER REDEFINES CENTRDTF.
  4641         10  CENTRDTA PIC  X(0001).
  4642     05  CENTRDTI PIC  X(0008).
  4643*    -------------------------------
  4644     05  CPAYEEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  88
* EL6311.cbl
  4645     05  CPAYEEF PIC  X(0001).
  4646     05  FILLER REDEFINES CPAYEEF.
  4647         10  CPAYEEA PIC  X(0001).
  4648     05  CPAYEEI PIC  X(0006).
  4649*    -------------------------------
  4650     05  CRFNDSWL PIC S9(0004) COMP.
  4651     05  CRFNDSWF PIC  X(0001).
  4652     05  FILLER REDEFINES CRFNDSWF.
  4653         10  CRFNDSWA PIC  X(0001).
  4654     05  CRFNDSWI PIC  X(0003).
  4655*    -------------------------------
  4656     05  CLFHDGL PIC S9(0004) COMP.
  4657     05  CLFHDGF PIC  X(0001).
  4658     05  FILLER REDEFINES CLFHDGF.
  4659         10  CLFHDGA PIC  X(0001).
  4660     05  CLFHDGI PIC  X(0006).
  4661*    -------------------------------
  4662     05  CAHHDGL PIC S9(0004) COMP.
  4663     05  CAHHDGF PIC  X(0001).
  4664     05  FILLER REDEFINES CAHHDGF.
  4665         10  CAHHDGA PIC  X(0001).
  4666     05  CAHHDGI PIC  X(0006).
  4667*    -------------------------------
  4668     05  CENTDTL PIC S9(0004) COMP.
  4669     05  CENTDTF PIC  X(0001).
  4670     05  FILLER REDEFINES CENTDTF.
  4671         10  CENTDTA PIC  X(0001).
  4672     05  CENTDTI PIC  X(0008).
  4673*    -------------------------------
  4674     05  CENTBYL PIC S9(0004) COMP.
  4675     05  CENTBYF PIC  X(0001).
  4676     05  FILLER REDEFINES CENTBYF.
  4677         10  CENTBYA PIC  X(0001).
  4678     05  CENTBYI PIC  X(0004).
  4679*    -------------------------------
  4680     05  CCHGCNTL PIC S9(0004) COMP.
  4681     05  CCHGCNTF PIC  X(0001).
  4682     05  FILLER REDEFINES CCHGCNTF.
  4683         10  CCHGCNTA PIC  X(0001).
  4684     05  CCHGCNTI PIC  X(0003).
  4685*    -------------------------------
  4686     05  CLFREFNL PIC S9(0004) COMP.
  4687     05  CLFREFNF PIC  X(0001).
  4688     05  FILLER REDEFINES CLFREFNF.
  4689         10  CLFREFNA PIC  X(0001).
  4690     05  CLFREFNI PIC  X(0006).
  4691*    -------------------------------
  4692     05  CAHREFNL PIC S9(0004) COMP.
  4693     05  CAHREFNF PIC  X(0001).
  4694     05  FILLER REDEFINES CAHREFNF.
  4695         10  CAHREFNA PIC  X(0001).
  4696     05  CAHREFNI PIC  X(0006).
  4697*    -------------------------------
  4698     05  CREINCDL PIC S9(0004) COMP.
  4699     05  CREINCDF PIC  X(0001).
  4700     05  FILLER REDEFINES CREINCDF.
  4701         10  CREINCDA PIC  X(0001).
  4702     05  CREINCDI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  89
* EL6311.cbl
  4703*    -------------------------------
  4704     05  CAEFFDTL PIC S9(0004) COMP.
  4705     05  CAEFFDTF PIC  X(0001).
  4706     05  FILLER REDEFINES CAEFFDTF.
  4707         10  CAEFFDTA PIC  X(0001).
  4708     05  CAEFFDTI PIC  X(0008).
  4709*    -------------------------------
  4710     05  CAEXPDTL PIC S9(0004) COMP.
  4711     05  CAEXPDTF PIC  X(0001).
  4712     05  FILLER REDEFINES CAEXPDTF.
  4713         10  CAEXPDTA PIC  X(0001).
  4714     05  CAEXPDTI PIC  X(0008).
  4715*    -------------------------------
  4716     05  COMMLFL PIC S9(0004) COMP.
  4717     05  COMMLFF PIC  X(0001).
  4718     05  FILLER REDEFINES COMMLFF.
  4719         10  COMMLFA PIC  X(0001).
  4720     05  COMMLFI PIC  X(0006).
  4721*    -------------------------------
  4722     05  COMMAHL PIC S9(0004) COMP.
  4723     05  COMMAHF PIC  X(0001).
  4724     05  FILLER REDEFINES COMMAHF.
  4725         10  COMMAHA PIC  X(0001).
  4726     05  COMMAHI PIC  X(0006).
  4727*    -------------------------------
  4728     05  CERMSG1L PIC S9(0004) COMP.
  4729     05  CERMSG1F PIC  X(0001).
  4730     05  FILLER REDEFINES CERMSG1F.
  4731         10  CERMSG1A PIC  X(0001).
  4732     05  CERMSG1I PIC  X(0078).
  4733*    -------------------------------
  4734     05  CERMSG2L PIC S9(0004) COMP.
  4735     05  CERMSG2F PIC  X(0001).
  4736     05  FILLER REDEFINES CERMSG2F.
  4737         10  CERMSG2A PIC  X(0001).
  4738     05  CERMSG2I PIC  X(0078).
  4739*    -------------------------------
  4740     05  CERMSG3L PIC S9(0004) COMP.
  4741     05  CERMSG3F PIC  X(0001).
  4742     05  FILLER REDEFINES CERMSG3F.
  4743         10  CERMSG3A PIC  X(0001).
  4744     05  CERMSG3I PIC  X(0078).
  4745*    -------------------------------
  4746     05  CPFENTRL PIC S9(0004) COMP.
  4747     05  CPFENTRF PIC  X(0001).
  4748     05  FILLER REDEFINES CPFENTRF.
  4749         10  CPFENTRA PIC  X(0001).
  4750     05  CPFENTRI PIC  9(2).
  4751*    -------------------------------
  4752     05  CPF5HDRL PIC S9(0004) COMP.
  4753     05  CPF5HDRF PIC  X(0001).
  4754     05  FILLER REDEFINES CPF5HDRF.
  4755         10  CPF5HDRA PIC  X(0001).
  4756     05  CPF5HDRI PIC  X(0005).
  4757*    -------------------------------
  4758     05  CPF4HDRL PIC S9(0004) COMP.
  4759     05  CPF4HDRF PIC  X(0001).
  4760     05  FILLER REDEFINES CPF4HDRF.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  90
* EL6311.cbl
  4761         10  CPF4HDRA PIC  X(0001).
  4762     05  CPF4HDRI PIC  X(0013).
  4763*    -------------------------------
  4764     05  CF15HDRL PIC S9(0004) COMP.
  4765     05  CF15HDRF PIC  X(0001).
  4766     05  FILLER REDEFINES CF15HDRF.
  4767         10  CF15HDRA PIC  X(0001).
  4768     05  CF15HDRI PIC  X(0022).
  4769 01  EL631CO REDEFINES EL631BI.
  4770     05  FILLER            PIC  X(0012).
  4771*    -------------------------------
  4772     05  FILLER            PIC  X(0003).
  4773     05  CDATEO PIC  X(0008).
  4774*    -------------------------------
  4775     05  FILLER            PIC  X(0003).
  4776     05  CTIMEO PIC  99.99.
  4777*    -------------------------------
  4778     05  FILLER            PIC  X(0003).
  4779     05  CHEADO PIC  X(0038).
  4780*    -------------------------------
  4781     05  FILLER            PIC  X(0003).
  4782     05  CCHGTO PIC  X(0004).
  4783*    -------------------------------
  4784     05  FILLER            PIC  X(0003).
  4785     05  CCHGO PIC  ZZZ9.
  4786*    -------------------------------
  4787     05  FILLER            PIC  X(0003).
  4788     05  CMAINTO PIC  X(0001).
  4789*    -------------------------------
  4790     05  FILLER            PIC  X(0003).
  4791     05  CMANTBYO PIC  X(0004).
  4792*    -------------------------------
  4793     05  FILLER            PIC  X(0003).
  4794     05  CCHGHDGO PIC  X(0003).
  4795*    -------------------------------
  4796     05  FILLER            PIC  X(0003).
  4797     05  CMANTDTO PIC  X(0008).
  4798*    -------------------------------
  4799     05  FILLER            PIC  X(0003).
  4800     05  CMANTATO PIC  99.99.
  4801*    -------------------------------
  4802     05  FILLER            PIC  X(0003).
  4803     05  CCSRO PIC  X(0004).
  4804*    -------------------------------
  4805     05  FILLER            PIC  X(0003).
  4806     05  CBATCHO PIC  X(0006).
  4807*    -------------------------------
  4808     05  FILLER            PIC  X(0003).
  4809     05  CSEQO PIC  X(0004).
  4810*    -------------------------------
  4811     05  FILLER            PIC  X(0003).
  4812     05  CMOENDTO PIC  X(0008).
  4813*    -------------------------------
  4814     05  FILLER            PIC  X(0003).
  4815     05  CCARRO PIC  X(0001).
  4816*    -------------------------------
  4817     05  FILLER            PIC  X(0003).
  4818     05  CGROUPO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  91
* EL6311.cbl
  4819*    -------------------------------
  4820     05  FILLER            PIC  X(0003).
  4821     05  CSTATEO PIC  X(0002).
  4822*    -------------------------------
  4823     05  FILLER            PIC  X(0003).
  4824     05  CACCTO PIC  X(0010).
  4825*    -------------------------------
  4826     05  FILLER            PIC  X(0003).
  4827     05  CORIGHDO PIC  X(0011).
  4828*    -------------------------------
  4829     05  FILLER            PIC  X(0003).
  4830     05  CORGNOO PIC  X(0006).
  4831*    -------------------------------
  4832     05  FILLER            PIC  X(0003).
  4833     05  CORGSEQO PIC  X(0004).
  4834*    -------------------------------
  4835     05  FILLER            PIC  X(0003).
  4836     05  CREFHDGO PIC  X(0010).
  4837*    -------------------------------
  4838     05  FILLER            PIC  X(0003).
  4839     05  CREFO PIC  X(0012).
  4840*    -------------------------------
  4841     05  FILLER            PIC  X(0003).
  4842     05  CNHINTO PIC  999999.99.
  4843*    -------------------------------
  4844     05  FILLER            PIC  X(0003).
  4845     05  CCERTNOO PIC  X(0010).
  4846*    -------------------------------
  4847     05  FILLER            PIC  X(0003).
  4848     05  CSUFIXO PIC  X(0001).
  4849*    -------------------------------
  4850     05  FILLER            PIC  X(0003).
  4851     05  CEFFDTO PIC  X(0008).
  4852*    -------------------------------
  4853     05  FILLER            PIC  X(0003).
  4854     05  CLSTNMO PIC  X(0015).
  4855*    -------------------------------
  4856     05  FILLER            PIC  X(0003).
  4857     05  CPCYNO PIC  X(0001).
  4858*    -------------------------------
  4859     05  FILLER            PIC  X(0003).
  4860     05  CINAMEO PIC  X(0015).
  4861*    -------------------------------
  4862     05  FILLER            PIC  X(0003).
  4863     05  CINITSO PIC  X(0010).
  4864*    -------------------------------
  4865     05  FILLER            PIC  X(0003).
  4866     05  CCANREAO PIC  X(0001).
  4867*    -------------------------------
  4868     05  FILLER            PIC  X(0003).
  4869     05  CKIND1O PIC  X(0002).
  4870*    -------------------------------
  4871     05  FILLER            PIC  X(0003).
  4872     05  CCANDT1O PIC  X(0008).
  4873*    -------------------------------
  4874     05  FILLER            PIC  X(0003).
  4875     05  CREFND1O PIC  Z(7).99-.
  4876*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  92
* EL6311.cbl
  4877     05  FILLER            PIC  X(0003).
  4878     05  CMTHD1O PIC  X(0001).
  4879*    -------------------------------
  4880     05  FILLER            PIC  X(0003).
  4881     05  CKIND2O PIC  X(0002).
  4882*    -------------------------------
  4883     05  FILLER            PIC  X(0003).
  4884     05  CCANDT2O PIC  X(0008).
  4885*    -------------------------------
  4886     05  FILLER            PIC  X(0003).
  4887     05  CREFND2O PIC  Z(7).99-.
  4888*    -------------------------------
  4889     05  FILLER            PIC  X(0003).
  4890     05  CMTHD2O PIC  X(0001).
  4891*    -------------------------------
  4892     05  FILLER            PIC  X(0003).
  4893     05  CLIVESO PIC  X(0003).
  4894*    -------------------------------
  4895     05  FILLER            PIC  X(0003).
  4896     05  CFORCEO PIC  X(0001).
  4897*    -------------------------------
  4898     05  FILLER            PIC  X(0003).
  4899     05  CBILCDO PIC  X(0001).
  4900*    -------------------------------
  4901     05  FILLER            PIC  X(0003).
  4902     05  CCRFND1O PIC  Z(7).99-.
  4903*    -------------------------------
  4904     05  FILLER            PIC  X(0003).
  4905     05  CCRFND2O PIC  Z(7).99-.
  4906*    -------------------------------
  4907     05  FILLER            PIC  X(0003).
  4908     05  CBILIT1O PIC  X(0008).
  4909*    -------------------------------
  4910     05  FILLER            PIC  X(0003).
  4911     05  CDRFND1O PIC  Z(7).99-.
  4912*    -------------------------------
  4913     05  FILLER            PIC  X(0003).
  4914     05  CBILIT2O PIC  X(0008).
  4915*    -------------------------------
  4916     05  FILLER            PIC  X(0003).
  4917     05  CDRFND2O PIC  Z(7).99-.
  4918*    -------------------------------
  4919     05  FILLER            PIC  X(0003).
  4920     05  CCANTXTO PIC  X(0005).
  4921*    -------------------------------
  4922     05  FILLER            PIC  X(0003).
  4923     05  CCANFEEO PIC  Z9.
  4924*    -------------------------------
  4925     05  FILLER            PIC  X(0003).
  4926     05  CTERM1O PIC  ZZ9.
  4927*    -------------------------------
  4928     05  FILLER            PIC  X(0003).
  4929     05  CRTERM1O PIC  ZZ9.
  4930*    -------------------------------
  4931     05  FILLER            PIC  X(0003).
  4932     05  CPREM1O PIC  ZZZZZZ9.99-.
  4933*    -------------------------------
  4934     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  93
* EL6311.cbl
  4935     05  CTERM2O PIC  ZZ9.
  4936*    -------------------------------
  4937     05  FILLER            PIC  X(0003).
  4938     05  CRTERM2O PIC  ZZ9.
  4939*    -------------------------------
  4940     05  FILLER            PIC  X(0003).
  4941     05  CPREM2O PIC  ZZZZZZ9.99-.
  4942*    -------------------------------
  4943     05  FILLER            PIC  X(0003).
  4944     05  CENTRDTO PIC  X(0008).
  4945*    -------------------------------
  4946     05  FILLER            PIC  X(0003).
  4947     05  CPAYEEO PIC  X(0006).
  4948*    -------------------------------
  4949     05  FILLER            PIC  X(0003).
  4950     05  CRFNDSWO PIC  X(0003).
  4951*    -------------------------------
  4952     05  FILLER            PIC  X(0003).
  4953     05  CLFHDGO PIC  X(0006).
  4954*    -------------------------------
  4955     05  FILLER            PIC  X(0003).
  4956     05  CAHHDGO PIC  X(0006).
  4957*    -------------------------------
  4958     05  FILLER            PIC  X(0003).
  4959     05  CENTDTO PIC  X(0008).
  4960*    -------------------------------
  4961     05  FILLER            PIC  X(0003).
  4962     05  CENTBYO PIC  X(0004).
  4963*    -------------------------------
  4964     05  FILLER            PIC  X(0003).
  4965     05  CCHGCNTO PIC  X(0003).
  4966*    -------------------------------
  4967     05  FILLER            PIC  X(0003).
  4968     05  CLFREFNO PIC  X(0006).
  4969*    -------------------------------
  4970     05  FILLER            PIC  X(0003).
  4971     05  CAHREFNO PIC  X(0006).
  4972*    -------------------------------
  4973     05  FILLER            PIC  X(0003).
  4974     05  CREINCDO PIC  X(0003).
  4975*    -------------------------------
  4976     05  FILLER            PIC  X(0003).
  4977     05  CAEFFDTO PIC  X(0008).
  4978*    -------------------------------
  4979     05  FILLER            PIC  X(0003).
  4980     05  CAEXPDTO PIC  X(0008).
  4981*    -------------------------------
  4982     05  FILLER            PIC  X(0003).
  4983     05  COMMLFO PIC  .99999.
  4984*    -------------------------------
  4985     05  FILLER            PIC  X(0003).
  4986     05  COMMAHO PIC  .99999.
  4987*    -------------------------------
  4988     05  FILLER            PIC  X(0003).
  4989     05  CERMSG1O PIC  X(0078).
  4990*    -------------------------------
  4991     05  FILLER            PIC  X(0003).
  4992     05  CERMSG2O PIC  X(0078).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  94
* EL6311.cbl
  4993*    -------------------------------
  4994     05  FILLER            PIC  X(0003).
  4995     05  CERMSG3O PIC  X(0078).
  4996*    -------------------------------
  4997     05  FILLER            PIC  X(0003).
  4998     05  CPFENTRO PIC  X(0002).
  4999*    -------------------------------
  5000     05  FILLER            PIC  X(0003).
  5001     05  CPF5HDRO PIC  X(0005).
  5002*    -------------------------------
  5003     05  FILLER            PIC  X(0003).
  5004     05  CPF4HDRO PIC  X(0013).
  5005*    -------------------------------
  5006     05  FILLER            PIC  X(0003).
  5007     05  CF15HDRO PIC  X(0022).
  5008*    -------------------------------
  5009 01  EL631DI REDEFINES EL631BI.
  5010     05  FILLER            PIC  X(0012).
  5011*    -------------------------------
  5012     05  DDATEL PIC S9(0004) COMP.
  5013     05  DDATEF PIC  X(0001).
  5014     05  FILLER REDEFINES DDATEF.
  5015         10  DDATEA PIC  X(0001).
  5016     05  DDATEI PIC  X(0008).
  5017*    -------------------------------
  5018     05  DTIMEL PIC S9(0004) COMP.
  5019     05  DTIMEF PIC  X(0001).
  5020     05  FILLER REDEFINES DTIMEF.
  5021         10  DTIMEA PIC  X(0001).
  5022     05  DTIMEI PIC  X(0005).
  5023*    -------------------------------
  5024     05  DHEADL PIC S9(0004) COMP.
  5025     05  DHEADF PIC  X(0001).
  5026     05  FILLER REDEFINES DHEADF.
  5027         10  DHEADA PIC  X(0001).
  5028     05  DHEADI PIC  X(0038).
  5029*    -------------------------------
  5030     05  DLDATEL PIC S9(0004) COMP.
  5031     05  DLDATEF PIC  X(0001).
  5032     05  FILLER REDEFINES DLDATEF.
  5033         10  DLDATEA PIC  X(0001).
  5034     05  DLDATEI PIC  X(0010).
  5035*    -------------------------------
  5036     05  DBATCHL PIC S9(0004) COMP.
  5037     05  DBATCHF PIC  X(0001).
  5038     05  FILLER REDEFINES DBATCHF.
  5039         10  DBATCHA PIC  X(0001).
  5040     05  DBATCHI PIC  X(0011).
  5041*    -------------------------------
  5042     05  DACCTNML PIC S9(0004) COMP.
  5043     05  DACCTNMF PIC  X(0001).
  5044     05  FILLER REDEFINES DACCTNMF.
  5045         10  DACCTNMA PIC  X(0001).
  5046     05  DACCTNMI PIC  X(0030).
  5047*    -------------------------------
  5048     05  DPROCDTL PIC S9(0004) COMP.
  5049     05  DPROCDTF PIC  X(0001).
  5050     05  FILLER REDEFINES DPROCDTF.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  95
* EL6311.cbl
  5051         10  DPROCDTA PIC  X(0001).
  5052     05  DPROCDTI PIC  X(0008).
  5053*    -------------------------------
  5054     05  DINPUTL PIC S9(0004) COMP.
  5055     05  DINPUTF PIC  X(0001).
  5056     05  FILLER REDEFINES DINPUTF.
  5057         10  DINPUTA PIC  X(0001).
  5058     05  DINPUTI PIC  X(0008).
  5059*    -------------------------------
  5060     05  DMAINDTL PIC S9(0004) COMP.
  5061     05  DMAINDTF PIC  X(0001).
  5062     05  FILLER REDEFINES DMAINDTF.
  5063         10  DMAINDTA PIC  X(0001).
  5064     05  DMAINDTI PIC  X(0008).
  5065*    -------------------------------
  5066     05  DCARRL PIC S9(0004) COMP.
  5067     05  DCARRF PIC  X(0001).
  5068     05  FILLER REDEFINES DCARRF.
  5069         10  DCARRA PIC  X(0001).
  5070     05  DCARRI PIC  X(0001).
  5071*    -------------------------------
  5072     05  DGROUPL PIC S9(0004) COMP.
  5073     05  DGROUPF PIC  X(0001).
  5074     05  FILLER REDEFINES DGROUPF.
  5075         10  DGROUPA PIC  X(0001).
  5076     05  DGROUPI PIC  X(0006).
  5077*    -------------------------------
  5078     05  DSTATEL PIC S9(0004) COMP.
  5079     05  DSTATEF PIC  X(0001).
  5080     05  FILLER REDEFINES DSTATEF.
  5081         10  DSTATEA PIC  X(0001).
  5082     05  DSTATEI PIC  X(0002).
  5083*    -------------------------------
  5084     05  DACCTL PIC S9(0004) COMP.
  5085     05  DACCTF PIC  X(0001).
  5086     05  FILLER REDEFINES DACCTF.
  5087         10  DACCTA PIC  X(0001).
  5088     05  DACCTI PIC  X(0010).
  5089*    -------------------------------
  5090     05  DRECVDTL PIC S9(0004) COMP.
  5091     05  DRECVDTF PIC  X(0001).
  5092     05  FILLER REDEFINES DRECVDTF.
  5093         10  DRECVDTA PIC  X(0001).
  5094     05  DRECVDTI PIC  X(0008).
  5095*    -------------------------------
  5096     05  DCSRL PIC S9(0004) COMP.
  5097     05  DCSRF PIC  X(0001).
  5098     05  FILLER REDEFINES DCSRF.
  5099         10  DCSRA PIC  X(0001).
  5100     05  DCSRI PIC  X(0004).
  5101*    -------------------------------
  5102     05  DREFHDGL PIC S9(0004) COMP.
  5103     05  DREFHDGF PIC  X(0001).
  5104     05  FILLER REDEFINES DREFHDGF.
  5105         10  DREFHDGA PIC  X(0001).
  5106     05  DREFHDGI PIC  X(0010).
  5107*    -------------------------------
  5108     05  DREFL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  96
* EL6311.cbl
  5109     05  DREFF PIC  X(0001).
  5110     05  FILLER REDEFINES DREFF.
  5111         10  DREFA PIC  X(0001).
  5112     05  DREFI PIC  X(0012).
  5113*    -------------------------------
  5114     05  DLFPHDGL PIC S9(0004) COMP.
  5115     05  DLFPHDGF PIC  X(0001).
  5116     05  FILLER REDEFINES DLFPHDGF.
  5117         10  DLFPHDGA PIC  X(0001).
  5118     05  DLFPHDGI PIC  X(0010).
  5119*    -------------------------------
  5120     05  DAHPHDGL PIC S9(0004) COMP.
  5121     05  DAHPHDGF PIC  X(0001).
  5122     05  FILLER REDEFINES DAHPHDGF.
  5123         10  DAHPHDGA PIC  X(0001).
  5124     05  DAHPHDGI PIC  X(0010).
  5125*    -------------------------------
  5126     05  DLFRHDGL PIC S9(0004) COMP.
  5127     05  DLFRHDGF PIC  X(0001).
  5128     05  FILLER REDEFINES DLFRHDGF.
  5129         10  DLFRHDGA PIC  X(0001).
  5130     05  DLFRHDGI PIC  X(0009).
  5131*    -------------------------------
  5132     05  DAHRHDGL PIC S9(0004) COMP.
  5133     05  DAHRHDGF PIC  X(0001).
  5134     05  FILLER REDEFINES DAHRHDGF.
  5135         10  DAHRHDGA PIC  X(0001).
  5136     05  DAHRHDGI PIC  X(0009).
  5137*    -------------------------------
  5138     05  DRISSL PIC S9(0004) COMP.
  5139     05  DRISSF PIC  X(0001).
  5140     05  FILLER REDEFINES DRISSF.
  5141         10  DRISSA PIC  X(0001).
  5142     05  DRISSI PIC  X(0005).
  5143*    -------------------------------
  5144     05  DRLFPRML PIC S9(0004) COMP.
  5145     05  DRLFPRMF PIC  X(0001).
  5146     05  FILLER REDEFINES DRLFPRMF.
  5147         10  DRLFPRMA PIC  X(0001).
  5148     05  DRLFPRMI PIC  S9(9)V99.
  5149*    -------------------------------
  5150     05  DRAHPRML PIC S9(0004) COMP.
  5151     05  DRAHPRMF PIC  X(0001).
  5152     05  FILLER REDEFINES DRAHPRMF.
  5153         10  DRAHPRMA PIC  X(0001).
  5154     05  DRAHPRMI PIC  S9(9)V99.
  5155*    -------------------------------
  5156     05  DRCANCL PIC S9(0004) COMP.
  5157     05  DRCANCF PIC  X(0001).
  5158     05  FILLER REDEFINES DRCANCF.
  5159         10  DRCANCA PIC  X(0001).
  5160     05  DRCANCI PIC  X(0005).
  5161*    -------------------------------
  5162     05  DRLFRFDL PIC S9(0004) COMP.
  5163     05  DRLFRFDF PIC  X(0001).
  5164     05  FILLER REDEFINES DRLFRFDF.
  5165         10  DRLFRFDA PIC  X(0001).
  5166     05  DRLFRFDI PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  97
* EL6311.cbl
  5167*    -------------------------------
  5168     05  DRAHRFDL PIC S9(0004) COMP.
  5169     05  DRAHRFDF PIC  X(0001).
  5170     05  FILLER REDEFINES DRAHRFDF.
  5171         10  DRAHRFDA PIC  X(0001).
  5172     05  DRAHRFDI PIC  S9(9)V99.
  5173*    -------------------------------
  5174     05  DEISSL PIC S9(0004) COMP.
  5175     05  DEISSF PIC  X(0001).
  5176     05  FILLER REDEFINES DEISSF.
  5177         10  DEISSA PIC  X(0001).
  5178     05  DEISSI PIC  X(0005).
  5179*    -------------------------------
  5180     05  DELFPRML PIC S9(0004) COMP.
  5181     05  DELFPRMF PIC  X(0001).
  5182     05  FILLER REDEFINES DELFPRMF.
  5183         10  DELFPRMA PIC  X(0001).
  5184     05  DELFPRMI PIC  X(0011).
  5185*    -------------------------------
  5186     05  DEAHPRML PIC S9(0004) COMP.
  5187     05  DEAHPRMF PIC  X(0001).
  5188     05  FILLER REDEFINES DEAHPRMF.
  5189         10  DEAHPRMA PIC  X(0001).
  5190     05  DEAHPRMI PIC  X(0011).
  5191*    -------------------------------
  5192     05  DECANCL PIC S9(0004) COMP.
  5193     05  DECANCF PIC  X(0001).
  5194     05  FILLER REDEFINES DECANCF.
  5195         10  DECANCA PIC  X(0001).
  5196     05  DECANCI PIC  X(0005).
  5197*    -------------------------------
  5198     05  DELFRFDL PIC S9(0004) COMP.
  5199     05  DELFRFDF PIC  X(0001).
  5200     05  FILLER REDEFINES DELFRFDF.
  5201         10  DELFRFDA PIC  X(0001).
  5202     05  DELFRFDI PIC  X(0011).
  5203*    -------------------------------
  5204     05  DEAHRFDL PIC S9(0004) COMP.
  5205     05  DEAHRFDF PIC  X(0001).
  5206     05  FILLER REDEFINES DEAHRFDF.
  5207         10  DEAHRFDA PIC  X(0001).
  5208     05  DEAHRFDI PIC  X(0011).
  5209*    -------------------------------
  5210     05  DCISSL PIC S9(0004) COMP.
  5211     05  DCISSF PIC  X(0001).
  5212     05  FILLER REDEFINES DCISSF.
  5213         10  DCISSA PIC  X(0001).
  5214     05  DCISSI PIC  X(0005).
  5215*    -------------------------------
  5216     05  DCLFPRML PIC S9(0004) COMP.
  5217     05  DCLFPRMF PIC  X(0001).
  5218     05  FILLER REDEFINES DCLFPRMF.
  5219         10  DCLFPRMA PIC  X(0001).
  5220     05  DCLFPRMI PIC  X(0011).
  5221*    -------------------------------
  5222     05  DCAHPRML PIC S9(0004) COMP.
  5223     05  DCAHPRMF PIC  X(0001).
  5224     05  FILLER REDEFINES DCAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  98
* EL6311.cbl
  5225         10  DCAHPRMA PIC  X(0001).
  5226     05  DCAHPRMI PIC  X(0011).
  5227*    -------------------------------
  5228     05  DCCANCL PIC S9(0004) COMP.
  5229     05  DCCANCF PIC  X(0001).
  5230     05  FILLER REDEFINES DCCANCF.
  5231         10  DCCANCA PIC  X(0001).
  5232     05  DCCANCI PIC  X(0005).
  5233*    -------------------------------
  5234     05  DCLFRFDL PIC S9(0004) COMP.
  5235     05  DCLFRFDF PIC  X(0001).
  5236     05  FILLER REDEFINES DCLFRFDF.
  5237         10  DCLFRFDA PIC  X(0001).
  5238     05  DCLFRFDI PIC  X(0011).
  5239*    -------------------------------
  5240     05  DCAHRFDL PIC S9(0004) COMP.
  5241     05  DCAHRFDF PIC  X(0001).
  5242     05  FILLER REDEFINES DCAHRFDF.
  5243         10  DCAHRFDA PIC  X(0001).
  5244     05  DCAHRFDI PIC  X(0011).
  5245*    -------------------------------
  5246     05  DOISSL PIC S9(0004) COMP.
  5247     05  DOISSF PIC  X(0001).
  5248     05  FILLER REDEFINES DOISSF.
  5249         10  DOISSA PIC  X(0001).
  5250     05  DOISSI PIC  X(0005).
  5251*    -------------------------------
  5252     05  DOLFPRML PIC S9(0004) COMP.
  5253     05  DOLFPRMF PIC  X(0001).
  5254     05  FILLER REDEFINES DOLFPRMF.
  5255         10  DOLFPRMA PIC  X(0001).
  5256     05  DOLFPRMI PIC  X(0011).
  5257*    -------------------------------
  5258     05  DOAHPRML PIC S9(0004) COMP.
  5259     05  DOAHPRMF PIC  X(0001).
  5260     05  FILLER REDEFINES DOAHPRMF.
  5261         10  DOAHPRMA PIC  X(0001).
  5262     05  DOAHPRMI PIC  X(0011).
  5263*    -------------------------------
  5264     05  DOCANCL PIC S9(0004) COMP.
  5265     05  DOCANCF PIC  X(0001).
  5266     05  FILLER REDEFINES DOCANCF.
  5267         10  DOCANCA PIC  X(0001).
  5268     05  DOCANCI PIC  X(0005).
  5269*    -------------------------------
  5270     05  DOLFRFDL PIC S9(0004) COMP.
  5271     05  DOLFRFDF PIC  X(0001).
  5272     05  FILLER REDEFINES DOLFRFDF.
  5273         10  DOLFRFDA PIC  X(0001).
  5274     05  DOLFRFDI PIC  X(0011).
  5275*    -------------------------------
  5276     05  DOAHRFDL PIC S9(0004) COMP.
  5277     05  DOAHRFDF PIC  X(0001).
  5278     05  FILLER REDEFINES DOAHRFDF.
  5279         10  DOAHRFDA PIC  X(0001).
  5280     05  DOAHRFDI PIC  X(0011).
  5281*    -------------------------------
  5282     05  DITOTALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page  99
* EL6311.cbl
  5283     05  DITOTALF PIC  X(0001).
  5284     05  FILLER REDEFINES DITOTALF.
  5285         10  DITOTALA PIC  X(0001).
  5286     05  DITOTALI PIC  X(0005).
  5287*    -------------------------------
  5288     05  DIFATALL PIC S9(0004) COMP.
  5289     05  DIFATALF PIC  X(0001).
  5290     05  FILLER REDEFINES DIFATALF.
  5291         10  DIFATALA PIC  X(0001).
  5292     05  DIFATALI PIC  X(0005).
  5293*    -------------------------------
  5294     05  DIFORCEL PIC S9(0004) COMP.
  5295     05  DIFORCEF PIC  X(0001).
  5296     05  FILLER REDEFINES DIFORCEF.
  5297         10  DIFORCEA PIC  X(0001).
  5298     05  DIFORCEI PIC  X(0005).
  5299*    -------------------------------
  5300     05  DIHOLDL PIC S9(0004) COMP.
  5301     05  DIHOLDF PIC  X(0001).
  5302     05  FILLER REDEFINES DIHOLDF.
  5303         10  DIHOLDA PIC  X(0001).
  5304     05  DIHOLDI PIC  X(0005).
  5305*    -------------------------------
  5306     05  DIAVAILL PIC S9(0004) COMP.
  5307     05  DIAVAILF PIC  X(0001).
  5308     05  FILLER REDEFINES DIAVAILF.
  5309         10  DIAVAILA PIC  X(0001).
  5310     05  DIAVAILI PIC  X(0005).
  5311*    -------------------------------
  5312     05  DIGPREML PIC S9(0004) COMP.
  5313     05  DIGPREMF PIC  X(0001).
  5314     05  FILLER REDEFINES DIGPREMF.
  5315         10  DIGPREMA PIC  X(0001).
  5316     05  DIGPREMI PIC  X(0011).
  5317*    -------------------------------
  5318     05  DIBPREML PIC S9(0004) COMP.
  5319     05  DIBPREMF PIC  X(0001).
  5320     05  FILLER REDEFINES DIBPREMF.
  5321         10  DIBPREMA PIC  X(0001).
  5322     05  DIBPREMI PIC  X(0011).
  5323*    -------------------------------
  5324     05  DCTOTALL PIC S9(0004) COMP.
  5325     05  DCTOTALF PIC  X(0001).
  5326     05  FILLER REDEFINES DCTOTALF.
  5327         10  DCTOTALA PIC  X(0001).
  5328     05  DCTOTALI PIC  X(0005).
  5329*    -------------------------------
  5330     05  DCFATALL PIC S9(0004) COMP.
  5331     05  DCFATALF PIC  X(0001).
  5332     05  FILLER REDEFINES DCFATALF.
  5333         10  DCFATALA PIC  X(0001).
  5334     05  DCFATALI PIC  X(0005).
  5335*    -------------------------------
  5336     05  DCFORCEL PIC S9(0004) COMP.
  5337     05  DCFORCEF PIC  X(0001).
  5338     05  FILLER REDEFINES DCFORCEF.
  5339         10  DCFORCEA PIC  X(0001).
  5340     05  DCFORCEI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 100
* EL6311.cbl
  5341*    -------------------------------
  5342     05  DCHOLDL PIC S9(0004) COMP.
  5343     05  DCHOLDF PIC  X(0001).
  5344     05  FILLER REDEFINES DCHOLDF.
  5345         10  DCHOLDA PIC  X(0001).
  5346     05  DCHOLDI PIC  X(0005).
  5347*    -------------------------------
  5348     05  DCAVAILL PIC S9(0004) COMP.
  5349     05  DCAVAILF PIC  X(0001).
  5350     05  FILLER REDEFINES DCAVAILF.
  5351         10  DCAVAILA PIC  X(0001).
  5352     05  DCAVAILI PIC  X(0005).
  5353*    -------------------------------
  5354     05  DCGPREML PIC S9(0004) COMP.
  5355     05  DCGPREMF PIC  X(0001).
  5356     05  FILLER REDEFINES DCGPREMF.
  5357         10  DCGPREMA PIC  X(0001).
  5358     05  DCGPREMI PIC  X(0011).
  5359*    -------------------------------
  5360     05  DCBPREML PIC S9(0004) COMP.
  5361     05  DCBPREMF PIC  X(0001).
  5362     05  FILLER REDEFINES DCBPREMF.
  5363         10  DCBPREMA PIC  X(0001).
  5364     05  DCBPREMI PIC  X(0011).
  5365*    -------------------------------
  5366     05  DNTOTALL PIC S9(0004) COMP.
  5367     05  DNTOTALF PIC  X(0001).
  5368     05  FILLER REDEFINES DNTOTALF.
  5369         10  DNTOTALA PIC  X(0001).
  5370     05  DNTOTALI PIC  X(0005).
  5371*    -------------------------------
  5372     05  DNFATALL PIC S9(0004) COMP.
  5373     05  DNFATALF PIC  X(0001).
  5374     05  FILLER REDEFINES DNFATALF.
  5375         10  DNFATALA PIC  X(0001).
  5376     05  DNFATALI PIC  X(0005).
  5377*    -------------------------------
  5378     05  DNFORCEL PIC S9(0004) COMP.
  5379     05  DNFORCEF PIC  X(0001).
  5380     05  FILLER REDEFINES DNFORCEF.
  5381         10  DNFORCEA PIC  X(0001).
  5382     05  DNFORCEI PIC  X(0005).
  5383*    -------------------------------
  5384     05  DNHOLDL PIC S9(0004) COMP.
  5385     05  DNHOLDF PIC  X(0001).
  5386     05  FILLER REDEFINES DNHOLDF.
  5387         10  DNHOLDA PIC  X(0001).
  5388     05  DNHOLDI PIC  X(0005).
  5389*    -------------------------------
  5390     05  DNAVAILL PIC S9(0004) COMP.
  5391     05  DNAVAILF PIC  X(0001).
  5392     05  FILLER REDEFINES DNAVAILF.
  5393         10  DNAVAILA PIC  X(0001).
  5394     05  DNAVAILI PIC  X(0005).
  5395*    -------------------------------
  5396     05  DNGPREML PIC S9(0004) COMP.
  5397     05  DNGPREMF PIC  X(0001).
  5398     05  FILLER REDEFINES DNGPREMF.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 101
* EL6311.cbl
  5399         10  DNGPREMA PIC  X(0001).
  5400     05  DNGPREMI PIC  X(0011).
  5401*    -------------------------------
  5402     05  DNBPREML PIC S9(0004) COMP.
  5403     05  DNBPREMF PIC  X(0001).
  5404     05  FILLER REDEFINES DNBPREMF.
  5405         10  DNBPREMA PIC  X(0001).
  5406     05  DNBPREMI PIC  X(0011).
  5407*    -------------------------------
  5408     05  DERMSGL PIC S9(0004) COMP.
  5409     05  DERMSGF PIC  X(0001).
  5410     05  FILLER REDEFINES DERMSGF.
  5411         10  DERMSGA PIC  X(0001).
  5412     05  DERMSGI PIC  X(0075).
  5413*    -------------------------------
  5414     05  DPFENTRL PIC S9(0004) COMP.
  5415     05  DPFENTRF PIC  X(0001).
  5416     05  FILLER REDEFINES DPFENTRF.
  5417         10  DPFENTRA PIC  X(0001).
  5418     05  DPFENTRI PIC  9(2).
  5419 01  EL631DO REDEFINES EL631BI.
  5420     05  FILLER            PIC  X(0012).
  5421*    -------------------------------
  5422     05  FILLER            PIC  X(0003).
  5423     05  DDATEO PIC  X(0008).
  5424*    -------------------------------
  5425     05  FILLER            PIC  X(0003).
  5426     05  DTIMEO PIC  99.99.
  5427*    -------------------------------
  5428     05  FILLER            PIC  X(0003).
  5429     05  DHEADO PIC  X(0038).
  5430*    -------------------------------
  5431     05  FILLER            PIC  X(0003).
  5432     05  DLDATEO PIC  X(0010).
  5433*    -------------------------------
  5434     05  FILLER            PIC  X(0003).
  5435     05  DBATCHO PIC  X(0011).
  5436*    -------------------------------
  5437     05  FILLER            PIC  X(0003).
  5438     05  DACCTNMO PIC  X(0030).
  5439*    -------------------------------
  5440     05  FILLER            PIC  X(0003).
  5441     05  DPROCDTO PIC  X(0008).
  5442*    -------------------------------
  5443     05  FILLER            PIC  X(0003).
  5444     05  DINPUTO PIC  X(0008).
  5445*    -------------------------------
  5446     05  FILLER            PIC  X(0003).
  5447     05  DMAINDTO PIC  X(0008).
  5448*    -------------------------------
  5449     05  FILLER            PIC  X(0003).
  5450     05  DCARRO PIC  X(0001).
  5451*    -------------------------------
  5452     05  FILLER            PIC  X(0003).
  5453     05  DGROUPO PIC  X(0006).
  5454*    -------------------------------
  5455     05  FILLER            PIC  X(0003).
  5456     05  DSTATEO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 102
* EL6311.cbl
  5457*    -------------------------------
  5458     05  FILLER            PIC  X(0003).
  5459     05  DACCTO PIC  X(0010).
  5460*    -------------------------------
  5461     05  FILLER            PIC  X(0003).
  5462     05  DRECVDTO PIC  X(0008).
  5463*    -------------------------------
  5464     05  FILLER            PIC  X(0003).
  5465     05  DCSRO PIC  X(0004).
  5466*    -------------------------------
  5467     05  FILLER            PIC  X(0003).
  5468     05  DREFHDGO PIC  X(0010).
  5469*    -------------------------------
  5470     05  FILLER            PIC  X(0003).
  5471     05  DREFO PIC  X(0012).
  5472*    -------------------------------
  5473     05  FILLER            PIC  X(0003).
  5474     05  DLFPHDGO PIC  X(0010).
  5475*    -------------------------------
  5476     05  FILLER            PIC  X(0003).
  5477     05  DAHPHDGO PIC  X(0010).
  5478*    -------------------------------
  5479     05  FILLER            PIC  X(0003).
  5480     05  DLFRHDGO PIC  X(0009).
  5481*    -------------------------------
  5482     05  FILLER            PIC  X(0003).
  5483     05  DAHRHDGO PIC  X(0009).
  5484*    -------------------------------
  5485     05  FILLER            PIC  X(0003).
  5486     05  DRISSO PIC  ZZ99-.
  5487*    -------------------------------
  5488     05  FILLER            PIC  X(0003).
  5489     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5490*    -------------------------------
  5491     05  FILLER            PIC  X(0003).
  5492     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5493*    -------------------------------
  5494     05  FILLER            PIC  X(0003).
  5495     05  DRCANCO PIC  ZZ99-.
  5496*    -------------------------------
  5497     05  FILLER            PIC  X(0003).
  5498     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5499*    -------------------------------
  5500     05  FILLER            PIC  X(0003).
  5501     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5502*    -------------------------------
  5503     05  FILLER            PIC  X(0003).
  5504     05  DEISSO PIC  ZZ99-.
  5505*    -------------------------------
  5506     05  FILLER            PIC  X(0003).
  5507     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5508*    -------------------------------
  5509     05  FILLER            PIC  X(0003).
  5510     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5511*    -------------------------------
  5512     05  FILLER            PIC  X(0003).
  5513     05  DECANCO PIC  ZZ99-.
  5514*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 103
* EL6311.cbl
  5515     05  FILLER            PIC  X(0003).
  5516     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5517*    -------------------------------
  5518     05  FILLER            PIC  X(0003).
  5519     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5520*    -------------------------------
  5521     05  FILLER            PIC  X(0003).
  5522     05  DCISSO PIC  ZZ99-.
  5523*    -------------------------------
  5524     05  FILLER            PIC  X(0003).
  5525     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5526*    -------------------------------
  5527     05  FILLER            PIC  X(0003).
  5528     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5529*    -------------------------------
  5530     05  FILLER            PIC  X(0003).
  5531     05  DCCANCO PIC  ZZ99-.
  5532*    -------------------------------
  5533     05  FILLER            PIC  X(0003).
  5534     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5535*    -------------------------------
  5536     05  FILLER            PIC  X(0003).
  5537     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5538*    -------------------------------
  5539     05  FILLER            PIC  X(0003).
  5540     05  DOISSO PIC  ZZ99-.
  5541*    -------------------------------
  5542     05  FILLER            PIC  X(0003).
  5543     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5544*    -------------------------------
  5545     05  FILLER            PIC  X(0003).
  5546     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5547*    -------------------------------
  5548     05  FILLER            PIC  X(0003).
  5549     05  DOCANCO PIC  ZZ99-.
  5550*    -------------------------------
  5551     05  FILLER            PIC  X(0003).
  5552     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5553*    -------------------------------
  5554     05  FILLER            PIC  X(0003).
  5555     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5556*    -------------------------------
  5557     05  FILLER            PIC  X(0003).
  5558     05  DITOTALO PIC  ZZZ99.
  5559*    -------------------------------
  5560     05  FILLER            PIC  X(0003).
  5561     05  DIFATALO PIC  ZZZ99.
  5562*    -------------------------------
  5563     05  FILLER            PIC  X(0003).
  5564     05  DIFORCEO PIC  ZZZ99.
  5565*    -------------------------------
  5566     05  FILLER            PIC  X(0003).
  5567     05  DIHOLDO PIC  ZZZ99.
  5568*    -------------------------------
  5569     05  FILLER            PIC  X(0003).
  5570     05  DIAVAILO PIC  ZZZ99.
  5571*    -------------------------------
  5572     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 104
* EL6311.cbl
  5573     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5574*    -------------------------------
  5575     05  FILLER            PIC  X(0003).
  5576     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5577*    -------------------------------
  5578     05  FILLER            PIC  X(0003).
  5579     05  DCTOTALO PIC  ZZZ99.
  5580*    -------------------------------
  5581     05  FILLER            PIC  X(0003).
  5582     05  DCFATALO PIC  ZZZ99.
  5583*    -------------------------------
  5584     05  FILLER            PIC  X(0003).
  5585     05  DCFORCEO PIC  ZZZ99.
  5586*    -------------------------------
  5587     05  FILLER            PIC  X(0003).
  5588     05  DCHOLDO PIC  ZZZ99.
  5589*    -------------------------------
  5590     05  FILLER            PIC  X(0003).
  5591     05  DCAVAILO PIC  ZZZ99.
  5592*    -------------------------------
  5593     05  FILLER            PIC  X(0003).
  5594     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5595*    -------------------------------
  5596     05  FILLER            PIC  X(0003).
  5597     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5598*    -------------------------------
  5599     05  FILLER            PIC  X(0003).
  5600     05  DNTOTALO PIC  ---99.
  5601*    -------------------------------
  5602     05  FILLER            PIC  X(0003).
  5603     05  DNFATALO PIC  ---99.
  5604*    -------------------------------
  5605     05  FILLER            PIC  X(0003).
  5606     05  DNFORCEO PIC  ---99.
  5607*    -------------------------------
  5608     05  FILLER            PIC  X(0003).
  5609     05  DNHOLDO PIC  ---99.
  5610*    -------------------------------
  5611     05  FILLER            PIC  X(0003).
  5612     05  DNAVAILO PIC  ---99.
  5613*    -------------------------------
  5614     05  FILLER            PIC  X(0003).
  5615     05  DNGPREMO PIC  -------9.99.
  5616*    -------------------------------
  5617     05  FILLER            PIC  X(0003).
  5618     05  DNBPREMO PIC  -------9.99.
  5619*    -------------------------------
  5620     05  FILLER            PIC  X(0003).
  5621     05  DERMSGO PIC  X(0075).
  5622*    -------------------------------
  5623     05  FILLER            PIC  X(0003).
  5624     05  DPFENTRO PIC  X(0002).
  5625*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 105
* EL6311.cbl
  5627 01  MAP-B REDEFINES EL631BI.
  5628     12  FILLER                  PIC X(569).
  5629*    12  FILLER                  PIC X(512).
  5630*    12  FILLER                  PIC X(510).
  5631     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5632         16  BKIND-LEN               PIC S9(4)  COMP.
  5633         16  BKIND-ATTRB             PIC X.
  5634         16  BKIND                   PIC XX.
  5635         16  BTYPE-LEN               PIC S9(4)  COMP.
  5636         16  BTYPE-ATTRB             PIC X.
  5637         16  BTYPE                   PIC X(3).
  5638         16  BTERM-LEN               PIC S9(4)  COMP.
  5639         16  BTERM-ATTRB             PIC X.
  5640         16  BTERMI                  PIC 999.
  5641         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5642         16  BBEN-LEN                PIC S9(4)  COMP.
  5643         16  BBEN-ATTRB              PIC X.
  5644         16  BBENI                   PIC 9(10)V99.
  5645*        16  BBENI                   PIC 9(12).
  5646         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5647         16  BPREM-LEN               PIC S9(4)  COMP.
  5648         16  BPREM-ATTRB             PIC X.
  5649         16  BPREMI                  PIC S9(9)V99.
  5650*        16  BPREMI                  PIC 9(11).
  5651         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5652         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5653         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5654         16  BEXPIRE-ATTRB           PIC X.
  5655         16  BEXPIRE                 PIC X(8).
  5656         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5657         16  BCRIT-PERD-ATTRB        PIC X.
  5658         16  BCRIT-PERDI             PIC 99.
  5659         16  BCRIT-PERDO REDEFINES
  5660                         BCRIT-PERDI PIC ZZ.
  5661         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5662         16  BALT-BEN-ATTRB          PIC X.
  5663         16  BALT-BENI               PIC 9(10)V99.
  5664*        16  BALT-BENI               PIC 9(12).
  5665         16  BALT-BENO REDEFINES
  5666                           BALT-BENI PIC Z(9).ZZ.
  5667         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5668         16  BALT-PREM-ATTRB         PIC X.
  5669         16  BALT-PREMI              PIC 9(9)V99.
  5670*        16  BALT-PREMI              PIC 9(11).
  5671         16  BALT-PREMO REDEFINES
  5672                          BALT-PREMI PIC Z(7).ZZ-.
  5673         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5674         16  BBEN-CD-ATTRB           PIC X.
  5675         16  BBEN-CD                 PIC XXX.
  5676         16  BCPREM-LEN              PIC S9(4)  COMP.
  5677         16  BCPREM-ATTRB            PIC X.
  5678         16  BCPREMI                 PIC S9(9)V99.
  5679*        16  BCPREMI                 PIC X(11).
  5680         16  BCPREMO REDEFINES BCPREMI
  5681                                     PIC Z(7).99-.
  5682         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5683         16  BCALT-PREM-ATTRB        PIC X.
  5684         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 106
* EL6311.cbl
  5685         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5686         16  BBEN-ABBR-ATTRB         PIC X.
  5687         16  BBEN-ABBR               PIC X(5).
  5688         16  BDIFF-LEN               PIC S9(4)  COMP.
  5689         16  BDIFF-ATTRB             PIC X.
  5690         16  BDIFFO                  PIC Z(7).99-.
  5691         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5692         16  BBILL-LIT-ATTRB         PIC X.
  5693         16  BBILL-LIT               PIC X(8).
  5694         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5695         16  BDALT-PREM-ATTRB        PIC X.
  5696         16  BDALT-PREM              PIC Z(7).99-.
  5697
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 107
* EL6311.cbl
  5699
  5700****************************************************************
  5701*
  5702* Copyright (c) 2007 by Clerity Solutions, Inc.
  5703* All rights reserved.
  5704*
  5705****************************************************************
  5706 01  DFHEIV.
  5707   02  DFHEIV0               PIC X(35).
  5708   02  DFHEIV1               PIC X(08).
  5709   02  DFHEIV2               PIC X(08).
  5710   02  DFHEIV3               PIC X(08).
  5711   02  DFHEIV4               PIC X(06).
  5712   02  DFHEIV5               PIC X(04).
  5713   02  DFHEIV6               PIC X(04).
  5714   02  DFHEIV7               PIC X(02).
  5715   02  DFHEIV8               PIC X(02).
  5716   02  DFHEIV9               PIC X(01).
  5717   02  DFHEIV10              PIC S9(7) COMP-3.
  5718   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5719   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5720   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5721   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5722   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5723   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5724   02  DFHEIV17              PIC X(04).
  5725   02  DFHEIV18              PIC X(04).
  5726   02  DFHEIV19              PIC X(04).
  5727   02  DFHEIV20              USAGE IS POINTER.
  5728   02  DFHEIV21              USAGE IS POINTER.
  5729   02  DFHEIV22              USAGE IS POINTER.
  5730   02  DFHEIV23              USAGE IS POINTER.
  5731   02  DFHEIV24              USAGE IS POINTER.
  5732   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5733   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5734   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5735   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5736   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5737   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5738   02  FILLER                PIC X(02).
  5739   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5740   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5741   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5742   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5743   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5744 LINKAGE  SECTION.
  5745*****************************************************************
  5746*                                                               *
  5747* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5748* All rights reserved.                                          *
  5749*                                                               *
  5750*****************************************************************
  5751 01  dfheiblk.
  5752     02  eibtime          pic s9(7) comp-3.
  5753     02  eibdate          pic s9(7) comp-3.
  5754     02  eibtrnid         pic x(4).
  5755     02  eibtaskn         pic s9(7) comp-3.
  5756     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 108
* EL6311.cbl
  5757     02  dfheigdi         pic s9(4) comp.
  5758     02  eibcposn         pic s9(4) comp.
  5759     02  eibcalen         pic s9(4) comp.
  5760     02  eibaid           pic x(1).
  5761     02  eibfiller1       pic x(1).
  5762     02  eibfn            pic x(2).
  5763     02  eibfiller2       pic x(2).
  5764     02  eibrcode         pic x(6).
  5765     02  eibfiller3       pic x(2).
  5766     02  eibds            pic x(8).
  5767     02  eibreqid         pic x(8).
  5768     02  eibrsrce         pic x(8).
  5769     02  eibsync          pic x(1).
  5770     02  eibfree          pic x(1).
  5771     02  eibrecv          pic x(1).
  5772     02  eibsend          pic x(1).
  5773     02  eibatt           pic x(1).
  5774     02  eibeoc           pic x(1).
  5775     02  eibfmh           pic x(1).
  5776     02  eibcompl         pic x(1).
  5777     02  eibsig           pic x(1).
  5778     02  eibconf          pic x(1).
  5779     02  eiberr           pic x(1).
  5780     02  eibrldbk         pic x(1).
  5781     02  eiberrcd         pic x(4).
  5782     02  eibsynrb         pic x(1).
  5783     02  eibnodat         pic x(1).
  5784     02  eibfiller5       pic x(2).
  5785     02  eibresp          pic 9(09) comp.
  5786     02  eibresp2         pic 9(09) comp.
  5787     02  dfheigdj         pic s9(4) comp.
  5788     02  dfheigdk         pic s9(4) comp.
  5789 01  DFHCOMMAREA                 PIC X(1300).
  5790*                                COPY ERCPNDB.
  5791******************************************************************
  5792*                                                                *
  5793*                                                                *
  5794*                            ERCPNDB.                            *
  5795*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5796*                            VMOD=2.025                          *
  5797*                                                                *
  5798*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5799*                                                                *
  5800******************************************************************
  5801*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5802*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5803******************************************************************
  5804*                                                                *
  5805*                                                                *
  5806*   FILE TYPE = VSAM,KSDS                                        *
  5807*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5808*                                                                *
  5809*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5810*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5811*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5812*                                                 RKP=13,LEN=36  *
  5813*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5814*                                      AND CHG-SEQ.)             *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 109
* EL6311.cbl
  5815*                                                RKP=49,LEN=11   *
  5816*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5817*                                      AND CHG-SEQ.)             *
  5818*                                                RKP=60,LEN=15   *
  5819*                                                                *
  5820*   LOG = NO                                                     *
  5821*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5822******************************************************************
  5823******************************************************************
  5824*                   C H A N G E   L O G
  5825*
  5826* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5827*-----------------------------------------------------------------
  5828*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5829* EFFECTIVE    NUMBER
  5830*-----------------------------------------------------------------
  5831* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5832* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5833* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5834* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5835* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5836* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5837* 032306                   PEMA  ADD BOW LOAN NUMBER
  5838* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5839* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5840* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5841* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5842* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5843* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5844* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5845* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5846* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  5847******************************************************************
  5848
  5849 01  PENDING-BUSINESS.
  5850     12  PB-RECORD-ID                     PIC XX.
  5851         88  VALID-PB-ID                        VALUE 'PB'.
  5852
  5853     12  PB-CONTROL-PRIMARY.
  5854         16  PB-COMPANY-CD                PIC X.
  5855         16  PB-ENTRY-BATCH               PIC X(6).
  5856         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5857         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5858
  5859     12  PB-CONTROL-BY-ACCOUNT.
  5860         16  PB-COMPANY-CD-A1             PIC X.
  5861         16  PB-CARRIER                   PIC X.
  5862         16  PB-GROUPING.
  5863             20  PB-GROUPING-PREFIX       PIC XXX.
  5864             20  PB-GROUPING-PRIME        PIC XXX.
  5865         16  PB-STATE                     PIC XX.
  5866         16  PB-ACCOUNT.
  5867             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5868             20  PB-ACCOUNT-PRIME         PIC X(6).
  5869         16  PB-CERT-EFF-DT               PIC XX.
  5870         16  PB-CERT-NO.
  5871             20  PB-CERT-PRIME            PIC X(10).
  5872             20  PB-CERT-SFX              PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 110
* EL6311.cbl
  5873         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5874
  5875         16  PB-RECORD-TYPE               PIC X.
  5876             88  PB-MAILING-DATA                VALUE '0'.
  5877             88  PB-ISSUE                       VALUE '1'.
  5878             88  PB-CANCELLATION                VALUE '2'.
  5879             88  PB-BATCH-TRAILER               VALUE '9'.
  5880
  5881     12  PB-CONTROL-BY-ORIG-BATCH.
  5882         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5883         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5884         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5885         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5886
  5887     12  PB-CONTROL-BY-CSR.
  5888         16  PB-CSR-COMPANY-CD            PIC X.
  5889         16  PB-CSR-ID                    PIC X(4).
  5890         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5891         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5892         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5893******************************************************************
  5894*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5895******************************************************************
  5896
  5897     12  PB-LAST-MAINT-DT                 PIC XX.
  5898     12  PB-LAST-MAINT-BY                 PIC X(4).
  5899     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5900
  5901     12  PB-RECORD-BODY                   PIC X(375).
  5902
  5903     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5904         16  PB-CERT-ORIGIN               PIC X.
  5905             88  CLASIC-CREATED-CERT         VALUE '1'.
  5906         16  PB-I-NAME.
  5907             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5908             20  PB-I-INSURED-FIRST-NAME.
  5909                 24  PB-I-INSURED-1ST-INIT PIC X.
  5910                 24  FILLER                PIC X(9).
  5911             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5912         16  PB-I-AGE                     PIC S99   COMP-3.
  5913         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5914         16  PB-I-BIRTHDAY                PIC XX.
  5915         16  PB-I-INSURED-SEX             PIC X.
  5916             88  PB-SEX-MALE     VALUE 'M'.
  5917             88  PB-SEX-FEMALE   VALUE 'F'.
  5918
  5919         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5920         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5921         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5922         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5923         16  PB-I-SKIP-CODE               PIC X.
  5924             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5925             88  PB-SKIP-JULY              VALUE '1'.
  5926             88  PB-SKIP-AUGUST            VALUE '2'.
  5927             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5928             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5929             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5930             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 111
* EL6311.cbl
  5931             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5932             88  PB-SKIP-JUNE              VALUE '8'.
  5933             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5934             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5935             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5936         16  PB-I-TERM-TYPE               PIC X.
  5937             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5938             88  PB-PAID-WEEKLY            VALUE 'W'.
  5939             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5940             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5941             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5942         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5943         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5944         16  PB-I-DATA-ENTRY-SW           PIC X.
  5945             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5946             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5947             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5948             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5949         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5950         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5951*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5952         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5953         16  FILLER                       PIC X.
  5954
  5955         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5956             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5957             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5958                                                   '90' THRU '99'.
  5959         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5960                                          PIC XX.
  5961         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5962         16  PB-I-AMOUNT-FINANCED REDEFINES
  5963                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  5964         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  5965         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  5966                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  5967         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5968         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5969         16  PB-I-CLP-AMOUNT REDEFINES
  5970                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5971         16  PB-I-LF-CALC-FLAG            PIC X.
  5972             88 PB-COMP-LF-PREM               VALUE '?'.
  5973         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5974         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5975         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5976         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5977         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5978         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5979         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5980         16  PB-I-LF-ABBR                 PIC XXX.
  5981         16  PB-I-LF-INPUT-CD             PIC XX.
  5982
  5983         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5984             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5985             88  PB-INVALID-AH               VALUE '  ' '00'
  5986                                                   '90' THRU '99'.
  5987         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5988         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 112
* EL6311.cbl
  5989         16  PB-I-AH-CALC-FLAG            PIC X.
  5990             88 PB-COMP-AH-PREM                  VALUE '?'.
  5991         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5992         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5993         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5994         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5995         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5996         16  PB-I-AH-ABBR                 PIC XXX.
  5997         16  PB-I-AH-INPUT-CD             PIC XXX.
  5998
  5999         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6000         16  PB-I-REIN-TABLE              PIC XXX.
  6001         16  PB-I-BUSINESS-TYPE           PIC 99.
  6002         16  PB-I-INDV-GRP-CD             PIC X.
  6003         16  PB-I-MORT-CODE.
  6004             20  PB-I-TABLE               PIC X.
  6005             20  PB-I-INTEREST            PIC XX.
  6006             20  PB-I-MORT-TYP            PIC X.
  6007         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6008         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6009         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6010         16  PB-I-INDV-GRP-OVRD           PIC X.
  6011         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6012         16  PB-I-SIG-SW                  PIC X.
  6013             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6014         16  PB-I-RATE-CLASS              PIC XX.
  6015         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6016         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6017         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6018         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6019         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6020         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6021         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6022         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6023         16  PB-I-OB-FLAG                 PIC X.
  6024             88  PB-I-OB                      VALUE 'B'.
  6025             88  PB-I-SUMMARY                 VALUE 'Z'.
  6026         16  PB-I-ENTRY-STATUS            PIC X.
  6027             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6028                                              'M' '5' '9' '2'.
  6029             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6030             88  PB-I-POLICY-PENDING          VALUE '2'.
  6031             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6032             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6033             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  6034             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6035             88  PB-I-REIN-ONLY               VALUE '9'.
  6036             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6037             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6038             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6039             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6040         16  PB-I-INT-CODE                PIC X.
  6041             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6042             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6043         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6044         16  PB-I-SOC-SEC-NO              PIC X(11).
  6045         16  PB-I-MEMBER-NO               PIC X(12).
  6046         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 113
* EL6311.cbl
  6047*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6048         16  PB-I-OLD-LOF                 PIC XXX.
  6049         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6050         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6051         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6052         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6053         16  PB-I-LIFE-INDICATOR          PIC X.
  6054             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6055         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6056         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6057                                          PIC S9(5)V99    COMP-3.
  6058         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6059             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6060             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6061         16  PB-I-1ST-PMT-DT              PIC XX.
  6062         16  PB-I-JOINT-INSURED.
  6063             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6064             20 PB-I-JOINT-FIRST-NAME.
  6065                24  PB-I-JOINT-FIRST-INIT PIC X.
  6066                24  FILLER                PIC X(9).
  6067             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6068*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6069         16  PB-I-BENEFICIARY-NAME.
  6070             20  PB-I-BANK-NUMBER         PIC X(10).
  6071             20  FILLER                   PIC X(15).
  6072         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6073         16  PB-I-REFERENCE               PIC X(12).
  6074         16  FILLER REDEFINES PB-I-REFERENCE.
  6075             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6076             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6077             20  PB-I-CLP-STATE           PIC XX.
  6078         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6079             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6080             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6081             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6082         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6083         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6084         16  PB-I-RESIDENT-STATE          PIC XX.
  6085         16  PB-I-RATE-CODE               PIC X(4).
  6086         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6087         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6088         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6089         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6090         16  PB-I-BANK-NOCHRGB            PIC 99.
  6091         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6092         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6093
  6094     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6095         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6096             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6097         16  PB-C-CANCEL-ORIGIN           PIC X.
  6098             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6099         16  PB-C-LF-CANCEL-DT            PIC XX.
  6100         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6101         16  PB-C-LF-CALC-REQ             PIC X.
  6102             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6103         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6104         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 114
* EL6311.cbl
  6105         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6106             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6107         16  PB-C-AH-CANCEL-DT            PIC XX.
  6108         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6109         16  PB-C-AH-CALC-REQ             PIC X.
  6110             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6111         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6112         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6113         16  PB-C-LAST-NAME               PIC X(15).
  6114         16  PB-C-REFUND-SW               PIC X.
  6115             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6116             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6117         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6118         16  PB-C-PAYEE-CODE              PIC X(6).
  6119         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6120         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6121         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6122         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6123         16  PB-C-REFERENCE               PIC X(12).
  6124         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6125         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6126         16  PB-C-POST-CARD-IND           PIC X.
  6127         16  PB-C-CANCEL-REASON           PIC X.
  6128         16  PB-C-REF-INTERFACE-SW        PIC X.
  6129         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6130         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6131         16  FILLER                       PIC X(01).
  6132*        16  FILLER                       PIC X(18).
  6133         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6134*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6135         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6136         16  PB-CANCELED-CERT-DATA.
  6137             20  PB-CI-INSURED-NAME.
  6138                 24  PB-CI-LAST-NAME      PIC X(15).
  6139                 24  PB-CI-INITIALS       PIC XX.
  6140             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6141             20  PB-CI-INSURED-SEX        PIC X.
  6142             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6143             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6144             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6145             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6146             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6147             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6148             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6149             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6150             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6151             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6152             20  PB-CI-RATE-CLASS         PIC XX.
  6153             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6154             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6155             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6156             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6157             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6158             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6159             20  PB-CI-LF-ABBR            PIC X(3).
  6160             20  PB-CI-AH-ABBR            PIC X(3).
  6161             20  PB-CI-OB-FLAG            PIC X.
  6162                 88  PB-CI-OB                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 115
* EL6311.cbl
  6163             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6164                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6165                                           'M' '4' '5' '9' '2'.
  6166                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6167                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6168                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6169                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6170                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6171                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6172                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6173                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6174                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6175                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6176                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6177                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6178                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6179             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6180                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6181                                           'M' '4' '5' '9' '2'.
  6182                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6183                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6184                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6185                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6186                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6187                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6188                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6189                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6190                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6191                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6192                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6193                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6194                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6195             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6196             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6197             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6198             20  PB-CI-MEMBER-NO          PIC X(12).
  6199             20  PB-CI-INT-CODE           PIC X.
  6200                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6201                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6202             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6203             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6204             20  PB-CI-COMP-EXCP-SW       PIC X.
  6205                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6206                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6207             20  PB-CI-ENTRY-STATUS       PIC X.
  6208             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6209             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6210             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6211             20  PB-CI-DEATH-DT           PIC XX.
  6212             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6213             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6214             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6215             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6216             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6217             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6218             20  PB-CI-ENTRY-DT              PIC XX.
  6219             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6220             20  PB-CI-LF-EXPIRE-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 116
* EL6311.cbl
  6221             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6222             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6223             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6224             20  PB-CI-OLD-LOF               PIC XXX.
  6225*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6226             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6227             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6228             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6229             20  PB-CI-INDV-GRP-CD           PIC X.
  6230             20  PB-CI-BENEFICIARY-NAME.
  6231                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6232                 24  FILLER                  PIC X(15).
  6233             20  PB-CI-NOTE-SW               PIC X.
  6234             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6235             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6236             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6237             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6238             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6239             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6240             20  PB-CI-FIRST-NAME            PIC X(10).
  6241             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6242
  6243         16  FILLER                       PIC X(13).
  6244*032306  16  FILLER                       PIC X(27).
  6245*        16  FILLER                       PIC X(46).
  6246
  6247     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6248         16  FILLER                       PIC X(10).
  6249         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6250         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6251         16  PB-M-INSURED-MID-INIT        PIC X.
  6252         16  PB-M-INSURED-AGE             PIC 99.
  6253         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6254         16  PB-M-INSURED-SEX             PIC X.
  6255         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6256         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6257         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6258         16  PB-M-INSURED-CITY-STATE.
  6259             20  PB-M-INSURED-CITY        PIC X(28).
  6260             20  PB-M-INSURED-STATE       PIC XX.
  6261         16  PB-M-INSURED-ZIP-CODE.
  6262             20  PB-M-INSURED-ZIP-PRIME.
  6263                 24  PB-M-INSURED-ZIP-1   PIC X.
  6264                     88  PB-M-CANADIAN-POST-CODE
  6265                                             VALUE 'A' THRU 'Z'.
  6266                 24  FILLER               PIC X(4).
  6267             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6268         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6269                                        PB-M-INSURED-ZIP-CODE.
  6270             20  PM-M-INS-CAN-POST1       PIC XXX.
  6271             20  PM-M-INS-CAN-POST2       PIC XXX.
  6272             20  FILLER                   PIC XXX.
  6273         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6274         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6275         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6276         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6277         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6278         16  PB-M-CRED-BENE-CITYST.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 117
* EL6311.cbl
  6279             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6280             20  PB-M-CRED-BENE-STATE     PIC XX.
  6281         16  FILLER                       PIC X(92).
  6282
  6283     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6284         16  FILLER                       PIC X(10).
  6285         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6286         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6287         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6288         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6289         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6290         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6291         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6292         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6293         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6294         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6295         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6296         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6297         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6298         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6299         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6300         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6301         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6302         16  PB-ACCOUNT-NAME              PIC X(30).
  6303         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6304         16  PB-REFERENCE                 PIC X(12).
  6305         16  PB-B-RECEIVED-DT             PIC XX.
  6306         16  FILLER                       PIC X(234).
  6307
  6308     12  PB-RECORD-STATUS.
  6309         16  PB-CREDIT-SELECT-DT          PIC XX.
  6310         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6311         16  PB-BILLED-DT                 PIC XX.
  6312         16  PB-BILLING-STATUS            PIC X.
  6313             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6314             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6315             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6316         16  PB-RECORD-BILL               PIC X.
  6317             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6318             88  PB-RECORD-RETURNED           VALUE 'R'.
  6319             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6320             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6321             88  PB-OVERRIDE-AH               VALUE 'A'.
  6322             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6323         16  PB-BATCH-ENTRY               PIC X.
  6324             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6325             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6326             88  PB-REISSUED-CERT             VALUE 'E'.
  6327             88  PB-CASH-CERT                 VALUE 'C'.
  6328             88  PB-MONTHLY-CERT              VALUE 'M'.
  6329             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6330             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6331             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6332         16  PB-FORCE-CODE                PIC X.
  6333             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6334             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6335             88  PB-CANCEL-FORCE              VALUE '8'.
  6336             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 118
* EL6311.cbl
  6337             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6338             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6339             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6340             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6341             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6342             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6343         16  PB-FATAL-FLAG                PIC X.
  6344             88  PB-FATAL-ERRORS              VALUE 'X'.
  6345         16  PB-FORCE-ER-CD               PIC X.
  6346             88  PB-FORCE-ERRORS              VALUE 'F'.
  6347             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6348         16  PB-WARN-ER-CD                PIC X.
  6349             88  PB-WARNING-ERRORS            VALUE 'W'.
  6350         16  FILLER                       PIC X.
  6351         16  PB-OUT-BAL-CD                PIC X.
  6352             88  PB-OUT-OF-BAL                VALUE 'O'.
  6353         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6354         16  PB-AH-OVERRIDE-L1            PIC X.
  6355         16  PB-INPUT-DT                  PIC XX.
  6356         16  PB-INPUT-BY                  PIC X(4).
  6357         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6358         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6359         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6360         16  PB-LF-EARNING-METHOD         PIC X.
  6361         16  PB-AH-EARNING-METHOD         PIC X.
  6362         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6363         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6364         16  PB-REIN-CD                   PIC XXX.
  6365         16  PB-LF-REFUND-TYPE            PIC X.
  6366         16  PB-AH-REFUND-TYPE            PIC X.
  6367         16  PB-ACCT-EFF-DT               PIC XX.
  6368         16  PB-ACCT-EXP-DT               PIC XX.
  6369         16  PB-COMPANY-ID                PIC X(3).
  6370         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6371         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6372         16  PB-SV-CARRIER                PIC X.
  6373         16  PB-SV-GROUPING               PIC X(6).
  6374         16  PB-SV-STATE                  PIC XX.
  6375         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6376         16  PB-GA-BILLING-INFO.
  6377             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6378                                          PIC XX.
  6379         16  PB-SV-REMIT-TO  REDEFINES
  6380             PB-GA-BILLING-INFO           PIC X(10).
  6381         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6382         16  PB-I-LOAN-OFFICER            PIC X(5).
  6383         16  PB-I-VIN                     PIC X(17).
  6384
  6385         16  FILLER                       PIC X(04).
  6386         16  IMNET-BYPASS-SW              PIC X.
  6387
  6388******************************************************************
  6389*                COMMON EDIT ERRORS                              *
  6390******************************************************************
  6391
  6392     12  PB-COMMON-ERRORS.
  6393         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6394                                           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 119
* EL6311.cbl
  6395
  6396******************************************************************
  6397*                                COPY ELCCERT.
  6398******************************************************************
  6399*                                                                *
  6400*                            ELCCERT.                            *
  6401*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6402*                            VMOD=2.013                          *
  6403*                                                                *
  6404*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6405*                                                                *
  6406*   FILE TYPE = VSAM,KSDS                                        *
  6407*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6408*                                                                *
  6409*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6410*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6411*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6412*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6413*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6414*                                                                *
  6415*   LOG = YES                                                    *
  6416*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6417******************************************************************
  6418*                   C H A N G E   L O G
  6419*
  6420* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6421*-----------------------------------------------------------------
  6422*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6423* EFFECTIVE    NUMBER
  6424*-----------------------------------------------------------------
  6425* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6426* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6427* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6428* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6429* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6430* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6431* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6432* 032612  CR2011110200001  PEMA  AHL CHANGES
  6433******************************************************************
  6434
  6435 01  CERTIFICATE-MASTER.
  6436     12  CM-RECORD-ID                      PIC XX.
  6437         88  VALID-CM-ID                      VALUE 'CM'.
  6438
  6439     12  CM-CONTROL-PRIMARY.
  6440         16  CM-COMPANY-CD                 PIC X.
  6441         16  CM-CARRIER                    PIC X.
  6442         16  CM-GROUPING.
  6443             20  CM-GROUPING-PREFIX        PIC X(3).
  6444             20  CM-GROUPING-PRIME         PIC X(3).
  6445         16  CM-STATE                      PIC XX.
  6446         16  CM-ACCOUNT.
  6447             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6448             20  CM-ACCOUNT-PRIME          PIC X(6).
  6449         16  CM-CERT-EFF-DT                PIC XX.
  6450         16  CM-CERT-NO.
  6451             20  CM-CERT-PRIME             PIC X(10).
  6452             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 120
* EL6311.cbl
  6453
  6454     12  CM-CONTROL-BY-NAME.
  6455         16  CM-COMPANY-CD-A1              PIC X.
  6456         16  CM-INSURED-LAST-NAME          PIC X(15).
  6457         16  CM-INSURED-INITIALS.
  6458             20  CM-INSURED-INITIAL1       PIC X.
  6459             20  CM-INSURED-INITIAL2       PIC X.
  6460
  6461     12  CM-CONTROL-BY-SSN.
  6462         16  CM-COMPANY-CD-A2              PIC X.
  6463         16  CM-SOC-SEC-NO.
  6464             20  CM-SSN-STATE              PIC XX.
  6465             20  CM-SSN-ACCOUNT            PIC X(6).
  6466             20  CM-SSN-LN3.
  6467                 25  CM-INSURED-INITIALS-A2.
  6468                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6469                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6470                 25 CM-PART-LAST-NAME-A2         PIC X.
  6471
  6472     12  CM-CONTROL-BY-CERT-NO.
  6473         16  CM-COMPANY-CD-A4              PIC X.
  6474         16  CM-CERT-NO-A4                 PIC X(11).
  6475
  6476     12  CM-CONTROL-BY-MEMB.
  6477         16  CM-COMPANY-CD-A5              PIC X.
  6478         16  CM-MEMBER-NO.
  6479             20  CM-MEMB-STATE             PIC XX.
  6480             20  CM-MEMB-ACCOUNT           PIC X(6).
  6481             20  CM-MEMB-LN4.
  6482                 25  CM-INSURED-INITIALS-A5.
  6483                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6484                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6485                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6486
  6487     12  CM-INSURED-PROFILE-DATA.
  6488         16  CM-INSURED-FIRST-NAME.
  6489             20  CM-INSURED-1ST-INIT       PIC X.
  6490             20  FILLER                    PIC X(9).
  6491         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6492         16  CM-INSURED-SEX                PIC X.
  6493             88  CM-SEX-MALE                  VALUE 'M'.
  6494             88  CM-SEX-FEMAL                 VALUE 'F'.
  6495         16  CM-INSURED-JOINT-AGE          PIC 99.
  6496         16  CM-JOINT-INSURED-NAME.
  6497             20  CM-JT-LAST-NAME           PIC X(15).
  6498             20  CM-JT-FIRST-NAME.
  6499                 24  CM-JT-1ST-INIT        PIC X.
  6500                 24  FILLER                PIC X(9).
  6501             20  CM-JT-INITIAL             PIC X.
  6502
  6503     12  CM-LIFE-DATA.
  6504         16  CM-LF-BENEFIT-CD              PIC XX.
  6505         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6506         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6507         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6508         16  CM-LF-DEV-CODE                PIC XXX.
  6509         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6510         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 121
* EL6311.cbl
  6511         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6512         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6513         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6514         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6515         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6516         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6517         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6518         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6519         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6520         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6521         16  cm-temp-epiq                  pic xx.
  6522             88  EPIQ-CLASS                  value 'EQ'.
  6523*        16  FILLER                        PIC XX.
  6524
  6525     12  CM-AH-DATA.
  6526         16  CM-AH-BENEFIT-CD              PIC XX.
  6527         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6528         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6529         16  CM-AH-DEV-CODE                PIC XXX.
  6530         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6531         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6532         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6533         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6534         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6535         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6536         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6537         16  CM-AH-PAID-THRU-DT            PIC XX.
  6538             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6539         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6540         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6541         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6542         16  FILLER                        PIC X.
  6543
  6544     12  CM-LOAN-INFORMATION.
  6545         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6546         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6547                                           PIC S9(5)V99  COMP-3.
  6548         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6549         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6550         16  CM-PAY-FREQUENCY              PIC S99.
  6551         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6552         16  CM-RATE-CLASS                 PIC XX.
  6553         16  CM-BENEFICIARY                PIC X(25).
  6554         16  CM-POLICY-FORM-NO             PIC X(12).
  6555         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6556         16  CM-LAST-ADD-ON-DT             PIC XX.
  6557         16  CM-DEDUCTIBLE-AMOUNTS.
  6558             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6559             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6560         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6561             20  CM-RESIDENT-STATE         PIC XX.
  6562             20  CM-RATE-CODE              PIC X(4).
  6563             20  FILLER                    PIC XX.
  6564         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6565             20  CM-LOAN-OFFICER           PIC X(5).
  6566             20  FILLER                    PIC XXX.
  6567         16  CM-CSR-CODE                   PIC XXX.
  6568         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 122
* EL6311.cbl
  6569             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6570         16  CM-POST-CARD-IND              PIC X.
  6571         16  CM-NH-INTERFACE-SW            PIC X.
  6572         16  CM-PREMIUM-TYPE               PIC X.
  6573             88  CM-SING-PRM                  VALUE '1'.
  6574             88  CM-O-B-COVERAGE              VALUE '2'.
  6575             88  CM-OPEN-END                  VALUE '3'.
  6576         16  CM-IND-GRP-TYPE               PIC X.
  6577             88  CM-INDIVIDUAL                VALUE 'I'.
  6578             88  CM-GROUP                     VALUE 'G'.
  6579         16  CM-SKIP-CODE                  PIC X.
  6580             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6581             88  SKIP-JULY                    VALUE '1'.
  6582             88  SKIP-AUGUST                  VALUE '2'.
  6583             88  SKIP-SEPTEMBER               VALUE '3'.
  6584             88  SKIP-JULY-AUG                VALUE '4'.
  6585             88  SKIP-AUG-SEPT                VALUE '5'.
  6586             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6587             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6588             88  SKIP-JUNE                    VALUE '8'.
  6589             88  SKIP-JUNE-JULY               VALUE '9'.
  6590             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6591             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6592         16  CM-PAYMENT-MODE               PIC X.
  6593             88  PAY-MONTHLY                  VALUE SPACE.
  6594             88  PAY-WEEKLY                   VALUE '1'.
  6595             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6596             88  PAY-BI-WEEKLY                VALUE '3'.
  6597             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6598         16  CM-LOAN-NUMBER                PIC X(8).
  6599         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6600         16  CM-OLD-LOF                    PIC XXX.
  6601*        16  CM-LOAN-OFFICER               PIC XXX.
  6602         16  CM-REIN-TABLE                 PIC XXX.
  6603         16  CM-SPECIAL-REIN-CODE          PIC X.
  6604         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6605         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6606         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6607
  6608     12  CM-STATUS-DATA.
  6609         16  CM-ENTRY-STATUS               PIC X.
  6610         16  CM-ENTRY-DT                   PIC XX.
  6611
  6612         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6613         16  CM-LF-CANCEL-DT               PIC XX.
  6614         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6615
  6616         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6617         16  CM-LF-DEATH-DT                PIC XX.
  6618         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6619
  6620         16  CM-LF-CURRENT-STATUS          PIC X.
  6621             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6622                                                'M' '4' '5' '9'.
  6623             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6624             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6625             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6626             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 123
* EL6311.cbl
  6627             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6628             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6629             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6630             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6631             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6632             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6633             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6634             88  CM-LF-DECLINED               VALUE 'D'.
  6635             88  CM-LF-VOIDED                 VALUE 'V'.
  6636
  6637         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6638         16  CM-AH-CANCEL-DT               PIC XX.
  6639         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6640
  6641         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6642         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6643         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6644
  6645         16  CM-AH-CURRENT-STATUS          PIC X.
  6646             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6647                                                'M' '4' '5' '9'.
  6648             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6649             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6650             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6651             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6652             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6653             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6654             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6655             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6656             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6657             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6658             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6659             88  CM-AH-DECLINED               VALUE 'D'.
  6660             88  CM-AH-VOIDED                 VALUE 'V'.
  6661
  6662         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6663             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6664             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6665             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6666         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6667
  6668         16  CM-ENTRY-BATCH                PIC X(6).
  6669         16  CM-LF-EXIT-BATCH              PIC X(6).
  6670         16  CM-AH-EXIT-BATCH              PIC X(6).
  6671         16  CM-LAST-MONTH-END             PIC XX.
  6672
  6673     12  CM-NOTE-SW                        PIC X.
  6674         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6675         88  CERT-NOTES-PRESENT               VALUE '1'.
  6676         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6677         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6678         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6679         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6680         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6681         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6682     12  CM-COMP-EXCP-SW                   PIC X.
  6683         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6684         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 124
* EL6311.cbl
  6685     12  CM-INSURED-ADDRESS-SW             PIC X.
  6686         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6687         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6688
  6689*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6690     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6691     12  FILLER                            PIC X.
  6692
  6693*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6694     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6695     12  FILLER                            PIC X.
  6696*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6697     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6698
  6699     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6700         88  CERT-ADDED-BATCH                 VALUE ' '.
  6701         88  CERT-ADDED-ONLINE                VALUE '1'.
  6702         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6703         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6704         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6705     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6706         88  CERT-AS-LOADED                   VALUE ' '.
  6707         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6708         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6709         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6710         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6711         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6712         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6713         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6714
  6715     12  CM-ACCOUNT-COMM-PCTS.
  6716         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6717         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6718
  6719     12  CM-USER-FIELD                     PIC X.
  6720     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6721     12  CM-CLP-STATE                      PIC XX.
  6722     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6723     12  CM-USER-RESERVED                  PIC XXX.
  6724     12  FILLER REDEFINES CM-USER-RESERVED.
  6725         16  CM-AH-CLASS-CD                PIC XX.
  6726         16  F                             PIC X.
  6727******************************************************************
  6728*                                COPY ERCNOTE.
  6729******************************************************************
  6730*                                                                *
  6731*                                                                *
  6732*                            ERCNOTE                             *
  6733*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6734*                            VMOD=2.003                          *
  6735*                                                                *
  6736*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6737*                                                                *
  6738*        FILE TYPE= VSAM,KSDS                                    *
  6739*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6740*                                                                *
  6741*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6742*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 125
* EL6311.cbl
  6743*        LOG = YES                                               *
  6744*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6745*                                                                *
  6746******************************************************************
  6747*                   C H A N G E   L O G
  6748*
  6749* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6750*-----------------------------------------------------------------
  6751*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6752* EFFECTIVE    NUMBER
  6753*-----------------------------------------------------------------
  6754* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6755*                                FILE WILL CONTAIN BILLING NOTES O
  6756******************************************************************
  6757
  6758 01  CERTIFICATE-NOTE.
  6759     12  CN-RECORD-ID                PIC  XX.
  6760         88  VALID-CN-ID                  VALUE 'CN'.
  6761
  6762     12  CN-CONTROL-PRIMARY.
  6763         16  CN-COMPANY-CD           PIC X.
  6764         16  CN-CARRIER              PIC X.
  6765         16  CN-GROUPING.
  6766             20 CN-GROUPING-PREFIX   PIC XXX.
  6767             20 CN-GROUPING-PRIME    PIC XXX.
  6768         16  CN-STATE                PIC XX.
  6769         16  CN-ACCOUNT.
  6770             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6771             20 CN-ACCOUNT-PRIME     PIC X(6).
  6772         16  CN-CERT-EFF-DT          PIC XX.
  6773         16  CN-CERT-NO.
  6774             20  CN-CERT-PRIME       PIC X(10).
  6775             20  CN-CERT-SFX         PIC X.
  6776
  6777     12  CN-BILLING-START-LINE-NO    PIC 99.
  6778     12  CN-BILLING-END-LINE-NO      PIC 99.
  6779
  6780     12  CN-LINES.
  6781         16  CN-LINE OCCURS 10       PIC X(77).
  6782
  6783     12  CN-LAST-MAINT-DT            PIC XX.
  6784     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6785     12  CN-LAST-MAINT-USER          PIC X(4).
  6786     12  FILLER                      PIC X(6).
  6787******************************************************************
  6788*                                COPY ERCPNDM.
  6789******************************************************************
  6790*                                                                *
  6791*                                                                *
  6792*                            ERCPNDM                             *
  6793*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6794*                            VMOD=2.003                          *
  6795*                                                                *
  6796*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6797*                                                                *
  6798*   FILE TYPE = VSAM,KSDS                                        *
  6799*   RECORD SIZE = 374   RECFORM = FIX                            *
  6800*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 126
* EL6311.cbl
  6801*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6802*   ALTERNATE PATH    = NOT USED                                 *
  6803*                                                                *
  6804*   LOG = YES                                                    *
  6805*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6806******************************************************************
  6807*                   C H A N G E   L O G
  6808*
  6809* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6810*-----------------------------------------------------------------
  6811*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6812* EFFECTIVE    NUMBER
  6813*-----------------------------------------------------------------
  6814* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6815* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6816* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6817******************************************************************
  6818
  6819 01  PENDING-MAILING-DATA.
  6820     12  PM-RECORD-ID                      PIC XX.
  6821         88  VALID-MA-ID                       VALUE 'PM'.
  6822
  6823     12  PM-CONTROL-PRIMARY.
  6824         16  PM-COMPANY-CD                 PIC X.
  6825         16  PM-ENTRY-BATCH                PIC X(6).
  6826         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6827         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6828
  6829     12  FILLER                            PIC X(14).
  6830
  6831     12  PM-ACCESS-CONTROL.
  6832         16  PM-SOURCE-SYSTEM              PIC XX.
  6833             88  PM-FROM-CREDIT                VALUE 'CR'.
  6834             88  PM-FROM-VSI                   VALUE 'VS'.
  6835             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6836             88  PM-FROM-OTHER                 VALUE 'OT'.
  6837         16  PM-RECORD-ADD-DT              PIC XX.
  6838         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6839         16  PM-LAST-MAINT-DT              PIC XX.
  6840         16  PM-LAST-MAINT-BY              PIC XXXX.
  6841         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6842
  6843     12  PM-PROFILE-INFO.
  6844         16  PM-QUALIFY-CODE-1             PIC XX.
  6845         16  PM-QUALIFY-CODE-2             PIC XX.
  6846         16  PM-QUALIFY-CODE-3             PIC XX.
  6847         16  PM-QUALIFY-CODE-4             PIC XX.
  6848         16  PM-QUALIFY-CODE-5             PIC XX.
  6849
  6850         16  PM-INSURED-LAST-NAME          PIC X(15).
  6851         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6852         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6853         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6854         16  PM-INSURED-BIRTH-DT           PIC XX.
  6855         16  PM-INSURED-SEX                PIC X.
  6856             88  PM-SEX-MALE                   VALUE 'M'.
  6857             88  PM-SEX-FEMALE                 VALUE 'F'.
  6858         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 127
* EL6311.cbl
  6859
  6860         16  PM-ADDRESS-CORRECTED          PIC X.
  6861         16  PM-JOINT-BIRTH-DT             PIC XX.
  6862*        16  FILLER                        PIC X(12).
  6863
  6864         16  PM-ADDRESS-LINE-1             PIC X(30).
  6865         16  PM-ADDRESS-LINE-2             PIC X(30).
  6866         16  PM-CITY-STATE.
  6867             20  PM-CITY                   PIC X(28).
  6868             20  PM-STATE                  PIC XX.
  6869         16  PM-ZIP.
  6870             20  PM-ZIP-CODE.
  6871                 24  PM-ZIP-1              PIC X.
  6872                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6873                 24  FILLER                PIC X(4).
  6874             20  PM-ZIP-PLUS4              PIC X(4).
  6875         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6876             20  PM-CAN-POST1              PIC XXX.
  6877             20  PM-CAN-POST2              PIC XXX.
  6878             20  FILLER                    PIC XXX.
  6879
  6880         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6881
  6882         16  FILLER                        PIC X(03).
  6883
  6884     12  PM-CRED-BENE-INFO.
  6885         16  PM-CRED-BENE-NAME             PIC X(25).
  6886         16  PM-CRED-BENE-ADDR             PIC X(30).
  6887         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6888         16  PM-CRED-BENE-CTYST.
  6889             20  PM-CRED-BENE-CITY         PIC X(28).
  6890             20  PM-CRED-BENE-STATE        PIC XX.
  6891         16  PM-CRED-BENE-ZIP.
  6892             20  PM-CB-ZIP-CODE.
  6893                 24  PM-CB-ZIP-1           PIC X.
  6894                     88  PM-CB-CANADIAN-POST-CODE
  6895                                  VALUE 'A' THRU 'Z'.
  6896                 24  FILLER                PIC X(4).
  6897             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6898         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6899             20  PM-CB-CAN-POST1           PIC XXX.
  6900             20  PM-CB-CAN-POST2           PIC XXX.
  6901             20  FILLER                    PIC XXX.
  6902     12  PM-POST-CARD-MAIL-DATA.
  6903         16  PM-MAIL-DATA OCCURS 7.
  6904             20  PM-MAIL-TYPE              PIC X.
  6905                 88  PM-12MO-MAILING           VALUE '1'.
  6906                 88  PM-EXP-MAILING            VALUE '2'.
  6907             20  PM-MAIL-STATUS            PIC X.
  6908                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6909                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6910                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6911             20  PM-MAIL-DATE              PIC XX.
  6912     12  FILLER                            PIC XX.
  6913     12  FILLER                            PIC X(12).
  6914*    12  FILLER                            PIC X(30).
  6915
  6916******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 128
* EL6311.cbl
  6917*                                COPY ERCMAIL.
  6918******************************************************************
  6919*                                                                *
  6920*                                                                *
  6921*                            ERCMAIL                             *
  6922*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6923*                            VMOD=2.003                          *
  6924*                                                                *
  6925*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6926*                                                                *
  6927*   FILE TYPE = VSAM,KSDS                                        *
  6928*   RECORD SIZE = 374   RECFORM = FIX                            *
  6929*                                                                *
  6930*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6931*   ALTERNATE PATH    = NOT USED                                 *
  6932*                                                                *
  6933*   LOG = YES                                                    *
  6934*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6935******************************************************************
  6936*                   C H A N G E   L O G
  6937*
  6938* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6939*-----------------------------------------------------------------
  6940*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6941* EFFECTIVE    NUMBER
  6942*-----------------------------------------------------------------
  6943* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6944* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6945* 111108                   PEMA  ADD CRED BENE ADDR2
  6946******************************************************************
  6947
  6948 01  MAILING-DATA.
  6949     12  MA-RECORD-ID                      PIC XX.
  6950         88  VALID-MA-ID                       VALUE 'MA'.
  6951
  6952     12  MA-CONTROL-PRIMARY.
  6953         16  MA-COMPANY-CD                 PIC X.
  6954         16  MA-CARRIER                    PIC X.
  6955         16  MA-GROUPING.
  6956             20  MA-GROUPING-PREFIX        PIC XXX.
  6957             20  MA-GROUPING-PRIME         PIC XXX.
  6958         16  MA-STATE                      PIC XX.
  6959         16  MA-ACCOUNT.
  6960             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6961             20  MA-ACCOUNT-PRIME          PIC X(6).
  6962         16  MA-CERT-EFF-DT                PIC XX.
  6963         16  MA-CERT-NO.
  6964             20  MA-CERT-PRIME             PIC X(10).
  6965             20  MA-CERT-SFX               PIC X.
  6966
  6967     12  FILLER                            PIC XX.
  6968
  6969     12  MA-ACCESS-CONTROL.
  6970         16  MA-SOURCE-SYSTEM              PIC XX.
  6971             88  MA-FROM-CREDIT                VALUE 'CR'.
  6972             88  MA-FROM-VSI                   VALUE 'VS'.
  6973             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6974             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 129
* EL6311.cbl
  6975         16  MA-RECORD-ADD-DT              PIC XX.
  6976         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6977         16  MA-LAST-MAINT-DT              PIC XX.
  6978         16  MA-LAST-MAINT-BY              PIC XXXX.
  6979         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6980
  6981     12  MA-PROFILE-INFO.
  6982         16  MA-QUALIFY-CODE-1             PIC XX.
  6983         16  MA-QUALIFY-CODE-2             PIC XX.
  6984         16  MA-QUALIFY-CODE-3             PIC XX.
  6985         16  MA-QUALIFY-CODE-4             PIC XX.
  6986         16  MA-QUALIFY-CODE-5             PIC XX.
  6987
  6988         16  MA-INSURED-LAST-NAME          PIC X(15).
  6989         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6990         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6991         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6992         16  MA-INSURED-BIRTH-DT           PIC XX.
  6993         16  MA-INSURED-SEX                PIC X.
  6994             88  MA-SEX-MALE                   VALUE 'M'.
  6995             88  MA-SEX-FEMALE                 VALUE 'F'.
  6996         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6997
  6998         16  MA-ADDRESS-CORRECTED          PIC X.
  6999         16  MA-JOINT-BIRTH-DT             PIC XX.
  7000*        16  FILLER                        PIC X(12).
  7001
  7002         16  MA-ADDRESS-LINE-1             PIC X(30).
  7003         16  MA-ADDRESS-LINE-2             PIC X(30).
  7004         16  MA-CITY-STATE.
  7005             20  MA-CITY                   PIC X(28).
  7006             20  MA-ADDR-STATE             PIC XX.
  7007         16  MA-ZIP.
  7008             20  MA-ZIP-CODE.
  7009                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7010                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7011                 24  FILLER                PIC X(4).
  7012             20  MA-ZIP-PLUS4              PIC X(4).
  7013         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7014             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7015             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7016             20  FILLER                    PIC X(3).
  7017
  7018         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7019
  7020         16  FILLER                        PIC XXX.
  7021*        16  FILLER                        PIC X(10).
  7022
  7023     12  MA-CRED-BENE-INFO.
  7024         16  MA-CRED-BENE-NAME                 PIC X(25).
  7025         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7026         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7027         16  MA-CRED-BENE-CTYST.
  7028             20  MA-CRED-BENE-CITY             PIC X(28).
  7029             20  MA-CRED-BENE-STATE            PIC XX.
  7030         16  MA-CRED-BENE-ZIP.
  7031             20  MA-CB-ZIP-CODE.
  7032                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 130
* EL6311.cbl
  7033                     88  MA-CB-CANADIAN-POST-CODE
  7034                                           VALUE 'A' THRU 'Z'.
  7035                 24  FILLER                    PIC X(4).
  7036             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7037         16  MA-CB-CANADIAN-POSTAL-CODE
  7038                            REDEFINES MA-CRED-BENE-ZIP.
  7039             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7040             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7041             20  FILLER                        PIC X(3).
  7042     12  MA-POST-CARD-MAIL-DATA.
  7043         16  MA-MAIL-DATA OCCURS 7.
  7044             20  MA-MAIL-TYPE              PIC X.
  7045                 88  MA-12MO-MAILING           VALUE '1'.
  7046                 88  MA-EXP-MAILING            VALUE '2'.
  7047             20  MA-MAIL-STATUS            PIC X.
  7048                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7049                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7050                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7051             20  MA-MAIL-DATE              PIC XX.
  7052     12  FILLER                            PIC XX.
  7053     12  FILLER                            PIC XX.
  7054*    12  FILLER                            PIC X(30).
  7055******************************************************************
  7056*                                COPY ERCRQST.
  7057******************************************************************
  7058*                                                                *
  7059*                                                                *
  7060*                            ERCRQST.                            *
  7061*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7062*                            VMOD=2.002                          *
  7063*                                                                *
  7064*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7065*                                                                *
  7066*   FILE TYPE = VSAM,KSDS                                        *
  7067*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7068*                                                                *
  7069*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7070*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7071*                                   ACCOUNT, REF, BATCH)         *
  7072*                                                RKP=9, LEN=38   *
  7073*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7074*                                   ACCOUNT, REF, BATCH)         *
  7075*                                                RKP=47, LEN=46  *
  7076*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7077*                                   BATCH)                       *
  7078*                                                RKP=93, LEN=24  *
  7079*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7080*                                   REF, BATCH)                  *
  7081*                                                RKP=117, LEN=35 *
  7082*   LOG = NO                                                     *
  7083*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7084******************************************************************
  7085
  7086 01  AR-REQUEST-RECORD.
  7087     12  RQ-RECORD-ID                     PIC XX.
  7088         88  VALID-RQ-ID                        VALUE 'RQ'.
  7089
  7090     12  RQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 131
* EL6311.cbl
  7091         16  RQ-COMPANY-CD                PIC X.
  7092         16  RQ-ENTRY-BATCH               PIC X(6).
  7093
  7094     12  RQ-CONTROL-BY-ACCT-REF.
  7095         16  RQ-COMPANY-CD-A1             PIC X.
  7096         16  RQ-CARRIER-A1                PIC X.
  7097         16  RQ-GROUPING-A1               PIC X(6).
  7098         16  RQ-STATE-A1                  PIC XX.
  7099         16  RQ-ACCOUNT-A1                PIC X(10).
  7100         16  RQ-REFERENCE-A1              PIC X(12).
  7101         16  RQ-BATCH-A1                  PIC X(6).
  7102
  7103     12  RQ-CONTROL-BY-FIN-RESP.
  7104         16  RQ-COMPANY-CD-A2             PIC X.
  7105         16  RQ-CARRIER-A2                PIC X.
  7106         16  RQ-GROUPING-A2               PIC X(6).
  7107         16  RQ-FIN-RESP-A2               PIC X(10).
  7108         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7109         16  RQ-REFERENCE-A2              PIC X(12).
  7110         16  RQ-BATCH-A2                  PIC X(6).
  7111
  7112     12  RQ-CONTROL-BY-ACCT-AGENT.
  7113         16  RQ-COMPANY-CD-A3             PIC X.
  7114         16  RQ-CARRIER-A3                PIC X.
  7115         16  RQ-GROUPING-A3               PIC X(6).
  7116         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7117         16  RQ-BATCH-A3                  PIC X(6).
  7118
  7119     12  RQ-CONTROL-BY-SUMMARY.
  7120         16  RQ-COMPANY-CD-A4             PIC X.
  7121         16  RQ-SUMMARY-CODE              PIC X(6).
  7122         16  RQ-ACCOUNT-A4                PIC X(10).
  7123         16  RQ-REFERENCE-A4              PIC X(12).
  7124         16  RQ-BATCH-A4                  PIC X(6).
  7125
  7126     12  RQ-REQUEST-METHOD                PIC X.
  7127         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7128         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7129         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7130         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7131     12  FILLER                           PIC X.
  7132     12  RQ-STATUS                        PIC X.
  7133         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7134         88  RQ-RESUBMIT                      VALUE 'R'.
  7135     12  RQ-PROCESSOR-ID                  PIC X(4).
  7136     12  RQ-ENTRY-DT                      PIC XX.
  7137     12  RQ-MO-END-DT                     PIC XX.
  7138     12  RQ-REQUEST-DT                    PIC XX.
  7139     12  RQ-STMT-DT                       PIC XX.
  7140     12  RQ-REVERSAL-DT                   PIC XX.
  7141     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7142     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7143
  7144     12  FILLER                           PIC X(27).
  7145
  7146******************************************************************
  7147
  7148*                                COPY ERCLOFC.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 132
* EL6311.cbl
  7149******************************************************************
  7150*                                                                *
  7151*                                                                *
  7152*                            ERCLOFC                             *
  7153*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7154*                            VMOD=2.003                          *
  7155*                                                                *
  7156*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7157*                                                                *
  7158*   FILE TYPE = VSAM,KSDS                                        *
  7159*   RECORD SIZE = 670   RECFORM = FIX                            *
  7160*                                                                *
  7161*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7162*                                                                *
  7163*   LOG = YES                                                    *
  7164*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7165*                                                                *
  7166******************************************************************
  7167
  7168 01  LOAN-OFFICER-MASTER.
  7169     12  LO-RECORD-ID                PIC XX.
  7170         88  VALID-LO-ID                VALUE 'LO'.
  7171
  7172     12  LO-CONTROL-PRIMARY.
  7173         16  LO-COMPANY-CD           PIC X.
  7174         16  LO-CARRIER              PIC X.
  7175         16  LO-GROUPING.
  7176             20  LO-GROUPING-PREFIX  PIC XXX.
  7177             20  LO-GROUPING-PRIME   PIC XXX.
  7178         16  LO-STATE                PIC XX.
  7179         16  LO-ACCOUNT.
  7180             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7181             20  LO-ACCOUNT-PRIME    PIC X(6).
  7182         16  LO-OFFICER-CODE         PIC X(5).
  7183
  7184     12  LO-OFFICER-NAME             PIC X(30).
  7185
  7186     12  LO-LAST-MAINT-DT            PIC XX.
  7187     12  LO-LAST-USER                PIC X(4).
  7188     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7189
  7190     12  LO-COMP-CONTROL             PIC X.
  7191             88  LO-SHOW-COMP           VALUE 'Y'.
  7192             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7193     12  LO-DETAIL-CONTROL           PIC X.
  7194             88  LO-PRINT-DETAIL        VALUE 'D'.
  7195             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7196
  7197     12  LO-SV-CARRIER               PIC X.
  7198     12  LO-SV-GROUPING              PIC X(6).
  7199     12  LO-SV-STATE                 PIC XX.
  7200
  7201     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7202     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7203
  7204     12  LO-OFFICER-INFO.
  7205         16  FILLER OCCURS 12 TIMES.
  7206             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 133
* EL6311.cbl
  7207             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7208             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7209             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7210             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7211             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7212             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7213             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7214     12  FILLER                      PIC X(198).
  7215******************************************************************
  7216*                                COPY ERCPYAJ.
  7217******************************************************************
  7218*                                                                *
  7219*                            ERCPYAJ                             *
  7220*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7221*                            VMOD=2.015                          *
  7222*                                                                *
  7223*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7224*                                                                *
  7225*                                                                *
  7226*   FILE TYPE = VSAM,KSDS                                        *
  7227*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7228*                                                                *
  7229*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7230*       ALTERNATE PATHS = NONE                                   *
  7231*                                                                *
  7232*   LOG = YES                                                    *
  7233*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7234******************************************************************
  7235******************************************************************
  7236*                   C H A N G E   L O G
  7237*
  7238* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7239*-----------------------------------------------------------------
  7240*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7241* EFFECTIVE    NUMBER
  7242*-----------------------------------------------------------------
  7243* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7244* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7245******************************************************************
  7246
  7247 01  PENDING-PAY-ADJ.
  7248     12  PY-RECORD-ID                     PIC XX.
  7249         88  VALID-PY-ID                        VALUE 'PY'.
  7250
  7251     12  PY-CONTROL-PRIMARY.
  7252         16  PY-COMPANY-CD                PIC X.
  7253         16  PY-CARRIER                   PIC X.
  7254         16  PY-GROUPING                  PIC X(6).
  7255         16  PY-FIN-RESP                  PIC X(10).
  7256         16  PY-ACCOUNT                   PIC X(10).
  7257         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7258                                          PIC X(10).
  7259         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7260         16  PY-RECORD-TYPE               PIC X.
  7261             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7262             88  PY-DEPOSIT                   VALUE 'D'.
  7263             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7264             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 134
* EL6311.cbl
  7265             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7266             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7267             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7268             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7269             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7270             88  PY-FICA-ENTRY                VALUE 'F'.
  7271             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7272             88  PY-POLICY-FEE                VALUE 'W'.
  7273             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7274
  7275     12  PY-PYMT-TYPE                     PIC X.
  7276             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7277             88  PY-REINS-PYMT                VALUE 'R'.
  7278             88  PY-EXP-PYMT                  VALUE 'E'.
  7279
  7280     12  PY-BIL-INV                       PIC X(6).
  7281     12  PY-REF-NO                        PIC X(12).
  7282
  7283     12  PY-LAST-MAINT-DT                 PIC XX.
  7284     12  PY-LAST-MAINT-BY                 PIC X(4).
  7285     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7286
  7287     12  PY-PYADJ-RECORD.
  7288         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7289         16  PY-ENTRY-COMMENT             PIC X(30).
  7290         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7291             20  PY-GL-ACCOUNT            PIC X(10).
  7292             20  PY-GL-STATE              PIC X(02).
  7293             20  PY-GL-CANC-SW            PIC X(01).
  7294                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7295                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7296             20  PY-GL-COMMENT            PIC X(10).
  7297             20  FILLER      REDEFINES PY-GL-COMMENT.
  7298                 24  PY-GL-CHECK-NO       PIC 9(06).
  7299                 24  FILLER               PIC X(04).
  7300             20  FILLER                   PIC X(07).
  7301         16  PY-SAVE-ACCOUNT              PIC X(10).
  7302         16  PY-SAVE-TYPE                 PIC X(01).
  7303
  7304         16  PY-LETTERS.
  7305             20  PY-LETTER OCCURS 3 TIMES
  7306                           INDEXED BY PY-LET-NDX
  7307                                          PIC X(04).
  7308
  7309         16  PY-ERCOMP-TYPE               PIC X.
  7310             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7311             88  PY-GA-TYPE                   VALUE 'G'.
  7312             88  PY-BANK-TYPE                 VALUE 'B'.
  7313         16  FILLER                       PIC X(05).
  7314
  7315     12  PY-RECORD-STATUS.
  7316         16  PY-CREDIT-SELECT-DT          PIC XX.
  7317         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7318         16  PY-BILLED-DATE               PIC XX.
  7319         16  PY-REPORTED-DT               PIC XX.
  7320         16  PY-PMT-APPLIED               PIC X.
  7321             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7322             88  PY-GA-PMT                    VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 135
* EL6311.cbl
  7323             88  PY-OVWRITE-PMT               VALUE 'O'.
  7324             88  PY-NON-AR-PMT                VALUE 'N'.
  7325         16  FILLER                       PIC X(5).
  7326         16  PY-INPUT-DT                  PIC XX.
  7327         16  PY-CHECK-NUMBER              PIC X(6).
  7328         16  PY-VOID-SW                   PIC X.
  7329             88  PY-CHECK-VOIDED              VALUE 'V'.
  7330         16  PY-CHECK-ORIGIN-SW           PIC X.
  7331             88  PY-BILLING-CHECK             VALUE 'B'.
  7332             88  PY-REFUND-CHECK              VALUE 'R'.
  7333             88  PY-GA-CHECK                  VALUE 'G'.
  7334             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7335             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7336         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7337         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7338         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7339         16  PY-BILL-FLAG                 PIC X.
  7340             88  PY-BILLED                    VALUE 'B'.
  7341         16  PY-AR-FLAG                   PIC X.
  7342             88  PY-AR-CYCLE                  VALUE 'C'.
  7343             88  PY-AR-MONTH-END              VALUE 'M'.
  7344         16  PY-AR-DATE                   PIC XX.
  7345
  7346     12  PY-GL-CODES.
  7347         16  PY-GL-DB                     PIC X(14).
  7348         16  PY-GL-CR                     PIC X(14).
  7349         16  PY-GL-FLAG                   PIC X.
  7350         16  PY-GL-DATE                   PIC XX.
  7351
  7352     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7353     12  FILLER                           PIC X(3).
  7354******************************************************************
  7355*                                COPY ERCCNOT.
  7356******************************************************************
  7357*                                                                *
  7358*                            ERCCNOT                             *
  7359*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7360*                            VMOD=2.003                          *
  7361*                                                                *
  7362*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7363*                                                                *
  7364*        FILE TYPE= VSAM,KSDS                                    *
  7365*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7366*                                                                *
  7367*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7368*                                                                *
  7369*        LOG = YES                                               *
  7370*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7371*                                                                *
  7372******************************************************************
  7373*                   C H A N G E   L O G
  7374*
  7375* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7376*-----------------------------------------------------------------
  7377*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7378* EFFECTIVE    NUMBER
  7379*-----------------------------------------------------------------
  7380* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 136
* EL6311.cbl
  7381******************************************************************
  7382
  7383 01  CERT-NOTE-FILE.
  7384     12  CZ-RECORD-ID                PIC  XX.
  7385         88  VALID-CZ-ID                  VALUE 'CZ'.
  7386
  7387     12  CZ-CONTROL-PRIMARY.
  7388         16  CZ-COMPANY-CD           PIC X.
  7389         16  CZ-CARRIER              PIC X.
  7390         16  CZ-GROUPING.
  7391             20 CZ-GROUPING-PREFIX   PIC XXX.
  7392             20 CZ-GROUPING-PRIME    PIC XXX.
  7393         16  CZ-STATE                PIC XX.
  7394         16  CZ-ACCOUNT.
  7395             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7396             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7397         16  CZ-CERT-EFF-DT          PIC XX.
  7398         16  CZ-CERT-NO.
  7399             20  CZ-CERT-PRIME       PIC X(10).
  7400             20  CZ-CERT-SFX         PIC X.
  7401         16  CZ-RECORD-TYPE          PIC X.
  7402             88  CERT-NOTE           VALUE '1'.
  7403             88  CLAIM-CERT-NOTE     VALUE '2'.
  7404         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7405
  7406     12  CZ-LAST-MAINT-DT            PIC XX.
  7407     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7408     12  CZ-LAST-MAINT-USER          PIC X(4).
  7409
  7410     12  CZ-NOTE-INFORMATION.
  7411         16  CZ-NOTE                 PIC X(63).
  7412         16  FILLER                  PIC X(39).
  7413******************************************************************
  7414*                                COPY ELCMSTR.
  7415******************************************************************
  7416*                                                                *
  7417*                            ELCMSTR.                            *
  7418*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7419*                            VMOD=2.012                          *
  7420*                                                                *
  7421*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7422*                                                                *
  7423*   FILE TYPE = VSAM,KSDS                                        *
  7424*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7425*                                                                *
  7426*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7427*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7428*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7429*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7430*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7431*                                                 RKP=75,LEN=21  *
  7432*                                                                *
  7433*   **** NOTE ****                                               *
  7434*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7435*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7436*                                                                *
  7437*   LOG = YES                                                    *
  7438*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 137
* EL6311.cbl
  7439******************************************************************
  7440*                   C H A N G E   L O G
  7441*
  7442* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7443*-----------------------------------------------------------------
  7444*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7445* EFFECTIVE    NUMBER
  7446*-----------------------------------------------------------------
  7447* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7448* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7449* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7450* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7451* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7452******************************************************************
  7453 01  CLAIM-MASTER.
  7454     12  CL-RECORD-ID                PIC XX.
  7455         88  VALID-CL-ID         VALUE 'CL'.
  7456
  7457     12  CL-CONTROL-PRIMARY.
  7458         16  CL-COMPANY-CD           PIC X.
  7459         16  CL-CARRIER              PIC X.
  7460         16  CL-CLAIM-NO             PIC X(7).
  7461         16  CL-CERT-NO.
  7462             20  CL-CERT-PRIME       PIC X(10).
  7463             20  CL-CERT-SFX         PIC X.
  7464
  7465     12  CL-CONTROL-BY-NAME.
  7466         16  CL-COMPANY-CD-A1        PIC X.
  7467         16  CL-INSURED-LAST-NAME    PIC X(15).
  7468         16  CL-INSURED-NAME.
  7469             20  CL-INSURED-1ST-NAME PIC X(12).
  7470             20  CL-INSURED-MID-INIT PIC X.
  7471
  7472     12  CL-CONTROL-BY-SSN.
  7473         16  CL-COMPANY-CD-A2        PIC X.
  7474         16  CL-SOC-SEC-NO.
  7475             20  CL-SSN-STATE        PIC XX.
  7476             20  CL-SSN-ACCOUNT      PIC X(6).
  7477             20  CL-SSN-LN3          PIC X(3).
  7478
  7479     12  CL-CONTROL-BY-CERT-NO.
  7480         16  CL-COMPANY-CD-A4        PIC X.
  7481         16  CL-CERT-NO-A4.
  7482             20  CL-CERT-A4-PRIME    PIC X(10).
  7483             20  CL-CERT-A4-SFX      PIC X.
  7484
  7485     12  CL-CONTROL-BY-CCN.
  7486         16  CL-COMPANY-CD-A5        PIC X.
  7487         16  CL-CCN-A5.
  7488             20  CL-CCN.
  7489                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7490                 24  CL-CCN-PRIME-A5 PIC X(12).
  7491             20  CL-CCN-FILLER-A5    PIC X(4).
  7492
  7493     12  CL-INSURED-PROFILE-DATA.
  7494         16  CL-INSURED-BIRTH-DT     PIC XX.
  7495         16  CL-INSURED-SEX-CD       PIC X.
  7496             88  INSURED-IS-MALE        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 138
* EL6311.cbl
  7497             88  INSURED-IS-FEMALE      VALUE 'F'.
  7498             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7499         16  CL-INSURED-OCC-CD       PIC X(6).
  7500         16  FILLER                  PIC X(5).
  7501
  7502     12  CL-PROCESSING-INFO.
  7503         16  CL-PROCESSOR-ID         PIC X(4).
  7504         16  CL-CLAIM-STATUS         PIC X.
  7505             88  CLAIM-IS-OPEN          VALUE 'O'.
  7506             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7507         16  CL-CLAIM-TYPE           PIC X.
  7508*            88  AH-CLAIM               VALUE 'A'.
  7509*            88  LIFE-CLAIM             VALUE 'L'.
  7510*            88  PROPERTY-CLAIM         VALUE 'P'.
  7511*            88  IUI-CLAIM              VALUE 'I'.
  7512*            88  GAP-CLAIM              VALUE 'G'.
  7513*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7514         16  CL-CLAIM-PREM-TYPE      PIC X.
  7515             88  SINGLE-PREMIUM         VALUE '1'.
  7516             88  O-B-COVERAGE           VALUE '2'.
  7517             88  OPEN-END-COVERAGE      VALUE '3'.
  7518         16  CL-INCURRED-DT          PIC XX.
  7519         16  CL-REPORTED-DT          PIC XX.
  7520         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7521         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7522         16  CL-LAST-PMT-DT          PIC XX.
  7523         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7524         16  CL-PAID-THRU-DT         PIC XX.
  7525         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7526         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7527         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7528         16  CL-PMT-CALC-METHOD      PIC X.
  7529             88  CL-360-DAY-YR          VALUE '1'.
  7530             88  CL-365-DAY-YR          VALUE '2'.
  7531             88  CL-FULL-MONTHS         VALUE '3'.
  7532         16  CL-CAUSE-CD             PIC X(6).
  7533
  7534         16  CL-PRIME-CERT-NO.
  7535             20  CL-PRIME-CERT-PRIME PIC X(10).
  7536             20  CL-PRIME-CERT-SFX   PIC X.
  7537
  7538         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7539             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7540             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7541
  7542         16  CL-MICROFILM-NO         PIC X(10).
  7543         16  FILLER REDEFINES CL-MICROFILM-NO.
  7544             20  CL-BENEFIT-PERIOD   PIC 99.
  7545             20  FILLER              PIC X(8).
  7546         16  CL-PROG-FORM-TYPE       PIC X.
  7547         16  CL-LAST-ADD-ON-DT       PIC XX.
  7548
  7549         16  CL-LAST-REOPEN-DT       PIC XX.
  7550         16  CL-LAST-CLOSE-DT        PIC XX.
  7551         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7552             88  FINAL-PAID             VALUE '1'.
  7553             88  CLAIM-DENIED           VALUE '2'.
  7554             88  AUTO-CLOSE             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 139
* EL6311.cbl
  7555             88  MANUAL-CLOSE           VALUE '4'.
  7556             88  BENEFITS-CHANGED       VALUE 'C'.
  7557             88  SETUP-ERRORS           VALUE 'E'.
  7558         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7559         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7560         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7561             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7562         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7563         16  FILLER                  PIC X.
  7564
  7565     12  CL-CERTIFICATE-DATA.
  7566         16  CL-CERT-ORIGIN          PIC X.
  7567             88  CERT-WAS-ONLINE        VALUE '1'.
  7568             88  CERT-WAS-CREATED       VALUE '2'.
  7569             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7570         16  CL-CERT-KEY-DATA.
  7571             20  CL-CERT-CARRIER     PIC X.
  7572             20  CL-CERT-GROUPING    PIC X(6).
  7573             20  CL-CERT-STATE       PIC XX.
  7574             20  CL-CERT-ACCOUNT.
  7575                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7576                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7577             20  CL-CERT-EFF-DT      PIC XX.
  7578
  7579     12  CL-STATUS-CONTROLS.
  7580         16  CL-PRIORITY-CD          PIC X.
  7581             88  CONFIDENTIAL-DATA      VALUE '8'.
  7582             88  HIGHEST-PRIORITY       VALUE '9'.
  7583         16  CL-SUPV-ATTN-CD         PIC X.
  7584             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7585             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7586         16  CL-PURGED-DT            PIC XX.
  7587         16  CL-RESTORED-DT          PIC XX.
  7588         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7589         16  CL-NEXT-RESEND-DT       PIC XX.
  7590         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7591         16  CL-CRITICAL-PERIOD      PIC 99.
  7592*        16  FILLER                  PIC XX.
  7593         16  CL-LAST-MAINT-DT        PIC XX.
  7594         16  CL-LAST-MAINT-USER      PIC X(4).
  7595         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7596         16  CL-LAST-MAINT-TYPE      PIC X.
  7597             88  CLAIM-SET-UP           VALUE ' '.
  7598             88  PAYMENT-MADE           VALUE '1'.
  7599             88  LETTER-SENT            VALUE '2'.
  7600             88  MASTER-WAS-ALTERED     VALUE '3'.
  7601             88  MASTER-WAS-RESTORED    VALUE '4'.
  7602             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7603             88  FILE-CONVERTED         VALUE '6'.
  7604             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7605             88  ERROR-CORRECTION       VALUE 'E'.
  7606         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7607         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7608         16  CL-BENEFICIARY          PIC X(10).
  7609         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7610         16  CL-DENIAL-TYPE          PIC X.
  7611             88  CL-TYPE-DENIAL          VALUE '1'.
  7612             88  CL-TYPE-RESCISSION      VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 140
* EL6311.cbl
  7613             88  CL-TYPE-REFORMATION     VALUE '3'.
  7614             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7615             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7616         16  filler                  pic x(5).
  7617*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7618*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7619*        16  CL-RTW-DT               PIC XX.
  7620
  7621     12  CL-TRAILER-CONTROLS.
  7622         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7623             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7624             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7625             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7626         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7627         16  FILLER                  PIC XX.
  7628         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7629         16  CL-ADDRESS-TRAILER-CNT.
  7630             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7631                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7632             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7633                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7634             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7635                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7636             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7637                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7638             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7639                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7640             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7641                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7642             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7643                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7644
  7645     12  CL-CV-REFERENCE-NO.
  7646         16  CL-CV-REFNO-PRIME       PIC X(18).
  7647         16  CL-CV-REFNO-SFX         PIC XX.
  7648
  7649     12  CL-FILE-LOCATION            PIC X(4).
  7650
  7651     12  CL-PROCESS-ERRORS.
  7652         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7653             88  NO-FATAL-ERRORS        VALUE ZERO.
  7654         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7655             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7656
  7657     12  CL-PRODUCT-CD               PIC X.
  7658
  7659     12  CL-CURRENT-KEY-DATA.
  7660         16  CL-CURRENT-CARRIER      PIC X.
  7661         16  CL-CURRENT-GROUPING     PIC X(6).
  7662         16  CL-CURRENT-STATE        PIC XX.
  7663         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7664
  7665     12  CL-ASSOCIATES               PIC X.
  7666         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7667         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7668         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7669         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7670
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 141
* EL6311.cbl
  7671     12  CL-ACTIVITY-CODE            PIC 99.
  7672     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7673     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7674
  7675     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7676     12  CL-LAG-REPORT-CODE          PIC 9.
  7677     12  CL-LOAN-TYPE                PIC XX.
  7678     12  CL-LEGAL-STATE              PIC XX.
  7679
  7680     12  CL-YESNOSW                  PIC X.
  7681     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7682         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7683         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7684         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7685     12  cl-insured-type             pic x.
  7686         88  cl-claim-on-primary         value 'P'.
  7687         88  cl-claim-on-co-borrower     value 'C'.
  7688     12  cl-benefit-expiration-dt    PIC XX.
  7689*                                COPY ERCENDT.
  7690******************************************************************
  7691*                                                                *
  7692*                                                                *
  7693*                            ERCENDT.                            *
  7694*                            VMOD=2.001                          *
  7695*                                                                *
  7696*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7697*                                                                *
  7698*   FILE TYPE = VSAM,KSDS                                        *
  7699*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7700*                                                                *
  7701*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7702*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7703*                                                                *
  7704*   LOG = NO                                                     *
  7705*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7706******************************************************************
  7707*-----------------------------------------------------------------
  7708*                   C H A N G E   L O G
  7709*
  7710* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7711*-----------------------------------------------------------------
  7712*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7713* EFFECTIVE    NUMBER
  7714*-----------------------------------------------------------------
  7715* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7716*                                WITH OPEN CLAIMS
  7717* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7718* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7719* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7720*-----------------------------------------------------------------
  7721 01  ENDORSEMENT-RECORD.
  7722     12  EN-RECORD-ID                PIC XX.
  7723         88  VALID-EN-ID                VALUE 'EN'.
  7724     12  EN-CONTROL-PRIMARY.
  7725         16  EN-COMPANY-CD           PIC X.
  7726         16  EN-CARRIER              PIC X.
  7727         16  EN-GROUPING             PIC X(6).
  7728         16  EN-STATE                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 142
* EL6311.cbl
  7729         16  EN-ACCOUNT              PIC X(10).
  7730         16  EN-CERT-EFF-DT          PIC XX.
  7731         16  EN-CERT-NO.
  7732             20  EN-CERT-PRIME       PIC X(10).
  7733             20  EN-CERT-SFX         PIC X.
  7734         16  EN-REC-TYPE             PIC X.
  7735             88  EN-ISSUE               VALUE 'I'.
  7736             88  EN-CANCELLATION        VALUE 'C'.
  7737         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7738     12  EN-CONTROL-BY-ARCH-NO.
  7739         16  EN-COMPANY-CD-A1              PIC X.
  7740         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7741     12  EN-LAST-MAINT-DT            PIC XX.
  7742     12  EN-LAST-MAINT-BY            PIC X(4).
  7743     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7744     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7745     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7746         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7747         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7748         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7749         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7750         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7751         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7752         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7753         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7754         16  EN-LF-ORIG-BENCD        PIC XX.
  7755         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7756         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7757         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7758         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7759         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7760         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7761*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7762         16  EN-ORIG-CRED-BENE       PIC X(25).
  7763         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7764         16  FILLER                  PIC X.
  7765         16  EN-AH-ORIG-BENCD        PIC XX.
  7766         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7767         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7768         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7769         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7770*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7771*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7772         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7773         16  F                       PIC X(09).
  7774         16  EN-AH-ORIG-CP           PIC 99.
  7775         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7776         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7777         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7778         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7779         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7780         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7781         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7782         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7783         16  EN-LF-NEW-BENCD         PIC XX.
  7784         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7785         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7786         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 143
* EL6311.cbl
  7787         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7788         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7789         16  EN-LF-NEW-EXP-DT        PIC XX.
  7790         16  EN-NEW-CRED-BENE        PIC X(25).
  7791         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7792         16  FILLER                  PIC X.
  7793         16  EN-AH-NEW-BENCD         PIC XX.
  7794         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7795         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7796         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7797         16  EN-AH-NEW-EXP-DT        PIC XX.
  7798*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7799*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7800*        16  F                       PIC X(12).
  7801         16  EN-AH-NEW-CP            PIC 99.
  7802         16  EN-SIG-SW               PIC X.
  7803         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7804         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7805         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7806         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7807         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7808         16  FILLER                  PIC X(33).
  7809     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7810         16  EN-LF-ORIG-REF-DT       PIC XX.
  7811         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7812         16  EN-AH-ORIG-REF-DT       PIC XX.
  7813         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7814         16  EN-LF-NEW-REF-DT        PIC XX.
  7815         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7816         16  EN-AH-NEW-REF-DT        PIC XX.
  7817         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7818         16  EN-FLAG-CERT            PIC X.
  7819         16  EN-INS-LAST-NAME        PIC X(15).
  7820         16  EN-INS-FIRST-NAME       PIC X(10).
  7821         16  EN-INS-MIDDLE-INIT      PIC X.
  7822         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7823         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7824         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7825         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7826         16  FILLER                  PIC X(262).
  7827     12  EN-MONEY-SW             PIC X.
  7828     12  EN-HEALTH-APP           PIC X.
  7829     12  EN-VOUCHER-SW           PIC X.
  7830     12  EN-PAYEE                PIC X(14).
  7831     12  EN-INPUT-DT             PIC XX.
  7832     12  EN-PROCESS-DT           PIC XX.
  7833     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7834     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7835     12  EN-REASON-CODES.
  7836         16  F OCCURS 12.
  7837             20  EN-REASON-CODE  PIC X(4).
  7838     12  EN-TEMPLATE-USED        PIC X(8).
  7839     12  EN-DOCU-TYPE            PIC X.
  7840         88  EN-VERI-DOCU          VALUE 'V'.
  7841         88  EN-GCE-DOCU           VALUE 'G'.
  7842         88  EN-CANC-DOCU          VALUE 'C'.
  7843     12  EN-COMMENTS1            PIC X(13).
  7844     12  EN-COMMENTS2            PIC X(70).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 144
* EL6311.cbl
  7845     12  EN-COMM-CHGBK           PIC X.
  7846         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7847         88  EN-CHG-ACCT           VALUE 'Y'.
  7848     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7849     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7850     12  EN-BATCH-NUMBER         PIC X(6).
  7851     12  EN-ACCT-SUMM            PIC X.
  7852     12  EN-CSO-SUMM             PIC X.
  7853     12  FILLER                  PIC X(13).
  7854******************************************************************
  7855*                                COPY ELCCRTT.
  7856******************************************************************
  7857*                                                                *
  7858*                            ELCCRTT.                            *
  7859*                                                                *
  7860*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7861*                                                                *
  7862*   FILE TYPE = VSAM,KSDS                                        *
  7863*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7864*                                                                *
  7865*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7866*                                                                *
  7867*   LOG = YES                                                    *
  7868*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7869******************************************************************
  7870*                   C H A N G E   L O G
  7871*
  7872* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7873*-----------------------------------------------------------------
  7874*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7875* EFFECTIVE    NUMBER
  7876*-----------------------------------------------------------------
  7877* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7878* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7879* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7880* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7881* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7882* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7883* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7884******************************************************************
  7885
  7886 01  CERTIFICATE-TRAILERS.
  7887     12  CS-RECORD-ID                      PIC XX.
  7888         88  VALID-CS-ID                      VALUE 'CS'.
  7889
  7890     12  CS-CONTROL-PRIMARY.
  7891         16  CS-COMPANY-CD                 PIC X.
  7892         16  CS-CARRIER                    PIC X.
  7893         16  CS-GROUPING                   PIC X(6).
  7894         16  CS-STATE                      PIC XX.
  7895         16  CS-ACCOUNT                    PIC X(10).
  7896         16  CS-CERT-EFF-DT                PIC XX.
  7897         16  CS-CERT-NO.
  7898             20  CS-CERT-PRIME             PIC X(10).
  7899             20  CS-CERT-SFX               PIC X.
  7900         16  CS-TRAILER-TYPE               PIC X.
  7901             88  COMM-TRLR           VALUE 'A'.
  7902             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 145
* EL6311.cbl
  7903             88  CERT-DATA-TRLR      VALUE 'C'.
  7904
  7905     12  CS-DATA-AREA                      PIC X(516).
  7906
  7907     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7908         16  CS-BANK-COMMISSION-AREA.
  7909             20  CS-BANK-COMMS       OCCURS 10.
  7910                 24  CS-AGT                PIC X(10).
  7911                 24  CS-COM-TYP            PIC X.
  7912                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7913                 24  CS-RECALC-LV-INDIC    PIC X.
  7914                 24  FILLER                PIC X(10).
  7915         16  FILLER                        PIC X(256).
  7916
  7917     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7918****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7919         16  CS-MB-CLAIM-DATA OCCURS 24.
  7920             20  CS-CLAIM-NO               PIC X(7).
  7921             20  CS-CLAIM-TYPE             PIC X.
  7922                 88  CS-AH-CLM               VALUE 'A'.
  7923                 88  CS-IU-CLM               VALUE 'I'.
  7924                 88  CS-GP-CLM               VALUE 'G'.
  7925                 88  CS-LF-CLM               VALUE 'L'.
  7926                 88  CS-PR-CLM               VALUE 'P'.
  7927                 88  CS-FL-CLM               VALUE 'F'.
  7928             20  CS-INSURED-TYPE           PIC X.
  7929                 88  CS-PRIM-INSURED          VALUE 'P'.
  7930                 88  CS-CO-BORROWER           VALUE 'C'.
  7931             20  CS-BENEFIT-PERIOD         PIC 99.
  7932             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7933             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7934             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7935         16  FILLER                        PIC X(12).
  7936     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7937         16  CS-VIN-NUMBER                 PIC X(17).
  7938         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7939         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7940         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7941         16  FILLER                        PIC X(496).
  7942*                                COPY ERCCHEK.
  7943******************************************************************
  7944*                                                                *
  7945*                                                                *
  7946*                            ERCCHEK                             *
  7947*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7948*                            VMOD=2.008                          *
  7949*                                                                *
  7950*   FILE DESCRIPTION = CHECK RECORDS                             *
  7951*                                                                *
  7952*   FILE TYPE = VSAM,KSDS                                        *
  7953*   RECORD SIZE = 600    RECFORM = FIXED                         *
  7954*                                                                *
  7955*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  7956*       ALTERNATE INDEX = NONE                                   *
  7957*                                                                *
  7958*   LOG = YES                                                    *
  7959*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7960******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 146
* EL6311.cbl
  7961*                   C H A N G E   L O G
  7962*
  7963* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7964*-----------------------------------------------------------------
  7965*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7966* EFFECTIVE    NUMBER
  7967*-----------------------------------------------------------------
  7968* 021414    2003053000001  PEMA  changes for auto chk request
  7969******************************************************************
  7970 01  CHECK-RECORDS.
  7971     12  CH-RECORD-ID                      PIC XX.
  7972         88  VALID-CH-ID                      VALUE 'CH'.
  7973
  7974     12  CH-CONTROL-PRIMARY.
  7975         16  CH-COMPANY-CD                 PIC X.
  7976         16  CH-CARRIER                    PIC X.
  7977         16  CH-GROUPING                   PIC X(6).
  7978         16  CH-STATE                      PIC XX.
  7979         16  CH-ACCOUNT                    PIC X(10).
  7980         16  CH-CERT-EFF-DT                PIC XX.
  7981         16  CH-CERT-NO.
  7982             20  CH-CERT-PRIME             PIC X(10).
  7983             20  CH-CERT-SFX               PIC X.
  7984         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  7985
  7986     12  CH-RECORDED-DT                    PIC XX.
  7987     12  CH-RECORDED-BY                    PIC X(4).
  7988     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  7989
  7990     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  7991     12  CH-CHECK-NO                       PIC X(7).
  7992     12  CH-REASON-FOR-CHECK               PIC X(25).
  7993     12  CH-CHECK-WRITTEN-DT               PIC XX.
  7994     12  FILLER                            PIC X.
  7995
  7996     12  CH-PAYEE-INFO.
  7997         16  CH-PAYEE-NAME-1               PIC X(30).
  7998         16  CH-PAYEE-NAME-2               PIC X(30).
  7999         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8000         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8001         16  CH-PAYEE-CITY-ST.
  8002             20  CH-PAYEE-CITY             PIC X(28).
  8003             20  CH-PAYEE-STATE            PIC XX.
  8004         16  CH-PAYEE-ZIP-CODE.
  8005             20  CH-PAYEE-ZIP.
  8006                 24  CH-ZIP-PRI-1ST        PIC X.
  8007                     88  CH-CANADIAN-POST-CODE
  8008                                           VALUES 'A' THRU 'Z'.
  8009                 24  FILLER                PIC X(4).
  8010             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8011         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8012             20  CH-CAN-POSTAL-1           PIC XXX.
  8013             20  CH-CAN-POSTAL-2           PIC XXX.
  8014             20  FILLER                    PIC XXX.
  8015
  8016     12  CH-CHECK-STUB-TEXT.
  8017         16  CH-STUB-LINE-1                PIC X(30).
  8018         16  CH-TEXT-LINE-1                PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 147
* EL6311.cbl
  8019         16  CH-TEXT-LINE-2                PIC X(50).
  8020         16  CH-TEXT-LINE-3                PIC X(40).
  8021     12  CH-RETURN-TO                      PIC X(30).
  8022
  8023     12  CH-COMPENSATION-CONTROL.
  8024         16  CH-COMP-CARRIER               PIC X.
  8025         16  CH-COMP-GROUPING              PIC X(6).
  8026         16  CH-COMP-FIN-RESP              PIC X(10).
  8027         16  CH-COMP-ACCOUNT               PIC X(10).
  8028
  8029     12  CH-CREDIT-SELECT-DT               PIC XX.
  8030     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8031     12  CH-PAYEE-CODE                     PIC X(6).
  8032
  8033     12  CH-VOID-DATA.
  8034         20  CH-VOID-DT                    PIC XX.
  8035         20  CH-VOID-BY                    PIC X(4).
  8036         20  CH-VOID-REASON                PIC X(25).
  8037
  8038     12  CH-APPROVAL-DATA.
  8039         20  CH-APPROVAL-DT                PIC XX.
  8040         20  CH-APPROVAL-STATUS            PIC X.
  8041             88  CH-IN-LIMBO                  VALUE ' '.
  8042             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8043             88  CH-APPROVED                  VALUE 'A'.
  8044             88  CH-DENIED                    VALUE 'D'.
  8045         20  CH-APPROVED-BY                PIC XXXX.
  8046     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8047             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8048     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8049
  8050     12  ch-released-dt                    pic xx.
  8051     12  ch-check-cashed-dt                pic xx.
  8052     12  FILLER                            PIC X.
  8053*    12  CH-CHECK-REFERENCE                PIC X(12).
  8054     12  CH-CHECK-ORIGIN-SW                PIC X.
  8055             88  CH-REFUND-CHECK              VALUE 'R'.
  8056             88  CH-MAINT-CHECK               VALUE 'M'.
  8057
  8058     12  CH-CANC-DT                        PIC XX.
  8059     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8060     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8061
  8062     12  CH-INSURED-NAME                   PIC X(28).
  8063
  8064     12  ch-released-by                    pic x(4).
  8065     12  ch-csr                            pic x(4).
  8066     12  ch-deduct-commission              pic x.
  8067         88  ch-deduct-comm                  value 'Y'.
  8068         88  ch-do-not-deduct-comm           value 'N'.
  8069
  8070     12  FILLER                            PIC X(11).
  8071*    12  CH-LETTER-TABLE.
  8072*        16  CH-LETTERS OCCURS 3 TIMES
  8073*                       INDEXED BY CH-LT-NDX
  8074*                                          PIC X(04).
  8075
  8076     12  FILLER                            PIC X(07).
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 148
* EL6311.cbl
  8077
  8078 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8079                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8080                          PENDING-MAILING-DATA MAILING-DATA
  8081                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8082                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8083                          CLAIM-MASTER ENDORSEMENT-RECORD
  8084                          CERTIFICATE-TRAILERS CHECK-RECORDS.
  8085 0000-DFHEXIT SECTION.
  8086     MOVE '9#                    $   ' TO DFHEIV0.
  8087     MOVE 'EL6311' TO DFHEIV1.
  8088     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8089
  8090     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8091     MOVE EIBTRMID               TO QID-TERM.
  8092     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8093     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8094     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8095     MOVE 2                      TO EMI-SWITCH2.
  8096
  8097     IF EIBCALEN = 0
  8098         GO TO 8800-UNAUTHORIZED-ACCESS.
  8099
  8100     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8101     MOVE '5'                   TO DC-OPTION-CODE.
  8102     PERFORM 9700-DATE-LINK.
  8103     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8104     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8105
  8106     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8107     MOVE SPACE                  TO DC-OPTION-CODE.
  8108     PERFORM 9700-DATE-LINK.
  8109     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8110     MOVE LOW-VALUES             TO EL631BI.
  8111
  8112
  8113* EXEC CICS HANDLE CONDITION
  8114*        PGMIDERR  (9600-PGMID-ERROR)
  8115*        ERROR     (9990-ABEND)
  8116*        INVREQ    (9990-ABEND)
  8117*        QIDERR    (0010-MAIN-LOGIC)
  8118*    END-EXEC.
  8119*    MOVE '"$L.8N                ! " #00008108' TO DFHEIV0
  8120     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8121     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8122     MOVE X'2220233030303038313038' TO DFHEIV0(25:11)
  8123     CALL 'kxdfhei1' USING DFHEIV0
  8124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8125
  8126
  8127     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8128         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8129             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8130             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8131             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8132             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8133             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8134             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 149
* EL6311.cbl
  8135             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8136             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8137
  8138             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8139                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8140
  8141             ELSE
  8142                 NEXT SENTENCE
  8143
  8144         ELSE
  8145             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8146             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8147             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8148             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8149             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8150             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8151             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8152             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8153             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8154             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8155             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8156             GO TO 3900-RE-DISPLAY-RECORD
  8157     ELSE
  8158         GO TO 0020-MAIN-LOGIC.
  8159
  8160 0010-MAIN-LOGIC.
  8161     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8162                                    WS-FIRST-ENTRY-SW.
  8163
  8164     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8165
  8166     MOVE LOW-VALUES             TO EC-NEW-CERT
  8167                                    EC-NEW-STATE.
  8168
  8169     IF PI-DISPLAY-ORIGINAL-BATCH
  8170         NEXT SENTENCE
  8171     ELSE
  8172         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8173             GO TO 5000-BROWSE-BATCH-HEADERS.
  8174
  8175     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8176         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8177
  8178     IF PI-CSR-BROWSE
  8179        GO TO 4200-BROWSE-CSR-FORWARD.
  8180
  8181     IF PI-FILE-BROWSE
  8182         GO TO 4300-BROWSE-FILE-FORWARD.
  8183
  8184     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8185
  8186 0020-MAIN-LOGIC.
  8187     IF EIBAID = DFHCLEAR
  8188         GO TO 9400-CLEAR.
  8189
  8190     MOVE LOW-VALUES             TO EC-NEW-CERT
  8191                                    EC-NEW-STATE.
  8192
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 150
* EL6311.cbl
  8194
  8195******************************************************************
  8196*                                                                *
  8197*              R E C E I V E   M A P                             *
  8198*                                                                *
  8199******************************************************************
  8200
  8201 0200-RECEIVE.
  8202     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8203         MOVE ER-0008            TO EMI-ERROR
  8204         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8205         IF PI-MAP-NAME = EL631B
  8206             MOVE -1                 TO BMAINTL
  8207             GO TO 8200-SEND-DATAONLY
  8208         ELSE
  8209             IF PI-MAP-NAME = EL631C
  8210                 MOVE -1                 TO CMAINTL
  8211                 GO TO 8200-SEND-DATAONLY
  8212             ELSE
  8213                 IF PI-MAP-NAME = EL631D
  8214                     MOVE -1                 TO DPFENTRL
  8215                     GO TO 8200-SEND-DATAONLY.
  8216
  8217
  8218* EXEC CICS RECEIVE
  8219*        MAP      (PI-MAP-NAME)
  8220*        MAPSET   (MAPSET-EL6311S)
  8221*        INTO     (EL631BI)
  8222*    END-EXEC.
  8223     MOVE LENGTH OF
  8224      EL631BI
  8225       TO DFHEIV11
  8226*    MOVE '8"T I  L              ''   #00008205' TO DFHEIV0
  8227     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8228     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8229     MOVE X'2020233030303038323035' TO DFHEIV0(25:11)
  8230     CALL 'kxdfhei1' USING DFHEIV0,
  8231           PI-MAP-NAME,
  8232           EL631BI,
  8233           DFHEIV11,
  8234           MAPSET-EL6311S,
  8235           DFHEIV99,
  8236           DFHEIV99
  8237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8238
  8239
  8240******************************************************************
  8241*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8242******************************************************************
  8243
  8244     IF BTYPE-LEN (1) EQUAL +3
  8245        IF BTYPE (1) EQUAL ALL ' '
  8246            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8247
  8248     IF BTYPE-LEN (2) EQUAL +3
  8249        IF BTYPE (2) EQUAL ALL ' '
  8250            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8251
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 151
* EL6311.cbl
  8252     INSPECT EL631BI CONVERTING '_' TO ' '.
  8253
  8254     IF PI-MAP-NAME = EL631B
  8255         IF BPFENTRL GREATER THAN ZEROS
  8256             IF EIBAID NOT = DFHENTER
  8257                 MOVE ER-0004       TO EMI-ERROR
  8258                 MOVE -1            TO BPFENTRL
  8259                 MOVE AL-UNBOF      TO BPFENTRA
  8260                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8261                 GO TO 8200-SEND-DATAONLY
  8262             ELSE
  8263                 IF BPFENTRI NUMERIC AND
  8264                   (BPFENTRI GREATER 0 AND LESS 25)
  8265                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8266                 ELSE
  8267                     MOVE ER-0029  TO EMI-ERROR
  8268                     MOVE AL-UNBON TO BPFENTRA
  8269                     MOVE -1       TO BPFENTRL
  8270                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8271                     GO TO 8200-SEND-DATAONLY
  8272         ELSE
  8273             NEXT SENTENCE
  8274     ELSE
  8275         IF PI-MAP-NAME = EL631C
  8276            IF CPFENTRL GREATER THAN ZEROS
  8277                IF EIBAID NOT = DFHENTER
  8278                 MOVE ER-0004         TO EMI-ERROR
  8279                 MOVE -1              TO CPFENTRL
  8280                 MOVE AL-UNBOF        TO CPFENTRA
  8281                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8282                 GO TO 8200-SEND-DATAONLY
  8283             ELSE
  8284                 IF CPFENTRI NUMERIC AND
  8285                   (CPFENTRI GREATER 0 AND LESS 25)
  8286                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8287                 ELSE
  8288                     MOVE ER-0029      TO EMI-ERROR
  8289                     MOVE AL-UNBON     TO CPFENTRA
  8290                     MOVE -1           TO CPFENTRL
  8291                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8292                     GO TO 8200-SEND-DATAONLY
  8293         ELSE
  8294             NEXT SENTENCE
  8295     ELSE
  8296     IF PI-MAP-NAME = EL631D
  8297         IF DPFENTRL GREATER THAN ZEROS
  8298             IF EIBAID NOT = DFHENTER
  8299                 MOVE ER-0004         TO EMI-ERROR
  8300                 MOVE -1              TO DPFENTRL
  8301                 MOVE AL-UNBOF        TO DPFENTRA
  8302                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8303                 GO TO 8200-SEND-DATAONLY
  8304             ELSE
  8305                 IF DPFENTRI NUMERIC AND
  8306                   (DPFENTRI GREATER 0 AND LESS 25)
  8307                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8308                 ELSE
  8309                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 152
* EL6311.cbl
  8310                     MOVE AL-UNBON     TO DPFENTRA
  8311                     MOVE -1           TO DPFENTRL
  8312                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8313                     GO TO 8200-SEND-DATAONLY.
  8314
  8315     IF EIBAID = DFHPF23
  8316         GO TO 8810-PF23.
  8317
  8318     IF EIBAID = DFHPF24
  8319         GO TO 9200-RETURN-MAIN-MENU.
  8320
  8321     IF EIBAID = DFHPF12
  8322         GO TO 9500-PF12.
  8323
  8324     IF PI-MAP-NAME = EL631B
  8325        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8326
  8327     IF PI-MAP-NAME = EL631C
  8328        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8329
  8330     IF PI-MAP-NAME = EL631D
  8331        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8332
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 153
* EL6311.cbl
  8334
  8335******************************************************************
  8336*                                                                *
  8337*      ISSUE SCREEN PF KEY CHECKING                              *
  8338*                                                                *
  8339******************************************************************
  8340
  8341******************************************************************
  8342*                                                                *
  8343*      PF KEY FUNCTIONS:                                         *
  8344*                                                                *
  8345*      PF1  = BROWSE FORWARD                                     *
  8346*      PF2  = BROWSE BACKWARD                                    *
  8347*      PF3  = CERTIFICATE LOOKUP                                 *
  8348*      PF4  = DISPLAY BATCH HEADER                               *
  8349*      PF5  = ADD ISSUE  SCREEN                                  *
  8350*      PF6  = ADD CANCEL SCREEN                                  *
  8351*      PF7  = CERTIFICATE DISPLAY                                *
  8352*      PF8  = CERTIFICATE NOTES                                  *
  8353*      PF9  = EDIT CONTROL                                       *
  8354*      PF10 = DISPLAY LETTER SCREEN                              *
  8355*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8356*      PF12 = HELP SCREEN                                        *
  8357*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8358*      PF14 = ACCOUNT MASTER                                     *
  8359*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8360*      PF16 = DISPLAY LETTER REVIEW                              *
  8361*                                                                *
  8362******************************************************************
  8363
  8364 0300-CHECK-ISSUE-PF-KEYS.
  8365     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8366        MOVE ER-2337            TO EMI-ERROR
  8367        MOVE -1                  TO BMAINTL
  8368        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8369        GO TO 8200-SEND-DATAONLY.
  8370
  8371     IF EIBAID = DFHPF1
  8372        MOVE '0'                TO PI-EDIT-SW
  8373        IF PI-PRIMARY-BROWSE
  8374           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8375        ELSE
  8376           IF PI-PRIMARY-WITH-SELECT
  8377              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8378           ELSE
  8379              IF PI-FILE-BROWSE
  8380                 GO TO 4300-BROWSE-FILE-FORWARD
  8381              ELSE
  8382                 IF PI-CSR-BROWSE
  8383                    GO TO 4200-BROWSE-CSR-FORWARD
  8384                 ELSE
  8385                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8386
  8387     IF EIBAID = DFHPF2
  8388        MOVE '0'                TO PI-EDIT-SW
  8389        IF PI-PRIMARY-BROWSE
  8390           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8391        ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 154
* EL6311.cbl
  8392           IF PI-PRIMARY-WITH-SELECT
  8393              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8394           ELSE
  8395              IF PI-FILE-BROWSE
  8396                 GO TO 4800-BROWSE-FILE-BACKWARD
  8397              ELSE
  8398                 IF PI-CSR-BROWSE
  8399                    GO TO 4900-BROWSE-CSR-BACKWARD
  8400                 ELSE
  8401                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8402
  8403     IF EIBAID = DFHPF3
  8404        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8405        MOVE XCTL-EL127         TO PGM-NAME
  8406        GO TO 9300-XCTL.
  8407
  8408     IF (EIBAID = DFHPF15 OR DFHPF6)
  8409        AND (CSR-EDIT-SESSION)
  8410*       AND (FATAL-OR-UNFORCED)
  8411        AND (FATAL-ERRORS)
  8412        MOVE ER-1819             TO EMI-ERROR
  8413        MOVE -1                  TO BMAINTL
  8414        MOVE AL-UANON            TO BMAINTA
  8415        PERFORM 9900-ERROR-FORMAT
  8416                                 THRU 9900-EXIT
  8417        GO TO 8200-SEND-DATAONLY
  8418     END-IF
  8419     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8420      OR (EIBAID = DFHPF10)
  8421        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8422        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8423        IF (RESP-NORMAL)
  8424           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8425              AM-CONTROL-PRIMARY (1:20))
  8426            IF AM-NAME NOT GREATER THAN SPACES OR
  8427               AM-ADDRS NOT GREATER THAN SPACES  OR
  8428               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8429               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8430               AM-ZIP NOT GREATER THAN SPACES
  8431               MOVE ER-3834             TO EMI-ERROR
  8432               MOVE -1                  TO BMAINTL
  8433               MOVE AL-UANON            TO BMAINTA
  8434               PERFORM 9900-ERROR-FORMAT
  8435                                 THRU 9900-EXIT
  8436               GO TO 8200-SEND-DATAONLY
  8437            END-IF
  8438        ELSE
  8439           MOVE ER-1609             TO EMI-ERROR
  8440           MOVE -1                  TO BMAINTL
  8441           MOVE AL-UANON            TO BMAINTA
  8442           PERFORM 9900-ERROR-FORMAT
  8443                                THRU 9900-EXIT
  8444           GO TO 8200-SEND-DATAONLY
  8445        END-IF
  8446
  8447        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8448        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8449        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 155
* EL6311.cbl
  8450            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8451               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8452               MA-CITY NOT GREATER THAN SPACES OR
  8453               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8454               MA-ZIP-CODE NOT GREATER THAN SPACES
  8455               MOVE ER-3835             TO EMI-ERROR
  8456               MOVE -1                  TO BMAINTL
  8457               MOVE AL-UANON            TO BMAINTA
  8458               PERFORM 9900-ERROR-FORMAT
  8459                                 THRU 9900-EXIT
  8460               GO TO 8200-SEND-DATAONLY
  8461            END-IF
  8462        ELSE
  8463           MOVE ER-3000             TO EMI-ERROR
  8464           MOVE -1                  TO BMAINTL
  8465           MOVE AL-UANON            TO BMAINTA
  8466           PERFORM 9900-ERROR-FORMAT
  8467                                THRU 9900-EXIT
  8468           GO TO 8200-SEND-DATAONLY
  8469        END-IF
  8470
  8471     END-IF
  8472     IF (EIBAID = DFHPF15)
  8473        AND (CSR-EDIT-SESSION)
  8474        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8475        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8476        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8477        MOVE PI-SV-STATE         TO PI-STATE
  8478        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8479        MOVE BCERTNOI            TO PI-CERT-PRIME
  8480        MOVE BSUFIXI             TO PI-CERT-SFX
  8481        MOVE BEFFDTI             TO DEEDIT-FIELD
  8482        PERFORM 8600-DEEDIT
  8483        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8484        MOVE '4'                 TO DC-OPTION-CODE
  8485        PERFORM 9700-DATE-LINK
  8486        IF DATE-CONVERSION-ERROR
  8487           MOVE ER-0348          TO EMI-ERROR
  8488           MOVE -1               TO BEFFDTL
  8489           MOVE AL-UABON         TO BEFFDTA
  8490           PERFORM 9900-ERROR-FORMAT
  8491                                 THRU 9900-EXIT
  8492           GO TO 8200-SEND-DATAONLY
  8493        ELSE
  8494           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8495           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8496           MOVE XCTL-EL6315      TO PGM-NAME
  8497           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8498           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8499           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8500           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8501           GO TO 9300-XCTL
  8502        END-IF
  8503     END-IF
  8504
  8505     IF EIBAID = DFHPF4
  8506        MOVE '0'                TO PI-EDIT-SW
  8507        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 156
* EL6311.cbl
  8508           NEXT SENTENCE
  8509        ELSE
  8510           GO TO 7200-DISPLAY-BATCHES.
  8511
  8512     IF EIBAID = DFHPF5
  8513        MOVE ER-0029                TO EMI-ERROR
  8514        MOVE -1                     TO BPFENTRL
  8515        MOVE AL-UNBON               TO BPFENTRA
  8516        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8517        GO TO 8200-SEND-DATAONLY.
  8518*        MOVE '0'                TO PI-EDIT-SW
  8519*        IF PI-DISPLAY-ORIGINAL-BATCH
  8520*           NEXT SENTENCE
  8521*        ELSE
  8522*           MOVE EL631B              TO PI-MAP-NAME
  8523*           MOVE LOW-VALUES          TO EL631BI
  8524*           MOVE 'A'                 TO BMAINTO
  8525*           MOVE AL-UANON            TO BMAINTA
  8526*           MOVE -1                  TO BMAINTL
  8527*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8528*           GO TO 8100-SEND-INITIAL-MAP.
  8529
  8530     IF EIBAID = DFHPF6
  8531        IF NOT CSR-EDIT-SESSION
  8532           MOVE ER-0029                TO EMI-ERROR
  8533           MOVE -1                     TO BPFENTRL
  8534           MOVE AL-UNBON               TO BPFENTRA
  8535           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8536           GO TO 8200-SEND-DATAONLY
  8537*           MOVE '0'              TO PI-EDIT-SW
  8538*           IF PI-DISPLAY-ORIGINAL-BATCH
  8539*              NEXT SENTENCE
  8540*           ELSE
  8541*              MOVE EL631C        TO PI-MAP-NAME
  8542*              MOVE LOW-VALUES    TO EL631CI
  8543*              MOVE 'A'           TO CMAINTO
  8544*              MOVE AL-UANON      TO CMAINTA
  8545*              MOVE -1            TO CMAINTL
  8546*              MOVE '6'           TO PI-MAINT-FUNCTION
  8547*              GO TO 8100-SEND-INITIAL-MAP
  8548*           END-IF
  8549        ELSE
  8550           PERFORM 5100-PROCESS-POL-RESC
  8551                                 THRU 5100-EXIT
  8552           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8553           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8554                                    PI-PREV-SEQ-NO
  8555           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8556*                                    WS-CANCEL-LETTER-SW
  8557                                    PI-ALL-ISSUES-SW
  8558                                    PI-ALL-CANCELS-SW
  8559           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8560        END-IF
  8561     END-IF
  8562     IF EIBAID = DFHPF7
  8563        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8564        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8565        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 157
* EL6311.cbl
  8566        MOVE PI-SV-STATE            TO PI-STATE
  8567        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8568        MOVE BCERTNOI               TO PI-CERT-PRIME
  8569        MOVE BSUFIXI                TO PI-CERT-SFX
  8570        MOVE BEFFDTI                TO DEEDIT-FIELD
  8571        PERFORM 8600-DEEDIT
  8572        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8573        MOVE '4'                    TO DC-OPTION-CODE
  8574        PERFORM 9700-DATE-LINK
  8575        IF DATE-CONVERSION-ERROR
  8576           MOVE ER-0348            TO EMI-ERROR
  8577           MOVE -1                  TO BEFFDTL
  8578           MOVE AL-UABON            TO BEFFDTA
  8579           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8580           GO TO 8200-SEND-DATAONLY
  8581        ELSE
  8582           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8583           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8584           MOVE XCTL-EL1273        TO PGM-NAME
  8585           GO TO 9300-XCTL.
  8586
  8587     IF EIBAID = DFHPF8
  8588        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8589        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8590        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8591        MOVE PI-SV-STATE            TO PI-STATE
  8592        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8593        MOVE BCERTNOI               TO PI-CERT-PRIME
  8594        MOVE BSUFIXI                TO PI-CERT-SFX
  8595        MOVE BEFFDTI                TO DEEDIT-FIELD
  8596        PERFORM 8600-DEEDIT
  8597        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8598        MOVE '4'                    TO DC-OPTION-CODE
  8599        PERFORM 9700-DATE-LINK
  8600        IF DATE-CONVERSION-ERROR
  8601           MOVE ER-0348            TO EMI-ERROR
  8602           MOVE -1                  TO BEFFDTL
  8603           MOVE AL-UABON            TO BEFFDTA
  8604           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8605           GO TO 8200-SEND-DATAONLY
  8606        ELSE
  8607           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8608           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8609           IF PI-COMPANY-ID = 'DMD'
  8610               MOVE XCTL-EL401DMD      TO PGM-NAME
  8611             ELSE
  8612               MOVE XCTL-EL1279        TO PGM-NAME
  8613           END-IF
  8614           GO TO 9300-XCTL.
  8615
  8616     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8617        MOVE XCTL-EL6312         TO PGM-NAME
  8618
  8619* EXEC CICS XCTL
  8620*           PROGRAM   (PGM-NAME)
  8621*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8622*           LENGTH    (WS-COMM-LENGTH)
  8623*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 158
* EL6311.cbl
  8624*    MOVE '.$C                   %   #00008589' TO DFHEIV0
  8625     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8626     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8627     MOVE X'2020233030303038353839' TO DFHEIV0(25:11)
  8628     CALL 'kxdfhei1' USING DFHEIV0,
  8629           PGM-NAME,
  8630           PROGRAM-INTERFACE-BLOCK,
  8631           WS-COMM-LENGTH,
  8632           DFHEIV99
  8633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8634     ELSE
  8635        MOVE '0'                 TO  PI-EDIT-SW.
  8636
  8637     IF  EIBAID = DFHPF10
  8638         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8639         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8640         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8641                                    PI-1042-WA
  8642         MOVE 4                  TO PI-689-DATA-SOURCE
  8643         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8644         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8645         MOVE PI-SV-STATE        TO PI-689-STATE
  8646         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8647         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8648         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8649         MOVE PI-PB-ALT-CHG-SEQ-NO
  8650                                 TO PI-689-ALT-SEQ-NO
  8651         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8652         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8653         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8654         MOVE +0                 TO PI-689-CONTROL
  8655         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8656                                    PI-689-EXP-DATE
  8657                                    PI-689-RESP-PERSON
  8658                                    PI-689-TYPE
  8659                                    PI-689-FOLLOW-UP-EDIT
  8660                                    PI-689-RESEND1-EDIT
  8661                                    PI-689-SEQ-EDIT
  8662                                    PI-689-BCSEQ-EDIT
  8663                                    PI-689-LBL-OVERRIDE
  8664         MOVE W-LETTER-COMMUNICATION-AREAS
  8665                                 TO PI-PROGRAM-WORK-AREA
  8666         MOVE XCTL-EL689         TO PGM-NAME
  8667         GO TO 9300-XCTL.
  8668
  8669     IF  EIBAID = DFHPF16
  8670         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8671         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8672         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8673                                    PI-1042-WA
  8674         MOVE 4                  TO PI-689-DATA-SOURCE
  8675         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8676         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8677         MOVE PI-SV-STATE        TO PI-689-STATE
  8678         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8679         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8680         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8681         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 159
* EL6311.cbl
  8682                                 TO PI-689-ALT-SEQ-NO
  8683         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8684         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8685         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8686         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8687         MOVE W-LETTER-COMMUNICATION-AREAS
  8688                                 TO PI-PROGRAM-WORK-AREA
  8689         MOVE XCTL-EL690         TO PGM-NAME
  8690         GO TO 9300-XCTL.
  8691
  8692     IF EIBAID = DFHPF13
  8693         MOVE XCTL-EL6313        TO PGM-NAME
  8694         GO TO 9300-XCTL.
  8695
  8696     IF EIBAID = DFHPF17
  8697        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8698        IF (PB-I-LOAN-APR > ZEROS)
  8699           and (pb-i-loan-apr < 99.9999)
  8700           AND (PB-I-BENEFICIARY-NAME NOT
  8701              = SPACES AND LOW-VALUES)
  8702
  8703           MOVE LINK-ELVADS          TO PGM-NAME
  8704
  8705* EXEC CICS LINK
  8706*              PROGRAM    (PGM-NAME)
  8707*              COMMAREA   (WS-PASS-AREA)
  8708*              LENGTH     (WS-PASS-AREA-LENGTH)
  8709*          END-EXEC
  8710*    MOVE '."C                   (   #00008664' TO DFHEIV0
  8711     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8712     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8713     MOVE X'2020233030303038363634' TO DFHEIV0(25:11)
  8714     CALL 'kxdfhei1' USING DFHEIV0,
  8715           PGM-NAME,
  8716           WS-PASS-AREA,
  8717           WS-PASS-AREA-LENGTH,
  8718           DFHEIV99,
  8719           DFHEIV99,
  8720           DFHEIV99,
  8721           DFHEIV99
  8722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8723
  8724           MOVE 0000             TO EMI-ERROR
  8725           MOVE -1               TO BMAINTL
  8726           PERFORM 9900-ERROR-FORMAT
  8727                                 THRU 9900-EXIT
  8728           GO TO 8200-SEND-DATAONLY
  8729        ELSE
  8730           MOVE ER-0877            TO EMI-ERROR
  8731           MOVE -1                  TO BEFFDTL
  8732           MOVE AL-UABON            TO BEFFDTA
  8733           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8734           GO TO 8200-SEND-DATAONLY
  8735        END-IF
  8736     END-IF
  8737     IF EIBAID = DFHPF14
  8738        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8739        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 160
* EL6311.cbl
  8740        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8741        MOVE PI-SV-STATE            TO PI-CR-STATE
  8742        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8743        MOVE SPACE                  TO PI-EDIT-SW
  8744        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8745        MOVE XCTL-EL650             TO PGM-NAME
  8746        GO TO 9300-XCTL.
  8747
  8748     IF EIBAID = DFHPF15
  8749        IF PI-COMPANY-ID  =  'HER'
  8750            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8751            MOVE XCTL-EL680         TO PGM-NAME
  8752            GO TO 9300-XCTL.
  8753
  8754     IF EIBAID = DFHENTER OR DFHPF11
  8755        GO TO 1000-ISSUE-MAINLINE.
  8756
  8757     MOVE ER-0029                TO EMI-ERROR
  8758     MOVE -1                     TO BPFENTRL
  8759     MOVE AL-UNBON               TO BPFENTRA
  8760     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8761     GO TO 8200-SEND-DATAONLY.
  8762
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 161
* EL6311.cbl
  8764
  8765******************************************************************
  8766*                                                                *
  8767*      CANCEL SCREEN PF KEY CHECKING                             *
  8768*                                                                *
  8769******************************************************************
  8770
  8771******************************************************************
  8772*                                                                *
  8773*      PF KEY FUNCTIONS:                                         *
  8774*                                                                *
  8775*      PF1  = BROWSE FORWARD                                     *
  8776*      PF2  = BROWSE BACKWARD                                    *
  8777*      PF3  = CERTIFICATE LOOKUP                                 *
  8778*      PF4  = DISPLAY BATCH HEADER                               *
  8779*      PF5  = ADD ISSUE SCREEN                                   *
  8780*      PF6  = ADD CANCEL SCREEN                                  *
  8781*      PF7  = CERTIFICATE DISPLAY                                *
  8782*      PF8  = CERTIFICATE NOTES                                  *
  8783*      PF9  = EDIT CONTROL                                       *
  8784*      PF10 = DISPLAY LETTER SCREEN                              *
  8785*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8786*      PF12 = DISPLAY HELP SCREEN                                *
  8787*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8788*      PF14 = ACCOUNT MASTER                                     *
  8789*      PF16 = LETTER REVIEW                                      *
  8790*                                                                *
  8791******************************************************************
  8792
  8793 0400-CHECK-CANCEL-PF-KEYS.
  8794     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8795        MOVE ER-2337             TO EMI-ERROR
  8796        MOVE -1                  TO CMAINTL
  8797        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8798        GO TO 8200-SEND-DATAONLY.
  8799
  8800     IF EIBAID = DFHPF1
  8801        MOVE '0'                TO PI-EDIT-SW
  8802        IF PI-PRIMARY-BROWSE
  8803           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8804        ELSE
  8805           IF PI-PRIMARY-WITH-SELECT
  8806              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8807           ELSE
  8808              IF PI-FILE-BROWSE
  8809                 GO TO 4300-BROWSE-FILE-FORWARD
  8810              ELSE
  8811                 IF PI-CSR-BROWSE
  8812                    GO TO 4200-BROWSE-CSR-FORWARD
  8813                 ELSE
  8814                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8815
  8816     IF EIBAID = DFHPF2
  8817        MOVE '0'                TO PI-EDIT-SW
  8818        IF PI-PRIMARY-BROWSE
  8819           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8820        ELSE
  8821           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 162
* EL6311.cbl
  8822              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8823           ELSE
  8824              IF PI-FILE-BROWSE
  8825                 GO TO 4800-BROWSE-FILE-BACKWARD
  8826              ELSE
  8827                 IF PI-CSR-BROWSE
  8828                    GO TO 4900-BROWSE-CSR-BACKWARD
  8829                 ELSE
  8830                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8831
  8832     IF EIBAID = DFHPF3
  8833        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8834        MOVE XCTL-EL127         TO PGM-NAME
  8835        GO TO 9300-XCTL.
  8836
  8837     IF (EIBAID = DFHPF15 OR DFHPF17)
  8838        AND (CSR-EDIT-SESSION)
  8839*       AND (FATAL-OR-UNFORCED)
  8840        AND (FATAL-ERRORS)
  8841        MOVE ER-1819             TO EMI-ERROR
  8842        MOVE -1                  TO CMAINTL
  8843        MOVE AL-UANON            TO CMAINTA
  8844        PERFORM 9900-ERROR-FORMAT
  8845                                 THRU 9900-EXIT
  8846        GO TO 8200-SEND-DATAONLY
  8847     END-IF
  8848     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8849       AND (CSR-EDIT-SESSION)
  8850        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8851        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8852        IF (RESP-NORMAL)
  8853           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8854              AM-CONTROL-PRIMARY (1:20))
  8855            IF AM-NAME NOT GREATER THAN SPACES OR
  8856               AM-ADDRS NOT GREATER THAN SPACES  OR
  8857               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8858               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8859               AM-ZIP NOT GREATER THAN SPACES
  8860               MOVE ER-3834             TO EMI-ERROR
  8861               MOVE -1                  TO BMAINTL
  8862               MOVE AL-UANON            TO BMAINTA
  8863               PERFORM 9900-ERROR-FORMAT
  8864                                 THRU 9900-EXIT
  8865               GO TO 8200-SEND-DATAONLY
  8866            END-IF
  8867        ELSE
  8868           MOVE ER-1609             TO EMI-ERROR
  8869           MOVE -1                  TO BMAINTL
  8870           MOVE AL-UANON            TO BMAINTA
  8871           PERFORM 9900-ERROR-FORMAT
  8872                                THRU 9900-EXIT
  8873           GO TO 8200-SEND-DATAONLY
  8874        END-IF
  8875
  8876        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8877        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8878        IF (ERMAIL-FOUND)
  8879            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 163
* EL6311.cbl
  8880               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8881               MA-CITY NOT GREATER THAN SPACES OR
  8882               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8883               MA-ZIP-CODE NOT GREATER THAN SPACES
  8884               MOVE ER-3835             TO EMI-ERROR
  8885               MOVE -1                  TO BMAINTL
  8886               MOVE AL-UANON            TO BMAINTA
  8887               PERFORM 9900-ERROR-FORMAT
  8888                                 THRU 9900-EXIT
  8889               GO TO 8200-SEND-DATAONLY
  8890            END-IF
  8891        ELSE
  8892           MOVE ER-3000             TO EMI-ERROR
  8893           MOVE -1                  TO BMAINTL
  8894           MOVE AL-UANON            TO BMAINTA
  8895           PERFORM 9900-ERROR-FORMAT
  8896                                THRU 9900-EXIT
  8897           GO TO 8200-SEND-DATAONLY
  8898        END-IF
  8899
  8900     END-IF
  8901     IF (EIBAID = DFHPF15 OR DFHPF17)
  8902        AND (CSR-EDIT-SESSION)
  8903        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8904        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8905        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8906        MOVE PI-SV-STATE         TO PI-STATE
  8907        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8908        MOVE CCERTNOI            TO PI-CERT-PRIME
  8909        MOVE CSUFIXI             TO PI-CERT-SFX
  8910        MOVE CEFFDTI             TO DEEDIT-FIELD
  8911        PERFORM 8600-DEEDIT
  8912        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8913        MOVE '4'                 TO DC-OPTION-CODE
  8914        PERFORM 9700-DATE-LINK
  8915        IF DATE-CONVERSION-ERROR
  8916           MOVE ER-0348          TO EMI-ERROR
  8917           MOVE -1               TO CEFFDTL
  8918           MOVE AL-UABON         TO CEFFDTA
  8919           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8920           GO TO 8200-SEND-DATAONLY
  8921        ELSE
  8922           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8923           PERFORM 6000-CREATE-TEMP-STORAGE
  8924                                 THRU 6000-EXIT
  8925           IF EIBAID = DFHPF17
  8926               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  8927                                  THRU 6400-EXIT
  8928               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  8929                                 '2' AND '3' AND '4'
  8930                  MOVE ER-3831     TO  EMI-ERROR
  8931                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8932                  GO TO 8200-SEND-DATAONLY
  8933               END-IF
  8934               MOVE 'Y'          TO PI-CLM-RESC-IND
  8935           ELSE
  8936               MOVE 'N'          TO PI-CLM-RESC-IND
  8937           END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 164
* EL6311.cbl
  8938           MOVE XCTL-EL6316      TO PGM-NAME
  8939           MOVE '2'              TO PI-ISS-CAN-SW
  8940           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  8941           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8942           GO TO 9300-XCTL
  8943        END-IF
  8944     END-IF
  8945
  8946     IF EIBAID = DFHPF4
  8947        MOVE '0'                TO PI-EDIT-SW
  8948        IF PI-DISPLAY-ORIGINAL-BATCH
  8949           NEXT SENTENCE
  8950        ELSE
  8951           GO TO 7200-DISPLAY-BATCHES.
  8952
  8953     IF EIBAID = DFHPF5
  8954        MOVE ER-0029                TO EMI-ERROR
  8955        MOVE -1                     TO BPFENTRL
  8956        MOVE AL-UNBON               TO BPFENTRA
  8957        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8958        GO TO 8200-SEND-DATAONLY.
  8959*        MOVE '0'                TO PI-EDIT-SW
  8960*        IF PI-DISPLAY-ORIGINAL-BATCH
  8961*           NEXT SENTENCE
  8962*        ELSE
  8963*           MOVE EL631B              TO PI-MAP-NAME
  8964*           MOVE LOW-VALUES          TO EL631BI
  8965*           MOVE 'A'                 TO BMAINTO
  8966*           MOVE AL-UANON            TO BMAINTA
  8967*           MOVE -1                  TO BMAINTL
  8968*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8969*           GO TO 8100-SEND-INITIAL-MAP.
  8970
  8971     IF EIBAID = DFHPF6
  8972        MOVE ER-0029                TO EMI-ERROR
  8973        MOVE -1                     TO BPFENTRL
  8974        MOVE AL-UNBON               TO BPFENTRA
  8975        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8976        GO TO 8200-SEND-DATAONLY.
  8977*        MOVE '0'                TO PI-EDIT-SW
  8978*        IF PI-DISPLAY-ORIGINAL-BATCH
  8979*           NEXT SENTENCE
  8980*        ELSE
  8981*           MOVE EL631C              TO PI-MAP-NAME
  8982*           MOVE LOW-VALUES          TO EL631CI
  8983*           MOVE 'A'                 TO CMAINTO
  8984*           MOVE AL-UANON            TO CMAINTA
  8985*           MOVE -1                  TO CMAINTL
  8986*           MOVE '6'                 TO PI-MAINT-FUNCTION
  8987*           GO TO 8100-SEND-INITIAL-MAP.
  8988
  8989     IF EIBAID = DFHPF7
  8990        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8991        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8992        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8993        MOVE PI-SV-STATE            TO PI-STATE
  8994        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8995        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 165
* EL6311.cbl
  8996        MOVE CSUFIXI                TO PI-CERT-SFX
  8997        MOVE CEFFDTI                TO DEEDIT-FIELD
  8998        PERFORM 8600-DEEDIT
  8999        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9000        MOVE '4'                    TO DC-OPTION-CODE
  9001        PERFORM 9700-DATE-LINK
  9002        IF DATE-CONVERSION-ERROR
  9003           MOVE ER-0348            TO EMI-ERROR
  9004           MOVE -1                  TO BEFFDTL
  9005           MOVE AL-UABON            TO BEFFDTA
  9006           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9007           GO TO 8200-SEND-DATAONLY
  9008        ELSE
  9009           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9010           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9011           MOVE XCTL-EL1273        TO PGM-NAME
  9012           GO TO 9300-XCTL.
  9013
  9014     IF EIBAID = DFHPF8
  9015        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9016        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9017        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9018        MOVE PI-SV-STATE            TO PI-STATE
  9019        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9020        MOVE CCERTNOI               TO PI-CERT-PRIME
  9021        MOVE CSUFIXI                TO PI-CERT-SFX
  9022        MOVE CEFFDTI                TO DEEDIT-FIELD
  9023        PERFORM 8600-DEEDIT
  9024        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9025        MOVE '4'                    TO DC-OPTION-CODE
  9026        PERFORM 9700-DATE-LINK
  9027        IF DATE-CONVERSION-ERROR
  9028           MOVE ER-0348             TO EMI-ERROR
  9029           MOVE -1                  TO BEFFDTL
  9030           MOVE AL-UABON            TO BEFFDTA
  9031           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9032           GO TO 8200-SEND-DATAONLY
  9033        ELSE
  9034           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9035           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9036           IF PI-COMPANY-ID = 'DMD'
  9037               MOVE XCTL-EL401DMD      TO PGM-NAME
  9038             ELSE
  9039               MOVE XCTL-EL1279        TO PGM-NAME
  9040           END-IF
  9041           GO TO 9300-XCTL.
  9042
  9043     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9044        MOVE XCTL-EL6312     TO PGM-NAME
  9045
  9046* EXEC CICS XCTL
  9047*           PROGRAM  (PGM-NAME)
  9048*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9049*           LENGTH   (WS-COMM-LENGTH)
  9050*       END-EXEC
  9051*    MOVE '.$C                   %   #00008991' TO DFHEIV0
  9052     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9053     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 166
* EL6311.cbl
  9054     MOVE X'2020233030303038393931' TO DFHEIV0(25:11)
  9055     CALL 'kxdfhei1' USING DFHEIV0,
  9056           PGM-NAME,
  9057           PROGRAM-INTERFACE-BLOCK,
  9058           WS-COMM-LENGTH,
  9059           DFHEIV99
  9060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9061     ELSE
  9062        MOVE '0'                 TO  PI-EDIT-SW.
  9063
  9064     IF EIBAID = DFHPF10
  9065         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9066         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9067         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9068         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9069                                    PI-1042-WA
  9070         MOVE 4                  TO PI-689-DATA-SOURCE
  9071         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9072         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9073         MOVE PI-SV-STATE        TO PI-689-STATE
  9074         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9075         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9076         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9077         MOVE PI-PB-ALT-CHG-SEQ-NO
  9078                                 TO PI-689-ALT-SEQ-NO
  9079         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9080         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9081         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9082         MOVE +0                 TO PI-689-CONTROL
  9083         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9084                                    PI-689-EXP-DATE
  9085                                    PI-689-RESP-PERSON
  9086                                    PI-689-TYPE
  9087                                    PI-689-FOLLOW-UP-EDIT
  9088                                    PI-689-RESEND1-EDIT
  9089                                    PI-689-SEQ-EDIT
  9090                                    PI-689-BCSEQ-EDIT
  9091                                    PI-689-LBL-OVERRIDE
  9092         MOVE W-LETTER-COMMUNICATION-AREAS
  9093                                 TO PI-PROGRAM-WORK-AREA
  9094         MOVE XCTL-EL689         TO PGM-NAME
  9095         GO TO 9300-XCTL.
  9096
  9097     IF  EIBAID = DFHPF16
  9098         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9099         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9100         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9101                                    PI-1042-WA
  9102         MOVE 4                  TO PI-689-DATA-SOURCE
  9103         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9104         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9105         MOVE PI-SV-STATE        TO PI-689-STATE
  9106         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9107         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9108         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9109         MOVE PI-PB-ALT-CHG-SEQ-NO
  9110                                 TO PI-689-ALT-SEQ-NO
  9111         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 167
* EL6311.cbl
  9112         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9113         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9114         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9115         MOVE W-LETTER-COMMUNICATION-AREAS
  9116                                 TO PI-PROGRAM-WORK-AREA
  9117         MOVE XCTL-EL690         TO PGM-NAME
  9118         GO TO 9300-XCTL.
  9119     IF (EIBAID = DFHPF13)
  9120        if (not fatal-errors)
  9121           and (not unforced-errors)
  9122           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9123           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9124           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9125           MOVE PI-SV-STATE      TO PI-STATE
  9126           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9127           MOVE CCERTNOI         TO PI-CERT-PRIME
  9128           MOVE CSUFIXI          TO PI-CERT-SFX
  9129           MOVE CEFFDTI          TO DEEDIT-FIELD
  9130           PERFORM 8600-DEEDIT
  9131           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9132           MOVE '4'              TO DC-OPTION-CODE
  9133           PERFORM 9700-DATE-LINK
  9134           IF DATE-CONVERSION-ERROR
  9135              MOVE ER-0348       TO EMI-ERROR
  9136              MOVE -1            TO CEFFDTL
  9137              MOVE AL-UABON      TO CEFFDTA
  9138              PERFORM 9900-ERROR-FORMAT
  9139                                 THRU 9900-EXIT
  9140              GO TO 8200-SEND-DATAONLY
  9141           ELSE
  9142              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9143              MOVE AL-UANON      TO CEFFDTA
  9144              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9145              PERFORM 6000-CREATE-TEMP-STORAGE
  9146                                 THRU 6000-EXIT
  9147              MOVE XCTL-EL677    TO PGM-NAME
  9148              GO TO 9300-XCTL
  9149           end-if
  9150        else
  9151           MOVE ER-3444          TO EMI-ERROR
  9152           MOVE -1               TO CPFENTRL
  9153           MOVE AL-UNBON         TO CPFENTRA
  9154           PERFORM 9900-ERROR-FORMAT
  9155                                 THRU 9900-EXIT
  9156           GO TO 8200-SEND-DATAONLY
  9157        end-if
  9158     end-if
  9159
  9160     IF EIBAID = DFHPF14
  9161        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9162        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9163        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9164        MOVE PI-SV-STATE            TO PI-CR-STATE
  9165        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9166        MOVE SPACE                  TO PI-EDIT-SW
  9167        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9168        MOVE XCTL-EL650             TO PGM-NAME
  9169        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 168
* EL6311.cbl
  9170
  9171     IF EIBAID = DFHENTER OR DFHPF11
  9172        GO TO 2000-CANCEL-MAINLINE.
  9173
  9174     MOVE ER-0029                TO EMI-ERROR.
  9175     MOVE -1                     TO CPFENTRL.
  9176     MOVE AL-UNBON               TO CPFENTRA.
  9177     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9178     GO TO 8200-SEND-DATAONLY.
  9179
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 169
* EL6311.cbl
  9181
  9182******************************************************************
  9183*                                                                *
  9184*      BATCH SCREEN PF KEY CHECKING                              *
  9185*                                                                *
  9186******************************************************************
  9187
  9188******************************************************************
  9189*                                                                *
  9190*      PF KEY FUNCTIONS:                                         *
  9191*                                                                *
  9192*      PF1 = BROWSE FORWARD                                      *
  9193*      PF2 = BROWSE BACKWARD                                     *
  9194*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9195*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9196*                                                                *
  9197*                                                                *
  9198******************************************************************
  9199
  9200 0500-CHECK-BATCH-PF-KEYS.
  9201     IF EIBAID = DFHPF1
  9202        MOVE '0'                TO PI-EDIT-SW
  9203        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9204           GO TO 5000-BROWSE-BATCH-HEADERS
  9205        ELSE
  9206           IF PI-GOOD-BROWSE
  9207              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9208                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9209              ELSE
  9210                 IF PI-FILE-BROWSE
  9211                    GO TO 4300-BROWSE-FILE-FORWARD
  9212                 ELSE
  9213                    IF PI-CSR-BROWSE
  9214                       GO TO 4200-BROWSE-CSR-FORWARD
  9215                    ELSE
  9216                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9217           ELSE
  9218              GO TO 0800-BROWSE-ERROR.
  9219
  9220     IF EIBAID = DFHPF2
  9221        MOVE '0'                TO PI-EDIT-SW
  9222        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9223           GO TO 5500-BROWSE-BATCH-BACKWARD
  9224        ELSE
  9225           IF PI-GOOD-BROWSE
  9226              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9227                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9228              ELSE
  9229                 IF PI-FILE-BROWSE
  9230                    GO TO 4800-BROWSE-FILE-BACKWARD
  9231                 ELSE
  9232                    IF PI-CSR-BROWSE
  9233                       GO TO 4900-BROWSE-CSR-BACKWARD
  9234                    ELSE
  9235                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9236           ELSE
  9237              GO TO 0800-BROWSE-ERROR.
  9238
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 170
* EL6311.cbl
  9239     IF EIBAID = DFHPF3
  9240        GO TO 3000-BATCH-MAINLINE.
  9241
  9242     IF  EIBAID = DFHPF4
  9243        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9244        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9245        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9246        MOVE PI-SV-STATE            TO PI-CR-STATE
  9247        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9248                                       PI-CR-FIN-RESP
  9249        MOVE 'A'                    TO PI-CR-TYPE
  9250        MOVE SPACE                  TO PI-EDIT-SW
  9251        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9252        MOVE XCTL-EL640             TO PGM-NAME
  9253        GO TO 9300-XCTL.
  9254
  9255     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9256       AND
  9257        (EIBAID = DFHENTER)
  9258           GO TO 3500-EDIT-BATCH-DATA.
  9259
  9260     IF EIBAID = DFHENTER
  9261        GO TO 3500-EDIT-BATCH-DATA.
  9262
  9263     MOVE ER-0029             TO EMI-ERROR.
  9264     MOVE -1                  TO DPFENTRL.
  9265     MOVE AL-UNBON            TO DPFENTRA.
  9266     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9267     GO TO 8200-SEND-DATAONLY.
  9268
  9269 0800-BROWSE-ERROR.
  9270     MOVE ER-2258                TO EMI-ERROR.
  9271     MOVE -1                     TO DPFENTRL.
  9272     MOVE AL-UNBON               TO DPFENTRA.
  9273     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9274     GO TO 8200-SEND-DATAONLY.
  9275
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 171
* EL6311.cbl
  9277
  9278******************************************************************
  9279*                                                                *
  9280*                I S S U E   M A I N L I N E                     *
  9281*                                                                *
  9282******************************************************************
  9283
  9284 1000-ISSUE-MAINLINE.
  9285     IF PI-DISPLAY-ORIGINAL-BATCH
  9286        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9287           MOVE ER-0023             TO EMI-ERROR
  9288           MOVE -1                  TO BMAINTL
  9289           MOVE AL-UABON            TO BMAINTA
  9290           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9291           GO TO 8200-SEND-DATAONLY
  9292        ELSE
  9293           NEXT SENTENCE
  9294     ELSE
  9295        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9296           MOVE ER-0023             TO EMI-ERROR
  9297           MOVE -1                  TO BMAINTL
  9298           MOVE AL-UABON            TO BMAINTA
  9299           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9300           GO TO 8200-SEND-DATAONLY.
  9301
  9302     IF BMAINTI = 'S'
  9303        GO TO 1100-SHOW-REQUEST.
  9304
  9305     IF NOT MODIFY-CAP
  9306         MOVE 'UPDATE'       TO SM-READ
  9307         PERFORM 9995-SECURITY-VIOLATION
  9308         MOVE ER-0070        TO EMI-ERROR
  9309         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9310         GO TO 8100-SEND-INITIAL-MAP.
  9311
  9312     IF BMAINTL GREATER THAN ZEROS
  9313        IF PI-PF5-FUNCTION
  9314           IF BMAINTI NOT = 'A'
  9315              MOVE AL-UABON  TO BMAINTA
  9316              MOVE -1        TO BMAINTL
  9317              MOVE ER-2260   TO EMI-ERROR
  9318              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9319              GO TO 8200-SEND-DATAONLY.
  9320
  9321     IF BCERTNOL = ZEROS
  9322       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9323         NEXT SENTENCE
  9324     ELSE
  9325         IF BCERTNOL NOT = ZEROS
  9326             MOVE AL-UANON       TO BCERTNOA
  9327         ELSE
  9328             MOVE -1             TO BCERTNOL
  9329             MOVE  1             TO SET-CURSOR-SW
  9330             MOVE ER-2218        TO EMI-ERROR
  9331             MOVE AL-UABON       TO BCERTNOA
  9332             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9333
  9334     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 172
* EL6311.cbl
  9335         MOVE AL-UANON       TO BSUFIXA
  9336     ELSE
  9337         MOVE AL-SANOF       TO BSUFIXA.
  9338
  9339     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9340        NEXT SENTENCE
  9341     ELSE
  9342        IF BEFFDTL NOT = ZEROS
  9343           MOVE AL-UNNON             TO BEFFDTA
  9344           MOVE BEFFDTI              TO DEEDIT-FIELD
  9345           PERFORM 8600-DEEDIT
  9346           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9347           MOVE 4                    TO DC-OPTION-CODE
  9348           PERFORM 9700-DATE-LINK
  9349           IF NO-CONVERSION-ERROR
  9350              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9351              ELSE
  9352              MOVE -1                TO BEFFDTL
  9353              MOVE  1                TO SET-CURSOR-SW
  9354              MOVE ER-2226           TO EMI-ERROR
  9355              MOVE AL-UNBON          TO BEFFDTA
  9356              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9357           ELSE
  9358              MOVE -1                TO BEFFDTL
  9359              MOVE  1                TO SET-CURSOR-SW
  9360              MOVE ER-2220           TO EMI-ERROR
  9361              MOVE AL-UNBON          TO BEFFDTA
  9362              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9363
  9364     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9365
  9366     IF BCERTNOL NOT = ZEROS
  9367        MOVE BCERTNOI                TO WS-NEW-PRIME
  9368     ELSE
  9369        MOVE SPACES                  TO WS-NEW-PRIME.
  9370
  9371     IF BSUFIXL NOT = ZEROS
  9372        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9373     ELSE
  9374        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9375
  9376     IF BEFFDTL NOT = ZEROS
  9377        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9378     ELSE
  9379        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9380
  9381     IF BMAINTI = 'A' OR 'K' OR 'S'
  9382        NEXT SENTENCE
  9383     ELSE
  9384        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9385        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9386           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9387           WS-PB-RECORD-TYPE NOT = '1'
  9388           IF BMAINTI = 'C'
  9389               MOVE ER-2287          TO EMI-ERROR
  9390               MOVE -1               TO BCERTNOL
  9391               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9392               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 173
* EL6311.cbl
  9393               GO TO 8200-SEND-DATAONLY
  9394             ELSE
  9395               MOVE ER-2260          TO EMI-ERROR
  9396               MOVE -1               TO BCERTNOL
  9397               MOVE AL-UABON         TO BCERTNOA
  9398               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9399               GO TO 8200-SEND-DATAONLY.
  9400
  9401     IF BMAINTI = 'D'
  9402         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9403
  9404*    IF BMICRNOL  NOT =  ZEROS
  9405*        IF BMICRNOI  NUMERIC
  9406*            MOVE AL-UNNON       TO  BMICRNOA
  9407*        ELSE
  9408*            MOVE -1             TO  BMICRNOL
  9409*            MOVE 1              TO  SET-CURSOR-SW
  9410*            MOVE AL-UNBON       TO  BMICRNOA
  9411*            MOVE ER-2701        TO  EMI-ERROR
  9412*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9413     IF BVINL NOT = ZEROS
  9414        MOVE AL-UANON            TO BVINA
  9415     END-IF
  9416     IF B1STNML NOT = ZEROS
  9417         MOVE AL-UANON                TO B1STNMA.
  9418
  9419     IF BINITL  NOT = ZEROS
  9420        MOVE AL-UANON                TO BINITA.
  9421
  9422     IF BSEXL NOT = ZEROS
  9423        IF BSEXI = 'M' OR 'F'
  9424           MOVE AL-UANON             TO BSEXA
  9425        ELSE
  9426           MOVE -1               TO BSEXL
  9427           MOVE ER-2629          TO EMI-ERROR
  9428           MOVE AL-UABON         TO BSEXA
  9429           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9430
  9431     IF BAGEL NOT = ZEROS
  9432         IF BAGEI NUMERIC
  9433             MOVE BAGEI              TO WS-BAGE
  9434             MOVE AL-UNNON           TO BAGEA
  9435         ELSE
  9436             MOVE -1                 TO BAGEL
  9437             MOVE  1                 TO SET-CURSOR-SW
  9438             MOVE ER-2223            TO EMI-ERROR
  9439             MOVE AL-UNBON           TO BAGEA
  9440             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9441
  9442     IF BLSTNML NOT = ZERO  OR
  9443        B1STNML NOT = ZERO  OR
  9444        BINITL NOT = ZERO
  9445         IF BAGEL = ZEROS
  9446             MOVE -1                 TO BAGEL
  9447             MOVE  1                 TO SET-CURSOR-SW
  9448             MOVE ER-3269            TO EMI-ERROR
  9449             MOVE AL-UNBON           TO BAGEA
  9450             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 174
* EL6311.cbl
  9451         END-IF
  9452     END-IF.
  9453
  9454     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9455
  9456     IF (BBIRTHL GREATER THAN +0) AND
  9457        (BBIRTHI NOT EQUAL SPACES)
  9458        NEXT SENTENCE
  9459     ELSE
  9460        GO TO 1010-CHECK-AGE.
  9461
  9462     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9463     PERFORM 8600-DEEDIT.
  9464     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9465     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9466     MOVE AL-UNNON               TO BBIRTHA.
  9467     MOVE '4'                    TO DC-OPTION-CODE.
  9468     PERFORM 9700-DATE-LINK.
  9469     IF DATE-CONVERSION-ERROR
  9470        MOVE -1                  TO BBIRTHL
  9471        MOVE  1                  TO SET-CURSOR-SW
  9472        MOVE ER-2228             TO EMI-ERROR
  9473        MOVE AL-UNBON            TO BBIRTHA
  9474        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9475        GO TO 1010-CHECK-AGE.
  9476
  9477     IF (NO-CONVERSION-ERROR) AND
  9478        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9479        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9480        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9481        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9482                                    WS-CONVERTED-BIRTH
  9483        MOVE AL-UANON            TO BBIRTHA
  9484     ELSE
  9485        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9486        MOVE AL-UANON            TO BBIRTHA.
  9487
  9488 1010-CHECK-AGE.
  9489
  9490*    IF BAGEL = ZERO
  9491*       IF BBIRTHL GREATER THAN ZERO
  9492*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9493
  9494     IF B1STPMTL NOT = ZEROS
  9495        IF B1STPMTI = SPACES
  9496           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9497        ELSE
  9498           MOVE B1STPMTI             TO DEEDIT-FIELD
  9499           PERFORM 8600-DEEDIT
  9500           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9501           MOVE AL-UNNON             TO B1STPMTA
  9502           MOVE 4                    TO DC-OPTION-CODE
  9503           PERFORM 9700-DATE-LINK
  9504           IF NO-CONVERSION-ERROR
  9505              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9506              MOVE AL-UANON          TO B1STPMTA
  9507           ELSE
  9508              MOVE -1                TO B1STPMTL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 175
* EL6311.cbl
  9509              MOVE  1                TO SET-CURSOR-SW
  9510              MOVE ER-2200           TO EMI-ERROR
  9511              MOVE AL-UNBON          TO B1STPMTA
  9512              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9513
  9514     IF BDAYSL NOT = ZEROS
  9515         IF BDAYSI NUMERIC
  9516             MOVE AL-UNNON           TO BDAYSA
  9517         ELSE
  9518             MOVE -1                 TO BDAYSL
  9519             MOVE ER-2530            TO EMI-ERROR
  9520             MOVE AL-UNBON           TO BDAYSA
  9521             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9522
  9523     IF BLNTRML NOT = ZEROS
  9524         IF BLNTRMI NUMERIC
  9525             MOVE AL-UNNON       TO BLNTRMA
  9526         ELSE
  9527             MOVE -1             TO BLNTRML
  9528             MOVE ER-2533        TO EMI-ERROR
  9529             MOVE AL-UNBON       TO BLNTRMA
  9530             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9531
  9532**   IF PI-COMPANY-ID = 'DMD'
  9533     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9534        NEXT SENTENCE
  9535     ELSE
  9536         IF BLNOFCRL NOT = ZEROS
  9537            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9538            IF LOAN-OFFICER-FOUND
  9539                MOVE AL-UANON        TO BLNOFCRA
  9540             ELSE
  9541                 MOVE SPACE          TO WS-LOAN-OFFICER
  9542                 MOVE -1             TO BLNOFCRL
  9543                 MOVE  1             TO SET-CURSOR-SW
  9544                 MOVE ER-3006        TO EMI-ERROR
  9545                 MOVE AL-UNBON       TO BLNOFCRA
  9546                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9547
  9548     IF BFREQL NOT = ZEROS
  9549         IF BFREQI NUMERIC
  9550             MOVE AL-UNNON       TO BFREQA
  9551         ELSE
  9552             MOVE -1             TO BFREQL
  9553             MOVE  1             TO SET-CURSOR-SW
  9554             MOVE ER-2223        TO EMI-ERROR
  9555             MOVE AL-UNBON       TO BFREQA
  9556             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9557
  9558     IF BMODEL NOT = ZEROS
  9559         MOVE BMODEI             TO WS-MODE-CODE
  9560                                    PI-BMODE
  9561         IF WS-MODE-CODE-VALID
  9562             MOVE AL-UANON       TO BMODEA
  9563         ELSE
  9564             MOVE -1             TO BMODEL
  9565             MOVE ER-2591        TO EMI-ERROR
  9566             MOVE AL-UABON       TO BMODEA
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 176
* EL6311.cbl
  9567             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9568
  9569     IF BPMTSL NOT = ZEROS
  9570         IF BPMTSI NUMERIC
  9571             MOVE AL-UNNON           TO BPMTSA
  9572             MOVE BPMTSI             TO PI-BPMTS
  9573         ELSE
  9574             MOVE -1                 TO BPMTSL
  9575             MOVE ER-2592            TO EMI-ERROR
  9576             MOVE AL-UNBON           TO BPMTSA
  9577             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9578
  9579     IF BPMTAMTL NOT = ZEROS
  9580
  9581* EXEC CICS BIF DEEDIT
  9582*            FIELD  (BPMTAMTI)
  9583*            LENGTH (9)
  9584*       END-EXEC
  9585     MOVE 9
  9586       TO DFHEIV11
  9587*    MOVE '@"L                   #   #00009515' TO DFHEIV0
  9588     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9589     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9590     MOVE X'2020233030303039353135' TO DFHEIV0(25:11)
  9591     CALL 'kxdfhei1' USING DFHEIV0,
  9592           BPMTAMTI,
  9593           DFHEIV11
  9594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9595        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9596*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9597*        PERFORM 8600-DEEDIT
  9598*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9599
  9600*    IF BAPRL NOT = ZEROS
  9601*        EXEC CICS BIF DEEDIT
  9602*            FIELD  (BAPRI)
  9603*            LENGTH (7)
  9604*        END-EXEC
  9605*        MOVE BAPRI              TO WS-BAPR.
  9606
  9607     IF BAPRL > 0
  9608        MOVE +0                  TO  WS-BAPR
  9609        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9610           (WS-SUB > 7)
  9611           OR (BAPRI (WS-SUB:1) NUMERIC)
  9612           OR (BAPRI (WS-SUB:1) = '.')
  9613        END-PERFORM
  9614        IF WS-SUB > 7
  9615           MOVE ER-2471       TO EMI-ERROR
  9616           MOVE -1            TO BAPRL
  9617           MOVE AL-UNBON      TO BAPRA
  9618           PERFORM 9900-ERROR-FORMAT
  9619                                 THRU 9900-EXIT
  9620        ELSE
  9621           IF BAPRI (WS-SUB:1) NUMERIC
  9622              MOVE WS-SUB           TO WS-BEG
  9623              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9624                 (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 177
* EL6311.cbl
  9625                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9626              END-PERFORM
  9627              COMPUTE WS-END = WS-SUB - WS-BEG
  9628              MOVE BAPRI (WS-BEG:WS-END)
  9629                                 TO WS-APR-WHOLE-NUM
  9630           END-IF
  9631           IF BAPRI (WS-SUB:1) = '.'
  9632              COMPUTE WS-BEG = WS-SUB + 1
  9633              IF (WS-BEG < 8)
  9634                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9635                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9636                    (WS-SUB > 7)
  9637                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9638                 END-PERFORM
  9639                 COMPUTE WS-END = WS-SUB - WS-BEG
  9640                 MOVE BAPRI (WS-BEG:WS-END)
  9641                                 TO WS-APR-DEC (1:WS-END)
  9642              END-IF
  9643           END-IF
  9644           MOVE AL-UNNON      TO BAPRA
  9645           MOVE WS-BAPR       TO BAPRO
  9646        END-IF
  9647     END-IF
  9648*     IF BAPRL NOT = ZEROS
  9649*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9650*        PERFORM 8600-DEEDIT
  9651*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9652
  9653     IF BLIVESL NOT = ZEROS
  9654        MOVE BLIVESI             TO DEEDIT-FIELD
  9655        PERFORM 8600-DEEDIT
  9656        IF DEEDIT-FIELD-V0 NUMERIC
  9657           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9658           MOVE AL-UNNON         TO BLIVESA
  9659        ELSE
  9660           MOVE -1               TO BLIVESL
  9661           MOVE AL-UNBON         TO BLIVESA
  9662           MOVE ER-2223          TO EMI-ERROR
  9663           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9664
  9665*DMD CUSTOM CODING*************START
  9666*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9667     IF PI-COMPANY-ID NOT = 'DMD'
  9668         MOVE ZEROS               TO BBILLEDL
  9669         GO TO 1010-EDIT-CONT.
  9670
  9671     IF BBILLEDL NOT = ZEROS
  9672        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9673        MOVE 'Y'                 TO WS-NUMERIC-SW
  9674        MOVE +1                  TO WS-CSO-SUB
  9675        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9676        IF CSO-NUMERIC-FIELD
  9677
  9678* EXEC CICS BIF DEEDIT
  9679*              FIELD  (BBILLEDI)
  9680*              LENGTH (9)
  9681*          END-EXEC
  9682     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 178
* EL6311.cbl
  9683       TO DFHEIV11
  9684*    MOVE '@"L                   #   #00009601' TO DFHEIV0
  9685     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9686     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9687     MOVE X'2020233030303039363031' TO DFHEIV0(25:11)
  9688     CALL 'kxdfhei1' USING DFHEIV0,
  9689           BBILLEDI,
  9690           DFHEIV11
  9691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9692           MOVE BBILLEDI         TO WS-BILLED
  9693           MOVE AL-UNNON         TO BBILLEDA
  9694        ELSE
  9695           MOVE -1               TO BBILLEDL
  9696           MOVE AL-UNBON         TO BBILLEDA
  9697           MOVE ER-2547          TO EMI-ERROR
  9698           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9699     ELSE
  9700        IF BMAINTI EQUAL 'A'
  9701           MOVE -1               TO BBILLEDL
  9702           MOVE AL-UNBON         TO BBILLEDA
  9703           MOVE ER-8148          TO EMI-ERROR
  9704           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9705
  9706 1010-EDIT-CONT.
  9707
  9708     IF BFORCEL  NOT = ZEROS
  9709         IF FORCE-CAP
  9710            MOVE AL-UANON            TO BFORCEA
  9711         ELSE
  9712            MOVE ER-2945             TO EMI-ERROR
  9713            MOVE AL-UABON            TO BFORCEA
  9714            MOVE -1                  TO BFORCEL
  9715            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9716
  9717     IF BENTRYL NOT = ZEROS
  9718        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9719                 'C' and 'D' AND 'V' AND 'U' AND 'M'
  9720           MOVE ER-2224              TO EMI-ERROR
  9721           MOVE AL-UABON             TO BENTRYA
  9722           MOVE -1                   TO BENTRYL
  9723           MOVE  1                   TO SET-CURSOR-SW
  9724           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9725        ELSE
  9726           MOVE AL-UANON             TO BENTRYA.
  9727
  9728     IF BUNWRITL NOT = ZEROS
  9729        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9730           MOVE ER-7574              TO EMI-ERROR
  9731           MOVE AL-UABON             TO BUNWRITA
  9732           MOVE -1                   TO BUNWRITL
  9733           MOVE  1                   TO SET-CURSOR-SW
  9734           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9735        ELSE
  9736           MOVE AL-UANON             TO BUNWRITA.
  9737
  9738     IF BREINL  NOT = ZEROS
  9739         MOVE AL-UANON               TO BREINA.
  9740
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 179
* EL6311.cbl
  9741     IF BBILCDL NOT = ZEROS
  9742        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9743                             AND 'A' AND 'B' AND 'E'
  9744           MOVE ER-2225              TO EMI-ERROR
  9745           MOVE AL-UABON             TO BBILCDA
  9746           MOVE -1                   TO BBILCDL
  9747           MOVE  1                   TO SET-CURSOR-SW
  9748           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9749        ELSE
  9750           MOVE AL-UANON             TO BBILCDA.
  9751
  9752     IF BSKPCDL NOT = ZEROS
  9753         MOVE AL-UANON               TO BSKPCDA.
  9754
  9755     IF BINDGRPL NOT = ZEROS
  9756         MOVE AL-UANON               TO BINDGRPA.
  9757
  9758     IF BSIGL   NOT = ZEROS
  9759         MOVE AL-UANON               TO BSIGA.
  9760
  9761     IF BRTCLSL NOT = ZEROS
  9762         MOVE AL-UANON               TO BRTCLSA.
  9763
  9764     IF BMEMBERL NOT = ZEROS
  9765         MOVE AL-UANON               TO BMEMBERA.
  9766
  9767     MOVE +0                         TO WS-SUB1.
  9768
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 180
* EL6311.cbl
  9770
  9771******************************************************************
  9772*                                                                *
  9773*           E D I T   I S S U E   C O V E R A G E S              *
  9774*                                                                *
  9775******************************************************************
  9776
  9777 1020-EDIT-COVERAGES.
  9778     ADD +1                      TO WS-SUB1.
  9779
  9780     IF WS-SUB1 GREATER +2
  9781        GO TO 1025-EDIT-COMPLETE.
  9782
  9783     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9784       IF (BMODEL   GREATER ZERO  OR
  9785            BPMTSL   GREATER ZERO  OR
  9786            BPMTAMTL GREATER ZERO)
  9787          AND
  9788            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9789               GO TO 1021-CONT-EDIT.
  9790
  9791     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9792        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9793        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9794        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9795        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9796        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9797        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9798        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9799        NEXT SENTENCE
  9800         ELSE
  9801            GO TO 1020-EDIT-COVERAGES.
  9802
  9803 1021-CONT-EDIT.
  9804
  9805     IF BMAINTI = 'A'
  9806        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9807           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9808        ELSE
  9809           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9810           MOVE ER-7404          TO EMI-ERROR
  9811           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9812           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9813     ELSE
  9814        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9815           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9816
  9817     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9818        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9819        PERFORM 8600-DEEDIT
  9820        IF DEEDIT-FIELD-V0 NUMERIC
  9821           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9822        ELSE
  9823           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9824
  9825     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9826*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
  9827        IF BMODEL  GREATER THAN ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 181
* EL6311.cbl
  9828           BPMTSL  GREATER THAN ZEROS
  9829           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9830
  9831     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9832         IF BMODEL   GREATER THAN ZEROS  OR
  9833            BPMTSL   GREATER THAN ZEROS  OR
  9834            BPMTAMTL GREATER THAN ZEROS
  9835             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9836
  9837     IF BMAINTI = ('C' OR 'K')
  9838        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9839           NEXT SENTENCE
  9840        ELSE
  9841           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9842           PERFORM 8600-DEEDIT
  9843           IF DEEDIT-FIELD-V0 NUMERIC
  9844              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9845              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9846                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9847              ELSE
  9848                    MOVE ER-2241      TO EMI-ERROR
  9849                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9850                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9851                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9852           ELSE
  9853              MOVE ER-2223          TO EMI-ERROR
  9854              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9855              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9856              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9857     ELSE
  9858        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9859            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9860            PERFORM 8600-DEEDIT
  9861            IF DEEDIT-FIELD-V0      NUMERIC
  9862               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9863                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9864                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9865               ELSE
  9866                  MOVE ER-2241         TO EMI-ERROR
  9867                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9868                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9869                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9870            ELSE
  9871              MOVE ER-2223             TO EMI-ERROR
  9872              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9873              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9874              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9875        ELSE
  9876            MOVE ER-2240               TO EMI-ERROR
  9877            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9878            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9879*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9880*        IF BMODEL  GREATER THAN ZEROS  AND
  9881*           BPMTSL  GREATER THAN ZEROS
  9882*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9883
  9884     IF BBEN-LEN (WS-SUB1) = ZEROS
  9885        AND BMAINTI = ('C' OR 'K')
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 182
* EL6311.cbl
  9886           NEXT SENTENCE
  9887     ELSE
  9888        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9889           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9890
  9891* EXEC CICS BIF DEEDIT
  9892*              FIELD  (BBENI (WS-SUB1))
  9893*              LENGTH (12)
  9894*          END-EXEC
  9895     MOVE 12
  9896       TO DFHEIV11
  9897*    MOVE '@"L                   #   #00009803' TO DFHEIV0
  9898     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9899     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9900     MOVE X'2020233030303039383033' TO DFHEIV0(25:11)
  9901     CALL 'kxdfhei1' USING DFHEIV0,
  9902           BBENI(WS-SUB1),
  9903           DFHEIV11
  9904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9905           IF BBENI (WS-SUB1)  NUMERIC
  9906              IF BBENI (WS-SUB1) GREATER THAN ZEROS
  9907                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9908*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9909*          PERFORM 8600-DEEDIT
  9910*          IF DEEDIT-FIELD-V2  NUMERIC
  9911*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9912*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9913              ELSE
  9914                 MOVE ER-7632    TO EMI-ERROR
  9915                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9916                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9917                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9918           ELSE
  9919              MOVE ER-2223         TO EMI-ERROR
  9920              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  9921              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  9922              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9923        ELSE
  9924           MOVE ER-7632    TO EMI-ERROR
  9925           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9926           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9927           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9928
  9929     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
  9930        AND (BMAINTI = ('C' OR 'K'))
  9931        CONTINUE
  9932     ELSE
  9933        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  9934           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  9935           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
  9936              FOR ALL '.'
  9937           IF WS-TALLY > 1
  9938              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9939                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
  9940              END-PERFORM
  9941              IF A1 < 9
  9942                 ADD 3 TO A1
  9943                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 183
* EL6311.cbl
  9944              END-IF
  9945           ELSE
  9946              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9947                (A1 > 11)
  9948                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
  9949                  LOW-VALUES OR SPACES)
  9950              END-PERFORM
  9951              IF A1 > 1 AND < 12
  9952                 MOVE SPACES
  9953                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9954              END-IF
  9955           END-IF
  9956
  9957* EXEC CICS BIF DEEDIT
  9958*              FIELD  (BPREMI (WS-SUB1))
  9959*              LENGTH (11)
  9960*          END-EXEC
  9961     MOVE 11
  9962       TO DFHEIV11
  9963*    MOVE '@"L                   #   #00009858' TO DFHEIV0
  9964     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9965     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9966     MOVE X'2020233030303039383538' TO DFHEIV0(25:11)
  9967     CALL 'kxdfhei1' USING DFHEIV0,
  9968           BPREMI(WS-SUB1),
  9969           DFHEIV11
  9970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9971           IF BPREMI (WS-SUB1) NUMERIC
  9972              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
  9973                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
  9974*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  9975*          PERFORM 8600-DEEDIT
  9976*          IF DEEDIT-FIELD-V2  NUMERIC
  9977*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9978*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  9979              ELSE
  9980                 IF PI-COMPANY-ID NOT = 'DCC'
  9981                    MOVE ER-7633    TO EMI-ERROR
  9982                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
  9983                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  9984                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9985                 END-IF
  9986              END-IF
  9987           ELSE
  9988              MOVE ER-2223         TO EMI-ERROR
  9989              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9990              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9991              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9992           END-IF
  9993        ELSE
  9994           IF PI-COMPANY-ID NOT = 'DCC'
  9995              MOVE ER-7633         TO EMI-ERROR
  9996              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9997              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9998              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9999           END-IF
 10000        END-IF
 10001     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 184
* EL6311.cbl
 10002
 10003     IF BCPREM-LEN   (WS-SUB1) = ZEROS
 10004        NEXT SENTENCE
 10005     ELSE
 10006        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
 10007
 10008* EXEC CICS BIF DEEDIT
 10009*           FIELD  (BCPREMI (WS-SUB1))
 10010*           LENGTH (11)
 10011*       END-EXEC
 10012     MOVE 11
 10013       TO DFHEIV11
 10014*    MOVE '@"L                   #   #00009898' TO DFHEIV0
 10015     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10016     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10017     MOVE X'2020233030303039383938' TO DFHEIV0(25:11)
 10018     CALL 'kxdfhei1' USING DFHEIV0,
 10019           BCPREMI(WS-SUB1),
 10020           DFHEIV11
 10021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10022        IF BCPREMI (WS-SUB1) NUMERIC
 10023           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10024*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10025*       PERFORM 8600-DEEDIT
 10026*       IF DEEDIT-FIELD-V2  NUMERIC
 10027*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10028        ELSE
 10029           MOVE ER-2223         TO EMI-ERROR
 10030           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10031           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10032           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10033
 10034     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10035        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10036        PERFORM 8600-DEEDIT
 10037        IF DEEDIT-FIELD-V0 NUMERIC
 10038           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10039           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10040         ELSE
 10041           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10042           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10043           MOVE ER-2223              TO EMI-ERROR
 10044           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10045
 10046     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10047        IF BEXPIRE   (WS-SUB1) = SPACES
 10048           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10049        ELSE
 10050           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10051           PERFORM 8600-DEEDIT
 10052           IF DEEDIT-FIELD-V0        NUMERIC
 10053              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10054              MOVE 4                TO DC-OPTION-CODE
 10055              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10056              PERFORM 9700-DATE-LINK
 10057              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10058                                                        (WS-SUB1)
 10059              IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 185
* EL6311.cbl
 10060                 NEXT SENTENCE
 10061              ELSE
 10062                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10063                 MOVE ER-2531    TO EMI-ERROR
 10064                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10065                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10066           ELSE
 10067             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10068             MOVE ER-2532        TO EMI-ERROR
 10069             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10070             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10071
 10072     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10073        NEXT SENTENCE
 10074     ELSE
 10075
 10076* EXEC CICS BIF DEEDIT
 10077*           FIELD  (BALT-BENI (WS-SUB1))
 10078*           LENGTH (12)
 10079*       END-EXEC
 10080     MOVE 12
 10081       TO DFHEIV11
 10082*    MOVE '@"L                   #   #00009955' TO DFHEIV0
 10083     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10084     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10085     MOVE X'2020233030303039393535' TO DFHEIV0(25:11)
 10086     CALL 'kxdfhei1' USING DFHEIV0,
 10087           BALT-BENI(WS-SUB1),
 10088           DFHEIV11
 10089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10090        IF BALT-BENI (WS-SUB1) NUMERIC
 10091           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10092*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10093*       PERFORM 8600-DEEDIT
 10094*       IF DEEDIT-FIELD-V0 NUMERIC
 10095*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10096        ELSE
 10097           MOVE ER-2223         TO EMI-ERROR
 10098           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10099           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10100           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10101
 10102     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10103        NEXT SENTENCE
 10104     ELSE
 10105
 10106* EXEC CICS BIF DEEDIT
 10107*           FIELD  (BALT-PREMI (WS-SUB1))
 10108*           LENGTH (11)
 10109*       END-EXEC
 10110     MOVE 11
 10111       TO DFHEIV11
 10112*    MOVE '@"L                   #   #00009974' TO DFHEIV0
 10113     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10114     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10115     MOVE X'2020233030303039393734' TO DFHEIV0(25:11)
 10116     CALL 'kxdfhei1' USING DFHEIV0,
 10117           BALT-PREMI(WS-SUB1),
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 186
* EL6311.cbl
 10118           DFHEIV11
 10119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10120        IF BALT-PREMI (WS-SUB1) NUMERIC
 10121           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10122*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10123*       PERFORM 8600-DEEDIT
 10124*       IF DEEDIT-FIELD-V0 NUMERIC
 10125*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10126        ELSE
 10127           MOVE ER-2223         TO EMI-ERROR
 10128           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10129           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10130           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10131
 10132      GO TO 1020-EDIT-COVERAGES.
 10133
 10134 1025-EDIT-COMPLETE.
 10135     IF PI-COMPANY-ID  =  'DMD'
 10136        MOVE LOW-VALUES             TO BNCERTI
 10137                                       BNSTATI.
 10138
 10139     IF EMI-ERROR = ZEROS
 10140         NEXT SENTENCE
 10141     ELSE
 10142         GO TO 8200-SEND-DATAONLY.
 10143
 10144     IF BMAINTI = 'A'
 10145         GO TO 1200-ADD-ISSUE-ROUTINE.
 10146
 10147     IF BMAINTI = 'C'
 10148         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10149
 10150     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10151
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 187
* EL6311.cbl
 10153
 10154 1030-EDIT-FOR-NUMERICS.
 10155     IF WS-CSO-SUB EQUAL 10
 10156        GO TO 1030-EDIT-EXIT.
 10157
 10158     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10159        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10160        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10161           ADD +1               TO WS-CSO-SUB
 10162           GO TO 1030-EDIT-FOR-NUMERICS.
 10163
 10164     MOVE 'N'                   TO WS-NUMERIC-SW.
 10165
 10166 1030-EDIT-EXIT.
 10167******************************************************************
 10168*                                                                *
 10169*                 C A L C U L A T E   A G E                      *
 10170*                                                                *
 10171******************************************************************
 10172
 10173
 10174 1095-CALC-AGE.
 10175
 10176     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10177     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10178     MOVE 1                  TO DC-OPTION-CODE.
 10179     PERFORM 9700-DATE-LINK
 10180     IF NO-CONVERSION-ERROR
 10181         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10182         MOVE WS-BAGE            TO BAGEI
 10183         MOVE +2                 TO BAGEL
 10184         MOVE AL-UNNON TO BAGEA.
 10185
 10186 1099-EXIT.
 10187     EXIT.
 10188
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 188
* EL6311.cbl
 10190
 10191******************************************************************
 10192*                                                                *
 10193*                   S H O W   I S S U E                          *
 10194*                                                                *
 10195******************************************************************
 10196
 10197 1100-SHOW-REQUEST.
 10198     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10199
 10200     IF BCERTNOL = ZEROS AND
 10201        BEFFDTL  = ZEROS
 10202        MOVE -1                  TO BMAINTL
 10203        GO TO 8200-SEND-DATAONLY.
 10204
 10205     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10206
 10207     IF BSUFIXL NOT = ZEROS
 10208        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10209     ELSE
 10210        MOVE SPACE               TO WS-NEW-SUFFIX.
 10211
 10212     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10213     PERFORM 8600-DEEDIT.
 10214     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10215     MOVE '4'                    TO DC-OPTION-CODE.
 10216     PERFORM 9700-DATE-LINK.
 10217     IF DATE-CONVERSION-ERROR
 10218        MOVE ER-0348             TO EMI-ERROR
 10219        MOVE -1                  TO BEFFDTL
 10220        MOVE AL-UABON            TO BEFFDTA
 10221        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10222        GO TO 8200-SEND-DATAONLY
 10223     ELSE
 10224        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10225        MOVE AL-UANON            TO BEFFDTA
 10226        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10227
 10228     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10229
 10230     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10231        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10232          MOVE 'Y'                    TO WS-SHOW-SW
 10233          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10234             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10235           ELSE
 10236             IF PI-FILE-BROWSE
 10237                GO TO 4300-BROWSE-FILE-FORWARD
 10238              ELSE
 10239                IF PI-CSR-BROWSE
 10240                   GO TO 4200-BROWSE-CSR-FORWARD
 10241                ELSE
 10242                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10243        ELSE
 10244           GO TO 3900-RE-DISPLAY-RECORD.
 10245
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 189
* EL6311.cbl
 10247
 10248******************************************************************
 10249*                                                                *
 10250*            A D D   I S S U E   R O U T I N E                   *
 10251*                                                                *
 10252******************************************************************
 10253
 10254***************************************************************
 10255*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10256*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10257*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10258*     4. LINK TO THE EDIT ROUTINE.                            *
 10259*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10260*     6. WRITE THE NEW ISSUE RECORD.                          *
 10261*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10262*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10263*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10264*        ELSE                                                 *
 10265*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10266***************************************************************
 10267
 10268 1200-ADD-ISSUE-ROUTINE.
 10269     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10270
 10271
 10272* EXEC CICS GETMAIN
 10273*        SET     (ADDRESS OF PENDING-BUSINESS)
 10274*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10275*    END-EXEC.
 10276*    MOVE '," L                  $   #00010129' TO DFHEIV0
 10277     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10278     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10279     MOVE X'2020233030303130313239' TO DFHEIV0(25:11)
 10280     CALL 'kxdfhei1' USING DFHEIV0,
 10281           DFHEIV20,
 10282           ERPNDB-RECORD-LENGTH,
 10283           DFHEIV99
 10284     SET ADDRESS OF PENDING-BUSINESS TO
 10285         DFHEIV20
 10286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10287
 10288
 10289
 10290* EXEC CICS HANDLE CONDITION
 10291*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10292*    END-EXEC.
 10293*    MOVE '"$I                   ! # #00010134' TO DFHEIV0
 10294     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10295     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10296     MOVE X'2320233030303130313334' TO DFHEIV0(25:11)
 10297     CALL 'kxdfhei1' USING DFHEIV0
 10298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10299
 10300
 10301     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10302     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10303     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10304
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 190
* EL6311.cbl
 10305
 10306* EXEC CICS READ
 10307*        INTO    (PENDING-BUSINESS)
 10308*        DATASET (FILE-ID-ERPNDB)
 10309*        RIDFLD  (ERPNDB-KEY)
 10310*    END-EXEC.
 10311     MOVE LENGTH OF
 10312      PENDING-BUSINESS
 10313       TO DFHEIV11
 10314*    MOVE '&"IL       E          (   #00010142' TO DFHEIV0
 10315     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10316     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10317     MOVE X'2020233030303130313432' TO DFHEIV0(25:11)
 10318     CALL 'kxdfhei1' USING DFHEIV0,
 10319           FILE-ID-ERPNDB,
 10320           PENDING-BUSINESS,
 10321           DFHEIV11,
 10322           ERPNDB-KEY,
 10323           DFHEIV99,
 10324           DFHEIV99,
 10325           DFHEIV99
 10326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10327
 10328
 10329     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10330
 10331     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10332     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10333     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10334     MOVE SPACES                 TO PENDING-BUSINESS.
 10335     MOVE 'PB'                   TO PB-RECORD-ID.
 10336     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10337     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10338     MOVE SPACES                 TO PB-CERT-SFX.
 10339     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10340     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10341                                    PB-ALT-CHG-SEQ-NO.
 10342
 10343     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10344     MOVE '1'                    TO PB-RECORD-TYPE.
 10345
 10346     IF BSUFIXL NOT = ZEROS
 10347        MOVE BSUFIXI             TO PB-CERT-SFX.
 10348
 10349     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10350
 10351     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10352     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10353
 10354     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10355                                    PB-I-LF-PREM-CALC
 10356                                    PB-I-LF-ALT-PREM-CALC
 10357                                    PB-I-LF-RATE
 10358                                    PB-I-LF-ALT-RATE
 10359                                    PB-I-LF-REI-RATE
 10360                                    PB-I-LF-ALT-REI-RATE
 10361                                    PB-I-RATE-DEV-PCT-LF
 10362                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 191
* EL6311.cbl
 10363                                    PB-I-AH-RATE
 10364                                    PB-I-AH-REI-RATE
 10365                                    PB-I-AH-RATE-TRM
 10366                                    PB-I-RATE-DEV-PCT-AH
 10367                                    PB-I-BUSINESS-TYPE
 10368                                    PB-I-LIFE-COMMISSION
 10369                                    PB-I-JOINT-COMMISSION
 10370                                    PB-I-JOINT-AGE
 10371                                    PB-I-AH-COMMISSION
 10372                                    PB-I-CURR-SEQ
 10373                                    PB-CHG-COUNT
 10374                                    PB-LF-BILLED-AMTS
 10375                                    PB-AH-BILLED-AMTS
 10376                                    PB-CALC-TOLERANCE
 10377                                    PB-I-EXTENTION-DAYS
 10378*                                   PB-I-MICROFILM-NO
 10379                                    PB-I-TERM-IN-DAYS.
 10380
 10381     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10382                                    PB-I-LF-EXPIRE-DT
 10383                                    PB-I-AH-EXPIRE-DT
 10384                                    PB-BILLED-DT
 10385                                    PB-ACCT-EFF-DT
 10386                                    PB-ACCT-EXP-DT
 10387                                    PB-I-1ST-PMT-DT.
 10388
 10389     MOVE 'X'                    TO PB-FATAL-FLAG.
 10390
 10391     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10392
 10393     IF BLSTNML GREATER THAN ZEROS
 10394         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10395
 10396*    IF BMICRNOL  GREATER  ZEROS
 10397*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10398*    ELSE
 10399*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10400     IF BVINL > ZEROS
 10401        MOVE BVINI               TO PB-I-VIN
 10402     END-IF
 10403     IF B1STNML GREATER THAN ZEROS
 10404         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10405
 10406     IF BINITL  GREATER THAN ZEROS
 10407         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10408
 10409     IF BBIRTHL GREATER THAN ZERO
 10410         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10411     ELSE
 10412         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10413
 10414     IF B1STPMTL GREATER THAN ZERO
 10415         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10416     ELSE
 10417         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10418
 10419     IF BAGEL    GREATER THAN ZEROS
 10420         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 192
* EL6311.cbl
 10421        ELSE
 10422         MOVE ZEROS              TO PB-I-AGE.
 10423
 10424     IF BSEXL    GREATER THAN ZEROS
 10425         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10426
 10427     IF BTERM-LEN (1) GREATER THAN ZEROS
 10428        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10429     ELSE
 10430        MOVE ZEROS               TO PB-I-LF-TERM.
 10431
 10432     IF BTERM-LEN (2) GREATER THAN ZEROS
 10433        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10434     ELSE
 10435        MOVE ZEROS               TO PB-I-AH-TERM.
 10436
 10437     IF BLNTRML       GREATER THAN ZEROS
 10438         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10439        ELSE
 10440         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10441
 10442     IF BFREQL        GREATER THAN ZEROS
 10443         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10444        ELSE
 10445         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10446
 10447     IF BSKPCDL       GREATER THAN ZEROS
 10448         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10449
 10450     IF BMODEL        GREATER THAN ZEROS
 10451         MOVE BMODEI             TO PB-I-TERM-TYPE
 10452                                    PI-BMODE.
 10453
 10454     IF BPMTSL        GREATER THAN ZEROS
 10455         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10456                                    PI-BPMTS
 10457        ELSE
 10458         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10459                                    PI-BPMTS.
 10460
 10461     IF BPMTAMTL      GREATER THAN ZEROS
 10462         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10463        ELSE
 10464         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10465
 10466     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10467        IF BTYPE  (1)   NOT = ZEROS
 10468           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10469                                    PI-BTYPE (1)
 10470           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10471           MOVE SPACES           TO PB-I-LF-ABBR
 10472        ELSE
 10473           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10474                                    PB-I-LF-ABBR
 10475           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10476     ELSE
 10477        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10478                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 193
* EL6311.cbl
 10479        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10480
 10481     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10482         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10483     ELSE
 10484         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10485
 10486     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10487         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10488     ELSE
 10489         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10490
 10491     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10492         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10493            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10494            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10495         ELSE
 10496            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10497*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10498*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10499         END-IF
 10500     ELSE
 10501         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10502
 10503     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10504         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10505
 10506     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10507         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10508         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10509     ELSE
 10510         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10511
 10512     IF  BALT-PREM-LEN     (2) > ZEROS
 10513         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10514     ELSE
 10515         MOVE ZEROS            TO PB-I-TOT-FEES.
 10516
 10517     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10518        IF BTYPE      (2)   NOT = ZEROS
 10519           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10520                                  PI-BTYPE (2)
 10521           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10522           MOVE SPACES         TO PB-I-AH-ABBR
 10523        ELSE
 10524           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10525                                  PB-I-AH-ABBR
 10526           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10527     ELSE
 10528        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10529                                  PB-I-AH-ABBR
 10530        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10531
 10532     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10533         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10534     ELSE
 10535         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10536
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 194
* EL6311.cbl
 10537     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10538         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10539            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10540            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10541         ELSE
 10542            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10543*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10544*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10545         END-IF
 10546     ELSE
 10547         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10548
 10549     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10550         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10551
 10552     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10553        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10554     ELSE
 10555        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10556
 10557     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10558        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10559     ELSE
 10560        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10561
 10562     IF BINDGRPL  GREATER THAN ZEROS
 10563         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10564
 10565     IF BRTCLSL   GREATER THAN ZEROS
 10566         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10567
 10568     IF BSIGL     GREATER THAN ZEROS
 10569         MOVE BSIGI              TO PB-I-SIG-SW.
 10570     IF BAPRL > ZEROS
 10571         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10572     ELSE
 10573        if pi-company-id = 'CID'
 10574           move +99.9999         to pb-i-loan-apr
 10575        else
 10576           MOVE ZEROS            TO PB-I-LOAN-APR
 10577        end-if
 10578     end-if
 10579     IF BMEMBERL  GREATER THAN ZEROS
 10580         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10581
 10582     IF BLNOFCRL  GREATER THAN ZEROS
 10583         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10584
 10585     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10586        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10587     ELSE
 10588        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10589
 10590     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10591        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10592     ELSE
 10593        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10594
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 195
* EL6311.cbl
 10595     IF BDAYSL   GREATER THAN ZEROS
 10596        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10597                                    PB-I-EXTENTION-DAYS
 10598     ELSE
 10599        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10600                                    PB-I-EXTENTION-DAYS.
 10601
 10602     IF BDAYSL GREATER THAN ZEROS
 10603        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10604
 10605     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10606        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10607           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10608
 10609     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10610        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10611           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10612
 10613     IF B1STPMTL GREATER THAN ZEROS
 10614        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10615
 10616     IF PB-EXT-DAYS-PROCESSING
 10617        IF PB-I-EXTENTION-DAYS = ZEROS
 10618           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10619
 10620     IF PB-EXPIRE-DT-PROCESSING
 10621        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10622           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10623             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10624
 10625     IF PB-1ST-PMT-DT-PROCESSING
 10626        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10627           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10628
 10629     IF BREINL GREATER THAN ZEROS
 10630        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10631
 10632     IF BENTRYL NOT = ZEROS
 10633        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10634        IF PI-COMPANY-ID = 'CID'
 10635           AND (PB-BATCH-ENTRY = 'P')
 10636           AND (PB-STATE = 'VA')
 10637           PERFORM 1500-UPDATE-ERNOTE
 10638                                 THRU 1500-EXIT
 10639        END-IF
 10640     END-IF
 10641     IF BUNWRITL NOT = ZEROS
 10642        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10643
 10644     IF BFORCEL NOT = ZEROS
 10645        MOVE BFORCEI             TO PB-FORCE-CODE.
 10646
 10647     IF BBILCDL NOT = ZEROS
 10648        MOVE BBILCDI             TO PB-RECORD-BILL.
 10649
 10650     IF BLIVESL GREATER THAN ZEROS
 10651        MOVE WS-BLIVES           TO PB-I-LIVES
 10652     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 196
* EL6311.cbl
 10653        MOVE ZEROS               TO PB-I-LIVES.
 10654
 10655     IF BBILLEDL GREATER THAN ZEROS
 10656        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10657     ELSE
 10658        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10659
 10660*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10661
 10662 1260-WRITE-PB-RECORD.
 10663     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10664                                    PB-INPUT-BY.
 10665     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10666     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10667                                    PB-INPUT-DT.
 10668
 10669     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10670     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10671                                    PB-CONTROL-BY-ORIG-BATCH.
 10672
 10673
 10674     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10675     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10676     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10677     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10678     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10679
 10680     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10681
 10682     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10683
 10684     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10685     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10686     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10687
 10688     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10689     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10690
 10691 1275-WRITE-PENDING-BUSINESS.
 10692     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10693     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10694     MOVE 'A'                    TO JP-RECORD-TYPE.
 10695     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10696
 10697
 10698* EXEC CICS HANDLE CONDITION
 10699*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10700*    END-EXEC.
 10701*    MOVE '"$%                   ! $ #00010516' TO DFHEIV0
 10702     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10703     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10704     MOVE X'2420233030303130353136' TO DFHEIV0(25:11)
 10705     CALL 'kxdfhei1' USING DFHEIV0
 10706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10707
 10708
 10709
 10710* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 197
* EL6311.cbl
 10711*        DATASET (FILE-ID-ERPNDB)
 10712*        FROM    (PENDING-BUSINESS)
 10713*        RIDFLD  (PB-CONTROL-PRIMARY)
 10714*    END-EXEC.
 10715     MOVE LENGTH OF
 10716      PENDING-BUSINESS
 10717       TO DFHEIV11
 10718*    MOVE '&$ L                  ''   #00010520' TO DFHEIV0
 10719     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10720     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10721     MOVE X'2020233030303130353230' TO DFHEIV0(25:11)
 10722     CALL 'kxdfhei1' USING DFHEIV0,
 10723           FILE-ID-ERPNDB,
 10724           PENDING-BUSINESS,
 10725           DFHEIV11,
 10726           PB-CONTROL-PRIMARY,
 10727           DFHEIV99,
 10728           DFHEIV99
 10729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10730
 10731
 10732     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10733
 10734     PERFORM 8400-LOG-JOURNAL-RECORD.
 10735
 10736******************************************************************
 10737*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10738******************************************************************
 10739     display ' made it to add orig cert '
 10740     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10741     MOVE ' '                    TO WS-ERMAIL-SW
 10742
 10743* EXEC CICS READ
 10744*       DATASET   (FILE-ID-ERMAIL)
 10745*       SET       (ADDRESS OF MAILING-DATA)
 10746*       RIDFLD    (ERMAIL-KEY)
 10747*       RESP      (WS-RESPONSE)
 10748*    END-EXEC
 10749*    MOVE '&"S        E          (  N#00010536' TO DFHEIV0
 10750     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10751     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10752     MOVE X'204E233030303130353336' TO DFHEIV0(25:11)
 10753     CALL 'kxdfhei1' USING DFHEIV0,
 10754           FILE-ID-ERMAIL,
 10755           DFHEIV20,
 10756           DFHEIV99,
 10757           ERMAIL-KEY,
 10758           DFHEIV99,
 10759           DFHEIV99,
 10760           DFHEIV99
 10761     SET ADDRESS OF MAILING-DATA TO
 10762         DFHEIV20
 10763     MOVE EIBRESP  TO WS-RESPONSE
 10764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10765     IF RESP-NORMAL
 10766        SET ERMAIL-FOUND TO TRUE
 10767     END-IF
 10768
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 198
* EL6311.cbl
 10769     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10770     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10771     MOVE 'OC'                   TO OC-RECORD-ID
 10772     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10773                                 TO OC-CONTROL-PRIMARY (1:33)
 10774     MOVE 'I'                    TO OC-RECORD-TYPE
 10775     MOVE +4096                  TO OC-KEY-SEQ-NO
 10776     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10777     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10778     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10779     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10780     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10781     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10782     MOVE PB-I-AGE               TO OC-INS-AGE
 10783     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10784     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10785     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10786     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10787     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10788     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10789     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10790     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10791     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10792     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10793     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10794     IF PB-I-JOINT-COMMISSION > +0
 10795         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10796     ELSE
 10797         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10798     END-IF
 10799     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10800     MOVE +0                     TO OC-LF-CANCEL-AMT
 10801                                    OC-LF-ITD-CANCEL-AMT
 10802     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10803     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10804     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10805     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10806     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10807     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10808     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10809     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10810     MOVE +0                     TO OC-AH-CANCEL-AMT
 10811                                    OC-AH-ITD-CANCEL-AMT
 10812     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10813     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10814     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10815     IF ERMAIL-FOUND
 10816        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10817     END-IF
 10818     IF NOT CERT-TRL-REC-NOT-FOUND
 10819        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10820                           OC-INS-AGE-DEFAULT-FLAG
 10821        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10822                           OC-JNT-AGE-DEFAULT-FLAG
 10823     END-IF
 10824     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10825     .
 10826 1275-WRITE-ELCRTO.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 199
* EL6311.cbl
 10827
 10828* EXEC CICS WRITE
 10829*       DATASET   ('ELCRTO')
 10830*       FROM      (ORIGINAL-CERTIFICATE)
 10831*       RIDFLD    (OC-CONTROL-PRIMARY)
 10832*       RESP      (WS-RESPONSE)
 10833*    END-EXEC
 10834     MOVE LENGTH OF
 10835      ORIGINAL-CERTIFICATE
 10836       TO DFHEIV11
 10837     MOVE 'ELCRTO' TO DFHEIV1
 10838*    MOVE '&$ L                  ''  N#00010604' TO DFHEIV0
 10839     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10840     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10841     MOVE X'204E233030303130363034' TO DFHEIV0(25:11)
 10842     CALL 'kxdfhei1' USING DFHEIV0,
 10843           DFHEIV1,
 10844           ORIGINAL-CERTIFICATE,
 10845           DFHEIV11,
 10846           OC-CONTROL-PRIMARY,
 10847           DFHEIV99,
 10848           DFHEIV99
 10849     MOVE EIBRESP  TO WS-RESPONSE
 10850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10851     display ' just wrote 1275 ' ws-response
 10852     IF RESP-DUPKEY
 10853        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10854        GO TO 1275-WRITE-ELCRTO
 10855     ELSE
 10856        IF NOT RESP-NORMAL
 10857           MOVE -1               TO BMAINTL
 10858           MOVE ER-7450          TO EMI-ERROR
 10859           PERFORM 9900-ERROR-FORMAT
 10860                                 THRU 9900-EXIT
 10861           GO TO 8200-SEND-DATAONLY
 10862        END-IF
 10863     END-IF
 10864******************************************************************
 10865*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10866******************************************************************
 10867
 10868
 10869* EXEC CICS READ
 10870*        INTO    (PENDING-BUSINESS)
 10871*        DATASET (FILE-ID-ERPNDB)
 10872*        RIDFLD  (ERPNDB-KEY)
 10873*        UPDATE
 10874*    END-EXEC.
 10875     MOVE LENGTH OF
 10876      PENDING-BUSINESS
 10877       TO DFHEIV11
 10878*    MOVE '&"IL       EU         (   #00010627' TO DFHEIV0
 10879     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10880     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10881     MOVE X'2020233030303130363237' TO DFHEIV0(25:11)
 10882     CALL 'kxdfhei1' USING DFHEIV0,
 10883           FILE-ID-ERPNDB,
 10884           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 200
* EL6311.cbl
 10885           DFHEIV11,
 10886           ERPNDB-KEY,
 10887           DFHEIV99,
 10888           DFHEIV99,
 10889           DFHEIV99
 10890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10891
 10892
 10893     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10894     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10895     MOVE 'B'                    TO JP-RECORD-TYPE.
 10896     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10897
 10898     PERFORM 8400-LOG-JOURNAL-RECORD.
 10899
 10900     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10901
 10902
 10903* EXEC CICS REWRITE
 10904*        DATASET (FILE-ID-ERPNDB)
 10905*        FROM    (PENDING-BUSINESS)
 10906*    END-EXEC.
 10907     MOVE LENGTH OF
 10908      PENDING-BUSINESS
 10909       TO DFHEIV11
 10910*    MOVE '&& L                  %   #00010643' TO DFHEIV0
 10911     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10912     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10913     MOVE X'2020233030303130363433' TO DFHEIV0(25:11)
 10914     CALL 'kxdfhei1' USING DFHEIV0,
 10915           FILE-ID-ERPNDB,
 10916           PENDING-BUSINESS,
 10917           DFHEIV11,
 10918           DFHEIV99
 10919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10920
 10921
 10922     MOVE 'C'                    TO JP-RECORD-TYPE.
 10923     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10924
 10925     PERFORM 8400-LOG-JOURNAL-RECORD.
 10926
 10927     IF WS-ERRORS-PRESENT
 10928         GO TO 3900-RE-DISPLAY-RECORD.
 10929
 10930     MOVE ZEROS                  TO EMI-ERROR.
 10931     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10932     MOVE LOW-VALUES             TO EL631BI.
 10933     MOVE  -1                    TO BMAINTL.
 10934     GO TO 8100-SEND-INITIAL-MAP.
 10935
 10936 1280-BATCH-HDR-NOT-FOUND.
 10937     MOVE -1                     TO BMAINTL.
 10938     MOVE ER-7450                TO EMI-ERROR.
 10939     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10940     GO TO 8200-SEND-DATAONLY.
 10941
 10942 1290-DUPLICATE-ALT-INDEX.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 201
* EL6311.cbl
 10943
 10944******************************************************************
 10945*                                                                *
 10946*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 10947*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 10948*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 10949*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 10950*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 10951*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 10952*                                                                *
 10953******************************************************************
 10954
 10955     IF LCP-ONCTR-01 =  0
 10956         ADD 1 TO LCP-ONCTR-01
 10957        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 10958
 10959     ADD +1                      TO WS-SEQ-NO-COUNTER.
 10960
 10961     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 10962         NEXT SENTENCE
 10963     ELSE
 10964         ADD +1 TO PB-BATCH-SEQ-NO
 10965                   PB-CSR-BATCH-SEQ-NO
 10966         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 10967         GO TO 1275-WRITE-PENDING-BUSINESS.
 10968
 10969     MOVE -1                     TO BCERTNOL.
 10970     MOVE AL-UABON               TO BCERTNOA.
 10971     MOVE AL-UNBON               TO BEFFDTA.
 10972
 10973     MOVE 1                      TO EMI-SUB
 10974                                    EMI-SWITCH1
 10975                                    EMI-SWITCH-AREA-1
 10976                                    EMI-SWITCH-AREA-2.
 10977
 10978     MOVE SPACES                 TO EMI-ERROR-LINES.
 10979
 10980
 10981* EXEC CICS SYNCPOINT ROLLBACK
 10982*    END-EXEC.
 10983*    MOVE '6"R                   !   #00010706' TO DFHEIV0
 10984     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10985     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10986     MOVE X'2020233030303130373036' TO DFHEIV0(25:11)
 10987     CALL 'kxdfhei1' USING DFHEIV0
 10988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10989
 10990
 10991     MOVE ER-2247                TO EMI-ERROR.
 10992     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10993     GO TO 8200-SEND-DATAONLY.
 10994
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 202
* EL6311.cbl
 10996
 10997
 10998 1295-READ-CERT-TRAILER.
 10999
 11000
 11001* EXEC CICS GETMAIN
 11002*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11003*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11004*        INITIMG (GETMAIN-SPACE)
 11005*    END-EXEC
 11006*    MOVE ',"IL                  $   #00010718' TO DFHEIV0
 11007     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11008     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11009     MOVE X'2020233030303130373138' TO DFHEIV0(25:11)
 11010     CALL 'kxdfhei1' USING DFHEIV0,
 11011           DFHEIV20,
 11012           ELCRTT-RECORD-LENGTH,
 11013           GETMAIN-SPACE
 11014     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11015         DFHEIV20
 11016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11017
 11018     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11019     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11020     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11021
 11022
 11023* EXEC CICS HANDLE CONDITION
 11024*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11025*    END-EXEC.
 11026*    MOVE '"$I                   ! % #00010728' TO DFHEIV0
 11027     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11028     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11029     MOVE X'2520233030303130373238' TO DFHEIV0(25:11)
 11030     CALL 'kxdfhei1' USING DFHEIV0
 11031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11032
 11033
 11034
 11035* EXEC CICS READ
 11036*        DATASET  (CRTT-ID)
 11037*        RIDFLD   (ELCRTT-KEY)
 11038*        INTO     (CERTIFICATE-TRAILERS)
 11039*    END-EXEC.
 11040     MOVE LENGTH OF
 11041      CERTIFICATE-TRAILERS
 11042       TO DFHEIV11
 11043*    MOVE '&"IL       E          (   #00010732' TO DFHEIV0
 11044     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11045     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11046     MOVE X'2020233030303130373332' TO DFHEIV0(25:11)
 11047     CALL 'kxdfhei1' USING DFHEIV0,
 11048           CRTT-ID,
 11049           CERTIFICATE-TRAILERS,
 11050           DFHEIV11,
 11051           ELCRTT-KEY,
 11052           DFHEIV99,
 11053           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 203
* EL6311.cbl
 11054           DFHEIV99
 11055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11056
 11057
 11058     GO TO 1295-EXIT.
 11059
 11060 1295-CERT-TRL-REC-NOTFND.
 11061     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11062
 11063 1295-EXIT.
 11064     EXIT.
 11065
 11066******************************************************************
 11067*                                                                *
 11068*          C H A N G E   I S S U E   R O U T I N E               *
 11069*                                                                *
 11070******************************************************************
 11071
 11072***************************************************************
 11073*                                                             *
 11074*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11075*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11076*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11077*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11078*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11079*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11080*     5. LINK TO THE EDIT ROUTINE.                            *
 11081*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11082*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11083*              THE EDIT ROUTINE.                              *
 11084*     7. REWRITE THE NEW ISSUE                                *
 11085*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11086*                                                             *
 11087***************************************************************
 11088
 11089 1300-CHANGE-ISSUE-ROUTINE.
 11090     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11091
 11092     IF BCHGL NOT = ZEROS
 11093        MOVE ER-2196             TO EMI-ERROR
 11094        MOVE AL-UABON            TO BMAINTA
 11095        MOVE -1                  TO BMAINTL
 11096        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11097        GO TO 8200-SEND-DATAONLY.
 11098
 11099     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11100
 11101     IF BSUFIXL NOT = ZEROS
 11102        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11103     ELSE
 11104        MOVE SPACE               TO WS-NEW-SUFFIX.
 11105
 11106     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11107     PERFORM 8600-DEEDIT.
 11108     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11109     MOVE '4'                    TO DC-OPTION-CODE.
 11110     PERFORM 9700-DATE-LINK.
 11111     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 204
* EL6311.cbl
 11112        MOVE ER-0348             TO EMI-ERROR
 11113        MOVE -1                  TO BEFFDTL
 11114        MOVE AL-UABON            TO BEFFDTA
 11115        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11116        GO TO 8200-SEND-DATAONLY
 11117     ELSE
 11118        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11119        MOVE AL-UANON            TO BEFFDTA
 11120        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11121
 11122 1325-PROCESS-ISSUE-CHANGES.
 11123
 11124* EXEC CICS HANDLE CONDITION
 11125*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11126*    END-EXEC.
 11127*    MOVE '"$I                   ! & #00010803' TO DFHEIV0
 11128     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11129     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11130     MOVE X'2620233030303130383033' TO DFHEIV0(25:11)
 11131     CALL 'kxdfhei1' USING DFHEIV0
 11132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11133
 11134
 11135     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11136     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11137     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11138
 11139
 11140* EXEC CICS GETMAIN
 11141*        SET      (ADDRESS OF PENDING-BUSINESS)
 11142*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11143*        INITIMG  (GETMAIN-SPACE)
 11144*     END-EXEC.
 11145*    MOVE ',"IL                  $   #00010811' TO DFHEIV0
 11146     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11147     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11148     MOVE X'2020233030303130383131' TO DFHEIV0(25:11)
 11149     CALL 'kxdfhei1' USING DFHEIV0,
 11150           DFHEIV20,
 11151           ERPNDB-RECORD-LENGTH,
 11152           GETMAIN-SPACE
 11153     SET ADDRESS OF PENDING-BUSINESS TO
 11154         DFHEIV20
 11155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11156
 11157
 11158
 11159* EXEC CICS READ
 11160*        INTO    (PENDING-BUSINESS)
 11161*        DATASET (FILE-ID-ERPNDB)
 11162*        RIDFLD  (ERPNDB-KEY)
 11163*    END-EXEC.
 11164     MOVE LENGTH OF
 11165      PENDING-BUSINESS
 11166       TO DFHEIV11
 11167*    MOVE '&"IL       E          (   #00010817' TO DFHEIV0
 11168     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11169     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 205
* EL6311.cbl
 11170     MOVE X'2020233030303130383137' TO DFHEIV0(25:11)
 11171     CALL 'kxdfhei1' USING DFHEIV0,
 11172           FILE-ID-ERPNDB,
 11173           PENDING-BUSINESS,
 11174           DFHEIV11,
 11175           ERPNDB-KEY,
 11176           DFHEIV99,
 11177           DFHEIV99,
 11178           DFHEIV99
 11179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11180
 11181
 11182     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11183
 11184
 11185* EXEC CICS HANDLE CONDITION
 11186*         NOTFND     (1385-REC-NOT-FOUND)
 11187*    END-EXEC.
 11188*    MOVE '"$I                   ! '' #00010825' TO DFHEIV0
 11189     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11190     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11191     MOVE X'2720233030303130383235' TO DFHEIV0(25:11)
 11192     CALL 'kxdfhei1' USING DFHEIV0
 11193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11194
 11195
 11196**********************************************************
 11197*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11198*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11199**********************************************************
 11200
 11201
 11202* EXEC CICS READ
 11203*        DATASET (FILE-ID-ERPNDB)
 11204*        INTO    (PENDING-BUSINESS)
 11205*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11206*    END-EXEC.
 11207     MOVE LENGTH OF
 11208      PENDING-BUSINESS
 11209       TO DFHEIV11
 11210*    MOVE '&"IL       E          (   #00010834' TO DFHEIV0
 11211     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11212     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11213     MOVE X'2020233030303130383334' TO DFHEIV0(25:11)
 11214     CALL 'kxdfhei1' USING DFHEIV0,
 11215           FILE-ID-ERPNDB,
 11216           PENDING-BUSINESS,
 11217           DFHEIV11,
 11218           PI-PREV-CONTROL-PRIMARY,
 11219           DFHEIV99,
 11220           DFHEIV99,
 11221           DFHEIV99
 11222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11223
 11224
 11225********** DO NOT ALLOW CHANGES IF THRU A/R
 11226     IF BMAINTI = 'C'
 11227         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 206
* EL6311.cbl
 11228             MOVE ER-4005          TO EMI-ERROR
 11229             MOVE -1               TO BMAINTL
 11230             MOVE AL-UABON         TO BMAINTA
 11231             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11232             GO TO 8200-SEND-DATAONLY.
 11233**********
 11234
 11235     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11236        MOVE -1                 TO BMAINTL
 11237        MOVE ER-2197            TO EMI-ERROR
 11238        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11239        GO TO 8200-SEND-DATAONLY.
 11240
 11241     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11242        MOVE ER-2196             TO EMI-ERROR
 11243        MOVE AL-UABON            TO BMAINTA
 11244        MOVE -1                  TO BMAINTL
 11245        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11246        GO TO 8200-SEND-DATAONLY.
 11247
 11248     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11249
 11250     IF PB-BILLED-DT = LOW-VALUES AND
 11251        PB-CHG-COUNT = ZEROS
 11252        NEXT SENTENCE
 11253     ELSE
 11254        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11255            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11256           OR
 11257           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11258            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11259           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11260
 11261
 11262* EXEC CICS READ
 11263*        DATASET (FILE-ID-ERPNDB)
 11264*        INTO    (PENDING-BUSINESS)
 11265*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11266*        UPDATE
 11267*    END-EXEC.
 11268     MOVE LENGTH OF
 11269      PENDING-BUSINESS
 11270       TO DFHEIV11
 11271*    MOVE '&"IL       EU         (   #00010876' TO DFHEIV0
 11272     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11273     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11274     MOVE X'2020233030303130383736' TO DFHEIV0(25:11)
 11275     CALL 'kxdfhei1' USING DFHEIV0,
 11276           FILE-ID-ERPNDB,
 11277           PENDING-BUSINESS,
 11278           DFHEIV11,
 11279           PI-PREV-CONTROL-PRIMARY,
 11280           DFHEIV99,
 11281           DFHEIV99,
 11282           DFHEIV99
 11283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11284
 11285
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 207
* EL6311.cbl
 11286     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11287     MOVE 'B'                    TO JP-RECORD-TYPE
 11288     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11289     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11290
 11291     PERFORM 8400-LOG-JOURNAL-RECORD.
 11292
 11293     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11294        PB-CHG-COUNT NOT = ZEROS
 11295        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11296            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11297           OR
 11298           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11299            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11300            MOVE LOW-VALUES             TO PB-BILLED-DT
 11301            ADD +1                      TO PB-CHG-COUNT.
 11302
 11303     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11304     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11305     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11306     MOVE '5'                    TO DC-OPTION-CODE.
 11307     PERFORM 9700-DATE-LINK
 11308     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11309
 11310*    IF BMICRNOL  GREATER  ZEROS
 11311*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11312
 11313     IF BVINL > ZEROS
 11314        MOVE BVINI               TO PB-I-VIN
 11315     END-IF
 11316     IF (BFORCEL NOT = ZEROS)
 11317        AND (PB-COMPANY-ID = 'DCC')
 11318        AND (BFORCEI = ' ')
 11319        AND (PB-FORCE-CODE = 'O')
 11320        COMPUTE PB-I-AH-PREMIUM-AMT =
 11321           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11322        PERFORM 1800-REMOVE-CERT-NOTES
 11323                                 THRU 1800-EXIT
 11324        PERFORM 1900-DELETE-ERPYAJ
 11325                                 THRU 1900-EXIT
 11326        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11327     END-IF
 11328     IF (BFORCEL NOT = ZEROS)
 11329        AND (PB-COMPANY-ID = 'DCC')
 11330        AND (BFORCEI = 'O')
 11331        AND (PB-FORCE-CODE NOT = 'O')
 11332        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11333           PB-I-AH-PREM-CALC
 11334        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11335        MOVE SPACE               TO DC-OPTION-CODE
 11336        PERFORM 9700-DATE-LINK
 11337        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11338        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11339        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11340        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11341        PERFORM 1500-UPDATE-ERNOTE
 11342                                 THRU 1500-EXIT
 11343        PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 208
* EL6311.cbl
 11344                                 THRU 1600-EXIT
 11345     END-IF
 11346     IF BLSTNML  GREATER THAN ZEROS
 11347         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11348
 11349     IF B1STNML  GREATER THAN ZEROS
 11350         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11351
 11352     IF BINITL   GREATER THAN ZEROS
 11353         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11354
 11355     IF BBIRTHL  GREATER THAN ZERO
 11356         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11357
 11358     IF B1STPMTL GREATER THAN ZERO
 11359         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11360
 11361     IF BAGEL    GREATER THAN ZEROS
 11362         MOVE BAGEI              TO PB-I-AGE.
 11363
 11364     MOVE 'N'                    TO WS-INS-AGE-SET
 11365                                    WS-JNT-AGE-SET.
 11366     IF BAGEL    GREATER THAN ZEROS
 11367        MOVE 'Y'                TO WS-INS-AGE-SET
 11368        IF BAGEI = ZERO AND
 11369             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11370           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11371           MOVE 'AGE*'          TO BAGEDEFO
 11372        ELSE
 11373           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11374           MOVE 'AGE '          TO BAGEDEFO
 11375        END-IF
 11376        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11377     END-IF.
 11378
 11379     IF BSEXL    GREATER THAN ZEROS
 11380         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11381
 11382     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11383        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11384
 11385     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11386        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11387
 11388     IF BLNTRML  GREATER THAN ZEROS
 11389         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11390
 11391     IF BFREQL   GREATER THAN ZEROS
 11392         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11393
 11394     IF BSKPCDL  GREATER THAN ZEROS
 11395         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11396
 11397     IF BMODEL   GREATER THAN ZEROS
 11398         MOVE BMODEI             TO PB-I-TERM-TYPE
 11399                                    PI-BMODE.
 11400
 11401     IF BPMTSL   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 209
* EL6311.cbl
 11402         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11403                                    PI-BPMTS.
 11404
 11405     IF BPMTAMTL GREATER THAN ZEROS
 11406         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11407
 11408     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11409         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11410
 11411     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11412         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11413
 11414     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11415
 11416     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11417         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11418            SUBTRACT PB-I-LF-PREMIUM-AMT
 11419                     FROM WS-B-LF-ISS-PRM-ENTERED
 11420            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11421            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11422            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11423         ELSE
 11424            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11425*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11426*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11427         END-IF
 11428     END-IF.
 11429
 11430     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11431            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11432                     FROM WS-B-LF-ISS-PRM-ENTERED
 11433         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11434         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11435
 11436     IF  BALT-PREM-LEN     (2)  > ZEROS
 11437         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11438
 11439     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11440         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11441
 11442     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11443         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11444            SUBTRACT PB-I-AH-PREMIUM-AMT
 11445                     FROM WS-B-AH-ISS-PRM-ENTERED
 11446            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11447            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11448            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11449         ELSE
 11450            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11451*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11452*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11453         END-IF
 11454     END-IF
 11455
 11456     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11457        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11458
 11459     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 210
* EL6311.cbl
 11460        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11461
 11462     IF BINDGRPL            GREATER THAN ZEROS
 11463         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11464
 11465     IF BRTCLSL             GREATER THAN ZEROS
 11466         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11467
 11468     IF BSIGL               GREATER THAN ZEROS
 11469         MOVE BSIGI              TO PB-I-SIG-SW.
 11470
 11471     IF BAPRL               GREATER THAN ZEROS
 11472         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11473
 11474     IF BMEMBERL            GREATER THAN ZEROS
 11475         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11476
 11477     IF BLNOFCRL            GREATER THAN ZEROS
 11478         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11479
 11480     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11481        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11482
 11483     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11484        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11485
 11486     IF BDAYSL              GREATER THAN ZEROS
 11487        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11488                                    PB-I-EXTENTION-DAYS.
 11489
 11490     IF BDAYSL GREATER THAN ZEROS
 11491        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11492
 11493     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11494        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11495           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11496
 11497     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11498        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11499           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11500
 11501     IF B1STPMTL GREATER THAN ZEROS
 11502        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11503
 11504     IF PB-EXT-DAYS-PROCESSING
 11505        IF PB-I-EXTENTION-DAYS = ZEROS
 11506           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11507
 11508     IF PB-EXPIRE-DT-PROCESSING
 11509        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11510           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11511             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11512
 11513     IF PB-1ST-PMT-DT-PROCESSING
 11514        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11515           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11516
 11517     IF BREINL GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 211
* EL6311.cbl
 11518        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11519
 11520     IF BFORCEL NOT = ZEROS
 11521        MOVE BFORCEI             TO PB-FORCE-CODE.
 11522     IF (BENTRYL NOT = ZEROS)
 11523        AND (PB-COMPANY-ID = 'CID')
 11524        AND (PB-STATE = 'VA')
 11525        AND (BENTRYI NOT = 'P')
 11526        AND (PB-BATCH-ENTRY = 'P')
 11527        PERFORM 1800-REMOVE-CERT-NOTES
 11528                                 THRU 1800-EXIT
 11529     END-IF
 11530     IF BENTRYL NOT = ZEROS
 11531        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11532        IF PI-COMPANY-ID = 'CID'
 11533           AND (PB-BATCH-ENTRY = 'P')
 11534           AND (PB-STATE = 'VA')
 11535           PERFORM 1500-UPDATE-ERNOTE
 11536                                 THRU 1500-EXIT
 11537        END-IF
 11538     END-IF
 11539
 11540     IF BUNWRITL NOT = ZEROS
 11541        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11542
 11543     IF BBILCDL NOT = ZEROS
 11544        MOVE BBILCDI             TO PB-RECORD-BILL.
 11545
 11546     IF BLIVESL GREATER THAN ZEROS
 11547        MOVE WS-BLIVES           TO PB-I-LIVES.
 11548
 11549
 11550*DMD CUSTOM CODING*************START
 11551     IF PI-COMPANY-ID NOT = 'DMD'
 11552         MOVE ZEROS               TO BBILLEDL.
 11553*DMD CUSTOM CODING*************END
 11554
 11555     IF BBILLEDL GREATER THAN ZEROS
 11556        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11557
 11558
 11559*****************************************************************
 11560*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11561*****************************************************************
 11562
 11563     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11564        IF BTYPE  (1)   = ZEROS OR SPACES
 11565           IF REMOVE-LF-COVERAGE
 11566               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11567                                        PI-BTYPE (1)
 11568               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11569                                        WS-B-LF-ISS-PRM-ENTERED
 11570               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11571                                        WS-B-LF-ISS-PRM-ENTERED
 11572               SUBTRACT PB-I-LF-PREM-CALC FROM
 11573                                        WS-B-LF-ISS-PRM-COMPUTED
 11574               MOVE ZEROS            TO PB-I-LF-TERM
 11575                                        PB-I-LF-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 212
* EL6311.cbl
 11576                                        PB-I-LF-PREMIUM-AMT
 11577                                        PB-I-LF-BENEFIT-CD
 11578                                        PB-I-LF-PREM-CALC
 11579                                        PB-I-LF-CRIT-PER
 11580                                        PB-I-LF-ALT-BENEFIT-AMT
 11581                                        PB-I-LF-ALT-PREMIUM-AMT
 11582               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11583           ELSE
 11584               NEXT SENTENCE
 11585        ELSE
 11586           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11587                                    PI-BTYPE (1).
 11588     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11589        IF BTYPE  (2)   = ZEROS OR SPACES
 11590           IF  REMOVE-AH-COVERAGE
 11591               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11592                                        PI-BTYPE (2)
 11593               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11594                                        WS-B-AH-ISS-PRM-ENTERED
 11595               SUBTRACT PB-I-AH-PREM-CALC FROM
 11596                                        WS-B-AH-ISS-PRM-COMPUTED
 11597               MOVE ZEROS            TO PB-I-AH-TERM
 11598                                        PB-I-AH-BENEFIT-AMT
 11599                                        PB-I-AH-PREMIUM-AMT
 11600                                        PB-I-AH-BENEFIT-CD
 11601                                        PB-I-AH-PREM-CALC
 11602                                        PB-I-AH-CRIT-PER
 11603               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11604           ELSE
 11605               NEXT SENTENCE
 11606        ELSE
 11607           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11608                                    PI-BTYPE (2).
 11609 1360-REWRITE-PB-RECORD.
 11610     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11611
 11612     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11613     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11614
 11615     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11616
 11617     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11618     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11619
 11620     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11621         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11622
 11623     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11624         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11625
 11626     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11627
 11628     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11629
 11630     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11631
 11632     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11633     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 213
* EL6311.cbl
 11634     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11635
 11636     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11637     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11638
 11639 1375-REWRITE-PB-RECORD.
 11640     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11641     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11642     MOVE 'C'                    TO JP-RECORD-TYPE.
 11643     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11644
 11645
 11646* EXEC CICS REWRITE
 11647*        DATASET (FILE-ID-ERPNDB)
 11648*        FROM    (PENDING-BUSINESS)
 11649*    END-EXEC.
 11650     MOVE LENGTH OF
 11651      PENDING-BUSINESS
 11652       TO DFHEIV11
 11653*    MOVE '&& L                  %   #00011242' TO DFHEIV0
 11654     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11655     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11656     MOVE X'2020233030303131323432' TO DFHEIV0(25:11)
 11657     CALL 'kxdfhei1' USING DFHEIV0,
 11658           FILE-ID-ERPNDB,
 11659           PENDING-BUSINESS,
 11660           DFHEIV11,
 11661           DFHEIV99
 11662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11663
 11664
 11665     PERFORM 8400-LOG-JOURNAL-RECORD.
 11666******************************************************************
 11667*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11668******************************************************************
 11669     display ' made it to update orig cert '
 11670     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11671     MOVE ' '                    TO WS-ERMAIL-SW
 11672
 11673* EXEC CICS READ
 11674*       DATASET   (FILE-ID-ERMAIL)
 11675*       SET       (ADDRESS OF MAILING-DATA)
 11676*       RIDFLD    (ERMAIL-KEY)
 11677*       RESP      (WS-RESPONSE)
 11678*    END-EXEC
 11679*    MOVE '&"S        E          (  N#00011254' TO DFHEIV0
 11680     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11681     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11682     MOVE X'204E233030303131323534' TO DFHEIV0(25:11)
 11683     CALL 'kxdfhei1' USING DFHEIV0,
 11684           FILE-ID-ERMAIL,
 11685           DFHEIV20,
 11686           DFHEIV99,
 11687           ERMAIL-KEY,
 11688           DFHEIV99,
 11689           DFHEIV99,
 11690           DFHEIV99
 11691     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 214
* EL6311.cbl
 11692         DFHEIV20
 11693     MOVE EIBRESP  TO WS-RESPONSE
 11694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11695     IF RESP-NORMAL
 11696        SET ERMAIL-FOUND TO TRUE
 11697     END-IF
 11698
 11699     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11700     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11701                                 TO ELCRTO-KEY
 11702     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11703     MOVE +0                     TO ELCRTO-SEQ-NO
 11704
 11705* EXEC CICS READ
 11706*       DATASET   ('ELCRTO')
 11707*       INTO      (ORIGINAL-CERTIFICATE)
 11708*       RIDFLD    (ELCRTO-KEY)
 11709*       GTEQ
 11710*       RESP      (WS-RESPONSE)
 11711*    END-EXEC
 11712     MOVE LENGTH OF
 11713      ORIGINAL-CERTIFICATE
 11714       TO DFHEIV11
 11715     MOVE 'ELCRTO' TO DFHEIV1
 11716*    MOVE '&"IL       G          (  N#00011269' TO DFHEIV0
 11717     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11718     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11719     MOVE X'204E233030303131323639' TO DFHEIV0(25:11)
 11720     CALL 'kxdfhei1' USING DFHEIV0,
 11721           DFHEIV1,
 11722           ORIGINAL-CERTIFICATE,
 11723           DFHEIV11,
 11724           ELCRTO-KEY,
 11725           DFHEIV99,
 11726           DFHEIV99,
 11727           DFHEIV99
 11728     MOVE EIBRESP  TO WS-RESPONSE
 11729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11730     display ' just read gteq ' ws-response
 11731     IF RESP-NORMAL
 11732        AND (OC-CONTROL-PRIMARY (1:33) =
 11733                 PB-CONTROL-BY-ACCOUNT (1:33))
 11734        AND (OC-RECORD-TYPE = 'I')
 11735        display ' resp norm, key =, type i '
 11736        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11737           display ' end proc blank '
 11738           display ' csr edit session ' PI-CSR-SESSION-SW
 11739           IF NOT CSR-EDIT-SESSION
 11740
 11741* EXEC CICS READ
 11742*                DATASET   ('ELCRTO')
 11743*                INTO      (ORIGINAL-CERTIFICATE)
 11744*                RIDFLD    (OC-CONTROL-PRIMARY)
 11745*                UPDATE
 11746*                RESP      (WS-RESPONSE)
 11747*             END-EXEC
 11748     MOVE LENGTH OF
 11749      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 215
* EL6311.cbl
 11750       TO DFHEIV11
 11751     MOVE 'ELCRTO' TO DFHEIV1
 11752*    MOVE '&"IL       EU         (  N#00011286' TO DFHEIV0
 11753     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11754     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11755     MOVE X'204E233030303131323836' TO DFHEIV0(25:11)
 11756     CALL 'kxdfhei1' USING DFHEIV0,
 11757           DFHEIV1,
 11758           ORIGINAL-CERTIFICATE,
 11759           DFHEIV11,
 11760           OC-CONTROL-PRIMARY,
 11761           DFHEIV99,
 11762           DFHEIV99,
 11763           DFHEIV99
 11764     MOVE EIBRESP  TO WS-RESPONSE
 11765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11766              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11767              IF RESP-NORMAL
 11768                 display ' good read upd '
 11769                 MOVE PB-I-INSURED-LAST-NAME TO
 11770                         OC-INS-LAST-NAME
 11771                 MOVE PB-I-INSURED-FIRST-NAME TO
 11772                         OC-INS-FIRST-NAME
 11773                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11774                         OC-INS-MIDDLE-INIT
 11775                 MOVE PB-I-AGE         TO OC-INS-AGE
 11776                 MOVE PB-I-JOINT-LAST-NAME   TO
 11777                         OC-JNT-LAST-NAME
 11778                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11779                         OC-JNT-FIRST-NAME
 11780                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11781                         OC-JNT-MIDDLE-INIT
 11782                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11783                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11784                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11785                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11786                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11787                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11788                         OC-LF-ALT-BEN-AMT
 11789                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11790                         OC-LF-ALT-PRM-AMT
 11791                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11792                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11793                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11794                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11795                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11796                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11797                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11798                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11799                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11800                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11801                 IF OC-CANCEL-TRAN-IND = 'N'
 11802                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11803                    MOVE +0            TO OC-LF-CANCEL-AMT
 11804                                          OC-LF-ITD-CANCEL-AMT
 11805                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 11806                    MOVE +0            TO OC-AH-CANCEL-AMT
 11807                                          OC-AH-ITD-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 216
* EL6311.cbl
 11808                 END-IF
 11809                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11810                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11811                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11812                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11813                 IF ERMAIL-FOUND
 11814                    MOVE MA-CRED-BENE-NAME
 11815                                 TO OC-CRED-BENE-NAME
 11816                 END-IF
 11817                 IF NOT CERT-TRL-REC-NOT-FOUND
 11818                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11819                           OC-INS-AGE-DEFAULT-FLAG
 11820                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11821                           OC-JNT-AGE-DEFAULT-FLAG
 11822                 END-IF
 11823
 11824* EXEC CICS REWRITE
 11825*                   DATASET   ('ELCRTO')
 11826*                   FROM      (ORIGINAL-CERTIFICATE)
 11827*                   RESP      (WS-RESPONSE)
 11828*                END-EXEC
 11829     MOVE LENGTH OF
 11830      ORIGINAL-CERTIFICATE
 11831       TO DFHEIV11
 11832     MOVE 'ELCRTO' TO DFHEIV1
 11833*    MOVE '&& L                  %  N#00011350' TO DFHEIV0
 11834     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11835     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11836     MOVE X'204E233030303131333530' TO DFHEIV0(25:11)
 11837     CALL 'kxdfhei1' USING DFHEIV0,
 11838           DFHEIV1,
 11839           ORIGINAL-CERTIFICATE,
 11840           DFHEIV11,
 11841           DFHEIV99
 11842     MOVE EIBRESP  TO WS-RESPONSE
 11843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11844                 display ' just rewrote ' ws-response
 11845              END-IF
 11846           END-IF
 11847        ELSE
 11848           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11849           MOVE 'OC'             TO OC-RECORD-ID
 11850           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11851           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11852           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11853           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11854           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11855           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11856           MOVE PB-I-AGE         TO OC-INS-AGE
 11857           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11858           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11859           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11860           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11861           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11862           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11863           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11864           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11865           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 217
* EL6311.cbl
 11866           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11867           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11868           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11869           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11870           MOVE +0               TO OC-LF-CANCEL-AMT
 11871                                    OC-LF-ITD-CANCEL-AMT
 11872           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11873           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11874           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11875           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11876           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11877           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11878           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11879           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11880           MOVE +0               TO OC-AH-CANCEL-AMT
 11881                                    OC-AH-ITD-CANCEL-AMT
 11882           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11883           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11884           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 11885           IF ERMAIL-FOUND
 11886              MOVE MA-CRED-BENE-NAME
 11887                                 TO OC-CRED-BENE-NAME
 11888           END-IF
 11889           IF NOT CERT-TRL-REC-NOT-FOUND
 11890              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11891                           OC-INS-AGE-DEFAULT-FLAG
 11892              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11893                           OC-JNT-AGE-DEFAULT-FLAG
 11894           END-IF
 11895           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11896
 11897* EXEC CICS WRITE
 11898*             DATASET   ('ELCRTO')
 11899*             FROM      (ORIGINAL-CERTIFICATE)
 11900*             RIDFLD    (OC-CONTROL-PRIMARY)
 11901*             RESP      (WS-RESPONSE)
 11902*          END-EXEC
 11903     MOVE LENGTH OF
 11904      ORIGINAL-CERTIFICATE
 11905       TO DFHEIV11
 11906     MOVE 'ELCRTO' TO DFHEIV1
 11907*    MOVE '&$ L                  ''  N#00011407' TO DFHEIV0
 11908     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11909     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11910     MOVE X'204E233030303131343037' TO DFHEIV0(25:11)
 11911     CALL 'kxdfhei1' USING DFHEIV0,
 11912           DFHEIV1,
 11913           ORIGINAL-CERTIFICATE,
 11914           DFHEIV11,
 11915           OC-CONTROL-PRIMARY,
 11916           DFHEIV99,
 11917           DFHEIV99
 11918     MOVE EIBRESP  TO WS-RESPONSE
 11919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11920        END-IF
 11921     ELSE
 11922        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 11923        MOVE 'OC'                TO OC-RECORD-ID
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 218
* EL6311.cbl
 11924        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11925                                 TO OC-CONTROL-PRIMARY (1:33)
 11926        MOVE 'I'                 TO OC-RECORD-TYPE
 11927        MOVE +4096               TO OC-KEY-SEQ-NO
 11928        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 11929        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 11930        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 11931        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11932        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11933        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11934        MOVE PB-I-AGE            TO OC-INS-AGE
 11935        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11936        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11937        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11938        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 11939        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 11940        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 11941        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11942        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11943        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11944        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11945        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 11946        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11947        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 11948        MOVE +0                  TO OC-LF-CANCEL-AMT
 11949                                    OC-LF-ITD-CANCEL-AMT
 11950        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 11951        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 11952        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11953        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11954        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 11955        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 11956        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 11957        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 11958        MOVE +0                  TO OC-AH-CANCEL-AMT
 11959                                    OC-AH-ITD-CANCEL-AMT
 11960        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 11961        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 11962        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 11963        IF ERMAIL-FOUND
 11964           MOVE MA-CRED-BENE-NAME
 11965                                 TO OC-CRED-BENE-NAME
 11966        END-IF
 11967        IF NOT CERT-TRL-REC-NOT-FOUND
 11968           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11969                           OC-INS-AGE-DEFAULT-FLAG
 11970           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11971                           OC-JNT-AGE-DEFAULT-FLAG
 11972        END-IF
 11973        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 11974
 11975* EXEC CICS WRITE
 11976*          DATASET   ('ELCRTO')
 11977*          FROM      (ORIGINAL-CERTIFICATE)
 11978*          RIDFLD    (OC-CONTROL-PRIMARY)
 11979*          RESP      (WS-RESPONSE)
 11980*       END-EXEC
 11981     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 219
* EL6311.cbl
 11982      ORIGINAL-CERTIFICATE
 11983       TO DFHEIV11
 11984     MOVE 'ELCRTO' TO DFHEIV1
 11985*    MOVE '&$ L                  ''  N#00011467' TO DFHEIV0
 11986     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11987     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11988     MOVE X'204E233030303131343637' TO DFHEIV0(25:11)
 11989     CALL 'kxdfhei1' USING DFHEIV0,
 11990           DFHEIV1,
 11991           ORIGINAL-CERTIFICATE,
 11992           DFHEIV11,
 11993           OC-CONTROL-PRIMARY,
 11994           DFHEIV99,
 11995           DFHEIV99
 11996     MOVE EIBRESP  TO WS-RESPONSE
 11997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11998     END-IF
 11999******************************************************************
 12000*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12001******************************************************************
 12002
 12003     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12004     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12005
 12006
 12007* EXEC CICS READ
 12008*        INTO    (PENDING-BUSINESS)
 12009*        DATASET (FILE-ID-ERPNDB)
 12010*        RIDFLD  (ERPNDB-KEY)
 12011*        UPDATE
 12012*    END-EXEC.
 12013     MOVE LENGTH OF
 12014      PENDING-BUSINESS
 12015       TO DFHEIV11
 12016*    MOVE '&"IL       EU         (   #00011481' TO DFHEIV0
 12017     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12018     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12019     MOVE X'2020233030303131343831' TO DFHEIV0(25:11)
 12020     CALL 'kxdfhei1' USING DFHEIV0,
 12021           FILE-ID-ERPNDB,
 12022           PENDING-BUSINESS,
 12023           DFHEIV11,
 12024           ERPNDB-KEY,
 12025           DFHEIV99,
 12026           DFHEIV99,
 12027           DFHEIV99
 12028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12029
 12030
 12031     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12032     MOVE 'B'                    TO JP-RECORD-TYPE.
 12033     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12034
 12035     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12036
 12037     PERFORM 8400-LOG-JOURNAL-RECORD.
 12038
 12039     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 220
* EL6311.cbl
 12040
 12041     MOVE 'C'                    TO JP-RECORD-TYPE.
 12042     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12043
 12044
 12045* EXEC CICS REWRITE
 12046*        DATASET    (FILE-ID-ERPNDB)
 12047*        FROM       (PENDING-BUSINESS)
 12048*    END-EXEC.
 12049     MOVE LENGTH OF
 12050      PENDING-BUSINESS
 12051       TO DFHEIV11
 12052*    MOVE '&& L                  %   #00011501' TO DFHEIV0
 12053     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12054     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12055     MOVE X'2020233030303131353031' TO DFHEIV0(25:11)
 12056     CALL 'kxdfhei1' USING DFHEIV0,
 12057           FILE-ID-ERPNDB,
 12058           PENDING-BUSINESS,
 12059           DFHEIV11,
 12060           DFHEIV99
 12061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12062
 12063
 12064     PERFORM 8400-LOG-JOURNAL-RECORD.
 12065
 12066     IF WS-ERRORS-PRESENT
 12067        GO TO 3900-RE-DISPLAY-RECORD.
 12068
 12069     MOVE ZEROS                  TO EMI-ERROR.
 12070     MOVE -1                     TO BMAINTL.
 12071     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12072     GO TO 3900-RE-DISPLAY-RECORD.
 12073
 12074 1380-BATCH-HDR-NOT-FOUND.
 12075     MOVE -1                     TO BMAINTL.
 12076     MOVE ER-7450                TO EMI-ERROR.
 12077     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12078     GO TO 8200-SEND-DATAONLY.
 12079
 12080 1385-REC-NOT-FOUND.
 12081     MOVE -1                     TO BMAINTL.
 12082     MOVE ER-7451                TO EMI-ERROR.
 12083     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12084     GO TO 8200-SEND-DATAONLY.
 12085
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 221
* EL6311.cbl
 12087
 12088 1386-UPDATE-AGE-FLAGS.
 12089
 12090
 12091* EXEC CICS GETMAIN
 12092*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12093*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12094*        INITIMG (GETMAIN-SPACE)
 12095*    END-EXEC
 12096*    MOVE ',"IL                  $   #00011532' TO DFHEIV0
 12097     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12098     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12099     MOVE X'2020233030303131353332' TO DFHEIV0(25:11)
 12100     CALL 'kxdfhei1' USING DFHEIV0,
 12101           DFHEIV20,
 12102           ELCRTT-RECORD-LENGTH,
 12103           GETMAIN-SPACE
 12104     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12105         DFHEIV20
 12106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12107
 12108
 12109* EXEC CICS HANDLE CONDITION
 12110*        NOTFND   (1386-NOTFND)
 12111*    END-EXEC.
 12112*    MOVE '"$I                   ! ( #00011538' TO DFHEIV0
 12113     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12114     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12115     MOVE X'2820233030303131353338' TO DFHEIV0(25:11)
 12116     CALL 'kxdfhei1' USING DFHEIV0
 12117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12118
 12119
 12120     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12121     MOVE 'C'                TO ELCRTT-REC-TYPE
 12122
 12123
 12124* EXEC CICS READ
 12125*        UPDATE
 12126*        DATASET  (CRTT-ID)
 12127*        RIDFLD   (ELCRTT-KEY)
 12128*        INTO     (CERTIFICATE-TRAILERS)
 12129*    END-EXEC.
 12130     MOVE LENGTH OF
 12131      CERTIFICATE-TRAILERS
 12132       TO DFHEIV11
 12133*    MOVE '&"IL       EU         (   #00011545' TO DFHEIV0
 12134     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12135     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12136     MOVE X'2020233030303131353435' TO DFHEIV0(25:11)
 12137     CALL 'kxdfhei1' USING DFHEIV0,
 12138           CRTT-ID,
 12139           CERTIFICATE-TRAILERS,
 12140           DFHEIV11,
 12141           ELCRTT-KEY,
 12142           DFHEIV99,
 12143           DFHEIV99,
 12144           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 222
* EL6311.cbl
 12145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12146
 12147
 12148     IF WS-INS-AGE-SET = 'Y'
 12149        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12150     END-IF
 12151     IF WS-JNT-AGE-SET = 'Y'
 12152        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12153     END-IF
 12154
 12155
 12156* EXEC CICS REWRITE
 12157*       DATASET  (CRTT-ID)
 12158*       FROM     (CERTIFICATE-TRAILERS)
 12159*    END-EXEC.
 12160     MOVE LENGTH OF
 12161      CERTIFICATE-TRAILERS
 12162       TO DFHEIV11
 12163*    MOVE '&& L                  %   #00011559' TO DFHEIV0
 12164     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12165     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12166     MOVE X'2020233030303131353539' TO DFHEIV0(25:11)
 12167     CALL 'kxdfhei1' USING DFHEIV0,
 12168           CRTT-ID,
 12169           CERTIFICATE-TRAILERS,
 12170           DFHEIV11,
 12171           DFHEIV99
 12172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12173
 12174
 12175     GO TO 1386-EXIT.
 12176
 12177 1386-NOTFND.
 12178
 12179     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12180     MOVE 'CS'         TO CS-RECORD-ID.
 12181     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12182     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12183     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12184     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12185     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12186
 12187* EXEC CICS WRITE
 12188*       DATASET  (CRTT-ID)
 12189*       RIDFLD   (ELCRTT-KEY)
 12190*       FROM     (CERTIFICATE-TRAILERS)
 12191*    END-EXEC.
 12192     MOVE LENGTH OF
 12193      CERTIFICATE-TRAILERS
 12194       TO DFHEIV11
 12195*    MOVE '&$ L                  ''   #00011575' TO DFHEIV0
 12196     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12197     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12198     MOVE X'2020233030303131353735' TO DFHEIV0(25:11)
 12199     CALL 'kxdfhei1' USING DFHEIV0,
 12200           CRTT-ID,
 12201           CERTIFICATE-TRAILERS,
 12202           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 223
* EL6311.cbl
 12203           ELCRTT-KEY,
 12204           DFHEIV99,
 12205           DFHEIV99
 12206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12207
 12208
 12209 1386-EXIT.
 12210     EXIT.
 12211
 12212 1390-UPDATE-ERPNDM.
 12213
 12214
 12215* EXEC CICS HANDLE CONDITION
 12216*        NOTFND (1399-EXIT)
 12217*    END-EXEC.
 12218*    MOVE '"$I                   ! ) #00011586' TO DFHEIV0
 12219     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12220     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12221     MOVE X'2920233030303131353836' TO DFHEIV0(25:11)
 12222     CALL 'kxdfhei1' USING DFHEIV0
 12223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12224
 12225
 12226     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12227
 12228
 12229* EXEC CICS READ
 12230*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12231*        DATASET (FILE-ID-ERPNDM)
 12232*        RIDFLD  (ERPNDM-KEY)
 12233*        UPDATE
 12234*    END-EXEC.
 12235*    MOVE '&"S        EU         (   #00011592' TO DFHEIV0
 12236     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12237     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12238     MOVE X'2020233030303131353932' TO DFHEIV0(25:11)
 12239     CALL 'kxdfhei1' USING DFHEIV0,
 12240           FILE-ID-ERPNDM,
 12241           DFHEIV20,
 12242           DFHEIV99,
 12243           ERPNDM-KEY,
 12244           DFHEIV99,
 12245           DFHEIV99,
 12246           DFHEIV99
 12247     SET ADDRESS OF PENDING-MAILING-DATA TO
 12248         DFHEIV20
 12249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12250
 12251
 12252     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12253     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12254     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12255
 12256     IF BLSTNML GREATER THAN ZEROS
 12257         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12258
 12259     IF B1STNML GREATER  THAN ZEROS
 12260         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 224
* EL6311.cbl
 12261
 12262     IF BINITL GREATER THAN ZEROS
 12263         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12264
 12265     IF BAGEL GREATER THAN ZEROS
 12266         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12267
 12268     IF BBIRTHL GREATER THAN ZEROS
 12269         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12270
 12271     IF BSEXL GREATER THAN ZEROS
 12272         MOVE  BSEXI             TO PM-INSURED-SEX.
 12273
 12274
 12275* EXEC CICS REWRITE
 12276*        DATASET (FILE-ID-ERPNDM)
 12277*        FROM    (PENDING-MAILING-DATA)
 12278*    END-EXEC.
 12279     MOVE LENGTH OF
 12280      PENDING-MAILING-DATA
 12281       TO DFHEIV11
 12282*    MOVE '&& L                  %   #00011621' TO DFHEIV0
 12283     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12284     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12285     MOVE X'2020233030303131363231' TO DFHEIV0(25:11)
 12286     CALL 'kxdfhei1' USING DFHEIV0,
 12287           FILE-ID-ERPNDM,
 12288           PENDING-MAILING-DATA,
 12289           DFHEIV11,
 12290           DFHEIV99
 12291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12292
 12293
 12294 1399-EXIT.
 12295     EXIT.
 12296
 12297******************************************************************
 12298*                                                                *
 12299*          D E L E T E   I S S U E   R O U T I N E               *
 12300*                                                                *
 12301******************************************************************
 12302
 12303 1400-DELETE-ISSUE-ROUTINE.
 12304     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12305
 12306     IF BCHGL NOT = ZEROS
 12307        MOVE ER-2196             TO EMI-ERROR
 12308        MOVE AL-UABON            TO BMAINTA
 12309        MOVE -1                  TO BMAINTL
 12310        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12311        GO TO 8200-SEND-DATAONLY.
 12312
 12313
 12314* EXEC CICS HANDLE CONDITION
 12315*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12316*    END-EXEC.
 12317*    MOVE '"$I                   ! * #00011645' TO DFHEIV0
 12318     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 225
* EL6311.cbl
 12319     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12320     MOVE X'2A20233030303131363435' TO DFHEIV0(25:11)
 12321     CALL 'kxdfhei1' USING DFHEIV0
 12322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12323
 12324
 12325     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12326     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12327     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12328
 12329
 12330* EXEC CICS READ
 12331*        SET     (ADDRESS OF PENDING-BUSINESS)
 12332*        DATASET (FILE-ID-ERPNDB)
 12333*        RIDFLD  (ERPNDB-KEY)
 12334*    END-EXEC.
 12335*    MOVE '&"S        E          (   #00011653' TO DFHEIV0
 12336     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12337     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12338     MOVE X'2020233030303131363533' TO DFHEIV0(25:11)
 12339     CALL 'kxdfhei1' USING DFHEIV0,
 12340           FILE-ID-ERPNDB,
 12341           DFHEIV20,
 12342           DFHEIV99,
 12343           ERPNDB-KEY,
 12344           DFHEIV99,
 12345           DFHEIV99,
 12346           DFHEIV99
 12347     SET ADDRESS OF PENDING-BUSINESS TO
 12348         DFHEIV20
 12349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12350
 12351
 12352     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12353
 12354     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12355
 12356     IF BSUFIXL NOT = ZEROS
 12357        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12358     ELSE
 12359        MOVE SPACE               TO WS-NEW-SUFFIX.
 12360
 12361     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12362     PERFORM 8600-DEEDIT.
 12363     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12364     MOVE '4'                    TO DC-OPTION-CODE.
 12365     PERFORM 9700-DATE-LINK.
 12366     IF DATE-CONVERSION-ERROR
 12367        MOVE ER-0348             TO EMI-ERROR
 12368        MOVE -1                  TO BEFFDTL
 12369        MOVE AL-UABON            TO BEFFDTA
 12370        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12371        GO TO 8200-SEND-DATAONLY
 12372     ELSE
 12373        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12374        MOVE AL-UANON            TO BEFFDTA
 12375        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12376
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 226
* EL6311.cbl
 12377
 12378* EXEC CICS HANDLE CONDITION
 12379*         NOTFND    (1490-RECORD-NOT-FOUND)
 12380*    END-EXEC.
 12381*    MOVE '"$I                   ! + #00011684' TO DFHEIV0
 12382     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12383     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12384     MOVE X'2B20233030303131363834' TO DFHEIV0(25:11)
 12385     CALL 'kxdfhei1' USING DFHEIV0
 12386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12387
 12388
 12389
 12390* EXEC CICS READ
 12391*        SET     (ADDRESS OF PENDING-BUSINESS)
 12392*        DATASET (FILE-ID-ERPNDB)
 12393*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12394*        UPDATE
 12395*    END-EXEC.
 12396*    MOVE '&"S        EU         (   #00011688' TO DFHEIV0
 12397     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12398     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12399     MOVE X'2020233030303131363838' TO DFHEIV0(25:11)
 12400     CALL 'kxdfhei1' USING DFHEIV0,
 12401           FILE-ID-ERPNDB,
 12402           DFHEIV20,
 12403           DFHEIV99,
 12404           PI-PREV-CONTROL-PRIMARY,
 12405           DFHEIV99,
 12406           DFHEIV99,
 12407           DFHEIV99
 12408     SET ADDRESS OF PENDING-BUSINESS TO
 12409         DFHEIV20
 12410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12411
 12412
 12413     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12414        MOVE -1                 TO BMAINTL
 12415        MOVE ER-2197            TO EMI-ERROR
 12416        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12417        GO TO 8200-SEND-DATAONLY.
 12418
 12419     IF PB-BILLED-DT NOT = LOW-VALUES
 12420        MOVE -1                 TO BMAINTL
 12421        MOVE ER-2129            TO EMI-ERROR
 12422        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12423        GO TO 8200-SEND-DATAONLY.
 12424
 12425     IF PB-CHG-COUNT NOT = ZEROS
 12426        MOVE ER-2336            TO EMI-ERROR
 12427        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12428        MOVE AL-UABON            TO BMAINTA
 12429        MOVE -1                  TO BMAINTL
 12430        GO TO 8200-SEND-DATAONLY.
 12431
 12432     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12433        PB-CHG-COUNT NOT = ZEROS
 12434        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 227
* EL6311.cbl
 12435        MOVE AL-UABON            TO BMAINTA
 12436        MOVE -1                  TO BMAINTL
 12437        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12438        GO TO 8200-SEND-DATAONLY.
 12439******************************************************************
 12440*                                                                *
 12441*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12442*                                                                *
 12443******************************************************************
 12444     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12445     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12446     MOVE +0                     TO ELCRTO-SEQ-NO
 12447
 12448* EXEC CICS READ
 12449*       DATASET   ('ELCRTO')
 12450*       INTO      (ORIGINAL-CERTIFICATE)
 12451*       RIDFLD    (ELCRTO-KEY)
 12452*       GTEQ
 12453*       RESP      (WS-RESPONSE)
 12454*    END-EXEC
 12455     MOVE LENGTH OF
 12456      ORIGINAL-CERTIFICATE
 12457       TO DFHEIV11
 12458     MOVE 'ELCRTO' TO DFHEIV1
 12459*    MOVE '&"IL       G          (  N#00011729' TO DFHEIV0
 12460     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12461     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12462     MOVE X'204E233030303131373239' TO DFHEIV0(25:11)
 12463     CALL 'kxdfhei1' USING DFHEIV0,
 12464           DFHEIV1,
 12465           ORIGINAL-CERTIFICATE,
 12466           DFHEIV11,
 12467           ELCRTO-KEY,
 12468           DFHEIV99,
 12469           DFHEIV99,
 12470           DFHEIV99
 12471     MOVE EIBRESP  TO WS-RESPONSE
 12472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12473     IF RESP-NORMAL
 12474        AND (OC-CONTROL-PRIMARY (1:33) =
 12475                 PB-CONTROL-BY-ACCOUNT (1:33))
 12476        AND (OC-RECORD-TYPE = 'I')
 12477
 12478* EXEC CICS READ
 12479*          DATASET   ('ELCRTO')
 12480*          INTO      (ORIGINAL-CERTIFICATE)
 12481*          RIDFLD    (ELCRTO-KEY)
 12482*          UPDATE
 12483*          RESP      (WS-RESPONSE)
 12484*       END-EXEC
 12485     MOVE LENGTH OF
 12486      ORIGINAL-CERTIFICATE
 12487       TO DFHEIV11
 12488     MOVE 'ELCRTO' TO DFHEIV1
 12489*    MOVE '&"IL       EU         (  N#00011740' TO DFHEIV0
 12490     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12491     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12492     MOVE X'204E233030303131373430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 228
* EL6311.cbl
 12493     CALL 'kxdfhei1' USING DFHEIV0,
 12494           DFHEIV1,
 12495           ORIGINAL-CERTIFICATE,
 12496           DFHEIV11,
 12497           ELCRTO-KEY,
 12498           DFHEIV99,
 12499           DFHEIV99,
 12500           DFHEIV99
 12501     MOVE EIBRESP  TO WS-RESPONSE
 12502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12503        IF RESP-NORMAL
 12504
 12505* EXEC CICS DELETE
 12506*             DATASET   ('ELCRTO')
 12507*          END-EXEC
 12508     MOVE 'ELCRTO' TO DFHEIV1
 12509*    MOVE '&(                    &   #00011748' TO DFHEIV0
 12510     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12511     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12512     MOVE X'2020233030303131373438' TO DFHEIV0(25:11)
 12513     CALL 'kxdfhei1' USING DFHEIV0,
 12514           DFHEIV1,
 12515           DFHEIV99,
 12516           DFHEIV99,
 12517           DFHEIV99,
 12518           DFHEIV99
 12519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12520        END-IF
 12521     END-IF
 12522******************************************************************
 12523*                                                                *
 12524*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12525*                                                                *
 12526******************************************************************
 12527
 12528* EXEC CICS HANDLE CONDITION
 12529*        NOTFND    (1405-DELETE-CERTIFICATE)
 12530*    END-EXEC.
 12531*    MOVE '"$I                   ! , #00011758' TO DFHEIV0
 12532     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12533     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12534     MOVE X'2C20233030303131373538' TO DFHEIV0(25:11)
 12535     CALL 'kxdfhei1' USING DFHEIV0
 12536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12537
 12538
 12539
 12540* EXEC CICS READ
 12541*        EQUAL
 12542*        DATASET   (FILE-ID-ERPNDM)
 12543*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12544*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12545*        UPDATE
 12546*    END-EXEC.
 12547*    MOVE '&"S        EU         (   #00011762' TO DFHEIV0
 12548     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12549     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12550     MOVE X'2020233030303131373632' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 229
* EL6311.cbl
 12551     CALL 'kxdfhei1' USING DFHEIV0,
 12552           FILE-ID-ERPNDM,
 12553           DFHEIV20,
 12554           DFHEIV99,
 12555           PI-PREV-CONTROL-PRIMARY,
 12556           DFHEIV99,
 12557           DFHEIV99,
 12558           DFHEIV99
 12559     SET ADDRESS OF PENDING-MAILING-DATA TO
 12560         DFHEIV20
 12561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12562
 12563
 12564     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12565     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12566     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12567
 12568     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12569
 12570
 12571* EXEC CICS DELETE
 12572*        DATASET   (FILE-ID-ERPNDM)
 12573*    END-EXEC.
 12574*    MOVE '&(                    &   #00011776' TO DFHEIV0
 12575     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12576     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12577     MOVE X'2020233030303131373736' TO DFHEIV0(25:11)
 12578     CALL 'kxdfhei1' USING DFHEIV0,
 12579           FILE-ID-ERPNDM,
 12580           DFHEIV99,
 12581           DFHEIV99,
 12582           DFHEIV99,
 12583           DFHEIV99
 12584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12585
 12586
 12587******************************************************************
 12588*                PROCESS   CERTIFICATE                           *
 12589******************************************************************
 12590
 12591 1405-DELETE-CERTIFICATE.
 12592
 12593* EXEC CICS HANDLE CONDITION
 12594*         NOTFND  (1420-CONTINUE-DELETE)
 12595*    END-EXEC.
 12596*    MOVE '"$I                   ! - #00011785' TO DFHEIV0
 12597     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12598     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12599     MOVE X'2D20233030303131373835' TO DFHEIV0(25:11)
 12600     CALL 'kxdfhei1' USING DFHEIV0
 12601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12602
 12603
 12604     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12605     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12606     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12607     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12608
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 230
* EL6311.cbl
 12609
 12610* EXEC CICS READ
 12611*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12612*        DATASET (FILE-ID-ELCERT)
 12613*        RIDFLD  (ELCERT-KEY)
 12614*        UPDATE
 12615*    END-EXEC.
 12616*    MOVE '&"S        EU         (   #00011794' TO DFHEIV0
 12617     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12618     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12619     MOVE X'2020233030303131373934' TO DFHEIV0(25:11)
 12620     CALL 'kxdfhei1' USING DFHEIV0,
 12621           FILE-ID-ELCERT,
 12622           DFHEIV20,
 12623           DFHEIV99,
 12624           ELCERT-KEY,
 12625           DFHEIV99,
 12626           DFHEIV99,
 12627           DFHEIV99
 12628     SET ADDRESS OF CERTIFICATE-MASTER TO
 12629         DFHEIV20
 12630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12631
 12632
 12633     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12634
 12635     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12636     MOVE 'B'                    TO JP-RECORD-TYPE
 12637     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12638
 12639     PERFORM 8400-LOG-JOURNAL-RECORD.
 12640
 12641     IF CERT-NOTES-ARE-NOT-PRESENT
 12642        MOVE ' '                 TO WS-CERT-NOTE-SW
 12643     ELSE
 12644        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12645
 12646     IF INSURED-ADDR-PRESENT
 12647        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12648
 12649******************************************************************
 12650******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12651******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12652******************************************************************
 12653******************************************************************
 12654
 12655     IF CERT-ADDED-BATCH AND
 12656        (NOT NO-CLAIM-ATTACHED
 12657         OR
 12658         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12659        GO TO 1410-REWRITE-CERT.
 12660
 12661******************************************************************
 12662******************************************************************
 12663
 12664     IF CERT-ADDED-BATCH  AND
 12665        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12666        GO TO 1410-REWRITE-CERT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 231
* EL6311.cbl
 12667
 12668     IF NO-CLAIM-ATTACHED
 12669        NEXT SENTENCE
 12670     ELSE
 12671        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12672        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12673        GO TO 1410-REWRITE-CERT.
 12674
 12675     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12676     MOVE 'D'                      TO JP-RECORD-TYPE.
 12677     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12678
 12679
 12680* EXEC CICS DELETE
 12681*         DATASET    (FILE-ID-ELCERT)
 12682*    END-EXEC.
 12683*    MOVE '&(                    &   #00011847' TO DFHEIV0
 12684     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12685     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12686     MOVE X'2020233030303131383437' TO DFHEIV0(25:11)
 12687     CALL 'kxdfhei1' USING DFHEIV0,
 12688           FILE-ID-ELCERT,
 12689           DFHEIV99,
 12690           DFHEIV99,
 12691           DFHEIV99,
 12692           DFHEIV99
 12693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12694
 12695
 12696     PERFORM 8400-LOG-JOURNAL-RECORD.
 12697
 12698******************************************************************
 12699*                                                                *
 12700*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12701*                                                                *
 12702******************************************************************
 12703
 12704     IF  CERT-NOTES-ARE-PRESENT
 12705         NEXT SENTENCE
 12706     ELSE
 12707         GO TO 1407-DELETE-MAILING.
 12708
 12709
 12710* EXEC CICS HANDLE CONDITION
 12711*         NOTFND  (1406-DELETE-ERNOTE)
 12712*    END-EXEC.
 12713*    MOVE '"$I                   ! . #00011864' TO DFHEIV0
 12714     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12715     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12716     MOVE X'2E20233030303131383634' TO DFHEIV0(25:11)
 12717     CALL 'kxdfhei1' USING DFHEIV0
 12718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12719
 12720
 12721     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12722     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12723     MOVE 0                     TO ERCNOT-SEQUENCE.
 12724
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 232
* EL6311.cbl
 12725 1406-DELETE-ERCNOT-LOOP.
 12726
 12727
 12728* EXEC CICS READ
 12729*        GTEQ
 12730*        DATASET   (FILE-ID-ERCNOT)
 12731*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12732*        RIDFLD    (ERCNOT-KEY)
 12733*    END-EXEC.
 12734*    MOVE '&"S        G          (   #00011874' TO DFHEIV0
 12735     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12736     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12737     MOVE X'2020233030303131383734' TO DFHEIV0(25:11)
 12738     CALL 'kxdfhei1' USING DFHEIV0,
 12739           FILE-ID-ERCNOT,
 12740           DFHEIV20,
 12741           DFHEIV99,
 12742           ERCNOT-KEY,
 12743           DFHEIV99,
 12744           DFHEIV99,
 12745           DFHEIV99
 12746     SET ADDRESS OF CERT-NOTE-FILE TO
 12747         DFHEIV20
 12748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12749
 12750
 12751     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12752     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12753         GO TO 1406-DELETE-ERNOTE
 12754     END-IF.
 12755
 12756     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12757     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12758     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12759
 12760     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12761
 12762
 12763* EXEC CICS DELETE
 12764*        DATASET   (FILE-ID-ERCNOT)
 12765*        RIDFLD    (ERCNOT-KEY)
 12766*        END-EXEC.
 12767*    MOVE '&(  R                 &   #00011892' TO DFHEIV0
 12768     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12769     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12770     MOVE X'2020233030303131383932' TO DFHEIV0(25:11)
 12771     CALL 'kxdfhei1' USING DFHEIV0,
 12772           FILE-ID-ERCNOT,
 12773           ERCNOT-KEY,
 12774           DFHEIV99,
 12775           DFHEIV99,
 12776           DFHEIV99
 12777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12778
 12779
 12780     PERFORM 8400-LOG-JOURNAL-RECORD.
 12781
 12782     GO TO 1406-DELETE-ERCNOT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 233
* EL6311.cbl
 12783
 12784 1406-DELETE-ERNOTE.
 12785
 12786
 12787* EXEC CICS HANDLE CONDITION
 12788*         NOTFND  (1407-DELETE-MAILING)
 12789*    END-EXEC.
 12790*    MOVE '"$I                   ! / #00011903' TO DFHEIV0
 12791     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12792     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12793     MOVE X'2F20233030303131393033' TO DFHEIV0(25:11)
 12794     CALL 'kxdfhei1' USING DFHEIV0
 12795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12796
 12797
 12798
 12799* EXEC CICS READ
 12800*        EQUAL
 12801*        DATASET   (FILE-ID-ERNOTE)
 12802*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12803*        RIDFLD    (ELCERT-KEY)
 12804*        UPDATE
 12805*    END-EXEC.
 12806*    MOVE '&"S        EU         (   #00011907' TO DFHEIV0
 12807     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12808     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12809     MOVE X'2020233030303131393037' TO DFHEIV0(25:11)
 12810     CALL 'kxdfhei1' USING DFHEIV0,
 12811           FILE-ID-ERNOTE,
 12812           DFHEIV20,
 12813           DFHEIV99,
 12814           ELCERT-KEY,
 12815           DFHEIV99,
 12816           DFHEIV99,
 12817           DFHEIV99
 12818     SET ADDRESS OF CERTIFICATE-NOTE TO
 12819         DFHEIV20
 12820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12821
 12822
 12823     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12824     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12825     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12826
 12827     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12828
 12829
 12830* EXEC CICS DELETE
 12831*        DATASET   (FILE-ID-ERNOTE)
 12832*        END-EXEC.
 12833*    MOVE '&(                    &   #00011921' TO DFHEIV0
 12834     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12835     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12836     MOVE X'2020233030303131393231' TO DFHEIV0(25:11)
 12837     CALL 'kxdfhei1' USING DFHEIV0,
 12838           FILE-ID-ERNOTE,
 12839           DFHEIV99,
 12840           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 234
* EL6311.cbl
 12841           DFHEIV99,
 12842           DFHEIV99
 12843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12844
 12845
 12846     PERFORM 8400-LOG-JOURNAL-RECORD.
 12847
 12848******************************************************************
 12849*                                                                *
 12850*                DELETE MAILING ADDRESS RECORDS                  *
 12851*                                                                *
 12852******************************************************************
 12853
 12854 1407-DELETE-MAILING.
 12855     IF CERT-ADDRESS-PRESENT
 12856        NEXT SENTENCE
 12857     ELSE
 12858        GO TO 1420-CONTINUE-DELETE.
 12859
 12860
 12861* EXEC CICS HANDLE CONDITION
 12862*         NOTFND  (1420-CONTINUE-DELETE)
 12863*    END-EXEC.
 12864*    MOVE '"$I                   ! 0 #00011939' TO DFHEIV0
 12865     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12866     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12867     MOVE X'3020233030303131393339' TO DFHEIV0(25:11)
 12868     CALL 'kxdfhei1' USING DFHEIV0
 12869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12870
 12871
 12872
 12873* EXEC CICS READ
 12874*        EQUAL
 12875*        DATASET   (FILE-ID-ERMAIL)
 12876*        SET       (ADDRESS OF MAILING-DATA)
 12877*        RIDFLD    (ELCERT-KEY)
 12878*        UPDATE
 12879*    END-EXEC.
 12880*    MOVE '&"S        EU         (   #00011943' TO DFHEIV0
 12881     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12882     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12883     MOVE X'2020233030303131393433' TO DFHEIV0(25:11)
 12884     CALL 'kxdfhei1' USING DFHEIV0,
 12885           FILE-ID-ERMAIL,
 12886           DFHEIV20,
 12887           DFHEIV99,
 12888           ELCERT-KEY,
 12889           DFHEIV99,
 12890           DFHEIV99,
 12891           DFHEIV99
 12892     SET ADDRESS OF MAILING-DATA TO
 12893         DFHEIV20
 12894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12895
 12896
 12897     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12898     MOVE 'D'                    TO  JP-RECORD-TYPE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 235
* EL6311.cbl
 12899     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12900
 12901     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12902
 12903
 12904* EXEC CICS DELETE
 12905*        DATASET   (FILE-ID-ERMAIL)
 12906*    END-EXEC.
 12907*    MOVE '&(                    &   #00011957' TO DFHEIV0
 12908     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12909     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12910     MOVE X'2020233030303131393537' TO DFHEIV0(25:11)
 12911     CALL 'kxdfhei1' USING DFHEIV0,
 12912           FILE-ID-ERMAIL,
 12913           DFHEIV99,
 12914           DFHEIV99,
 12915           DFHEIV99,
 12916           DFHEIV99
 12917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12918
 12919
 12920     GO TO 1420-CONTINUE-DELETE.
 12921
 12922 1410-REWRITE-CERT.
 12923     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12924     MOVE 'C'                      TO JP-RECORD-TYPE.
 12925     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12926     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12927
 12928
 12929* EXEC CICS REWRITE
 12930*         DATASET    (FILE-ID-ELCERT)
 12931*         FROM       (CERTIFICATE-MASTER)
 12932*         END-EXEC.
 12933     MOVE LENGTH OF
 12934      CERTIFICATE-MASTER
 12935       TO DFHEIV11
 12936*    MOVE '&& L                  %   #00011969' TO DFHEIV0
 12937     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12938     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12939     MOVE X'2020233030303131393639' TO DFHEIV0(25:11)
 12940     CALL 'kxdfhei1' USING DFHEIV0,
 12941           FILE-ID-ELCERT,
 12942           CERTIFICATE-MASTER,
 12943           DFHEIV11,
 12944           DFHEIV99
 12945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12946
 12947
 12948     PERFORM 8400-LOG-JOURNAL-RECORD.
 12949
 12950 1420-CONTINUE-DELETE.
 12951     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 12952     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 12953
 12954     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 12955     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 12956
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 236
* EL6311.cbl
 12957     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 12958
 12959 1450-DELETE-PB-RECORD.
 12960     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 12961     MOVE 'D'                      TO JP-RECORD-TYPE
 12962     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 12963
 12964
 12965* EXEC CICS DELETE
 12966*        DATASET    (FILE-ID-ERPNDB)
 12967*    END-EXEC.
 12968*    MOVE '&(                    &   #00011990' TO DFHEIV0
 12969     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12970     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12971     MOVE X'2020233030303131393930' TO DFHEIV0(25:11)
 12972     CALL 'kxdfhei1' USING DFHEIV0,
 12973           FILE-ID-ERPNDB,
 12974           DFHEIV99,
 12975           DFHEIV99,
 12976           DFHEIV99,
 12977           DFHEIV99
 12978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12979
 12980
 12981     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12982
 12983     PERFORM 8400-LOG-JOURNAL-RECORD.
 12984
 12985     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12986     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12987     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12988
 12989
 12990* EXEC CICS HANDLE CONDITION
 12991*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12992*    END-EXEC.
 12993*    MOVE '"$I                   ! 1 #00012002' TO DFHEIV0
 12994     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12995     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12996     MOVE X'3120233030303132303032' TO DFHEIV0(25:11)
 12997     CALL 'kxdfhei1' USING DFHEIV0
 12998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12999
 13000
 13001
 13002* EXEC CICS READ
 13003*        SET     (ADDRESS OF PENDING-BUSINESS)
 13004*        DATASET (FILE-ID-ERPNDB)
 13005*        RIDFLD  (ERPNDB-KEY)
 13006*        UPDATE
 13007*    END-EXEC.
 13008*    MOVE '&"S        EU         (   #00012006' TO DFHEIV0
 13009     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13010     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13011     MOVE X'2020233030303132303036' TO DFHEIV0(25:11)
 13012     CALL 'kxdfhei1' USING DFHEIV0,
 13013           FILE-ID-ERPNDB,
 13014           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 237
* EL6311.cbl
 13015           DFHEIV99,
 13016           ERPNDB-KEY,
 13017           DFHEIV99,
 13018           DFHEIV99,
 13019           DFHEIV99
 13020     SET ADDRESS OF PENDING-BUSINESS TO
 13021         DFHEIV20
 13022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13023
 13024
 13025     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13026
 13027     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13028
 13029     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13030        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13031        MOVE 'D'                   TO JP-RECORD-TYPE
 13032        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13033
 13034* EXEC CICS DELETE
 13035*            DATASET    (FILE-ID-ERPNDB)
 13036*       END-EXEC
 13037*    MOVE '&(                    &   #00012021' TO DFHEIV0
 13038     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13039     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13040     MOVE X'2020233030303132303231' TO DFHEIV0(25:11)
 13041     CALL 'kxdfhei1' USING DFHEIV0,
 13042           FILE-ID-ERPNDB,
 13043           DFHEIV99,
 13044           DFHEIV99,
 13045           DFHEIV99,
 13046           DFHEIV99
 13047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13048        PERFORM 8400-LOG-JOURNAL-RECORD
 13049     ELSE
 13050        MOVE 'B'                 TO JP-RECORD-TYPE
 13051        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13052        PERFORM 8400-LOG-JOURNAL-RECORD
 13053        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13054        MOVE 'C'                 TO JP-RECORD-TYPE
 13055        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13056
 13057* EXEC CICS REWRITE
 13058*            DATASET    (FILE-ID-ERPNDB)
 13059*            FROM       (PENDING-BUSINESS)
 13060*       END-EXEC
 13061     MOVE LENGTH OF
 13062      PENDING-BUSINESS
 13063       TO DFHEIV11
 13064*    MOVE '&& L                  %   #00012032' TO DFHEIV0
 13065     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13066     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13067     MOVE X'2020233030303132303332' TO DFHEIV0(25:11)
 13068     CALL 'kxdfhei1' USING DFHEIV0,
 13069           FILE-ID-ERPNDB,
 13070           PENDING-BUSINESS,
 13071           DFHEIV11,
 13072           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 238
* EL6311.cbl
 13073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13074        PERFORM 8400-LOG-JOURNAL-RECORD.
 13075
 13076******************************************************************
 13077*                                                                *
 13078*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13079*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13080*                                                                *
 13081******************************************************************
 13082
 13083     IF NOT PI-AR-PROCESSING
 13084        GO TO 1475-DELETE-FINISHED.
 13085
 13086     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13087        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13088        NEXT SENTENCE
 13089     ELSE
 13090        GO TO 1475-DELETE-FINISHED.
 13091
 13092
 13093* EXEC CICS HANDLE CONDITION
 13094*         NOTFND    (1475-DELETE-FINISHED)
 13095*         END-EXEC.
 13096*    MOVE '"$I                   ! 2 #00012054' TO DFHEIV0
 13097     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13098     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13099     MOVE X'3220233030303132303534' TO DFHEIV0(25:11)
 13100     CALL 'kxdfhei1' USING DFHEIV0
 13101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13102
 13103
 13104     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13105     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13106
 13107
 13108* EXEC CICS READ
 13109*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13110*        DATASET (FILE-ID-ERRQST)
 13111*        RIDFLD  (ERRQST-KEY)
 13112*        UPDATE
 13113*    END-EXEC.
 13114*    MOVE '&"S        EU         (   #00012061' TO DFHEIV0
 13115     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13116     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13117     MOVE X'2020233030303132303631' TO DFHEIV0(25:11)
 13118     CALL 'kxdfhei1' USING DFHEIV0,
 13119           FILE-ID-ERRQST,
 13120           DFHEIV20,
 13121           DFHEIV99,
 13122           ERRQST-KEY,
 13123           DFHEIV99,
 13124           DFHEIV99,
 13125           DFHEIV99
 13126     SET ADDRESS OF AR-REQUEST-RECORD TO
 13127         DFHEIV20
 13128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13129
 13130
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 239
* EL6311.cbl
 13131     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13132
 13133     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13134
 13135     MOVE 'D'                      TO JP-RECORD-TYPE.
 13136     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13137
 13138
 13139* EXEC CICS DELETE
 13140*         DATASET    (FILE-ID-ERRQST)
 13141*    END-EXEC.
 13142*    MOVE '&(                    &   #00012075' TO DFHEIV0
 13143     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13144     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13145     MOVE X'2020233030303132303735' TO DFHEIV0(25:11)
 13146     CALL 'kxdfhei1' USING DFHEIV0,
 13147           FILE-ID-ERRQST,
 13148           DFHEIV99,
 13149           DFHEIV99,
 13150           DFHEIV99,
 13151           DFHEIV99
 13152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13153
 13154
 13155     PERFORM 8400-LOG-JOURNAL-RECORD.
 13156
 13157 1475-DELETE-FINISHED.
 13158     MOVE ZEROS                  TO EMI-ERROR.
 13159     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13160     MOVE LOW-VALUES             TO EL631BI.
 13161     MOVE -1                     TO BMAINTL.
 13162     GO TO 8100-SEND-INITIAL-MAP.
 13163
 13164 1480-BATCH-HDR-NOT-FOUND.
 13165     MOVE -1                     TO BMAINTL.
 13166     MOVE ER-7450                TO EMI-ERROR.
 13167     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13168     GO TO 8200-SEND-DATAONLY.
 13169
 13170 1490-RECORD-NOT-FOUND.
 13171     MOVE -1                     TO BMAINTL.
 13172     MOVE ER-7451                TO EMI-ERROR.
 13173     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13174     GO TO 8200-SEND-DATAONLY.
 13175
 13176******************************************************************
 13177*            O V E R   C H A R G E   P R O C E S S I N G         *
 13178******************************************************************
 13179 1500-UPDATE-ERNOTE.
 13180     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13181     MOVE 'A'                    TO WS-NOTE-SW
 13182     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13183     .
 13184 1500-EXIT.
 13185     EXIT.
 13186 1510-ADD-ERNOTE-REC.
 13187
 13188* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 240
* EL6311.cbl
 13189*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13190*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13191*        INITIMG (GETMAIN-SPACE)
 13192*    END-EXEC
 13193*    MOVE ',"IL                  $   #00012111' TO DFHEIV0
 13194     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13195     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13196     MOVE X'2020233030303132313131' TO DFHEIV0(25:11)
 13197     CALL 'kxdfhei1' USING DFHEIV0,
 13198           DFHEIV20,
 13199           ERNOTE-RECORD-LENGTH,
 13200           GETMAIN-SPACE
 13201     SET ADDRESS OF CERTIFICATE-NOTE TO
 13202         DFHEIV20
 13203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13204     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13205                                 TO ERNOTE-KEY
 13206
 13207* EXEC CICS READ
 13208*       DATASET    (FILE-ID-ERNOTE)
 13209*       RIDFLD     (ERNOTE-KEY)
 13210*       INTO       (CERTIFICATE-NOTE)
 13211*       RESP       (WS-RESPONSE)
 13212*       UPDATE
 13213*    END-EXEC
 13214     MOVE LENGTH OF
 13215      CERTIFICATE-NOTE
 13216       TO DFHEIV11
 13217*    MOVE '&"IL       EU         (  N#00012118' TO DFHEIV0
 13218     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13219     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13220     MOVE X'204E233030303132313138' TO DFHEIV0(25:11)
 13221     CALL 'kxdfhei1' USING DFHEIV0,
 13222           FILE-ID-ERNOTE,
 13223           CERTIFICATE-NOTE,
 13224           DFHEIV11,
 13225           ERNOTE-KEY,
 13226           DFHEIV99,
 13227           DFHEIV99,
 13228           DFHEIV99
 13229     MOVE EIBRESP  TO WS-RESPONSE
 13230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13231     IF RESP-NORMAL
 13232        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13233           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13234        END-IF
 13235        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13236           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13237        END-IF
 13238        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13239           (N1 > +10)
 13240           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13241           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13242        END-PERFORM
 13243        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13244          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13245
 13246* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 241
* EL6311.cbl
 13247*            DATASET    (FILE-ID-ERNOTE)
 13248*          END-EXEC
 13249*    MOVE '&*                    #   #00012139' TO DFHEIV0
 13250     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13251     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13252     MOVE X'2020233030303132313339' TO DFHEIV0(25:11)
 13253     CALL 'kxdfhei1' USING DFHEIV0,
 13254           FILE-ID-ERNOTE,
 13255           DFHEIV99
 13256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13257        ELSE
 13258          PERFORM VARYING N1 FROM +1 BY +1
 13259           UNTIL (N1 > +10)
 13260           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13261          END-PERFORM
 13262          IF (N1 < +11)
 13263            IF N1 >= CN-BILLING-START-LINE-NO AND
 13264              N1 <= CN-BILLING-END-LINE-NO
 13265              IF PI-COMPANY-ID = 'DCC'
 13266                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13267              ELSE
 13268                 MOVE WS-VA-NO-COMM-MESS
 13269                                    TO CN-LINE (N1)
 13270              END-IF
 13271            ELSE
 13272              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13273               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13274                IF PI-COMPANY-ID = 'DCC'
 13275                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13276                ELSE
 13277                  MOVE WS-VA-NO-COMM-MESS
 13278                                    TO CN-LINE (N1)
 13279                END-IF
 13280                MOVE N1             TO CN-BILLING-END-LINE-NO
 13281              ELSE
 13282                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13283                  IF PI-COMPANY-ID = 'DCC'
 13284                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13285                  ELSE
 13286                     MOVE WS-VA-NO-COMM-MESS
 13287                                    TO CN-LINE (N1)
 13288                  END-IF
 13289                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13290                                      CN-BILLING-START-LINE-NO
 13291                ELSE
 13292                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13293                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13294                     IF PI-COMPANY-ID = 'DCC'
 13295                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13296                     ELSE
 13297                       MOVE WS-VA-NO-COMM-MESS
 13298                                    TO CN-LINE (N1)
 13299                     END-IF
 13300                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13301                  ELSE
 13302                     PERFORM 1700-SQUEEZE-IT-IN
 13303                                 THRU 1700-EXIT
 13304                  END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 242
* EL6311.cbl
 13305                END-IF
 13306              END-IF
 13307            END-IF
 13308            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13309            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13310            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13311
 13312* EXEC CICS REWRITE
 13313*              DATASET    (FILE-ID-ERNOTE)
 13314*              FROM       (CERTIFICATE-NOTE)
 13315*              RESP       (WS-RESPONSE)
 13316*           END-EXEC
 13317     MOVE LENGTH OF
 13318      CERTIFICATE-NOTE
 13319       TO DFHEIV11
 13320*    MOVE '&& L                  %  N#00012196' TO DFHEIV0
 13321     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13322     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13323     MOVE X'204E233030303132313936' TO DFHEIV0(25:11)
 13324     CALL 'kxdfhei1' USING DFHEIV0,
 13325           FILE-ID-ERNOTE,
 13326           CERTIFICATE-NOTE,
 13327           DFHEIV11,
 13328           DFHEIV99
 13329     MOVE EIBRESP  TO WS-RESPONSE
 13330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13331          END-IF
 13332        END-IF
 13333     ELSE
 13334        MOVE SPACES              TO CERTIFICATE-NOTE
 13335        MOVE 'CN'                TO CN-RECORD-ID
 13336        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13337                                 TO CN-CONTROL-PRIMARY
 13338                                    ERNOTE-KEY
 13339        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13340                                    CN-BILLING-END-LINE-NO
 13341        IF PI-COMPANY-ID = 'DCC'
 13342           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13343        ELSE
 13344           MOVE WS-VA-NO-COMM-MESS
 13345                                 TO CN-LINE (1)
 13346        END-IF
 13347        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13348        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13349        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13350
 13351* EXEC CICS WRITE
 13352*          DATASET    (FILE-ID-ERNOTE)
 13353*          FROM       (CERTIFICATE-NOTE)
 13354*          RIDFLD     (ERNOTE-KEY)
 13355*          RESP       (WS-RESPONSE)
 13356*       END-EXEC
 13357     MOVE LENGTH OF
 13358      CERTIFICATE-NOTE
 13359       TO DFHEIV11
 13360*    MOVE '&$ L                  ''  N#00012220' TO DFHEIV0
 13361     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13362     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 243
* EL6311.cbl
 13363     MOVE X'204E233030303132323230' TO DFHEIV0(25:11)
 13364     CALL 'kxdfhei1' USING DFHEIV0,
 13365           FILE-ID-ERNOTE,
 13366           CERTIFICATE-NOTE,
 13367           DFHEIV11,
 13368           ERNOTE-KEY,
 13369           DFHEIV99,
 13370           DFHEIV99
 13371     MOVE EIBRESP  TO WS-RESPONSE
 13372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13373     END-IF
 13374     .
 13375 1510-EXIT.
 13376     EXIT.
 13377 1520-UPDATE-ELCERT.
 13378     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13379                                 TO ELCERT-KEY
 13380
 13381* EXEC CICS READ
 13382*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13383*        DATASET (FILE-ID-ELCERT)
 13384*        RIDFLD  (ELCERT-KEY)
 13385*        UPDATE
 13386*        RESP    (WS-RESPONSE)
 13387*    END-EXEC
 13388*    MOVE '&"S        EU         (  N#00012233' TO DFHEIV0
 13389     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13390     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13391     MOVE X'204E233030303132323333' TO DFHEIV0(25:11)
 13392     CALL 'kxdfhei1' USING DFHEIV0,
 13393           FILE-ID-ELCERT,
 13394           DFHEIV20,
 13395           DFHEIV99,
 13396           ELCERT-KEY,
 13397           DFHEIV99,
 13398           DFHEIV99,
 13399           DFHEIV99
 13400     SET ADDRESS OF CERTIFICATE-MASTER TO
 13401         DFHEIV20
 13402     MOVE EIBRESP  TO WS-RESPONSE
 13403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13404     IF RESP-NORMAL
 13405        IF WS-NOTE-SW = 'A'
 13406           IF CM-NOTE-SW = ' '
 13407              MOVE '2'             TO CM-NOTE-SW
 13408           ELSE
 13409             IF CM-NOTE-SW = '1'
 13410                MOVE '3'           TO CM-NOTE-SW
 13411             ELSE
 13412               IF CM-NOTE-SW = '4'
 13413                  MOVE '6'         TO CM-NOTE-SW
 13414               ELSE
 13415                 IF CM-NOTE-SW = '5'
 13416                    MOVE '7'       TO CM-NOTE-SW
 13417                 END-IF
 13418               END-IF
 13419             END-IF
 13420           END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 244
* EL6311.cbl
 13421        ELSE
 13422           IF CM-NOTE-SW = '2'
 13423              MOVE ' '             TO CM-NOTE-SW
 13424           ELSE
 13425             IF CM-NOTE-SW = '3'
 13426                MOVE '1'           TO CM-NOTE-SW
 13427             ELSE
 13428               IF CM-NOTE-SW = '6'
 13429                  MOVE '4'         TO CM-NOTE-SW
 13430               ELSE
 13431                 IF CM-NOTE-SW = '7'
 13432                    MOVE '5'       TO CM-NOTE-SW
 13433                 END-IF
 13434               END-IF
 13435             END-IF
 13436           END-IF
 13437        END-IF
 13438
 13439* EXEC CICS REWRITE
 13440*          DATASET    (FILE-ID-ELCERT)
 13441*          FROM       (CERTIFICATE-MASTER)
 13442*          RESP       (WS-RESPONSE)
 13443*       END-EXEC
 13444     MOVE LENGTH OF
 13445      CERTIFICATE-MASTER
 13446       TO DFHEIV11
 13447*    MOVE '&& L                  %  N#00012274' TO DFHEIV0
 13448     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13449     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13450     MOVE X'204E233030303132323734' TO DFHEIV0(25:11)
 13451     CALL 'kxdfhei1' USING DFHEIV0,
 13452           FILE-ID-ELCERT,
 13453           CERTIFICATE-MASTER,
 13454           DFHEIV11,
 13455           DFHEIV99
 13456     MOVE EIBRESP  TO WS-RESPONSE
 13457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13458        IF RESP-NORMAL
 13459           CONTINUE
 13460        ELSE
 13461           MOVE WS-RESPONSE TO EMI-ERROR
 13462           PERFORM 9900-ERROR-FORMAT
 13463                                 THRU 9900-EXIT
 13464           GO TO 8200-SEND-DATAONLY
 13465        END-IF
 13466     ELSE
 13467        MOVE -1                  TO BMAINTL
 13468        MOVE 0249                TO EMI-ERROR
 13469        PERFORM 9900-ERROR-FORMAT
 13470                                 THRU 9900-EXIT
 13471        GO TO 8200-SEND-DATAONLY
 13472     END-IF
 13473     .
 13474 1520-EXIT.
 13475     EXIT.
 13476 1600-UPDATE-ERPYAJ.
 13477     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13478                                 THRU 1610-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 245
* EL6311.cbl
 13479     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13480                                 THRU 1620-EXIT
 13481     .
 13482 1600-EXIT.
 13483     EXIT.
 13484 1610-ADD-ERPYAJ-BANK-REC.
 13485
 13486* EXEC CICS GETMAIN
 13487*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13488*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13489*        INITIMG (GETMAIN-SPACE)
 13490*    END-EXEC
 13491*    MOVE ',"IL                  $   #00012306' TO DFHEIV0
 13492     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13493     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13494     MOVE X'2020233030303132333036' TO DFHEIV0(25:11)
 13495     CALL 'kxdfhei1' USING DFHEIV0,
 13496           DFHEIV20,
 13497           ERPYAJ-RECORD-LENGTH,
 13498           GETMAIN-SPACE
 13499     SET ADDRESS OF PENDING-PAY-ADJ TO
 13500         DFHEIV20
 13501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13502     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13503     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13504     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13505     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13506     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13507     MOVE +10                    TO ERPYAJ-SEQ-NO
 13508     MOVE 'R'                    TO ERPYAJ-TYPE
 13509     IF REVERSAL
 13510        MOVE 'C'                 TO ERPYAJ-TYPE
 13511     END-IF
 13512     MOVE SPACES                 TO PENDING-PAY-ADJ
 13513     MOVE 'PY'                   TO PY-RECORD-ID
 13514     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13515     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13516     IF REVERSAL
 13517        MOVE PB-I-DCC-OVER-CHG-AMT
 13518                                 TO PY-ENTRY-AMT
 13519     END-IF
 13520     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13521                                    PY-INPUT-DT
 13522*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13523*                                   PY-INPUT-DT
 13524     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13525     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13526     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13527     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13528     IF PB-CARRIER = '2'
 13529        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13530     ELSE
 13531        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13532     END-IF
 13533     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13534                                    PY-BILLED-DATE
 13535                                    PY-AR-DATE
 13536                                    PY-REPORTED-DT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 246
* EL6311.cbl
 13537                                    PY-CHECK-WRITTEN-DT
 13538     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13539                                    PY-CHECK-QUE-SEQUENCE
 13540     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13541     PERFORM WITH TEST AFTER
 13542        UNTIL (NOT RESP-DUPKEY)
 13543           AND (NOT RESP-DUPREC)
 13544
 13545* EXEC CICS WRITE
 13546*          DATASET    (FILE-ID-ERPYAJ)
 13547*          FROM       (PENDING-PAY-ADJ)
 13548*          RIDFLD     (ERPYAJ-KEY)
 13549*          RESP       (WS-RESPONSE)
 13550*       END-EXEC
 13551     MOVE LENGTH OF
 13552      PENDING-PAY-ADJ
 13553       TO DFHEIV11
 13554*    MOVE '&$ L                  ''  N#00012353' TO DFHEIV0
 13555     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13556     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13557     MOVE X'204E233030303132333533' TO DFHEIV0(25:11)
 13558     CALL 'kxdfhei1' USING DFHEIV0,
 13559           FILE-ID-ERPYAJ,
 13560           PENDING-PAY-ADJ,
 13561           DFHEIV11,
 13562           ERPYAJ-KEY,
 13563           DFHEIV99,
 13564           DFHEIV99
 13565     MOVE EIBRESP  TO WS-RESPONSE
 13566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13567        IF RESP-DUPKEY OR RESP-DUPREC
 13568           ADD +1                TO ERPYAJ-SEQ-NO
 13569           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13570        END-IF
 13571     END-PERFORM
 13572     .
 13573 1610-EXIT.
 13574     EXIT.
 13575 1620-ADD-ERPYAJ-DLR-REC.
 13576     MOVE 'C'                    TO ERPYAJ-TYPE
 13577     IF REVERSAL
 13578        MOVE 'R'                 TO ERPYAJ-TYPE
 13579     END-IF
 13580     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13581                                    ERPYAJ-ACCOUNT
 13582     ADD +1                      TO ERPYAJ-SEQ-NO
 13583     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13584     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13585     IF PB-CARRIER = '2'
 13586        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13587     ELSE
 13588        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13589     END-IF
 13590     PERFORM WITH TEST AFTER
 13591        UNTIL (NOT RESP-DUPKEY)
 13592           AND (NOT RESP-DUPREC)
 13593
 13594* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 247
* EL6311.cbl
 13595*          DATASET    (FILE-ID-ERPYAJ)
 13596*          FROM       (PENDING-PAY-ADJ)
 13597*          RIDFLD     (ERPYAJ-KEY)
 13598*          RESP       (WS-RESPONSE)
 13599*       END-EXEC
 13600     MOVE LENGTH OF
 13601      PENDING-PAY-ADJ
 13602       TO DFHEIV11
 13603*    MOVE '&$ L                  ''  N#00012385' TO DFHEIV0
 13604     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13605     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13606     MOVE X'204E233030303132333835' TO DFHEIV0(25:11)
 13607     CALL 'kxdfhei1' USING DFHEIV0,
 13608           FILE-ID-ERPYAJ,
 13609           PENDING-PAY-ADJ,
 13610           DFHEIV11,
 13611           ERPYAJ-KEY,
 13612           DFHEIV99,
 13613           DFHEIV99
 13614     MOVE EIBRESP  TO WS-RESPONSE
 13615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13616        IF RESP-DUPKEY OR RESP-DUPREC
 13617           ADD +1                TO ERPYAJ-SEQ-NO
 13618           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13619        END-IF
 13620     END-PERFORM
 13621     .
 13622 1620-EXIT.
 13623     EXIT.
 13624 1700-SQUEEZE-IT-IN.
 13625     IF (N1 > CN-BILLING-END-LINE-NO)
 13626        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13627           N1 = +1
 13628           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13629           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13630              IF PI-COMPANY-ID = 'DCC'
 13631                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13632              ELSE
 13633                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13634              END-IF
 13635              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13636              MOVE +2 TO N1
 13637           END-IF
 13638        END-PERFORM
 13639     ELSE
 13640        IF (N1 < CN-BILLING-START-LINE-NO)
 13641           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13642              N1 = +10
 13643              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13644              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13645                 IF PI-COMPANY-ID = 'DCC'
 13646                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13647                 ELSE
 13648                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13649                 END-IF
 13650                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13651                 MOVE +9 TO N1
 13652              END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 248
* EL6311.cbl
 13653           END-PERFORM
 13654        END-IF
 13655     END-IF
 13656     .
 13657 1700-EXIT.
 13658     EXIT.
 13659 1800-REMOVE-CERT-NOTES.
 13660     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13661                                 TO ERNOTE-KEY
 13662
 13663* EXEC CICS READ
 13664*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13665*       DATASET    (FILE-ID-ERNOTE)
 13666*       RIDFLD     (ERNOTE-KEY)
 13667*       RESP       (WS-RESPONSE)
 13668*       UPDATE
 13669*    END-EXEC
 13670*    MOVE '&"S        EU         (  N#00012437' TO DFHEIV0
 13671     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13672     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13673     MOVE X'204E233030303132343337' TO DFHEIV0(25:11)
 13674     CALL 'kxdfhei1' USING DFHEIV0,
 13675           FILE-ID-ERNOTE,
 13676           DFHEIV20,
 13677           DFHEIV99,
 13678           ERNOTE-KEY,
 13679           DFHEIV99,
 13680           DFHEIV99,
 13681           DFHEIV99
 13682     SET ADDRESS OF CERTIFICATE-NOTE TO
 13683         DFHEIV20
 13684     MOVE EIBRESP  TO WS-RESPONSE
 13685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13686     IF RESP-NORMAL
 13687        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13688           (N1 > +10)
 13689           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13690           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13691        END-PERFORM
 13692        IF N1 < +11
 13693           MOVE SPACES              TO CN-LINE (N1)
 13694           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13695              N1 <= CN-BILLING-END-LINE-NO
 13696              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13697              IF CN-BILLING-END-LINE-NO <
 13698                               CN-BILLING-START-LINE-NO
 13699                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13700                                     CN-BILLING-START-LINE-NO
 13701              END-IF
 13702              PERFORM 1820-SQUEEZE-ERNOTE
 13703                                  THRU 1820-EXIT
 13704           END-IF
 13705           IF CN-LINES = SPACES
 13706
 13707* EXEC CICS DELETE
 13708*                DATASET    (FILE-ID-ERNOTE)
 13709*                RESP       (WS-RESPONSE)
 13710*             END-EXEC
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 249
* EL6311.cbl
 13711*    MOVE '&(                    &  N#00012464' TO DFHEIV0
 13712     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13713     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13714     MOVE X'204E233030303132343634' TO DFHEIV0(25:11)
 13715     CALL 'kxdfhei1' USING DFHEIV0,
 13716           FILE-ID-ERNOTE,
 13717           DFHEIV99,
 13718           DFHEIV99,
 13719           DFHEIV99,
 13720           DFHEIV99
 13721     MOVE EIBRESP  TO WS-RESPONSE
 13722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13723              IF RESP-NORMAL
 13724                 MOVE 'D'        TO WS-NOTE-SW
 13725                 PERFORM 1520-UPDATE-ELCERT
 13726                                 THRU 1520-EXIT
 13727              END-IF
 13728           ELSE
 13729
 13730* EXEC CICS REWRITE
 13731*                DATASET    (FILE-ID-ERNOTE)
 13732*                FROM       (CERTIFICATE-NOTE)
 13733*                RESP       (WS-RESPONSE)
 13734*             END-EXEC
 13735     MOVE LENGTH OF
 13736      CERTIFICATE-NOTE
 13737       TO DFHEIV11
 13738*    MOVE '&& L                  %  N#00012474' TO DFHEIV0
 13739     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13740     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13741     MOVE X'204E233030303132343734' TO DFHEIV0(25:11)
 13742     CALL 'kxdfhei1' USING DFHEIV0,
 13743           FILE-ID-ERNOTE,
 13744           CERTIFICATE-NOTE,
 13745           DFHEIV11,
 13746           DFHEIV99
 13747     MOVE EIBRESP  TO WS-RESPONSE
 13748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13749           END-IF
 13750        END-IF
 13751     END-IF
 13752     .
 13753 1800-EXIT.
 13754     EXIT.
 13755 1820-SQUEEZE-ERNOTE.
 13756     MOVE CN-BILLING-START-LINE-NO TO N2
 13757     IF N2 = 0
 13758         MOVE +1                 TO N2
 13759     END-IF
 13760     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13761        (N1 > +9)
 13762        IF CN-LINE (N1) = SPACES
 13763           MOVE CN-LINE (N1 + +1)
 13764                                 TO CN-LINE (N1)
 13765           MOVE SPACES           TO CN-LINE (N1 + +1)
 13766        END-IF
 13767     END-PERFORM
 13768     .
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 250
* EL6311.cbl
 13769 1820-EXIT.
 13770     EXIT.
 13771 1900-DELETE-ERPYAJ.
 13772     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13773     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13774     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13775     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13776     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13777     MOVE +10                    TO ERPYAJ-SEQ-NO
 13778     MOVE 'R'                    TO ERPYAJ-TYPE
 13779     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13780
 13781* EXEC CICS STARTBR
 13782*       DATASET    (FILE-ID-ERPYAJ)
 13783*       RIDFLD     (ERPYAJ-KEY)
 13784*       RESP       (WS-RESPONSE)
 13785*    END-EXEC
 13786     MOVE 0
 13787       TO DFHEIV11
 13788*    MOVE '&,         G          &  N#00012510' TO DFHEIV0
 13789     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13790     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13791     MOVE X'204E233030303132353130' TO DFHEIV0(25:11)
 13792     CALL 'kxdfhei1' USING DFHEIV0,
 13793           FILE-ID-ERPYAJ,
 13794           ERPYAJ-KEY,
 13795           DFHEIV99,
 13796           DFHEIV11,
 13797           DFHEIV99
 13798     MOVE EIBRESP  TO WS-RESPONSE
 13799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13800     IF RESP-NORMAL
 13801        CONTINUE
 13802     ELSE
 13803        GO TO 1900-GET-DEALER
 13804     END-IF
 13805     .
 13806 1900-READNEXT-ERPYAJ-B.
 13807*  GET THE BANK ERPYAJ RECORD
 13808
 13809* EXEC CICS READNEXT
 13810*       DATASET    (FILE-ID-ERPYAJ)
 13811*       RIDFLD     (ERPYAJ-KEY)
 13812*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13813*       RESP       (WS-RESPONSE)
 13814*    END-EXEC
 13815     MOVE 0
 13816       TO DFHEIV11
 13817*    MOVE '&.S                   )  N#00012523' TO DFHEIV0
 13818     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13819     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13820     MOVE X'204E233030303132353233' TO DFHEIV0(25:11)
 13821     CALL 'kxdfhei1' USING DFHEIV0,
 13822           FILE-ID-ERPYAJ,
 13823           DFHEIV20,
 13824           DFHEIV99,
 13825           ERPYAJ-KEY,
 13826           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 251
* EL6311.cbl
 13827           DFHEIV11,
 13828           DFHEIV99,
 13829           DFHEIV99
 13830     SET ADDRESS OF PENDING-PAY-ADJ TO
 13831         DFHEIV20
 13832     MOVE EIBRESP  TO WS-RESPONSE
 13833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13834     IF RESP-NORMAL
 13835        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13836           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13837              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13838                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13839
 13840* EXEC CICS READ
 13841*                   DATASET    (FILE-ID-ERPYAJ)
 13842*                   RIDFLD     (ERPYAJ-KEY)
 13843*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13844*                   RESP       (WS-RESPONSE)
 13845*                   UPDATE
 13846*                END-EXEC
 13847*    MOVE '&"S        EU         (  N#00012534' TO DFHEIV0
 13848     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13849     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13850     MOVE X'204E233030303132353334' TO DFHEIV0(25:11)
 13851     CALL 'kxdfhei1' USING DFHEIV0,
 13852           FILE-ID-ERPYAJ,
 13853           DFHEIV20,
 13854           DFHEIV99,
 13855           ERPYAJ-KEY,
 13856           DFHEIV99,
 13857           DFHEIV99,
 13858           DFHEIV99
 13859     SET ADDRESS OF PENDING-PAY-ADJ TO
 13860         DFHEIV20
 13861     MOVE EIBRESP  TO WS-RESPONSE
 13862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13863                 IF RESP-NORMAL
 13864
 13865* EXEC CICS DELETE
 13866*                      DATASET   (FILE-ID-ERPYAJ)
 13867*                      RESP      (WS-RESPONSE)
 13868*                   END-EXEC
 13869*    MOVE '&(                    &  N#00012542' TO DFHEIV0
 13870     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13871     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13872     MOVE X'204E233030303132353432' TO DFHEIV0(25:11)
 13873     CALL 'kxdfhei1' USING DFHEIV0,
 13874           FILE-ID-ERPYAJ,
 13875           DFHEIV99,
 13876           DFHEIV99,
 13877           DFHEIV99,
 13878           DFHEIV99
 13879     MOVE EIBRESP  TO WS-RESPONSE
 13880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13881                 END-IF
 13882              ELSE
 13883                 SET REVERSAL    TO TRUE
 13884                 PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 252
* EL6311.cbl
 13885                                 THRU 1600-EXIT
 13886                 GO TO 1900-EXIT
 13887              END-IF
 13888           ELSE
 13889              GO TO 1900-READNEXT-ERPYAJ-B
 13890           END-IF
 13891        END-IF
 13892
 13893* EXEC CICS ENDBR
 13894*          DATASET   (FILE-ID-ERPYAJ)
 13895*       END-EXEC
 13896     MOVE 0
 13897       TO DFHEIV11
 13898*    MOVE '&2                    $   #00012557' TO DFHEIV0
 13899     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13900     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13901     MOVE X'2020233030303132353537' TO DFHEIV0(25:11)
 13902     CALL 'kxdfhei1' USING DFHEIV0,
 13903           FILE-ID-ERPYAJ,
 13904           DFHEIV11,
 13905           DFHEIV99
 13906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13907     END-IF
 13908     .
 13909 1900-GET-DEALER.
 13910     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13911     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13912     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13913     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13914     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13915     MOVE +10                    TO ERPYAJ-SEQ-NO
 13916     MOVE 'C'                    TO ERPYAJ-TYPE
 13917     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13918
 13919* EXEC CICS STARTBR
 13920*       DATASET    (FILE-ID-ERPYAJ)
 13921*       RIDFLD     (ERPYAJ-KEY)
 13922*       RESP       (WS-RESPONSE)
 13923*    END-EXEC
 13924     MOVE 0
 13925       TO DFHEIV11
 13926*    MOVE '&,         G          &  N#00012571' TO DFHEIV0
 13927     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13928     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13929     MOVE X'204E233030303132353731' TO DFHEIV0(25:11)
 13930     CALL 'kxdfhei1' USING DFHEIV0,
 13931           FILE-ID-ERPYAJ,
 13932           ERPYAJ-KEY,
 13933           DFHEIV99,
 13934           DFHEIV11,
 13935           DFHEIV99
 13936     MOVE EIBRESP  TO WS-RESPONSE
 13937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13938     IF RESP-NORMAL
 13939        CONTINUE
 13940     ELSE
 13941        GO TO 1900-EXIT
 13942     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 253
* EL6311.cbl
 13943     .
 13944 1900-READNEXT-ERPYAJ-D.
 13945*  GET THE DEALER ERPYAJ RECORD
 13946
 13947* EXEC CICS READNEXT
 13948*       DATASET    (FILE-ID-ERPYAJ)
 13949*       RIDFLD     (ERPYAJ-KEY)
 13950*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13951*       RESP       (WS-RESPONSE)
 13952*    END-EXEC
 13953     MOVE 0
 13954       TO DFHEIV11
 13955*    MOVE '&.S                   )  N#00012584' TO DFHEIV0
 13956     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13957     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13958     MOVE X'204E233030303132353834' TO DFHEIV0(25:11)
 13959     CALL 'kxdfhei1' USING DFHEIV0,
 13960           FILE-ID-ERPYAJ,
 13961           DFHEIV20,
 13962           DFHEIV99,
 13963           ERPYAJ-KEY,
 13964           DFHEIV99,
 13965           DFHEIV11,
 13966           DFHEIV99,
 13967           DFHEIV99
 13968     SET ADDRESS OF PENDING-PAY-ADJ TO
 13969         DFHEIV20
 13970     MOVE EIBRESP  TO WS-RESPONSE
 13971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13972     IF RESP-NORMAL
 13973        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13974           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13975              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13976                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13977
 13978* EXEC CICS READ
 13979*                   DATASET    (FILE-ID-ERPYAJ)
 13980*                   RIDFLD     (ERPYAJ-KEY)
 13981*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13982*                   RESP       (WS-RESPONSE)
 13983*                   UPDATE
 13984*                END-EXEC
 13985*    MOVE '&"S        EU         (  N#00012595' TO DFHEIV0
 13986     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13987     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13988     MOVE X'204E233030303132353935' TO DFHEIV0(25:11)
 13989     CALL 'kxdfhei1' USING DFHEIV0,
 13990           FILE-ID-ERPYAJ,
 13991           DFHEIV20,
 13992           DFHEIV99,
 13993           ERPYAJ-KEY,
 13994           DFHEIV99,
 13995           DFHEIV99,
 13996           DFHEIV99
 13997     SET ADDRESS OF PENDING-PAY-ADJ TO
 13998         DFHEIV20
 13999     MOVE EIBRESP  TO WS-RESPONSE
 14000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 254
* EL6311.cbl
 14001                 IF RESP-NORMAL
 14002
 14003* EXEC CICS DELETE
 14004*                      DATASET   (FILE-ID-ERPYAJ)
 14005*                      RESP      (WS-RESPONSE)
 14006*                   END-EXEC
 14007*    MOVE '&(                    &  N#00012603' TO DFHEIV0
 14008     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14009     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14010     MOVE X'204E233030303132363033' TO DFHEIV0(25:11)
 14011     CALL 'kxdfhei1' USING DFHEIV0,
 14012           FILE-ID-ERPYAJ,
 14013           DFHEIV99,
 14014           DFHEIV99,
 14015           DFHEIV99,
 14016           DFHEIV99
 14017     MOVE EIBRESP  TO WS-RESPONSE
 14018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14019                 END-IF
 14020              ELSE
 14021                 SET REVERSAL    TO TRUE
 14022              END-IF
 14023           ELSE
 14024              GO TO 1900-READNEXT-ERPYAJ-D
 14025           END-IF
 14026        END-IF
 14027
 14028* EXEC CICS ENDBR
 14029*          DATASET   (FILE-ID-ERPYAJ)
 14030*       END-EXEC
 14031     MOVE 0
 14032       TO DFHEIV11
 14033*    MOVE '&2                    $   #00012615' TO DFHEIV0
 14034     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14035     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14036     MOVE X'2020233030303132363135' TO DFHEIV0(25:11)
 14037     CALL 'kxdfhei1' USING DFHEIV0,
 14038           FILE-ID-ERPYAJ,
 14039           DFHEIV11,
 14040           DFHEIV99
 14041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14042     END-IF
 14043     .
 14044 1900-EXIT.
 14045     EXIT.
 14046******************************************************************
 14047*            C A N C E L   M A I N L I N E                       *
 14048******************************************************************
 14049
 14050 2000-CANCEL-MAINLINE.
 14051     IF PI-DISPLAY-ORIGINAL-BATCH
 14052        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14053           MOVE ER-0023             TO EMI-ERROR
 14054           MOVE -1                  TO CMAINTL
 14055           MOVE AL-UABON            TO CMAINTA
 14056           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14057           GO TO 8200-SEND-DATAONLY
 14058        ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 255
* EL6311.cbl
 14059           NEXT SENTENCE
 14060     ELSE
 14061        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14062           MOVE ER-0023             TO EMI-ERROR
 14063           MOVE -1                  TO CMAINTL
 14064           MOVE AL-UABON            TO CMAINTA
 14065           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14066           GO TO 8200-SEND-DATAONLY.
 14067
 14068     IF CMAINTI = 'S'
 14069        GO TO 2100-SHOW-REQUEST.
 14070
 14071     IF NOT MODIFY-CAP
 14072         MOVE 'UPDATE'       TO SM-READ
 14073         PERFORM 9995-SECURITY-VIOLATION
 14074         MOVE ER-0070        TO EMI-ERROR
 14075         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14076         GO TO 8100-SEND-INITIAL-MAP.
 14077
 14078     IF CMAINTL GREATER THAN ZEROS
 14079        IF PI-PF6-FUNCTION
 14080           IF CMAINTI NOT = 'A'
 14081              MOVE AL-UABON  TO CMAINTA
 14082              MOVE -1        TO CMAINTL
 14083              MOVE ER-2260   TO EMI-ERROR
 14084              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14085              GO TO 8200-SEND-DATAONLY.
 14086
 14087     IF CCERTNOL = ZEROS
 14088       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14089         NEXT SENTENCE
 14090     ELSE
 14091         IF CCERTNOL NOT = ZEROS
 14092             MOVE AL-UANON       TO CCERTNOA
 14093         ELSE
 14094             MOVE -1             TO CCERTNOL
 14095             MOVE  1             TO SET-CURSOR-SW
 14096             MOVE ER-2218       TO EMI-ERROR
 14097             MOVE AL-UABON       TO CCERTNOA
 14098             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14099
 14100     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14101        NEXT SENTENCE
 14102     ELSE
 14103        IF CEFFDTL NOT = ZEROS
 14104           MOVE AL-UNNON         TO CEFFDTA
 14105           MOVE CEFFDTI TO DEEDIT-FIELD
 14106           PERFORM 8600-DEEDIT
 14107           MOVE 4                TO DC-OPTION-CODE
 14108           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14109           PERFORM 9700-DATE-LINK
 14110           IF NO-CONVERSION-ERROR
 14111              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14112              ELSE
 14113              MOVE -1            TO CEFFDTL
 14114              MOVE  1            TO SET-CURSOR-SW
 14115              MOVE ER-2226      TO EMI-ERROR
 14116              MOVE AL-UNBON      TO CEFFDTA
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 256
* EL6311.cbl
 14117              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14118          ELSE
 14119          MOVE -1                 TO CEFFDTL
 14120          MOVE  1                 TO SET-CURSOR-SW
 14121          MOVE ER-2220            TO EMI-ERROR
 14122          MOVE AL-UNBON           TO CEFFDTA
 14123          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14124
 14125     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14126
 14127     IF CCERTNOL NOT = ZEROS
 14128        MOVE CCERTNOI                TO WS-NEW-PRIME
 14129     ELSE
 14130        MOVE SPACES                  TO WS-NEW-PRIME.
 14131
 14132     IF CSUFIXL NOT = ZEROS
 14133        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14134     ELSE
 14135        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14136
 14137     IF CEFFDTL NOT = ZEROS
 14138        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14139     ELSE
 14140        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14141
 14142     IF CMAINTI = 'A' OR 'K' OR 'S'
 14143        NEXT SENTENCE
 14144     ELSE
 14145        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14146        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14147           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14148           WS-PB-RECORD-TYPE NOT = '2'
 14149           IF CMAINTI = 'C'
 14150              MOVE ER-2287          TO EMI-ERROR
 14151              MOVE -1               TO CCERTNOL
 14152              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14153              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14154              GO TO 8200-SEND-DATAONLY
 14155             ELSE
 14156              MOVE ER-2260          TO EMI-ERROR
 14157              MOVE -1               TO CCERTNOL
 14158              MOVE AL-UABON         TO CCERTNOA
 14159              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14160              GO TO 8200-SEND-DATAONLY.
 14161
 14162     IF CMAINTI = 'D'
 14163        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14164
 14165     IF CLSTNML GREATER THAN ZEROS
 14166         MOVE AL-UANON           TO CLSTNMA.
 14167
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 257
* EL6311.cbl
 14169
 14170******************************************************************
 14171*                                                                *
 14172*           E D I T   C A N C E L   C O V E R A G E S            *
 14173*                                                                *
 14174******************************************************************
 14175
 14176 2015-EDIT-COVERAGES.
 14177     IF CCANDT1L      GREATER THAN ZEROS OR
 14178        CREFND1L      GREATER THAN ZEROS OR
 14179        CCANDT2L      GREATER THAN ZEROS OR
 14180        CREFND2L      GREATER THAN ZEROS OR
 14181        CMTHD1L       GREATER THAN ZEROS OR
 14182        CMTHD2L       GREATER THAN ZEROS OR
 14183        CLIVESL       GREATER THAN ZEROS OR
 14184        CPAYEEL       GREATER THAN ZEROS OR
 14185        CFORCEL       GREATER THAN ZEROS OR
 14186        CBILCDL       GREATER THAN ZEROS OR
 14187        CCANREAL      GREATER THAN ZEROS
 14188            NEXT SENTENCE
 14189         ELSE
 14190            GO TO 2030-EDIT-COMPLETE.
 14191
 14192     IF CCANDT1L = ZEROS
 14193        AND (CMAINTI = 'C' OR 'K')
 14194        NEXT SENTENCE
 14195     ELSE
 14196        IF CCANDT1L      GREATER THAN ZEROS
 14197            MOVE AL-UNNON            TO CCANDT1A
 14198            IF CCANDT1I = SPACES
 14199               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14200            ELSE
 14201               MOVE CCANDT1I            TO DEEDIT-FIELD
 14202               PERFORM 8600-DEEDIT
 14203               IF DEEDIT-FIELD-V0   NUMERIC
 14204                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14205                  MOVE 4                TO DC-OPTION-CODE
 14206                  PERFORM 9700-DATE-LINK
 14207                  IF NO-CONVERSION-ERROR
 14208                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14209                  ELSE
 14210                      MOVE -1        TO CCANDT1L
 14211                      MOVE ER-2227   TO EMI-ERROR
 14212                      MOVE AL-UNBON  TO CCANDT1A
 14213                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14214               ELSE
 14215                  MOVE -1         TO CCANDT1L
 14216                  MOVE ER-2223    TO EMI-ERROR
 14217                  MOVE AL-UNBON   TO CCANDT1A
 14218                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14219        ELSE
 14220            IF CREFND1L GREATER THAN ZEROS
 14221               MOVE -1             TO CCANDT1L
 14222               MOVE ER-2222        TO EMI-ERROR
 14223               MOVE AL-UNBOF       TO CCANDT1A
 14224               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14225
 14226     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 258
* EL6311.cbl
 14227        AND (CMAINTI = 'C' OR 'K')
 14228         NEXT SENTENCE
 14229     ELSE
 14230         IF CREFND1L NOT = ZEROS
 14231            MOVE AL-UNNON        TO CREFND1A
 14232
 14233* EXEC CICS BIF DEEDIT
 14234*               FIELD  (CREFND1I)
 14235*               LENGTH (11)
 14236*           END-EXEC
 14237     MOVE 11
 14238       TO DFHEIV11
 14239*    MOVE '@"L                   #   #00012808' TO DFHEIV0
 14240     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14241     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14242     MOVE X'2020233030303132383038' TO DFHEIV0(25:11)
 14243     CALL 'kxdfhei1' USING DFHEIV0,
 14244           CREFND1I,
 14245           DFHEIV11
 14246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14247            MOVE CREFND1I        TO WS-CREFND1
 14248*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14249*           PERFORM 8600-DEEDIT
 14250*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14251            IF WS-CREFND1  = ZEROS
 14252               AND CMAINTI = 'A'
 14253             MOVE ER-2437        TO EMI-ERROR
 14254             MOVE -1             TO CREFND1L
 14255             MOVE AL-UNBON       TO CREFND1A
 14256             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14257
 14258     IF CCANREAL > +0
 14259        MOVE AL-UANON            TO CCANREAA
 14260        IF CCANREAI = 'R' OR ' '
 14261           CONTINUE
 14262        ELSE
 14263           MOVE ER-9841        TO EMI-ERROR
 14264           MOVE -1             TO CCANREAL
 14265           MOVE AL-UABON       TO CCANREAA
 14266           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14267        END-IF
 14268     END-IF
 14269     IF CMTHD1L EQUAL +0
 14270        NEXT SENTENCE
 14271     ELSE
 14272        IF CMTHD1L NOT = +0
 14273           MOVE AL-UNNON        TO CMTHD1A
 14274           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14275                         OR '5' OR '6' OR '8' OR '9'
 14276                         OR 'R' OR ' '
 14277              NEXT SENTENCE
 14278           ELSE
 14279              MOVE ER-0582        TO EMI-ERROR
 14280              MOVE -1             TO CMTHD1L
 14281              MOVE AL-UNBON       TO CMTHD1A
 14282              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14283
 14284     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 259
* EL6311.cbl
 14285        AND (CMAINTI = 'C' OR 'K')
 14286         NEXT SENTENCE
 14287     ELSE
 14288         IF CCANDT2L  GREATER THAN ZEROS
 14289             MOVE AL-UNNON       TO CCANDT2A
 14290             IF CCANDT2I = SPACES
 14291                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14292             ELSE
 14293                MOVE CCANDT2I       TO DEEDIT-FIELD
 14294                PERFORM 8600-DEEDIT
 14295                IF DEEDIT-FIELD-V0   NUMERIC
 14296                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14297                   MOVE 4                TO DC-OPTION-CODE
 14298                   PERFORM 9700-DATE-LINK
 14299                   IF NO-CONVERSION-ERROR
 14300                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14301                   ELSE
 14302                      MOVE -1       TO CCANDT2L
 14303                      MOVE ER-2227  TO EMI-ERROR
 14304                      MOVE AL-UNBON TO CCANDT2A
 14305                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14306                ELSE
 14307                   MOVE -1         TO CCANDT2L
 14308                   MOVE ER-2223    TO EMI-ERROR
 14309                   MOVE AL-UNBON   TO CCANDT2A
 14310                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14311         ELSE
 14312            IF CREFND2L GREATER THAN ZEROS
 14313               MOVE -1             TO CCANDT2L
 14314               MOVE ER-2222        TO EMI-ERROR
 14315               MOVE AL-UNBOF       TO CCANDT2A
 14316               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14317
 14318     IF CREFND2L = ZEROS
 14319        AND (CMAINTI = 'C' OR 'K')
 14320         NEXT SENTENCE
 14321     ELSE
 14322         IF CREFND2L NOT = ZEROS
 14323            MOVE AL-UNNON        TO CREFND2A
 14324
 14325* EXEC CICS BIF DEEDIT
 14326*               FIELD  (CREFND2I)
 14327*               LENGTH (11)
 14328*           END-EXEC
 14329     MOVE 11
 14330       TO DFHEIV11
 14331*    MOVE '@"L                   #   #00012889' TO DFHEIV0
 14332     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14333     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14334     MOVE X'2020233030303132383839' TO DFHEIV0(25:11)
 14335     CALL 'kxdfhei1' USING DFHEIV0,
 14336           CREFND2I,
 14337           DFHEIV11
 14338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14339            MOVE CREFND2I        TO WS-CREFND2
 14340*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14341*           PERFORM 8600-DEEDIT
 14342*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 260
* EL6311.cbl
 14343            IF WS-CREFND2  = ZEROS
 14344               AND CMAINTI = 'A'
 14345             MOVE ER-2437        TO EMI-ERROR
 14346             MOVE -1             TO CREFND2L
 14347             MOVE AL-UNBON       TO CREFND2A
 14348             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14349
 14350     IF CMTHD2L EQUAL +0
 14351        NEXT SENTENCE
 14352     ELSE
 14353        IF CMTHD2L NOT = +0
 14354           MOVE AL-UNNON        TO CMTHD2A
 14355           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14356                         OR '5' OR '6' OR '8' OR '9'
 14357                         OR ' ' OR 'R'
 14358              NEXT SENTENCE
 14359           ELSE
 14360              MOVE ER-0582        TO EMI-ERROR
 14361              MOVE -1             TO CMTHD2L
 14362              MOVE AL-UNBON       TO CMTHD2A
 14363              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14364
 14365     IF CLIVESL GREATER THAN ZEROS
 14366         MOVE CLIVESI            TO DEEDIT-FIELD
 14367         PERFORM 8600-DEEDIT
 14368         IF DEEDIT-FIELD-V0 NUMERIC
 14369             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14370             MOVE AL-UNNON       TO CLIVESA
 14371         ELSE
 14372             MOVE -1             TO CLIVESL
 14373             MOVE AL-UNBON       TO CLIVESA
 14374             MOVE ER-2223        TO EMI-ERROR
 14375             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14376
 14377     IF CFORCEL  NOT = ZEROS
 14378         IF FORCE-CAP
 14379            MOVE AL-UANON            TO CFORCEA
 14380         ELSE
 14381            MOVE ER-2945             TO EMI-ERROR
 14382            MOVE AL-UABON            TO CFORCEA
 14383            MOVE -1                  TO CFORCEL
 14384            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14385
 14386     IF CPAYEEL GREATER THAN ZEROS
 14387        MOVE AL-UANON            TO CPAYEEA.
 14388
 14389     IF CBILCDL NOT = ZEROS
 14390        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14391                             AND 'A' AND 'B' AND 'E'
 14392           MOVE ER-2225              TO EMI-ERROR
 14393           MOVE AL-UABON             TO CBILCDA
 14394           MOVE -1                   TO CBILCDL
 14395           MOVE  1                   TO SET-CURSOR-SW
 14396           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14397        ELSE
 14398           MOVE AL-UANON             TO CBILCDA.
 14399
 14400 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 261
* EL6311.cbl
 14401     IF EMI-ERROR = ZEROS
 14402         NEXT SENTENCE
 14403     ELSE
 14404         GO TO 8200-SEND-DATAONLY.
 14405
 14406     IF CMAINTI = 'A'
 14407        GO TO 2200-ADD-CANCEL-ROUTINE.
 14408
 14409     IF CMAINTI = 'C'
 14410        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14411
 14412     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14413
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 262
* EL6311.cbl
 14415
 14416******************************************************************
 14417*                                                                *
 14418*                   S H O W   C A N C E L                        *
 14419*                                                                *
 14420******************************************************************
 14421
 14422 2100-SHOW-REQUEST.
 14423     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14424
 14425     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14426        MOVE -1                  TO CMAINTL
 14427        GO TO 8200-SEND-DATAONLY.
 14428
 14429     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14430
 14431     IF CSUFIXL NOT = ZEROS
 14432        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14433       ELSE
 14434        MOVE SPACE            TO WS-NEW-SUFFIX.
 14435
 14436     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14437     PERFORM 8600-DEEDIT.
 14438     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14439     MOVE '4'                    TO DC-OPTION-CODE.
 14440     PERFORM 9700-DATE-LINK.
 14441     IF DATE-CONVERSION-ERROR
 14442        MOVE ER-0348             TO EMI-ERROR
 14443        MOVE -1                  TO CEFFDTL
 14444        MOVE AL-UABON            TO CEFFDTA
 14445        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14446        GO TO 8200-SEND-DATAONLY
 14447     ELSE
 14448        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14449        MOVE AL-UANON            TO CEFFDTA
 14450        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14451
 14452     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14453
 14454     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14455        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14456        MOVE 'Y'                    TO WS-SHOW-SW
 14457        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14458           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14459        ELSE
 14460           IF PI-FILE-BROWSE
 14461              GO TO 4300-BROWSE-FILE-FORWARD
 14462           ELSE
 14463              IF PI-CSR-BROWSE
 14464                 GO TO 4200-BROWSE-CSR-FORWARD
 14465              ELSE
 14466                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14467     ELSE
 14468        GO TO 3900-RE-DISPLAY-RECORD.
 14469
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 263
* EL6311.cbl
 14471
 14472
 14473******************************************************************
 14474*                                                                *
 14475*            A D D   C A N C E L   R O U T I N E                 *
 14476*                                                                *
 14477******************************************************************
 14478
 14479 2200-ADD-CANCEL-ROUTINE.
 14480     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14481
 14482
 14483* EXEC CICS GETMAIN
 14484*        SET     (ADDRESS OF PENDING-BUSINESS)
 14485*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14486*    END-EXEC.
 14487*    MOVE '," L                  $   #00013036' TO DFHEIV0
 14488     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14489     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14490     MOVE X'2020233030303133303336' TO DFHEIV0(25:11)
 14491     CALL 'kxdfhei1' USING DFHEIV0,
 14492           DFHEIV20,
 14493           ERPNDB-RECORD-LENGTH,
 14494           DFHEIV99
 14495     SET ADDRESS OF PENDING-BUSINESS TO
 14496         DFHEIV20
 14497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14498
 14499
 14500
 14501* EXEC CICS HANDLE CONDITION
 14502*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14503*    END-EXEC.
 14504*    MOVE '"$I                   ! 3 #00013041' TO DFHEIV0
 14505     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14506     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14507     MOVE X'3320233030303133303431' TO DFHEIV0(25:11)
 14508     CALL 'kxdfhei1' USING DFHEIV0
 14509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14510
 14511
 14512     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14513     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14514     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14515
 14516
 14517* EXEC CICS READ
 14518*        INTO    (PENDING-BUSINESS)
 14519*        DATASET (FILE-ID-ERPNDB)
 14520*        RIDFLD  (ERPNDB-KEY)
 14521*    END-EXEC.
 14522     MOVE LENGTH OF
 14523      PENDING-BUSINESS
 14524       TO DFHEIV11
 14525*    MOVE '&"IL       E          (   #00013049' TO DFHEIV0
 14526     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14527     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14528     MOVE X'2020233030303133303439' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 264
* EL6311.cbl
 14529     CALL 'kxdfhei1' USING DFHEIV0,
 14530           FILE-ID-ERPNDB,
 14531           PENDING-BUSINESS,
 14532           DFHEIV11,
 14533           ERPNDB-KEY,
 14534           DFHEIV99,
 14535           DFHEIV99,
 14536           DFHEIV99
 14537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14538
 14539
 14540     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14541
 14542     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14543     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14544     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14545     MOVE SPACES                 TO PENDING-BUSINESS.
 14546     MOVE 'PB'                   TO PB-RECORD-ID.
 14547     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14548     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14549     MOVE SPACES                 TO PB-CERT-SFX.
 14550     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14551     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14552                                    PB-ALT-CHG-SEQ-NO.
 14553
 14554     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14555     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14556     MOVE '2'                    TO PB-RECORD-TYPE.
 14557
 14558     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14559     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14560
 14561
 14562     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14563                                    PB-ALT-CHG-SEQ-NO
 14564                                    PB-C-LF-REF-CALC
 14565                                    PB-C-AH-REF-CALC
 14566                                    PB-C-LF-RFND-CLP
 14567                                    PB-C-AH-RFND-CLP
 14568                                    PB-CI-INSURED-AGE
 14569                                    PB-CI-LF-TERM
 14570                                    PB-CI-AH-TERM
 14571                                    PB-CI-LF-BENEFIT-CD
 14572                                    PB-CI-LF-BENEFIT-AMT
 14573                                    PB-CI-LF-ALT-BENEFIT-AMT
 14574                                    PB-CI-LF-PREMIUM-AMT
 14575                                    PB-CI-LF-ALT-PREMIUM-AMT
 14576                                    PB-CI-AH-BENEFIT-CD
 14577                                    PB-CI-AH-BENEFIT-AMT
 14578                                    PB-CI-AH-PREMIUM-AMT
 14579                                    PB-CI-PAY-FREQUENCY
 14580                                    PB-CI-LOAN-APR
 14581                                    PB-CI-LOAN-TERM
 14582                                    PB-CI-LIFE-COMMISSION
 14583                                    PB-CI-AH-COMMISSION
 14584                                    PB-CI-CURR-SEQ
 14585                                    PB-CI-AH-CANCEL-AMT
 14586                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 265
* EL6311.cbl
 14587                                    PB-CI-RATE-DEV-PCT-LF
 14588                                    PB-CI-RATE-DEV-PCT-AH
 14589                                    PB-CI-EXTENTION-DAYS
 14590                                    PB-CI-TERM-IN-DAYS
 14591                                    PB-CI-LIVES
 14592                                    PB-CI-LF-CRIT-PER
 14593                                    PB-CI-AH-CRIT-PER
 14594                                    PB-C-LF-REM-TERM
 14595                                    PB-C-AH-REM-TERM
 14596                                    PB-CHG-COUNT
 14597                                    PB-LF-BILLED-AMTS
 14598                                    PB-AH-BILLED-AMTS
 14599                                    PB-C-NH-INT-ON-REFS
 14600*                                   PB-C-MICROFILM-NO
 14601                                    PB-CALC-TOLERANCE.
 14602
 14603     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14604                                    PB-CI-AH-SETTLEMENT-DT
 14605                                    PB-CI-DEATH-DT
 14606                                    PB-CI-LF-PRIOR-CANCEL-DT
 14607                                    PB-CI-AH-PRIOR-CANCEL-DT
 14608                                    PB-CI-ENTRY-DT
 14609                                    PB-CI-LF-EXPIRE-DT
 14610                                    PB-CI-AH-EXPIRE-DT
 14611                                    PB-CI-LOAN-1ST-PMT-DT
 14612                                    PB-C-LF-CANCEL-DT
 14613                                    PB-C-AH-CANCEL-DT
 14614                                    PB-CREDIT-ACCEPT-DT
 14615                                    PB-BILLED-DT
 14616                                    PB-ACCT-EFF-DT
 14617                                    PB-ACCT-EXP-DT.
 14618
 14619     MOVE 'X'                    TO PB-FATAL-FLAG.
 14620
 14621     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14622
 14623     IF CSUFIXL     GREATER THAN ZEROS
 14624        MOVE CSUFIXI             TO PB-CERT-SFX.
 14625
 14626*    IF CMICRNOL  GREATER  ZEROS
 14627*        IF CMICRNOI  NUMERIC
 14628*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14629*            MOVE AL-UNNON       TO  CMICRNOA
 14630*        ELSE
 14631*            MOVE -1             TO  CMICRNOL
 14632*            MOVE AL-UNBON       TO  CMICRNOA
 14633*            MOVE ER-2701        TO  EMI-ERROR
 14634*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14635
 14636     IF CLSTNML     GREATER THAN ZEROS
 14637        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14638
 14639     IF CCANREAL > ZEROS
 14640        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14641     END-IF
 14642     IF CPCYNL > ZEROS
 14643        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14644     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 266
* EL6311.cbl
 14645     IF CCANDT1L    GREATER THAN ZEROS
 14646        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14647
 14648     IF CCANDT2L    GREATER THAN ZEROS
 14649        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14650
 14651     IF CMTHD1L    GREATER THAN +0
 14652        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14653
 14654     IF CMTHD2L    GREATER THAN +0
 14655        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14656
 14657     IF CREFND1L    GREATER THAN ZEROS
 14658        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14659        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14660     ELSE
 14661        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14662
 14663     IF CREFND2L    GREATER THAN ZEROS
 14664        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14665        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14666     ELSE
 14667        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14668
 14669     IF CLIVESL     GREATER THAN ZEROS
 14670        MOVE WS-CLIVES           TO PB-C-LIVES
 14671     ELSE
 14672        MOVE ZEROS               TO PB-C-LIVES.
 14673
 14674     IF CPAYEEL     GREATER THAN ZEROS
 14675        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14676
 14677     IF CFORCEL     GREATER THAN ZEROS
 14678        MOVE CFORCEI             TO PB-FORCE-CODE.
 14679
 14680     IF CBILCDL     GREATER THAN ZEROS
 14681        MOVE CBILCDI             TO PB-RECORD-BILL.
 14682
 14683*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14684
 14685 2260-WRITE-PB-RECORD.
 14686     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14687                                    PB-INPUT-BY.
 14688     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14689     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14690                                    PB-INPUT-DT.
 14691
 14692     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14693     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14694                                    PB-CONTROL-BY-ORIG-BATCH.
 14695
 14696     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14697     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14698     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14699     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14700     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14701
 14702     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 267
* EL6311.cbl
 14703
 14704     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14705
 14706     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14707     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14708     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14709
 14710     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14711     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14712
 14713 2275-WRITE-PENDING-BUSINESS.
 14714     MOVE 'A'                    TO JP-RECORD-TYPE.
 14715     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14716     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14717     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14718
 14719
 14720* EXEC CICS HANDLE CONDITION
 14721*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14722*    END-EXEC.
 14723*    MOVE '"$%                   ! 4 #00013234' TO DFHEIV0
 14724     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14725     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14726     MOVE X'3420233030303133323334' TO DFHEIV0(25:11)
 14727     CALL 'kxdfhei1' USING DFHEIV0
 14728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14729
 14730
 14731
 14732* EXEC CICS WRITE
 14733*        DATASET (FILE-ID-ERPNDB)
 14734*        FROM    (PENDING-BUSINESS)
 14735*        RIDFLD  (PB-CONTROL-PRIMARY)
 14736*    END-EXEC.
 14737     MOVE LENGTH OF
 14738      PENDING-BUSINESS
 14739       TO DFHEIV11
 14740*    MOVE '&$ L                  ''   #00013238' TO DFHEIV0
 14741     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14742     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14743     MOVE X'2020233030303133323338' TO DFHEIV0(25:11)
 14744     CALL 'kxdfhei1' USING DFHEIV0,
 14745           FILE-ID-ERPNDB,
 14746           PENDING-BUSINESS,
 14747           DFHEIV11,
 14748           PB-CONTROL-PRIMARY,
 14749           DFHEIV99,
 14750           DFHEIV99
 14751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14752
 14753
 14754     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14755
 14756     PERFORM 8400-LOG-JOURNAL-RECORD.
 14757
 14758******************************************************************
 14759*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14760******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 268
* EL6311.cbl
 14761
 14762     display ' made it to add orig CANCEL cert '
 14763     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14764     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14765     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14766     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14767
 14768
 14769* EXEC CICS READ
 14770*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14771*        DATASET (FILE-ID-ELCERT)
 14772*        RIDFLD  (ELCERT-KEY)
 14773*        RESP    (WS-RESPONSE)
 14774*    END-EXEC.
 14775*    MOVE '&"S        E          (  N#00013258' TO DFHEIV0
 14776     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14777     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14778     MOVE X'204E233030303133323538' TO DFHEIV0(25:11)
 14779     CALL 'kxdfhei1' USING DFHEIV0,
 14780           FILE-ID-ELCERT,
 14781           DFHEIV20,
 14782           DFHEIV99,
 14783           ELCERT-KEY,
 14784           DFHEIV99,
 14785           DFHEIV99,
 14786           DFHEIV99
 14787     SET ADDRESS OF CERTIFICATE-MASTER TO
 14788         DFHEIV20
 14789     MOVE EIBRESP  TO WS-RESPONSE
 14790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14791
 14792
 14793     IF NOT RESP-NORMAL
 14794        GO TO 2276-BYPASS-CRTO
 14795     END-IF
 14796
 14797     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14798     MOVE ' '                    TO WS-ERMAIL-SW
 14799
 14800
 14801* EXEC CICS READ
 14802*       DATASET   (FILE-ID-ERMAIL)
 14803*       SET       (ADDRESS OF MAILING-DATA)
 14804*       RIDFLD    (ERMAIL-KEY)
 14805*       RESP      (WS-RESPONSE)
 14806*    END-EXEC
 14807*    MOVE '&"S        E          (  N#00013272' TO DFHEIV0
 14808     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14809     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14810     MOVE X'204E233030303133323732' TO DFHEIV0(25:11)
 14811     CALL 'kxdfhei1' USING DFHEIV0,
 14812           FILE-ID-ERMAIL,
 14813           DFHEIV20,
 14814           DFHEIV99,
 14815           ERMAIL-KEY,
 14816           DFHEIV99,
 14817           DFHEIV99,
 14818           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 269
* EL6311.cbl
 14819     SET ADDRESS OF MAILING-DATA TO
 14820         DFHEIV20
 14821     MOVE EIBRESP  TO WS-RESPONSE
 14822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14823
 14824     IF RESP-NORMAL
 14825        SET ERMAIL-FOUND TO TRUE
 14826     END-IF
 14827
 14828     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 14829
 14830     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14831     MOVE 'OC'                   TO OC-RECORD-ID
 14832     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14833                                 TO OC-CONTROL-PRIMARY (1:33)
 14834     MOVE 'I'                    TO OC-RECORD-TYPE
 14835     MOVE +4096                  TO OC-KEY-SEQ-NO
 14836     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14837     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14838     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14839
 14840     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14841     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14842     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14843     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14844     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14845     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14846     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14847     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14848     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14849     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14850     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14851     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14852     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14853     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14854     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14855     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14856     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14857     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14858     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14859     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14860     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14861     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14862     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14863     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14864     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14865     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14866     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14867     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14868     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14869     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14870     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 14871     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 14872
 14873     IF ERMAIL-FOUND
 14874        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14875     END-IF
 14876     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 270
* EL6311.cbl
 14877        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 14878                           OC-INS-AGE-DEFAULT-FLAG
 14879        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 14880                           OC-JNT-AGE-DEFAULT-FLAG
 14881     END-IF
 14882     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14883     .
 14884 2275-WRITE-ELCRTO.
 14885
 14886
 14887* EXEC CICS WRITE
 14888*       DATASET   ('ELCRTO')
 14889*       FROM      (ORIGINAL-CERTIFICATE)
 14890*       RIDFLD    (OC-CONTROL-PRIMARY)
 14891*       RESP      (WS-RESPONSE)
 14892*    END-EXEC
 14893     MOVE LENGTH OF
 14894      ORIGINAL-CERTIFICATE
 14895       TO DFHEIV11
 14896     MOVE 'ELCRTO' TO DFHEIV1
 14897*    MOVE '&$ L                  ''  N#00013341' TO DFHEIV0
 14898     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14899     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14900     MOVE X'204E233030303133333431' TO DFHEIV0(25:11)
 14901     CALL 'kxdfhei1' USING DFHEIV0,
 14902           DFHEIV1,
 14903           ORIGINAL-CERTIFICATE,
 14904           DFHEIV11,
 14905           OC-CONTROL-PRIMARY,
 14906           DFHEIV99,
 14907           DFHEIV99
 14908     MOVE EIBRESP  TO WS-RESPONSE
 14909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14910
 14911     display ' just wrote 2275 ' ws-response
 14912     IF RESP-DUPKEY
 14913        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14914        GO TO 2275-WRITE-ELCRTO
 14915     ELSE
 14916        IF NOT RESP-NORMAL
 14917           MOVE -1               TO BMAINTL
 14918           MOVE ER-7450          TO EMI-ERROR
 14919           PERFORM 9900-ERROR-FORMAT
 14920                                 THRU 9900-EXIT
 14921           GO TO 8200-SEND-DATAONLY
 14922        END-IF
 14923     END-IF.
 14924
 14925 2276-BYPASS-CRTO.
 14926******************************************************************
 14927*       U P D A T E   T H E   B A T C H   H E A D E R            *
 14928******************************************************************
 14929
 14930
 14931* EXEC CICS READ
 14932*        INTO    (PENDING-BUSINESS)
 14933*        DATASET (FILE-ID-ERPNDB)
 14934*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 271
* EL6311.cbl
 14935*        UPDATE
 14936*    END-EXEC.
 14937     MOVE LENGTH OF
 14938      PENDING-BUSINESS
 14939       TO DFHEIV11
 14940*    MOVE '&"IL       EU         (   #00013367' TO DFHEIV0
 14941     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14942     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14943     MOVE X'2020233030303133333637' TO DFHEIV0(25:11)
 14944     CALL 'kxdfhei1' USING DFHEIV0,
 14945           FILE-ID-ERPNDB,
 14946           PENDING-BUSINESS,
 14947           DFHEIV11,
 14948           ERPNDB-KEY,
 14949           DFHEIV99,
 14950           DFHEIV99,
 14951           DFHEIV99
 14952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14953
 14954
 14955     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14956     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14957     MOVE 'B'                    TO JP-RECORD-TYPE.
 14958     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14959
 14960     PERFORM 8400-LOG-JOURNAL-RECORD.
 14961
 14962     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 14963
 14964
 14965* EXEC CICS REWRITE
 14966*        DATASET (FILE-ID-ERPNDB)
 14967*        FROM    (PENDING-BUSINESS)
 14968*    END-EXEC.
 14969     MOVE LENGTH OF
 14970      PENDING-BUSINESS
 14971       TO DFHEIV11
 14972*    MOVE '&& L                  %   #00013383' TO DFHEIV0
 14973     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14974     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14975     MOVE X'2020233030303133333833' TO DFHEIV0(25:11)
 14976     CALL 'kxdfhei1' USING DFHEIV0,
 14977           FILE-ID-ERPNDB,
 14978           PENDING-BUSINESS,
 14979           DFHEIV11,
 14980           DFHEIV99
 14981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14982
 14983
 14984     MOVE 'C'                    TO JP-RECORD-TYPE.
 14985     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14986
 14987     PERFORM 8400-LOG-JOURNAL-RECORD.
 14988
 14989     IF WS-ERRORS-PRESENT
 14990        GO TO 3900-RE-DISPLAY-RECORD.
 14991
 14992     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 272
* EL6311.cbl
 14993     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14994     MOVE LOW-VALUES             TO EL631CI.
 14995     MOVE  -1                    TO CMAINTL.
 14996     GO TO 8100-SEND-INITIAL-MAP.
 14997
 14998 2280-BATCH-HDR-NOT-FOUND.
 14999     MOVE -1                     TO BMAINTL.
 15000     MOVE ER-7450                TO EMI-ERROR.
 15001     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15002     GO TO 8200-SEND-DATAONLY.
 15003
 15004 2290-DUPLICATE-ALT-INDEX.
 15005
 15006******************************************************************
 15007*                                                                *
 15008*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 15009*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 15010*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 15011*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 15012*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 15013*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15014*                                                                *
 15015******************************************************************
 15016
 15017     IF LCP-ONCTR-02 =  0
 15018         ADD 1 TO LCP-ONCTR-02
 15019        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15020
 15021     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15022
 15023     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15024         NEXT SENTENCE
 15025     ELSE
 15026         ADD +1 TO PB-BATCH-SEQ-NO
 15027                   PB-CSR-BATCH-SEQ-NO
 15028         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15029         GO TO 2275-WRITE-PENDING-BUSINESS.
 15030
 15031     MOVE -1                     TO CCERTNOL.
 15032     MOVE AL-UABON               TO CCERTNOA.
 15033     MOVE AL-UNBON               TO CEFFDTA.
 15034
 15035     MOVE 1                      TO EMI-SUB
 15036                                    EMI-SWITCH1
 15037                                    EMI-SWITCH-AREA-1
 15038                                    EMI-SWITCH-AREA-2.
 15039
 15040     MOVE SPACES                 TO EMI-ERROR-LINES.
 15041
 15042
 15043* EXEC CICS SYNCPOINT ROLLBACK
 15044*    END-EXEC.
 15045*    MOVE '6"R                   !   #00013446' TO DFHEIV0
 15046     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15047     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15048     MOVE X'2020233030303133343436' TO DFHEIV0(25:11)
 15049     CALL 'kxdfhei1' USING DFHEIV0
 15050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 273
* EL6311.cbl
 15051
 15052
 15053     MOVE ER-2247                TO EMI-ERROR.
 15054     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15055     GO TO 8200-SEND-DATAONLY.
 15056
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 274
* EL6311.cbl
 15058
 15059******************************************************************
 15060*                                                                *
 15061*          C H A N G E   C A N C E L   R O U T I N E             *
 15062*                                                                *
 15063******************************************************************
 15064
 15065***************************************************************
 15066*                                                             *
 15067*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15068*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15069*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15070*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15071*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15072*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15073*     5. LINK TO THE EDIT ROUTINE.                            *
 15074*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15075*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15076*              THE EDIT ROUTINE.                              *
 15077*     7. REWRITE THE NEW ISSUE                                *
 15078*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15079*                                                             *
 15080***************************************************************
 15081 2300-CHANGE-CANCEL-ROUTINE.
 15082     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15083
 15084     IF CCHGL NOT = ZEROS
 15085        MOVE ER-2196             TO EMI-ERROR
 15086        MOVE AL-UABON            TO CMAINTA
 15087        MOVE -1                  TO CMAINTL
 15088        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15089        GO TO 8200-SEND-DATAONLY.
 15090
 15091     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15092
 15093     IF CSUFIXL NOT = ZEROS
 15094        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15095     ELSE
 15096        MOVE SPACE               TO WS-NEW-SUFFIX.
 15097
 15098     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15099     PERFORM 8600-DEEDIT.
 15100     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15101     MOVE '4'                    TO DC-OPTION-CODE.
 15102
 15103     PERFORM 9700-DATE-LINK.
 15104
 15105     IF DATE-CONVERSION-ERROR
 15106        MOVE ER-0348             TO EMI-ERROR
 15107        MOVE -1                  TO CEFFDTL
 15108        MOVE AL-UABON            TO CEFFDTA
 15109        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15110        GO TO 8200-SEND-DATAONLY
 15111     ELSE
 15112        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15113        MOVE AL-UANON            TO CEFFDTA
 15114        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15115
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 275
* EL6311.cbl
 15116 2325-PROCESS-CANCEL-CHANGES.
 15117
 15118* EXEC CICS HANDLE CONDITION
 15119*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15120*    END-EXEC.
 15121*    MOVE '"$I                   ! 5 #00013513' TO DFHEIV0
 15122     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15123     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15124     MOVE X'3520233030303133353133' TO DFHEIV0(25:11)
 15125     CALL 'kxdfhei1' USING DFHEIV0
 15126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15127
 15128
 15129     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15130     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15131     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15132
 15133
 15134* EXEC CICS GETMAIN
 15135*        SET      (ADDRESS OF PENDING-BUSINESS)
 15136*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15137*        INITIMG  (GETMAIN-SPACE)
 15138*     END-EXEC.
 15139*    MOVE ',"IL                  $   #00013521' TO DFHEIV0
 15140     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15141     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15142     MOVE X'2020233030303133353231' TO DFHEIV0(25:11)
 15143     CALL 'kxdfhei1' USING DFHEIV0,
 15144           DFHEIV20,
 15145           ERPNDB-RECORD-LENGTH,
 15146           GETMAIN-SPACE
 15147     SET ADDRESS OF PENDING-BUSINESS TO
 15148         DFHEIV20
 15149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15150
 15151
 15152
 15153* EXEC CICS READ
 15154*        INTO    (PENDING-BUSINESS)
 15155*        DATASET (FILE-ID-ERPNDB)
 15156*        RIDFLD  (ERPNDB-KEY)
 15157*    END-EXEC.
 15158     MOVE LENGTH OF
 15159      PENDING-BUSINESS
 15160       TO DFHEIV11
 15161*    MOVE '&"IL       E          (   #00013527' TO DFHEIV0
 15162     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15163     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15164     MOVE X'2020233030303133353237' TO DFHEIV0(25:11)
 15165     CALL 'kxdfhei1' USING DFHEIV0,
 15166           FILE-ID-ERPNDB,
 15167           PENDING-BUSINESS,
 15168           DFHEIV11,
 15169           ERPNDB-KEY,
 15170           DFHEIV99,
 15171           DFHEIV99,
 15172           DFHEIV99
 15173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 276
* EL6311.cbl
 15174
 15175
 15176     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15177
 15178
 15179* EXEC CICS HANDLE CONDITION
 15180*         NOTFND     (2385-REC-NOT-FOUND)
 15181*    END-EXEC.
 15182*    MOVE '"$I                   ! 6 #00013535' TO DFHEIV0
 15183     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15184     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15185     MOVE X'3620233030303133353335' TO DFHEIV0(25:11)
 15186     CALL 'kxdfhei1' USING DFHEIV0
 15187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15188
 15189
 15190**********************************************************
 15191*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15192*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15193**********************************************************
 15194
 15195
 15196* EXEC CICS READ
 15197*        DATASET (FILE-ID-ERPNDB)
 15198*        INTO    (PENDING-BUSINESS)
 15199*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15200*    END-EXEC.
 15201     MOVE LENGTH OF
 15202      PENDING-BUSINESS
 15203       TO DFHEIV11
 15204*    MOVE '&"IL       E          (   #00013544' TO DFHEIV0
 15205     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15206     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15207     MOVE X'2020233030303133353434' TO DFHEIV0(25:11)
 15208     CALL 'kxdfhei1' USING DFHEIV0,
 15209           FILE-ID-ERPNDB,
 15210           PENDING-BUSINESS,
 15211           DFHEIV11,
 15212           PI-PREV-CONTROL-PRIMARY,
 15213           DFHEIV99,
 15214           DFHEIV99,
 15215           DFHEIV99
 15216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15217
 15218
 15219********** DO NOT ALLOW CHANGES IF THRU A/R
 15220     IF BMAINTI = 'C'
 15221         IF PB-EL860-INTERNAL-PROCESS
 15222             MOVE ER-4005          TO EMI-ERROR
 15223             MOVE -1               TO BMAINTL
 15224             MOVE AL-UABON         TO BMAINTA
 15225             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15226             GO TO 8200-SEND-DATAONLY.
 15227**********
 15228
 15229     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15230        MOVE -1                 TO CMAINTL
 15231        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 277
* EL6311.cbl
 15232        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15233        GO TO 8200-SEND-DATAONLY.
 15234
 15235     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15236        MOVE ER-2196             TO EMI-ERROR
 15237        MOVE AL-UABON            TO CMAINTA
 15238        MOVE -1                  TO CMAINTL
 15239        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15240        GO TO 8200-SEND-DATAONLY.
 15241     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15242
 15243     IF PB-BILLED-DT = LOW-VALUES AND
 15244        PB-CHG-COUNT = ZEROS
 15245        NEXT SENTENCE
 15246     ELSE
 15247        IF (CREFND1L GREATER THAN ZEROS AND
 15248            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15249           OR
 15250           (CREFND2L GREATER THAN ZEROS AND
 15251            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15252           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15253     if ((crefnd1l <> zeros)
 15254        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15255                      or
 15256        ((crefnd2l <> zeros)
 15257        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15258        continue
 15259     else
 15260        go to 2330-continue-change
 15261     end-if
 15262
 15263     move zeros                  to ws-check-amts
 15264     move ' '                    to ws-stop-sw
 15265                                    ws-check-sw
 15266                                    ws-proc-check-sw
 15267                                    ws-chek-browse-sw
 15268
 15269     perform 2500-browse-checks  thru 2500-exit
 15270
 15271     if i-have-processed-checks
 15272        or i-have-checks
 15273        continue
 15274     else
 15275        go to 2330-continue-change
 15276     end-if
 15277
 15278     display ' pb lf can ' pb-c-lf-cancel-amt
 15279     display ' ws lf can ' ws-crefnd1
 15280     if crefnd1l <> zeros
 15281        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15282        move ws-crefnd1 to ws-new-ref-total
 15283     else
 15284        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15285     end-if
 15286     display ' pb ah can ' pb-c-ah-cancel-amt
 15287     display ' ws ah can ' ws-crefnd2
 15288     display ' chk amts  ' ws-check-amts
 15289     if crefnd2l <> zeros
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 278
* EL6311.cbl
 15290        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15291        compute ws-new-ref-total = ws-new-ref-total +
 15292           ws-crefnd2
 15293     else
 15294        compute ws-new-ref-total = ws-new-ref-total +
 15295           pb-c-ah-cancel-amt
 15296     end-if
 15297
 15298     if zeros = (ws-lf-diff + ws-ah-diff)
 15299        move er-3449             to emi-error
 15300        perform 9900-error-format thru 9900-exit
 15301        go to 2330-continue-change
 15302     end-if
 15303
 15304     if (ws-new-ref-total < ws-check-amts)
 15305        and (pb-c-refund-sw = 'Y')
 15306        move er-3447             to emi-error
 15307        perform 9900-error-format thru 9900-exit
 15308        move al-uabon            to cmainta
 15309        move -1                  to cmaintl
 15310        go to 8200-send-dataonly
 15311     end-if
 15312
 15313     if (ws-new-ref-total > ws-check-amts)
 15314        and (ws-check-amts not = zeros)
 15315        move er-3448             to emi-error
 15316        move al-uabon            to crefnd1a
 15317                                    crefnd2a
 15318        perform 9900-error-format thru 9900-exit
 15319     end-if
 15320
 15321*     if (ws-lf-diff + ws-ah-diff) < zeros
 15322*        move er-3447             to emi-error
 15323*        perform 9900-error-format thru 9900-exit
 15324*        move al-uabon            to cmainta
 15325*        move -1                  to cmaintl
 15326*        go to 8200-send-dataonly
 15327*     end-if
 15328     .
 15329 2330-continue-change.
 15330
 15331
 15332* EXEC CICS READ
 15333*        DATASET (FILE-ID-ERPNDB)
 15334*        INTO    (PENDING-BUSINESS)
 15335*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15336*        UPDATE
 15337*    END-EXEC.
 15338     MOVE LENGTH OF
 15339      PENDING-BUSINESS
 15340       TO DFHEIV11
 15341*    MOVE '&"IL       EU         (   #00013662' TO DFHEIV0
 15342     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15343     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15344     MOVE X'2020233030303133363632' TO DFHEIV0(25:11)
 15345     CALL 'kxdfhei1' USING DFHEIV0,
 15346           FILE-ID-ERPNDB,
 15347           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 279
* EL6311.cbl
 15348           DFHEIV11,
 15349           PI-PREV-CONTROL-PRIMARY,
 15350           DFHEIV99,
 15351           DFHEIV99,
 15352           DFHEIV99
 15353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15354
 15355
 15356     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15357     MOVE 'B'                    TO JP-RECORD-TYPE
 15358     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15359     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15360
 15361     PERFORM 8400-LOG-JOURNAL-RECORD.
 15362
 15363     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15364          PB-CHG-COUNT NOT = ZEROS
 15365        IF (CREFND1L GREATER THAN ZEROS AND
 15366            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15367           OR
 15368           (CREFND2L GREATER THAN ZEROS AND
 15369            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15370            ADD +1                      TO PB-CHG-COUNT
 15371            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15372
 15373*    IF CMICRNOL  GREATER  ZEROS
 15374*        IF CMICRNOI  NUMERIC
 15375*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15376*            MOVE AL-UNNON       TO  CMICRNOA
 15377*        ELSE
 15378*            MOVE -1             TO  CMICRNOL
 15379*            MOVE AL-UNBON       TO  CMICRNOA
 15380*            MOVE ER-2701        TO  EMI-ERROR
 15381*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15382
 15383     IF CSUFIXL GREATER THAN ZEROS
 15384        MOVE CSUFIXI             TO PB-CERT-SFX.
 15385
 15386     IF CLSTNML GREATER THAN ZEROS
 15387         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15388
 15389     IF CCANREAL > ZEROS
 15390        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15391     END-IF
 15392     IF CPCYNL > ZEROS
 15393        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15394     END-IF
 15395     IF CCANDT1L    GREATER THAN ZEROS
 15396        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15397
 15398     IF CCANDT2L    GREATER THAN ZEROS
 15399        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15400
 15401     IF CMTHD1L    GREATER THAN +0
 15402        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15403
 15404     IF CMTHD2L    GREATER THAN +0
 15405        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 280
* EL6311.cbl
 15406
 15407     IF CREFND1L    GREATER THAN ZEROS
 15408        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15409        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15410        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15411        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15412
 15413     IF CREFND2L    GREATER THAN ZEROS
 15414        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15415        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15416        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15417        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15418
 15419     IF CLIVESL     GREATER THAN ZEROS
 15420        MOVE WS-CLIVES           TO PB-C-LIVES.
 15421
 15422     IF CPAYEEL     GREATER THAN ZEROS
 15423        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15424
 15425     IF CFORCEL     GREATER THAN ZEROS
 15426        MOVE CFORCEI             TO PB-FORCE-CODE.
 15427
 15428     IF CBILCDL     GREATER THAN ZEROS
 15429        MOVE CBILCDI             TO PB-RECORD-BILL.
 15430
 15431 2360-REWRITE-PB-RECORD.
 15432     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15433     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15434     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15435     MOVE 'C'                    TO JP-RECORD-TYPE.
 15436     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15437     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15438     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15439
 15440     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15441
 15442     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15443     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15444
 15445     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15446
 15447     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15448
 15449     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15450     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15451     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15452
 15453     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15454     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15455
 15456 2375-REWRITE-PENDING-BUSINESS.
 15457     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15458     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15459     MOVE 'C'                    TO JP-RECORD-TYPE.
 15460     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15461
 15462
 15463* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 281
* EL6311.cbl
 15464*        DATASET (FILE-ID-ERPNDB)
 15465*        FROM    (PENDING-BUSINESS)
 15466*    END-EXEC.
 15467     MOVE LENGTH OF
 15468      PENDING-BUSINESS
 15469       TO DFHEIV11
 15470*    MOVE '&& L                  %   #00013775' TO DFHEIV0
 15471     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15472     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15473     MOVE X'2020233030303133373735' TO DFHEIV0(25:11)
 15474     CALL 'kxdfhei1' USING DFHEIV0,
 15475           FILE-ID-ERPNDB,
 15476           PENDING-BUSINESS,
 15477           DFHEIV11,
 15478           DFHEIV99
 15479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15480
 15481
 15482     PERFORM 8400-LOG-JOURNAL-RECORD.
 15483
 15484******************************************************************
 15485*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15486******************************************************************
 15487
 15488     display ' made it to update orig cancel cert '
 15489
 15490     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15491     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15492     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15493     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15494
 15495
 15496* EXEC CICS READ
 15497*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15498*        DATASET (FILE-ID-ELCERT)
 15499*        RIDFLD  (ELCERT-KEY)
 15500*        RESP    (WS-RESPONSE)
 15501*    END-EXEC.
 15502*    MOVE '&"S        E          (  N#00013793' TO DFHEIV0
 15503     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15504     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15505     MOVE X'204E233030303133373933' TO DFHEIV0(25:11)
 15506     CALL 'kxdfhei1' USING DFHEIV0,
 15507           FILE-ID-ELCERT,
 15508           DFHEIV20,
 15509           DFHEIV99,
 15510           ELCERT-KEY,
 15511           DFHEIV99,
 15512           DFHEIV99,
 15513           DFHEIV99
 15514     SET ADDRESS OF CERTIFICATE-MASTER TO
 15515         DFHEIV20
 15516     MOVE EIBRESP  TO WS-RESPONSE
 15517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15518
 15519
 15520     IF NOT RESP-NORMAL
 15521        GO TO 2376-BYPASS-CRTO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 282
* EL6311.cbl
 15522     END-IF
 15523
 15524
 15525     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15526     MOVE ' '                    TO WS-ERMAIL-SW
 15527
 15528
 15529* EXEC CICS READ
 15530*       DATASET   (FILE-ID-ERMAIL)
 15531*       SET       (ADDRESS OF MAILING-DATA)
 15532*       RIDFLD    (ERMAIL-KEY)
 15533*       RESP      (WS-RESPONSE)
 15534*    END-EXEC
 15535*    MOVE '&"S        E          (  N#00013808' TO DFHEIV0
 15536     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15537     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15538     MOVE X'204E233030303133383038' TO DFHEIV0(25:11)
 15539     CALL 'kxdfhei1' USING DFHEIV0,
 15540           FILE-ID-ERMAIL,
 15541           DFHEIV20,
 15542           DFHEIV99,
 15543           ERMAIL-KEY,
 15544           DFHEIV99,
 15545           DFHEIV99,
 15546           DFHEIV99
 15547     SET ADDRESS OF MAILING-DATA TO
 15548         DFHEIV20
 15549     MOVE EIBRESP  TO WS-RESPONSE
 15550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15551
 15552     IF RESP-NORMAL
 15553        SET ERMAIL-FOUND TO TRUE
 15554     END-IF
 15555
 15556     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15557
 15558     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15559                                 TO ELCRTO-KEY
 15560     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15561     MOVE +0                     TO ELCRTO-SEQ-NO
 15562
 15563
 15564* EXEC CICS READ
 15565*       DATASET   ('ELCRTO')
 15566*       INTO      (ORIGINAL-CERTIFICATE)
 15567*       RIDFLD    (ELCRTO-KEY)
 15568*       GTEQ
 15569*       RESP      (WS-RESPONSE)
 15570*    END-EXEC
 15571     MOVE LENGTH OF
 15572      ORIGINAL-CERTIFICATE
 15573       TO DFHEIV11
 15574     MOVE 'ELCRTO' TO DFHEIV1
 15575*    MOVE '&"IL       G          (  N#00013826' TO DFHEIV0
 15576     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15577     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15578     MOVE X'204E233030303133383236' TO DFHEIV0(25:11)
 15579     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 283
* EL6311.cbl
 15580           DFHEIV1,
 15581           ORIGINAL-CERTIFICATE,
 15582           DFHEIV11,
 15583           ELCRTO-KEY,
 15584           DFHEIV99,
 15585           DFHEIV99,
 15586           DFHEIV99
 15587     MOVE EIBRESP  TO WS-RESPONSE
 15588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15589
 15590     display ' just read gteq ' ws-response
 15591     IF RESP-NORMAL
 15592        AND (OC-CONTROL-PRIMARY (1:33) =
 15593                 PB-CONTROL-BY-ACCOUNT (1:33))
 15594        AND (OC-RECORD-TYPE = 'I')
 15595        display ' resp norm, key =, type i '
 15596        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15597           display ' end proc blank '
 15598           display ' csr edit session ' PI-CSR-SESSION-SW
 15599           IF NOT CSR-EDIT-SESSION
 15600
 15601* EXEC CICS READ
 15602*                DATASET   ('ELCRTO')
 15603*                INTO      (ORIGINAL-CERTIFICATE)
 15604*                RIDFLD    (OC-CONTROL-PRIMARY)
 15605*                UPDATE
 15606*                RESP      (WS-RESPONSE)
 15607*             END-EXEC
 15608     MOVE LENGTH OF
 15609      ORIGINAL-CERTIFICATE
 15610       TO DFHEIV11
 15611     MOVE 'ELCRTO' TO DFHEIV1
 15612*    MOVE '&"IL       EU         (  N#00013844' TO DFHEIV0
 15613     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15614     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15615     MOVE X'204E233030303133383434' TO DFHEIV0(25:11)
 15616     CALL 'kxdfhei1' USING DFHEIV0,
 15617           DFHEIV1,
 15618           ORIGINAL-CERTIFICATE,
 15619           DFHEIV11,
 15620           OC-CONTROL-PRIMARY,
 15621           DFHEIV99,
 15622           DFHEIV99,
 15623           DFHEIV99
 15624     MOVE EIBRESP  TO WS-RESPONSE
 15625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15626              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15627              IF RESP-NORMAL
 15628                 display ' good read upd '
 15629                 IF OC-ISSUE-TRAN-IND = 'N'
 15630                    MOVE CM-INSURED-LAST-NAME   TO
 15631                         OC-INS-LAST-NAME
 15632                    MOVE CM-INSURED-FIRST-NAME  TO
 15633                         OC-INS-FIRST-NAME
 15634                    MOVE CM-INSURED-INITIAL2    TO
 15635                         OC-INS-MIDDLE-INIT
 15636                    MOVE CM-INSURED-ISSUE-AGE   TO
 15637                         OC-INS-AGE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 284
* EL6311.cbl
 15638                    MOVE CM-JT-LAST-NAME        TO
 15639                         OC-JNT-LAST-NAME
 15640                    MOVE CM-JT-FIRST-NAME       TO
 15641                         OC-JNT-FIRST-NAME
 15642                    MOVE CM-JT-INITIAL          TO
 15643                         OC-JNT-MIDDLE-INIT
 15644                    MOVE CM-INSURED-JOINT-AGE   TO
 15645                         OC-JNT-AGE
 15646                    MOVE CM-LF-BENEFIT-CD       TO
 15647                         OC-LF-BENCD
 15648                    MOVE CM-LF-ORIG-TERM        TO
 15649                         OC-LF-TERM
 15650                    MOVE CM-LF-BENEFIT-AMT      TO
 15651                         OC-LF-BEN-AMT
 15652                    MOVE CM-LF-PREMIUM-AMT      TO
 15653                         OC-LF-PRM-AMT
 15654                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15655                         OC-LF-ALT-BEN-AMT
 15656                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 15657                         OC-LF-ALT-PRM-AMT
 15658                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15659                         OC-LF-EXP-DT
 15660                    MOVE CM-LIFE-COMM-PCT       TO
 15661                         OC-LF-COMM-PCT
 15662                    MOVE CM-AH-BENEFIT-CD       TO
 15663                         OC-AH-BENCD
 15664                    MOVE CM-AH-ORIG-TERM        TO
 15665                         OC-AH-TERM
 15666                    MOVE CM-AH-BENEFIT-AMT      TO
 15667                         OC-AH-BEN-AMT
 15668                    MOVE CM-AH-PREMIUM-AMT      TO
 15669                         OC-AH-PRM-AMT
 15670                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15671                         OC-AH-EXP-DT
 15672                    MOVE CM-AH-COMM-PCT         TO
 15673                         OC-AH-COMM-PCT
 15674                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15675                         OC-AH-CP
 15676                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15677                         OC-1ST-PMT-DT
 15678                 END-IF
 15679                 MOVE PB-C-LF-CANCEL-DT      TO
 15680                         OC-LF-CANCEL-DT
 15681                 MOVE PB-C-LF-CANCEL-AMT     TO
 15682                         OC-LF-CANCEL-AMT
 15683                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15684                         OC-LF-ITD-CANCEL-AMT
 15685                 MOVE PB-C-AH-CANCEL-DT      TO
 15686                         OC-AH-CANCEL-DT
 15687                 MOVE PB-C-AH-CANCEL-AMT     TO
 15688                         OC-AH-CANCEL-AMT
 15689                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15690                         OC-AH-ITD-CANCEL-AMT
 15691                 MOVE 'Y'                    TO
 15692                         OC-CANCEL-TRAN-IND
 15693                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15694                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15695                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 285
* EL6311.cbl
 15696                 IF ERMAIL-FOUND
 15697                    MOVE MA-CRED-BENE-NAME
 15698                                 TO OC-CRED-BENE-NAME
 15699                 END-IF
 15700                 IF NOT CERT-TRL-REC-NOT-FOUND
 15701                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15702                           OC-INS-AGE-DEFAULT-FLAG
 15703                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15704                           OC-JNT-AGE-DEFAULT-FLAG
 15705                 END-IF
 15706
 15707* EXEC CICS REWRITE
 15708*                   DATASET   ('ELCRTO')
 15709*                   FROM      (ORIGINAL-CERTIFICATE)
 15710*                   RESP      (WS-RESPONSE)
 15711*                END-EXEC
 15712     MOVE LENGTH OF
 15713      ORIGINAL-CERTIFICATE
 15714       TO DFHEIV11
 15715     MOVE 'ELCRTO' TO DFHEIV1
 15716*    MOVE '&& L                  %  N#00013931' TO DFHEIV0
 15717     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15718     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15719     MOVE X'204E233030303133393331' TO DFHEIV0(25:11)
 15720     CALL 'kxdfhei1' USING DFHEIV0,
 15721           DFHEIV1,
 15722           ORIGINAL-CERTIFICATE,
 15723           DFHEIV11,
 15724           DFHEIV99
 15725     MOVE EIBRESP  TO WS-RESPONSE
 15726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15727                 display ' just rewrote ' ws-response
 15728              END-IF
 15729           END-IF
 15730        ELSE
 15731           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15732           MOVE 'OC'             TO OC-RECORD-ID
 15733           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15734           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15735           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15736           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15737           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15738           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15739           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15740           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15741           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15742           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15743           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15744           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15745           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15746           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15747           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15748           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15749           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15750           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15751           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15752           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15753           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 286
* EL6311.cbl
 15754           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15755           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15756           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15757           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15758           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15759           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15760           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15761           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15762           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15763           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15764           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15765           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15766           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15767           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15768           IF ERMAIL-FOUND
 15769              MOVE MA-CRED-BENE-NAME
 15770                                 TO OC-CRED-BENE-NAME
 15771           END-IF
 15772           IF NOT CERT-TRL-REC-NOT-FOUND
 15773              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15774                           OC-INS-AGE-DEFAULT-FLAG
 15775              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15776                           OC-JNT-AGE-DEFAULT-FLAG
 15777           END-IF
 15778           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15779
 15780* EXEC CICS WRITE
 15781*             DATASET   ('ELCRTO')
 15782*             FROM      (ORIGINAL-CERTIFICATE)
 15783*             RIDFLD    (OC-CONTROL-PRIMARY)
 15784*             RESP      (WS-RESPONSE)
 15785*          END-EXEC
 15786     MOVE LENGTH OF
 15787      ORIGINAL-CERTIFICATE
 15788       TO DFHEIV11
 15789     MOVE 'ELCRTO' TO DFHEIV1
 15790*    MOVE '&$ L                  ''  N#00013988' TO DFHEIV0
 15791     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15792     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15793     MOVE X'204E233030303133393838' TO DFHEIV0(25:11)
 15794     CALL 'kxdfhei1' USING DFHEIV0,
 15795           DFHEIV1,
 15796           ORIGINAL-CERTIFICATE,
 15797           DFHEIV11,
 15798           OC-CONTROL-PRIMARY,
 15799           DFHEIV99,
 15800           DFHEIV99
 15801     MOVE EIBRESP  TO WS-RESPONSE
 15802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15803        END-IF
 15804     ELSE
 15805        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15806        MOVE 'OC'                TO OC-RECORD-ID
 15807        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15808                                 TO OC-CONTROL-PRIMARY (1:33)
 15809        MOVE 'I'                 TO OC-RECORD-TYPE
 15810        MOVE +4096               TO OC-KEY-SEQ-NO
 15811        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 287
* EL6311.cbl
 15812        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15813        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15814        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15815        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15816        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15817        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15818        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15819        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15820        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15821        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15822        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15823        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15824        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15825        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15826        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15827        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15828        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15829        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15830        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15831        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15832        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15833        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15834        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15835        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15836        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15837        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15838        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15839        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15840        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15841        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15842        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15843        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15844        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15845        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15846        IF ERMAIL-FOUND
 15847           MOVE MA-CRED-BENE-NAME
 15848                                 TO OC-CRED-BENE-NAME
 15849        END-IF
 15850        IF NOT CERT-TRL-REC-NOT-FOUND
 15851           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15852                           OC-INS-AGE-DEFAULT-FLAG
 15853           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15854                           OC-JNT-AGE-DEFAULT-FLAG
 15855        END-IF
 15856        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15857
 15858
 15859* EXEC CICS WRITE
 15860*          DATASET   ('ELCRTO')
 15861*          FROM      (ORIGINAL-CERTIFICATE)
 15862*          RIDFLD    (OC-CONTROL-PRIMARY)
 15863*          RESP      (WS-RESPONSE)
 15864*       END-EXEC
 15865     MOVE LENGTH OF
 15866      ORIGINAL-CERTIFICATE
 15867       TO DFHEIV11
 15868     MOVE 'ELCRTO' TO DFHEIV1
 15869*    MOVE '&$ L                  ''  N#00014049' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 288
* EL6311.cbl
 15870     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15871     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15872     MOVE X'204E233030303134303439' TO DFHEIV0(25:11)
 15873     CALL 'kxdfhei1' USING DFHEIV0,
 15874           DFHEIV1,
 15875           ORIGINAL-CERTIFICATE,
 15876           DFHEIV11,
 15877           OC-CONTROL-PRIMARY,
 15878           DFHEIV99,
 15879           DFHEIV99
 15880     MOVE EIBRESP  TO WS-RESPONSE
 15881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15882     END-IF.
 15883
 15884 2376-BYPASS-CRTO.
 15885******************************************************************
 15886*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15887******************************************************************
 15888
 15889
 15890* EXEC CICS HANDLE CONDITION
 15891*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15892*    END-EXEC.
 15893*    MOVE '"$I                   ! 7 #00014062' TO DFHEIV0
 15894     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15895     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15896     MOVE X'3720233030303134303632' TO DFHEIV0(25:11)
 15897     CALL 'kxdfhei1' USING DFHEIV0
 15898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15899
 15900
 15901
 15902* EXEC CICS READ
 15903*        INTO    (PENDING-BUSINESS)
 15904*        DATASET (FILE-ID-ERPNDB)
 15905*        RIDFLD  (ERPNDB-KEY)
 15906*        UPDATE
 15907*    END-EXEC.
 15908     MOVE LENGTH OF
 15909      PENDING-BUSINESS
 15910       TO DFHEIV11
 15911*    MOVE '&"IL       EU         (   #00014066' TO DFHEIV0
 15912     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15913     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15914     MOVE X'2020233030303134303636' TO DFHEIV0(25:11)
 15915     CALL 'kxdfhei1' USING DFHEIV0,
 15916           FILE-ID-ERPNDB,
 15917           PENDING-BUSINESS,
 15918           DFHEIV11,
 15919           ERPNDB-KEY,
 15920           DFHEIV99,
 15921           DFHEIV99,
 15922           DFHEIV99
 15923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15924
 15925
 15926     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15927     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 289
* EL6311.cbl
 15928     MOVE 'B'                    TO JP-RECORD-TYPE.
 15929     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15930
 15931     PERFORM 8400-LOG-JOURNAL-RECORD.
 15932
 15933     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15934
 15935
 15936* EXEC CICS REWRITE
 15937*        DATASET (FILE-ID-ERPNDB)
 15938*        FROM    (PENDING-BUSINESS)
 15939*    END-EXEC.
 15940     MOVE LENGTH OF
 15941      PENDING-BUSINESS
 15942       TO DFHEIV11
 15943*    MOVE '&& L                  %   #00014082' TO DFHEIV0
 15944     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15945     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15946     MOVE X'2020233030303134303832' TO DFHEIV0(25:11)
 15947     CALL 'kxdfhei1' USING DFHEIV0,
 15948           FILE-ID-ERPNDB,
 15949           PENDING-BUSINESS,
 15950           DFHEIV11,
 15951           DFHEIV99
 15952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15953
 15954
 15955     MOVE 'C'                    TO JP-RECORD-TYPE.
 15956     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15957
 15958     PERFORM 8400-LOG-JOURNAL-RECORD.
 15959
 15960     IF WS-ERRORS-PRESENT
 15961         GO TO 3900-RE-DISPLAY-RECORD.
 15962
 15963     MOVE ZEROS                  TO EMI-ERROR
 15964     MOVE -1                     TO CMAINTL
 15965     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15966     GO TO 3900-RE-DISPLAY-RECORD.
 15967
 15968 2380-BATCH-HDR-NOT-FOUND.
 15969     MOVE -1                     TO BMAINTL.
 15970     MOVE ER-7450                TO EMI-ERROR.
 15971     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15972     GO TO 8200-SEND-DATAONLY.
 15973
 15974 2385-REC-NOT-FOUND.
 15975     MOVE -1                     TO BMAINTL.
 15976     MOVE ER-7451                TO EMI-ERROR.
 15977     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15978     GO TO 8200-SEND-DATAONLY.
 15979
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 290
* EL6311.cbl
 15981
 15982******************************************************************
 15983*                                                                *
 15984*          D E L E T E   C A N C E L   R O U T I N E             *
 15985*                                                                *
 15986******************************************************************
 15987
 15988 2400-DELETE-CANCEL-ROUTINE.
 15989     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 15990
 15991     IF CCHGL NOT = ZEROS
 15992        MOVE ER-2196             TO EMI-ERROR
 15993        MOVE AL-UABON            TO CMAINTA
 15994        MOVE -1                  TO CMAINTL
 15995        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15996        GO TO 8200-SEND-DATAONLY.
 15997
 15998
 15999* EXEC CICS HANDLE CONDITION
 16000*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16001*    END-EXEC.
 16002*    MOVE '"$I                   ! 8 #00014130' TO DFHEIV0
 16003     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16004     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16005     MOVE X'3820233030303134313330' TO DFHEIV0(25:11)
 16006     CALL 'kxdfhei1' USING DFHEIV0
 16007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16008
 16009
 16010     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16011     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16012     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16013
 16014
 16015* EXEC CICS READ
 16016*        SET     (ADDRESS OF PENDING-BUSINESS)
 16017*        DATASET (FILE-ID-ERPNDB)
 16018*        RIDFLD  (ERPNDB-KEY)
 16019*    END-EXEC.
 16020*    MOVE '&"S        E          (   #00014138' TO DFHEIV0
 16021     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16022     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16023     MOVE X'2020233030303134313338' TO DFHEIV0(25:11)
 16024     CALL 'kxdfhei1' USING DFHEIV0,
 16025           FILE-ID-ERPNDB,
 16026           DFHEIV20,
 16027           DFHEIV99,
 16028           ERPNDB-KEY,
 16029           DFHEIV99,
 16030           DFHEIV99,
 16031           DFHEIV99
 16032     SET ADDRESS OF PENDING-BUSINESS TO
 16033         DFHEIV20
 16034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16035
 16036
 16037     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16038
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 291
* EL6311.cbl
 16039     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16040
 16041     IF CSUFIXL NOT = ZEROS
 16042        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16043     ELSE
 16044        MOVE SPACE               TO WS-NEW-SUFFIX.
 16045
 16046     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16047
 16048     PERFORM 8600-DEEDIT.
 16049     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16050     MOVE '4'                    TO DC-OPTION-CODE.
 16051     PERFORM 9700-DATE-LINK.
 16052
 16053     IF DATE-CONVERSION-ERROR
 16054        MOVE ER-0348             TO EMI-ERROR
 16055        MOVE -1                  TO CEFFDTL
 16056        MOVE AL-UABON            TO CEFFDTA
 16057        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16058        GO TO 8200-SEND-DATAONLY
 16059     ELSE
 16060        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16061        MOVE AL-UANON            TO CEFFDTA
 16062        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16063
 16064
 16065* EXEC CICS HANDLE CONDITION
 16066*         NOTFND    (2490-RECORD-NOT-FOUND)
 16067*    END-EXEC.
 16068*    MOVE '"$I                   ! 9 #00014171' TO DFHEIV0
 16069     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16070     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16071     MOVE X'3920233030303134313731' TO DFHEIV0(25:11)
 16072     CALL 'kxdfhei1' USING DFHEIV0
 16073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16074
 16075
 16076
 16077* EXEC CICS READ
 16078*        SET     (ADDRESS OF PENDING-BUSINESS)
 16079*        DATASET (FILE-ID-ERPNDB)
 16080*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16081*        UPDATE
 16082*    END-EXEC.
 16083*    MOVE '&"S        EU         (   #00014175' TO DFHEIV0
 16084     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16085     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16086     MOVE X'2020233030303134313735' TO DFHEIV0(25:11)
 16087     CALL 'kxdfhei1' USING DFHEIV0,
 16088           FILE-ID-ERPNDB,
 16089           DFHEIV20,
 16090           DFHEIV99,
 16091           PI-PREV-CONTROL-PRIMARY,
 16092           DFHEIV99,
 16093           DFHEIV99,
 16094           DFHEIV99
 16095     SET ADDRESS OF PENDING-BUSINESS TO
 16096         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 292
* EL6311.cbl
 16097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16098
 16099
 16100     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16101        MOVE -1                 TO CMAINTL
 16102        MOVE ER-2197            TO EMI-ERROR
 16103        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16104        GO TO 8200-SEND-DATAONLY.
 16105
 16106     IF PB-BILLED-DT NOT = LOW-VALUES
 16107        MOVE -1                 TO CMAINTL
 16108        MOVE ER-2129            TO EMI-ERROR
 16109        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16110        GO TO 8200-SEND-DATAONLY.
 16111
 16112     IF PB-CHG-COUNT NOT = ZEROS
 16113        MOVE ER-2336            TO EMI-ERROR
 16114        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16115        MOVE AL-UABON            TO CMAINTA
 16116        MOVE -1                  TO CMAINTL
 16117        GO TO 8200-SEND-DATAONLY.
 16118
 16119     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16120        PB-CHG-COUNT NOT = ZEROS
 16121        MOVE ER-2196             TO EMI-ERROR
 16122        MOVE AL-UABON            TO CMAINTA
 16123        MOVE -1                  TO CMAINTL
 16124        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16125        GO TO 8200-SEND-DATAONLY.
 16126
 16127     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16128        MOVE ER-2900 TO EMI-ERROR
 16129        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16130        MOVE AL-UABON         TO CMAINTA
 16131        MOVE -1               TO CMAINTL
 16132        GO TO 8200-SEND-DATAONLY.
 16133     move ' '                    to ws-stop-sw
 16134                                    ws-check-sw
 16135                                    ws-proc-check-sw
 16136                                    ws-chek-browse-sw
 16137
 16138     perform 2500-browse-checks  thru 2500-exit
 16139     if (i-have-processed-checks)
 16140        and (pb-c-refund-sw = 'Y')
 16141        move er-3446             to emi-error
 16142        perform 9900-error-format thru 9900-exit
 16143        move al-uabon            to cmainta
 16144        move -1                  to cmaintl
 16145        go to 8200-send-dataonly
 16146     end-if
 16147
 16148* EXEC CICS HANDLE CONDITION
 16149*         NOTFND  (2475-CONTINUE-DELETE)
 16150*    END-EXEC
 16151*    MOVE '"$I                   ! : #00014229' TO DFHEIV0
 16152     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16153     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16154     MOVE X'3A20233030303134323239' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 293
* EL6311.cbl
 16155     CALL 'kxdfhei1' USING DFHEIV0
 16156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16157
 16158     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16159     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16160     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16161     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16162
 16163
 16164* EXEC CICS READ
 16165*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16166*        DATASET (FILE-ID-ELCERT)
 16167*        RIDFLD  (ELCERT-KEY)
 16168*        UPDATE
 16169*    END-EXEC.
 16170*    MOVE '&"S        EU         (   #00014238' TO DFHEIV0
 16171     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16172     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16173     MOVE X'2020233030303134323338' TO DFHEIV0(25:11)
 16174     CALL 'kxdfhei1' USING DFHEIV0,
 16175           FILE-ID-ELCERT,
 16176           DFHEIV20,
 16177           DFHEIV99,
 16178           ELCERT-KEY,
 16179           DFHEIV99,
 16180           DFHEIV99,
 16181           DFHEIV99
 16182     SET ADDRESS OF CERTIFICATE-MASTER TO
 16183         DFHEIV20
 16184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16185
 16186
 16187     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16188
 16189     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16190     MOVE 'B'                    TO JP-RECORD-TYPE.
 16191     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16192     PERFORM 8400-LOG-JOURNAL-RECORD.
 16193
 16194     IF PB-CI-LIVES NOT NUMERIC
 16195         MOVE ZERO                    TO PB-CI-LIVES.
 16196
 16197     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16198        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16199           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16200           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16201           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16202                                            CM-LF-CANCEL-DT
 16203           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16204        ELSE
 16205           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16206           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16207           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16208           MOVE PB-CI-LIVES              TO CM-LIVES.
 16209
 16210     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16211        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16212           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 294
* EL6311.cbl
 16213               MOVE CM-LF-STATUS-AT-CANCEL
 16214                                        TO CM-LF-CURRENT-STATUS
 16215               MOVE SPACE
 16216                                        TO CM-LF-STATUS-AT-CANCEL
 16217           ELSE
 16218               MOVE PB-CI-LF-POLICY-STATUS
 16219                                        TO CM-LF-CURRENT-STATUS
 16220        ELSE
 16221           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16222
 16223
 16224     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16225        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16226           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16227           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16228           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16229                                            CM-AH-CANCEL-DT
 16230           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16231        ELSE
 16232           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16233           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16234           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16235           MOVE PB-CI-LIVES              TO CM-LIVES.
 16236
 16237     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16238        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16239           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16240               MOVE CM-AH-STATUS-AT-CANCEL
 16241                                        TO CM-AH-CURRENT-STATUS
 16242               MOVE SPACE
 16243                                        TO CM-AH-STATUS-AT-CANCEL
 16244           ELSE
 16245               MOVE PB-CI-AH-POLICY-STATUS
 16246                                        TO CM-AH-CURRENT-STATUS
 16247        ELSE
 16248           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16249
 16250 2450-REWRITE-CERT.
 16251     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16252     MOVE 'C'                      TO JP-RECORD-TYPE.
 16253     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16254
 16255
 16256* EXEC CICS REWRITE
 16257*        DATASET  (FILE-ID-ELCERT)
 16258*        FROM     (CERTIFICATE-MASTER)
 16259*    END-EXEC.
 16260     MOVE LENGTH OF
 16261      CERTIFICATE-MASTER
 16262       TO DFHEIV11
 16263*    MOVE '&& L                  %   #00014313' TO DFHEIV0
 16264     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16265     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16266     MOVE X'2020233030303134333133' TO DFHEIV0(25:11)
 16267     CALL 'kxdfhei1' USING DFHEIV0,
 16268           FILE-ID-ELCERT,
 16269           CERTIFICATE-MASTER,
 16270           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 295
* EL6311.cbl
 16271           DFHEIV99
 16272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16273
 16274
 16275     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16276
 16277     PERFORM 8400-LOG-JOURNAL-RECORD.
 16278
 16279     move ' '                    to ws-stop-sw
 16280                                    ws-proc-check-sw
 16281                                    ws-chek-browse-sw
 16282
 16283     if i-have-checks
 16284        perform until i-say-stop
 16285           perform 2510-startbr-erchek
 16286                                 thru 2510-exit
 16287           if resp-normal
 16288              perform 2520-readnext-erchek
 16289                                 thru 2520-exit
 16290           end-if
 16291           if (not resp-normal)
 16292              or (pb-control-by-account (1:33) not =
 16293                 ch-control-primary (1:33))
 16294                 set i-say-stop to true
 16295           else
 16296              perform 2530-readupd-erchek
 16297                                 thru 2530-exit
 16298              if resp-normal
 16299                 perform 2540-delete-erchek
 16300                                 thru 2540-exit
 16301              end-if
 16302              if ws-chek-browse-sw = 'Y'
 16303                 perform 2525-endbr-erchek
 16304                                 thru 2525-exit
 16305                 move ' '        to ws-chek-browse-sw
 16306              end-if
 16307           end-if
 16308        end-perform
 16309     end-if
 16310
 16311     if ws-chek-browse-sw = 'Y'
 16312        perform 2525-endbr-erchek thru 2525-exit
 16313     end-if
 16314     .
 16315 2475-CONTINUE-DELETE.
 16316     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16317     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16318
 16319     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16320     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16321
 16322     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16323
 16324     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16325     MOVE 'D'                    TO JP-RECORD-TYPE
 16326     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16327
 16328
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 296
* EL6311.cbl
 16329* EXEC CICS DELETE
 16330*        DATASET    (FILE-ID-ERPNDB)
 16331*    END-EXEC.
 16332*    MOVE '&(                    &   #00014371' TO DFHEIV0
 16333     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16334     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16335     MOVE X'2020233030303134333731' TO DFHEIV0(25:11)
 16336     CALL 'kxdfhei1' USING DFHEIV0,
 16337           FILE-ID-ERPNDB,
 16338           DFHEIV99,
 16339           DFHEIV99,
 16340           DFHEIV99,
 16341           DFHEIV99
 16342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16343
 16344
 16345     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16346
 16347     PERFORM 8400-LOG-JOURNAL-RECORD.
 16348
 16349     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16350     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16351
 16352
 16353* EXEC CICS HANDLE CONDITION
 16354*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16355*    END-EXEC.
 16356*    MOVE '"$I                   ! ; #00014382' TO DFHEIV0
 16357     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16358     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16359     MOVE X'3B20233030303134333832' TO DFHEIV0(25:11)
 16360     CALL 'kxdfhei1' USING DFHEIV0
 16361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16362
 16363
 16364
 16365* EXEC CICS READ
 16366*        SET     (ADDRESS OF PENDING-BUSINESS)
 16367*        DATASET (FILE-ID-ERPNDB)
 16368*        RIDFLD  (ERPNDB-KEY)
 16369*        UPDATE
 16370*    END-EXEC.
 16371*    MOVE '&"S        EU         (   #00014386' TO DFHEIV0
 16372     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16373     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16374     MOVE X'2020233030303134333836' TO DFHEIV0(25:11)
 16375     CALL 'kxdfhei1' USING DFHEIV0,
 16376           FILE-ID-ERPNDB,
 16377           DFHEIV20,
 16378           DFHEIV99,
 16379           ERPNDB-KEY,
 16380           DFHEIV99,
 16381           DFHEIV99,
 16382           DFHEIV99
 16383     SET ADDRESS OF PENDING-BUSINESS TO
 16384         DFHEIV20
 16385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16386
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 297
* EL6311.cbl
 16387
 16388     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16389     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16390
 16391     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16392        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16393        MOVE 'D'                 TO JP-RECORD-TYPE
 16394        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16395
 16396* EXEC CICS DELETE
 16397*            DATASET    (FILE-ID-ERPNDB)
 16398*       END-EXEC
 16399*    MOVE '&(                    &   #00014400' TO DFHEIV0
 16400     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16401     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16402     MOVE X'2020233030303134343030' TO DFHEIV0(25:11)
 16403     CALL 'kxdfhei1' USING DFHEIV0,
 16404           FILE-ID-ERPNDB,
 16405           DFHEIV99,
 16406           DFHEIV99,
 16407           DFHEIV99,
 16408           DFHEIV99
 16409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16410        PERFORM 8400-LOG-JOURNAL-RECORD
 16411     ELSE
 16412        MOVE 'B'                 TO JP-RECORD-TYPE
 16413        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16414        PERFORM 8400-LOG-JOURNAL-RECORD
 16415        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16416        MOVE 'C'                 TO JP-RECORD-TYPE
 16417        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16418
 16419* EXEC CICS REWRITE
 16420*            DATASET    (FILE-ID-ERPNDB)
 16421*            FROM       (PENDING-BUSINESS)
 16422*       END-EXEC
 16423     MOVE LENGTH OF
 16424      PENDING-BUSINESS
 16425       TO DFHEIV11
 16426*    MOVE '&& L                  %   #00014411' TO DFHEIV0
 16427     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16428     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16429     MOVE X'2020233030303134343131' TO DFHEIV0(25:11)
 16430     CALL 'kxdfhei1' USING DFHEIV0,
 16431           FILE-ID-ERPNDB,
 16432           PENDING-BUSINESS,
 16433           DFHEIV11,
 16434           DFHEIV99
 16435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16436        PERFORM 8400-LOG-JOURNAL-RECORD.
 16437
 16438******************************************************************
 16439*                                                                *
 16440*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16441*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16442*                                                                *
 16443******************************************************************
 16444
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 298
* EL6311.cbl
 16445     IF NOT PI-AR-PROCESSING
 16446        GO TO 2480-DELETE-FINISHED.
 16447
 16448     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16449        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16450        NEXT SENTENCE
 16451     ELSE
 16452        GO TO 2480-DELETE-FINISHED.
 16453
 16454
 16455* EXEC CICS HANDLE CONDITION
 16456*         NOTFND    (2480-DELETE-FINISHED)
 16457*    END-EXEC.
 16458*    MOVE '"$I                   ! < #00014433' TO DFHEIV0
 16459     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16460     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16461     MOVE X'3C20233030303134343333' TO DFHEIV0(25:11)
 16462     CALL 'kxdfhei1' USING DFHEIV0
 16463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16464
 16465
 16466     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16467     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16468
 16469
 16470* EXEC CICS READ
 16471*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16472*        DATASET (FILE-ID-ERRQST)
 16473*        RIDFLD  (ERRQST-KEY)
 16474*        UPDATE
 16475*    END-EXEC.
 16476*    MOVE '&"S        EU         (   #00014440' TO DFHEIV0
 16477     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16478     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16479     MOVE X'2020233030303134343430' TO DFHEIV0(25:11)
 16480     CALL 'kxdfhei1' USING DFHEIV0,
 16481           FILE-ID-ERRQST,
 16482           DFHEIV20,
 16483           DFHEIV99,
 16484           ERRQST-KEY,
 16485           DFHEIV99,
 16486           DFHEIV99,
 16487           DFHEIV99
 16488     SET ADDRESS OF AR-REQUEST-RECORD TO
 16489         DFHEIV20
 16490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16491
 16492
 16493     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16494
 16495     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16496
 16497     MOVE 'D'                      TO JP-RECORD-TYPE.
 16498     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16499
 16500
 16501* EXEC CICS DELETE
 16502*         DATASET    (FILE-ID-ERRQST)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 299
* EL6311.cbl
 16503*    END-EXEC.
 16504*    MOVE '&(                    &   #00014454' TO DFHEIV0
 16505     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16506     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16507     MOVE X'2020233030303134343534' TO DFHEIV0(25:11)
 16508     CALL 'kxdfhei1' USING DFHEIV0,
 16509           FILE-ID-ERRQST,
 16510           DFHEIV99,
 16511           DFHEIV99,
 16512           DFHEIV99,
 16513           DFHEIV99
 16514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16515
 16516
 16517     PERFORM 8400-LOG-JOURNAL-RECORD.
 16518
 16519 2480-DELETE-FINISHED.
 16520     MOVE ZEROS                  TO EMI-ERROR.
 16521     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16522     MOVE LOW-VALUES             TO EL631CI.
 16523     MOVE -1                     TO CMAINTL.
 16524     GO TO 8100-SEND-INITIAL-MAP.
 16525
 16526 2485-BATCH-HDR-NOT-FOUND.
 16527     MOVE -1                     TO CMAINTL
 16528     MOVE AL-UABON               TO CMAINTA.
 16529     MOVE ER-7450                TO EMI-ERROR.
 16530     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16531     GO TO 8200-SEND-DATAONLY.
 16532
 16533 2490-RECORD-NOT-FOUND.
 16534     MOVE -1                     TO CMAINTL
 16535     MOVE AL-UABON               TO CMAINTA.
 16536     MOVE ER-7451                TO EMI-ERROR.
 16537     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16538     GO TO 8200-SEND-DATAONLY.
 16539***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 16540***                                                            ***
 16541***     2500  B R O W S E   C H E C K S                        ***
 16542***  We perform this routine from 2 different places.          ***
 16543***  1. If the user changes the refund amount on a cancel, we  ***
 16544***    want to.........                                        ***
 16545***    a. determine if prior checks have been processed        ***
 16546***    b. If the amt is larger, display message instructing    ***
 16547***     them to create another check to make up the difference.***
 16548***    c. If the amt is less, do not allow the change and      ***
 16549***     display a FATAL error suggesting they deal with check  ***
 16550***     records befor continuing.                              ***
 16551***  2. If the user wants to delete a cancel record we......   ***
 16552***    a. browse through all the checks and if there is a      ***
 16553***     processed check, send FATAL message.                   ***
 16554***    b. If there is a non-released check, then delete that   ***
 16555***     check after you delete the pending cancel record.      ***
 16556***                                                            ***
 16557***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 16558
 16559 2500-browse-checks.
 16560
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 300
* EL6311.cbl
 16561     perform 2510-startbr-erchek thru 2510-exit
 16562
 16563     if not resp-normal
 16564        go to 2500-exit
 16565     end-if
 16566
 16567     perform until i-say-stop
 16568        perform 2520-readnext-erchek
 16569                                 thru 2520-exit
 16570        if (not resp-normal)
 16571           or (pb-control-by-account (1:33) not =
 16572              ch-control-primary (1:33))
 16573              set i-say-stop to true
 16574        else
 16575           if (ch-approval-status) = ' '
 16576              and (ch-void-dt = low-values)
 16577              and (ch-released-dt = low-values)
 16578              set i-have-checks to true
 16579           else
 16580              if ch-void-dt = low-values
 16581                 set i-have-processed-checks to true
 16582              end-if
 16583           end-if
 16584           if (ch-credit-accept-dt = low-values)
 16585              and (ch-void-dt = low-values)
 16586              and (ch-approval-status = ' ' OR 'P' OR 'A')
 16587              compute ws-check-amts = ws-check-amts +
 16588                 ch-amount-paid
 16589           end-if
 16590        end-if
 16591     end-perform
 16592
 16593     if ws-chek-browse-sw = 'Y'
 16594        perform 2525-endbr-erchek thru 2525-exit
 16595     end-if
 16596
 16597    .
 16598 2500-exit.
 16599     exit.
 16600
 16601 2510-startbr-erchek.
 16602
 16603     move pb-control-by-account  to erchek-key
 16604     move +0                     to chek-record-seq
 16605
 16606
 16607* exec cics startbr
 16608*       dataset   ('ERCHEK')
 16609*       ridfld    (erchek-key)
 16610*       gteq
 16611*       resp      (ws-response)
 16612*    end-exec
 16613     MOVE 'ERCHEK' TO DFHEIV1
 16614     MOVE 0
 16615       TO DFHEIV11
 16616*    MOVE '&,         G          &  N#00014547' TO DFHEIV0
 16617     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16618     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 301
* EL6311.cbl
 16619     MOVE X'204E233030303134353437' TO DFHEIV0(25:11)
 16620     CALL 'kxdfhei1' USING DFHEIV0,
 16621           DFHEIV1,
 16622           erchek-key,
 16623           DFHEIV99,
 16624           DFHEIV11,
 16625           DFHEIV99
 16626     MOVE EIBRESP  TO ws-response
 16627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16628
 16629     IF RESP-NORMAL
 16630        move 'Y'                 to ws-chek-browse-sw
 16631     end-if
 16632
 16633     .
 16634 2510-exit.
 16635     exit.
 16636
 16637 2520-readnext-erchek.
 16638
 16639
 16640* EXEC CICS READNEXT
 16641*       SET     (ADDRESS OF CHECK-RECORDS)
 16642*       DATASET ('ERCHEK')
 16643*       RIDFLD  (ERCHEK-KEY)
 16644*       RESP    (WS-RESPONSE)
 16645*    END-EXEC
 16646     MOVE 'ERCHEK' TO DFHEIV1
 16647     MOVE 0
 16648       TO DFHEIV11
 16649*    MOVE '&.S                   )  N#00014564' TO DFHEIV0
 16650     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16651     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16652     MOVE X'204E233030303134353634' TO DFHEIV0(25:11)
 16653     CALL 'kxdfhei1' USING DFHEIV0,
 16654           DFHEIV1,
 16655           DFHEIV20,
 16656           DFHEIV99,
 16657           ERCHEK-KEY,
 16658           DFHEIV99,
 16659           DFHEIV11,
 16660           DFHEIV99,
 16661           DFHEIV99
 16662     SET ADDRESS OF CHECK-RECORDS TO
 16663         DFHEIV20
 16664     MOVE EIBRESP  TO WS-RESPONSE
 16665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16666
 16667     .
 16668 2520-exit.
 16669     exit.
 16670
 16671 2525-endbr-erchek.
 16672
 16673
 16674* exec cics endbr
 16675*       dataset  ('ERCHEK')
 16676*    end-exec
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 302
* EL6311.cbl
 16677     MOVE 'ERCHEK' TO DFHEIV1
 16678     MOVE 0
 16679       TO DFHEIV11
 16680*    MOVE '&2                    $   #00014577' TO DFHEIV0
 16681     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16682     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16683     MOVE X'2020233030303134353737' TO DFHEIV0(25:11)
 16684     CALL 'kxdfhei1' USING DFHEIV0,
 16685           DFHEIV1,
 16686           DFHEIV11,
 16687           DFHEIV99
 16688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16689
 16690     .
 16691 2525-exit.
 16692     exit.
 16693
 16694 2530-readupd-erchek.
 16695
 16696
 16697* EXEC CICS READ
 16698*       UPDATE
 16699*       SET     (ADDRESS OF CHECK-RECORDS)
 16700*       DATASET ('ERCHEK')
 16701*       RIDFLD  (ERCHEK-KEY)
 16702*       RESP    (WS-RESPONSE)
 16703*    END-EXEC
 16704     MOVE 'ERCHEK' TO DFHEIV1
 16705*    MOVE '&"S        EU         (  N#00014587' TO DFHEIV0
 16706     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16707     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16708     MOVE X'204E233030303134353837' TO DFHEIV0(25:11)
 16709     CALL 'kxdfhei1' USING DFHEIV0,
 16710           DFHEIV1,
 16711           DFHEIV20,
 16712           DFHEIV99,
 16713           ERCHEK-KEY,
 16714           DFHEIV99,
 16715           DFHEIV99,
 16716           DFHEIV99
 16717     SET ADDRESS OF CHECK-RECORDS TO
 16718         DFHEIV20
 16719     MOVE EIBRESP  TO WS-RESPONSE
 16720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16721
 16722     .
 16723 2530-exit.
 16724     exit.
 16725
 16726 2540-delete-erchek.
 16727
 16728
 16729* EXEC CICS DELETE
 16730*       DATASET ('ERCHEK')
 16731*       RESP    (WS-RESPONSE)
 16732*    END-EXEC
 16733     MOVE 'ERCHEK' TO DFHEIV1
 16734*    MOVE '&(                    &  N#00014601' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 303
* EL6311.cbl
 16735     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16736     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16737     MOVE X'204E233030303134363031' TO DFHEIV0(25:11)
 16738     CALL 'kxdfhei1' USING DFHEIV0,
 16739           DFHEIV1,
 16740           DFHEIV99,
 16741           DFHEIV99,
 16742           DFHEIV99,
 16743           DFHEIV99
 16744     MOVE EIBRESP  TO WS-RESPONSE
 16745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16746
 16747     .
 16748 2540-exit.
 16749     exit.
 16750***************************************************************
 16751*                                                             *
 16752*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16753*                                                             *
 16754***************************************************************
 16755
 16756***************************************************************
 16757*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16758*     AN ALREADY BILLED RECORD.                               *
 16759***************************************************************
 16760
 16761 2700-BUILD-CORRECTION-RECORD.
 16762     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16763     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16764     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16765     MOVE '5'                    TO DC-OPTION-CODE.
 16766     PERFORM 9700-DATE-LINK.
 16767     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16768
 16769     IF PB-CHG-COUNT = ZEROS
 16770        MOVE +1                  TO WS-SEQ-SAVE
 16771     ELSE
 16772        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16773
 16774     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16775     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16776
 16777     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16778
 16779     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16780     MOVE 'A'                    TO JP-RECORD-TYPE.
 16781     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16782
 16783
 16784* EXEC CICS WRITE
 16785*        DATASET    (FILE-ID-ERPNDB)
 16786*        FROM       (PENDING-BUSINESS)
 16787*        RIDFLD     (PB-CONTROL-PRIMARY)
 16788*    END-EXEC.
 16789     MOVE LENGTH OF
 16790      PENDING-BUSINESS
 16791       TO DFHEIV11
 16792*    MOVE '&$ L                  ''   #00014642' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 304
* EL6311.cbl
 16793     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16794     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16795     MOVE X'2020233030303134363432' TO DFHEIV0(25:11)
 16796     CALL 'kxdfhei1' USING DFHEIV0,
 16797           FILE-ID-ERPNDB,
 16798           PENDING-BUSINESS,
 16799           DFHEIV11,
 16800           PB-CONTROL-PRIMARY,
 16801           DFHEIV99,
 16802           DFHEIV99
 16803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16804
 16805
 16806     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16807
 16808     PERFORM 8400-LOG-JOURNAL-RECORD.
 16809
 16810 2799-EXIT.
 16811      EXIT.
 16812
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 305
* EL6311.cbl
 16814
 16815******************************************************************
 16816*                                                                *
 16817*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 16818*                                                                *
 16819******************************************************************
 16820
 16821 2800-REWRITE-ISSUE-CERT-KEY.
 16822     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16823
 16824     IF  BCERTNOL GREATER THAN ZEROS
 16825         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 16826
 16827     IF  BSUFIXL  GREATER THAN ZEROS
 16828         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 16829
 16830     IF  BEFFDTL  GREATER THAN ZEROS
 16831         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16832
 16833 2810-READ-BY-ACCOUNT.
 16834
 16835* EXEC CICS HANDLE CONDITION
 16836*         NOTFND    (2820-PROCESS-REWRITE)
 16837*    END-EXEC.
 16838*    MOVE '"$I                   ! = #00014676' TO DFHEIV0
 16839     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16840     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16841     MOVE X'3D20233030303134363736' TO DFHEIV0(25:11)
 16842     CALL 'kxdfhei1' USING DFHEIV0
 16843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16844
 16845
 16846
 16847* EXEC CICS READ
 16848*        SET     (ADDRESS OF PENDING-BUSINESS)
 16849*        DATASET (FILE-ID-ERPNDB2)
 16850*        RIDFLD  (ERPNDB-ALT-KEY)
 16851*    END-EXEC.
 16852*    MOVE '&"S        E          (   #00014680' TO DFHEIV0
 16853     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16854     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16855     MOVE X'2020233030303134363830' TO DFHEIV0(25:11)
 16856     CALL 'kxdfhei1' USING DFHEIV0,
 16857           FILE-ID-ERPNDB2,
 16858           DFHEIV20,
 16859           DFHEIV99,
 16860           ERPNDB-ALT-KEY,
 16861           DFHEIV99,
 16862           DFHEIV99,
 16863           DFHEIV99
 16864     SET ADDRESS OF PENDING-BUSINESS TO
 16865         DFHEIV20
 16866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16867
 16868
 16869     GO TO 2890-DUPLICATE-RECORD.
 16870
 16871  2820-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 306
* EL6311.cbl
 16872
 16873* EXEC CICS HANDLE CONDITION
 16874*         NOTFND    (2885-RECORD-MISSING)
 16875*    END-EXEC.
 16876*    MOVE '"$I                   ! > #00014689' TO DFHEIV0
 16877     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16878     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16879     MOVE X'3E20233030303134363839' TO DFHEIV0(25:11)
 16880     CALL 'kxdfhei1' USING DFHEIV0
 16881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16882
 16883
 16884     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16885
 16886
 16887* EXEC CICS READ
 16888*        SET     (ADDRESS OF PENDING-BUSINESS)
 16889*        DATASET (FILE-ID-ERPNDB)
 16890*        RIDFLD  (ERPNDB-KEY)
 16891*        UPDATE
 16892*    END-EXEC.
 16893*    MOVE '&"S        EU         (   #00014695' TO DFHEIV0
 16894     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16895     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16896     MOVE X'2020233030303134363935' TO DFHEIV0(25:11)
 16897     CALL 'kxdfhei1' USING DFHEIV0,
 16898           FILE-ID-ERPNDB,
 16899           DFHEIV20,
 16900           DFHEIV99,
 16901           ERPNDB-KEY,
 16902           DFHEIV99,
 16903           DFHEIV99,
 16904           DFHEIV99
 16905     SET ADDRESS OF PENDING-BUSINESS TO
 16906         DFHEIV20
 16907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16908
 16909
 16910     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16911     MOVE 'D'                    TO JP-RECORD-TYPE.
 16912     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16913     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16914
 16915     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16916
 16917     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16918     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16919     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16920
 16921
 16922* EXEC CICS DELETE
 16923*        DATASET    (FILE-ID-ERPNDB)
 16924*    END-EXEC.
 16925*    MOVE '&(                    &   #00014713' TO DFHEIV0
 16926     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16927     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16928     MOVE X'2020233030303134373133' TO DFHEIV0(25:11)
 16929     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 307
* EL6311.cbl
 16930           FILE-ID-ERPNDB,
 16931           DFHEIV99,
 16932           DFHEIV99,
 16933           DFHEIV99,
 16934           DFHEIV99
 16935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16936
 16937
 16938     PERFORM 8400-LOG-JOURNAL-RECORD.
 16939
 16940
 16941* EXEC CICS GETMAIN
 16942*        SET      (ADDRESS OF PENDING-BUSINESS)
 16943*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16944*        INITIMG  (GETMAIN-SPACE)
 16945*    END-EXEC.
 16946*    MOVE ',"IL                  $   #00014719' TO DFHEIV0
 16947     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16948     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16949     MOVE X'2020233030303134373139' TO DFHEIV0(25:11)
 16950     CALL 'kxdfhei1' USING DFHEIV0,
 16951           DFHEIV20,
 16952           ERPNDB-RECORD-LENGTH,
 16953           GETMAIN-SPACE
 16954     SET ADDRESS OF PENDING-BUSINESS TO
 16955         DFHEIV20
 16956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16957
 16958
 16959     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16960
 16961
 16962* EXEC CICS HANDLE CONDITION
 16963*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 16964*    END-EXEC.
 16965*    MOVE '"$I                   ! ? #00014727' TO DFHEIV0
 16966     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16967     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16968     MOVE X'3F20233030303134373237' TO DFHEIV0(25:11)
 16969     CALL 'kxdfhei1' USING DFHEIV0
 16970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16971
 16972
 16973
 16974* EXEC CICS READ
 16975*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16976*        DATASET (FILE-ID-ELCERT)
 16977*        RIDFLD  (ELCERT-KEY)
 16978*        UPDATE
 16979*    END-EXEC.
 16980*    MOVE '&"S        EU         (   #00014731' TO DFHEIV0
 16981     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16982     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16983     MOVE X'2020233030303134373331' TO DFHEIV0(25:11)
 16984     CALL 'kxdfhei1' USING DFHEIV0,
 16985           FILE-ID-ELCERT,
 16986           DFHEIV20,
 16987           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 308
* EL6311.cbl
 16988           ELCERT-KEY,
 16989           DFHEIV99,
 16990           DFHEIV99,
 16991           DFHEIV99
 16992     SET ADDRESS OF CERTIFICATE-MASTER TO
 16993         DFHEIV20
 16994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16995
 16996
 16997     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 16998     MOVE 'B'                    TO JP-RECORD-TYPE
 16999     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17000     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17001
 17002     IF INSURED-ADDR-PRESENT
 17003        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 17004
 17005     IF CERT-NOTES-ARE-NOT-PRESENT
 17006        MOVE SPACE               TO WS-CERT-NOTE-SW
 17007     ELSE
 17008        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 17009
 17010     IF CERT-ADDED-BATCH      OR
 17011        CERT-AND-CLAIM-ONLINE OR
 17012        CERT-WAS-CREATED-FOR-CLAIM
 17013        NEXT SENTENCE
 17014     ELSE
 17015        GO TO 2825-DELETE-CERTIFICATE.
 17016
 17017     PERFORM 8400-LOG-JOURNAL-RECORD.
 17018
 17019*********************************************************
 17020** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 17021     IF CERT-ADDED-BATCH
 17022         GO TO 2822-REWRITE-ELCERT.
 17023*********************************************************
 17024
 17025     IF NO-CLAIM-ATTACHED
 17026        NEXT SENTENCE
 17027     ELSE
 17028        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 17029        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 17030
 17031 2822-REWRITE-ELCERT.
 17032     MOVE 'C'                    TO JP-RECORD-TYPE
 17033     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17034
 17035     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17036
 17037
 17038* EXEC CICS REWRITE
 17039*         DATASET    (FILE-ID-ELCERT)
 17040*         FROM       (CERTIFICATE-MASTER)
 17041*    END-EXEC.
 17042     MOVE LENGTH OF
 17043      CERTIFICATE-MASTER
 17044       TO DFHEIV11
 17045*    MOVE '&& L                  %   #00014778' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 309
* EL6311.cbl
 17046     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17047     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17048     MOVE X'2020233030303134373738' TO DFHEIV0(25:11)
 17049     CALL 'kxdfhei1' USING DFHEIV0,
 17050           FILE-ID-ELCERT,
 17051           CERTIFICATE-MASTER,
 17052           DFHEIV11,
 17053           DFHEIV99
 17054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17055
 17056
 17057     PERFORM 8400-LOG-JOURNAL-RECORD.
 17058
 17059     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17060
 17061 2825-DELETE-CERTIFICATE.
 17062     MOVE 'D'                      TO JP-RECORD-TYPE.
 17063     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17064
 17065     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17066
 17067
 17068* EXEC CICS DELETE
 17069*         DATASET    (FILE-ID-ELCERT)
 17070*    END-EXEC.
 17071*    MOVE '&(                    &   #00014793' TO DFHEIV0
 17072     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17073     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17074     MOVE X'2020233030303134373933' TO DFHEIV0(25:11)
 17075     CALL 'kxdfhei1' USING DFHEIV0,
 17076           FILE-ID-ELCERT,
 17077           DFHEIV99,
 17078           DFHEIV99,
 17079           DFHEIV99,
 17080           DFHEIV99
 17081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17082
 17083
 17084     PERFORM 8400-LOG-JOURNAL-RECORD.
 17085
 17086******************************************************************
 17087*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17088******************************************************************
 17089
 17090     IF CERT-NOTES-ARE-PRESENT
 17091        NEXT SENTENCE
 17092     ELSE
 17093        GO TO 2827-DELETE-MAILING.
 17094
 17095
 17096* EXEC CICS HANDLE CONDITION
 17097*         NOTFND  (2827-DELETE-MAILING)
 17098*    END-EXEC.
 17099*    MOVE '"$I                   ! @ #00014808' TO DFHEIV0
 17100     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17101     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17102     MOVE X'4020233030303134383038' TO DFHEIV0(25:11)
 17103     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 310
* EL6311.cbl
 17104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17105
 17106
 17107
 17108* EXEC CICS READ
 17109*        EQUAL
 17110*        DATASET   (FILE-ID-ERNOTE)
 17111*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17112*        RIDFLD    (ELCERT-KEY)
 17113*        UPDATE
 17114*    END-EXEC.
 17115*    MOVE '&"S        EU         (   #00014812' TO DFHEIV0
 17116     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17117     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17118     MOVE X'2020233030303134383132' TO DFHEIV0(25:11)
 17119     CALL 'kxdfhei1' USING DFHEIV0,
 17120           FILE-ID-ERNOTE,
 17121           DFHEIV20,
 17122           DFHEIV99,
 17123           ELCERT-KEY,
 17124           DFHEIV99,
 17125           DFHEIV99,
 17126           DFHEIV99
 17127     SET ADDRESS OF CERTIFICATE-NOTE TO
 17128         DFHEIV20
 17129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17130
 17131
 17132     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17133     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17134     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17135
 17136     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17137
 17138
 17139* EXEC CICS DELETE
 17140*        DATASET   (FILE-ID-ERNOTE)
 17141*    END-EXEC.
 17142*    MOVE '&(                    &   #00014826' TO DFHEIV0
 17143     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17144     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17145     MOVE X'2020233030303134383236' TO DFHEIV0(25:11)
 17146     CALL 'kxdfhei1' USING DFHEIV0,
 17147           FILE-ID-ERNOTE,
 17148           DFHEIV99,
 17149           DFHEIV99,
 17150           DFHEIV99,
 17151           DFHEIV99
 17152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17153
 17154
 17155     PERFORM 8400-LOG-JOURNAL-RECORD.
 17156
 17157******************************************************************
 17158*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17159******************************************************************
 17160
 17161 2827-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 311
* EL6311.cbl
 17162     IF CERT-ADDRESS-PRESENT
 17163        NEXT SENTENCE
 17164     ELSE
 17165        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17166
 17167
 17168* EXEC CICS HANDLE CONDITION
 17169*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17170*    END-EXEC.
 17171*    MOVE '"$I                   ! A #00014842' TO DFHEIV0
 17172     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17173     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17174     MOVE X'4120233030303134383432' TO DFHEIV0(25:11)
 17175     CALL 'kxdfhei1' USING DFHEIV0
 17176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17177
 17178
 17179     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17180
 17181
 17182* EXEC CICS READ
 17183*        EQUAL
 17184*        DATASET   (FILE-ID-ERMAIL)
 17185*        SET       (ADDRESS OF MAILING-DATA)
 17186*        RIDFLD    (ERMAIL-KEY)
 17187*        UPDATE
 17188*    END-EXEC.
 17189*    MOVE '&"S        EU         (   #00014848' TO DFHEIV0
 17190     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17191     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17192     MOVE X'2020233030303134383438' TO DFHEIV0(25:11)
 17193     CALL 'kxdfhei1' USING DFHEIV0,
 17194           FILE-ID-ERMAIL,
 17195           DFHEIV20,
 17196           DFHEIV99,
 17197           ERMAIL-KEY,
 17198           DFHEIV99,
 17199           DFHEIV99,
 17200           DFHEIV99
 17201     SET ADDRESS OF MAILING-DATA TO
 17202         DFHEIV20
 17203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17204
 17205
 17206     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17207     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17208     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17209
 17210     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17211
 17212
 17213* EXEC CICS DELETE
 17214*        DATASET   (FILE-ID-ERMAIL)
 17215*    END-EXEC.
 17216*    MOVE '&(                    &   #00014862' TO DFHEIV0
 17217     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17218     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17219     MOVE X'2020233030303134383632' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 312
* EL6311.cbl
 17220     CALL 'kxdfhei1' USING DFHEIV0,
 17221           FILE-ID-ERMAIL,
 17222           DFHEIV99,
 17223           DFHEIV99,
 17224           DFHEIV99,
 17225           DFHEIV99
 17226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17227
 17228
 17229     PERFORM 8400-LOG-JOURNAL-RECORD.
 17230
 17231 2830-BUILD-NEW-ISSUE-RECORD.
 17232     MOVE SPACES                 TO ELCERT-KEY.
 17233
 17234     IF  BCERTNOL GREATER THAN ZEROS
 17235         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17236
 17237     IF  BSUFIXL  GREATER THAN ZEROS
 17238         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17239
 17240     IF BEFFDTL GREATER THAN ZEROS
 17241        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17242
 17243 2870-WRITE-PENDING-BUSINESS.
 17244     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17245     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17246     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17247     MOVE '5'                    TO DC-OPTION-CODE.
 17248     PERFORM 9700-DATE-LINK.
 17249     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17250
 17251     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17252
 17253     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17254     MOVE 'A'                    TO JP-RECORD-TYPE.
 17255     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17256
 17257
 17258* EXEC CICS WRITE
 17259*        DATASET  (FILE-ID-ERPNDB)
 17260*        FROM     (PENDING-BUSINESS)
 17261*        RIDFLD   (PB-CONTROL-PRIMARY)
 17262*    END-EXEC.
 17263     MOVE LENGTH OF
 17264      PENDING-BUSINESS
 17265       TO DFHEIV11
 17266*    MOVE '&$ L                  ''   #00014894' TO DFHEIV0
 17267     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17268     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17269     MOVE X'2020233030303134383934' TO DFHEIV0(25:11)
 17270     CALL 'kxdfhei1' USING DFHEIV0,
 17271           FILE-ID-ERPNDB,
 17272           PENDING-BUSINESS,
 17273           DFHEIV11,
 17274           PB-CONTROL-PRIMARY,
 17275           DFHEIV99,
 17276           DFHEIV99
 17277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 313
* EL6311.cbl
 17278
 17279
 17280     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17281
 17282     PERFORM 8400-LOG-JOURNAL-RECORD.
 17283
 17284     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17285
 17286 2885-RECORD-MISSING.
 17287     MOVE -1                     TO BMAINTL
 17288     MOVE AL-UABON               TO BMAINTA
 17289     MOVE ER-2902                TO EMI-ERROR.
 17290     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17291     GO TO 8200-SEND-DATAONLY.
 17292
 17293 2890-DUPLICATE-RECORD.
 17294     MOVE -1                     TO BMAINTL.
 17295     MOVE AL-UABON               TO BCERTNOA.
 17296     MOVE AL-UNBON               TO BEFFDTA.
 17297     MOVE SPACE                  TO BMAINTI.
 17298
 17299     MOVE 1                      TO EMI-SUB
 17300                                    EMI-SWITCH1
 17301                                    EMI-SWITCH-AREA-1
 17302                                    EMI-SWITCH-AREA-2.
 17303
 17304     MOVE SPACES                 TO EMI-ERROR-LINES.
 17305
 17306
 17307* EXEC CICS SYNCPOINT ROLLBACK
 17308*    END-EXEC.
 17309*    MOVE '6"R                   !   #00014926' TO DFHEIV0
 17310     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17311     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17312     MOVE X'2020233030303134393236' TO DFHEIV0(25:11)
 17313     CALL 'kxdfhei1' USING DFHEIV0
 17314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17315
 17316
 17317     MOVE ER-2247                TO EMI-ERROR.
 17318     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17319     GO TO 8200-SEND-DATAONLY.
 17320
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 314
* EL6311.cbl
 17322
 17323******************************************************************
 17324*                                                                *
 17325*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17326*                                                                *
 17327******************************************************************
 17328
 17329 2900-REWRITE-CAN-CERT-KEY.
 17330     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17331
 17332     IF  CCERTNOL GREATER THAN ZEROS
 17333         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17334
 17335     IF  CSUFIXL  GREATER THAN ZEROS
 17336         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17337
 17338     IF  CEFFDTL  GREATER THAN ZEROS
 17339         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17340
 17341 2910-READ-BY-ACCOUNT.
 17342
 17343* EXEC CICS HANDLE CONDITION
 17344*         NOTFND    (2920-PROCESS-REWRITE)
 17345*    END-EXEC.
 17346*    MOVE '"$I                   ! B #00014954' TO DFHEIV0
 17347     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17348     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17349     MOVE X'4220233030303134393534' TO DFHEIV0(25:11)
 17350     CALL 'kxdfhei1' USING DFHEIV0
 17351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17352
 17353
 17354
 17355* EXEC CICS READ
 17356*        SET     (ADDRESS OF PENDING-BUSINESS)
 17357*        DATASET (FILE-ID-ERPNDB2)
 17358*        RIDFLD  (ERPNDB-ALT-KEY)
 17359*    END-EXEC.
 17360*    MOVE '&"S        E          (   #00014958' TO DFHEIV0
 17361     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17362     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17363     MOVE X'2020233030303134393538' TO DFHEIV0(25:11)
 17364     CALL 'kxdfhei1' USING DFHEIV0,
 17365           FILE-ID-ERPNDB2,
 17366           DFHEIV20,
 17367           DFHEIV99,
 17368           ERPNDB-ALT-KEY,
 17369           DFHEIV99,
 17370           DFHEIV99,
 17371           DFHEIV99
 17372     SET ADDRESS OF PENDING-BUSINESS TO
 17373         DFHEIV20
 17374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17375
 17376
 17377     GO TO 2990-DUPLICATE-RECORD.
 17378
 17379  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 315
* EL6311.cbl
 17380
 17381* EXEC CICS HANDLE CONDITION
 17382*         NOTFND    (2985-RECORD-MISSING)
 17383*    END-EXEC.
 17384*    MOVE '"$I                   ! C #00014967' TO DFHEIV0
 17385     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17386     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17387     MOVE X'4320233030303134393637' TO DFHEIV0(25:11)
 17388     CALL 'kxdfhei1' USING DFHEIV0
 17389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17390
 17391
 17392     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17393
 17394
 17395* EXEC CICS READ
 17396*        SET     (ADDRESS OF PENDING-BUSINESS)
 17397*        DATASET (FILE-ID-ERPNDB)
 17398*        RIDFLD  (ERPNDB-KEY)
 17399*        UPDATE
 17400*    END-EXEC.
 17401*    MOVE '&"S        EU         (   #00014973' TO DFHEIV0
 17402     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17403     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17404     MOVE X'2020233030303134393733' TO DFHEIV0(25:11)
 17405     CALL 'kxdfhei1' USING DFHEIV0,
 17406           FILE-ID-ERPNDB,
 17407           DFHEIV20,
 17408           DFHEIV99,
 17409           ERPNDB-KEY,
 17410           DFHEIV99,
 17411           DFHEIV99,
 17412           DFHEIV99
 17413     SET ADDRESS OF PENDING-BUSINESS TO
 17414         DFHEIV20
 17415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17416
 17417
 17418     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17419     MOVE 'D'                    TO JP-RECORD-TYPE.
 17420     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17421     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17422
 17423     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17424
 17425     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17426     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17427     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17428
 17429
 17430* EXEC CICS DELETE
 17431*        DATASET    (FILE-ID-ERPNDB)
 17432*    END-EXEC.
 17433*    MOVE '&(                    &   #00014991' TO DFHEIV0
 17434     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17435     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17436     MOVE X'2020233030303134393931' TO DFHEIV0(25:11)
 17437     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 316
* EL6311.cbl
 17438           FILE-ID-ERPNDB,
 17439           DFHEIV99,
 17440           DFHEIV99,
 17441           DFHEIV99,
 17442           DFHEIV99
 17443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17444
 17445
 17446     PERFORM 8400-LOG-JOURNAL-RECORD.
 17447
 17448
 17449* EXEC CICS GETMAIN
 17450*        SET      (ADDRESS OF PENDING-BUSINESS)
 17451*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17452*        INITIMG  (GETMAIN-SPACE)
 17453*    END-EXEC.
 17454*    MOVE ',"IL                  $   #00014997' TO DFHEIV0
 17455     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17456     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17457     MOVE X'2020233030303134393937' TO DFHEIV0(25:11)
 17458     CALL 'kxdfhei1' USING DFHEIV0,
 17459           DFHEIV20,
 17460           ERPNDB-RECORD-LENGTH,
 17461           GETMAIN-SPACE
 17462     SET ADDRESS OF PENDING-BUSINESS TO
 17463         DFHEIV20
 17464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17465
 17466
 17467     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17468
 17469 2950-PROCESS-CANCELS.
 17470
 17471
 17472* EXEC CICS HANDLE CONDITION
 17473*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17474*    END-EXEC.
 17475*    MOVE '"$I                   ! D #00015007' TO DFHEIV0
 17476     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17477     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17478     MOVE X'4420233030303135303037' TO DFHEIV0(25:11)
 17479     CALL 'kxdfhei1' USING DFHEIV0
 17480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17481
 17482
 17483
 17484* EXEC CICS READ
 17485*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17486*        DATASET (FILE-ID-ELCERT)
 17487*        RIDFLD  (ELCERT-KEY)
 17488*        UPDATE
 17489*    END-EXEC.
 17490*    MOVE '&"S        EU         (   #00015011' TO DFHEIV0
 17491     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17492     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17493     MOVE X'2020233030303135303131' TO DFHEIV0(25:11)
 17494     CALL 'kxdfhei1' USING DFHEIV0,
 17495           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 317
* EL6311.cbl
 17496           DFHEIV20,
 17497           DFHEIV99,
 17498           ELCERT-KEY,
 17499           DFHEIV99,
 17500           DFHEIV99,
 17501           DFHEIV99
 17502     SET ADDRESS OF CERTIFICATE-MASTER TO
 17503         DFHEIV20
 17504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17505
 17506
 17507     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17508
 17509     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17510     MOVE 'B'                      TO JP-RECORD-TYPE.
 17511     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17512     PERFORM 8400-LOG-JOURNAL-RECORD.
 17513
 17514     IF PB-CI-LIVES NOT NUMERIC
 17515         MOVE ZERO                    TO PB-CI-LIVES.
 17516
 17517     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17518        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17519        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17520        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17521                                         CM-LF-CANCEL-DT
 17522     ELSE
 17523        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17524        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17525        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17526        MOVE PB-CI-LIVES              TO CM-LIVES.
 17527
 17528     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17529        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17530            MOVE CM-LF-STATUS-AT-CANCEL
 17531                                     TO CM-LF-CURRENT-STATUS
 17532            MOVE SPACE
 17533                                     TO CM-LF-STATUS-AT-CANCEL
 17534        ELSE
 17535            MOVE PB-CI-LF-POLICY-STATUS
 17536                                     TO CM-LF-CURRENT-STATUS
 17537     ELSE
 17538        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17539
 17540     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17541        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17542        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17543        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17544                                         CM-AH-CANCEL-DT
 17545     ELSE
 17546        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17547        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17548        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17549        MOVE PB-CI-LIVES              TO CM-LIVES.
 17550
 17551     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17552        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17553            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 318
* EL6311.cbl
 17554                                     TO CM-AH-CURRENT-STATUS
 17555            MOVE SPACE
 17556                                     TO CM-AH-STATUS-AT-CANCEL
 17557        ELSE
 17558            MOVE PB-CI-AH-POLICY-STATUS
 17559                                     TO CM-AH-CURRENT-STATUS
 17560     ELSE
 17561        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17562
 17563 2975-REWRITE-CERT.
 17564     MOVE 'C'                      TO JP-RECORD-TYPE.
 17565     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17566
 17567
 17568* EXEC CICS REWRITE
 17569*        DATASET    (FILE-ID-ELCERT)
 17570*        FROM       (CERTIFICATE-MASTER)
 17571*    END-EXEC.
 17572     MOVE LENGTH OF
 17573      CERTIFICATE-MASTER
 17574       TO DFHEIV11
 17575*    MOVE '&& L                  %   #00015078' TO DFHEIV0
 17576     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17577     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17578     MOVE X'2020233030303135303738' TO DFHEIV0(25:11)
 17579     CALL 'kxdfhei1' USING DFHEIV0,
 17580           FILE-ID-ELCERT,
 17581           CERTIFICATE-MASTER,
 17582           DFHEIV11,
 17583           DFHEIV99
 17584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17585
 17586
 17587     PERFORM 8400-LOG-JOURNAL-RECORD.
 17588
 17589 2960-BUILD-NEW-CANCEL-RECORD.
 17590     IF  CCERTNOL GREATER THAN ZEROS
 17591         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17592
 17593     IF  CSUFIXL  GREATER THAN ZEROS
 17594         MOVE CSUFIXI             TO PB-CERT-SFX.
 17595
 17596     IF  CEFFDTL  GREATER  THAN ZEROS
 17597         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17598
 17599 2970-WRITE-PENDING-BUSINESS.
 17600     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17601     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17602     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17603     MOVE '5'                    TO DC-OPTION-CODE.
 17604     PERFORM 9700-DATE-LINK.
 17605     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17606
 17607     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17608
 17609     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17610                                    PB-CI-INSURED-SEX
 17611                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 319
* EL6311.cbl
 17612                                    PB-CI-AH-BENEFIT-CD
 17613                                    PB-CI-RATE-CLASS
 17614                                    PB-CI-RATE-DEV-LF
 17615                                    PB-CI-RATE-DEV-AH
 17616                                    PB-CI-LF-ABBR
 17617                                    PB-CI-AH-ABBR
 17618                                    PB-CI-OB-FLAG
 17619                                    PB-CI-LF-POLICY-STATUS
 17620                                    PB-CI-AH-POLICY-STATUS
 17621                                    PB-CI-INDV-GRP-CD
 17622                                    PB-CI-BENEFICIARY-NAME
 17623                                    PB-CI-NOTE-SW
 17624                                    PB-CI-SOC-SEC-NO
 17625                                    PB-CI-MEMBER-NO
 17626                                    PB-CI-INT-CODE
 17627                                    PB-CI-COMP-EXCP-SW
 17628                                    PB-CI-ENTRY-STATUS
 17629                                    PB-CI-CREDIT-INTERFACE-SW-1
 17630                                    PB-CI-CREDIT-INTERFACE-SW-2
 17631                                    PB-CI-ENTRY-BATCH.
 17632
 17633     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17634                                    PB-CI-AH-SETTLEMENT-DT
 17635                                    PB-CI-DEATH-DT
 17636                                    PB-CI-LF-PRIOR-CANCEL-DT
 17637                                    PB-CI-AH-PRIOR-CANCEL-DT
 17638                                    PB-CI-LOAN-1ST-PMT-DT
 17639                                    PB-CI-ENTRY-DT
 17640                                    PB-CI-LF-EXPIRE-DT
 17641                                    PB-CI-AH-EXPIRE-DT.
 17642
 17643     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17644                                    PB-CI-LF-TERM
 17645                                    PB-CI-LF-BENEFIT-AMT
 17646                                    PB-CI-LF-ALT-BENEFIT-AMT
 17647                                    PB-CI-LF-PREMIUM-AMT
 17648                                    PB-CI-LF-ALT-PREMIUM-AMT
 17649                                    PB-CI-AH-TERM
 17650                                    PB-CI-AH-BENEFIT-AMT
 17651                                    PB-CI-AH-PREMIUM-AMT
 17652                                    PB-CI-RATE-DEV-PCT-LF
 17653                                    PB-CI-RATE-DEV-PCT-AH
 17654                                    PB-CI-LIFE-COMMISSION
 17655                                    PB-CI-AH-COMMISSION
 17656                                    PB-CI-PAY-FREQUENCY
 17657                                    PB-CI-LOAN-APR
 17658                                    PB-CI-LOAN-TERM
 17659                                    PB-CI-CURR-SEQ
 17660                                    PB-CI-AH-CANCEL-AMT
 17661                                    PB-CI-LF-CANCEL-AMT
 17662                                    PB-CI-EXTENTION-DAYS
 17663                                    PB-CI-TERM-IN-DAYS
 17664                                    PB-CI-LOAN-OFFICER
 17665                                    PB-CI-LIVES
 17666                                    PB-CI-LF-CRIT-PER
 17667                                    PB-CI-AH-CRIT-PER
 17668                                    PB-C-LF-REM-TERM
 17669                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 320
* EL6311.cbl
 17670
 17671     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17672     MOVE 'A'                    TO JP-RECORD-TYPE.
 17673     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17674
 17675
 17676* EXEC CICS HANDLE CONDITION
 17677*        DUPREC   (2990-DUPLICATE-RECORD)
 17678*    END-EXEC.
 17679*    MOVE '"$%                   ! E #00015171' TO DFHEIV0
 17680     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17681     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17682     MOVE X'4520233030303135313731' TO DFHEIV0(25:11)
 17683     CALL 'kxdfhei1' USING DFHEIV0
 17684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17685
 17686
 17687
 17688* EXEC CICS WRITE
 17689*        DATASET  (FILE-ID-ERPNDB)
 17690*        FROM     (PENDING-BUSINESS)
 17691*        RIDFLD   (PB-CONTROL-PRIMARY)
 17692*    END-EXEC.
 17693     MOVE LENGTH OF
 17694      PENDING-BUSINESS
 17695       TO DFHEIV11
 17696*    MOVE '&$ L                  ''   #00015175' TO DFHEIV0
 17697     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17698     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17699     MOVE X'2020233030303135313735' TO DFHEIV0(25:11)
 17700     CALL 'kxdfhei1' USING DFHEIV0,
 17701           FILE-ID-ERPNDB,
 17702           PENDING-BUSINESS,
 17703           DFHEIV11,
 17704           PB-CONTROL-PRIMARY,
 17705           DFHEIV99,
 17706           DFHEIV99
 17707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17708
 17709
 17710     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17711
 17712     PERFORM 8400-LOG-JOURNAL-RECORD.
 17713
 17714     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17715
 17716 2985-RECORD-MISSING.
 17717     MOVE -1                     TO CMAINTL
 17718     MOVE AL-UABON               TO CMAINTA.
 17719
 17720     MOVE ER-2902                TO EMI-ERROR.
 17721     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17722     GO TO 8200-SEND-DATAONLY.
 17723
 17724 2990-DUPLICATE-RECORD.
 17725     MOVE SPACE                  TO CMAINTI.
 17726     MOVE -1                     TO CMAINTL.
 17727     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 321
* EL6311.cbl
 17728     MOVE AL-UNBON               TO CEFFDTA.
 17729
 17730     MOVE 1                      TO EMI-SUB
 17731                                    EMI-SWITCH1
 17732                                    EMI-SWITCH-AREA-1
 17733                                    EMI-SWITCH-AREA-2.
 17734     MOVE SPACES                 TO EMI-ERROR-LINES.
 17735
 17736
 17737* EXEC CICS SYNCPOINT ROLLBACK
 17738*    END-EXEC.
 17739*    MOVE '6"R                   !   #00015207' TO DFHEIV0
 17740     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17741     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17742     MOVE X'2020233030303135323037' TO DFHEIV0(25:11)
 17743     CALL 'kxdfhei1' USING DFHEIV0
 17744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17745
 17746
 17747     MOVE ER-2247                TO EMI-ERROR.
 17748     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17749     GO TO 8200-SEND-DATAONLY.
 17750
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 322
* EL6311.cbl
 17752
 17753***************************************************************
 17754*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17755*     PREMIUM FOR A SINGLE BATCH.                             *
 17756*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17757***************************************************************
 17758
 17759 3000-BATCH-MAINLINE.
 17760     IF PI-PREV-KEY NOT = SPACES
 17761         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17762     ELSE
 17763         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17764
 17765     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17766
 17767 3010-READNEXT.
 17768
 17769* EXEC CICS READ
 17770*         DATASET    (FILE-ID-ERPNDB)
 17771*         SET        (ADDRESS OF PENDING-BUSINESS)
 17772*         RIDFLD     (ERPNDB-KEY)
 17773*         GTEQ
 17774*    END-EXEC.
 17775*    MOVE '&"S        G          (   #00015231' TO DFHEIV0
 17776     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17777     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17778     MOVE X'2020233030303135323331' TO DFHEIV0(25:11)
 17779     CALL 'kxdfhei1' USING DFHEIV0,
 17780           FILE-ID-ERPNDB,
 17781           DFHEIV20,
 17782           DFHEIV99,
 17783           ERPNDB-KEY,
 17784           DFHEIV99,
 17785           DFHEIV99,
 17786           DFHEIV99
 17787     SET ADDRESS OF PENDING-BUSINESS TO
 17788         DFHEIV20
 17789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17790
 17791
 17792     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17793        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17794          GO TO 3030-END-BATCH.
 17795
 17796     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17797
 17798     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17799        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17800          GO TO 3020-BUMP-SEQ.
 17801
 17802     IF PB-ISSUE
 17803        ADD +1                   TO WS-ISS-TOTAL-CNT
 17804        IF PB-FATAL-ERRORS
 17805           ADD +1                      TO WS-ISS-FATAL-CNT
 17806           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17807           GO TO 3020-BUMP-SEQ
 17808        ELSE
 17809           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 323
* EL6311.cbl
 17810              ADD +1                      TO WS-ISS-FORCE-CNT
 17811              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17812              GO TO 3020-BUMP-SEQ
 17813           ELSE
 17814              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17815                 ADD +1                      TO WS-ISS-HOLD-CNT
 17816                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17817                 GO TO 3020-BUMP-SEQ
 17818              ELSE
 17819                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17820                     THRU  3299-EXIT
 17821                 GO TO 3020-BUMP-SEQ.
 17822
 17823     IF PB-CANCELLATION
 17824        ADD +1                   TO WS-CAN-TOTAL-CNT
 17825        IF PB-FATAL-ERRORS
 17826           ADD +1                 TO WS-CAN-FATAL-CNT
 17827           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17828           GO TO 3020-BUMP-SEQ
 17829        ELSE
 17830           IF PB-UNFORCED-ERRORS
 17831              ADD +1                 TO WS-CAN-FORCE-CNT
 17832              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17833              GO TO 3020-BUMP-SEQ
 17834           ELSE
 17835              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17836                 ADD +1                 TO WS-CAN-HOLD-CNT
 17837                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17838                 GO TO 3020-BUMP-SEQ
 17839              ELSE
 17840                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17841                     THRU  3499-EXIT
 17842                 GO TO 3020-BUMP-SEQ.
 17843
 17844     IF PB-BATCH-TRAILER
 17845         GO TO 3030-END-BATCH.
 17846
 17847 3020-BUMP-SEQ.
 17848     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17849     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17850     GO TO 3010-READNEXT.
 17851
 17852 3030-END-BATCH.
 17853     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17854     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17855     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17856     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17857
 17858     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17859                                          - WS-ISS-FORCE-CNT
 17860                                          - WS-ISS-HOLD-CNT).
 17861
 17862     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17863     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17864
 17865     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17866     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17867     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 324
* EL6311.cbl
 17868     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17869     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17870                                          - WS-CAN-FORCE-CNT
 17871                                          - WS-CAN-HOLD-CNT).
 17872     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 17873     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 17874
 17875     COMPUTE WS-NET-TOTAL-CNT
 17876         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 17877     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 17878     COMPUTE WS-NET-FATAL-CNT
 17879         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 17880     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 17881     COMPUTE WS-NET-FORCE-CNT
 17882         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 17883     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 17884     COMPUTE WS-NET-HOLD-CNT
 17885         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 17886     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 17887
 17888     COMPUTE WS-NET-AVAIL-CNT
 17889          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17890                              - WS-ISS-FORCE-CNT
 17891                              - WS-ISS-HOLD-CNT)
 17892          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17893                              - WS-CAN-FORCE-CNT
 17894                              - WS-CAN-HOLD-CNT).
 17895     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 17896
 17897     COMPUTE WS-NET-GOOD-PREM
 17898         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 17899     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 17900     COMPUTE WS-NET-BAD-PREM
 17901         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 17902     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 17903
 17904     MOVE 0000                   TO EMI-ERROR.
 17905     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17906     MOVE -1                     TO DPFENTRL.
 17907     GO TO 8200-SEND-DATAONLY.
 17908
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 325
* EL6311.cbl
 17910
 17911******************************************************************
 17912*                                                                *
 17913*           A D D    B A D   I S S U E   P R E M I U M           *
 17914*                                                                *
 17915******************************************************************
 17916
 17917 3100-ADD-BAD-ISSUE-PREM.
 17918     IF PB-OVERRIDE-LIFE
 17919       OR PB-OVERRIDE-BOTH
 17920           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 17921           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 17922       ELSE
 17923           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 17924           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 17925
 17926     IF PB-OVERRIDE-AH
 17927       OR PB-OVERRIDE-BOTH
 17928           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 17929       ELSE
 17930           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 17931
 17932 3199-EXIT.
 17933     EXIT.
 17934
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 326
* EL6311.cbl
 17936
 17937******************************************************************
 17938*                                                                *
 17939*       A D D   G O O D   I S S U E   P R E M I U M              *
 17940*                                                                *
 17941******************************************************************
 17942
 17943 3200-ADD-GOOD-ISSUE-PREM.
 17944     IF PB-OVERRIDE-LIFE
 17945       OR PB-OVERRIDE-BOTH
 17946           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 17947           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 17948       ELSE
 17949           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17950           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 17951
 17952     IF PB-OVERRIDE-AH
 17953       OR PB-OVERRIDE-BOTH
 17954           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17955       ELSE
 17956           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 17957
 17958 3299-EXIT.
 17959     EXIT.
 17960
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 327
* EL6311.cbl
 17962
 17963
 17964******************************************************************
 17965*                                                                *
 17966*        A D D   B A D   C A N C E L   P R E M I U M             *
 17967*                                                                *
 17968******************************************************************
 17969
 17970 3300-ADD-BAD-CANCEL-PREM.
 17971     IF PB-OVERRIDE-LIFE
 17972       OR PB-OVERRIDE-BOTH
 17973           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 17974       ELSE
 17975           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17976
 17977     IF PB-OVERRIDE-AH
 17978       OR PB-OVERRIDE-BOTH
 17979           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 17980       ELSE
 17981           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17982
 17983 3399-EXIT.
 17984     EXIT.
 17985
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 328
* EL6311.cbl
 17987
 17988******************************************************************
 17989*                                                                *
 17990*       A D D   G O O D   C A N C E L   P R E M I U M            *
 17991*                                                                *
 17992******************************************************************
 17993
 17994 3400-ADD-GOOD-CANCEL-PREM.
 17995     IF PB-OVERRIDE-LIFE
 17996       OR PB-OVERRIDE-BOTH
 17997           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 17998       ELSE
 17999           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18000
 18001     IF PB-OVERRIDE-AH
 18002       OR PB-OVERRIDE-BOTH
 18003           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 18004       ELSE
 18005           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18006
 18007 3499-EXIT.
 18008     EXIT.
 18009
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 329
* EL6311.cbl
 18011
 18012******************************************************************
 18013*                                                                *
 18014*           E D I T   B A T C H   D A T A                        *
 18015*                                                                *
 18016******************************************************************
 18017
 18018 3500-EDIT-BATCH-DATA.
 18019     IF PI-PREV-KEY NOT = SPACES
 18020        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18021     ELSE
 18022        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18023
 18024     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18025     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18026
 18027
 18028* EXEC CICS HANDLE CONDITION
 18029*         NOTFND      (3590-NOT-FOUND)
 18030*    END-EXEC.
 18031*    MOVE '"$I                   ! F #00015473' TO DFHEIV0
 18032     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18033     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18034     MOVE X'4620233030303135343733' TO DFHEIV0(25:11)
 18035     CALL 'kxdfhei1' USING DFHEIV0
 18036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18037
 18038
 18039     IF DRISSL   GREATER THAN ZEROS OR
 18040        DRISSL   GREATER THAN ZEROS OR
 18041        DRLFPRML GREATER THAN ZEROS OR
 18042        DRAHPRML GREATER THAN ZEROS OR
 18043        DRCANCL  GREATER THAN ZEROS OR
 18044        DRLFRFDL GREATER THAN ZEROS OR
 18045        DRAHRFDL GREATER THAN ZEROS
 18046              NEXT SENTENCE
 18047          ELSE
 18048              MOVE ER-3224    TO EMI-ERROR
 18049              MOVE -1         TO DPFENTRL
 18050              MOVE AL-UNBON   TO DPFENTRA
 18051              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18052              GO TO 8200-SEND-DATAONLY.
 18053
 18054     IF NOT MODIFY-CAP
 18055         MOVE 'UPDATE'       TO SM-READ
 18056         PERFORM 9995-SECURITY-VIOLATION
 18057         MOVE ER-0070        TO EMI-ERROR
 18058         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18059         GO TO 8100-SEND-INITIAL-MAP.
 18060
 18061        IF DRISSL GREATER THAN ZEROS
 18062           MOVE AL-UNNON         TO DRISSA
 18063           MOVE DRISSI           TO DEEDIT-FIELD
 18064           PERFORM 8600-DEEDIT
 18065           IF DEEDIT-FIELD-V0  NUMERIC
 18066              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18067           ELSE
 18068              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 330
* EL6311.cbl
 18069              MOVE -1         TO DRISSL
 18070              MOVE AL-UNBON   TO DRISSA
 18071              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18072
 18073        IF DRLFPRML GREATER THAN ZEROS
 18074           MOVE AL-UNNON         TO DRLFPRMA
 18075
 18076* EXEC CICS BIF DEEDIT
 18077*              FIELD  (DRLFPRMI)
 18078*              LENGTH (11)
 18079*          END-EXEC
 18080     MOVE 11
 18081       TO DFHEIV11
 18082*    MOVE '@"L                   #   #00015513' TO DFHEIV0
 18083     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18084     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18085     MOVE X'2020233030303135353133' TO DFHEIV0(25:11)
 18086     CALL 'kxdfhei1' USING DFHEIV0,
 18087           DRLFPRMI,
 18088           DFHEIV11
 18089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18090           IF DRLFPRMI NUMERIC
 18091              MOVE DRLFPRMI   TO WS-DRLFPRM
 18092*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18093*          PERFORM 8600-DEEDIT
 18094*          IF DEEDIT-FIELD-V2  NUMERIC
 18095*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18096           ELSE
 18097              MOVE ER-2223    TO EMI-ERROR
 18098              MOVE -1         TO DRLFPRML
 18099              MOVE AL-UNBON   TO DRLFPRMA
 18100              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18101
 18102        IF DRAHPRML GREATER THAN ZEROS
 18103           MOVE AL-UNNON         TO DRAHPRMA
 18104
 18105* EXEC CICS BIF DEEDIT
 18106*              FIELD  (DRAHPRMI)
 18107*              LENGTH (11)
 18108*          END-EXEC
 18109     MOVE 11
 18110       TO DFHEIV11
 18111*    MOVE '@"L                   #   #00015531' TO DFHEIV0
 18112     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18113     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18114     MOVE X'2020233030303135353331' TO DFHEIV0(25:11)
 18115     CALL 'kxdfhei1' USING DFHEIV0,
 18116           DRAHPRMI,
 18117           DFHEIV11
 18118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18119           IF DRAHPRMI NUMERIC
 18120              MOVE DRAHPRMI   TO WS-DRAHPRM
 18121*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18122*          PERFORM 8600-DEEDIT
 18123*          IF DEEDIT-FIELD-V2  NUMERIC
 18124*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18125           ELSE
 18126              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 331
* EL6311.cbl
 18127              MOVE -1         TO DRAHPRML
 18128              MOVE AL-UNBON   TO DRAHPRMA
 18129              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18130
 18131        IF DRCANCL GREATER THAN ZEROS
 18132           MOVE AL-UNNON         TO DRCANCA
 18133           MOVE DRCANCI          TO DEEDIT-FIELD
 18134           PERFORM 8600-DEEDIT
 18135           IF DEEDIT-FIELD-V0  NUMERIC
 18136              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18137           ELSE
 18138              MOVE ER-2223    TO EMI-ERROR
 18139              MOVE -1         TO DRCANCL
 18140              MOVE AL-UNBON   TO DRCANCL
 18141              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18142
 18143        IF DRLFRFDL GREATER THAN ZEROS
 18144           MOVE AL-UNNON         TO DRLFRFDA
 18145
 18146* EXEC CICS BIF DEEDIT
 18147*              FIELD  (DRLFRFDI)
 18148*              LENGTH (11)
 18149*          END-EXEC
 18150     MOVE 11
 18151       TO DFHEIV11
 18152*    MOVE '@"L                   #   #00015561' TO DFHEIV0
 18153     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18154     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18155     MOVE X'2020233030303135353631' TO DFHEIV0(25:11)
 18156     CALL 'kxdfhei1' USING DFHEIV0,
 18157           DRLFRFDI,
 18158           DFHEIV11
 18159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18160           IF DRLFRFDI NUMERIC
 18161              MOVE DRLFRFDI   TO WS-DRLFRFD
 18162*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18163*          PERFORM 8600-DEEDIT
 18164*          IF DEEDIT-FIELD-V2  NUMERIC
 18165*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18166           ELSE
 18167              MOVE ER-2223    TO EMI-ERROR
 18168              MOVE -1         TO DRLFRFDL
 18169              MOVE AL-UNBON   TO DRLFRFDA
 18170              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18171
 18172        IF DRAHRFDL GREATER THAN ZEROS
 18173           MOVE AL-UNNON         TO DRAHRFDA
 18174
 18175* EXEC CICS BIF DEEDIT
 18176*              FIELD  (DRAHRFDI)
 18177*              LENGTH (11)
 18178*          END-EXEC
 18179     MOVE 11
 18180       TO DFHEIV11
 18181*    MOVE '@"L                   #   #00015579' TO DFHEIV0
 18182     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18183     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18184     MOVE X'2020233030303135353739' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 332
* EL6311.cbl
 18185     CALL 'kxdfhei1' USING DFHEIV0,
 18186           DRAHRFDI,
 18187           DFHEIV11
 18188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18189           IF DRAHRFDI NUMERIC
 18190              MOVE DRAHRFDI   TO WS-DRAHRFD
 18191*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18192*          PERFORM 8600-DEEDIT
 18193*          IF DEEDIT-FIELD-V2  NUMERIC
 18194*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18195           ELSE
 18196              MOVE ER-2223    TO EMI-ERROR
 18197              MOVE -1         TO DRAHRFDL
 18198              MOVE AL-UNBON   TO DRAHRFDA
 18199              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18200
 18201     IF EMI-ERROR = ZEROS
 18202        GO 3600-UPDATE-BATCH-HEADER.
 18203
 18204     GO TO 8200-SEND-DATAONLY.
 18205
 18206 3590-NOT-FOUND.
 18207     MOVE ER-2192                TO EMI-ERROR.
 18208     MOVE -1                     TO DPFENTRL.
 18209     MOVE AL-UNBON               TO DPFENTRA.
 18210     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18211     GO TO 8200-SEND-DATAONLY.
 18212
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 333
* EL6311.cbl
 18214
 18215******************************************************************
 18216*                                                                *
 18217*           U P D A T E   B A T C H   H E A D E R                *
 18218*                                                                *
 18219******************************************************************
 18220
 18221 3600-UPDATE-BATCH-HEADER.
 18222
 18223* EXEC CICS HANDLE CONDITION
 18224*         NOTFND      (3690-NOT-FOUND)
 18225*    END-EXEC.
 18226*    MOVE '"$I                   ! G #00015616' TO DFHEIV0
 18227     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18228     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18229     MOVE X'4720233030303135363136' TO DFHEIV0(25:11)
 18230     CALL 'kxdfhei1' USING DFHEIV0
 18231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18232
 18233
 18234
 18235* EXEC CICS READ
 18236*        DATASET (FILE-ID-ERPNDB)
 18237*        RIDFLD  (ERPNDB-KEY)
 18238*        SET     (ADDRESS OF PENDING-BUSINESS)
 18239*        UPDATE
 18240*    END-EXEC.
 18241*    MOVE '&"S        EU         (   #00015620' TO DFHEIV0
 18242     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18243     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18244     MOVE X'2020233030303135363230' TO DFHEIV0(25:11)
 18245     CALL 'kxdfhei1' USING DFHEIV0,
 18246           FILE-ID-ERPNDB,
 18247           DFHEIV20,
 18248           DFHEIV99,
 18249           ERPNDB-KEY,
 18250           DFHEIV99,
 18251           DFHEIV99,
 18252           DFHEIV99
 18253     SET ADDRESS OF PENDING-BUSINESS TO
 18254         DFHEIV20
 18255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18256
 18257
 18258     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18259     MOVE 'B'                    TO JP-RECORD-TYPE.
 18260     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18261
 18262     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18263
 18264     PERFORM 8400-LOG-JOURNAL-RECORD.
 18265
 18266     IF DRISSL GREATER THAN ZEROS
 18267        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18268
 18269     IF DRCANCL GREATER THAN ZEROS
 18270        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18271
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 334
* EL6311.cbl
 18272
 18273     IF DRLFPRML GREATER THAN ZEROS
 18274        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18275
 18276     IF DRAHPRML GREATER THAN ZEROS
 18277        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18278
 18279     IF DRLFRFDL GREATER THAN ZEROS
 18280        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18281
 18282     IF DRAHRFDL GREATER THAN ZEROS
 18283        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18284
 18285 3670-REWRITE-BATCH-HEADER.
 18286     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18287        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18288        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18289        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18290        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18291        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18292        MOVE SPACE               TO PB-OUT-BAL-CD
 18293     ELSE
 18294        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18295
 18296     MOVE 'C'                    TO JP-RECORD-TYPE.
 18297     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18298
 18299
 18300* EXEC CICS REWRITE
 18301*         DATASET      (FILE-ID-ERPNDB)
 18302*         FROM         (PENDING-BUSINESS)
 18303*    END-EXEC.
 18304     MOVE LENGTH OF
 18305      PENDING-BUSINESS
 18306       TO DFHEIV11
 18307*    MOVE '&& L                  %   #00015668' TO DFHEIV0
 18308     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18309     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18310     MOVE X'2020233030303135363638' TO DFHEIV0(25:11)
 18311     CALL 'kxdfhei1' USING DFHEIV0,
 18312           FILE-ID-ERPNDB,
 18313           PENDING-BUSINESS,
 18314           DFHEIV11,
 18315           DFHEIV99
 18316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18317
 18318
 18319     PERFORM 8400-LOG-JOURNAL-RECORD.
 18320
 18321     GO TO 7200-DISPLAY-BATCHES.
 18322
 18323 3690-NOT-FOUND.
 18324     MOVE ER-2192                TO EMI-ERROR.
 18325     MOVE -1                     TO DPFENTRL.
 18326     MOVE AL-UNBON               TO DPFENTRA.
 18327     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18328     GO TO 8200-SEND-DATAONLY.
 18329
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 335
* EL6311.cbl
 18331
 18332******************************************************************
 18333*                                                                *
 18334*           R E - D I S P L A Y   R E C O R D                    *
 18335*                                                                *
 18336******************************************************************
 18337
 18338 3900-RE-DISPLAY-RECORD.
 18339
 18340* EXEC CICS HANDLE CONDITION
 18341*         NOTFND   (3990-NOT-FOUND)
 18342*    END-EXEC.
 18343*    MOVE '"$I                   ! H #00015693' TO DFHEIV0
 18344     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18345     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18346     MOVE X'4820233030303135363933' TO DFHEIV0(25:11)
 18347     CALL 'kxdfhei1' USING DFHEIV0
 18348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18349
 18350
 18351     IF PI-DISPLAY-ORIGINAL-BATCH
 18352         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18353     ELSE
 18354         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18355
 18356
 18357* EXEC CICS READ
 18358*         DATASET   (FILE-ID)
 18359*         RIDFLD    (PI-PREV-KEY)
 18360*         SET       (ADDRESS OF PENDING-BUSINESS)
 18361*    END-EXEC.
 18362*    MOVE '&"S        E          (   #00015702' TO DFHEIV0
 18363     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18364     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18365     MOVE X'2020233030303135373032' TO DFHEIV0(25:11)
 18366     CALL 'kxdfhei1' USING DFHEIV0,
 18367           FILE-ID,
 18368           DFHEIV20,
 18369           DFHEIV99,
 18370           PI-PREV-KEY,
 18371           DFHEIV99,
 18372           DFHEIV99,
 18373           DFHEIV99
 18374     SET ADDRESS OF PENDING-BUSINESS TO
 18375         DFHEIV20
 18376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18377
 18378
 18379     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18380
 18381     IF PB-ISSUE
 18382         GO TO 7000-DISPLAY-ISSUES.
 18383
 18384     IF PB-CANCELLATION
 18385         GO TO 7100-DISPLAY-CANCELS.
 18386
 18387     IF PB-BATCH-TRAILER
 18388         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 336
* EL6311.cbl
 18389
 18390 3990-NOT-FOUND.
 18391     MOVE LOW-VALUES             TO EL631BI.
 18392
 18393     IF PI-MAP-NAME = EL631B
 18394         MOVE -1                  TO BMAINTL
 18395     ELSE
 18396         MOVE -1                  TO CMAINTL.
 18397
 18398     GO TO 8100-SEND-INITIAL-MAP.
 18399
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 337
* EL6311.cbl
 18401
 18402***************************************************************
 18403*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18404*                                                             *
 18405*      1. START BROWSE WITH                                   *
 18406*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18407*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18408*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18409*                                                             *
 18410*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18411*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18412*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18413*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18414*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18415*               AND IS IT TO BE DISPLAYED.                    *
 18416*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18417*               DISPLAYED.                                    *
 18418*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18419*               DISPLAYED.                                    *
 18420*                                                             *
 18421*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18422*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18423***************************************************************
 18424
 18425 4000-BROWSE-DETAIL-FORWARD.
 18426     IF FIRST-TIME
 18427        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18428     ELSE
 18429        IF SHOW-RECORD
 18430           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18431           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18432           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18433           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18434           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18435        ELSE
 18436           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18437
 18438
 18439* EXEC CICS HANDLE CONDITION
 18440*         NOTFND   (4050-END-RECORDS)
 18441*         ENDFILE  (4050-END-RECORDS)
 18442*    END-EXEC.
 18443*    MOVE '"$I''                  ! I #00015767' TO DFHEIV0
 18444     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18445     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18446     MOVE X'4920233030303135373637' TO DFHEIV0(25:11)
 18447     CALL 'kxdfhei1' USING DFHEIV0
 18448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18449
 18450
 18451
 18452* EXEC CICS STARTBR
 18453*         DATASET   (FILE-ID-ERPNDB2)
 18454*         RIDFLD    (ERPNDB-ALT-KEY)
 18455*    END-EXEC.
 18456     MOVE 0
 18457       TO DFHEIV11
 18458*    MOVE '&,         G          &   #00015772' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 338
* EL6311.cbl
 18459     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18460     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18461     MOVE X'2020233030303135373732' TO DFHEIV0(25:11)
 18462     CALL 'kxdfhei1' USING DFHEIV0,
 18463           FILE-ID-ERPNDB2,
 18464           ERPNDB-ALT-KEY,
 18465           DFHEIV99,
 18466           DFHEIV11,
 18467           DFHEIV99
 18468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18469
 18470
 18471     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18472
 18473     IF FIRST-TIME OR SHOW-RECORD
 18474        MOVE SPACE               TO WS-FIRST-TIME-SW
 18475        GO TO 4005-READ-NEXT-RECORD.
 18476
 18477
 18478* EXEC CICS READNEXT
 18479*         DATASET    (FILE-ID-ERPNDB2)
 18480*         SET        (ADDRESS OF PENDING-BUSINESS)
 18481*         RIDFLD     (ERPNDB-ALT-KEY)
 18482*    END-EXEC.
 18483     MOVE 0
 18484       TO DFHEIV11
 18485*    MOVE '&.S                   )   #00015783' TO DFHEIV0
 18486     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18487     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18488     MOVE X'2020233030303135373833' TO DFHEIV0(25:11)
 18489     CALL 'kxdfhei1' USING DFHEIV0,
 18490           FILE-ID-ERPNDB2,
 18491           DFHEIV20,
 18492           DFHEIV99,
 18493           ERPNDB-ALT-KEY,
 18494           DFHEIV99,
 18495           DFHEIV11,
 18496           DFHEIV99,
 18497           DFHEIV99
 18498     SET ADDRESS OF PENDING-BUSINESS TO
 18499         DFHEIV20
 18500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18501
 18502
 18503 4005-READ-NEXT-RECORD.
 18504
 18505* EXEC CICS READNEXT
 18506*         DATASET    (FILE-ID-ERPNDB2)
 18507*         SET        (ADDRESS OF PENDING-BUSINESS)
 18508*         RIDFLD     (ERPNDB-ALT-KEY)
 18509*    END-EXEC.
 18510     MOVE 0
 18511       TO DFHEIV11
 18512*    MOVE '&.S                   )   #00015790' TO DFHEIV0
 18513     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18514     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18515     MOVE X'2020233030303135373930' TO DFHEIV0(25:11)
 18516     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 339
* EL6311.cbl
 18517           FILE-ID-ERPNDB2,
 18518           DFHEIV20,
 18519           DFHEIV99,
 18520           ERPNDB-ALT-KEY,
 18521           DFHEIV99,
 18522           DFHEIV11,
 18523           DFHEIV99,
 18524           DFHEIV99
 18525     SET ADDRESS OF PENDING-BUSINESS TO
 18526         DFHEIV20
 18527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18528
 18529
 18530     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18531
 18532     IF WS-BATCH-PREFIX = '#CL'
 18533        GO TO 4005-READ-NEXT-RECORD.
 18534
 18535     IF SHOW-RECORD
 18536        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18537           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18538           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18539           PB-STATE         NOT = PI-PB-STATE          OR
 18540           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18541           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18542           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18543           GO TO 4050-END-RECORDS
 18544        ELSE
 18545           GO TO 4010-CHECK-REC-TYPE.
 18546
 18547     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18548        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18549        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18550        PB-STATE            NOT = PI-PB-STATE          OR
 18551        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18552        GO TO 4050-END-RECORDS.
 18553
 18554     IF PB-BATCH-TRAILER
 18555        GO TO 4005-READ-NEXT-RECORD.
 18556
 18557     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18558        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18559           GO TO 4005-READ-NEXT-RECORD
 18560        ELSE
 18561           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18562              GO TO 4010-CHECK-REC-TYPE
 18563           ELSE
 18564              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18565                 GO TO 4010-CHECK-REC-TYPE
 18566              ELSE
 18567                 GO TO 4005-READ-NEXT-RECORD.
 18568
 18569     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18570        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18571           GO TO 4005-READ-NEXT-RECORD.
 18572
 18573 4010-CHECK-REC-TYPE.
 18574     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 340
* EL6311.cbl
 18575         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18576             NEXT SENTENCE
 18577         ELSE
 18578             GO TO 4005-READ-NEXT-RECORD.
 18579
 18580     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18581         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18582             NEXT SENTENCE
 18583        ELSE
 18584             GO TO 4005-READ-NEXT-RECORD.
 18585
 18586     IF NOT DISPLAY-CHANGE-RECORDS AND
 18587            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18588        GO TO 4005-READ-NEXT-RECORD.
 18589
 18590     IF DISPLAY-HOLD-RECORDS AND
 18591        NOT PB-RECORD-ON-HOLD
 18592          GO TO 4005-READ-NEXT-RECORD.
 18593
 18594     IF PB-ISSUE
 18595        IF DISPLAY-CHK-REQ-RECORDS
 18596            GO TO 4005-READ-NEXT-RECORD.
 18597
 18598     IF PB-ISSUE
 18599        IF ISSUE-WITH-WARNING
 18600           IF PB-WARNING-ERRORS
 18601              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18602                  GO TO 4005-READ-NEXT-RECORD
 18603              ELSE
 18604                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18605                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18606                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18607                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18608                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18609                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18610                 GO TO 7000-DISPLAY-ISSUES
 18611           ELSE
 18612              GO TO 4005-READ-NEXT-RECORD.
 18613
 18614     IF PB-ISSUE
 18615        IF (ISSUES-IN-ERROR AND
 18616            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18617            ALL-ISSUES
 18618            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18619            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18620            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18621            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18622            MOVE PB-SV-STATE            TO PI-SV-STATE
 18623            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18624            GO TO 7000-DISPLAY-ISSUES
 18625        ELSE
 18626            GO TO 4005-READ-NEXT-RECORD.
 18627
 18628     IF PB-CANCELLATION
 18629        IF DISPLAY-CHK-REQ-RECORDS
 18630           IF PB-C-REFUND-REQUESTED
 18631              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18632              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 341
* EL6311.cbl
 18633              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18634              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18635              MOVE PB-SV-STATE            TO PI-SV-STATE
 18636              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18637              GO TO 7100-DISPLAY-CANCELS
 18638           ELSE
 18639               GO TO 4005-READ-NEXT-RECORD.
 18640
 18641     IF PB-CANCELLATION
 18642        IF CANCEL-WITH-WARNING
 18643           IF PB-WARNING-ERRORS
 18644              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18645                  GO TO 4005-READ-NEXT-RECORD
 18646              ELSE
 18647                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18648                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18649                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18650                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18651                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18652                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18653                 GO TO 7100-DISPLAY-CANCELS
 18654           ELSE
 18655              GO TO 4005-READ-NEXT-RECORD.
 18656
 18657     IF PB-CANCELLATION
 18658        IF (CANCEL-IN-ERROR  AND
 18659            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18660            ALL-CANCELS
 18661            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18662            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18663            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18664            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18665            MOVE PB-SV-STATE            TO PI-SV-STATE
 18666            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18667            GO TO 7100-DISPLAY-CANCELS.
 18668
 18669     GO TO 4005-READ-NEXT-RECORD.
 18670
 18671 4050-END-RECORDS.
 18672******************************************************************
 18673*                                                                *
 18674*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18675*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18676*         PROGRAM.                                               *
 18677*                                                                *
 18678******************************************************************
 18679
 18680     IF BROWSE-STARTED
 18681        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18682
 18683* EXEC CICS ENDBR
 18684*            DATASET  (FILE-ID-ERPNDB2)
 18685*       END-EXEC.
 18686     MOVE 0
 18687       TO DFHEIV11
 18688*    MOVE '&2                    $   #00015948' TO DFHEIV0
 18689     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18690     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 342
* EL6311.cbl
 18691     MOVE X'2020233030303135393438' TO DFHEIV0(25:11)
 18692     CALL 'kxdfhei1' USING DFHEIV0,
 18693           FILE-ID-ERPNDB2,
 18694           DFHEIV11,
 18695           DFHEIV99
 18696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18697
 18698
 18699     IF  EIBTRNID NOT = TRANS-EXB1
 18700         IF PENDING-BUS-RECS-FOUND
 18701             NEXT SENTENCE
 18702           ELSE
 18703             MOVE '9'            TO PI-BROWSE-SW
 18704             GO TO 9400-CLEAR.
 18705
 18706     IF SHOW-RECORD
 18707        MOVE ER-2253            TO EMI-ERROR
 18708       ELSE
 18709        MOVE ER-2254            TO EMI-ERROR.
 18710
 18711     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18712
 18713     IF PI-MAP-NAME = SPACES
 18714        MOVE -1                  TO DPFENTRL
 18715        MOVE EL631D               TO PI-MAP-NAME
 18716        GO TO 8100-SEND-INITIAL-MAP.
 18717
 18718     IF PI-MAP-NAME = EL631B
 18719        MOVE -1                  TO BMAINTL
 18720     ELSE
 18721        IF PI-MAP-NAME = EL631C
 18722           MOVE -1               TO CMAINTL
 18723        ELSE
 18724           MOVE -1               TO DPFENTRL.
 18725
 18726     GO TO 8200-SEND-DATAONLY.
 18727
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 343
* EL6311.cbl
 18729
 18730***************************************************************
 18731*                                                             *
 18732*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18733*                                                             *
 18734*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18735*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18736*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18737*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18738*                                                             *
 18739*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18740*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18741*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18742*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18743*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18744*                AND IS IT TO BE DISPLAYED.                   *
 18745*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18746*                DISPLAYED.                                   *
 18747*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18748*                DISPLAYED.                                   *
 18749*                                                             *
 18750*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18751*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18752*                                                             *
 18753*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18754*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18755*                THEY ARE NOT TO BE DISPLAYED.                *
 18756*                                                             *
 18757***************************************************************
 18758
 18759 4100-BROWSE-PRIMARY-FORWARD.
 18760     IF FIRST-TIME  OR SHOW-RECORD
 18761        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18762        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18763        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18764     ELSE
 18765        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18766        IF ERPNDB-BATCH-SEQ-NO = +9999
 18767           GO TO 4150-END-BATCH
 18768        ELSE
 18769           IF DISPLAY-CHANGE-RECORDS
 18770              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18771           ELSE
 18772              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18773              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18774
 18775     IF FIRST-TIME
 18776         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18777            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18778              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18779
 18780
 18781* EXEC CICS HANDLE CONDITION
 18782*         ENDFILE  (4150-END-BATCH)
 18783*    END-EXEC.
 18784*    MOVE '"$''                   ! J #00016033' TO DFHEIV0
 18785     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18786     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 344
* EL6311.cbl
 18787     MOVE X'4A20233030303136303333' TO DFHEIV0(25:11)
 18788     CALL 'kxdfhei1' USING DFHEIV0
 18789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18790
 18791
 18792 4105-READ-NEXT.
 18793
 18794* EXEC CICS HANDLE CONDITION
 18795*         NOTFND    (4150-END-BATCH)
 18796*    END-EXEC.
 18797*    MOVE '"$I                   ! K #00016038' TO DFHEIV0
 18798     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18799     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18800     MOVE X'4B20233030303136303338' TO DFHEIV0(25:11)
 18801     CALL 'kxdfhei1' USING DFHEIV0
 18802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18803
 18804
 18805     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18806
 18807     IF PI-DISPLAY-ORIGINAL-BATCH
 18808        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18809     ELSE
 18810        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18811
 18812
 18813* EXEC CICS READ
 18814*         DATASET   (FILE-ID)
 18815*         SET       (ADDRESS OF PENDING-BUSINESS)
 18816*         RIDFLD    (ERPNDB-KEY)
 18817*         GTEQ
 18818*    END-EXEC.
 18819*    MOVE '&"S        G          (   #00016049' TO DFHEIV0
 18820     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18821     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18822     MOVE X'2020233030303136303439' TO DFHEIV0(25:11)
 18823     CALL 'kxdfhei1' USING DFHEIV0,
 18824           FILE-ID,
 18825           DFHEIV20,
 18826           DFHEIV99,
 18827           ERPNDB-KEY,
 18828           DFHEIV99,
 18829           DFHEIV99,
 18830           DFHEIV99
 18831     SET ADDRESS OF PENDING-BUSINESS TO
 18832         DFHEIV20
 18833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18834
 18835
 18836     IF PI-DISPLAY-ORIGINAL-BATCH
 18837        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18838           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18839           GO TO 4150-END-BATCH
 18840        ELSE
 18841           IF PB-BATCH-TRAILER
 18842              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18843              GO TO 4105-READ-NEXT
 18844           ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 345
* EL6311.cbl
 18845              NEXT SENTENCE
 18846     ELSE
 18847        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18848           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18849           GO TO 4150-END-BATCH.
 18850
 18851     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18852
 18853     IF WS-BATCH-PREFIX = '#CL'
 18854         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18855         GO TO 4105-READ-NEXT.
 18856
 18857     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18858     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18859     MOVE PB-STATE               TO PI-PB-STATE.
 18860     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18861
 18862     IF PB-BATCH-TRAILER
 18863        IF SHOW-RECORD
 18864           GO TO 4150-END-BATCH
 18865        ELSE
 18866           MOVE ER-2251         TO EMI-ERROR
 18867           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18868           MOVE 1               TO PI-BROWSE-TYPE
 18869           GO TO 7200-DISPLAY-BATCHES.
 18870
 18871     IF SHOW-RECORD
 18872           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18873              GO TO 4110-BUMP-SEQ
 18874           ELSE
 18875              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18876                 GO TO 4110-BUMP-SEQ
 18877              ELSE
 18878                 GO TO 4107-CHECK-REC-TYPE.
 18879
 18880     IF NOT  PI-PRIMARY-WITH-SELECT
 18881        GO TO 4107-CHECK-REC-TYPE.
 18882
 18883     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18884        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18885           GO TO 4110-BUMP-SEQ
 18886        ELSE
 18887           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18888              GO TO 4107-CHECK-REC-TYPE
 18889           ELSE
 18890              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18891                 GO TO 4107-CHECK-REC-TYPE
 18892              ELSE
 18893                 GO TO 4110-BUMP-SEQ.
 18894
 18895     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18896        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18897           GO TO 4110-BUMP-SEQ.
 18898
 18899 4107-CHECK-REC-TYPE.
 18900     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18901         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18902             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 346
* EL6311.cbl
 18903           ELSE
 18904             GO TO 4110-BUMP-SEQ.
 18905
 18906     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18907         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18908             NEXT SENTENCE
 18909           ELSE
 18910             GO TO 4110-BUMP-SEQ.
 18911
 18912     IF NOT DISPLAY-CHANGE-RECORDS AND
 18913        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18914           GO TO 4110-BUMP-SEQ.
 18915
 18916     IF DISPLAY-HOLD-RECORDS AND
 18917        NOT PB-RECORD-ON-HOLD
 18918          GO TO 4110-BUMP-SEQ.
 18919
 18920     IF PB-ISSUE
 18921        IF DISPLAY-CHK-REQ-RECORDS
 18922            GO TO 4110-BUMP-SEQ.
 18923
 18924     IF PB-ISSUE
 18925        IF ISSUE-WITH-WARNING
 18926           IF PB-WARNING-ERRORS
 18927              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18928                  GO TO 4110-BUMP-SEQ
 18929              ELSE
 18930                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18931                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18932                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18933                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18934                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18935                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18936                 GO TO 7000-DISPLAY-ISSUES
 18937        ELSE
 18938            GO TO 4110-BUMP-SEQ.
 18939
 18940     IF PB-ISSUE
 18941        IF (ISSUES-IN-ERROR AND
 18942            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18943            ALL-ISSUES
 18944            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18945            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18946            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18947            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18948            MOVE PB-SV-STATE            TO PI-SV-STATE
 18949            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18950            GO TO 7000-DISPLAY-ISSUES
 18951        ELSE
 18952            GO TO 4110-BUMP-SEQ.
 18953
 18954     IF PB-CANCELLATION
 18955        IF DISPLAY-CHK-REQ-RECORDS
 18956           IF PB-C-REFUND-REQUESTED
 18957              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18958              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18959              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18960              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 347
* EL6311.cbl
 18961              MOVE PB-SV-STATE            TO PI-SV-STATE
 18962              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18963              GO TO 7100-DISPLAY-CANCELS
 18964           ELSE
 18965              GO TO 4110-BUMP-SEQ.
 18966
 18967     IF PB-CANCELLATION
 18968        IF CANCEL-WITH-WARNING
 18969           IF PB-WARNING-ERRORS
 18970              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18971                  GO TO 4110-BUMP-SEQ
 18972              ELSE
 18973                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18974                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18975                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18976                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18977                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18978                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18979                 GO TO 7100-DISPLAY-CANCELS
 18980           ELSE
 18981              GO TO 4110-BUMP-SEQ.
 18982
 18983     IF PB-CANCELLATION
 18984        IF (CANCEL-IN-ERROR  AND
 18985            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18986            ALL-CANCELS
 18987            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18988            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18989            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18990            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18991            MOVE PB-SV-STATE            TO PI-SV-STATE
 18992            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 18993            GO TO 7100-DISPLAY-CANCELS.
 18994
 18995 4110-BUMP-SEQ.
 18996     IF NOT DISPLAY-CHANGE-RECORDS
 18997        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18998        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18999     ELSE
 19000        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19001           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19002           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19003        ELSE
 19004           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19005           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19006
 19007     GO TO 4105-READ-NEXT.
 19008
 19009 4150-END-BATCH.
 19010******************************************************************
 19011*                                                                *
 19012*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19013*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19014*         PROGRAM.                                               *
 19015*                                                                *
 19016******************************************************************
 19017
 19018     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 348
* EL6311.cbl
 19019         IF PENDING-BUS-RECS-FOUND
 19020             NEXT SENTENCE
 19021           ELSE
 19022             MOVE '9'            TO PI-BROWSE-SW
 19023             GO TO 9400-CLEAR.
 19024
 19025     IF SHOW-RECORD
 19026        MOVE ER-2253             TO EMI-ERROR
 19027     ELSE
 19028        MOVE ER-2251             TO EMI-ERROR.
 19029
 19030     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19031
 19032     IF PI-MAP-NAME = SPACES
 19033        MOVE -1                  TO BMAINTL
 19034        MOVE EL631B              TO PI-MAP-NAME
 19035        GO TO 8100-SEND-INITIAL-MAP.
 19036
 19037     IF PI-MAP-NAME = EL631B
 19038        MOVE -1                  TO BMAINTL
 19039     ELSE
 19040        IF PI-MAP-NAME = EL631C
 19041           MOVE -1               TO CMAINTL
 19042        ELSE
 19043           MOVE -1               TO DPFENTRL.
 19044
 19045     GO TO 8200-SEND-DATAONLY.
 19046
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 349
* EL6311.cbl
 19048
 19049***************************************************************
 19050*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19051*                                                             *
 19052*      1. START BROWSE WITH                                   *
 19053*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19054*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19055*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19056*                                                             *
 19057*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19058*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19059*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19060*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19061*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19062*               AND IS IT TO BE DISPLAYED.                    *
 19063*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19064*               DISPLAYED.                                    *
 19065*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19066*               DISPLAYED.                                    *
 19067*                                                             *
 19068*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19069*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19070***************************************************************
 19071
 19072 4200-BROWSE-CSR-FORWARD.
 19073
 19074     IF FIRST-TIME
 19075        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19076     ELSE
 19077        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19078
 19079
 19080* EXEC CICS HANDLE CONDITION
 19081*         NOTFND   (4250-END-RECORDS)
 19082*         ENDFILE  (4250-END-RECORDS)
 19083*    END-EXEC.
 19084*    MOVE '"$I''                  ! L #00016299' TO DFHEIV0
 19085     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19086     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19087     MOVE X'4C20233030303136323939' TO DFHEIV0(25:11)
 19088     CALL 'kxdfhei1' USING DFHEIV0
 19089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19090
 19091
 19092
 19093* EXEC CICS STARTBR
 19094*         DATASET   (FILE-ID-ERPNDB4)
 19095*         RIDFLD    (ERPNDB-CSR-KEY)
 19096*    END-EXEC.
 19097     MOVE 0
 19098       TO DFHEIV11
 19099*    MOVE '&,         G          &   #00016304' TO DFHEIV0
 19100     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19101     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19102     MOVE X'2020233030303136333034' TO DFHEIV0(25:11)
 19103     CALL 'kxdfhei1' USING DFHEIV0,
 19104           FILE-ID-ERPNDB4,
 19105           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 350
* EL6311.cbl
 19106           DFHEIV99,
 19107           DFHEIV11,
 19108           DFHEIV99
 19109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19110
 19111
 19112     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19113
 19114     IF FIRST-TIME
 19115        MOVE SPACE               TO WS-FIRST-TIME-SW
 19116        GO TO 4205-READ-NEXT-RECORD.
 19117
 19118
 19119* EXEC CICS READNEXT
 19120*         DATASET    (FILE-ID-ERPNDB4)
 19121*         SET        (ADDRESS OF PENDING-BUSINESS)
 19122*         RIDFLD     (ERPNDB-CSR-KEY)
 19123*    END-EXEC.
 19124     MOVE 0
 19125       TO DFHEIV11
 19126*    MOVE '&.S                   )   #00016315' TO DFHEIV0
 19127     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19128     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19129     MOVE X'2020233030303136333135' TO DFHEIV0(25:11)
 19130     CALL 'kxdfhei1' USING DFHEIV0,
 19131           FILE-ID-ERPNDB4,
 19132           DFHEIV20,
 19133           DFHEIV99,
 19134           ERPNDB-CSR-KEY,
 19135           DFHEIV99,
 19136           DFHEIV11,
 19137           DFHEIV99,
 19138           DFHEIV99
 19139     SET ADDRESS OF PENDING-BUSINESS TO
 19140         DFHEIV20
 19141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19142
 19143
 19144 4205-READ-NEXT-RECORD.
 19145
 19146
 19147* EXEC CICS READNEXT
 19148*         DATASET    (FILE-ID-ERPNDB4)
 19149*         SET        (ADDRESS OF PENDING-BUSINESS)
 19150*         RIDFLD     (ERPNDB-CSR-KEY)
 19151*    END-EXEC.
 19152     MOVE 0
 19153       TO DFHEIV11
 19154*    MOVE '&.S                   )   #00016323' TO DFHEIV0
 19155     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19156     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19157     MOVE X'2020233030303136333233' TO DFHEIV0(25:11)
 19158     CALL 'kxdfhei1' USING DFHEIV0,
 19159           FILE-ID-ERPNDB4,
 19160           DFHEIV20,
 19161           DFHEIV99,
 19162           ERPNDB-CSR-KEY,
 19163           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 351
* EL6311.cbl
 19164           DFHEIV11,
 19165           DFHEIV99,
 19166           DFHEIV99
 19167     SET ADDRESS OF PENDING-BUSINESS TO
 19168         DFHEIV20
 19169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19170
 19171
 19172     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19173
 19174     IF WS-BATCH-PREFIX = '#CL'
 19175        GO TO 4205-READ-NEXT-RECORD.
 19176
 19177     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19178        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19179        GO TO 4250-END-RECORDS.
 19180
 19181     IF PB-BATCH-TRAILER
 19182        GO TO 4205-READ-NEXT-RECORD.
 19183
 19184     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19185        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19186           GO TO 4205-READ-NEXT-RECORD
 19187        ELSE
 19188           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19189              GO TO 4210-CHECK-REC-TYPE
 19190           ELSE
 19191              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19192                 GO TO 4210-CHECK-REC-TYPE
 19193              ELSE
 19194                 GO TO 4205-READ-NEXT-RECORD.
 19195
 19196     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19197        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19198           GO TO 4205-READ-NEXT-RECORD.
 19199
 19200 4210-CHECK-REC-TYPE.
 19201     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19202         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19203             NEXT SENTENCE
 19204         ELSE
 19205             GO TO 4205-READ-NEXT-RECORD.
 19206
 19207     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19208         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19209             NEXT SENTENCE
 19210        ELSE
 19211             GO TO 4205-READ-NEXT-RECORD.
 19212
 19213     IF NOT DISPLAY-CHANGE-RECORDS AND
 19214            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19215        GO TO 4205-READ-NEXT-RECORD.
 19216
 19217     IF DISPLAY-HOLD-RECORDS AND
 19218        NOT PB-RECORD-ON-HOLD
 19219          GO TO 4205-READ-NEXT-RECORD.
 19220
 19221     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 352
* EL6311.cbl
 19222        IF DISPLAY-CHK-REQ-RECORDS
 19223            GO TO 4205-READ-NEXT-RECORD.
 19224
 19225     IF PB-ISSUE
 19226        IF ISSUE-WITH-WARNING
 19227           IF PB-WARNING-ERRORS
 19228              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19229                  GO TO 4205-READ-NEXT-RECORD
 19230              ELSE
 19231                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19232                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19233                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19234                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19235                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19236                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19237                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19238                 GO TO 7000-DISPLAY-ISSUES
 19239           ELSE
 19240              GO TO 4205-READ-NEXT-RECORD.
 19241
 19242     IF PB-ISSUE
 19243        IF (ISSUES-IN-ERROR AND
 19244            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19245            ALL-ISSUES
 19246            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19247            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19248            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19249            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19250            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19251            MOVE PB-SV-STATE            TO PI-SV-STATE
 19252            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19253            GO TO 7000-DISPLAY-ISSUES
 19254        ELSE
 19255            GO TO 4205-READ-NEXT-RECORD.
 19256
 19257     IF PB-CANCELLATION
 19258        IF DISPLAY-CHK-REQ-RECORDS
 19259           IF PB-C-REFUND-REQUESTED
 19260              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19261              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19262              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19263              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19264              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19265              MOVE PB-SV-STATE            TO PI-SV-STATE
 19266              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19267              GO TO 7100-DISPLAY-CANCELS
 19268           ELSE
 19269               GO TO 4205-READ-NEXT-RECORD.
 19270
 19271     IF PB-CANCELLATION
 19272        IF CANCEL-WITH-WARNING
 19273           IF PB-WARNING-ERRORS
 19274              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19275                  GO TO 4205-READ-NEXT-RECORD
 19276              ELSE
 19277                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19278                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19279                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 353
* EL6311.cbl
 19280                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19281                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19282                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19283                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19284                 GO TO 7100-DISPLAY-CANCELS
 19285           ELSE
 19286              GO TO 4205-READ-NEXT-RECORD.
 19287
 19288     IF PB-CANCELLATION
 19289        IF (CANCEL-IN-ERROR  AND
 19290            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19291            ALL-CANCELS
 19292            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19293            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19294            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19295            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19296            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19297            MOVE PB-SV-STATE            TO PI-SV-STATE
 19298            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19299            GO TO 7100-DISPLAY-CANCELS.
 19300
 19301     GO TO 4205-READ-NEXT-RECORD.
 19302
 19303 4250-END-RECORDS.
 19304******************************************************************
 19305*                                                                *
 19306*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19307*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19308*         PROGRAM.                                               *
 19309*                                                                *
 19310******************************************************************
 19311
 19312     IF BROWSE-STARTED
 19313        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19314
 19315* EXEC CICS ENDBR
 19316*            DATASET  (FILE-ID-ERPNDB4)
 19317*       END-EXEC.
 19318     MOVE 0
 19319       TO DFHEIV11
 19320*    MOVE '&2                    $   #00016471' TO DFHEIV0
 19321     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19322     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19323     MOVE X'2020233030303136343731' TO DFHEIV0(25:11)
 19324     CALL 'kxdfhei1' USING DFHEIV0,
 19325           FILE-ID-ERPNDB4,
 19326           DFHEIV11,
 19327           DFHEIV99
 19328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19329
 19330
 19331     IF  EIBTRNID NOT = TRANS-EXB1
 19332         IF PENDING-BUS-RECS-FOUND
 19333             NEXT SENTENCE
 19334           ELSE
 19335             MOVE '9'            TO PI-BROWSE-SW
 19336             GO TO 9400-CLEAR.
 19337
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 354
* EL6311.cbl
 19338     IF SHOW-RECORD
 19339        MOVE ER-2253            TO EMI-ERROR
 19340       ELSE
 19341        MOVE ER-2254            TO EMI-ERROR.
 19342
 19343     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19344
 19345     IF PI-MAP-NAME = SPACES
 19346        MOVE -1                  TO DPFENTRL
 19347        MOVE EL631D               TO PI-MAP-NAME
 19348        GO TO 8100-SEND-INITIAL-MAP.
 19349
 19350     IF PI-MAP-NAME = EL631B
 19351        MOVE -1                  TO BMAINTL
 19352     ELSE
 19353        IF PI-MAP-NAME = EL631C
 19354           MOVE -1               TO CMAINTL
 19355        ELSE
 19356           MOVE -1               TO DPFENTRL.
 19357
 19358     GO TO 8200-SEND-DATAONLY.
 19359
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 355
* EL6311.cbl
 19361
 19362***************************************************************
 19363*                                                             *
 19364*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19365*                                                             *
 19366*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19367*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19368*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19369*                                                             *
 19370*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19371*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19372*          A. IS IT WITHIN THE SAME COMPANY                   *
 19373*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19374*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19375*                AND IS IT TO BE DISPLAYED.                   *
 19376*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19377*                DISPLAYED.                                   *
 19378*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19379*                DISPLAYED.                                   *
 19380*                                                             *
 19381*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19382*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19383*                                                             *
 19384*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19385*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19386*                THEY ARE NOT TO BE DISPLAYED.                *
 19387*                                                             *
 19388***************************************************************
 19389
 19390 4300-BROWSE-FILE-FORWARD.
 19391     IF FIRST-TIME OR SHOW-RECORD
 19392        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19393        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19394        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19395     ELSE
 19396        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19397        IF ERPNDB-BATCH-SEQ-NO = +9999
 19398           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19399        ELSE
 19400           IF DISPLAY-CHANGE-RECORDS
 19401              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19402           ELSE
 19403              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19404              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19405
 19406
 19407* EXEC CICS HANDLE CONDITION
 19408*         ENDFILE  (4350-END-BATCH)
 19409*         NOTFND   (4350-END-BATCH)
 19410*    END-EXEC.
 19411*    MOVE '"$''I                  ! M #00016550' TO DFHEIV0
 19412     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19413     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19414     MOVE X'4D20233030303136353530' TO DFHEIV0(25:11)
 19415     CALL 'kxdfhei1' USING DFHEIV0
 19416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19417
 19418
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 356
* EL6311.cbl
 19419 4305-READ-NEXT.
 19420     IF PI-DISPLAY-ORIGINAL-BATCH
 19421        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19422     ELSE
 19423        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19424
 19425
 19426* EXEC CICS READ
 19427*         DATASET   (FILE-ID)
 19428*         SET       (ADDRESS OF PENDING-BUSINESS)
 19429*         RIDFLD    (ERPNDB-KEY)
 19430*         GTEQ
 19431*    END-EXEC.
 19432*    MOVE '&"S        G          (   #00016561' TO DFHEIV0
 19433     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19434     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19435     MOVE X'2020233030303136353631' TO DFHEIV0(25:11)
 19436     CALL 'kxdfhei1' USING DFHEIV0,
 19437           FILE-ID,
 19438           DFHEIV20,
 19439           DFHEIV99,
 19440           ERPNDB-KEY,
 19441           DFHEIV99,
 19442           DFHEIV99,
 19443           DFHEIV99
 19444     SET ADDRESS OF PENDING-BUSINESS TO
 19445         DFHEIV20
 19446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19447
 19448
 19449     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19450        GO TO 4350-END-BATCH.
 19451
 19452     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19453                                    WS-BATCH-NO.
 19454
 19455     IF  WS-BATCH-PREFIX = '#CL'
 19456         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19457         GO TO 4305-READ-NEXT.
 19458
 19459     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19460     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19461     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19462     MOVE PB-STATE               TO PI-PB-STATE.
 19463     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19464
 19465     IF PB-BATCH-TRAILER
 19466        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19467        GO TO 4305-READ-NEXT.
 19468
 19469     IF SHOW-RECORD
 19470           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19471              GO TO 4310-BUMP-SEQ
 19472           ELSE
 19473              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19474                 GO TO 4310-BUMP-SEQ
 19475              ELSE
 19476                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 357
* EL6311.cbl
 19477
 19478     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19479        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19480           GO TO 4310-BUMP-SEQ
 19481        ELSE
 19482           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19483              GO TO 4307-CHECK-REC-TYPE
 19484           ELSE
 19485              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19486                 GO TO 4307-CHECK-REC-TYPE
 19487              ELSE
 19488                 GO TO 4310-BUMP-SEQ.
 19489
 19490     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19491        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19492           GO TO 4310-BUMP-SEQ.
 19493
 19494 4307-CHECK-REC-TYPE.
 19495     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19496         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19497             NEXT SENTENCE
 19498         ELSE
 19499             GO TO 4310-BUMP-SEQ.
 19500
 19501     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19502         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19503             NEXT SENTENCE
 19504        ELSE
 19505             GO TO 4310-BUMP-SEQ.
 19506
 19507     IF NOT DISPLAY-CHANGE-RECORDS AND
 19508            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19509        GO TO 4310-BUMP-SEQ.
 19510
 19511     IF DISPLAY-HOLD-RECORDS AND
 19512        NOT PB-RECORD-ON-HOLD
 19513          GO TO 4310-BUMP-SEQ.
 19514
 19515     IF PB-ISSUE
 19516        IF DISPLAY-CHK-REQ-RECORDS
 19517           GO TO 4310-BUMP-SEQ.
 19518
 19519     IF PB-ISSUE
 19520        IF ISSUE-WITH-WARNING
 19521           IF PB-WARNING-ERRORS
 19522              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19523                  GO TO 4310-BUMP-SEQ
 19524              ELSE
 19525                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19526                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19527                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19528                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19529                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19530                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19531                 GO TO 7000-DISPLAY-ISSUES
 19532           ELSE
 19533              GO TO 4310-BUMP-SEQ.
 19534
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 358
* EL6311.cbl
 19535     IF PB-ISSUE
 19536        IF (ISSUES-IN-ERROR AND
 19537            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19538            ALL-ISSUES
 19539            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19540            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19541            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19542            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19543            MOVE PB-SV-STATE            TO PI-SV-STATE
 19544            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19545            GO TO 7000-DISPLAY-ISSUES
 19546        ELSE
 19547            GO TO 4310-BUMP-SEQ.
 19548
 19549     IF PB-CANCELLATION
 19550        IF DISPLAY-CHK-REQ-RECORDS
 19551           IF PB-C-REFUND-REQUESTED
 19552              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19553              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19554              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19555              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19556              MOVE PB-SV-STATE            TO PI-SV-STATE
 19557              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19558              GO TO 7100-DISPLAY-CANCELS
 19559           ELSE
 19560              GO TO 4310-BUMP-SEQ.
 19561
 19562     IF PB-CANCELLATION
 19563        IF CANCEL-WITH-WARNING
 19564           IF PB-WARNING-ERRORS
 19565              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19566                  GO TO 4310-BUMP-SEQ
 19567              ELSE
 19568                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19569                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19570                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19571                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19572                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19573                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19574                 GO TO 7100-DISPLAY-CANCELS
 19575           ELSE
 19576              GO TO 4310-BUMP-SEQ.
 19577
 19578     IF PB-CANCELLATION
 19579        IF (CANCEL-IN-ERROR  AND
 19580            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19581            ALL-CANCELS
 19582            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19583            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19584            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19585            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19586            MOVE PB-SV-STATE            TO PI-SV-STATE
 19587            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19588            GO TO 7100-DISPLAY-CANCELS.
 19589
 19590 4310-BUMP-SEQ.
 19591     IF NOT DISPLAY-CHANGE-RECORDS
 19592        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 359
* EL6311.cbl
 19593        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19594     ELSE
 19595        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19596           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19597           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19598        ELSE
 19599           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19600           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19601
 19602     GO TO 4305-READ-NEXT.
 19603
 19604 4350-END-BATCH.
 19605
 19606******************************************************************
 19607*                                                                *
 19608*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19609*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19610*         PROGRAM.                                               *
 19611*                                                                *
 19612******************************************************************
 19613
 19614     IF  EIBTRNID NOT = TRANS-EXB1
 19615         IF PENDING-BUS-RECS-FOUND
 19616             NEXT SENTENCE
 19617           ELSE
 19618             MOVE '9'            TO PI-BROWSE-SW
 19619             GO TO 9400-CLEAR.
 19620
 19621     IF SHOW-RECORD
 19622        MOVE ER-2253            TO EMI-ERROR
 19623     ELSE
 19624        MOVE ER-2251            TO EMI-ERROR.
 19625
 19626     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19627
 19628     IF PI-MAP-NAME = SPACES
 19629        MOVE -1                  TO BMAINTL
 19630        MOVE EL631B               TO PI-MAP-NAME
 19631        GO TO 8100-SEND-INITIAL-MAP.
 19632
 19633     IF PI-MAP-NAME = EL631B
 19634        MOVE -1                  TO BMAINTL
 19635     ELSE
 19636        IF PI-MAP-NAME = EL631C
 19637           MOVE -1               TO CMAINTL
 19638        ELSE
 19639           MOVE -1               TO DPFENTRL.
 19640
 19641     GO TO 8200-SEND-DATAONLY.
 19642
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 360
* EL6311.cbl
 19644
 19645******************************************************************
 19646*                                                                *
 19647*        B R O W S E   D E T A I L   B A C K W A R D             *
 19648*                                                                *
 19649******************************************************************
 19650
 19651 4500-BROWSE-DETAIL-BACKWARD.
 19652
 19653     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19654
 19655
 19656* EXEC CICS HANDLE CONDITION
 19657*         NOTFND   (4570-NOT-FOUND)
 19658*         ENDFILE  (4550-END-RECORDS)
 19659*    END-EXEC
 19660*    MOVE '"$I''                  ! N #00016774' TO DFHEIV0
 19661     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19662     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19663     MOVE X'4E20233030303136373734' TO DFHEIV0(25:11)
 19664     CALL 'kxdfhei1' USING DFHEIV0
 19665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19666
 19667
 19668* EXEC CICS STARTBR
 19669*         DATASET   (FILE-ID-ERPNDB2)
 19670*         RIDFLD    (ERPNDB-ALT-KEY)
 19671*    END-EXEC.
 19672     MOVE 0
 19673       TO DFHEIV11
 19674*    MOVE '&,         G          &   #00016779' TO DFHEIV0
 19675     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19676     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19677     MOVE X'2020233030303136373739' TO DFHEIV0(25:11)
 19678     CALL 'kxdfhei1' USING DFHEIV0,
 19679           FILE-ID-ERPNDB2,
 19680           ERPNDB-ALT-KEY,
 19681           DFHEIV99,
 19682           DFHEIV11,
 19683           DFHEIV99
 19684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19685
 19686
 19687     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19688                                    WS-FIRST-TIME-SW.
 19689
 19690 4505-READ-PREV-RECORD.
 19691
 19692* EXEC CICS READPREV
 19693*         DATASET    (FILE-ID-ERPNDB2)
 19694*         SET        (ADDRESS OF PENDING-BUSINESS)
 19695*         RIDFLD     (ERPNDB-ALT-KEY)
 19696*    END-EXEC.
 19697     MOVE 0
 19698       TO DFHEIV11
 19699*    MOVE '&0S                   )   #00016788' TO DFHEIV0
 19700     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19701     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 361
* EL6311.cbl
 19702     MOVE X'2020233030303136373838' TO DFHEIV0(25:11)
 19703     CALL 'kxdfhei1' USING DFHEIV0,
 19704           FILE-ID-ERPNDB2,
 19705           DFHEIV20,
 19706           DFHEIV99,
 19707           ERPNDB-ALT-KEY,
 19708           DFHEIV99,
 19709           DFHEIV11,
 19710           DFHEIV99,
 19711           DFHEIV99
 19712     SET ADDRESS OF PENDING-BUSINESS TO
 19713         DFHEIV20
 19714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19715
 19716
 19717     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19718
 19719     IF WS-BATCH-PREFIX = '#CL'
 19720         GO TO 4505-READ-PREV-RECORD.
 19721
 19722     IF FIRST-TIME
 19723         MOVE SPACE               TO WS-FIRST-TIME-SW
 19724         GO TO 4505-READ-PREV-RECORD.
 19725
 19726     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19727        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19728        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19729        PB-STATE         NOT = PI-PB-STATE    OR
 19730        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19731          GO TO 4550-END-RECORDS.
 19732
 19733
 19734     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19735
 19736     IF PB-BATCH-TRAILER
 19737        GO TO 4505-READ-PREV-RECORD.
 19738
 19739     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19740
 19741     IF  WS-BATCH-PREFIX = '#CL'
 19742         GO TO 4505-READ-PREV-RECORD.
 19743
 19744     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19745        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19746           GO TO 4505-READ-PREV-RECORD
 19747        ELSE
 19748           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19749              GO TO 4510-CHECK-REC-TYPE
 19750           ELSE
 19751              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19752                 GO TO 4510-CHECK-REC-TYPE
 19753              ELSE
 19754                 GO TO 4505-READ-PREV-RECORD.
 19755
 19756     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19757        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19758           GO TO 4505-READ-PREV-RECORD.
 19759
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 362
* EL6311.cbl
 19760 4510-CHECK-REC-TYPE.
 19761     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19762         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19763             NEXT SENTENCE
 19764         ELSE
 19765             GO TO 4505-READ-PREV-RECORD.
 19766
 19767     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19768         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19769             NEXT SENTENCE
 19770        ELSE
 19771             GO TO 4505-READ-PREV-RECORD.
 19772
 19773     IF NOT DISPLAY-CHANGE-RECORDS AND
 19774            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19775        GO TO 4505-READ-PREV-RECORD.
 19776
 19777     IF DISPLAY-HOLD-RECORDS AND
 19778        NOT PB-RECORD-ON-HOLD
 19779          GO TO 4505-READ-PREV-RECORD.
 19780
 19781     IF PB-ISSUE
 19782        IF DISPLAY-CHK-REQ-RECORDS
 19783           GO TO 4505-READ-PREV-RECORD.
 19784
 19785     IF PB-ISSUE
 19786        IF ISSUE-WITH-WARNING
 19787           IF PB-WARNING-ERRORS
 19788              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19789                  GO TO 4505-READ-PREV-RECORD
 19790              ELSE
 19791                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19792                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19793                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19794                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19795                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19796                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19797                 GO TO 7000-DISPLAY-ISSUES
 19798           ELSE
 19799              GO TO 4505-READ-PREV-RECORD.
 19800
 19801     IF PB-ISSUE
 19802        IF (ISSUES-IN-ERROR AND
 19803            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19804            ALL-ISSUES
 19805            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19806            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19807            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19808            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19809            MOVE PB-SV-STATE            TO PI-SV-STATE
 19810            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19811            GO TO 7000-DISPLAY-ISSUES
 19812        ELSE
 19813            GO TO 4505-READ-PREV-RECORD.
 19814
 19815     IF PB-CANCELLATION
 19816        IF DISPLAY-CHK-REQ-RECORDS
 19817           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 363
* EL6311.cbl
 19818              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19819              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19820              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19821              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19822              MOVE PB-SV-STATE            TO PI-SV-STATE
 19823              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19824              GO TO 7100-DISPLAY-CANCELS
 19825           ELSE
 19826              GO TO 4505-READ-PREV-RECORD.
 19827
 19828     IF PB-CANCELLATION
 19829        IF CANCEL-WITH-WARNING
 19830           IF PB-WARNING-ERRORS
 19831              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19832                  GO TO 4505-READ-PREV-RECORD
 19833              ELSE
 19834                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19835                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19836                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19837                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19838                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19839                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19840                 GO TO 7100-DISPLAY-CANCELS
 19841           ELSE
 19842              GO TO 4505-READ-PREV-RECORD.
 19843
 19844     IF PB-CANCELLATION
 19845        IF (CANCEL-IN-ERROR  AND
 19846            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19847            ALL-CANCELS
 19848            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19849            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19850            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19851            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19852            MOVE PB-SV-STATE            TO PI-SV-STATE
 19853            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19854            GO TO 7100-DISPLAY-CANCELS.
 19855
 19856     GO TO 4505-READ-PREV-RECORD.
 19857
 19858 4550-END-RECORDS.
 19859     IF PI-MAP-NAME = EL631B
 19860        MOVE -1                  TO BMAINTL
 19861     ELSE
 19862        IF PI-MAP-NAME = EL631C
 19863           MOVE -1               TO CMAINTL
 19864        ELSE
 19865           MOVE -1               TO DPFENTRL.
 19866
 19867     MOVE ER-2255               TO EMI-ERROR.
 19868     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19869     GO TO 8200-SEND-DATAONLY.
 19870
 19871 4570-NOT-FOUND.
 19872
 19873******************************************************************
 19874*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19875******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 364
* EL6311.cbl
 19876
 19877
 19878* EXEC CICS RESETBR
 19879*         DATASET    (FILE-ID-ERPNDB2)
 19880*         RIDFLD     (ERPNDB-ALT-KEY)
 19881*    END-EXEC.
 19882     MOVE 0
 19883       TO DFHEIV11
 19884*    MOVE '&4         G          &   #00016954' TO DFHEIV0
 19885     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19886     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19887     MOVE X'2020233030303136393534' TO DFHEIV0(25:11)
 19888     CALL 'kxdfhei1' USING DFHEIV0,
 19889           FILE-ID-ERPNDB2,
 19890           ERPNDB-ALT-KEY,
 19891           DFHEIV99,
 19892           DFHEIV11,
 19893           DFHEIV99
 19894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19895
 19896
 19897
 19898* EXEC CICS READNEXT
 19899*         DATASET    (FILE-ID-ERPNDB2)
 19900*         SET        (ADDRESS OF PENDING-BUSINESS)
 19901*         RIDFLD     (ERPNDB-ALT-KEY)
 19902*    END-EXEC.
 19903     MOVE 0
 19904       TO DFHEIV11
 19905*    MOVE '&.S                   )   #00016959' TO DFHEIV0
 19906     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19907     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19908     MOVE X'2020233030303136393539' TO DFHEIV0(25:11)
 19909     CALL 'kxdfhei1' USING DFHEIV0,
 19910           FILE-ID-ERPNDB2,
 19911           DFHEIV20,
 19912           DFHEIV99,
 19913           ERPNDB-ALT-KEY,
 19914           DFHEIV99,
 19915           DFHEIV11,
 19916           DFHEIV99,
 19917           DFHEIV99
 19918     SET ADDRESS OF PENDING-BUSINESS TO
 19919         DFHEIV20
 19920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19921
 19922
 19923
 19924* EXEC CICS READPREV
 19925*         DATASET    (FILE-ID-ERPNDB2)
 19926*         SET        (ADDRESS OF PENDING-BUSINESS)
 19927*         RIDFLD     (ERPNDB-ALT-KEY)
 19928*    END-EXEC.
 19929     MOVE 0
 19930       TO DFHEIV11
 19931*    MOVE '&0S                   )   #00016965' TO DFHEIV0
 19932     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19933     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 365
* EL6311.cbl
 19934     MOVE X'2020233030303136393635' TO DFHEIV0(25:11)
 19935     CALL 'kxdfhei1' USING DFHEIV0,
 19936           FILE-ID-ERPNDB2,
 19937           DFHEIV20,
 19938           DFHEIV99,
 19939           ERPNDB-ALT-KEY,
 19940           DFHEIV99,
 19941           DFHEIV11,
 19942           DFHEIV99,
 19943           DFHEIV99
 19944     SET ADDRESS OF PENDING-BUSINESS TO
 19945         DFHEIV20
 19946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19947
 19948
 19949 4580-READ-PREV-RECORD.
 19950
 19951* EXEC CICS READPREV
 19952*         DATASET    (FILE-ID-ERPNDB2)
 19953*         SET        (ADDRESS OF PENDING-BUSINESS)
 19954*         RIDFLD     (ERPNDB-ALT-KEY)
 19955*    END-EXEC.
 19956     MOVE 0
 19957       TO DFHEIV11
 19958*    MOVE '&0S                   )   #00016972' TO DFHEIV0
 19959     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19960     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19961     MOVE X'2020233030303136393732' TO DFHEIV0(25:11)
 19962     CALL 'kxdfhei1' USING DFHEIV0,
 19963           FILE-ID-ERPNDB2,
 19964           DFHEIV20,
 19965           DFHEIV99,
 19966           ERPNDB-ALT-KEY,
 19967           DFHEIV99,
 19968           DFHEIV11,
 19969           DFHEIV99,
 19970           DFHEIV99
 19971     SET ADDRESS OF PENDING-BUSINESS TO
 19972         DFHEIV20
 19973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19974
 19975
 19976     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19977
 19978     IF WS-BATCH-PREFIX = '#CL'
 19979        GO TO 4580-READ-PREV-RECORD.
 19980
 19981     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 19982     GO TO 4505-READ-PREV-RECORD.
 19983
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 366
* EL6311.cbl
 19985
 19986******************************************************************
 19987*                                                                *
 19988*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 19989*                                                                *
 19990******************************************************************
 19991
 19992 4600-BROWSE-PRIMARY-BACKWARD.
 19993        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 19994
 19995     IF ERPNDB-BATCH-SEQ-NO = +9999
 19996        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 19997
 19998        IF ERPNDB-BATCH-SEQ-NO = +0000
 19999           GO TO 4650-END-BATCH
 20000        ELSE
 20001           IF PI-MAP-NAME NOT = EL631D
 20002              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20003                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 20004              ELSE
 20005                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 20006                 IF DISPLAY-CHANGE-RECORDS
 20007                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 20008                 ELSE
 20009                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 20010
 20011
 20012* EXEC CICS HANDLE CONDITION
 20013*         NOTFND    (4680-NOT-FOUND)
 20014*         ENDFILE   (4680-NOT-FOUND)
 20015*    END-EXEC.
 20016*    MOVE '"$I''                  ! O #00017013' TO DFHEIV0
 20017     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20018     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20019     MOVE X'4F20233030303137303133' TO DFHEIV0(25:11)
 20020     CALL 'kxdfhei1' USING DFHEIV0
 20021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20022
 20023
 20024 4605-READ-NEXT.
 20025     IF ERPNDB-BATCH-SEQ-NO = +0000
 20026        GO TO 4650-END-BATCH.
 20027
 20028     IF PI-DISPLAY-ORIGINAL-BATCH
 20029        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20030     ELSE
 20031        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20032
 20033
 20034* EXEC CICS READ
 20035*         DATASET   (FILE-ID)
 20036*         SET       (ADDRESS OF PENDING-BUSINESS)
 20037*         RIDFLD    (ERPNDB-KEY)
 20038*    END-EXEC.
 20039*    MOVE '&"S        E          (   #00017027' TO DFHEIV0
 20040     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20041     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20042     MOVE X'2020233030303137303237' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 367
* EL6311.cbl
 20043     CALL 'kxdfhei1' USING DFHEIV0,
 20044           FILE-ID,
 20045           DFHEIV20,
 20046           DFHEIV99,
 20047           ERPNDB-KEY,
 20048           DFHEIV99,
 20049           DFHEIV99,
 20050           DFHEIV99
 20051     SET ADDRESS OF PENDING-BUSINESS TO
 20052         DFHEIV20
 20053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20054
 20055
 20056     IF NOT  PI-PRIMARY-WITH-SELECT
 20057        GO TO 4607-CHECK-REC-TYPE.
 20058
 20059     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20060
 20061     IF  WS-BATCH-PREFIX = '#CL'
 20062         GO TO 4610-BUMP-SEQ.
 20063
 20064     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20065        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20066           GO TO 4610-BUMP-SEQ
 20067        ELSE
 20068           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20069              GO TO 4607-CHECK-REC-TYPE
 20070           ELSE
 20071              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20072                 GO TO 4607-CHECK-REC-TYPE
 20073              ELSE
 20074                 GO TO 4610-BUMP-SEQ.
 20075
 20076     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20077        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20078           GO TO 4610-BUMP-SEQ.
 20079
 20080 4607-CHECK-REC-TYPE.
 20081     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20082         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20083             NEXT SENTENCE
 20084         ELSE
 20085             GO TO 4610-BUMP-SEQ.
 20086
 20087     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20088         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20089             NEXT SENTENCE
 20090        ELSE
 20091             GO TO 4610-BUMP-SEQ.
 20092
 20093     IF NOT DISPLAY-CHANGE-RECORDS AND
 20094            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20095        GO TO 4610-BUMP-SEQ.
 20096
 20097     IF DISPLAY-HOLD-RECORDS AND
 20098        NOT PB-RECORD-ON-HOLD
 20099          GO TO 4610-BUMP-SEQ.
 20100
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 368
* EL6311.cbl
 20101     IF PB-ISSUE
 20102        IF DISPLAY-CHK-REQ-RECORDS
 20103           GO TO 4610-BUMP-SEQ.
 20104
 20105     IF PB-ISSUE
 20106        IF ISSUE-WITH-WARNING
 20107           IF PB-WARNING-ERRORS
 20108              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20109                  GO TO 4610-BUMP-SEQ
 20110              ELSE
 20111                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20112                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20113                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20114                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20115                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20116                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20117                 GO TO 7000-DISPLAY-ISSUES
 20118           ELSE
 20119              GO TO 4610-BUMP-SEQ.
 20120
 20121     IF PB-ISSUE
 20122        IF (ISSUES-IN-ERROR AND
 20123            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20124            ALL-ISSUES
 20125            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20126            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20127            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20128            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20129            MOVE PB-SV-STATE            TO PI-SV-STATE
 20130            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20131            GO TO 7000-DISPLAY-ISSUES
 20132        ELSE
 20133            GO TO 4610-BUMP-SEQ.
 20134
 20135     IF PB-CANCELLATION
 20136        IF DISPLAY-CHK-REQ-RECORDS
 20137           IF PB-C-REFUND-REQUESTED
 20138              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20139              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20140              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20141              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20142              MOVE PB-SV-STATE            TO PI-SV-STATE
 20143              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20144              GO TO 7100-DISPLAY-CANCELS
 20145           ELSE
 20146              GO TO 4610-BUMP-SEQ.
 20147
 20148     IF PB-CANCELLATION
 20149        IF CANCEL-WITH-WARNING
 20150           IF PB-WARNING-ERRORS
 20151              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20152                  GO TO 4610-BUMP-SEQ
 20153              ELSE
 20154                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20155                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20156                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20157                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20158                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 369
* EL6311.cbl
 20159                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20160                 GO TO 7100-DISPLAY-CANCELS
 20161           ELSE
 20162              GO TO 4610-BUMP-SEQ.
 20163
 20164     IF PB-CANCELLATION
 20165        IF (CANCEL-IN-ERROR  AND
 20166            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20167            ALL-CANCELS
 20168            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20169            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20170            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20171            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20172            MOVE PB-SV-STATE            TO PI-SV-STATE
 20173            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20174            GO TO 7100-DISPLAY-CANCELS.
 20175
 20176 4610-BUMP-SEQ.
 20177     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20178        GO TO 4650-END-BATCH.
 20179
 20180     IF DISPLAY-CHANGE-RECORDS
 20181        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20182           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20183        ELSE
 20184           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20185           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20186        ELSE
 20187           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20188           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20189
 20190        GO TO 4605-READ-NEXT.
 20191
 20192 4650-END-BATCH.
 20193     IF PI-MAP-NAME = EL631B
 20194        MOVE -1                  TO BMAINTL
 20195     ELSE
 20196        IF PI-MAP-NAME = EL631C
 20197           MOVE -1               TO CMAINTL
 20198        ELSE
 20199           MOVE -1               TO DPFENTRL.
 20200
 20201     MOVE ER-2252               TO EMI-ERROR.
 20202     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20203     GO TO 8200-SEND-DATAONLY.
 20204
 20205 4680-NOT-FOUND.
 20206     IF DISPLAY-CHANGE-RECORDS
 20207        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20208           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20209        ELSE
 20210           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20211           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20212     ELSE
 20213        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20214
 20215     GO TO 4605-READ-NEXT.
 20216
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 370
* EL6311.cbl
 20218
 20219******************************************************************
 20220*                                                                *
 20221*        B R O W S E   F I L E   B A C K W A R D S               *
 20222*                                                                *
 20223******************************************************************
 20224
 20225 4800-BROWSE-FILE-BACKWARD.
 20226
 20227* EXEC CICS HANDLE CONDITION
 20228*         NOTFND   (4860-NOT-FOUND)
 20229*         ENDFILE  (4850-END-RECORDS)
 20230*    END-EXEC.
 20231*    MOVE '"$I''                  ! P #00017203' TO DFHEIV0
 20232     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20233     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20234     MOVE X'5020233030303137323033' TO DFHEIV0(25:11)
 20235     CALL 'kxdfhei1' USING DFHEIV0
 20236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20237
 20238
 20239     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20240
 20241     IF PI-DISPLAY-ORIGINAL-BATCH
 20242        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20243     ELSE
 20244        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20245
 20246
 20247* EXEC CICS STARTBR
 20248*         DATASET   (FILE-ID)
 20249*         RIDFLD    (ERPNDB-KEY)
 20250*    END-EXEC.
 20251     MOVE 0
 20252       TO DFHEIV11
 20253*    MOVE '&,         G          &   #00017215' TO DFHEIV0
 20254     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20255     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20256     MOVE X'2020233030303137323135' TO DFHEIV0(25:11)
 20257     CALL 'kxdfhei1' USING DFHEIV0,
 20258           FILE-ID,
 20259           ERPNDB-KEY,
 20260           DFHEIV99,
 20261           DFHEIV11,
 20262           DFHEIV99
 20263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20264
 20265
 20266     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20267
 20268
 20269* EXEC CICS READPREV
 20270*         DATASET    (FILE-ID-ERPNDB)
 20271*         SET        (ADDRESS OF PENDING-BUSINESS)
 20272*         RIDFLD     (ERPNDB-KEY)
 20273*    END-EXEC.
 20274     MOVE 0
 20275       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 371
* EL6311.cbl
 20276*    MOVE '&0S                   )   #00017222' TO DFHEIV0
 20277     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20278     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20279     MOVE X'2020233030303137323232' TO DFHEIV0(25:11)
 20280     CALL 'kxdfhei1' USING DFHEIV0,
 20281           FILE-ID-ERPNDB,
 20282           DFHEIV20,
 20283           DFHEIV99,
 20284           ERPNDB-KEY,
 20285           DFHEIV99,
 20286           DFHEIV11,
 20287           DFHEIV99,
 20288           DFHEIV99
 20289     SET ADDRESS OF PENDING-BUSINESS TO
 20290         DFHEIV20
 20291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20292
 20293
 20294 4810-READ-PREV-RECORD.
 20295
 20296* EXEC CICS READPREV
 20297*         DATASET    (FILE-ID-ERPNDB)
 20298*         SET        (ADDRESS OF PENDING-BUSINESS)
 20299*         RIDFLD     (ERPNDB-KEY)
 20300*    END-EXEC.
 20301     MOVE 0
 20302       TO DFHEIV11
 20303*    MOVE '&0S                   )   #00017229' TO DFHEIV0
 20304     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20305     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20306     MOVE X'2020233030303137323239' TO DFHEIV0(25:11)
 20307     CALL 'kxdfhei1' USING DFHEIV0,
 20308           FILE-ID-ERPNDB,
 20309           DFHEIV20,
 20310           DFHEIV99,
 20311           ERPNDB-KEY,
 20312           DFHEIV99,
 20313           DFHEIV11,
 20314           DFHEIV99,
 20315           DFHEIV99
 20316     SET ADDRESS OF PENDING-BUSINESS TO
 20317         DFHEIV20
 20318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20319
 20320
 20321     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20322        GO TO 4850-END-RECORDS.
 20323
 20324     IF PB-BATCH-TRAILER
 20325        GO TO 4810-READ-PREV-RECORD.
 20326
 20327     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20328
 20329     IF  WS-BATCH-PREFIX = '#CL'
 20330         GO TO 4810-READ-PREV-RECORD.
 20331
 20332     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20333        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 372
* EL6311.cbl
 20334           GO TO 4810-READ-PREV-RECORD
 20335        ELSE
 20336           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20337              GO TO 4820-CHECK-REC-TYPE
 20338           ELSE
 20339              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20340                 GO TO 4820-CHECK-REC-TYPE
 20341              ELSE
 20342                 GO TO 4810-READ-PREV-RECORD.
 20343
 20344     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20345        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20346           GO TO 4810-READ-PREV-RECORD.
 20347
 20348 4820-CHECK-REC-TYPE.
 20349     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20350         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20351             NEXT SENTENCE
 20352         ELSE
 20353             GO TO 4810-READ-PREV-RECORD.
 20354
 20355     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20356         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20357             NEXT SENTENCE
 20358        ELSE
 20359             GO TO 4810-READ-PREV-RECORD.
 20360
 20361     IF NOT DISPLAY-CHANGE-RECORDS AND
 20362            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20363        GO TO 4810-READ-PREV-RECORD.
 20364
 20365     IF DISPLAY-HOLD-RECORDS AND
 20366        NOT PB-RECORD-ON-HOLD
 20367          GO TO 4810-READ-PREV-RECORD.
 20368
 20369     IF PB-ISSUE
 20370        IF DISPLAY-CHK-REQ-RECORDS
 20371           GO TO 4810-READ-PREV-RECORD.
 20372
 20373     IF PB-ISSUE
 20374        IF ISSUE-WITH-WARNING
 20375           IF PB-WARNING-ERRORS
 20376              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20377                  GO TO 4810-READ-PREV-RECORD
 20378              ELSE
 20379                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20380                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20381                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20382                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20383                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20384                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20385                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20386                 GO TO 7000-DISPLAY-ISSUES
 20387           ELSE
 20388              GO TO 4810-READ-PREV-RECORD.
 20389
 20390     IF PB-ISSUE
 20391        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 373
* EL6311.cbl
 20392            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20393            ALL-ISSUES
 20394            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20395            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20396            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20397            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20398            MOVE PB-SV-STATE            TO PI-SV-STATE
 20399            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20400            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20401            GO TO 7000-DISPLAY-ISSUES
 20402        ELSE
 20403            GO TO 4810-READ-PREV-RECORD.
 20404
 20405     IF PB-CANCELLATION
 20406        IF DISPLAY-CHK-REQ-RECORDS
 20407           IF PB-C-REFUND-REQUESTED
 20408              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20409              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20410              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20411              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20412              MOVE PB-SV-STATE            TO PI-SV-STATE
 20413              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20414              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20415              GO TO 7100-DISPLAY-CANCELS
 20416           ELSE
 20417              GO TO 4810-READ-PREV-RECORD.
 20418
 20419     IF PB-CANCELLATION
 20420        IF CANCEL-WITH-WARNING
 20421           IF PB-WARNING-ERRORS
 20422              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20423                  GO TO 4810-READ-PREV-RECORD
 20424              ELSE
 20425                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20426                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20427                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20428                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20429                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20430                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20431                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20432                 GO TO 7100-DISPLAY-CANCELS
 20433           ELSE
 20434              GO TO 4810-READ-PREV-RECORD.
 20435
 20436     IF PB-CANCELLATION
 20437        IF (CANCEL-IN-ERROR  AND
 20438            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20439            ALL-CANCELS
 20440            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20441            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20442            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20443            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20444            MOVE PB-SV-STATE            TO PI-SV-STATE
 20445            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20446            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20447            GO TO 7100-DISPLAY-CANCELS.
 20448
 20449     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 374
* EL6311.cbl
 20450
 20451 4850-END-RECORDS.
 20452     MOVE ER-2252                TO EMI-ERROR.
 20453     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20454
 20455     IF PI-MAP-NAME = EL631B
 20456        MOVE -1                  TO BPFENTRL
 20457     ELSE
 20458        MOVE -1                  TO CPFENTRL.
 20459
 20460     GO TO 8200-SEND-DATAONLY.
 20461
 20462 4860-NOT-FOUND.
 20463
 20464******************************************************************
 20465*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20466******************************************************************
 20467
 20468
 20469* EXEC CICS RESETBR
 20470*         DATASET    (FILE-ID-ERPNDB)
 20471*         RIDFLD     (ERPNDB-KEY)
 20472*     END-EXEC.
 20473     MOVE 0
 20474       TO DFHEIV11
 20475*    MOVE '&4         G          &   #00017382' TO DFHEIV0
 20476     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20477     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20478     MOVE X'2020233030303137333832' TO DFHEIV0(25:11)
 20479     CALL 'kxdfhei1' USING DFHEIV0,
 20480           FILE-ID-ERPNDB,
 20481           ERPNDB-KEY,
 20482           DFHEIV99,
 20483           DFHEIV11,
 20484           DFHEIV99
 20485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20486
 20487
 20488
 20489* EXEC CICS READNEXT
 20490*         DATASET    (FILE-ID-ERPNDB)
 20491*         SET        (ADDRESS OF PENDING-BUSINESS)
 20492*         RIDFLD     (ERPNDB-KEY)
 20493*    END-EXEC.
 20494     MOVE 0
 20495       TO DFHEIV11
 20496*    MOVE '&.S                   )   #00017387' TO DFHEIV0
 20497     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20498     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20499     MOVE X'2020233030303137333837' TO DFHEIV0(25:11)
 20500     CALL 'kxdfhei1' USING DFHEIV0,
 20501           FILE-ID-ERPNDB,
 20502           DFHEIV20,
 20503           DFHEIV99,
 20504           ERPNDB-KEY,
 20505           DFHEIV99,
 20506           DFHEIV11,
 20507           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 375
* EL6311.cbl
 20508           DFHEIV99
 20509     SET ADDRESS OF PENDING-BUSINESS TO
 20510         DFHEIV20
 20511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20512
 20513
 20514
 20515* EXEC CICS READPREV
 20516*         DATASET    (FILE-ID-ERPNDB)
 20517*         SET        (ADDRESS OF PENDING-BUSINESS)
 20518*         RIDFLD     (ERPNDB-KEY)
 20519*    END-EXEC.
 20520     MOVE 0
 20521       TO DFHEIV11
 20522*    MOVE '&0S                   )   #00017393' TO DFHEIV0
 20523     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20524     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20525     MOVE X'2020233030303137333933' TO DFHEIV0(25:11)
 20526     CALL 'kxdfhei1' USING DFHEIV0,
 20527           FILE-ID-ERPNDB,
 20528           DFHEIV20,
 20529           DFHEIV99,
 20530           ERPNDB-KEY,
 20531           DFHEIV99,
 20532           DFHEIV11,
 20533           DFHEIV99,
 20534           DFHEIV99
 20535     SET ADDRESS OF PENDING-BUSINESS TO
 20536         DFHEIV20
 20537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20538
 20539
 20540     GO TO 4810-READ-PREV-RECORD.
 20541
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 376
* EL6311.cbl
 20543
 20544******************************************************************
 20545*                                                                *
 20546*           B R O W S E   C S R   B A C K W A R D                *
 20547*                                                                *
 20548******************************************************************
 20549
 20550 4900-BROWSE-CSR-BACKWARD.
 20551
 20552     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20553
 20554
 20555* EXEC CICS HANDLE CONDITION
 20556*         NOTFND   (4970-NOT-FOUND)
 20557*         ENDFILE  (4950-END-RECORDS)
 20558*    END-EXEC
 20559*    MOVE '"$I''                  ! Q #00017413' TO DFHEIV0
 20560     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20561     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20562     MOVE X'5120233030303137343133' TO DFHEIV0(25:11)
 20563     CALL 'kxdfhei1' USING DFHEIV0
 20564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20565
 20566
 20567* EXEC CICS STARTBR
 20568*         DATASET   (FILE-ID-ERPNDB4)
 20569*         RIDFLD    (ERPNDB-CSR-KEY)
 20570*    END-EXEC.
 20571     MOVE 0
 20572       TO DFHEIV11
 20573*    MOVE '&,         G          &   #00017418' TO DFHEIV0
 20574     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20575     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20576     MOVE X'2020233030303137343138' TO DFHEIV0(25:11)
 20577     CALL 'kxdfhei1' USING DFHEIV0,
 20578           FILE-ID-ERPNDB4,
 20579           ERPNDB-CSR-KEY,
 20580           DFHEIV99,
 20581           DFHEIV11,
 20582           DFHEIV99
 20583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20584
 20585
 20586     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20587                                    WS-FIRST-TIME-SW.
 20588
 20589 4905-READ-PREV-RECORD.
 20590
 20591* EXEC CICS READPREV
 20592*         DATASET    (FILE-ID-ERPNDB4)
 20593*         SET        (ADDRESS OF PENDING-BUSINESS)
 20594*         RIDFLD     (ERPNDB-CSR-KEY)
 20595*    END-EXEC.
 20596     MOVE 0
 20597       TO DFHEIV11
 20598*    MOVE '&0S                   )   #00017427' TO DFHEIV0
 20599     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20600     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 377
* EL6311.cbl
 20601     MOVE X'2020233030303137343237' TO DFHEIV0(25:11)
 20602     CALL 'kxdfhei1' USING DFHEIV0,
 20603           FILE-ID-ERPNDB4,
 20604           DFHEIV20,
 20605           DFHEIV99,
 20606           ERPNDB-CSR-KEY,
 20607           DFHEIV99,
 20608           DFHEIV11,
 20609           DFHEIV99,
 20610           DFHEIV99
 20611     SET ADDRESS OF PENDING-BUSINESS TO
 20612         DFHEIV20
 20613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20614
 20615
 20616     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20617
 20618     IF WS-BATCH-PREFIX = '#CL'
 20619         GO TO 4905-READ-PREV-RECORD.
 20620
 20621     IF FIRST-TIME
 20622         MOVE SPACE               TO WS-FIRST-TIME-SW
 20623         GO TO 4905-READ-PREV-RECORD.
 20624
 20625     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20626        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20627        GO TO 4950-END-RECORDS.
 20628
 20629     IF PB-BATCH-TRAILER
 20630        GO TO 4905-READ-PREV-RECORD.
 20631
 20632     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20633
 20634     IF  WS-BATCH-PREFIX = '#CL'
 20635         GO TO 4905-READ-PREV-RECORD.
 20636
 20637     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20638        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20639           GO TO 4905-READ-PREV-RECORD
 20640        ELSE
 20641           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20642              GO TO 4910-CHECK-REC-TYPE
 20643           ELSE
 20644              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20645                 GO TO 4910-CHECK-REC-TYPE
 20646              ELSE
 20647                 GO TO 4905-READ-PREV-RECORD.
 20648
 20649     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20650        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20651           GO TO 4905-READ-PREV-RECORD.
 20652
 20653 4910-CHECK-REC-TYPE.
 20654     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20655         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20656             NEXT SENTENCE
 20657         ELSE
 20658             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 378
* EL6311.cbl
 20659
 20660     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20661         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20662             NEXT SENTENCE
 20663        ELSE
 20664             GO TO 4905-READ-PREV-RECORD.
 20665
 20666     IF NOT DISPLAY-CHANGE-RECORDS AND
 20667            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20668        GO TO 4905-READ-PREV-RECORD.
 20669
 20670     IF DISPLAY-HOLD-RECORDS AND
 20671        NOT PB-RECORD-ON-HOLD
 20672          GO TO 4905-READ-PREV-RECORD.
 20673
 20674     IF PB-ISSUE
 20675        IF DISPLAY-CHK-REQ-RECORDS
 20676           GO TO 4905-READ-PREV-RECORD.
 20677
 20678     IF PB-ISSUE
 20679        IF ISSUE-WITH-WARNING
 20680           IF PB-WARNING-ERRORS
 20681              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20682                  GO TO 4505-READ-PREV-RECORD
 20683              ELSE
 20684                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20685                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20686                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20687                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20688                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20689                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20690                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20691                 GO TO 7000-DISPLAY-ISSUES
 20692           ELSE
 20693              GO TO 4905-READ-PREV-RECORD.
 20694
 20695     IF PB-ISSUE
 20696        IF (ISSUES-IN-ERROR AND
 20697            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20698            ALL-ISSUES
 20699            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20700            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20701            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20702            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20703            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20704            MOVE PB-SV-STATE            TO PI-SV-STATE
 20705            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20706            GO TO 7000-DISPLAY-ISSUES
 20707        ELSE
 20708            GO TO 4905-READ-PREV-RECORD.
 20709
 20710     IF PB-CANCELLATION
 20711        IF DISPLAY-CHK-REQ-RECORDS
 20712           IF PB-C-REFUND-REQUESTED
 20713              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20714              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20715              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20716              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 379
* EL6311.cbl
 20717              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20718              MOVE PB-SV-STATE            TO PI-SV-STATE
 20719              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20720              GO TO 7100-DISPLAY-CANCELS
 20721           ELSE
 20722              GO TO 4905-READ-PREV-RECORD.
 20723
 20724     IF PB-CANCELLATION
 20725        IF CANCEL-WITH-WARNING
 20726           IF PB-WARNING-ERRORS
 20727              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20728                  GO TO 4505-READ-PREV-RECORD
 20729              ELSE
 20730                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20731                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20732                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20733                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20734                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20735                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20736                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20737                 GO TO 7100-DISPLAY-CANCELS
 20738           ELSE
 20739              GO TO 4905-READ-PREV-RECORD.
 20740
 20741     IF PB-CANCELLATION
 20742        IF (CANCEL-IN-ERROR  AND
 20743            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20744            ALL-CANCELS
 20745            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20746            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20747            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20748            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20749            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20750            MOVE PB-SV-STATE            TO PI-SV-STATE
 20751            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20752            GO TO 7100-DISPLAY-CANCELS.
 20753
 20754     GO TO 4905-READ-PREV-RECORD.
 20755
 20756 4950-END-RECORDS.
 20757     IF PI-MAP-NAME = EL631B
 20758        MOVE -1                  TO BMAINTL
 20759     ELSE
 20760        IF PI-MAP-NAME = EL631C
 20761           MOVE -1               TO CMAINTL
 20762        ELSE
 20763           MOVE -1               TO DPFENTRL.
 20764
 20765     MOVE ER-2255               TO EMI-ERROR.
 20766     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20767     GO TO 8200-SEND-DATAONLY.
 20768
 20769 4970-NOT-FOUND.
 20770
 20771******************************************************************
 20772*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20773******************************************************************
 20774
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 380
* EL6311.cbl
 20775
 20776* EXEC CICS RESETBR
 20777*         DATASET    (FILE-ID-ERPNDB4)
 20778*         RIDFLD     (ERPNDB-CSR-KEY)
 20779*    END-EXEC.
 20780     MOVE 0
 20781       TO DFHEIV11
 20782*    MOVE '&4         G          &   #00017592' TO DFHEIV0
 20783     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20784     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20785     MOVE X'2020233030303137353932' TO DFHEIV0(25:11)
 20786     CALL 'kxdfhei1' USING DFHEIV0,
 20787           FILE-ID-ERPNDB4,
 20788           ERPNDB-CSR-KEY,
 20789           DFHEIV99,
 20790           DFHEIV11,
 20791           DFHEIV99
 20792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20793
 20794
 20795
 20796* EXEC CICS READNEXT
 20797*         DATASET    (FILE-ID-ERPNDB4)
 20798*         SET        (ADDRESS OF PENDING-BUSINESS)
 20799*         RIDFLD     (ERPNDB-CSR-KEY)
 20800*    END-EXEC.
 20801     MOVE 0
 20802       TO DFHEIV11
 20803*    MOVE '&.S                   )   #00017597' TO DFHEIV0
 20804     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20805     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20806     MOVE X'2020233030303137353937' TO DFHEIV0(25:11)
 20807     CALL 'kxdfhei1' USING DFHEIV0,
 20808           FILE-ID-ERPNDB4,
 20809           DFHEIV20,
 20810           DFHEIV99,
 20811           ERPNDB-CSR-KEY,
 20812           DFHEIV99,
 20813           DFHEIV11,
 20814           DFHEIV99,
 20815           DFHEIV99
 20816     SET ADDRESS OF PENDING-BUSINESS TO
 20817         DFHEIV20
 20818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20819
 20820
 20821
 20822* EXEC CICS READPREV
 20823*         DATASET    (FILE-ID-ERPNDB4)
 20824*         SET        (ADDRESS OF PENDING-BUSINESS)
 20825*         RIDFLD     (ERPNDB-CSR-KEY)
 20826*    END-EXEC.
 20827     MOVE 0
 20828       TO DFHEIV11
 20829*    MOVE '&0S                   )   #00017603' TO DFHEIV0
 20830     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20831     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20832     MOVE X'2020233030303137363033' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 381
* EL6311.cbl
 20833     CALL 'kxdfhei1' USING DFHEIV0,
 20834           FILE-ID-ERPNDB4,
 20835           DFHEIV20,
 20836           DFHEIV99,
 20837           ERPNDB-CSR-KEY,
 20838           DFHEIV99,
 20839           DFHEIV11,
 20840           DFHEIV99,
 20841           DFHEIV99
 20842     SET ADDRESS OF PENDING-BUSINESS TO
 20843         DFHEIV20
 20844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20845
 20846
 20847 4980-READ-PREV-RECORD.
 20848
 20849* EXEC CICS READPREV
 20850*         DATASET    (FILE-ID-ERPNDB4)
 20851*         SET        (ADDRESS OF PENDING-BUSINESS)
 20852*         RIDFLD     (ERPNDB-CSR-KEY)
 20853*    END-EXEC.
 20854     MOVE 0
 20855       TO DFHEIV11
 20856*    MOVE '&0S                   )   #00017610' TO DFHEIV0
 20857     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20858     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20859     MOVE X'2020233030303137363130' TO DFHEIV0(25:11)
 20860     CALL 'kxdfhei1' USING DFHEIV0,
 20861           FILE-ID-ERPNDB4,
 20862           DFHEIV20,
 20863           DFHEIV99,
 20864           ERPNDB-CSR-KEY,
 20865           DFHEIV99,
 20866           DFHEIV11,
 20867           DFHEIV99,
 20868           DFHEIV99
 20869     SET ADDRESS OF PENDING-BUSINESS TO
 20870         DFHEIV20
 20871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20872
 20873
 20874     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20875
 20876     IF WS-BATCH-PREFIX = '#CL'
 20877        GO TO 4980-READ-PREV-RECORD.
 20878
 20879     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20880     GO TO 4905-READ-PREV-RECORD.
 20881
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 382
* EL6311.cbl
 20883
 20884
 20885******************************************************************
 20886*                                                                *
 20887*        B R O W S E   B A T C H   H E A D E R S                 *
 20888*                                                                *
 20889******************************************************************
 20890
 20891 5000-BROWSE-BATCH-HEADERS.
 20892
 20893     IF EIBTRNID NOT = TRANS-EXB1
 20894        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 20895        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20896        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20897        GO TO 5010-READ-NEXT-RECORD.
 20898
 20899     IF EIBAID = DFHPF4
 20900        MOVE '0'                TO PI-EDIT-SW
 20901        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 20902        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20903        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20904        GO TO 5010-READ-NEXT-RECORD.
 20905
 20906     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20907     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 20908     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20909
 20910
 20911* EXEC CICS HANDLE CONDITION
 20912*         ENDFILE  (5050-NOT-FOUND)
 20913*    END-EXEC.
 20914*    MOVE '"$''                   ! R #00017652' TO DFHEIV0
 20915     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 20916     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20917     MOVE X'5220233030303137363532' TO DFHEIV0(25:11)
 20918     CALL 'kxdfhei1' USING DFHEIV0
 20919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20920
 20921
 20922 5010-READ-NEXT-RECORD.
 20923
 20924* EXEC CICS HANDLE CONDITION
 20925*         NOTFND    (5050-NOT-FOUND)
 20926*    END-EXEC.
 20927*    MOVE '"$I                   ! S #00017657' TO DFHEIV0
 20928     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20929     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20930     MOVE X'5320233030303137363537' TO DFHEIV0(25:11)
 20931     CALL 'kxdfhei1' USING DFHEIV0
 20932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20933
 20934
 20935
 20936* EXEC CICS READ
 20937*         DATASET   (FILE-ID-ERPNDB)
 20938*         SET       (ADDRESS OF PENDING-BUSINESS)
 20939*         RIDFLD    (ERPNDB-KEY)
 20940*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 383
* EL6311.cbl
 20941*    END-EXEC.
 20942*    MOVE '&"S        G          (   #00017661' TO DFHEIV0
 20943     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20944     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20945     MOVE X'2020233030303137363631' TO DFHEIV0(25:11)
 20946     CALL 'kxdfhei1' USING DFHEIV0,
 20947           FILE-ID-ERPNDB,
 20948           DFHEIV20,
 20949           DFHEIV99,
 20950           ERPNDB-KEY,
 20951           DFHEIV99,
 20952           DFHEIV99,
 20953           DFHEIV99
 20954     SET ADDRESS OF PENDING-BUSINESS TO
 20955         DFHEIV20
 20956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20957
 20958
 20959     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 20960         GO TO 5050-NOT-FOUND.
 20961
 20962     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20963
 20964     IF WS-BATCH-PREFIX = '#CL'
 20965         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20966         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 20967         GO TO 5010-READ-NEXT-RECORD.
 20968
 20969     IF NOT PB-BATCH-TRAILER
 20970         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20971         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 20972         GO TO 5010-READ-NEXT-RECORD.
 20973
 20974     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20975         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20976             NEXT SENTENCE
 20977         ELSE
 20978             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 20979             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20980             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20981             GO TO 5010-READ-NEXT-RECORD.
 20982
 20983     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20984         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20985             NEXT SENTENCE
 20986        ELSE
 20987             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20988             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20989             GO TO 5010-READ-NEXT-RECORD.
 20990
 20991     IF EIBAID = DFHPF4
 20992        MOVE '0'                TO PI-EDIT-SW
 20993        GO TO 7200-DISPLAY-BATCHES.
 20994
 20995     IF PI-CSR-BROWSE
 20996        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20997           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20998           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 384
* EL6311.cbl
 20999           GO TO 5010-READ-NEXT-RECORD.
 21000
 21001     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21002       IF PI-PB-CARRIER    = SPACES AND
 21003          PI-PB-GROUPING   = SPACES AND
 21004          PI-PB-STATE      = SPACES AND
 21005          PI-PB-ACCOUNT    = SPACES
 21006            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21007            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21008            GO TO 7200-DISPLAY-BATCHES
 21009         ELSE
 21010           IF PI-PB-CARRIER    = PB-CARRIER  AND
 21011              PI-PB-GROUPING   = PB-GROUPING AND
 21012              PI-PB-STATE      = PB-STATE    AND
 21013              PI-PB-ACCOUNT    = PB-ACCOUNT
 21014              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21015              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21016              GO TO 7200-DISPLAY-BATCHES.
 21017
 21018     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21019     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21020
 21021
 21022* EXEC CICS HANDLE CONDITION
 21023*         NOTFND    (5050-NOT-FOUND)
 21024*    END-EXEC.
 21025*    MOVE '"$I                   ! T #00017730' TO DFHEIV0
 21026     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21027     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21028     MOVE X'5420233030303137373330' TO DFHEIV0(25:11)
 21029     CALL 'kxdfhei1' USING DFHEIV0
 21030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21031
 21032
 21033
 21034* EXEC CICS READ
 21035*         DATASET   (FILE-ID-ERPNDB)
 21036*         SET       (ADDRESS OF PENDING-BUSINESS)
 21037*         RIDFLD    (ERPNDB-KEY)
 21038*         GTEQ
 21039*    END-EXEC.
 21040*    MOVE '&"S        G          (   #00017734' TO DFHEIV0
 21041     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21042     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21043     MOVE X'2020233030303137373334' TO DFHEIV0(25:11)
 21044     CALL 'kxdfhei1' USING DFHEIV0,
 21045           FILE-ID-ERPNDB,
 21046           DFHEIV20,
 21047           DFHEIV99,
 21048           ERPNDB-KEY,
 21049           DFHEIV99,
 21050           DFHEIV99,
 21051           DFHEIV99
 21052     SET ADDRESS OF PENDING-BUSINESS TO
 21053         DFHEIV20
 21054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21055
 21056
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 385
* EL6311.cbl
 21057     GO TO 5010-READ-NEXT-RECORD.
 21058
 21059 5050-NOT-FOUND.
 21060
 21061******************************************************************
 21062*                                                                *
 21063*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21064*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21065*         PROGRAM.                                               *
 21066*                                                                *
 21067******************************************************************
 21068
 21069     IF EIBTRNID NOT = TRANS-EXB1
 21070        IF PENDING-BUS-RECS-FOUND
 21071            NEXT SENTENCE
 21072          ELSE
 21073            MOVE '9'            TO PI-BROWSE-SW
 21074            GO TO 9400-CLEAR.
 21075
 21076     MOVE ER-2256                TO EMI-ERROR.
 21077     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21078
 21079     IF PI-MAP-NAME = SPACES
 21080        MOVE EL631D              TO PI-MAP-NAME
 21081        MOVE -1                  TO DPFENTRL
 21082        GO TO 8100-SEND-INITIAL-MAP.
 21083
 21084     IF PI-MAP-NAME = EL631B
 21085        MOVE -1                  TO BMAINTL
 21086     ELSE
 21087        IF PI-MAP-NAME = EL631C
 21088           MOVE -1               TO CMAINTL
 21089        ELSE
 21090           MOVE -1               TO DPFENTRL
 21091           GO TO 8200-SEND-DATAONLY.
 21092
 21093     GO TO 8100-SEND-INITIAL-MAP.
 21094
 21095     .
 21096 5100-PROCESS-POL-RESC.
 21097     MOVE ZEROS                  TO CG-LF-BENCD
 21098                                    CG-AH-BENCD
 21099                                    CG-LF-CAN-AMT
 21100                                    CG-AH-CAN-AMT
 21101     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21102                                    CG-AH-CAN-DT
 21103     MOVE SPACES                 TO CG-BATCH-NO
 21104     MOVE '4'                    TO CG-OPTION-CODE
 21105     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21106     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21107     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21108     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21109     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21110     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21111     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21112     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21113     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21114     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 386
* EL6311.cbl
 21115     MOVE PI-PREV-ALT-KEY (1:33)
 21116                                 TO CG-CERT-KEY
 21117     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21118     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21119                                    CG-AH-CAN-AMT
 21120     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21121                                    CG-AH-CAN-DT
 21122     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21123     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21124      display 'about to cancel ' cg-cert-key
 21125
 21126* EXEC CICS LINK
 21127*        PROGRAM  ('ELCANC')
 21128*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21129*    END-EXEC
 21130     MOVE LENGTH OF
 21131      CANCEL-GEN-PASS-AREA
 21132       TO DFHEIV11
 21133     MOVE 'ELCANC' TO DFHEIV1
 21134*    MOVE '."C                   (   #00017809' TO DFHEIV0
 21135     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21136     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21137     MOVE X'2020233030303137383039' TO DFHEIV0(25:11)
 21138     CALL 'kxdfhei1' USING DFHEIV0,
 21139           DFHEIV1,
 21140           CANCEL-GEN-PASS-AREA,
 21141           DFHEIV11,
 21142           DFHEIV99,
 21143           DFHEIV99,
 21144           DFHEIV99,
 21145           DFHEIV99
 21146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21147     IF CG-SUCCESS
 21148        CONTINUE
 21149     ELSE
 21150        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21151        MOVE '3'                 TO EMI-SWITCH1
 21152        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21153        EVALUATE TRUE
 21154           WHEN CG-DATE-ERROR
 21155             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21156           WHEN CG-CERT-NOT-FOUND
 21157             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21158           WHEN CG-AMOUNT-ERROR
 21159             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21160           WHEN CG-OPTION-ERROR
 21161             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21162           WHEN CG-PREV-CAN
 21163             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21164           WHEN CG-INVALID-DATA
 21165             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21166           WHEN CG-NO-ACCT-MSTR
 21167             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21168           WHEN CG-SFX-A-EXIST
 21169             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21170           WHEN CG-MISC-ERROR
 21171             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21172           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 387
* EL6311.cbl
 21173             MOVE ' ERROR - ELCANC - RETURN '
 21174                                 TO EMI-ERROR-TEXT (1) (12:25)
 21175        END-EVALUATE
 21176        GO TO 8200-SEND-DATAONLY
 21177     END-IF
 21178     .
 21179 5100-EXIT.
 21180     EXIT.
 21181
 21182******************************************************************
 21183*                                                                *
 21184*        B R O W S E   B A T C H   B A C K W A R D S             *
 21185*                                                                *
 21186******************************************************************
 21187
 21188 5500-BROWSE-BATCH-BACKWARD.
 21189
 21190* EXEC CICS HANDLE CONDITION
 21191*         NOTFND   (5550-END-RECORDS)
 21192*         ENDFILE  (5550-END-RECORDS)
 21193*    END-EXEC.
 21194*    MOVE '"$I''                  ! U #00017855' TO DFHEIV0
 21195     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21196     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21197     MOVE X'5520233030303137383535' TO DFHEIV0(25:11)
 21198     CALL 'kxdfhei1' USING DFHEIV0
 21199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21200
 21201
 21202 5505-START-BROWSE.
 21203     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21204     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21205     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21206
 21207
 21208* EXEC CICS STARTBR
 21209*         DATASET   (FILE-ID-ERPNDB)
 21210*         RIDFLD    (ERPNDB-ALT-KEY)
 21211*    END-EXEC.
 21212     MOVE 0
 21213       TO DFHEIV11
 21214*    MOVE '&,         G          &   #00017865' TO DFHEIV0
 21215     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21216     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21217     MOVE X'2020233030303137383635' TO DFHEIV0(25:11)
 21218     CALL 'kxdfhei1' USING DFHEIV0,
 21219           FILE-ID-ERPNDB,
 21220           ERPNDB-ALT-KEY,
 21221           DFHEIV99,
 21222           DFHEIV11,
 21223           DFHEIV99
 21224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21225
 21226
 21227     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21228
 21229
 21230* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 388
* EL6311.cbl
 21231*         DATASET    (FILE-ID-ERPNDB)
 21232*         SET        (ADDRESS OF PENDING-BUSINESS)
 21233*         RIDFLD     (ERPNDB-KEY)
 21234*    END-EXEC.
 21235     MOVE 0
 21236       TO DFHEIV11
 21237*    MOVE '&.S                   )   #00017872' TO DFHEIV0
 21238     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21239     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21240     MOVE X'2020233030303137383732' TO DFHEIV0(25:11)
 21241     CALL 'kxdfhei1' USING DFHEIV0,
 21242           FILE-ID-ERPNDB,
 21243           DFHEIV20,
 21244           DFHEIV99,
 21245           ERPNDB-KEY,
 21246           DFHEIV99,
 21247           DFHEIV11,
 21248           DFHEIV99,
 21249           DFHEIV99
 21250     SET ADDRESS OF PENDING-BUSINESS TO
 21251         DFHEIV20
 21252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21253
 21254
 21255
 21256* EXEC CICS READPREV
 21257*         DATASET    (FILE-ID-ERPNDB)
 21258*         SET        (ADDRESS OF PENDING-BUSINESS)
 21259*         RIDFLD     (ERPNDB-KEY)
 21260*    END-EXEC.
 21261     MOVE 0
 21262       TO DFHEIV11
 21263*    MOVE '&0S                   )   #00017878' TO DFHEIV0
 21264     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21265     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21266     MOVE X'2020233030303137383738' TO DFHEIV0(25:11)
 21267     CALL 'kxdfhei1' USING DFHEIV0,
 21268           FILE-ID-ERPNDB,
 21269           DFHEIV20,
 21270           DFHEIV99,
 21271           ERPNDB-KEY,
 21272           DFHEIV99,
 21273           DFHEIV11,
 21274           DFHEIV99,
 21275           DFHEIV99
 21276     SET ADDRESS OF PENDING-BUSINESS TO
 21277         DFHEIV20
 21278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21279
 21280
 21281
 21282* EXEC CICS READPREV
 21283*         DATASET    (FILE-ID-ERPNDB)
 21284*         SET        (ADDRESS OF PENDING-BUSINESS)
 21285*         RIDFLD     (ERPNDB-KEY)
 21286*    END-EXEC.
 21287     MOVE 0
 21288       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 389
* EL6311.cbl
 21289*    MOVE '&0S                   )   #00017884' TO DFHEIV0
 21290     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21291     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21292     MOVE X'2020233030303137383834' TO DFHEIV0(25:11)
 21293     CALL 'kxdfhei1' USING DFHEIV0,
 21294           FILE-ID-ERPNDB,
 21295           DFHEIV20,
 21296           DFHEIV99,
 21297           ERPNDB-KEY,
 21298           DFHEIV99,
 21299           DFHEIV11,
 21300           DFHEIV99,
 21301           DFHEIV99
 21302     SET ADDRESS OF PENDING-BUSINESS TO
 21303         DFHEIV20
 21304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21305
 21306
 21307     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21308        GO TO 5550-END-RECORDS.
 21309
 21310     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21311
 21312     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21313
 21314     IF  WS-BATCH-PREFIX = '#CL'
 21315             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21316
 21317* EXEC CICS ENDBR
 21318*                 DATASET  (FILE-ID-ERPNDB)
 21319*            END-EXEC
 21320     MOVE 0
 21321       TO DFHEIV11
 21322*    MOVE '&2                    $   #00017899' TO DFHEIV0
 21323     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21324     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21325     MOVE X'2020233030303137383939' TO DFHEIV0(25:11)
 21326     CALL 'kxdfhei1' USING DFHEIV0,
 21327           FILE-ID-ERPNDB,
 21328           DFHEIV11,
 21329           DFHEIV99
 21330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21331         GO TO 5505-START-BROWSE.
 21332
 21333     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21334         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21335             NEXT SENTENCE
 21336         ELSE
 21337             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21338
 21339* EXEC CICS ENDBR
 21340*                 DATASET  (FILE-ID-ERPNDB)
 21341*            END-EXEC
 21342     MOVE 0
 21343       TO DFHEIV11
 21344*    MOVE '&2                    $   #00017909' TO DFHEIV0
 21345     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21346     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 390
* EL6311.cbl
 21347     MOVE X'2020233030303137393039' TO DFHEIV0(25:11)
 21348     CALL 'kxdfhei1' USING DFHEIV0,
 21349           FILE-ID-ERPNDB,
 21350           DFHEIV11,
 21351           DFHEIV99
 21352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21353             GO TO 5505-START-BROWSE.
 21354
 21355
 21356     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21357         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21358             NEXT SENTENCE
 21359        ELSE
 21360             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21361
 21362* EXEC CICS ENDBR
 21363*                 DATASET  (FILE-ID-ERPNDB)
 21364*            END-EXEC
 21365     MOVE 0
 21366       TO DFHEIV11
 21367*    MOVE '&2                    $   #00017920' TO DFHEIV0
 21368     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21369     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21370     MOVE X'2020233030303137393230' TO DFHEIV0(25:11)
 21371     CALL 'kxdfhei1' USING DFHEIV0,
 21372           FILE-ID-ERPNDB,
 21373           DFHEIV11,
 21374           DFHEIV99
 21375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21376             GO TO 5505-START-BROWSE.
 21377
 21378     IF NOT PB-BATCH-TRAILER
 21379        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21380
 21381* EXEC CICS ENDBR
 21382*            DATASET  (FILE-ID-ERPNDB)
 21383*       END-EXEC
 21384     MOVE 0
 21385       TO DFHEIV11
 21386*    MOVE '&2                    $   #00017927' TO DFHEIV0
 21387     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21388     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21389     MOVE X'2020233030303137393237' TO DFHEIV0(25:11)
 21390     CALL 'kxdfhei1' USING DFHEIV0,
 21391           FILE-ID-ERPNDB,
 21392           DFHEIV11,
 21393           DFHEIV99
 21394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21395        GO TO 5505-START-BROWSE.
 21396
 21397     IF PI-CSR-BROWSE
 21398        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21399           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21400
 21401* EXEC CICS ENDBR
 21402*               DATASET  (FILE-ID-ERPNDB)
 21403*          END-EXEC
 21404     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 391
* EL6311.cbl
 21405       TO DFHEIV11
 21406*    MOVE '&2                    $   #00017935' TO DFHEIV0
 21407     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21408     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21409     MOVE X'2020233030303137393335' TO DFHEIV0(25:11)
 21410     CALL 'kxdfhei1' USING DFHEIV0,
 21411           FILE-ID-ERPNDB,
 21412           DFHEIV11,
 21413           DFHEIV99
 21414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21415           GO TO 5505-START-BROWSE.
 21416
 21417     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21418        IF PI-PB-CARRIER    = SPACES AND
 21419           PI-PB-GROUPING   = SPACES AND
 21420           PI-PB-STATE      = SPACES AND
 21421           PI-PB-ACCOUNT    = SPACES
 21422             GO TO 7200-DISPLAY-BATCHES
 21423          ELSE
 21424            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21425               PI-PB-GROUPING   = PB-GROUPING AND
 21426               PI-PB-STATE      = PB-STATE    AND
 21427               PI-PB-ACCOUNT    = PB-ACCOUNT
 21428                 GO TO 7200-DISPLAY-BATCHES.
 21429
 21430     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21431
 21432
 21433* EXEC CICS ENDBR
 21434*         DATASET  (FILE-ID-ERPNDB)
 21435*    END-EXEC.
 21436     MOVE 0
 21437       TO DFHEIV11
 21438*    MOVE '&2                    $   #00017955' TO DFHEIV0
 21439     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21440     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21441     MOVE X'2020233030303137393535' TO DFHEIV0(25:11)
 21442     CALL 'kxdfhei1' USING DFHEIV0,
 21443           FILE-ID-ERPNDB,
 21444           DFHEIV11,
 21445           DFHEIV99
 21446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21447
 21448
 21449     GO TO 5505-START-BROWSE.
 21450
 21451 5550-END-RECORDS.
 21452     MOVE ER-2257                TO EMI-ERROR.
 21453     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21454     MOVE -1                     TO DPFENTRL.
 21455
 21456     GO TO 8200-SEND-DATAONLY.
 21457
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 392
* EL6311.cbl
 21459
 21460******************************************************************
 21461*                                                                *
 21462*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21463*                                                                *
 21464******************************************************************
 21465
 21466 6000-CREATE-TEMP-STORAGE.
 21467
 21468
 21469* EXEC CICS HANDLE CONDITION
 21470*        QIDERR  (6050-QID-ERROR)
 21471*    END-EXEC.
 21472*    MOVE '"$N                   ! V #00017978' TO DFHEIV0
 21473     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21474     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21475     MOVE X'5620233030303137393738' TO DFHEIV0(25:11)
 21476     CALL 'kxdfhei1' USING DFHEIV0
 21477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21478
 21479
 21480
 21481* EXEC CICS WRITEQ TS
 21482*        QUEUE    (QID)
 21483*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21484*        LENGTH   (WS-COMM-LENGTH)
 21485*        ITEM     (W-ONE)
 21486*    END-EXEC.
 21487*    MOVE '*" I                  ''   #00017982' TO DFHEIV0
 21488     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 21489     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21490     MOVE X'2020233030303137393832' TO DFHEIV0(25:11)
 21491     CALL 'kxdfhei1' USING DFHEIV0,
 21492           QID,
 21493           PROGRAM-INTERFACE-BLOCK,
 21494           WS-COMM-LENGTH,
 21495           W-ONE,
 21496           DFHEIV99,
 21497           DFHEIV99
 21498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21499
 21500
 21501 6000-EXIT.
 21502      EXIT.
 21503
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 393
* EL6311.cbl
 21505
 21506******************************************************************
 21507*                                                                *
 21508*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21509*                                                                *
 21510******************************************************************
 21511
 21512 6050-RECOVER-TEMP-STORAGE.
 21513     IF PGM-NAME = XCTL-EL6312
 21514        GO TO 6050-EXIT.
 21515
 21516     IF PGM-NAME = XCTL-EL6313
 21517        GO TO 6050-EXIT.
 21518
 21519     IF PGM-NAME = XCTL-EL6315
 21520         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21521     END-IF
 21522
 21523     IF PGM-NAME = XCTL-EL6316
 21524         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21525     END-IF
 21526
 21527
 21528* EXEC CICS HANDLE CONDITION
 21529*        QIDERR  (6050-QID-ERROR)
 21530*    END-EXEC.
 21531*    MOVE '"$N                   ! W #00018015' TO DFHEIV0
 21532     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21533     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21534     MOVE X'5720233030303138303135' TO DFHEIV0(25:11)
 21535     CALL 'kxdfhei1' USING DFHEIV0
 21536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21537
 21538
 21539
 21540* EXEC CICS READQ TS
 21541*         QUEUE   (QID)
 21542*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21543*         LENGTH  (WS-COMM-LENGTH)
 21544*         ITEM    (W-ONE)
 21545*     END-EXEC.
 21546*    MOVE '*$II   L              ''   #00018019' TO DFHEIV0
 21547     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21548     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21549     MOVE X'2020233030303138303139' TO DFHEIV0(25:11)
 21550     CALL 'kxdfhei1' USING DFHEIV0,
 21551           QID,
 21552           PROGRAM-INTERFACE-BLOCK,
 21553           WS-COMM-LENGTH,
 21554           W-ONE,
 21555           DFHEIV99,
 21556           DFHEIV99
 21557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21558
 21559
 21560 6050-DELETE-TEMP-STORAGE.
 21561
 21562
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 394
* EL6311.cbl
 21563* EXEC CICS DELETEQ TS
 21564*        QUEUE   (QID)
 21565*    END-EXEC.
 21566*    MOVE '*&                    #   #00018028' TO DFHEIV0
 21567     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21568     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21569     MOVE X'2020233030303138303238' TO DFHEIV0(25:11)
 21570     CALL 'kxdfhei1' USING DFHEIV0,
 21571           QID,
 21572           DFHEIV99
 21573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21574
 21575
 21576     GO TO 6050-EXIT.
 21577
 21578 6050-QID-ERROR.
 21579     MOVE ER-0033                TO EMI-ERROR
 21580     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21581
 21582 6050-EXIT.
 21583      EXIT.
 21584
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 395
* EL6311.cbl
 21586
 21587******************************************************************
 21588*                                                                *
 21589*            T E R M   C O N V E R S I O N                       *
 21590*                                                                *
 21591******************************************************************
 21592
 21593 6100-TERM-CONVERSION.
 21594
 21595     IF PI-BPMTS = ZERO
 21596         GO TO 6199-EXIT.
 21597
 21598     IF PI-BMODE = ' ' OR 'M'
 21599         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21600         GO TO 6105-ROUND-TERM.
 21601
 21602     IF PI-BMODE = 'S'
 21603         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21604         GO TO 6105-ROUND-TERM.
 21605
 21606     IF PI-BMODE = 'W'
 21607         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21608         GO TO 6105-ROUND-TERM.
 21609
 21610     IF PI-BMODE = 'B'
 21611         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21612         GO TO 6105-ROUND-TERM.
 21613
 21614     IF PI-BMODE = 'T'
 21615         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21616
 21617 6105-ROUND-TERM.
 21618
 21619     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21620         ADD +1                  TO WS-CALC-TERM-WHOLE
 21621         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21622
 21623     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21624         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21625
 21626     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21627         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21628                                      WS-BTERM    (WS-SUB1)
 21629         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21630
 21631     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21632         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21633             MOVE -1               TO BMODEL
 21634             MOVE ER-2593          TO EMI-ERROR
 21635             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21636             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21637
 21638 6124-CHECK-BENEFIT.
 21639
 21640     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21641        GO TO 6126-COMPUTE-BENEFIT.
 21642
 21643     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 396
* EL6311.cbl
 21644
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 397
* EL6311.cbl
 21646******************************************************************
 21647**         COMPUTE TERM AND BENEFIT
 21648******************************************************************
 21649 6125-COMPUTE-TERM-BENEFIT.
 21650
 21651     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21652        PI-BPMTAMT = ZERO
 21653         GO TO 6199-EXIT.
 21654
 21655     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21656                                     WS-BTERM  (WS-SUB1).
 21657     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21658
 21659 6126-COMPUTE-BENEFIT.
 21660
 21661     IF PI-BMODE = 'M' OR  ' '
 21662         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21663
 21664     IF PI-BMODE = 'W'
 21665         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21666
 21667     IF PI-BMODE = 'S'
 21668         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21669
 21670     IF PI-BMODE = 'B'
 21671         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21672
 21673     IF PI-BMODE = 'T'
 21674         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21675
 21676     IF WS-SUB1 = +1
 21677        COMPUTE WS-BBEN (WS-SUB1) =
 21678                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21679
 21680     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21681     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21682     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21683
 21684 6199-EXIT.
 21685     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 398
* EL6311.cbl
 21687
 21688******************************************************************
 21689*                                                                *
 21690*             D I S P L A Y   I S S U E S                        *
 21691*                                                                *
 21692******************************************************************
 21693
 21694 6200-CREATE-VADS.
 21695     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21696     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21697     MOVE SPACES                 TO WS-PASS-VADS-REC
 21698
 21699* EXEC CICS GETMAIN
 21700*       SET      (ADDRESS OF PENDING-BUSINESS)
 21701*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21702*       INITIMG  (GETMAIN-SPACE)
 21703*       RESP     (WS-RESPONSE)
 21704*    END-EXEC
 21705*    MOVE ',"IL                  $  N#00018154' TO DFHEIV0
 21706     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21707     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21708     MOVE X'204E233030303138313534' TO DFHEIV0(25:11)
 21709     CALL 'kxdfhei1' USING DFHEIV0,
 21710           DFHEIV20,
 21711           ERPNDB-RECORD-LENGTH,
 21712           GETMAIN-SPACE
 21713     SET ADDRESS OF PENDING-BUSINESS TO
 21714         DFHEIV20
 21715     MOVE EIBRESP  TO WS-RESPONSE
 21716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21717
 21718* EXEC CICS READ
 21719*       INTO    (PENDING-BUSINESS)
 21720*       DATASET (FILE-ID-ERPNDB)
 21721*       RIDFLD  (ERPNDB-KEY)
 21722*       RESP    (WS-RESPONSE)
 21723*    END-EXEC
 21724     MOVE LENGTH OF
 21725      PENDING-BUSINESS
 21726       TO DFHEIV11
 21727*    MOVE '&"IL       E          (  N#00018160' TO DFHEIV0
 21728     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21729     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21730     MOVE X'204E233030303138313630' TO DFHEIV0(25:11)
 21731     CALL 'kxdfhei1' USING DFHEIV0,
 21732           FILE-ID-ERPNDB,
 21733           PENDING-BUSINESS,
 21734           DFHEIV11,
 21735           ERPNDB-KEY,
 21736           DFHEIV99,
 21737           DFHEIV99,
 21738           DFHEIV99
 21739     MOVE EIBRESP  TO WS-RESPONSE
 21740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21741     IF RESP-NORMAL
 21742        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21743        IF (RESP-NORMAL)
 21744           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 399
* EL6311.cbl
 21745              AM-CONTROL-PRIMARY (1:20))
 21746           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21747        ELSE
 21748           MOVE 'ACCOUNT NOT FOUND'
 21749                                 TO VD-ACCOUNT-NAME
 21750        END-IF
 21751        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21752                                    TO M1
 21753        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21754        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21755           (A2 > M1)
 21756           OR (WS-WORK-FIELD (A2:1) = '*')
 21757           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21758           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21759        END-PERFORM
 21760        IF A2 > M1
 21761           CONTINUE
 21762        ELSE
 21763           MOVE WS-WORK-FIELD (1:A2 - 1)
 21764                                    TO VD-ACCOUNT-NAME
 21765        END-IF
 21766        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21767        MOVE PB-CARRIER          TO VD-CARRIER
 21768        MOVE PB-GROUPING         TO VD-GROUPING
 21769        MOVE PB-STATE            TO VD-STATE
 21770        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21771        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21772        MOVE PB-CERT-NO          TO VD-CERT-NO
 21773        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21774        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21775        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21776        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21777        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21778        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21779        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21780        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21781        MOVE PB-CSR-ID           TO VD-CSR-ID
 21782        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21783        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21784        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21785        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21786        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21787        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21788        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21789        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21790        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21791        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21792        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21793        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21794        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21795     END-IF
 21796     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21797
 21798
 21799* EXEC CICS GETMAIN
 21800*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21801*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21802*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 400
* EL6311.cbl
 21803*       RESP     (WS-RESPONSE)
 21804*    END-EXEC
 21805*    MOVE ',"IL                  $  N#00018223' TO DFHEIV0
 21806     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21807     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21808     MOVE X'204E233030303138323233' TO DFHEIV0(25:11)
 21809     CALL 'kxdfhei1' USING DFHEIV0,
 21810           DFHEIV20,
 21811           ERPNDM-RECORD-LENGTH,
 21812           GETMAIN-SPACE
 21813     SET ADDRESS OF PENDING-MAILING-DATA TO
 21814         DFHEIV20
 21815     MOVE EIBRESP  TO WS-RESPONSE
 21816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21817
 21818
 21819* EXEC CICS READ
 21820*       INTO    (PENDING-MAILING-DATA)
 21821*       DATASET (FILE-ID-ERPNDM)
 21822*       RIDFLD  (ERPNDM-KEY)
 21823*       RESP    (WS-RESPONSE)
 21824*    END-EXEC
 21825     MOVE LENGTH OF
 21826      PENDING-MAILING-DATA
 21827       TO DFHEIV11
 21828*    MOVE '&"IL       E          (  N#00018230' TO DFHEIV0
 21829     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21830     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21831     MOVE X'204E233030303138323330' TO DFHEIV0(25:11)
 21832     CALL 'kxdfhei1' USING DFHEIV0,
 21833           FILE-ID-ERPNDM,
 21834           PENDING-MAILING-DATA,
 21835           DFHEIV11,
 21836           ERPNDM-KEY,
 21837           DFHEIV99,
 21838           DFHEIV99,
 21839           DFHEIV99
 21840     MOVE EIBRESP  TO WS-RESPONSE
 21841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21842
 21843     IF RESP-NORMAL
 21844        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 21845        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 21846        MOVE PM-CITY              TO VD-INSURED-CITY
 21847        MOVE PM-STATE             TO VD-INSURED-STATE
 21848        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 21849     END-IF
 21850
 21851     MOVE 'VAC1'                  TO VD-LETTER-ID
 21852     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 21853     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 21854     MOVE EIBTIME                 TO VD-CURRENT-TIME
 21855     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 21856     MOVE +0                      TO VD-ARCHIVE-NO
 21857     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 21858     .
 21859 6200-EXIT.
 21860     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 401
* EL6311.cbl
 21861 6210-READ-ERACCT.
 21862     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 21863     MOVE LOW-VALUES             TO ERACCT-FILL
 21864
 21865* EXEC CICS READ
 21866*         DATASET   ('ERACCT')
 21867*         INTO      (ACCOUNT-MASTER)
 21868*         RIDFLD    (ERACCT-KEY)
 21869*         GTEQ
 21870*         RESP      (WS-RESPONSE)
 21871*    END-EXEC
 21872     MOVE LENGTH OF
 21873      ACCOUNT-MASTER
 21874       TO DFHEIV11
 21875     MOVE 'ERACCT' TO DFHEIV1
 21876*    MOVE '&"IL       G          (  N#00018258' TO DFHEIV0
 21877     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21878     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21879     MOVE X'204E233030303138323538' TO DFHEIV0(25:11)
 21880     CALL 'kxdfhei1' USING DFHEIV0,
 21881           DFHEIV1,
 21882           ACCOUNT-MASTER,
 21883           DFHEIV11,
 21884           ERACCT-KEY,
 21885           DFHEIV99,
 21886           DFHEIV99,
 21887           DFHEIV99
 21888     MOVE EIBRESP  TO WS-RESPONSE
 21889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21890     .
 21891 6210-EXIT.
 21892     EXIT.
 21893
 21894 6220-READ-ERMAIL.
 21895
 21896     MOVE ELCERT-KEY             TO ERMAIL-KEY
 21897     MOVE ' '                    TO WS-ERMAIL-SW
 21898
 21899
 21900* EXEC CICS READ
 21901*       DATASET   (FILE-ID-ERMAIL)
 21902*       SET       (ADDRESS OF MAILING-DATA)
 21903*       RIDFLD    (ERMAIL-KEY)
 21904*       RESP      (WS-RESPONSE)
 21905*    END-EXEC
 21906*    MOVE '&"S        E          (  N#00018274' TO DFHEIV0
 21907     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21908     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21909     MOVE X'204E233030303138323734' TO DFHEIV0(25:11)
 21910     CALL 'kxdfhei1' USING DFHEIV0,
 21911           FILE-ID-ERMAIL,
 21912           DFHEIV20,
 21913           DFHEIV99,
 21914           ERMAIL-KEY,
 21915           DFHEIV99,
 21916           DFHEIV99,
 21917           DFHEIV99
 21918     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 402
* EL6311.cbl
 21919         DFHEIV20
 21920     MOVE EIBRESP  TO WS-RESPONSE
 21921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21922
 21923     IF RESP-NORMAL
 21924        SET ERMAIL-FOUND TO TRUE
 21925     END-IF
 21926     .
 21927 6220-EXIT.
 21928     EXIT.
 21929
 21930 6400-CHECK-FOR-RES-REF-CLAIM.
 21931     display 'made it to 6400- for ' pi-cert-no
 21932     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 21933
 21934     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 21935                                    W-CL-COMP-CD.
 21936     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 21937                                    W-CL-CERT-NO.
 21938     MOVE SPACES                 TO MSTR-CERT-SFX.
 21939
 21940
 21941* EXEC CICS HANDLE CONDITION
 21942*        NOTFND  (6400-CONTINUE)
 21943*        ENDFILE (6400-CONTINUE)
 21944*    END-EXEC.
 21945*    MOVE '"$I''                  ! X #00018298' TO DFHEIV0
 21946     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21947     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21948     MOVE X'5820233030303138323938' TO DFHEIV0(25:11)
 21949     CALL 'kxdfhei1' USING DFHEIV0
 21950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21951
 21952
 21953
 21954* EXEC CICS IGNORE CONDITION
 21955*        DUPKEY
 21956*    END-EXEC.
 21957*    MOVE '"*$                   !   #00018303' TO DFHEIV0
 21958     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 21959     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21960     MOVE X'2020233030303138333033' TO DFHEIV0(25:11)
 21961     CALL 'kxdfhei1' USING DFHEIV0
 21962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21963
 21964
 21965
 21966* EXEC CICS STARTBR
 21967*        DATASET   (CLMS-ID)
 21968*        RIDFLD    (ELMSTR-KEY)
 21969*        GENERIC   EQUAL
 21970*        KEYLENGTH (ELMSTR-LENGTH)
 21971*    END-EXEC.
 21972     MOVE 0
 21973       TO DFHEIV11
 21974*    MOVE '&,   KG    E          &   #00018307' TO DFHEIV0
 21975     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 21976     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 403
* EL6311.cbl
 21977     MOVE X'2020233030303138333037' TO DFHEIV0(25:11)
 21978     CALL 'kxdfhei1' USING DFHEIV0,
 21979           CLMS-ID,
 21980           ELMSTR-KEY,
 21981           ELMSTR-LENGTH,
 21982           DFHEIV11,
 21983           DFHEIV99
 21984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21985
 21986
 21987     display 'browse started'
 21988     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21989
 21990 6400-NEXT-CLAIM.
 21991
 21992
 21993* EXEC CICS READNEXT
 21994*        DATASET   (CLMS-ID)
 21995*        RIDFLD    (ELMSTR-KEY)
 21996*        SET       (ADDRESS OF CLAIM-MASTER)
 21997*    END-EXEC.
 21998     MOVE 0
 21999       TO DFHEIV11
 22000*    MOVE '&.S                   )   #00018319' TO DFHEIV0
 22001     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 22002     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22003     MOVE X'2020233030303138333139' TO DFHEIV0(25:11)
 22004     CALL 'kxdfhei1' USING DFHEIV0,
 22005           CLMS-ID,
 22006           DFHEIV20,
 22007           DFHEIV99,
 22008           ELMSTR-KEY,
 22009           DFHEIV99,
 22010           DFHEIV11,
 22011           DFHEIV99,
 22012           DFHEIV99
 22013     SET ADDRESS OF CLAIM-MASTER TO
 22014         DFHEIV20
 22015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22016
 22017
 22018     display 'read claim for ' mstr-cert-no
 22019     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22020        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22021         GO TO 6400-CONTINUE
 22022     END-IF.
 22023
 22024     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22025        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22026        PI-STATE       NOT = CL-CERT-STATE     OR
 22027        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22028        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22029         GO TO 6400-NEXT-CLAIM
 22030     END-IF.
 22031
 22032     display 'found claim ' cl-claim-no
 22033        ' with denial type ' cl-denial-type
 22034     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 404
* EL6311.cbl
 22035         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22036         GO TO 6400-CONTINUE
 22037     END-IF.
 22038
 22039     GO TO 6400-NEXT-CLAIM.
 22040
 22041 6400-CONTINUE.
 22042
 22043     IF WS-BROWSE-STARTED-SW = 'Y'
 22044
 22045* EXEC CICS ENDBR
 22046*            DATASET   (CLMS-ID)
 22047*        END-EXEC
 22048     MOVE 0
 22049       TO DFHEIV11
 22050*    MOVE '&2                    $   #00018351' TO DFHEIV0
 22051     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22052     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22053     MOVE X'2020233030303138333531' TO DFHEIV0(25:11)
 22054     CALL 'kxdfhei1' USING DFHEIV0,
 22055           CLMS-ID,
 22056           DFHEIV11,
 22057           DFHEIV99
 22058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22059         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22060     END-IF.
 22061
 22062 6400-EXIT.
 22063     EXIT.
 22064
 22065 7000-DISPLAY-ISSUES.
 22066
 22067     IF PI-DISPLAY-ORIGINAL-BATCH
 22068        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22069        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22070     ELSE
 22071        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22072
 22073     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22074
 22075     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22076     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22077
 22078     MOVE LOW-VALUES                 TO EL631BI.
 22079     MOVE ZEROS                      TO PI-BPMTAMT
 22080                                        PI-BPMTS.
 22081     MOVE SPACE                      TO PI-BMODE
 22082                                        PI-BTYPE (1)
 22083                                        PI-BTYPE (2).
 22084     MOVE EL631B                     TO PI-MAP-NAME.
 22085     MOVE 'Y'                        TO PI-BROWSE-SW.
 22086     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22087                                        PI-HIGH-SEQ-NO.
 22088
 22089     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22090        MOVE AL-SABOF                TO BCHGTA
 22091        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22092        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 405
* EL6311.cbl
 22093     ELSE
 22094        MOVE AL-SADOF                TO BCHGTA
 22095                                        BCHGA
 22096        MOVE PB-CHG-COUNT            TO BCHGO.
 22097
 22098     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22099     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22100     MOVE WS-HR-MINS                 TO BMANTATO.
 22101
 22102     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22103        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22104        MOVE SPACE                   TO DC-OPTION-CODE
 22105        PERFORM 9700-DATE-LINK
 22106        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22107        MOVE 'INACTIVE'              TO BMOENDTO
 22108     ELSE
 22109        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22110        MOVE SPACE                   TO DC-OPTION-CODE
 22111        PERFORM 9700-DATE-LINK
 22112        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22113        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22114        MOVE SPACE                   TO DC-OPTION-CODE
 22115        PERFORM 9700-DATE-LINK
 22116        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22117
 22118*    MOVE PB-I-REFERENCE             TO BREFO.
 22119
 22120*    IF PI-COMPANY-ID EQUAL 'HER'
 22121*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22122*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22123*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22124*                MOVE WS-MEMBER-NO-1-8
 22125*                                TO  BMICRNOO.
 22126
 22127*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22128*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22129*            MOVE PB-I-MICROFILM-NO
 22130*                                TO  BMICRNOO.
 22131     IF PB-I-VIN NOT = SPACES
 22132        MOVE PB-I-VIN            TO BVINO
 22133     END-IF
 22134
 22135     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22136     MOVE PB-CERT-SFX                TO BSUFIXO.
 22137     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22138     MOVE SPACE                      TO DC-OPTION-CODE.
 22139     PERFORM 9700-DATE-LINK.
 22140     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22141
 22142     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22143     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22144     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22145     MOVE PB-I-INSURED-SEX           TO BSEXO
 22146
 22147     IF PB-I-AGE NOT = ZEROS
 22148         MOVE PB-I-AGE               TO BAGEO.
 22149
 22150     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 406
* EL6311.cbl
 22151                                 TO ELCERT-KEY
 22152     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22153     IF NOT CERT-TRL-REC-NOT-FOUND
 22154         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22155             MOVE 'AGE*'             TO BAGEDEFO
 22156         ELSE
 22157             MOVE 'AGE '             TO BAGEDEFO
 22158         END-IF
 22159     ELSE
 22160         MOVE 'AGE '             TO BAGEDEFO
 22161     END-IF
 22162
 22163     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22164         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22165         MOVE SPACE                  TO DC-OPTION-CODE
 22166         PERFORM 9700-DATE-LINK
 22167         IF NO-CONVERSION-ERROR
 22168            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22169
 22170     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22171         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22172         MOVE SPACE                  TO DC-OPTION-CODE
 22173         PERFORM 9700-DATE-LINK
 22174         IF NO-CONVERSION-ERROR
 22175            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22176
 22177     IF PB-I-EXTENTION-DAYS NUMERIC
 22178        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22179           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22180        ELSE
 22181           IF PB-I-TERM-IN-DAYS NUMERIC
 22182              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22183                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22184
 22185     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22186        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22187
 22188     MOVE PB-FORCE-CODE              TO BFORCEO.
 22189     MOVE PB-I-TERM-TYPE             TO BMODEO
 22190                                        PI-BMODE.
 22191
 22192     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22193        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22194
 22195     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22196         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22197                                        PI-BPMTS.
 22198
 22199     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22200         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22201           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22202                                        PI-BPMTAMT.
 22203
 22204     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22205     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22206     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22207     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22208     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 407
* EL6311.cbl
 22209     MOVE PB-I-SIG-SW                TO BSIGO.
 22210     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22211     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22212     MOVE PB-RECORD-BILL             TO BBILCDO.
 22213     MOVE PB-FORCE-CODE              TO BFORCEO.
 22214
 22215     IF (PB-I-LIVES NUMERIC)
 22216        AND (PB-I-LIVES > ZEROS)
 22217        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22218        IF (RESP-NORMAL)
 22219           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22220           CONTINUE
 22221        ELSE
 22222           MOVE PB-I-LIVES       TO BLIVESO
 22223        END-IF
 22224     END-IF
 22225
 22226     IF PB-I-NUM-BILLED NUMERIC AND
 22227        PB-I-NUM-BILLED GREATER THAN ZEROS
 22228        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22229*    ELSE
 22230*       MOVE ZEROS                   TO BBILLEDO.
 22231
 22232     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22233
 22234     IF PB-I-LOAN-APR NOT = +99.9999
 22235        MOVE PB-I-LOAN-APR           TO BAPRO.
 22236
 22237     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22238        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22239
 22240     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22241        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22242           MOVE AL-SANOF                TO BORIGHDA
 22243           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22244           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22245
 22246     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22247
 22248     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22249        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22250
 22251     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22252        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22253                                        PI-BTYPE (1).
 22254
 22255     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22256        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22257
 22258     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22259        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22260
 22261     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22262        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22263
 22264     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22265        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22266
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 408
* EL6311.cbl
 22267     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22268        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22269
 22270     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22271         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22272         MOVE SPACE                  TO DC-OPTION-CODE
 22273         PERFORM 9700-DATE-LINK
 22274         IF NO-CONVERSION-ERROR
 22275            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22276
 22277     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22278        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22279        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22280        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22281        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22282                 GIVING BDIFFO (1)
 22283     ELSE
 22284        MOVE SPACES                  TO BBEN-CD     (1)
 22285                                        BBEN-ABBR   (1).
 22286
 22287     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22288        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22289        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22290                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22291
 22292     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22293       IF PB-RECORD-ON-HOLD
 22294          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22295
 22296     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22297       IF PB-RECORD-RETURNED
 22298          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22299
 22300     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22301        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22302             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22303
 22304     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22305
 22306     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22307        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22308
 22309     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22310        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22311                                        PI-BTYPE (2).
 22312
 22313     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22314        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22315
 22316     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22317        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22318
 22319     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22320        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22321
 22322     IF PB-I-TOT-FEES NOT NUMERIC
 22323        MOVE ZEROS               TO PB-I-TOT-FEES
 22324     END-IF
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 409
* EL6311.cbl
 22325     IF PB-I-TOT-FEES > ZEROS
 22326        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22327
 22328     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22329         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22330         MOVE SPACE                  TO DC-OPTION-CODE
 22331         PERFORM 9700-DATE-LINK
 22332         IF NO-CONVERSION-ERROR
 22333            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22334
 22335     IF PB-I-TOT-FEES > ZEROS
 22336        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22337        SUBTRACT PB-I-TOT-FEES FROM
 22338                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22339
 22340     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22341        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22342        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22343        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22344        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22345                 GIVING BDIFFO (2)
 22346     ELSE
 22347        MOVE SPACES                  TO BBEN-CD     (2)
 22348                                        BBEN-ABBR   (2).
 22349
 22350     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22351       IF PB-RECORD-ON-HOLD
 22352          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22353
 22354     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22355       IF PB-RECORD-RETURNED
 22356          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22357
 22358     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22359        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22360             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22361
 22362     MOVE PB-CSR-ID                  TO BCSRO.
 22363
 22364     IF PI-COMPANY-ID  =  'DMD'
 22365        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22366            NEXT SENTENCE
 22367        ELSE
 22368            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22369               MOVE 'NEW CERT'       TO BNCERTLI
 22370               MOVE EC-NEW-CERT      TO BNCERTO.
 22371
 22372     IF PI-COMPANY-ID  =  'DMD'
 22373        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22374            NEXT SENTENCE
 22375        ELSE
 22376           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22377               MOVE 'NEW STATE'      TO BNSTATLI
 22378               MOVE EC-NEW-STATE     TO BNSTATO.
 22379
 22380 7000-CONTINUE.
 22381     MOVE 'C'                        TO BMAINTI.
 22382     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 410
* EL6311.cbl
 22383
 22384     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22385        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22386
 22387     IF PI-6315-FINALIZED = 'Y'   AND
 22388        PB-UNFORCED-ERRORS
 22389          MOVE -1                TO BFORCEL
 22390          MOVE  1                TO SET-CURSOR-SW
 22391     END-IF
 22392
 22393     IF NO-CURSOR-SET
 22394        MOVE -1                      TO BMAINTL.
 22395
 22396     GO TO 8100-SEND-INITIAL-MAP.
 22397
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 411
* EL6311.cbl
 22399
 22400******************************************************************
 22401*                                                                *
 22402*             D I S P L A Y   C A N C E L S                      *
 22403*                                                                *
 22404******************************************************************
 22405
 22406 7100-DISPLAY-CANCELS.
 22407     IF PI-DISPLAY-ORIGINAL-BATCH
 22408        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22409        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22410     ELSE
 22411        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22412
 22413     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22414
 22415     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22416     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22417
 22418     MOVE LOW-VALUES                 TO EL631CI.
 22419     MOVE EL631C                     TO PI-MAP-NAME.
 22420     MOVE 'Y'                        TO PI-BROWSE-SW.
 22421     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22422                                        PI-HIGH-SEQ-NO.
 22423
 22424     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22425        MOVE AL-SABOF                TO CCHGTA
 22426        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22427        MOVE AL-SANON                TO CCHGA
 22428      ELSE
 22429        MOVE AL-SADOF                TO CCHGTA
 22430                                        CCHGA
 22431        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22432
 22433*    MOVE PB-C-REFERENCE             TO CREFO.
 22434
 22435*    IF PB-C-MICROFILM-NO IS NUMERIC
 22436*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22437*          MOVE PB-C-MICROFILM-NO
 22438*                                TO CMICRNOO
 22439*          MOVE AL-UNNON         TO CMICRNOA
 22440*       END-IF
 22441*    END-IF
 22442     IF PB-C-NH-INT-ON-REFS NUMERIC
 22443        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 22444           MOVE PB-C-NH-INT-ON-REFS
 22445                                 TO CNHINTO
 22446           MOVE AL-SANOF         TO CNHINTA
 22447        END-IF
 22448     END-IF
 22449     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22450     MOVE PB-CERT-SFX                TO CSUFIXO.
 22451     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22452     MOVE SPACE                      TO DC-OPTION-CODE.
 22453     PERFORM 9700-DATE-LINK.
 22454     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22455
 22456     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 412
* EL6311.cbl
 22457        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22458        MOVE SPACE                   TO DC-OPTION-CODE
 22459        PERFORM 9700-DATE-LINK
 22460        IF NO-CONVERSION-ERROR
 22461           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22462
 22463     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22464        NEXT SENTENCE
 22465     ELSE
 22466        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22467
 22468     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22469        NEXT SENTENCE
 22470     ELSE
 22471        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22472
 22473     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22474        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22475        MOVE SPACE                   TO DC-OPTION-CODE
 22476        PERFORM 9700-DATE-LINK
 22477        IF NO-CONVERSION-ERROR
 22478           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22479
 22480     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22481         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22482
 22483     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22484         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22485
 22486     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22487        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22488        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22489                 GIVING CDRFND1O.
 22490
 22491     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22492        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22493        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22494                 GIVING CDRFND2O.
 22495
 22496     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22497       IF PB-RECORD-ON-HOLD
 22498          MOVE 'ON HOLD'             TO CBILIT1O.
 22499
 22500     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22501       IF PB-RECORD-RETURNED
 22502          MOVE 'RETURNED'            TO CBILIT1O.
 22503
 22504     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22505        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22506             MOVE 'OVERRIDE'         TO CBILIT1O.
 22507
 22508     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22509       IF PB-RECORD-ON-HOLD
 22510          MOVE 'ON HOLD'             TO CBILIT2O.
 22511
 22512     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22513       IF PB-RECORD-RETURNED
 22514          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 413
* EL6311.cbl
 22515
 22516     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22517        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22518             MOVE 'OVERRIDE'         TO CBILIT2O.
 22519
 22520     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22521     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22522     IF PB-C-POST-CARD-IND = 'Y'
 22523        MOVE 'Y'                     TO CPCYNO
 22524     ELSE
 22525        MOVE 'N'                     TO CPCYNO
 22526     END-IF
 22527     MOVE PB-FORCE-CODE              TO CFORCEO.
 22528     MOVE PB-RECORD-BILL             TO CBILCDO.
 22529     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22530     MOVE SPACES                     TO CINITSO.
 22531     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22532         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22533     ELSE
 22534         MOVE PB-CI-INITIALS         TO CINITSO
 22535     END-IF.
 22536
 22537     IF PB-CI-CANCEL-FEE NUMERIC
 22538        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22539        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22540     ELSE
 22541        MOVE ZEROES                  TO W-CANCEL-FEE.
 22542
 22543     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22544
 22545     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22546        ADD PB-CI-LF-PREMIUM-AMT
 22547             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22548
 22549     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22550        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22551
 22552     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22553     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22554     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22555     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22556
 22557     IF PB-C-LIVES NUMERIC
 22558        MOVE PB-C-LIVES              TO CLIVESO.
 22559
 22560     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22561        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22562
 22563     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22564        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22565        MOVE SPACE                   TO DC-OPTION-CODE
 22566        PERFORM 9700-DATE-LINK
 22567        IF NO-CONVERSION-ERROR
 22568           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22569
 22570     IF  PB-C-REFUND-CREATED
 22571         MOVE 'YES'                  TO CRFNDSWO
 22572     ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 414
* EL6311.cbl
 22573         IF PB-C-REFUND-REQUESTED
 22574            MOVE 'REQ'               TO CRFNDSWO
 22575         ELSE
 22576            MOVE 'NO'                TO CRFNDSWO.
 22577
 22578     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22579     MOVE SPACE                      TO DC-OPTION-CODE.
 22580     PERFORM 9700-DATE-LINK.
 22581     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22582     MOVE PB-INPUT-BY                TO CENTBYO.
 22583
 22584     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22585        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22586        MOVE SPACE                   TO DC-OPTION-CODE
 22587        PERFORM 9700-DATE-LINK
 22588        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22589        MOVE 'INACTIVE'              TO CMOENDTO
 22590     ELSE
 22591        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22592        MOVE SPACE                   TO DC-OPTION-CODE
 22593        PERFORM 9700-DATE-LINK
 22594        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22595        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22596        MOVE SPACE                   TO DC-OPTION-CODE
 22597        PERFORM 9700-DATE-LINK
 22598        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22599
 22600     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22601
 22602     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22603     MOVE WS-HR-MINS                 TO CMANTATO.
 22604
 22605     EVALUATE PB-LF-REFUND-TYPE
 22606        WHEN '1'
 22607           MOVE 'RULE78'            TO CLFREFNO
 22608        WHEN '2'
 22609           MOVE 'PRORAT'            TO CLFREFNO
 22610        WHEN '3'
 22611           MOVE 'CALIF'             TO CLFREFNO
 22612        WHEN '4'
 22613           MOVE 'IRREG'             TO CLFREFNO
 22614        WHEN '5'
 22615           MOVE 'NETPAY'            TO CLFREFNO
 22616        WHEN '6'
 22617           MOVE 'ATCP'              TO CLFREFNO
 22618        WHEN '7'
 22619           MOVE 'UTAH'              TO CLFREFNO
 22620        WHEN '8'
 22621           MOVE 'MEAN'              TO CLFREFNO
 22622        WHEN '9'
 22623           MOVE 'SUM '              TO CLFREFNO
 22624        WHEN 'B'
 22625           MOVE 'BALN'              TO CLFREFNO
 22626     END-EVALUATE.
 22627
 22628     EVALUATE TRUE
 22629        WHEN PB-AH-REFUND-TYPE =  '1'
 22630           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 415
* EL6311.cbl
 22631        WHEN PB-AH-REFUND-TYPE =  '2'
 22632           MOVE 'PRORAT'            TO CAHREFNO
 22633        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22634           MOVE 'CALIF'             TO CAHREFNO
 22635        WHEN PB-AH-REFUND-TYPE =  '4'
 22636           MOVE 'IRREG'             TO CAHREFNO
 22637        WHEN PB-AH-REFUND-TYPE =  '5'
 22638           MOVE 'NETPAY'            TO CAHREFNO
 22639        WHEN PB-AH-REFUND-TYPE =  '6'
 22640           MOVE 'ATCP'              TO CAHREFNO
 22641        WHEN PB-AH-REFUND-TYPE =  '7'
 22642           MOVE 'UTAH'              TO CAHREFNO
 22643        WHEN PB-AH-REFUND-TYPE =  '8'
 22644           MOVE 'MEAN'              TO CAHREFNO
 22645        WHEN PB-AH-REFUND-TYPE =  '9'
 22646           MOVE 'SUM '              TO CAHREFNO
 22647        WHEN PB-AH-REFUND-TYPE =  'B'
 22648           MOVE 'BALN'              TO CAHREFNO
 22649     END-EVALUATE.
 22650
 22651     MOVE PB-REIN-CD                 TO CREINCDO.
 22652
 22653     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22654        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22655        MOVE SPACE                   TO DC-OPTION-CODE
 22656        PERFORM 9700-DATE-LINK
 22657        IF NO-CONVERSION-ERROR
 22658           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22659
 22660     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22661        MOVE 999999                  TO WS-EXP-DT-EDIT
 22662        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22663        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22664     ELSE
 22665        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22666           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22667           MOVE SPACE                   TO DC-OPTION-CODE
 22668           PERFORM 9700-DATE-LINK
 22669           IF NO-CONVERSION-ERROR
 22670              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22671
 22672     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22673        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22674           MOVE AL-SANOF                TO CORIGHDA
 22675           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22676           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22677
 22678     MOVE PB-CSR-ID              TO CCSRO.
 22679
 22680     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22681     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22682
 22683     MOVE 'C'                    TO CMAINTI.
 22684     MOVE AL-UANON               TO CMAINTA.
 22685
 22686     IF PI-6316-FINALIZED = 'Y'  AND
 22687        PB-UNFORCED-ERRORS
 22688          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 416
* EL6311.cbl
 22689          MOVE  1                TO SET-CURSOR-SW
 22690     END-IF
 22691
 22692     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22693        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22694
 22695     IF NO-CURSOR-SET
 22696        MOVE -1                  TO CMAINTL.
 22697
 22698     GO TO 8100-SEND-INITIAL-MAP.
 22699
 22700
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 417
* EL6311.cbl
 22702***************************************************************
 22703*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22704*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22705***************************************************************
 22706
 22707 7200-DISPLAY-BATCHES.
 22708     MOVE EL631D                 TO PI-MAP-NAME.
 22709     MOVE LOW-VALUES             TO EL631DI.
 22710
 22711     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22712
 22713
 22714* EXEC CICS HANDLE CONDITION
 22715*         NOTFND   (3690-NOT-FOUND)
 22716*    END-EXEC.
 22717*    MOVE '"$I                   ! Y #00019008' TO DFHEIV0
 22718     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22719     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22720     MOVE X'5920233030303139303038' TO DFHEIV0(25:11)
 22721     CALL 'kxdfhei1' USING DFHEIV0
 22722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22723
 22724
 22725     IF PI-DISPLAY-SCREEN
 22726        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22727     ELSE
 22728        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22729
 22730     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22731     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22732
 22733
 22734* EXEC CICS READ
 22735*         DATASET   (FILE-ID-ERPNDB)
 22736*         RIDFLD    (ERPNDB-KEY)
 22737*         SET       (ADDRESS OF PENDING-BUSINESS)
 22738*    END-EXEC.
 22739*    MOVE '&"S        E          (   #00019020' TO DFHEIV0
 22740     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22741     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22742     MOVE X'2020233030303139303230' TO DFHEIV0(25:11)
 22743     CALL 'kxdfhei1' USING DFHEIV0,
 22744           FILE-ID-ERPNDB,
 22745           DFHEIV20,
 22746           DFHEIV99,
 22747           ERPNDB-KEY,
 22748           DFHEIV99,
 22749           DFHEIV99,
 22750           DFHEIV99
 22751     SET ADDRESS OF PENDING-BUSINESS TO
 22752         DFHEIV20
 22753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22754
 22755
 22756     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22757     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22758     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22759     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 418
* EL6311.cbl
 22760     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22761
 22762     MOVE EL631D                 TO PI-MAP-NAME.
 22763     MOVE LOW-VALUES             TO EL631DI.
 22764     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22765
 22766*    IF PI-AR-PROCESSING
 22767*       MOVE PB-REFERENCE        TO DREFO.
 22768
 22769     MOVE PB-CSR-ID              TO DCSRO.
 22770
 22771     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22772        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22773        MOVE SPACE               TO DC-OPTION-CODE
 22774        PERFORM 9700-DATE-LINK
 22775        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22776        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22777        MOVE 'INACTIVE'          TO DLDATEO
 22778     ELSE
 22779        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22780        MOVE SPACE               TO DC-OPTION-CODE
 22781        PERFORM 9700-DATE-LINK
 22782        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22783
 22784     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22785     MOVE SPACE                  TO DC-OPTION-CODE.
 22786     PERFORM 9700-DATE-LINK.
 22787     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22788
 22789     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22790        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22791     ELSE
 22792        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22793        MOVE SPACE               TO DC-OPTION-CODE
 22794        PERFORM 9700-DATE-LINK
 22795        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22796
 22797     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22798     MOVE SPACE                  TO DC-OPTION-CODE.
 22799     PERFORM 9700-DATE-LINK.
 22800     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22801
 22802     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22803     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22804
 22805     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22806        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22807                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 22808
 22809     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 22810     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 22811     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 22812
 22813     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 22814        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 22815                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 22816
 22817     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 419
* EL6311.cbl
 22818     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 22819     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 22820
 22821     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 22822        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 22823                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 22824
 22825     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 22826     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 22827
 22828     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 22829        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 22830                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 22831
 22832     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 22833     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 22834     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 22835
 22836     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 22837        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 22838                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 22839
 22840     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 22841     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 22842     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 22843
 22844     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 22845        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 22846                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 22847
 22848     MOVE -1                     TO DPFENTRL.
 22849     GO TO 8100-SEND-INITIAL-MAP.
 22850
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 420
* EL6311.cbl
 22852
 22853***************************************************************
 22854*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 22855*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 22856*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 22857*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 22858*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 22859*     ARE THEN SET ACCORDINGLY.                               *
 22860*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 22861*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 22862*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 22863***************************************************************
 22864
 22865******************************************************************
 22866*                                                                *
 22867*            E R R O R   A N A L Y S I S                         *
 22868*                                                                *
 22869******************************************************************
 22870
 22871******************************************************************
 22872*                                                                *
 22873*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 22874*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 22875*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 22876*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 22877*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 22878*                                                                *
 22879*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 22880*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 22881*                                                                *
 22882******************************************************************
 22883
 22884 7300-FORMAT-ERRORS.
 22885     MOVE ' '                    TO PI-ERRORS-SW
 22886     IF PB-COMMON-ERRORS = LOW-VALUES
 22887        IF PB-FATAL-ERRORS
 22888           MOVE ER-2695          TO EMI-ERROR
 22889           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22890           GO TO 7399-EXIT.
 22891
 22892     MOVE +0                     TO WS-SUB4.
 22893
 22894 7310-ERROR-LOOP.
 22895
 22896     ADD +1                      TO WS-SUB4.
 22897
 22898     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22899        GO TO 7350-SET-ERROR-FLAGS.
 22900
 22901     IF PI-COMPANY-ID = 'UCL'
 22902         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 22903             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 22904             MOVE ' '                   TO DC-OPTION-CODE
 22905             PERFORM 9700-DATE-LINK
 22906             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 22907
 22908     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 22909     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 421
* EL6311.cbl
 22910     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 22911
 22912     GO TO 7310-ERROR-LOOP.
 22913
 22914
 22915 7350-SET-ERROR-FLAGS.
 22916
 22917     IF EMI-FATAL-CTR NOT = ZEROS
 22918        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22919        MOVE 'X'                 TO PB-FATAL-FLAG
 22920                                    PI-ERRORS-SW
 22921        GO TO 7355-SET-ERROR-FLAGS.
 22922
 22923     move ' ' to pi-unforced-sw
 22924     IF EMI-FORCABLE-CTR NOT = ZEROS
 22925        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22926        IF PB-ISSUE
 22927           IF PB-ISSUE-FORCE
 22928              MOVE 'F'           TO PB-FORCE-ER-CD
 22929              MOVE ER-2600       TO EMI-ERROR
 22930              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22931             ELSE
 22932              MOVE 'X'           TO PB-FORCE-ER-CD
 22933*                                   PI-ERRORS-SW
 22934          ELSE
 22935           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 22936              MOVE 'F'           TO PB-FORCE-ER-CD
 22937                                    pi-unforced-sw
 22938              MOVE ER-2600       TO EMI-ERROR
 22939              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22940             ELSE
 22941              MOVE 'X'           TO PB-FORCE-ER-CD
 22942                                    pi-unforced-sw.
 22943*                                   PI-ERRORS-SW.
 22944
 22945     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 22946     IF PB-ISSUE
 22947         MOVE 'I'                TO ENDT-RECORD-TYPE
 22948     ELSE
 22949         MOVE 'C'                TO ENDT-RECORD-TYPE
 22950     END-IF
 22951     MOVE +0                     TO ENDT-SEQ-NO
 22952
 22953
 22954* EXEC CICS READ
 22955*        DATASET   (FILE-ID-ERENDT)
 22956*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 22957*        RIDFLD    (ERENDT-KEY)
 22958*        RESP      (WS-RESPONSE)
 22959*        GTEQ
 22960*    END-EXEC
 22961*    MOVE '&"S        G          (  N#00019223' TO DFHEIV0
 22962     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22963     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22964     MOVE X'204E233030303139323233' TO DFHEIV0(25:11)
 22965     CALL 'kxdfhei1' USING DFHEIV0,
 22966           FILE-ID-ERENDT,
 22967           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 422
* EL6311.cbl
 22968           DFHEIV99,
 22969           ERENDT-KEY,
 22970           DFHEIV99,
 22971           DFHEIV99,
 22972           DFHEIV99
 22973     SET ADDRESS OF ENDORSEMENT-RECORD TO
 22974         DFHEIV20
 22975     MOVE EIBRESP  TO WS-RESPONSE
 22976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22977
 22978     IF RESP-NORMAL
 22979        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 22980        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 22981            MOVE ER-0280          TO EMI-ERROR
 22982            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22983            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 22984            EVALUATE TRUE
 22985              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 22986                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 22987              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 22988                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 22989              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 22990                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 22991            END-EVALUATE
 22992        END-IF
 22993     END-IF
 22994
 22995
 22996
 22997     IF FIRST-ENTRY OR
 22998        EIBAID = DFHPF1 OR DFHPF2
 22999        MOVE '0'                TO PI-EDIT-SW
 23000        GO TO 7399-EXIT.
 23001
 23002 7355-SET-ERROR-FLAGS.
 23003
 23004     IF EMI-WARNING-CTR NOT = ZEROS
 23005        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23006        MOVE 'W'                 TO PB-WARN-ER-CD.
 23007
 23008     IF PB-UNFORCED-ERRORS OR
 23009        PB-FATAL-ERRORS    OR
 23010        PB-RECORD-ON-HOLD  OR
 23011        PB-RECORD-RETURNED OR
 23012        PB-CANCELLATION
 23013          NEXT SENTENCE
 23014        ELSE
 23015          GO TO 7399-EXIT.
 23016
 23017
 23018* EXEC CICS  HANDLE CONDITION
 23019*           NOTFND   (7399-EXIT)
 23020*    END-EXEC.
 23021*    MOVE '"$I                   ! Z #00019270' TO DFHEIV0
 23022     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23023     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23024     MOVE X'5A20233030303139323730' TO DFHEIV0(25:11)
 23025     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 423
* EL6311.cbl
 23026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23027
 23028
 23029     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23030     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23031     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23032     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23033
 23034
 23035* EXEC CICS READ
 23036*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23037*        DATASET (FILE-ID-ELCERT)
 23038*        RIDFLD  (ELCERT-KEY)
 23039*        UPDATE
 23040*    END-EXEC.
 23041*    MOVE '&"S        EU         (   #00019279' TO DFHEIV0
 23042     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23043     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23044     MOVE X'2020233030303139323739' TO DFHEIV0(25:11)
 23045     CALL 'kxdfhei1' USING DFHEIV0,
 23046           FILE-ID-ELCERT,
 23047           DFHEIV20,
 23048           DFHEIV99,
 23049           ELCERT-KEY,
 23050           DFHEIV99,
 23051           DFHEIV99,
 23052           DFHEIV99
 23053     SET ADDRESS OF CERTIFICATE-MASTER TO
 23054         DFHEIV20
 23055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23056
 23057
 23058
 23059     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23060     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23061
 23062     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23063        GO TO 7360-REWRITE-CERT-MASTER.
 23064
 23065     IF PB-ISSUE
 23066        IF PB-RECORD-RETURNED
 23067            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23068            GO TO 7360-REWRITE-CERT-MASTER
 23069        ELSE
 23070            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23071            GO TO 7360-REWRITE-CERT-MASTER.
 23072
 23073     IF PB-RECORD-RETURNED
 23074         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 23075         GO TO 7360-REWRITE-CERT-MASTER.
 23076
 23077     IF (PB-C-LF-CANCEL-VOIDED)
 23078        or (pb-c-ah-cancel-voided)
 23079        IF (PB-UNFORCED-ERRORS OR
 23080            PB-FATAL-ERRORS    OR
 23081            PB-RECORD-ON-HOLD)
 23082            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23083            GO TO 7360-REWRITE-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 424
* EL6311.cbl
 23084        ELSE
 23085            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23086            GO TO 7360-REWRITE-CERT-MASTER.
 23087
 23088     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23089                            OR PB-RECORD-ON-HOLD)
 23090        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23091     ELSE
 23092        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23093
 23094 7360-REWRITE-CERT-MASTER.
 23095
 23096     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23097        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23098
 23099* EXEC CICS UNLOCK
 23100*            DATASET    (FILE-ID-ELCERT)
 23101*       END-EXEC
 23102*    MOVE '&*                    #   #00019326' TO DFHEIV0
 23103     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23104     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23105     MOVE X'2020233030303139333236' TO DFHEIV0(25:11)
 23106     CALL 'kxdfhei1' USING DFHEIV0,
 23107           FILE-ID-ELCERT,
 23108           DFHEIV99
 23109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23110        GO TO 7399-EXIT.
 23111
 23112
 23113* EXEC CICS REWRITE
 23114*         DATASET    (FILE-ID-ELCERT)
 23115*         FROM       (CERTIFICATE-MASTER)
 23116*    END-EXEC.
 23117     MOVE LENGTH OF
 23118      CERTIFICATE-MASTER
 23119       TO DFHEIV11
 23120*    MOVE '&& L                  %   #00019331' TO DFHEIV0
 23121     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23122     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23123     MOVE X'2020233030303139333331' TO DFHEIV0(25:11)
 23124     CALL 'kxdfhei1' USING DFHEIV0,
 23125           FILE-ID-ELCERT,
 23126           CERTIFICATE-MASTER,
 23127           DFHEIV11,
 23128           DFHEIV99
 23129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23130
 23131
 23132 7399-EXIT.
 23133      EXIT.
 23134
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 425
* EL6311.cbl
 23136
 23137*************************************************************
 23138*                                                           *
 23139*              S E T   A T T R I B U T E S                  *
 23140*                                                           *
 23141*************************************************************
 23142
 23143 7400-SET-ATTRIBUTES.
 23144
 23145     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23146        GO TO 7499-EXIT.
 23147
 23148**2601**
 23149
 23150     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23151        IF PB-ISSUE
 23152           MOVE AL-UABON         TO BEFFDTA
 23153           GO TO 7499-EXIT
 23154         ELSE
 23155           MOVE AL-UABON         TO CEFFDTA
 23156           GO TO 7499-EXIT.
 23157
 23158**2604**
 23159
 23160     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23161        IF PB-ISSUE
 23162           MOVE AL-UABON         TO BTYPE1A
 23163           MOVE -1               TO BTYPE1L
 23164           MOVE  1               TO SET-CURSOR-SW
 23165           GO TO 7499-EXIT.
 23166
 23167**2605**
 23168
 23169     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23170        IF PB-ISSUE
 23171           MOVE AL-UABON         TO BTYPE2A
 23172           MOVE -1               TO BTYPE2L
 23173           MOVE  1               TO SET-CURSOR-SW
 23174           GO TO 7499-EXIT.
 23175
 23176**2606**
 23177
 23178     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23179        IF PB-ISSUE
 23180           MOVE AL-UABON         TO BSIGA
 23181           MOVE -1               TO BSIGL
 23182           MOVE  1               TO SET-CURSOR-SW
 23183           GO TO 7499-EXIT.
 23184
 23185**2607**
 23186
 23187     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23188        IF PB-ISSUE
 23189           MOVE AL-UABON         TO BSIGA
 23190           MOVE -1               TO BSIGL
 23191           MOVE  1               TO SET-CURSOR-SW
 23192           GO TO 7499-EXIT.
 23193
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 426
* EL6311.cbl
 23194**2615**
 23195
 23196     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23197        IF PB-ISSUE
 23198           MOVE AL-UABOF         TO BREINA
 23199           MOVE -1               TO BREINL
 23200           GO TO 7499-EXIT.
 23201
 23202**2622**
 23203
 23204     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23205        IF PB-ISSUE
 23206           MOVE AL-UABON         TO BEFFDTA
 23207           GO TO 7499-EXIT
 23208        ELSE
 23209           MOVE AL-UABON         TO CEFFDTA
 23210           GO TO 7499-EXIT.
 23211
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 427
* EL6311.cbl
 23213
 23214*************************************************************
 23215*                                                           *
 23216*              I S S U E   E R R O R S                      *
 23217*                                                           *
 23218*************************************************************
 23219
 23220 7420-ISSUE-ERRORS.
 23221
 23222**2626**
 23223
 23224     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23225        MOVE AL-UABON            TO BCERTNOA
 23226        GO TO 7499-EXIT.
 23227
 23228**2627**
 23229
 23230     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23231        MOVE AL-UNBON            TO BAGEA
 23232        MOVE -1                  TO BAGEL
 23233        MOVE  1                  TO SET-CURSOR-SW
 23234        GO TO 7499-EXIT.
 23235
 23236**2628**
 23237
 23238     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23239        MOVE AL-UNBON            TO BAGEA
 23240        MOVE -1                  TO BAGEL
 23241        MOVE  1                  TO SET-CURSOR-SW
 23242        GO TO 7499-EXIT.
 23243
 23244**2629**
 23245
 23246     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23247        MOVE AL-UABON            TO BSEXA
 23248        MOVE -1                  TO BSEXL
 23249        MOVE  1                  TO SET-CURSOR-SW
 23250        GO TO 7499-EXIT.
 23251
 23252**2630**
 23253
 23254     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23255        MOVE -1                  TO BTYPE1L
 23256        MOVE  1                  TO SET-CURSOR-SW
 23257        GO TO 7499-EXIT.
 23258
 23259**2631**
 23260
 23261     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23262        MOVE -1                  TO BTYPE1L
 23263        MOVE  1                  TO SET-CURSOR-SW
 23264        GO TO 7499-EXIT.
 23265
 23266**2632**
 23267
 23268     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23269        MOVE AL-UNBON            TO BBEN1A
 23270        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 428
* EL6311.cbl
 23271        MOVE  1                  TO SET-CURSOR-SW
 23272        GO TO 7499-EXIT.
 23273
 23274**2633**
 23275
 23276     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23277        MOVE AL-UNBON            TO BPREM1A
 23278        MOVE -1                  TO BPREM1L
 23279        MOVE  1                  TO SET-CURSOR-SW
 23280        GO TO 7499-EXIT.
 23281
 23282**2634**
 23283
 23284     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23285        MOVE -1                  TO BTYPE2L
 23286        MOVE  1                  TO SET-CURSOR-SW
 23287        GO TO 7499-EXIT.
 23288
 23289**2635**
 23290
 23291     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23292        MOVE AL-UNBON            TO BBEN2A
 23293        MOVE -1                  TO BBEN2L
 23294        MOVE  1                  TO SET-CURSOR-SW
 23295        GO TO 7499-EXIT.
 23296
 23297**2636**
 23298
 23299     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23300        MOVE AL-UNBON            TO BPREM2A
 23301        MOVE -1                  TO BPREM2L
 23302        MOVE  1                  TO SET-CURSOR-SW
 23303        GO TO 7499-EXIT.
 23304
 23305**2639**
 23306
 23307     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23308        MOVE AL-UNBON            TO BBEN1A
 23309        MOVE -1                  TO BBEN1L
 23310        MOVE  1                  TO SET-CURSOR-SW
 23311        GO TO 7499-EXIT.
 23312
 23313**2640**
 23314
 23315     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23316        MOVE AL-UNBON            TO BBEN2A
 23317        MOVE -1                  TO BBEN2L
 23318        MOVE  1                  TO SET-CURSOR-SW
 23319        GO TO 7499-EXIT.
 23320
 23321**2647**
 23322
 23323     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23324        MOVE AL-UNBON            TO BTERM1A
 23325        MOVE -1                  TO BTERM1L
 23326        MOVE  1                  TO SET-CURSOR-SW
 23327        GO TO 7499-EXIT.
 23328
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 429
* EL6311.cbl
 23329**2648**
 23330
 23331     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23332        MOVE AL-UNBON            TO BLNTRMA
 23333        MOVE -1                  TO BLNTRML
 23334        MOVE  1                  TO SET-CURSOR-SW
 23335        GO TO 7499-EXIT.
 23336
 23337**2649**
 23338
 23339     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23340        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23341            MOVE AL-UNBON            TO BPREM1A
 23342            MOVE -1                  TO BPREM1L
 23343            MOVE  1                  TO SET-CURSOR-SW
 23344            GO TO 7499-EXIT
 23345     ELSE
 23346        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23347           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23348            MOVE AL-UNBON            TO BPREM2A
 23349            MOVE -1                  TO BPREM2L
 23350            MOVE  1                  TO SET-CURSOR-SW
 23351            GO TO 7499-EXIT.
 23352
 23353**2650**
 23354
 23355     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23356        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23357            MOVE AL-UNBON        TO BPREM1A
 23358            MOVE -1              TO BPREM1L
 23359            MOVE  1              TO SET-CURSOR-SW
 23360            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23361                MOVE AL-UNBON        TO BPREM2A
 23362                MOVE -1              TO BPREM2L
 23363                MOVE  1              TO SET-CURSOR-SW
 23364                GO TO 7499-EXIT
 23365            ELSE
 23366                GO TO 7499-EXIT
 23367        ELSE
 23368            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23369                MOVE AL-UNBON        TO BPREM2A
 23370                MOVE -1              TO BPREM2L
 23371                MOVE  1              TO SET-CURSOR-SW
 23372                GO TO 7499-EXIT
 23373            ELSE
 23374                GO TO 7499-EXIT.
 23375
 23376**2651**
 23377
 23378     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23379        MOVE AL-UABON            TO BSIGA
 23380        MOVE -1                  TO BSIGL
 23381        MOVE  1                  TO SET-CURSOR-SW
 23382        GO TO 7499-EXIT.
 23383
 23384**2653**
 23385
 23386     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 430
* EL6311.cbl
 23387        MOVE AL-UABON            TO BFREQA
 23388        MOVE -1                  TO BFREQL
 23389        MOVE  1                  TO SET-CURSOR-SW
 23390        GO TO 7499-EXIT.
 23391
 23392**2654**
 23393
 23394     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23395        MOVE AL-UABON            TO BFREQA
 23396        MOVE -1                  TO BFREQL
 23397        MOVE  1                  TO SET-CURSOR-SW
 23398        GO TO 7499-EXIT.
 23399
 23400**2655**
 23401
 23402     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23403        MOVE AL-UABON            TO BFREQA
 23404        MOVE -1                  TO BFREQL
 23405        MOVE  1                  TO SET-CURSOR-SW
 23406        GO TO 7499-EXIT.
 23407
 23408**2656**
 23409
 23410     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23411        MOVE AL-UNBON            TO BAPRA
 23412        MOVE -1                  TO BAPRL
 23413        MOVE  1                  TO SET-CURSOR-SW
 23414        GO TO 7499-EXIT.
 23415
 23416**2657**
 23417
 23418     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23419        MOVE AL-UNBON            TO BAPRA
 23420        MOVE -1                  TO BAPRL
 23421        MOVE  1                  TO SET-CURSOR-SW
 23422        GO TO 7499-EXIT.
 23423
 23424**2658**
 23425
 23426     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23427        MOVE AL-UNBON            TO BTERM2A
 23428        MOVE -1                  TO BTERM2L
 23429        MOVE  1                  TO SET-CURSOR-SW
 23430        GO TO 7499-EXIT.
 23431
 23432**2660**
 23433
 23434     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23435        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23436        MOVE -1                  TO BLSTNML
 23437        MOVE  1                  TO SET-CURSOR-SW
 23438        GO TO 7499-EXIT.
 23439
 23440
 23441**2662**
 23442
 23443     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23444        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 431
* EL6311.cbl
 23445        MOVE -1                  TO BAGEL
 23446        MOVE  1                  TO SET-CURSOR-SW
 23447        GO TO 7499-EXIT.
 23448
 23449**2663**
 23450
 23451     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23452        MOVE AL-UNBON            TO BAGEA
 23453        MOVE -1                  TO BAGEL
 23454        MOVE  1                  TO SET-CURSOR-SW
 23455        GO TO 7499-EXIT.
 23456
 23457**2664**
 23458
 23459     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23460        MOVE AL-UABON            TO BREINA
 23461        MOVE -1                  TO BREINL
 23462        MOVE  1                  TO SET-CURSOR-SW
 23463        GO TO 7499-EXIT.
 23464
 23465**2667**
 23466
 23467     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23468        MOVE AL-UNBON            TO BBEN2A
 23469        MOVE -1                  TO BBEN2L
 23470        MOVE  1                  TO SET-CURSOR-SW
 23471        GO TO 7499-EXIT.
 23472
 23473**2668**
 23474
 23475     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23476        MOVE AL-UABON            TO BEFFDTA
 23477        GO TO 7499-EXIT.
 23478
 23479**2669**
 23480
 23481     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23482       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23483       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23484        MOVE AL-UNBON            TO BAGEA
 23485        MOVE -1                  TO BAGEL
 23486        MOVE  1                  TO SET-CURSOR-SW
 23487        GO TO 7499-EXIT.
 23488
 23489**2670**
 23490
 23491     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 23492        MOVE AL-UABON            TO BFORCEA
 23493        MOVE -1                  TO BFORCEL
 23494        MOVE  1                  TO SET-CURSOR-SW
 23495        GO TO 7499-EXIT.
 23496
 23497**2671**
 23498
 23499     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23500        MOVE AL-UABON            TO BEFFDTA
 23501        GO TO 7499-EXIT.
 23502
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 432
* EL6311.cbl
 23503**2672**
 23504
 23505     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23506        MOVE AL-UABON            TO BEFFDTA
 23507        GO TO 7499-EXIT.
 23508
 23509**2673**
 23510
 23511     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23512        MOVE AL-UABON            TO BEFFDTA
 23513        GO TO 7499-EXIT.
 23514
 23515**2674**
 23516
 23517     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23518        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23519        MOVE -1                  TO BTYPE1L
 23520        MOVE  1                  TO SET-CURSOR-SW
 23521        GO TO 7499-EXIT.
 23522
 23523**2677**
 23524
 23525     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23526        MOVE AL-UNBON            TO BTERM1A
 23527        MOVE -1                  TO BTERM1L
 23528        MOVE  1                  TO SET-CURSOR-SW
 23529        GO TO 7499-EXIT.
 23530
 23531**2678**
 23532
 23533     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23534        MOVE AL-UNBON            TO BTERM2A
 23535        MOVE -1                  TO BTERM2L
 23536        MOVE  1                  TO SET-CURSOR-SW
 23537        GO TO 7499-EXIT.
 23538
 23539**2679**
 23540
 23541     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23542        MOVE AL-UABON            TO BTYPE1A
 23543        MOVE -1                  TO BTYPE1L
 23544        MOVE  1                  TO SET-CURSOR-SW
 23545        GO TO 7499-EXIT.
 23546
 23547**2680**
 23548
 23549     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 23550        MOVE AL-UABOF            TO B1STPMTA
 23551        MOVE -1                  TO B1STPMTL
 23552        MOVE  1                  TO SET-CURSOR-SW
 23553        GO TO 7499-EXIT.
 23554
 23555**2681**
 23556
 23557     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23558        MOVE AL-UABON            TO BDAYSA
 23559        MOVE -1                  TO BDAYSL
 23560        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 433
* EL6311.cbl
 23561        GO TO 7499-EXIT.
 23562
 23563**2682**
 23564
 23565     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23566        MOVE AL-UABON            TO BTERM1A
 23567        MOVE -1                  TO BTERM1L
 23568        MOVE  1                  TO SET-CURSOR-SW
 23569        GO TO 7499-EXIT.
 23570
 23571**2683**
 23572
 23573     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23574        MOVE AL-UABON            TO BSKPCDA
 23575        MOVE -1                  TO BSKPCDL
 23576        MOVE  1                  TO SET-CURSOR-SW
 23577        GO TO 7499-EXIT.
 23578
 23579**2684**
 23580
 23581     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23582        MOVE AL-UABON            TO BTYPE2A
 23583        MOVE -1                  TO BTYPE2L
 23584        MOVE  1                  TO SET-CURSOR-SW
 23585        GO TO 7499-EXIT.
 23586
 23587**2686**
 23588
 23589     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23590        MOVE AL-UABON            TO BTYPE2A
 23591        MOVE -1                  TO BTYPE2L
 23592        MOVE  1                  TO SET-CURSOR-SW
 23593        GO TO 7499-EXIT.
 23594
 23595**2689**
 23596
 23597     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23598        MOVE AL-UABON            TO BSIGA
 23599        MOVE -1                  TO BSIGL
 23600        MOVE  1                  TO SET-CURSOR-SW
 23601        GO TO 7499-EXIT.
 23602
 23603**2690**
 23604
 23605     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23606        MOVE AL-UABOF            TO BLNOFCRA
 23607        MOVE -1                  TO BLNOFCRL
 23608        MOVE  1                  TO SET-CURSOR-SW
 23609        GO TO 7499-EXIT.
 23610
 23611**2693**
 23612
 23613     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23614        MOVE AL-UABOF            TO BLNOFCRA
 23615        MOVE AL-UNBON            TO BBEN1A
 23616        MOVE -1                  TO BBEN1L
 23617        MOVE  1                  TO SET-CURSOR-SW
 23618        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 434
* EL6311.cbl
 23619
 23620**2720**
 23621
 23622     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23623        MOVE AL-UNBON            TO BBEN1A
 23624        MOVE -1                  TO BBEN1L
 23625        MOVE  1                  TO SET-CURSOR-SW
 23626        GO TO 7499-EXIT.
 23627
 23628**2709**
 23629
 23630*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23631*       MOVE AL-UNBON            TO BBEN1A
 23632*       MOVE -1                  TO BBEN1L
 23633*       MOVE  1                  TO SET-CURSOR-SW
 23634*       GO TO 7499-EXIT.
 23635
 23636*************************************************************
 23637*                                                           *
 23638*            C A N C E L   E R R O R S                      *
 23639*                                                           *
 23640*************************************************************
 23641
 23642**2726**
 23643
 23644     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23645        MOVE AL-UABON            TO CCERTNOA
 23646        GO TO 7499-EXIT.
 23647
 23648**2728**
 23649
 23650     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23651        MOVE AL-UABON            TO CCERTNOA
 23652        GO TO 7499-EXIT.
 23653
 23654**2729**
 23655
 23656     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23657        MOVE AL-UABON            TO CCERTNOA
 23658        GO TO 7499-EXIT.
 23659
 23660**2730**
 23661
 23662     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23663        MOVE AL-UABON            TO CCERTNOA
 23664        GO TO 7499-EXIT.
 23665
 23666**2731**
 23667
 23668     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23669        MOVE AL-UABON            TO CCANDT1A
 23670        MOVE -1                  TO CCANDT1L
 23671        MOVE  1                  TO SET-CURSOR-SW
 23672        GO TO 7499-EXIT.
 23673
 23674**2732**
 23675
 23676     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 435
* EL6311.cbl
 23677        MOVE AL-UABON            TO CCANDT1A
 23678        MOVE -1                  TO CCANDT1L
 23679        MOVE  1                  TO SET-CURSOR-SW
 23680        GO TO 7499-EXIT.
 23681
 23682**2733**
 23683
 23684     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23685        MOVE AL-UABON            TO CCANDT1A
 23686        MOVE -1                  TO CCANDT1L
 23687        MOVE  1                  TO SET-CURSOR-SW
 23688        GO TO 7499-EXIT.
 23689
 23690**2734**
 23691
 23692     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23693        MOVE AL-UNBON            TO CREFND1A
 23694        MOVE -1                  TO CREFND1L
 23695        MOVE  1                  TO SET-CURSOR-SW
 23696        GO TO 7499-EXIT.
 23697
 23698**2735**
 23699
 23700     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23701        MOVE AL-UABON            TO CCANDT2A
 23702        MOVE -1                  TO CCANDT2L
 23703        MOVE  1                  TO SET-CURSOR-SW
 23704        GO TO 7499-EXIT.
 23705
 23706**2736**
 23707
 23708     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23709        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23710            MOVE AL-UNBON        TO CREFND1A
 23711            MOVE -1              TO CREFND1L
 23712            MOVE  1              TO SET-CURSOR-SW
 23713            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23714                MOVE AL-UNBON        TO CREFND2A
 23715                MOVE -1              TO CREFND2L
 23716                MOVE  1              TO SET-CURSOR-SW
 23717                GO TO 7499-EXIT
 23718            ELSE
 23719                GO TO 7499-EXIT
 23720        ELSE
 23721            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23722                MOVE AL-UNBON        TO CREFND2A
 23723                MOVE -1              TO CREFND2L
 23724                MOVE  1              TO SET-CURSOR-SW
 23725                GO TO 7499-EXIT
 23726            ELSE
 23727                GO TO 7499-EXIT.
 23728
 23729**2738**
 23730
 23731     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23732        MOVE -1                  TO CREFND2L
 23733        MOVE  1                  TO SET-CURSOR-SW
 23734        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 436
* EL6311.cbl
 23735
 23736**2739**
 23737
 23738     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23739        MOVE -1                  TO CREFND1L
 23740        MOVE  1                  TO SET-CURSOR-SW
 23741        GO TO 7499-EXIT.
 23742
 23743**2741**
 23744
 23745     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23746        MOVE -1                  TO CREFND1L
 23747        MOVE  1                  TO SET-CURSOR-SW
 23748        GO TO 7499-EXIT.
 23749
 23750**2743**
 23751
 23752     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23753        MOVE AL-UNBON            TO CCANDT1A
 23754        MOVE -1                  TO CCANDT1L
 23755        MOVE  1                  TO SET-CURSOR-SW
 23756        GO TO 7499-EXIT.
 23757
 23758**2744**
 23759
 23760     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23761        MOVE AL-UNBON            TO CCANDT2A
 23762        MOVE -1                  TO CCANDT2L
 23763        MOVE  1                  TO SET-CURSOR-SW
 23764        GO TO 7499-EXIT.
 23765
 23766**2747**
 23767
 23768     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23769        MOVE AL-UABON            TO CLSTNMA
 23770        MOVE -1                  TO CLSTNML
 23771        MOVE  1                  TO SET-CURSOR-SW
 23772        GO TO 7499-EXIT.
 23773
 23774**2749**
 23775
 23776     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23777        MOVE AL-UABON            TO CFORCEA
 23778        MOVE -1                  TO CFORCEL
 23779        MOVE  1                  TO SET-CURSOR-SW
 23780        GO TO 7499-EXIT.
 23781
 23782**2753**
 23783
 23784     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23785        MOVE AL-UNBON            TO CCANDT1A
 23786        MOVE -1                  TO CCANDT1L
 23787        MOVE  1                  TO SET-CURSOR-SW
 23788        GO TO 7499-EXIT.
 23789
 23790**2755**
 23791
 23792     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 437
* EL6311.cbl
 23793        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23794            MOVE AL-UNBON        TO CREFND1A
 23795            MOVE -1              TO CREFND1L
 23796            MOVE  1              TO SET-CURSOR-SW
 23797            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23798                MOVE AL-UNBON        TO CREFND2A
 23799                MOVE -1              TO CREFND2L
 23800                MOVE  1              TO SET-CURSOR-SW
 23801                GO TO 7499-EXIT
 23802            ELSE
 23803                GO TO 7499-EXIT
 23804        ELSE
 23805            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23806                MOVE AL-UNBON        TO CREFND2A
 23807                MOVE -1              TO CREFND2L
 23808                MOVE  1              TO SET-CURSOR-SW
 23809            ELSE
 23810                GO TO 7499-EXIT.
 23811
 23812**2757**
 23813
 23814     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 23815        MOVE AL-UNBON            TO CLIVESA
 23816        MOVE -1                  TO CLIVESL
 23817        MOVE  1                  TO SET-CURSOR-SW
 23818        GO TO 7499-EXIT.
 23819
 23820**2771**
 23821
 23822     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 23823        MOVE AL-UABON            TO CCANDT2A
 23824        MOVE -1                  TO CCANDT2L
 23825        MOVE  1                  TO SET-CURSOR-SW
 23826        GO TO 7499-EXIT.
 23827
 23828**2774**
 23829
 23830     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 23831        MOVE AL-UABON            TO CCANDT1A
 23832        MOVE -1                  TO CCANDT1L
 23833        MOVE  1                  TO SET-CURSOR-SW
 23834        GO TO 7499-EXIT.
 23835
 23836**2775**
 23837
 23838     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 23839        MOVE AL-UABON            TO CCANDT2A
 23840        MOVE -1                  TO CCANDT2L
 23841        MOVE  1                  TO SET-CURSOR-SW
 23842        GO TO 7499-EXIT.
 23843
 23844**2776**
 23845
 23846     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 23847        MOVE AL-UABON            TO CCANDT1A
 23848        MOVE -1                  TO CCANDT1L
 23849        MOVE  1                  TO SET-CURSOR-SW
 23850        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 438
* EL6311.cbl
 23851
 23852
 23853**2777**
 23854
 23855     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 23856        MOVE AL-UABON            TO CCANDT2A
 23857        MOVE -1                  TO CCANDT2L
 23858        MOVE  1                  TO SET-CURSOR-SW
 23859        GO TO 7499-EXIT.
 23860
 23861**2794**
 23862
 23863     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 23864        MOVE AL-UABON            TO CFORCEA
 23865        MOVE -1                  TO CFORCEL
 23866        MOVE  1                  TO SET-CURSOR-SW
 23867        GO TO 7499-EXIT.
 23868
 23869**2799**
 23870
 23871     IF PI-COMPANY-ID = 'UCL'
 23872         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 23873             MOVE AL-UNBON            TO BEFFDTA
 23874             MOVE -1                  TO BEFFDTL
 23875             MOVE  1                  TO SET-CURSOR-SW
 23876             GO TO 7499-EXIT.
 23877
 23878 7499-EXIT.
 23879      EXIT.
 23880
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 439
* EL6311.cbl
 23882
 23883 7500-READ-ERLOFC.
 23884     MOVE SPACES                 TO  WS-LOAN-OFFICER
 23885                                     ERLOFC-KEY.
 23886
 23887     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 23888
 23889     IF ST-ACCNT-CNTL
 23890         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23891
 23892     IF CARR-GROUP-ST-ACCNT-CNTL
 23893         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23894         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 23895         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 23896
 23897     IF CARR-ST-ACCNT-CNTL
 23898         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23899         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23900
 23901     IF CARR-ACCNT-CNTL
 23902         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 23903
 23904     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 23905
 23906     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 23907
 23908
 23909* EXEC CICS HANDLE CONDITION
 23910*        NOTFND   (7550-OFFICER-NOTFND)
 23911*    END-EXEC.
 23912*    MOVE '"$I                   ! [ #00020112' TO DFHEIV0
 23913     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23914     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23915     MOVE X'5B20233030303230313132' TO DFHEIV0(25:11)
 23916     CALL 'kxdfhei1' USING DFHEIV0
 23917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23918
 23919
 23920
 23921* EXEC CICS READ
 23922*        DATASET   (FILE-ID-ERLOFC)
 23923*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 23924*        RIDFLD    (ERLOFC-KEY)
 23925*        EQUAL
 23926*    END-EXEC.
 23927*    MOVE '&"S        E          (   #00020116' TO DFHEIV0
 23928     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23929     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23930     MOVE X'2020233030303230313136' TO DFHEIV0(25:11)
 23931     CALL 'kxdfhei1' USING DFHEIV0,
 23932           FILE-ID-ERLOFC,
 23933           DFHEIV20,
 23934           DFHEIV99,
 23935           ERLOFC-KEY,
 23936           DFHEIV99,
 23937           DFHEIV99,
 23938           DFHEIV99
 23939     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 440
* EL6311.cbl
 23940         DFHEIV20
 23941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23942
 23943
 23944     GO TO 7599-EXIT.
 23945
 23946 7550-OFFICER-NOTFND.
 23947     MOVE 'X'                    TO WS-LOAN-OFFICER.
 23948
 23949 7599-EXIT.
 23950      EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 441
* EL6311.cbl
 23952******************************************************************
 23953*                                                                *
 23954*            S  E N D    I N I T I A L   M A P                   *
 23955*                                                                *
 23956******************************************************************
 23957
 23958 8100-SEND-INITIAL-MAP.
 23959     MOVE EIBTIME                TO TIME-IN.
 23960
 23961     IF EIBAID = DFHPF11
 23962        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 23963        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23964
 23965
 23966     IF PI-COMPANY-ID = CLIENT-GIC
 23967        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23968                                       BCPREM-ATTRB (2).
 23969
 23970     IF PI-COMPANY-ID = (CLIENT-MIC OR
 23971                         CLIENT-PEM OR
 23972                         CLIENT-CSO)
 23973        AND PI-DISPLAY-ORIGINAL-BATCH
 23974          IF PI-MAP-NAME = EL631B
 23975             MOVE AL-SADOF               TO BPF5HDRA
 23976                                            BPF4HDRA
 23977          ELSE
 23978             IF PI-MAP-NAME = EL631C
 23979                MOVE AL-SADOF            TO CPF5HDRA
 23980                                            CPF4HDRA.
 23981
 23982     IF PI-MAP-NAME = EL631B
 23983        MOVE AL-SADOF               TO BPF5HDRA
 23984     ELSE
 23985        MOVE AL-SADOF               TO CPF5HDRA
 23986     END-IF
 23987
 23988*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23989     IF PI-MAP-NAME = EL631B
 23990          IF PI-COMPANY-ID NOT = 'DMD'
 23991             MOVE AL-SANOF            TO BBILLEDA
 23992             MOVE AL-SADOF            TO DMDBILA.
 23993*DMD CUSTOM CODING*************END
 23994
 23995     IF PI-PROCESSOR-ID = 'LGXX'
 23996        IF PI-MAP-NAME = EL631B
 23997           MOVE AL-SABOF                    TO BREFHDGA
 23998           MOVE AL-SANOF                    TO BREFA
 23999        ELSE
 24000           IF PI-MAP-NAME = EL631C
 24001              MOVE AL-SABOF                 TO CREFHDGA
 24002              MOVE AL-SANOF                 TO CREFA.
 24003
 24004*******      ONLY SHOW CANCEL FEE FOR CLIENT ACE ON EL631C *******
 24005     IF PI-COMPANY-ID = (CLIENT-ACE OR CLIENT-LGX)
 24006        NEXT SENTENCE
 24007     ELSE
 24008        IF PI-MAP-NAME = EL631C
 24009           MOVE AL-SADOF            TO CCANTXTA
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 442
* EL6311.cbl
 24010                                       CCANFEEA.
 24011
 24012     IF PI-MAP-NAME = EL631D
 24013        IF PI-AR-PROCESSING
 24014           MOVE AL-SANOF            TO DREFHDGA
 24015        ELSE
 24016           MOVE AL-SADOF            TO DREFHDGA.
 24017
 24018     IF (PI-COMPANY-ID NOT = 'DCC')
 24019        AND (PI-MAP-NAME = EL631B)
 24020        MOVE AL-SADOF            TO BVINHA
 24021                                    BVINA
 24022     END-IF
 24023     IF PI-MAP-NAME = EL631B
 24024        IF CSR-EDIT-SESSION
 24025           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24026                                 TO BHEADO
 24027           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24028        ELSE
 24029           MOVE AL-SADOF         TO BF15HDRA
 24030           MOVE '4=B-HDR      '  TO BPF4HDRO
 24031        END-IF
 24032        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24033        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24034        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24035        MOVE WS-CURRENT-DT          TO BDATEO
 24036        MOVE TIME-OUT               TO BTIMEO
 24037        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24038        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24039        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24040        IF   WS-DISPLAY-SCREEN
 24041             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24042             MOVE PB-SV-CARRIER     TO BCARRO
 24043             MOVE PB-SV-GROUPING    TO BGROUPO
 24044             MOVE PB-SV-STATE       TO BSTATEO
 24045             MOVE PB-ACCOUNT        TO BACCTO
 24046        ELSE
 24047             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24048     ELSE
 24049        IF PI-MAP-NAME = EL631C
 24050           MOVE '4=B-HDR      '     TO CPF4HDRO
 24051           IF CSR-EDIT-SESSION
 24052              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24053                                 TO CHEADO
 24054           ELSE
 24055              MOVE AL-SADOF      TO CF15HDRA
 24056           END-IF
 24057           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24058           MOVE WS-CURRENT-DT          TO CDATEO
 24059           MOVE TIME-OUT               TO CTIMEO
 24060           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24061           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24062           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24063           MOVE WS-C-HDG               TO CLFHDGO
 24064           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24065           MOVE WS-C-HDG               TO CAHHDGO
 24066           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24067           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 443
* EL6311.cbl
 24068           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24069           IF   WS-DISPLAY-SCREEN
 24070                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24071                MOVE PB-SV-CARRIER     TO CCARRO
 24072                MOVE PB-SV-GROUPING    TO CGROUPO
 24073                MOVE PB-SV-STATE       TO CSTATEO
 24074                MOVE PB-ACCOUNT        TO CACCTO
 24075           ELSE
 24076                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24077        ELSE
 24078           MOVE WS-CURRENT-DT          TO DDATEO
 24079           MOVE TIME-OUT               TO DTIMEO
 24080           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24081                                          WS-REFUND-HDG-OVERRIDE
 24082           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24083           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24084           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24085                                          WS-REFUND-HDG-OVERRIDE
 24086           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24087           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24088           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24089           IF CSR-EDIT-SESSION
 24090              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24091                                 TO DHEADO
 24092           END-IF
 24093           IF  WS-DISPLAY-SCREEN
 24094               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24095               MOVE PB-CARRIER         TO DCARRO
 24096               MOVE PB-GROUPING        TO DGROUPO
 24097               MOVE PB-STATE           TO DSTATEO
 24098               MOVE PB-ACCOUNT         TO DACCTO
 24099               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24100           ELSE
 24101               MOVE EL631D             TO PI-MAP-NAME
 24102               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24103               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24104
 24105     MOVE SPACE                        TO WS-DISPLAY-SW.
 24106
 24107
 24108* EXEC CICS SEND
 24109*        MAP      (PI-MAP-NAME)
 24110*        MAPSET   (MAPSET-EL6311S)
 24111*        FROM     (EL631BI)
 24112*        ERASE
 24113*        CURSOR
 24114*    END-EXEC.
 24115     MOVE LENGTH OF
 24116      EL631BI
 24117       TO DFHEIV12
 24118     MOVE -1
 24119       TO DFHEIV11
 24120*    MOVE '8$     CT  E    H L F ,   #00020286' TO DFHEIV0
 24121     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 24122     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24123     MOVE X'2020233030303230323836' TO DFHEIV0(25:11)
 24124     CALL 'kxdfhei1' USING DFHEIV0,
 24125           PI-MAP-NAME,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 444
* EL6311.cbl
 24126           EL631BI,
 24127           DFHEIV12,
 24128           MAPSET-EL6311S,
 24129           DFHEIV99,
 24130           DFHEIV99,
 24131           DFHEIV99,
 24132           DFHEIV11,
 24133           DFHEIV99,
 24134           DFHEIV99,
 24135           DFHEIV99
 24136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24137
 24138
 24139     GO TO 9100-RETURN-TRAN.
 24140
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 445
* EL6311.cbl
 24142
 24143******************************************************************
 24144*                                                                *
 24145*              S E N D    D A T A O N L Y                        *
 24146*                                                                *
 24147******************************************************************
 24148
 24149 8200-SEND-DATAONLY.
 24150     MOVE EIBTIME                TO TIME-IN.
 24151
 24152     IF PI-COMPANY-ID = CLIENT-GIC
 24153        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24154                                       BCPREM-ATTRB (2).
 24155
 24156     IF PI-MAP-NAME = EL631B
 24157        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24158        MOVE WS-CURRENT-DT          TO BDATEO
 24159        MOVE TIME-OUT               TO BTIMEO
 24160        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24161        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24162        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24163        MOVE SPACES                 TO BPFENTRO
 24164        MOVE AL-UANOF               TO BPFENTRA
 24165
 24166*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24167        IF PI-COMPANY-ID NOT = 'DMD'
 24168             MOVE AL-SANOF            TO BBILLEDA
 24169             MOVE AL-SADOF            TO DMDBILA
 24170         ELSE
 24171            NEXT SENTENCE
 24172*DMD CUSTOM CODING*************END
 24173     ELSE
 24174        IF PI-MAP-NAME = EL631C
 24175           MOVE WS-CURRENT-DT          TO CDATEO
 24176           MOVE TIME-OUT               TO CTIMEO
 24177           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24178           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24179           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24180           MOVE SPACES                 TO CPFENTRO
 24181           MOVE AL-UANOF               TO CPFENTRA
 24182        ELSE
 24183           MOVE WS-CURRENT-DT          TO DDATEO
 24184           MOVE TIME-OUT               TO DTIMEO
 24185           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24186
 24187
 24188* EXEC CICS SEND
 24189*        MAP      (PI-MAP-NAME)
 24190*        MAPSET   (MAPSET-EL6311S)
 24191*        FROM     (EL631BI)
 24192*        DATAONLY
 24193*        CURSOR
 24194*    END-EXEC.
 24195     MOVE LENGTH OF
 24196      EL631BI
 24197       TO DFHEIV12
 24198     MOVE -1
 24199       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 446
* EL6311.cbl
 24200*    MOVE '8$D    CT       H L F ,   #00020342' TO DFHEIV0
 24201     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24202     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24203     MOVE X'2020233030303230333432' TO DFHEIV0(25:11)
 24204     CALL 'kxdfhei1' USING DFHEIV0,
 24205           PI-MAP-NAME,
 24206           EL631BI,
 24207           DFHEIV12,
 24208           MAPSET-EL6311S,
 24209           DFHEIV99,
 24210           DFHEIV99,
 24211           DFHEIV99,
 24212           DFHEIV11,
 24213           DFHEIV99,
 24214           DFHEIV99,
 24215           DFHEIV99
 24216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24217
 24218
 24219     GO TO 9100-RETURN-TRAN.
 24220
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 447
* EL6311.cbl
 24222
 24223******************************************************************
 24224*                                                                *
 24225*           U T I L I T Y   R O U T I N E S                      *
 24226*                                                                *
 24227******************************************************************
 24228
 24229 8300-SEND-TEXT.
 24230
 24231* EXEC CICS SEND TEXT
 24232*        FROM     (LOGOFF-TEXT)
 24233*        LENGTH   (LOGOFF-LENGTH)
 24234*        ERASE
 24235*        FREEKB
 24236*    END-EXEC.
 24237*    MOVE '8&      T  E F  H   F -   #00020361' TO DFHEIV0
 24238     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24239     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24240     MOVE X'2020233030303230333631' TO DFHEIV0(25:11)
 24241     CALL 'kxdfhei1' USING DFHEIV0,
 24242           LOGOFF-TEXT,
 24243           LOGOFF-LENGTH,
 24244           DFHEIV99,
 24245           DFHEIV99,
 24246           DFHEIV99,
 24247           DFHEIV99,
 24248           DFHEIV99,
 24249           DFHEIV99,
 24250           DFHEIV99,
 24251           DFHEIV99,
 24252           DFHEIV99,
 24253           DFHEIV99
 24254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24255
 24256
 24257
 24258* EXEC CICS RETURN
 24259*    END-EXEC.
 24260*    MOVE '.(                    ''   #00020368' TO DFHEIV0
 24261     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24262     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24263     MOVE X'2020233030303230333638' TO DFHEIV0(25:11)
 24264     CALL 'kxdfhei1' USING DFHEIV0,
 24265           DFHEIV99,
 24266           DFHEIV99,
 24267           DFHEIV99,
 24268           DFHEIV99,
 24269           DFHEIV99,
 24270           DFHEIV99
 24271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24272
 24273
 24274 8400-LOG-JOURNAL-RECORD.
 24275     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 24276     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 24277
 24278*    EXEC CICS JOURNAL
 24279*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 448
* EL6311.cbl
 24280*        JTYPEID     ('EL')
 24281*        FROM        (JOURNAL-RECORD)
 24282*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24283*    END-EXEC.
 24284
 24285 8600-DEEDIT.
 24286
 24287* EXEC CICS BIF DEEDIT
 24288*         FIELD   (DEEDIT-FIELD)
 24289*         LENGTH  (15)
 24290*    END-EXEC.
 24291     MOVE 15
 24292       TO DFHEIV11
 24293*    MOVE '@"L                   #   #00020383' TO DFHEIV0
 24294     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24295     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24296     MOVE X'2020233030303230333833' TO DFHEIV0(25:11)
 24297     CALL 'kxdfhei1' USING DFHEIV0,
 24298           DEEDIT-FIELD,
 24299           DFHEIV11
 24300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24301
 24302
 24303 8800-UNAUTHORIZED-ACCESS.
 24304     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24305     GO TO 8300-SEND-TEXT.
 24306
 24307 8810-PF23.
 24308     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24309     MOVE XCTL-EL005             TO PGM-NAME.
 24310     GO TO 9300-XCTL.
 24311
 24312 9100-RETURN-TRAN.
 24313     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24314
 24315     IF  PI-MAP-NAME =  EL631B
 24316         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24317
 24318     IF  PI-MAP-NAME =  EL631C
 24319         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24320
 24321     IF  PI-MAP-NAME =  EL631D
 24322         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24323
 24324
 24325* EXEC CICS RETURN
 24326*        TRANSID    (TRANS-EXB1)
 24327*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24328*        LENGTH     (1300)
 24329*    END-EXEC.
 24330     MOVE 1300
 24331       TO DFHEIV11
 24332*    MOVE '.(CT                  ''   #00020409' TO DFHEIV0
 24333     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24334     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24335     MOVE X'2020233030303230343039' TO DFHEIV0(25:11)
 24336     CALL 'kxdfhei1' USING DFHEIV0,
 24337           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 449
* EL6311.cbl
 24338           PROGRAM-INTERFACE-BLOCK,
 24339           DFHEIV11,
 24340           DFHEIV99,
 24341           DFHEIV99,
 24342           DFHEIV99
 24343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24344
 24345
 24346 9200-RETURN-MAIN-MENU.
 24347     MOVE XCTL-EL626             TO PGM-NAME.
 24348     GO TO 9300-XCTL.
 24349
 24350 9300-XCTL.
 24351
 24352* EXEC CICS XCTL
 24353*        PROGRAM    (PGM-NAME)
 24354*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24355*        LENGTH     (PI-COMM-LENGTH)
 24356*    END-EXEC.
 24357*    MOVE '.$C                   %   #00020420' TO DFHEIV0
 24358     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24359     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24360     MOVE X'2020233030303230343230' TO DFHEIV0(25:11)
 24361     CALL 'kxdfhei1' USING DFHEIV0,
 24362           PGM-NAME,
 24363           PROGRAM-INTERFACE-BLOCK,
 24364           PI-COMM-LENGTH,
 24365           DFHEIV99
 24366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24367
 24368
 24369 9400-CLEAR.
 24370     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24371     GO TO 9300-XCTL.
 24372
 24373 9500-PF12.
 24374     MOVE XCTL-EL010             TO PGM-NAME.
 24375     GO TO 9300-XCTL.
 24376
 24377 9600-PGMID-ERROR.
 24378
 24379* EXEC CICS HANDLE CONDITION
 24380*        PGMIDERR    (8300-SEND-TEXT)
 24381*    END-EXEC.
 24382*    MOVE '"$L                   ! \ #00020435' TO DFHEIV0
 24383     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24384     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24385     MOVE X'5C20233030303230343335' TO DFHEIV0(25:11)
 24386     CALL 'kxdfhei1' USING DFHEIV0
 24387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24388
 24389
 24390     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24391     MOVE ' '                    TO PI-ENTRY-CD-1.
 24392     MOVE XCTL-EL005             TO PGM-NAME.
 24393     MOVE PGM-NAME               TO LOGOFF-PGM.
 24394     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24395     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 450
* EL6311.cbl
 24396
 24397 9700-DATE-LINK.
 24398     MOVE LINK-ELDATCV           TO PGM-NAME.
 24399
 24400* EXEC CICS LINK
 24401*        PROGRAM    (PGM-NAME)
 24402*        COMMAREA   (DATE-CONVERSION-DATA)
 24403*        LENGTH     (DC-COMM-LENGTH)
 24404*    END-EXEC.
 24405*    MOVE '."C                   (   #00020448' TO DFHEIV0
 24406     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24407     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24408     MOVE X'2020233030303230343438' TO DFHEIV0(25:11)
 24409     CALL 'kxdfhei1' USING DFHEIV0,
 24410           PGM-NAME,
 24411           DATE-CONVERSION-DATA,
 24412           DC-COMM-LENGTH,
 24413           DFHEIV99,
 24414           DFHEIV99,
 24415           DFHEIV99,
 24416           DFHEIV99
 24417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24418
 24419
 24420 9800-LINK-PENDING-EDIT.
 24421     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24422     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24423
 24424     MOVE LINK-EL050             TO PGM-NAME
 24425     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24426     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24427                                    WK-CO-TOL-CLAIM
 24428                                    WK-CO-TOL-PREM
 24429                                    WK-CO-TOL-REFUND
 24430                                    WK-CO-TOL-PREM-PCT
 24431                                    WK-CO-TOL-REFUND-PCT
 24432                                    WK-REFUND-OVS-AMT
 24433                                    WK-REFUND-OVS-PCT
 24434                                    WK-ACCT-ADDR
 24435                                    WK-LIFE-EDIT-ADDR
 24436                                    WK-AH-EDIT-ADDR
 24437                                    WK-LIFE-BEN-ADDR
 24438                                    WK-AH-BEN-ADDR
 24439                                    WK-STATE-ADDR
 24440                                    WK-PLAN-ADDR
 24441                                    WK-FORM-ADDR
 24442     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24443
 24444     MOVE '6'                    TO WK-ENTRY-SW.
 24445
 24446     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24447
 24448     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24449                                    EC-AM-EXPIRATION-DT
 24450                                    EC-AM-EFFECTIVE-DT
 24451                                    EC-CM-LF-CANCEL-DT
 24452                                    EC-CM-AH-CANCEL-DT
 24453                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 451
* EL6311.cbl
 24454
 24455     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24456                                    EC-CO-TOL-REFUND
 24457                                    EC-CO-MIN-AGE
 24458                                    EC-CO-MIN-PREMIUM
 24459                                    EC-CO-MIN-TERM
 24460                                    EC-CO-MAX-TERM
 24461                                    EC-ST-TOL-PREM
 24462                                    EC-ST-TOL-REFUND
 24463                                    EC-AM-LF-TOL-PREM
 24464                                    EC-AM-AH-TOL-PREM
 24465                                    EC-AM-LF-MAX-ATT-AGE
 24466                                    EC-AM-LF-MAX-AGE
 24467                                    EC-AM-LF-MAX-TERM
 24468                                    EC-AM-LF-MAX-TOT-BEN
 24469                                    EC-AM-AH-MAX-ATT-AGE
 24470                                    EC-AM-AH-MAX-AGE
 24471                                    EC-AM-AH-MAX-TERM
 24472                                    EC-AM-AH-MAX-TOT-BEN
 24473                                    EC-AM-AH-MAX-MON-BEN
 24474                                    EC-RT-LF-MAX-ATT-AGE
 24475                                    EC-RT-LF-MAX-AGE
 24476                                    EC-RT-LF-MAX-TERM
 24477                                    EC-RT-LF-MAX-TOT-BEN
 24478                                    EC-RT-AH-MAX-ATT-AGE
 24479                                    EC-RT-AH-MAX-AGE
 24480                                    EC-RT-AH-MAX-TERM
 24481                                    EC-RT-AH-MAX-TOT-BEN
 24482                                    EC-RT-AH-MAX-MON-BEN
 24483                                    EC-RT-AH-RATE
 24484                                    EC-RT-LF-RATE
 24485                                    EC-RT-LF-NSP-RATE
 24486                                    EC-RT-AH-NSP-RATE
 24487                                    EC-CM-LF-PRIOR-REFUND
 24488                                    EC-CM-AH-PRIOR-REFUND.
 24489
 24490     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24491                                    EC-ST-TOL-PREM-PCT
 24492                                    EC-AM-LF-TOL-REFUND
 24493                                    EC-AM-LF-DEV-PERCENT
 24494                                    EC-CO-TOL-REFUND-PCT
 24495                                    EC-ST-TOL-REFUND-PCT
 24496                                    EC-AM-AH-TOL-REFUND
 24497                                    EC-AM-AH-DEV-PERCENT.
 24498
 24499
 24500* EXEC CICS LINK
 24501*         PROGRAM   (PGM-NAME)
 24502*         COMMAREA  (PASSED-RECORD)
 24503*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24504*    END-EXEC.
 24505*    MOVE '."C                   (   #00020533' TO DFHEIV0
 24506     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24507     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24508     MOVE X'2020233030303230353333' TO DFHEIV0(25:11)
 24509     CALL 'kxdfhei1' USING DFHEIV0,
 24510           PGM-NAME,
 24511           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 452
* EL6311.cbl
 24512           WS-EDIT-PASS-LENGTH,
 24513           DFHEIV99,
 24514           DFHEIV99,
 24515           DFHEIV99,
 24516           DFHEIV99
 24517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24518
 24519
 24520     MOVE '1'                    TO PI-EDIT-SW.
 24521     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24522
 24523     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24524
 24525     IF PI-COMPANY-ID = 'UCL'
 24526         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24527
 24528     IF VALID-PB-ID
 24529        GO TO 9800-EXIT.
 24530
 24531     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24532
 24533     IF PI-MAP-NAME = EL631B
 24534        MOVE -1                  TO BMAINTL
 24535       ELSE
 24536        MOVE -1                  TO CMAINTL.
 24537
 24538     GO TO 8200-SEND-DATAONLY.
 24539
 24540 9800-EXIT.
 24541      EXIT.
 24542
 24543 9900-ERROR-FORMAT.
 24544
 24545     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24546
 24547     IF NOT EMI-ERRORS-COMPLETE
 24548         MOVE LINK-EL001         TO PGM-NAME
 24549
 24550* EXEC CICS LINK
 24551*            PROGRAM    (PGM-NAME)
 24552*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24553*            LENGTH     (EMI-COMM-LENGTH)
 24554*        END-EXEC.
 24555*    MOVE '."C                   (   #00020568' TO DFHEIV0
 24556     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24557     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24558     MOVE X'2020233030303230353638' TO DFHEIV0(25:11)
 24559     CALL 'kxdfhei1' USING DFHEIV0,
 24560           PGM-NAME,
 24561           ERROR-MESSAGE-INTERFACE-BLOCK,
 24562           EMI-COMM-LENGTH,
 24563           DFHEIV99,
 24564           DFHEIV99,
 24565           DFHEIV99,
 24566           DFHEIV99
 24567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24568
 24569
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 453
* EL6311.cbl
 24570 9900-EXIT.
 24571     EXIT.
 24572
 24573 9990-ABEND.
 24574     MOVE LINK-EL004             TO PGM-NAME.
 24575     MOVE DFHEIBLK               TO EMI-LINE1.
 24576
 24577* EXEC CICS LINK
 24578*        PROGRAM   (PGM-NAME)
 24579*        COMMAREA  (EMI-LINE1)
 24580*        LENGTH    (72)
 24581*    END-EXEC.
 24582     MOVE 72
 24583       TO DFHEIV11
 24584*    MOVE '."C                   (   #00020580' TO DFHEIV0
 24585     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24586     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24587     MOVE X'2020233030303230353830' TO DFHEIV0(25:11)
 24588     CALL 'kxdfhei1' USING DFHEIV0,
 24589           PGM-NAME,
 24590           EMI-LINE1,
 24591           DFHEIV11,
 24592           DFHEIV99,
 24593           DFHEIV99,
 24594           DFHEIV99,
 24595           DFHEIV99
 24596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24597
 24598
 24599     IF PI-MAP-NAME = EL631B
 24600        MOVE -1                  TO BMAINTL
 24601       ELSE
 24602        MOVE -1                  TO CMAINTL.
 24603
 24604     IF EIBTRNID NOT = TRANS-EXB1
 24605        GO TO 8100-SEND-INITIAL-MAP
 24606       ELSE
 24607        GO TO 8200-SEND-DATAONLY.
 24608
 24609 9995-SECURITY-VIOLATION.
 24610*                            COPY ELCSCTP.
 24611******************************************************************
 24612*                                                                *
 24613*                            ELCSCTP                             *
 24614*                            VMOD=2.001                          *
 24615*                                                                *
 24616*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24617******************************************************************
 24618
 24619
 24620     MOVE EIBDATE          TO SM-JUL-DATE.
 24621     MOVE EIBTRMID         TO SM-TERMID.
 24622     MOVE THIS-PGM         TO SM-PGM.
 24623     MOVE EIBTIME          TO TIME-IN.
 24624     MOVE TIME-OUT         TO SM-TIME.
 24625     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24626
 24627
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 454
* EL6311.cbl
 24628* EXEC CICS LINK
 24629*         PROGRAM  ('EL003')
 24630*         COMMAREA (SECURITY-MESSAGE)
 24631*         LENGTH   (80)
 24632*    END-EXEC.
 24633     MOVE 'EL003' TO DFHEIV1
 24634     MOVE 80
 24635       TO DFHEIV11
 24636*    MOVE '."C                   (   #00020614' TO DFHEIV0
 24637     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24638     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24639     MOVE X'2020233030303230363134' TO DFHEIV0(25:11)
 24640     CALL 'kxdfhei1' USING DFHEIV0,
 24641           DFHEIV1,
 24642           SECURITY-MESSAGE,
 24643           DFHEIV11,
 24644           DFHEIV99,
 24645           DFHEIV99,
 24646           DFHEIV99,
 24647           DFHEIV99
 24648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24649
 24650
 24651******************************************************************
 24652
 24653
 24654 9999-DFHBACK SECTION.
 24655     MOVE '9%                    "   ' TO DFHEIV0
 24656     MOVE 'EL6311' TO DFHEIV1
 24657     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24658     GOBACK.
 24659 9999-DFHEXIT.
 24660     IF DFHEIGDJ EQUAL 0001
 24661         NEXT SENTENCE
 24662     ELSE IF DFHEIGDJ EQUAL 2
 24663         GO TO 9600-PGMID-ERROR,
 24664               9990-ABEND,
 24665               9990-ABEND,
 24666               0010-MAIN-LOGIC
 24667         DEPENDING ON DFHEIGDI
 24668     ELSE IF DFHEIGDJ EQUAL 3
 24669         GO TO 1280-BATCH-HDR-NOT-FOUND
 24670         DEPENDING ON DFHEIGDI
 24671     ELSE IF DFHEIGDJ EQUAL 4
 24672         GO TO 1290-DUPLICATE-ALT-INDEX
 24673         DEPENDING ON DFHEIGDI
 24674     ELSE IF DFHEIGDJ EQUAL 5
 24675         GO TO 1295-CERT-TRL-REC-NOTFND
 24676         DEPENDING ON DFHEIGDI
 24677     ELSE IF DFHEIGDJ EQUAL 6
 24678         GO TO 1380-BATCH-HDR-NOT-FOUND
 24679         DEPENDING ON DFHEIGDI
 24680     ELSE IF DFHEIGDJ EQUAL 7
 24681         GO TO 1385-REC-NOT-FOUND
 24682         DEPENDING ON DFHEIGDI
 24683     ELSE IF DFHEIGDJ EQUAL 8
 24684         GO TO 1386-NOTFND
 24685         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 455
* EL6311.cbl
 24686     ELSE IF DFHEIGDJ EQUAL 9
 24687         GO TO 1399-EXIT
 24688         DEPENDING ON DFHEIGDI
 24689     ELSE IF DFHEIGDJ EQUAL 10
 24690         GO TO 1480-BATCH-HDR-NOT-FOUND
 24691         DEPENDING ON DFHEIGDI
 24692     ELSE IF DFHEIGDJ EQUAL 11
 24693         GO TO 1490-RECORD-NOT-FOUND
 24694         DEPENDING ON DFHEIGDI
 24695     ELSE IF DFHEIGDJ EQUAL 12
 24696         GO TO 1405-DELETE-CERTIFICATE
 24697         DEPENDING ON DFHEIGDI
 24698     ELSE IF DFHEIGDJ EQUAL 13
 24699         GO TO 1420-CONTINUE-DELETE
 24700         DEPENDING ON DFHEIGDI
 24701     ELSE IF DFHEIGDJ EQUAL 14
 24702         GO TO 1406-DELETE-ERNOTE
 24703         DEPENDING ON DFHEIGDI
 24704     ELSE IF DFHEIGDJ EQUAL 15
 24705         GO TO 1407-DELETE-MAILING
 24706         DEPENDING ON DFHEIGDI
 24707     ELSE IF DFHEIGDJ EQUAL 16
 24708         GO TO 1420-CONTINUE-DELETE
 24709         DEPENDING ON DFHEIGDI
 24710     ELSE IF DFHEIGDJ EQUAL 17
 24711         GO TO 1480-BATCH-HDR-NOT-FOUND
 24712         DEPENDING ON DFHEIGDI
 24713     ELSE IF DFHEIGDJ EQUAL 18
 24714         GO TO 1475-DELETE-FINISHED
 24715         DEPENDING ON DFHEIGDI
 24716     ELSE IF DFHEIGDJ EQUAL 19
 24717         GO TO 2280-BATCH-HDR-NOT-FOUND
 24718         DEPENDING ON DFHEIGDI
 24719     ELSE IF DFHEIGDJ EQUAL 20
 24720         GO TO 2290-DUPLICATE-ALT-INDEX
 24721         DEPENDING ON DFHEIGDI
 24722     ELSE IF DFHEIGDJ EQUAL 21
 24723         GO TO 2380-BATCH-HDR-NOT-FOUND
 24724         DEPENDING ON DFHEIGDI
 24725     ELSE IF DFHEIGDJ EQUAL 22
 24726         GO TO 2385-REC-NOT-FOUND
 24727         DEPENDING ON DFHEIGDI
 24728     ELSE IF DFHEIGDJ EQUAL 23
 24729         GO TO 2380-BATCH-HDR-NOT-FOUND
 24730         DEPENDING ON DFHEIGDI
 24731     ELSE IF DFHEIGDJ EQUAL 24
 24732         GO TO 2485-BATCH-HDR-NOT-FOUND
 24733         DEPENDING ON DFHEIGDI
 24734     ELSE IF DFHEIGDJ EQUAL 25
 24735         GO TO 2490-RECORD-NOT-FOUND
 24736         DEPENDING ON DFHEIGDI
 24737     ELSE IF DFHEIGDJ EQUAL 26
 24738         GO TO 2475-CONTINUE-DELETE
 24739         DEPENDING ON DFHEIGDI
 24740     ELSE IF DFHEIGDJ EQUAL 27
 24741         GO TO 2485-BATCH-HDR-NOT-FOUND
 24742         DEPENDING ON DFHEIGDI
 24743     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 456
* EL6311.cbl
 24744         GO TO 2480-DELETE-FINISHED
 24745         DEPENDING ON DFHEIGDI
 24746     ELSE IF DFHEIGDJ EQUAL 29
 24747         GO TO 2820-PROCESS-REWRITE
 24748         DEPENDING ON DFHEIGDI
 24749     ELSE IF DFHEIGDJ EQUAL 30
 24750         GO TO 2885-RECORD-MISSING
 24751         DEPENDING ON DFHEIGDI
 24752     ELSE IF DFHEIGDJ EQUAL 31
 24753         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24754         DEPENDING ON DFHEIGDI
 24755     ELSE IF DFHEIGDJ EQUAL 32
 24756         GO TO 2827-DELETE-MAILING
 24757         DEPENDING ON DFHEIGDI
 24758     ELSE IF DFHEIGDJ EQUAL 33
 24759         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24760         DEPENDING ON DFHEIGDI
 24761     ELSE IF DFHEIGDJ EQUAL 34
 24762         GO TO 2920-PROCESS-REWRITE
 24763         DEPENDING ON DFHEIGDI
 24764     ELSE IF DFHEIGDJ EQUAL 35
 24765         GO TO 2985-RECORD-MISSING
 24766         DEPENDING ON DFHEIGDI
 24767     ELSE IF DFHEIGDJ EQUAL 36
 24768         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24769         DEPENDING ON DFHEIGDI
 24770     ELSE IF DFHEIGDJ EQUAL 37
 24771         GO TO 2990-DUPLICATE-RECORD
 24772         DEPENDING ON DFHEIGDI
 24773     ELSE IF DFHEIGDJ EQUAL 38
 24774         GO TO 3590-NOT-FOUND
 24775         DEPENDING ON DFHEIGDI
 24776     ELSE IF DFHEIGDJ EQUAL 39
 24777         GO TO 3690-NOT-FOUND
 24778         DEPENDING ON DFHEIGDI
 24779     ELSE IF DFHEIGDJ EQUAL 40
 24780         GO TO 3990-NOT-FOUND
 24781         DEPENDING ON DFHEIGDI
 24782     ELSE IF DFHEIGDJ EQUAL 41
 24783         GO TO 4050-END-RECORDS,
 24784               4050-END-RECORDS
 24785         DEPENDING ON DFHEIGDI
 24786     ELSE IF DFHEIGDJ EQUAL 42
 24787         GO TO 4150-END-BATCH
 24788         DEPENDING ON DFHEIGDI
 24789     ELSE IF DFHEIGDJ EQUAL 43
 24790         GO TO 4150-END-BATCH
 24791         DEPENDING ON DFHEIGDI
 24792     ELSE IF DFHEIGDJ EQUAL 44
 24793         GO TO 4250-END-RECORDS,
 24794               4250-END-RECORDS
 24795         DEPENDING ON DFHEIGDI
 24796     ELSE IF DFHEIGDJ EQUAL 45
 24797         GO TO 4350-END-BATCH,
 24798               4350-END-BATCH
 24799         DEPENDING ON DFHEIGDI
 24800     ELSE IF DFHEIGDJ EQUAL 46
 24801         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 27-Aug-14 10:41 Page 457
* EL6311.cbl
 24802               4550-END-RECORDS
 24803         DEPENDING ON DFHEIGDI
 24804     ELSE IF DFHEIGDJ EQUAL 47
 24805         GO TO 4680-NOT-FOUND,
 24806               4680-NOT-FOUND
 24807         DEPENDING ON DFHEIGDI
 24808     ELSE IF DFHEIGDJ EQUAL 48
 24809         GO TO 4860-NOT-FOUND,
 24810               4850-END-RECORDS
 24811         DEPENDING ON DFHEIGDI
 24812     ELSE IF DFHEIGDJ EQUAL 49
 24813         GO TO 4970-NOT-FOUND,
 24814               4950-END-RECORDS
 24815         DEPENDING ON DFHEIGDI
 24816     ELSE IF DFHEIGDJ EQUAL 50
 24817         GO TO 5050-NOT-FOUND
 24818         DEPENDING ON DFHEIGDI
 24819     ELSE IF DFHEIGDJ EQUAL 51
 24820         GO TO 5050-NOT-FOUND
 24821         DEPENDING ON DFHEIGDI
 24822     ELSE IF DFHEIGDJ EQUAL 52
 24823         GO TO 5050-NOT-FOUND
 24824         DEPENDING ON DFHEIGDI
 24825     ELSE IF DFHEIGDJ EQUAL 53
 24826         GO TO 5550-END-RECORDS,
 24827               5550-END-RECORDS
 24828         DEPENDING ON DFHEIGDI
 24829     ELSE IF DFHEIGDJ EQUAL 54
 24830         GO TO 6050-QID-ERROR
 24831         DEPENDING ON DFHEIGDI
 24832     ELSE IF DFHEIGDJ EQUAL 55
 24833         GO TO 6050-QID-ERROR
 24834         DEPENDING ON DFHEIGDI
 24835     ELSE IF DFHEIGDJ EQUAL 56
 24836         GO TO 6400-CONTINUE,
 24837               6400-CONTINUE
 24838         DEPENDING ON DFHEIGDI
 24839     ELSE IF DFHEIGDJ EQUAL 57
 24840         GO TO 3690-NOT-FOUND
 24841         DEPENDING ON DFHEIGDI
 24842     ELSE IF DFHEIGDJ EQUAL 58
 24843         GO TO 7399-EXIT
 24844         DEPENDING ON DFHEIGDI
 24845     ELSE IF DFHEIGDJ EQUAL 59
 24846         GO TO 7550-OFFICER-NOTFND
 24847         DEPENDING ON DFHEIGDI
 24848     ELSE IF DFHEIGDJ EQUAL 60
 24849         GO TO 8300-SEND-TEXT
 24850         DEPENDING ON DFHEIGDI.
 24851     MOVE '9%                    "   ' TO DFHEIV0
 24852     MOVE 'EL6311' TO DFHEIV1
 24853     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24854     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14900     Code:       98475
