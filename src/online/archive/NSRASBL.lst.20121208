* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* NSRASBL.cbl
* Options: int("NSRASBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("NSRASBL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"NSRASBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"NSRASBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   NSRASBL.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM NSRASLTR
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* ChangeS ARE MARKED BY THE Change EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  Change   Change REQUEST PGMR  DESCRIPTION OF Change
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* NSRASBL.cbl
    14* 060611    2011022800001  PEMA  NEW PROGRAM
    15* 122911    2011022800001  AJRA  ADD VA DISCLOSURE TO CERT PRINT
    16* 071212    2011022800001  AJRA  ADD UNDW ID
    17* 072312    2011022800001  AJRA    ADD NEW FIELDS
    18* 090612  IR2012090600001  AJRA  NAPERSOFT
    19* 091112  IR2012091100002  AJRA  FIX AKA
    20* 091312  IR2012091100004  AJRA  FIX JOINT NAME
    21* 092412  IR2012092350004  AJRA  FIX CANCEL AMT
    22* 100112  IR2012100100002  AJRA  FIX ADDRESS WITH 2 SPACES
    23* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    24******************************************************************
    25 ENVIRONMENT DIVISION.
    26 DATA DIVISION.
    27 working-storage section.
    28 01  DFH-START PIC X(04).
    29 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    30 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    31 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    32 77  S1                          PIC S999 COMP-3 VALUE +0.
    33 77  E1                          PIC S999 COMP-3 VALUE +0.
    34 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    35 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    36 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    37 77  WS-ARCHIVE-NO               PIC S9(8)  COMP VALUE +0.
    38 77  WS-FOLLOW-UP-DT             PIC XX  VALUE LOW-VALUES.
    39 77  WS-RESEND-DT                PIC XX  VALUE LOW-VALUES.
    40 77  WS-AUTO-LAST-SCHED-DT       PIC XX  VALUE LOW-VALUES.
    41 77  WS-LAST-ACT-DT              PIC XX  VALUE LOW-VALUES.
    42 77  WS-ACTIVITY-DT              PIC XX  VALUE LOW-VALUES.
    43 77  WS-FORM                     PIC XXXX  VALUE SPACES.
    44 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    45 77  WS-FOUND-BENE-SW            PIC X   VALUE ' '.
    46     88  FOUND-BENE                  VALUE 'Y'.
    47 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    48 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    49 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    50 77  WS-ERPNDB-SW                PIC X  VALUE ' '.
    51     88  END-OF-ERPNDB              VALUE 'Y'.
    52 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    53     88  ACCT-FOUND                 VALUE 'Y'.
    54 77  WS-ELCERT-SW                PIC X  VALUE ' '.
    55     88  CERT-FOUND                 VALUE 'Y'.
    56     88  CERT-NOT-FOUND             VALUE 'N'.
    57 77  WS-ERENDT-SW                PIC X  VALUE ' '.
    58     88  ENDT-FOUND                 VALUE 'Y'.
    59     88  ENDT-NOT-FOUND             VALUE 'N'.
    60 77  WS-LF-ABBRV                 PIC X(10) VALUE SPACES.
    61 77  WS-LF-DESC                  PIC X(02) VALUE SPACES.
    62 77  WS-LF-EARN                  PIC X     VALUE ' '.
    63 77  WS-WAIT-PER                 PIC X(03) VALUE ZEROS.
    64 77  WS-RET-ELIM                 PIC X(01) VALUE SPACES.
    65 77  WS-AH-DESC                  PIC X(35) VALUE SPACES.
    66 77  WS-BEN-DAYS                 PIC X(02) VALUE ZEROS.
    67 77  WS-CSR-ID                   PIC XXXX  VALUE SPACES.
    68 77  WS-LF-BENCD                 PIC XX    VALUE '00'.
    69 77  WS-AH-BENCD                 PIC XX    VALUE '00'.
    70 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    71 77  WS-COMPANY-CD               PIC X  VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* NSRASBL.cbl
    72 77  WS-WORK-PREM                PIC S9(9)V99 COMP-3 VALUE +0.
    73 77  WS-WORK-LF-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    74 77  WS-WORK-AH-PREM             PIC S9(9)V99 COMP-3 VALUE +0.
    75 77  WS-WORK-REF                 PIC S9(9)V99 COMP-3 VALUE +0.
    76 77  WS-WORK-LF-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    77 77  WS-WORK-AH-REF              PIC S9(9)V99 COMP-3 VALUE +0.
    78 77  WS-ISSUE-CANCEL-SW          PIC X  VALUE SPACES.
    79     88  PROCESS-ISSUE               VALUE 'I'.
    80     88  PROCESS-CANCEL              VALUE 'C'.
    81 77  WS-SAVE-OUT-LETTER          PIC X(6)  VALUE SPACES.
    82 77  WS-WORK-COMM                PIC 9(7)V99 VALUE ZEROS.
    83 77  WS-DIFF                     PIC 999 VALUE ZEROS.
    84 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
    85 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    86 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    87 77  WS-INS-BIRTH-DATE           PIC X(21)  VALUE SPACES.
    88 77  WS-JNT-BIRTH-DATE           PIC X(21)  VALUE SPACES.
    89 77  WS-NH-INT                   PIC 9(7).99 VALUE ZEROS.
    90 77  WS-CERT-FORM-ID             PIC X(5) VALUE SPACES.
    91 77  LINK-ELVADS                 PIC X(8) VALUE 'ELVADS'.
    92 01  WS-SAVE-ERACCT-REC          PIC X(2000).
    93 01  WS-XML-WORK                 PIC X(4200)  VALUE SPACES.
    94 01 response-code         pic s9(8) comp.
    95 01 display-response      pic 9(8).
    96 01 bl-index              pic 9(8) comp.
    97 01 max-last-name         pic x(18).
    98 01 first-initial         pic x.
    99 01 name-in-range-flag    pic 9.
   100 01 max-entries           pic s9(8) comp value 100.
   101 01 WS-PASSED-DT          PIC XX   VALUE LOW-VALUES.
   102 01 lower-case    pic x(26) value
   103            "abcdefghijklmnopqrstuvwxyz".
   104 01 upper-case    pic x(26) value
   105            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
   106
   107*                                COPY ELCVADS.
   108******************************************************************
   109*                                                                *
   110*                                                                *
   111*                            ELCVADS.                            *
   112*                                                                *
   113*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
   114*   ELVADS                  LENGTH = 350                         *
   115******************************************************************
   116******************************************************************
   117*                   C H A N G E   L O G
   118*
   119* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   120*-----------------------------------------------------------------
   121*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   122* EFFECTIVE    NUMBER
   123*-----------------------------------------------------------------
   124* 100111    2011022800001  AJRA  NAPERSOFT
   125******************************************************************
   126
   127 01  VIRGINIA-DISCLOSURE.
   128     12  VD-COMPANY-CD              PIC X.
   129     12  VD-CARRIER                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* NSRASBL.cbl
   130     12  VD-GROUPING.
   131         20  VD-GROUPING-PREFIX     PIC XXX.
   132         20  VD-GROUPING-PRIME      PIC XXX.
   133     12  VD-STATE                   PIC XX.
   134     12  VD-ACCOUNT.
   135         20  VD-ACCOUNT-PREFIX      PIC X(4).
   136         20  VD-ACCOUNT-PRIME       PIC X(6).
   137     12  VD-CERT-EFF-DT             PIC XX.
   138     12  VD-CERT-NO.
   139         20  VD-CERT-PRIME          PIC X(10).
   140         20  VD-CERT-SFX            PIC X.
   141     12  VD-ENTRY-BATCH             PIC X(6).
   142     12  VD-CSR-ID                  PIC X(4).
   143     12  VD-NAME.
   144         20  VD-INSURED-LAST-NAME   PIC X(15).
   145         20  VD-INSURED-FIRST-NAME.
   146             24  VD-INSURED-1ST-INIT PIC X.
   147             24  FILLER             PIC X(9).
   148         20  VD-INSURED-MIDDLE-INIT PIC X.
   149     12  VD-JOINT-INSURED.
   150         20 VD-JOINT-LAST-NAME      PIC X(15).
   151         20 VD-JOINT-FIRST-NAME.
   152            24  VD-JOINT-FIRST-INIT PIC X.
   153            24  FILLER              PIC X(9).
   154         20 VD-JOINT-MIDDLE-INIT    PIC X.
   155     12  VD-INSURED-ADDRESS-1       PIC X(30).
   156     12  VD-INSURED-ADDRESS-2       PIC X(30).
   157     12  VD-INSURED-CITY-STATE.
   158         20  VD-INSURED-CITY        PIC X(28).
   159         20  VD-INSURED-STATE       PIC XX.
   160     12  VD-INSURED-ZIP-CODE.
   161         20  VD-INSURED-ZIP-PRIME.
   162             24  VD-INSURED-ZIP-1   PIC X.
   163                 88  VD-CANADIAN-POST-CODE
   164                                       VALUE 'A' THRU 'Z'.
   165             24  FILLER             PIC X(4).
   166         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
   167     12  VD-BENEFICIARY-NAME        PIC X(30).
   168     12  VD-ACCOUNT-NAME            PIC X(30).
   169     12  VD-LOAN-TERM               PIC S999   COMP-3.
   170     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   171     12  VD-1ST-PMT-DT              PIC XX.
   172     12  VD-LIFE-BENEFIT-CD         PIC XX.
   173         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
   174         88  VD-INVALID-LIFE           VALUE '  ' '00'
   175                                             '90' THRU '99'.
   176     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
   177                                    PIC XX.
   178     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   179     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   180     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
   181     12  VD-LF-TERM                 PIC S999   COMP-3.
   182     12  VD-AH-BENEFIT-CD           PIC XX.
   183         88  VD-VALID-AH               VALUE '01' THRU '89'.
   184         88  VD-INVALID-AH             VALUE '  ' '00'
   185                                             '90' THRU '99'.
   186     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   187     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* NSRASBL.cbl
   188     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
   189     12  VD-AH-TERM                 PIC S999   COMP-3.
   190     12  VD-LETTER-ID               PIC X(4).
   191     12  VD-PROC-ID                 PIC X(4).
   192     12  VD-COMP-ID                 PIC X(3).
   193     12  VD-CURRENT-DATE            PIC XX.
   194     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
   195     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
   196     12  FILLER                     PIC X(32).
   197 01  WS-PASS-AREA.
   198     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   199     05  WS-PASS-VADS-REC    PIC X(350).
   200
   201*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   202*                         COPY ELCZREC.
   203******************************************************************
   204*                                                                *
   205*                                                                *
   206*                            ELCZREC.                            *
   207*                                                                *
   208*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   209*                                                                *
   210******************************************************************
   211*-----------------------------------------------------------------
   212*                   C H A N G E   L O G
   213*
   214* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   215*-----------------------------------------------------------------
   216*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   217* EFFECTIVE    NUMBER
   218*-----------------------------------------------------------------
   219* 122011    2011022800001  AJRA  NEW FILE
   220* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   221*-----------------------------------------------------------------
   222 01  W-Z-CONTROL-DATA.
   223     05  W-NUMBER-OF-COPIES      PIC  9.
   224     05  FILLER                  PIC  X.
   225     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   226     05  FILLER                  PIC  X.
   227     05  W-DAYS-TO-RESEND        PIC  999.
   228     05  FILLER                  PIC  X.
   229     05  W-FORM-TO-RESEND        PIC  X(4).
   230     05  FILLER                  PIC  X.
   231     05  W-PROMPT-LETTER         PIC  X.
   232     05  FILLER                  PIC  X.
   233     05  W-ENCLOSURE-CD          PIC  XXX.
   234     05  FILLER                  PIC  X.
   235     05  W-AUTO-CLOSE-IND        PIC  X.
   236     05  FILLER                  PIC  X.
   237     05  W-LETTER-TO-BENE        PIC  X.
   238     05  FILLER                  PIC  X.
   239     05  W-LETTER-TO-ACCT        PIC  X.
   240     05  FILLER                  PIC  X.
   241     05  W-LETTER-TYPE           PIC  X.
   242     05  FILLER                  PIC  X.
   243     05  W-PRINT-CERTIFICATE     PIC  X.
   244     05  FILLER                  PIC  X.
   245     05  W-REFUND-REQUIRED       PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* NSRASBL.cbl
   246     05  FILLER                  PIC  X.
   247     05  W-ONBASE-CODE           PIC  XX.
   248     05  FILLER                  PIC  X.
   249     05  W-ACCT-SUMM             PIC  X.
   250     05  FILLER                  PIC  X.
   251     05  W-CSO-SUMM              PIC  X.
   252     05  FILLER                  PIC  X(31).
   253 01  MISC.
   254     12  WS-RESPONSE             PIC S9(8)   COMP.
   255         88  RESP-NORMAL                  VALUE +00.
   256         88  RESP-NOTFND                  VALUE +13.
   257         88  RESP-DUPREC                  VALUE +14.
   258         88  RESP-DUPKEY                  VALUE +15.
   259         88  RESP-NOTOPEN                 VALUE +19.
   260         88  RESP-ENDFILE                 VALUE +20.
   261 01  srch-commarea.
   262*                                copy ELCADLTRSPI.
   263******************************************************************
   264*                   C H A N G E   L O G
   265*
   266* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   267*-----------------------------------------------------------------
   268*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   269* EFFECTIVE    NUMBER
   270*-----------------------------------------------------------------
   271* 060611    2011022800001  PEMA  NEW COPYBOOK
   272******************************************************************
   273****************************************
   274*  commarea for NaperSoft On Demand Admin services letters
   275*  (business logic input & output)
   276****************************************
   277     03  BL-INPUT.
   278         05  BL-DATA-SRCE        PIC X.
   279         05  BL-LETTER-ID        PIC XXXX.
   280         05  BL-CARRIER          PIC X.
   281         05  BL-GROUP            PIC X(6).
   282         05  BL-STATE            PIC XX.
   283         05  BL-ACCOUNT          PIC X(10).
   284         05  BL-EFF-DT           PIC X(10).
   285         05  BL-CERT-NO          PIC X(11).
   286         05  BL-BATCH-NO         PIC X(6).
   287         05  BL-BATCH-SEQ        PIC 9(8).
   288         05  BL-RESP-NO          PIC X(10).
   289         05  BL-NO-OF-COPIES     PIC 99.
   290         05  BL-PROC-ID          PIC XXXX.
   291         05  BL-COMP-ID          PIC XXX.
   292         05  BL-PRINT-NOW-SW     PIC X.
   293         05  BL-ENC-CD           PIC XXX.
   294         05  BL-RESEND-DT        PIC X(10).
   295         05  BL-FOLLOW-UP-DT     PIC X(10).
   296         05  BL-ARCHIVE-NO       PIC 9(8).
   297         05  BL-FUNC             PIC X(8).
   298         05  BL-COMMENTS         PIC X(70).
   299         05  FILLER REDEFINES BL-COMMENTS.
   300             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   301             10  BL-LETTER-TO-ACCT PIC X.
   302             10  BL-LETTER-TO-BENE PIC X.
   303             10  BL-WRITE-ERARCH   PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* NSRASBL.cbl
   304                 88  ERARCH-QWS      VALUE 'Q'.
   305                 88  ERARCH-BATCH    VALUE 'B'.
   306                 88  ERARCH-TEMP     VALUE 'T'.
   307             10  BL-PROCESS-TYPE PIC X(07).
   308             10  BL-CERT-FORM-ID PIC X(05).
   309             10  FILLER          PIC X(07).
   310     03  BL-OUTPUT.
   311         05  BL-STATUS                   PIC X.
   312             88  BL-OK                      VALUE "P".
   313             88  BL-FAIL                  VALUE "F".
   314         05  BL-MESSAGE          PIC X(50).
   315     03  BL-RECORD-PASSED-DATA   PIC X(4754).
   316 01  filler                      pic x(500).
   317 01  WS-SAVE-CARRIER-INFO.
   318     05  WS-PREV-CARRIER         PIC X      VALUE SPACES.
   319     05  WS-CARR-NAME            PIC X(30)  VALUE SPACES.
   320     05  WS-CARR-ICO             PIC X(30)  VALUE SPACES.
   321     05  WS-CARR-ADDR1           PIC X(30)  VALUE SPACES.
   322     05  WS-CARR-ADDR2           PIC X(30)  VALUE SPACES.
   323     05  WS-CARR-CITYST          PIC X(30)  VALUE SPACES.
   324     05  WS-CARR-ZIP             PIC X(9)   VALUE SPACES.
   325     05  WS-CARR-PHONE           PIC X(11)  VALUE SPACES.
   326 01  WS-SAVE-STATE-INFO.
   327     05  WS-PREV-STATE           PIC XX     VALUE SPACES.
   328     05  WS-STATE-NAME           PIC X(25)  VALUE SPACES.
   329 01  WS-SAVE-LFBEN-INFO.
   330     05  WS-PREV-LFBEN           PIC XX     VALUE SPACES.
   331     05  WS-LFBEN-ALPH           PIC XXX    VALUE SPACES.
   332     05  WS-LFBEN-DESC           PIC X(10)  VALUE SPACES.
   333 01  WS-SAVE-AHBEN-INFO.
   334     05  WS-PREV-AHBEN           PIC XX     VALUE SPACES.
   335     05  WS-AHBEN-DESC           PIC X(10)  VALUE SPACES.
   336     05  WS-AHBEN-RET-ELIM       PIC X      VALUE SPACES.
   337     05  WS-AHBEN-DAYS           PIC XX     VALUE SPACES.
   338 01  WS-ERPNDB-KEY.
   339     05  WS-ERPNDB-COMPANY-CD    PIC X.
   340     05  WS-ERPNDB-BATCH-NO      PIC X(6).
   341     05  WS-ERPNDB-BATCH-SEQ     PIC S9(4) COMP  VALUE +0.
   342     05  WS-ERPNDB-CHG-SEQ       PIC S9(4) COMP  VALUE +0.
   343 01  WS-ELENCC-KEY.
   344     05  WS-ELENCC-COMPANY-CD    PIC X.
   345     05  WS-ELENCC-REC-TYPE      PIC X.
   346     05  WS-ELENCC-ENC-CODE      PIC X(5).
   347     05  F                       PIC X(9).
   348 01  WS-ELCERT-KEY.
   349     05  WS-ELCERT-COMPANY-CD    PIC X.
   350     05  WS-ELCERT-CARRIER       PIC X.
   351     05  WS-ELCERT-GROUP         PIC X(6).
   352     05  WS-ELCERT-STATE         PIC XX.
   353     05  WS-ELCERT-ACCOUNT       PIC X(10).
   354     05  WS-ELCERT-EFF-DT        PIC XX.
   355     05  WS-ELCERT-CERT-NO       PIC X(11).
   356 01  WS-ERENDT-KEY.
   357     05  WS-ERENDT-COMPANY-CD    PIC X.
   358     05  WS-ERENDT-CARRIER       PIC X.
   359     05  WS-ERENDT-GROUP         PIC X(6).
   360     05  WS-ERENDT-STATE         PIC XX.
   361     05  WS-ERENDT-ACCOUNT       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* NSRASBL.cbl
   362     05  WS-ERENDT-EFF-DT        PIC XX.
   363     05  WS-ERENDT-CERT-NO       PIC X(11).
   364     05  WS-ERENDT-REC-TYPE      PIC X.
   365     05  WS-ERENDT-SEQ-NO        PIC 9(4) BINARY.
   366 01  WS-ERCOMP-KEY.
   367     05  WS-ERCOMP-COMPANY-CD    PIC X.
   368     05  WS-ERCOMP-CARRIER       PIC X.
   369     05  WS-ERCOMP-GROUP         PIC X(6).
   370     05  WS-ERCOMP-RESP-NO       PIC X(10).
   371     05  WS-ERCOMP-ACCOUNT       PIC X(10).
   372     05  WS-ERCOMP-REC-TYPE      PIC X.
   373 01  WS-ERMAIL-KEY.
   374     05  WS-ERMAIL-COMPANY-CD    PIC X.
   375     05  WS-ERMAIL-CARRIER       PIC X.
   376     05  WS-ERMAIL-GROUP         PIC X(6).
   377     05  WS-ERMAIL-STATE         PIC XX.
   378     05  WS-ERMAIL-ACCOUNT       PIC X(10).
   379     05  WS-ERMAIL-EFF-DT        PIC XX.
   380     05  WS-ERMAIL-CERT-NO       PIC X(11).
   381 01  WS-ERACCT-KEY.
   382     05  WS-ERACCT-COMPANY-CD    PIC X.
   383     05  WS-ERACCT-CARRIER       PIC X.
   384     05  WS-ERACCT-GROUP         PIC X(6).
   385     05  WS-ERACCT-STATE         PIC XX.
   386     05  WS-ERACCT-ACCOUNT       PIC X(10).
   387     05  WS-ERACCT-EXP-DT        PIC XX.
   388     05  FILLER                  PIC XXXX.
   389 01  WS-ELLETR-KEY.
   390     05  WS-ELLETR-COMPANY-CD    PIC X.
   391     05  WS-ELLETR-LETTER-ID     PIC X(12).
   392     05  WS-ELLETR-SEQ-NO        PIC S9(4) COMP VALUE +0.
   393 01  WS-ELCNTL-KEY.
   394     05  WS-ELCNTL-COMPANY-ID    PIC XXX.
   395     05  WS-ELCNTL-REC-TYPE      PIC X.
   396     05  WS-ELCNTL-GENL.
   397         10  WS-ELCNTL-STATE     PIC XX  VALUE SPACES.
   398         10  WS-ELCNTL-BEN-CD.
   399             15  F               PIC X.
   400             15  WS-ELCNTL-CARR  PIC X.
   401     05  WS-ELCNTL-SEQ-NO        PIC S9(4) COMP.
   402*                                COPY ELCDATE.
   403******************************************************************
   404*                                                                *
   405*                                                                *
   406*                            ELCDATE.                            *
   407*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   408*                            VMOD=2.003
   409*                                                                *
   410*                                                                *
   411*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   412*                 LENGTH = 200                                   *
   413******************************************************************
   414
   415 01  DATE-CONVERSION-DATA.
   416     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   417     12  DC-OPTION-CODE                PIC X.
   418         88  BIN-TO-GREG                VALUE ' '.
   419         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* NSRASBL.cbl
   420         88  EDIT-GREG-TO-BIN           VALUE '2'.
   421         88  YMD-GREG-TO-BIN            VALUE '3'.
   422         88  MDY-GREG-TO-BIN            VALUE '4'.
   423         88  JULIAN-TO-BIN              VALUE '5'.
   424         88  BIN-PLUS-ELAPSED           VALUE '6'.
   425         88  FIND-CENTURY               VALUE '7'.
   426         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   427         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   428         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   429         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   430         88  JULIAN-TO-BIN-3            VALUE 'C'.
   431         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   432         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   433         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   434         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   435         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   436         88  CHECK-LEAP-YEAR            VALUE 'H'.
   437         88  BIN-3-TO-GREG              VALUE 'I'.
   438         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   439         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   440         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   441         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   442         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   443         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   444         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   445         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   446         88  THREE-CHARACTER-BIN
   447                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   448         88  GREGORIAN-TO-BIN
   449                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   450         88  BIN-TO-GREGORIAN
   451                  VALUES ' ' '1' 'I' '8' 'G'.
   452         88  JULIAN-TO-BINARY
   453                  VALUES '5' 'C' 'E' 'F'.
   454     12  DC-ERROR-CODE                 PIC X.
   455         88  NO-CONVERSION-ERROR        VALUE ' '.
   456         88  DATE-CONVERSION-ERROR
   457                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   458         88  DATE-IS-ZERO               VALUE '1'.
   459         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   460         88  DATE-IS-INVALID            VALUE '3'.
   461         88  DATE1-GREATER-DATE2        VALUE '4'.
   462         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   463         88  DATE-INVALID-OPTION        VALUE '9'.
   464         88  INVALID-CENTURY            VALUE 'A'.
   465         88  ONLY-CENTURY               VALUE 'B'.
   466         88  ONLY-LEAP-YEAR             VALUE 'C'.
   467         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   468     12  DC-END-OF-MONTH               PIC X.
   469         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   470     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   471         88  USE-NORMAL-PROCESS         VALUE ' '.
   472         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   473         88  ADJUST-UP-100-YRS          VALUE '2'.
   474     12  FILLER                        PIC X.
   475     12  DC-CONVERSION-DATES.
   476         16  DC-BIN-DATE-1             PIC XX.
   477         16  DC-BIN-DATE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* NSRASBL.cbl
   478         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   479         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   480                       DC-GREG-DATE-1-EDIT.
   481             20  DC-EDIT1-MONTH        PIC 99.
   482             20  SLASH1-1              PIC X.
   483             20  DC-EDIT1-DAY          PIC 99.
   484             20  SLASH1-2              PIC X.
   485             20  DC-EDIT1-YEAR         PIC 99.
   486         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   487         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   488                     DC-GREG-DATE-2-EDIT.
   489             20  DC-EDIT2-MONTH        PIC 99.
   490             20  SLASH2-1              PIC X.
   491             20  DC-EDIT2-DAY          PIC 99.
   492             20  SLASH2-2              PIC X.
   493             20  DC-EDIT2-YEAR         PIC 99.
   494         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   495         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   496                     DC-GREG-DATE-1-YMD.
   497             20  DC-YMD-YEAR           PIC 99.
   498             20  DC-YMD-MONTH          PIC 99.
   499             20  DC-YMD-DAY            PIC 99.
   500         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   501         16  DC-GREG-DATE-1-MDY-R REDEFINES
   502                      DC-GREG-DATE-1-MDY.
   503             20  DC-MDY-MONTH          PIC 99.
   504             20  DC-MDY-DAY            PIC 99.
   505             20  DC-MDY-YEAR           PIC 99.
   506         16  DC-GREG-DATE-1-ALPHA.
   507             20  DC-ALPHA-MONTH        PIC X(10).
   508             20  DC-ALPHA-DAY          PIC 99.
   509             20  FILLER                PIC XX.
   510             20  DC-ALPHA-CENTURY.
   511                 24 DC-ALPHA-CEN-N     PIC 99.
   512             20  DC-ALPHA-YEAR         PIC 99.
   513         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   514         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   515         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   516         16  DC-JULIAN-DATE            PIC 9(05).
   517         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   518                                       PIC 9(05).
   519         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   520             20  DC-JULIAN-YEAR        PIC 99.
   521             20  DC-JULIAN-DAYS        PIC 999.
   522         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   523         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   524         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   525     12  DATE-CONVERSION-VARIBLES.
   526         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   527         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   528             20  FILLER                PIC 9(3).
   529             20  HOLD-CEN-1-CCYY.
   530                 24  HOLD-CEN-1-CC     PIC 99.
   531                 24  HOLD-CEN-1-YY     PIC 99.
   532             20  HOLD-CEN-1-MO         PIC 99.
   533             20  HOLD-CEN-1-DA         PIC 99.
   534         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   535             20  HOLD-CEN-1-R-MO       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* NSRASBL.cbl
   536             20  HOLD-CEN-1-R-DA       PIC 99.
   537             20  HOLD-CEN-1-R-CCYY.
   538                 24  HOLD-CEN-1-R-CC   PIC 99.
   539                 24  HOLD-CEN-1-R-YY   PIC 99.
   540             20  FILLER                PIC 9(3).
   541         16  HOLD-CENTURY-1-X.
   542             20  FILLER                PIC X(3)  VALUE SPACES.
   543             20  HOLD-CEN-1-X-CCYY.
   544                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   545                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   546             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   547             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   548         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   549             20  HOLD-CEN-1-R-X-MO     PIC XX.
   550             20  HOLD-CEN-1-R-X-DA     PIC XX.
   551             20  HOLD-CEN-1-R-X-CCYY.
   552                 24  HOLD-CEN-1-R-X-CC PIC XX.
   553                 24  HOLD-CEN-1-R-X-YY PIC XX.
   554             20  FILLER                PIC XXX.
   555         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   556         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   557         16  DC-JULIAN-DATE-1          PIC 9(07).
   558         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   559             20  DC-JULIAN-1-CCYY.
   560                 24  DC-JULIAN-1-CC    PIC 99.
   561                 24  DC-JULIAN-1-YR    PIC 99.
   562             20  DC-JULIAN-DA-1        PIC 999.
   563         16  DC-JULIAN-DATE-2          PIC 9(07).
   564         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   565             20  DC-JULIAN-2-CCYY.
   566                 24  DC-JULIAN-2-CC    PIC 99.
   567                 24  DC-JULIAN-2-YR    PIC 99.
   568             20  DC-JULIAN-DA-2        PIC 999.
   569         16  DC-GREG-DATE-A-EDIT.
   570             20  DC-EDITA-MONTH        PIC 99.
   571             20  SLASHA-1              PIC X VALUE '/'.
   572             20  DC-EDITA-DAY          PIC 99.
   573             20  SLASHA-2              PIC X VALUE '/'.
   574             20  DC-EDITA-CCYY.
   575                 24  DC-EDITA-CENT     PIC 99.
   576                 24  DC-EDITA-YEAR     PIC 99.
   577         16  DC-GREG-DATE-B-EDIT.
   578             20  DC-EDITB-MONTH        PIC 99.
   579             20  SLASHB-1              PIC X VALUE '/'.
   580             20  DC-EDITB-DAY          PIC 99.
   581             20  SLASHB-2              PIC X VALUE '/'.
   582             20  DC-EDITB-CCYY.
   583                 24  DC-EDITB-CENT     PIC 99.
   584                 24  DC-EDITB-YEAR     PIC 99.
   585         16  DC-GREG-DATE-CYMD         PIC 9(08).
   586         16  DC-GREG-DATE-CYMD-R REDEFINES
   587                              DC-GREG-DATE-CYMD.
   588             20  DC-CYMD-CEN           PIC 99.
   589             20  DC-CYMD-YEAR          PIC 99.
   590             20  DC-CYMD-MONTH         PIC 99.
   591             20  DC-CYMD-DAY           PIC 99.
   592         16  DC-GREG-DATE-MDCY         PIC 9(08).
   593         16  DC-GREG-DATE-MDCY-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* NSRASBL.cbl
   594                              DC-GREG-DATE-MDCY.
   595             20  DC-MDCY-MONTH         PIC 99.
   596             20  DC-MDCY-DAY           PIC 99.
   597             20  DC-MDCY-CEN           PIC 99.
   598             20  DC-MDCY-YEAR          PIC 99.
   599    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   600        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   601    12  DC-EL310-DATE                  PIC X(21).
   602    12  FILLER                         PIC X(28).
   603*                                COPY NSCASEXTR.
   604******************************************************************
   605*                                                                *
   606*                                                                *
   607*                            NSCASEXTR.                          *
   608*                            VMOD=2.001                          *
   609*                                                                *
   610*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
   611*                                                                *
   612*   FILE TYPE = VSAM,KSDS                                        *
   613*   RECORD SIZE = 4500 RECFORM = FIXED                           *
   614*                                                                *
   615*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
   616*                                                                *
   617*   LOG = NO                                                     *
   618*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   619******************************************************************
   620*-----------------------------------------------------------------
   621*                   C H A N G E   L O G
   622*
   623* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   624*-----------------------------------------------------------------
   625*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   626* EFFECTIVE    NUMBER
   627*-----------------------------------------------------------------
   628* 072211    2011022800001  PEMA  NEW FILE
   629*-----------------------------------------------------------------
   630 01 NSAS-EXTRACT-RECORD.
   631    05  NSAS-CONTROL-PRIMARY.
   632        10  NSAS-COMPANY-CD      PIC X.
   633        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
   634        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
   635    05  NSAS-LETTER-VARIABLES    PIC X(4350).
   636    05  FILLER                   PIC X(143).
   637*                                COPY ERCPNDB.
   638******************************************************************
   639*                                                                *
   640*                                                                *
   641*                            ERCPNDB.                            *
   642*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   643*                            VMOD=2.025                          *
   644*                                                                *
   645*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
   646*                                                                *
   647******************************************************************
   648*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
   649*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
   650******************************************************************
   651*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* NSRASBL.cbl
   652*                                                                *
   653*   FILE TYPE = VSAM,KSDS                                        *
   654*   RECORD SIZE = 585  RECFORM = FIXED                           *
   655*                                                                *
   656*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
   657*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
   658*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
   659*                                                 RKP=13,LEN=36  *
   660*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
   661*                                      AND CHG-SEQ.)             *
   662*                                                RKP=49,LEN=11   *
   663*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
   664*                                      AND CHG-SEQ.)             *
   665*                                                RKP=60,LEN=15   *
   666*                                                                *
   667*   LOG = NO                                                     *
   668*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   669******************************************************************
   670******************************************************************
   671*                   C H A N G E   L O G
   672*
   673* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   674*-----------------------------------------------------------------
   675*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   676* EFFECTIVE    NUMBER
   677*-----------------------------------------------------------------
   678* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   679* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   680* 011904                   PEMA  ADD TOTAL FEE PROCESSING
   681* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   682* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
   683* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   684* 032306                   PEMA  ADD BOW LOAN NUMBER
   685* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
   686* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
   687* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   688* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   689* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
   690* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
   691* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   692* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
   693******************************************************************
   694
   695 01  PENDING-BUSINESS.
   696     12  PB-RECORD-ID                     PIC XX.
   697         88  VALID-PB-ID                        VALUE 'PB'.
   698
   699     12  PB-CONTROL-PRIMARY.
   700         16  PB-COMPANY-CD                PIC X.
   701         16  PB-ENTRY-BATCH               PIC X(6).
   702         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   703         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   704
   705     12  PB-CONTROL-BY-ACCOUNT.
   706         16  PB-COMPANY-CD-A1             PIC X.
   707         16  PB-CARRIER                   PIC X.
   708         16  PB-GROUPING.
   709             20  PB-GROUPING-PREFIX       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* NSRASBL.cbl
   710             20  PB-GROUPING-PRIME        PIC XXX.
   711         16  PB-STATE                     PIC XX.
   712         16  PB-ACCOUNT.
   713             20  PB-ACCOUNT-PREFIX        PIC X(4).
   714             20  PB-ACCOUNT-PRIME         PIC X(6).
   715         16  PB-CERT-EFF-DT               PIC XX.
   716         16  PB-CERT-NO.
   717             20  PB-CERT-PRIME            PIC X(10).
   718             20  PB-CERT-SFX              PIC X.
   719         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   720
   721         16  PB-RECORD-TYPE               PIC X.
   722             88  PB-MAILING-DATA                VALUE '0'.
   723             88  PB-ISSUE                       VALUE '1'.
   724             88  PB-CANCELLATION                VALUE '2'.
   725             88  PB-BATCH-TRAILER               VALUE '9'.
   726
   727     12  PB-CONTROL-BY-ORIG-BATCH.
   728         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   729         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   730         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   731         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   732
   733     12  PB-CONTROL-BY-CSR.
   734         16  PB-CSR-COMPANY-CD            PIC X.
   735         16  PB-CSR-ID                    PIC X(4).
   736         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   737         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   738         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   739******************************************************************
   740*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   741******************************************************************
   742
   743     12  PB-LAST-MAINT-DT                 PIC XX.
   744     12  PB-LAST-MAINT-BY                 PIC X(4).
   745     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   746
   747     12  PB-RECORD-BODY                   PIC X(375).
   748
   749     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   750         16  PB-CERT-ORIGIN               PIC X.
   751             88  CLASIC-CREATED-CERT         VALUE '1'.
   752         16  PB-I-NAME.
   753             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   754             20  PB-I-INSURED-FIRST-NAME.
   755                 24  PB-I-INSURED-1ST-INIT PIC X.
   756                 24  FILLER                PIC X(9).
   757             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   758         16  PB-I-AGE                     PIC S99   COMP-3.
   759         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   760         16  PB-I-BIRTHDAY                PIC XX.
   761         16  PB-I-INSURED-SEX             PIC X.
   762             88  PB-SEX-MALE     VALUE 'M'.
   763             88  PB-SEX-FEMALE   VALUE 'F'.
   764
   765         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   766         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   767         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* NSRASBL.cbl
   768         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   769         16  PB-I-SKIP-CODE               PIC X.
   770             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
   771             88  PB-SKIP-JULY              VALUE '1'.
   772             88  PB-SKIP-AUGUST            VALUE '2'.
   773             88  PB-SKIP-SEPTEMBER         VALUE '3'.
   774             88  PB-SKIP-JULY-AUG          VALUE '4'.
   775             88  PB-SKIP-AUG-SEPT          VALUE '5'.
   776             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
   777             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
   778             88  PB-SKIP-JUNE              VALUE '8'.
   779             88  PB-SKIP-JUNE-JULY         VALUE '9'.
   780             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
   781             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
   782         16  PB-I-TERM-TYPE               PIC X.
   783             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
   784             88  PB-PAID-WEEKLY            VALUE 'W'.
   785             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
   786             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
   787             88  PB-PAID-13-YEARLY         VALUE 'T'.
   788         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
   789         16  PB-I-POLICY-FORM-NO          PIC X(12).
   790         16  PB-I-DATA-ENTRY-SW           PIC X.
   791             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
   792             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
   793             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
   794             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
   795         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
   796         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
   797*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
   798         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
   799         16  FILLER                       PIC X.
   800
   801         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
   802             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
   803             88  PB-INVALID-LIFE             VALUE '  ' '00'
   804                                                   '90' THRU '99'.
   805         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
   806                                          PIC XX.
   807         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   808         16  PB-I-AMOUNT-FINANCED REDEFINES
   809                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
   810         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
   811         16  PB-I-UNPAID-CASH-PRICE REDEFINES
   812                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
   813         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   814         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
   815         16  PB-I-CLP-AMOUNT REDEFINES
   816                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
   817         16  PB-I-LF-CALC-FLAG            PIC X.
   818             88 PB-COMP-LF-PREM               VALUE '?'.
   819         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
   820         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
   821         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
   822         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
   823         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
   824         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
   825         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* NSRASBL.cbl
   826         16  PB-I-LF-ABBR                 PIC XXX.
   827         16  PB-I-LF-INPUT-CD             PIC XX.
   828
   829         16  PB-I-AH-BENEFIT-CD           PIC XX.
   830             88  PB-VALID-AH                 VALUE '01' THRU '89'.
   831             88  PB-INVALID-AH               VALUE '  ' '00'
   832                                                   '90' THRU '99'.
   833         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   834         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   835         16  PB-I-AH-CALC-FLAG            PIC X.
   836             88 PB-COMP-AH-PREM                  VALUE '?'.
   837         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
   838         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
   839         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
   840         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
   841         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
   842         16  PB-I-AH-ABBR                 PIC XXX.
   843         16  PB-I-AH-INPUT-CD             PIC XXX.
   844
   845         16  PB-I-SPECIAL-REIN-CODE       PIC X.
   846         16  PB-I-REIN-TABLE              PIC XXX.
   847         16  PB-I-BUSINESS-TYPE           PIC 99.
   848         16  PB-I-INDV-GRP-CD             PIC X.
   849         16  PB-I-MORT-CODE.
   850             20  PB-I-TABLE               PIC X.
   851             20  PB-I-INTEREST            PIC XX.
   852             20  PB-I-MORT-TYP            PIC X.
   853         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
   854         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
   855         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
   856         16  PB-I-INDV-GRP-OVRD           PIC X.
   857         16  PB-I-RATE-CLASS-OVRD         PIC XX.
   858         16  PB-I-SIG-SW                  PIC X.
   859             88  PB-POLICY-SIGNED             VALUE 'Y'.
   860         16  PB-I-RATE-CLASS              PIC XX.
   861         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
   862         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
   863         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
   864         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
   865         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
   866         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
   867         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
   868         16  PB-I-BENEFIT-TYPE            PIC XXX.
   869         16  PB-I-OB-FLAG                 PIC X.
   870             88  PB-I-OB                      VALUE 'B'.
   871             88  PB-I-SUMMARY                 VALUE 'Z'.
   872         16  PB-I-ENTRY-STATUS            PIC X.
   873             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
   874                                              'M' '5' '9' '2'.
   875             88  PB-I-NORMAL-ENTRY            VALUE '1'.
   876             88  PB-I-POLICY-PENDING          VALUE '2'.
   877             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
   878             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
   879             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
   880             88  PB-I-REIN-ONLY               VALUE '9'.
   881             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
   882             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
   883             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* NSRASBL.cbl
   884             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
   885         16  PB-I-INT-CODE                PIC X.
   886             88  PB-ADD-ON-INTEREST           VALUE 'A'.
   887             88  PB-SIMPLE-INTEREST           VALUE 'S'.
   888         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   889         16  PB-I-SOC-SEC-NO              PIC X(11).
   890         16  PB-I-MEMBER-NO               PIC X(12).
   891         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
   892*        16  PB-I-LOAN-OFFICER            PIC XXX.
   893         16  PB-I-OLD-LOF                 PIC XXX.
   894         16  PB-I-LF-EXPIRE-DT            PIC XX.
   895         16  PB-I-AH-EXPIRE-DT            PIC XX.
   896         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
   897         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
   898         16  PB-I-LIFE-INDICATOR          PIC X.
   899             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
   900         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
   901         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
   902                                          PIC S9(5)V99    COMP-3.
   903         16  PB-I-MAIL-ADDRS-SW           PIC X.
   904             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
   905             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
   906         16  PB-I-1ST-PMT-DT              PIC XX.
   907         16  PB-I-JOINT-INSURED.
   908             20 PB-I-JOINT-LAST-NAME      PIC X(15).
   909             20 PB-I-JOINT-FIRST-NAME.
   910                24  PB-I-JOINT-FIRST-INIT PIC X.
   911                24  FILLER                PIC X(9).
   912             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
   913*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
   914         16  PB-I-BENEFICIARY-NAME.
   915             20  PB-I-BANK-NUMBER         PIC X(10).
   916             20  FILLER                   PIC X(15).
   917         16  PB-I-LAST-ADD-ON-DT          PIC XX.
   918         16  PB-I-REFERENCE               PIC X(12).
   919         16  FILLER REDEFINES PB-I-REFERENCE.
   920             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
   921             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
   922             20  PB-I-CLP-STATE           PIC XX.
   923         16  PB-I-UNDERWRITING-STATUS     PIC X.
   924             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
   925             88  PB-I-POLICY-DECLINED         VALUE 'D'.
   926             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
   927         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
   928         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
   929         16  PB-I-RESIDENT-STATE          PIC XX.
   930         16  PB-I-RATE-CODE               PIC X(4).
   931         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
   932         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   933         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   934         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
   935         16  PB-I-BANK-NOCHRGB            PIC 99.
   936         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
   937         16  PB-I-JOINT-BIRTHDAY          PIC XX.
   938
   939     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
   940         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
   941             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* NSRASBL.cbl
   942         16  PB-C-CANCEL-ORIGIN           PIC X.
   943             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
   944         16  PB-C-LF-CANCEL-DT            PIC XX.
   945         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
   946         16  PB-C-LF-CALC-REQ             PIC X.
   947             88 PB-COMP-LF-CANCEL            VALUE '?'.
   948         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
   949         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
   950         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
   951             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
   952         16  PB-C-AH-CANCEL-DT            PIC XX.
   953         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
   954         16  PB-C-AH-CALC-REQ             PIC X.
   955             88 PB-COMP-AH-CANCEL            VALUE '?'.
   956         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
   957         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
   958         16  PB-C-LAST-NAME               PIC X(15).
   959         16  PB-C-REFUND-SW               PIC X.
   960             88  PB-C-REFUND-CREATED          VALUE 'Y'.
   961             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
   962         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
   963         16  PB-C-PAYEE-CODE              PIC X(6).
   964         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
   965         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
   966         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
   967         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
   968         16  PB-C-REFERENCE               PIC X(12).
   969         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   970         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   971         16  PB-C-POST-CARD-IND           PIC X.
   972         16  PB-C-CANCEL-REASON           PIC X.
   973         16  PB-C-REF-INTERFACE-SW        PIC X.
   974         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
   975         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
   976         16  FILLER                       PIC X(01).
   977*        16  FILLER                       PIC X(18).
   978         16  PB-C-POLICY-FORM-NO          PIC X(12).
   979*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
   980         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
   981         16  PB-CANCELED-CERT-DATA.
   982             20  PB-CI-INSURED-NAME.
   983                 24  PB-CI-LAST-NAME      PIC X(15).
   984                 24  PB-CI-INITIALS       PIC XX.
   985             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
   986             20  PB-CI-INSURED-SEX        PIC X.
   987             20  PB-CI-LF-TERM            PIC S999        COMP-3.
   988             20  PB-CI-LF-BENEFIT-CD      PIC XX.
   989             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
   990             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
   991             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
   992             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
   993             20  PB-CI-AH-TERM            PIC S999        COMP-3.
   994             20  PB-CI-AH-BENEFIT-CD      PIC XX.
   995             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
   996             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
   997             20  PB-CI-RATE-CLASS         PIC XX.
   998             20  PB-CI-RATE-DEV-LF        PIC XXX.
   999             20  PB-CI-RATE-DEV-AH        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* NSRASBL.cbl
  1000             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  1001             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  1002             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  1003             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  1004             20  PB-CI-LF-ABBR            PIC X(3).
  1005             20  PB-CI-AH-ABBR            PIC X(3).
  1006             20  PB-CI-OB-FLAG            PIC X.
  1007                 88  PB-CI-OB                VALUE 'B'.
  1008             20  PB-CI-LF-POLICY-STATUS   PIC X.
  1009                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  1010                                           'M' '4' '5' '9' '2'.
  1011                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  1012                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  1013                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  1014                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  1015                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  1016                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1017                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  1018                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1019                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  1020                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  1021                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  1022                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  1023             20  PB-CI-AH-POLICY-STATUS   PIC X.
  1024                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  1025                                           'M' '4' '5' '9' '2'.
  1026                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  1027                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  1028                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  1029                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  1030                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  1031                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1032                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  1033                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1034                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  1035                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  1036                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  1037                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  1038             20  PB-CI-PAY-FREQUENCY      PIC 99.
  1039             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  1040             20  PB-CI-SOC-SEC-NO         PIC X(11).
  1041             20  PB-CI-MEMBER-NO          PIC X(12).
  1042             20  PB-CI-INT-CODE           PIC X.
  1043                 88  PB-CI-ADD-ON                  VALUE 'A'.
  1044                 88  PB-CI-SIMPLE                  VALUE 'S'.
  1045             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  1046             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  1047             20  PB-CI-COMP-EXCP-SW       PIC X.
  1048                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  1049                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  1050             20  PB-CI-ENTRY-STATUS       PIC X.
  1051             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  1052             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  1053             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  1054             20  PB-CI-DEATH-DT           PIC XX.
  1055             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  1056             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  1057             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* NSRASBL.cbl
  1058             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1059             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  1060             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  1061             20  PB-CI-ENTRY-DT              PIC XX.
  1062             20  PB-CI-ENTRY-BATCH           PIC X(6).
  1063             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  1064             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  1065             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  1066             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  1067             20  PB-CI-OLD-LOF               PIC XXX.
  1068*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  1069             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  1070             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  1071             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  1072             20  PB-CI-INDV-GRP-CD           PIC X.
  1073             20  PB-CI-BENEFICIARY-NAME.
  1074                 24  PB-CI-BANK-NUMBER       PIC X(10).
  1075                 24  FILLER                  PIC X(15).
  1076             20  PB-CI-NOTE-SW               PIC X.
  1077             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  1078             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  1079             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  1080             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  1081             20  PB-CI-LOAN-OFFICER          PIC X(5).
  1082             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  1083             20  PB-CI-FIRST-NAME            PIC X(10).
  1084             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  1085
  1086         16  FILLER                       PIC X(13).
  1087*032306  16  FILLER                       PIC X(27).
  1088*        16  FILLER                       PIC X(46).
  1089
  1090     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  1091         16  FILLER                       PIC X(10).
  1092         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  1093         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  1094         16  PB-M-INSURED-MID-INIT        PIC X.
  1095         16  PB-M-INSURED-AGE             PIC 99.
  1096         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  1097         16  PB-M-INSURED-SEX             PIC X.
  1098         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  1099         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  1100         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  1101         16  PB-M-INSURED-CITY-STATE.
  1102             20  PB-M-INSURED-CITY        PIC X(28).
  1103             20  PB-M-INSURED-STATE       PIC XX.
  1104         16  PB-M-INSURED-ZIP-CODE.
  1105             20  PB-M-INSURED-ZIP-PRIME.
  1106                 24  PB-M-INSURED-ZIP-1   PIC X.
  1107                     88  PB-M-CANADIAN-POST-CODE
  1108                                             VALUE 'A' THRU 'Z'.
  1109                 24  FILLER               PIC X(4).
  1110             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  1111         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  1112                                        PB-M-INSURED-ZIP-CODE.
  1113             20  PM-M-INS-CAN-POST1       PIC XXX.
  1114             20  PM-M-INS-CAN-POST2       PIC XXX.
  1115             20  FILLER                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* NSRASBL.cbl
  1116         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  1117         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  1118         16  PB-M-CRED-BENE-NAME          PIC X(30).
  1119         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  1120         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  1121         16  PB-M-CRED-BENE-CITYST.
  1122             20  PB-M-CRED-BENE-CITY      PIC X(28).
  1123             20  PB-M-CRED-BENE-STATE     PIC XX.
  1124         16  FILLER                       PIC X(92).
  1125
  1126     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  1127         16  FILLER                       PIC X(10).
  1128         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1129         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1130         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1131         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1132         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1133         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1134         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1135         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1136         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1137         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1138         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1139         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1140         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  1141         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  1142         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  1143         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  1144         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  1145         16  PB-ACCOUNT-NAME              PIC X(30).
  1146         16  PB-PREM-REF-RPT-FLAG         PIC X.
  1147         16  PB-REFERENCE                 PIC X(12).
  1148         16  PB-B-RECEIVED-DT             PIC XX.
  1149         16  FILLER                       PIC X(234).
  1150
  1151     12  PB-RECORD-STATUS.
  1152         16  PB-CREDIT-SELECT-DT          PIC XX.
  1153         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  1154         16  PB-BILLED-DT                 PIC XX.
  1155         16  PB-BILLING-STATUS            PIC X.
  1156             88  PB-ENTRY-REVERSED            VALUE 'R'.
  1157             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  1158             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  1159         16  PB-RECORD-BILL               PIC X.
  1160             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  1161             88  PB-RECORD-RETURNED           VALUE 'R'.
  1162             88  PB-RECORD-ENDORSED           VALUE 'E'.
  1163             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  1164             88  PB-OVERRIDE-AH               VALUE 'A'.
  1165             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  1166         16  PB-BATCH-ENTRY               PIC X.
  1167             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  1168             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  1169             88  PB-REISSUED-CERT             VALUE 'E'.
  1170             88  PB-MONTHLY-CERT              VALUE 'M'.
  1171             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  1172             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  1173             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* NSRASBL.cbl
  1174         16  PB-FORCE-CODE                PIC X.
  1175             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  1176             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  1177             88  PB-CANCEL-FORCE              VALUE '8'.
  1178             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  1179             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  1180             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  1181             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  1182             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  1183             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  1184             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  1185         16  PB-FATAL-FLAG                PIC X.
  1186             88  PB-FATAL-ERRORS              VALUE 'X'.
  1187         16  PB-FORCE-ER-CD               PIC X.
  1188             88  PB-FORCE-ERRORS              VALUE 'F'.
  1189             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  1190         16  PB-WARN-ER-CD                PIC X.
  1191             88  PB-WARNING-ERRORS            VALUE 'W'.
  1192         16  FILLER                       PIC X.
  1193         16  PB-OUT-BAL-CD                PIC X.
  1194             88  PB-OUT-OF-BAL                VALUE 'O'.
  1195         16  PB-LIFE-OVERRIDE-L1          PIC X.
  1196         16  PB-AH-OVERRIDE-L1            PIC X.
  1197         16  PB-INPUT-DT                  PIC XX.
  1198         16  PB-INPUT-BY                  PIC X(4).
  1199         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  1200         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  1201         16  PB-TOLERANCE-REJECT-SW       PIC X.
  1202         16  PB-LF-EARNING-METHOD         PIC X.
  1203         16  PB-AH-EARNING-METHOD         PIC X.
  1204         16  PB-LF-TERM-CALC-METHOD       PIC X.
  1205         16  PB-AH-TERM-CALC-METHOD       PIC X.
  1206         16  PB-REIN-CD                   PIC XXX.
  1207         16  PB-LF-REFUND-TYPE            PIC X.
  1208         16  PB-AH-REFUND-TYPE            PIC X.
  1209         16  PB-ACCT-EFF-DT               PIC XX.
  1210         16  PB-ACCT-EXP-DT               PIC XX.
  1211         16  PB-COMPANY-ID                PIC X(3).
  1212         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1213         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1214         16  PB-SV-CARRIER                PIC X.
  1215         16  PB-SV-GROUPING               PIC X(6).
  1216         16  PB-SV-STATE                  PIC XX.
  1217         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  1218         16  PB-GA-BILLING-INFO.
  1219             20  PB-GA-BILL-DT OCCURS 5 TIMES
  1220                                          PIC XX.
  1221         16  PB-SV-REMIT-TO  REDEFINES
  1222             PB-GA-BILLING-INFO           PIC X(10).
  1223         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  1224         16  PB-I-LOAN-OFFICER            PIC X(5).
  1225         16  PB-I-VIN                     PIC X(17).
  1226
  1227         16  FILLER                       PIC X(04).
  1228         16  IMNET-BYPASS-SW              PIC X.
  1229
  1230******************************************************************
  1231*                COMMON EDIT ERRORS                              *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* NSRASBL.cbl
  1232******************************************************************
  1233
  1234     12  PB-COMMON-ERRORS.
  1235         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  1236                                           PIC S9(4)     COMP.
  1237
  1238******************************************************************
  1239*                                COPY ERCENDT.
  1240******************************************************************
  1241*                                                                *
  1242*                                                                *
  1243*                            ERCENDT.                            *
  1244*                            VMOD=2.001                          *
  1245*                                                                *
  1246*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  1247*                                                                *
  1248*   FILE TYPE = VSAM,KSDS                                        *
  1249*   RECORD SIZE = 579  RECFORM = FIXED                           *
  1250*                                                                *
  1251*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  1252*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  1253*                                                                *
  1254*   LOG = NO                                                     *
  1255*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1256******************************************************************
  1257*-----------------------------------------------------------------
  1258*                   C H A N G E   L O G
  1259*
  1260* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1261*-----------------------------------------------------------------
  1262*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1263* EFFECTIVE    NUMBER
  1264*-----------------------------------------------------------------
  1265* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  1266*                                WITH OPEN CLAIMS
  1267* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  1268*-----------------------------------------------------------------
  1269 01  ENDORSEMENT-RECORD.
  1270     12  EN-RECORD-ID                PIC XX.
  1271         88  VALID-EN-ID                VALUE 'EN'.
  1272     12  EN-CONTROL-PRIMARY.
  1273         16  EN-COMPANY-CD           PIC X.
  1274         16  EN-CARRIER              PIC X.
  1275         16  EN-GROUPING             PIC X(6).
  1276         16  EN-STATE                PIC XX.
  1277         16  EN-ACCOUNT              PIC X(10).
  1278         16  EN-CERT-EFF-DT          PIC XX.
  1279         16  EN-CERT-NO.
  1280             20  EN-CERT-PRIME       PIC X(10).
  1281             20  EN-CERT-SFX         PIC X.
  1282         16  EN-REC-TYPE             PIC X.
  1283             88  EN-ISSUE               VALUE 'I'.
  1284             88  EN-CANCELLATION        VALUE 'C'.
  1285         16  EN-SEQ-NO               PIC 9(04) BINARY.
  1286     12  EN-CONTROL-BY-ARCH-NO.
  1287         16  EN-COMPANY-CD-A1              PIC X.
  1288         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  1289     12  EN-LAST-MAINT-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* NSRASBL.cbl
  1290     12  EN-LAST-MAINT-BY            PIC X(4).
  1291     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  1292     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  1293     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1294         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  1295         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  1296         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  1297         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  1298         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  1299         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  1300         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  1301         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  1302         16  EN-LF-ORIG-BENCD        PIC XX.
  1303         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  1304         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1305         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1306         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  1307         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  1308         16  EN-LF-ORIG-EXP-DT       PIC XX.
  1309*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  1310         16  EN-ORIG-CRED-BENE       PIC X(25).
  1311         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1312         16  FILLER                  PIC X.
  1313         16  EN-AH-ORIG-BENCD        PIC XX.
  1314         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  1315         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1316         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1317         16  EN-AH-ORIG-EXP-DT       PIC XX.
  1318*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  1319*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  1320         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1321         16  F                       PIC X(09).
  1322         16  EN-AH-ORIG-CP           PIC 99.
  1323         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  1324         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  1325         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  1326         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  1327         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  1328         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  1329         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  1330         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  1331         16  EN-LF-NEW-BENCD         PIC XX.
  1332         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  1333         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1334         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1335         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  1336         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  1337         16  EN-LF-NEW-EXP-DT        PIC XX.
  1338         16  EN-NEW-CRED-BENE        PIC X(25).
  1339         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1340         16  FILLER                  PIC X.
  1341         16  EN-AH-NEW-BENCD         PIC XX.
  1342         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  1343         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1344         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1345         16  EN-AH-NEW-EXP-DT        PIC XX.
  1346*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  1347*        16  EN-AH-NEW-WAIT-PER      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* NSRASBL.cbl
  1348*        16  F                       PIC X(12).
  1349         16  EN-AH-NEW-CP            PIC 99.
  1350         16  EN-SIG-SW               PIC X.
  1351         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1352         16  FILLER                  PIC X(37).
  1353     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  1354         16  EN-LF-ORIG-REF-DT       PIC XX.
  1355         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1356         16  EN-AH-ORIG-REF-DT       PIC XX.
  1357         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  1358         16  EN-LF-NEW-REF-DT        PIC XX.
  1359         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1360         16  EN-AH-NEW-REF-DT        PIC XX.
  1361         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  1362         16  EN-FLAG-CERT            PIC X.
  1363         16  EN-INS-LAST-NAME        PIC X(15).
  1364         16  EN-INS-FIRST-NAME       PIC X(10).
  1365         16  EN-INS-MIDDLE-INIT      PIC X.
  1366         16  FILLER                  PIC X(274).
  1367     12  EN-MONEY-SW             PIC X.
  1368     12  EN-HEALTH-APP           PIC X.
  1369     12  EN-VOUCHER-SW           PIC X.
  1370     12  EN-PAYEE                PIC X(14).
  1371     12  EN-INPUT-DT             PIC XX.
  1372     12  EN-PROCESS-DT           PIC XX.
  1373     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  1374     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  1375     12  EN-REASON-CODES.
  1376         16  F OCCURS 12.
  1377             20  EN-REASON-CODE  PIC X(4).
  1378     12  EN-TEMPLATE-USED        PIC X(8).
  1379     12  EN-DOCU-TYPE            PIC X.
  1380         88  EN-VERI-DOCU          VALUE 'V'.
  1381         88  EN-GCE-DOCU           VALUE 'G'.
  1382         88  EN-CANC-DOCU          VALUE 'C'.
  1383     12  EN-COMMENTS1            PIC X(13).
  1384     12  EN-COMMENTS2            PIC X(70).
  1385     12  EN-COMM-CHGBK           PIC X.
  1386         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  1387         88  EN-CHG-ACCT           VALUE 'Y'.
  1388     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  1389     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  1390     12  EN-BATCH-NUMBER         PIC X(6).
  1391     12  EN-ACCT-SUMM            PIC X.
  1392     12  EN-CSO-SUMM             PIC X.
  1393     12  FILLER                  PIC X(13).
  1394******************************************************************
  1395*                                COPY ERCMAIL.
  1396******************************************************************
  1397*                                                                *
  1398*                                                                *
  1399*                            ERCMAIL                             *
  1400*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1401*                            VMOD=2.003                          *
  1402*                                                                *
  1403*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  1404*                                                                *
  1405*   FILE TYPE = VSAM,KSDS                                        *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* NSRASBL.cbl
  1406*   RECORD SIZE = 374   RECFORM = FIX                            *
  1407*                                                                *
  1408*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  1409*   ALTERNATE PATH    = NOT USED                                 *
  1410*                                                                *
  1411*   LOG = YES                                                    *
  1412*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1413******************************************************************
  1414*                   C H A N G E   L O G
  1415*
  1416* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1417*-----------------------------------------------------------------
  1418*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1419* EFFECTIVE    NUMBER
  1420*-----------------------------------------------------------------
  1421* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  1422* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1423* 111108                   PEMA  ADD CRED BENE ADDR2
  1424******************************************************************
  1425
  1426 01  MAILING-DATA.
  1427     12  MA-RECORD-ID                      PIC XX.
  1428         88  VALID-MA-ID                       VALUE 'MA'.
  1429
  1430     12  MA-CONTROL-PRIMARY.
  1431         16  MA-COMPANY-CD                 PIC X.
  1432         16  MA-CARRIER                    PIC X.
  1433         16  MA-GROUPING.
  1434             20  MA-GROUPING-PREFIX        PIC XXX.
  1435             20  MA-GROUPING-PRIME         PIC XXX.
  1436         16  MA-STATE                      PIC XX.
  1437         16  MA-ACCOUNT.
  1438             20  MA-ACCOUNT-PREFIX         PIC X(4).
  1439             20  MA-ACCOUNT-PRIME          PIC X(6).
  1440         16  MA-CERT-EFF-DT                PIC XX.
  1441         16  MA-CERT-NO.
  1442             20  MA-CERT-PRIME             PIC X(10).
  1443             20  MA-CERT-SFX               PIC X.
  1444
  1445     12  FILLER                            PIC XX.
  1446
  1447     12  MA-ACCESS-CONTROL.
  1448         16  MA-SOURCE-SYSTEM              PIC XX.
  1449             88  MA-FROM-CREDIT                VALUE 'CR'.
  1450             88  MA-FROM-VSI                   VALUE 'VS'.
  1451             88  MA-FROM-WARRANTY              VALUE 'WA'.
  1452             88  MA-FROM-OTHER                 VALUE 'OT'.
  1453         16  MA-RECORD-ADD-DT              PIC XX.
  1454         16  MA-RECORD-ADDED-BY            PIC XXXX.
  1455         16  MA-LAST-MAINT-DT              PIC XX.
  1456         16  MA-LAST-MAINT-BY              PIC XXXX.
  1457         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  1458
  1459     12  MA-PROFILE-INFO.
  1460         16  MA-QUALIFY-CODE-1             PIC XX.
  1461         16  MA-QUALIFY-CODE-2             PIC XX.
  1462         16  MA-QUALIFY-CODE-3             PIC XX.
  1463         16  MA-QUALIFY-CODE-4             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* NSRASBL.cbl
  1464         16  MA-QUALIFY-CODE-5             PIC XX.
  1465
  1466         16  MA-INSURED-LAST-NAME          PIC X(15).
  1467         16  MA-INSURED-FIRST-NAME         PIC X(10).
  1468         16  MA-INSURED-MIDDLE-INIT        PIC X.
  1469         16  MA-INSURED-ISSUE-AGE          PIC 99.
  1470         16  MA-INSURED-BIRTH-DT           PIC XX.
  1471         16  MA-INSURED-SEX                PIC X.
  1472             88  MA-SEX-MALE                   VALUE 'M'.
  1473             88  MA-SEX-FEMALE                 VALUE 'F'.
  1474         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  1475
  1476         16  MA-ADDRESS-CORRECTED          PIC X.
  1477         16  MA-JOINT-BIRTH-DT             PIC XX.
  1478*        16  FILLER                        PIC X(12).
  1479
  1480         16  MA-ADDRESS-LINE-1             PIC X(30).
  1481         16  MA-ADDRESS-LINE-2             PIC X(30).
  1482         16  MA-CITY-STATE.
  1483             20  MA-CITY                   PIC X(28).
  1484             20  MA-ADDR-STATE             PIC XX.
  1485         16  MA-ZIP.
  1486             20  MA-ZIP-CODE.
  1487                 24  MA-ZIP-CODE-1ST       PIC X(1).
  1488                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1489                 24  FILLER                PIC X(4).
  1490             20  MA-ZIP-PLUS4              PIC X(4).
  1491         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  1492             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  1493             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  1494             20  FILLER                    PIC X(3).
  1495
  1496         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  1497
  1498         16  FILLER                        PIC XXX.
  1499*        16  FILLER                        PIC X(10).
  1500
  1501     12  MA-CRED-BENE-INFO.
  1502         16  MA-CRED-BENE-NAME                 PIC X(25).
  1503         16  MA-CRED-BENE-ADDR                 PIC X(30).
  1504         16  MA-CRED-BENE-ADDR2                PIC X(30).
  1505         16  MA-CRED-BENE-CTYST.
  1506             20  MA-CRED-BENE-CITY             PIC X(28).
  1507             20  MA-CRED-BENE-STATE            PIC XX.
  1508         16  MA-CRED-BENE-ZIP.
  1509             20  MA-CB-ZIP-CODE.
  1510                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  1511                     88  MA-CB-CANADIAN-POST-CODE
  1512                                           VALUE 'A' THRU 'Z'.
  1513                 24  FILLER                    PIC X(4).
  1514             20  MA-CB-ZIP-PLUS4               PIC X(4).
  1515         16  MA-CB-CANADIAN-POSTAL-CODE
  1516                            REDEFINES MA-CRED-BENE-ZIP.
  1517             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  1518             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  1519             20  FILLER                        PIC X(3).
  1520     12  MA-POST-CARD-MAIL-DATA.
  1521         16  MA-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* NSRASBL.cbl
  1522             20  MA-MAIL-TYPE              PIC X.
  1523                 88  MA-12MO-MAILING           VALUE '1'.
  1524                 88  MA-EXP-MAILING            VALUE '2'.
  1525             20  MA-MAIL-STATUS            PIC X.
  1526                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  1527                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  1528                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  1529             20  MA-MAIL-DATE              PIC XX.
  1530     12  FILLER                            PIC XX.
  1531     12  FILLER                            PIC XX.
  1532*    12  FILLER                            PIC X(30).
  1533******************************************************************
  1534*                                COPY ERCCOMP.
  1535******************************************************************
  1536*                                                                *
  1537*                                                                *
  1538*                            ERCCOMP                             *
  1539*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1540*                            VMOD=2.019                          *
  1541*                                                                *
  1542*   ONLINE CREDIT SYSTEM                                         *
  1543*                                                                *
  1544*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1545*                                                                *
  1546*   FILE TYPE = VSAM,KSDS                                        *
  1547*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1548*                                                                *
  1549*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1550*       ALTERNATE PATH = NONE                                    *
  1551*                                                                *
  1552*   LOG = NO                                                     *
  1553*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1554*                                                                *
  1555******************************************************************
  1556*                   C H A N G E   L O G
  1557*
  1558* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1559*-----------------------------------------------------------------
  1560*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1561* EFFECTIVE    NUMBER
  1562*-----------------------------------------------------------------
  1563* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1564* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1565* 092205    2005050300006  PEMA  ADD LEASE FEE
  1566* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1567* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1568* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1569* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1570* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1571* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1572******************************************************************
  1573
  1574 01  COMPENSATION-MASTER.
  1575     12  CO-RECORD-ID                          PIC XX.
  1576         88  VALID-CO-ID                          VALUE 'CO'.
  1577
  1578     12  CO-CONTROL-PRIMARY.
  1579         16  CO-COMPANY-CD                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* NSRASBL.cbl
  1580         16  CO-CONTROL.
  1581             20  CO-CTL-1.
  1582                 24  CO-CARR-GROUP.
  1583                     28  CO-CARRIER            PIC X.
  1584                     28  CO-GROUPING.
  1585                         32  CO-GROUP-PREFIX   PIC XXX.
  1586                         32  CO-GROUP-PRIME    PIC XXX.
  1587                 24  CO-RESP-NO.
  1588                     28  CO-RESP-PREFIX        PIC X(4).
  1589                     28  CO-RESP-PRIME         PIC X(6).
  1590             20  CO-CTL-2.
  1591                 24  CO-ACCOUNT.
  1592                     28  CO-ACCT-PREFIX        PIC X(4).
  1593                     28  CO-ACCT-PRIME         PIC X(6).
  1594         16  CO-TYPE                           PIC X.
  1595             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1596             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1597             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1598
  1599     12  CO-MAINT-INFORMATION.
  1600         16  CO-LAST-MAINT-DT                  PIC XX.
  1601         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1602         16  CO-LAST-MAINT-USER                PIC X(4).
  1603     12  FILLER                                PIC XX.
  1604     12  CO-STMT-TYPE                          PIC XXX.
  1605     12  CO-COMP-TYPE                          PIC X.
  1606         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1607     12  CO-STMT-OWNER                         PIC X(4).
  1608     12  CO-BALANCE-CONTROL                    PIC X.
  1609         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1610         88  CO-NO-BALANCE                        VALUE 'N'.
  1611
  1612     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1613         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1614         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1615         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1616
  1617     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1618         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1619         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1620
  1621     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1622     12  CO-GA-DIRECT-DEP                      PIC X.
  1623     12  CO-FUTURE-SPACE                       PIC X.
  1624         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1625
  1626     12  CO-ACCT-NAME                          PIC X(30).
  1627     12  CO-MAIL-NAME                          PIC X(30).
  1628     12  CO-ADDR-1                             PIC X(30).
  1629     12  CO-ADDR-2                             PIC X(30).
  1630     12  CO-ADDR-3.
  1631         16  CO-ADDR-CITY                      PIC X(27).
  1632         16  CO-ADDR-STATE                     PIC XX.
  1633     12  CO-CSO-1099                           PIC X.
  1634     12  CO-ZIP.
  1635         16  CO-ZIP-PRIME.
  1636             20  CO-ZIP-PRI-1ST                PIC X.
  1637                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* NSRASBL.cbl
  1638             20  FILLER                        PIC X(4).
  1639         16  CO-ZIP-PLUS4                      PIC X(4).
  1640     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1641         16  CO-CAN-POSTAL-1                   PIC XXX.
  1642         16  CO-CAN-POSTAL-2                   PIC XXX.
  1643         16  FILLER                            PIC XXX.
  1644     12  CO-SOC-SEC                            PIC X(13).
  1645     12  CO-TELEPHONE.
  1646         16  CO-AREA-CODE                      PIC XXX.
  1647         16  CO-PREFIX                         PIC XXX.
  1648         16  CO-PHONE                          PIC X(4).
  1649
  1650     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1651
  1652     12  CO-AR-BAL-LEVEL                       PIC X.
  1653         88  CO-AR-REF-LVL                        VALUE '1'.
  1654         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1655         88  CO-AR-BILL-LVL                       VALUE '2'.
  1656         88  CO-AR-AGT-LVL                        VALUE '3'.
  1657         88  CO-AR-FR-LVL                         VALUE '4'.
  1658
  1659     12  CO-AR-NORMAL-PRINT                    PIC X.
  1660         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1661         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1662
  1663     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1664
  1665     12  CO-AR-REPORTING                       PIC X.
  1666         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1667         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1668
  1669     12  CO-AR-PULL-CHECK                      PIC X.
  1670         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1671         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1672
  1673     12  CO-AR-BALANCE-PRINT                   PIC X.
  1674         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1675
  1676     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1677         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1678         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1679         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1680
  1681     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1682
  1683     12  CO-USER-CODE                          PIC X.
  1684     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1685
  1686******************************************************************
  1687*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1688*    THE LAST MONTH END RUN.
  1689******************************************************************
  1690
  1691     12  CO-LAST-ACTIVITY-DATE.
  1692         16  CO-ACT-YEAR                       PIC 99.
  1693         16  CO-ACT-MONTH                      PIC 99.
  1694         16  CO-ACT-DAY                        PIC 99.
  1695
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* NSRASBL.cbl
  1696     12  CO-LAST-STMT-DT.
  1697         16  CO-LAST-STMT-YEAR                 PIC 99.
  1698         16  CO-LAST-STMT-MONTH                PIC 99.
  1699         16  CO-LAST-STMT-DAY                  PIC 99.
  1700
  1701     12  CO-MO-END-TOTALS.
  1702         16  CO-MONTHLY-TOTALS.
  1703             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1704             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1705             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1706             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1707             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1708
  1709         16  CO-AGING-TOTALS.
  1710             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1711             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1712             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1713             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1714
  1715         16  CO-YTD-TOTALS.
  1716             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1717             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1718
  1719         16  CO-OVER-UNDER-TOTALS.
  1720             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1721             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1722
  1723     12  CO-MISCELLANEOUS-TOTALS.
  1724         16  CO-FICA-TOTALS.
  1725             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1726             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1727
  1728         16  CO-CLAIM-TOTALS.
  1729             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1730             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1731
  1732******************************************************************
  1733*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1734*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1735******************************************************************
  1736
  1737     12  CO-CURRENT-TOTALS.
  1738         16  CO-CURRENT-LAST-STMT-DT.
  1739             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1740             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1741             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1742
  1743         16  CO-CURRENT-MONTHLY-TOTALS.
  1744             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1745             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1746             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1747             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1748             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1749
  1750         16  CO-CURRENT-AGING-TOTALS.
  1751             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1752             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1753             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* NSRASBL.cbl
  1754             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1755
  1756         16  CO-CURRENT-YTD-TOTALS.
  1757             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1758             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1759
  1760     12  CO-PAID-COMM-TOTALS.
  1761         16  CO-YTD-PAID-COMMS.
  1762             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1763             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1764
  1765     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1766         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1767         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1768
  1769     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1770         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1771         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1772         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1773         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1774         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1775         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1776         88  CO-FINAL-LETTER                  VALUE 'F'.
  1777         88  CO-RECONCILING                   VALUE 'R'.
  1778         88  CO-PHONE-CALL                    VALUE 'P'.
  1779         88  CO-LEGAL                         VALUE 'L'.
  1780         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1781         88  CO-WRITE-OFF                     VALUE 'W'.
  1782         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1783
  1784     12  CO-CSR-CODE                       PIC X(4).
  1785
  1786     12  CO-GA-STATUS-INFO.
  1787         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1788         16  CO-GA-TERMINATION-DT          PIC XX.
  1789         16  CO-GA-STATUS-CODE             PIC X.
  1790             88  CO-GA-ACTIVE                 VALUE 'A'.
  1791             88  CO-GA-INACTIVE               VALUE 'I'.
  1792             88  CO-GA-PENDING                VALUE 'P'.
  1793         16  CO-GA-COMMENTS.
  1794             20  CO-GA-COMMENT-1           PIC X(40).
  1795             20  CO-GA-COMMENT-2           PIC X(40).
  1796             20  CO-GA-COMMENT-3           PIC X(40).
  1797             20  CO-GA-COMMENT-4           PIC X(40).
  1798
  1799     12  CO-RPTCD2                         PIC X(10).
  1800     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1801         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1802         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1803
  1804     12  CO-TYPE-AGENT                     PIC X(01).
  1805         88  CO-CORPORATION                   VALUE 'C'.
  1806         88  CO-PARTNERSHIP                   VALUE 'P'.
  1807         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1808         88  CO-TRUST                         VALUE 'T'.
  1809         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1810
  1811     12  CO-FAXNO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* NSRASBL.cbl
  1812         16  CO-FAX-AREA-CODE                  PIC XXX.
  1813         16  CO-FAX-PREFIX                     PIC XXX.
  1814         16  CO-FAX-PHONE                      PIC X(4).
  1815
  1816     12  CO-BANK-INFORMATION.
  1817         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1818         16  CO-BANK-TRANSIT-NON REDEFINES
  1819             CO-BANK-TRANSIT-NO                PIC 9(8).
  1820
  1821         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1822     12  CO-MISC-DEDUCT-INFO REDEFINES
  1823                  CO-BANK-INFORMATION.
  1824         16  CO-MD-GL-ACCT                     PIC X(10).
  1825         16  CO-MD-DIV                         PIC XX.
  1826         16  CO-MD-CENTER                      PIC X(4).
  1827         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1828         16  CO-CREATE-AP-CHECK                PIC X.
  1829         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1830         16  FILLER                            PIC XXX.
  1831     12  CO-ACH-STATUS                         PIC X.
  1832         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1833         88  CO-ACH-PENDING                        VALUE 'P'.
  1834
  1835     12  CO-BILL-SW                            PIC X.
  1836     12  CO-CONTROL-NAME                       PIC X(30).
  1837     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1838     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1839     12  CO-CLP-STATE                          PIC XX.
  1840     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1841     12  CO-SPP-REFUND-EDIT                    PIC X.
  1842
  1843******************************************************************
  1844*                                COPY ELCCERT.
  1845******************************************************************
  1846*                                                                *
  1847*                            ELCCERT.                            *
  1848*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1849*                            VMOD=2.013                          *
  1850*                                                                *
  1851*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1852*                                                                *
  1853*   FILE TYPE = VSAM,KSDS                                        *
  1854*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1855*                                                                *
  1856*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1857*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1858*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1859*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1860*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1861*                                                                *
  1862*   LOG = YES                                                    *
  1863*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1864******************************************************************
  1865*                   C H A N G E   L O G
  1866*
  1867* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1868*-----------------------------------------------------------------
  1869*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* NSRASBL.cbl
  1870* EFFECTIVE    NUMBER
  1871*-----------------------------------------------------------------
  1872* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1873* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1874* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1875* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1876* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1877* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1878* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1879* 032612  CR2011110200001  PEMA  AHL CHANGES
  1880******************************************************************
  1881
  1882 01  CERTIFICATE-MASTER.
  1883     12  CM-RECORD-ID                      PIC XX.
  1884         88  VALID-CM-ID                      VALUE 'CM'.
  1885
  1886     12  CM-CONTROL-PRIMARY.
  1887         16  CM-COMPANY-CD                 PIC X.
  1888         16  CM-CARRIER                    PIC X.
  1889         16  CM-GROUPING.
  1890             20  CM-GROUPING-PREFIX        PIC X(3).
  1891             20  CM-GROUPING-PRIME         PIC X(3).
  1892         16  CM-STATE                      PIC XX.
  1893         16  CM-ACCOUNT.
  1894             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1895             20  CM-ACCOUNT-PRIME          PIC X(6).
  1896         16  CM-CERT-EFF-DT                PIC XX.
  1897         16  CM-CERT-NO.
  1898             20  CM-CERT-PRIME             PIC X(10).
  1899             20  CM-CERT-SFX               PIC X.
  1900
  1901     12  CM-CONTROL-BY-NAME.
  1902         16  CM-COMPANY-CD-A1              PIC X.
  1903         16  CM-INSURED-LAST-NAME          PIC X(15).
  1904         16  CM-INSURED-INITIALS.
  1905             20  CM-INSURED-INITIAL1       PIC X.
  1906             20  CM-INSURED-INITIAL2       PIC X.
  1907
  1908     12  CM-CONTROL-BY-SSN.
  1909         16  CM-COMPANY-CD-A2              PIC X.
  1910         16  CM-SOC-SEC-NO.
  1911             20  CM-SSN-STATE              PIC XX.
  1912             20  CM-SSN-ACCOUNT            PIC X(6).
  1913             20  CM-SSN-LN3.
  1914                 25  CM-INSURED-INITIALS-A2.
  1915                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1916                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1917                 25 CM-PART-LAST-NAME-A2         PIC X.
  1918
  1919     12  CM-CONTROL-BY-CERT-NO.
  1920         16  CM-COMPANY-CD-A4              PIC X.
  1921         16  CM-CERT-NO-A4                 PIC X(11).
  1922
  1923     12  CM-CONTROL-BY-MEMB.
  1924         16  CM-COMPANY-CD-A5              PIC X.
  1925         16  CM-MEMBER-NO.
  1926             20  CM-MEMB-STATE             PIC XX.
  1927             20  CM-MEMB-ACCOUNT           PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* NSRASBL.cbl
  1928             20  CM-MEMB-LN4.
  1929                 25  CM-INSURED-INITIALS-A5.
  1930                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1931                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1932                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1933
  1934     12  CM-INSURED-PROFILE-DATA.
  1935         16  CM-INSURED-FIRST-NAME.
  1936             20  CM-INSURED-1ST-INIT       PIC X.
  1937             20  FILLER                    PIC X(9).
  1938         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1939         16  CM-INSURED-SEX                PIC X.
  1940             88  CM-SEX-MALE                  VALUE 'M'.
  1941             88  CM-SEX-FEMAL                 VALUE 'F'.
  1942         16  CM-INSURED-JOINT-AGE          PIC 99.
  1943         16  CM-JOINT-INSURED-NAME.
  1944             20  CM-JT-LAST-NAME           PIC X(15).
  1945             20  CM-JT-FIRST-NAME.
  1946                 24  CM-JT-1ST-INIT        PIC X.
  1947                 24  FILLER                PIC X(9).
  1948             20  CM-JT-INITIAL             PIC X.
  1949
  1950     12  CM-LIFE-DATA.
  1951         16  CM-LF-BENEFIT-CD              PIC XX.
  1952         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1953         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1954         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1955         16  CM-LF-DEV-CODE                PIC XXX.
  1956         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1957         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1958         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1959         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1960         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1961         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1962         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1963         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1964         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1965         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1966         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1967         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1968         16  FILLER                        PIC XX.
  1969
  1970     12  CM-AH-DATA.
  1971         16  CM-AH-BENEFIT-CD              PIC XX.
  1972         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1973         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1974         16  CM-AH-DEV-CODE                PIC XXX.
  1975         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1976         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1977         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1978         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1979         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1980         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1981         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1982         16  CM-AH-PAID-THRU-DT            PIC XX.
  1983             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1984         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1985         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* NSRASBL.cbl
  1986         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1987         16  FILLER                        PIC X.
  1988
  1989     12  CM-LOAN-INFORMATION.
  1990         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1991         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1992                                           PIC S9(5)V99  COMP-3.
  1993         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1994         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1995         16  CM-PAY-FREQUENCY              PIC S99.
  1996         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1997         16  CM-RATE-CLASS                 PIC XX.
  1998         16  CM-BENEFICIARY                PIC X(25).
  1999         16  CM-POLICY-FORM-NO             PIC X(12).
  2000         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2001         16  CM-LAST-ADD-ON-DT             PIC XX.
  2002         16  CM-DEDUCTIBLE-AMOUNTS.
  2003             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2004             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2005         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2006             20  CM-RESIDENT-STATE         PIC XX.
  2007             20  CM-RATE-CODE              PIC X(4).
  2008             20  FILLER                    PIC XX.
  2009         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2010             20  CM-LOAN-OFFICER           PIC X(5).
  2011             20  FILLER                    PIC XXX.
  2012         16  CM-CSR-CODE                   PIC XXX.
  2013         16  CM-UNDERWRITING-CODE          PIC X.
  2014             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2015         16  CM-POST-CARD-IND              PIC X.
  2016         16  CM-NH-INTERFACE-SW            PIC X.
  2017         16  CM-PREMIUM-TYPE               PIC X.
  2018             88  CM-SING-PRM                  VALUE '1'.
  2019             88  CM-O-B-COVERAGE              VALUE '2'.
  2020             88  CM-OPEN-END                  VALUE '3'.
  2021         16  CM-IND-GRP-TYPE               PIC X.
  2022             88  CM-INDIVIDUAL                VALUE 'I'.
  2023             88  CM-GROUP                     VALUE 'G'.
  2024         16  CM-SKIP-CODE                  PIC X.
  2025             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2026             88  SKIP-JULY                    VALUE '1'.
  2027             88  SKIP-AUGUST                  VALUE '2'.
  2028             88  SKIP-SEPTEMBER               VALUE '3'.
  2029             88  SKIP-JULY-AUG                VALUE '4'.
  2030             88  SKIP-AUG-SEPT                VALUE '5'.
  2031             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2032             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2033             88  SKIP-JUNE                    VALUE '8'.
  2034             88  SKIP-JUNE-JULY               VALUE '9'.
  2035             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2036             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2037         16  CM-PAYMENT-MODE               PIC X.
  2038             88  PAY-MONTHLY                  VALUE SPACE.
  2039             88  PAY-WEEKLY                   VALUE '1'.
  2040             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2041             88  PAY-BI-WEEKLY                VALUE '3'.
  2042             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2043         16  CM-LOAN-NUMBER                PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* NSRASBL.cbl
  2044         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2045         16  CM-OLD-LOF                    PIC XXX.
  2046*        16  CM-LOAN-OFFICER               PIC XXX.
  2047         16  CM-REIN-TABLE                 PIC XXX.
  2048         16  CM-SPECIAL-REIN-CODE          PIC X.
  2049         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2050         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2051         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2052
  2053     12  CM-STATUS-DATA.
  2054         16  CM-ENTRY-STATUS               PIC X.
  2055         16  CM-ENTRY-DT                   PIC XX.
  2056
  2057         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2058         16  CM-LF-CANCEL-DT               PIC XX.
  2059         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2060
  2061         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2062         16  CM-LF-DEATH-DT                PIC XX.
  2063         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2064
  2065         16  CM-LF-CURRENT-STATUS          PIC X.
  2066             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2067                                                'M' '4' '5' '9'.
  2068             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2069             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2070             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2071             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2072             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2073             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2074             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2075             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2076             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2077             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2078             88  CM-LF-DECLINED               VALUE 'D'.
  2079             88  CM-LF-VOIDED                 VALUE 'V'.
  2080
  2081         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2082         16  CM-AH-CANCEL-DT               PIC XX.
  2083         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2084
  2085         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2086         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2087         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2088
  2089         16  CM-AH-CURRENT-STATUS          PIC X.
  2090             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2091                                                'M' '4' '5' '9'.
  2092             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2093             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2094             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2095             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2096             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2097             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2098             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2099             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2100             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2101             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* NSRASBL.cbl
  2102             88  CM-AH-DECLINED               VALUE 'D'.
  2103             88  CM-AH-VOIDED                 VALUE 'V'.
  2104
  2105         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2106             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2107             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2108             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2109         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2110
  2111         16  CM-ENTRY-BATCH                PIC X(6).
  2112         16  CM-LF-EXIT-BATCH              PIC X(6).
  2113         16  CM-AH-EXIT-BATCH              PIC X(6).
  2114         16  CM-LAST-MONTH-END             PIC XX.
  2115
  2116     12  CM-NOTE-SW                        PIC X.
  2117         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2118         88  CERT-NOTES-PRESENT               VALUE '1'.
  2119         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2120         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2121         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2122         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2123         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2124         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2125     12  CM-COMP-EXCP-SW                   PIC X.
  2126         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2127         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2128     12  CM-INSURED-ADDRESS-SW             PIC X.
  2129         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2130         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2131
  2132*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2133     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2134     12  FILLER                            PIC X.
  2135
  2136*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2137     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2138     12  FILLER                            PIC X.
  2139*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2140     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2141
  2142     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2143         88  CERT-ADDED-BATCH                 VALUE ' '.
  2144         88  CERT-ADDED-ONLINE                VALUE '1'.
  2145         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2146         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2147         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2148     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2149         88  CERT-AS-LOADED                   VALUE ' '.
  2150         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2151         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2152         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2153         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2154         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2155         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2156         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2157
  2158     12  CM-ACCOUNT-COMM-PCTS.
  2159         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* NSRASBL.cbl
  2160         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2161
  2162     12  CM-USER-FIELD                     PIC X.
  2163     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2164     12  CM-CLP-STATE                      PIC XX.
  2165     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2166     12  CM-USER-RESERVED                  PIC XXX.
  2167     12  FILLER REDEFINES CM-USER-RESERVED.
  2168         16  CM-AH-CLASS-CD                PIC XX.
  2169         16  F                             PIC X.
  2170******************************************************************
  2171*                                COPY ELCCRTO.
  2172******************************************************************
  2173*                                                                *
  2174*                            ELCCRTO.                            *
  2175*                                                                *
  2176*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2177*                                                                *
  2178*   FILE TYPE = VSAM,KSDS                                        *
  2179*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2180*                                                                *
  2181*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2182*                                                                *
  2183*   LOG = YES                                                    *
  2184*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2185******************************************************************
  2186*                   C H A N G E   L O G
  2187*
  2188* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2189*-----------------------------------------------------------------
  2190*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2191* EFFECTIVE    NUMBER
  2192*-----------------------------------------------------------------
  2193* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2194* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2195* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2196******************************************************************
  2197 01  ORIGINAL-CERTIFICATE.
  2198     12  OC-RECORD-ID                      PIC XX.
  2199         88  VALID-OC-ID                      VALUE 'OC'.
  2200     12  OC-CONTROL-PRIMARY.
  2201         16  OC-COMPANY-CD                 PIC X.
  2202         16  OC-CARRIER                    PIC X.
  2203         16  OC-GROUPING                   PIC X(6).
  2204         16  OC-STATE                      PIC XX.
  2205         16  OC-ACCOUNT                    PIC X(10).
  2206         16  OC-CERT-EFF-DT                PIC XX.
  2207         16  OC-CERT-NO.
  2208             20  OC-CERT-PRIME             PIC X(10).
  2209             20  OC-CERT-SFX               PIC X.
  2210         16  OC-RECORD-TYPE                PIC X.
  2211         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2212     12  OC-LAST-MAINT-DT                  PIC XX.
  2213     12  OC-LAST-MAINT-BY                  PIC X(4).
  2214     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2215     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2216     12  FILLER                            PIC X(49).
  2217     12  OC-ORIG-REC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* NSRASBL.cbl
  2218         16  OC-INS-LAST-NAME              PIC X(15).
  2219         16  OC-INS-FIRST-NAME             PIC X(10).
  2220         16  OC-INS-MIDDLE-INIT            PIC X.
  2221         16  OC-INS-AGE                    PIC S999     COMP-3.
  2222         16  OC-JNT-LAST-NAME              PIC X(15).
  2223         16  OC-JNT-FIRST-NAME             PIC X(10).
  2224         16  OC-JNT-MIDDLE-INIT            PIC X.
  2225         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2226         16  OC-LF-BENCD                   PIC XX.
  2227         16  OC-LF-TERM                    PIC S999      COMP-3.
  2228         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2229         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2230         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2231         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2232         16  OC-LF-EXP-DT                  PIC XX.
  2233         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2234         16  OC-LF-CANCEL-DT               PIC XX.
  2235         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2236         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2237         16  OC-AH-BENCD                   PIC XX.
  2238         16  OC-AH-TERM                    PIC S999      COMP-3.
  2239         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2240         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2241         16  OC-AH-EXP-DT                  PIC XX.
  2242         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2243         16  OC-AH-CP                      PIC 99.
  2244         16  OC-AH-CANCEL-DT               PIC XX.
  2245         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2246         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2247         16  OC-CRED-BENE-NAME             PIC X(25).
  2248         16  OC-1ST-PMT-DT                 PIC XX.
  2249         16  FILLER                        PIC X(215).
  2250
  2251     12  FILLER                            PIC X(50).
  2252******************************************************************
  2253*                                COPY ERCACCT.
  2254******************************************************************
  2255*                                                                *
  2256*                                                                *
  2257*                            ERCACCT                             *
  2258*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2259*                            VMOD=2.031                          *
  2260*                                                                *
  2261*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2262*                                                                *
  2263*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2264*   VSAM ACCOUNT MASTER FILES.                                   *
  2265*                                                                *
  2266*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2267*                                                                *
  2268*   FILE TYPE = VSAM,KSDS                                        *
  2269*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2270*                                                                *
  2271*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2272*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2273*                                                                *
  2274*   LOG = NO                                                     *
  2275*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* NSRASBL.cbl
  2276*                                                                *
  2277*                                                                *
  2278******************************************************************
  2279*                   C H A N G E   L O G
  2280*
  2281* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2282*-----------------------------------------------------------------
  2283*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2284* EFFECTIVE    NUMBER
  2285*-----------------------------------------------------------------
  2286* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2287* 092705    2005050300006  PEMA  ADD SPP LEASES
  2288* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2289* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2290* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2291* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2292* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2293******************************************************************
  2294
  2295 01  ACCOUNT-MASTER.
  2296     12  AM-RECORD-ID                      PIC XX.
  2297         88  VALID-AM-ID                      VALUE 'AM'.
  2298
  2299     12  AM-CONTROL-PRIMARY.
  2300         16  AM-COMPANY-CD                 PIC X.
  2301         16  AM-MSTR-CNTRL.
  2302             20  AM-CONTROL-A.
  2303                 24  AM-CARRIER            PIC X.
  2304                 24  AM-GROUPING.
  2305                     28 AM-GROUPING-PREFIX PIC XXX.
  2306                     28 AM-GROUPING-PRIME  PIC XXX.
  2307                 24  AM-STATE              PIC XX.
  2308                 24  AM-ACCOUNT.
  2309                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2310                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2311             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2312                                           PIC X(19).
  2313             20  AM-CNTRL-B.
  2314                 24  AM-EXPIRATION-DT      PIC XX.
  2315                 24  FILLER                PIC X(4).
  2316             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2317                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2318
  2319     12  AM-CONTROL-BY-VAR-GRP.
  2320         16  AM-COMPANY-CD-A1              PIC X.
  2321         16  AM-VG-CARRIER                 PIC X.
  2322         16  AM-VG-GROUPING                PIC X(6).
  2323         16  AM-VG-STATE                   PIC XX.
  2324         16  AM-VG-ACCOUNT                 PIC X(10).
  2325         16  AM-VG-DATE.
  2326             20  AM-VG-EXPIRATION-DT       PIC XX.
  2327             20  FILLER                    PIC X(4).
  2328         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2329                                           PIC 9(11)      COMP-3.
  2330     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2331         16  FILLER                        PIC X(10).
  2332         16  AM-VG-KEY3.
  2333             20  AM-VG3-ACCOUNT            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* NSRASBL.cbl
  2334             20  AM-VG3-EXP-DT             PIC XX.
  2335         16  FILLER                        PIC X(4).
  2336     12  AM-MAINT-INFORMATION.
  2337         16  AM-LAST-MAINT-DT              PIC XX.
  2338         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2339         16  AM-LAST-MAINT-USER            PIC X(4).
  2340         16  FILLER                        PIC XX.
  2341
  2342     12  AM-EFFECTIVE-DT                   PIC XX.
  2343     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2344
  2345     12  AM-PREV-DATES  COMP-3.
  2346         16  AM-PREV-EXP-DT                PIC 9(11).
  2347         16  AM-PREV-EFF-DT                PIC 9(11).
  2348
  2349     12  AM-REPORT-CODE-1                  PIC X(10).
  2350     12  AM-REPORT-CODE-2                  PIC X(10).
  2351
  2352     12  AM-CITY-CODE                      PIC X(4).
  2353     12  AM-COUNTY-PARISH                  PIC X(6).
  2354
  2355     12  AM-NAME                           PIC X(30).
  2356     12  AM-PERSON                         PIC X(30).
  2357     12  AM-ADDRS                          PIC X(30).
  2358     12  AM-CITY.
  2359         16  AM-ADDR-CITY                  PIC X(28).
  2360         16  AM-ADDR-STATE                 PIC XX.
  2361     12  AM-ZIP.
  2362         16  AM-ZIP-PRIME.
  2363             20  AM-ZIP-PRI-1ST            PIC X.
  2364                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2365             20  FILLER                    PIC X(4).
  2366         16  AM-ZIP-PLUS4                  PIC X(4).
  2367     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2368         16  AM-CAN-POSTAL-1               PIC XXX.
  2369         16  AM-CAN-POSTAL-2               PIC XXX.
  2370         16  FILLER                        PIC XXX.
  2371     12  AM-TEL-NO.
  2372         16  AM-AREA-CODE                  PIC 999.
  2373         16  AM-TEL-PRE                    PIC 999.
  2374         16  AM-TEL-NBR                    PIC 9(4).
  2375     12  AM-TEL-LOC                        PIC X.
  2376         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2377         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2378
  2379     12  AM-COMM-STRUCTURE.
  2380         16  AM-DEFN-1.
  2381             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2382                 24  AM-AGT.
  2383                     28  AM-AGT-PREFIX     PIC X(4).
  2384                     28  AM-AGT-PRIME      PIC X(6).
  2385                 24  AM-COM-TYP            PIC X.
  2386                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2387                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2388                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2389                 24  AM-RECALC-LV-INDIC    PIC X.
  2390                 24  AM-RETRO-LV-INDIC     PIC X.
  2391                 24  AM-GL-CODES           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* NSRASBL.cbl
  2392                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2393                 24  FILLER                PIC X(01).
  2394         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2395             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2396                 24  FILLER                PIC X(11).
  2397                 24  AM-L-COMA             PIC XXX.
  2398                 24  AM-J-COMA             PIC XXX.
  2399                 24  AM-A-COMA             PIC XXX.
  2400                 24  FILLER                PIC X(6).
  2401
  2402     12  AM-COMM-CHANGE-STATUS             PIC X.
  2403         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2404
  2405     12  AM-CSR-CODE                       PIC X(4).
  2406
  2407     12  AM-BILLING-STATUS                 PIC X.
  2408         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2409         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2410     12  AM-AUTO-REFUND-SW                 PIC X.
  2411         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2412         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2413     12  AM-GPCD                           PIC 99.
  2414     12  AM-IG                             PIC X.
  2415         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2416         88  AM-HAS-GROUP                     VALUE '2'.
  2417     12  AM-STATUS                         PIC X.
  2418         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2419         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2420         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2421         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2422         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2423         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2424     12  AM-REMIT-TO                       PIC 99.
  2425     12  AM-ID-NO                          PIC X(11).
  2426
  2427     12  AM-CAL-TABLE                      PIC XX.
  2428     12  AM-LF-DEVIATION                   PIC XXX.
  2429     12  AM-AH-DEVIATION                   PIC XXX.
  2430     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2431     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2432     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2433     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2434     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2435     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2436
  2437     12  AM-USER-FIELDS.
  2438         16  AM-FLD-1                      PIC XX.
  2439         16  AM-FLD-2                      PIC XX.
  2440         16  AM-FLD-3                      PIC XX.
  2441         16  AM-FLD-4                      PIC XX.
  2442         16  AM-FLD-5                      PIC XX.
  2443
  2444     12  AM-1ST-PROD-DATE.
  2445         16  AM-1ST-PROD-YR                PIC XX.
  2446         16  AM-1ST-PROD-MO                PIC XX.
  2447         16  AM-1ST-PROD-DA                PIC XX.
  2448     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2449     12  AM-CERTS-PURGED-DATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* NSRASBL.cbl
  2450         16  AM-PUR-YR                     PIC XX.
  2451         16  AM-PUR-MO                     PIC XX.
  2452         16  AM-PUR-DA                     PIC XX.
  2453     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2454     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2455     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2456     12  AM-INACTIVE-DATE.
  2457         16  AM-INA-MO                     PIC 99.
  2458         16  AM-INA-DA                     PIC 99.
  2459         16  AM-INA-YR                     PIC 99.
  2460     12  AM-AR-HI-CERT-DATE                PIC XX.
  2461
  2462     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2463     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2464
  2465     12  AM-OB-PAYMENT-MODE                PIC X.
  2466         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2467         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2468         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2469         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2470
  2471     12  AM-AH-ONLY-INDICATOR              PIC X.
  2472         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2473         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2474
  2475     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2476
  2477     12  AM-OVER-SHORT.
  2478         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2479         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2480
  2481     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2482     12  AM-DCC-CLP-STATE                  PIC XX.
  2483
  2484     12  AM-RECALC-COMM                    PIC X.
  2485     12  AM-RECALC-REIN                    PIC X.
  2486
  2487     12  AM-REI-TABLE                      PIC XXX.
  2488     12  AM-REI-ET-LF                      PIC X.
  2489     12  AM-REI-ET-AH                      PIC X.
  2490     12  AM-REI-PE-LF                      PIC X.
  2491     12  AM-REI-PE-AH                      PIC X.
  2492     12  AM-REI-PRT-ST                     PIC X.
  2493     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2494     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2495     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2496     12  AM-REI-GROUP-A                    PIC X(6).
  2497     12  AM-REI-MORT                       PIC X(4).
  2498     12  AM-REI-PRT-OW                     PIC X.
  2499     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2500     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2501     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2502     12  AM-REI-GROUP-B                    PIC X(6).
  2503
  2504     12  AM-TRUST-TYPE                     PIC X(2).
  2505
  2506     12  AM-EMPLOYER-STMT-USED             PIC X.
  2507     12  AM-GROUPED-CHECKS-Y-N             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* NSRASBL.cbl
  2508
  2509     12  AM-STD-AH-TYPE                    PIC XX.
  2510     12  AM-EARN-METHODS.
  2511         16  AM-EARN-METHOD-R              PIC X.
  2512             88 AM-REF-RL-R78                 VALUE 'R'.
  2513             88 AM-REF-RL-PR                  VALUE 'P'.
  2514             88 AM-REF-RL-MEAN                VALUE 'M'.
  2515             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2516         16  AM-EARN-METHOD-L              PIC X.
  2517             88 AM-REF-LL-R78                 VALUE 'R'.
  2518             88 AM-REF-LL-PR                  VALUE 'P'.
  2519             88 AM-REF-LL-MEAN                VALUE 'M'.
  2520             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2521         16  AM-EARN-METHOD-A              PIC X.
  2522             88 AM-REF-AH-R78                 VALUE 'R'.
  2523             88 AM-REF-AH-PR                  VALUE 'P'.
  2524             88 AM-REF-AH-MEAN                VALUE 'M'.
  2525             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2526             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2527             88 AM-REF-AH-NET                 VALUE 'N'.
  2528
  2529     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2530     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2531     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2532
  2533     12  AM-RET-Y-N                        PIC X.
  2534     12  AM-RET-P-E                        PIC X.
  2535     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2536     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2537     12  AM-RET-GRP                        PIC X(6).
  2538     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2539         16  AM-POOL-PRIME                 PIC XXX.
  2540         16  AM-POOL-SUB                   PIC XXX.
  2541     12  AM-RETRO-EARNINGS.
  2542         16  AM-RET-EARN-R                 PIC X.
  2543         16  AM-RET-EARN-L                 PIC X.
  2544         16  AM-RET-EARN-A                 PIC X.
  2545     12  AM-RET-ST-TAX-USE                 PIC X.
  2546         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2547         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2548     12  AM-RETRO-BEG-EARNINGS.
  2549         16  AM-RET-BEG-EARN-R             PIC X.
  2550         16  AM-RET-BEG-EARN-L             PIC X.
  2551         16  AM-RET-BEG-EARN-A             PIC X.
  2552     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2553     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2554
  2555     12  AM-USER-SELECT-OPTIONS.
  2556         16  AM-USER-SELECT-1              PIC X(10).
  2557         16  AM-USER-SELECT-2              PIC X(10).
  2558         16  AM-USER-SELECT-3              PIC X(10).
  2559         16  AM-USER-SELECT-4              PIC X(10).
  2560         16  AM-USER-SELECT-5              PIC X(10).
  2561
  2562     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2563
  2564     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2565
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* NSRASBL.cbl
  2566     12  AM-RPT045A-SWITCH                 PIC X.
  2567         88  RPT045A-OFF                   VALUE 'N'.
  2568
  2569     12  AM-INSURANCE-LIMITS.
  2570         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2571         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2572
  2573     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2574         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2575
  2576     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2577         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2578         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2579
  2580     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2581
  2582     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2583     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2584     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2585     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2586     12  AM-DCC-UEF-STATE                  PIC XX.
  2587     12  FILLER                            PIC XXX.
  2588     12  AM-REPORT-CODE-3                  PIC X(10).
  2589*    12  FILLER                            PIC X(22).
  2590
  2591     12  AM-RESERVE-DATE.
  2592         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2593         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2594         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2595
  2596     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2597     12  AM-NOTIFICATION-TYPES.
  2598         16  AM-NOTIF-OF-LETTERS           PIC X.
  2599         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2600         16  AM-NOTIF-OF-REPORTS           PIC X.
  2601         16  AM-NOTIF-OF-STATUS            PIC X.
  2602
  2603     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2604         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2605         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2606         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2607         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2608
  2609     12  AM-BENEFIT-CONTROLS.
  2610         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2611             20  AM-BENEFIT-CODE           PIC XX.
  2612             20  AM-BENEFIT-TYPE           PIC X.
  2613             20  AM-BENEFIT-REVISION       PIC XXX.
  2614             20  AM-BENEFIT-REM-TERM       PIC X.
  2615             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2616             20  FILLER                    PIC XX.
  2617         16  FILLER                        PIC X(80).
  2618
  2619     12  AM-TRANSFER-DATA.
  2620         16  AM-TRANSFERRED-FROM.
  2621             20  AM-TRNFROM-CARRIER        PIC X.
  2622             20  AM-TRNFROM-GROUPING.
  2623                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* NSRASBL.cbl
  2624                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2625             20  AM-TRNFROM-STATE          PIC XX.
  2626             20  AM-TRNFROM-ACCOUNT.
  2627                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2628                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2629             20  AM-TRNFROM-DTE            PIC XX.
  2630         16  AM-TRANSFERRED-TO.
  2631             20  AM-TRNTO-CARRIER          PIC X.
  2632             20  AM-TRNTO-GROUPING.
  2633                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2634                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2635             20  AM-TRNTO-STATE            PIC XX.
  2636             20  AM-TRNTO-ACCOUNT.
  2637                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2638                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2639             20  AM-TRNTO-DTE              PIC XX.
  2640         16  FILLER                        PIC X(10).
  2641
  2642     12  AM-SAVED-REMIT-TO                 PIC 99.
  2643
  2644     12  AM-COMM-STRUCTURE-SAVED.
  2645         16  AM-DEFN-1-SAVED.
  2646             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2647                 24  AM-AGT-SV             PIC X(10).
  2648                 24  AM-COM-TYP-SV         PIC X.
  2649                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2650                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2651                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2652                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2653                 24  FILLER                PIC X.
  2654                 24  AM-GL-CODES-SV        PIC X.
  2655                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2656                 24  FILLER                PIC X.
  2657         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2658             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2659                 24  FILLER                PIC X(11).
  2660                 24  AM-L-COMA-SV          PIC XXX.
  2661                 24  AM-J-COMA-SV          PIC XXX.
  2662                 24  AM-A-COMA-SV          PIC XXX.
  2663                 24  FILLER                PIC X(6).
  2664
  2665     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2666         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2667            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2668            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2669            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2670
  2671     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2672     12  FILLER                            PIC X(120).
  2673
  2674     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2675         16  AM-CONTROL-NAME               PIC X(30).
  2676         16  AM-EXECUTIVE-ONE.
  2677             20  AM-EXEC1-NAME             PIC X(15).
  2678             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2679                                                          COMP-3.
  2680             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2681                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* NSRASBL.cbl
  2682         16  AM-EXECUTIVE-TWO.
  2683             20  AM-EXEC2-NAME             PIC X(15).
  2684             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2685                                                          COMP-3.
  2686             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2687                                                          COMP-3.
  2688
  2689     12  AM-RETRO-ADDITIONAL-DATA.
  2690         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2691         16  AM-RETRO-PREM-P-E             PIC X.
  2692         16  AM-RETRO-CLMS-P-I             PIC X.
  2693         16  AM-RETRO-RET-BRACKET-LF.
  2694             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2695                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2696                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2697             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2698                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2699                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2700             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2701                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2702                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2703         16  AM-RETRO-RET-BRACKET-AH.
  2704             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2705                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2706                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2707                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2708             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2709                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2710                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2711             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2712                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2713                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2714
  2715     12  AM-COMMENTS.
  2716         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2717
  2718     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2719         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2720         16  AM-FLI-BILLING-CODE           PIC X.
  2721         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2722         16  AM-FLI-UNITED-IDENT           PIC X.
  2723         16  AM-FLI-INTEREST-LOST-DATA.
  2724             20  AM-FLI-BANK-NO            PIC X(5).
  2725             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2726             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2727             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2728         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2729             20  AM-FLI-AGT                PIC X(9).
  2730             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2731             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2732         16  FILLER                        PIC X(102).
  2733
  2734     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2735         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2736             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2737             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2738             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2739             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* NSRASBL.cbl
  2740             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2741         16  FILLER                          PIC X(10).
  2742******************************************************************
  2743*                                COPY ELCTEXT.
  2744******************************************************************
  2745*                                                                *
  2746*                                                                *
  2747*                            ELCTEXT.                            *
  2748*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2749*                            VMOD=2.008                          *
  2750*                                                                *
  2751*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  2752*                                     FORM LETTERS,              *
  2753*                                     CERT FORM DISPLAY.
  2754*                                                                *
  2755*   FILE TYPE = VSAM,KSDS                                        *
  2756*   RECORD SIZE = 100   RECFORM = FIXED                          *
  2757*                                                                *
  2758*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  2759*       ALTERNATE INDEX = NONE                                   *
  2760*                                                                *
  2761*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  2762*       ALTERNATE INDEX = NONE                                   *
  2763*                                                                *
  2764*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  2765*       ALTERNATE INDEX = NONE                                   *
  2766*                                                                *
  2767*   LOG = NO                                                     *
  2768*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2769******************************************************************
  2770 01  TEXT-FILES.
  2771     12  TEXT-FILE-ID                PIC XX.
  2772         88  FORMS-FILE-TEXT            VALUE 'TF'.
  2773         88  LETTER-FILE-TEXT           VALUE 'TL'.
  2774         88  HELP-FILE-TEXT             VALUE 'TH'.
  2775
  2776     12  TX-CONTROL-PRIMARY.
  2777         16  TX-COMPANY-CD           PIC X.
  2778             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  2779         16  TX-ACCESS-CD-GENL       PIC X(12).
  2780
  2781         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2782             20  TX-LETTER-NO        PIC X(4).
  2783             20  FILLER              PIC X(8).
  2784
  2785         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2786             20  TX-FORM-NO          PIC X(12).
  2787
  2788         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  2789             20  TX-HELP-TYPE        PIC X.
  2790                 88  HELP-FOR-GENERAL   VALUE ' '.
  2791                 88  HELP-BY-SCREEN     VALUE 'S'.
  2792                 88  HELP-BY-ERROR      VALUE 'E'.
  2793             20  TX-SCREEN-OR-ERROR  PIC X(4).
  2794                 88  GENERAL-INFO-HELP  VALUE '0000'.
  2795             20  TX-HELP-FOR-COMPANY  PIC XXX.
  2796                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  2797             20  FILLER              PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* NSRASBL.cbl
  2798
  2799         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  2800
  2801     12  TX-PROCESS-CONTROL          PIC XX.
  2802         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  2803
  2804     12  TX-TEXT-LINE                PIC X(70).
  2805
  2806     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  2807         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  2808         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  2809         88  TX-VALID-FORM-SQUEEZE-VALUE
  2810                                        VALUE 'Y' ' '.
  2811
  2812     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  2813         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  2814         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  2815         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  2816         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  2817         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  2818         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  2819         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  2820                                              'K' 'N' ' '
  2821                                              'Z'.
  2822
  2823     12  TX-ARCHIVE-SW               PIC X.
  2824         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  2825         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  2826         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  2827
  2828     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  2829     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  2830
  2831     12  TX-BSR-CODE                 PIC X.
  2832         88  TX-BSR-LETTER              VALUE 'B'.
  2833         88  TX-NON-BSR-LETTER          VALUE ' '.
  2834
  2835     12  FILLER                      PIC X.
  2836*****************************************************************
  2837*                                COPY ELCCNTL.
  2838******************************************************************
  2839*                                                                *
  2840*                                                                *
  2841*                            ELCCNTL.                            *
  2842*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2843*                            VMOD=2.059                          *
  2844*                                                                *
  2845*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2846*                                                                *
  2847*   FILE TYPE = VSAM,KSDS                                        *
  2848*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2849*                                                                *
  2850*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2851*       ALTERNATE INDEX = NONE                                   *
  2852*                                                                *
  2853*   LOG = YES                                                    *
  2854*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2855******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* NSRASBL.cbl
  2856*                   C H A N G E   L O G
  2857*
  2858* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2859*-----------------------------------------------------------------
  2860*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2861* EFFECTIVE    NUMBER
  2862*-----------------------------------------------------------------
  2863* 082503                   PEMA  ADD BENEFIT GROUP
  2864* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2865* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2866* 092705    2005050300006  PEMA  ADD SPP LEASES
  2867* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2868* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2869* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2870* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2871* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2872* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2873******************************************************************
  2874*
  2875 01  CONTROL-FILE.
  2876     12  CF-RECORD-ID                       PIC XX.
  2877         88  VALID-CF-ID                        VALUE 'CF'.
  2878
  2879     12  CF-CONTROL-PRIMARY.
  2880         16  CF-COMPANY-ID                  PIC XXX.
  2881         16  CF-RECORD-TYPE                 PIC X.
  2882             88  CF-COMPANY-MASTER              VALUE '1'.
  2883             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2884             88  CF-STATE-MASTER                VALUE '3'.
  2885             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2886             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2887             88  CF-CARRIER-MASTER              VALUE '6'.
  2888             88  CF-MORTALITY-MASTER            VALUE '7'.
  2889             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2890             88  CF-TERMINAL-MASTER             VALUE '9'.
  2891             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2892             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2893             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2894             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2895             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2896             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2897             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2898             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2899             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2900         16  CF-ACCESS-CD-GENL              PIC X(4).
  2901         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2902             20  CF-PROCESSOR               PIC X(4).
  2903         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2904             20  CF-STATE-CODE              PIC XX.
  2905             20  FILLER                     PIC XX.
  2906         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2907             20  FILLER                     PIC XX.
  2908             20  CF-HI-BEN-IN-REC           PIC XX.
  2909         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2910             20  FILLER                     PIC XXX.
  2911             20  CF-CARRIER-CNTL            PIC X.
  2912         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2913             20  FILLER                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* NSRASBL.cbl
  2914             20  CF-HI-TYPE-IN-REC          PIC 99.
  2915         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2916             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2917                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2918             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2919             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2920         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2921             20  FILLER                     PIC X.
  2922             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2923         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2924             20  FILLER                     PIC XX.
  2925             20  CF-MORTGAGE-PLAN           PIC XX.
  2926         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2927
  2928     12  CF-LAST-MAINT-DT                   PIC XX.
  2929     12  CF-LAST-MAINT-BY                   PIC X(4).
  2930     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2931
  2932     12  CF-RECORD-BODY                     PIC X(728).
  2933
  2934
  2935****************************************************************
  2936*             COMPANY MASTER RECORD                            *
  2937****************************************************************
  2938
  2939     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2940         16  CF-COMPANY-ADDRESS.
  2941             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2942             20  CF-CL-IN-CARE-OF           PIC X(30).
  2943             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2944             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2945             20  CF-CL-CITY-STATE           PIC X(30).
  2946             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2947             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2948         16  CF-COMPANY-CD                  PIC X.
  2949         16  CF-COMPANY-PASSWORD            PIC X(8).
  2950         16  CF-SECURITY-OPTION             PIC X.
  2951             88  ALL-SECURITY                   VALUE '1'.
  2952             88  COMPANY-VERIFY                 VALUE '2'.
  2953             88  PROCESSOR-VERIFY               VALUE '3'.
  2954             88  NO-SECURITY                    VALUE '4'.
  2955             88  ALL-BUT-TERM                   VALUE '5'.
  2956         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2957             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2958         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2959             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2960         16  CF-INFORCE-LOCATION            PIC X.
  2961             88  CERTS-ARE-ONLINE               VALUE '1'.
  2962             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2963             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2964         16  CF-LOWER-CASE-LETTERS          PIC X.
  2965         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2966             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2967             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2968             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2969             88  CF-ACCNT-CNTL                  VALUE '3'.
  2970             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2971
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* NSRASBL.cbl
  2972         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2973         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2974
  2975         16  CF-LGX-CREDIT-USER             PIC X.
  2976             88  CO-IS-NOT-USER                 VALUE 'N'.
  2977             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2978
  2979         16 CF-CREDIT-CALC-CODES.
  2980             20  CF-CR-REM-TERM-CALC PIC X.
  2981               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2982               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2983               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2984               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2985               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2986               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2987               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2988             20  CF-CR-R78-METHOD           PIC X.
  2989               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2990               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2991
  2992         16  CF-CLAIM-CONTROL-COUNTS.
  2993             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2994                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2995
  2996             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2997                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2998
  2999             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3000                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3001
  3002             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3003                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3004
  3005         16  CF-CURRENT-MONTH-END           PIC XX.
  3006
  3007         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3008             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3009             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3010             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3011             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3012                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3013                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3014             20  CF-CO-PREM-REJECT-SW       PIC X.
  3015                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3016                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3017             20  CF-CO-REF-REJECT-SW        PIC X.
  3018                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3019                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3020
  3021         16  CF-CO-REPORTING-DT             PIC XX.
  3022         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3023         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3024           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3025           88  CF-CO-MONTH-END                  VALUE '1'.
  3026
  3027         16  CF-LGX-CLAIM-USER              PIC X.
  3028             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3029             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* NSRASBL.cbl
  3030
  3031         16  CF-CREDIT-EDIT-CONTROLS.
  3032             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3033             20  CF-MIN-AGE                 PIC 99.
  3034             20  CF-DEFAULT-AGE             PIC 99.
  3035             20  CF-MIN-TERM                PIC S999      COMP-3.
  3036             20  CF-MAX-TERM                PIC S999      COMP-3.
  3037             20  CF-DEFAULT-SEX             PIC X.
  3038             20  CF-JOINT-AGE-INPUT         PIC X.
  3039                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3040             20  CF-BIRTH-DATE-INPUT        PIC X.
  3041                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3042             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3043                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3044                 88  CF-ZERO-CARRIER            VALUE '1'.
  3045                 88  CF-ZERO-GROUPING           VALUE '2'.
  3046                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3047             20  CF-EDIT-SW                 PIC X.
  3048                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3049             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3050             20  CF-CR-PR-METHOD            PIC X.
  3051               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3052               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3053             20  FILLER                     PIC X.
  3054
  3055         16  CF-CREDIT-MISC-CONTROLS.
  3056             20  CF-REIN-TABLE-SW           PIC X.
  3057                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3058             20  CF-COMP-TABLE-SW           PIC X.
  3059                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3060             20  CF-EXPERIENCE-RETENTION-AGE
  3061                                            PIC S9        COMP-3.
  3062             20  CF-CONVERSION-DT           PIC XX.
  3063             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3064             20  CF-RUN-FREQUENCY-SW        PIC X.
  3065                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3066                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3067
  3068             20  CF-CR-CHECK-NO-CONTROL.
  3069                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3070                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3071                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3072                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3073                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3074                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3075
  3076                 24  CF-CR-CHECK-COUNT       REDEFINES
  3077                     CF-CR-CHECK-COUNTER      PIC X(4).
  3078
  3079                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3080                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3081
  3082                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3083                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3084                 24  CF-MAIL-PROCESSING       PIC X.
  3085                     88  MAIL-PROCESSING          VALUE 'Y'.
  3086
  3087         16  CF-MISC-SYSTEM-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* NSRASBL.cbl
  3088             20  CF-SYSTEM-C                 PIC X.
  3089                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3090             20  CF-SYSTEM-D                 PIC X.
  3091                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3092             20  CF-SOC-SEC-NO-SW            PIC X.
  3093                 88  SOC-SEC-NO-USED             VALUE '1'.
  3094             20  CF-MEMBER-NO-SW             PIC X.
  3095                 88  MEMBER-NO-USED              VALUE '1'.
  3096             20  CF-TAX-ID-NUMBER            PIC X(11).
  3097             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3098             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3099                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3100                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3101                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3102                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3103             20  CF-SYSTEM-E                 PIC X.
  3104                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3105
  3106         16  CF-LGX-LIFE-USER               PIC X.
  3107             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3108             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3109
  3110         16  CF-CR-MONTH-END-DT             PIC XX.
  3111
  3112         16  CF-FILE-MAINT-DATES.
  3113             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3114                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3115             20  CF-LAST-BATCH       REDEFINES
  3116                 CF-LAST-BATCH-NO               PIC X(4).
  3117             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3118             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3119             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3120             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3121             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3122             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3123             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3124             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3125             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3126             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3127
  3128         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3129         16  FILLER                         PIC X.
  3130
  3131         16  CF-ALT-MORT-CODE               PIC X(4).
  3132         16  CF-MEMBER-CAPTION              PIC X(10).
  3133
  3134         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3135             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3136             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3137             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3138             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3139             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3140
  3141         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3142
  3143         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3144         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3145         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* NSRASBL.cbl
  3146         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3147
  3148         16  CF-AH-OVERRIDE-L1              PIC X.
  3149         16  CF-AH-OVERRIDE-L2              PIC XX.
  3150         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3151         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3152
  3153         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3154         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3155
  3156         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3157         16  CF-AR-LAST-EL860-DT            PIC XX.
  3158         16  CF-MP-MONTH-END-DT             PIC XX.
  3159
  3160         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3161         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3162             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3163
  3164         16  CF-AR-MONTH-END-DT             PIC XX.
  3165
  3166         16  CF-CRDTCRD-USER                PIC X.
  3167             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3168             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3169
  3170         16  CF-CC-MONTH-END-DT             PIC XX.
  3171
  3172         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3173
  3174         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3175             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3176             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3177             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3178         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3179         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3180         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3181         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3182             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3183             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3184         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3185         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3186         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3187             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3188         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3189
  3190         16  CF-CL-ZIP-CODE.
  3191             20  CF-CL-ZIP-PRIME.
  3192                 24  CF-CL-ZIP-1ST          PIC X.
  3193                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3194                 24  FILLER                 PIC X(4).
  3195             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3196         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3197             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3198             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3199             20  FILLER                     PIC XXX.
  3200
  3201         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3202         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3203         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* NSRASBL.cbl
  3204         16  CF-CO-OPTION-START-DATE        PIC XX.
  3205         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3206           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3207                                                      '3' '4'.
  3208           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3209           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3210           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3211           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3212           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3213           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3214
  3215         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3216
  3217         16  CF-PAYMENT-APPROVAL-LEVELS.
  3218             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3219             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3220             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3221             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3222             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3223             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3224
  3225         16  CF-END-USER-REPORTING-USER     PIC X.
  3226             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3227             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3228
  3229         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3230             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3231             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3232
  3233         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3234
  3235         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3236         16  FILLER                         PIC X.
  3237
  3238         16  CF-CREDIT-ARCHIVE-CNTL.
  3239             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3240             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3241             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3242
  3243         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3244
  3245         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3246             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3247             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3248
  3249         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3250             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3251             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3252
  3253         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3254
  3255         16  CF-CO-ACH-ID-CODE              PIC  X.
  3256             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3257             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3258             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3259         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3260         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3261         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* NSRASBL.cbl
  3262         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3263         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3264         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3265         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3266         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3267         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3268                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3269         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3270                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3271
  3272         16  CF-CO-OVER-SHORT.
  3273             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3274             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3275
  3276*         16  FILLER                         PIC X(102).
  3277         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3278             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3279             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3280
  3281         16  CF-AH-APPROVAL-DAYS.
  3282             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3283             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3284             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3285             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3286
  3287         16  FILLER                         PIC X(82).
  3288****************************************************************
  3289*             PROCESSOR/USER RECORD                            *
  3290****************************************************************
  3291
  3292     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3293         16  CF-PROCESSOR-NAME              PIC X(30).
  3294         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3295         16  CF-PROCESSOR-TITLE             PIC X(26).
  3296         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3297                 88  MESSAGE-YES                VALUE 'Y'.
  3298                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3299
  3300*****************************************************
  3301****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3302****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3303****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3304****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3305*****************************************************
  3306
  3307         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3308             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3309             20  CF-APPLICATION-FORCE       PIC X.
  3310             20  CF-INDIVIDUAL-APP.
  3311                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3312                     28  CF-BROWSE-APP      PIC X.
  3313                     28  CF-UPDATE-APP      PIC X.
  3314
  3315         16  CF-CURRENT-TERM-ON             PIC X(4).
  3316         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3317             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3318             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3319             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* NSRASBL.cbl
  3320             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3321             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3322             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3323             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3324         16  CF-PROCESSOR-CARRIER           PIC X.
  3325             88  NO-CARRIER-SECURITY            VALUE ' '.
  3326         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3327             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3328         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3329             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3330         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3331             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3332
  3333         16  CF-PROC-SYS-ACCESS-SW.
  3334             20  CF-PROC-CREDIT-CLAIMS-SW.
  3335                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3336                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3337                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3338                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3339             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3340                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3341                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3342             20  CF-PROC-LIFE-GNRLDGR-SW.
  3343                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3344                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3345                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3346                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3347             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3348                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3349                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3350         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3351             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3352             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3353         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3354
  3355         16  CF-APPROVAL-LEVEL                  PIC X.
  3356             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3357             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3358             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3359             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3360
  3361         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3362
  3363         16  CF-LANGUAGE-TYPE                   PIC X.
  3364             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3365             88  CF-LANG-IS-FR                      VALUE 'F'.
  3366
  3367         16  CF-CSR-IND                         PIC X.
  3368         16  FILLER                             PIC X(239).
  3369
  3370****************************************************************
  3371*             PROCESSOR/REMINDERS RECORD                       *
  3372****************************************************************
  3373
  3374     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3375         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3376             20  CF-START-REMIND-DT         PIC XX.
  3377             20  CF-END-REMIND-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* NSRASBL.cbl
  3378             20  CF-REMINDER-TEXT           PIC X(50).
  3379         16  FILLER                         PIC X(296).
  3380
  3381
  3382****************************************************************
  3383*             STATE MASTER RECORD                              *
  3384****************************************************************
  3385
  3386     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3387         16  CF-STATE-ABBREVIATION          PIC XX.
  3388         16  CF-STATE-NAME                  PIC X(25).
  3389         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3390         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3391             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3392             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3393             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3394             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3395                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3396                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3397             20  CF-ST-PREM-REJECT-SW       PIC X.
  3398                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3399                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3400             20  CF-ST-REF-REJECT-SW        PIC X.
  3401                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3402                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3403         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3404         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3405         16  CF-ST-REFUND-RULES.
  3406             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3407             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3408             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3409         16  CF-ST-FST-PMT-EXTENSION.
  3410             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3411             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3412                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3413                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3414                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3415                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3416         16  CF-ST-STATE-CALL.
  3417             20  CF-ST-CALL-UNEARNED        PIC X.
  3418             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3419             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3420         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3421             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3422             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3423         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3424         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3425         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3426         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3427         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3428         16  FILLER                         PIC X.
  3429         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3430             20  CF-ST-BENEFIT-CD           PIC XX.
  3431             20  CF-ST-BENEFIT-KIND         PIC X.
  3432                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3433                 88  CF-ST-AH-KIND              VALUE 'A'.
  3434             20  CF-ST-REM-TERM-CALC        PIC X.
  3435                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* NSRASBL.cbl
  3436                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3437                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3438                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3439                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3440                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3441                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3442                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3443
  3444             20  CF-ST-REFUND-CALC          PIC X.
  3445                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3446                 88  ST-REFD-BY-R78             VALUE '1'.
  3447                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3448                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3449                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3450                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3451                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3452                 88  ST-REFD-UTAH               VALUE '7'.
  3453                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3454                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3455                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3456
  3457             20  CF-ST-EARNING-CALC         PIC X.
  3458                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3459                 88  ST-EARN-BY-R78             VALUE '1'.
  3460                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3461                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3462                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3463                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3464                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3465                 88  ST-EARN-MEAN               VALUE '8'.
  3466                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3467
  3468             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3469                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3470                 88  ST-OVRD-BY-R78             VALUE '1'.
  3471                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3472                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3473                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3474                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3475                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3476                 88  ST-OVRD-MEAN               VALUE '8'.
  3477                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3478             20  FILLER                     PIC X.
  3479
  3480         16  CF-ST-COMMISSION-CAPS.
  3481             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3482             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3483             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3484             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3485         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3486                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3487
  3488         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3489
  3490         16  CF-ST-STATUTORY-INTEREST.
  3491             20  CF-ST-STAT-DATE-FROM       PIC X.
  3492                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3493                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* NSRASBL.cbl
  3494             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3495             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3496             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3497             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3498             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3499
  3500         16  CF-ST-OVER-SHORT.
  3501             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3502             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3503
  3504         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3505
  3506         16  CF-ST-RT-CALC                  PIC X.
  3507
  3508         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3509         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3510         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3511         16  CF-ST-RF-LR-CALC               PIC X.
  3512         16  CF-ST-RF-LL-CALC               PIC X.
  3513         16  CF-ST-RF-LN-CALC               PIC X.
  3514         16  CF-ST-RF-AH-CALC               PIC X.
  3515         16  CF-ST-RF-CP-CALC               PIC X.
  3516*        16  FILLER                         PIC X(206).
  3517*CIDMOD         16  FILLER                         PIC X(192).
  3518         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3519             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3520         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3521         16  CF-ST-VFY-2ND-BENE             PIC X.
  3522         16  FILLER                         PIC X(186).
  3523
  3524****************************************************************
  3525*             BENEFIT MASTER RECORD                            *
  3526****************************************************************
  3527
  3528     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3529         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3530             20  CF-BENEFIT-CODE            PIC XX.
  3531             20  CF-BENEFIT-NUMERIC  REDEFINES
  3532                 CF-BENEFIT-CODE            PIC XX.
  3533             20  CF-BENEFIT-ALPHA           PIC XXX.
  3534             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3535             20  CF-BENEFIT-COMMENT         PIC X(10).
  3536
  3537             20  CF-LF-COVERAGE-TYPE        PIC X.
  3538                 88  CF-REDUCING                VALUE 'R'.
  3539                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3540
  3541             20  CF-SPECIAL-CALC-CD         PIC X.
  3542                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3543                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3544                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3545                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3546                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3547                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3548                 88  CF-FARM-PLAN               VALUE 'F'.
  3549                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3550                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3551                 88  CF-3-MTH-INTEREST          VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* NSRASBL.cbl
  3552                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3553                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3554                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3555                 88  CF-PRUDENTIAL              VALUE 'P'.
  3556                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3557                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3558                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3559                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3560                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3561                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3562
  3563             20  CF-JOINT-INDICATOR         PIC X.
  3564                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3565
  3566*            20  FILLER                     PIC X(12).
  3567             20  FILLER                     PIC X(11).
  3568             20  CF-BENEFIT-CATEGORY        PIC X.
  3569             20  CF-LOAN-TYPE               PIC X(8).
  3570
  3571             20  CF-CO-REM-TERM-CALC        PIC X.
  3572                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3573                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3574                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3575                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3576                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3577
  3578             20  CF-CO-EARNINGS-CALC        PIC X.
  3579                 88  CO-EARN-BY-R78             VALUE '1'.
  3580                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3581                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3582                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3583                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3584                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3585                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3586                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3587
  3588             20  CF-CO-REFUND-CALC          PIC X.
  3589                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3590                 88  CO-REFD-BY-R78             VALUE '1'.
  3591                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3592                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3593                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3594                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3595                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3596                 88  CO-REFD-MEAN               VALUE '8'.
  3597                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3598                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3599                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3600
  3601             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3602                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3603                 88  CO-OVRD-BY-R78             VALUE '1'.
  3604                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3605                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3606                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3607                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3608                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3609                 88  CO-OVRD-MEAN               VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* NSRASBL.cbl
  3610                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3611
  3612             20  CF-CO-BEN-I-G-CD           PIC X.
  3613                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3614                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3615                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3616
  3617         16  FILLER                         PIC X(304).
  3618
  3619
  3620****************************************************************
  3621*             CARRIER MASTER RECORD                            *
  3622****************************************************************
  3623
  3624     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3625         16  CF-ADDRESS-DATA.
  3626             20  CF-MAIL-TO-NAME            PIC X(30).
  3627             20  CF-IN-CARE-OF              PIC X(30).
  3628             20  CF-ADDRESS-LINE-1          PIC X(30).
  3629             20  CF-ADDRESS-LINE-2          PIC X(30).
  3630             20  CF-CITY-STATE              PIC X(30).
  3631             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3632             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3633
  3634         16  CF-CLAIM-NO-CONTROL.
  3635             20  CF-CLAIM-NO-METHOD         PIC X.
  3636                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3637                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3638                 88  CLAIM-NO-SEQ               VALUE '3'.
  3639                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3640             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3641                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3642                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3643                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3644
  3645         16  CF-CHECK-NO-CONTROL.
  3646             20  CF-CHECK-NO-METHOD         PIC X.
  3647                 88  CHECK-NO-MANUAL            VALUE '1'.
  3648                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3649                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3650                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3651             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3652                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3653
  3654         16  CF-DOMICILE-STATE              PIC XX.
  3655
  3656         16  CF-EXPENSE-CONTROLS.
  3657             20  CF-EXPENSE-METHOD          PIC X.
  3658                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3659                 88  DOLLARS-PER-PMT            VALUE '2'.
  3660                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3661                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3662             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3663             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3664
  3665         16  CF-CORRESPONDENCE-CONTROL.
  3666             20  CF-LETTER-RESEND-OPT       PIC X.
  3667                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* NSRASBL.cbl
  3668                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3669             20  FILLER                     PIC X(4).
  3670
  3671         16  CF-RESERVE-CONTROLS.
  3672             20  CF-MANUAL-SW               PIC X.
  3673                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3674             20  CF-FUTURE-SW               PIC X.
  3675                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3676             20  CF-PTC-SW                  PIC X.
  3677                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3678             20  CF-IBNR-SW                 PIC X.
  3679                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3680             20  CF-PTC-LF-SW               PIC X.
  3681                 88  CF-LF-PTC-USED             VALUE '1'.
  3682             20  CF-CDT-ACCESS-METHOD       PIC X.
  3683                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3684                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3685                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3686             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3687
  3688         16  CF-CLAIM-CALC-METHOD           PIC X.
  3689             88  360-PLUS-MONTHS                VALUE '1'.
  3690             88  365-PLUS-MONTHS                VALUE '2'.
  3691             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3692             88  360-DAILY                      VALUE '4'.
  3693             88  365-DAILY                      VALUE '5'.
  3694
  3695         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3696         16  FILLER                         PIC X(11).
  3697
  3698         16  CF-LIMIT-AMOUNTS.
  3699             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3700             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3701             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3702             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3703             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3704             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3705             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3706             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3707             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3708             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3709
  3710         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3711         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3712         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3713
  3714         16  CF-ZIP-CODE.
  3715             20  CF-ZIP-PRIME.
  3716                 24  CF-ZIP-1ST             PIC X.
  3717                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3718                 24  FILLER                 PIC X(4).
  3719             20  CF-ZIP-PLUS4               PIC X(4).
  3720         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3721             20  CF-CAN-POSTAL-1            PIC XXX.
  3722             20  CF-CAN-POSTAL-2            PIC XXX.
  3723             20  FILLER                     PIC XXX.
  3724
  3725         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* NSRASBL.cbl
  3726         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3727         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3728
  3729         16  CF-RATING-SWITCH               PIC X.
  3730             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3731             88  CF-NO-RATING                   VALUE 'N'.
  3732
  3733         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3734
  3735         16  CF-CARRIER-OVER-SHORT.
  3736             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3737             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3738
  3739         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3740         16  CF-SECPAY-SWITCH               PIC X.
  3741             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3742             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3743         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3744         16  FILLER                         PIC X(448).
  3745*        16  FILLER                         PIC X(452).
  3746
  3747
  3748****************************************************************
  3749*             MORTALITY MASTER RECORD                          *
  3750****************************************************************
  3751
  3752     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3753         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3754                                INDEXED BY CF-MORT-NDX.
  3755             20  CF-MORT-TABLE              PIC X(5).
  3756             20  CF-MORT-TABLE-TYPE         PIC X.
  3757                 88  CF-MORT-JOINT              VALUE 'J'.
  3758                 88  CF-MORT-SINGLE             VALUE 'S'.
  3759                 88  CF-MORT-COMBINED           VALUE 'C'.
  3760                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3761                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3762             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3763             20  CF-MORT-AGE-METHOD         PIC XX.
  3764                 88  CF-AGE-LAST                VALUE 'AL'.
  3765                 88  CF-AGE-NEAR                VALUE 'AN'.
  3766             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3767             20  CF-MORT-ADJUSTMENT-DIRECTION
  3768                                            PIC X.
  3769                 88  CF-MINUS                   VALUE '-'.
  3770                 88  CF-PLUS                    VALUE '+'.
  3771             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3772             20  CF-MORT-JOINT-CODE         PIC X.
  3773                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3774             20  CF-MORT-PC-Q               PIC X.
  3775                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3776             20  CF-MORT-TABLE-CODE         PIC X(4).
  3777             20  CF-MORT-COMMENTS           PIC X(15).
  3778             20  FILLER                     PIC X(14).
  3779
  3780         16  FILLER                         PIC X(251).
  3781
  3782
  3783****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* NSRASBL.cbl
  3784*             BUSSINESS TYPE MASTER RECORD                     *
  3785****************************************************************
  3786
  3787     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3788* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3789* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3790* AND RECORD 05 IS TYPES 81-99
  3791         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3792             20  CF-BUSINESS-TITLE          PIC  X(19).
  3793             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3794                                            PIC S9V9(4) COMP-3.
  3795             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3796             20  FILLER                     PIC  X.
  3797         16  FILLER                         PIC  X(248).
  3798
  3799
  3800****************************************************************
  3801*             TERMINAL MASTER RECORD                           *
  3802****************************************************************
  3803
  3804     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3805
  3806         16  CF-COMPANY-TERMINALS.
  3807             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3808                                  PIC X(4).
  3809         16  FILLER               PIC X(248).
  3810
  3811
  3812****************************************************************
  3813*             LIFE EDIT MASTER RECORD                          *
  3814****************************************************************
  3815
  3816     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3817         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3818             20  CF-LIFE-CODE-IN            PIC XX.
  3819             20  CF-LIFE-CODE-OUT           PIC XX.
  3820         16  FILLER                         PIC X(248).
  3821
  3822
  3823****************************************************************
  3824*             AH EDIT MASTER RECORD                            *
  3825****************************************************************
  3826
  3827     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3828         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3829             20  CF-AH-CODE-IN              PIC XXX.
  3830             20  CF-AH-CODE-OUT             PIC XX.
  3831         16  FILLER                         PIC X(248).
  3832
  3833
  3834****************************************************************
  3835*             CREDIBILITY TABLES                               *
  3836****************************************************************
  3837
  3838     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3839         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3840                             INDEXED BY CF-CRDB-NDX.
  3841             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* NSRASBL.cbl
  3842             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3843             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3844         16  FILLER                         PIC  X(332).
  3845
  3846
  3847****************************************************************
  3848*             REPORT CUSTOMIZATION RECORD                      *
  3849****************************************************************
  3850
  3851     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3852         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3853             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3854             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3855             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3856**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3857****       A T-TRANSFER.                                   ****
  3858             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3859
  3860         16  FILLER                         PIC XX.
  3861
  3862         16  CF-CARRIER-CNTL-OPT.
  3863             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3864                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3865                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3866             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3867                                            PIC X.
  3868         16  CF-GROUP-CNTL-OPT.
  3869             20  CF-GROUP-OPT-SEQ           PIC 9.
  3870                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3871                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3872             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3873                                            PIC X(6).
  3874         16  CF-STATE-CNTL-OPT.
  3875             20  CF-STATE-OPT-SEQ           PIC 9.
  3876                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3877                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3878             20  CF-STATE-SELECT OCCURS 3 TIMES
  3879                                            PIC XX.
  3880         16  CF-ACCOUNT-CNTL-OPT.
  3881             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3882                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3883                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3884             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3885                                            PIC X(10).
  3886         16  CF-BUS-TYP-CNTL-OPT.
  3887             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3888                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3889                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3890             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3891                                            PIC XX.
  3892         16  CF-LF-TYP-CNTL-OPT.
  3893             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3894                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3895                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3896             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3897                                            PIC XX.
  3898         16  CF-AH-TYP-CNTL-OPT.
  3899             20  CF-AH-TYP-OPT-SEQ          PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* NSRASBL.cbl
  3900                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3901                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3902             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3903                                            PIC XX.
  3904         16  CF-REPTCD1-CNTL-OPT.
  3905             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3906                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3907                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3908             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3909                                            PIC X(10).
  3910         16  CF-REPTCD2-CNTL-OPT.
  3911             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3912                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3913                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3914             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3915                                            PIC X(10).
  3916         16  CF-USER1-CNTL-OPT.
  3917             20  CF-USER1-OPT-SEQ           PIC 9.
  3918                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3919                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3920             20  CF-USER1-SELECT OCCURS 3 TIMES
  3921                                            PIC X(10).
  3922         16  CF-USER2-CNTL-OPT.
  3923             20  CF-USER2-OPT-SEQ           PIC 9.
  3924                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3925                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3926             20  CF-USER2-SELECT OCCURS 3 TIMES
  3927                                            PIC X(10).
  3928         16  CF-USER3-CNTL-OPT.
  3929             20  CF-USER3-OPT-SEQ           PIC 9.
  3930                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3931                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3932             20  CF-USER3-SELECT OCCURS 3 TIMES
  3933                                            PIC X(10).
  3934         16  CF-USER4-CNTL-OPT.
  3935             20  CF-USER4-OPT-SEQ           PIC 9.
  3936                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3937                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3938             20  CF-USER4-SELECT OCCURS 3 TIMES
  3939                                            PIC X(10).
  3940         16  CF-USER5-CNTL-OPT.
  3941             20  CF-USER5-OPT-SEQ           PIC 9.
  3942                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3943                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3944             20  CF-USER5-SELECT OCCURS 3 TIMES
  3945                                            PIC X(10).
  3946         16  CF-REINS-CNTL-OPT.
  3947             20  CF-REINS-OPT-SEQ           PIC 9.
  3948                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3949                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3950             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3951                 24  CF-REINS-PRIME         PIC XXX.
  3952                 24  CF-REINS-SUB           PIC XXX.
  3953
  3954         16  CF-AGENT-CNTL-OPT.
  3955             20  CF-AGENT-OPT-SEQ           PIC 9.
  3956                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3957                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* NSRASBL.cbl
  3958             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3959                                            PIC X(10).
  3960
  3961         16  FILLER                         PIC X(43).
  3962
  3963         16  CF-LOSS-RATIO-SELECT.
  3964             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3965             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3966         16  CF-ENTRY-DATE-SELECT.
  3967             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3968             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3969         16  CF-EFFECTIVE-DATE-SELECT.
  3970             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3971             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3972
  3973         16  CF-EXCEPTION-LIST-IND          PIC X.
  3974             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3975
  3976         16  FILLER                         PIC X(318).
  3977
  3978****************************************************************
  3979*                  EXCEPTION REPORTING RECORD                  *
  3980****************************************************************
  3981
  3982     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3983         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3984             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3985
  3986         16  CF-COMBINED-LIFE-AH-OPT.
  3987             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3988             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3989             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3990             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3991
  3992         16  CF-LIFE-OPT.
  3993             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3994             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3995             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3996             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3997             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3998             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3999             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4000             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4001             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4002             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4003
  4004         16  CF-AH-OPT.
  4005             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4006             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4007             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4008             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4009             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4010             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4011             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4012             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4013             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4014             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4015
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* NSRASBL.cbl
  4016         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4017             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4018             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4019             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4020
  4021         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4022
  4023         16  FILLER                         PIC X(673).
  4024
  4025
  4026****************************************************************
  4027*             MORTGAGE SYSTEM PLAN RECORD                      *
  4028****************************************************************
  4029
  4030     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4031         16  CF-PLAN-TYPE                   PIC X.
  4032             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4033             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4034             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4035         16  CF-PLAN-ABBREV                 PIC XXX.
  4036         16  CF-PLAN-DESCRIPT               PIC X(10).
  4037         16  CF-PLAN-NOTES                  PIC X(20).
  4038         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4039         16  CF-PLAN-UNDERWRITING.
  4040             20  CF-PLAN-TERM-DATA.
  4041                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4042                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4043             20  CF-PLAN-AGE-DATA.
  4044                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4045                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4046                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4047             20  CF-PLAN-BENEFIT-DATA.
  4048                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4049                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4050                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4051                                            PIC S9(7)V99  COMP-3.
  4052         16  CF-PLAN-POLICY-FORMS.
  4053             20  CF-POLICY-FORM             PIC X(12).
  4054             20  CF-MASTER-APPLICATION      PIC X(12).
  4055             20  CF-MASTER-POLICY           PIC X(12).
  4056         16  CF-PLAN-RATING.
  4057             20  CF-RATE-CODE               PIC X(5).
  4058             20  CF-SEX-RATING              PIC X.
  4059                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4060                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4061             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4062             20  CF-SUB-STD-TYPE            PIC X.
  4063                 88  CF-PCT-OF-PREM            VALUE '1'.
  4064                 88  CF-PCT-OF-BENE            VALUE '2'.
  4065         16  CF-PLAN-PREM-TOLERANCES.
  4066             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4067             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4068         16  CF-PLAN-PYMT-TOLERANCES.
  4069             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4070             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4071         16  CF-PLAN-MISC-DATA.
  4072             20  FILLER                     PIC X.
  4073             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* NSRASBL.cbl
  4074             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4075         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4076         16  CF-PLAN-IND-GRP                PIC X.
  4077             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4078                                                     '1'.
  4079             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4080                                                     '2'.
  4081         16  CF-MIB-SEARCH-SW               PIC X.
  4082             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4083             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4084             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4085             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4086         16  CF-ALPHA-SEARCH-SW             PIC X.
  4087             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4088             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4089             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4090             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4091             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4092             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4093             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4094             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4095             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4096             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4097                                                     'A' 'B' 'C'
  4098                                                     'X' 'Y' 'Z'.
  4099         16  CF-EFF-DT-RULE-SW              PIC X.
  4100             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4101             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4102             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4103             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4104             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4105         16  FILLER                         PIC X(4).
  4106         16  CF-HEALTH-QUESTIONS            PIC X.
  4107             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4108         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4109         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4110         16  CF-PLAN-SNGL-JNT               PIC X.
  4111             88  CF-COMBINED-PLAN              VALUE 'C'.
  4112             88  CF-JNT-PLAN                   VALUE 'J'.
  4113             88  CF-SNGL-PLAN                  VALUE 'S'.
  4114         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4115         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4116         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4117         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4118         16  CF-RERATE-CNTL                 PIC  X.
  4119             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4120             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4121             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4122             88  CF-AUTO-RECALC                 VALUE '4'.
  4123         16  CF-BENEFIT-TYPE                PIC  X.
  4124             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4125             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4126         16  CF-POLICY-FEE                  PIC S999V99
  4127                                                    COMP-3.
  4128         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4129         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4130         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4131         16  CF-4TH-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* NSRASBL.cbl
  4132         16  FILLER                         PIC  X(32).
  4133         16  CF-TERMINATION-FORM            PIC  X(04).
  4134         16  FILLER                         PIC  X(08).
  4135         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4136                                                       COMP-3.
  4137         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4138         16  CF-ISSUE-LETTER                PIC  X(4).
  4139         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4140         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4141             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4142             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4143         16  CF-MP-REFUND-CALC              PIC X.
  4144             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4145             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4146             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4147             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4148             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4149             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4150             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4151             88  CF-MP-REFD-MEAN                VALUE '8'.
  4152         16  CF-ALT-RATE-CODE               PIC  X(5).
  4153
  4154
  4155         16  FILLER                         PIC X(498).
  4156****************************************************************
  4157*             MORTGAGE COMPANY MASTER RECORD                   *
  4158****************************************************************
  4159
  4160     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4161         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4162         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4163             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4164             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4165             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4166             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4167             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4168
  4169         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4170         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4171         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4172         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4173         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4174
  4175         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4176             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4177         16  CF-MP-RECON-USE-IND            PIC X(1).
  4178             88  CF-MP-USE-RECON             VALUE 'Y'.
  4179         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4180             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4181         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4182             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4183             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4184         16  FILLER                         PIC X(1).
  4185         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4186             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4187         16  CF-MORTG-MIB-VERSION           PIC X.
  4188             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4189             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* NSRASBL.cbl
  4190             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4191         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4192             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4193                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4194             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4195                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4196             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4197                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4198             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4199                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4200             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4201                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4202             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4203                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4204         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4205         16  FILLER                         PIC X(7).
  4206         16  CF-MORTG-DESTINATION-SYMBOL.
  4207             20  CF-MORTG-MIB-COMM          PIC X(5).
  4208             20  CF-MORTG-MIB-TERM          PIC X(5).
  4209         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4210             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4211         16  FILLER                         PIC X(03).
  4212         16  CF-MP-CHECK-NO-CONTROL.
  4213             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4214                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4215                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4216                                                ' ' LOW-VALUES.
  4217                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4218                                               VALUE '3'.
  4219         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4220         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4221         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4222             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4223                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4224             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4225                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4226             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4227                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4228             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4229                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4230             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4231                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4232             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4233                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4234         16  CF-MORTG-BILLING-AREA.
  4235             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4236                                            PIC X.
  4237         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4238         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4239         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4240         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4241             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4242             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4243         16  FILLER                         PIC X.
  4244         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4245             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4246             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4247         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* NSRASBL.cbl
  4248         16  FILLER                         PIC X(8).
  4249         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4250         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4251         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4252         16  CF-ACH-COMPANY-ID.
  4253             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4254                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4255                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4256                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4257             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4258         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4259             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4260         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4261             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4262             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4263         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4264         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4265         16  FILLER                         PIC X(536).
  4266
  4267****************************************************************
  4268*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4269****************************************************************
  4270
  4271     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4272         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4273             20  CF-FEMALE-HEIGHT.
  4274                 24  CF-FEMALE-FT           PIC 99.
  4275                 24  CF-FEMALE-IN           PIC 99.
  4276             20  CF-FEMALE-MIN-WT           PIC 999.
  4277             20  CF-FEMALE-MAX-WT           PIC 999.
  4278         16  FILLER                         PIC X(428).
  4279
  4280     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4281         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4282             20  CF-MALE-HEIGHT.
  4283                 24  CF-MALE-FT             PIC 99.
  4284                 24  CF-MALE-IN             PIC 99.
  4285             20  CF-MALE-MIN-WT             PIC 999.
  4286             20  CF-MALE-MAX-WT             PIC 999.
  4287         16  FILLER                         PIC X(428).
  4288******************************************************************
  4289*             AUTOMATIC ACTIVITY RECORD                          *
  4290******************************************************************
  4291     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4292         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4293             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4294             20  CF-SYS-LETTER-ID           PIC X(04).
  4295             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4296             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4297             20  CF-SYS-RESET-SW            PIC X(01).
  4298             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4299             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4300
  4301         16  FILLER                         PIC X(50).
  4302
  4303         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4304             20  CF-USER-ACTIVE-SW          PIC X(01).
  4305             20  CF-USER-LETTER-ID          PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* NSRASBL.cbl
  4306             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4307             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4308             20  CF-USER-RESET-SW           PIC X(01).
  4309             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4310             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4311             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4312
  4313         16  FILLER                         PIC X(246).
  4314*                                COPY NSCASVARS.
  4315******************************************************************
  4316*                   C H A N G E   L O G
  4317*
  4318* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4319*-----------------------------------------------------------------
  4320*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4321* EFFECTIVE    NUMBER
  4322*-----------------------------------------------------------------
  4323* 101612  CR2011022800001  AJRA  REMOVE SIGN FROM CHG TOTALS
  4324******************************************************************
  4325 01 NAPER-OUTPUT-DATA.
  4326    05  F                       PIC X(07) VALUE "LETTER=".
  4327    05  OUT-LETTER              PIC X(06) VALUE SPACES.
  4328    05  F                       PIC X(08) VALUE "~PROCID=".
  4329    05  OUT-PROC-ID             PIC X(04) VALUE SPACES.
  4330    05  F                       PIC X(10) VALUE "~PROCNAME=".
  4331    05  OUT-PROC-NAME           PIC X(30) VALUE SPACES.
  4332    05  F                       PIC X(11) VALUE "~PROCTITLE=".
  4333    05  OUT-PROC-TITLE          PIC X(30) VALUE SPACES.
  4334    05  F                       PIC X(09) VALUE "~CSRNAME=".
  4335    05  OUT-CSR-NAME            PIC X(30) VALUE SPACES.
  4336    05  F                       PIC X(10) VALUE "~CSRTITLE=".
  4337    05  OUT-CSR-TITLE           PIC X(30) VALUE SPACES.
  4338    05  F                       PIC X(06) VALUE "~CARR=".
  4339    05  OUT-CARRIER             PIC X(01) VALUE SPACES.
  4340    05  F                       PIC X(10) VALUE "~GROUPING=".
  4341    05  OUT-GROUPING            PIC X(06) VALUE SPACES.
  4342    05  F                       PIC X(08) VALUE "~CERTST=".
  4343    05  OUT-STATE               PIC X(02) VALUE SPACES.
  4344    05  F                       PIC X(09) VALUE "~ACCOUNT=".
  4345    05  OUT-ACCOUNT             PIC X(10) VALUE SPACES.
  4346    05  F                       PIC X(11) VALUE "~CERTEFFDT=".
  4347    05  OUT-CERT-EFF-DT         PIC X(21) VALUE SPACES.
  4348    05  F                       PIC X(07) VALUE "~CRTNO=".
  4349    05  OUT-CERT-NO             PIC X(11) VALUE SPACES.
  4350    05  F                       PIC X(08) VALUE "~CRTSUF=".
  4351    05  OUT-CERT-SFX            PIC X(01) VALUE SPACES.
  4352    05  F                       PIC X(08) VALUE "~ILNAME=".
  4353    05  OUT-ILNAME              PIC X(15) VALUE SPACES.
  4354    05  F                       PIC X(08) VALUE "~IFNAME=".
  4355    05  OUT-IFNAME              PIC X(10) VALUE SPACES.
  4356    05  F                       PIC X(08) VALUE "~IFINIT=".
  4357    05  OUT-IFINIT              PIC X(01) VALUE SPACES.
  4358    05  F                       PIC X(08) VALUE "~IMINIT=".
  4359    05  OUT-IMINIT              PIC X(01) VALUE SPACES.
  4360    05  F                       PIC X(09) VALUE "~IISSAGE=".
  4361    05  OUT-IAGE                PIC 99    BLANK WHEN ZERO.
  4362    05  F                       PIC X(06) VALUE "~ISEX=".
  4363    05  OUT-ISEX                PIC X(01) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* NSRASBL.cbl
  4364    05  F                       PIC X(10) VALUE "~INSADDR1=".
  4365    05  OUT-INS-ADDR1           PIC X(30) VALUE SPACES.
  4366    05  F                       PIC X(10) VALUE "~INSADDR2=".
  4367    05  OUT-INS-ADDR2           PIC X(30) VALUE SPACES.
  4368    05  F                       PIC X(09) VALUE "~INSCITY=".
  4369    05  OUT-INS-CITY            PIC X(30) VALUE SPACES.
  4370    05  F                       PIC X(10) VALUE "~INSSTATE=".
  4371    05  OUT-INS-STATE           PIC X(02) VALUE SPACES.
  4372    05  F                       PIC X(08) VALUE "~INSZIP=".
  4373    05  OUT-INS-ZIP             PIC X(09) VALUE SPACES.
  4374    05  F                       PIC X(05) VALUE "~SSN=".
  4375    05  OUT-SOC-SEC-NO          PIC X(11) VALUE SPACES.
  4376    05  F                       PIC X(07) VALUE "~MEMNO=".
  4377    05  OUT-MEMBER-NO           PIC X(12) VALUE SPACES.
  4378    05  F                       PIC X(08) VALUE "~JLNAME=".
  4379    05  OUT-JLNAME              PIC X(15) VALUE SPACES.
  4380    05  F                       PIC X(08) VALUE "~JFNAME=".
  4381    05  OUT-JFNAME              PIC X(10) VALUE SPACES.
  4382    05  F                       PIC X(08) VALUE "~JMINIT=".
  4383    05  OUT-JMINIT              PIC X(01) VALUE SPACES.
  4384    05  F                       PIC X(08) VALUE "~JNTAGE=".
  4385    05  OUT-JAGE                PIC 99    BLANK WHEN ZERO.
  4386    05  F                       PIC X(10) VALUE "~ACCTNAME=".
  4387    05  OUT-ACCT-NAME           PIC X(30) VALUE SPACES.
  4388    05  F                       PIC X(11) VALUE "~ACCTADDR1=".
  4389    05  OUT-ACCT-ADDR1          PIC X(30) VALUE SPACES.
  4390    05  F                       PIC X(11) VALUE "~ACCTADDR2=".
  4391    05  OUT-ACCT-ADDR2          PIC X(30) VALUE SPACES.
  4392    05  F                       PIC X(10) VALUE "~ACCTCITY=".
  4393    05  OUT-ACCT-CITY           PIC X(30) VALUE SPACES.
  4394    05  F                       PIC X(11) VALUE "~ACCTSTATE=".
  4395    05  OUT-ACCT-STATE          PIC X(02) VALUE SPACES.
  4396    05  F                       PIC X(09) VALUE "~ACCTZIP=".
  4397    05  OUT-ACCT-ZIP            PIC X(10) VALUE SPACES.
  4398    05  F                       PIC X(11) VALUE "~ACCTPHONE=".
  4399    05  OUT-ACCT-PHONE          PIC X(10) VALUE SPACES.
  4400    05  F                       PIC X(11) VALUE "~ACCTCNTRL=".
  4401    05  OUT-ACCT-CNTRL-NAME     PIC X(30) VALUE SPACES.
  4402    05  F                       PIC X(09) VALUE "~BUSTYPE=".
  4403    05  OUT-ACCT-BUS-TYPE       PIC X(02) VALUE SPACES.
  4404    05  F                       PIC X(10) VALUE "~BENENAME=".
  4405    05  OUT-BENE-NAME           PIC X(30) VALUE SPACES.
  4406    05  F                       PIC X(11) VALUE "~BENEADDR1=".
  4407    05  OUT-BENE-ADDR1          PIC X(30) VALUE SPACES.
  4408    05  F                       PIC X(11) VALUE "~BENEADDR2=".
  4409    05  OUT-BENE-ADDR2          PIC X(30) VALUE SPACES.
  4410    05  F                       PIC X(10) VALUE "~BENECITY=".
  4411    05  OUT-BENE-CITY           PIC X(30) VALUE SPACES.
  4412    05  F                       PIC X(11) VALUE "~BENESTATE=".
  4413    05  OUT-BENE-STATE          PIC X(02) VALUE SPACES.
  4414    05  F                       PIC X(09) VALUE "~BENEZIP=".
  4415    05  OUT-BENE-ZIP            PIC X(09) VALUE SPACES.
  4416    05  F                       PIC X(10) VALUE "~CARRNAME=".
  4417    05  OUT-CARR-NAME           PIC X(30) VALUE SPACES.
  4418    05  F                       PIC X(08) VALUE "~RESPNO=".
  4419    05  OUT-RESP-NO             PIC X(10) VALUE SPACES.
  4420    05  F                       PIC X(12) VALUE "~COACCTNAME=".
  4421    05  OUT-COMP-NAME           PIC X(30) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* NSRASBL.cbl
  4422    05  F                       PIC X(12) VALUE "~COMAILNAME=".
  4423    05  OUT-COMP-MAIL-TO        PIC X(30) VALUE SPACES.
  4424    05  F                       PIC X(11) VALUE "~COMPADDR1=".
  4425    05  OUT-COMP-ADDR1          PIC X(30) VALUE SPACES.
  4426    05  F                       PIC X(11) VALUE "~COMPADDR2=".
  4427    05  OUT-COMP-ADDR2          PIC X(30) VALUE SPACES.
  4428    05  F                       PIC X(10) VALUE "~COMPCITY=".
  4429    05  OUT-COMP-CITY           PIC X(30) VALUE SPACES.
  4430    05  F                       PIC X(11) VALUE "~COMPSTATE=".
  4431    05  OUT-COMP-STATE          PIC X(02) VALUE SPACES.
  4432    05  F                       PIC X(09) VALUE "~COMPZIP=".
  4433    05  OUT-COMP-ZIP            PIC X(09) VALUE SPACES.
  4434    05  F                       PIC X(11) VALUE "~COMPPHONE=".
  4435    05  OUT-COMP-PHONE          PIC X(10) VALUE SPACES.
  4436    05  F                       PIC X(09) VALUE "~COMPFAX=".
  4437    05  OUT-COMP-FAX            PIC X(10) VALUE SPACES.
  4438    05  F                       PIC X(12) VALUE "~COMPSTATUS=".
  4439    05  OUT-COMP-STATUS         PIC X(01) VALUE SPACES.
  4440    05  F                       PIC X(12) VALUE "~COMPBILLSW=".
  4441    05  OUT-BILL-SW             PIC X(01) VALUE SPACES.
  4442    05  F                       PIC X(08) VALUE "~RPTCD1=".
  4443    05  OUT-RPT-CD1             PIC X(10) VALUE SPACES.
  4444    05  F                       PIC X(08) VALUE "~RPTCD2=".
  4445    05  OUT-RPT-CD2             PIC X(10) VALUE SPACES.
  4446    05  F                       PIC X(09) VALUE "~ENTRYDT=".
  4447    05  OUT-ENTRY-DT            PIC X(21) VALUE SPACES.
  4448    05  F                       PIC X(07) VALUE "~BATCH=".
  4449    05  OUT-ENTRY-BATCH         PIC X(06) VALUE SPACES.
  4450    05  F                       PIC X(11) VALUE "~ENTSTATUS=".
  4451    05  OUT-ENTRY-STATUS        PIC X(01) VALUE SPACES.
  4452    05  F                       PIC X(10) VALUE "~1STPMTDT=".
  4453    05  OUT-1ST-PMT-DT          PIC X(21) VALUE SPACES.
  4454    05  F                       PIC X(05) VALUE "~APR=".
  4455    05  OUT-LOAN-APR            PIC 999.9(4)  BLANK WHEN ZERO.
  4456    05  F                       PIC X(08) VALUE "~LNTERM=".
  4457    05  OUT-LOAN-TERM           PIC 999   BLANK WHEN ZERO.
  4458    05  F                       PIC X(11) VALUE "~RATECLASS=".
  4459    05  OUT-RATE-CLASS          PIC X(02) VALUE SPACES.
  4460    05  F                       PIC X(09) VALUE "~EXTDAYS=".
  4461    05  OUT-EXT-DAYS            PIC 999   BLANK WHEN ZERO.
  4462    05  F                       PIC X(09) VALUE "~CSRCODE=".
  4463    05  OUT-CSR-CODE            PIC X(04) VALUE SPACES.
  4464    05  F                       PIC X(07) VALUE "~UCODE=".
  4465    05  OUT-UCODE               PIC X(01) VALUE SPACES.
  4466    05  F                       PIC X(10) VALUE "~PREMTYPE=".
  4467    05  OUT-PREM-TYPE           PIC X(01) VALUE SPACES.
  4468    05  F                       PIC X(12) VALUE "~INDGRPTYPE=".
  4469    05  OUT-IND-GRP             PIC X(01) VALUE SPACES.
  4470    05  F                       PIC X(06) VALUE "~SKIP=".
  4471    05  OUT-SKIP-CD             PIC X(01) VALUE SPACES.
  4472    05  F                       PIC X(06) VALUE "~MODE=".
  4473    05  OUT-PMT-MODE            PIC X(01) VALUE SPACES.
  4474    05  F                       PIC X(09) VALUE "~LOANOFF=".
  4475    05  OUT-LOAN-OFF            PIC X(05) VALUE SPACES.
  4476    05  F                       PIC X(06) VALUE "~RTBL=".
  4477    05  OUT-REIN-TABLE          PIC X(03) VALUE SPACES.
  4478    05  F                       PIC X(10) VALUE "~SPECREIN=".
  4479    05  OUT-SPEC-REIN           PIC X(01) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* NSRASBL.cbl
  4480    05  F                       PIC X(09) VALUE "~LFBENCD=".
  4481    05  OUT-LF-BENCD            PIC X(02) VALUE SPACES.
  4482    05  F                       PIC X(08) VALUE "~LFTERM=".
  4483    05  OUT-LF-TERM             PIC 999   BLANK WHEN ZERO.
  4484    05  F                       PIC X(07) VALUE "~LFDEV=".
  4485    05  OUT-LF-DEV-CD           PIC X(03) VALUE SPACES.
  4486    05  F                       PIC X(10) VALUE "~LFDEVPCT=".
  4487    05  OUT-LF-DEV-PCT          PIC 9.9(6)  BLANK WHEN ZERO.
  4488    05  F                       PIC X(07) VALUE "~LFBEN=".
  4489    05  OUT-LF-BEN              PIC 9(9).99 BLANK WHEN ZERO.
  4490    05  F                       PIC X(08) VALUE "~LFPREM=".
  4491    05  OUT-LF-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4492    05  F                       PIC X(08) VALUE "~LFABEN=".
  4493    05  OUT-LF-ALT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4494    05  F                       PIC X(09) VALUE "~LFAPREM=".
  4495    05  OUT-LF-ALT-PRM          PIC 9(7).99 BLANK WHEN ZERO.
  4496    05  F                       PIC X(07) VALUE "~LFNSP=".
  4497    05  OUT-LF-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4498    05  F                       PIC X(08) VALUE "~LFRBEN=".
  4499    05  OUT-LF-REM-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4500    05  F                       PIC X(07) VALUE "~LFCAN=".
  4501    05  OUT-LF-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4502    05  F                       PIC X(07) VALUE "~LFDTH=".
  4503    05  OUT-LF-DTH              PIC 9(9).99 BLANK WHEN ZERO.
  4504    05  F                       PIC X(08) VALUE "~LFRATE=".
  4505    05  OUT-LF-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4506    05  F                       PIC X(09) VALUE "~LFARATE=".
  4507    05  OUT-LF-ALT-RATE         PIC 99.9(5) BLANK WHEN ZERO.
  4508    05  F                       PIC X(09) VALUE "~LFEXPDT=".
  4509    05  OUT-LF-EXP-DT           PIC X(21) VALUE SPACES.
  4510    05  F                       PIC X(08) VALUE "~LFSTAT=".
  4511    05  OUT-LF-CUR-STATUS       PIC X(01) VALUE SPACES.
  4512    05  F                       PIC X(09) VALUE "~LFCANDT=".
  4513    05  OUT-LF-CAN-DT           PIC X(21) VALUE SPACES.
  4514    05  F                       PIC X(12) VALUE "~LFCANEXTDT=".
  4515    05  OUT-LF-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4516    05  F                       PIC X(07) VALUE "~DTHDT=".
  4517    05  OUT-LF-DTH-DT           PIC X(21) VALUE SPACES.
  4518    05  F                       PIC X(10) VALUE "~DTHEXTDT=".
  4519    05  OUT-LF-DTH-EXIT-DT      PIC X(21) VALUE SPACES.
  4520    05  F                       PIC X(12) VALUE "~LFEXTBATCH=".
  4521    05  OUT-LF-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4522    05  F                       PIC X(08) VALUE "~LFCOMM=".
  4523    05  OUT-LF-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4524    05  F                       PIC X(11) VALUE "~LFBENDESC=".
  4525    05  OUT-LF-DESC             PIC X(02) VALUE SPACES.
  4526    05  F                       PIC X(11) VALUE "~LFBENABRV=".
  4527    05  OUT-LF-ABBRV            PIC X(03) VALUE SPACES.
  4528    05  F                       PIC X(09) VALUE "~AHBENCD=".
  4529    05  OUT-AH-BENCD            PIC X(02) VALUE SPACES.
  4530    05  F                       PIC X(08) VALUE "~AHTERM=".
  4531    05  OUT-AH-TERM             PIC 999   BLANK WHEN ZERO.
  4532    05  F                       PIC X(11) VALUE "~AHCRITPER=".
  4533    05  OUT-CRIT-PER            PIC 99    BLANK WHEN ZERO.
  4534    05  F                       PIC X(09) VALUE "~AHDEVCD=".
  4535    05  OUT-AH-DEV-CD           PIC X(03) VALUE SPACES.
  4536    05  F                       PIC X(10) VALUE "~AHDEVPCT=".
  4537    05  OUT-AH-DEV-PCT          PIC 9.9(6) BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* NSRASBL.cbl
  4538    05  F                       PIC X(07) VALUE "~AHBEN=".
  4539    05  OUT-AH-BEN              PIC 9(7).99 BLANK WHEN ZERO.
  4540    05  F                       PIC X(08) VALUE "~AHPREM=".
  4541    05  OUT-AH-PRM              PIC 9(7).99 BLANK WHEN ZERO.
  4542    05  F                       PIC X(07) VALUE "~AHNSP=".
  4543    05  OUT-AH-NSP              PIC 9(7).99 BLANK WHEN ZERO.
  4544    05  F                       PIC X(07) VALUE "~AHCAN=".
  4545    05  OUT-AH-REF              PIC 9(7).99 BLANK WHEN ZERO.
  4546    05  F                       PIC X(10) VALUE "~AHITDPMT=".
  4547    05  OUT-AH-CLM              PIC 9(7).99 BLANK WHEN ZERO.
  4548    05  F                       PIC X(10) VALUE "~AHTOTBEN=".
  4549    05  OUT-AH-TOT-BEN          PIC 9(9).99 BLANK WHEN ZERO.
  4550    05  F                       PIC X(12) VALUE "~AHPDTHRUDT=".
  4551    05  OUT-AH-PDTHRU-DT        PIC X(21) VALUE SPACES.
  4552    05  F                       PIC X(08) VALUE "~AHRATE=".
  4553    05  OUT-AH-RATE             PIC 99.9(5) BLANK WHEN ZERO.
  4554    05  F                       PIC X(09) VALUE "~AHEXPDT=".
  4555    05  OUT-AH-EXP-DT           PIC X(21) VALUE SPACES.
  4556    05  F                       PIC X(08) VALUE "~AHSTAT=".
  4557    05  OUT-AH-CUR-STATUS       PIC X(01) VALUE SPACES.
  4558    05  F                       PIC X(09) VALUE "~AHCANDT=".
  4559    05  OUT-AH-CAN-DT           PIC X(21) VALUE SPACES.
  4560    05  F                       PIC X(12) VALUE "~AHCANEXTDT=".
  4561    05  OUT-AH-CAN-EXIT-DT      PIC X(21) VALUE SPACES.
  4562    05  F                       PIC X(12) VALUE "~AHEXTBATCH=".
  4563    05  OUT-AH-EXIT-BATCH       PIC X(06) VALUE SPACES.
  4564    05  F                       PIC X(08) VALUE "~AHCOMM=".
  4565    05  OUT-AH-COMM-PCT         PIC .9(5) BLANK WHEN ZERO.
  4566    05  F                       PIC X(11) VALUE "~AHBENDESC=".
  4567    05  OUT-AH-DESC             PIC X(35) VALUE SPACES.
  4568    05  F                       PIC X(14) VALUE "~AHBENRETELIM=".
  4569    05  OUT-RET-ELIM            PIC X(01) VALUE SPACES.
  4570    05  F                       PIC X(11) VALUE "~AHBENDAYS=".
  4571    05  OUT-BEN-DAYS            PIC X(02) VALUE SPACES.
  4572    05  F                       PIC X(08) VALUE "~AHWAIT=".
  4573    05  OUT-WAIT-PER            PIC X(03) VALUE SPACES.
  4574    05  F                       PIC X(11) VALUE "~AHMAXPMTS=".
  4575    05  OUT-MAX-PMTS            PIC 99    VALUE ZEROS.
  4576    05  OUT-MAX-PMTS-A REDEFINES OUT-MAX-PMTS
  4577                                PIC X(2).
  4578    05  F                       PIC X(09) VALUE "~TOTPREM=".
  4579    05  OUT-TOT-PRM             PIC 9(7).99 BLANK WHEN ZERO.
  4580    05  F                       PIC X(08) VALUE "~TOTREF=".
  4581    05  OUT-TOT-REF             PIC 9(7).99 BLANK WHEN ZERO.
  4582    05  F                       PIC X(08) VALUE "~SEXPDT=".
  4583    05  OUT-SCHED-EXP-DT        PIC X(21) VALUE SPACES.
  4584    05  F                       PIC X(07) VALUE "~STERM=".
  4585    05  OUT-SCHED-TERM          PIC 999   BLANK WHEN ZERO.
  4586    05  F                       PIC X(12) VALUE "~IORIGLNAME=".
  4587    05  OUT-ORIG-ILNAME         PIC X(15) VALUE SPACES.
  4588    05  F                       PIC X(12) VALUE "~IORIGFNAME=".
  4589    05  OUT-ORIG-IFNAME         PIC X(10) VALUE SPACES.
  4590    05  F                       PIC X(11) VALUE "~IORIGINIT=".
  4591    05  OUT-ORIG-MINIT          PIC X(01) VALUE SPACES.
  4592    05  F                       PIC X(10) VALUE "~IORIGAGE=".
  4593    05  OUT-ORIG-IAGE           PIC 99    BLANK WHEN ZERO.
  4594    05  F                       PIC X(12) VALUE "~JORIGLNAME=".
  4595    05  OUT-ORIG-JLNAME         PIC X(15) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* NSRASBL.cbl
  4596    05  F                       PIC X(12) VALUE "~JORIGFNAME=".
  4597    05  OUT-ORIG-JFNAME         PIC X(10) VALUE SPACES.
  4598    05  F                       PIC X(11) VALUE "~JORIGINIT=".
  4599    05  OUT-ORIG-JMINIT         PIC X(01) VALUE SPACES.
  4600    05  F                       PIC X(10) VALUE "~JORIGAGE=".
  4601    05  OUT-ORIG-JAGE           PIC 99    BLANK WHEN ZERO.
  4602    05  F                       PIC X(13) VALUE "~LFORIGBENCD=".
  4603    05  OUT-ORIG-LF-BENCD       PIC X(02) VALUE SPACES.
  4604    05  F                       PIC X(12) VALUE "~LFORIGTERM=".
  4605    05  OUT-ORIG-LF-TERM        PIC 999   BLANK WHEN ZERO.
  4606    05  F                       PIC X(14) VALUE "~LFORIGBENAMT=".
  4607    05  OUT-ORIG-LF-BEN         PIC 9(9).99 VALUE ZEROS.
  4608    05  OUT-ORIG-LF-BEN-A REDEFINES OUT-ORIG-LF-BEN
  4609                                PIC X(12).
  4610    05  F                       PIC X(14) VALUE "~LFORIGPRMAMT=".
  4611    05  OUT-ORIG-LF-PRM         PIC 9(9).99 VALUE ZEROS.
  4612    05  OUT-ORIG-LF-PRM-A REDEFINES OUT-ORIG-LF-PRM
  4613                                PIC X(12).
  4614    05  F                       PIC X(14) VALUE "~LFCALCPRMAMT=".
  4615    05  OUT-LF-CALC-PRM         PIC 9(9).99 VALUE ZEROS.
  4616    05  F                       PIC X(14) VALUE "~LFORIGREFAMT=".
  4617    05  OUT-ORIG-LF-REF         PIC 9(7).99 VALUE ZEROS.
  4618    05  F                       PIC X(14) VALUE "~LFCALCREFAMT=".
  4619    05  OUT-LF-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4620    05  F                       PIC X(14) VALUE "~LFORIGALTBEN=".
  4621    05  OUT-ORIG-LF-ALT-BEN     PIC 9(9).99 VALUE ZEROS.
  4622    05  OUT-ORIG-LF-ALT-BEN-A REDEFINES OUT-ORIG-LF-ALT-BEN
  4623                                PIC X(12).
  4624    05  F                       PIC X(14) VALUE "~LFORIGALTPRM=".
  4625    05  OUT-ORIG-LF-ALT-PRM     PIC 9(7).99 VALUE ZEROS.
  4626    05  OUT-ORIG-LF-ALT-PRM-A REDEFINES OUT-ORIG-LF-ALT-PRM
  4627                                PIC X(10).
  4628    05  F                       PIC X(13) VALUE "~LFORIGEXPDT=".
  4629    05  OUT-ORIG-LF-EXP-DT      PIC X(21) VALUE SPACES.
  4630    05  F                       PIC X(12) VALUE "~LFORIGDESC=".
  4631    05  OUT-ORIG-LF-DESC        PIC X(02) VALUE SPACES.
  4632    05  F                       PIC X(13) VALUE "~AHORIGBENCD=".
  4633    05  OUT-ORIG-AH-BENCD       PIC X(02) VALUE SPACES.
  4634    05  F                       PIC X(12) VALUE "~AHORIGTERM=".
  4635    05  OUT-ORIG-AH-TERM        PIC 999   BLANK WHEN ZERO.
  4636    05  F                       PIC X(13) VALUE "~AHORIGCRITP=".
  4637    05  OUT-ORIG-CRIT-PER       PIC 99    BLANK WHEN ZERO.
  4638    05  F                       PIC X(14) VALUE "~AHORIGBENAMT=".
  4639    05  OUT-ORIG-AH-BEN         PIC 9(7).99 VALUE ZEROS.
  4640    05  OUT-ORIG-AH-BEN-A REDEFINES OUT-ORIG-AH-BEN
  4641                                PIC X(10).
  4642    05  F                       PIC X(14) VALUE "~AHORIGPRMAMT=".
  4643    05  OUT-ORIG-AH-PRM         PIC 9(7).99 VALUE ZEROS.
  4644    05  OUT-ORIG-AH-PRM-A REDEFINES OUT-ORIG-AH-PRM
  4645                                PIC X(10).
  4646    05  F                       PIC X(14) VALUE "~AHCALCPRMAMT=".
  4647    05  OUT-AH-CALC-PRM         PIC 9(7).99 VALUE ZEROS.
  4648    05  F                       PIC X(14) VALUE "~AHORIGREFAMT=".
  4649    05  OUT-ORIG-AH-REF         PIC 9(7).99 VALUE ZEROS.
  4650    05  F                       PIC X(14) VALUE "~AHCALCREFAMT=".
  4651    05  OUT-AH-CALC-REF         PIC 9(7).99 VALUE ZEROS.
  4652    05  F                       PIC X(13) VALUE "~AHORIGEXPDT=".
  4653    05  OUT-ORIG-AH-EXP-DT      PIC X(21) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* NSRASBL.cbl
  4654    05  F                       PIC X(12) VALUE "~AHORIGDESC=".
  4655    05  OUT-ORIG-AH-DESC        PIC X(35) VALUE SPACES.
  4656    05  F                       PIC X(13) VALUE "~AHORIGRELIM=".
  4657    05  OUT-ORIG-RET-ELIM       PIC X(01) VALUE SPACES.
  4658    05  F                       PIC X(13) VALUE "~ORIGBENDAYS=".
  4659    05  OUT-ORIG-BEN-DAYS       PIC X(02) VALUE ZEROS.
  4660    05  F                       PIC X(10) VALUE "~ORIGWAIT=".
  4661    05  OUT-ORIG-WAIT-PER       PIC X(03) VALUE SPACES.
  4662    05  F                       PIC X(13) VALUE "~ORIGMAXPMTS=".
  4663    05  OUT-ORIG-MAX-PMTS       PIC 99    VALUE ZEROS.
  4664    05  OUT-ORIG-MAX-PMTS-A REDEFINES OUT-ORIG-MAX-PMTS
  4665                                PIC X(2).
  4666    05  F                       PIC X(09) VALUE "~OSEXPDT=".
  4667    05  OUT-ORIG-SCHED-EXP-DT   PIC X(21) VALUE SPACES.
  4668    05  F                       PIC X(08) VALUE "~OSTERM=".
  4669    05  OUT-ORIG-SCHED-TERM     PIC 9(09) BLANK WHEN ZERO.
  4670    05  F                       PIC X(11) VALUE "~INEWLNAME=".
  4671    05  OUT-NEW-ILNAME          PIC X(15) VALUE SPACES.
  4672    05  F                       PIC X(11) VALUE "~INEWFNAME=".
  4673    05  OUT-NEW-IFNAME          PIC X(10) VALUE SPACES.
  4674    05  F                       PIC X(10) VALUE "~INEWINIT=".
  4675    05  OUT-NEW-IMINIT          PIC X(01) VALUE SPACES.
  4676    05  F                       PIC X(09) VALUE "~INEWAGE=".
  4677    05  OUT-NEW-IAGE            PIC 9(09) BLANK WHEN ZERO.
  4678    05  OUT-NEW-IAGE-A REDEFINES OUT-NEW-IAGE
  4679                                PIC X(09).
  4680    05  F                       PIC X(11) VALUE "~JNEWLNAME=".
  4681    05  OUT-NEW-JLNAME          PIC X(15) VALUE SPACES.
  4682    05  F                       PIC X(11) VALUE "~JNEWFNAME=".
  4683    05  OUT-NEW-JFNAME          PIC X(10) VALUE SPACES.
  4684    05  F                       PIC X(10) VALUE "~JNEWINIT=".
  4685    05  OUT-NEW-JMINIT          PIC X(01) VALUE SPACES.
  4686    05  F                       PIC X(09) VALUE "~JNEWAGE=".
  4687    05  OUT-NEW-JAGE            PIC 9(09) BLANK WHEN ZERO.
  4688    05  OUT-NEW-JAGE-A REDEFINES OUT-NEW-JAGE
  4689                                PIC X(09).
  4690    05  F                       PIC X(12) VALUE "~LFNEWBENCD=".
  4691    05  OUT-NEW-LF-BENCD        PIC X(09) VALUE SPACES.
  4692    05  F                       PIC X(11) VALUE "~LFNEWTERM=".
  4693    05  OUT-NEW-LF-TERM         PIC 9(09) BLANK WHEN ZERO.
  4694    05  OUT-NEW-LF-TERM-A REDEFINES OUT-NEW-LF-TERM
  4695                                PIC X(09).
  4696    05  F                       PIC X(13) VALUE "~LFNEWBENAMT=".
  4697    05  OUT-NEW-LF-BEN          PIC 9(9).99 VALUE ZEROS.
  4698    05  OUT-NEW-LF-BEN-A REDEFINES OUT-NEW-LF-BEN
  4699                                PIC X(12).
  4700    05  F                       PIC X(13) VALUE "~LFNEWPRMAMT=".
  4701    05  OUT-NEW-LF-PRM          PIC 9(7).99 VALUE ZEROS.
  4702    05  OUT-NEW-LF-PRM-A REDEFINES OUT-NEW-LF-PRM
  4703                                PIC X(10).
  4704    05  F                       PIC X(13) VALUE "~LFNEWREFAMT=".
  4705    05  OUT-NEW-LF-REF          PIC 9(7).99 VALUE ZEROS.
  4706    05  F                       PIC X(13) VALUE "~LFNEWALTBEN=".
  4707    05  OUT-NEW-LF-ALT-BEN      PIC 9(9).99 VALUE ZEROS.
  4708    05  OUT-NEW-LF-ALT-BEN-A REDEFINES OUT-NEW-LF-ALT-BEN
  4709                                PIC X(12).
  4710    05  F                       PIC X(13) VALUE "~LFNEWALTPRM=".
  4711    05  OUT-NEW-LF-ALT-PRM      PIC 9(7).99 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* NSRASBL.cbl
  4712    05  OUT-NEW-LF-ALT-PRM-A REDEFINES OUT-NEW-LF-ALT-PRM
  4713                                PIC X(10).
  4714    05  F                       PIC X(12) VALUE "~LFNEWEXPDT=".
  4715    05  OUT-NEW-LF-EXP-DT       PIC X(21) VALUE SPACES.
  4716    05  F                       PIC X(11) VALUE "~LFNEWDESC=".
  4717    05  OUT-NEW-LF-DESC         PIC X(10) VALUE SPACES.
  4718    05  F                       PIC X(12) VALUE "~AHNEWBENCD=".
  4719    05  OUT-NEW-AH-BENCD        PIC X(02) VALUE SPACES.
  4720    05  F                       PIC X(11) VALUE "~AHNEWTERM=".
  4721    05  OUT-NEW-AH-TERM         PIC 9(09) BLANK WHEN ZERO.
  4722    05  OUT-NEW-AH-TERM-A REDEFINES OUT-NEW-AH-TERM
  4723                                PIC X(09).
  4724    05  F                       PIC X(12) VALUE "~AHNEWCRITP=".
  4725    05  OUT-NEW-CRIT-PER        PIC 9(09) BLANK WHEN ZERO.
  4726    05  OUT-NEW-CRIT-PER-A REDEFINES OUT-NEW-CRIT-PER
  4727                                PIC X(09).
  4728    05  F                       PIC X(13) VALUE "~AHNEWBENAMT=".
  4729    05  OUT-NEW-AH-BEN          PIC 9(7).99 VALUE ZEROS.
  4730    05  OUT-NEW-AH-BEN-A REDEFINES OUT-NEW-AH-BEN
  4731                                PIC X(10).
  4732    05  F                       PIC X(13) VALUE "~AHNEWPRMAMT=".
  4733    05  OUT-NEW-AH-PRM          PIC 9(7).99 VALUE ZEROS.
  4734    05  OUT-NEW-AH-PRM-A REDEFINES OUT-NEW-AH-PRM
  4735                                PIC X(10).
  4736    05  F                       PIC X(13) VALUE "~AHNEWREFAMT=".
  4737    05  OUT-NEW-AH-REF          PIC 9(7).99 VALUE ZEROS.
  4738    05  F                       PIC X(12) VALUE "~AHNEWEXPDT=".
  4739    05  OUT-NEW-AH-EXP-DT       PIC X(21) VALUE SPACES.
  4740    05  F                       PIC X(11) VALUE "~AHNEWDESC=".
  4741    05  OUT-NEW-AH-DESC         PIC X(35) VALUE SPACES.
  4742    05  F                       PIC X(12) VALUE "~AHNEWRELIM=".
  4743    05  OUT-NEW-RET-ELIM        PIC X(01) VALUE SPACES.
  4744    05  F                       PIC X(12) VALUE "~NEWBENDAYS=".
  4745    05  OUT-NEW-BEN-DAYS        PIC X(09) VALUE ZEROS.
  4746    05  F                       PIC X(09) VALUE "~NEWWAIT=".
  4747    05  OUT-NEW-WAIT-PER        PIC X(09) VALUE SPACES.
  4748    05  F                       PIC X(12) VALUE "~NEWMAXPMTS=".
  4749    05  OUT-NEW-MAX-PMTS        PIC 9(09) VALUE ZEROS.
  4750    05  OUT-NEW-MAX-PMTS-A REDEFINES OUT-NEW-MAX-PMTS
  4751                                PIC X(09).
  4752    05  F                       PIC X(09) VALUE "~NSEXPDT=".
  4753    05  OUT-NEW-SCHED-EXP-DT    PIC X(21) VALUE SPACES.
  4754    05  F                       PIC X(08) VALUE "~NSTERM=".
  4755    05  OUT-NEW-SCHED-TERM      PIC 9(09) BLANK WHEN ZERO.
  4756    05  OUT-NEW-SCHED-TERM-A REDEFINES OUT-NEW-SCHED-TERM
  4757                                PIC X(09).
  4758    05  F                       PIC X(12) VALUE "~TOTPREMCHG=".
  4759    05  OUT-TOT-PRM-CHG         PIC 9(7).99 VALUE ZEROS.
  4760    05  F                       PIC X(11) VALUE "~TOTREFCHG=".
  4761    05  OUT-TOT-REF-CHG         PIC 9(7).99 VALUE ZEROS.
  4762    05  F                       PIC X(11) VALUE "~PAYABLETO=".
  4763    05  OUT-PAYEE               PIC X(30) VALUE SPACES.
  4764    05  F                       PIC X(11) VALUE "~SIGNEEDED=".
  4765    05  OUT-SIG-SW              PIC X(01) VALUE SPACES.
  4766    05  F                       PIC X(09) VALUE "~BALLOON=".
  4767    05  OUT-BALLOON-IND         PIC X(01) VALUE SPACES.
  4768    05  F                       PIC X(10) VALUE "~LEASEIND=".
  4769    05  OUT-LEASE-IND           PIC X(01) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* NSRASBL.cbl
  4770    05  F                       PIC X(09) VALUE "~RESCIND=".
  4771    05  OUT-RESCIND             PIC X(01) VALUE SPACES.
  4772    05  F                       PIC X(07) VALUE "~RCD01=".
  4773    05  OUT-REA-CD1             PIC X(04) VALUE SPACES.
  4774    05  F                       PIC X(07) VALUE "~RCD02=".
  4775    05  OUT-REA-CD2             PIC X(04) VALUE SPACES.
  4776    05  F                       PIC X(07) VALUE "~RCD03=".
  4777    05  OUT-REA-CD3             PIC X(04) VALUE SPACES.
  4778    05  F                       PIC X(07) VALUE "~RCD04=".
  4779    05  OUT-REA-CD4             PIC X(04) VALUE SPACES.
  4780    05  F                       PIC X(07) VALUE "~RCD05=".
  4781    05  OUT-REA-CD5             PIC X(04) VALUE SPACES.
  4782    05  F                       PIC X(07) VALUE "~RCD06=".
  4783    05  OUT-REA-CD6             PIC X(04) VALUE SPACES.
  4784    05  F                       PIC X(07) VALUE "~RCD07=".
  4785    05  OUT-REA-CD7             PIC X(04) VALUE SPACES.
  4786    05  F                       PIC X(07) VALUE "~RCD08=".
  4787    05  OUT-REA-CD8             PIC X(04) VALUE SPACES.
  4788    05  F                       PIC X(07) VALUE "~RCD09=".
  4789    05  OUT-REA-CD9             PIC X(04) VALUE SPACES.
  4790    05  F                       PIC X(07) VALUE "~RCD10=".
  4791    05  OUT-REA-CD10            PIC X(04) VALUE SPACES.
  4792    05  F                       PIC X(07) VALUE "~RCD11=".
  4793    05  OUT-REA-CD11            PIC X(04) VALUE SPACES.
  4794    05  F                       PIC X(07) VALUE "~RCD12=".
  4795    05  OUT-REA-CD12            PIC X(04) VALUE SPACES.
  4796    05  F                       PIC X(11) VALUE "~CYCLEDATE=".
  4797    05  OUT-CYCLE-DT            PIC X(21) VALUE SPACES.
  4798    05  F                       PIC X(08) VALUE "~ARCHNO=".
  4799    05  OUT-ARCH-NO             PIC 9(9)  VALUE ZEROS.
  4800    05  F                       PIC X(06) VALUE "~FORM=".
  4801    05  OUT-FORM                PIC X(03) VALUE SPACES.
  4802    05  F                       PIC X(09) VALUE "~ENCLINE=".
  4803    05  OUT-ENC-LINE            PIC X(50) VALUE SPACES.
  4804    05  F                       PIC X(08) VALUE "~ATTACH=".
  4805    05  OUT-ATTACH              PIC X(50) VALUE SPACES.
  4806    05  F                       PIC X(10) VALUE "~OUTSTACK=".
  4807    05  OUT-STACK               PIC X(10) VALUE SPACES.
  4808    05  F                       PIC X(11) VALUE "~STATENAME=".
  4809    05  OUT-STATE-NAME          PIC X(25) VALUE SPACES.
  4810    05  F                       PIC X(08) VALUE "~PRTNOW=".
  4811    05  OUT-PRINT-NOW           PIC X(01) VALUE SPACES.
  4812    05  F                       PIC X(05) VALUE "~NCB=".
  4813    05  OUT-CHGBACK             PIC X     VALUE ' '.
  4814    05  F                       PIC X(8) VALUE "~CSOAMT=".
  4815    05  OUT-CSO-PORTION         PIC 9(7).99 VALUE ZEROS.
  4816    05  F                       PIC X(9) VALUE "~ACCTAMT=".
  4817    05  OUT-ACT-PORTION         PIC 9(7).99 VALUE ZEROS.
  4818    05  F                       PIC X(8) VALUE "~TOPREM=".
  4819    05  OUT-ORIG-TOT-PREM       PIC 9(7).99 VALUE ZEROS.
  4820    05  F                       PIC X(7) VALUE "~TOREF=".
  4821    05  OUT-ORIG-TOT-REF        PIC 9(7).99 VALUE ZEROS.
  4822    05  F                       PIC X(7) VALUE "~CANDT=".
  4823    05  OUT-CANCEL-DT           PIC X(21) VALUE SPACES.
  4824    05  F                       PIC X(9)  VALUE "~HLTHAPP=".
  4825    05  OUT-HEALTH-APP          PIC X     VALUE SPACES.
  4826    05  F                       PIC X(08) VALUE "~UNDWID=".
  4827    05  OUT-UNDW-ID             PIC X(04) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* NSRASBL.cbl
  4828    05  F                       PIC X(8) VALUE "~TNPREM=".
  4829    05  OUT-NEW-TOT-PREM        PIC 9(7).99 VALUE ZEROS.
  4830    05  F                       PIC X(7) VALUE "~TNREF=".
  4831    05  OUT-NEW-TOT-REF         PIC 9(7).99 VALUE ZEROS.
  4832    05  F                       PIC X(11) VALUE 'EndOfString'.
  4833    05  f                       pic x(01) value spaces.
  4834*                                COPY ERCARCH.
  4835******************************************************************
  4836*                                                                *
  4837*                            ERCARCH.                            *
  4838*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4839*                            VMOD=2.002                          *
  4840*                                                                *
  4841*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4842*                                                                *
  4843*   FILE TYPE = VSAM,KSDS                                        *
  4844*   RECORD SIZE = 250  RECFORM = FIXED                           *
  4845*                                                                *
  4846*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  4847*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  4848*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  4849*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  4850*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  4851*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  4852*                                                                *
  4853*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4854******************************************************************
  4855*                   C H A N G E   L O G
  4856*
  4857* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4858*-----------------------------------------------------------------
  4859*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4860* EFFECTIVE    NUMBER
  4861*-----------------------------------------------------------------
  4862* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  4863* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4864******************************************************************
  4865 01  LETTER-ARCHIVE.
  4866     12  LA-RECORD-ID                PIC  X(02).
  4867         88  LA-VALID-ID                VALUE 'LA'.
  4868
  4869     12  LA-CONTROL-PRIMARY.
  4870         16  LA-COMPANY-CD           PIC  X(01).
  4871         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  4872
  4873     12  LA-CONTROL-BY-CERT-RESP.
  4874         16  LA-COMPANY-CD-A2        PIC  X(01).
  4875         16  LA-CERT-NO-A2.
  4876             20  LA-CERT-PRIME-A2    PIC  X(10).
  4877             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  4878         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  4879             20  LA-RESP-PERSON-A2   PIC  X(10).
  4880             20  LA-TYPE-A2          PIC  X(01).
  4881         16  LA-CARRIER-A2           PIC  X(01).
  4882         16  LA-GROUPING-A2          PIC  X(06).
  4883         16  LA-STATE-A2             PIC  X(02).
  4884         16  LA-ACCOUNT-A2           PIC  X(10).
  4885         16  LA-EFFECT-DATE-A2       PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* NSRASBL.cbl
  4886         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  4887
  4888     12  LA-CONTROL-BY-FORM.
  4889         16  LA-COMPANY-CD-A3        PIC  X(01).
  4890         16  LA-FORM-A3              PIC  X(04).
  4891         16  LA-CARRIER-A3           PIC  X(01).
  4892         16  LA-GROUPING-A3          PIC  X(06).
  4893         16  LA-STATE-A3             PIC  X(02).
  4894         16  LA-ACCOUNT-A3           PIC  X(10).
  4895         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  4896
  4897     12  LA-CONTROL-BY-PROCESSOR.
  4898         16  LA-COMPANY-CD-A4        PIC  X(01).
  4899         16  LA-PROCESSOR-CD         PIC  X(04).
  4900         16  LA-CARRIER-A4           PIC  X(01).
  4901         16  LA-GROUPING-A4          PIC  X(06).
  4902         16  LA-STATE-A4             PIC  X(02).
  4903         16  LA-ACCOUNT-A4           PIC  X(10).
  4904         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  4905
  4906     12  LA-CONTROL-BY-KEY-FIELDS.
  4907         16  LA-COMPANY-CD-A5        PIC  X(01).
  4908         16  LA-CARRIER-A5           PIC  X(01).
  4909         16  LA-GROUPING-A5          PIC  X(06).
  4910         16  LA-STATE-A5             PIC  X(02).
  4911         16  LA-ACCOUNT-A5           PIC  X(10).
  4912         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  4913
  4914     12  LA-CONTROL-BY-GROUP-CODE.
  4915         16  LA-COMPANY-CD-A6        PIC  X(01).
  4916         16  LA-ENTRY-A6.
  4917             20  LA-FILLER           PIC  X(02).
  4918             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  4919         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  4920
  4921     12  FILLER                      PIC  X(09).
  4922
  4923     12  LA-HEADER-RECORD.
  4924         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  4925         16  LA-CREATION-DATE        PIC  X(02).
  4926         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  4927         16  LA-FINAL-ACT-DATE       REDEFINES
  4928               LA-FOLLOW-UP-DATE     PIC  X(02).
  4929         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  4930         16  LA-NO-OF-COPIES         PIC S9(01).
  4931         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  4932         16  LA-REPLY-DATE           PIC  X(02).
  4933         16  LA-RESEND-DATES.
  4934             20  LA-RESEND-DATE      PIC  X(02).
  4935             20  LA-SENT-DATE        PIC  X(02).
  4936             20  FILLER              PIC  X(08).
  4937         16  LA-SOURCE-INFORMATION.
  4938             20  LA-DATA-SOURCE      PIC  X(01).
  4939             20  LA-ADDR-SOURCE      PIC  X(01).
  4940         16  LA-STATUS               PIC  X(01).
  4941             88  LA-STATUS-ACTIVE         VALUE 'A'.
  4942             88  LA-STATUS-COMPLETED      VALUE 'C'.
  4943             88  LA-STATUS-ON-HOLD        VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* NSRASBL.cbl
  4944             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  4945             88  LA-STATUS-PURGED         VALUE 'P'.
  4946             88  LA-STATUS-VOIDED         VALUE 'V'.
  4947         16  LA-LAST-RESENT-PRINT-DATE
  4948                                     PIC  X(02).
  4949         16  LA-PRINT-RESTRICTION    PIC  X(01).
  4950             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4951                                          VALUE 'C'.
  4952             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4953                                          VALUE 'F'.
  4954             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4955                                          VALUE 'P'.
  4956         16  LA-PURGED-DATE          PIC  X(02).
  4957         16  LA-VOIDED-DATE          PIC  X(02).
  4958         16  LA-RESEND-LETR          PIC  X(4).
  4959         16  FILLER                  PIC  X(08).
  4960*        16  LA-RESEND-LETR-2        PIC  X(4).
  4961*        16  LA-RESEND-LETR-3        PIC  X(4).
  4962*        16  FILLER                  PIC  X(59).
  4963         16  LA-ARCHIVE-STATUS       PIC  X.
  4964             88  LA-TEMP                VALUE 'T'.
  4965             88  LA-QWS                 VALUE 'Q'.
  4966             88  LA-BATCH               VALUE 'B'.
  4967         16  LA-FINAL-ACT-IND        PIC  X(1).
  4968         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  4969         16  FILLER                  PIC  X(46).
  4970*        16  FILLER                  PIC  X(71).
  4971         16  LA-LAST-MAINT-DATE      PIC  X(2).
  4972         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  4973         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  4974                                     PIC  X(4).
  4975         16  LA-LAST-UPDATED-BY      PIC  X(4).
  4976
  4977******************************************************************
  4978 01  FILLER                      PIC X(500)  VALUE SPACES.
  4979*                                COPY ELCENCC.
  4980******************************************************************
  4981*                                                                *
  4982*                                                                *
  4983*                            ELCENCC                             *
  4984*                            VMOD=2.001                          *
  4985*                                                                *
  4986*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  4987*                                                                *
  4988*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  4989*   A NAPERSOFT DOCUMENT                                         *
  4990*                                                                *
  4991*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  4992*                                                                *
  4993*   FILE TYPE = VSAM,KSDS                                        *
  4994*   RECORD SIZE = 400   RECFORM = FIX                            *
  4995*                                                                *
  4996*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  4997*                                                                *
  4998*   LOG = NO                                                     *
  4999*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5000*                                                                *
  5001*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* NSRASBL.cbl
  5002******************************************************************
  5003*                   C H A N G E   L O G
  5004*
  5005* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5006*-----------------------------------------------------------------
  5007*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5008* EFFECTIVE    NUMBER
  5009*-----------------------------------------------------------------
  5010* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5011******************************************************************
  5012 01  ENCLOSURE-CODES.
  5013     12  NC-RECORD-ID                      PIC XX.
  5014         88  VALID-NC-ID                      VALUE 'NC'.
  5015     12  NC-CONTROL-PRIMARY.
  5016         16  NC-COMPANY-CD                 PIC X.
  5017         16  NC-REC-TYPE                   PIC X.
  5018             88  NC-CLAIMS                   VALUE '1'.
  5019             88  NC-ADMIN                    VALUE '2'.
  5020         16  NC-ENC-CODE                   PIC X(5).
  5021         16  FILLER                        PIC X(09).
  5022     12  NC-MAINT-INFORMATION.
  5023         16  NC-LAST-MAINT-DT              PIC XX.
  5024         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5025         16  NC-LAST-MAINT-USER            PIC X(4).
  5026         16  FILLER                        PIC XX.
  5027     12  NC-OUTPUT-STACK                   PIC XXX.
  5028     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5029     12  NC-ATTACHMENTS                    PIC X(100).
  5030     12  NC-FUTURE                         PIC X(50).
  5031     12  FILLER                            PIC X(117).
  5032******************************************************************
  5033****************************************************************
  5034*
  5035* Copyright (c) 2007 by Clerity Solutions, Inc.
  5036* All rights reserved.
  5037*
  5038****************************************************************
  5039 01  DFHEIV.
  5040   02  DFHEIV0               PIC X(35).
  5041   02  DFHEIV1               PIC X(08).
  5042   02  DFHEIV2               PIC X(08).
  5043   02  DFHEIV3               PIC X(08).
  5044   02  DFHEIV4               PIC X(06).
  5045   02  DFHEIV5               PIC X(04).
  5046   02  DFHEIV6               PIC X(04).
  5047   02  DFHEIV7               PIC X(02).
  5048   02  DFHEIV8               PIC X(02).
  5049   02  DFHEIV9               PIC X(01).
  5050   02  DFHEIV10              PIC S9(7) COMP-3.
  5051   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5052   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5053   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5054   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5055   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5056   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5057   02  DFHEIV17              PIC X(04).
  5058   02  DFHEIV18              PIC X(04).
  5059   02  DFHEIV19              PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* NSRASBL.cbl
  5060   02  DFHEIV20              USAGE IS POINTER.
  5061   02  DFHEIV21              USAGE IS POINTER.
  5062   02  DFHEIV22              USAGE IS POINTER.
  5063   02  DFHEIV23              USAGE IS POINTER.
  5064   02  DFHEIV24              USAGE IS POINTER.
  5065   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5066   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5067   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5068   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5069   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5070   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5071   02  FILLER                PIC X(02).
  5072   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5073   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5074   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5075   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5076   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5077 LINKAGE  SECTION.
  5078*****************************************************************
  5079*                                                               *
  5080* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5081* All rights reserved.                                          *
  5082*                                                               *
  5083*****************************************************************
  5084 01  dfheiblk.
  5085     02  eibtime          pic s9(7) comp-3.
  5086     02  eibdate          pic s9(7) comp-3.
  5087     02  eibtrnid         pic x(4).
  5088     02  eibtaskn         pic s9(7) comp-3.
  5089     02  eibtrmid         pic x(4).
  5090     02  dfheigdi         pic s9(4) comp.
  5091     02  eibcposn         pic s9(4) comp.
  5092     02  eibcalen         pic s9(4) comp.
  5093     02  eibaid           pic x(1).
  5094     02  eibfiller1       pic x(1).
  5095     02  eibfn            pic x(2).
  5096     02  eibfiller2       pic x(2).
  5097     02  eibrcode         pic x(6).
  5098     02  eibfiller3       pic x(2).
  5099     02  eibds            pic x(8).
  5100     02  eibreqid         pic x(8).
  5101     02  eibrsrce         pic x(8).
  5102     02  eibsync          pic x(1).
  5103     02  eibfree          pic x(1).
  5104     02  eibrecv          pic x(1).
  5105     02  eibsend          pic x(1).
  5106     02  eibatt           pic x(1).
  5107     02  eibeoc           pic x(1).
  5108     02  eibfmh           pic x(1).
  5109     02  eibcompl         pic x(1).
  5110     02  eibsig           pic x(1).
  5111     02  eibconf          pic x(1).
  5112     02  eiberr           pic x(1).
  5113     02  eibrldbk         pic x(1).
  5114     02  eiberrcd         pic x(4).
  5115     02  eibsynrb         pic x(1).
  5116     02  eibnodat         pic x(1).
  5117     02  eibfiller5       pic x(2).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* NSRASBL.cbl
  5118     02  eibresp          pic 9(09) comp.
  5119     02  eibresp2         pic 9(09) comp.
  5120     02  dfheigdj         pic s9(4) comp.
  5121     02  dfheigdk         pic s9(4) comp.
  5122 01 dfhcommarea                  PIC X(5000).
  5123 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  5124 0000-DFHEXIT SECTION.
  5125     MOVE '9#                    $   ' TO DFHEIV0.
  5126     MOVE 'NSRASBL' TO DFHEIV1.
  5127     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5128     display ' entering pgm nsrasbl '
  5129     display ' commarea ' dfhcommarea
  5130     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5131     MOVE '5'                    TO DC-OPTION-CODE
  5132     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5133     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  5134     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  5135     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  5136     move dfhcommarea            to srch-commarea
  5137*****************************************************
  5138* The full       key has been established and passed
  5139* to this program via NSRASLTR
  5140*****************************************************
  5141     PERFORM 1115-MATCH-COMPANY  THRU 1115-EXIT
  5142     display ' input data ' bl-carrier ' ' bl-group ' '
  5143        bl-account ' ' bl-eff-dt ' ' bl-cert-no
  5144     MOVE BL-LETTER-ID           TO OUT-LETTER
  5145     MOVE BL-PROC-ID             TO OUT-PROC-ID
  5146     MOVE BL-CARRIER             TO OUT-CARRIER
  5147     MOVE BL-GROUP               TO OUT-GROUPING
  5148     MOVE BL-ACCOUNT             TO OUT-ACCOUNT
  5149     MOVE BL-PRINT-NOW-SW        TO OUT-PRINT-NOW
  5150     MOVE BL-CERT-FORM-ID        TO WS-CERT-FORM-ID
  5151     STRING DC-EDITA-CCYY DC-EDITA-MONTH
  5152        DC-EDITA-DAY  DELIMITED BY SIZE
  5153        INTO OUT-CYCLE-DT
  5154     END-STRING
  5155     IF BL-EFF-DT = '99/99/99' OR '99/99/9999'
  5156        MOVE HIGH-VALUES         TO WS-PASSED-DT
  5157     ELSE
  5158        IF BL-EFF-DT = SPACES
  5159           display ' bad eff data ' bl-eff-dt ' ' bl-cert-no
  5160        ELSE
  5161           IF BL-EFF-DT (9:2) = SPACES
  5162              STRING BL-EFF-DT (7:2) BL-EFF-DT (1:2)
  5163                     BL-EFF-DT (4:2)
  5164                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5165              END-STRING
  5166           ELSE
  5167              STRING BL-EFF-DT (9:2) BL-EFF-DT (1:2)
  5168                     BL-EFF-DT (4:2)
  5169                DELIMITED BY SIZE INTO DC-GREG-DATE-1-YMD-R
  5170              END-STRING
  5171           END-IF
  5172           MOVE '3'              TO DC-OPTION-CODE
  5173           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  5174           IF NO-CONVERSION-ERROR
  5175              MOVE DC-BIN-DATE-1 TO WS-PASSED-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* NSRASBL.cbl
  5176           ELSE
  5177              MOVE 'BAD EFF DATE CONVERT ' TO BL-MESSAGE
  5178              SET BL-FAIL TO TRUE
  5179              GO TO 0000-RETURN
  5180           END-IF
  5181        END-IF
  5182     END-IF
  5183     perform 0800-init-out-data  thru 0800-exit
  5184     SET BL-FAIL TO TRUE
  5185******************************************************************
  5186* DATA SOURCE MEANINGS  BL-DATA-SRCE
  5187*    1) FROM ACCT MAINT
  5188*    2) FROM CERT UPDATE
  5189*    3) FROM COMP MAINT
  5190*    4) FROM REVIEW AND CORRECTIONS
  5191******************************************************************
  5192     EVALUATE BL-DATA-SRCE
  5193        WHEN '1'
  5194           PERFORM 0100-DATA-SRCE-1 THRU 0100-EXIT
  5195        WHEN '2'
  5196           PERFORM 0200-DATA-SRCE-2 THRU 0200-EXIT
  5197        WHEN '3'
  5198           PERFORM 0300-DATA-SRCE-3 THRU 0300-EXIT
  5199        WHEN '4'
  5200           PERFORM 0400-DATA-SRCE-4 THRU 0400-EXIT
  5201        WHEN OTHER
  5202           MOVE ' BAD DATA SOURCE CODE ' TO BL-MESSAGE
  5203     END-EVALUATE
  5204     IF BL-OK
  5205        display ' bl write erarch ' bl-write-erarch
  5206        PERFORM 1250-GET-ELLETR  THRU 1250-EXIT
  5207        PERFORM 1700-GET-ELENCC  THRU 1700-EXIT
  5208        IF BL-ARCHIVE-NO = ZEROS
  5209           PERFORM 1500-GET-ARCH-NO THRU 1500-EXIT
  5210           MOVE WS-ARCHIVE-NO    TO BL-ARCHIVE-NO
  5211           display ' arch zeros, new arch ' bl-archive-no
  5212        END-IF
  5213        MOVE BL-ARCHIVE-NO       TO OUT-ARCH-NO
  5214        PERFORM 0500-SCRUB-DATA  THRU 0500-EXIT
  5215        display ' bl write erarch ' bl-write-erarch
  5216        IF BL-WRITE-ERARCH = 'T' OR 'B'
  5217           PERFORM 0700-WRITE-EXTR THRU 0700-EXIT
  5218           IF BL-FAIL
  5219              GO TO 0000-RETURN
  5220           END-IF
  5221        END-IF
  5222        MOVE W-LETTER-TO-ACCT    TO BL-LETTER-TO-ACCT
  5223        MOVE W-LETTER-TO-BENE    TO BL-LETTER-TO-BENE
  5224     END-IF
  5225     .
  5226 0000-RETURN.
  5227     move srch-commarea          to dfhcommarea
  5228
  5229* exec cics
  5230*       return
  5231*    end-exec
  5232*    MOVE '.(                    &   #00005224' TO DFHEIV0
  5233     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* NSRASBL.cbl
  5234     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5235     MOVE X'2020233030303035323234' TO DFHEIV0(25:11)
  5236     CALL 'kxdfhei1' USING DFHEIV0,
  5237           DFHEIV99,
  5238           DFHEIV99,
  5239           DFHEIV99,
  5240           DFHEIV99,
  5241           DFHEIV99
  5242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5243     .
  5244 0100-DATA-SRCE-1.
  5245     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5246     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5247     MOVE ' '                    TO WS-ERACCT-SW
  5248     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  5249     MOVE WS-COMPANY-CD          TO WS-ERACCT-COMPANY-CD
  5250     MOVE BL-CARRIER             TO WS-ERACCT-CARRIER
  5251     MOVE BL-GROUP               TO WS-ERACCT-GROUP
  5252     MOVE BL-STATE               TO WS-ERACCT-STATE
  5253     MOVE BL-ACCOUNT             TO WS-ERACCT-ACCOUNT
  5254     MOVE WS-PASSED-DT           TO WS-ERACCT-EXP-DT
  5255     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT
  5256     IF ACCT-FOUND
  5257        MOVE AM-CSR-CODE         TO WS-CSR-ID
  5258        PERFORM 1025-GET-CSR-INFO
  5259                                 THRU 1025-EXIT
  5260        PERFORM 1300-DETERMINE-COMM
  5261                                 THRU 1300-EXIT
  5262        SET BL-OK TO TRUE
  5263     ELSE
  5264        MOVE ' ACCOUNT MASTER NOT FOUND ' TO BL-MESSAGE
  5265        SET BL-FAIL TO TRUE
  5266     END-IF
  5267     .
  5268 0100-EXIT.
  5269     EXIT.
  5270 0200-DATA-SRCE-2.
  5271     display ' made it to data srce 2 '
  5272     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5273     PERFORM 1125-MATCH-STATE    THRU 1125-EXIT
  5274     MOVE ' '                    TO WS-ELCERT-SW
  5275     MOVE WS-COMPANY-CD          TO WS-ELCERT-COMPANY-CD
  5276     MOVE BL-CARRIER             TO WS-ELCERT-CARRIER
  5277     MOVE BL-GROUP               TO WS-ELCERT-GROUP
  5278     MOVE BL-STATE               TO WS-ELCERT-STATE
  5279     MOVE BL-ACCOUNT             TO WS-ELCERT-ACCOUNT
  5280     MOVE WS-PASSED-DT           TO WS-ELCERT-EFF-DT
  5281     MOVE BL-CERT-NO             TO WS-ELCERT-CERT-NO
  5282     PERFORM 1100-GET-ELCERT     THRU 1100-EXIT
  5283     IF CERT-FOUND
  5284        MOVE CM-LF-BENEFIT-CD    TO WS-LF-BENCD
  5285        MOVE CM-AH-BENEFIT-CD    TO WS-AH-BENCD
  5286        PERFORM 1130-MATCH-BENCDS THRU 1130-EXIT
  5287        MOVE WS-LF-ABBRV         TO OUT-LF-ABBRV
  5288        MOVE WS-LF-DESC          TO OUT-LF-DESC
  5289        IF WS-LF-EARN = 'B'
  5290           MOVE 'B'              TO OUT-BALLOON-IND
  5291        END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* NSRASBL.cbl
  5292        MOVE WS-WAIT-PER         TO OUT-WAIT-PER
  5293        MOVE WS-RET-ELIM         TO OUT-RET-ELIM
  5294        MOVE WS-AH-DESC          TO OUT-AH-DESC
  5295        MOVE WS-BEN-DAYS         TO OUT-BEN-DAYS
  5296        MOVE ' '                 TO WS-ERACCT-SW
  5297        MOVE LOW-VALUES          TO WS-ERACCT-KEY
  5298        MOVE WS-ELCERT-KEY (1:22) TO WS-ERACCT-KEY (1:22)
  5299        PERFORM 1200-GET-ERACCT  THRU 1200-EXIT
  5300        IF ACCT-FOUND
  5301           MOVE AM-CSR-CODE      TO WS-CSR-ID
  5302           PERFORM 1025-GET-CSR-INFO
  5303                                 THRU 1025-EXIT
  5304           PERFORM 1300-DETERMINE-COMM
  5305                                 THRU 1300-EXIT
  5306        END-IF
  5307        IF (CM-STATE = 'KY' OR 'MD' OR 'WI')
  5308           AND (OUT-BALLOON-IND = 'B')
  5309           MOVE 'B'              TO OUT-FORM (3:1)
  5310        END-IF
  5311        SET BL-OK TO TRUE
  5312     ELSE
  5313        display ' cert not found ' ws-elcert-cert-no
  5314        MOVE ' CERTIFICATE NOT FOUND ' TO BL-MESSAGE
  5315        SET BL-FAIL TO TRUE
  5316     END-IF
  5317     .
  5318 0200-EXIT.
  5319     EXIT.
  5320 0300-DATA-SRCE-3.
  5321     PERFORM 1120-MATCH-CARRIER  THRU 1120-EXIT
  5322     MOVE WS-COMPANY-CD          TO WS-ERCOMP-COMPANY-CD
  5323     MOVE BL-CARRIER             TO WS-ERCOMP-CARRIER
  5324     MOVE BL-GROUP               TO WS-ERCOMP-GROUP
  5325     MOVE BL-RESP-NO             TO WS-ERCOMP-RESP-NO
  5326     MOVE BL-ACCOUNT             TO WS-ERCOMP-ACCOUNT
  5327     IF WS-ERCOMP-ACCOUNT = SPACES
  5328        MOVE LOW-VALUES          TO WS-ERCOMP-ACCOUNT
  5329        MOVE 'G'                 TO WS-ERCOMP-REC-TYPE
  5330     ELSE
  5331        MOVE 'A'                 TO WS-ERCOMP-REC-TYPE
  5332     END-IF
  5333     PERFORM 1225-GET-ERCOMP     THRU 1225-EXIT
  5334     IF RESP-NORMAL
  5335        MOVE CO-CSR-CODE         TO WS-CSR-ID
  5336        PERFORM 1025-GET-CSR-INFO
  5337                                 THRU 1025-EXIT
  5338        SET BL-OK TO TRUE
  5339     ELSE
  5340        MOVE ' COMPENSATION MASTER NOT FOUND ' TO BL-MESSAGE
  5341        SET BL-FAIL TO TRUE
  5342     END-IF
  5343     .
  5344 0300-EXIT.
  5345     EXIT.
  5346 0400-DATA-SRCE-4.
  5347     MOVE WS-COMPANY-CD          TO WS-ERPNDB-COMPANY-CD
  5348     MOVE BL-BATCH-NO            TO WS-ERPNDB-BATCH-NO
  5349     MOVE BL-BATCH-SEQ           TO WS-ERPNDB-BATCH-SEQ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* NSRASBL.cbl
  5350     MOVE +0                     TO WS-ERPNDB-CHG-SEQ
  5351     MOVE ' '                    TO WS-ERPNDB-SW WS-ERACCT-SW
  5352                                    WS-ELCERT-SW WS-ERENDT-SW
  5353
  5354* EXEC CICS READ
  5355*         DATASET    ('ERPNDB')
  5356*         INTO       (PENDING-BUSINESS)
  5357*         RIDFLD     (WS-ERPNDB-KEY)
  5358*         RESP       (WS-RESPONSE)
  5359*    END-EXEC
  5360     MOVE LENGTH OF
  5361      PENDING-BUSINESS
  5362       TO DFHEIV11
  5363     MOVE 'ERPNDB' TO DFHEIV1
  5364*    MOVE '&"IL       E          (  N#00005337' TO DFHEIV0
  5365     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5366     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5367     MOVE X'204E233030303035333337' TO DFHEIV0(25:11)
  5368     CALL 'kxdfhei1' USING DFHEIV0,
  5369           DFHEIV1,
  5370           PENDING-BUSINESS,
  5371           DFHEIV11,
  5372           WS-ERPNDB-KEY,
  5373           DFHEIV99,
  5374           DFHEIV99,
  5375           DFHEIV99
  5376     MOVE EIBRESP  TO WS-RESPONSE
  5377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5378     IF RESP-NORMAL
  5379        IF PB-RECORD-TYPE = '1' OR '2'
  5380           MOVE PB-CARRIER       TO BL-CARRIER
  5381           MOVE PB-GROUPING      TO BL-GROUP
  5382           MOVE PB-STATE         TO BL-STATE
  5383           MOVE PB-ACCOUNT       TO BL-ACCOUNT
  5384           MOVE PB-CERT-NO       TO BL-CERT-NO
  5385           MOVE PB-CSR-ID        TO WS-CSR-ID
  5386           IF PB-ISSUE
  5387              SET PROCESS-ISSUE TO TRUE
  5388              MOVE PB-I-LF-BENEFIT-CD TO WS-LF-BENCD
  5389              MOVE PB-I-AH-BENEFIT-CD TO WS-AH-BENCD
  5390              MOVE PB-I-LF-PREM-CALC TO OUT-LF-CALC-PRM
  5391              MOVE PB-I-AH-PREM-CALC TO OUT-AH-CALC-PRM
  5392           ELSE
  5393              SET PROCESS-CANCEL TO TRUE
  5394              MOVE PB-CI-LF-BENEFIT-CD TO WS-LF-BENCD
  5395              MOVE PB-CI-AH-BENEFIT-CD TO WS-AH-BENCD
  5396              MOVE PB-C-LF-REF-CALC TO OUT-LF-CALC-REF
  5397              MOVE PB-C-AH-REF-CALC TO OUT-AH-CALC-REF
  5398           END-IF
  5399           PERFORM 1120-MATCH-CARRIER
  5400                                 THRU 1120-EXIT
  5401           PERFORM 1125-MATCH-STATE
  5402                                 THRU 1125-EXIT
  5403           PERFORM 1130-MATCH-BENCDS
  5404                                 THRU 1130-EXIT
  5405           MOVE WS-LF-ABBRV      TO OUT-LF-ABBRV
  5406           MOVE WS-LF-DESC       TO OUT-LF-DESC
  5407                                    OUT-ORIG-LF-DESC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* NSRASBL.cbl
  5408           IF WS-LF-EARN = 'B'
  5409              MOVE 'B'           TO OUT-BALLOON-IND
  5410           END-IF
  5411           MOVE WS-WAIT-PER      TO OUT-WAIT-PER
  5412                                    OUT-ORIG-WAIT-PER
  5413           MOVE WS-RET-ELIM      TO OUT-RET-ELIM
  5414                                    OUT-ORIG-RET-ELIM
  5415           MOVE WS-AH-DESC       TO OUT-AH-DESC
  5416                                    OUT-ORIG-AH-DESC
  5417           MOVE WS-BEN-DAYS      TO OUT-BEN-DAYS
  5418                                    OUT-ORIG-BEN-DAYS
  5419           PERFORM 1025-GET-CSR-INFO
  5420                                 THRU 1025-EXIT
  5421           MOVE PB-CONTROL-BY-ACCOUNT (1:33)
  5422                                 TO WS-ELCERT-KEY
  5423           PERFORM 1100-GET-ELCERT
  5424                                 THRU 1100-EXIT
  5425           MOVE LOW-VALUES       TO WS-ERACCT-KEY
  5426           MOVE PB-CONTROL-BY-ACCOUNT (1:22)
  5427                                 TO WS-ERACCT-KEY (1:22)
  5428           PERFORM 1200-GET-ERACCT
  5429                                  THRU 1200-EXIT
  5430           IF ACCT-FOUND
  5431              MOVE AM-CSR-CODE      TO WS-CSR-ID
  5432              PERFORM 1025-GET-CSR-INFO
  5433                                    THRU 1025-EXIT
  5434              PERFORM 1300-DETERMINE-COMM
  5435                                    THRU 1300-EXIT
  5436           END-IF
  5437           MOVE PB-CONTROL-BY-ACCOUNT (1:33)
  5438                                 TO WS-ERENDT-KEY
  5439           MOVE WS-ISSUE-CANCEL-SW TO WS-ERENDT-REC-TYPE
  5440           MOVE +0               TO WS-ERENDT-SEQ-NO
  5441           PERFORM 0600-GET-ERENDT
  5442                                  THRU 0600-EXIT
  5443           SET BL-OK TO TRUE
  5444           IF (PB-STATE = 'KY' OR 'MD' OR 'WI')
  5445              AND (OUT-BALLOON-IND = 'B')
  5446              MOVE 'B'           TO OUT-FORM (3:1)
  5447           END-IF
  5448        END-IF
  5449     END-IF
  5450     .
  5451 0400-EXIT.
  5452     EXIT.
  5453 0500-SCRUB-DATA.
  5454*   THE DECODER DOES NOT LIKE & AND I TRIED TO USE
  5455*   A DIFFERENT DELIMITER IN PROGRAM NSRASLTR BUT
  5456*   COULD NOT GET IT TO WORK SO I AM CONVERTING IT
  5457*   TO A HEX 26 TO GET BY THE DECODER
  5458     MOVE FUNCTION LENGTH(OUT-ACCT-NAME)
  5459                                 TO M1
  5460     MOVE OUT-ACCT-NAME          TO WS-WORK-FIELD
  5461     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5462        (A1 > M1)
  5463        OR (WS-WORK-FIELD (A1:1) = '*')
  5464        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  5465        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* NSRASBL.cbl
  5466     END-PERFORM
  5467     IF A1 > M1
  5468        CONTINUE
  5469     ELSE
  5470        MOVE WS-WORK-FIELD (1:A1 - 1)
  5471                                 TO OUT-ACCT-NAME
  5472     END-IF
  5473     MOVE FUNCTION LENGTH(OUT-BENE-NAME)
  5474                                 TO M1
  5475     MOVE OUT-BENE-NAME          TO WS-WORK-FIELD
  5476     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5477        (A1 > M1)
  5478        OR (WS-WORK-FIELD (A1:1) = '*')
  5479        OR (WS-WORK-FIELD (A1:4) = ' DBA' OR ' AKA')
  5480        OR (WS-WORK-FIELD (A1:4) = '(DBA' OR '(AKA')
  5481     END-PERFORM
  5482     IF A1 > M1
  5483        CONTINUE
  5484     ELSE
  5485        MOVE WS-WORK-FIELD (1:A1 - 1)
  5486                                 TO OUT-BENE-NAME
  5487     END-IF
  5488     IF OUT-CERT-NO = LOW-VALUES OR SPACES
  5489         MOVE '0000000000 '  TO OUT-CERT-NO
  5490     END-IF
  5491     MOVE +1 TO M1
  5492     MOVE SPACES TO BL-RECORD-PASSED-DATA
  5493     MOVE FUNCTION LENGTH(NAPER-OUTPUT-DATA)
  5494                                 TO NS-LEN
  5495     display ' naper output data length ' ns-len
  5496     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  5497        (NAPER-OUTPUT-DATA (A1:11) = 'EndOfString')
  5498        OR (A1 > NS-LEN)
  5499        IF NAPER-OUTPUT-DATA (A1:3) = SPACES
  5500           CONTINUE
  5501        ELSE
  5502           IF NAPER-OUTPUT-DATA (A1:1) = '~'
  5503              MOVE '&'           TO BL-RECORD-PASSED-DATA (M1:1)
  5504              MOVE ' '           TO NAPER-OUTPUT-DATA (A1:1)
  5505              ADD +1 TO M1
  5506           ELSE
  5507              IF NAPER-OUTPUT-DATA (A1:1) = '&'
  5508                 MOVE '%26'      TO BL-RECORD-PASSED-DATA (M1:3)
  5509                 ADD +3 TO M1
  5510              ELSE
  5511                 MOVE NAPER-OUTPUT-DATA (A1:1)
  5512                                 TO BL-RECORD-PASSED-DATA (M1:1)
  5513                 ADD +1 TO M1
  5514              END-IF
  5515           END-IF
  5516        END-IF
  5517     END-PERFORM
  5518     .
  5519 0500-EXIT.
  5520     EXIT.
  5521 0600-GET-ERENDT.
  5522
  5523* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* NSRASBL.cbl
  5524*         DATASET    ('ERENDT')
  5525*         INTO       (ENDORSEMENT-RECORD)
  5526*         RIDFLD     (WS-ERENDT-KEY)
  5527*         RESP       (WS-RESPONSE)
  5528*         GTEQ
  5529*    END-EXEC
  5530     MOVE LENGTH OF
  5531      ENDORSEMENT-RECORD
  5532       TO DFHEIV11
  5533     MOVE 'ERENDT' TO DFHEIV1
  5534*    MOVE '&"IL       G          (  N#00005487' TO DFHEIV0
  5535     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5536     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5537     MOVE X'204E233030303035343837' TO DFHEIV0(25:11)
  5538     CALL 'kxdfhei1' USING DFHEIV0,
  5539           DFHEIV1,
  5540           ENDORSEMENT-RECORD,
  5541           DFHEIV11,
  5542           WS-ERENDT-KEY,
  5543           DFHEIV99,
  5544           DFHEIV99,
  5545           DFHEIV99
  5546     MOVE EIBRESP  TO WS-RESPONSE
  5547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5548     DISPLAY ' JUST READ ENDT ' WS-RESPONSE ' '
  5549        WS-ERENDT-KEY (2:33) ' ' WS-ERENDT-SEQ-NO
  5550     IF (RESP-NORMAL)
  5551        AND (PB-CONTROL-BY-ACCOUNT (1:33) =
  5552           EN-CONTROL-PRIMARY (1:33))
  5553        AND (EN-REC-TYPE = WS-ISSUE-CANCEL-SW)
  5554*       AND (EN-PROCESS-DT = LOW-VALUES)
  5555        SET ENDT-FOUND TO TRUE
  5556        PERFORM 0620-BUILD-ENDT  THRU 0620-EXIT
  5557        PERFORM 0650-PROCESS-NO-Change
  5558                                 THRU 0650-EXIT
  5559     END-IF
  5560     .
  5561 0600-EXIT.
  5562     EXIT.
  5563 0620-BUILD-ENDT.
  5564     display ' made it to 0620 '
  5565     IF EN-REC-TYPE = 'C'
  5566        GO TO 0620-PROCESS-CANCEL
  5567     END-IF
  5568     MOVE EN-LF-ORIG-BENCD       TO WS-LF-BENCD
  5569     MOVE EN-AH-ORIG-BENCD       TO WS-AH-BENCD
  5570     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  5571     MOVE WS-LF-DESC             TO OUT-ORIG-LF-DESC
  5572     IF WS-LF-EARN = 'B'
  5573        MOVE 'B'                 TO OUT-BALLOON-IND
  5574     END-IF
  5575     MOVE WS-AH-DESC             TO OUT-ORIG-AH-DESC
  5576     MOVE WS-RET-ELIM            TO OUT-ORIG-RET-ELIM
  5577     MOVE WS-BEN-DAYS            TO OUT-ORIG-BEN-DAYS
  5578     MOVE WS-WAIT-PER            TO OUT-ORIG-WAIT-PER
  5579     MOVE EN-INS-ORIG-LAST-NAME    TO OUT-ORIG-ILNAME
  5580     MOVE EN-INS-ORIG-FIRST-NAME   TO OUT-ORIG-IFNAME
  5581     MOVE EN-INS-ORIG-MIDDLE-INIT  TO OUT-ORIG-MINIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* NSRASBL.cbl
  5582     MOVE EN-INS-ORIG-AGE          TO OUT-ORIG-IAGE
  5583     MOVE EN-JNT-ORIG-LAST-NAME    TO OUT-ORIG-JLNAME
  5584     MOVE EN-JNT-ORIG-FIRST-NAME   TO OUT-ORIG-JFNAME
  5585     MOVE EN-JNT-ORIG-MIDDLE-INIT  TO OUT-ORIG-JMINIT
  5586     MOVE EN-JNT-ORIG-AGE          TO OUT-ORIG-JAGE
  5587     MOVE EN-LF-ORIG-BENCD         TO OUT-ORIG-LF-BENCD
  5588     MOVE EN-LF-ORIG-TERM          TO OUT-ORIG-LF-TERM
  5589     MOVE EN-LF-ORIG-BEN-AMT       TO OUT-ORIG-LF-BEN
  5590     MOVE EN-LF-ORIG-PRM-AMT       TO OUT-ORIG-LF-PRM
  5591     MOVE EN-LF-ORIG-ALT-BEN-AMT   TO OUT-ORIG-LF-ALT-BEN
  5592     MOVE EN-LF-ORIG-ALT-PRM-AMT   TO OUT-ORIG-LF-ALT-PRM
  5593     IF EN-LF-ORIG-BENCD EQUAL '00' OR SPACES
  5594         MOVE SPACES             TO OUT-ORIG-LF-BEN-A
  5595                                    OUT-ORIG-LF-PRM-A
  5596                                    OUT-ORIG-LF-ALT-BEN-A
  5597                                    OUT-ORIG-LF-ALT-PRM-A
  5598     END-IF
  5599     MOVE EN-LF-ORIG-EXP-DT      TO DC-BIN-DATE-1
  5600     MOVE ' '                    TO DC-OPTION-CODE
  5601     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5602     IF NO-CONVERSION-ERROR
  5603        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5604           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5605              INTO OUT-ORIG-LF-EXP-DT
  5606        END-STRING
  5607     END-IF
  5608     MOVE EN-AH-ORIG-BENCD       TO OUT-ORIG-AH-BENCD
  5609     MOVE EN-AH-ORIG-TERM        TO OUT-ORIG-AH-TERM
  5610     MOVE EN-AH-ORIG-BEN-AMT     TO OUT-ORIG-AH-BEN
  5611     MOVE EN-AH-ORIG-PRM-AMT     TO OUT-ORIG-AH-PRM
  5612     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  5613         MOVE SPACES             TO OUT-ORIG-AH-BEN-A
  5614                                    OUT-ORIG-AH-PRM-A
  5615     END-IF
  5616     COMPUTE WS-WORK-PREM =
  5617        EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT
  5618           + EN-AH-ORIG-PRM-AMT
  5619     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-PREM
  5620     MOVE EN-AH-ORIG-EXP-DT      TO DC-BIN-DATE-1
  5621     MOVE ' '                    TO DC-OPTION-CODE
  5622     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5623     IF NO-CONVERSION-ERROR
  5624        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5625           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5626              INTO OUT-ORIG-AH-EXP-DT
  5627        END-STRING
  5628     END-IF
  5629     MOVE EN-AH-ORIG-CP          TO OUT-ORIG-CRIT-PER
  5630                                    OUT-ORIG-MAX-PMTS
  5631     IF EN-AH-ORIG-BENCD EQUAL '00' OR SPACES
  5632         MOVE SPACES             TO OUT-ORIG-MAX-PMTS-A
  5633     END-IF
  5634     MOVE EN-INS-NEW-LAST-NAME    TO OUT-NEW-ILNAME
  5635     MOVE EN-INS-NEW-FIRST-NAME   TO OUT-NEW-IFNAME
  5636     MOVE EN-INS-NEW-MIDDLE-INIT  TO OUT-NEW-IMINIT
  5637     MOVE EN-INS-NEW-AGE          TO OUT-NEW-IAGE
  5638     MOVE EN-JNT-NEW-LAST-NAME    TO OUT-NEW-JLNAME
  5639     MOVE EN-JNT-NEW-FIRST-NAME   TO OUT-NEW-JFNAME
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* NSRASBL.cbl
  5640     MOVE EN-JNT-NEW-MIDDLE-INIT  TO OUT-NEW-JMINIT
  5641     MOVE EN-JNT-NEW-AGE          TO OUT-NEW-JAGE
  5642     MOVE EN-LF-NEW-BENCD        TO WS-LF-BENCD
  5643     MOVE EN-AH-NEW-BENCD        TO WS-AH-BENCD
  5644     PERFORM 1130-MATCH-BENCDS   THRU 1130-EXIT
  5645     MOVE WS-LF-DESC             TO OUT-NEW-LF-DESC
  5646     IF WS-LF-EARN = 'B'
  5647        MOVE 'B'                 TO OUT-BALLOON-IND
  5648     END-IF
  5649     MOVE WS-AH-DESC             TO OUT-NEW-AH-DESC
  5650     MOVE WS-RET-ELIM            TO OUT-NEW-RET-ELIM
  5651     MOVE WS-BEN-DAYS            TO OUT-NEW-BEN-DAYS
  5652     MOVE WS-WAIT-PER            TO OUT-NEW-WAIT-PER
  5653     MOVE EN-LF-NEW-BENCD         TO OUT-NEW-LF-BENCD
  5654     MOVE EN-LF-NEW-TERM          TO OUT-NEW-LF-TERM
  5655     MOVE EN-LF-NEW-BEN-AMT       TO OUT-NEW-LF-BEN
  5656     MOVE EN-LF-NEW-PRM-AMT       TO OUT-NEW-LF-PRM
  5657     MOVE EN-LF-NEW-ALT-BEN-AMT   TO OUT-NEW-LF-ALT-BEN
  5658     MOVE EN-LF-NEW-ALT-PRM-AMT   TO OUT-NEW-LF-ALT-PRM
  5659     IF EN-LF-NEW-BENCD EQUAL '00' OR SPACES
  5660         MOVE SPACES             TO OUT-NEW-LF-BEN-A
  5661                                    OUT-NEW-LF-PRM-A
  5662                                    OUT-NEW-LF-ALT-BEN-A
  5663                                    OUT-NEW-LF-ALT-PRM-A
  5664     END-IF
  5665    MOVE EN-LF-NEW-EXP-DT        TO DC-BIN-DATE-1
  5666     MOVE ' '                     TO DC-OPTION-CODE
  5667     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  5668     IF NO-CONVERSION-ERROR
  5669        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5670           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5671              INTO OUT-NEW-LF-EXP-DT
  5672        END-STRING
  5673     END-IF
  5674     MOVE EN-AH-NEW-BENCD         TO OUT-NEW-AH-BENCD
  5675     MOVE EN-AH-NEW-TERM          TO OUT-NEW-AH-TERM
  5676     MOVE EN-AH-NEW-BEN-AMT       TO OUT-NEW-AH-BEN
  5677     MOVE EN-AH-NEW-PRM-AMT       TO OUT-NEW-AH-PRM
  5678     COMPUTE WS-WORK-PREM =
  5679        EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT
  5680           + EN-AH-NEW-PRM-AMT
  5681     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-PREM
  5682     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
  5683         MOVE SPACES             TO OUT-NEW-AH-BEN-A
  5684                                    OUT-NEW-AH-PRM-A
  5685     END-IF
  5686     MOVE EN-AH-NEW-EXP-DT        TO DC-BIN-DATE-1
  5687     MOVE ' '                     TO DC-OPTION-CODE
  5688     PERFORM 9700-DATE-LINK       THRU 9700-EXIT
  5689     IF NO-CONVERSION-ERROR
  5690        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  5691           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  5692              INTO OUT-NEW-AH-EXP-DT
  5693        END-STRING
  5694     END-IF
  5695     MOVE EN-AH-NEW-CP            TO OUT-NEW-CRIT-PER
  5696                                     OUT-NEW-MAX-PMTS
  5697     IF EN-AH-NEW-BENCD EQUAL '00' OR SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* NSRASBL.cbl
  5698         MOVE SPACES             TO OUT-NEW-MAX-PMTS-A
  5699     END-IF
  5700     IF EN-LF-ORIG-EXP-DT > EN-AH-ORIG-EXP-DT
  5701        MOVE OUT-ORIG-LF-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  5702     ELSE
  5703        MOVE OUT-ORIG-AH-EXP-DT  TO OUT-ORIG-SCHED-EXP-DT
  5704     END-IF
  5705     IF EN-LF-NEW-EXP-DT > EN-AH-NEW-EXP-DT
  5706        MOVE OUT-NEW-LF-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  5707     ELSE
  5708        MOVE OUT-NEW-AH-EXP-DT   TO OUT-NEW-SCHED-EXP-DT
  5709     END-IF
  5710     IF EN-LF-ORIG-TERM > EN-AH-ORIG-TERM
  5711        MOVE EN-LF-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  5712     ELSE
  5713        MOVE EN-AH-ORIG-TERM     TO OUT-ORIG-SCHED-TERM
  5714     END-IF
  5715     IF EN-LF-NEW-TERM > EN-AH-NEW-TERM
  5716        MOVE EN-LF-NEW-TERM      TO OUT-NEW-SCHED-TERM
  5717     ELSE
  5718        MOVE EN-AH-NEW-TERM      TO OUT-NEW-SCHED-TERM
  5719     END-IF
  5720     COMPUTE WS-WORK-PREM =
  5721        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  5722        EN-AH-NEW-PRM-AMT) -
  5723        (EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT +
  5724        EN-AH-ORIG-PRM-AMT)
  5725     MOVE WS-WORK-PREM           TO OUT-TOT-PRM-CHG
  5726     IF EN-CSO-PORTION NOT NUMERIC
  5727        MOVE ZEROS               TO EN-CSO-PORTION
  5728     END-IF
  5729     IF EN-ACCT-PORTION NOT NUMERIC
  5730        MOVE ZERO                TO EN-ACCT-PORTION
  5731     END-IF
  5732     MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  5733     MOVE EN-ACCT-PORTION        TO OUT-ACT-PORTION
  5734     IF WS-WORK-PREM >= +0
  5735        MOVE 'CSO'               TO OUT-PAYEE
  5736     ELSE
  5737        MOVE 'ACCT'              TO OUT-PAYEE
  5738     END-IF
  5739     move en-sig-sw              to out-sig-sw
  5740     MOVE EN-HEALTH-APP          TO OUT-HEALTH-APP
  5741     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  5742     GO TO 0620-CONTINUE
  5743     .
  5744 0620-PROCESS-CANCEL.
  5745*    MOVE EN-LF-ORIG-REF-DT      TO DC-BIN-DATE-1
  5746*    MOVE ' '                    TO DC-OPTION-CODE
  5747*    PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5748*    IF NO-CONVERSION-ERROR
  5749*       MOVE DC-GREG-DATE-A-EDIT TO OUT-ORIG-LF-CAN-DT
  5750*    END-IF
  5751*
  5752*    MOVE EN-LF-NEW-REF-DT       TO DC-BIN-DATE-1
  5753*    MOVE ' '                    TO DC-OPTION-CODE
  5754*    PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5755*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* NSRASBL.cbl
  5756*       MOVE DC-GREG-DATE-A-EDIT TO OUT-NEW-LF-CAN-DT
  5757*    END-IF
  5758*
  5759*    MOVE EN-AH-ORIG-REF-DT      TO DC-BIN-DATE-1
  5760*    MOVE ' '                    TO DC-OPTION-CODE
  5761*    PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5762*    IF NO-CONVERSION-ERROR
  5763*       MOVE DC-GREG-DATE-A-EDIT TO OUT-ORIG-AH-CAN-DT
  5764*    END-IF
  5765*
  5766*    MOVE EN-AH-NEW-REF-DT       TO DC-BIN-DATE-1
  5767*    MOVE ' '                    TO DC-OPTION-CODE
  5768*    PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5769*    IF NO-CONVERSION-ERROR
  5770*       MOVE DC-GREG-DATE-A-EDIT TO OUT-NEW-AH-CAN-DT
  5771*    END-IF
  5772     MOVE EN-LF-ORIG-REF-AMT     TO OUT-ORIG-LF-REF
  5773     MOVE EN-AH-ORIG-REF-AMT     TO OUT-ORIG-AH-REF
  5774     MOVE EN-LF-NEW-REF-AMT      TO OUT-NEW-LF-REF
  5775     MOVE EN-AH-NEW-REF-AMT      TO OUT-NEW-AH-REF
  5776     COMPUTE WS-WORK-PREM =
  5777        EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT
  5778     MOVE WS-WORK-PREM           TO OUT-ORIG-TOT-REF
  5779     COMPUTE WS-WORK-PREM =
  5780        EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT
  5781     MOVE WS-WORK-PREM           TO OUT-NEW-TOT-REF
  5782     COMPUTE WS-WORK-PREM =
  5783        (EN-LF-NEW-REF-AMT + EN-AH-NEW-REF-AMT) -
  5784        (EN-LF-ORIG-REF-AMT + EN-AH-ORIG-REF-AMT)
  5785     MOVE WS-WORK-PREM           TO OUT-TOT-REF-CHG
  5786     MOVE EN-CSO-PORTION         TO OUT-CSO-PORTION
  5787     MOVE EN-ACCT-PORTION        TO OUT-ACT-PORTION
  5788     MOVE EN-COMM-CHGBK          TO OUT-CHGBACK
  5789     .
  5790 0620-CONTINUE.
  5791     display ' about to bld reason codes ' en-reason-code (1)
  5792     move en-reason-code (1)     to out-rea-cd1
  5793     move en-reason-code (2)     to out-rea-cd2
  5794     move en-reason-code (3)     to out-rea-cd3
  5795     move en-reason-code (4)     to out-rea-cd4
  5796     move en-reason-code (5)     to out-rea-cd5
  5797     move en-reason-code (6)     to out-rea-cd6
  5798     move en-reason-code (7)     to out-rea-cd7
  5799     move en-reason-code (8)     to out-rea-cd8
  5800     move en-reason-code (9)     to out-rea-cd9
  5801     move en-reason-code (10)    to out-rea-cd10
  5802     move en-reason-code (11)    to out-rea-cd11
  5803     move en-reason-code (12)    to out-rea-cd12
  5804*    PERFORM 1300-DETERMINE-COMM
  5805*                                THRU 1300-EXIT
  5806     .
  5807 0620-EXIT.
  5808     EXIT.
  5809 0650-PROCESS-NO-Change.
  5810     IF EN-REC-TYPE = 'C'
  5811        GO TO 0650-PROCESS-CANCEL
  5812     END-IF
  5813     if ((OUT-NEW-ILNAME = OUT-ORIG-ILNAME)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* NSRASBL.cbl
  5814        AND (OUT-NEW-ILNAME NOT = SPACES))
  5815                      AND
  5816        ((OUT-NEW-IFNAME = OUT-ORIG-IFNAME)
  5817        AND (OUT-NEW-IFNAME NOT = SPACES))
  5818                      AND
  5819        ((OUT-NEW-IMINIT = OUT-ORIG-MINIT)
  5820        AND (OUT-NEW-IFNAME NOT = SPACES))
  5821        move 'No Change'         to out-new-Ifname
  5822        MOVE SPACES              TO OUT-NEW-IMINIT
  5823        move spaces              to out-new-Ilname
  5824     ELSE
  5825         IF OUT-NEW-ILNAME = SPACES
  5826           AND OUT-NEW-IFNAME = SPACES
  5827           AND OUT-NEW-IMINIT = SPACES
  5828           AND OUT-ORIG-ILNAME NOT = SPACES
  5829            MOVE 'None'          TO OUT-NEW-IFNAME
  5830            MOVE SPACES          TO OUT-NEW-IMINIT
  5831            MOVE SPACES          TO OUT-NEW-ILNAME
  5832         END-IF
  5833     END-IF
  5834     IF ((OUT-NEW-JLNAME = OUT-ORIG-JLNAME)
  5835        AND (OUT-NEW-JLNAME NOT = SPACES))
  5836                    AND
  5837        ((OUT-NEW-JFNAME = OUT-ORIG-JFNAME)
  5838        AND (OUT-NEW-JFNAME NOT = SPACES))
  5839                    AND
  5840        ((OUT-NEW-JMINIT = OUT-ORIG-JMINIT)
  5841        AND (OUT-NEW-JFNAME NOT = SPACES))
  5842        MOVE 'No Change'         TO OUT-NEW-JFNAME
  5843        MOVE SPACES              TO OUT-NEW-JMINIT
  5844        MOVE SPACES              TO OUT-NEW-JLNAME
  5845     ELSE
  5846         IF OUT-NEW-JLNAME = SPACES
  5847           AND OUT-NEW-JFNAME = SPACES
  5848           AND OUT-NEW-JMINIT = SPACES
  5849           AND OUT-ORIG-JLNAME NOT = SPACES
  5850            MOVE 'None'          TO OUT-NEW-JFNAME
  5851            MOVE SPACES          TO OUT-NEW-JMINIT
  5852            MOVE SPACES          TO OUT-NEW-JLNAME
  5853         END-IF
  5854     END-IF
  5855     IF (EN-LF-NEW-BEN-AMT = EN-LF-ORIG-BEN-AMT)
  5856        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  5857        MOVE 'No Change'         TO OUT-NEW-LF-BEN-A
  5858     ELSE
  5859         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  5860           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  5861             MOVE ZEROS          TO OUT-NEW-LF-BEN
  5862         END-IF
  5863     END-IF
  5864     IF (EN-LF-NEW-PRM-AMT = EN-LF-ORIG-PRM-AMT)
  5865        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  5866        MOVE 'No Change'         TO OUT-NEW-LF-PRM-A
  5867     ELSE
  5868         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  5869           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  5870             MOVE ZEROS          TO OUT-NEW-LF-PRM
  5871         END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* NSRASBL.cbl
  5872     END-IF
  5873     IF (EN-LF-NEW-ALT-BEN-AMT = EN-LF-ORIG-ALT-BEN-AMT)
  5874        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  5875        MOVE 'No Change'         TO OUT-NEW-LF-ALT-BEN-A
  5876     ELSE
  5877         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  5878           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  5879             MOVE ZEROS          TO OUT-NEW-LF-ALT-BEN
  5880         END-IF
  5881     END-IF
  5882     IF (EN-LF-NEW-ALT-PRM-AMT = EN-LF-ORIG-ALT-PRM-AMT)
  5883        AND (EN-LF-NEW-BENCD NOT EQUAL '00' AND SPACES)
  5884        MOVE 'No Change'         TO OUT-NEW-LF-ALT-PRM-A
  5885     ELSE
  5886         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  5887           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  5888             MOVE ZEROS          TO OUT-NEW-LF-ALT-PRM
  5889         END-IF
  5890     END-IF
  5891     IF OUT-NEW-SCHED-EXP-DT = OUT-ORIG-SCHED-EXP-DT
  5892        MOVE 'No Change'         TO OUT-NEW-SCHED-EXP-DT
  5893     END-IF
  5894     IF (OUT-NEW-LF-EXP-DT = OUT-ORIG-LF-EXP-DT)
  5895        AND (OUT-NEW-LF-EXP-DT NOT = SPACES)
  5896        MOVE 'No Change'         TO OUT-NEW-LF-EXP-DT
  5897     END-IF
  5898     IF (OUT-NEW-LF-DESC = OUT-ORIG-LF-DESC)
  5899        AND (OUT-NEW-LF-DESC NOT = SPACES)
  5900        MOVE 'No Change'         to OUT-NEW-LF-DESC
  5901     ELSE
  5902        IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  5903          AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  5904            MOVE 'None'          TO OUT-NEW-LF-DESC
  5905        END-IF
  5906     end-if
  5907     IF (OUT-NEW-AH-EXP-DT = OUT-ORIG-AH-EXP-DT)
  5908       AND (OUT-NEW-AH-EXP-DT NOT = SPACES)
  5909        MOVE 'No Change'          TO OUT-NEW-AH-EXP-DT
  5910     END-IF
  5911     IF (EN-AH-NEW-BEN-AMT = EN-AH-ORIG-BEN-AMT)
  5912        AND (EN-AH-ORIG-BEN-AMT NOT = ZEROS)
  5913        MOVE 'No Change'         TO OUT-NEW-AH-BEN-A
  5914     ELSE
  5915         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  5916           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  5917             MOVE ZEROS          TO OUT-NEW-AH-BEN
  5918         END-IF
  5919     END-IF
  5920     IF (EN-AH-NEW-PRM-AMT = EN-AH-ORIG-PRM-AMT)
  5921        AND (EN-AH-ORIG-PRM-AMT NOT = ZEROS)
  5922        MOVE 'No Change'         TO OUT-NEW-AH-PRM-A
  5923     ELSE
  5924         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  5925           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  5926             MOVE ZEROS          TO OUT-NEW-AH-PRM
  5927         END-IF
  5928     END-IF
  5929     IF (OUT-NEW-AH-DESC = OUT-ORIG-AH-DESC)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* NSRASBL.cbl
  5930        AND (OUT-ORIG-AH-DESC NOT = SPACES)
  5931        MOVE 'No Change'         TO OUT-NEW-AH-DESC
  5932     ELSE
  5933         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  5934           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  5935             MOVE 'None'         TO OUT-NEW-AH-DESC
  5936         END-IF
  5937     END-IF
  5938     IF EN-INS-NEW-AGE = EN-INS-ORIG-AGE
  5939        MOVE 'No Change'         TO OUT-NEW-IAGE-A
  5940     END-IF
  5941     IF (EN-JNT-NEW-AGE = EN-JNT-ORIG-AGE)
  5942        AND (EN-JNT-ORIG-AGE NOT = ZEROS)
  5943        MOVE 'No Change'         TO OUT-NEW-JAGE-A
  5944     ELSE
  5945         IF (EN-JNT-ORIG-AGE NOT = ZEROS AND SPACES)
  5946           AND (EN-JNT-NEW-AGE = ZEROS OR SPACES)
  5947             MOVE 'None'         TO OUT-NEW-JAGE-A
  5948         END-IF
  5949     END-IF
  5950     IF (EN-LF-NEW-TERM = EN-LF-ORIG-TERM)
  5951        AND (EN-LF-ORIG-TERM NOT = ZEROS)
  5952        MOVE 'No Change'         TO OUT-NEW-LF-TERM-A
  5953     ELSE
  5954         IF (EN-LF-ORIG-BENCD NOT = '00' AND SPACES)
  5955           AND (EN-LF-NEW-BENCD = '00' OR SPACES)
  5956             MOVE ZEROS          TO OUT-NEW-LF-TERM
  5957         END-IF
  5958     END-IF
  5959     IF (EN-AH-NEW-TERM = EN-AH-ORIG-TERM)
  5960        AND (EN-AH-ORIG-TERM NOT = ZEROS)
  5961        MOVE 'No Change'         TO OUT-NEW-AH-TERM-A
  5962     ELSE
  5963         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  5964           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  5965             MOVE ZEROS          TO OUT-NEW-AH-TERM
  5966         END-IF
  5967     END-IF
  5968     IF (EN-AH-NEW-CP = EN-AH-ORIG-CP)
  5969        AND (EN-AH-NEW-BENCD NOT EQUAL '00' AND SPACES)
  5970        MOVE 'No Change'         TO OUT-NEW-CRIT-PER-A
  5971                                    OUT-NEW-MAX-PMTS-A
  5972     ELSE
  5973         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  5974           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
  5975             MOVE 'None'         TO OUT-NEW-CRIT-PER-A
  5976                                    OUT-NEW-MAX-PMTS-A
  5977         END-IF
  5978     END-IF
  5979     IF OUT-NEW-SCHED-TERM = OUT-ORIG-SCHED-TERM
  5980        MOVE 'No Change'         TO OUT-NEW-SCHED-TERM-A
  5981     END-IF
  5982     IF (OUT-NEW-WAIT-PER = OUT-ORIG-WAIT-PER)
  5983       AND (OUT-ORIG-WAIT-PER NOT = SPACES)
  5984         MOVE 'No Change'        TO OUT-NEW-WAIT-PER
  5985     ELSE
  5986         IF (EN-AH-ORIG-BENCD NOT = '00' AND SPACES)
  5987           AND (EN-AH-NEW-BENCD = '00' OR SPACES)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* NSRASBL.cbl
  5988             MOVE 'None'         TO OUT-NEW-WAIT-PER
  5989         END-IF
  5990     END-IF
  5991     .
  5992 0650-PROCESS-CANCEL.
  5993     .
  5994 0650-EXIT.
  5995     EXIT.
  5996 0700-WRITE-EXTR.
  5997     display ' made it to 0700 '
  5998     PERFORM 1000-BUILD-ERARCH   THRU 1000-EXIT
  5999     IF BL-FAIL
  6000        MOVE ' COULDNT BUILD ERARCH ' TO BL-MESSAGE
  6001        GO TO 0700-EXIT
  6002     END-IF
  6003     MOVE WS-COMPANY-CD          TO NSAS-COMPANY-CD
  6004     MOVE BL-ARCHIVE-NO          TO NSAS-ARCHIVE-NO
  6005     MOVE +0                     TO NSAS-SEQ-NO
  6006     PERFORM 0710-BUILD-NSASEXTR THRU 0710-EXIT
  6007     PERFORM 0720-WRITE-NSASEXTR THRU 0720-EXIT
  6008     IF BL-FAIL
  6009        MOVE ' COULDNT BUILD STD NSASEXTR ' TO BL-MESSAGE
  6010        GO TO 0700-EXIT
  6011     END-IF
  6012     IF W-LETTER-TO-ACCT NOT = SPACES
  6013        display ' acct ne spaces ' bl-archive-no
  6014        MOVE W-LETTER-TO-ACCT   TO NSAS-LETTER-VARIABLES (5:1)
  6015        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  6016        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  6017        MOVE +1                  TO NSAS-SEQ-NO
  6018        PERFORM 0720-WRITE-NSASEXTR
  6019                                 THRU 0720-EXIT
  6020        IF BL-FAIL
  6021           MOVE ' COULDNT BUILD ACCT NSASEXTR ' TO BL-MESSAGE
  6022           GO TO 0700-EXIT
  6023        END-IF
  6024     END-IF
  6025     IF W-LETTER-TO-BENE NOT = SPACES
  6026        display ' bene ne spaces ' bl-archive-no
  6027        MOVE W-LETTER-TO-BENE   TO NSAS-LETTER-VARIABLES (5:1)
  6028        MOVE WS-COMPANY-CD       TO NSAS-COMPANY-CD
  6029        MOVE BL-ARCHIVE-NO       TO NSAS-ARCHIVE-NO
  6030        MOVE +2                  TO NSAS-SEQ-NO
  6031        PERFORM 0720-WRITE-NSASEXTR
  6032                                 THRU 0720-EXIT
  6033        IF BL-FAIL
  6034           MOVE ' COULDNT BUILD BENE NSASEXTR ' TO BL-MESSAGE
  6035        END-IF
  6036     END-IF
  6037     IF W-PRINT-CERTIFICATE = 'Y' AND
  6038        BL-STATE = 'VA'
  6039           MOVE OUT-ACCT-NAME       TO VD-ACCOUNT-NAME
  6040           MOVE WS-COMPANY-CD       TO VD-COMPANY-CD
  6041           MOVE BL-CARRIER          TO VD-CARRIER
  6042           MOVE BL-GROUP            TO VD-GROUPING
  6043           MOVE BL-STATE            TO VD-STATE
  6044           MOVE BL-ACCOUNT          TO VD-ACCOUNT
  6045           MOVE WS-ELCERT-EFF-DT    TO VD-CERT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* NSRASBL.cbl
  6046           MOVE BL-CERT-NO          TO VD-CERT-NO
  6047           MOVE OUT-ILNAME          TO VD-INSURED-LAST-NAME
  6048           MOVE OUT-IFNAME          TO VD-INSURED-FIRST-NAME
  6049           MOVE OUT-IMINIT          TO VD-INSURED-MIDDLE-INIT
  6050           MOVE OUT-JLNAME          TO VD-JOINT-LAST-NAME
  6051           MOVE OUT-JFNAME          TO VD-JOINT-FIRST-NAME
  6052           MOVE OUT-JMINIT          TO VD-JOINT-MIDDLE-INIT
  6053           MOVE OUT-BENE-NAME       TO VD-BENEFICIARY-NAME
  6054           MOVE OUT-ENTRY-BATCH     TO VD-ENTRY-BATCH
  6055           MOVE OUT-CSR-CODE        TO VD-CSR-ID
  6056           MOVE CM-LF-BENEFIT-CD    TO VD-LF-BENEFIT-CD
  6057           MOVE CM-LF-PREMIUM-AMT   TO VD-LF-PREMIUM-AMT
  6058           MOVE CM-LF-BENEFIT-AMT   TO VD-LF-BENEFIT-AMT
  6059           MOVE CM-LF-ORIG-TERM     TO VD-LF-TERM
  6060           MOVE CM-LF-PREMIUM-RATE  TO VD-LF-RATE
  6061           MOVE CM-AH-BENEFIT-CD    TO VD-AH-BENEFIT-CD
  6062           MOVE CM-AH-PREMIUM-AMT   TO VD-AH-PREMIUM-AMT
  6063           MOVE CM-AH-BENEFIT-AMT   TO VD-AH-BENEFIT-AMT
  6064           MOVE CM-AH-ORIG-TERM     TO VD-AH-TERM
  6065           MOVE CM-AH-PREMIUM-RATE  TO VD-AH-RATE
  6066           MOVE CM-LOAN-TERM        TO VD-LOAN-TERM
  6067           MOVE CM-LOAN-APR         TO VD-LOAN-APR
  6068           MOVE CM-LOAN-1ST-PMT-DT  TO VD-1ST-PMT-DT
  6069           MOVE OUT-INS-ADDR1       TO VD-INSURED-ADDRESS-1
  6070           MOVE OUT-INS-ADDR2       TO VD-INSURED-ADDRESS-2
  6071           MOVE OUT-INS-CITY        TO VD-INSURED-CITY
  6072           MOVE OUT-INS-STATE       TO VD-INSURED-STATE
  6073           MOVE OUT-INS-ZIP         TO VD-INSURED-ZIP-CODE
  6074           MOVE 'VADS'              TO VD-LETTER-ID
  6075           MOVE OUT-PROC-ID         TO VD-PROC-ID
  6076           MOVE BL-COMP-ID          TO VD-COMP-ID
  6077           MOVE EIBTIME             TO VD-CURRENT-TIME
  6078           MOVE SAVE-BIN-DATE       TO VD-CURRENT-DATE
  6079           MOVE BL-ARCHIVE-NO       TO VD-ARCHIVE-NO
  6080           MOVE VIRGINIA-DISCLOSURE TO WS-PASS-VADS-REC
  6081
  6082* EXEC CICS LINK
  6083*              PROGRAM    (LINK-ELVADS)
  6084*              COMMAREA   (WS-PASS-AREA)
  6085*              LENGTH     (WS-PASS-AREA-LENGTH)
  6086*          END-EXEC
  6087*    MOVE '."C                   ''   #00006027' TO DFHEIV0
  6088     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6089     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6090     MOVE X'2020233030303036303237' TO DFHEIV0(25:11)
  6091     CALL 'kxdfhei1' USING DFHEIV0,
  6092           LINK-ELVADS,
  6093           WS-PASS-AREA,
  6094           WS-PASS-AREA-LENGTH,
  6095           DFHEIV99,
  6096           DFHEIV99,
  6097           DFHEIV99
  6098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6099     END-IF
  6100     .
  6101 0700-EXIT.
  6102     EXIT.
  6103  0710-BUILD-NSASEXTR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* NSRASBL.cbl
  6104***  i added the extra space in front of the 1st ~
  6105***  only because there may be a letter to acct or bene
  6106     STRING
  6107         OUT-LETTER             ' ~'
  6108         OUT-PROC-ID            '~'
  6109         OUT-PROC-NAME          '~'
  6110         OUT-PROC-TITLE         '~'
  6111         OUT-CSR-NAME           '~'
  6112         OUT-CSR-TITLE          '~'
  6113         OUT-CARRIER            '~'
  6114         OUT-GROUPING           '~'
  6115         OUT-STATE              '~'
  6116         OUT-ACCOUNT            '~'
  6117         OUT-CERT-EFF-DT        '~'
  6118         OUT-CERT-NO            '~'
  6119         OUT-CERT-SFX           '~'
  6120         OUT-ILNAME             '~'
  6121         OUT-IFNAME             '~'
  6122         OUT-IFINIT             '~'
  6123         OUT-IMINIT             '~'
  6124         OUT-IAGE               '~'
  6125         OUT-ISEX               '~'
  6126         OUT-INS-ADDR1          '~'
  6127         OUT-INS-ADDR2          '~'
  6128         OUT-INS-CITY           '~'
  6129         OUT-INS-STATE          '~'
  6130         OUT-INS-ZIP            '~'
  6131         OUT-SOC-SEC-NO         '~'
  6132         OUT-MEMBER-NO          '~'
  6133         OUT-JLNAME             '~'
  6134         OUT-JFNAME             '~'
  6135         OUT-JMINIT             '~'
  6136         OUT-JAGE               '~'
  6137         OUT-ACCT-NAME          '~'
  6138         OUT-ACCT-ADDR1         '~'
  6139         OUT-ACCT-ADDR2         '~'
  6140         OUT-ACCT-CITY          '~'
  6141         OUT-ACCT-STATE         '~'
  6142         OUT-ACCT-ZIP           '~'
  6143         OUT-ACCT-PHONE         '~'
  6144         OUT-ACCT-CNTRL-NAME    '~'
  6145         OUT-ACCT-BUS-TYPE      '~'
  6146         OUT-BENE-NAME          '~'
  6147         OUT-BENE-ADDR1         '~'
  6148         OUT-BENE-ADDR2         '~'
  6149         OUT-BENE-CITY          '~'
  6150         OUT-BENE-STATE         '~'
  6151         OUT-BENE-ZIP           '~'
  6152         OUT-CARR-NAME          '~'
  6153         OUT-RESP-NO            '~'
  6154         OUT-COMP-NAME          '~'
  6155         OUT-COMP-MAIL-TO       '~'
  6156         OUT-COMP-ADDR1         '~'
  6157         OUT-COMP-ADDR2         '~'
  6158         OUT-COMP-CITY          '~'
  6159         OUT-COMP-STATE         '~'
  6160         OUT-COMP-ZIP           '~'
  6161         OUT-COMP-PHONE         '~'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* NSRASBL.cbl
  6162         OUT-COMP-FAX           '~'
  6163         OUT-COMP-STATUS        '~'
  6164         OUT-BILL-SW            '~'
  6165         OUT-RPT-CD1            '~'
  6166         OUT-RPT-CD2            '~'
  6167         OUT-ENTRY-DT           '~'
  6168         OUT-ENTRY-BATCH        '~'
  6169         OUT-ENTRY-STATUS       '~'
  6170         OUT-1ST-PMT-DT         '~'
  6171         OUT-LOAN-APR           '~'
  6172         OUT-LOAN-TERM          '~'
  6173         OUT-RATE-CLASS         '~'
  6174         OUT-EXT-DAYS           '~'
  6175         OUT-CSR-CODE           '~'
  6176         OUT-UCODE              '~'
  6177         OUT-PREM-TYPE          '~'
  6178         OUT-IND-GRP            '~'
  6179         OUT-SKIP-CD            '~'
  6180         OUT-PMT-MODE           '~'
  6181         OUT-LOAN-OFF           '~'
  6182         OUT-REIN-TABLE         '~'
  6183         OUT-SPEC-REIN          '~'
  6184         OUT-LF-BENCD           '~'
  6185         OUT-LF-TERM            '~'
  6186         OUT-LF-DEV-CD          '~'
  6187         OUT-LF-DEV-PCT         '~'
  6188         OUT-LF-BEN             '~'
  6189         OUT-LF-PRM             '~'
  6190         OUT-LF-ALT-BEN         '~'
  6191         OUT-LF-ALT-PRM         '~'
  6192         OUT-LF-NSP             '~'
  6193         OUT-LF-REM-BEN         '~'
  6194         OUT-LF-REF             '~'
  6195         OUT-LF-DTH             '~'
  6196         OUT-LF-RATE            '~'
  6197         OUT-LF-ALT-RATE        '~'
  6198         OUT-LF-EXP-DT          '~'
  6199         OUT-LF-CUR-STATUS      '~'
  6200         OUT-LF-CAN-DT          '~'
  6201         OUT-LF-CAN-EXIT-DT     '~'
  6202         OUT-LF-DTH-DT          '~'
  6203         OUT-LF-DTH-EXIT-DT     '~'
  6204         OUT-LF-EXIT-BATCH      '~'
  6205         OUT-LF-COMM-PCT        '~'
  6206         OUT-LF-DESC            '~'
  6207         OUT-LF-ABBRV           '~'
  6208         OUT-AH-BENCD           '~'
  6209         OUT-AH-TERM            '~'
  6210         OUT-CRIT-PER           '~'
  6211         OUT-AH-DEV-CD          '~'
  6212         OUT-AH-DEV-PCT         '~'
  6213         OUT-AH-BEN             '~'
  6214         OUT-AH-PRM             '~'
  6215         OUT-AH-NSP             '~'
  6216         OUT-AH-REF             '~'
  6217         OUT-AH-CLM             '~'
  6218         OUT-AH-TOT-BEN         '~'
  6219         OUT-AH-PDTHRU-DT       '~'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* NSRASBL.cbl
  6220         OUT-AH-RATE            '~'
  6221         OUT-AH-EXP-DT          '~'
  6222         OUT-AH-CUR-STATUS      '~'
  6223         OUT-AH-CAN-DT          '~'
  6224         OUT-AH-CAN-EXIT-DT     '~'
  6225         OUT-AH-EXIT-BATCH      '~'
  6226         OUT-AH-COMM-PCT        '~'
  6227         OUT-AH-DESC            '~'
  6228         OUT-RET-ELIM           '~'
  6229         OUT-BEN-DAYS           '~'
  6230         OUT-WAIT-PER           '~'
  6231         OUT-MAX-PMTS           '~'
  6232         OUT-TOT-PRM            '~'
  6233         OUT-TOT-REF            '~'
  6234         OUT-SCHED-EXP-DT       '~'
  6235         OUT-SCHED-TERM         '~'
  6236         OUT-ORIG-ILNAME        '~'
  6237         OUT-ORIG-IFNAME        '~'
  6238         OUT-ORIG-MINIT         '~'
  6239         OUT-ORIG-IAGE          '~'
  6240         OUT-ORIG-JLNAME        '~'
  6241         OUT-ORIG-JFNAME        '~'
  6242         OUT-ORIG-JMINIT        '~'
  6243         OUT-ORIG-JAGE          '~'
  6244         OUT-ORIG-LF-BENCD      '~'
  6245         OUT-ORIG-LF-TERM       '~'
  6246         OUT-ORIG-LF-BEN        '~'
  6247         OUT-ORIG-LF-PRM        '~'
  6248         OUT-LF-CALC-PRM        '~'
  6249         OUT-ORIG-LF-REF        '~'
  6250         OUT-LF-CALC-REF        '~'
  6251         OUT-ORIG-LF-ALT-BEN    '~'
  6252         OUT-ORIG-LF-ALT-PRM    '~'
  6253         OUT-ORIG-LF-EXP-DT     '~'
  6254         OUT-ORIG-LF-DESC       '~'
  6255         OUT-ORIG-AH-BENCD      '~'
  6256         OUT-ORIG-AH-TERM       '~'
  6257         OUT-ORIG-CRIT-PER      '~'
  6258         OUT-ORIG-AH-BEN        '~'
  6259         OUT-ORIG-AH-PRM        '~'
  6260         OUT-AH-CALC-PRM        '~'
  6261         OUT-ORIG-AH-REF        '~'
  6262         OUT-AH-CALC-REF        '~'
  6263         OUT-ORIG-AH-EXP-DT     '~'
  6264         OUT-ORIG-AH-DESC       '~'
  6265         OUT-ORIG-RET-ELIM      '~'
  6266         OUT-ORIG-BEN-DAYS      '~'
  6267         OUT-ORIG-WAIT-PER      '~'
  6268         OUT-ORIG-MAX-PMTS      '~'
  6269         OUT-ORIG-SCHED-EXP-DT  '~'
  6270         OUT-ORIG-SCHED-TERM    '~'
  6271         OUT-NEW-ILNAME         '~'
  6272         OUT-NEW-IFNAME         '~'
  6273         OUT-NEW-IMINIT         '~'
  6274         OUT-NEW-IAGE           '~'
  6275         OUT-NEW-JLNAME         '~'
  6276         OUT-NEW-JFNAME         '~'
  6277         OUT-NEW-JMINIT         '~'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* NSRASBL.cbl
  6278         OUT-NEW-JAGE           '~'
  6279         OUT-NEW-LF-BENCD       '~'
  6280         OUT-NEW-LF-TERM        '~'
  6281         OUT-NEW-LF-BEN         '~'
  6282         OUT-NEW-LF-PRM         '~'
  6283         OUT-NEW-LF-REF         '~'
  6284         OUT-NEW-LF-ALT-BEN     '~'
  6285         OUT-NEW-LF-ALT-PRM     '~'
  6286         OUT-NEW-LF-EXP-DT      '~'
  6287         OUT-NEW-LF-DESC        '~'
  6288         OUT-NEW-AH-BENCD       '~'
  6289         OUT-NEW-AH-TERM        '~'
  6290         OUT-NEW-CRIT-PER       '~'
  6291         OUT-NEW-AH-BEN         '~'
  6292         OUT-NEW-AH-PRM         '~'
  6293         OUT-NEW-AH-REF         '~'
  6294         OUT-NEW-AH-EXP-DT      '~'
  6295         OUT-NEW-AH-DESC        '~'
  6296         OUT-NEW-RET-ELIM       '~'
  6297         OUT-NEW-BEN-DAYS       '~'
  6298         OUT-NEW-WAIT-PER       '~'
  6299         OUT-NEW-MAX-PMTS       '~'
  6300         OUT-NEW-SCHED-EXP-DT   '~'
  6301         OUT-NEW-SCHED-TERM     '~'
  6302         OUT-TOT-PRM-CHG        '~'
  6303         OUT-TOT-REF-CHG        '~'
  6304         OUT-PAYEE              '~'
  6305         OUT-SIG-SW             '~'
  6306         OUT-BALLOON-IND        '~'
  6307         OUT-LEASE-IND          '~'
  6308         OUT-RESCIND            '~'
  6309         OUT-REA-CD1            '~'
  6310         OUT-REA-CD2            '~'
  6311         OUT-REA-CD3            '~'
  6312         OUT-REA-CD4            '~'
  6313         OUT-REA-CD5            '~'
  6314         OUT-REA-CD6            '~'
  6315         OUT-REA-CD7            '~'
  6316         OUT-REA-CD8            '~'
  6317         OUT-REA-CD9            '~'
  6318         OUT-REA-CD10           '~'
  6319         OUT-REA-CD11           '~'
  6320         OUT-REA-CD12           '~'
  6321         OUT-CYCLE-DT           '~'
  6322         OUT-ARCH-NO            '~'
  6323         OUT-FORM               '~'
  6324         OUT-ENC-LINE           '~'
  6325         OUT-ATTACH             '~'
  6326         OUT-STACK              '~'
  6327         OUT-STATE-NAME         '~'
  6328         OUT-PRINT-NOW          '~'
  6329         OUT-CHGBACK            '~'
  6330         OUT-CSO-PORTION        '~'
  6331         OUT-ACT-PORTION        '~'
  6332         W-LETTER-TYPE          '~'
  6333         W-PRINT-CERTIFICATE    '~'
  6334         WS-INS-BIRTH-DATE      '~'
  6335         WS-JNT-BIRTH-DATE      '~'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* NSRASBL.cbl
  6336         WS-NH-INT              '~'
  6337         OUT-ORIG-TOT-PREM      '~'
  6338         OUT-ORIG-TOT-REF       '~'
  6339         OUT-CANCEL-DT          '~'
  6340         OUT-HEALTH-APP         '~'
  6341         WS-CERT-FORM-ID        '~'
  6342         OUT-UNDW-ID            '~'
  6343         OUT-NEW-TOT-PREM       '~'
  6344         OUT-NEW-TOT-REF        '~'
  6345            DELIMITED BY '   ' INTO NSAS-LETTER-VARIABLES
  6346     END-STRING
  6347     .
  6348 0710-exit.
  6349     EXIT.
  6350 0720-WRITE-NSASEXTR.
  6351
  6352* EXEC CICS WRITE
  6353*       DATASET    ('NSASEXTR')
  6354*       FROM       (NSAS-EXTRACT-RECORD)
  6355*       RIDFLD     (NSAS-CONTROL-PRIMARY)
  6356*       RESP       (WS-RESPONSE)
  6357*    END-EXEC
  6358     MOVE LENGTH OF
  6359      NSAS-EXTRACT-RECORD
  6360       TO DFHEIV11
  6361     MOVE 'NSASEXTR' TO DFHEIV1
  6362*    MOVE '&$ L                  ''  N#00006284' TO DFHEIV0
  6363     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6364     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6365     MOVE X'204E233030303036323834' TO DFHEIV0(25:11)
  6366     CALL 'kxdfhei1' USING DFHEIV0,
  6367           DFHEIV1,
  6368           NSAS-EXTRACT-RECORD,
  6369           DFHEIV11,
  6370           NSAS-CONTROL-PRIMARY,
  6371           DFHEIV99,
  6372           DFHEIV99
  6373     MOVE EIBRESP  TO WS-RESPONSE
  6374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6375     IF NOT RESP-NORMAL
  6376        display ' bad write nsasextr ' ws-response
  6377        SET BL-FAIL TO TRUE
  6378     END-IF
  6379     .
  6380 0720-EXIT.
  6381     EXIT.
  6382 0800-init-out-data.
  6383     MOVE ZEROS                  TO OUT-IAGE
  6384                                    OUT-JAGE
  6385                                    OUT-LOAN-APR
  6386                                    OUT-LOAN-TERM
  6387                                    OUT-EXT-DAYS
  6388                                    OUT-LF-TERM
  6389                                    OUT-AH-TERM
  6390                                    OUT-LF-DEV-PCT
  6391                                    OUT-AH-DEV-PCT
  6392                                    OUT-LF-BEN
  6393                                    OUT-AH-BEN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* NSRASBL.cbl
  6394                                    OUT-CRIT-PER
  6395                                    OUT-MAX-PMTS
  6396                                    OUT-SCHED-TERM
  6397                                    OUT-ORIG-IAGE
  6398                                    OUT-ORIG-JAGE
  6399                                    OUT-NEW-IAGE
  6400                                    OUT-NEW-JAGE
  6401                                    OUT-ORIG-LF-TERM
  6402                                    OUT-ORIG-AH-TERM
  6403                                    OUT-NEW-LF-TERM
  6404                                    OUT-NEW-AH-TERM
  6405                                    OUT-ORIG-CRIT-PER
  6406                                    OUT-ORIG-MAX-PMTS
  6407                                    OUT-ORIG-SCHED-TERM
  6408                                    OUT-NEW-SCHED-TERM
  6409                                    OUT-NEW-CRIT-PER
  6410                                    OUT-NEW-MAX-PMTS
  6411                                    OUT-CSO-PORTION
  6412                                    OUT-ACT-PORTION
  6413     .
  6414 0800-exit.
  6415     exit.
  6416 1000-BUILD-ERARCH.
  6417* DATA SOURCE MEANINGS  BL-DATA-SRCE
  6418*    1) FROM ACCT MAINT
  6419*    2) FROM CERT UPDATE
  6420*    3) FROM COMP MAINT
  6421*    4) FROM REVIEW AND CORRECTIONS
  6422******************************************************************
  6423     MOVE 'LA'                   TO LETTER-ARCHIVE
  6424     MOVE BL-ARCHIVE-NO          TO LA-ARCHIVE-NO
  6425                                    LA-ARCHIVE-NO-A2
  6426                                    LA-ARCHIVE-NO-A3
  6427                                    LA-ARCHIVE-NO-A4
  6428                                    LA-ARCHIVE-NO-A5
  6429                                    LA-ARCHIVE-NO-A6
  6430     MOVE WS-COMPANY-CD          TO LA-COMPANY-CD
  6431                                    LA-COMPANY-CD-A2
  6432                                    LA-COMPANY-CD-A3
  6433                                    LA-COMPANY-CD-A4
  6434                                    LA-COMPANY-CD-A5
  6435                                    LA-COMPANY-CD-A6
  6436     MOVE BL-CARRIER             TO LA-CARRIER-A2
  6437                                    LA-CARRIER-A3
  6438                                    LA-CARRIER-A4
  6439                                    LA-CARRIER-A5
  6440     MOVE BL-GROUP               TO LA-GROUPING-A2
  6441                                    LA-GROUPING-A3
  6442                                    LA-GROUPING-A4
  6443                                    LA-GROUPING-A5
  6444     MOVE BL-ACCOUNT             TO LA-ACCOUNT-A2
  6445                                    LA-ACCOUNT-A3
  6446                                    LA-ACCOUNT-A4
  6447                                    LA-ACCOUNT-A5
  6448     MOVE BL-STATE               TO LA-STATE-A2
  6449                                    LA-STATE-A3
  6450                                    LA-STATE-A4
  6451                                    LA-STATE-A5
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* NSRASBL.cbl
  6452     IF BL-DATA-SRCE = '2' OR '4'
  6453        MOVE WS-ELCERT-EFF-DT    TO LA-EFFECT-DATE-A2
  6454        MOVE BL-CERT-NO          TO LA-CERT-NO-A2
  6455     ELSE
  6456        MOVE LOW-VALUES          TO LA-EFFECT-DATE-A2
  6457     END-IF
  6458     IF BL-DATA-SRCE = '4'
  6459        MOVE BL-BATCH-NO         TO LA-ENTRY-A6
  6460     END-IF
  6461     MOVE BL-PROC-ID             TO LA-PROCESSOR-CD
  6462                                    LA-LAST-UPDATED-BY
  6463     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  6464                                    LA-INITIAL-PRINT-DATE
  6465                                    LA-SENT-DATE
  6466                                    LA-REPLY-DATE
  6467                                    LA-RESEND-DATE
  6468                                    LA-FOLLOW-UP-DATE
  6469     MOVE 'A'                    TO LA-STATUS
  6470     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  6471     MOVE W-FORM-TO-RESEND       TO LA-RESEND-LETR
  6472     IF W-DAYS-TO-RESEND NOT NUMERIC
  6473        MOVE ZEROS               TO W-DAYS-TO-RESEND
  6474     END-IF
  6475     IF W-DAYS-TO-RESEND > ZEROS
  6476        MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  6477        MOVE W-DAYS-TO-RESEND  TO DC-ELAPSED-DAYS
  6478        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  6479        MOVE '6'                 TO DC-OPTION-CODE
  6480        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  6481        IF NO-CONVERSION-ERROR
  6482           MOVE DC-BIN-DATE-2    TO LA-RESEND-DATE
  6483        END-IF
  6484     END-IF
  6485     IF W-DAYS-TO-FOLLOW-UP >= ZEROS
  6486        MOVE SAVE-BIN-DATE       TO DC-BIN-DATE-1
  6487        MOVE W-DAYS-TO-FOLLOW-UP TO DC-ELAPSED-DAYS
  6488        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  6489        MOVE '6'                 TO DC-OPTION-CODE
  6490        PERFORM 9700-DATE-LINK THRU 9700-EXIT
  6491        IF NO-CONVERSION-ERROR
  6492           MOVE DC-BIN-DATE-2    TO LA-FOLLOW-UP-DATE
  6493        END-IF
  6494     END-IF
  6495
  6496     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  6497     MOVE BL-LETTER-ID           TO LA-FORM-A3
  6498     MOVE BL-DATA-SRCE           TO LA-DATA-SOURCE
  6499     MOVE BL-WRITE-ERARCH        TO LA-ARCHIVE-STATUS
  6500     MOVE SAVE-BIN-DATE          TO LA-CREATION-DATE
  6501                                    LA-LAST-MAINT-DATE
  6502     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  6503                                    LA-NO-OF-TEXT-RECORDS
  6504     MOVE EIBTIME                TO LA-LAST-MAINT-TIME
  6505
  6506* EXEC CICS WRITE
  6507*         DATASET   ('ERARCH')
  6508*         FROM      (LETTER-ARCHIVE)
  6509*         RIDFLD    (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* NSRASBL.cbl
  6510*         RESP      (WS-RESPONSE)
  6511*    END-EXEC
  6512     MOVE LENGTH OF
  6513      LETTER-ARCHIVE
  6514       TO DFHEIV11
  6515     MOVE 'ERARCH' TO DFHEIV1
  6516*    MOVE '&$ L                  ''  N#00006420' TO DFHEIV0
  6517     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6518     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6519     MOVE X'204E233030303036343230' TO DFHEIV0(25:11)
  6520     CALL 'kxdfhei1' USING DFHEIV0,
  6521           DFHEIV1,
  6522           LETTER-ARCHIVE,
  6523           DFHEIV11,
  6524           LA-CONTROL-PRIMARY,
  6525           DFHEIV99,
  6526           DFHEIV99
  6527     MOVE EIBRESP  TO WS-RESPONSE
  6528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6529     IF NOT RESP-NORMAL
  6530        DISPLAY ' BAD WRITE ON ERARCH ' WS-RESPONSE ' '
  6531        la-archive-no
  6532        SET BL-FAIL TO TRUE
  6533     END-IF
  6534     .
  6535 1000-EXIT.
  6536     EXIT.
  6537 1025-GET-CSR-INFO.
  6538     MOVE WS-CSR-ID              TO OUT-CSR-CODE
  6539                                    OUT-CSR-TITLE
  6540                                    OUT-PROC-TITLE
  6541                                    OUT-UNDW-ID
  6542     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  6543     MOVE '2'                    TO WS-ELCNTL-REC-TYPE
  6544     MOVE WS-CSR-ID              TO WS-ELCNTL-GENL
  6545     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  6546
  6547* EXEC CICS READ
  6548*       INTO    (CONTROL-FILE)
  6549*       DATASET ('ELCNTL')
  6550*       RIDFLD  (WS-ELCNTL-KEY)
  6551*       RESP    (WS-RESPONSE)
  6552*    END-EXEC
  6553     MOVE LENGTH OF
  6554      CONTROL-FILE
  6555       TO DFHEIV11
  6556     MOVE 'ELCNTL' TO DFHEIV1
  6557*    MOVE '&"IL       E          (  N#00006443' TO DFHEIV0
  6558     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6559     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6560     MOVE X'204E233030303036343433' TO DFHEIV0(25:11)
  6561     CALL 'kxdfhei1' USING DFHEIV0,
  6562           DFHEIV1,
  6563           CONTROL-FILE,
  6564           DFHEIV11,
  6565           WS-ELCNTL-KEY,
  6566           DFHEIV99,
  6567           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* NSRASBL.cbl
  6568           DFHEIV99
  6569     MOVE EIBRESP  TO WS-RESPONSE
  6570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6571     IF RESP-NORMAL
  6572        MOVE CF-PROCESSOR-NAME   TO OUT-CSR-NAME
  6573                                    OUT-PROC-NAME
  6574*       MOVE CF-PROCESSOR-TITLE  TO OUT-CSR-TITLE
  6575*                                   OUT-PROC-TITLE
  6576     END-IF
  6577     IF BL-PROC-ID NOT = PB-CSR-ID
  6578        MOVE BL-COMP-ID          TO WS-ELCNTL-KEY
  6579        MOVE '2'                 TO WS-ELCNTL-REC-TYPE
  6580        MOVE BL-PROC-ID          TO WS-ELCNTL-GENL
  6581                                    OUT-PROC-TITLE
  6582        MOVE +0                  TO WS-ELCNTL-SEQ-NO
  6583
  6584* EXEC CICS READ
  6585*          INTO    (CONTROL-FILE)
  6586*          DATASET ('ELCNTL')
  6587*          RIDFLD  (WS-ELCNTL-KEY)
  6588*          RESP    (WS-RESPONSE)
  6589*       END-EXEC
  6590     MOVE LENGTH OF
  6591      CONTROL-FILE
  6592       TO DFHEIV11
  6593     MOVE 'ELCNTL' TO DFHEIV1
  6594*    MOVE '&"IL       E          (  N#00006461' TO DFHEIV0
  6595     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6596     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6597     MOVE X'204E233030303036343631' TO DFHEIV0(25:11)
  6598     CALL 'kxdfhei1' USING DFHEIV0,
  6599           DFHEIV1,
  6600           CONTROL-FILE,
  6601           DFHEIV11,
  6602           WS-ELCNTL-KEY,
  6603           DFHEIV99,
  6604           DFHEIV99,
  6605           DFHEIV99
  6606     MOVE EIBRESP  TO WS-RESPONSE
  6607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6608        IF RESP-NORMAL
  6609           MOVE CF-PROCESSOR-NAME   TO OUT-PROC-NAME
  6610*          MOVE CF-PROCESSOR-TITLE  TO OUT-PROC-TITLE
  6611        END-IF
  6612     END-IF
  6613     .
  6614 1025-EXIT.
  6615     EXIT.
  6616 1050-GET-ERMAIL.
  6617     MOVE CM-CONTROL-PRIMARY     TO WS-ERMAIL-KEY
  6618
  6619* EXEC CICS READ
  6620*         DATASET    ('ERMAIL')
  6621*         INTO       (MAILING-DATA)
  6622*         RIDFLD     (WS-ERMAIL-KEY)
  6623*         RESP       (WS-RESPONSE)
  6624*    END-EXEC
  6625     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* NSRASBL.cbl
  6626      MAILING-DATA
  6627       TO DFHEIV11
  6628     MOVE 'ERMAIL' TO DFHEIV1
  6629*    MOVE '&"IL       E          (  N#00006477' TO DFHEIV0
  6630     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6631     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6632     MOVE X'204E233030303036343737' TO DFHEIV0(25:11)
  6633     CALL 'kxdfhei1' USING DFHEIV0,
  6634           DFHEIV1,
  6635           MAILING-DATA,
  6636           DFHEIV11,
  6637           WS-ERMAIL-KEY,
  6638           DFHEIV99,
  6639           DFHEIV99,
  6640           DFHEIV99
  6641     MOVE EIBRESP  TO WS-RESPONSE
  6642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6643     IF RESP-NORMAL
  6644        MOVE MA-ADDRESS-LINE-1   TO OUT-INS-ADDR1
  6645        MOVE MA-ADDRESS-LINE-2   TO OUT-INS-ADDR2
  6646        MOVE MA-CITY             TO OUT-INS-CITY
  6647        MOVE MA-ADDR-STATE       TO OUT-INS-STATE
  6648        MOVE MA-ZIP              TO OUT-INS-ZIP
  6649        MOVE MA-CRED-BENE-NAME   TO OUT-BENE-NAME
  6650        MOVE MA-CRED-BENE-ADDR   TO OUT-BENE-ADDR1
  6651        MOVE MA-CRED-BENE-ADDR2  TO OUT-BENE-ADDR2
  6652        MOVE MA-CRED-BENE-CITY   TO OUT-BENE-CITY
  6653        MOVE MA-CRED-BENE-STATE  TO OUT-BENE-STATE
  6654        MOVE MA-CRED-BENE-ZIP    TO OUT-BENE-ZIP
  6655        IF MA-INSURED-BIRTH-DT NOT = LOW-VALUES AND SPACES
  6656           MOVE MA-INSURED-BIRTH-DT
  6657                                 TO DC-BIN-DATE-1
  6658           MOVE ' '              TO DC-OPTION-CODE
  6659           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  6660           IF NO-CONVERSION-ERROR
  6661              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6662                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6663                INTO WS-INS-BIRTH-DATE
  6664              END-STRING
  6665           END-IF
  6666        END-IF
  6667        IF MA-JOINT-BIRTH-DT NOT = LOW-VALUES AND SPACES
  6668           MOVE MA-JOINT-BIRTH-DT
  6669                                 TO DC-BIN-DATE-1
  6670           MOVE ' '              TO DC-OPTION-CODE
  6671           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  6672           IF NO-CONVERSION-ERROR
  6673              STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6674                DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6675                INTO WS-JNT-BIRTH-DATE
  6676              END-STRING
  6677           END-IF
  6678        END-IF
  6679     END-IF
  6680     .
  6681 1050-EXIT.
  6682     EXIT.
  6683 1100-GET-ELCERT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* NSRASBL.cbl
  6684
  6685* EXEC CICS READ
  6686*         DATASET    ('ELCERT')
  6687*         INTO       (CERTIFICATE-MASTER)
  6688*         RIDFLD     (WS-ELCERT-KEY)
  6689*         RESP       (WS-RESPONSE)
  6690*    END-EXEC.
  6691     MOVE LENGTH OF
  6692      CERTIFICATE-MASTER
  6693       TO DFHEIV11
  6694     MOVE 'ELCERT' TO DFHEIV1
  6695*    MOVE '&"IL       E          (  N#00006524' TO DFHEIV0
  6696     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6697     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6698     MOVE X'204E233030303036353234' TO DFHEIV0(25:11)
  6699     CALL 'kxdfhei1' USING DFHEIV0,
  6700           DFHEIV1,
  6701           CERTIFICATE-MASTER,
  6702           DFHEIV11,
  6703           WS-ELCERT-KEY,
  6704           DFHEIV99,
  6705           DFHEIV99,
  6706           DFHEIV99
  6707     MOVE EIBRESP  TO WS-RESPONSE
  6708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6709
  6710     IF RESP-NORMAL
  6711        SET CERT-FOUND TO TRUE
  6712        PERFORM 1110-BUILD-CERT  THRU 1110-EXIT
  6713        PERFORM 1050-GET-ERMAIL  THRU 1050-EXIT
  6714     END-IF
  6715     .
  6716 1100-EXIT.
  6717     EXIT.
  6718 1110-BUILD-CERT.
  6719     MOVE CM-CARRIER             TO OUT-CARRIER
  6720     MOVE CM-GROUPING            TO OUT-GROUPING
  6721     MOVE CM-STATE               TO OUT-STATE
  6722     MOVE CM-ACCOUNT             TO OUT-ACCOUNT
  6723     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  6724     MOVE ' '                    TO DC-OPTION-CODE
  6725     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6726     IF NO-CONVERSION-ERROR
  6727        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6728           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6729              INTO OUT-CERT-EFF-DT
  6730        END-STRING
  6731     END-IF
  6732     MOVE CM-CERT-NO             TO OUT-CERT-NO
  6733     MOVE CM-INSURED-LAST-NAME   TO OUT-ILNAME
  6734                                    OUT-ORIG-ILNAME
  6735     MOVE CM-INSURED-INITIAL1    TO OUT-IFINIT
  6736     MOVE CM-INSURED-INITIAL2    TO OUT-IMINIT
  6737                                    OUT-ORIG-MINIT
  6738     IF (CM-SSN-STATE = CM-STATE)
  6739        AND (CM-SSN-ACCOUNT = CM-ACCOUNT (5:6))
  6740        MOVE SPACES              TO OUT-SOC-SEC-NO
  6741     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* NSRASBL.cbl
  6742        MOVE CM-SOC-SEC-NO       TO OUT-SOC-SEC-NO
  6743     END-IF
  6744     IF (CM-MEMB-STATE = CM-STATE)
  6745        AND (CM-MEMB-ACCOUNT = CM-ACCOUNT (5:6))
  6746        MOVE SPACES              TO OUT-MEMBER-NO
  6747     ELSE
  6748        MOVE CM-MEMBER-NO        TO OUT-MEMBER-NO
  6749     END-IF
  6750     MOVE CM-INSURED-FIRST-NAME  TO OUT-IFNAME
  6751                                    OUT-ORIG-IFNAME
  6752     MOVE CM-INSURED-ISSUE-AGE   TO OUT-IAGE
  6753                                    OUT-ORIG-IAGE
  6754     MOVE CM-INSURED-SEX         TO OUT-ISEX
  6755     MOVE CM-INSURED-JOINT-AGE   TO OUT-JAGE
  6756                                    OUT-ORIG-JAGE
  6757     MOVE CM-JT-LAST-NAME        TO OUT-JLNAME
  6758                                    OUT-ORIG-JLNAME
  6759     MOVE CM-JT-FIRST-NAME       TO OUT-JFNAME
  6760                                    OUT-ORIG-JFNAME
  6761     MOVE CM-JT-INITIAL          TO OUT-JMINIT
  6762                                    OUT-ORIG-JMINIT
  6763     MOVE CM-LF-BENEFIT-CD       TO OUT-LF-BENCD
  6764                                    OUT-ORIG-LF-BENCD
  6765     MOVE CM-LF-ORIG-TERM        TO OUT-LF-TERM
  6766                                    OUT-ORIG-LF-TERM
  6767     MOVE CM-LF-DEV-CODE         TO OUT-LF-DEV-CD
  6768     IF CM-LF-DEV-PCT NOT NUMERIC
  6769        MOVE ZEROS               TO CM-LF-DEV-PCT
  6770     END-IF
  6771     MOVE CM-LF-DEV-PCT          TO OUT-LF-DEV-PCT
  6772     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  6773        IF (PB-C-LF-CANCEL-DT = LOW-VALUES OR SPACES) AND
  6774          (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  6775             MOVE SPACES          TO OUT-LF-BENCD
  6776                                     OUT-LF-CAN-DT
  6777             MOVE ZEROS           TO OUT-LF-TERM
  6778                                     OUT-LF-BEN
  6779                                     OUT-LF-PRM
  6780                                     OUT-LF-ALT-BEN
  6781                                     OUT-LF-ALT-PRM
  6782                                     OUT-LF-COMM-PCT
  6783                                     OUT-LF-NSP
  6784                                     OUT-LF-REM-BEN
  6785                                     WS-WORK-LF-PREM
  6786                                     OUT-LF-REF
  6787                                     OUT-ORIG-LF-REF
  6788                                     WS-WORK-LF-REF
  6789             MOVE LOW-VALUES      TO OUT-LF-EXP-DT
  6790             GO TO 1100-LF-CONT
  6791        END-IF
  6792     END-IF
  6793     MOVE CM-LF-BENEFIT-AMT      TO OUT-LF-BEN
  6794                                    OUT-ORIG-LF-BEN
  6795     MOVE CM-LF-PREMIUM-AMT      TO OUT-LF-PRM
  6796                                    OUT-ORIG-LF-PRM
  6797                                    WS-WORK-LF-PREM
  6798     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
  6799        MOVE ZEROS               TO CM-LF-ALT-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* NSRASBL.cbl
  6800     END-IF
  6801     MOVE CM-LF-ALT-BENEFIT-AMT  TO OUT-LF-ALT-BEN
  6802                                    OUT-ORIG-LF-ALT-BEN
  6803     IF CM-LF-ALT-PREMIUM-AMT NOT NUMERIC
  6804        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-AMT
  6805     END-IF
  6806     MOVE CM-LF-ALT-PREMIUM-AMT  TO OUT-LF-ALT-PRM
  6807                                    OUT-ORIG-LF-ALT-PRM
  6808     ADD CM-LF-ALT-PREMIUM-AMT   TO WS-WORK-LF-PREM
  6809     IF CM-LF-NSP-PREMIUM-AMT NOT NUMERIC
  6810        MOVE ZEROS               TO CM-LF-NSP-PREMIUM-AMT
  6811     END-IF
  6812     MOVE CM-LF-NSP-PREMIUM-AMT  TO OUT-LF-NSP
  6813     MOVE CM-LF-REMAINING-AMT    TO OUT-LF-REM-BEN
  6814     MOVE CM-LF-ITD-CANCEL-AMT   TO OUT-LF-REF
  6815                                    OUT-ORIG-LF-REF
  6816                                    WS-WORK-LF-REF
  6817     IF CM-LF-DEATH-CLAIM-APPLIED
  6818        AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  6819            MOVE PB-C-LF-CANCEL-AMT TO OUT-LF-REF
  6820                                    OUT-ORIG-LF-REF
  6821                                    WS-WORK-LF-REF
  6822     END-IF
  6823     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
  6824     MOVE ' '                    TO DC-OPTION-CODE
  6825     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6826     IF NO-CONVERSION-ERROR
  6827        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6828           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6829              INTO OUT-LF-CAN-DT
  6830        END-STRING
  6831     END-IF
  6832      .
  6833 1100-LF-CONT.
  6834
  6835     MOVE CM-LF-ITD-DEATH-AMT    TO OUT-LF-DTH
  6836     IF CM-LF-PREMIUM-RATE NOT NUMERIC
  6837        MOVE ZEROS               TO CM-LF-PREMIUM-RATE
  6838     END-IF
  6839     MOVE CM-LF-PREMIUM-RATE     TO OUT-LF-RATE
  6840     IF CM-LF-ALT-PREMIUM-RATE NOT NUMERIC
  6841        MOVE ZEROS               TO CM-LF-ALT-PREMIUM-RATE
  6842     END-IF
  6843     MOVE CM-LF-ALT-PREMIUM-RATE TO OUT-LF-ALT-RATE
  6844     IF BL-DATA-SRCE = '4' AND PROCESS-CANCEL
  6845        IF (PB-C-AH-CANCEL-DT = LOW-VALUES OR SPACES) AND
  6846          (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  6847              MOVE SPACES              TO OUT-AH-BENCD
  6848                                          OUT-AH-CAN-DT
  6849              MOVE ZEROS               TO OUT-AH-TERM
  6850                                          OUT-AH-BEN
  6851                                          OUT-AH-PRM
  6852                                          OUT-AH-NSP
  6853                                          OUT-AH-COMM-PCT
  6854                                          OUT-CRIT-PER
  6855                                          WS-WORK-AH-PREM
  6856                                          OUT-AH-REF
  6857                                          OUT-ORIG-AH-REF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* NSRASBL.cbl
  6858                                          WS-WORK-AH-REF
  6859              MOVE SPACES              TO OUT-MAX-PMTS-A
  6860                                          OUT-WAIT-PER
  6861                                          OUT-RET-ELIM
  6862                                          OUT-AH-DESC
  6863                                          OUT-BEN-DAYS
  6864              MOVE LOW-VALUES          TO OUT-AH-EXP-DT
  6865             GO TO 1100-AH-CONT
  6866        END-IF
  6867     END-IF
  6868     MOVE CM-AH-BENEFIT-CD       TO OUT-AH-BENCD
  6869                                    OUT-ORIG-AH-BENCD
  6870     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  6871        COMPUTE OUT-AH-TOT-BEN = CM-AH-ORIG-TERM *
  6872           CM-AH-BENEFIT-AMT
  6873     ELSE
  6874        MOVE ZEROS               TO OUT-AH-TOT-BEN
  6875     END-IF
  6876     MOVE CM-AH-ORIG-TERM        TO OUT-AH-TERM
  6877                                    OUT-ORIG-AH-TERM
  6878     MOVE CM-AH-CRITICAL-PERIOD  TO OUT-CRIT-PER
  6879                                    OUT-ORIG-CRIT-PER
  6880                                    OUT-MAX-PMTS
  6881                                    OUT-ORIG-MAX-PMTS
  6882     IF CM-AH-BENEFIT-CD EQUAL '00' OR SPACES
  6883         MOVE SPACES             TO OUT-MAX-PMTS-A
  6884     END-IF
  6885     MOVE CM-AH-DEV-CODE         TO OUT-AH-DEV-CD
  6886     IF CM-AH-DEV-PCT NOT NUMERIC
  6887        MOVE ZEROS               TO CM-AH-DEV-PCT
  6888     END-IF
  6889     MOVE CM-AH-DEV-PCT          TO OUT-AH-DEV-PCT
  6890     MOVE CM-AH-BENEFIT-AMT      TO OUT-AH-BEN
  6891                                    OUT-ORIG-AH-BEN
  6892     MOVE CM-AH-PREMIUM-AMT      TO OUT-AH-PRM
  6893                                    OUT-ORIG-AH-PRM
  6894                                    WS-WORK-AH-PREM
  6895     MOVE CM-AH-NSP-PREMIUM-AMT  TO OUT-AH-NSP
  6896     MOVE CM-AH-ITD-CANCEL-AMT   TO OUT-AH-REF
  6897                                    OUT-ORIG-AH-REF
  6898                                    WS-WORK-AH-REF
  6899     IF CM-AH-DEATH-CLAIM-APPLIED
  6900        AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES OR SPACES)
  6901            MOVE PB-C-AH-CANCEL-AMT TO OUT-AH-REF
  6902                                    OUT-ORIG-AH-REF
  6903                                    WS-WORK-AH-REF
  6904     END-IF
  6905     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1
  6906     MOVE ' '                    TO DC-OPTION-CODE
  6907     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6908     IF NO-CONVERSION-ERROR
  6909        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6910           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6911              INTO OUT-AH-CAN-DT
  6912        END-STRING
  6913     END-IF
  6914      .
  6915 1100-AH-CONT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* NSRASBL.cbl
  6916
  6917     MOVE CM-AH-ITD-AH-PMT       TO OUT-AH-CLM
  6918     MOVE CM-AH-PAID-THRU-DT     TO DC-BIN-DATE-1
  6919     MOVE ' '                    TO DC-OPTION-CODE
  6920     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6921     IF NO-CONVERSION-ERROR
  6922        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6923           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6924              INTO OUT-AH-PDTHRU-DT
  6925        END-STRING
  6926     END-IF
  6927     IF CM-AH-PREMIUM-RATE NOT NUMERIC
  6928        MOVE ZEROS               TO CM-AH-PREMIUM-RATE
  6929     END-IF
  6930     MOVE CM-AH-PREMIUM-RATE     TO OUT-AH-RATE
  6931     IF CM-LOAN-APR NOT NUMERIC
  6932        MOVE ZEROS               TO CM-LOAN-APR
  6933     END-IF
  6934     MOVE CM-LOAN-APR            TO OUT-LOAN-APR
  6935     MOVE CM-LOAN-TERM           TO OUT-LOAN-TERM
  6936     MOVE CM-RATE-CLASS          TO OUT-RATE-CLASS
  6937     MOVE CM-PMT-EXTENSION-DAYS  TO OUT-EXT-DAYS
  6938     MOVE CM-UNDERWRITING-CODE   TO OUT-UCODE
  6939     MOVE CM-PREMIUM-TYPE        TO OUT-PREM-TYPE
  6940     MOVE CM-IND-GRP-TYPE        TO OUT-IND-GRP
  6941     MOVE CM-LOAN-OFFICER        TO OUT-LOAN-OFF
  6942     MOVE CM-REIN-TABLE          TO OUT-REIN-TABLE
  6943     MOVE CM-SPECIAL-REIN-CODE   TO OUT-SPEC-REIN
  6944     MOVE CM-LF-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  6945     MOVE ' '                    TO DC-OPTION-CODE
  6946     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6947     IF NO-CONVERSION-ERROR
  6948        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6949           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6950              INTO OUT-LF-EXP-DT
  6951        END-STRING
  6952     END-IF
  6953     MOVE OUT-LF-EXP-DT          TO OUT-ORIG-LF-EXP-DT
  6954     MOVE CM-AH-LOAN-EXPIRE-DT   TO DC-BIN-DATE-1
  6955     MOVE ' '                    TO DC-OPTION-CODE
  6956     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6957     IF NO-CONVERSION-ERROR
  6958        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6959           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6960              INTO OUT-AH-EXP-DT
  6961        END-STRING
  6962     END-IF
  6963     MOVE OUT-AH-EXP-DT          TO OUT-ORIG-AH-EXP-DT
  6964     MOVE CM-LOAN-1ST-PMT-DT     TO DC-BIN-DATE-1
  6965     MOVE ' '                    TO DC-OPTION-CODE
  6966     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6967     IF NO-CONVERSION-ERROR
  6968        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6969           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6970              INTO OUT-1ST-PMT-DT
  6971        END-STRING
  6972     END-IF
  6973     MOVE CM-ENTRY-STATUS        TO OUT-ENTRY-STATUS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* NSRASBL.cbl
  6974     MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
  6975     MOVE ' '                    TO DC-OPTION-CODE
  6976     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6977     IF NO-CONVERSION-ERROR
  6978        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6979           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6980              INTO OUT-ENTRY-DT
  6981        END-STRING
  6982     END-IF
  6983     MOVE CM-LF-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  6984     MOVE ' '                    TO DC-OPTION-CODE
  6985     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6986     IF NO-CONVERSION-ERROR
  6987        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6988           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6989              INTO OUT-LF-CAN-EXIT-DT
  6990        END-STRING
  6991     END-IF
  6992     MOVE CM-LF-DEATH-DT         TO DC-BIN-DATE-1
  6993     MOVE ' '                    TO DC-OPTION-CODE
  6994     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6995     IF NO-CONVERSION-ERROR
  6996        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  6997           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  6998              INTO OUT-LF-DTH-DT
  6999        END-STRING
  7000     END-IF
  7001     MOVE CM-LF-DEATH-EXIT-DT    TO DC-BIN-DATE-1
  7002     MOVE ' '                    TO DC-OPTION-CODE
  7003     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7004     IF NO-CONVERSION-ERROR
  7005        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7006           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7007              INTO OUT-LF-DTH-EXIT-DT
  7008        END-STRING
  7009     END-IF
  7010     MOVE CM-LF-CURRENT-STATUS   TO OUT-LF-CUR-STATUS
  7011     IF OUT-AH-CAN-DT NOT = SPACES
  7012        MOVE OUT-AH-CAN-DT       TO OUT-CANCEL-DT
  7013     ELSE
  7014        MOVE OUT-LF-CAN-DT       TO OUT-CANCEL-DT
  7015     END-IF
  7016     MOVE CM-AH-CANCEL-EXIT-DT   TO DC-BIN-DATE-1
  7017     MOVE ' '                    TO DC-OPTION-CODE
  7018     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  7019     IF NO-CONVERSION-ERROR
  7020        STRING DC-EDITA-CCYY '-' DC-EDITA-MONTH '-'
  7021           DC-EDITA-DAY ' 00:00:00.0' DELIMITED BY SIZE
  7022              INTO OUT-AH-CAN-EXIT-DT
  7023        END-STRING
  7024     END-IF
  7025     MOVE CM-AH-CURRENT-STATUS   TO OUT-AH-CUR-STATUS
  7026     IF CM-ENTRY-BATCH = LOW-VALUES
  7027        MOVE SPACES              TO CM-ENTRY-BATCH
  7028     END-IF
  7029     MOVE CM-ENTRY-BATCH         TO OUT-ENTRY-BATCH
  7030     IF CM-LF-EXIT-BATCH = LOW-VALUES
  7031        MOVE SPACES              TO CM-LF-EXIT-BATCH
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* NSRASBL.cbl
  7032     END-IF
  7033     MOVE CM-LF-EXIT-BATCH       TO OUT-LF-EXIT-BATCH
  7034     IF CM-AH-EXIT-BATCH = LOW-VALUES
  7035        MOVE SPACES              TO CM-AH-EXIT-BATCH
  7036     END-IF
  7037     MOVE CM-AH-EXIT-BATCH       TO OUT-AH-EXIT-BATCH
  7038     MOVE CM-LIFE-COMM-PCT       TO OUT-LF-COMM-PCT
  7039     MOVE CM-AH-COMM-PCT         TO OUT-AH-COMM-PCT
  7040     MOVE CM-CERT-SFX            TO OUT-CERT-SFX
  7041     MOVE CM-CONTROL-PRIMARY     TO MA-CONTROL-PRIMARY
  7042     COMPUTE WS-WORK-PREM =
  7043         WS-WORK-LF-PREM + WS-WORK-AH-PREM
  7044*        (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT
  7045*           + CM-AH-PREMIUM-AMT)
  7046     MOVE WS-WORK-PREM           TO OUT-TOT-PRM
  7047                                    OUT-ORIG-TOT-PREM
  7048     COMPUTE WS-WORK-REF =
  7049        (WS-WORK-LF-REF + WS-WORK-AH-REF)
  7050     MOVE WS-WORK-REF            TO OUT-TOT-REF
  7051                                    OUT-ORIG-TOT-REF
  7052     IF CM-LF-LOAN-EXPIRE-DT > CM-AH-LOAN-EXPIRE-DT
  7053        MOVE OUT-LF-EXP-DT       TO OUT-SCHED-EXP-DT
  7054     ELSE
  7055        MOVE OUT-AH-EXP-DT       TO OUT-SCHED-EXP-DT
  7056     END-IF
  7057     MOVE OUT-SCHED-EXP-DT       TO OUT-ORIG-SCHED-EXP-DT
  7058     IF CM-LF-ORIG-TERM > CM-AH-ORIG-TERM
  7059        MOVE CM-LF-ORIG-TERM     TO OUT-SCHED-TERM
  7060     ELSE
  7061        MOVE CM-AH-ORIG-TERM     TO OUT-SCHED-TERM
  7062     END-IF
  7063     MOVE OUT-SCHED-TERM         TO OUT-ORIG-SCHED-TERM
  7064     IF CM-NH-INT-ON-REFS NUMERIC
  7065        IF CM-NH-INT-ON-REFS NOT = ZEROS
  7066           MOVE CM-NH-INT-ON-REFS TO WS-NH-INT
  7067        END-IF
  7068     END-IF
  7069     .
  7070 1110-EXIT.
  7071     EXIT.
  7072 1115-MATCH-COMPANY.
  7073     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7074     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  7075     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7076
  7077* EXEC CICS READ
  7078*       INTO    (CONTROL-FILE)
  7079*       DATASET ('ELCNTL')
  7080*       RIDFLD  (WS-ELCNTL-KEY)
  7081*       RESP    (WS-RESPONSE)
  7082*    END-EXEC
  7083     MOVE LENGTH OF
  7084      CONTROL-FILE
  7085       TO DFHEIV11
  7086     MOVE 'ELCNTL' TO DFHEIV1
  7087*    MOVE '&"IL       E          (  N#00006896' TO DFHEIV0
  7088     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7089     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* NSRASBL.cbl
  7090     MOVE X'204E233030303036383936' TO DFHEIV0(25:11)
  7091     CALL 'kxdfhei1' USING DFHEIV0,
  7092           DFHEIV1,
  7093           CONTROL-FILE,
  7094           DFHEIV11,
  7095           WS-ELCNTL-KEY,
  7096           DFHEIV99,
  7097           DFHEIV99,
  7098           DFHEIV99
  7099     MOVE EIBRESP  TO WS-RESPONSE
  7100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7101     IF RESP-NORMAL
  7102        MOVE CF-COMPANY-CD       TO WS-COMPANY-CD
  7103     END-IF
  7104     .
  7105 1115-EXIT.
  7106     EXIT.
  7107 1120-MATCH-CARRIER.
  7108     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7109     MOVE '6'                    TO WS-ELCNTL-REC-TYPE
  7110     MOVE BL-CARRIER             TO WS-ELCNTL-CARR
  7111     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7112
  7113* EXEC CICS READ
  7114*       INTO    (CONTROL-FILE)
  7115*       DATASET ('ELCNTL')
  7116*       RIDFLD  (WS-ELCNTL-KEY)
  7117*       RESP    (WS-RESPONSE)
  7118*    END-EXEC
  7119     MOVE LENGTH OF
  7120      CONTROL-FILE
  7121       TO DFHEIV11
  7122     MOVE 'ELCNTL' TO DFHEIV1
  7123*    MOVE '&"IL       E          (  N#00006913' TO DFHEIV0
  7124     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7125     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7126     MOVE X'204E233030303036393133' TO DFHEIV0(25:11)
  7127     CALL 'kxdfhei1' USING DFHEIV0,
  7128           DFHEIV1,
  7129           CONTROL-FILE,
  7130           DFHEIV11,
  7131           WS-ELCNTL-KEY,
  7132           DFHEIV99,
  7133           DFHEIV99,
  7134           DFHEIV99
  7135     MOVE EIBRESP  TO WS-RESPONSE
  7136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7137     IF RESP-NORMAL
  7138        MOVE CF-MAIL-TO-NAME     TO OUT-CARR-NAME
  7139     ELSE
  7140        MOVE 'UNKNOWN'           TO OUT-CARR-NAME
  7141     END-IF
  7142     .
  7143 1120-EXIT.
  7144     EXIT.
  7145 1125-MATCH-STATE.
  7146     MOVE BL-STATE               TO OUT-STATE
  7147     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* NSRASBL.cbl
  7148     MOVE '3'                    TO WS-ELCNTL-REC-TYPE
  7149     MOVE BL-STATE               TO WS-ELCNTL-STATE
  7150     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7151
  7152* EXEC CICS READ
  7153*       INTO    (CONTROL-FILE)
  7154*       DATASET ('ELCNTL')
  7155*       RIDFLD  (WS-ELCNTL-KEY)
  7156*       RESP    (WS-RESPONSE)
  7157*    END-EXEC
  7158     MOVE LENGTH OF
  7159      CONTROL-FILE
  7160       TO DFHEIV11
  7161     MOVE 'ELCNTL' TO DFHEIV1
  7162*    MOVE '&"IL       E          (  N#00006933' TO DFHEIV0
  7163     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7164     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7165     MOVE X'204E233030303036393333' TO DFHEIV0(25:11)
  7166     CALL 'kxdfhei1' USING DFHEIV0,
  7167           DFHEIV1,
  7168           CONTROL-FILE,
  7169           DFHEIV11,
  7170           WS-ELCNTL-KEY,
  7171           DFHEIV99,
  7172           DFHEIV99,
  7173           DFHEIV99
  7174     MOVE EIBRESP  TO WS-RESPONSE
  7175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7176     IF RESP-NORMAL
  7177        MOVE CF-STATE-NAME       TO OUT-STATE-NAME
  7178     ELSE
  7179        MOVE 'UNKNOWN'           TO OUT-STATE-NAME
  7180     END-IF
  7181     .
  7182 1125-EXIT.
  7183     EXIT.
  7184 1130-MATCH-BENCDS.
  7185     MOVE SPACES                 TO WS-LF-ABBRV
  7186                                    WS-LF-DESC
  7187                                    WS-LF-EARN
  7188                                    WS-WAIT-PER
  7189                                    WS-RET-ELIM
  7190                                    WS-AH-DESC
  7191                                    WS-BEN-DAYS
  7192     IF WS-LF-BENCD NOT = ZEROS AND SPACES
  7193        PERFORM 1140-MATCH-LFBEN THRU 1140-EXIT
  7194     END-IF
  7195     IF WS-AH-BENCD NOT = ZEROS AND SPACES
  7196        PERFORM 1150-MATCH-AHBEN THRU 1150-EXIT
  7197     END-IF
  7198     .
  7199 1130-EXIT.
  7200     EXIT.
  7201 1140-MATCH-LFBEN.
  7202     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7203     MOVE '4'                    TO WS-ELCNTL-REC-TYPE
  7204     MOVE WS-LF-BENCD            TO WS-ELCNTL-BEN-CD
  7205     MOVE +0                     TO WS-ELCNTL-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* NSRASBL.cbl
  7206
  7207* EXEC CICS READ
  7208*       INTO    (CONTROL-FILE)
  7209*       DATASET ('ELCNTL')
  7210*       RIDFLD  (WS-ELCNTL-KEY)
  7211*       GTEQ
  7212*       RESP    (WS-RESPONSE)
  7213*    END-EXEC
  7214     MOVE LENGTH OF
  7215      CONTROL-FILE
  7216       TO DFHEIV11
  7217     MOVE 'ELCNTL' TO DFHEIV1
  7218*    MOVE '&"IL       G          (  N#00006969' TO DFHEIV0
  7219     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  7220     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7221     MOVE X'204E233030303036393639' TO DFHEIV0(25:11)
  7222     CALL 'kxdfhei1' USING DFHEIV0,
  7223           DFHEIV1,
  7224           CONTROL-FILE,
  7225           DFHEIV11,
  7226           WS-ELCNTL-KEY,
  7227           DFHEIV99,
  7228           DFHEIV99,
  7229           DFHEIV99
  7230     MOVE EIBRESP  TO WS-RESPONSE
  7231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7232     IF RESP-NORMAL
  7233        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7234           (WS-LF-BENCD = CF-BENEFIT-CODE (S1))
  7235           OR (S1 > +8)
  7236        END-PERFORM
  7237        IF S1 < + 9
  7238           MOVE CF-BENEFIT-ALPHA (S1)
  7239                                 TO WS-LF-ABBRV
  7240           MOVE WS-LF-BENCD      TO WS-LF-DESC
  7241           MOVE CF-CO-EARNINGS-CALC (S1)
  7242                                 TO WS-LF-EARN
  7243        ELSE
  7244           MOVE 'XX'             TO WS-LF-DESC
  7245           MOVE 'XXX'            TO WS-LF-ABBRV
  7246        END-IF
  7247     ELSE
  7248        DISPLAY ' NO LF BEN CD ' WS-LF-BENCD
  7249     END-IF
  7250     .
  7251 1140-EXIT.
  7252     EXIT.
  7253 1150-MATCH-AHBEN.
  7254     MOVE BL-COMP-ID             TO WS-ELCNTL-KEY
  7255     MOVE '5'                    TO WS-ELCNTL-REC-TYPE
  7256     MOVE WS-AH-BENCD            TO WS-ELCNTL-BEN-CD
  7257     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7258
  7259* EXEC CICS READ
  7260*       INTO    (CONTROL-FILE)
  7261*       DATASET ('ELCNTL')
  7262*       RIDFLD  (WS-ELCNTL-KEY)
  7263*       GTEQ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* NSRASBL.cbl
  7264*       RESP    (WS-RESPONSE)
  7265*    END-EXEC
  7266     MOVE LENGTH OF
  7267      CONTROL-FILE
  7268       TO DFHEIV11
  7269     MOVE 'ELCNTL' TO DFHEIV1
  7270*    MOVE '&"IL       G          (  N#00007002' TO DFHEIV0
  7271     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  7272     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7273     MOVE X'204E233030303037303032' TO DFHEIV0(25:11)
  7274     CALL 'kxdfhei1' USING DFHEIV0,
  7275           DFHEIV1,
  7276           CONTROL-FILE,
  7277           DFHEIV11,
  7278           WS-ELCNTL-KEY,
  7279           DFHEIV99,
  7280           DFHEIV99,
  7281           DFHEIV99
  7282     MOVE EIBRESP  TO WS-RESPONSE
  7283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7284     IF RESP-NORMAL
  7285        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7286           (WS-AH-BENCD = CF-BENEFIT-CODE (S1))
  7287           OR (S1 > +8)
  7288        END-PERFORM
  7289        IF S1 < + 9
  7290           MOVE CF-BENEFIT-ALPHA (S1)
  7291                                 TO WS-WAIT-PER
  7292           MOVE CF-BENEFIT-ALPHA (S1) (3:1)
  7293                                 TO WS-RET-ELIM
  7294           MOVE CF-BENEFIT-ALPHA (S1) (1:2)
  7295                                 TO WS-BEN-DAYS
  7296           IF CF-SPECIAL-CALC-CD (S1) = 'C'
  7297              IF CF-JOINT-INDICATOR (S1) = 'J'
  7298                 MOVE 'Joint Critical Period Disability'
  7299                                 TO WS-AH-DESC
  7300              ELSE
  7301                 MOVE 'Single Critical Period-Primary Only'
  7302                                 TO WS-AH-DESC
  7303              END-IF
  7304           ELSE
  7305              IF CF-JOINT-INDICATOR (S1) = 'J'
  7306                 MOVE 'Joint Disability'
  7307                                 TO WS-AH-DESC
  7308              ELSE
  7309                 MOVE 'Single Disability (Primary Only)'
  7310                                 TO WS-AH-DESC
  7311              END-IF
  7312           END-IF
  7313        ELSE
  7314           MOVE 'NOT FOUND'      TO WS-AH-DESC
  7315        END-IF
  7316     ELSE
  7317        DISPLAY ' NO AH BEN CD ' WS-AH-BENCD
  7318     END-IF
  7319     .
  7320 1150-EXIT.
  7321     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* NSRASBL.cbl
  7322 1200-GET-ERACCT.
  7323     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  7324     MOVE ' UNKNOWN '            TO OUT-ACCT-NAME
  7325                                    OUT-ACCT-ADDR1
  7326                                    OUT-ACCT-ADDR2
  7327                                    OUT-ACCT-CITY
  7328     MOVE ZEROS                  TO WS-CHGBACK
  7329
  7330* EXEC CICS STARTBR
  7331*        DATASET   ('ERACCT')
  7332*        RIDFLD    (WS-ERACCT-KEY)
  7333*        GTEQ
  7334*        RESP      (WS-RESPONSE)
  7335*    END-EXEC
  7336     MOVE 'ERACCT' TO DFHEIV1
  7337     MOVE 0
  7338       TO DFHEIV11
  7339*    MOVE '&,         G          &  N#00007054' TO DFHEIV0
  7340     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7341     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7342     MOVE X'204E233030303037303534' TO DFHEIV0(25:11)
  7343     CALL 'kxdfhei1' USING DFHEIV0,
  7344           DFHEIV1,
  7345           WS-ERACCT-KEY,
  7346           DFHEIV99,
  7347           DFHEIV11,
  7348           DFHEIV99
  7349     MOVE EIBRESP  TO WS-RESPONSE
  7350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7351     IF RESP-NORMAL
  7352
  7353* EXEC CICS READNEXT
  7354*          INTO    (ACCOUNT-MASTER)
  7355*          DATASET ('ERACCT')
  7356*          RIDFLD  (WS-ERACCT-KEY)
  7357*          RESP    (WS-RESPONSE)
  7358*       END-EXEC
  7359     MOVE LENGTH OF
  7360      ACCOUNT-MASTER
  7361       TO DFHEIV12
  7362     MOVE 'ERACCT' TO DFHEIV1
  7363     MOVE 0
  7364       TO DFHEIV11
  7365*    MOVE '&.IL                  )  N#00007061' TO DFHEIV0
  7366     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7367     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7368     MOVE X'204E233030303037303631' TO DFHEIV0(25:11)
  7369     CALL 'kxdfhei1' USING DFHEIV0,
  7370           DFHEIV1,
  7371           ACCOUNT-MASTER,
  7372           DFHEIV12,
  7373           WS-ERACCT-KEY,
  7374           DFHEIV99,
  7375           DFHEIV11,
  7376           DFHEIV99,
  7377           DFHEIV99
  7378     MOVE EIBRESP  TO WS-RESPONSE
  7379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* NSRASBL.cbl
  7380     END-IF
  7381     IF RESP-NORMAL
  7382        PERFORM UNTIL
  7383           NOT (RESP-NORMAL)
  7384           OR (WS-SAVE-ERACCT-KEY NOT =
  7385                        AM-CONTROL-PRIMARY (1:20))
  7386           IF BL-DATA-SRCE = '4' OR '2'
  7387              IF (CM-CERT-EFF-DT < AM-EXPIRATION-DT
  7388                 AND >= AM-EFFECTIVE-DT)
  7389                 PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7390                    (AM-COM-TYP (S1) = 'C' OR 'D')
  7391                    OR (S1 > +10)
  7392                 END-PERFORM
  7393                 IF S1 < +11
  7394                    MOVE AM-COMM-CHARGEBACK (S1)
  7395                                 TO WS-CHGBACK
  7396                 END-IF
  7397              END-IF
  7398           END-IF
  7399           MOVE ACCOUNT-MASTER   TO WS-SAVE-ERACCT-REC
  7400
  7401* EXEC CICS READNEXT
  7402*             INTO    (ACCOUNT-MASTER)
  7403*             DATASET ('ERACCT')
  7404*             RIDFLD  (WS-ERACCT-KEY)
  7405*             RESP    (WS-RESPONSE)
  7406*          END-EXEC
  7407     MOVE LENGTH OF
  7408      ACCOUNT-MASTER
  7409       TO DFHEIV12
  7410     MOVE 'ERACCT' TO DFHEIV1
  7411     MOVE 0
  7412       TO DFHEIV11
  7413*    MOVE '&.IL                  )  N#00007087' TO DFHEIV0
  7414     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7415     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7416     MOVE X'204E233030303037303837' TO DFHEIV0(25:11)
  7417     CALL 'kxdfhei1' USING DFHEIV0,
  7418           DFHEIV1,
  7419           ACCOUNT-MASTER,
  7420           DFHEIV12,
  7421           WS-ERACCT-KEY,
  7422           DFHEIV99,
  7423           DFHEIV11,
  7424           DFHEIV99,
  7425           DFHEIV99
  7426     MOVE EIBRESP  TO WS-RESPONSE
  7427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7428        END-PERFORM
  7429        MOVE WS-SAVE-ERACCT-REC  TO ACCOUNT-MASTER
  7430        IF WS-SAVE-ERACCT-KEY = AM-CONTROL-PRIMARY (1:20)
  7431           SET ACCT-FOUND TO TRUE
  7432           MOVE AM-NAME          TO OUT-ACCT-NAME
  7433           MOVE AM-ADDRS         TO OUT-ACCT-ADDR1
  7434           MOVE SPACES           TO OUT-ACCT-ADDR2
  7435           MOVE AM-ADDR-CITY     TO OUT-ACCT-CITY
  7436           MOVE AM-ADDR-STATE    TO OUT-ACCT-STATE
  7437           MOVE AM-ZIP-PRIME     TO OUT-ACCT-ZIP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* NSRASBL.cbl
  7438           MOVE AM-REPORT-CODE-1 TO OUT-RPT-CD1
  7439           MOVE AM-REPORT-CODE-2 TO OUT-RPT-CD2
  7440           IF AM-ZIP-PLUS4 NOT = SPACES AND ZEROS
  7441              STRING '-' AM-ZIP-PLUS4 DELIMITED BY SIZE
  7442                 INTO OUT-ACCT-ZIP (6:5)
  7443              END-STRING
  7444           END-IF
  7445           MOVE AM-TEL-NO        TO OUT-ACCT-PHONE
  7446           MOVE AM-GPCD          TO OUT-ACCT-BUS-TYPE
  7447           MOVE AM-STATE         TO OUT-FORM
  7448           IF AM-ACCOUNT (10:1) = 'L'
  7449              MOVE 'L'           TO OUT-FORM (3:1)
  7450                                    OUT-LEASE-IND
  7451           END-IF
  7452           MOVE AM-CONTROL-PRIMARY (1:8)
  7453                                 TO WS-ERCOMP-KEY
  7454           IF AM-REMIT-TO NOT NUMERIC
  7455              MOVE 01            TO AM-REMIT-TO
  7456           END-IF
  7457           MOVE AM-AGT (AM-REMIT-TO) TO WS-ERCOMP-RESP-NO
  7458           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7459              (AM-COM-TYP (S1) = 'C' OR 'D')
  7460              OR (S1 > +10)
  7461           END-PERFORM
  7462           IF S1 < +11
  7463              MOVE AM-AGT (S1)   TO WS-ERCOMP-ACCOUNT
  7464           END-IF
  7465           MOVE 'A'              TO WS-ERCOMP-REC-TYPE
  7466           PERFORM 1225-GET-ERCOMP THRU 1225-EXIT
  7467        END-IF
  7468     END-IF
  7469
  7470* EXEC CICS ENDBR
  7471*        DATASET   ('ERACCT')
  7472*    END-EXEC
  7473     MOVE 'ERACCT' TO DFHEIV1
  7474     MOVE 0
  7475       TO DFHEIV11
  7476*    MOVE '&2                    $   #00007134' TO DFHEIV0
  7477     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7478     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7479     MOVE X'2020233030303037313334' TO DFHEIV0(25:11)
  7480     CALL 'kxdfhei1' USING DFHEIV0,
  7481           DFHEIV1,
  7482           DFHEIV11,
  7483           DFHEIV99
  7484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7485    .
  7486 1200-EXIT.
  7487     EXIT.
  7488 1225-GET-ERCOMP.
  7489
  7490* EXEC CICS READ
  7491*       INTO    (COMPENSATION-MASTER)
  7492*       DATASET ('ERCOMP')
  7493*       RIDFLD  (WS-ERCOMP-KEY)
  7494*       RESP    (WS-RESPONSE)
  7495*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* NSRASBL.cbl
  7496     MOVE LENGTH OF
  7497      COMPENSATION-MASTER
  7498       TO DFHEIV11
  7499     MOVE 'ERCOMP' TO DFHEIV1
  7500*    MOVE '&"IL       E          (  N#00007141' TO DFHEIV0
  7501     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7502     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7503     MOVE X'204E233030303037313431' TO DFHEIV0(25:11)
  7504     CALL 'kxdfhei1' USING DFHEIV0,
  7505           DFHEIV1,
  7506           COMPENSATION-MASTER,
  7507           DFHEIV11,
  7508           WS-ERCOMP-KEY,
  7509           DFHEIV99,
  7510           DFHEIV99,
  7511           DFHEIV99
  7512     MOVE EIBRESP  TO WS-RESPONSE
  7513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7514     IF RESP-NORMAL
  7515        MOVE CO-RESP-NO          TO OUT-RESP-NO
  7516        MOVE CO-ACCT-NAME        TO OUT-COMP-NAME
  7517        MOVE CO-MAIL-NAME        TO OUT-COMP-MAIL-TO
  7518        MOVE CO-ADDR-1           TO OUT-COMP-ADDR1
  7519        MOVE CO-ADDR-2           TO OUT-COMP-ADDR2
  7520        MOVE CO-ADDR-CITY        TO OUT-COMP-CITY
  7521        MOVE CO-ADDR-STATE       TO OUT-COMP-STATE
  7522        MOVE CO-ZIP              TO OUT-COMP-ZIP
  7523        MOVE CO-TELEPHONE        TO OUT-COMP-PHONE
  7524        MOVE CO-FAXNO            TO OUT-COMP-FAX
  7525        MOVE CO-GA-STATUS-CODE   TO OUT-COMP-STATUS
  7526        MOVE CO-BILL-SW          TO OUT-BILL-SW
  7527     END-IF
  7528     .
  7529 1225-EXIT.
  7530     EXIT.
  7531 1250-GET-ELLETR.
  7532     display ' made it to 1250 '
  7533     move spaces                 to W-Z-CONTROL-DATA
  7534     MOVE WS-COMPANY-CD          TO WS-ELLETR-COMPANY-CD
  7535     MOVE BL-LETTER-ID           TO WS-ELLETR-LETTER-ID
  7536     MOVE +0                     TO WS-ELLETR-SEQ-NO
  7537
  7538* EXEC CICS READ
  7539*         DATASET    ('ELLETR')
  7540*         INTO       (TEXT-FILES)
  7541*         RIDFLD     (WS-ELLETR-KEY)
  7542*         RESP       (WS-RESPONSE)
  7543*         GTEQ
  7544*    END-EXEC
  7545     MOVE LENGTH OF
  7546      TEXT-FILES
  7547       TO DFHEIV11
  7548     MOVE 'ELLETR' TO DFHEIV1
  7549*    MOVE '&"IL       G          (  N#00007170' TO DFHEIV0
  7550     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  7551     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7552     MOVE X'204E233030303037313730' TO DFHEIV0(25:11)
  7553     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* NSRASBL.cbl
  7554           DFHEIV1,
  7555           TEXT-FILES,
  7556           DFHEIV11,
  7557           WS-ELLETR-KEY,
  7558           DFHEIV99,
  7559           DFHEIV99,
  7560           DFHEIV99
  7561     MOVE EIBRESP  TO WS-RESPONSE
  7562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7563     IF RESP-NORMAL
  7564        IF (LETTER-FILE-TEXT)
  7565           AND (BL-LETTER-ID = TX-LETTER-NO)
  7566           AND (TX-LINE-SQUEEZE-CONTROL = 'Z')
  7567           display ' found good z record '
  7568           PERFORM 1280-PROCESS-Z-CONTROLS
  7569                                 THRU 1280-EXIT
  7570        END-IF
  7571     END-IF
  7572     .
  7573 1250-EXIT.
  7574     EXIT.
  7575 1280-PROCESS-Z-CONTROLS.
  7576     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  7577*    IF W-FORM-TO-RESEND > SPACES
  7578*       MOVE W-FORM-TO-RESEND    TO OUT-FORM
  7579*    ELSE
  7580*       MOVE SPACES              TO OUT-FORM
  7581*    END-IF
  7582     MOVE W-ENCLOSURE-CD         TO BL-ENC-CD
  7583     .
  7584 1280-EXIT.
  7585     EXIT.
  7586 1300-DETERMINE-COMM.
  7587******************************************************************
  7588* DATA SOURCE MEANINGS  BL-DATA-SRCE
  7589*    1) FROM ACCT MAINT
  7590*    2) FROM CERT UPDATE
  7591*    3) FROM COMP MAINT
  7592*    4) FROM REVIEW AND CORRECTIONS
  7593******************************************************************
  7594     MOVE 'Y'                    TO OUT-CHGBACK
  7595     MOVE ZEROS                  TO WS-DIFF
  7596                                    WS-CSO-PORTION
  7597                                    WS-ACCT-PORTION
  7598     IF BL-DATA-SRCE = '4'
  7599        IF PB-CANCELLATION
  7600           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
  7601           MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-2
  7602           IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
  7603              MOVE PB-C-LF-CANCEL-DT
  7604                                 TO DC-BIN-DATE-2
  7605           END-IF
  7606           MOVE '1'              TO DC-OPTION-CODE
  7607           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7608           IF NO-CONVERSION-ERROR
  7609              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  7610              IF DC-ODD-DAYS-OVER > +1
  7611                 ADD +1          TO WS-DIFF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* NSRASBL.cbl
  7612              END-IF
  7613              IF (WS-CHGBACK = 99)
  7614                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  7615                 COMPUTE WS-CSO-PORTION = PB-C-LF-CANCEL-AMT +
  7616                    PB-C-AH-CANCEL-AMT
  7617                 MOVE 'N'       TO OUT-CHGBACK
  7618              ELSE
  7619                 COMPUTE WS-ACCT-PORTION =
  7620                   (PB-CI-LIFE-COMMISSION * PB-C-LF-CANCEL-AMT)
  7621                   + (PB-CI-AH-COMMISSION * PB-C-AH-CANCEL-AMT)
  7622                 COMPUTE WS-CSO-PORTION =
  7623                   (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT)
  7624                      - WS-ACCT-PORTION
  7625              END-IF
  7626           END-IF
  7627        END-IF
  7628     ELSE
  7629        IF (CM-LF-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7630           OR (CM-AH-CANCEL-DT NOT = LOW-VALUES AND SPACES)
  7631           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  7632           MOVE CM-AH-CANCEL-DT  TO DC-BIN-DATE-2
  7633           IF CM-LF-CANCEL-DT > DC-BIN-DATE-2
  7634              MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-2
  7635           END-IF
  7636           MOVE '1'              TO DC-OPTION-CODE
  7637           PERFORM 9700-DATE-LINK THRU 9700-EXIT
  7638           IF NO-CONVERSION-ERROR
  7639              MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  7640              IF DC-ODD-DAYS-OVER > +1
  7641                 ADD +1          TO WS-DIFF
  7642              END-IF
  7643              IF (WS-CHGBACK = 99)
  7644                 OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  7645                 COMPUTE WS-CSO-PORTION = CM-LF-ITD-CANCEL-AMT
  7646                    + CM-AH-ITD-CANCEL-AMT
  7647                 MOVE 'N'       TO OUT-CHGBACK
  7648              ELSE
  7649                 COMPUTE WS-ACCT-PORTION =
  7650                   (CM-LIFE-COMM-PCT * CM-LF-ITD-CANCEL-AMT)
  7651                   + (CM-AH-COMM-PCT * CM-AH-ITD-CANCEL-AMT)
  7652                 COMPUTE WS-CSO-PORTION =
  7653                   (CM-LF-ITD-CANCEL-AMT + CM-AH-ITD-CANCEL-AMT)
  7654                      - WS-ACCT-PORTION
  7655              END-IF
  7656           END-IF
  7657        END-IF
  7658     END-IF
  7659     .
  7660 1300-EXIT.
  7661     EXIT.
  7662 1500-GET-ARCH-NO.
  7663     DISPLAY ' MADE IT TO 1500 '
  7664     MOVE BL-COMP-ID             TO WS-ELCNTL-COMPANY-ID
  7665     MOVE '1'                    TO WS-ELCNTL-REC-TYPE
  7666     MOVE SPACES                 TO WS-ELCNTL-GENL
  7667     MOVE +0                     TO WS-ELCNTL-SEQ-NO
  7668
  7669* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* NSRASBL.cbl
  7670*       INTO    (CONTROL-FILE)
  7671*       DATASET ('ELCNTL')
  7672*       RIDFLD  (WS-ELCNTL-KEY)
  7673*       UPDATE
  7674*       RESP    (WS-RESPONSE)
  7675*    END-EXEC
  7676     MOVE LENGTH OF
  7677      CONTROL-FILE
  7678       TO DFHEIV11
  7679     MOVE 'ELCNTL' TO DFHEIV1
  7680*    MOVE '&"IL       EU         (  N#00007282' TO DFHEIV0
  7681     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7682     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7683     MOVE X'204E233030303037323832' TO DFHEIV0(25:11)
  7684     CALL 'kxdfhei1' USING DFHEIV0,
  7685           DFHEIV1,
  7686           CONTROL-FILE,
  7687           DFHEIV11,
  7688           WS-ELCNTL-KEY,
  7689           DFHEIV99,
  7690           DFHEIV99,
  7691           DFHEIV99
  7692     MOVE EIBRESP  TO WS-RESPONSE
  7693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7694     IF RESP-NORMAL
  7695        AND (CF-COMPANY-ID  = BL-COMP-ID)
  7696        AND (CF-RECORD-TYPE = '1')
  7697        ADD +1                   TO CF-CREDIT-LAST-ARCH-NUM
  7698        MOVE CF-CREDIT-LAST-ARCH-NUM
  7699                                 TO WS-ARCHIVE-NO
  7700
  7701* EXEC CICS REWRITE
  7702*          FROM    (CONTROL-FILE)
  7703*          DATASET ('ELCNTL')
  7704*       END-EXEC
  7705     MOVE LENGTH OF
  7706      CONTROL-FILE
  7707       TO DFHEIV11
  7708     MOVE 'ELCNTL' TO DFHEIV1
  7709*    MOVE '&& L                  %   #00007295' TO DFHEIV0
  7710     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7711     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7712     MOVE X'2020233030303037323935' TO DFHEIV0(25:11)
  7713     CALL 'kxdfhei1' USING DFHEIV0,
  7714           DFHEIV1,
  7715           CONTROL-FILE,
  7716           DFHEIV11,
  7717           DFHEIV99
  7718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7719     ELSE
  7720        MOVE +0                  TO WS-ARCHIVE-NO
  7721     END-IF
  7722    .
  7723 1500-EXIT.
  7724     EXIT.
  7725 1700-GET-ELENCC.
  7726     MOVE WS-COMPANY-CD          TO WS-ELENCC-KEY
  7727     MOVE '2'                    TO WS-ELENCC-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* NSRASBL.cbl
  7728     MOVE BL-ENC-CD              TO WS-ELENCC-ENC-CODE
  7729     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  7730        (WS-ELENCC-ENC-CODE (E1:1) = ' ')
  7731        OR (E1 > +5)
  7732     END-PERFORM
  7733     IF E1 < +5
  7734        MOVE BL-STATE            TO WS-ELENCC-ENC-CODE (E1:2)
  7735     END-IF
  7736
  7737* EXEC CICS READ
  7738*        DATASET   ('ELENCC')
  7739*        INTO      (ENCLOSURE-CODES)
  7740*        RIDFLD    (WS-ELENCC-KEY)
  7741*        RESP      (WS-RESPONSE)
  7742*    END-EXEC
  7743     MOVE LENGTH OF
  7744      ENCLOSURE-CODES
  7745       TO DFHEIV11
  7746     MOVE 'ELENCC' TO DFHEIV1
  7747*    MOVE '&"IL       E          (  N#00007316' TO DFHEIV0
  7748     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7749     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7750     MOVE X'204E233030303037333136' TO DFHEIV0(25:11)
  7751     CALL 'kxdfhei1' USING DFHEIV0,
  7752           DFHEIV1,
  7753           ENCLOSURE-CODES,
  7754           DFHEIV11,
  7755           WS-ELENCC-KEY,
  7756           DFHEIV99,
  7757           DFHEIV99,
  7758           DFHEIV99
  7759     MOVE EIBRESP  TO WS-RESPONSE
  7760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7761     IF NOT RESP-NORMAL
  7762        display ' elencc resp not normal ' ws-response
  7763        MOVE BL-ENC-CD           TO WS-ELENCC-ENC-CODE
  7764
  7765* EXEC CICS READ
  7766*           DATASET   ('ELENCC')
  7767*           INTO      (ENCLOSURE-CODES)
  7768*           RIDFLD    (WS-ELENCC-KEY)
  7769*           RESP      (WS-RESPONSE)
  7770*       END-EXEC
  7771     MOVE LENGTH OF
  7772      ENCLOSURE-CODES
  7773       TO DFHEIV11
  7774     MOVE 'ELENCC' TO DFHEIV1
  7775*    MOVE '&"IL       E          (  N#00007325' TO DFHEIV0
  7776     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7777     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7778     MOVE X'204E233030303037333235' TO DFHEIV0(25:11)
  7779     CALL 'kxdfhei1' USING DFHEIV0,
  7780           DFHEIV1,
  7781           ENCLOSURE-CODES,
  7782           DFHEIV11,
  7783           WS-ELENCC-KEY,
  7784           DFHEIV99,
  7785           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* NSRASBL.cbl
  7786           DFHEIV99
  7787     MOVE EIBRESP  TO WS-RESPONSE
  7788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7789     END-IF
  7790     IF RESP-NORMAL
  7791        display ' elencc resp normal ' ws-response
  7792        MOVE NC-OUTPUT-STACK     TO OUT-STACK
  7793        MOVE NC-ENCLOSURE-LINE   TO OUT-ENC-LINE
  7794        MOVE NC-ATTACHMENTS      TO OUT-ATTACH
  7795     END-IF
  7796     .
  7797 1700-EXIT.
  7798     EXIT.
  7799 9700-DATE-LINK.
  7800
  7801* EXEC CICS LINK
  7802*        PROGRAM   ('ELDATCV')
  7803*        COMMAREA  (DATE-CONVERSION-DATA)
  7804*        LENGTH    (DC-COMM-LENGTH)
  7805*    END-EXEC.
  7806     MOVE 'ELDATCV' TO DFHEIV1
  7807*    MOVE '."C                   ''   #00007342' TO DFHEIV0
  7808     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7809     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7810     MOVE X'2020233030303037333432' TO DFHEIV0(25:11)
  7811     CALL 'kxdfhei1' USING DFHEIV0,
  7812           DFHEIV1,
  7813           DATE-CONVERSION-DATA,
  7814           DC-COMM-LENGTH,
  7815           DFHEIV99,
  7816           DFHEIV99,
  7817           DFHEIV99
  7818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7819
  7820 9700-EXIT.
  7821      EXIT.
  7822
  7823 9999-DFHBACK SECTION.
  7824     MOVE '9%                    "   ' TO DFHEIV0
  7825     MOVE 'NSRASBL' TO DFHEIV1
  7826     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7827     GOBACK.
  7828 9999-DFHEXIT.
  7829     IF DFHEIGDJ EQUAL 0001
  7830         NEXT SENTENCE.
  7831     MOVE '9%                    "   ' TO DFHEIV0
  7832     MOVE 'NSRASBL' TO DFHEIV1
  7833     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7834     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       31460     Code:       42023
