* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    57* 111714  CR2014073000001  PEMA  DRAFTS TO CHECKS
    58* 032015  CR2014121000003  TANA  Default prnt survey to 'N'for DCC
    59* 110515  IR2015103000001  TANA  Check app level for 3550 message
    60* 120115  CR2015082700002  PEMA  ADD JNT BORROWER PROCESSING
    61* 012016  IR2016011800003  PEMA  FIXED LENGTH OF PAYEE NAME
    62* 050616  CR2015030200004  TANA  Additional pmt Pd thru exp date
    63* 013017  CR2016053100001  PEMA  ACH PROCESSING
    64* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
    65* 102617    2017101800003  TANA  Fix family leave auth level
    66******************************************************************
    67
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page   3
* EL156.cbl
    69 ENVIRONMENT DIVISION.
    70
    71 DATA DIVISION.
    72
    73 WORKING-STORAGE SECTION.
    74 01  DFH-START PIC X(04).
    75
    76 77  FILLER  PIC X(32)  VALUE '********************************'.
    77 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    78 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    79 77  WS-SSN  PIC X(9) VALUE ZEROS.
    80 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    81 77  C0                          PIC S999 COMP-3 VALUE +0.
    82 77  C1                          PIC S999 COMP-3 VALUE +0.
    83 77  C2                          PIC S999 COMP-3 VALUE +0.
    84 77  C3                          PIC S999 COMP-3 VALUE +0.
    85 77  s1                          PIC S999 COMP-3 VALUE +0.
    86 77  s2                          pic s999 comp-3 value +0.
    87 77  P1                          PIC S999 COMP-3 VALUE +0.
    88 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    89 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    90 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    91 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    92 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    93 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    94 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    95 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    96 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    97 77  ws-max-bens                 pic s999 comp-3 value +0.
    98 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    99 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
   100 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
   101 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
   102 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
   103 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
   104
   105*    COPY ELCSCTM.
   106******************************************************************
   107*                                                                *
   108*                                                                *
   109*                            ELCSCTM                             *
   110*                            VMOD=2.001                          *
   111*                                                                *
   112*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   113*                                                                *
   114******************************************************************
   115 01  SECURITY-MESSAGE.
   116     12  FILLER                          PIC X(30)
   117            VALUE '** LOGIC SECURITY VIOLATION -'.
   118     12  SM-READ                         PIC X(6).
   119     12  FILLER                          PIC X(5)
   120            VALUE ' PGM='.
   121     12  SM-PGM                          PIC X(6).
   122     12  FILLER                          PIC X(5)
   123            VALUE ' OPR='.
   124     12  SM-PROCESSOR-ID                 PIC X(4).
   125     12  FILLER                          PIC X(6)
   126            VALUE ' TERM='.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page   4
* EL156.cbl
   127     12  SM-TERMID                       PIC X(4).
   128     12  FILLER                          PIC XX   VALUE SPACE.
   129     12  SM-JUL-DATE                     PIC 9(5).
   130     12  FILLER                          PIC X    VALUE SPACE.
   131     12  SM-TIME                         PIC 99.99.
   132
   133
   134*    COPY ELCSCRTY.
   135******************************************************************
   136*                                                                *
   137*                                                                *
   138*                            ELCSCRTY                            *
   139*                            VMOD=2.001                          *
   140*                                                                *
   141*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   142*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   143*        SAVED IN PI-SECURITY-ADDRESS.                           *
   144*                                                                *
   145******************************************************************
   146 01  SECURITY-CONTROL.
   147     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   148     12  FILLER                       PIC XX    VALUE 'SC'.
   149     12  SC-CREDIT-CODES.
   150         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   151             20  SC-CREDIT-DISPLAY    PIC X.
   152             20  SC-CREDIT-UPDATE     PIC X.
   153     12  SC-CLAIMS-CODES.
   154         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   155             20  SC-CLAIMS-DISPLAY    PIC X.
   156             20  SC-CLAIMS-UPDATE     PIC X.
   157
   158 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   159 01  WS-DATE-AREA.
   160     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   161     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   162     12  SAVE-DATE-CCYYMMDD.
   163         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   164         16  SAVE-DATE-YMD.
   165             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   166             20  FILLER              PIC X(04)   VALUE SPACES.
   167
   168 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   169 01  STANDARD-AREAS.
   170     12  WS-RESPONSE         PIC S9(8)   COMP.
   171         88  WS-RESP-NORMAL              VALUE +00.
   172         88  WS-RESP-ERROR               VALUE +01.
   173         88  WS-RESP-NOTFND              VALUE +13.
   174         88  WS-RESP-DUPREC              VALUE +14.
   175         88  WS-RESP-ENDFILE             VALUE +20.
   176     12  PMT-HEAD-A.
   177         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   178         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   179         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   180-        '     RESERVES  TYPE    AMOUNT'.
   181     12  PMT-HEAD-B.
   182         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   183         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   184         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page   5
* EL156.cbl
   185     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   186     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   187     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   188     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   189     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   190     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   191     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   192     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   193     12  PGM-NAME            PIC X(8).
   194     12  TIME-IN             PIC S9(7).
   195     12  TIME-OUT-R  REDEFINES TIME-IN.
   196         16  FILLER          PIC X.
   197         16  TIME-OUT        PIC 99V99.
   198         16  FILLER          PIC XX.
   199     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   200     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   201     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   202     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   203     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   204     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   205     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   206     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   207     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   208     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   209     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   210     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   211     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   212     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   213     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   214     12  WS-BLANK            PIC X       VALUE ' '.
   215
   216 01  MISC-WORK-AREAS.
   217     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   218     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   219     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   220     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   221     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   222     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   223     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   224     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   225     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   226     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   227     12  W-CALLED-NAME           PIC X(08).
   228     12  W-EOB-CODES.
   229         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   230             20  W-EOB-CODE      PIC XXX.
   231             20  W-EOB-FILLER    PIC X.
   232     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   233     12  W-NAME-LAST             PIC X(15).
   234     12  W-NAME-FIRST            PIC X(15).
   235     12  W-NAME-MIDDLE.
   236         16  FILLER              PIC X.
   237         16  W-NAME-MIDDLE-2     PIC X.
   238         16  FILLER              PIC X(13).
   239     12  W-DMD-CHECK-NO.
   240         16  W-DMD-CHECK-NO-1    PIC X(4).
   241         16  W-DMD-CHECK-NO-2    PIC X.
   242         16  W-DMD-CHECK-NO-3    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page   6
* EL156.cbl
   243
   244     12  WS-COMPUTE-FROM-DT  PIC XX.
   245     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   246     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   247     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   248     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   249     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   250     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   251         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   252         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   253     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   254         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   255     12  WS-UPDATE-SW        PIC X VALUE ' '.
   256     12  WS-GROUPING.
   257         16  WS-GROUP-1      PIC X VALUE SPACES.
   258         16  FILLER          PIC X(05) VALUE SPACES.
   259     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   260     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   261     12  WS-WORK-STATE-ACCT.
   262         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   263         16  FILLER          PIC X       VALUE '/'.
   264         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   265     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   266     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   267     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   268     12  QID.
   269         16  QID-TERM        PIC X(4)    VALUE SPACES.
   270         16  FILLER          PIC X(4)    VALUE '156A'.
   271     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   272     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   273     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   274     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   275     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   276     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   277     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   278     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   279     12  WS-STATUS           PIC X       VALUE SPACES.
   280     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   281     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   282     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   283     12  ws-extended-exp-dt  pic xx      value low-values.
   284     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   285     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   286     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   287     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   288     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   289     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   290     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   291     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   292     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   293     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   294     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   295     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   296     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   297     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   298     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   299     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   300     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page   7
* EL156.cbl
   301     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   302     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   303     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   304     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   305     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   306     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   307     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   308     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   309     12  WORK-DATE-FROM.
   310         16  WDF-MONTH       PIC 99        VALUE ZERO.
   311         16  WDF-DAY         PIC 99        VALUE ZERO.
   312         16  WDF-YEAR        PIC 99        VALUE ZERO.
   313     12  WORK-DATE-THRU.
   314         16  WDT-MONTH       PIC 99        VALUE ZERO.
   315         16  WDT-DAY         PIC 99        VALUE ZERO.
   316         16  WDT-YEAR        PIC 99        VALUE ZERO.
   317     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   318     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   319     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   320     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   321     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   322     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   323     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   324     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   325     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   326     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   327     12  WS-PY-WK REDEFINES WS-PY-WORK.
   328         16  WS-PY-NUM       PIC S9(7)V99.
   329         16  WS-PY-SIGN      PIC X.
   330     12  WS-DY-WORK          PIC S9(5).
   331     12  WS-DY-WK REDEFINES WS-DY-WORK.
   332         16  WS-DY-NUM       PIC S9(4).
   333         16  WS-DY-SIGN      PIC X.
   334     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   335         88  COMP-REC-FOUND              VALUE 'Y'.
   336     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   337         88  BENEFIT-FOUND       VALUE 'Y'.
   338         88  NO-BENEFIT-FOUND    VALUE 'N'.
   339     12  WS-TERMS.
   340         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   341         16  FILLER          PIC X       VALUE '/'.
   342         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   343         16  WST-REM-DAYS-GRP.
   344             20  WST-SLASH   PIC X       VALUE '/'.
   345             20  WST-REM-DAYS
   346                             PIC --9.
   347     12  WS-ACCESS.
   348         16  FILLER          PIC XX      VALUE SPACES.
   349         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   350     12  WS-STATE-ACCESS.
   351         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   352         16  FILLER          PIC XX      VALUE SPACES.
   353     12  WS-CARR-ACCESS.
   354         16  FILLER          PIC X(3)    VALUE SPACES.
   355         16  WS-CARR         PIC X       VALUE SPACES.
   356     12  DATE-WORK.
   357         16  FILLER          PIC XX      VALUE SPACES.
   358         16  NUM-WORK        PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page   8
* EL156.cbl
   359     12  WS-SAVE-INPUT.
   360         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   361         16  WS-PAYEE        PIC XX      VALUE SPACE.
   362         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   363         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   364         16  WS-OFFLINE      PIC X       VALUE SPACE.
   365         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   366         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   367         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   368         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   369         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   370         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   371         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   372         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   373         16  WS-ETYPE        PIC X       VALUE SPACE.
   374         16  WS-CASH         PIC X       VALUE SPACE.
   375         16  WS-GROUPED      PIC X       VALUE SPACE.
   376         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   377         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   378         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   379         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   380         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   381         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   382         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   383         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   384         16  ws-int-to-rem-borr pic x value spaces.
   385     12  LAST-ERROR-LINE.
   386         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   387         16  FILLER              PIC X(30)
   388             VALUE ' FATAL ERRORS ENCOUNTERED'.
   389         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   390         16  FILLER              PIC X(28)
   391             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   392     12  WS-CHECK-AREA.
   393         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   394         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   395     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   396     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   397         16  FILLER              PIC XX.
   398         16  WS-A-CHECK-NUM-5    PIC 9(5).
   399     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   400         16  FILLER              PIC X.
   401         16  WS-A-CHECK-NUM-6    PIC 9(6).
   402     12  OPTION-1-SAVE-AREA.
   403         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   404         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   405     12  WS-WORK-ZIP.
   406         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   407         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   408     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   409                                 PIC 9(9).
   410     12  WS-FLI-PMTNOTE.
   411         16  WS-PMTOPTION        PIC XX.
   412         16  WS-DOCNAME          PIC X(28).
   413         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   414             20  WS-AMOUNT       PIC X(8).
   415             20  FILLER          PIC X(20).
   416         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page   9
* EL156.cbl
   417             20  WS-NUM-AMT      PIC 9(6)V99.
   418             20  FILLER          PIC X(20).
   419
   420     12  WS-HAN-PMTNOTE.
   421         16  WS-HAN-PMT-CODE     PIC X.
   422         16  WS-HAN-PMT-NOTE     PIC X(39).
   423
   424     12  WS-NCL-PMT-OPTION       PIC XX.
   425         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   426
   427     12  WS-CLAIM-SEQUENCE.
   428         16  FILLER              PIC X VALUE '('.
   429         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   430         16  FILLER              PIC X(04) VALUE ' OF '.
   431         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   432         16  FILLER              PIC X VALUE ')'.
   433
   434     12  WS-REFUND-AMT           PIC Z(7).99.
   435     12  WS-CALC-INT             PIC S9(7)V99.
   436     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   437
   438     12  SUB                     PIC 99 VALUE ZEROS.
   439
   440     12  WS-BOANOTE1.
   441         16  WS-BOANOTE1-DESC    PIC X(11).
   442         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   443         16  FILLER              PIC X(17).
   444     12  WS-BOANOTE2.
   445         16  WS-BOANOTE2-DESC    PIC X(11).
   446         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   447         16  FILLER              PIC X(17).
   448
   449     12  WS-NCLNOTE1.
   450         16  WS-NCLNOTE1-DESC    PIC X(11).
   451         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   452         16  FILLER              PIC X(17).
   453     12  WS-NCLNOTE2.
   454         16  WS-NCLNOTE2-DESC    PIC X(11).
   455         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   456         16  FILLER              PIC X(17).
   457
   458     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   459     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   460     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   461     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   462     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   463     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   464     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   465     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   466     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   467     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   468
   469     12  WS-AIG-WORK-AREAS.
   470         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   471             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   472         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   473             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   474         16  WS-FROM-DATE-MDY.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  10
* EL156.cbl
   475             20  WS-FROM-MO      PIC 99.
   476             20  WS-FROM-DA      PIC 99.
   477             20  WS-FROM-YR      PIC 99.
   478         16  WS-TEMP-DATE-MDY.
   479             20  WS-TEMP-MO      PIC 99.
   480             20  WS-TEMP-DA      PIC 99.
   481             20  WS-TEMP-YR      PIC 99.
   482         16  WS-BIN-FROM-DT      PIC XX.
   483         16  WS-TEMP-INC-MDY.
   484             20  WS-TEMP-INC-MO  PIC 99.
   485             20  WS-TEMP-INC-DA  PIC 99.
   486             20  WS-TEMP-INC-YR  PIC 99.
   487         16  WS-PMT-DUE-MDY.
   488             20  WS-PMT-DUE-MO   PIC 99.
   489             20  WS-PMT-DUE-DA   PIC 99.
   490             20  WS-PMT-DUE-YR   PIC 99.
   491         16  WS-PMT-DUE-DT       PIC XX.
   492         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   493         16  WS-RETRO-ELIM-DT    PIC XX.
   494         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   495             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   496         16  WS-SAVE-DUE-DA      PIC 99.
   497         16  WS-CDAYS            PIC S9(05).
   498         16  WS-DAYS-OFF         PIC S9(05).
   499         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   500             88  ELIM-SATISFIED            VALUE 'Y'.
   501         16  WS-AIG-CHECKNO.
   502             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   503             20  WS-A-CHECKNO-3-7.
   504                 24  FILLER              PIC X(3)    VALUE SPACES.
   505                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   506                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   507         16  WS-AIG-GROUPING.
   508             20  WS-A-BENE               PIC XXX.
   509             20  FILLER                  PIC XXX.
   510         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   511             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   512             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   513         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   514                 VALUE 'UNEMPLOYMENT PAYMENT'.
   515         16  WS-CHK-THRU-DT              PIC XX.
   516         16  WS-HOLD-BIN-DATE-1          PIC XX.
   517
   518 01  MISC-CSO-AREA.
   519     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   520     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   521     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   522         88  APPROVAL-NEEDED                        VALUE 'Y'.
   523     12  WS-APPROV-NOTE                  PIC X(43)
   524         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   525     12  WS-3550-APPROV-NOTE             PIC X(43)
   526         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   527     12  WS-REAUDIT-NOTE                 PIC X(43)
   528         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   529     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   530     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   531     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   532     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  11
* EL156.cbl
   533     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   534     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   535     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   536         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   537     12  WS-PAYEE-CITY-STATE     PIC X(30).
   538     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   539         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   540     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   541     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   542     12  WS-WORK-NAME            PIC X(30).
   543     12  FILLER  REDEFINES WS-WORK-NAME.
   544         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   545     12  WS-INSURED-NAME         PIC X(30).
   546     12  FILLER  REDEFINES WS-INSURED-NAME.
   547         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   548     12  WS-PAYEE-NAME           PIC X(30).
   549     12  FILLER  REDEFINES WS-PAYEE-NAME.
   550         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   551
   552 01  ERROR-MESSAGES.
   553     12  ER-0000                 PIC X(4)  VALUE '0000'.
   554     12  ER-0004                 PIC X(4)  VALUE '0004'.
   555     12  ER-0008                 PIC X(4)  VALUE '0008'.
   556     12  ER-0019                 PIC X(4)  VALUE '0019'.
   557     12  ER-0029                 PIC X(4)  VALUE '0029'.
   558     12  ER-0042                 PIC X(4)  VALUE '0042'.
   559     12  ER-0070                 PIC X(4)  VALUE '0070'.
   560     12  ER-0130                 PIC X(4)  VALUE '0130'.
   561     12  ER-0149                 PIC X(4)  VALUE '0149'.
   562     12  ER-0154                 PIC X(4)  VALUE '0154'.
   563     12  ER-0168                 PIC X(4)  VALUE '0168'.
   564     12  ER-0169                 PIC X(4)  VALUE '0169'.
   565     12  ER-0172                 PIC X(4)  VALUE '0174'.
   566     12  ER-0198                 PIC X(4)  VALUE '0198'.
   567     12  ER-0204                 PIC X(4)  VALUE '0204'.
   568     12  ER-0206                 PIC X(4)  VALUE '0206'.
   569     12  ER-0252                 PIC X(4)  VALUE '0252'.
   570     12  ER-0254                 PIC X(4)  VALUE '0254'.
   571     12  ER-0282                 PIC X(4)  VALUE '0282'.
   572     12  ER-0283                 PIC X(4)  VALUE '0283'.
   573     12  ER-0294                 PIC X(4)  VALUE '0294'.
   574     12  ER-0338                 PIC X(4)  VALUE '0338'.
   575     12  ER-0419                 PIC X(4)  VALUE '0419'.
   576     12  ER-0420                 PIC X(4)  VALUE '0420'.
   577     12  ER-0421                 PIC X(4)  VALUE '0421'.
   578     12  ER-0422                 PIC X(4)  VALUE '0422'.
   579     12  ER-0433                 PIC X(4)  VALUE '0433'.
   580     12  ER-0436                 PIC X(4)  VALUE '0436'.
   581     12  ER-0437                 PIC X(4)  VALUE '0437'.
   582     12  ER-0438                 PIC X(4)  VALUE '0438'.
   583     12  ER-0439                 PIC X(4)  VALUE '0439'.
   584     12  ER-0440                 PIC X(4)  VALUE '0440'.
   585     12  ER-0441                 PIC X(4)  VALUE '0441'.
   586     12  ER-0442                 PIC X(4)  VALUE '0442'.
   587     12  ER-0443                 PIC X(4)  VALUE '0443'.
   588     12  ER-0444                 PIC X(4)  VALUE '0444'.
   589     12  ER-0445                 PIC X(4)  VALUE '0445'.
   590     12  ER-0446                 PIC X(4)  VALUE '0446'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  12
* EL156.cbl
   591     12  ER-0447                 PIC X(4)  VALUE '0447'.
   592     12  ER-0448                 PIC X(4)  VALUE '0448'.
   593     12  ER-0449                 PIC X(4)  VALUE '0449'.
   594     12  ER-0452                 PIC X(4)  VALUE '0452'.
   595     12  ER-0458                 PIC X(4)  VALUE '0458'.
   596     12  ER-0459                 PIC X(4)  VALUE '0459'.
   597     12  ER-0460                 PIC X(4)  VALUE '0460'.
   598     12  ER-0461                 PIC X(4)  VALUE '0461'.
   599     12  ER-0462                 PIC X(4)  VALUE '0462'.
   600     12  ER-0463                 PIC X(4)  VALUE '0463'.
   601     12  ER-0464                 PIC X(4)  VALUE '0464'.
   602     12  ER-0465                 PIC X(4)  VALUE '0465'.
   603     12  ER-0466                 PIC X(4)  VALUE '0466'.
   604     12  ER-0467                 PIC X(4)  VALUE '0467'.
   605     12  ER-0468                 PIC X(4)  VALUE '0468'.
   606     12  ER-0469                 PIC X(4)  VALUE '0469'.
   607     12  ER-0473                 PIC X(4)  VALUE '0473'.
   608     12  ER-0474                 PIC X(4)  VALUE '0474'.
   609     12  ER-0475                 PIC X(4)  VALUE '0475'.
   610     12  ER-0476                 PIC X(4)  VALUE '0476'.
   611     12  ER-0477                 PIC X(4)  VALUE '0477'.
   612     12  ER-0478                 PIC X(4)  VALUE '0478'.
   613     12  ER-0479                 PIC X(4)  VALUE '0479'.
   614     12  ER-0481                 PIC X(4)  VALUE '0481'.
   615     12  ER-0491                 PIC X(4)  VALUE '0491'.
   616     12  ER-0492                 PIC X(4)  VALUE '0492'.
   617     12  ER-0493                 PIC X(4)  VALUE '0493'.
   618     12  ER-0494                 PIC X(4)  VALUE '0494'.
   619     12  ER-0495                 PIC X(4)  VALUE '0495'.
   620     12  ER-0499                 PIC X(4)  VALUE '0499'.
   621     12  ER-0500                 PIC X(4)  VALUE '0500'.
   622     12  ER-0501                 PIC X(4)  VALUE '0501'.
   623     12  ER-0502                 PIC X(4)  VALUE '0502'.
   624     12  ER-0508                 PIC X(4)  VALUE '0508'.
   625     12  ER-0513                 PIC X(4)  VALUE '0513'.
   626     12  ER-0518                 PIC X(4)  VALUE '0518'.
   627     12  ER-0524                 PIC X(4)  VALUE '0524'.
   628     12  ER-0525                 PIC X(4)  VALUE '0525'.
   629     12  ER-0526                 PIC X(4)  VALUE '0526'.
   630     12  ER-0530                 PIC X(4)  VALUE '0530'.
   631     12  ER-0540                 PIC X(4)  VALUE '0540'.
   632     12  ER-0541                 PIC X(4)  VALUE '0541'.
   633     12  ER-0542                 PIC X(4)  VALUE '0542'.
   634     12  ER-0543                 PIC X(4)  VALUE '0543'.
   635     12  ER-0545                 PIC X(4)  VALUE '0545'.
   636     12  ER-0552                 PIC X(4)  VALUE '0552'.
   637     12  ER-0555                 PIC X(4)  VALUE '0555'.
   638     12  ER-0556                 PIC X(4)  VALUE '0556'.
   639     12  ER-0557                 PIC X(4)  VALUE '0557'.
   640     12  ER-0572                 PIC X(4)  VALUE '0572'.
   641     12  ER-0573                 PIC X(4)  VALUE '0573'.
   642     12  ER-0594                 PIC X(4)  VALUE '0594'.
   643     12  ER-0616                 PIC X(4)  VALUE '0616'.
   644     12  ER-0617                 PIC X(4)  VALUE '0617'.
   645     12  ER-0618                 PIC X(4)  VALUE '0618'.
   646     12  ER-0657                 PIC X(4)  VALUE '0657'.
   647     12  ER-0658                 PIC X(4)  VALUE '0658'.
   648     12  ER-0699                 PIC X(4)  VALUE '0699'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  13
* EL156.cbl
   649     12  ER-0730                 PIC X(4)  VALUE '0730'.
   650     12  ER-0737                 PIC X(4)  VALUE '0737'.
   651     12  ER-0760                 PIC X(4)  VALUE '0760'.
   652     12  ER-0768                 PIC X(4)  VALUE '0768'.
   653     12  ER-0769                 PIC X(4)  VALUE '0769'.
   654     12  ER-0770                 PIC X(4)  VALUE '0770'.
   655     12  ER-0802                 PIC X(4)  VALUE '0802'.
   656     12  ER-0803                 PIC X(4)  VALUE '0803'.
   657     12  ER-0819                 PIC X(4)  VALUE '0819'.
   658     12  ER-0834                 PIC X(4)  VALUE '0834'.
   659     12  ER-0836                 PIC X(4)  VALUE '0836'.
   660     12  ER-0844                 PIC X(4)  VALUE '0844'.
   661     12  ER-0845                 PIC X(4)  VALUE '0845'.
   662     12  ER-0846                 PIC X(4)  VALUE '0846'.
   663     12  ER-0849                 PIC X(4)  VALUE '0849'.
   664     12  ER-0851                 PIC X(4)  VALUE '0851'.
   665     12  ER-0872                 PIC X(4)  VALUE '0872'.
   666     12  ER-0873                 PIC X(4)  VALUE '0873'.
   667     12  ER-0874                 PIC X(4)  VALUE '0874'.
   668     12  ER-0879                 PIC X(4)  VALUE '0879'.
   669     12  ER-0919                 PIC X(4)  VALUE '0919'.
   670     12  ER-0921                 PIC X(4)  VALUE '0921'.
   671     12  ER-0923                 PIC X(4)  VALUE '0923'.
   672     12  ER-0925                 PIC X(4)  VALUE '0925'.
   673     12  ER-0944                 PIC X(4)  VALUE '0944'.
   674     12  ER-0945                 PIC X(4)  VALUE '0945'.
   675     12  ER-0946                 PIC X(4)  VALUE '0946'.
   676     12  ER-0947                 PIC X(4)  VALUE '0947'.
   677     12  ER-0948                 PIC X(4)  VALUE '0948'.
   678     12  ER-0949                 PIC X(4)  VALUE '0949'.
   679     12  ER-0950                 PIC X(4)  VALUE '0950'.
   680     12  ER-0951                 PIC X(4)  VALUE '0951'.
   681     12  ER-0954                 PIC X(4)  VALUE '0954'.
   682     12  ER-0956                 PIC X(4)  VALUE '0956'.
   683     12  ER-0967                 PIC X(4)  VALUE '0967'.
   684     12  ER-0968                 PIC X(4)  VALUE '0968'.
   685     12  ER-0974                 PIC X(4)  VALUE '0974'.
   686     12  ER-0975                 PIC X(4)  VALUE '0975'.
   687     12  ER-1561                 PIC X(4)  VALUE '1561'.
   688     12  ER-1566                 PIC X(4)  VALUE '1566'.
   689     12  ER-1567                 PIC X(4)  VALUE '1567'.
   690     12  ER-1569                 PIC X(4)  VALUE '1569'.
   691     12  er-1582                 pic x(4)  value '1582'.
   692     12  er-1657                 pic x(4)  value '1657'.
   693     12  er-1658                 pic x(4)  value '1658'.
   694     12  er-1667                 pic x(4)  value '1667'.
   695     12  er-1670                 pic x(4)  value '1670'.
   696     12  er-1671                 pic x(4)  value '1671'.
   697     12  er-1672                 pic x(4)  value '1672'.
   698     12  er-1673                 pic x(4)  value '1673'.
   699     12  er-1674                 pic x(4)  value '1674'.
   700     12  er-1677                 pic x(4)  value '1677'.
   701     12  ER-1775                 PIC X(4)  VALUE '1775'.
   702     12  ER-1880                 PIC X(4)  VALUE '1880'.
   703     12  ER-2044                 PIC X(4)  VALUE '2044'.
   704     12  ER-3140                 PIC X(4)  VALUE '3140'.
   705     12  ER-3141                 PIC X(4)  VALUE '3141'.
   706     12  ER-3255                 PIC X(4)  VALUE '3255'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  14
* EL156.cbl
   707     12  ER-3516                 PIC X(4)  VALUE '3516'.
   708     12  ER-3527                 PIC X(4)  VALUE '3527'.
   709     12  ER-3528                 PIC X(4)  VALUE '3528'.
   710     12  ER-3529                 PIC X(4)  VALUE '3529'.
   711     12  ER-3530                 PIC X(4)  VALUE '3530'.
   712     12  ER-3531                 PIC X(4)  VALUE '3531'.
   713     12  ER-3532                 PIC X(4)  VALUE '3532'.
   714     12  ER-3533                 PIC X(4)  VALUE '3533'.
   715     12  ER-3534                 PIC X(4)  VALUE '3534'.
   716     12  ER-3535                 PIC X(4)  VALUE '3535'.
   717     12  ER-3536                 PIC X(4)  VALUE '3536'.
   718     12  ER-3537                 PIC X(4)  VALUE '3537'.
   719     12  ER-3538                 PIC X(4)  VALUE '3538'.
   720     12  ER-3539                 PIC X(4)  VALUE '3539'.
   721     12  ER-3540                 PIC X(4)  VALUE '3540'.
   722     12  ER-3541                 PIC X(4)  VALUE '3541'.
   723     12  ER-3542                 PIC X(4)  VALUE '3542'.
   724     12  ER-3543                 PIC X(4)  VALUE '3543'.
   725     12  ER-3546                 PIC X(4)  VALUE '3546'.
   726     12  ER-3549                 PIC X(4)  VALUE '3549'.
   727     12  ER-3818                 PIC X(4)  VALUE '3818'.
   728     12  ER-7540                 PIC X(4)  VALUE '7540'.
   729     12  ER-7576                 PIC X(4)  VALUE '7576'.
   730     12  ER-7579                 PIC X(4)  VALUE '7579'.
   731     12  ER-7580                 PIC X(4)  VALUE '7580'.
   732     12  ER-7583                 PIC X(4)  VALUE '7583'.
   733     12  ER-7830                 PIC X(4)  VALUE '7830'.
   734     12  ER-7831                 PIC X(4)  VALUE '7831'.
   735     12  ER-7832                 PIC X(4)  VALUE '7832'.
   736     12  ER-7833                 PIC X(4)  VALUE '7833'.
   737     12  ER-7834                 PIC X(4)  VALUE '7834'.
   738     12  ER-7835                 PIC X(4)  VALUE '7835'.
   739     12  ER-7836                 PIC X(4)  VALUE '7836'.
   740     12  ER-7837                 PIC X(4)  VALUE '7837'.
   741     12  ER-7838                 PIC X(4)  VALUE '7838'.
   742     12  ER-7841                 PIC X(4)  VALUE '7841'.
   743     12  ER-7844                 PIC X(4)  VALUE '7844'.
   744     12  ER-7845                 PIC X(4)  VALUE '7845'.
   745     12  ER-8000                 PIC X(4)  VALUE '8000'.
   746     12  ER-8051                 PIC X(4)  VALUE '8051'.
   747     12  ER-8052                 PIC X(4)  VALUE '8052'.
   748     12  ER-8053                 PIC X(4)  VALUE '8053'.
   749     12  ER-8054                 PIC X(4)  VALUE '8054'.
   750     12  ER-8055                 PIC X(4)  VALUE '8055'.
   751     12  ER-8056                 PIC X(4)  VALUE '8056'.
   752     12  ER-8057                 PIC X(4)  VALUE '8057'.
   753     12  ER-8058                 PIC X(4)  VALUE '8058'.
   754     12  ER-8059                 PIC X(4)  VALUE '8059'.
   755     12  ER-8060                 PIC X(4)  VALUE '8060'.
   756     12  ER-8061                 PIC X(4)  VALUE '8061'.
   757     12  ER-8062                 PIC X(4)  VALUE '8062'.
   758     12  ER-8063                 PIC X(4)  VALUE '8063'.
   759     12  ER-8064                 PIC X(4)  VALUE '8064'.
   760     12  ER-8065                 PIC X(4)  VALUE '8065'.
   761     12  ER-8066                 PIC X(4)  VALUE '8066'.
   762     12  ER-8146                 PIC X(4)  VALUE '8146'.
   763     12  ER-8147                 PIC X(4)  VALUE '8147'.
   764     12  ER-8152                 PIC X(4)  VALUE '8152'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  15
* EL156.cbl
   765     12  ER-8153                 PIC X(4)  VALUE '8153'.
   766     12  ER-8154                 PIC X(4)  VALUE '8154'.
   767     12  ER-8155                 PIC X(4)  VALUE '8155'.
   768     12  ER-8310                 PIC X(4)  VALUE '8310'.
   769     12  ER-8311                 PIC X(4)  VALUE '8311'.
   770     12  ER-8312                 PIC X(4)  VALUE '8312'.
   771     12  ER-8313                 PIC X(4)  VALUE '8313'.
   772     12  ER-8314                 PIC X(4)  VALUE '8314'.
   773     12  ER-8315                 PIC X(4)  VALUE '8315'.
   774     12  ER-8316                 PIC X(4)  VALUE '8316'.
   775     12  ER-8317                 PIC X(4)  VALUE '8317'.
   776
   777 01  CSO-WORK-FIELDS.
   778     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   779       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   780
   781     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   782     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   783         88  CERT-NOTE-ADDED           VALUE 'Y'.
   784     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   785         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   786     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   787
   788     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   789
   790 01  SC-NP6-CERT-NOTE.
   791     12  FILLER                  PIC X(12)
   792               VALUE 'REM BENEFIT '.
   793     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   794     12  SC-NP6-COMM             PIC X(8)
   795               VALUE ' + 6 MO '.
   796     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   797     12  FILLER                  PIC X(12)
   798               VALUE ' = AMT PAID '.
   799     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   800
   801 01  SC-NP6-ORIG-NOTE.
   802     12  FILLER                  PIC X(63)  VALUE
   803         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   804 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   805     88  PDEF-FOUND                   VALUE 'Y'.
   806 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   807     88  ACCT-FOUND                   VALUE 'Y'.
   808 01  CTBL-KEY-SAVE               PIC X(5).
   809 01  CTBL-KEY.
   810     05  CTBL-COMPANY-CD         PIC X.
   811     05  CTBL-TABLE              PIC XXX.
   812     05  CTBL-BEN-TYPE           PIC X.
   813     05  CTBL-BEN-CODE           PIC XX.
   814 01  ERPDEF-KEY-SAVE             PIC X(18).
   815 01  ERPDEF-KEY.
   816     12  ERPDEF-COMPANY-CD       PIC X.
   817     12  ERPDEF-STATE            PIC XX.
   818     12  ERPDEF-PROD-CD          PIC XXX.
   819     12  F                       PIC X(7).
   820     12  ERPDEF-BEN-TYPE         PIC X.
   821     12  ERPDEF-BEN-CODE         PIC XX.
   822     12  ERPDEF-EXP-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  16
* EL156.cbl
   823 01  ELCRTT-KEY.
   824     05  CTRLR-COMP-CD       PIC X.
   825     05  CTRLR-CARRIER       PIC X.
   826     05  CTRLR-GROUPING      PIC X(6).
   827     05  CTRLR-STATE         PIC X(2).
   828     05  CTRLR-ACCOUNT       PIC X(10).
   829     05  CTRLR-EFF-DT        PIC XX.
   830     05  CTRLR-CERT-NO       PIC X(11).
   831     05  CTRLR-REC-TYPE      PIC X.
   832 01  ACCESS-KEYS.
   833     12  ELARCH-KEY.
   834         16  ARCH-CO             PIC X.
   835         16  ARCH-NUMBER         PIC S9(08) COMP.
   836         16  ARCH-REC-TYPE       PIC X.
   837         16  ARCH-SEQ            PIC S9(04) COMP.
   838     12  ELMSTR-KEY.
   839         16  MSTR-COMP-CD        PIC X.
   840         16  MSTR-CARRIER        PIC X.
   841         16  MSTR-CLAIM-NO       PIC X(7).
   842         16  MSTR-CERT-NO        PIC X(11).
   843     12  ELCNTL-KEY.
   844         16  CNTL-COMP-ID        PIC X(3).
   845         16  CNTL-REC-TYPE       PIC X.
   846         16  CNTL-ACCESS         PIC X(4).
   847         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   848     12  ELCERT-KEY.
   849         16  CERT-COMP-CD        PIC X.
   850         16  CERT-CARRIER        PIC X.
   851         16  CERT-GROUPING       PIC X(6).
   852         16  CERT-STATE          PIC XX.
   853         16  CERT-ACCOUNT        PIC X(10).
   854         16  CERT-EFF-DT         PIC XX.
   855         16  CERT-CERT-NO        PIC X(11).
   856     12  ELTRLR-KEY.
   857         16  TRLR-COMP-CD        PIC X.
   858         16  TRLR-CARRIER        PIC X.
   859         16  TRLR-CLAIM-NO       PIC X(7).
   860         16  TRLR-CERT-NO        PIC X(11).
   861         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   862     12  ELACTQ-KEY.
   863         16  ACTQ-COMP-CD        PIC X.
   864         16  ACTQ-CARRIER        PIC X.
   865         16  ACTQ-CLAIM-NO       PIC X(7).
   866         16  ACTQ-CERT-NO        PIC X(11).
   867     12  W-NOTE-KEY.
   868         16  W-NOTE-COMP-CD      PIC X.
   869         16  W-NOTE-CERT-KEY.
   870             20  W-NOTE-CARRIER  PIC X.
   871             20  W-NOTE-GROUPING PIC X(6).
   872             20  W-NOTE-STATE    PIC XX.
   873             20  W-NOTE-ACCOUNT  PIC X(10).
   874             20  W-NOTE-EFF-DT   PIC XX.
   875             20  W-NOTE-CERT-NO  PIC X(11).
   876     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   877     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   878     12  ERACCT-KEY.
   879         16  ERACCT-PARTIAL-KEY.
   880             20  ACCT-COMP-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  17
* EL156.cbl
   881             20  ACCT-CARRIER    PIC X.
   882             20  ACCT-GROUPING   PIC X(6).
   883             20  ACCT-STATE      PIC XX.
   884             20  ACCT-ACCOUNT    PIC X(10).
   885         16  ACCT-EXP-DT         PIC XX.
   886         16  FILLER              PIC X(4) VALUE SPACES.
   887     12  ELCHKQ-KEY.
   888         16  CHKQ-COMP-CD        PIC X.
   889         16  CHKQ-CONTROL        PIC S9(8) COMP.
   890         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   891     12  ELBENE-KEY.
   892         16  BENE-COMP-CD         PIC X.
   893         16  BENE-RECORD-TYPE     PIC X.
   894         16  BENE-NUMBER          PIC X(10).
   895     12  ERCOMP-KEY.
   896         16  COMP-COMP-CD        PIC X.
   897         16  COMP-CARRIER        PIC X.
   898         16  COMP-GROUP          PIC X(06).
   899         16  COMP-FIN-RESP       PIC X(10).
   900         16  COMP-ACCOUNT        PIC X(10).
   901         16  COMP-TYPE           PIC X.
   902
   903     12  DLO035-KEY.
   904         16  DL35-PROCESS-TYPE   PIC X.
   905         16  DL35-CREDIT-CARD    PIC X(20).
   906         16  DL35-BEN-TYPE       PIC XX.
   907         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   908         16  DL35-RETURN-CODE    PIC XX.
   909
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  18
* EL156.cbl
   911*    COPY ELCDATE.
   912******************************************************************
   913*                                                                *
   914*                                                                *
   915*                            ELCDATE.                            *
   916*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   917*                            VMOD=2.003
   918*                                                                *
   919*                                                                *
   920*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   921*                 LENGTH = 200                                   *
   922******************************************************************
   923
   924 01  DATE-CONVERSION-DATA.
   925     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   926     12  DC-OPTION-CODE                PIC X.
   927         88  BIN-TO-GREG                VALUE ' '.
   928         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   929         88  EDIT-GREG-TO-BIN           VALUE '2'.
   930         88  YMD-GREG-TO-BIN            VALUE '3'.
   931         88  MDY-GREG-TO-BIN            VALUE '4'.
   932         88  JULIAN-TO-BIN              VALUE '5'.
   933         88  BIN-PLUS-ELAPSED           VALUE '6'.
   934         88  FIND-CENTURY               VALUE '7'.
   935         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   936         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   937         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   938         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   939         88  JULIAN-TO-BIN-3            VALUE 'C'.
   940         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   941         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   942         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   943         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   944         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   945         88  CHECK-LEAP-YEAR            VALUE 'H'.
   946         88  BIN-3-TO-GREG              VALUE 'I'.
   947         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   948         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   949         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   950         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   951         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   952         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   953         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   954         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   955         88  THREE-CHARACTER-BIN
   956                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   957         88  GREGORIAN-TO-BIN
   958                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   959         88  BIN-TO-GREGORIAN
   960                  VALUES ' ' '1' 'I' '8' 'G'.
   961         88  JULIAN-TO-BINARY
   962                  VALUES '5' 'C' 'E' 'F'.
   963     12  DC-ERROR-CODE                 PIC X.
   964         88  NO-CONVERSION-ERROR        VALUE ' '.
   965         88  DATE-CONVERSION-ERROR
   966                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   967         88  DATE-IS-ZERO               VALUE '1'.
   968         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  19
* EL156.cbl
   969         88  DATE-IS-INVALID            VALUE '3'.
   970         88  DATE1-GREATER-DATE2        VALUE '4'.
   971         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   972         88  DATE-INVALID-OPTION        VALUE '9'.
   973         88  INVALID-CENTURY            VALUE 'A'.
   974         88  ONLY-CENTURY               VALUE 'B'.
   975         88  ONLY-LEAP-YEAR             VALUE 'C'.
   976         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   977     12  DC-END-OF-MONTH               PIC X.
   978         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   979     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   980         88  USE-NORMAL-PROCESS         VALUE ' '.
   981         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   982         88  ADJUST-UP-100-YRS          VALUE '2'.
   983     12  FILLER                        PIC X.
   984     12  DC-CONVERSION-DATES.
   985         16  DC-BIN-DATE-1             PIC XX.
   986         16  DC-BIN-DATE-2             PIC XX.
   987         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   988         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   989                       DC-GREG-DATE-1-EDIT.
   990             20  DC-EDIT1-MONTH        PIC 99.
   991             20  SLASH1-1              PIC X.
   992             20  DC-EDIT1-DAY          PIC 99.
   993             20  SLASH1-2              PIC X.
   994             20  DC-EDIT1-YEAR         PIC 99.
   995         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   996         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   997                     DC-GREG-DATE-2-EDIT.
   998             20  DC-EDIT2-MONTH        PIC 99.
   999             20  SLASH2-1              PIC X.
  1000             20  DC-EDIT2-DAY          PIC 99.
  1001             20  SLASH2-2              PIC X.
  1002             20  DC-EDIT2-YEAR         PIC 99.
  1003         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1004         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1005                     DC-GREG-DATE-1-YMD.
  1006             20  DC-YMD-YEAR           PIC 99.
  1007             20  DC-YMD-MONTH          PIC 99.
  1008             20  DC-YMD-DAY            PIC 99.
  1009         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1010         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1011                      DC-GREG-DATE-1-MDY.
  1012             20  DC-MDY-MONTH          PIC 99.
  1013             20  DC-MDY-DAY            PIC 99.
  1014             20  DC-MDY-YEAR           PIC 99.
  1015         16  DC-GREG-DATE-1-ALPHA.
  1016             20  DC-ALPHA-MONTH        PIC X(10).
  1017             20  DC-ALPHA-DAY          PIC 99.
  1018             20  FILLER                PIC XX.
  1019             20  DC-ALPHA-CENTURY.
  1020                 24 DC-ALPHA-CEN-N     PIC 99.
  1021             20  DC-ALPHA-YEAR         PIC 99.
  1022         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1023         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1024         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1025         16  DC-JULIAN-DATE            PIC 9(05).
  1026         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  20
* EL156.cbl
  1027                                       PIC 9(05).
  1028         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1029             20  DC-JULIAN-YEAR        PIC 99.
  1030             20  DC-JULIAN-DAYS        PIC 999.
  1031         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1032         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1033         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1034     12  DATE-CONVERSION-VARIBLES.
  1035         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1036         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1037             20  FILLER                PIC 9(3).
  1038             20  HOLD-CEN-1-CCYY.
  1039                 24  HOLD-CEN-1-CC     PIC 99.
  1040                 24  HOLD-CEN-1-YY     PIC 99.
  1041             20  HOLD-CEN-1-MO         PIC 99.
  1042             20  HOLD-CEN-1-DA         PIC 99.
  1043         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1044             20  HOLD-CEN-1-R-MO       PIC 99.
  1045             20  HOLD-CEN-1-R-DA       PIC 99.
  1046             20  HOLD-CEN-1-R-CCYY.
  1047                 24  HOLD-CEN-1-R-CC   PIC 99.
  1048                 24  HOLD-CEN-1-R-YY   PIC 99.
  1049             20  FILLER                PIC 9(3).
  1050         16  HOLD-CENTURY-1-X.
  1051             20  FILLER                PIC X(3)  VALUE SPACES.
  1052             20  HOLD-CEN-1-X-CCYY.
  1053                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1054                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1055             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1056             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1057         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1058             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1059             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1060             20  HOLD-CEN-1-R-X-CCYY.
  1061                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1062                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1063             20  FILLER                PIC XXX.
  1064         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1065         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1066         16  DC-JULIAN-DATE-1          PIC 9(07).
  1067         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1068             20  DC-JULIAN-1-CCYY.
  1069                 24  DC-JULIAN-1-CC    PIC 99.
  1070                 24  DC-JULIAN-1-YR    PIC 99.
  1071             20  DC-JULIAN-DA-1        PIC 999.
  1072         16  DC-JULIAN-DATE-2          PIC 9(07).
  1073         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1074             20  DC-JULIAN-2-CCYY.
  1075                 24  DC-JULIAN-2-CC    PIC 99.
  1076                 24  DC-JULIAN-2-YR    PIC 99.
  1077             20  DC-JULIAN-DA-2        PIC 999.
  1078         16  DC-GREG-DATE-A-EDIT.
  1079             20  DC-EDITA-MONTH        PIC 99.
  1080             20  SLASHA-1              PIC X VALUE '/'.
  1081             20  DC-EDITA-DAY          PIC 99.
  1082             20  SLASHA-2              PIC X VALUE '/'.
  1083             20  DC-EDITA-CCYY.
  1084                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  21
* EL156.cbl
  1085                 24  DC-EDITA-YEAR     PIC 99.
  1086         16  DC-GREG-DATE-B-EDIT.
  1087             20  DC-EDITB-MONTH        PIC 99.
  1088             20  SLASHB-1              PIC X VALUE '/'.
  1089             20  DC-EDITB-DAY          PIC 99.
  1090             20  SLASHB-2              PIC X VALUE '/'.
  1091             20  DC-EDITB-CCYY.
  1092                 24  DC-EDITB-CENT     PIC 99.
  1093                 24  DC-EDITB-YEAR     PIC 99.
  1094         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1095         16  DC-GREG-DATE-CYMD-R REDEFINES
  1096                              DC-GREG-DATE-CYMD.
  1097             20  DC-CYMD-CEN           PIC 99.
  1098             20  DC-CYMD-YEAR          PIC 99.
  1099             20  DC-CYMD-MONTH         PIC 99.
  1100             20  DC-CYMD-DAY           PIC 99.
  1101         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1102         16  DC-GREG-DATE-MDCY-R REDEFINES
  1103                              DC-GREG-DATE-MDCY.
  1104             20  DC-MDCY-MONTH         PIC 99.
  1105             20  DC-MDCY-DAY           PIC 99.
  1106             20  DC-MDCY-CEN           PIC 99.
  1107             20  DC-MDCY-YEAR          PIC 99.
  1108    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1109        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1110    12  DC-EL310-DATE                  PIC X(21).
  1111    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  22
* EL156.cbl
  1113*    COPY ELCLOGOF.
  1114******************************************************************
  1115*                                                                *
  1116*                                                                *
  1117*                            ELCLOGOF.                           *
  1118*                            VMOD=2.001                          *
  1119*                                                                *
  1120*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1121*                                                                *
  1122******************************************************************
  1123 01  CLASIC-LOGOFF.
  1124     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1125     12  LOGOFF-TEXT.
  1126         16  FILLER          PIC X(5)    VALUE SPACES.
  1127         16  LOGOFF-MSG.
  1128             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1129             20  FILLER      PIC X       VALUE SPACES.
  1130             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1131         16  FILLER          PIC X(80)
  1132           VALUE '* YOU ARE NOW LOGGED OFF'.
  1133         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1134         16  FILLER          PIC X       VALUE QUOTE.
  1135         16  LOGOFF-SYS-MSG  PIC X(17)
  1136           VALUE 'S CLAS-IC SYSTEM '.
  1137     12  TEXT-MESSAGES.
  1138         16  UNACCESS-MSG    PIC X(29)
  1139             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1140         16  PGMIDERR-MSG    PIC X(17)
  1141             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  23
* EL156.cbl
  1143*    COPY ELCCALC.
  1144******************************************************************
  1145*                                                                *
  1146*                           ELCCALC.                            *
  1147*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1148*                            VMOD=2.025                          *
  1149*                                                                *
  1150*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1151*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1152*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1153*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1154*                                                                *
  1155*  PASSED TO ELRTRM                                              *
  1156*  -----------------                                             *
  1157*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1158*  ORIGINAL TERM                                                 *
  1159*  BEGINNING DATE                                                *
  1160*  ENDING DATE                                                   *
  1161*  COMPANY I.D.                                                  *
  1162*  ACCOUNT MASTER USER FIELD                                     *
  1163*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1164*  FREE LOOK DAYS                                                *
  1165*                                                                *
  1166*  RETURNED FROM ELRTRM                                          *
  1167*  ---------------------                                         *
  1168*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1169*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1170*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1171*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1172*----------------------------------------------------------------*
  1173*  PASSED TO ELRAMT                                              *
  1174*  ----------------                                              *
  1175*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1176*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1177*  ORIGINAL AMOUNT                                               *
  1178*  ALTERNATE BENEFIT (BALLON)                                    *
  1179*  A.P.R. - NET PAY ONLY                                         *
  1180*  METHOD
  1181*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1182*  COMPANY I.D.                                                  *
  1183*  BENEFIT TYPE                                                  *
  1184*                                                                *
  1185*  RETURNED FROM ELRAMT                                          *
  1186*  --------------------                                          *
  1187*  REMAINING AMOUNT 1 - CURRENT                                  *
  1188*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1189*  REMAINING AMOUNT FACTOR
  1190*----------------------------------------------------------------*
  1191*  PASSED TO ELRESV                                              *
  1192*  -----------------                                             *
  1193*  CERTIFICATE EFFECTIVE DATE                                    *
  1194*  VALUATION DATE                                                *
  1195*  PAID THRU DATE                                                *
  1196*  BENEFIT                                                       *
  1197*  INCURRED DATE                                                 *
  1198*  REPORTED DATE                                                 *
  1199*  ISSUE AGE                                                     *
  1200*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  24
* EL156.cbl
  1201*  CDT PERCENT                                                   *
  1202*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1203* *CLAIM TYPE (LIFE, A/H)                                        *
  1204* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1205* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1206*                                                                *
  1207*  RETURNED FROM ELRESV                                          *
  1208*  --------------------                                          *
  1209*  CDT TABLE USED                                                *
  1210*  CDT FACTOR USED                                               *
  1211*  PAY TO CURRENT RESERVE                                        *
  1212*  I.B.N.R. - A/H ONLY                                           *
  1213*  FUTURE (ACCRUED) AH ONLY                                      *
  1214*----------------------------------------------------------------*
  1215*  PASSED TO ELRATE                                              *
  1216*  ----------------                                              *
  1217*  CERT ISSUE DATE                                               *
  1218*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1219*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1220*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1221*  STATE CODE (CLIENT DEFINED)                                   *
  1222*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1223*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1224*  DEVIATION CODE                                                *
  1225*  ISSUE AGE                                                     *
  1226*  ORIGINAL BENEFIT AMOUNT                                       *
  1227*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1228*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1229*  BENEFIT KIND (LIFE OR A/H)                                    *
  1230*  A.P.R.                                                        *
  1231*  METHOD
  1232*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1233*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1234*  COMPANY I.D. (3 CHARACTER)                                    *
  1235*  BENEFIT CODE                                                  *
  1236*  BENEFIT OVERRIDE CODE                                         *
  1237*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1238*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1239*  JOINT INDICATOR (CSL ONLY)                                    *
  1240*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1241*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1242*                                                                *
  1243*  RETURNED FROM ELRATE                                          *
  1244*  --------------------                                          *
  1245*  CALCULATED PREMIUM                                            *
  1246*  PREMIUM RATE                                                  *
  1247*  MORTALITY CODE                                                *
  1248*  MAX ATTAINED AGE                                              *
  1249*  MAX AGE                                                       *
  1250*  MAX TERM                                                      *
  1251*  MAX MONTHLY BENEFIT                                           *
  1252*  MAX TOTAL BENIFIT                                             *
  1253*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1254*----------------------------------------------------------------*
  1255*  PASSED TO ELRFND                                              *
  1256*  ----------------                                              *
  1257*  CERT ISSUE DATE                                               *
  1258*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  25
* EL156.cbl
  1259*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1260*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1261*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1262*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1263*  STATE CODE (CLIENT DEFINED)                                   *
  1264*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1265*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1266*  DEVIATION CODE                                                *
  1267*  ISSUE AGE                                                     *
  1268*  ORIGINAL BENEFIT AMOUNT                                       *
  1269*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1270*  PROCESS TYPE (CANCEL)                                         *
  1271*  BENEFIT KIND (LIFE OR A/H)                                    *
  1272*  A.P.R.                                                        *
  1273*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1274*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1275*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1276*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1277*  COMPANY I.D. (3 CHARACTER)                                    *
  1278*  BENEFIT CODE                                                  *
  1279*  BENEFIT OVERRIDE CODE                                         *
  1280*                                                                *
  1281*  RETURNED FROM ELRFND                                          *
  1282*  --------------------                                          *
  1283*  CALCULATED REFUND                                             *
  1284*----------------------------------------------------------------*
  1285*  PASSED TO ELEARN                                              *
  1286*  ----------------                                              *
  1287*  CERT ISSUE DATE                                               *
  1288*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1289*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1290*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1291*  STATE CODE (CLIENT DEFINED)                                   *
  1292*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1293*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1294*  DEVIATION CODE                                                *
  1295*  ISSUE AGE                                                     *
  1296*  ORIGINAL BENEFIT AMOUNT                                       *
  1297*  BENEFIT KIND (LIFE OR A/H)                                    *
  1298*  A.P.R.                                                        *
  1299*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1300*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1301*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1302*  COMPANY I.D. (3 CHARACTER)                                    *
  1303*  BENEFIT CODE                                                  *
  1304*  BENEFIT OVERRIDE CODE                                         *
  1305*                                                                *
  1306*  RETURNED FROM ELEARN                                          *
  1307*  --------------------                                          *
  1308*  INDICATED  EARNINGS                                           *
  1309*----------------------------------------------------------------*
  1310*                 LENGTH = 450                                   *
  1311*                                                                *
  1312******************************************************************
  1313******************************************************************
  1314*                   C H A N G E   L O G
  1315*
  1316* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  26
* EL156.cbl
  1317*-----------------------------------------------------------------
  1318*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1319* EFFECTIVE    NUMBER
  1320*-----------------------------------------------------------------
  1321* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1322* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1323* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1324* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1325* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1326* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1327* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1328* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1329* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1330* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1331* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1332******************************************************************
  1333
  1334 01  CALCULATION-PASS-AREA.
  1335     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1336                                     COMP.
  1337
  1338     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1339       88  NO-CP-ERROR                             VALUE ZERO.
  1340       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1341                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1342       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1343       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1344       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1345       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1346       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1347       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1348       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1349       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1350       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1351       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1352       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1353       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1354       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1355       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1356       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1357       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1358       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1359
  1360     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1361       88  NO-CP-ERROR-2                           VALUE ZERO.
  1362***********************  INPUT AREAS ****************************
  1363
  1364     12  CP-CALCULATION-AREA.
  1365         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1366         16  CP-CERT-EFF-DT        PIC XX.
  1367         16  CP-VALUATION-DT       PIC XX.
  1368         16  CP-PAID-THRU-DT       PIC XX.
  1369         16  CP-BENEFIT-TYPE       PIC X.
  1370           88  CP-AH                               VALUE 'A' 'D'
  1371                                                   'I' 'U'.
  1372           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1373           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1374         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  27
* EL156.cbl
  1375         16  CP-REPORTED-DT        PIC XX.
  1376         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  1377         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1378         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1379                                     COMP-3.
  1380         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1381                                     COMP-3.
  1382         16  CP-CDT-METHOD         PIC X.
  1383           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1384           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1385           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1386         16  CP-CLAIM-TYPE         PIC X.
  1387           88  CP-AH-CLAIM                         VALUE 'A'.
  1388           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1389         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1390                                     COMP-3.
  1391         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1392                                     COMP-3.
  1393         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1394                                     COMP-3.
  1395         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1396                                     COMP-3.
  1397         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1398                                     COMP-3.
  1399         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1400                                     COMP-3.
  1401         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1402                                     COMP-3.
  1403         16  CP-REM-TERM-METHOD    PIC X.
  1404           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1405           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1406           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1407           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1408           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1409           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1410           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1411         16  CP-EARNING-METHOD     PIC X.
  1412           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1413           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1414           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1415           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1416           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1417           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1418           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1419           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1420           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1421           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1422           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1423           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1424           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1425           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1426         16  CP-PROCESS-TYPE       PIC X.
  1427           88  CP-CLAIM                            VALUE '1'.
  1428           88  CP-CANCEL                           VALUE '2'.
  1429           88  CP-ISSUE                            VALUE '3'.
  1430         16  CP-SPECIAL-CALC-CD    PIC X.
  1431           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1432           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  28
* EL156.cbl
  1433           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1434           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  1435           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1436           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1437           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1438           88  CP-FARM-PLAN                    VALUE 'F'.
  1439           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1440           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1441           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1442           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1443           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1444           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1445           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1446           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1447           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1448           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1449                                                     'W' 'X'.
  1450           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1451           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1452           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1453           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1454           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1455           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1456           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1457           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1458           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1459           88  CP-CSL-METH-1                   VALUE '5'.
  1460           88  CP-CSL-METH-2                   VALUE '6'.
  1461           88  CP-CSL-METH-3                   VALUE '7'.
  1462           88  CP-CSL-METH-4                   VALUE '8'.
  1463
  1464         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1465                                     COMP-3.
  1466         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1467         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1468         16  CP-STATE              PIC XX          VALUE SPACE.
  1469         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1470         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1471           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1472               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1473         16  CP-R78-OPTION         PIC X.
  1474           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1475           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1476
  1477         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1478         16  CP-IBNR-RESERVE-SW    PIC X.
  1479         16  CP-CLAIM-STATUS       PIC X.
  1480         16  CP-RATE-FILE          PIC X.
  1481         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1482                                     COMP-3.
  1483
  1484         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1485         16  CP-AH-OVERRIDE-CODE   PIC X.
  1486
  1487         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1488                                     COMP-3.
  1489         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1490                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  29
* EL156.cbl
  1491         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1492                                     COMP-3.
  1493         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1494                                     COMP-3.
  1495         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1496                                     COMP-3.
  1497         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1498                                  PIC S9(7)V99 COMP-3.
  1499
  1500         16  CP-PAID-FROM-DATE     PIC X(02).
  1501         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1502         16  CP-EXT-DAYS-CALC      PIC X.
  1503           88  CP-EXT-NO-CHG                   VALUE ' '.
  1504           88  CP-EXT-CHG-LF                   VALUE '1'.
  1505           88  CP-EXT-CHG-AH                   VALUE '2'.
  1506           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1507         16  CP-DOMICILE-STATE     PIC XX.
  1508         16  CP-CARRIER            PIC X.
  1509         16  CP-REIN-FLAG          PIC X.
  1510         16  CP-REM-TRM-CALC-OPTION PIC X.
  1511           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1512                      '2' '3' '4' '5'.
  1513           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1514           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1515           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1516           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1517           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1518           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1519           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1520           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1521         16  CP-SIG-SWITCH         PIC X.
  1522         16  CP-RATING-METHOD      PIC X.
  1523           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1524           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1525           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1526           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1527           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1528           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1529           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1530           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1531           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1532         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1533                                     COMP-3.
  1534         16  CP-BEN-CATEGORY       PIC X.
  1535         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1536         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1537                                   PIC S99V9(5) COMP-3.
  1538         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1539         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1540                                   PIC S99V9(5) COMP-3.
  1541         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1542         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1543         16  CP-EXPIRE-DT          PIC XX.
  1544         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1545         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1546         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1547         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1548         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  30
* EL156.cbl
  1549             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1550             88  CP-CALC-CLP              VALUE 'C'.
  1551         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1552         16  CP-CANCEL-REASON      PIC X.
  1553         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1554         16  CP-PMT-MODE           PIC X.
  1555         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1556         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1557         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1558         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1559         16  FILLER                PIC X.
  1560
  1561***************    OUTPUT FROM ELRESV   ************************
  1562
  1563         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1564
  1565         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1566                                     COMP-3.
  1567         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1568                                     COMP-3.
  1569         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1570                                     COMP-3.
  1571         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1572                                     COMP-3.
  1573         16  FILLER                PIC X(09).
  1574***************    OUTPUT FROM ELRTRM   *************************
  1575
  1576         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1577                                     COMP-3.
  1578         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1579                                     COMP-3.
  1580         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1581                                     COMP-3.
  1582         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1583                                     COMP-3.
  1584         16  FILLER                PIC X(12).
  1585
  1586***************    OUTPUT FROM ELRAMT   *************************
  1587
  1588         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1589                                     COMP-3.
  1590         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1591                                     COMP-3.
  1592         16  FILLER                PIC X(12).
  1593
  1594***************    OUTPUT FROM ELRATE   *************************
  1595
  1596         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1597                                     COMP-3.
  1598         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1599                                     COMP-3.
  1600         16  CP-MORTALITY-CODE     PIC X(4).
  1601         16  CP-RATE-EDIT-FLAG     PIC X.
  1602             88  CP-RATES-NEED-APR                  VALUE '1'.
  1603         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1604                                     COMP-3.
  1605         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1606         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  31
* EL156.cbl
  1607         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1608                                   PIC S9(7)V99 COMP-3.
  1609         16  FILLER                PIC X(07).
  1610
  1611***************    OUTPUT FROM ELRFND   *************************
  1612
  1613         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1614                                     COMP-3.
  1615         16  CP-REFUND-TYPE-USED   PIC X.
  1616           88  CP-R-AS-R78                         VALUE '1'.
  1617           88  CP-R-AS-PRORATA                     VALUE '2'.
  1618           88  CP-R-AS-CALIF                       VALUE '3'.
  1619           88  CP-R-AS-TEXAS                       VALUE '4'.
  1620           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1621           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1622           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1623           88  CP-R-AS-MEAN                        VALUE '8'.
  1624           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1625           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1626           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1627           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1628           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1629           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1630         16  FILLER                PIC X(12).
  1631
  1632***************    OUTPUT FROM ELEARN   *************************
  1633
  1634         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1635                                     COMP-3.
  1636         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1637                                     COMP-3.
  1638         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1639                                     COMP-3.
  1640         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1641                                     COMP-3.
  1642         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1643                                     COMP-3.
  1644         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1645                                     COMP-3.
  1646         16  CP-EARNING-TYPE-USED  PIC X.
  1647           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1648           88  CP-E-AS-R78                         VALUE '1'.
  1649           88  CP-E-AS-PRORATA                     VALUE '2'.
  1650           88  CP-E-AS-TEXAS                       VALUE '4'.
  1651           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1652           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1653           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1654           88  CP-E-AS-MEAN                        VALUE '8'.
  1655           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1656         16  FILLER                PIC X(12).
  1657
  1658***************    OUTPUT FROM ELPMNT   *************************
  1659
  1660         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1661                                     COMP-3.
  1662         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1663                                     COMP-3.
  1664         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  32
* EL156.cbl
  1665
  1666***************   MISC WORK AREAS    *****************************
  1667         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1668                                     COMP-3.
  1669         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1670                                     COMP-3.
  1671         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1672                                     COMP-3.
  1673         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1674                                     COMP-3.
  1675         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1676                                     COMP-3.
  1677         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1678                                     COMP-3.
  1679         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1680             88  OPEN-RATE-FILE                   VALUE 'O'.
  1681             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1682             88  IO-ERROR                         VALUE 'E'.
  1683
  1684         16  CP-FIRST-PAY-DATE     PIC XX.
  1685
  1686         16  CP-JOINT-INDICATOR    PIC X.
  1687
  1688         16  CP-RESERVE-REMAINING-TERM
  1689                                   PIC S9(4)V9    VALUE ZERO
  1690                                     COMP-3.
  1691
  1692         16  CP-INSURED-BIRTH-DT   PIC XX.
  1693
  1694         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1695                                     COMP-3.
  1696
  1697         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1698                                     COMP-3.
  1699
  1700         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1701                                     COMP-3.
  1702
  1703         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1704                                     COMP-3.
  1705
  1706         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1707                                     COMP-3.
  1708
  1709         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1710                                     COMP-3.
  1711
  1712         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1713                                     COMP-3.
  1714
  1715         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1716             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1717
  1718         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1719                                     COMP-3.
  1720         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1721                                     COMP-3.
  1722         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  33
* EL156.cbl
  1723         16  cp-extra-periods      pic 9 value zeros.
  1724         16  cp-net-only-state     pic x value spaces.
  1725         16  FILLER                PIC X(13).
  1726******************************************************************
  1727*    COPY ELCICALC.
  1728******************************************************************
  1729*                                                                *
  1730*                           ELCCICALC.                           *
  1731*                            VMOD=2.001                          *
  1732*                                                                *
  1733*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1734*                 CALCULATION MODULE                             *
  1735*                                                                *
  1736*  PASSED TO ELCLMI                                              *
  1737*  -----------------                                             *
  1738*  STATE                                                         *
  1739*  PRODUCT                                                       *
  1740*  COVERAGE                                                      *
  1741*  EFFECTIVE DATE                                                *
  1742*  INCURRED DATE                                                 *
  1743*  ESTABLISHED DATE                                              *
  1744*  LAST PAID DATE                                                *
  1745*  REPORTED DATE                                                 *
  1746*  CLAIM PAYMENT AMOUNT                                          *
  1747*                                                                *
  1748*  RETURNED FROM ELRTRM                                          *
  1749*  ---------------------                                         *
  1750*  RETURN CODE                                                   *
  1751*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1752*  CLAIM INTEREST AMOUNT                                         *
  1753*----------------------------------------------------------------*
  1754*----------------------------------------------------------------*
  1755*                 LENGTH = 100                                   *
  1756*                                                                *
  1757******************************************************************
  1758******************************************************************
  1759*                   C H A N G E   L O G
  1760*
  1761* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1762*-----------------------------------------------------------------
  1763*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1764* EFFECTIVE    NUMBER
  1765*-----------------------------------------------------------------
  1766* 120905    2004040700004  PEMA  NEW COPYBOOK
  1767* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1768******************************************************************
  1769
  1770 01  CLAIM-INT-PASS-AREA.
  1771     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1772                                     COMP.
  1773
  1774     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1775       88  NO-CI-ERROR                             VALUE ZERO.
  1776       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1777       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1778       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1779       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1780       88  CP-AMT-LT-5000                          VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  34
* EL156.cbl
  1781       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1782       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1783       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1784       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
  1785***********************  INPUT AREAS ****************************
  1786
  1787     12  CP-CALCULATION-AREA.
  1788         16  CP-COMPANY-CD         PIC X.
  1789         16  CP-STATE              PIC XX.
  1790         16  CP-PRODUCT            PIC XX.
  1791         16  CP-COVERAGE           PIC XX.
  1792         16  CP-INC-DT             PIC XX.
  1793         16  CP-EST-DT             PIC XX.
  1794         16  CP-LSTPD-DT           PIC XX.
  1795         16  CP-RPT-DT             PIC XX.
  1796         16  CP-PRF-DT             PIC XX.
  1797         16  CP-EFF-DT             PIC XX.
  1798         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1799         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1800         16  FILLER                PIC X(37).
  1801
  1802***************    OUTPUT FROM ELCLMI   ************************
  1803
  1804         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1805
  1806         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1807         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1808         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1809         16  FILLER                PIC X(19).
  1810******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  35
* EL156.cbl
  1812*    COPY ELCATTR.
  1813******************************************************************
  1814*                                                                *
  1815*                            ELCATTR.                            *
  1816*                            VMOD=2.001                          *
  1817*                                                                *
  1818*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1819*                                                                *
  1820*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1821*                                                                *
  1822*                   POS 1   P=PROTECTED                          *
  1823*                           U=UNPROTECTED                        *
  1824*                           S=ASKIP                              *
  1825*                   POS 2   A=ALPHA/NUMERIC                      *
  1826*                           N=NUMERIC                            *
  1827*                   POS 3   N=NORMAL                             *
  1828*                           B=BRIGHT                             *
  1829*                           D=DARK                               *
  1830*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1831*                           OF=MODIFIED DATA TAG OFF             *
  1832*                                                                *
  1833*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1834******************************************************************
  1835 01  ATTRIBUTE-LIST.
  1836     12  AL-PABOF            PIC X       VALUE 'Y'.
  1837     12  AL-PABON            PIC X       VALUE 'Z'.
  1838     12  AL-PADOF            PIC X       VALUE '%'.
  1839     12  AL-PADON            PIC X       VALUE '_'.
  1840     12  AL-PANOF            PIC X       VALUE '-'.
  1841     12  AL-PANON            PIC X       VALUE '/'.
  1842     12  AL-SABOF            PIC X       VALUE '8'.
  1843     12  AL-SABON            PIC X       VALUE '9'.
  1844     12  AL-SADOF            PIC X       VALUE '@'.
  1845     12  AL-SADON            PIC X       VALUE QUOTE.
  1846     12  AL-SANOF            PIC X       VALUE '0'.
  1847     12  AL-SANON            PIC X       VALUE '1'.
  1848     12  AL-UABOF            PIC X       VALUE 'H'.
  1849     12  AL-UABON            PIC X       VALUE 'I'.
  1850     12  AL-UADOF            PIC X       VALUE '<'.
  1851     12  AL-UADON            PIC X       VALUE '('.
  1852     12  AL-UANOF            PIC X       VALUE ' '.
  1853     12  AL-UANON            PIC X       VALUE 'A'.
  1854     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1855     12  AL-UNBON            PIC X       VALUE 'R'.
  1856     12  AL-UNDOF            PIC X       VALUE '*'.
  1857     12  AL-UNDON            PIC X       VALUE ')'.
  1858     12  AL-UNNOF            PIC X       VALUE '&'.
  1859     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  36
* EL156.cbl
  1861*    COPY ELCEMIB.
  1862******************************************************************
  1863*                                                                *
  1864*                                                                *
  1865*                            ELCEMIB.                            *
  1866*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1867*                            VMOD=2.005                          *
  1868*                                                                *
  1869*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1870*                                                                *
  1871******************************************************************
  1872 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1873     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1874     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1875     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1876     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1877     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1878     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1879     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1880     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1881     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1882         88  EMI-NO-ERRORS                    VALUE '1'.
  1883         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1884         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1885     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1886         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1887     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1888         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1889         88  EMI-AREA1-FULL                   VALUE '2'.
  1890     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1891         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1892         88  EMI-AREA2-FULL                   VALUE '2'.
  1893     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1894         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1895         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1896         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1897         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1898         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1899     12  EMI-ERROR-LINES.
  1900         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1901         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1902         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1903         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1904             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1905                 24  EMI-ERR-NUM         PIC X(4).
  1906                 24  EMI-FILLER          PIC X.
  1907                 24  EMI-SEV             PIC X.
  1908                 24  FILLER              PIC X.
  1909             20  FILLER                  PIC X(02).
  1910     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1911         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1912             20  EMI-ERROR-NUMBER    PIC X(4).
  1913             20  EMI-FILL            PIC X.
  1914             20  EMI-SEVERITY        PIC X.
  1915             20  FILLER              PIC X.
  1916             20  EMI-ERROR-TEXT.
  1917                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1918                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  37
* EL156.cbl
  1919     12  EMI-SEVERITY-SAVE           PIC X.
  1920         88  EMI-NOTE                    VALUE 'N'.
  1921         88  EMI-WARNING                 VALUE 'W'.
  1922         88  EMI-FORCABLE                VALUE 'F'.
  1923         88  EMI-FATAL                   VALUE 'X'.
  1924     12  EMI-MESSAGE-FLAG            PIC X.
  1925         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1926         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1927     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1928     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1929         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1930         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1931         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1932     12  emi-claim-no                pic x(7).
  1933     12  emi-claim-type              pic x(6).
  1934     12  FILLER                      PIC X(124)  VALUE SPACES.
  1935     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1936     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1937     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1938     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  38
* EL156.cbl
  1940*    COPY ELCLNKLT.
  1941******************************************************************
  1942*                                                                *
  1943*                                                                *
  1944*                           ELCLNKLT                             *
  1945*                            VMOD=2.003                          *
  1946*                                                                *
  1947*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1948*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1949*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1950*                                                                *
  1951*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1952*   COMPLETING THE REQUIRED FIELDS.                              *
  1953*                                                                *
  1954*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1955*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1956*                              9999 INDICATES AN UNKNOWN ABEND   *
  1957*                                   WAS DETECTED.                *
  1958*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1959*                              CODES FOUND IN THE ERROR FILE.    *
  1960******************************************************************
  1961 01  W-1523-LINKDATA.
  1962     12  W-1523-COMMON-PI-DATA.
  1963         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1964         16  FILLER              PIC  X(67).
  1965         16  W-1523-COMPANY-CD   PIC  X(01).
  1966         16  FILLER              PIC  X(10).
  1967         16  W-1523-CONTROL-IN-PROGRESS.
  1968             20  W-1523-CARRIER  PIC  X(01).
  1969             20  W-1523-GROUPING PIC  X(06).
  1970             20  W-1523-STATE    PIC  X(02).
  1971             20  W-1523-ACCOUNT  PIC  X(10).
  1972             20  W-1523-CLAIM-CERT-GRP.
  1973                 24  W-1523-CLAIM-NO
  1974                                 PIC  X(07).
  1975                 24  W-1523-CERT-NO.
  1976                     28  W-1523-CERT-PRIME
  1977                                 PIC  X(10).
  1978                     28  W-1523-CERT-SFX
  1979                                 PIC  X(01).
  1980                 24  W-1523-CERT-EFF-DT
  1981                                 PIC  X(02).
  1982         16  FILLER              PIC X(265).
  1983
  1984     12  W-1523-WORK-AREA.
  1985         16  W-1523-FORM-NUMBER  PIC  X(04).
  1986         16  W-1523-NUMBER-COPIES
  1987                                 PIC  9(01).
  1988         16  W-1523-ADDR-TYPE    PIC  X(02).
  1989         16  W-1523-FOLLOW-UP-DATE
  1990                                 PIC  X(02).
  1991         16  W-1523-RESEND-DATE  PIC  X(02).
  1992         16  W-1523-ERROR-CODE   PIC  9(04).
  1993             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1994             88  W-1523-FATAL-ERROR
  1995                                    VALUES  0006 0013 0042
  1996                                            0154 0168 0169
  1997                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  39
* EL156.cbl
  1998                                            0179 0186 0281
  1999                                            0332 2055 3697
  2000                                            3698 3699 3770
  2001                                            3771 3772 7675
  2002                                            9106 9808 9883
  2003                                            9887.
  2004             88  W-1523-STOP-ERRORS
  2005                                    VALUES  0013 0042 0154
  2006                                            0168 0169 0172
  2007                                            0281 0332 2055
  2008                                            3698 3699 7675
  2009                                            9106 9808 9883
  2010                                            9999.
  2011         16  W-1523-REASON       PIC  X(70).
  2012         16  W-1523-ARCHIVE-NUMBER
  2013                                 PIC  9(08).
  2014     12  W-1523-POINTER-AREA.
  2015         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  2016         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2017         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2018         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2019         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  40
* EL156.cbl
  2021*    COPY ELCNWA.
  2022*****************************************************************
  2023*                                                               *
  2024*                                                               *
  2025*                            ELCNWA.                            *
  2026*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2027*                            VMOD=2.003                         *
  2028*                                                               *
  2029*            M O V E   N A M E   W O R K   A R E A.             *
  2030*                                                               *
  2031*****************************************************************.
  2032
  2033 01  WS-NAME-WORK-AREA.
  2034     05  WS-INSURED-LAST-NAME        PIC X(15).
  2035     05  WS-INSURED-1ST-NAME         PIC X(12).
  2036     05  WS-INSURED-MID-INIT         PIC X.
  2037
  2038     05  WS-NAME-WORK.
  2039         10  WS-NW                   PIC X
  2040             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2041
  2042     05  WS-NAME-WORK2.
  2043         10  WS-NW2                  PIC X
  2044             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2045                                        NWA-INDEX0.
  2046
  2047     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2048                                     COMP-3.
  2049
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  41
* EL156.cbl
  2051*    COPY ELCDMO.
  2052******************************************************************
  2053*                                                                *
  2054*                                                                *
  2055*                            ELCDMO.                             *
  2056*                            VMOD=2.004                          *
  2057*                                                                *
  2058*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2059*        COMMUNICATION AREA                                      *
  2060*   FILE TYPE = NA                                               *
  2061*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2062*                                                                *
  2063******************************************************************
  2064 01  DMO-COMMUNICATION-AREA.
  2065     12  DM-RECORD-TYPE                  PIC  X(02).
  2066             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2067             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2068             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2069     12  DM-DIST-CODE                    PIC  X(04).
  2070     12  DM-MAIL-CODE                    PIC  X(05).
  2071     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2072     12  DM-INSURED-NAME                 PIC  X(30).
  2073     12  DM-CLAIM-NO                     PIC  X(07).
  2074     12  DM-CLAIM-TYPE                   PIC  X.
  2075
  2076     12  DM-STATUS-DATA-AREA.
  2077         16  DM-CLAIM-STATUS             PIC  X.
  2078             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2079             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2080             88  DM-CLOSED                        VALUE '3'.
  2081             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2082             88  DM-DEFAULT                       VALUE '9'.
  2083         16  DM-STATUS-DATE              PIC  X(08).
  2084******YYYYMMDD
  2085         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2086             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2087             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2088             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2089             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2090             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2091             88  DM-RE-OPENED                     VALUE 'R'.
  2092             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2093             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2094             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2095         16  DM-STAT-CARRIER             PIC X.
  2096
  2097     12  DM-DRAFT-DATA-AREA.
  2098         16  DM-PAYMENT-TYPE             PIC  X.
  2099             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2100         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2101         16  DM-PAYMENT-DATE             PIC  X(08).
  2102******YYYYMMDD
  2103         16  DM-CERT-NO                  PIC  X(11).
  2104         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2105         16  DM-CARRIER                  PIC  X.
  2106
  2107     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  42
* EL156.cbl
  2109*    COPY ELCDMDCD.
  2110******************************************************************
  2111*                                                                *
  2112*                                                                *
  2113*                            ELCDMDCD.                           *
  2114*                            VMOD=2.001                          *
  2115*                                                                *
  2116*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2117*       COMMUNICATIONS AREA                                      *
  2118*                                                                *
  2119******************************************************************
  2120 01  CD-COMMUNICATION-AREA.
  2121     12  CD-SYSTEM-ID            PIC  X(02).
  2122         88 CD-CLAIMS                      VALUE 'CL'.
  2123         88 CD-CREDIT                      VALUE 'CR'.
  2124     12  CD-RECORD-TYPE          PIC  X(02).
  2125         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2126         88 CD-EOB-CODE                    VALUE 'EO'.
  2127         88 CD-ICD9-CODE                   VALUE 'I9'.
  2128         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2129         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2130         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2131         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2132         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2133     12  CD-RECORD-KEY           PIC  X(06).
  2134         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2135     12  CD-RETURN-CODE          PIC  X(02).
  2136     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2137     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2138     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2139     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  43
* EL156.cbl
  2141*    COPY ELCDCTB.
  2142******************************************************************
  2143*                                                                *
  2144*                                                                *
  2145*                            ELCDCTB.                            *
  2146*                            VMOD=2.002                          *
  2147*                                                                *
  2148*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2149*       COMMUNICATIONS AREA                                      *
  2150*                                                                *
  2151******************************************************************
  2152 01  DCT-COMMUNICATION-AREA.
  2153     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2154     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2155     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2156     12  DCT-PRODUCT-CODE         PIC  X(02).
  2157     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2158     12  DCT-RETURN-CODE          PIC  X(02).
  2159     12  DCT-MAIL-CODE            PIC  X(05).
  2160     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2161     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  44
* EL156.cbl
  2163 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2164 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2165 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2166 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  45
* EL156.cbl
  2168*    COPY ELCINTF.
  2169******************************************************************
  2170*                                                                *
  2171*                                                                *
  2172*                            ELCINTF.                            *
  2173*                            VMOD=2.017                          *
  2174*                                                                *
  2175*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2176*                                                                *
  2177*       LENGTH = 1024                                            *
  2178*                                                                *
  2179******************************************************************
  2180*                   C H A N G E   L O G
  2181*
  2182* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2183*-----------------------------------------------------------------
  2184*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2185* EFFECTIVE    NUMBER
  2186*-----------------------------------------------------------------
  2187* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2188******************************************************************
  2189 01  PROGRAM-INTERFACE-BLOCK.
  2190     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2191     12  PI-CALLING-PROGRAM              PIC X(8).
  2192     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2193     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2194     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2195     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2196     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2197     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2198     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2199     12  PI-COMPANY-ID                   PIC XXX.
  2200     12  PI-COMPANY-CD                   PIC X.
  2201
  2202     12  PI-COMPANY-PASSWORD             PIC X(8).
  2203
  2204     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2205
  2206     12  PI-CONTROL-IN-PROGRESS.
  2207         16  PI-CARRIER                  PIC X.
  2208         16  PI-GROUPING                 PIC X(6).
  2209         16  PI-STATE                    PIC XX.
  2210         16  PI-ACCOUNT                  PIC X(10).
  2211         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2212                                         PIC X(10).
  2213         16  PI-CLAIM-CERT-GRP.
  2214             20  PI-CLAIM-NO             PIC X(7).
  2215             20  PI-CERT-NO.
  2216                 25  PI-CERT-PRIME       PIC X(10).
  2217                 25  PI-CERT-SFX         PIC X.
  2218             20  PI-CERT-EFF-DT          PIC XX.
  2219         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2220             20  PI-PLAN-CODE            PIC X(2).
  2221             20  PI-REVISION-NUMBER      PIC X(3).
  2222             20  PI-PLAN-EFF-DT          PIC X(2).
  2223             20  PI-PLAN-EXP-DT          PIC X(2).
  2224             20  FILLER                  PIC X(11).
  2225         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  46
* EL156.cbl
  2226             20  PI-OE-REFERENCE-1.
  2227                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2228                 25  PI-OE-REF-1-SUFF    PIC XX.
  2229
  2230     12  PI-SESSION-IN-PROGRESS          PIC X.
  2231         88  CLAIM-SESSION                   VALUE '1'.
  2232         88  CREDIT-SESSION                  VALUE '2'.
  2233         88  WARRANTY-SESSION                VALUE '3'.
  2234         88  MORTGAGE-SESSION                VALUE '4'.
  2235         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2236
  2237
  2238*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2239
  2240     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2241     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2242
  2243     12  PI-CREDIT-USER                  PIC X.
  2244         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2245         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2246
  2247     12  PI-CLAIM-USER                   PIC X.
  2248         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2249         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2250
  2251     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2252         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2253         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2254         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2255         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2256         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2257
  2258     12  PI-PROCESSOR-ID                 PIC X(4).
  2259
  2260     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2261
  2262     12  PI-MEMBER-CAPTION               PIC X(10).
  2263
  2264     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2265         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2266
  2267     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2268     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2269     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2270     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2271
  2272     12  PI-AH-OVERRIDE-L1               PIC X.
  2273     12  PI-AH-OVERRIDE-L2               PIC XX.
  2274     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2275     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2276
  2277     12  PI-NEW-SYSTEM                   PIC X(2).
  2278
  2279     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2280     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2281         88  PI-USES-PAID-TO                 VALUE '1'.
  2282     12  PI-CRDTCRD-SYSTEM.
  2283         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  47
* EL156.cbl
  2284             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2285             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2286         16  PI-CC-MONTH-END-DT          PIC XX.
  2287     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2288
  2289     12  PI-OE-REFERENCE-2.
  2290         16  PI-OE-REF-2-PRIME           PIC X(10).
  2291         16  PI-OE-REF-2-SUFF            PIC X.
  2292
  2293     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2294
  2295     12  PI-LANGUAGE-TYPE                PIC X.
  2296             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2297             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2298             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2299
  2300     12  PI-POLICY-LINKAGE-IND           PIC X.
  2301         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2302         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2303                                                   LOW-VALUES.
  2304
  2305     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2306     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2307         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2308         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2309
  2310     12  PI-PROCESSOR-CSR-IND            PIC X.
  2311         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2312         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2313
  2314     12  FILLER                          PIC X(3).
  2315
  2316     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2317
  2318     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2319         PI-SYSTEM-LEVEL.
  2320
  2321         16  PI-ENTRY-CODES.
  2322             20  PI-ENTRY-CD-1           PIC X.
  2323             20  PI-ENTRY-CD-2           PIC X.
  2324
  2325         16  PI-RETURN-CODES.
  2326             20  PI-RETURN-CD-1          PIC X.
  2327             20  PI-RETURN-CD-2          PIC X.
  2328
  2329         16  PI-UPDATE-STATUS-SAVE.
  2330             20  PI-UPDATE-BY            PIC X(4).
  2331             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2332
  2333         16  PI-LOWER-CASE-LETTERS       PIC X.
  2334             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2335
  2336*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2337*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2338*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2339
  2340         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2341             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  48
* EL156.cbl
  2342             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2343             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2344             88  ACCNT-CNTL                  VALUE '3'.
  2345             88  CARR-ACCNT-CNTL             VALUE '4'.
  2346
  2347         16  PI-PROCESSOR-CAP-LIST.
  2348             20  PI-SYSTEM-CONTROLS.
  2349                24 PI-SYSTEM-DISPLAY     PIC X.
  2350                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2351                24 PI-SYSTEM-MODIFY      PIC X.
  2352                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2353             20  FILLER                  PIC XX.
  2354             20  PI-DISPLAY-CAP          PIC X.
  2355                 88  DISPLAY-CAP             VALUE 'Y'.
  2356             20  PI-MODIFY-CAP           PIC X.
  2357                 88  MODIFY-CAP              VALUE 'Y'.
  2358             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2359                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2360             20  PI-FORCE-CAP            PIC X.
  2361                 88  FORCE-CAP               VALUE 'Y'.
  2362
  2363         16  PI-PROGRAM-CONTROLS.
  2364             20  PI-PGM-PRINT-OPT        PIC X.
  2365             20  PI-PGM-FORMAT-OPT       PIC X.
  2366             20  PI-PGM-PROCESS-OPT      PIC X.
  2367             20  PI-PGM-TOTALS-OPT       PIC X.
  2368
  2369         16  PI-HELP-INTERFACE.
  2370             20  PI-LAST-ERROR-NO        PIC X(4).
  2371             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2372
  2373         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2374             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2375
  2376         16  PI-CR-CONTROL-IN-PROGRESS.
  2377             20  PI-CR-CARRIER           PIC X.
  2378             20  PI-CR-GROUPING          PIC X(6).
  2379             20  PI-CR-STATE             PIC XX.
  2380             20  PI-CR-ACCOUNT           PIC X(10).
  2381             20  PI-CR-FIN-RESP          PIC X(10).
  2382             20  PI-CR-TYPE              PIC X.
  2383
  2384         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2385
  2386         16  PI-CR-MONTH-END-DT          PIC XX.
  2387
  2388         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2389             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2390             88  PI-ZERO-CARRIER             VALUE '1'.
  2391             88  PI-ZERO-GROUPING            VALUE '2'.
  2392             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2393
  2394         16  PI-CARRIER-SECURITY         PIC X.
  2395             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2396
  2397         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2398             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2399             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  49
* EL156.cbl
  2400
  2401         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2402             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2403                                         INDEXED BY PI-ACCESS-NDX
  2404                                         PIC X.
  2405
  2406         16  PI-GA-BILLING-CONTROL       PIC X.
  2407             88  PI-GA-BILLING               VALUE '1'.
  2408
  2409         16  PI-MAIL-PROCESSING          PIC X.
  2410             88  PI-MAIL-YES                 VALUE 'Y'.
  2411
  2412         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2413
  2414         16  PI-AR-SYSTEM.
  2415             20  PI-AR-PROCESSING-CNTL   PIC X.
  2416                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2417             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2418             20  PI-AR-MONTH-END-DT      PIC XX.
  2419
  2420         16  PI-MP-SYSTEM.
  2421             20  PI-MORTGAGE-USER            PIC X.
  2422                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2423                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2424             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2425                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2426                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2427                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2428                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2429                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2430             20  PI-MP-MONTH-END-DT          PIC XX.
  2431             20  PI-MP-REFERENCE-NO.
  2432                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2433                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2434
  2435         16  PI-LABEL-CONTROL            PIC X(01).
  2436             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2437             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2438
  2439         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2440             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2441
  2442         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2443             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2444             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2445
  2446         16  FILLER                      PIC X(14).
  2447
  2448     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2449******************************************************************
  2450     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2451         16  PI-SAVE-FORM        PIC X(12).
  2452         16  PI-ACCT-KEY         PIC X(26).
  2453         16  PI-PAYEE-NAME       PIC X(30).
  2454         16  PI-DAILY-RATE       PIC S9(3)V99.
  2455         16  PI-MONTH-END-SAVE   PIC XX.
  2456         16  PI-BENEFIT-SAVE.
  2457             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  50
* EL156.cbl
  2458             20  PI-BEN-TYPE     PIC X.
  2459         16  PI-MANUAL-SW        PIC 9.
  2460         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2461         16  PI-PASS-SW          PIC X.
  2462         16  PI-PFKEY-USED       PIC X.
  2463         16  PI-CK-ASSIGN        PIC X.
  2464         16  PI-FATAL-COUNT      PIC 99.
  2465         16  PI-FORCE-COUNT      PIC 99.
  2466         16  PI-SAVE-INPUT.
  2467             20  PI-PMTTYPE      PIC X.
  2468             20  PI-PAYEE.
  2469                 24  PI-PAYEE-TYPE PIC X.
  2470                 24  PI-PAYEE-SEQ  PIC X.
  2471                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2472                   PI-PAYEE-SEQ    PIC S9.
  2473             20  PI-PMTNOTE1     PIC X(60).
  2474             20  PI-PMTNOTE2     PIC X(60).
  2475             20  PI-OFFLINE      PIC X.
  2476             20  PI-ECHECKNO     PIC X(7).
  2477             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2478                 28  PI-ECHECKNO-N     PIC X.
  2479                 28  PI-ECHECKNO-6     PIC X(6).
  2480             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2481                 24  PI-ECHECKNO-CR    PIC XX.
  2482                 24  PI-ECHECKNO-5     PIC X(5).
  2483             20  PI-HOLDTIL      PIC 9(6).
  2484             20  PI-EPYFROM      PIC 9(6).
  2485             20  PI-EPYTHRU      PIC 9(6).
  2486             20  PI-EDAYS        PIC S9(5).
  2487             20  PI-EPYAMT       PIC S9(7)V99.
  2488             20  PI-ERESV        PIC S9(7)V99.
  2489             20  PI-EEXPENS      PIC 9(6)V99.
  2490             20  PI-ETYPE        PIC X.
  2491             20  PI-CASH         PIC X.
  2492             20  PI-GROUPED      PIC X.
  2493             20  PI-INT-RATE     PIC S99V9(5).
  2494             20  PI-AIGFROM      PIC 9(6).
  2495             20  PI-LOAN-NO      PIC X(20).
  2496             20  PI-PROOF-DATE   PIC 9(6).
  2497             20  PI-PRINT-EOB-YN PIC X.
  2498             20  PI-PRINT-CLM-FRM-YN PIC X.
  2499             20  PI-PRINT-SURVEY-YN PIC X.
  2500             20  PI-SPECIAL-RELEASE-YN PIC X.
  2501             20  pi-int-to-rem-borr pic x.
  2502         16  PI-SAVE-COMPUTED.
  2503             20  PI-CCHECKNO     PIC X(7).
  2504             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2505                 28  PI-CCHECKNO-N     PIC X.
  2506                 28  PI-CCHECKNO-6     PIC X(6).
  2507             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2508                 24  PI-CCHECKNO-CR    PIC XX.
  2509                 24  PI-CCHECKNO-5     PIC X(5).
  2510             20  PI-CPYFROM      PIC XX.
  2511             20  PI-CPYTHRU      PIC XX.
  2512             20  PI-CDAYS        PIC S9(5).
  2513             20  PI-CPYAMT       PIC S9(7)V99.
  2514             20  PI-CRESV        PIC 9(6)V99.
  2515             20  PI-CEXPENS      PIC 9(6)V99.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  51
* EL156.cbl
  2516             20  PI-PMT-APPR-SW  PIC X.
  2517                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2518                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2519                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2520         16  PI-PREV-CLMNO       PIC X(7).
  2521         16  PI-LF-COVERAGE-TYPE PIC X.
  2522         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2523         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2524         16  PI-PROVISIONAL-IND  PIC X.
  2525             88 PI-PROV-PMT      VALUE 'P'.
  2526         16  PI-PREV-TRLR-KEY    PIC X(22).
  2527         16  PI-SPLIT-PMT-SW     PIC X.
  2528         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2529         16  PI-ACTIVITY-CODE    PIC 99.
  2530         16  PI-RESET-SW         PIC X.
  2531         16  PI-SPECIAL-BEN-SW   PIC X.
  2532             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2533         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2534         16  PI-EXP-DT           PIC XX.
  2535         16  PI-LOAN-DUE-DAY     PIC 99.
  2536         16  PI-3RD-PARTY-SW     PIC X.
  2537         16  PI-LOAN-UPDATE-SW   PIC X.
  2538
  2539         16  PI-DMD-DATA.
  2540             20  PI-SV-CERT-KEY       PIC X(21).
  2541             20  PI-SV-CERT-NO        PIC X(11).
  2542             20  PI-SV-BEN            PIC X(10).
  2543             20  PI-SV-CCN            PIC X(16).
  2544             20  PI-INTEREST-PAID-IND PIC X.
  2545                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2546             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2547             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2548             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2549             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2550         16  PI-AT-EOB-CODES.
  2551             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2552         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2553         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2554         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2555         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2556         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2557         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2558         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2559         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2560         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2561         16  PI-LF-BENEFIT-CD         PIC X(2).
  2562         16  PI-EOB-CODES-EXIST PIC X.
  2563         16  PI-SET-NOTE2-MDT   PIC X.
  2564         16  PI-VFY-2ND-BENE          PIC X.
  2565         16  PI-CLM-TYPE              PIC X.
  2566         16  PI-APPROVAL-LEVEL        PIC X.
  2567         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2568         16  PI-REAUDIT-NEEDED        PIC X.
  2569         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2570         16  PI-AH-BENEFIT-CD         PIC XX.
  2571         16  pi-ah-term               pic s999 comp-3.
  2572         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2573         16  pi-max-ext               pic 999.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  52
* EL156.cbl
  2574         16  pi-max-ext-used          pic x.
  2575         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2576         16  PI-JOINT-COV-IND         PIC X.
  2577             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2578             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2579         16  PI-JOINT-INSURED-IND     PIC X.
  2580             88  PI-JOINT-INSURED        VALUE 'Y'.
  2581             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2582         16  pi-int-payees-name       pic x(30).
  2583         16  PI-RB-JOINT-COV-IND      PIC X.
  2584             88  PI-RB-JOINT-COVERAGE    VALUE 'J'.
  2585             88  PI-RB-SINGLE-COVERAGE   VALUE ' '.
  2586         16  pi-ach-payment           pic x.
  2587*00781          16  FILLER                   PIC X(176).
  2588*052506         16  FILLER                   PIC X(161).
  2589*031808         16  FILLER                   PIC X(154).
  2590*091808         16  FILLER                   PIC X(152).
  2591*041710         16  FILLER                   PIC X(94).
  2592         16  FILLER                   PIC X(34).
  2593
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  53
* EL156.cbl
  2595*    COPY ELCJPFX.
  2596******************************************************************
  2597*                                                                *
  2598*                                                                *
  2599*                            ELCJPFX.                            *
  2600*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2601*                            VMOD=2.002                          *
  2602*                                                                *
  2603*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2604*                                                                *
  2605*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2606*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2607*        ELCNTL - CONTROL FILE                                   *
  2608*        ELMSTR - CLAIM MASTERS                                  *
  2609*        ELTRLR - ACTIVITY TRAILERS                              *
  2610*        ELCHKQ - CHECK QUE                                      *
  2611******************************************************************
  2612 01  JOURNAL-RECORD.
  2613     12  jp-date                     pic s9(5) comp-3.
  2614     12  jp-time                     pic s9(7) comp-3.
  2615     12  JP-USER-ID                  PIC X(4).
  2616     12  JP-FILE-ID                  PIC X(8).
  2617     12  JP-PROGRAM-ID               PIC X(8).
  2618     12  JP-RECORD-TYPE              PIC X.
  2619         88 JP-ADD              VALUE 'A'.
  2620         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2621         88 JP-AFTER-CHANGE     VALUE 'C'.
  2622         88 JP-DELETE           VALUE 'D'.
  2623         88 JP-GENERIC-DELETE   VALUE 'G'.
  2624         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2625         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2626     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2627     12  JP-RECORD-AREA
  2628
  2629
  2630                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  54
* EL156.cbl
  2632*    COPY ELCAID.
  2633******************************************************************
  2634*                                                                *
  2635*                            ELCAID.                             *
  2636*                            VMOD=2.001                          *
  2637*                                                                *
  2638*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2639*                                                                *
  2640*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2641*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2642******************************************************************
  2643
  2644 01  DFHAID.
  2645   02  DFHNULL   PIC  X  VALUE  ' '.
  2646   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2647   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2648   02  DFHPEN    PIC  X  VALUE  '='.
  2649   02  DFHOPID   PIC  X  VALUE  'W'.
  2650   02  DFHPA1    PIC  X  VALUE  '%'.
  2651   02  DFHPA2    PIC  X  VALUE  '>'.
  2652   02  DFHPA3    PIC  X  VALUE  ','.
  2653   02  DFHPF1    PIC  X  VALUE  '1'.
  2654   02  DFHPF2    PIC  X  VALUE  '2'.
  2655   02  DFHPF3    PIC  X  VALUE  '3'.
  2656   02  DFHPF4    PIC  X  VALUE  '4'.
  2657   02  DFHPF5    PIC  X  VALUE  '5'.
  2658   02  DFHPF6    PIC  X  VALUE  '6'.
  2659   02  DFHPF7    PIC  X  VALUE  '7'.
  2660   02  DFHPF8    PIC  X  VALUE  '8'.
  2661   02  DFHPF9    PIC  X  VALUE  '9'.
  2662   02  DFHPF10   PIC  X  VALUE  ':'.
  2663   02  DFHPF11   PIC  X  VALUE  '#'.
  2664   02  DFHPF12   PIC  X  VALUE  '@'.
  2665   02  DFHPF13   PIC  X  VALUE  'A'.
  2666   02  DFHPF14   PIC  X  VALUE  'B'.
  2667   02  DFHPF15   PIC  X  VALUE  'C'.
  2668   02  DFHPF16   PIC  X  VALUE  'D'.
  2669   02  DFHPF17   PIC  X  VALUE  'E'.
  2670   02  DFHPF18   PIC  X  VALUE  'F'.
  2671   02  DFHPF19   PIC  X  VALUE  'G'.
  2672   02  DFHPF20   PIC  X  VALUE  'H'.
  2673   02  DFHPF21   PIC  X  VALUE  'I'.
  2674*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2675   02  DFHPF22   PIC  X  VALUE  '['.
  2676   02  DFHPF23   PIC  X  VALUE  '.'.
  2677   02  DFHPF24   PIC  X  VALUE  '<'.
  2678   02  DFHMSRE   PIC  X  VALUE  'X'.
  2679   02  DFHSTRF   PIC  X  VALUE  'h'.
  2680   02  DFHTRIG   PIC  X  VALUE  '"'.
  2681 01  FILLER    REDEFINES DFHAID.
  2682     12  FILLER              PIC X(8).
  2683     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  55
* EL156.cbl
  2685*    COPY EL156S.
  2686 01  EL156AI.
  2687     05  FILLER            PIC  X(0012).
  2688*    -------------------------------
  2689     05  RUNDTEAL PIC S9(0004) COMP.
  2690     05  RUNDTEAF PIC  X(0001).
  2691     05  FILLER REDEFINES RUNDTEAF.
  2692         10  RUNDTEAA PIC  X(0001).
  2693     05  RUNDTEAI PIC  X(0008).
  2694*    -------------------------------
  2695     05  RUNTIMAL PIC S9(0004) COMP.
  2696     05  RUNTIMAF PIC  X(0001).
  2697     05  FILLER REDEFINES RUNTIMAF.
  2698         10  RUNTIMAA PIC  X(0001).
  2699     05  RUNTIMAI PIC  X(0005).
  2700*    -------------------------------
  2701     05  SEQUL PIC S9(0004) COMP.
  2702     05  SEQUF PIC  X(0001).
  2703     05  FILLER REDEFINES SEQUF.
  2704         10  SEQUA PIC  X(0001).
  2705     05  SEQUI PIC  X(0010).
  2706*    -------------------------------
  2707     05  CLMNOL PIC S9(0004) COMP.
  2708     05  CLMNOF PIC  X(0001).
  2709     05  FILLER REDEFINES CLMNOF.
  2710         10  CLMNOA PIC  X(0001).
  2711     05  CLMNOI PIC  X(0007).
  2712*    -------------------------------
  2713     05  CARRL PIC S9(0004) COMP.
  2714     05  CARRF PIC  X(0001).
  2715     05  FILLER REDEFINES CARRF.
  2716         10  CARRA PIC  X(0001).
  2717     05  CARRI PIC  X(0001).
  2718*    -------------------------------
  2719     05  CERTNOL PIC S9(0004) COMP.
  2720     05  CERTNOF PIC  X(0001).
  2721     05  FILLER REDEFINES CERTNOF.
  2722         10  CERTNOA PIC  X(0001).
  2723     05  CERTNOI PIC  X(0010).
  2724*    -------------------------------
  2725     05  SUFXL PIC S9(0004) COMP.
  2726     05  SUFXF PIC  X(0001).
  2727     05  FILLER REDEFINES SUFXF.
  2728         10  SUFXA PIC  X(0001).
  2729     05  SUFXI PIC  X(0001).
  2730*    -------------------------------
  2731     05  CLMTYPL PIC S9(0004) COMP.
  2732     05  CLMTYPF PIC  X(0001).
  2733     05  FILLER REDEFINES CLMTYPF.
  2734         10  CLMTYPA PIC  X(0001).
  2735     05  CLMTYPI PIC  X(0006).
  2736*    -------------------------------
  2737     05  CLMSTATL PIC S9(0004) COMP.
  2738     05  CLMSTATF PIC  X(0001).
  2739     05  FILLER REDEFINES CLMSTATF.
  2740         10  CLMSTATA PIC  X(0001).
  2741     05  CLMSTATI PIC  X(0006).
  2742*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  56
* EL156.cbl
  2743     05  LSTNMEL PIC S9(0004) COMP.
  2744     05  LSTNMEF PIC  X(0001).
  2745     05  FILLER REDEFINES LSTNMEF.
  2746         10  LSTNMEA PIC  X(0001).
  2747     05  LSTNMEI PIC  X(0015).
  2748*    -------------------------------
  2749     05  FSTNMEL PIC S9(0004) COMP.
  2750     05  FSTNMEF PIC  X(0001).
  2751     05  FILLER REDEFINES FSTNMEF.
  2752         10  FSTNMEA PIC  X(0001).
  2753     05  FSTNMEI PIC  X(0012).
  2754*    -------------------------------
  2755     05  MINITL PIC S9(0004) COMP.
  2756     05  MINITF PIC  X(0001).
  2757     05  FILLER REDEFINES MINITF.
  2758         10  MINITA PIC  X(0001).
  2759     05  MINITI PIC  X(0001).
  2760*    -------------------------------
  2761     05  PRIMHDGL PIC S9(0004) COMP.
  2762     05  PRIMHDGF PIC  X(0001).
  2763     05  FILLER REDEFINES PRIMHDGF.
  2764         10  PRIMHDGA PIC  X(0001).
  2765     05  PRIMHDGI PIC  X(0012).
  2766*    -------------------------------
  2767     05  PCERTNOL PIC S9(0004) COMP.
  2768     05  PCERTNOF PIC  X(0001).
  2769     05  FILLER REDEFINES PCERTNOF.
  2770         10  PCERTNOA PIC  X(0001).
  2771     05  PCERTNOI PIC  X(0010).
  2772*    -------------------------------
  2773     05  PSUFXL PIC S9(0004) COMP.
  2774     05  PSUFXF PIC  X(0001).
  2775     05  FILLER REDEFINES PSUFXF.
  2776         10  PSUFXA PIC  X(0001).
  2777     05  PSUFXI PIC  X(0001).
  2778*    -------------------------------
  2779     05  STATUSL PIC S9(0004) COMP.
  2780     05  STATUSF PIC  X(0001).
  2781     05  FILLER REDEFINES STATUSF.
  2782         10  STATUSA PIC  X(0001).
  2783     05  STATUSI PIC  X(0010).
  2784*    -------------------------------
  2785     05  LOANHL PIC S9(0004) COMP.
  2786     05  LOANHF PIC  X(0001).
  2787     05  FILLER REDEFINES LOANHF.
  2788         10  LOANHA PIC  X(0001).
  2789     05  LOANHI PIC  X(0014).
  2790*    -------------------------------
  2791     05  LOANNOL PIC S9(0004) COMP.
  2792     05  LOANNOF PIC  X(0001).
  2793     05  FILLER REDEFINES LOANNOF.
  2794         10  LOANNOA PIC  X(0001).
  2795     05  LOANNOI PIC  X(0025).
  2796*    -------------------------------
  2797     05  DUEDAYHL PIC S9(0004) COMP.
  2798     05  DUEDAYHF PIC  X(0001).
  2799     05  FILLER REDEFINES DUEDAYHF.
  2800         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  57
* EL156.cbl
  2801     05  DUEDAYHI PIC  X(0008).
  2802*    -------------------------------
  2803     05  DUEDAYL PIC S9(0004) COMP.
  2804     05  DUEDAYF PIC  X(0001).
  2805     05  FILLER REDEFINES DUEDAYF.
  2806         10  DUEDAYA PIC  X(0001).
  2807     05  DUEDAYI PIC  X(0002).
  2808*    -------------------------------
  2809     05  ZINTHL PIC S9(0004) COMP.
  2810     05  ZINTHF PIC  X(0001).
  2811     05  FILLER REDEFINES ZINTHF.
  2812         10  ZINTHA PIC  X(0001).
  2813     05  ZINTHI PIC  X(0009).
  2814*    -------------------------------
  2815     05  ZINTL PIC S9(0004) COMP.
  2816     05  ZINTF PIC  X(0001).
  2817     05  FILLER REDEFINES ZINTF.
  2818         10  ZINTA PIC  X(0001).
  2819     05  ZINTI PIC  99V99999.
  2820*    -------------------------------
  2821     05  PTHRHDGL PIC S9(0004) COMP.
  2822     05  PTHRHDGF PIC  X(0001).
  2823     05  FILLER REDEFINES PTHRHDGF.
  2824         10  PTHRHDGA PIC  X(0001).
  2825     05  PTHRHDGI PIC  X(0014).
  2826*    -------------------------------
  2827     05  PDTHRUL PIC S9(0004) COMP.
  2828     05  PDTHRUF PIC  X(0001).
  2829     05  FILLER REDEFINES PDTHRUF.
  2830         10  PDTHRUA PIC  X(0001).
  2831     05  PDTHRUI PIC  X(0008).
  2832*    -------------------------------
  2833     05  TOTPAIDL PIC S9(0004) COMP.
  2834     05  TOTPAIDF PIC  X(0001).
  2835     05  FILLER REDEFINES TOTPAIDF.
  2836         10  TOTPAIDA PIC  X(0001).
  2837     05  TOTPAIDI PIC  X(0010).
  2838*    -------------------------------
  2839     05  COVERL PIC S9(0004) COMP.
  2840     05  COVERF PIC  X(0001).
  2841     05  FILLER REDEFINES COVERF.
  2842         10  COVERA PIC  X(0001).
  2843     05  COVERI PIC  X(0010).
  2844*    -------------------------------
  2845     05  INCURL PIC S9(0004) COMP.
  2846     05  INCURF PIC  X(0001).
  2847     05  FILLER REDEFINES INCURF.
  2848         10  INCURA PIC  X(0001).
  2849     05  INCURI PIC  X(0008).
  2850*    -------------------------------
  2851     05  LSTDTEL PIC S9(0004) COMP.
  2852     05  LSTDTEF PIC  X(0001).
  2853     05  FILLER REDEFINES LSTDTEF.
  2854         10  LSTDTEA PIC  X(0001).
  2855     05  LSTDTEI PIC  X(0008).
  2856*    -------------------------------
  2857     05  CRTSTATL PIC S9(0004) COMP.
  2858     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  58
* EL156.cbl
  2859     05  FILLER REDEFINES CRTSTATF.
  2860         10  CRTSTATA PIC  X(0001).
  2861     05  CRTSTATI PIC  X(0010).
  2862*    -------------------------------
  2863     05  EFFECTL PIC S9(0004) COMP.
  2864     05  EFFECTF PIC  X(0001).
  2865     05  FILLER REDEFINES EFFECTF.
  2866         10  EFFECTA PIC  X(0001).
  2867     05  EFFECTI PIC  X(0008).
  2868*    -------------------------------
  2869     05  TERMSL PIC S9(0004) COMP.
  2870     05  TERMSF PIC  X(0001).
  2871     05  FILLER REDEFINES TERMSF.
  2872         10  TERMSA PIC  X(0001).
  2873     05  TERMSI PIC  X(0011).
  2874*    -------------------------------
  2875     05  STACCTL PIC S9(0004) COMP.
  2876     05  STACCTF PIC  X(0001).
  2877     05  FILLER REDEFINES STACCTF.
  2878         10  STACCTA PIC  X(0001).
  2879     05  STACCTI PIC  X(0013).
  2880*    -------------------------------
  2881     05  EXPDTEHL PIC S9(0004) COMP.
  2882     05  EXPDTEHF PIC  X(0001).
  2883     05  FILLER REDEFINES EXPDTEHF.
  2884         10  EXPDTEHA PIC  X(0001).
  2885     05  EXPDTEHI PIC  X(0014).
  2886*    -------------------------------
  2887     05  EXPDTEL PIC S9(0004) COMP.
  2888     05  EXPDTEF PIC  X(0001).
  2889     05  FILLER REDEFINES EXPDTEF.
  2890         10  EXPDTEA PIC  X(0001).
  2891     05  EXPDTEI PIC  X(0008).
  2892*    -------------------------------
  2893     05  BENECAPL PIC S9(0004) COMP.
  2894     05  BENECAPF PIC  X(0001).
  2895     05  FILLER REDEFINES BENECAPF.
  2896         10  BENECAPA PIC  X(0001).
  2897     05  BENECAPI PIC  X(0013).
  2898*    -------------------------------
  2899     05  BENEL PIC S9(0004) COMP.
  2900     05  BENEF PIC  X(0001).
  2901     05  FILLER REDEFINES BENEF.
  2902         10  BENEA PIC  X(0001).
  2903     05  BENEI PIC  X(0009).
  2904*    -------------------------------
  2905     05  FORMTYPL PIC S9(0004) COMP.
  2906     05  FORMTYPF PIC  X(0001).
  2907     05  FILLER REDEFINES FORMTYPF.
  2908         10  FORMTYPA PIC  X(0001).
  2909     05  FORMTYPI PIC  X(0001).
  2910*    -------------------------------
  2911     05  PMTTYPEL PIC S9(0004) COMP.
  2912     05  PMTTYPEF PIC  X(0001).
  2913     05  FILLER REDEFINES PMTTYPEF.
  2914         10  PMTTYPEA PIC  X(0001).
  2915     05  PMTTYPEI PIC  X(0001).
  2916*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  59
* EL156.cbl
  2917     05  PAYEEL PIC S9(0004) COMP.
  2918     05  PAYEEF PIC  X(0001).
  2919     05  FILLER REDEFINES PAYEEF.
  2920         10  PAYEEA PIC  X(0001).
  2921     05  PAYEEI PIC  X(0002).
  2922*    -------------------------------
  2923     05  CHECKNOL PIC S9(0004) COMP.
  2924     05  CHECKNOF PIC  X(0001).
  2925     05  FILLER REDEFINES CHECKNOF.
  2926         10  CHECKNOA PIC  X(0001).
  2927     05  CHECKNOI PIC  X(0007).
  2928*    -------------------------------
  2929     05  OFFLINEL PIC S9(0004) COMP.
  2930     05  OFFLINEF PIC  X(0001).
  2931     05  FILLER REDEFINES OFFLINEF.
  2932         10  OFFLINEA PIC  X(0001).
  2933     05  OFFLINEI PIC  X(0001).
  2934*    -------------------------------
  2935     05  HOLDTILL PIC S9(0004) COMP.
  2936     05  HOLDTILF PIC  X(0001).
  2937     05  FILLER REDEFINES HOLDTILF.
  2938         10  HOLDTILA PIC  X(0001).
  2939     05  HOLDTILI PIC  X(0008).
  2940*    -------------------------------
  2941     05  NOTE1L PIC S9(0004) COMP.
  2942     05  NOTE1F PIC  X(0001).
  2943     05  FILLER REDEFINES NOTE1F.
  2944         10  NOTE1A PIC  X(0001).
  2945     05  NOTE1I PIC  X(0060).
  2946*    -------------------------------
  2947     05  ITRB1L PIC S9(0004) COMP.
  2948     05  ITRB1F PIC  X(0001).
  2949     05  FILLER REDEFINES ITRB1F.
  2950         10  ITRB1A PIC  X(0001).
  2951     05  ITRB1I PIC  X(0008).
  2952*    -------------------------------
  2953     05  NOTE2L PIC S9(0004) COMP.
  2954     05  NOTE2F PIC  X(0001).
  2955     05  FILLER REDEFINES NOTE2F.
  2956         10  NOTE2A PIC  X(0001).
  2957     05  NOTE2I PIC  X(0060).
  2958*    -------------------------------
  2959     05  ITRB2L PIC S9(0004) COMP.
  2960     05  ITRB2F PIC  X(0001).
  2961     05  FILLER REDEFINES ITRB2F.
  2962         10  ITRB2A PIC  X(0001).
  2963     05  ITRB2I PIC  X(0010).
  2964*    -------------------------------
  2965     05  EOBYNL PIC S9(0004) COMP.
  2966     05  EOBYNF PIC  X(0001).
  2967     05  FILLER REDEFINES EOBYNF.
  2968         10  EOBYNA PIC  X(0001).
  2969     05  EOBYNI PIC  X(0001).
  2970*    -------------------------------
  2971     05  CLMFMYNL PIC S9(0004) COMP.
  2972     05  CLMFMYNF PIC  X(0001).
  2973     05  FILLER REDEFINES CLMFMYNF.
  2974         10  CLMFMYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  60
* EL156.cbl
  2975     05  CLMFMYNI PIC  X(0001).
  2976*    -------------------------------
  2977     05  SURVYYNL PIC S9(0004) COMP.
  2978     05  SURVYYNF PIC  X(0001).
  2979     05  FILLER REDEFINES SURVYYNF.
  2980         10  SURVYYNA PIC  X(0001).
  2981     05  SURVYYNI PIC  X(0001).
  2982*    -------------------------------
  2983     05  SPRELYNL PIC S9(0004) COMP.
  2984     05  SPRELYNF PIC  X(0001).
  2985     05  FILLER REDEFINES SPRELYNF.
  2986         10  SPRELYNA PIC  X(0001).
  2987     05  SPRELYNI PIC  X(0001).
  2988*    -------------------------------
  2989     05  PINTHL PIC S9(0004) COMP.
  2990     05  PINTHF PIC  X(0001).
  2991     05  FILLER REDEFINES PINTHF.
  2992         10  PINTHA PIC  X(0001).
  2993     05  PINTHI PIC  X(0004).
  2994*    -------------------------------
  2995     05  PINTL PIC S9(0004) COMP.
  2996     05  PINTF PIC  X(0001).
  2997     05  FILLER REDEFINES PINTF.
  2998         10  PINTA PIC  X(0001).
  2999     05  PINTI PIC  X(0008).
  3000*    -------------------------------
  3001     05  ITRBYNL PIC S9(0004) COMP.
  3002     05  ITRBYNF PIC  X(0001).
  3003     05  FILLER REDEFINES ITRBYNF.
  3004         10  ITRBYNA PIC  X(0001).
  3005     05  ITRBYNI PIC  X(0001).
  3006*    -------------------------------
  3007     05  PROOFDTL PIC S9(0004) COMP.
  3008     05  PROOFDTF PIC  X(0001).
  3009     05  FILLER REDEFINES PROOFDTF.
  3010         10  PROOFDTA PIC  X(0001).
  3011     05  PROOFDTI PIC  X(0008).
  3012*    -------------------------------
  3013     05  AIGFRMHL PIC S9(0004) COMP.
  3014     05  AIGFRMHF PIC  X(0001).
  3015     05  FILLER REDEFINES AIGFRMHF.
  3016         10  AIGFRMHA PIC  X(0001).
  3017     05  AIGFRMHI PIC  X(0012).
  3018*    -------------------------------
  3019     05  AIGFROML PIC S9(0004) COMP.
  3020     05  AIGFROMF PIC  X(0001).
  3021     05  FILLER REDEFINES AIGFROMF.
  3022         10  AIGFROMA PIC  X(0001).
  3023     05  AIGFROMI PIC  X(0008).
  3024*    -------------------------------
  3025     05  PMTHDGAL PIC S9(0004) COMP.
  3026     05  PMTHDGAF PIC  X(0001).
  3027     05  FILLER REDEFINES PMTHDGAF.
  3028         10  PMTHDGAA PIC  X(0001).
  3029     05  PMTHDGAI PIC  X(0066).
  3030*    -------------------------------
  3031     05  EPYFROML PIC S9(0004) COMP.
  3032     05  EPYFROMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  61
* EL156.cbl
  3033     05  FILLER REDEFINES EPYFROMF.
  3034         10  EPYFROMA PIC  X(0001).
  3035     05  EPYFROMI PIC  X(0008).
  3036*    -------------------------------
  3037     05  EPYTHRUL PIC S9(0004) COMP.
  3038     05  EPYTHRUF PIC  X(0001).
  3039     05  FILLER REDEFINES EPYTHRUF.
  3040         10  EPYTHRUA PIC  X(0001).
  3041     05  EPYTHRUI PIC  X(0008).
  3042*    -------------------------------
  3043     05  EDAYSL PIC S9(0004) COMP.
  3044     05  EDAYSF PIC  X(0001).
  3045     05  FILLER REDEFINES EDAYSF.
  3046         10  EDAYSA PIC  X(0001).
  3047     05  EDAYSI PIC  S9(6).
  3048*    -------------------------------
  3049     05  EPYAMTL PIC S9(0004) COMP.
  3050     05  EPYAMTF PIC  X(0001).
  3051     05  FILLER REDEFINES EPYAMTF.
  3052         10  EPYAMTA PIC  X(0001).
  3053     05  EPYAMTI PIC  S9(8)V99.
  3054*    -------------------------------
  3055     05  ERESVL PIC S9(0004) COMP.
  3056     05  ERESVF PIC  X(0001).
  3057     05  FILLER REDEFINES ERESVF.
  3058         10  ERESVA PIC  X(0001).
  3059     05  ERESVI PIC  S9(7)V99.
  3060*    -------------------------------
  3061     05  ETYPEL PIC S9(0004) COMP.
  3062     05  ETYPEF PIC  X(0001).
  3063     05  FILLER REDEFINES ETYPEF.
  3064         10  ETYPEA PIC  X(0001).
  3065     05  ETYPEI PIC  X(0001).
  3066*    -------------------------------
  3067     05  EEXPENSL PIC S9(0004) COMP.
  3068     05  EEXPENSF PIC  X(0001).
  3069     05  FILLER REDEFINES EEXPENSF.
  3070         10  EEXPENSA PIC  X(0001).
  3071     05  EEXPENSI PIC  9(6)V99.
  3072*    -------------------------------
  3073     05  CPYFROML PIC S9(0004) COMP.
  3074     05  CPYFROMF PIC  X(0001).
  3075     05  FILLER REDEFINES CPYFROMF.
  3076         10  CPYFROMA PIC  X(0001).
  3077     05  CPYFROMI PIC  X(0008).
  3078*    -------------------------------
  3079     05  CPYTHRUL PIC S9(0004) COMP.
  3080     05  CPYTHRUF PIC  X(0001).
  3081     05  FILLER REDEFINES CPYTHRUF.
  3082         10  CPYTHRUA PIC  X(0001).
  3083     05  CPYTHRUI PIC  X(0008).
  3084*    -------------------------------
  3085     05  CDAYSL PIC S9(0004) COMP.
  3086     05  CDAYSF PIC  X(0001).
  3087     05  FILLER REDEFINES CDAYSF.
  3088         10  CDAYSA PIC  X(0001).
  3089     05  CDAYSI PIC  9(6).
  3090*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  62
* EL156.cbl
  3091     05  CPYAMTL PIC S9(0004) COMP.
  3092     05  CPYAMTF PIC  X(0001).
  3093     05  FILLER REDEFINES CPYAMTF.
  3094         10  CPYAMTA PIC  X(0001).
  3095     05  CPYAMTI PIC  S9(8)V99.
  3096*    -------------------------------
  3097     05  CRESVL PIC S9(0004) COMP.
  3098     05  CRESVF PIC  X(0001).
  3099     05  FILLER REDEFINES CRESVF.
  3100         10  CRESVA PIC  X(0001).
  3101     05  CRESVI PIC  9(6)V99.
  3102*    -------------------------------
  3103     05  CEXPENSL PIC S9(0004) COMP.
  3104     05  CEXPENSF PIC  X(0001).
  3105     05  FILLER REDEFINES CEXPENSF.
  3106         10  CEXPENSA PIC  X(0001).
  3107     05  CEXPENSI PIC  9(6)V99.
  3108*    -------------------------------
  3109     05  ERRMSG0L PIC S9(0004) COMP.
  3110     05  ERRMSG0F PIC  X(0001).
  3111     05  FILLER REDEFINES ERRMSG0F.
  3112         10  ERRMSG0A PIC  X(0001).
  3113     05  ERRMSG0I PIC  X(0072).
  3114*    -------------------------------
  3115     05  ERRMSG1L PIC S9(0004) COMP.
  3116     05  ERRMSG1F PIC  X(0001).
  3117     05  FILLER REDEFINES ERRMSG1F.
  3118         10  ERRMSG1A PIC  X(0001).
  3119     05  ERRMSG1I PIC  X(0072).
  3120*    -------------------------------
  3121     05  ERRMSG2L PIC S9(0004) COMP.
  3122     05  ERRMSG2F PIC  X(0001).
  3123     05  FILLER REDEFINES ERRMSG2F.
  3124         10  ERRMSG2A PIC  X(0001).
  3125     05  ERRMSG2I PIC  X(0072).
  3126*    -------------------------------
  3127     05  ENTERPFL PIC S9(0004) COMP.
  3128     05  ENTERPFF PIC  X(0001).
  3129     05  FILLER REDEFINES ENTERPFF.
  3130         10  ENTERPFA PIC  X(0001).
  3131     05  ENTERPFI PIC  99.
  3132*    -------------------------------
  3133     05  PF6TITL PIC S9(0004) COMP.
  3134     05  PF6TITF PIC  X(0001).
  3135     05  FILLER REDEFINES PF6TITF.
  3136         10  PF6TITA PIC  X(0001).
  3137     05  PF6TITI PIC  X(0016).
  3138 01  EL156AO REDEFINES EL156AI.
  3139     05  FILLER            PIC  X(0012).
  3140*    -------------------------------
  3141     05  FILLER            PIC  X(0003).
  3142     05  RUNDTEAO PIC  X(0008).
  3143*    -------------------------------
  3144     05  FILLER            PIC  X(0003).
  3145     05  RUNTIMAO PIC  99.99.
  3146*    -------------------------------
  3147     05  FILLER            PIC  X(0003).
  3148     05  SEQUO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  63
* EL156.cbl
  3149*    -------------------------------
  3150     05  FILLER            PIC  X(0003).
  3151     05  CLMNOO PIC  X(0007).
  3152*    -------------------------------
  3153     05  FILLER            PIC  X(0003).
  3154     05  CARRO PIC  X(0001).
  3155*    -------------------------------
  3156     05  FILLER            PIC  X(0003).
  3157     05  CERTNOO PIC  X(0010).
  3158*    -------------------------------
  3159     05  FILLER            PIC  X(0003).
  3160     05  SUFXO PIC  X(0001).
  3161*    -------------------------------
  3162     05  FILLER            PIC  X(0003).
  3163     05  CLMTYPO PIC  X(0006).
  3164*    -------------------------------
  3165     05  FILLER            PIC  X(0003).
  3166     05  CLMSTATO PIC  X(0006).
  3167*    -------------------------------
  3168     05  FILLER            PIC  X(0003).
  3169     05  LSTNMEO PIC  X(0015).
  3170*    -------------------------------
  3171     05  FILLER            PIC  X(0003).
  3172     05  FSTNMEO PIC  X(0012).
  3173*    -------------------------------
  3174     05  FILLER            PIC  X(0003).
  3175     05  MINITO PIC  X(0001).
  3176*    -------------------------------
  3177     05  FILLER            PIC  X(0003).
  3178     05  PRIMHDGO PIC  X(0012).
  3179*    -------------------------------
  3180     05  FILLER            PIC  X(0003).
  3181     05  PCERTNOO PIC  X(0010).
  3182*    -------------------------------
  3183     05  FILLER            PIC  X(0003).
  3184     05  PSUFXO PIC  X(0001).
  3185*    -------------------------------
  3186     05  FILLER            PIC  X(0003).
  3187     05  STATUSO PIC  X(0010).
  3188*    -------------------------------
  3189     05  FILLER            PIC  X(0003).
  3190     05  LOANHO PIC  X(0014).
  3191*    -------------------------------
  3192     05  FILLER            PIC  X(0003).
  3193     05  LOANNOO PIC  X(0025).
  3194*    -------------------------------
  3195     05  FILLER            PIC  X(0003).
  3196     05  DUEDAYHO PIC  X(0008).
  3197*    -------------------------------
  3198     05  FILLER            PIC  X(0003).
  3199     05  DUEDAYO PIC  X(0002).
  3200*    -------------------------------
  3201     05  FILLER            PIC  X(0003).
  3202     05  ZINTHO PIC  X(0009).
  3203*    -------------------------------
  3204     05  FILLER            PIC  X(0003).
  3205     05  ZINTO PIC  9.99999.
  3206*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  64
* EL156.cbl
  3207     05  FILLER            PIC  X(0003).
  3208     05  PTHRHDGO PIC  X(0014).
  3209*    -------------------------------
  3210     05  FILLER            PIC  X(0003).
  3211     05  PDTHRUO PIC  X(0008).
  3212*    -------------------------------
  3213     05  FILLER            PIC  X(0003).
  3214     05  TOTPAIDO PIC  Z(6).99-.
  3215*    -------------------------------
  3216     05  FILLER            PIC  X(0003).
  3217     05  COVERO PIC  X(0010).
  3218*    -------------------------------
  3219     05  FILLER            PIC  X(0003).
  3220     05  INCURO PIC  X(0008).
  3221*    -------------------------------
  3222     05  FILLER            PIC  X(0003).
  3223     05  LSTDTEO PIC  X(0008).
  3224*    -------------------------------
  3225     05  FILLER            PIC  X(0003).
  3226     05  CRTSTATO PIC  X(0010).
  3227*    -------------------------------
  3228     05  FILLER            PIC  X(0003).
  3229     05  EFFECTO PIC  X(0008).
  3230*    -------------------------------
  3231     05  FILLER            PIC  X(0003).
  3232     05  TERMSO PIC  X(0011).
  3233*    -------------------------------
  3234     05  FILLER            PIC  X(0003).
  3235     05  STACCTO PIC  X(0013).
  3236*    -------------------------------
  3237     05  FILLER            PIC  X(0003).
  3238     05  EXPDTEHO PIC  X(0014).
  3239*    -------------------------------
  3240     05  FILLER            PIC  X(0003).
  3241     05  EXPDTEO PIC  X(0008).
  3242*    -------------------------------
  3243     05  FILLER            PIC  X(0003).
  3244     05  BENECAPO PIC  X(0013).
  3245*    -------------------------------
  3246     05  FILLER            PIC  X(0003).
  3247     05  BENEO PIC  Z(6).99.
  3248*    -------------------------------
  3249     05  FILLER            PIC  X(0003).
  3250     05  FORMTYPO PIC  X(0001).
  3251*    -------------------------------
  3252     05  FILLER            PIC  X(0003).
  3253     05  PMTTYPEO PIC  X(0001).
  3254*    -------------------------------
  3255     05  FILLER            PIC  X(0003).
  3256     05  PAYEEO PIC  X(0002).
  3257*    -------------------------------
  3258     05  FILLER            PIC  X(0003).
  3259     05  CHECKNOO PIC  X(0007).
  3260*    -------------------------------
  3261     05  FILLER            PIC  X(0003).
  3262     05  OFFLINEO PIC  X(0001).
  3263*    -------------------------------
  3264     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  65
* EL156.cbl
  3265     05  HOLDTILO PIC  99B99B99.
  3266*    -------------------------------
  3267     05  FILLER            PIC  X(0003).
  3268     05  NOTE1O PIC  X(0060).
  3269*    -------------------------------
  3270     05  FILLER            PIC  X(0003).
  3271     05  ITRB1O PIC  X(0008).
  3272*    -------------------------------
  3273     05  FILLER            PIC  X(0003).
  3274     05  NOTE2O PIC  X(0060).
  3275*    -------------------------------
  3276     05  FILLER            PIC  X(0003).
  3277     05  ITRB2O PIC  X(0010).
  3278*    -------------------------------
  3279     05  FILLER            PIC  X(0003).
  3280     05  EOBYNO PIC  X(0001).
  3281*    -------------------------------
  3282     05  FILLER            PIC  X(0003).
  3283     05  CLMFMYNO PIC  X(0001).
  3284*    -------------------------------
  3285     05  FILLER            PIC  X(0003).
  3286     05  SURVYYNO PIC  X(0001).
  3287*    -------------------------------
  3288     05  FILLER            PIC  X(0003).
  3289     05  SPRELYNO PIC  X(0001).
  3290*    -------------------------------
  3291     05  FILLER            PIC  X(0003).
  3292     05  PINTHO PIC  X(0004).
  3293*    -------------------------------
  3294     05  FILLER            PIC  X(0003).
  3295     05  PINTO PIC  Z,ZZ9.99.
  3296*    -------------------------------
  3297     05  FILLER            PIC  X(0003).
  3298     05  ITRBYNO PIC  X(0001).
  3299*    -------------------------------
  3300     05  FILLER            PIC  X(0003).
  3301     05  PROOFDTO PIC  99B99B99.
  3302*    -------------------------------
  3303     05  FILLER            PIC  X(0003).
  3304     05  AIGFRMHO PIC  X(0012).
  3305*    -------------------------------
  3306     05  FILLER            PIC  X(0003).
  3307     05  AIGFROMO PIC  99B99B99.
  3308*    -------------------------------
  3309     05  FILLER            PIC  X(0003).
  3310     05  PMTHDGAO PIC  X(0066).
  3311*    -------------------------------
  3312     05  FILLER            PIC  X(0003).
  3313     05  EPYFROMO PIC  99B99B99.
  3314*    -------------------------------
  3315     05  FILLER            PIC  X(0003).
  3316     05  EPYTHRUO PIC  99B99B99.
  3317*    -------------------------------
  3318     05  FILLER            PIC  X(0003).
  3319     05  EDAYSO PIC  Z(4)9-.
  3320*    -------------------------------
  3321     05  FILLER            PIC  X(0003).
  3322     05  EPYAMTO PIC  Z(6).99-.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  66
* EL156.cbl
  3323*    -------------------------------
  3324     05  FILLER            PIC  X(0003).
  3325     05  ERESVO PIC  Z(5).99-.
  3326*    -------------------------------
  3327     05  FILLER            PIC  X(0003).
  3328     05  ETYPEO PIC  X(0001).
  3329*    -------------------------------
  3330     05  FILLER            PIC  X(0003).
  3331     05  EEXPENSO PIC  Z(5).99.
  3332*    -------------------------------
  3333     05  FILLER            PIC  X(0003).
  3334     05  CPYFROMO PIC  99B99B99.
  3335*    -------------------------------
  3336     05  FILLER            PIC  X(0003).
  3337     05  CPYTHRUO PIC  99B99B99.
  3338*    -------------------------------
  3339     05  FILLER            PIC  X(0003).
  3340     05  CDAYSO PIC  Z(4)9-.
  3341*    -------------------------------
  3342     05  FILLER            PIC  X(0003).
  3343     05  CPYAMTO PIC  Z(6).99-.
  3344*    -------------------------------
  3345     05  FILLER            PIC  X(0003).
  3346     05  CRESVO PIC  Z(5).99.
  3347*    -------------------------------
  3348     05  FILLER            PIC  X(0003).
  3349     05  CEXPENSO PIC  Z(5).99.
  3350*    -------------------------------
  3351     05  FILLER            PIC  X(0003).
  3352     05  ERRMSG0O PIC  X(0072).
  3353*    -------------------------------
  3354     05  FILLER            PIC  X(0003).
  3355     05  ERRMSG1O PIC  X(0072).
  3356*    -------------------------------
  3357     05  FILLER            PIC  X(0003).
  3358     05  ERRMSG2O PIC  X(0072).
  3359*    -------------------------------
  3360     05  FILLER            PIC  X(0003).
  3361     05  ENTERPFO PIC  X(0002).
  3362*    -------------------------------
  3363     05  FILLER            PIC  X(0003).
  3364     05  PF6TITO PIC  X(0016).
  3365*    -------------------------------
  3366 01  EL156BI REDEFINES EL156AI.
  3367     05  FILLER            PIC  X(0012).
  3368*    -------------------------------
  3369     05  RUNDTEBL PIC S9(0004) COMP.
  3370     05  RUNDTEBF PIC  X(0001).
  3371     05  FILLER REDEFINES RUNDTEBF.
  3372         10  RUNDTEBA PIC  X(0001).
  3373     05  RUNDTEBI PIC  X(0008).
  3374*    -------------------------------
  3375     05  RUNTIMBL PIC S9(0004) COMP.
  3376     05  RUNTIMBF PIC  X(0001).
  3377     05  FILLER REDEFINES RUNTIMBF.
  3378         10  RUNTIMBA PIC  X(0001).
  3379     05  RUNTIMBI PIC  X(0005).
  3380*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  67
* EL156.cbl
  3381     05  PAYDTBL PIC S9(0004) COMP.
  3382     05  PAYDTBF PIC  X(0001).
  3383     05  FILLER REDEFINES PAYDTBF.
  3384         10  PAYDTBA PIC  X(0001).
  3385     05  PAYDTBI PIC  X(0008).
  3386*    -------------------------------
  3387     05  PAYTYPBL PIC S9(0004) COMP.
  3388     05  PAYTYPBF PIC  X(0001).
  3389     05  FILLER REDEFINES PAYTYPBF.
  3390         10  PAYTYPBA PIC  X(0001).
  3391     05  PAYTYPBI PIC  X(0015).
  3392*    -------------------------------
  3393     05  PAYAMTBL PIC S9(0004) COMP.
  3394     05  PAYAMTBF PIC  X(0001).
  3395     05  FILLER REDEFINES PAYAMTBF.
  3396         10  PAYAMTBA PIC  X(0001).
  3397     05  PAYAMTBI PIC  X(0011).
  3398*    -------------------------------
  3399     05  LOANHBL PIC S9(0004) COMP.
  3400     05  LOANHBF PIC  X(0001).
  3401     05  FILLER REDEFINES LOANHBF.
  3402         10  LOANHBA PIC  X(0001).
  3403     05  LOANHBI PIC  X(0012).
  3404*    -------------------------------
  3405     05  LOANNBL PIC S9(0004) COMP.
  3406     05  LOANNBF PIC  X(0001).
  3407     05  FILLER REDEFINES LOANNBF.
  3408         10  LOANNBA PIC  X(0001).
  3409     05  LOANNBI PIC  X(0025).
  3410*    -------------------------------
  3411     05  CKNUMHDL PIC S9(0004) COMP.
  3412     05  CKNUMHDF PIC  X(0001).
  3413     05  FILLER REDEFINES CKNUMHDF.
  3414         10  CKNUMHDA PIC  X(0001).
  3415     05  CKNUMHDI PIC  X(0012).
  3416*    -------------------------------
  3417     05  CKNUMBL PIC S9(0004) COMP.
  3418     05  CKNUMBF PIC  X(0001).
  3419     05  FILLER REDEFINES CKNUMBF.
  3420         10  CKNUMBA PIC  X(0001).
  3421     05  CKNUMBI PIC  X(0007).
  3422*    -------------------------------
  3423     05  AGTHDGL PIC S9(0004) COMP.
  3424     05  AGTHDGF PIC  X(0001).
  3425     05  FILLER REDEFINES AGTHDGF.
  3426         10  AGTHDGA PIC  X(0001).
  3427     05  AGTHDGI PIC  X(0016).
  3428*    -------------------------------
  3429     05  NAMEBL PIC S9(0004) COMP.
  3430     05  NAMEBF PIC  X(0001).
  3431     05  FILLER REDEFINES NAMEBF.
  3432         10  NAMEBA PIC  X(0001).
  3433     05  NAMEBI PIC  X(0030).
  3434*    -------------------------------
  3435     05  NAMEB2L PIC S9(0004) COMP.
  3436     05  NAMEB2F PIC  X(0001).
  3437     05  FILLER REDEFINES NAMEB2F.
  3438         10  NAMEB2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  68
* EL156.cbl
  3439     05  NAMEB2I PIC  X(0030).
  3440*    -------------------------------
  3441     05  ADDR1BL PIC S9(0004) COMP.
  3442     05  ADDR1BF PIC  X(0001).
  3443     05  FILLER REDEFINES ADDR1BF.
  3444         10  ADDR1BA PIC  X(0001).
  3445     05  ADDR1BI PIC  X(0030).
  3446*    -------------------------------
  3447     05  ADDR1B2L PIC S9(0004) COMP.
  3448     05  ADDR1B2F PIC  X(0001).
  3449     05  FILLER REDEFINES ADDR1B2F.
  3450         10  ADDR1B2A PIC  X(0001).
  3451     05  ADDR1B2I PIC  X(0030).
  3452*    -------------------------------
  3453     05  ADDR2BL PIC S9(0004) COMP.
  3454     05  ADDR2BF PIC  X(0001).
  3455     05  FILLER REDEFINES ADDR2BF.
  3456         10  ADDR2BA PIC  X(0001).
  3457     05  ADDR2BI PIC  X(0030).
  3458*    -------------------------------
  3459     05  ADDR2B2L PIC S9(0004) COMP.
  3460     05  ADDR2B2F PIC  X(0001).
  3461     05  FILLER REDEFINES ADDR2B2F.
  3462         10  ADDR2B2A PIC  X(0001).
  3463     05  ADDR2B2I PIC  X(0030).
  3464*    -------------------------------
  3465     05  CITYSTBL PIC S9(0004) COMP.
  3466     05  CITYSTBF PIC  X(0001).
  3467     05  FILLER REDEFINES CITYSTBF.
  3468         10  CITYSTBA PIC  X(0001).
  3469     05  CITYSTBI PIC  X(0030).
  3470*    -------------------------------
  3471     05  CITYST2L PIC S9(0004) COMP.
  3472     05  CITYST2F PIC  X(0001).
  3473     05  FILLER REDEFINES CITYST2F.
  3474         10  CITYST2A PIC  X(0001).
  3475     05  CITYST2I PIC  X(0030).
  3476*    -------------------------------
  3477     05  ZIPBL PIC S9(0004) COMP.
  3478     05  ZIPBF PIC  X(0001).
  3479     05  FILLER REDEFINES ZIPBF.
  3480         10  ZIPBA PIC  X(0001).
  3481     05  ZIPBI PIC  X(0009).
  3482*    -------------------------------
  3483     05  ZIPB2L PIC S9(0004) COMP.
  3484     05  ZIPB2F PIC  X(0001).
  3485     05  FILLER REDEFINES ZIPB2F.
  3486         10  ZIPB2A PIC  X(0001).
  3487     05  ZIPB2I PIC  X(0009).
  3488*    -------------------------------
  3489     05  INTHDBL PIC S9(0004) COMP.
  3490     05  INTHDBF PIC  X(0001).
  3491     05  FILLER REDEFINES INTHDBF.
  3492         10  INTHDBA PIC  X(0001).
  3493     05  INTHDBI PIC  X(0012).
  3494*    -------------------------------
  3495     05  INTAMTBL PIC S9(0004) COMP.
  3496     05  INTAMTBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  69
* EL156.cbl
  3497     05  FILLER REDEFINES INTAMTBF.
  3498         10  INTAMTBA PIC  X(0001).
  3499     05  INTAMTBI PIC  X(0011).
  3500*    -------------------------------
  3501     05  PMTHDGBL PIC S9(0004) COMP.
  3502     05  PMTHDGBF PIC  X(0001).
  3503     05  FILLER REDEFINES PMTHDGBF.
  3504         10  PMTHDGBA PIC  X(0001).
  3505     05  PMTHDGBI PIC  X(0034).
  3506*    -------------------------------
  3507     05  CLMNOBL PIC S9(0004) COMP.
  3508     05  CLMNOBF PIC  X(0001).
  3509     05  FILLER REDEFINES CLMNOBF.
  3510         10  CLMNOBA PIC  X(0001).
  3511     05  CLMNOBI PIC  X(0007).
  3512*    -------------------------------
  3513     05  CARRBL PIC S9(0004) COMP.
  3514     05  CARRBF PIC  X(0001).
  3515     05  FILLER REDEFINES CARRBF.
  3516         10  CARRBA PIC  X(0001).
  3517     05  CARRBI PIC  X(0001).
  3518*    -------------------------------
  3519     05  CERTNOBL PIC S9(0004) COMP.
  3520     05  CERTNOBF PIC  X(0001).
  3521     05  FILLER REDEFINES CERTNOBF.
  3522         10  CERTNOBA PIC  X(0001).
  3523     05  CERTNOBI PIC  X(0010).
  3524*    -------------------------------
  3525     05  SUFXBL PIC S9(0004) COMP.
  3526     05  SUFXBF PIC  X(0001).
  3527     05  FILLER REDEFINES SUFXBF.
  3528         10  SUFXBA PIC  X(0001).
  3529     05  SUFXBI PIC  X(0001).
  3530*    -------------------------------
  3531     05  CLMTYPBL PIC S9(0004) COMP.
  3532     05  CLMTYPBF PIC  X(0001).
  3533     05  FILLER REDEFINES CLMTYPBF.
  3534         10  CLMTYPBA PIC  X(0001).
  3535     05  CLMTYPBI PIC  X(0006).
  3536*    -------------------------------
  3537     05  INCURBL PIC S9(0004) COMP.
  3538     05  INCURBF PIC  X(0001).
  3539     05  FILLER REDEFINES INCURBF.
  3540         10  INCURBA PIC  X(0001).
  3541     05  INCURBI PIC  X(0008).
  3542*    -------------------------------
  3543     05  PYFROMBL PIC S9(0004) COMP.
  3544     05  PYFROMBF PIC  X(0001).
  3545     05  FILLER REDEFINES PYFROMBF.
  3546         10  PYFROMBA PIC  X(0001).
  3547     05  PYFROMBI PIC  X(0008).
  3548*    -------------------------------
  3549     05  PYTHRUBL PIC S9(0004) COMP.
  3550     05  PYTHRUBF PIC  X(0001).
  3551     05  FILLER REDEFINES PYTHRUBF.
  3552         10  PYTHRUBA PIC  X(0001).
  3553     05  PYTHRUBI PIC  X(0008).
  3554*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  70
* EL156.cbl
  3555     05  DAYSBL PIC S9(0004) COMP.
  3556     05  DAYSBF PIC  X(0001).
  3557     05  FILLER REDEFINES DAYSBF.
  3558         10  DAYSBA PIC  X(0001).
  3559     05  DAYSBI PIC  X(0005).
  3560*    -------------------------------
  3561     05  BYBL PIC S9(0004) COMP.
  3562     05  BYBF PIC  X(0001).
  3563     05  FILLER REDEFINES BYBF.
  3564         10  BYBA PIC  X(0001).
  3565     05  BYBI PIC  X(0004).
  3566*    -------------------------------
  3567     05  PROOFDBL PIC S9(0004) COMP.
  3568     05  PROOFDBF PIC  X(0001).
  3569     05  FILLER REDEFINES PROOFDBF.
  3570         10  PROOFDBA PIC  X(0001).
  3571     05  PROOFDBI PIC  X(0008).
  3572*    -------------------------------
  3573     05  ACCTBL PIC S9(0004) COMP.
  3574     05  ACCTBF PIC  X(0001).
  3575     05  FILLER REDEFINES ACCTBF.
  3576         10  ACCTBA PIC  X(0001).
  3577     05  ACCTBI PIC  X(0010).
  3578*    -------------------------------
  3579     05  STATEBL PIC S9(0004) COMP.
  3580     05  STATEBF PIC  X(0001).
  3581     05  FILLER REDEFINES STATEBF.
  3582         10  STATEBA PIC  X(0001).
  3583     05  STATEBI PIC  X(0002).
  3584*    -------------------------------
  3585     05  GROUPBL PIC S9(0004) COMP.
  3586     05  GROUPBF PIC  X(0001).
  3587     05  FILLER REDEFINES GROUPBF.
  3588         10  GROUPBA PIC  X(0001).
  3589     05  GROUPBI PIC  X(0006).
  3590*    -------------------------------
  3591     05  ACARRBL PIC S9(0004) COMP.
  3592     05  ACARRBF PIC  X(0001).
  3593     05  FILLER REDEFINES ACARRBF.
  3594         10  ACARRBA PIC  X(0001).
  3595     05  ACARRBI PIC  X(0001).
  3596*    -------------------------------
  3597     05  ACCTNMBL PIC S9(0004) COMP.
  3598     05  ACCTNMBF PIC  X(0001).
  3599     05  FILLER REDEFINES ACCTNMBF.
  3600         10  ACCTNMBA PIC  X(0001).
  3601     05  ACCTNMBI PIC  X(0030).
  3602*    -------------------------------
  3603     05  UNDISBL PIC S9(0004) COMP.
  3604     05  UNDISBF PIC  X(0001).
  3605     05  FILLER REDEFINES UNDISBF.
  3606         10  UNDISBA PIC  X(0001).
  3607     05  UNDISBI PIC  X(0010).
  3608*    -------------------------------
  3609     05  RATEBL PIC S9(0004) COMP.
  3610     05  RATEBF PIC  X(0001).
  3611     05  FILLER REDEFINES RATEBF.
  3612         10  RATEBA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  71
* EL156.cbl
  3613     05  RATEBI PIC  X(0006).
  3614*    -------------------------------
  3615     05  ERMSG1BL PIC S9(0004) COMP.
  3616     05  ERMSG1BF PIC  X(0001).
  3617     05  FILLER REDEFINES ERMSG1BF.
  3618         10  ERMSG1BA PIC  X(0001).
  3619     05  ERMSG1BI PIC  X(0072).
  3620*    -------------------------------
  3621     05  ENTPFBL PIC S9(0004) COMP.
  3622     05  ENTPFBF PIC  X(0001).
  3623     05  FILLER REDEFINES ENTPFBF.
  3624         10  ENTPFBA PIC  X(0001).
  3625     05  ENTPFBI PIC  99.
  3626 01  EL156BO REDEFINES EL156AI.
  3627     05  FILLER            PIC  X(0012).
  3628*    -------------------------------
  3629     05  FILLER            PIC  X(0003).
  3630     05  RUNDTEBO PIC  X(0008).
  3631*    -------------------------------
  3632     05  FILLER            PIC  X(0003).
  3633     05  RUNTIMBO PIC  99.99.
  3634*    -------------------------------
  3635     05  FILLER            PIC  X(0003).
  3636     05  PAYDTBO PIC  99B99B99.
  3637*    -------------------------------
  3638     05  FILLER            PIC  X(0003).
  3639     05  PAYTYPBO PIC  X(0015).
  3640*    -------------------------------
  3641     05  FILLER            PIC  X(0003).
  3642     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3643*    -------------------------------
  3644     05  FILLER            PIC  X(0003).
  3645     05  LOANHBO PIC  X(0012).
  3646*    -------------------------------
  3647     05  FILLER            PIC  X(0003).
  3648     05  LOANNBO PIC  X(0025).
  3649*    -------------------------------
  3650     05  FILLER            PIC  X(0003).
  3651     05  CKNUMHDO PIC  X(0012).
  3652*    -------------------------------
  3653     05  FILLER            PIC  X(0003).
  3654     05  CKNUMBO PIC  X(0007).
  3655*    -------------------------------
  3656     05  FILLER            PIC  X(0003).
  3657     05  AGTHDGO PIC  X(0016).
  3658*    -------------------------------
  3659     05  FILLER            PIC  X(0003).
  3660     05  NAMEBO PIC  X(0030).
  3661*    -------------------------------
  3662     05  FILLER            PIC  X(0003).
  3663     05  NAMEB2O PIC  X(0030).
  3664*    -------------------------------
  3665     05  FILLER            PIC  X(0003).
  3666     05  ADDR1BO PIC  X(0030).
  3667*    -------------------------------
  3668     05  FILLER            PIC  X(0003).
  3669     05  ADDR1B2O PIC  X(0030).
  3670*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  72
* EL156.cbl
  3671     05  FILLER            PIC  X(0003).
  3672     05  ADDR2BO PIC  X(0030).
  3673*    -------------------------------
  3674     05  FILLER            PIC  X(0003).
  3675     05  ADDR2B2O PIC  X(0030).
  3676*    -------------------------------
  3677     05  FILLER            PIC  X(0003).
  3678     05  CITYSTBO PIC  X(0030).
  3679*    -------------------------------
  3680     05  FILLER            PIC  X(0003).
  3681     05  CITYST2O PIC  X(0030).
  3682*    -------------------------------
  3683     05  FILLER            PIC  X(0003).
  3684     05  ZIPBO PIC  ZZZZ99999.
  3685*    -------------------------------
  3686     05  FILLER            PIC  X(0003).
  3687     05  ZIPB2O PIC  ZZZZZZZZZ.
  3688*    -------------------------------
  3689     05  FILLER            PIC  X(0003).
  3690     05  INTHDBO PIC  X(0012).
  3691*    -------------------------------
  3692     05  FILLER            PIC  X(0003).
  3693     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3694*    -------------------------------
  3695     05  FILLER            PIC  X(0003).
  3696     05  PMTHDGBO PIC  X(0034).
  3697*    -------------------------------
  3698     05  FILLER            PIC  X(0003).
  3699     05  CLMNOBO PIC  X(0007).
  3700*    -------------------------------
  3701     05  FILLER            PIC  X(0003).
  3702     05  CARRBO PIC  X(0001).
  3703*    -------------------------------
  3704     05  FILLER            PIC  X(0003).
  3705     05  CERTNOBO PIC  X(0010).
  3706*    -------------------------------
  3707     05  FILLER            PIC  X(0003).
  3708     05  SUFXBO PIC  X(0001).
  3709*    -------------------------------
  3710     05  FILLER            PIC  X(0003).
  3711     05  CLMTYPBO PIC  X(0006).
  3712*    -------------------------------
  3713     05  FILLER            PIC  X(0003).
  3714     05  INCURBO PIC  X(0008).
  3715*    -------------------------------
  3716     05  FILLER            PIC  X(0003).
  3717     05  PYFROMBO PIC  99B99B99.
  3718*    -------------------------------
  3719     05  FILLER            PIC  X(0003).
  3720     05  PYTHRUBO PIC  99B99B99.
  3721*    -------------------------------
  3722     05  FILLER            PIC  X(0003).
  3723     05  DAYSBO PIC  X(0005).
  3724*    -------------------------------
  3725     05  FILLER            PIC  X(0003).
  3726     05  BYBO PIC  X(0004).
  3727*    -------------------------------
  3728     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  73
* EL156.cbl
  3729     05  PROOFDBO PIC  99B99B99.
  3730*    -------------------------------
  3731     05  FILLER            PIC  X(0003).
  3732     05  ACCTBO PIC  X(0010).
  3733*    -------------------------------
  3734     05  FILLER            PIC  X(0003).
  3735     05  STATEBO PIC  X(0002).
  3736*    -------------------------------
  3737     05  FILLER            PIC  X(0003).
  3738     05  GROUPBO PIC  X(0006).
  3739*    -------------------------------
  3740     05  FILLER            PIC  X(0003).
  3741     05  ACARRBO PIC  X(0001).
  3742*    -------------------------------
  3743     05  FILLER            PIC  X(0003).
  3744     05  ACCTNMBO PIC  X(0030).
  3745*    -------------------------------
  3746     05  FILLER            PIC  X(0003).
  3747     05  UNDISBO PIC  ZZZ,Z99.99.
  3748*    -------------------------------
  3749     05  FILLER            PIC  X(0003).
  3750     05  RATEBO PIC  ZZZ.99.
  3751*    -------------------------------
  3752     05  FILLER            PIC  X(0003).
  3753     05  ERMSG1BO PIC  X(0072).
  3754*    -------------------------------
  3755     05  FILLER            PIC  X(0003).
  3756     05  ENTPFBO PIC  X(0002).
  3757*    -------------------------------
  3758****************************************************************
  3759*
  3760* Copyright (c) 2007-2013 Dell Inc.
  3761* All rights reserved.
  3762*
  3763****************************************************************
  3764 01  DFHEIV.
  3765   02  DFHEIV0               PIC X(35).
  3766   02  DFHEIV1               PIC X(08).
  3767   02  DFHEIV2               PIC X(08).
  3768   02  DFHEIV3               PIC X(08).
  3769   02  DFHEIV4               PIC X(06).
  3770   02  DFHEIV5               PIC X(04).
  3771   02  DFHEIV6               PIC X(04).
  3772   02  DFHEIV7               PIC X(02).
  3773   02  DFHEIV8               PIC X(02).
  3774   02  DFHEIV9               PIC X(01).
  3775   02  DFHEIV10              PIC S9(7) COMP-3.
  3776   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3777   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3778   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3779   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3780   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3781   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3782   02  DFHEIV17              PIC X(04).
  3783   02  DFHEIV18              PIC X(04).
  3784   02  DFHEIV19              PIC X(04).
  3785   02  DFHEIV20              USAGE IS POINTER.
  3786   02  DFHEIV21              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  74
* EL156.cbl
  3787   02  DFHEIV22              USAGE IS POINTER.
  3788   02  DFHEIV23              USAGE IS POINTER.
  3789   02  DFHEIV24              USAGE IS POINTER.
  3790   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3791   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3792   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3793   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3794   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3795   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3796   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3797   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3798   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3799   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3800   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3801   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3802   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3803   02  FILLER                PIC X(02).
  3804   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3805   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3806   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3807   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3808   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3809   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3810   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3811 LINKAGE  SECTION.
  3812*****************************************************************
  3813*                                                               *
  3814* Copyright (c) 2007-2013 Dell Inc.                             *
  3815* All rights reserved.                                          *
  3816*                                                               *
  3817*****************************************************************
  3818 01  dfheiblk.
  3819     02  eibtime          pic s9(7) comp-3.
  3820     02  eibdate          pic s9(7) comp-3.
  3821     02  eibtrnid         pic x(4).
  3822     02  eibtaskn         pic s9(7) comp-3.
  3823     02  eibtrmid         pic x(4).
  3824     02  dfheigdi         pic s9(4) comp.
  3825     02  eibcposn         pic s9(4) comp.
  3826     02  eibcalen         pic s9(4) comp.
  3827     02  eibaid           pic x(1).
  3828     02  eibfiller1       pic x(1).
  3829     02  eibfn            pic x(2).
  3830     02  eibfiller2       pic x(2).
  3831     02  eibrcode         pic x(6).
  3832     02  eibfiller3       pic x(2).
  3833     02  eibds            pic x(8).
  3834     02  eibreqid         pic x(8).
  3835     02  eibrsrce         pic x(8).
  3836     02  eibsync          pic x(1).
  3837     02  eibfree          pic x(1).
  3838     02  eibrecv          pic x(1).
  3839     02  eibsend          pic x(1).
  3840     02  eibatt           pic x(1).
  3841     02  eibeoc           pic x(1).
  3842     02  eibfmh           pic x(1).
  3843     02  eibcompl         pic x(1).
  3844     02  eibsig           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  75
* EL156.cbl
  3845     02  eibconf          pic x(1).
  3846     02  eiberr           pic x(1).
  3847     02  eibrldbk         pic x(1).
  3848     02  eiberrcd         pic x(4).
  3849     02  eibsynrb         pic x(1).
  3850     02  eibnodat         pic x(1).
  3851     02  eibfiller5       pic x(2).
  3852     02  eibresp          pic s9(8) comp.
  3853     02  eibresp2         pic s9(8) comp.
  3854     02  dfheigdj         pic s9(4) comp.
  3855     02  dfheigdk         pic s9(4) comp.
  3856 01  DFHCOMMAREA             PIC X(1024).
  3857
  3858*    COPY ELCMSTR.
  3859******************************************************************
  3860*                                                                *
  3861*                            ELCMSTR.                            *
  3862*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3863*                            VMOD=2.012                          *
  3864*                                                                *
  3865*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3866*                                                                *
  3867*   FILE TYPE = VSAM,KSDS                                        *
  3868*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3869*                                                                *
  3870*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3871*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3872*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3873*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3874*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3875*                                                 RKP=75,LEN=21  *
  3876*                                                                *
  3877*   **** NOTE ****                                               *
  3878*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3879*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3880*                                                                *
  3881*   LOG = YES                                                    *
  3882*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3883******************************************************************
  3884*                   C H A N G E   L O G
  3885*
  3886* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3887*-----------------------------------------------------------------
  3888*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3889* EFFECTIVE    NUMBER
  3890*-----------------------------------------------------------------
  3891* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3892* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3893* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3894* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3895* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3896* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3897******************************************************************
  3898 01  CLAIM-MASTER.
  3899     12  CL-RECORD-ID                PIC XX.
  3900         88  VALID-CL-ID         VALUE 'CL'.
  3901
  3902     12  CL-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  76
* EL156.cbl
  3903         16  CL-COMPANY-CD           PIC X.
  3904         16  CL-CARRIER              PIC X.
  3905         16  CL-CLAIM-NO             PIC X(7).
  3906         16  CL-CERT-NO.
  3907             20  CL-CERT-PRIME       PIC X(10).
  3908             20  CL-CERT-SFX         PIC X.
  3909
  3910     12  CL-CONTROL-BY-NAME.
  3911         16  CL-COMPANY-CD-A1        PIC X.
  3912         16  CL-INSURED-LAST-NAME    PIC X(15).
  3913         16  CL-INSURED-NAME.
  3914             20  CL-INSURED-1ST-NAME PIC X(12).
  3915             20  CL-INSURED-MID-INIT PIC X.
  3916
  3917     12  CL-CONTROL-BY-SSN.
  3918         16  CL-COMPANY-CD-A2        PIC X.
  3919         16  CL-SOC-SEC-NO.
  3920             20  CL-SSN-STATE        PIC XX.
  3921             20  CL-SSN-ACCOUNT      PIC X(6).
  3922             20  CL-SSN-LN3          PIC X(3).
  3923
  3924     12  CL-CONTROL-BY-CERT-NO.
  3925         16  CL-COMPANY-CD-A4        PIC X.
  3926         16  CL-CERT-NO-A4.
  3927             20  CL-CERT-A4-PRIME    PIC X(10).
  3928             20  CL-CERT-A4-SFX      PIC X.
  3929
  3930     12  CL-CONTROL-BY-CCN.
  3931         16  CL-COMPANY-CD-A5        PIC X.
  3932         16  CL-CCN-A5.
  3933             20  CL-CCN.
  3934                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3935                 24  CL-CCN-PRIME-A5 PIC X(12).
  3936             20  CL-CCN-FILLER-A5    PIC X(4).
  3937
  3938     12  CL-INSURED-PROFILE-DATA.
  3939         16  CL-INSURED-BIRTH-DT     PIC XX.
  3940         16  CL-INSURED-SEX-CD       PIC X.
  3941             88  INSURED-IS-MALE        VALUE 'M'.
  3942             88  INSURED-IS-FEMALE      VALUE 'F'.
  3943             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3944         16  CL-INSURED-OCC-CD       PIC X(6).
  3945         16  FILLER                  PIC X(5).
  3946
  3947     12  CL-PROCESSING-INFO.
  3948         16  CL-PROCESSOR-ID         PIC X(4).
  3949         16  CL-CLAIM-STATUS         PIC X.
  3950             88  CLAIM-IS-OPEN          VALUE 'O'.
  3951             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3952         16  CL-CLAIM-TYPE           PIC X.
  3953*            88  AH-CLAIM               VALUE 'A'.
  3954*            88  LIFE-CLAIM             VALUE 'L'.
  3955*            88  PROPERTY-CLAIM         VALUE 'P'.
  3956*            88  IUI-CLAIM              VALUE 'I'.
  3957*            88  GAP-CLAIM              VALUE 'G'.
  3958*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3959         16  CL-CLAIM-PREM-TYPE      PIC X.
  3960             88  SINGLE-PREMIUM         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  77
* EL156.cbl
  3961             88  O-B-COVERAGE           VALUE '2'.
  3962             88  OPEN-END-COVERAGE      VALUE '3'.
  3963         16  CL-INCURRED-DT          PIC XX.
  3964         16  CL-REPORTED-DT          PIC XX.
  3965         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3966         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3967         16  CL-LAST-PMT-DT          PIC XX.
  3968         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3969         16  CL-PAID-THRU-DT         PIC XX.
  3970         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3971         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3972         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3973         16  CL-PMT-CALC-METHOD      PIC X.
  3974             88  CL-360-DAY-YR          VALUE '1'.
  3975             88  CL-365-DAY-YR          VALUE '2'.
  3976             88  CL-FULL-MONTHS         VALUE '3'.
  3977         16  CL-CAUSE-CD             PIC X(6).
  3978
  3979         16  CL-PRIME-CERT-NO.
  3980             20  CL-PRIME-CERT-PRIME PIC X(10).
  3981             20  CL-PRIME-CERT-SFX   PIC X.
  3982
  3983         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3984             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3985             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3986
  3987         16  CL-MICROFILM-NO         PIC X(10).
  3988         16  FILLER REDEFINES CL-MICROFILM-NO.
  3989             20  CL-BENEFIT-PERIOD   PIC 99.
  3990             20  FILLER              PIC X(8).
  3991         16  CL-PROG-FORM-TYPE       PIC X.
  3992         16  CL-LAST-ADD-ON-DT       PIC XX.
  3993
  3994         16  CL-LAST-REOPEN-DT       PIC XX.
  3995         16  CL-LAST-CLOSE-DT        PIC XX.
  3996         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3997             88  FINAL-PAID             VALUE '1'.
  3998             88  CLAIM-DENIED           VALUE '2'.
  3999             88  AUTO-CLOSE             VALUE '3'.
  4000             88  MANUAL-CLOSE           VALUE '4'.
  4001             88  BENEFITS-CHANGED       VALUE 'C'.
  4002             88  SETUP-ERRORS           VALUE 'E'.
  4003         16  CL-ASSOC-CERT-SEQU      PIC S99.
  4004         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  4005         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  4006             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  4007         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  4008         16  FILLER                  PIC X.
  4009
  4010     12  CL-CERTIFICATE-DATA.
  4011         16  CL-CERT-ORIGIN          PIC X.
  4012             88  CERT-WAS-ONLINE        VALUE '1'.
  4013             88  CERT-WAS-CREATED       VALUE '2'.
  4014             88  COVERAGE-WAS-ADDED     VALUE '3'.
  4015         16  CL-CERT-KEY-DATA.
  4016             20  CL-CERT-CARRIER     PIC X.
  4017             20  CL-CERT-GROUPING    PIC X(6).
  4018             20  CL-CERT-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  78
* EL156.cbl
  4019             20  CL-CERT-ACCOUNT.
  4020                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  4021                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  4022             20  CL-CERT-EFF-DT      PIC XX.
  4023
  4024     12  CL-STATUS-CONTROLS.
  4025         16  CL-PRIORITY-CD          PIC X.
  4026             88  CONFIDENTIAL-DATA      VALUE '8'.
  4027             88  HIGHEST-PRIORITY       VALUE '9'.
  4028         16  CL-SUPV-ATTN-CD         PIC X.
  4029             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  4030             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  4031         16  CL-PURGED-DT            PIC XX.
  4032         16  CL-RESTORED-DT          PIC XX.
  4033         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  4034         16  CL-NEXT-RESEND-DT       PIC XX.
  4035         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  4036         16  CL-CRITICAL-PERIOD      PIC 99.
  4037*        16  FILLER                  PIC XX.
  4038         16  CL-LAST-MAINT-DT        PIC XX.
  4039         16  CL-LAST-MAINT-USER      PIC X(4).
  4040         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  4041         16  CL-LAST-MAINT-TYPE      PIC X.
  4042             88  CLAIM-SET-UP           VALUE ' '.
  4043             88  PAYMENT-MADE           VALUE '1'.
  4044             88  LETTER-SENT            VALUE '2'.
  4045             88  MASTER-WAS-ALTERED     VALUE '3'.
  4046             88  MASTER-WAS-RESTORED    VALUE '4'.
  4047             88  INCURRED-DATE-CHANGED  VALUE '5'.
  4048             88  FILE-CONVERTED         VALUE '6'.
  4049             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  4050             88  ERROR-CORRECTION       VALUE 'E'.
  4051         16  CL-RELATED-CLAIM-NO     PIC X(7).
  4052         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  4053         16  CL-BENEFICIARY          PIC X(10).
  4054         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  4055         16  CL-DENIAL-TYPE          PIC X.
  4056             88  CL-TYPE-DENIAL          VALUE '1'.
  4057             88  CL-TYPE-RESCISSION      VALUE '2'.
  4058             88  CL-TYPE-REFORMATION     VALUE '3'.
  4059             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4060             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4061         16  CL-NO-OF-EXTENSIONS     PIC 99.
  4062         16  filler                  pic x(3).
  4063*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4064*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4065*        16  CL-RTW-DT               PIC XX.
  4066
  4067     12  CL-TRAILER-CONTROLS.
  4068         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4069             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4070             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4071             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4072         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4073         16  FILLER                  PIC XX.
  4074         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  4075         16  CL-ADDRESS-TRAILER-CNT.
  4076             20  CL-INSURED-ADDR-CNT  PIC S9(1).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  79
* EL156.cbl
  4077                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4078             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4079                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4080             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4081                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4082             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4083                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4084             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4085                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4086             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4087                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4088             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4089                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4090
  4091     12  CL-CV-REFERENCE-NO.
  4092         16  CL-CV-REFNO-PRIME       PIC X(18).
  4093         16  CL-CV-REFNO-SFX         PIC XX.
  4094
  4095     12  CL-FILE-LOCATION            PIC X(4).
  4096
  4097     12  CL-PROCESS-ERRORS.
  4098         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4099             88  NO-FATAL-ERRORS        VALUE ZERO.
  4100         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4101             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4102
  4103     12  CL-PRODUCT-CD               PIC X.
  4104
  4105     12  CL-CURRENT-KEY-DATA.
  4106         16  CL-CURRENT-CARRIER      PIC X.
  4107         16  CL-CURRENT-GROUPING     PIC X(6).
  4108         16  CL-CURRENT-STATE        PIC XX.
  4109         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4110
  4111     12  CL-ASSOCIATES               PIC X.
  4112         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4113         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4114         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4115         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4116
  4117     12  CL-ACTIVITY-CODE            PIC 99.
  4118     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4119     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4120
  4121     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4122     12  CL-LAG-REPORT-CODE          PIC 9.
  4123     12  CL-LOAN-TYPE                PIC XX.
  4124     12  CL-LEGAL-STATE              PIC XX.
  4125
  4126     12  CL-YESNOSW                  PIC X.
  4127     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4128         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4129         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4130         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4131     12  cl-insured-type             pic x.
  4132         88  cl-claim-on-primary         value 'P'.
  4133         88  cl-claim-on-co-borrower     value 'C'.
  4134     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  80
* EL156.cbl
  4136*    COPY ELCCNTL.
  4137******************************************************************
  4138*                                                                *
  4139*                                                                *
  4140*                            ELCCNTL.                            *
  4141*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4142*                            VMOD=2.059                          *
  4143*                                                                *
  4144*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4145*                                                                *
  4146*   FILE TYPE = VSAM,KSDS                                        *
  4147*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4148*                                                                *
  4149*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4150*       ALTERNATE INDEX = NONE                                   *
  4151*                                                                *
  4152*   LOG = YES                                                    *
  4153*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4154******************************************************************
  4155*                   C H A N G E   L O G
  4156*
  4157* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4158*-----------------------------------------------------------------
  4159*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4160* EFFECTIVE    NUMBER
  4161*-----------------------------------------------------------------
  4162* 082503                   PEMA  ADD BENEFIT GROUP
  4163* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4164* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4165* 092705    2005050300006  PEMA  ADD SPP LEASES
  4166* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4167* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4168* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4169* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4170* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4171* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4172* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4173* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4174* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4175* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4176******************************************************************
  4177*
  4178 01  CONTROL-FILE.
  4179     12  CF-RECORD-ID                       PIC XX.
  4180         88  VALID-CF-ID                        VALUE 'CF'.
  4181
  4182     12  CF-CONTROL-PRIMARY.
  4183         16  CF-COMPANY-ID                  PIC XXX.
  4184         16  CF-RECORD-TYPE                 PIC X.
  4185             88  CF-COMPANY-MASTER              VALUE '1'.
  4186             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4187             88  CF-STATE-MASTER                VALUE '3'.
  4188             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4189             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4190             88  CF-CARRIER-MASTER              VALUE '6'.
  4191             88  CF-MORTALITY-MASTER            VALUE '7'.
  4192             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4193             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  81
* EL156.cbl
  4194             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4195             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4196             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4197             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4198             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4199             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4200             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4201             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4202             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4203         16  CF-ACCESS-CD-GENL              PIC X(4).
  4204         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4205             20  CF-PROCESSOR               PIC X(4).
  4206         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4207             20  CF-STATE-CODE              PIC XX.
  4208             20  FILLER                     PIC XX.
  4209         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4210             20  FILLER                     PIC XX.
  4211             20  CF-HI-BEN-IN-REC           PIC XX.
  4212         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4213             20  FILLER                     PIC XXX.
  4214             20  CF-CARRIER-CNTL            PIC X.
  4215         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4216             20  FILLER                     PIC XX.
  4217             20  CF-HI-TYPE-IN-REC          PIC 99.
  4218         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4219             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4220                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4221             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4222             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4223         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4224             20  FILLER                     PIC X.
  4225             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4226         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4227             20  FILLER                     PIC XX.
  4228             20  CF-MORTGAGE-PLAN           PIC XX.
  4229         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4230
  4231     12  CF-LAST-MAINT-DT                   PIC XX.
  4232     12  CF-LAST-MAINT-BY                   PIC X(4).
  4233     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4234
  4235     12  CF-RECORD-BODY                     PIC X(728).
  4236
  4237
  4238****************************************************************
  4239*             COMPANY MASTER RECORD                            *
  4240****************************************************************
  4241
  4242     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4243         16  CF-COMPANY-ADDRESS.
  4244             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4245             20  CF-CL-IN-CARE-OF           PIC X(30).
  4246             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4247             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4248             20  CF-CL-CITY-STATE           PIC X(30).
  4249             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4250             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4251         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  82
* EL156.cbl
  4252         16  CF-COMPANY-PASSWORD            PIC X(8).
  4253         16  CF-SECURITY-OPTION             PIC X.
  4254             88  ALL-SECURITY                   VALUE '1'.
  4255             88  COMPANY-VERIFY                 VALUE '2'.
  4256             88  PROCESSOR-VERIFY               VALUE '3'.
  4257             88  NO-SECURITY                    VALUE '4'.
  4258             88  ALL-BUT-TERM                   VALUE '5'.
  4259         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4260             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4261         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4262             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4263         16  CF-INFORCE-LOCATION            PIC X.
  4264             88  CERTS-ARE-ONLINE               VALUE '1'.
  4265             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4266             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4267         16  CF-LOWER-CASE-LETTERS          PIC X.
  4268         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4269             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4270             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4271             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4272             88  CF-ACCNT-CNTL                  VALUE '3'.
  4273             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4274
  4275         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4276         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4277
  4278         16  CF-LGX-CREDIT-USER             PIC X.
  4279             88  CO-IS-NOT-USER                 VALUE 'N'.
  4280             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4281
  4282         16 CF-CREDIT-CALC-CODES.
  4283             20  CF-CR-REM-TERM-CALC PIC X.
  4284               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4285               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4286               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4287               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4288               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4289               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4290               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4291             20  CF-CR-R78-METHOD           PIC X.
  4292               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4293               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4294
  4295         16  CF-CLAIM-CONTROL-COUNTS.
  4296             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4297                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4298
  4299             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4300                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4301
  4302             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4303                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4304
  4305             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4306                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4307
  4308         16  CF-CURRENT-MONTH-END           PIC XX.
  4309
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  83
* EL156.cbl
  4310         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4311             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4312             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4313             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4314             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4315                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4316                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4317             20  CF-CO-PREM-REJECT-SW       PIC X.
  4318                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4319                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4320             20  CF-CO-REF-REJECT-SW        PIC X.
  4321                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4322                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4323
  4324         16  CF-CO-REPORTING-DT             PIC XX.
  4325         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4326         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4327           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4328           88  CF-CO-MONTH-END                  VALUE '1'.
  4329
  4330         16  CF-LGX-CLAIM-USER              PIC X.
  4331             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4332             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4333
  4334         16  CF-CREDIT-EDIT-CONTROLS.
  4335             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4336             20  CF-MIN-AGE                 PIC 99.
  4337             20  CF-DEFAULT-AGE             PIC 99.
  4338             20  CF-MIN-TERM                PIC S999      COMP-3.
  4339             20  CF-MAX-TERM                PIC S999      COMP-3.
  4340             20  CF-DEFAULT-SEX             PIC X.
  4341             20  CF-JOINT-AGE-INPUT         PIC X.
  4342                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4343             20  CF-BIRTH-DATE-INPUT        PIC X.
  4344                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4345             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4346                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4347                 88  CF-ZERO-CARRIER            VALUE '1'.
  4348                 88  CF-ZERO-GROUPING           VALUE '2'.
  4349                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4350             20  CF-EDIT-SW                 PIC X.
  4351                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4352             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4353             20  CF-CR-PR-METHOD            PIC X.
  4354               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4355               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4356             20  FILLER                     PIC X.
  4357
  4358         16  CF-CREDIT-MISC-CONTROLS.
  4359             20  CF-REIN-TABLE-SW           PIC X.
  4360                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4361             20  CF-COMP-TABLE-SW           PIC X.
  4362                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4363             20  CF-EXPERIENCE-RETENTION-AGE
  4364                                            PIC S9        COMP-3.
  4365             20  CF-CONVERSION-DT           PIC XX.
  4366             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4367             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  84
* EL156.cbl
  4368                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4369                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4370
  4371             20  CF-CR-CHECK-NO-CONTROL.
  4372                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4373                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4374                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4375                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4376                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4377                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4378
  4379                 24  CF-CR-CHECK-COUNT       REDEFINES
  4380                     CF-CR-CHECK-COUNTER      PIC X(4).
  4381
  4382                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4383                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4384
  4385                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4386                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4387                 24  CF-MAIL-PROCESSING       PIC X.
  4388                     88  MAIL-PROCESSING          VALUE 'Y'.
  4389
  4390         16  CF-MISC-SYSTEM-CONTROL.
  4391             20  CF-SYSTEM-C                 PIC X.
  4392                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4393             20  CF-SYSTEM-D                 PIC X.
  4394                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4395             20  CF-SOC-SEC-NO-SW            PIC X.
  4396                 88  SOC-SEC-NO-USED             VALUE '1'.
  4397             20  CF-MEMBER-NO-SW             PIC X.
  4398                 88  MEMBER-NO-USED              VALUE '1'.
  4399             20  CF-TAX-ID-NUMBER            PIC X(11).
  4400             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4401             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4402                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4403                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4404                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4405                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4406             20  CF-SYSTEM-E                 PIC X.
  4407                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4408
  4409         16  CF-LGX-LIFE-USER               PIC X.
  4410             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4411             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4412
  4413         16  CF-CR-MONTH-END-DT             PIC XX.
  4414
  4415         16  CF-FILE-MAINT-DATES.
  4416             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4417                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4418             20  CF-LAST-BATCH       REDEFINES
  4419                 CF-LAST-BATCH-NO               PIC X(4).
  4420             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4421             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4422             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4423             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4424             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4425             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  85
* EL156.cbl
  4426             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4427             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4428             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4429             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4430
  4431         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4432         16  FILLER                         PIC X.
  4433
  4434         16  CF-ALT-MORT-CODE               PIC X(4).
  4435         16  CF-MEMBER-CAPTION              PIC X(10).
  4436
  4437         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4438             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4439             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4440             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4441             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4442             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4443
  4444         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4445
  4446         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4447         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4448         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4449         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4450
  4451         16  CF-AH-OVERRIDE-L1              PIC X.
  4452         16  CF-AH-OVERRIDE-L2              PIC XX.
  4453         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4454         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4455
  4456         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4457         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4458
  4459         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4460         16  CF-AR-LAST-EL860-DT            PIC XX.
  4461         16  CF-MP-MONTH-END-DT             PIC XX.
  4462
  4463         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4464         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4465             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4466
  4467         16  CF-AR-MONTH-END-DT             PIC XX.
  4468
  4469         16  CF-CRDTCRD-USER                PIC X.
  4470             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4471             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4472
  4473         16  CF-CC-MONTH-END-DT             PIC XX.
  4474
  4475         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4476
  4477         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4478             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4479             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4480             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4481         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4482         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4483         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  86
* EL156.cbl
  4484         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4485             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4486             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4487         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4488         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4489         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4490             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4491         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4492
  4493         16  CF-CL-ZIP-CODE.
  4494             20  CF-CL-ZIP-PRIME.
  4495                 24  CF-CL-ZIP-1ST          PIC X.
  4496                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4497                 24  FILLER                 PIC X(4).
  4498             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4499         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4500             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4501             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4502             20  FILLER                     PIC XXX.
  4503
  4504         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4505         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4506         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4507         16  CF-CO-OPTION-START-DATE        PIC XX.
  4508         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4509           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4510                                                      '3' '4'.
  4511           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4512           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4513           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4514           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4515           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4516           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4517
  4518         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4519
  4520         16  CF-PAYMENT-APPROVAL-LEVELS.
  4521             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4522             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4523             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4524             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4525             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4526             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4527
  4528         16  CF-END-USER-REPORTING-USER     PIC X.
  4529             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4530             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4531
  4532         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4533             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4534             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4535
  4536         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4537
  4538         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4539         16  FILLER                         PIC X.
  4540
  4541         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  87
* EL156.cbl
  4542             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4543             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4544             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4545
  4546         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4547
  4548         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4549             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4550             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4551
  4552         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4553             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4554             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4555
  4556         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4557
  4558         16  CF-CO-ACH-ID-CODE              PIC  X.
  4559             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4560             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4561             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4562         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4563         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4564         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4565         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4566         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4567         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4568         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4569         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4570         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4571                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4572         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4573                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4574
  4575         16  CF-CO-OVER-SHORT.
  4576             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4577             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4578
  4579*         16  FILLER                         PIC X(102).
  4580         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4581             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4582             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4583
  4584         16  CF-AH-APPROVAL-DAYS.
  4585             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4586             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4587             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4588             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4589
  4590         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4591
  4592         16  CF-APPROV-LEV-5.
  4593             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4594             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4595             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4596
  4597         16  FILLER                         PIC X(68).
  4598****************************************************************
  4599*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  88
* EL156.cbl
  4600****************************************************************
  4601
  4602     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4603         16  CF-PROCESSOR-NAME              PIC X(30).
  4604         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4605         16  CF-PROCESSOR-TITLE             PIC X(26).
  4606         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4607                 88  MESSAGE-YES                VALUE 'Y'.
  4608                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4609
  4610*****************************************************
  4611****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4612****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4613****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4614****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4615*****************************************************
  4616
  4617         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4618             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4619             20  CF-APPLICATION-FORCE       PIC X.
  4620             20  CF-INDIVIDUAL-APP.
  4621                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4622                     28  CF-BROWSE-APP      PIC X.
  4623                     28  CF-UPDATE-APP      PIC X.
  4624
  4625         16  CF-CURRENT-TERM-ON             PIC X(4).
  4626         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4627             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4628             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4629             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4630             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4631             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4632             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4633             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4634         16  CF-PROCESSOR-CARRIER           PIC X.
  4635             88  NO-CARRIER-SECURITY            VALUE ' '.
  4636         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4637             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4638         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4639             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4640         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4641             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4642
  4643         16  CF-PROC-SYS-ACCESS-SW.
  4644             20  CF-PROC-CREDIT-CLAIMS-SW.
  4645                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4646                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4647                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4648                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4649             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4650                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4651                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4652             20  CF-PROC-LIFE-GNRLDGR-SW.
  4653                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4654                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4655                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4656                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4657             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  89
* EL156.cbl
  4658                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4659                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4660         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4661             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4662             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4663         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4664
  4665         16  CF-APPROVAL-LEVEL                  PIC X.
  4666             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4667             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4668             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4669             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4670             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4671
  4672         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4673
  4674         16  CF-LANGUAGE-TYPE                   PIC X.
  4675             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4676             88  CF-LANG-IS-FR                      VALUE 'F'.
  4677
  4678         16  CF-CSR-IND                         PIC X.
  4679         16  FILLER                             PIC X(239).
  4680
  4681****************************************************************
  4682*             PROCESSOR/REMINDERS RECORD                       *
  4683****************************************************************
  4684
  4685     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4686         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4687             20  CF-START-REMIND-DT         PIC XX.
  4688             20  CF-END-REMIND-DT           PIC XX.
  4689             20  CF-REMINDER-TEXT           PIC X(50).
  4690         16  FILLER                         PIC X(296).
  4691
  4692
  4693****************************************************************
  4694*             STATE MASTER RECORD                              *
  4695****************************************************************
  4696
  4697     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4698         16  CF-STATE-ABBREVIATION          PIC XX.
  4699         16  CF-STATE-NAME                  PIC X(25).
  4700         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4701         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4702             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4703             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4704             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4705             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4706                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4707                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4708             20  CF-ST-PREM-REJECT-SW       PIC X.
  4709                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4710                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4711             20  CF-ST-REF-REJECT-SW        PIC X.
  4712                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4713                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4714         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4715         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  90
* EL156.cbl
  4716         16  CF-ST-REFUND-RULES.
  4717             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4718             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4719             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4720         16  CF-ST-FST-PMT-EXTENSION.
  4721             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4722             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4723                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4724                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4725                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4726                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4727         16  CF-ST-STATE-CALL.
  4728             20  CF-ST-CALL-UNEARNED        PIC X.
  4729             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4730             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4731         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4732             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4733             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4734         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4735         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4736         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4737         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4738         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4739         16  FILLER                         PIC X.
  4740         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4741             20  CF-ST-BENEFIT-CD           PIC XX.
  4742             20  CF-ST-BENEFIT-KIND         PIC X.
  4743                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4744                 88  CF-ST-AH-KIND              VALUE 'A'.
  4745             20  CF-ST-REM-TERM-CALC        PIC X.
  4746                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4747                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4748                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4749                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4750                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4751                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4752                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4753                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4754
  4755             20  CF-ST-REFUND-CALC          PIC X.
  4756                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4757                 88  ST-REFD-BY-R78             VALUE '1'.
  4758                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4759                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4760                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4761                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4762                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4763                 88  ST-REFD-UTAH               VALUE '7'.
  4764                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4765                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4766                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4767
  4768             20  CF-ST-EARNING-CALC         PIC X.
  4769                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4770                 88  ST-EARN-BY-R78             VALUE '1'.
  4771                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4772                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4773                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  91
* EL156.cbl
  4774                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4775                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4776                 88  ST-EARN-MEAN               VALUE '8'.
  4777                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4778
  4779             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4780                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4781                 88  ST-OVRD-BY-R78             VALUE '1'.
  4782                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4783                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4784                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4785                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4786                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4787                 88  ST-OVRD-MEAN               VALUE '8'.
  4788                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4789             20  cf-st-extra-periods        pic 9.
  4790*            20  FILLER                     PIC X.
  4791
  4792         16  CF-ST-COMMISSION-CAPS.
  4793             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4794             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4795             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4796             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4797         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4798                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4799
  4800         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4801
  4802         16  CF-ST-STATUTORY-INTEREST.
  4803             20  CF-ST-STAT-DATE-FROM       PIC X.
  4804                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4805                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4806             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4807             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4808             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4809             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4810             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4811
  4812         16  CF-ST-OVER-SHORT.
  4813             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4814             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4815
  4816         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4817
  4818         16  CF-ST-RT-CALC                  PIC X.
  4819
  4820         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4821         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4822         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4823         16  CF-ST-RF-LR-CALC               PIC X.
  4824         16  CF-ST-RF-LL-CALC               PIC X.
  4825         16  CF-ST-RF-LN-CALC               PIC X.
  4826         16  CF-ST-RF-AH-CALC               PIC X.
  4827         16  CF-ST-RF-CP-CALC               PIC X.
  4828*        16  FILLER                         PIC X(206).
  4829*CIDMOD         16  FILLER                         PIC X(192).
  4830         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4831             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  92
* EL156.cbl
  4832         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4833         16  CF-ST-VFY-2ND-BENE             PIC X.
  4834         16  CF-ST-CAUSAL-STATE             PIC X.
  4835         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4836         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4837         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4838             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4839         16  CF-ST-NET-ONLY-STATE           PIC X.
  4840             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4841         16  FILLER                         PIC X(181).
  4842
  4843****************************************************************
  4844*             BENEFIT MASTER RECORD                            *
  4845****************************************************************
  4846
  4847     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4848         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4849             20  CF-BENEFIT-CODE            PIC XX.
  4850             20  CF-BENEFIT-NUMERIC  REDEFINES
  4851                 CF-BENEFIT-CODE            PIC XX.
  4852             20  CF-BENEFIT-ALPHA           PIC XXX.
  4853             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4854             20  CF-BENEFIT-COMMENT         PIC X(10).
  4855
  4856             20  CF-LF-COVERAGE-TYPE        PIC X.
  4857                 88  CF-REDUCING                VALUE 'R'.
  4858                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4859
  4860             20  CF-SPECIAL-CALC-CD         PIC X.
  4861                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4862                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4863                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4864                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4865                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4866                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4867                 88  CF-FARM-PLAN               VALUE 'F'.
  4868                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4869                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4870                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4871                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4872                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4873                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4874                 88  CF-PRUDENTIAL              VALUE 'P'.
  4875                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4876                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4877                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4878                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4879                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4880                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4881
  4882             20  CF-JOINT-INDICATOR         PIC X.
  4883                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4884
  4885*            20  FILLER                     PIC X(12).
  4886             20  cf-maximum-benefits        pic s999 comp-3.
  4887             20  FILLER                     PIC X(09).
  4888             20  CF-BENEFIT-CATEGORY        PIC X.
  4889             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  93
* EL156.cbl
  4890
  4891             20  CF-CO-REM-TERM-CALC        PIC X.
  4892                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4893                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4894                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4895                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4896                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4897
  4898             20  CF-CO-EARNINGS-CALC        PIC X.
  4899                 88  CO-EARN-BY-R78             VALUE '1'.
  4900                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4901                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4902                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4903                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4904                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4905                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4906                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4907
  4908             20  CF-CO-REFUND-CALC          PIC X.
  4909                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4910                 88  CO-REFD-BY-R78             VALUE '1'.
  4911                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4912                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4913                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4914                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4915                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4916                 88  CO-REFD-MEAN               VALUE '8'.
  4917                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4918                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4919                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4920
  4921             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4922                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4923                 88  CO-OVRD-BY-R78             VALUE '1'.
  4924                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4925                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4926                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4927                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4928                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4929                 88  CO-OVRD-MEAN               VALUE '8'.
  4930                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4931
  4932             20  CF-CO-BEN-I-G-CD           PIC X.
  4933                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4934                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4935                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4936
  4937         16  FILLER                         PIC X(304).
  4938
  4939
  4940****************************************************************
  4941*             CARRIER MASTER RECORD                            *
  4942****************************************************************
  4943
  4944     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4945         16  CF-ADDRESS-DATA.
  4946             20  CF-MAIL-TO-NAME            PIC X(30).
  4947             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  94
* EL156.cbl
  4948             20  CF-ADDRESS-LINE-1          PIC X(30).
  4949             20  CF-ADDRESS-LINE-2          PIC X(30).
  4950             20  CF-CITY-STATE              PIC X(30).
  4951             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4952             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4953
  4954         16  CF-CLAIM-NO-CONTROL.
  4955             20  CF-CLAIM-NO-METHOD         PIC X.
  4956                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4957                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4958                 88  CLAIM-NO-SEQ               VALUE '3'.
  4959                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4960             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4961                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4962                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4963                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4964
  4965         16  CF-CHECK-NO-CONTROL.
  4966             20  CF-CHECK-NO-METHOD         PIC X.
  4967                 88  CHECK-NO-MANUAL            VALUE '1'.
  4968                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4969                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4970                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4971             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4972                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4973
  4974         16  CF-DOMICILE-STATE              PIC XX.
  4975
  4976         16  CF-EXPENSE-CONTROLS.
  4977             20  CF-EXPENSE-METHOD          PIC X.
  4978                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4979                 88  DOLLARS-PER-PMT            VALUE '2'.
  4980                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4981                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4982             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4983             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4984
  4985         16  CF-CORRESPONDENCE-CONTROL.
  4986             20  CF-LETTER-RESEND-OPT       PIC X.
  4987                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4988                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4989             20  FILLER                     PIC X(4).
  4990
  4991         16  CF-RESERVE-CONTROLS.
  4992             20  CF-MANUAL-SW               PIC X.
  4993                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4994             20  CF-FUTURE-SW               PIC X.
  4995                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4996             20  CF-PTC-SW                  PIC X.
  4997                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4998             20  CF-IBNR-SW                 PIC X.
  4999                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5000             20  CF-PTC-LF-SW               PIC X.
  5001                 88  CF-LF-PTC-USED             VALUE '1'.
  5002             20  CF-CDT-ACCESS-METHOD       PIC X.
  5003                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5004                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5005                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  95
* EL156.cbl
  5006             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5007
  5008         16  CF-CLAIM-CALC-METHOD           PIC X.
  5009             88  360-PLUS-MONTHS                VALUE '1'.
  5010             88  365-PLUS-MONTHS                VALUE '2'.
  5011             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5012             88  360-DAILY                      VALUE '4'.
  5013             88  365-DAILY                      VALUE '5'.
  5014
  5015         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5016         16  FILLER                         PIC X(11).
  5017
  5018         16  CF-LIMIT-AMOUNTS.
  5019             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5020             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5021             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5022             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5023             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5024             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5025             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5026             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5027             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5028             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5029
  5030         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5031         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5032         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5033
  5034         16  CF-ZIP-CODE.
  5035             20  CF-ZIP-PRIME.
  5036                 24  CF-ZIP-1ST             PIC X.
  5037                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5038                 24  FILLER                 PIC X(4).
  5039             20  CF-ZIP-PLUS4               PIC X(4).
  5040         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5041             20  CF-CAN-POSTAL-1            PIC XXX.
  5042             20  CF-CAN-POSTAL-2            PIC XXX.
  5043             20  FILLER                     PIC XXX.
  5044
  5045         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5046         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5047         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5048
  5049         16  CF-RATING-SWITCH               PIC X.
  5050             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5051             88  CF-NO-RATING                   VALUE 'N'.
  5052
  5053         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5054
  5055         16  CF-CARRIER-OVER-SHORT.
  5056             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5057             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5058
  5059         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5060         16  CF-SECPAY-SWITCH               PIC X.
  5061             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5062             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5063         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  96
* EL156.cbl
  5064         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5065         16  FILLER                         PIC X(444).
  5066*        16  FILLER                         PIC X(452).
  5067
  5068
  5069****************************************************************
  5070*             MORTALITY MASTER RECORD                          *
  5071****************************************************************
  5072
  5073     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5074         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5075                                INDEXED BY CF-MORT-NDX.
  5076             20  CF-MORT-TABLE              PIC X(5).
  5077             20  CF-MORT-TABLE-TYPE         PIC X.
  5078                 88  CF-MORT-JOINT              VALUE 'J'.
  5079                 88  CF-MORT-SINGLE             VALUE 'S'.
  5080                 88  CF-MORT-COMBINED           VALUE 'C'.
  5081                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5082                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5083             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5084             20  CF-MORT-AGE-METHOD         PIC XX.
  5085                 88  CF-AGE-LAST                VALUE 'AL'.
  5086                 88  CF-AGE-NEAR                VALUE 'AN'.
  5087             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5088             20  CF-MORT-ADJUSTMENT-DIRECTION
  5089                                            PIC X.
  5090                 88  CF-MINUS                   VALUE '-'.
  5091                 88  CF-PLUS                    VALUE '+'.
  5092             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5093             20  CF-MORT-JOINT-CODE         PIC X.
  5094                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5095             20  CF-MORT-PC-Q               PIC X.
  5096                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5097             20  CF-MORT-TABLE-CODE         PIC X(4).
  5098             20  CF-MORT-COMMENTS           PIC X(15).
  5099             20  FILLER                     PIC X(14).
  5100
  5101         16  FILLER                         PIC X(251).
  5102
  5103
  5104****************************************************************
  5105*             BUSSINESS TYPE MASTER RECORD                     *
  5106****************************************************************
  5107
  5108     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5109* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5110* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5111* AND RECORD 05 IS TYPES 81-99
  5112         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5113             20  CF-BUSINESS-TITLE          PIC  X(19).
  5114             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5115                                            PIC S9V9(4) COMP-3.
  5116             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5117             20  FILLER                     PIC  X.
  5118         16  FILLER                         PIC  X(248).
  5119
  5120
  5121****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  97
* EL156.cbl
  5122*             TERMINAL MASTER RECORD                           *
  5123****************************************************************
  5124
  5125     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5126
  5127         16  CF-COMPANY-TERMINALS.
  5128             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5129                                  PIC X(4).
  5130         16  FILLER               PIC X(248).
  5131
  5132
  5133****************************************************************
  5134*             LIFE EDIT MASTER RECORD                          *
  5135****************************************************************
  5136
  5137     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5138         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5139             20  CF-LIFE-CODE-IN            PIC XX.
  5140             20  CF-LIFE-CODE-OUT           PIC XX.
  5141         16  FILLER                         PIC X(248).
  5142
  5143
  5144****************************************************************
  5145*             AH EDIT MASTER RECORD                            *
  5146****************************************************************
  5147
  5148     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5149         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5150             20  CF-AH-CODE-IN              PIC XXX.
  5151             20  CF-AH-CODE-OUT             PIC XX.
  5152         16  FILLER                         PIC X(248).
  5153
  5154
  5155****************************************************************
  5156*             CREDIBILITY TABLES                               *
  5157****************************************************************
  5158
  5159     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5160         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5161                             INDEXED BY CF-CRDB-NDX.
  5162             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5163             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5164             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5165         16  FILLER                         PIC  X(332).
  5166
  5167
  5168****************************************************************
  5169*             REPORT CUSTOMIZATION RECORD                      *
  5170****************************************************************
  5171
  5172     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5173         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5174             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5175             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5176             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5177**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5178****       A T-TRANSFER.                                   ****
  5179             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  98
* EL156.cbl
  5180
  5181         16  FILLER                         PIC XX.
  5182
  5183         16  CF-CARRIER-CNTL-OPT.
  5184             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5185                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5186                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5187             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5188                                            PIC X.
  5189         16  CF-GROUP-CNTL-OPT.
  5190             20  CF-GROUP-OPT-SEQ           PIC 9.
  5191                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5192                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5193             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5194                                            PIC X(6).
  5195         16  CF-STATE-CNTL-OPT.
  5196             20  CF-STATE-OPT-SEQ           PIC 9.
  5197                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5198                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5199             20  CF-STATE-SELECT OCCURS 3 TIMES
  5200                                            PIC XX.
  5201         16  CF-ACCOUNT-CNTL-OPT.
  5202             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5203                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5204                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5205             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5206                                            PIC X(10).
  5207         16  CF-BUS-TYP-CNTL-OPT.
  5208             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5209                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5210                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5211             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5212                                            PIC XX.
  5213         16  CF-LF-TYP-CNTL-OPT.
  5214             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5215                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5216                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5217             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5218                                            PIC XX.
  5219         16  CF-AH-TYP-CNTL-OPT.
  5220             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5221                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5222                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5223             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5224                                            PIC XX.
  5225         16  CF-REPTCD1-CNTL-OPT.
  5226             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5227                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5228                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5229             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5230                                            PIC X(10).
  5231         16  CF-REPTCD2-CNTL-OPT.
  5232             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5233                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5234                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5235             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5236                                            PIC X(10).
  5237         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page  99
* EL156.cbl
  5238             20  CF-USER1-OPT-SEQ           PIC 9.
  5239                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5240                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5241             20  CF-USER1-SELECT OCCURS 3 TIMES
  5242                                            PIC X(10).
  5243         16  CF-USER2-CNTL-OPT.
  5244             20  CF-USER2-OPT-SEQ           PIC 9.
  5245                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5246                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5247             20  CF-USER2-SELECT OCCURS 3 TIMES
  5248                                            PIC X(10).
  5249         16  CF-USER3-CNTL-OPT.
  5250             20  CF-USER3-OPT-SEQ           PIC 9.
  5251                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5252                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5253             20  CF-USER3-SELECT OCCURS 3 TIMES
  5254                                            PIC X(10).
  5255         16  CF-USER4-CNTL-OPT.
  5256             20  CF-USER4-OPT-SEQ           PIC 9.
  5257                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5258                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5259             20  CF-USER4-SELECT OCCURS 3 TIMES
  5260                                            PIC X(10).
  5261         16  CF-USER5-CNTL-OPT.
  5262             20  CF-USER5-OPT-SEQ           PIC 9.
  5263                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5264                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5265             20  CF-USER5-SELECT OCCURS 3 TIMES
  5266                                            PIC X(10).
  5267         16  CF-REINS-CNTL-OPT.
  5268             20  CF-REINS-OPT-SEQ           PIC 9.
  5269                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5270                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5271             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5272                 24  CF-REINS-PRIME         PIC XXX.
  5273                 24  CF-REINS-SUB           PIC XXX.
  5274
  5275         16  CF-AGENT-CNTL-OPT.
  5276             20  CF-AGENT-OPT-SEQ           PIC 9.
  5277                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5278                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5279             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5280                                            PIC X(10).
  5281
  5282         16  FILLER                         PIC X(43).
  5283
  5284         16  CF-LOSS-RATIO-SELECT.
  5285             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5286             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5287         16  CF-ENTRY-DATE-SELECT.
  5288             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5289             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5290         16  CF-EFFECTIVE-DATE-SELECT.
  5291             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5292             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5293
  5294         16  CF-EXCEPTION-LIST-IND          PIC X.
  5295             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 100
* EL156.cbl
  5296
  5297         16  FILLER                         PIC X(318).
  5298
  5299****************************************************************
  5300*                  EXCEPTION REPORTING RECORD                  *
  5301****************************************************************
  5302
  5303     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5304         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5305             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5306
  5307         16  CF-COMBINED-LIFE-AH-OPT.
  5308             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5309             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5310             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5311             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5312
  5313         16  CF-LIFE-OPT.
  5314             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5315             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5316             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5317             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5318             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5319             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5320             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5321             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5322             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5323             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5324
  5325         16  CF-AH-OPT.
  5326             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5327             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5328             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5329             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5330             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5331             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5332             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5333             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5334             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5335             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5336
  5337         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5338             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5339             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5340             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5341
  5342         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5343
  5344         16  FILLER                         PIC X(673).
  5345
  5346
  5347****************************************************************
  5348*             MORTGAGE SYSTEM PLAN RECORD                      *
  5349****************************************************************
  5350
  5351     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5352         16  CF-PLAN-TYPE                   PIC X.
  5353             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 101
* EL156.cbl
  5354             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5355             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5356         16  CF-PLAN-ABBREV                 PIC XXX.
  5357         16  CF-PLAN-DESCRIPT               PIC X(10).
  5358         16  CF-PLAN-NOTES                  PIC X(20).
  5359         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5360         16  CF-PLAN-UNDERWRITING.
  5361             20  CF-PLAN-TERM-DATA.
  5362                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5363                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5364             20  CF-PLAN-AGE-DATA.
  5365                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5366                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5367                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5368             20  CF-PLAN-BENEFIT-DATA.
  5369                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5370                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5371                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5372                                            PIC S9(7)V99  COMP-3.
  5373         16  CF-PLAN-POLICY-FORMS.
  5374             20  CF-POLICY-FORM             PIC X(12).
  5375             20  CF-MASTER-APPLICATION      PIC X(12).
  5376             20  CF-MASTER-POLICY           PIC X(12).
  5377         16  CF-PLAN-RATING.
  5378             20  CF-RATE-CODE               PIC X(5).
  5379             20  CF-SEX-RATING              PIC X.
  5380                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5381                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5382             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5383             20  CF-SUB-STD-TYPE            PIC X.
  5384                 88  CF-PCT-OF-PREM            VALUE '1'.
  5385                 88  CF-PCT-OF-BENE            VALUE '2'.
  5386         16  CF-PLAN-PREM-TOLERANCES.
  5387             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5388             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5389         16  CF-PLAN-PYMT-TOLERANCES.
  5390             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5391             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5392         16  CF-PLAN-MISC-DATA.
  5393             20  FILLER                     PIC X.
  5394             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5395             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5396         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5397         16  CF-PLAN-IND-GRP                PIC X.
  5398             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5399                                                     '1'.
  5400             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5401                                                     '2'.
  5402         16  CF-MIB-SEARCH-SW               PIC X.
  5403             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5404             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5405             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5406             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5407         16  CF-ALPHA-SEARCH-SW             PIC X.
  5408             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5409             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5410             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5411             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 102
* EL156.cbl
  5412             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5413             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5414             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5415             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5416             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5417             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5418                                                     'A' 'B' 'C'
  5419                                                     'X' 'Y' 'Z'.
  5420         16  CF-EFF-DT-RULE-SW              PIC X.
  5421             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5422             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5423             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5424             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5425             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5426         16  FILLER                         PIC X(4).
  5427         16  CF-HEALTH-QUESTIONS            PIC X.
  5428             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5429         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5430         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5431         16  CF-PLAN-SNGL-JNT               PIC X.
  5432             88  CF-COMBINED-PLAN              VALUE 'C'.
  5433             88  CF-JNT-PLAN                   VALUE 'J'.
  5434             88  CF-SNGL-PLAN                  VALUE 'S'.
  5435         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5436         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5437         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5438         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5439         16  CF-RERATE-CNTL                 PIC  X.
  5440             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5441             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5442             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5443             88  CF-AUTO-RECALC                 VALUE '4'.
  5444         16  CF-BENEFIT-TYPE                PIC  X.
  5445             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5446             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5447         16  CF-POLICY-FEE                  PIC S999V99
  5448                                                    COMP-3.
  5449         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5450         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5451         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5452         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5453         16  FILLER                         PIC  X(32).
  5454         16  CF-TERMINATION-FORM            PIC  X(04).
  5455         16  FILLER                         PIC  X(08).
  5456         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5457                                                       COMP-3.
  5458         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5459         16  CF-ISSUE-LETTER                PIC  X(4).
  5460         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5461         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5462             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5463             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5464         16  CF-MP-REFUND-CALC              PIC X.
  5465             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5466             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5467             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5468             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5469             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 103
* EL156.cbl
  5470             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5471             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5472             88  CF-MP-REFD-MEAN                VALUE '8'.
  5473         16  CF-ALT-RATE-CODE               PIC  X(5).
  5474
  5475
  5476         16  FILLER                         PIC X(498).
  5477****************************************************************
  5478*             MORTGAGE COMPANY MASTER RECORD                   *
  5479****************************************************************
  5480
  5481     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5482         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5483         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5484             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5485             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5486             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5487             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5488             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5489
  5490         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5491         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5492         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5493         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5494         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5495
  5496         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5497             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5498         16  CF-MP-RECON-USE-IND            PIC X(1).
  5499             88  CF-MP-USE-RECON             VALUE 'Y'.
  5500         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5501             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5502         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5503             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5504             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5505         16  FILLER                         PIC X(1).
  5506         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5507             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5508         16  CF-MORTG-MIB-VERSION           PIC X.
  5509             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5510             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5511             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5512         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5513             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5514                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5515             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5516                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5517             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5518                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5519             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5520                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5521             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5522                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5523             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5524                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5525         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5526         16  FILLER                         PIC X(7).
  5527         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 104
* EL156.cbl
  5528             20  CF-MORTG-MIB-COMM          PIC X(5).
  5529             20  CF-MORTG-MIB-TERM          PIC X(5).
  5530         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5531             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5532         16  FILLER                         PIC X(03).
  5533         16  CF-MP-CHECK-NO-CONTROL.
  5534             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5535                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5536                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5537                                                ' ' LOW-VALUES.
  5538                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5539                                               VALUE '3'.
  5540         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5541         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5542         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5543             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5544                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5545             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5546                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5547             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5548                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5549             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5550                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5551             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5552                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5553             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5554                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5555         16  CF-MORTG-BILLING-AREA.
  5556             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5557                                            PIC X.
  5558         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5559         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5560         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5561         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5562             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5563             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5564         16  FILLER                         PIC X.
  5565         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5566             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5567             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5568         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5569         16  FILLER                         PIC X(8).
  5570         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5571         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5572         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5573         16  CF-ACH-COMPANY-ID.
  5574             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5575                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5576                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5577                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5578             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5579         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5580             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5581         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5582             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5583             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5584         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5585         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 105
* EL156.cbl
  5586         16  FILLER                         PIC X(536).
  5587
  5588****************************************************************
  5589*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5590****************************************************************
  5591
  5592     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5593         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5594             20  CF-FEMALE-HEIGHT.
  5595                 24  CF-FEMALE-FT           PIC 99.
  5596                 24  CF-FEMALE-IN           PIC 99.
  5597             20  CF-FEMALE-MIN-WT           PIC 999.
  5598             20  CF-FEMALE-MAX-WT           PIC 999.
  5599         16  FILLER                         PIC X(428).
  5600
  5601     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5602         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5603             20  CF-MALE-HEIGHT.
  5604                 24  CF-MALE-FT             PIC 99.
  5605                 24  CF-MALE-IN             PIC 99.
  5606             20  CF-MALE-MIN-WT             PIC 999.
  5607             20  CF-MALE-MAX-WT             PIC 999.
  5608         16  FILLER                         PIC X(428).
  5609******************************************************************
  5610*             AUTOMATIC ACTIVITY RECORD                          *
  5611******************************************************************
  5612     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5613         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5614             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5615             20  CF-SYS-LETTER-ID           PIC X(04).
  5616             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5617             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5618             20  CF-SYS-RESET-SW            PIC X(01).
  5619             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5620             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5621
  5622         16  FILLER                         PIC X(50).
  5623
  5624         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5625             20  CF-USER-ACTIVE-SW          PIC X(01).
  5626             20  CF-USER-LETTER-ID          PIC X(04).
  5627             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5628             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5629             20  CF-USER-RESET-SW           PIC X(01).
  5630             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5631             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5632             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5633
  5634         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 106
* EL156.cbl
  5636*    COPY ELCCERT.
  5637******************************************************************
  5638*                                                                *
  5639*                            ELCCERT.                            *
  5640*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5641*                            VMOD=2.013                          *
  5642*                                                                *
  5643*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5644*                                                                *
  5645*   FILE TYPE = VSAM,KSDS                                        *
  5646*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5647*                                                                *
  5648*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5649*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5650*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5651*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5652*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5653*                                                                *
  5654*   LOG = YES                                                    *
  5655*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5656******************************************************************
  5657*                   C H A N G E   L O G
  5658*
  5659* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5660*-----------------------------------------------------------------
  5661*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5662* EFFECTIVE    NUMBER
  5663*-----------------------------------------------------------------
  5664* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5665* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5666* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5667* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5668* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5669* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5670* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5671* 032612  CR2011110200001  PEMA  AHL CHANGES
  5672* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5673* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5674******************************************************************
  5675
  5676 01  CERTIFICATE-MASTER.
  5677     12  CM-RECORD-ID                      PIC XX.
  5678         88  VALID-CM-ID                      VALUE 'CM'.
  5679
  5680     12  CM-CONTROL-PRIMARY.
  5681         16  CM-COMPANY-CD                 PIC X.
  5682         16  CM-CARRIER                    PIC X.
  5683         16  CM-GROUPING.
  5684             20  CM-GROUPING-PREFIX        PIC X(3).
  5685             20  CM-GROUPING-PRIME         PIC X(3).
  5686         16  CM-STATE                      PIC XX.
  5687         16  CM-ACCOUNT.
  5688             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5689             20  CM-ACCOUNT-PRIME          PIC X(6).
  5690         16  CM-CERT-EFF-DT                PIC XX.
  5691         16  CM-CERT-NO.
  5692             20  CM-CERT-PRIME             PIC X(10).
  5693             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 107
* EL156.cbl
  5694
  5695     12  CM-CONTROL-BY-NAME.
  5696         16  CM-COMPANY-CD-A1              PIC X.
  5697         16  CM-INSURED-LAST-NAME          PIC X(15).
  5698         16  CM-INSURED-INITIALS.
  5699             20  CM-INSURED-INITIAL1       PIC X.
  5700             20  CM-INSURED-INITIAL2       PIC X.
  5701
  5702     12  CM-CONTROL-BY-SSN.
  5703         16  CM-COMPANY-CD-A2              PIC X.
  5704         16  CM-SOC-SEC-NO.
  5705             20  CM-SSN-STATE              PIC XX.
  5706             20  CM-SSN-ACCOUNT            PIC X(6).
  5707             20  CM-SSN-LN3.
  5708                 25  CM-INSURED-INITIALS-A2.
  5709                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5710                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5711                 25 CM-PART-LAST-NAME-A2         PIC X.
  5712
  5713     12  CM-CONTROL-BY-CERT-NO.
  5714         16  CM-COMPANY-CD-A4              PIC X.
  5715         16  CM-CERT-NO-A4                 PIC X(11).
  5716
  5717     12  CM-CONTROL-BY-MEMB.
  5718         16  CM-COMPANY-CD-A5              PIC X.
  5719         16  CM-MEMBER-NO.
  5720             20  CM-MEMB-STATE             PIC XX.
  5721             20  CM-MEMB-ACCOUNT           PIC X(6).
  5722             20  CM-MEMB-LN4.
  5723                 25  CM-INSURED-INITIALS-A5.
  5724                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5725                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5726                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5727
  5728     12  CM-INSURED-PROFILE-DATA.
  5729         16  CM-INSURED-FIRST-NAME.
  5730             20  CM-INSURED-1ST-INIT       PIC X.
  5731             20  FILLER                    PIC X(9).
  5732         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5733         16  CM-INSURED-SEX                PIC X.
  5734             88  CM-SEX-MALE                  VALUE 'M'.
  5735             88  CM-SEX-FEMAL                 VALUE 'F'.
  5736         16  CM-INSURED-JOINT-AGE          PIC 99.
  5737         16  CM-JOINT-INSURED-NAME.
  5738             20  CM-JT-LAST-NAME           PIC X(15).
  5739             20  CM-JT-FIRST-NAME.
  5740                 24  CM-JT-1ST-INIT        PIC X.
  5741                 24  FILLER                PIC X(9).
  5742             20  CM-JT-INITIAL             PIC X.
  5743
  5744     12  CM-LIFE-DATA.
  5745         16  CM-LF-BENEFIT-CD              PIC XX.
  5746         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5747         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5748         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5749         16  CM-LF-DEV-CODE                PIC XXX.
  5750         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5751         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 108
* EL156.cbl
  5752         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5753         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5754         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5755         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5756         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5757         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5758         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5759         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5760         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5761         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5762         16  cm-temp-epiq                  pic xx.
  5763             88  EPIQ-CLASS                  value 'EQ'.
  5764*        16  FILLER                        PIC XX.
  5765
  5766     12  CM-AH-DATA.
  5767         16  CM-AH-BENEFIT-CD              PIC XX.
  5768         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5769         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5770         16  CM-AH-DEV-CODE                PIC XXX.
  5771         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5772         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5773         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5774         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5775         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5776         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5777         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5778         16  CM-AH-PAID-THRU-DT            PIC XX.
  5779             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5780         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5781         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5782         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5783         16  FILLER                        PIC X.
  5784
  5785     12  CM-LOAN-INFORMATION.
  5786         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5787         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5788                                           PIC S9(5)V99  COMP-3.
  5789         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5790         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5791         16  CM-PAY-FREQUENCY              PIC S99.
  5792         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5793         16  CM-RATE-CLASS                 PIC XX.
  5794         16  CM-BENEFICIARY                PIC X(25).
  5795         16  CM-POLICY-FORM-NO             PIC X(12).
  5796         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5797         16  CM-LAST-ADD-ON-DT             PIC XX.
  5798         16  CM-DEDUCTIBLE-AMOUNTS.
  5799             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5800             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5801         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5802             20  CM-RESIDENT-STATE         PIC XX.
  5803             20  CM-RATE-CODE              PIC X(4).
  5804             20  FILLER                    PIC XX.
  5805         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5806             20  CM-LOAN-OFFICER           PIC X(5).
  5807             20  FILLER                    PIC XXX.
  5808         16  CM-CSR-CODE                   PIC XXX.
  5809         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 109
* EL156.cbl
  5810             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5811         16  CM-POST-CARD-IND              PIC X.
  5812         16  CM-NH-INTERFACE-SW            PIC X.
  5813         16  CM-PREMIUM-TYPE               PIC X.
  5814             88  CM-SING-PRM                  VALUE '1'.
  5815             88  CM-O-B-COVERAGE              VALUE '2'.
  5816             88  CM-OPEN-END                  VALUE '3'.
  5817         16  CM-IND-GRP-TYPE               PIC X.
  5818             88  CM-INDIVIDUAL                VALUE 'I'.
  5819             88  CM-GROUP                     VALUE 'G'.
  5820         16  CM-SKIP-CODE                  PIC X.
  5821             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5822             88  SKIP-JULY                    VALUE '1'.
  5823             88  SKIP-AUGUST                  VALUE '2'.
  5824             88  SKIP-SEPTEMBER               VALUE '3'.
  5825             88  SKIP-JULY-AUG                VALUE '4'.
  5826             88  SKIP-AUG-SEPT                VALUE '5'.
  5827             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5828             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5829             88  SKIP-JUNE                    VALUE '8'.
  5830             88  SKIP-JUNE-JULY               VALUE '9'.
  5831             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5832             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5833         16  CM-PAYMENT-MODE               PIC X.
  5834             88  PAY-MONTHLY                  VALUE SPACE.
  5835             88  PAY-WEEKLY                   VALUE '1'.
  5836             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5837             88  PAY-BI-WEEKLY                VALUE '3'.
  5838             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5839         16  CM-LOAN-NUMBER                PIC X(8).
  5840         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5841         16  CM-OLD-LOF                    PIC XXX.
  5842*        16  CM-LOAN-OFFICER               PIC XXX.
  5843         16  CM-REIN-TABLE                 PIC XXX.
  5844         16  CM-SPECIAL-REIN-CODE          PIC X.
  5845         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5846         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5847         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5848
  5849     12  CM-STATUS-DATA.
  5850         16  CM-ENTRY-STATUS               PIC X.
  5851         16  CM-ENTRY-DT                   PIC XX.
  5852
  5853         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5854         16  CM-LF-CANCEL-DT               PIC XX.
  5855         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5856
  5857         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5858         16  CM-LF-DEATH-DT                PIC XX.
  5859         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5860
  5861         16  CM-LF-CURRENT-STATUS          PIC X.
  5862             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5863                                                'M' '4' '5' '9'.
  5864             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5865             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5866             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5867             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 110
* EL156.cbl
  5868             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5869             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5870             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5871             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5872             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5873             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5874             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5875             88  CM-LF-DECLINED               VALUE 'D'.
  5876             88  CM-LF-VOIDED                 VALUE 'V'.
  5877
  5878         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5879         16  CM-AH-CANCEL-DT               PIC XX.
  5880         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5881
  5882         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5883         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5884         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5885
  5886         16  CM-AH-CURRENT-STATUS          PIC X.
  5887             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5888                                                'M' '4' '5' '9'.
  5889             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5890             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5891             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5892             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5893             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5894             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5895             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5896             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5897             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5898             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5899             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5900             88  CM-AH-DECLINED               VALUE 'D'.
  5901             88  CM-AH-VOIDED                 VALUE 'V'.
  5902
  5903         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5904             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5905             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5906             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5907         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5908
  5909         16  CM-ENTRY-BATCH                PIC X(6).
  5910         16  CM-LF-EXIT-BATCH              PIC X(6).
  5911         16  CM-AH-EXIT-BATCH              PIC X(6).
  5912         16  CM-LAST-MONTH-END             PIC XX.
  5913
  5914     12  CM-NOTE-SW                        PIC X.
  5915         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5916         88  CERT-NOTES-PRESENT               VALUE '1'.
  5917         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5918         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5919         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5920         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5921         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5922         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5923     12  CM-COMP-EXCP-SW                   PIC X.
  5924         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5925         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 111
* EL156.cbl
  5926     12  CM-INSURED-ADDRESS-SW             PIC X.
  5927         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5928         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5929
  5930*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5931     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5932     12  FILLER                            PIC X.
  5933
  5934*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5935     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5936     12  FILLER                            PIC X.
  5937*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5938     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5939
  5940     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5941         88  CERT-ADDED-BATCH                 VALUE ' '.
  5942         88  CERT-ADDED-ONLINE                VALUE '1'.
  5943         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5944         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5945         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5946     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5947         88  CERT-AS-LOADED                   VALUE ' '.
  5948         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5949         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5950         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5951         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5952         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5953         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5954         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5955
  5956     12  CM-ACCOUNT-COMM-PCTS.
  5957         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5958         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5959
  5960     12  CM-USER-FIELD                     PIC X.
  5961     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5962     12  CM-CLP-STATE                      PIC XX.
  5963     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5964     12  CM-USER-RESERVED                  PIC XXX.
  5965     12  FILLER REDEFINES CM-USER-RESERVED.
  5966         16  CM-AH-CLASS-CD                PIC XX.
  5967         16  F                             PIC X.
  5968******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 112
* EL156.cbl
  5970*    COPY ELCTRLR.
  5971******************************************************************
  5972*                                                                *
  5973*                            ELCTRLR.                            *
  5974*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5975*                            VMOD=2.014                          *
  5976*                                                                *
  5977*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5978*                                                                *
  5979*   FILE TYPE = VSAM,KSDS                                        *
  5980*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5981*                                                                *
  5982*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5983*       ALTERNATE INDEX = NONE                                   *
  5984*                                                                *
  5985*   LOG = YES                                                    *
  5986*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5987******************************************************************
  5988*                   C H A N G E   L O G
  5989*
  5990* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5991*-----------------------------------------------------------------
  5992*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5993* EFFECTIVE    NUMBER
  5994*-----------------------------------------------------------------
  5995* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5996* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5997* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5998* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5999* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  6000* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  6001* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  6002* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  6003* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  6004* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  6005* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  6006* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  6007* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  6008* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  6009* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  6010* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  6011* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  6012* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  6013* 040814    2014030500002  AJRA  ADD ICD CODES
  6014* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  6015* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6016* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  6017******************************************************************
  6018 01  ACTIVITY-TRAILERS.
  6019     12  AT-RECORD-ID                    PIC XX.
  6020         88  VALID-AT-ID                       VALUE 'AT'.
  6021
  6022     12  AT-CONTROL-PRIMARY.
  6023         16  AT-COMPANY-CD               PIC X.
  6024         16  AT-CARRIER                  PIC X.
  6025         16  AT-CLAIM-NO                 PIC X(7).
  6026         16  AT-CERT-NO.
  6027             20  AT-CERT-PRIME           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 113
* EL156.cbl
  6028             20  AT-CERT-SFX             PIC X.
  6029         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  6030             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  6031             88  AT-LAST-TRL-AVAIL            VALUE +100.
  6032             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  6033             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  6034             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  6035             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  6036             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  6037             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  6038             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  6039             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  6040             88  AT-DIAGNOSIS-TRL             VALUE +90.
  6041             88  AT-BENEFICIARY-TRL           VALUE +91.
  6042             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  6043             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  6044             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  6045             88  AT-ERROR-MSGS-TRL            VALUE +95.
  6046
  6047     12  AT-TRAILER-TYPE                 PIC X.
  6048         88  RESERVE-EXPENSE-TR               VALUE '1'.
  6049         88  PAYMENT-TR                       VALUE '2'.
  6050         88  AUTO-PAY-TR                      VALUE '3'.
  6051         88  CORRESPONDENCE-TR                VALUE '4'.
  6052         88  ADDRESS-TR                       VALUE '5'.
  6053         88  GENERAL-INFO-TR                  VALUE '6'.
  6054         88  AUTO-PROMPT-TR                   VALUE '7'.
  6055         88  DENIAL-TR                        VALUE '8'.
  6056         88  INCURRED-CHG-TR                  VALUE '9'.
  6057         88  FORM-CONTROL-TR                  VALUE 'A'.
  6058
  6059     12  AT-RECORDED-DT                  PIC XX.
  6060     12  AT-RECORDED-BY                  PIC X(4).
  6061     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  6062
  6063     12  AT-TRAILER-BODY                 PIC X(165).
  6064
  6065     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  6066         16  AT-RESERVE-CONTROLS.
  6067             20  AT-MANUAL-SW            PIC X.
  6068                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  6069             20  AT-FUTURE-SW            PIC X.
  6070                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  6071             20  AT-PTC-SW               PIC X.
  6072                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6073             20  AT-IBNR-SW              PIC X.
  6074                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6075             20  AT-PTC-LF-SW            PIC X.
  6076                 88  AT-LF-PTC-USED          VALUE '1'.
  6077             20  AT-CDT-ACCESS-METHOD    PIC X.
  6078                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6079                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6080                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6081             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6082         16  AT-LAST-COMPUTED-DT         PIC XX.
  6083         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  6084         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6085         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 114
* EL156.cbl
  6086         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6087         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6088         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6089         16  AT-EXPENSE-CONTROLS.
  6090             20  AT-EXPENSE-METHOD       PIC X.
  6091                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6092                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6093                 88  PERCENT-OF-PMT           VALUE '3'.
  6094                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6095             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6096             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6097         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6098         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6099
  6100         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6101         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6102
  6103*        16  FILLER                      PIC X(53).
  6104         16  FILLER                      PIC X(47).
  6105
  6106         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6107         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6108
  6109         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6110             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6111             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6112*                    C = CLOSED
  6113*                    O = OPEN
  6114             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6115*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6116
  6117     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6118         16  AT-PAYMENT-TYPE             PIC X.
  6119             88  PARTIAL-PAYMENT                VALUE '1'.
  6120             88  FINAL-PAYMENT                  VALUE '2'.
  6121             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6122             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6123             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6124             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6125             88  VOIDED-PAYMENT                 VALUE '9'.
  6126             88  TRANSFER                       VALUE 'T'.
  6127             88  LIFE-INTEREST                  VALUE 'I'.
  6128
  6129         16  AT-CLAIM-TYPE               PIC X.
  6130             88  PAID-FOR-AH                    VALUE 'A'.
  6131             88  PAID-FOR-LIFE                  VALUE 'L'.
  6132             88  PAID-FOR-IUI                   VALUE 'I'.
  6133             88  PAID-FOR-GAP                   VALUE 'G'.
  6134             88  PAID-FOR-FAM                   VALUE 'F'.
  6135         16  AT-CLAIM-PREM-TYPE          PIC X.
  6136             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6137             88  AT-O-B-COVERAGE                VALUE '2'.
  6138             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6139         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6140         16  AT-CHECK-NO                 PIC X(7).
  6141         16  AT-PAID-FROM-DT             PIC XX.
  6142         16  AT-PAID-THRU-DT             PIC XX.
  6143         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 115
* EL156.cbl
  6144         16  AT-ACH-PAYMENT              PIC X.
  6145*        16  FILLER                      PIC X.
  6146         16  AT-PAYEES-NAME              PIC X(30).
  6147         16  AT-PAYMENT-ORIGIN           PIC X.
  6148             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6149             88  ONLINE-AUTO-PMT                VALUE '2'.
  6150             88  OFFLINE-PMT                    VALUE '3'.
  6151         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6152         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6153         16  AT-VOID-DATA.
  6154             20  AT-VOID-DT              PIC XX.
  6155*00144       20  AT-VOID-REASON          PIC X(30).
  6156             20  AT-VOID-REASON          PIC X(26).
  6157         16  AT-PMT-APPROVED-BY          PIC X(04).
  6158         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6159         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6160         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6161                                         PIC S99V9(5)  COMP-3.
  6162         16  AT-CREDIT-INTERFACE.
  6163             20  AT-PMT-SELECT-DT        PIC XX.
  6164                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6165             20  AT-PMT-ACCEPT-DT        PIC XX.
  6166                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6167             20  AT-VOID-SELECT-DT       PIC XX.
  6168                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6169             20  AT-VOID-ACCEPT-DT       PIC XX.
  6170                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6171
  6172         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6173                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6174                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6175         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6176
  6177         16  AT-FORCE-CONTROL            PIC X.
  6178             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6179         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6180         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6181         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6182         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6183         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6184         16  AT-BENEFIT-TYPE             PIC X.
  6185
  6186         16  AT-EXPENSE-TYPE             PIC X.
  6187         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6188
  6189         16  AT-PAYEE-TYPE-CD.
  6190             20  AT-PAYEE-TYPE           PIC X.
  6191                 88  INSURED-PAID           VALUE 'I'.
  6192                 88  BENEFICIARY-PAID       VALUE 'B'.
  6193                 88  ACCOUNT-PAID           VALUE 'A'.
  6194                 88  OTHER-1-PAID           VALUE 'O'.
  6195                 88  OTHER-2-PAID           VALUE 'Q'.
  6196                 88  DOCTOR-PAID            VALUE 'P'.
  6197                 88  EMPLOYER-PAID          VALUE 'E'.
  6198             20  AT-PAYEE-SEQ            PIC X.
  6199
  6200         16  AT-CASH-PAYMENT             PIC X.
  6201         16  AT-GROUPED-PAYMENT          PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 116
* EL156.cbl
  6202         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6203         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6204         16  AT-APPROVED-LEVEL           PIC X.
  6205         16  AT-VOID-TYPE                PIC X.
  6206             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6207             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6208         16  AT-AIG-UNEMP-IND            PIC X.
  6209             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6210         16  AT-ASSOCIATES               PIC X.
  6211             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6212             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6213
  6214         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6215         16  AT-CV-PMT-CODE              PIC X.
  6216             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6217             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6218             88  FULL-ADD-PAYMENT           VALUE '3'.
  6219             88  HALF-ADD-PAYMENT           VALUE '4'.
  6220             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6221             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6222             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6223             88  ADDL-PAYMENT               VALUE '8'.
  6224
  6225         16  AT-EOB-CODE1                PIC XXX.
  6226         16  AT-EOB-CODE2                PIC XXX.
  6227         16  AT-EOB-CODE3                PIC XXX.
  6228         16  FILLER REDEFINES AT-EOB-CODE3.
  6229             20  AT-PRINT-CLM-FORM       PIC X.
  6230             20  AT-PRINT-SURVEY         PIC X.
  6231             20  AT-SPECIAL-RELEASE      PIC X.
  6232         16  AT-EOB-CODE4                PIC XXX.
  6233         16  FILLER REDEFINES AT-EOB-CODE4.
  6234             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6235             20  FILLER                  PIC X.
  6236         16  AT-EOB-CODE5                PIC XXX.
  6237         16  FILLER REDEFINES AT-EOB-CODE5.
  6238             20  AT-PMT-PROOF-DT         PIC XX.
  6239             20  FILLER                  PIC X.
  6240
  6241         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6242             88  AT-PRINT-EOB            VALUE 'Y'.
  6243
  6244         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6245         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6246
  6247     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6248         16  AT-SCHEDULE-START-DT        PIC XX.
  6249         16  AT-SCHEDULE-END-DT          PIC XX.
  6250         16  AT-TERMINATED-DT            PIC XX.
  6251         16  AT-LAST-PMT-TYPE            PIC X.
  6252             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6253             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6254         16  AT-FIRST-PMT-DATA.
  6255             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6256             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6257             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6258         16  AT-REGULAR-PMT-DATA.
  6259             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 117
* EL156.cbl
  6260             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6261             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6262         16  AT-AUTO-PAYEE-CD.
  6263             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6264                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6265                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6266                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6267                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6268                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6269             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6270         16  AT-AUTO-PAY-DAY             PIC 99.
  6271         16  AT-AUTO-CASH                PIC X.
  6272             88  AT-CASH                      VALUE 'Y'.
  6273             88  AT-NON-CASH                  VALUE 'N'.
  6274*        16  FILLER                      PIC X(129).
  6275         16  AT-AUTO-END-LETTER          PIC X(4).
  6276         16  FILLER                      PIC X(125).
  6277
  6278         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6279         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6280
  6281     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6282         16  AT-LETTER-SENT-DT           PIC XX.
  6283         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6284         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6285         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6286         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6287         16  AT-LETTER-ORIGIN            PIC X.
  6288             88  ONLINE-CREATION              VALUE '1' '3'.
  6289             88  OFFLINE-CREATION             VALUE '2' '4'.
  6290             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6291             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6292         16  AT-STD-LETTER-FORM          PIC X(4).
  6293         16  AT-REASON-TEXT              PIC X(70).
  6294         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6295         16  AT-ADDRESEE-TYPE            PIC X.
  6296              88  INSURED-ADDRESEE            VALUE 'I'.
  6297              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6298              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6299              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6300              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6301              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6302              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6303         16  AT-ADDRESSEE-NAME           PIC X(30).
  6304         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6305         16  AT-RESEND-PRINT-DATE        PIC XX.
  6306         16  AT-CORR-SOL-UNSOL           PIC X.
  6307         16  AT-LETTER-PURGED-DT         PIC XX.
  6308*
  6309*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6310*
  6311         16  AT-CSO-REDEFINITION.
  6312             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6313             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6314             20  AT-LETTER-TO-BENE       PIC X(1).
  6315             20  AT-STOP-LETTER-DT       PIC X(2).
  6316             20  AT-AUTH-RCVD            PIC X(1).
  6317             20  FILLER                  PIC X(18).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 118
* EL156.cbl
  6318*             20  FILLER                  PIC X(27).
  6319             20  AT-CSO-LETTER-STATUS    PIC X.
  6320                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6321                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6322                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6323             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6324             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6325*
  6326*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6327*
  6328*        16  FILLER                      PIC X(26).
  6329*
  6330*        16  AT-DMD-BSR-CODE             PIC X.
  6331*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6332*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6333*
  6334*        16  AT-DMD-LETTER-STATUS        PIC X.
  6335*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6336*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6337*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6338*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6339*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6340
  6341         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6342         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6343
  6344     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6345         16  AT-ADDRESS-TYPE             PIC X.
  6346             88  INSURED-ADDRESS               VALUE 'I'.
  6347             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6348             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6349             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6350             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6351             88  OTHER-ADDRESS-1               VALUE 'O'.
  6352             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6353         16  AT-MAIL-TO-NAME             PIC X(30).
  6354         16  AT-ADDRESS-LINE-1           PIC X(30).
  6355         16  AT-ADDRESS-LINE-2           PIC X(30).
  6356         16  AT-CITY-STATE.
  6357             20  AT-CITY                 PIC X(28).
  6358             20  AT-STATE                PIC XX.
  6359         16  AT-ZIP.
  6360             20  AT-ZIP-CODE.
  6361                 24  AT-ZIP-1ST          PIC X.
  6362                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6363                 24  FILLER              PIC X(4).
  6364             20  AT-ZIP-PLUS4            PIC X(4).
  6365         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6366             20  AT-CAN-POSTAL-1         PIC XXX.
  6367             20  AT-CAN-POSTAL-2         PIC XXX.
  6368             20  FILLER                  PIC XXX.
  6369         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6370*         16  FILLER                      PIC X(23).
  6371         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6372         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6373         16  FILLER                      PIC X(13).
  6374         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6375         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 119
* EL156.cbl
  6376
  6377     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6378         16  AT-INFO-LINE-1              PIC X(60).
  6379         16  FILLER REDEFINES AT-INFO-LINE-1.
  6380             20  AT-NOTE-ERROR-NO OCCURS 15
  6381                                         PIC X(4).
  6382         16  AT-INFO-LINE-2              PIC X(60).
  6383         16  FILLER REDEFINES AT-INFO-LINE-2.
  6384             20  AT-ICD-CODE-1           PIC X(8).
  6385             20  AT-ICD-CODE-2           PIC X(8).
  6386             20  FILLER                  PIC X(44).
  6387         16  AT-INFO-TRAILER-TYPE        PIC X.
  6388             88  AT-ERRORS-NOTE          VALUE 'E'.
  6389             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6390             88  AT-CALL-NOTE            VALUE 'C'.
  6391             88  AT-MAINT-NOTE           VALUE 'M'.
  6392             88  AT-CERT-CHANGE          VALUE 'X'.
  6393             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6394             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6395             88  AT-CERT-CANCELLED       VALUE 'T'.
  6396         16  AT-CALL-TYPE                PIC X.
  6397             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6398             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6399         16  AT-NOTE-CONTINUATION        PIC X.
  6400             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6401         16  AT-EOB-CODES-EXIST          PIC X.
  6402             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6403         16  FILLER                      PIC X(35).
  6404         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6405         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6406
  6407     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6408         16  AT-PROMPT-LINE-1            PIC X(60).
  6409         16  AT-PROMPT-LINE-2            PIC X(60).
  6410         16  AT-PROMPT-START-DT          PIC XX.
  6411         16  AT-PROMPT-END-DT            PIC XX.
  6412         16  FILLER                      PIC X(35).
  6413         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6414         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6415
  6416     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6417         16  AT-DENIAL-INFO-1            PIC X(60).
  6418         16  AT-DENIAL-INFO-2            PIC X(60).
  6419         16  AT-DENIAL-DT                PIC XX.
  6420         16  AT-RETRACTION-DT            PIC XX.
  6421         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6422*         16  FILLER                      PIC X(31).
  6423         16  AT-DENIAL-PROOF-DT          PIC XX.
  6424         16  FILLER                      PIC X(29).
  6425         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6426         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6427
  6428     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6429         16  AT-OLD-INCURRED-DT          PIC XX.
  6430         16  AT-OLD-REPORTED-DT          PIC XX.
  6431         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6432         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6433         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 120
* EL156.cbl
  6434         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6435         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6436         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6437         16  FILLER                      PIC X(26).
  6438         16  AT-OLD-DIAG-CODE            PIC X(6).
  6439         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6440         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6441         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6442         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6443         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6444         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6445         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6446         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6447         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6448         16  FILLER                      PIC X(9).
  6449         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6450
  6451     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6452         16  AT-FORM-SEND-ON-DT          PIC XX.
  6453         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6454         16  AT-FORM-RE-SEND-DT          PIC XX.
  6455         16  AT-FORM-ANSWERED-DT         PIC XX.
  6456         16  AT-FORM-PRINTED-DT          PIC XX.
  6457         16  AT-FORM-REPRINT-DT          PIC XX.
  6458         16  AT-FORM-TYPE                PIC X.
  6459             88  INITIAL-FORM                  VALUE '1'.
  6460             88  PROGRESS-FORM                 VALUE '2'.
  6461         16  AT-INSTRUCT-LN-1            PIC X(28).
  6462         16  AT-INSTRUCT-LN-2            PIC X(28).
  6463         16  AT-INSTRUCT-LN-3            PIC X(28).
  6464         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6465         16  AT-FORM-ADDRESS             PIC X.
  6466             88  FORM-TO-INSURED              VALUE 'I'.
  6467             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6468             88  FORM-TO-OTHER-1              VALUE 'O'.
  6469             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6470         16  AT-RELATED-1.
  6471             20 AT-REL-CARR-1            PIC X.
  6472             20 AT-REL-CLAIM-1           PIC X(7).
  6473             20 AT-REL-CERT-1            PIC X(11).
  6474         16  AT-RELATED-2.
  6475             20 AT-REL-CARR-2            PIC X.
  6476             20 AT-REL-CLAIM-2           PIC X(7).
  6477             20 AT-REL-CERT-2            PIC X(11).
  6478         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6479         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6480         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6481         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6482         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6483         16  AT-STOP-FORM-DT             PIC X(2).
  6484
  6485         16  FILLER                      PIC X(09).
  6486         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6487         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6488******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 121
* EL156.cbl
  6490*    COPY ELCACTQ.
  6491******************************************************************
  6492*                                                                *
  6493*                            ELCACTQ.                            *
  6494*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6495*                            VMOD=2.004                          *
  6496*                                                                *
  6497*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6498*                                                                *
  6499*   FILE TYPE = VSAM,KSDS                                        *
  6500*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6501*                                                                *
  6502*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6503*       ALTERNATE INDEX = NONE                                   *
  6504*                                                                *
  6505*   LOG = YES                                                    *
  6506*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6507*                                                                *
  6508*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6509******************************************************************
  6510
  6511 01  ACTIVITY-QUE.
  6512     12  AQ-RECORD-ID                PIC XX.
  6513         88  VALID-AQ-ID                VALUE 'AQ'.
  6514
  6515     12  AQ-CONTROL-PRIMARY.
  6516         16  AQ-COMPANY-CD           PIC X.
  6517         16  AQ-CARRIER              PIC X.
  6518         16  AQ-CLAIM-NO             PIC X(7).
  6519         16  AQ-CERT-NO.
  6520             20  AQ-CERT-PRIME       PIC X(10).
  6521             20  AQ-CERT-SFX         PIC X.
  6522
  6523     12  AQ-PENDING-ACTIVITY-FLAGS.
  6524         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6525         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6526             88  PENDING-PAYMENTS       VALUE '1'.
  6527         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6528             88  PENDING-FULL-PRINT     VALUE '1'.
  6529             88  PENDING-PART-PRINT     VALUE '2'.
  6530         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6531             88  PENDING-LETTERS        VALUE '1'.
  6532         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6533             88  PENDING-RESTORE        VALUE 'C'.
  6534             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6535
  6536     12  FILLER                      PIC X(20).
  6537
  6538     12  AQ-RESEND-DATE              PIC XX.
  6539     12  AQ-FOLLOWUP-DATE            PIC XX.
  6540     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6541     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6542     12  AQ-AUTO-LETTER              PIC X(4).
  6543     12  FILLER                      PIC XX.
  6544     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6545*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 122
* EL156.cbl
  6547*    COPY ERCACCT.
  6548******************************************************************
  6549*                                                                *
  6550*                                                                *
  6551*                            ERCACCT                             *
  6552*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6553*                            VMOD=2.031                          *
  6554*                                                                *
  6555*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6556*                                                                *
  6557*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6558*   VSAM ACCOUNT MASTER FILES.                                   *
  6559*                                                                *
  6560*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6561*                                                                *
  6562*   FILE TYPE = VSAM,KSDS                                        *
  6563*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6564*                                                                *
  6565*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6566*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6567*                                                                *
  6568*   LOG = NO                                                     *
  6569*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6570*                                                                *
  6571*                                                                *
  6572******************************************************************
  6573*                   C H A N G E   L O G
  6574*
  6575* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6576*-----------------------------------------------------------------
  6577*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6578* EFFECTIVE    NUMBER
  6579*-----------------------------------------------------------------
  6580* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6581* 092705    2005050300006  PEMA  ADD SPP LEASES
  6582* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6583* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6584* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6585* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6586* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6587* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6588******************************************************************
  6589
  6590 01  ACCOUNT-MASTER.
  6591     12  AM-RECORD-ID                      PIC XX.
  6592         88  VALID-AM-ID                      VALUE 'AM'.
  6593
  6594     12  AM-CONTROL-PRIMARY.
  6595         16  AM-COMPANY-CD                 PIC X.
  6596         16  AM-MSTR-CNTRL.
  6597             20  AM-CONTROL-A.
  6598                 24  AM-CARRIER            PIC X.
  6599                 24  AM-GROUPING.
  6600                     28 AM-GROUPING-PREFIX PIC XXX.
  6601                     28 AM-GROUPING-PRIME  PIC XXX.
  6602                 24  AM-STATE              PIC XX.
  6603                 24  AM-ACCOUNT.
  6604                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 123
* EL156.cbl
  6605                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6606             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6607                                           PIC X(19).
  6608             20  AM-CNTRL-B.
  6609                 24  AM-EXPIRATION-DT      PIC XX.
  6610                 24  FILLER                PIC X(4).
  6611             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6612                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6613
  6614     12  AM-CONTROL-BY-VAR-GRP.
  6615         16  AM-COMPANY-CD-A1              PIC X.
  6616         16  AM-VG-CARRIER                 PIC X.
  6617         16  AM-VG-GROUPING                PIC X(6).
  6618         16  AM-VG-STATE                   PIC XX.
  6619         16  AM-VG-ACCOUNT                 PIC X(10).
  6620         16  AM-VG-DATE.
  6621             20  AM-VG-EXPIRATION-DT       PIC XX.
  6622             20  FILLER                    PIC X(4).
  6623         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6624                                           PIC 9(11)      COMP-3.
  6625     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6626         16  FILLER                        PIC X(10).
  6627         16  AM-VG-KEY3.
  6628             20  AM-VG3-ACCOUNT            PIC X(10).
  6629             20  AM-VG3-EXP-DT             PIC XX.
  6630         16  FILLER                        PIC X(4).
  6631     12  AM-MAINT-INFORMATION.
  6632         16  AM-LAST-MAINT-DT              PIC XX.
  6633         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6634         16  AM-LAST-MAINT-USER            PIC X(4).
  6635         16  FILLER                        PIC XX.
  6636
  6637     12  AM-EFFECTIVE-DT                   PIC XX.
  6638     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6639
  6640     12  AM-PREV-DATES  COMP-3.
  6641         16  AM-PREV-EXP-DT                PIC 9(11).
  6642         16  AM-PREV-EFF-DT                PIC 9(11).
  6643
  6644     12  AM-REPORT-CODE-1                  PIC X(10).
  6645     12  AM-REPORT-CODE-2                  PIC X(10).
  6646
  6647     12  AM-CITY-CODE                      PIC X(4).
  6648     12  AM-COUNTY-PARISH                  PIC X(6).
  6649
  6650     12  AM-NAME                           PIC X(30).
  6651     12  AM-PERSON                         PIC X(30).
  6652     12  AM-ADDRS                          PIC X(30).
  6653     12  AM-CITY.
  6654         16  AM-ADDR-CITY                  PIC X(28).
  6655         16  AM-ADDR-STATE                 PIC XX.
  6656     12  AM-ZIP.
  6657         16  AM-ZIP-PRIME.
  6658             20  AM-ZIP-PRI-1ST            PIC X.
  6659                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6660             20  FILLER                    PIC X(4).
  6661         16  AM-ZIP-PLUS4                  PIC X(4).
  6662     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 124
* EL156.cbl
  6663         16  AM-CAN-POSTAL-1               PIC XXX.
  6664         16  AM-CAN-POSTAL-2               PIC XXX.
  6665         16  FILLER                        PIC XXX.
  6666     12  AM-TEL-NO.
  6667         16  AM-AREA-CODE                  PIC 999.
  6668         16  AM-TEL-PRE                    PIC 999.
  6669         16  AM-TEL-NBR                    PIC 9(4).
  6670     12  AM-TEL-LOC                        PIC X.
  6671         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6672         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6673
  6674     12  AM-COMM-STRUCTURE.
  6675         16  AM-DEFN-1.
  6676             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6677                 24  AM-AGT.
  6678                     28  AM-AGT-PREFIX     PIC X(4).
  6679                     28  AM-AGT-PRIME      PIC X(6).
  6680                 24  AM-COM-TYP            PIC X.
  6681                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6682                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6683                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6684                 24  AM-RECALC-LV-INDIC    PIC X.
  6685                 24  AM-RETRO-LV-INDIC     PIC X.
  6686                 24  AM-GL-CODES           PIC X.
  6687                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6688                 24  FILLER                PIC X(01).
  6689         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6690             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6691                 24  FILLER                PIC X(11).
  6692                 24  AM-L-COMA             PIC XXX.
  6693                 24  AM-J-COMA             PIC XXX.
  6694                 24  AM-A-COMA             PIC XXX.
  6695                 24  FILLER                PIC X(6).
  6696
  6697     12  AM-COMM-CHANGE-STATUS             PIC X.
  6698         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6699
  6700     12  AM-CSR-CODE                       PIC X(4).
  6701
  6702     12  AM-BILLING-STATUS                 PIC X.
  6703         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6704         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6705     12  AM-AUTO-REFUND-SW                 PIC X.
  6706         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6707         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6708     12  AM-GPCD                           PIC 99.
  6709     12  AM-IG                             PIC X.
  6710         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6711         88  AM-HAS-GROUP                     VALUE '2'.
  6712     12  AM-STATUS                         PIC X.
  6713         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6714         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6715         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6716         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6717         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6718         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6719         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6720         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 125
* EL156.cbl
  6721         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6722         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6723     12  AM-REMIT-TO                       PIC 99.
  6724     12  AM-ID-NO                          PIC X(11).
  6725
  6726     12  AM-CAL-TABLE                      PIC XX.
  6727     12  AM-LF-DEVIATION                   PIC XXX.
  6728     12  AM-AH-DEVIATION                   PIC XXX.
  6729     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6730     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6731     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6732     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6733     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6734     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6735
  6736     12  AM-USER-FIELDS.
  6737         16  AM-FLD-1                      PIC XX.
  6738         16  AM-FLD-2                      PIC XX.
  6739         16  AM-FLD-3                      PIC XX.
  6740         16  AM-FLD-4                      PIC XX.
  6741         16  AM-FLD-5                      PIC XX.
  6742
  6743     12  AM-1ST-PROD-DATE.
  6744         16  AM-1ST-PROD-YR                PIC XX.
  6745         16  AM-1ST-PROD-MO                PIC XX.
  6746         16  AM-1ST-PROD-DA                PIC XX.
  6747     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6748     12  AM-CERTS-PURGED-DATE.
  6749         16  AM-PUR-YR                     PIC XX.
  6750         16  AM-PUR-MO                     PIC XX.
  6751         16  AM-PUR-DA                     PIC XX.
  6752     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6753     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6754     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6755     12  AM-INACTIVE-DATE.
  6756         16  AM-INA-MO                     PIC 99.
  6757         16  AM-INA-DA                     PIC 99.
  6758         16  AM-INA-YR                     PIC 99.
  6759     12  AM-AR-HI-CERT-DATE                PIC XX.
  6760
  6761     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6762     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6763
  6764     12  AM-OB-PAYMENT-MODE                PIC X.
  6765         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6766         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6767         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6768         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6769
  6770     12  AM-AH-ONLY-INDICATOR              PIC X.
  6771         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6772         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6773
  6774     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6775
  6776     12  AM-OVER-SHORT.
  6777         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6778         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 126
* EL156.cbl
  6779
  6780     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6781     12  AM-DCC-CLP-STATE                  PIC XX.
  6782
  6783     12  AM-RECALC-COMM                    PIC X.
  6784     12  AM-RECALC-REIN                    PIC X.
  6785
  6786     12  AM-REI-TABLE                      PIC XXX.
  6787     12  AM-REI-ET-LF                      PIC X.
  6788     12  AM-REI-ET-AH                      PIC X.
  6789     12  AM-REI-PE-LF                      PIC X.
  6790     12  AM-REI-PE-AH                      PIC X.
  6791     12  AM-REI-PRT-ST                     PIC X.
  6792     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6793     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6794     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6795     12  AM-REI-GROUP-A                    PIC X(6).
  6796     12  AM-REI-MORT                       PIC X(4).
  6797     12  AM-REI-PRT-OW                     PIC X.
  6798     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6799     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6800     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6801     12  AM-REI-GROUP-B                    PIC X(6).
  6802
  6803     12  AM-TRUST-TYPE                     PIC X(2).
  6804
  6805     12  AM-EMPLOYER-STMT-USED             PIC X.
  6806     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6807
  6808     12  AM-STD-AH-TYPE                    PIC XX.
  6809     12  AM-EARN-METHODS.
  6810         16  AM-EARN-METHOD-R              PIC X.
  6811             88 AM-REF-RL-R78                 VALUE 'R'.
  6812             88 AM-REF-RL-PR                  VALUE 'P'.
  6813             88 AM-REF-RL-MEAN                VALUE 'M'.
  6814             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6815         16  AM-EARN-METHOD-L              PIC X.
  6816             88 AM-REF-LL-R78                 VALUE 'R'.
  6817             88 AM-REF-LL-PR                  VALUE 'P'.
  6818             88 AM-REF-LL-MEAN                VALUE 'M'.
  6819             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6820         16  AM-EARN-METHOD-A              PIC X.
  6821             88 AM-REF-AH-R78                 VALUE 'R'.
  6822             88 AM-REF-AH-PR                  VALUE 'P'.
  6823             88 AM-REF-AH-MEAN                VALUE 'M'.
  6824             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6825             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6826             88 AM-REF-AH-NET                 VALUE 'N'.
  6827
  6828     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6829     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6830     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6831
  6832     12  AM-RET-Y-N                        PIC X.
  6833     12  AM-RET-P-E                        PIC X.
  6834     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6835     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6836     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 127
* EL156.cbl
  6837     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6838         16  AM-POOL-PRIME                 PIC XXX.
  6839         16  AM-POOL-SUB                   PIC XXX.
  6840     12  AM-RETRO-EARNINGS.
  6841         16  AM-RET-EARN-R                 PIC X.
  6842         16  AM-RET-EARN-L                 PIC X.
  6843         16  AM-RET-EARN-A                 PIC X.
  6844     12  AM-RET-ST-TAX-USE                 PIC X.
  6845         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6846         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6847     12  AM-RETRO-BEG-EARNINGS.
  6848         16  AM-RET-BEG-EARN-R             PIC X.
  6849         16  AM-RET-BEG-EARN-L             PIC X.
  6850         16  AM-RET-BEG-EARN-A             PIC X.
  6851     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6852     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6853
  6854     12  AM-USER-SELECT-OPTIONS.
  6855         16  AM-USER-SELECT-1              PIC X(10).
  6856         16  AM-USER-SELECT-2              PIC X(10).
  6857         16  AM-USER-SELECT-3              PIC X(10).
  6858         16  AM-USER-SELECT-4              PIC X(10).
  6859         16  AM-USER-SELECT-5              PIC X(10).
  6860
  6861     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6862
  6863     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6864
  6865     12  AM-RPT045A-SWITCH                 PIC X.
  6866         88  RPT045A-OFF                   VALUE 'N'.
  6867
  6868     12  AM-INSURANCE-LIMITS.
  6869         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6870         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6871
  6872     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6873         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6874
  6875     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6876         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6877         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6878
  6879     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6880
  6881     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6882     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6883     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6884     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6885     12  AM-DCC-UEF-STATE                  PIC XX.
  6886     12  FILLER                            PIC XXX.
  6887     12  AM-REPORT-CODE-3                  PIC X(10).
  6888*    12  FILLER                            PIC X(22).
  6889
  6890     12  AM-RESERVE-DATE.
  6891         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6892         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6893         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6894
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 128
* EL156.cbl
  6895     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6896     12  AM-NOTIFICATION-TYPES.
  6897         16  AM-NOTIF-OF-LETTERS           PIC X.
  6898         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6899         16  AM-NOTIF-OF-REPORTS           PIC X.
  6900         16  AM-NOTIF-OF-STATUS            PIC X.
  6901
  6902     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6903         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6904         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6905         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6906         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6907
  6908     12  AM-BENEFIT-CONTROLS.
  6909         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6910             20  AM-BENEFIT-CODE           PIC XX.
  6911             20  AM-BENEFIT-TYPE           PIC X.
  6912             20  AM-BENEFIT-REVISION       PIC XXX.
  6913             20  AM-BENEFIT-REM-TERM       PIC X.
  6914             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6915             20  FILLER                    PIC XX.
  6916         16  FILLER                        PIC X(80).
  6917
  6918     12  AM-TRANSFER-DATA.
  6919         16  AM-TRANSFERRED-FROM.
  6920             20  AM-TRNFROM-CARRIER        PIC X.
  6921             20  AM-TRNFROM-GROUPING.
  6922                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6923                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6924             20  AM-TRNFROM-STATE          PIC XX.
  6925             20  AM-TRNFROM-ACCOUNT.
  6926                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6927                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6928             20  AM-TRNFROM-DTE            PIC XX.
  6929         16  AM-TRANSFERRED-TO.
  6930             20  AM-TRNTO-CARRIER          PIC X.
  6931             20  AM-TRNTO-GROUPING.
  6932                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6933                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6934             20  AM-TRNTO-STATE            PIC XX.
  6935             20  AM-TRNTO-ACCOUNT.
  6936                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6937                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6938             20  AM-TRNTO-DTE              PIC XX.
  6939         16  FILLER                        PIC X(10).
  6940
  6941     12  AM-SAVED-REMIT-TO                 PIC 99.
  6942
  6943     12  AM-COMM-STRUCTURE-SAVED.
  6944         16  AM-DEFN-1-SAVED.
  6945             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6946                 24  AM-AGT-SV             PIC X(10).
  6947                 24  AM-COM-TYP-SV         PIC X.
  6948                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6949                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6950                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6951                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6952                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 129
* EL156.cbl
  6953                 24  AM-GL-CODES-SV        PIC X.
  6954                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6955                 24  FILLER                PIC X.
  6956         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6957             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6958                 24  FILLER                PIC X(11).
  6959                 24  AM-L-COMA-SV          PIC XXX.
  6960                 24  AM-J-COMA-SV          PIC XXX.
  6961                 24  AM-A-COMA-SV          PIC XXX.
  6962                 24  FILLER                PIC X(6).
  6963
  6964     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6965         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6966            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6967            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6968            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6969
  6970     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6971     12  FILLER                            PIC X(120).
  6972
  6973     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6974         16  AM-CONTROL-NAME               PIC X(30).
  6975         16  AM-EXECUTIVE-ONE.
  6976             20  AM-EXEC1-NAME             PIC X(15).
  6977             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6978                                                          COMP-3.
  6979             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6980                                                          COMP-3.
  6981         16  AM-EXECUTIVE-TWO.
  6982             20  AM-EXEC2-NAME             PIC X(15).
  6983             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6984                                                          COMP-3.
  6985             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6986                                                          COMP-3.
  6987
  6988     12  AM-RETRO-ADDITIONAL-DATA.
  6989         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6990         16  AM-RETRO-PREM-P-E             PIC X.
  6991         16  AM-RETRO-CLMS-P-I             PIC X.
  6992         16  AM-RETRO-RET-BRACKET-LF.
  6993             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6994                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6995                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6996             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6997                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6998                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6999             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7000                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7001                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7002         16  AM-RETRO-RET-BRACKET-AH.
  7003             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7004                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7005                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7006                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7007             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7008                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7009                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7010             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 130
* EL156.cbl
  7011                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7012                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7013
  7014     12  AM-COMMENTS.
  7015         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7016
  7017     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7018         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7019         16  AM-FLI-BILLING-CODE           PIC X.
  7020         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7021         16  AM-FLI-UNITED-IDENT           PIC X.
  7022         16  AM-FLI-INTEREST-LOST-DATA.
  7023             20  AM-FLI-BANK-NO            PIC X(5).
  7024             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7025             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7026             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7027         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7028             20  AM-FLI-AGT                PIC X(9).
  7029             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7030             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7031         16  FILLER                        PIC X(102).
  7032
  7033     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7034         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7035             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7036             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7037             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7038             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7039             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7040         16  FILLER                          PIC X(10).
  7041******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 131
* EL156.cbl
  7043*    COPY ELCCHKQ.
  7044******************************************************************
  7045*                                                                *
  7046*                                                                *
  7047*                            ELCCHKQ.                            *
  7048*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7049*                            VMOD=2.007                          *
  7050*                                                                *
  7051*   FILE DESCRIPTION = CHECK QUE FILE                            *
  7052*                                                                *
  7053*   FILE TYPE = VSAM,KSDS                                        *
  7054*   RECORD SIZE = 100  RECFORM = FIXED                           *
  7055*                                                                *
  7056*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  7057*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  7058*                                                                *
  7059*   LOG = YES                                                    *
  7060*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7061******************************************************************
  7062 01  CHECK-QUE.
  7063     12  CQ-RECORD-ID                PIC XX.
  7064         88  VALID-CQ-ID         VALUE 'CQ'.
  7065
  7066     12  CQ-CONTROL-PRIMARY.
  7067         16  CQ-COMPANY-CD           PIC X.
  7068         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  7069         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  7070
  7071     12  CQ-CONTROL-BY-PAYEE.
  7072         16  CQ-CONTROL-BY-NUMBER.
  7073             20  CQ-COMPANY-CD-A1     PIC X.
  7074             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  7075         16  CQ-PAYEE-CARRIER        PIC X.
  7076         16  CQ-PAYEE-GROUPING       PIC X(6).
  7077         16  CQ-PAYEE-STATE          PIC XX.
  7078         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7079         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7080
  7081     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7082         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7083         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7084         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7085         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7086         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7087         16  FILLER                  PIC X(3).
  7088
  7089     12  CQ-ENTRY-TYPE               PIC X.
  7090             88  CHECK-ON-QUE           VALUE 'Q'.
  7091             88  ALIGNMENT-CHECK        VALUE 'A'.
  7092             88  SPOILED-CHECK          VALUE 'S'.
  7093             88  PAYMENT-ABORTED        VALUE 'X'.
  7094
  7095     12  CQ-CLAIM-MAST-CNTL.
  7096         16  CQ-CARRIER              PIC X.
  7097         16  CQ-CLAIM-NO             PIC X(7).
  7098         16  CQ-CERT-NO.
  7099             20  CQ-CERT-PRIME       PIC X(10).
  7100             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 132
* EL156.cbl
  7101         16  CQ-CLAIM-TYPE           PIC X.
  7102             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7103             88  CQ-AH-CLAIM            VALUE 'A'.
  7104         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7105             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7106             88  CQ-O-B-COVERAGE        VALUE '2'.
  7107             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7108
  7109     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7110     12  CQ-CHECK-NUMBER             PIC X(7).
  7111     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7112     12  CQ-PAYMENT-TYPE             PIC X.
  7113             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7114             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7115             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7116             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7117             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7118             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7119             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7120             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7121     12  CQ-VOID-INDICATOR           PIC X.
  7122             88  CHECK-IS-STOPPED          VALUE 'S'.
  7123             88  CHECK-IS-VOID             VALUE 'V'.
  7124     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7125     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7126     12  CQ-CHECK-BY-USER            PIC X(4).
  7127     12  CQ-PRE-NUMBERING-SW         PIC X.
  7128       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7129       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7130
  7131     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7132     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7133     12  CQ-LEDGER-FLAG              PIC X(01).
  7134     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7135     12  CQ-LAST-UPDATED-DT          PIC XX.
  7136     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7137     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7138
  7139     12  FILLER                      PIC X(04).
  7140
  7141******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 133
* EL156.cbl
  7143*    COPY ELCBENE.
  7144******************************************************************
  7145*                                                                *
  7146*                            ELCBENE.                            *
  7147*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7148*                            VMOD=2.006                          *
  7149*                                                                *
  7150*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7151*                                                                *
  7152*   FILE TYPE = VSAM,KSDS                                        *
  7153*   RECORD SIZE = 500   RECFORM = FIX                            *
  7154*                                                                *
  7155*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7156*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7157*                                                                *
  7158*   LOG = YES                                                    *
  7159*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7160*                                                                *
  7161*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7162******************************************************************
  7163*                   C H A N G E   L O G
  7164*
  7165* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7166*-----------------------------------------------------------------
  7167*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7168* EFFECTIVE    NUMBER
  7169*-----------------------------------------------------------------
  7170* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7171* 082317  CR2017082100003  PEMA  Add sub type
  7172******************************************************************
  7173
  7174 01  BENEFICIARY-MASTER.
  7175     12  BE-RECORD-ID                PIC XX.
  7176         88  VALID-BE-ID                VALUE 'BE'.
  7177
  7178     12  BE-CONTROL-PRIMARY.
  7179         16  BE-COMPANY-CD           PIC X.
  7180         16  BE-RECORD-TYPE          PIC X.
  7181             88  BENEFICIARY-RECORD  VALUE 'B'.
  7182             88  ADJUSTOR-RECORD     VALUE 'A'.
  7183         16  BE-BENEFICIARY          PIC X(10).
  7184     12  BE-CONTROL-BY-NAME.
  7185         16  BE-COMPANY-CD-A1        PIC X.
  7186         16  BE-RECORD-TYPE-A1       PIC X.
  7187         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7188         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7189
  7190     12  BE-LAST-MAINT-DT            PIC XX.
  7191     12  BE-LAST-MAINT-BY            PIC X(4).
  7192     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7193
  7194     12  BE-ADDRESS-DATA.
  7195         16  BE-MAIL-TO-NAME         PIC X(30).
  7196         16  BE-ADDRESS-LINE-1       PIC X(30).
  7197         16  BE-ADDRESS-LINE-2       PIC X(30).
  7198         16  BE-ADDRESS-LINE-3       PIC X(30).
  7199         16  BE-CITY-STATE.
  7200             20  BE-CITY             PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 134
* EL156.cbl
  7201             20  BE-STATE            PIC XX.
  7202         16  BE-ZIP-CODE.
  7203             20  BE-ZIP-PRIME.
  7204                 24  BE-ZIP-1ST      PIC X.
  7205                     88  BE-CANADIAN-POST-CODE
  7206                                         VALUE 'A' THRU 'Z'.
  7207                 24  FILLER          PIC X(4).
  7208             20  BE-ZIP-PLUS4        PIC X(4).
  7209         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7210             20  BE-CAN-POSTAL-1     PIC XXX.
  7211             20  BE-CAN-POSTAL-2     PIC XXX.
  7212             20  FILLER              PIC XXX.
  7213         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7214         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7215
  7216******************************************************************
  7217*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7218*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7219******************************************************************
  7220     12  BE-CARRIER                  PIC X.
  7221
  7222     12  BE-ADDRESS-DATA2.
  7223         16  BE-MAIL-TO-NAME2        PIC X(30).
  7224         16  BE-ADDRESS-LINE-12      PIC X(30).
  7225         16  BE-ADDRESS-LINE-22      PIC X(30).
  7226         16  BE-ADDRESS-LINE-32      PIC X(30).
  7227         16  BE-CITY-STATE2.
  7228             20  BE-CITY2            PIC X(28).
  7229             20  BE-STATE2           PIC XX.
  7230         16  BE-ZIP-CODE2.
  7231             20  BE-ZIP-PRIME2.
  7232                 24  BE-ZIP-1ST2     PIC X.
  7233                     88  BE-CANADIAN-POST-CODE2
  7234                                         VALUE 'A' THRU 'Z'.
  7235                 24  FILLER          PIC X(4).
  7236             20  BE-ZIP-PLUS42       PIC X(4).
  7237         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7238             20  BE-CAN-POSTAL-12    PIC XXX.
  7239             20  BE-CAN-POSTAL-22    PIC XXX.
  7240             20  FILLER              PIC XXX.
  7241         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7242         16  BE-ACH-DATA.
  7243             20  BE-ACH-YES-OR-NO    PIC X.
  7244                 88  BE-ON-ACH       VALUE 'Y'.
  7245                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7246             20  BE-ACH-ABA-ROUTING-NUMBER
  7247                                     PIC X(15).
  7248             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7249                                     PIC X(20).
  7250             20  BE-ACH-SUB-TYPE     PIC XX.
  7251             20  FILLER              PIC X(23).
  7252         16  BE-BILLING-STMT-DATA.
  7253*            20  BE-BSR              PIC X.
  7254*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  7255*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7256*            20  BE-BSR-FROM         PIC X(30).
  7257*            20  BE-BSR-DEPT         PIC X(30).
  7258             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 135
* EL156.cbl
  7259             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7260             20  BE-OUTPUT-TYPE      PIC X.
  7261                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7262                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7263
  7264     12  FILLER                      PIC X(28).
  7265******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 136
* EL156.cbl
  7267*    COPY ELCARCH.
  7268******************************************************************
  7269*                                                                *
  7270*                            ELCARCH.                            *
  7271*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7272*                            VMOD=2.007                          *
  7273*                                                                *
  7274*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7275*                                                                *
  7276*   FILE TYPE = VSAM,KSDS                                        *
  7277*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7278*                                                                *
  7279*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7280*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7281*                                                                *
  7282*   LOG = NO                                                     *
  7283*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7284*                                                                *
  7285*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7286******************************************************************
  7287 01  LETTER-ARCHIVE.
  7288     12  LA-RECORD-ID                PIC XX.
  7289         88  VALID-LA-ID                VALUE 'LA'.
  7290
  7291     12  LA-CONTROL-PRIMARY.
  7292         16  LA-COMPANY-CD           PIC X.
  7293         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7294         16  LA-RECORD-TYPE          PIC X.
  7295             88  LA-HEADER-DATA         VALUE '1'.
  7296             88  LA-ADDRESS-DATA        VALUE '2'.
  7297             88  LA-TEXT-DATA           VALUE '3'.
  7298             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7299         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7300
  7301     12  LA-CONTROL-BY-TYPE.
  7302         16  LA-COMPANY-CD-A1        PIC X.
  7303         16  LA-RECORD-TYPE-A1       PIC X.
  7304         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7305         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7306
  7307     12  LA-TEXT-RECORD.
  7308         16  LA-SKIP-CONTROL         PIC XX.
  7309             88  NO-LINES-SKIPPED       VALUE SPACES.
  7310             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7311         16  LA-TEXT-LINE            PIC X(70).
  7312
  7313     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7314         16  FILLER                  PIC XX.
  7315         16  LA-ADDRESS-LINE         PIC X(30).
  7316         16  FILLER                  PIC X(40).
  7317
  7318     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7319         16  FILLER                  PIC XX.
  7320         16  LA-CARRIER              PIC X.
  7321         16  LA-CLAIM-NO             PIC X(7).
  7322         16  LA-CERT-NO.
  7323             20  LA-CERT-PRIME       PIC X(10).
  7324             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 137
* EL156.cbl
  7325         16  LA-NO-OF-COPIES         PIC S9.
  7326         16  LA-RESEND-DATE          PIC XX.
  7327         16  LA-PROCESSOR-CD         PIC X(4).
  7328         16  LA-CREATION-DT          PIC XX.
  7329         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7330         16  LA-RESEND-PRINT-DATE    PIC XX.
  7331         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7332         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7333*
  7334* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7335*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7336*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7337*   I        20  LA-DMD-RES-ST           PIC XX.
  7338*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7339*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7340*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7341*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7342*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7343*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7344*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7345*   I        20  LA-DMD-UND-CODE         PIC XX.
  7346*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7347*   V    16  FILLER                  PIC X(15).
  7348* -----
  7349*
  7350* REINSERTED  CSO  MODS
  7351*
  7352         16  FILLER.
  7353             20  FILLER                  PIC X(29).
  7354             20  LA-CSO-LETTER-STATUS    PIC X.
  7355                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7356                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7357                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7358             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7359             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7360*
  7361
  7362     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7363         16  FILLER                  PIC XX.
  7364         16  LA4-CARRIER             PIC X.
  7365         16  LA4-CLAIM-NO            PIC X(7).
  7366         16  LA4-CERT-NO.
  7367             20  LA4-CERT-PRIME      PIC X(10).
  7368             20  LA4-CERT-SFX        PIC X.
  7369         16  LA4-NO-OF-COPIES        PIC S9.
  7370         16  LA4-RESEND-DATE         PIC XX.
  7371         16  LA4-PROCESSOR-CD        PIC X(4).
  7372         16  LA4-CREATION-DT         PIC XX.
  7373         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7374         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7375         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7376         16  LA4-FORM-TYPE           PIC X.
  7377             88  LA4-INITIAL-FORM    VALUE '1'.
  7378             88  LA4-PROGRESS-FORM   VALUE '2'.
  7379         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7380         16  LA4-STATE               PIC X(02).
  7381         16  FILLER                  PIC X(31).
  7382******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 138
* EL156.cbl
  7384*    COPY ELCDAR.
  7385******************************************************************
  7386*                                                                *
  7387*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7388*   FILE TYPE = VSAM,KSDS                                        *
  7389*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7390*   BASE CLUSTER = DLYACTV                                       *
  7391*   LOG = YES                                                    *
  7392*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7393*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7394*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7395*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7396*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7397*               BY PROGRAM "LGINFCE".                            *
  7398*                                                                *
  7399******************************************************************
  7400 01  DAILY-ACTIVITY-RECORD.
  7401     05  DA-KEY.
  7402         10  DA-COMP-CD          PIC X.
  7403         10  DA-CARRIER          PIC X.
  7404         10  DA-CLAIM-NO         PIC X(7).
  7405         10  DA-CERT-NO.
  7406             15  DA-CERT-PRIME   PIC X(10).
  7407             15  DA-CERT-SFX     PIC X.
  7408     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7409     05  DA-RECORD-TYPE          PIC X.
  7410     05  FILLER                  PIC X(2).
  7411******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 139
* EL156.cbl
  7413*    COPY ERCCOMP.
  7414******************************************************************
  7415*                                                                *
  7416*                                                                *
  7417*                            ERCCOMP                             *
  7418*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7419*                            VMOD=2.019                          *
  7420*                                                                *
  7421*   ONLINE CREDIT SYSTEM                                         *
  7422*                                                                *
  7423*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7424*                                                                *
  7425*   FILE TYPE = VSAM,KSDS                                        *
  7426*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7427*                                                                *
  7428*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7429*       ALTERNATE PATH = NONE                                    *
  7430*                                                                *
  7431*   LOG = NO                                                     *
  7432*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7433*                                                                *
  7434******************************************************************
  7435*                   C H A N G E   L O G
  7436*
  7437* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7438*-----------------------------------------------------------------
  7439*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7440* EFFECTIVE    NUMBER
  7441*-----------------------------------------------------------------
  7442* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7443* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7444* 092205    2005050300006  PEMA  ADD LEASE FEE
  7445* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7446* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7447* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7448* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7449* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7450* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7451******************************************************************
  7452
  7453 01  COMPENSATION-MASTER.
  7454     12  CO-RECORD-ID                          PIC XX.
  7455         88  VALID-CO-ID                          VALUE 'CO'.
  7456
  7457     12  CO-CONTROL-PRIMARY.
  7458         16  CO-COMPANY-CD                     PIC X.
  7459         16  CO-CONTROL.
  7460             20  CO-CTL-1.
  7461                 24  CO-CARR-GROUP.
  7462                     28  CO-CARRIER            PIC X.
  7463                     28  CO-GROUPING.
  7464                         32  CO-GROUP-PREFIX   PIC XXX.
  7465                         32  CO-GROUP-PRIME    PIC XXX.
  7466                 24  CO-RESP-NO.
  7467                     28  CO-RESP-PREFIX        PIC X(4).
  7468                     28  CO-RESP-PRIME         PIC X(6).
  7469             20  CO-CTL-2.
  7470                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 140
* EL156.cbl
  7471                     28  CO-ACCT-PREFIX        PIC X(4).
  7472                     28  CO-ACCT-PRIME         PIC X(6).
  7473         16  CO-TYPE                           PIC X.
  7474             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7475             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7476             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7477
  7478     12  CO-MAINT-INFORMATION.
  7479         16  CO-LAST-MAINT-DT                  PIC XX.
  7480         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7481         16  CO-LAST-MAINT-USER                PIC X(4).
  7482     12  FILLER                                PIC XX.
  7483     12  CO-STMT-TYPE                          PIC XXX.
  7484     12  CO-COMP-TYPE                          PIC X.
  7485         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7486     12  CO-STMT-OWNER                         PIC X(4).
  7487     12  CO-BALANCE-CONTROL                    PIC X.
  7488         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7489         88  CO-NO-BALANCE                        VALUE 'N'.
  7490
  7491     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7492         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7493         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7494         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7495
  7496     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7497         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7498         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7499
  7500     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7501     12  CO-GA-DIRECT-DEP                      PIC X.
  7502     12  CO-FUTURE-SPACE                       PIC X.
  7503         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7504
  7505     12  CO-ACCT-NAME                          PIC X(30).
  7506     12  CO-MAIL-NAME                          PIC X(30).
  7507     12  CO-ADDR-1                             PIC X(30).
  7508     12  CO-ADDR-2                             PIC X(30).
  7509     12  CO-ADDR-3.
  7510         16  CO-ADDR-CITY                      PIC X(27).
  7511         16  CO-ADDR-STATE                     PIC XX.
  7512     12  CO-CSO-1099                           PIC X.
  7513     12  CO-ZIP.
  7514         16  CO-ZIP-PRIME.
  7515             20  CO-ZIP-PRI-1ST                PIC X.
  7516                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7517             20  FILLER                        PIC X(4).
  7518         16  CO-ZIP-PLUS4                      PIC X(4).
  7519     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7520         16  CO-CAN-POSTAL-1                   PIC XXX.
  7521         16  CO-CAN-POSTAL-2                   PIC XXX.
  7522         16  FILLER                            PIC XXX.
  7523     12  CO-SOC-SEC                            PIC X(13).
  7524     12  CO-TELEPHONE.
  7525         16  CO-AREA-CODE                      PIC XXX.
  7526         16  CO-PREFIX                         PIC XXX.
  7527         16  CO-PHONE                          PIC X(4).
  7528
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 141
* EL156.cbl
  7529     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7530
  7531     12  CO-AR-BAL-LEVEL                       PIC X.
  7532         88  CO-AR-REF-LVL                        VALUE '1'.
  7533         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7534         88  CO-AR-BILL-LVL                       VALUE '2'.
  7535         88  CO-AR-AGT-LVL                        VALUE '3'.
  7536         88  CO-AR-FR-LVL                         VALUE '4'.
  7537
  7538     12  CO-AR-NORMAL-PRINT                    PIC X.
  7539         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7540         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7541
  7542     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7543
  7544     12  CO-AR-REPORTING                       PIC X.
  7545         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7546         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7547
  7548     12  CO-AR-PULL-CHECK                      PIC X.
  7549         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7550         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7551
  7552     12  CO-AR-BALANCE-PRINT                   PIC X.
  7553         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7554
  7555     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7556         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7557         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7558         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7559
  7560     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7561
  7562     12  CO-USER-CODE                          PIC X.
  7563     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7564
  7565******************************************************************
  7566*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7567*    THE LAST MONTH END RUN.
  7568******************************************************************
  7569
  7570     12  CO-LAST-ACTIVITY-DATE.
  7571         16  CO-ACT-YEAR                       PIC 99.
  7572         16  CO-ACT-MONTH                      PIC 99.
  7573         16  CO-ACT-DAY                        PIC 99.
  7574
  7575     12  CO-LAST-STMT-DT.
  7576         16  CO-LAST-STMT-YEAR                 PIC 99.
  7577         16  CO-LAST-STMT-MONTH                PIC 99.
  7578         16  CO-LAST-STMT-DAY                  PIC 99.
  7579
  7580     12  CO-MO-END-TOTALS.
  7581         16  CO-MONTHLY-TOTALS.
  7582             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7583             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7584             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7585             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7586             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 142
* EL156.cbl
  7587
  7588         16  CO-AGING-TOTALS.
  7589             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7590             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7591             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7592             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7593
  7594         16  CO-YTD-TOTALS.
  7595             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7596             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7597
  7598         16  CO-OVER-UNDER-TOTALS.
  7599             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7600             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7601
  7602     12  CO-MISCELLANEOUS-TOTALS.
  7603         16  CO-FICA-TOTALS.
  7604             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7605             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7606
  7607         16  CO-CLAIM-TOTALS.
  7608             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7609             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7610
  7611******************************************************************
  7612*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7613*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7614******************************************************************
  7615
  7616     12  CO-CURRENT-TOTALS.
  7617         16  CO-CURRENT-LAST-STMT-DT.
  7618             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7619             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7620             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7621
  7622         16  CO-CURRENT-MONTHLY-TOTALS.
  7623             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7624             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7625             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7626             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7627             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7628
  7629         16  CO-CURRENT-AGING-TOTALS.
  7630             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7631             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7632             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7633             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7634
  7635         16  CO-CURRENT-YTD-TOTALS.
  7636             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7637             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7638
  7639     12  CO-PAID-COMM-TOTALS.
  7640         16  CO-YTD-PAID-COMMS.
  7641             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7642             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7643
  7644     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 143
* EL156.cbl
  7645         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7646         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7647
  7648     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7649         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7650         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7651         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7652         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7653         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7654         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7655         88  CO-FINAL-LETTER                  VALUE 'F'.
  7656         88  CO-RECONCILING                   VALUE 'R'.
  7657         88  CO-PHONE-CALL                    VALUE 'P'.
  7658         88  CO-LEGAL                         VALUE 'L'.
  7659         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7660         88  CO-WRITE-OFF                     VALUE 'W'.
  7661         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7662
  7663     12  CO-CSR-CODE                       PIC X(4).
  7664
  7665     12  CO-GA-STATUS-INFO.
  7666         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7667         16  CO-GA-TERMINATION-DT          PIC XX.
  7668         16  CO-GA-STATUS-CODE             PIC X.
  7669             88  CO-GA-ACTIVE                 VALUE 'A'.
  7670             88  CO-GA-INACTIVE               VALUE 'I'.
  7671             88  CO-GA-PENDING                VALUE 'P'.
  7672         16  CO-GA-COMMENTS.
  7673             20  CO-GA-COMMENT-1           PIC X(40).
  7674             20  CO-GA-COMMENT-2           PIC X(40).
  7675             20  CO-GA-COMMENT-3           PIC X(40).
  7676             20  CO-GA-COMMENT-4           PIC X(40).
  7677
  7678     12  CO-RPTCD2                         PIC X(10).
  7679     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7680         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7681         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7682
  7683     12  CO-TYPE-AGENT                     PIC X(01).
  7684         88  CO-CORPORATION                   VALUE 'C'.
  7685         88  CO-PARTNERSHIP                   VALUE 'P'.
  7686         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7687         88  CO-TRUST                         VALUE 'T'.
  7688         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7689
  7690     12  CO-FAXNO.
  7691         16  CO-FAX-AREA-CODE                  PIC XXX.
  7692         16  CO-FAX-PREFIX                     PIC XXX.
  7693         16  CO-FAX-PHONE                      PIC X(4).
  7694
  7695     12  CO-BANK-INFORMATION.
  7696         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7697         16  CO-BANK-TRANSIT-NON REDEFINES
  7698             CO-BANK-TRANSIT-NO                PIC 9(8).
  7699
  7700         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7701     12  CO-MISC-DEDUCT-INFO REDEFINES
  7702                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 144
* EL156.cbl
  7703         16  CO-MD-GL-ACCT                     PIC X(10).
  7704         16  CO-MD-DIV                         PIC XX.
  7705         16  CO-MD-CENTER                      PIC X(4).
  7706         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7707         16  CO-CREATE-AP-CHECK                PIC X.
  7708         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7709         16  FILLER                            PIC XXX.
  7710     12  CO-ACH-STATUS                         PIC X.
  7711         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7712         88  CO-ACH-PENDING                        VALUE 'P'.
  7713
  7714     12  CO-BILL-SW                            PIC X.
  7715     12  CO-CONTROL-NAME                       PIC X(30).
  7716     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7717     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7718     12  CO-CLP-STATE                          PIC XX.
  7719     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7720     12  CO-SPP-REFUND-EDIT                    PIC X.
  7721
  7722******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 145
* EL156.cbl
  7724*    COPY ERCDMDNT.
  7725******************************************************************
  7726*                                                                *
  7727*                            ERCDMDNT                            *
  7728*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7729*                            VMOD=2.005                          *
  7730*                                                                *
  7731*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7732*                                                                *
  7733*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7734*                                                                *
  7735*        FILE TYPE= VSAM,KSDS                                    *
  7736*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7737*                                                                *
  7738*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7739*                                                                *
  7740*        LOG = YES                                               *
  7741*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7742*                                                                *
  7743******************************************************************
  7744
  7745 01  CERTIFICATE-NOTE.
  7746     12  CN-RECORD-ID                     PIC  XX.
  7747         88  VALID-CN-ID                      VALUE 'CN'.
  7748
  7749     12  CN-CONTROL-PRIMARY.
  7750         16  CN-COMPANY-CD                PIC X.
  7751         16  CN-CERT-KEY.
  7752             20  CN-CARRIER               PIC X.
  7753             20  CN-GROUPING.
  7754                 24  CN-GROUPING-PREFIX   PIC XXX.
  7755                 24  CN-GROUPING-PRIME    PIC XXX.
  7756             20  CN-STATE                 PIC XX.
  7757             20  CN-ACCOUNT.
  7758                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7759                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7760             20  CN-CERT-EFF-DT           PIC XX.
  7761             20  CN-CERT-NO.
  7762                 24  CN-CERT-PRIME        PIC X(10).
  7763                 24  CN-CERT-SFX          PIC X.
  7764
  7765     12  CN-BILLING-START-LINE-NO         PIC 99.
  7766     12  CN-BILLING-END-LINE-NO           PIC 99.
  7767
  7768     12  CN-LINES.
  7769         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7770
  7771     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7772         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7773         16  CN-CSI-GENERAL-DATA-AREA.
  7774             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7775
  7776         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7777             CN-CSI-GENERAL-DATA-AREA.
  7778             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7779             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7780             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7781             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 146
* EL156.cbl
  7782             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7783             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7784             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7785             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7786             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7787             20  FILLER                       PIC XX.
  7788             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7789             20  FILLER                       PIC X(38).
  7790
  7791         16  CN-CSI-PRODUCT-DATA-AREA.
  7792             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7793
  7794         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7795             CN-CSI-PRODUCT-DATA-AREA.
  7796             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7797             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7798             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7799             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7800             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7801             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7802             20  FILLER                   PIC XX.
  7803             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7804             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7805             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7806             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7807             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7808             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7809             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7810             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7811             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7812             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7813             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7814             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7815             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7816             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7817             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7818             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7819             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7820             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7821             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7822             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7823             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7824             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7825             20  FILLER                   PIC X(25).
  7826
  7827         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7828             CN-CSI-CREDIT-CARD-DATA.
  7829             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7830             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7831             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7832             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7833             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7834             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7835             20  FILLER                   PIC XX.
  7836             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7837             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7838             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7839             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 147
* EL156.cbl
  7840             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7841             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7842             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7843             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7844             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7845             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7846             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7847             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7848             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7849             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7850             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7851             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7852             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7853             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7854             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7855             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7856             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7857             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7858             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7859             20  FILLER                   PIC X(17).
  7860
  7861         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7862             CN-CSI-FAMILY-LEAVE-DATA.
  7863             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7864             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7865             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7866             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7867             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7868             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7869             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7870             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7871             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7872             20  CN-CSI-SL-INT-ON-PROCEEDS
  7873                                          PIC S9(5)V99  COMP-3.
  7874             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7875             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7876             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7877             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7878             20  CN-CSI-SL-POLICY-BENEFITS
  7879                                          PIC S9(5)V99  COMP-3.
  7880             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7881             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7882             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7883             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7884             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7885             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7886             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7887             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7888             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7889             20  CN-CSI-SL-STATE-NOT      PIC X.
  7890             20  FILLER                   PIC XX.
  7891
  7892         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7893             CN-CSI-SENIOR-LIFE-DATA.
  7894             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7895             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7896             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7897                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 148
* EL156.cbl
  7898             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7899             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7900             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7901             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7902             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7903             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7904             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7905             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7906             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7907             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7908             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7909             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7910             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7911             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7912             20  CN-CSI-PP-REPAIR         PIC X.
  7913             20  CN-CSI-PP-REPLACE        PIC X.
  7914             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7915             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7916             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7917             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7918             20  FILLER                   PIC X(5).
  7919
  7920         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7921             CN-CSI-PURCH-PROP-DATA.
  7922             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7923             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7924             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7925             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7926             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7927             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7928             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7929             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7930             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7931             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7932             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7933             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7934             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7935             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7936             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7937             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7938             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7939             20  CN-CSI-EW-REPLACE        PIC X.
  7940             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7941             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7942             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7943             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7944             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7945             20  FILLER                   PIC X(4).
  7946
  7947     12  CN-LAST-MAINT-DT                 PIC XX.
  7948     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7949     12  CN-LAST-MAINT-USER               PIC X(4).
  7950     12  FILLER                           PIC X(6).
  7951
  7952******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 149
* EL156.cbl
  7954*    COPY ERCCNOT.
  7955******************************************************************
  7956*                                                                *
  7957*                            ERCCNOT                             *
  7958*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7959*                            VMOD=2.003                          *
  7960*                                                                *
  7961*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7962*                                                                *
  7963*        FILE TYPE= VSAM,KSDS                                    *
  7964*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7965*                                                                *
  7966*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7967*                                                                *
  7968*        LOG = YES                                               *
  7969*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7970*                                                                *
  7971******************************************************************
  7972*                   C H A N G E   L O G
  7973*
  7974* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7975*-----------------------------------------------------------------
  7976*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7977* EFFECTIVE    NUMBER
  7978*-----------------------------------------------------------------
  7979* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7980******************************************************************
  7981
  7982 01  CERT-NOTE-FILE.
  7983     12  CZ-RECORD-ID                PIC  XX.
  7984         88  VALID-CZ-ID                  VALUE 'CZ'.
  7985
  7986     12  CZ-CONTROL-PRIMARY.
  7987         16  CZ-COMPANY-CD           PIC X.
  7988         16  CZ-CARRIER              PIC X.
  7989         16  CZ-GROUPING.
  7990             20 CZ-GROUPING-PREFIX   PIC XXX.
  7991             20 CZ-GROUPING-PRIME    PIC XXX.
  7992         16  CZ-STATE                PIC XX.
  7993         16  CZ-ACCOUNT.
  7994             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7995             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7996         16  CZ-CERT-EFF-DT          PIC XX.
  7997         16  CZ-CERT-NO.
  7998             20  CZ-CERT-PRIME       PIC X(10).
  7999             20  CZ-CERT-SFX         PIC X.
  8000         16  CZ-RECORD-TYPE          PIC X.
  8001             88  CERT-NOTE           VALUE '1'.
  8002             88  CLAIM-CERT-NOTE     VALUE '2'.
  8003         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  8004
  8005     12  CZ-LAST-MAINT-DT            PIC XX.
  8006     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  8007     12  CZ-LAST-MAINT-USER          PIC X(4).
  8008
  8009     12  CZ-NOTE-INFORMATION.
  8010         16  CZ-NOTE                 PIC X(63).
  8011         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 150
* EL156.cbl
  8012******************************************************************
  8013*                            COPY ERCPDEF.
  8014******************************************************************
  8015*                                                                *
  8016*                                                                *
  8017*                            ERCPDEF.                            *
  8018*                                                                *
  8019*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  8020*                                                                *
  8021*    FILE TYPE = VSAM,KSDS                                       *
  8022*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  8023*                                                                *
  8024*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  8025*                                                                *
  8026*    LOG = YES                                                   *
  8027*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8028******************************************************************
  8029*                   C H A N G E   L O G
  8030*
  8031* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8032*-----------------------------------------------------------------
  8033*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8034* EFFECTIVE    NUMBER
  8035*-----------------------------------------------------------------
  8036* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8037* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8038* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  8039******************************************************************
  8040 01  PRODUCT-MASTER.
  8041    12  PD-RECORD-ID                 PIC X(02).
  8042        88  VALID-PD-ID                  VALUE 'PD'.
  8043    12  PD-CONTROL-PRIMARY.
  8044        16  PD-COMPANY-CD            PIC X.
  8045        16  PD-STATE                 PIC XX.
  8046        16  PD-PRODUCT-CD            PIC XXX.
  8047        16  PD-FILLER                PIC X(7).
  8048        16  PD-BEN-TYPE              PIC X.
  8049        16  PD-BEN-CODE              PIC XX.
  8050        16  PD-PROD-EXP-DT           PIC XX.
  8051    12  FILLER                       PIC X(50).
  8052    12  PD-PRODUCT-DATA OCCURS 8.
  8053        16  PD-PROD-CODE             PIC X.
  8054            88  PD-PROD-LIFE           VALUE 'L'.
  8055            88  PD-PROD-PROP           VALUE 'P'.
  8056            88  PD-PROD-AH             VALUE 'A'.
  8057            88  PD-PROD-IU             VALUE 'I'.
  8058            88  PD-PROD-GAP            VALUE 'G'.
  8059            88  PD-PROD-FAML           VALUE 'F'.
  8060        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  8061        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  8062        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  8063        16  PD-MAX-TERM              PIC S999        COMP-3.
  8064        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  8065        16  FILLER                   PIC X.
  8066        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  8067        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  8068        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  8069        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 151
* EL156.cbl
  8070        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  8071        16  PD-REC-CRIT-PERIOD       PIC 99.
  8072        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  8073            20  PD-RECURRING-YN      PIC X.
  8074            20  FILLER               PIC X.
  8075        16  PD-RTW-MOS               PIC 99.
  8076        16  PD-MAX-EXTENSION         PIC 99.
  8077        16  pd-ben-pct               pic sv999 comp-3.
  8078*       16  FILLER                   PIC XX.
  8079    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  8080    12  PD-TERM-LIMITS OCCURS 15.
  8081        16  PD-LOW-TERM              PIC S999        COMP-3.
  8082        16  PD-HI-TERM               PIC S999        COMP-3.
  8083*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  8084    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  8085        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  8086        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  8087    12  PD-EARN-FACTORS.
  8088        16  FILLER OCCURS 15.
  8089            20  FILLER OCCURS 15.
  8090                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  8091    12  PD-PRODUCT-DESC              PIC X(80).
  8092    12  PD-TRUNCATED                 PIC X.
  8093    12  FILLER                       PIC X(59).
  8094    12  PD-MAINT-INFORMATION.
  8095        16  PD-LAST-MAINT-DT         PIC X(02).
  8096        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  8097        16  PD-LAST-MAINT-BY         PIC X(04).
  8098*                            COPY ELCCRTT.
  8099******************************************************************
  8100*                                                                *
  8101*                            ELCCRTT.                            *
  8102*                                                                *
  8103*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8104*                                                                *
  8105*   FILE TYPE = VSAM,KSDS                                        *
  8106*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8107*                                                                *
  8108*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8109*                                                                *
  8110*   LOG = YES                                                    *
  8111*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8112******************************************************************
  8113*                   C H A N G E   L O G
  8114*
  8115* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8116*-----------------------------------------------------------------
  8117*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8118* EFFECTIVE    NUMBER
  8119*-----------------------------------------------------------------
  8120* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8121* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8122* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8123* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8124* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8125* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8126* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8127* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 152
* EL156.cbl
  8128* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8129******************************************************************
  8130
  8131 01  CERTIFICATE-TRAILERS.
  8132     12  CS-RECORD-ID                      PIC XX.
  8133         88  VALID-CS-ID                      VALUE 'CS'.
  8134
  8135     12  CS-CONTROL-PRIMARY.
  8136         16  CS-COMPANY-CD                 PIC X.
  8137         16  CS-CARRIER                    PIC X.
  8138         16  CS-GROUPING                   PIC X(6).
  8139         16  CS-STATE                      PIC XX.
  8140         16  CS-ACCOUNT                    PIC X(10).
  8141         16  CS-CERT-EFF-DT                PIC XX.
  8142         16  CS-CERT-NO.
  8143             20  CS-CERT-PRIME             PIC X(10).
  8144             20  CS-CERT-SFX               PIC X.
  8145         16  CS-TRAILER-TYPE               PIC X.
  8146             88  COMM-TRLR           VALUE 'A'.
  8147             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8148             88  CERT-DATA-TRLR      VALUE 'C'.
  8149
  8150     12  CS-DATA-AREA                      PIC X(516).
  8151
  8152     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8153         16  CS-BANK-COMMISSION-AREA.
  8154             20  CS-BANK-COMMS       OCCURS 10.
  8155                 24  CS-AGT                PIC X(10).
  8156                 24  CS-COM-TYP            PIC X.
  8157                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8158                 24  CS-RECALC-LV-INDIC    PIC X.
  8159                 24  FILLER                PIC X(10).
  8160         16  FILLER                        PIC X(256).
  8161
  8162     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8163****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8164         16  CS-MB-CLAIM-DATA OCCURS 24.
  8165             20  CS-CLAIM-NO               PIC X(7).
  8166             20  CS-CLAIM-TYPE             PIC X.
  8167                 88  CS-AH-CLM               VALUE 'A'.
  8168                 88  CS-IU-CLM               VALUE 'I'.
  8169                 88  CS-GP-CLM               VALUE 'G'.
  8170                 88  CS-LF-CLM               VALUE 'L'.
  8171                 88  CS-PR-CLM               VALUE 'P'.
  8172                 88  CS-FL-CLM               VALUE 'F'.
  8173             20  CS-INSURED-TYPE           PIC X.
  8174                 88  CS-PRIM-INSURED          VALUE 'P'.
  8175                 88  CS-CO-BORROWER           VALUE 'C'.
  8176             20  CS-BENEFIT-PERIOD         PIC 99.
  8177             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8178             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8179             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8180         16  FILLER                        PIC X(12).
  8181     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8182         16  CS-VIN-NUMBER                 PIC X(17).
  8183         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8184         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8185         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 153
* EL156.cbl
  8186         16  cs-agent-name.
  8187             20  cs-agent-fname            pic x(20).
  8188             20  cs-agent-mi               pic x.
  8189             20  cs-agent-lname            pic x(25).
  8190         16  cs-license-no                 pic x(15).
  8191         16  cs-npn-number                 pic x(10).
  8192         16  cs-agent-edit-status          pic x.
  8193             88  cs-ae-refer-to-manager      value 'M'.
  8194             88  cs-ae-cover-sheet           value 'C'.
  8195             88  cs-ae-sig-form              value 'S'.
  8196             88  cs-ae-verified              value 'V'.
  8197             88  cs-unidentified-signature   value 'U'.
  8198             88  cs-cert-returned            value 'R'.
  8199             88  cs-accept-no-commission     value 'N'.
  8200         16  cs-year                       pic 9999.
  8201         16  cs-make                       pic x(20).
  8202         16  cs-model                      pic x(20).
  8203         16  cs-future                     pic x(20).
  8204         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8205         16  FILLER                        PIC X(356). *> was 420
  8206*        16  FILLER                        PIC X(496).
  8207 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8208                          CONTROL-FILE CERTIFICATE-MASTER
  8209                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8210                          ACCOUNT-MASTER CHECK-QUE
  8211                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8212                          DAILY-ACTIVITY-RECORD
  8213                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8214                          CERT-NOTE-FILE PRODUCT-MASTER
  8215                          CERTIFICATE-TRAILERS.
  8216 0000-DFHEXIT SECTION.
  8217     MOVE '9#                    $   ' TO DFHEIV0.
  8218     MOVE 'EL156' TO DFHEIV1.
  8219     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8220
  8221     IF EIBCALEN = 0
  8222         GO TO 8800-UNAUTHORIZED-ACCESS.
  8223
  8224     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8225     MOVE EIBTRMID               TO QID-TERM.
  8226     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8227     MOVE '2'                    TO EMI-SWITCH2.
  8228     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8229     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8230
  8231     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8232     MOVE '5'                    TO DC-OPTION-CODE.
  8233     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8234     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8235                                    SAVE-BIN-DATE.
  8236     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8237     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8238
  8239     IF SAVE-DATE-YY > 70
  8240         MOVE 19                 TO SAVE-DATE-CC
  8241     ELSE
  8242         MOVE 20                 TO SAVE-DATE-CC.
  8243
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 154
* EL156.cbl
  8244     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8245         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8246     END-IF.
  8247
  8248     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8249        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8250     ELSE
  8251        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8252     END-IF
  8253
  8254     IF PI-PRINT-CLM-FRM-YN = 'N'
  8255         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8256     ELSE
  8257         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8258     END-IF
  8259
  8260     IF PI-PRINT-SURVEY-YN = 'N'
  8261         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8262     ELSE
  8263         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8264     END-IF
  8265
  8266     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8267         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8268     ELSE
  8269         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8270     END-IF
  8271
  8272* EXEC CICS HANDLE CONDITION
  8273*        NOTOPEN   (9990-ABEND)
  8274*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8275*        MAPFAIL   (0400-FIRST-TIME)
  8276*        DUPREC    (6180-DUPREC)
  8277*        ERROR     (9990-ABEND)
  8278*    END-EXEC.
  8279*    MOVE '"$JL?%.               ! " #00008267' TO DFHEIV0
  8280     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8281     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8282     MOVE X'2220233030303038323637' TO DFHEIV0(25:11)
  8283     CALL 'kxdfhei1' USING DFHEIV0
  8284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8285
  8286
  8287     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8288         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8289
  8290     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8291         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8292             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8293             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8294             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8295             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8296             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8297             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8298             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8299             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8300             MOVE LOW-VALUES           TO EL156AI
  8301             MOVE 'Y'                  TO FIRST-ENTRY
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 155
* EL156.cbl
  8302         ELSE
  8303             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8304             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8305             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8306             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8307             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8308             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8309             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8310             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8311
  8312     IF RETURNED-FROM NOT = SPACES
  8313        IF (RETURNED-FROM = 'EL614')
  8314           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8315           IF WS-SAVED-EOB-CODES NOT = SPACES
  8316              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8317           ELSE
  8318              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8319           END-IF
  8320        END-IF
  8321         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8322            MOVE 'Y'             TO FIRST-ENTRY
  8323            IF RETURNED-FROM = 'EL614'
  8324               AND (PI-PASS-SW NOT = 'C')
  8325               IF WS-SAVED-EOB-CODES NOT = SPACES
  8326                  MOVE WS-SAVED-EOB-CODES
  8327                                 TO PI-PMTNOTE2
  8328                                    WS-PMTNOTE2
  8329                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8330               ELSE
  8331                  MOVE SPACES    TO PI-PMTNOTE2
  8332                                    WS-PMTNOTE2
  8333                                    PI-EOB-CODES-EXIST
  8334               END-IF
  8335            END-IF
  8336            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8337            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8338            IF RETURNED-FROM = 'EL614'
  8339               GO TO 1000-EDIT-DATA
  8340            END-IF
  8341            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8342               (PAYEEI   = LOW-VALUES OR SPACES)
  8343               GO TO 8100-SEND-INITIAL-MAP
  8344            ELSE
  8345               GO TO 1000-EDIT-DATA.
  8346
  8347     IF EIBTRNID NOT = TRANS-ID
  8348         GO TO 0400-FIRST-TIME.
  8349
  8350     IF EIBAID = DFHCLEAR
  8351        IF PI-PASS-SW = 'C'
  8352           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8353           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8354           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8355           MOVE 'Y'            TO RETURNED-FROM-B
  8356           GO TO 1000-EDIT-DATA
  8357        ELSE
  8358           GO TO 9400-CLEAR.
  8359
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 156
* EL156.cbl
  8360     IF PI-PASS-SW = 'C'
  8361         MOVE MAP-NAMEB          TO MAP-NAME
  8362         IF EIBAID = DFHPF1 OR DFHPF13
  8363             GO TO 5000-UPDATE
  8364           ELSE
  8365             IF EIBAID NOT = DFHENTER
  8366                 MOVE LOW-VALUES TO EL156BI
  8367                 MOVE MAP-NAMEB  TO MAP-NAME
  8368                 MOVE ER-0029    TO EMI-ERROR
  8369                 MOVE -1         TO  ENTPFBL
  8370                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8371                 GO TO 8200-SEND-DATAONLY.
  8372
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 157
* EL156.cbl
  8374 0200-RECEIVE.
  8375     MOVE LOW-VALUES             TO EL156AI.
  8376     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8377         MOVE ER-0008            TO EMI-ERROR
  8378         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8379         IF PI-PASS-SW = 'C'
  8380             MOVE -1             TO ENTPFBL
  8381             GO TO 8200-SEND-DATAONLY
  8382         ELSE
  8383             MOVE -1             TO PMTTYPEL
  8384             GO TO 8200-SEND-DATAONLY.
  8385
  8386     IF PI-COMPANY-ID = 'DMD'
  8387         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8388
  8389     IF PI-PASS-SW = 'C'
  8390         MOVE MAP-NAMEB          TO MAP-NAME.
  8391
  8392
  8393* EXEC CICS RECEIVE
  8394*        MAP   (MAP-NAME)
  8395*        MAPSET(MAPSET-NAME)
  8396*        ASIS
  8397*        INTO  (EL156AI)
  8398*    END-EXEC.
  8399     MOVE LENGTH OF
  8400      EL156AI
  8401       TO DFHEIV11
  8402*    MOVE '8"TAI  L              ''   #00008380' TO DFHEIV0
  8403     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8404     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8405     MOVE X'2020233030303038333830' TO DFHEIV0(25:11)
  8406     CALL 'kxdfhei1' USING DFHEIV0,
  8407           MAP-NAME,
  8408           EL156AI,
  8409           DFHEIV11,
  8410           MAPSET-NAME,
  8411           DFHEIV99,
  8412           DFHEIV99
  8413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8414
  8415
  8416     IF PI-PASS-SW NOT = 'C'
  8417         GO TO 0250-MAPA.
  8418
  8419     IF ENTPFBL NOT > ZERO
  8420         MOVE MAP-NAMEB          TO MAP-NAME
  8421         MOVE ER-0029            TO EMI-ERROR
  8422         MOVE -1                 TO  ENTPFBL
  8423         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8424         GO TO 8200-SEND-DATAONLY.
  8425
  8426     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8427         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8428       ELSE
  8429         MOVE MAP-NAMEB           TO MAP-NAME
  8430         MOVE ER-0029             TO EMI-ERROR
  8431         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 158
* EL156.cbl
  8432         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8433         GO TO 8200-SEND-DATAONLY.
  8434
  8435     IF EIBAID = DFHPF1 OR DFHPF13
  8436         IF MODIFY-CAP
  8437            GO TO 5000-UPDATE
  8438          ELSE
  8439            MOVE 'UPDATE'           TO SM-READ
  8440            PERFORM 9995-SECURITY-VIOLATION
  8441            MOVE MAP-NAMEB          TO MAP-NAME
  8442            MOVE ER-0070            TO EMI-ERROR
  8443            MOVE -1                 TO  ENTPFBL
  8444            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8445            GO TO 8200-SEND-DATAONLY.
  8446
  8447 0250-MAPA.
  8448     IF ENTERPFL = 0
  8449         GO TO 0300-CHECK-PFKEYS.
  8450
  8451     IF EIBAID NOT = DFHENTER
  8452         MOVE ER-0004            TO EMI-ERROR
  8453         GO TO 0320-INPUT-ERROR.
  8454
  8455     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8456         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8457     ELSE
  8458         MOVE ER-0029            TO EMI-ERROR
  8459         GO TO 0320-INPUT-ERROR.
  8460
  8461 0300-CHECK-PFKEYS.
  8462     IF EIBAID = DFHPF7 OR DFHPF8
  8463         GO TO 8820-PF7-8.
  8464
  8465     IF EIBAID = DFHPF23
  8466         GO TO 8810-PF23.
  8467
  8468     IF EIBAID = DFHPF24
  8469         GO TO 9200-RETURN-MAIN-MENU.
  8470
  8471     IF EIBAID = DFHPF12
  8472         GO TO 9500-PF12.
  8473
  8474     IF EIBAID = DFHPF1
  8475        IF PI-PASS-SW = 'A' OR 'B'
  8476          GO TO 0330-BROWSE-FORWARD.
  8477
  8478     IF EIBAID = DFHPF2
  8479        IF PI-PASS-SW = 'A' OR 'B'
  8480          GO TO 0350-BROWSE-BACKWARD.
  8481
  8482     IF EIBAID = DFHPF6
  8483        IF PI-EOB-CODES-EXIST = 'Y'
  8484           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8485        ELSE
  8486           MOVE SPACES              TO WS-PMTNOTE2
  8487        END-IF
  8488         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8489         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 159
* EL156.cbl
  8490            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8491         END-IF
  8492         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8493         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
  8494             MOVE 'EL614'        TO PGM-NAME
  8495             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8496             GO TO 9300-XCTL
  8497         ELSE
  8498             MOVE XCTL-157       TO PGM-NAME
  8499             GO TO 9300-XCTL.
  8500
  8501     IF EIBAID = DFHPF9
  8502        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8503        MOVE XCTL-141            TO PGM-NAME
  8504        GO TO 9300-XCTL.
  8505
  8506     IF EIBAID = DFHPF10
  8507        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8508        MOVE XCTL-155            TO PGM-NAME
  8509        GO TO 9300-XCTL.
  8510
  8511     MOVE SPACES                 TO ERRMSG0O
  8512                                    ERRMSG1O
  8513                                    ERRMSG2O.
  8514
  8515     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8516         IF PI-PASS-SW NOT = 'B'
  8517             MOVE ER-0422        TO EMI-ERROR
  8518             GO TO 0320-INPUT-ERROR
  8519           ELSE
  8520             GO TO 0700-TEST-FOR-CHANGES.
  8521
  8522     IF EIBAID = DFHPF11
  8523        IF PI-PASS-SW = 'C'
  8524           MOVE ER-0029          TO EMI-ERROR
  8525           GO TO 0320-INPUT-ERROR.
  8526
  8527     IF EIBAID = DFHENTER OR DFHPF11
  8528        NEXT SENTENCE
  8529     ELSE
  8530        MOVE ER-0029             TO EMI-ERROR
  8531        GO TO 0320-INPUT-ERROR.
  8532
  8533     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8534
  8535     if pi-epyfrom not = zeros
  8536        if pi-epyfrom not = ws-epyfrom
  8537           move zeros        to ws-edays
  8538        end-if
  8539     end-if
  8540
  8541     if pi-epythru not = zeros
  8542        if pi-epythru not = ws-epythru
  8543           move zeros        to ws-edays
  8544        end-if
  8545     end-if
  8546
  8547     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 160
* EL156.cbl
  8548         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8549         GO TO 1000-EDIT-DATA
  8550     ELSE
  8551         IF PI-FATAL-COUNT NOT = 0 OR
  8552            PI-FORCE-COUNT NOT = 0
  8553             GO TO 1000-EDIT-DATA
  8554         ELSE
  8555             GO TO 2000-EDIT-DONE.
  8556
  8557 0320-INPUT-ERROR.
  8558     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8559
  8560     IF ENTERPFL = 0
  8561         MOVE -1                 TO PMTTYPEL
  8562     ELSE
  8563         MOVE AL-UNBON           TO ENTERPFA
  8564         MOVE -1                 TO ENTERPFL.
  8565
  8566     GO TO 8200-SEND-DATAONLY.
  8567
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 161
* EL156.cbl
  8569 0330-BROWSE-FORWARD.
  8570
  8571     MOVE CLMNOI            TO PI-CLAIM-NO.
  8572     MOVE CARRI             TO PI-CARRIER.
  8573     MOVE CERTNOI           TO PI-CERT-PRIME.
  8574     MOVE SUFXI             TO PI-CERT-SFX.
  8575
  8576     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8577     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8578     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8579     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8580
  8581     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8582
  8583
  8584* EXEC CICS HANDLE CONDITION
  8585*         NOTFND   (0380-CLAIM-END-FILE)
  8586*         ENDFILE  (0380-CLAIM-END-FILE)
  8587*    END-EXEC.
  8588*    MOVE '"$I''                  ! # #00008554' TO DFHEIV0
  8589     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8590     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8591     MOVE X'2320233030303038353534' TO DFHEIV0(25:11)
  8592     CALL 'kxdfhei1' USING DFHEIV0
  8593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8594
  8595
  8596
  8597* EXEC CICS STARTBR
  8598*         DATASET    ('ELMSTR')
  8599*         RIDFLD     (ELMSTR-KEY)
  8600*         GTEQ
  8601*    END-EXEC.
  8602     MOVE 'ELMSTR' TO DFHEIV1
  8603     MOVE 0
  8604       TO DFHEIV11
  8605*    MOVE '&,         G          &   #00008559' TO DFHEIV0
  8606     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8607     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8608     MOVE X'2020233030303038353539' TO DFHEIV0(25:11)
  8609     CALL 'kxdfhei1' USING DFHEIV0,
  8610           DFHEIV1,
  8611           ELMSTR-KEY,
  8612           DFHEIV99,
  8613           DFHEIV11,
  8614           DFHEIV99
  8615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8616
  8617
  8618     MOVE 'Y' TO WS-BROWSE-START-SW.
  8619
  8620 0335-READNEXT.
  8621
  8622
  8623* EXEC CICS READNEXT
  8624*         DATASET    ('ELMSTR')
  8625*         RIDFLD     (ELMSTR-KEY)
  8626*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 162
* EL156.cbl
  8627*    END-EXEC.
  8628     MOVE 'ELMSTR' TO DFHEIV1
  8629     MOVE 0
  8630       TO DFHEIV11
  8631*    MOVE '&.S                   )   #00008569' TO DFHEIV0
  8632     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8633     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8634     MOVE X'2020233030303038353639' TO DFHEIV0(25:11)
  8635     CALL 'kxdfhei1' USING DFHEIV0,
  8636           DFHEIV1,
  8637           DFHEIV20,
  8638           DFHEIV99,
  8639           ELMSTR-KEY,
  8640           DFHEIV99,
  8641           DFHEIV11,
  8642           DFHEIV99,
  8643           DFHEIV99
  8644     SET ADDRESS OF CLAIM-MASTER TO
  8645         DFHEIV20
  8646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8647
  8648
  8649     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8650        GO TO 0380-CLAIM-END-FILE.
  8651
  8652     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8653        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8654        GO TO 0335-READNEXT.
  8655
  8656     IF PI-COMPANY-ID = 'CRI'
  8657         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8658            GO TO 0380-CLAIM-END-FILE.
  8659
  8660     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8661         GO TO 0335-READNEXT.
  8662
  8663     IF PI-CARRIER-SECURITY > SPACES
  8664         IF CL-CARRIER = PI-CARRIER-SECURITY
  8665             NEXT SENTENCE
  8666         ELSE
  8667             GO TO 0335-READNEXT.
  8668
  8669     IF PI-ACCOUNT-SECURITY > SPACES
  8670         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8671             NEXT SENTENCE
  8672         ELSE
  8673             GO TO 0335-READNEXT.
  8674
  8675     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8676     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8677     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8678
  8679     GO TO 0400-FIRST-TIME.
  8680
  8681 0350-BROWSE-BACKWARD.
  8682
  8683     MOVE CLMNOI            TO PI-CLAIM-NO
  8684                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 163
* EL156.cbl
  8685     MOVE CARRI             TO PI-CARRIER.
  8686     MOVE CERTNOI           TO PI-CERT-PRIME.
  8687     MOVE SUFXI             TO PI-CERT-SFX.
  8688
  8689     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8690
  8691     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8692     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8693     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8694
  8695
  8696* EXEC CICS HANDLE CONDITION
  8697*         NOTFND   (0380-CLAIM-END-FILE)
  8698*         ENDFILE  (0380-CLAIM-END-FILE)
  8699*    END-EXEC.
  8700*    MOVE '"$I''                  ! $ #00008621' TO DFHEIV0
  8701     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8702     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8703     MOVE X'2420233030303038363231' TO DFHEIV0(25:11)
  8704     CALL 'kxdfhei1' USING DFHEIV0
  8705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8706
  8707
  8708
  8709* EXEC CICS STARTBR
  8710*         DATASET    ('ELMSTR')
  8711*         RIDFLD     (ELMSTR-KEY)
  8712*         GTEQ
  8713*    END-EXEC.
  8714     MOVE 'ELMSTR' TO DFHEIV1
  8715     MOVE 0
  8716       TO DFHEIV11
  8717*    MOVE '&,         G          &   #00008626' TO DFHEIV0
  8718     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8719     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8720     MOVE X'2020233030303038363236' TO DFHEIV0(25:11)
  8721     CALL 'kxdfhei1' USING DFHEIV0,
  8722           DFHEIV1,
  8723           ELMSTR-KEY,
  8724           DFHEIV99,
  8725           DFHEIV11,
  8726           DFHEIV99
  8727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8728
  8729
  8730     MOVE 'Y' TO WS-BROWSE-START-SW.
  8731
  8732
  8733* EXEC CICS READNEXT
  8734*         DATASET    ('ELMSTR')
  8735*         RIDFLD     (ELMSTR-KEY)
  8736*         SET        (ADDRESS OF CLAIM-MASTER)
  8737*    END-EXEC.
  8738     MOVE 'ELMSTR' TO DFHEIV1
  8739     MOVE 0
  8740       TO DFHEIV11
  8741*    MOVE '&.S                   )   #00008634' TO DFHEIV0
  8742     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 164
* EL156.cbl
  8743     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8744     MOVE X'2020233030303038363334' TO DFHEIV0(25:11)
  8745     CALL 'kxdfhei1' USING DFHEIV0,
  8746           DFHEIV1,
  8747           DFHEIV20,
  8748           DFHEIV99,
  8749           ELMSTR-KEY,
  8750           DFHEIV99,
  8751           DFHEIV11,
  8752           DFHEIV99,
  8753           DFHEIV99
  8754     SET ADDRESS OF CLAIM-MASTER TO
  8755         DFHEIV20
  8756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8757
  8758
  8759
  8760* EXEC CICS READPREV
  8761*         DATASET    ('ELMSTR')
  8762*         RIDFLD     (ELMSTR-KEY)
  8763*         SET        (ADDRESS OF CLAIM-MASTER)
  8764*    END-EXEC.
  8765     MOVE 'ELMSTR' TO DFHEIV1
  8766     MOVE 0
  8767       TO DFHEIV11
  8768*    MOVE '&0S                   )   #00008640' TO DFHEIV0
  8769     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8770     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8771     MOVE X'2020233030303038363430' TO DFHEIV0(25:11)
  8772     CALL 'kxdfhei1' USING DFHEIV0,
  8773           DFHEIV1,
  8774           DFHEIV20,
  8775           DFHEIV99,
  8776           ELMSTR-KEY,
  8777           DFHEIV99,
  8778           DFHEIV11,
  8779           DFHEIV99,
  8780           DFHEIV99
  8781     SET ADDRESS OF CLAIM-MASTER TO
  8782         DFHEIV20
  8783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8784
  8785
  8786 0360-BROWSE-BACKWARD.
  8787
  8788
  8789* EXEC CICS READPREV
  8790*         DATASET    ('ELMSTR')
  8791*         RIDFLD     (ELMSTR-KEY)
  8792*         SET        (ADDRESS OF CLAIM-MASTER)
  8793*    END-EXEC.
  8794     MOVE 'ELMSTR' TO DFHEIV1
  8795     MOVE 0
  8796       TO DFHEIV11
  8797*    MOVE '&0S                   )   #00008648' TO DFHEIV0
  8798     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8799     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8800     MOVE X'2020233030303038363438' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 165
* EL156.cbl
  8801     CALL 'kxdfhei1' USING DFHEIV0,
  8802           DFHEIV1,
  8803           DFHEIV20,
  8804           DFHEIV99,
  8805           ELMSTR-KEY,
  8806           DFHEIV99,
  8807           DFHEIV11,
  8808           DFHEIV99,
  8809           DFHEIV99
  8810     SET ADDRESS OF CLAIM-MASTER TO
  8811         DFHEIV20
  8812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8813
  8814
  8815     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8816        GO TO 0380-CLAIM-END-FILE.
  8817
  8818     IF PI-COMPANY-ID = 'CRI'
  8819         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8820            GO TO 0380-CLAIM-END-FILE.
  8821
  8822     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8823         GO TO 0360-BROWSE-BACKWARD.
  8824
  8825     IF PI-CARRIER-SECURITY > SPACES
  8826         IF CL-CARRIER = PI-CARRIER-SECURITY
  8827             NEXT SENTENCE
  8828         ELSE
  8829             GO TO 0360-BROWSE-BACKWARD.
  8830
  8831     IF PI-ACCOUNT-SECURITY > SPACES
  8832         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8833             NEXT SENTENCE
  8834         ELSE
  8835             GO TO 0360-BROWSE-BACKWARD.
  8836
  8837     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8838     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8839     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8840
  8841     GO TO 0400-FIRST-TIME.
  8842
  8843 0380-CLAIM-END-FILE.
  8844
  8845     MOVE ER-0130     TO EMI-ERROR.
  8846     MOVE -1          TO CLMNOL.
  8847     MOVE AL-UABON    TO CARRA
  8848                         CLMNOA
  8849                         CERTNOA
  8850                         SUFXA.
  8851
  8852     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8853
  8854     GO TO 8200-SEND-DATAONLY.
  8855
  8856 0400-FIRST-TIME.
  8857
  8858     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 166
* EL156.cbl
  8859        MOVE 'N'         TO WS-BROWSE-START-SW
  8860
  8861* EXEC CICS ENDBR
  8862*            DATASET    ('ELMSTR')
  8863*       END-EXEC.
  8864     MOVE 'ELMSTR' TO DFHEIV1
  8865     MOVE 0
  8866       TO DFHEIV11
  8867*    MOVE '&2                    $   #00008699' TO DFHEIV0
  8868     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8869     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8870     MOVE X'2020233030303038363939' TO DFHEIV0(25:11)
  8871     CALL 'kxdfhei1' USING DFHEIV0,
  8872           DFHEIV1,
  8873           DFHEIV11,
  8874           DFHEIV99
  8875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8876
  8877
  8878     IF PI-PROCESSOR-ID = 'LGXX'
  8879         NEXT SENTENCE
  8880     ELSE
  8881
  8882* EXEC CICS READQ TS
  8883*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8884*            INTO    (SECURITY-CONTROL)
  8885*            LENGTH  (SC-COMM-LENGTH)
  8886*            ITEM    (SC-ITEM)
  8887*        END-EXEC
  8888*    MOVE '*$II   L              ''   #00008706' TO DFHEIV0
  8889     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8890     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8891     MOVE X'2020233030303038373036' TO DFHEIV0(25:11)
  8892     CALL 'kxdfhei1' USING DFHEIV0,
  8893           PI-SECURITY-TEMP-STORE-ID,
  8894           SECURITY-CONTROL,
  8895           SC-COMM-LENGTH,
  8896           SC-ITEM,
  8897           DFHEIV99,
  8898           DFHEIV99
  8899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8900         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8901         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8902
  8903     MOVE LOW-VALUES             TO EL156AI.
  8904     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8905     MOVE 'Y'                    TO FIRST-ENTRY.
  8906     GO TO 7000-SHOW-CLAIM.
  8907
  8908 0500-CREATE-TEMP-STORAGE.
  8909     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8910
  8911
  8912* EXEC CICS WRITEQ TS
  8913*        QUEUE (QID)
  8914*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8915*        LENGTH(PI-COMM-LENGTH)
  8916*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 167
* EL156.cbl
  8917*    MOVE '*"     L              ''   #00008723' TO DFHEIV0
  8918     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8919     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8920     MOVE X'2020233030303038373233' TO DFHEIV0(25:11)
  8921     CALL 'kxdfhei1' USING DFHEIV0,
  8922           QID,
  8923           PROGRAM-INTERFACE-BLOCK,
  8924           PI-COMM-LENGTH,
  8925           DFHEIV99,
  8926           DFHEIV99,
  8927           DFHEIV99
  8928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8929
  8930
  8931
  8932* EXEC CICS WRITEQ TS
  8933*        QUEUE (QID)
  8934*        FROM  (EL156AI)
  8935*        LENGTH(MAP-LENGTH)
  8936*    END-EXEC.
  8937*    MOVE '*"     L              ''   #00008729' TO DFHEIV0
  8938     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8939     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8940     MOVE X'2020233030303038373239' TO DFHEIV0(25:11)
  8941     CALL 'kxdfhei1' USING DFHEIV0,
  8942           QID,
  8943           EL156AI,
  8944           MAP-LENGTH,
  8945           DFHEIV99,
  8946           DFHEIV99,
  8947           DFHEIV99
  8948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8949
  8950
  8951 0599-EXIT.
  8952      EXIT.
  8953
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 168
* EL156.cbl
  8955 0600-RECOVER-TEMP-STORAGE.
  8956
  8957* EXEC CICS READQ TS
  8958*        QUEUE (QID)
  8959*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8960*        LENGTH(PI-COMM-LENGTH)
  8961*    END-EXEC.
  8962*    MOVE '*$I    L              ''   #00008740' TO DFHEIV0
  8963     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8964     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8965     MOVE X'2020233030303038373430' TO DFHEIV0(25:11)
  8966     CALL 'kxdfhei1' USING DFHEIV0,
  8967           QID,
  8968           PROGRAM-INTERFACE-BLOCK,
  8969           PI-COMM-LENGTH,
  8970           DFHEIV99,
  8971           DFHEIV99,
  8972           DFHEIV99
  8973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8974
  8975
  8976
  8977* EXEC CICS READQ TS
  8978*        QUEUE (QID)
  8979*        INTO  (EL156AI)
  8980*        LENGTH(MAP-LENGTH)
  8981*    END-EXEC.
  8982*    MOVE '*$I    L              ''   #00008746' TO DFHEIV0
  8983     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8984     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8985     MOVE X'2020233030303038373436' TO DFHEIV0(25:11)
  8986     CALL 'kxdfhei1' USING DFHEIV0,
  8987           QID,
  8988           EL156AI,
  8989           MAP-LENGTH,
  8990           DFHEIV99,
  8991           DFHEIV99,
  8992           DFHEIV99
  8993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8994
  8995
  8996     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8997
  8998     IF PMTTYPEI NOT = LOW-VALUES
  8999         MOVE AL-UANON           TO PMTTYPEA.
  9000
  9001     IF PAYEEI NOT = LOW-VALUES
  9002         MOVE AL-UANON           TO PAYEEA.
  9003
  9004     IF NOTE1I NOT = LOW-VALUES
  9005         MOVE AL-UANON           TO NOTE1A.
  9006
  9007     IF (RETURNED-FROM = 'EL614')
  9008        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  9009     END-IF
  9010*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  9011*       AND (PI-EOB-CODES-EXIST = 'Y')
  9012*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 169
* EL156.cbl
  9013*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  9014     IF PI-SET-NOTE2-MDT = 'Y'
  9015         MOVE AL-SANON           TO NOTE2A
  9016     END-IF
  9017
  9018     IF OFFLINEI NOT = LOW-VALUES
  9019         MOVE AL-UANON           TO OFFLINEA.
  9020
  9021*    IF GROUPEDI NOT = LOW-VALUES
  9022*        MOVE AL-UANON           TO GROUPEDA.
  9023
  9024*    IF CASHI NOT = LOW-VALUES
  9025*        MOVE AL-UANON           TO CASHA.
  9026
  9027     IF CHECKNOI NOT = LOW-VALUES
  9028         MOVE AL-UANON           TO CHECKNOA.
  9029
  9030     IF HOLDTILI NOT = LOW-VALUES
  9031         MOVE AL-UANON           TO HOLDTILA.
  9032
  9033     IF EPYFROMI NOT = LOW-VALUES
  9034         MOVE AL-UANON           TO EPYFROMA.
  9035
  9036     IF AIGFROMI NOT = LOW-VALUES
  9037         MOVE AL-UANON           TO AIGFROMA.
  9038
  9039     IF EPYTHRUI NOT = LOW-VALUES
  9040         MOVE AL-UANON           TO EPYTHRUA.
  9041
  9042     IF EDAYSI NOT = LOW-VALUES
  9043         MOVE AL-UNNON           TO EDAYSA.
  9044
  9045     IF EPYAMTL NOT = +0
  9046         MOVE AL-UNNON           TO EPYAMTA.
  9047
  9048     IF ERESVL NOT = +0
  9049         MOVE AL-UNNON           TO ERESVA.
  9050
  9051     IF EEXPENSL NOT = +0
  9052         MOVE AL-UNNON           TO EEXPENSA.
  9053
  9054     IF ETYPEI NOT = LOW-VALUES
  9055         MOVE AL-UNNON           TO ETYPEA.
  9056
  9057     IF PROOFDTI NOT = 0
  9058         MOVE AL-UNNON           TO PROOFDTA.
  9059
  9060     IF EOBYNI = 'Y' OR 'N' OR 'S'
  9061        MOVE AL-UANON            TO EOBYNA
  9062     END-IF
  9063     IF CLMFMYNI = 'Y' OR 'N'
  9064        MOVE AL-UANON            TO CLMFMYNA
  9065     END-IF
  9066
  9067     IF SURVYYNI = 'Y' OR 'N'
  9068        IF PI-APPROVAL-LEVEL = '4' OR '5'
  9069           MOVE AL-UANON         TO SURVYYNA
  9070        END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 170
* EL156.cbl
  9071     END-IF
  9072
  9073     IF SPRELYNI = 'Y' OR 'N'
  9074        MOVE AL-UANON            TO SPRELYNA
  9075     END-IF
  9076
  9077     .
  9078 0699-EXIT.
  9079      EXIT.
  9080
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 171
* EL156.cbl
  9082 0700-TEST-FOR-CHANGES.
  9083     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  9084         MOVE ER-0433            TO EMI-ERROR
  9085         GO TO 0750-FUNCTION-ERROR.
  9086
  9087     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  9088
  9089     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  9090         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  9091         MOVE 'A'                TO PI-PASS-SW
  9092         GO TO 1000-EDIT-DATA.
  9093
  9094     IF PI-FATAL-COUNT NOT = 0
  9095         MOVE ER-0499            TO EMI-ERROR
  9096         GO TO 0750-FUNCTION-ERROR.
  9097
  9098     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  9099         MOVE ER-0500            TO EMI-ERROR
  9100         GO TO 0750-FUNCTION-ERROR.
  9101
  9102     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  9103        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  9104           MOVE ER-0542          TO EMI-ERROR
  9105           MOVE -1               TO EPYAMTL
  9106           GO TO 0750-FUNCTION-ERROR.
  9107
  9108     IF PI-OFFLINE = 'Y'  OR
  9109        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  9110        MOVE EIBAID              TO PI-PFKEY-USED
  9111        GO TO 5000-UPDATE.
  9112
  9113     GO TO 6000-BUILD-SCREEN-B.
  9114
  9115 0750-FUNCTION-ERROR.
  9116     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9117
  9118     IF ENTERPFL > 0
  9119         MOVE -1                 TO ENTERPFL
  9120         MOVE AL-UNBON           TO ENTERPFA
  9121         GO TO 8200-SEND-DATAONLY
  9122     ELSE
  9123         MOVE -1                 TO ENTERPFL
  9124         MOVE AL-UNNOF           TO ENTERPFA
  9125         GO TO 8200-SEND-DATAONLY.
  9126
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 172
* EL156.cbl
  9128 0800-DELETE-TS.
  9129
  9130* EXEC CICS HANDLE CONDITION
  9131*        QIDERR(0800-EXIT)
  9132*    END-EXEC.
  9133*    MOVE '"$N                   ! % #00008885' TO DFHEIV0
  9134     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9135     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9136     MOVE X'2520233030303038383835' TO DFHEIV0(25:11)
  9137     CALL 'kxdfhei1' USING DFHEIV0
  9138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9139
  9140
  9141
  9142* EXEC CICS DELETEQ TS
  9143*        QUEUE(QID)
  9144*    END-EXEC.
  9145*    MOVE '*&                    #   #00008889' TO DFHEIV0
  9146     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9147     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9148     MOVE X'2020233030303038383839' TO DFHEIV0(25:11)
  9149     CALL 'kxdfhei1' USING DFHEIV0,
  9150           QID,
  9151           DFHEIV99
  9152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9153
  9154
  9155 0800-EXIT.
  9156      EXIT.
  9157 0900-GET-DDF-LIMITS.
  9158
  9159     if cm-clp-state = zeros or spaces or low-values
  9160        move cm-state            to cm-clp-state
  9161     end-if
  9162     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9163     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9164     MOVE cm-clp-state           TO ERPDEF-STATE
  9165     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9166     evaluate true
  9167        when (cl-claim-type = 'L' or 'P')
  9168           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9169             and 'CU')
  9170           move 'L'              to erpdef-ben-type
  9171           move pi-lf-benefit-cd to erpdef-ben-code
  9172        when (cl-claim-type not = 'L' and 'P')
  9173           and (pi-ah-benefit-cd not = '00' and '  ')
  9174           move 'A'              to erpdef-ben-type
  9175           move pi-ah-benefit-cd to erpdef-ben-code
  9176        when (cl-claim-type not = 'L' and 'P')
  9177           and (pi-ah-benefit-cd = '00' or '  ')
  9178           move 'L'              to erpdef-ben-type
  9179           move pi-lf-benefit-cd to erpdef-ben-code
  9180        when (cl-claim-type = 'L' or 'P')
  9181           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9182           move 'A'              to erpdef-ben-type
  9183           move pi-ah-benefit-cd to erpdef-ben-code
  9184        when other
  9185           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 173
* EL156.cbl
  9186           move pi-ah-benefit-cd to erpdef-ben-code
  9187     end-evaluate
  9188*    if (cl-claim-type = 'L' or 'P')
  9189*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9190*          and 'CU')
  9191*       move 'L'                 to erpdef-ben-type
  9192*       move pi-lf-benefit-cd    to erpdef-ben-code
  9193*    else
  9194*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9195*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9196*    end-if
  9197     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9198
  9199     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9200
  9201
  9202* EXEC CICS STARTBR
  9203*        DATASET  ('ERPDEF')
  9204*        RIDFLD   (ERPDEF-KEY)
  9205*        GTEQ
  9206*        RESP     (WS-RESPONSE)
  9207*    END-EXEC
  9208     MOVE 'ERPDEF' TO DFHEIV1
  9209     MOVE 0
  9210       TO DFHEIV11
  9211*    MOVE '&,         G          &  N#00008939' TO DFHEIV0
  9212     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9213     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9214     MOVE X'204E233030303038393339' TO DFHEIV0(25:11)
  9215     CALL 'kxdfhei1' USING DFHEIV0,
  9216           DFHEIV1,
  9217           ERPDEF-KEY,
  9218           DFHEIV99,
  9219           DFHEIV11,
  9220           DFHEIV99
  9221     MOVE EIBRESP  TO WS-RESPONSE
  9222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9223
  9224     IF NOT WS-RESP-NORMAL
  9225        GO TO 0900-EXIT
  9226     END-IF
  9227
  9228     .
  9229 0900-READNEXT.
  9230
  9231
  9232* EXEC CICS READNEXT
  9233*       DATASET  ('ERPDEF')
  9234*       SET      (ADDRESS OF PRODUCT-MASTER)
  9235*       RIDFLD   (ERPDEF-KEY)
  9236*       RESP     (WS-RESPONSE)
  9237*    END-EXEC
  9238     MOVE 'ERPDEF' TO DFHEIV1
  9239     MOVE 0
  9240       TO DFHEIV11
  9241*    MOVE '&.S                   )  N#00008953' TO DFHEIV0
  9242     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9243     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 174
* EL156.cbl
  9244     MOVE X'204E233030303038393533' TO DFHEIV0(25:11)
  9245     CALL 'kxdfhei1' USING DFHEIV0,
  9246           DFHEIV1,
  9247           DFHEIV20,
  9248           DFHEIV99,
  9249           ERPDEF-KEY,
  9250           DFHEIV99,
  9251           DFHEIV11,
  9252           DFHEIV99,
  9253           DFHEIV99
  9254     SET ADDRESS OF PRODUCT-MASTER TO
  9255         DFHEIV20
  9256     MOVE EIBRESP  TO WS-RESPONSE
  9257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9258
  9259     IF NOT WS-RESP-NORMAL
  9260        GO TO 0900-ENDBR
  9261     END-IF
  9262
  9263     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9264        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9265           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9266        ELSE
  9267           GO TO 0900-READNEXT
  9268        END-IF
  9269     ELSE
  9270        GO TO 0900-ENDBR
  9271     END-IF
  9272
  9273     IF CM-LOAN-TERM = ZEROS
  9274        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9275     END-IF
  9276
  9277     .
  9278 0900-ENDBR.
  9279
  9280
  9281* EXEC CICS ENDBR
  9282*       DATASET  ('ERPDEF')
  9283*    END-EXEC
  9284     MOVE 'ERPDEF' TO DFHEIV1
  9285     MOVE 0
  9286       TO DFHEIV11
  9287*    MOVE '&2                    $   #00008981' TO DFHEIV0
  9288     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9289     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9290     MOVE X'2020233030303038393831' TO DFHEIV0(25:11)
  9291     CALL 'kxdfhei1' USING DFHEIV0,
  9292           DFHEIV1,
  9293           DFHEIV11,
  9294           DFHEIV99
  9295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9296
  9297     .
  9298 0900-EXIT.
  9299     EXIT.
  9300 1000-EDIT-DATA.
  9301
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 175
* EL156.cbl
  9302     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9303         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9304         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9305
  9306     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9307
  9308     IF NOT MODIFY-CAP
  9309         MOVE ER-0070            TO EMI-ERROR
  9310         MOVE -1                 TO PMTTYPEL
  9311         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9312         GO TO 2000-EDIT-DONE.
  9313
  9314     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9315                         '5' AND '6'
  9316         MOVE ER-0420            TO EMI-ERROR
  9317         MOVE -1                 TO PMTTYPEL
  9318         MOVE AL-UABON           TO PMTTYPEA
  9319         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9320     ELSE
  9321         MOVE AL-UANON           TO PMTTYPEA.
  9322
  9323*    IF PI-OFFLINE = 'Y'
  9324*       IF PI-GROUPED = 'Y'
  9325*          MOVE ER-1880         TO EMI-ERROR
  9326*          MOVE -1              TO GROUPEDL
  9327*          MOVE AL-UABON        TO GROUPEDA
  9328*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9329*
  9330*    IF GROUPEDL > +0
  9331*       IF PI-GROUPED = 'Y' OR 'N'
  9332*          MOVE AL-UANON TO GROUPEDA
  9333*       ELSE
  9334*          MOVE ER-3140            TO EMI-ERROR
  9335*          MOVE -1                 TO GROUPEDL
  9336*          MOVE AL-UABON           TO GROUPEDA
  9337*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9338*
  9339*    IF CASHL > +0
  9340*       IF PI-CASH = 'Y' OR 'N'
  9341*          MOVE AL-UANON           TO CASHA
  9342*       ELSE
  9343*          MOVE ER-3141            TO EMI-ERROR
  9344*          MOVE -1                 TO CASHL
  9345*          MOVE AL-UABON           TO CASHA
  9346*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9347
  9348     IF LOANNOL > +0
  9349         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9350
  9351 1000-EDIT-PAYEE.
  9352
  9353     IF PI-PAYEE-SEQ NOT NUMERIC
  9354         MOVE ER-0294            TO  EMI-ERROR
  9355         MOVE -1                 TO  PAYEEL
  9356         MOVE AL-UABON           TO  PAYEEA
  9357         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9358         GO TO 1000-CONT-EDIT.
  9359
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 176
* EL156.cbl
  9360     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9361                         'E' OR 'O' OR 'Q'
  9362         NEXT SENTENCE
  9363     ELSE
  9364         MOVE ER-0294            TO  EMI-ERROR
  9365         MOVE -1                 TO  PAYEEL
  9366         MOVE AL-UABON           TO  PAYEEA
  9367         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9368         GO TO 1000-CONT-EDIT.
  9369
  9370     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9371        (PI-PAYEE-SEQ NOT < '1' AND
  9372         PI-PAYEE-SEQ NOT > '9'))
  9373      OR
  9374        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9375         (PI-PAYEE-SEQ NOT > '9'))
  9376         MOVE AL-UANON            TO PAYEEA
  9377     ELSE
  9378         MOVE ER-0294            TO EMI-ERROR
  9379         MOVE -1                 TO PAYEEL
  9380         MOVE AL-UABON           TO PAYEEA
  9381         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9382
  9383     IF PI-COMPANY-ID = 'DMD'
  9384         IF PI-PAYEE-TYPE = 'B' AND
  9385            PI-PAYEE-SEQ NOT = '0'
  9386               MOVE ER-7841            TO EMI-ERROR
  9387               MOVE -1                 TO PAYEEL
  9388               MOVE AL-UABON           TO PAYEEA
  9389               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9390
  9391     IF PI-COMPANY-ID = 'JHL'
  9392         IF PI-PAYEE = 'B0'
  9393             NEXT SENTENCE
  9394           ELSE
  9395
  9396* EXEC CICS HANDLE CONDITION
  9397*            ENDFILE(1950-NOT-FOUND)
  9398*            NOTFND (1950-NOT-FOUND)
  9399*        END-EXEC
  9400*    MOVE '"$''I                  ! & #00009083' TO DFHEIV0
  9401     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9402     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9403     MOVE X'2620233030303039303833' TO DFHEIV0(25:11)
  9404     CALL 'kxdfhei1' USING DFHEIV0
  9405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9406         MOVE 'N'                    TO FOUND-TOL-SW
  9407         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9408         MOVE '2'                    TO CNTL-REC-TYPE
  9409         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9410         MOVE +0                     TO CNTL-SEQ-NO
  9411         MOVE 'PROC'                 TO FILE-SWITCH
  9412         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9413         IF PI-PAYEE = 'I1' AND
  9414            APPROVAL-LEVEL-2
  9415             NEXT SENTENCE
  9416           ELSE
  9417         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 177
* EL156.cbl
  9418             MOVE ER-3546        TO EMI-ERROR
  9419             MOVE -1             TO PAYEEL
  9420             MOVE AL-UABON       TO PAYEEA
  9421             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9422
  9423     IF PI-PAYEE-TYPE = 'E'
  9424        IF PI-PMTTYPE = '5' OR '6'
  9425            NEXT SENTENCE
  9426        ELSE
  9427            MOVE ER-3539            TO EMI-ERROR
  9428            MOVE -1                 TO PAYEEL
  9429            MOVE AL-UABON           TO PAYEEA
  9430            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9431
  9432 1000-CONT-EDIT.
  9433
  9434     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9435        IF PI-EPYAMT NOT NEGATIVE
  9436            MOVE ER-0421         TO EMI-ERROR
  9437            MOVE -1              TO OFFLINEL
  9438            MOVE AL-UABON        TO OFFLINEA
  9439            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9440        ELSE
  9441            MOVE AL-UANON        TO OFFLINEA.
  9442
  9443     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
  9444        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9445           CONTINUE
  9446        ELSE
  9447           IF PI-PRINT-EOB-YN = 'S' AND
  9448              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9449                CONTINUE
  9450           ELSE
  9451              MOVE ER-1561       TO EMI-ERROR
  9452              MOVE -1            TO EOBYNL
  9453              MOVE AL-UABON      TO EOBYNA
  9454              PERFORM 9900-ERROR-FORMAT
  9455                                 THRU 9900-EXIT
  9456           END-IF
  9457        END-IF
  9458
  9459        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9460            MOVE ER-1566        TO EMI-ERROR
  9461            MOVE -1             TO CLMFMYNL
  9462            MOVE AL-UABON       TO CLMFMYNA
  9463            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9464        END-IF
  9465
  9466        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9467            MOVE ER-1567        TO EMI-ERROR
  9468            MOVE -1             TO SURVYYNL
  9469            MOVE AL-UABON       TO SURVYYNA
  9470            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9471        END-IF
  9472
  9473        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9474            MOVE ER-1569        TO EMI-ERROR
  9475            MOVE -1             TO SPRELYNL
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 178
* EL156.cbl
  9476            MOVE AL-UABON       TO SPRELYNA
  9477            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9478        END-IF
  9479
  9480     END-IF
  9481     IF PI-EPYAMT IS NEGATIVE
  9482         IF PI-OFFLINE NOT = 'Y'
  9483             MOVE ER-0836        TO  EMI-ERROR
  9484             MOVE -1             TO  OFFLINEL
  9485             MOVE AL-UABON       TO  OFFLINEA
  9486             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9487
  9488     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9489        MOVE ER-0872             TO EMI-ERROR
  9490        MOVE -1                  TO PROOFDTL
  9491        MOVE AL-UABON            TO PROOFDTA
  9492        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9493     ELSE
  9494        MOVE '4'                TO DC-OPTION-CODE
  9495        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9496        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9497        IF DATE-CONVERSION-ERROR
  9498            MOVE ER-0873        TO EMI-ERROR
  9499            MOVE -1                  TO PROOFDTL
  9500            MOVE AL-UABON            TO PROOFDTA
  9501            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9502        ELSE
  9503            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9504            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9505                MOVE ER-0873    TO EMI-ERROR
  9506                MOVE -1                  TO PROOFDTL
  9507                MOVE AL-UABON            TO PROOFDTA
  9508                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9509            END-IF
  9510        END-IF
  9511     END-IF.
  9512
  9513     IF PI-COMPANY-ID = 'DMD'
  9514        IF NOTE1L NOT = ZEROS
  9515            MOVE ER-7844        TO  EMI-ERROR
  9516            MOVE -1             TO  NOTE1L
  9517            MOVE AL-UABON       TO  NOTE1A
  9518            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9519
  9520     IF PI-COMPANY-ID = 'DMD'
  9521        IF NOTE2L NOT = ZEROS
  9522          GO TO 1004-DMD-EOB-CHECKS.
  9523
  9524     IF NOTE1L NOT > +0
  9525         GO TO 1005-CHECK-ERRORS.
  9526
  9527     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9528         GO TO 1005-CHECK-ERRORS.
  9529
  9530     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9531         GO TO 1003-HAN-PMT-NOTES.
  9532
  9533     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 179
* EL156.cbl
  9534
  9535     IF WS-PMTOPTION NUMERIC
  9536        IF WS-PMTOPTION > '00' AND < '17'
  9537           NEXT SENTENCE
  9538        ELSE
  9539           MOVE ER-0618          TO EMI-ERROR
  9540           MOVE -1               TO NOTE1L
  9541           MOVE AL-UABON         TO NOTE1A
  9542           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9543     ELSE
  9544        GO TO 1005-CHECK-ERRORS.
  9545
  9546     IF WS-PMTOPTION = '05' AND
  9547        WS-DOCNAME = SPACES
  9548          MOVE ER-0616             TO EMI-ERROR
  9549          MOVE -1                  TO NOTE1L
  9550          MOVE AL-UABON            TO NOTE1A
  9551          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9552
  9553     IF WS-PMTOPTION = '15' OR '16'
  9554
  9555* EXEC CICS BIF DEEDIT
  9556*            FIELD (WS-AMOUNT)
  9557*            LENGTH(08)
  9558*        END-EXEC
  9559     MOVE 08
  9560       TO DFHEIV11
  9561*    MOVE '@"L                   #   #00009235' TO DFHEIV0
  9562     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9563     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9564     MOVE X'2020233030303039323335' TO DFHEIV0(25:11)
  9565     CALL 'kxdfhei1' USING DFHEIV0,
  9566           WS-AMOUNT,
  9567           DFHEIV11
  9568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9569        IF (WS-NUM-AMT = ZEROS) OR
  9570           (WS-AMOUNT NOT NUMERIC)
  9571           MOVE ER-0617          TO EMI-ERROR
  9572           MOVE -1               TO NOTE1L
  9573           MOVE AL-UABON         TO NOTE1A
  9574           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9575
  9576     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9577
  9578     GO TO 1005-CHECK-ERRORS.
  9579
  9580 1003-HAN-PMT-NOTES.
  9581
  9582     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9583
  9584     IF WS-HAN-PMT-CODE = SPACE
  9585         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9586     ELSE
  9587     IF WS-HAN-PMT-CODE = 'A'
  9588         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9589                                 TO WS-HAN-PMT-NOTE
  9590     ELSE
  9591     IF WS-HAN-PMT-CODE = 'B'
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 180
* EL156.cbl
  9592         MOVE ':FINAL PAYMENT / DECEASED'
  9593                                 TO WS-HAN-PMT-NOTE
  9594     ELSE
  9595     IF WS-HAN-PMT-CODE = 'C'
  9596         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9597                                 TO WS-HAN-PMT-NOTE
  9598     ELSE
  9599     IF WS-HAN-PMT-CODE = 'D'
  9600         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9601                                 TO WS-HAN-PMT-NOTE
  9602     ELSE
  9603     IF WS-HAN-PMT-CODE = 'E'
  9604         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9605                                 TO WS-HAN-PMT-NOTE
  9606     ELSE
  9607     IF WS-HAN-PMT-CODE = 'F'
  9608         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9609                                 TO WS-HAN-PMT-NOTE
  9610     ELSE
  9611     IF WS-HAN-PMT-CODE = 'P'
  9612         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9613
  9614     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9615     GO TO 1005-CHECK-ERRORS.
  9616
  9617 1004-DMD-EOB-CHECKS.
  9618
  9619     INITIALIZE PI-AT-EOB-CODES.
  9620
  9621     IF NOTE2I (20:21) > SPACES
  9622         MOVE ER-7845          TO EMI-ERROR
  9623         MOVE -1               TO NOTE2L
  9624         MOVE AL-UABON         TO NOTE2A
  9625         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9626         GO TO 1005-CHECK-ERRORS
  9627      ELSE
  9628         MOVE NOTE2I             TO W-EOB-CODES.
  9629
  9630     MOVE +1                     TO W-EOB-NDX.
  9631
  9632 1004-CHECK-EACH-EOB.
  9633
  9634     IF W-EOB-NDX > +5
  9635             OR
  9636        W-EOB-CODE (W-EOB-NDX) = SPACES
  9637         GO TO 1004-CHECK-DUP-EOB.
  9638
  9639     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9640         MOVE ER-0956            TO EMI-ERROR
  9641         MOVE -1                 TO NOTE2L
  9642         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9643         GO TO 1005-CHECK-ERRORS.
  9644
  9645     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9646     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9647     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9648     MOVE 'DLO023'               TO PGM-NAME.
  9649
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 181
* EL156.cbl
  9650
  9651* EXEC CICS LINK
  9652*        PROGRAM    (PGM-NAME)
  9653*        COMMAREA   (CD-COMMUNICATION-AREA)
  9654*        LENGTH     (CD-RCRD-LENGTH)
  9655*    END-EXEC.
  9656*    MOVE '."C                   (   #00009320' TO DFHEIV0
  9657     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9658     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9659     MOVE X'2020233030303039333230' TO DFHEIV0(25:11)
  9660     CALL 'kxdfhei1' USING DFHEIV0,
  9661           PGM-NAME,
  9662           CD-COMMUNICATION-AREA,
  9663           CD-RCRD-LENGTH,
  9664           DFHEIV99,
  9665           DFHEIV99,
  9666           DFHEIV99,
  9667           DFHEIV99
  9668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9669
  9670
  9671     IF CD-RETURN-CODE = 'OK'
  9672         GO TO 1004-CONT.
  9673
  9674     MOVE -1                     TO NOTE2L.
  9675
  9676     IF CD-RETURN-CODE = '01'
  9677         MOVE ER-8310            TO EMI-ERROR
  9678         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9679         GO TO 1005-CHECK-ERRORS.
  9680
  9681     IF CD-RETURN-CODE = '02'
  9682         MOVE ER-8311            TO EMI-ERROR
  9683         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9684         GO TO 1005-CHECK-ERRORS.
  9685
  9686     IF CD-RETURN-CODE = '03'
  9687         MOVE ER-8312            TO EMI-ERROR
  9688         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9689         GO TO 1005-CHECK-ERRORS.
  9690
  9691     IF CD-RETURN-CODE = '04'
  9692         MOVE ER-8313            TO EMI-ERROR
  9693         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9694         GO TO 1005-CHECK-ERRORS.
  9695
  9696     IF CD-RETURN-CODE = '05'
  9697         MOVE ER-8314            TO EMI-ERROR
  9698         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9699         GO TO 1005-CHECK-ERRORS.
  9700
  9701     IF CD-RETURN-CODE = '06'
  9702         MOVE ER-8315            TO EMI-ERROR
  9703         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9704         GO TO 1005-CHECK-ERRORS.
  9705
  9706     IF CD-RETURN-CODE = 'E1'
  9707         MOVE ER-8316            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 182
* EL156.cbl
  9708         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9709         GO TO 1005-CHECK-ERRORS.
  9710
  9711     IF CD-RETURN-CODE = 'N1'
  9712         MOVE ER-8317            TO EMI-ERROR
  9713         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9714         GO TO 1005-CHECK-ERRORS.
  9715
  9716 1004-CONT.
  9717     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9718
  9719     ADD +1 TO W-EOB-NDX.
  9720     GO TO 1004-CHECK-EACH-EOB.
  9721
  9722 1004-CHECK-DUP-EOB.
  9723     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9724         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9725                               PI-AT-EOB-CODE (3) OR
  9726                               PI-AT-EOB-CODE (4) OR
  9727                               PI-AT-EOB-CODE (5)))
  9728                  OR
  9729        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9730         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9731                               PI-AT-EOB-CODE (4) OR
  9732                               PI-AT-EOB-CODE (5)))
  9733                  OR
  9734        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9735         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9736                               PI-AT-EOB-CODE (5)))
  9737                  OR
  9738        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9739         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9740            MOVE ER-8000            TO EMI-ERROR
  9741            MOVE AL-UABON           TO NOTE2A
  9742            MOVE -1                 TO NOTE2L
  9743            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9744            GO TO 1005-CHECK-ERRORS.
  9745
  9746 1005-CHECK-ERRORS.
  9747*    IF PI-COMPANY-ID NOT = 'DMD'
  9748        GO TO 1006-CHECK-ERRORS.
  9749
  9750*********  DMD CODE START ******************
  9751*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9752*       GO TO 1006-CHECK-ERRORS.
  9753*
  9754*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9755*
  9756*    COMPUTE W-PAYMENT-TOTAL
  9757*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9758*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9759*               AND
  9760*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9761*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9762*          MOVE ER-0967    TO EMI-ERROR
  9763*          MOVE -1         TO PMTTYPEL
  9764*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9765*
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 183
* EL156.cbl
  9766*    GO TO 1006-CHECK-ERRORS.
  9767*********  DMD CODE END ******************
  9768
  9769 1006-CHECK-ERRORS.
  9770     if emi-forcable-ctr = zeros
  9771        and emi-fatal-ctr = zeros
  9772        continue
  9773     else
  9774        IF NOT EMI-NO-ERRORS
  9775           GO TO 2000-EDIT-DONE
  9776        end-if
  9777     end-if
  9778
  9779* EXEC CICS HANDLE CONDITION
  9780*        NOTFND(1950-NOT-FOUND)
  9781*    END-EXEC.
  9782*    MOVE '"$I                   ! '' #00009433' TO DFHEIV0
  9783     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9784     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9785     MOVE X'2720233030303039343333' TO DFHEIV0(25:11)
  9786     CALL 'kxdfhei1' USING DFHEIV0
  9787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9788
  9789
  9790     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9791     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9792     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9793     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9794     MOVE 'MSTR'                 TO FILE-SWITCH.
  9795
  9796     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9797
  9798     IF PI-COMPANY-ID = 'DMD'
  9799         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9800
  9801     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9802        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9803           MOVE ER-0873    TO EMI-ERROR
  9804           MOVE -1                  TO PROOFDTL
  9805           MOVE AL-UABON            TO PROOFDTA
  9806           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9807        END-IF
  9808     END-IF
  9809     if cl-benefit-period = zeros
  9810        move er-1667             to emi-error
  9811        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9812     end-if
  9813     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9814     MOVE +95                    TO TRLR-SEQ-NO
  9815
  9816* EXEC CICS READ
  9817*       DATASET  ('ELTRLR')
  9818*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9819*       RIDFLD   (ELTRLR-KEY)
  9820*       RESP     (WS-RESPONSE)
  9821*    END-EXEC
  9822     MOVE 'ELTRLR' TO DFHEIV1
  9823*    MOVE '&"S        E          (  N#00009462' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 184
* EL156.cbl
  9824     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9825     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9826     MOVE X'204E233030303039343632' TO DFHEIV0(25:11)
  9827     CALL 'kxdfhei1' USING DFHEIV0,
  9828           DFHEIV1,
  9829           DFHEIV20,
  9830           DFHEIV99,
  9831           ELTRLR-KEY,
  9832           DFHEIV99,
  9833           DFHEIV99,
  9834           DFHEIV99
  9835     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9836         DFHEIV20
  9837     MOVE EIBRESP  TO WS-RESPONSE
  9838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9839
  9840     if ws-resp-normal
  9841        perform varying s1 from +1 by +1 until
  9842           at-note-error-no (s1) = spaces
  9843           if at-note-error-no (s1) = '1662'
  9844              continue
  9845           else
  9846              move at-note-error-no (s1)
  9847                                 to emi-error
  9848              if at-note-error-no (s1) = '1653'
  9849                 evaluate true
  9850                    when cl-claim-type = 'L'
  9851                       move '  LF  '
  9852                                 to emi-claim-type
  9853                    when cl-claim-type = 'I'
  9854                       move '  IU  '
  9855                                 to emi-claim-type
  9856                    when cl-claim-type = 'A'
  9857                       move '  AH  '
  9858                                 to emi-claim-type
  9859                    when other
  9860                       move ' FMLA '
  9861                                 to emi-claim-type
  9862                 end-evaluate
  9863              end-if
  9864              PERFORM 9900-ERROR-FORMAT
  9865                                 THRU 9900-EXIT
  9866           end-if
  9867        end-perform
  9868     end-if
  9869     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9870         IF PI-PMTTYPE = '5' OR '6'
  9871             NEXT SENTENCE
  9872         ELSE
  9873             MOVE ER-0555             TO EMI-ERROR
  9874             MOVE -1                  TO PMTTYPEL
  9875             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9876
  9877     IF CL-LAST-CLOSE-REASON = '2'
  9878         IF CL-CLAIM-STATUS = 'C'
  9879             MOVE ER-0760        TO  EMI-ERROR
  9880             MOVE -1             TO  PMTTYPEL
  9881             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 185
* EL156.cbl
  9882
  9883     IF PI-ACTIVITY-CODE = 9
  9884         MOVE ER-3538            TO  EMI-ERROR
  9885         MOVE -1                 TO  PMTTYPEL
  9886         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9887
  9888     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9889         GO TO 1008-READ-CERT.
  9890**********************AIG LOGIC STARTS *********************
  9891     IF CL-CERT-PRIME = 'INCOMPLETE'
  9892         MOVE ER-3540            TO  EMI-ERROR
  9893         MOVE -1                 TO  PMTTYPEL
  9894         MOVE AL-UABON           TO  PMTTYPEA
  9895         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9896         GO TO 2000-EDIT-DONE.
  9897
  9898     IF PI-PMTTYPE = '4'
  9899         IF PI-EPYAMT IS NEGATIVE
  9900             IF PI-ECHECKNO-CR = 'CR'
  9901                 NEXT SENTENCE
  9902             ELSE
  9903                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9904
  9905     IF PI-PMTTYPE = '4'
  9906         IF PI-ECHECKNO-CR = 'CR'
  9907             IF PI-EPYAMT IS NEGATIVE
  9908                 NEXT SENTENCE
  9909             ELSE
  9910                 MOVE ER-0834    TO  EMI-ERROR
  9911                 MOVE -1         TO  EPYAMTL
  9912                 MOVE AL-UNBON   TO  EPYAMTA
  9913                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9914
  9915     IF PI-PMTTYPE = '4'
  9916         IF PI-EPYAMT IS NEGATIVE
  9917             IF PI-OFFLINE = 'Y'
  9918                 NEXT SENTENCE
  9919             ELSE
  9920                 MOVE 'Y'        TO  PI-OFFLINE
  9921                                     WS-OFFLINE
  9922                                     OFFLINEO
  9923                 MOVE AL-UANON   TO  OFFLINEA.
  9924
  9925*    IF PI-PMTTYPE = '4'
  9926*        IF PI-EPYAMT IS NEGATIVE
  9927*            IF PI-CASH = 'Y'
  9928*                NEXT SENTENCE
  9929*            ELSE
  9930*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9931*                MOVE AL-UANON   TO  CASHA
  9932*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9933*
  9934*    IF PI-CASH NOT = 'Y' AND 'N'
  9935*         IF PI-OFFLINE = 'Y'  AND
  9936*            PI-ECHECKNO-CR = 'CR'
  9937*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9938*              MOVE AL-UANON     TO  CASHA
  9939*              GO TO 1007-DEFAULT-AIG-CHECKNO.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 186
* EL156.cbl
  9940*
  9941*    IF PI-CASH NOT = 'Y' AND 'N'
  9942*        IF PI-PMTTYPE = '5' OR '6'
  9943*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9944*            MOVE AL-UANON       TO  CASHA
  9945*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9946*
  9947*    IF PI-CASH NOT = 'Y' AND 'N'
  9948*       IF CL-ASSOCIATES = 'N' OR 'A'
  9949*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9950*           MOVE AL-UANON        TO  CASHA
  9951*       ELSE
  9952*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9953*           MOVE AL-UANON        TO  CASHA.
  9954*
  9955*    IF PI-PMTTYPE = '5' OR '6'
  9956*        IF PI-CASH = 'N'
  9957*            MOVE ER-0819        TO  EMI-ERROR
  9958*            MOVE AL-UANON       TO  CASHA
  9959*            MOVE -1             TO  CASHL
  9960*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9961*
  9962*    IF CL-ASSOCIATES = 'N' OR 'A'
  9963*       IF CASHI = 'N'
  9964*        MOVE ER-3537            TO  EMI-ERROR
  9965*        MOVE AL-UANON           TO  CASHA
  9966*        MOVE -1                 TO  CASHL
  9967*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9968
  9969 1007-DEFAULT-AIG-CHECKNO.
  9970
  9971     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9972         MOVE ER-3532            TO  EMI-ERROR
  9973         MOVE -1                 TO  PMTTYPEL
  9974         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9975**********************AIG LOGIC ENDS ***********************
  9976
  9977 1008-READ-CERT.
  9978
  9979     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9980     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9981     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9982     MOVE CL-CERT-STATE          TO CERT-STATE.
  9983     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9984     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9985     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9986     MOVE 'CERT'                 TO FILE-SWITCH.
  9987
  9988     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9989
  9990     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9991        MOVE CM-LF-LOAN-EXPIRE-DT
  9992                                 TO WS-EXP-DT PI-EXP-DT
  9993                                    ws-extended-exp-dt
  9994     ELSE
  9995        MOVE CM-AH-LOAN-EXPIRE-DT
  9996                                 TO WS-EXP-DT PI-EXP-DT
  9997                                    ws-extended-exp-dt
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 187
* EL156.cbl
  9998     end-if
  9999     MOVE '6'           TO DC-OPTION-CODE
 10000     if pi-dcc-product-code not = spaces
 10001        move cm-ah-benefit-cd    to pi-ah-benefit-cd
 10002        move cm-lf-benefit-cd    to pi-lf-benefit-cd
 10003        PERFORM 0900-GET-DDF-limits
 10004                                 THRU 0900-EXIT
 10005        IF PDEF-FOUND
 10006         AND CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 10007           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10008              (P1 > +8)
 10009              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 10010           END-PERFORM
 10011           IF P1 < +9
 10012              MOVE '6'           TO DC-OPTION-CODE
 10013              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10014              IF CL-NO-OF-EXTENSIONS NUMERIC
 10015               display ' 156 - no of ext ' CL-NO-OF-EXTENSIONS
 10016                 MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10017                                             PI-MAX-EXT
 10018              ELSE
 10019                 MOVE PD-MAX-EXTENSION (P1)
 10020                                 TO DC-ELAPSED-MONTHS
 10021              END-IF
 10022              PERFORM 9700-LINK-DATE-CONVERT
 10023                                 THRU 9700-EXIT
 10024              if no-conversion-error
 10025                 move dc-bin-date-2 to ws-extended-exp-dt
 10026              end-if
 10027           else
 10028              move er-1674       to emi-error
 10029              PERFORM 9900-ERROR-FORMAT
 10030                                 THRU 9900-EXIT
 10031           end-if
 10032        ELSE
 10033           IF CL-NO-OF-EXTENSIONS NUMERIC
 10034              MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10035                                          PI-MAX-EXT
 10036           ELSE
 10037              MOVE ZERO  TO DC-ELAPSED-MONTHS
 10038           END-IF
 10039           MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10040           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10041           if no-conversion-error
 10042              move dc-bin-date-2 to ws-extended-exp-dt
 10043           end-if
 10044        end-if
 10045     ELSE
 10046        IF CL-NO-OF-EXTENSIONS NUMERIC
 10047           MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10048                                       PI-MAX-EXT
 10049        ELSE
 10050           MOVE ZERO  TO DC-ELAPSED-MONTHS
 10051        END-IF
 10052        MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10053        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10054        if no-conversion-error
 10055           move dc-bin-date-2 to ws-extended-exp-dt
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 188
* EL156.cbl
 10056        end-if
 10057     end-if
 10058*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10059*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
 10060
 10061     IF CL-INCURRED-DT < CM-CERT-EFF-DT
 10062         MOVE ER-0458            TO EMI-ERROR
 10063         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10064
 10065     IF (CL-INCURRED-DT > WS-EXP-DT)
 10066        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
 10067        MOVE ER-1677             TO EMI-ERROR
 10068        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
 10069     END-IF
 10070     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
 10071     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
 10072         MOVE ER-0459            TO EMI-ERROR
 10073         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10074
 10075     IF CL-REPORTED-DT = LOW-VALUES
 10076        MOVE ER-0530             TO EMI-ERROR
 10077        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10078
 10079     IF PI-COMPANY-ID = 'NCL'
 10080        IF CM-CREDIT-INTERFACE-SW-1 = '2'
 10081            MOVE ER-0770            TO EMI-ERROR
 10082            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10083
 10084     IF PI-COMPANY-ID = 'NCL'
 10085        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
 10086            MOVE ER-0737            TO EMI-ERROR
 10087            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10088
 10089     IF CM-ENTRY-STATUS = 'D' OR 'V'
 10090         MOVE ER-0768            TO  EMI-ERROR
 10091         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10092
 10093     IF CM-CREDIT-INTERFACE-SW-1 = '4'
 10094         MOVE ER-0769            TO  EMI-ERROR
 10095         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10096
 10097     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10098         GO TO 1020-DO-LIFE-EDITS
 10099     ELSE
 10100         GO TO 1030-DO-AH-EDITS.
 10101
 10102 1010-GENERAL-ERROR.
 10103     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10104
 10105     IF EMI-MESSAGE-FORMATTED
 10106         MOVE -1                 TO PMTTYPEL.
 10107
 10108 1010-EXIT.
 10109     EXIT.
 10110
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 189
* EL156.cbl
 10112 1020-DO-LIFE-EDITS.
 10113     IF CM-LF-BENEFIT-CD = '00'
 10114         IF PI-PMTTYPE = '5' OR '6'
 10115             MOVE ER-0658        TO EMI-ERROR
 10116             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10117         ELSE
 10118            if (pi-company-id = 'DCC' or 'CAP')
 10119               and (pi-dcc-product-code not = spaces)
 10120               continue
 10121            else
 10122               MOVE ER-1775      TO EMI-ERROR
 10123               PERFORM 1040-PMTTYPE-ERROR
 10124                                 THRU 1040-EXIT
 10125            end-if
 10126         end-if
 10127     end-if
 10128
 10129     move cm-ah-benefit-cd to pi-ah-benefit-cd
 10130     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10131         MOVE ER-0460            TO EMI-ERROR
 10132         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10133
 10134     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
 10135     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
 10136     MOVE WS-ACCESS              TO  CNTL-ACCESS.
 10137     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 10138     MOVE '4'                    TO  CNTL-REC-TYPE.
 10139     MOVE ZEROS                  TO  CNTL-SEQ-NO.
 10140     MOVE 'BENE'                 TO  FILE-SWITCH.
 10141     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10142     IF NO-BENEFIT-FOUND
 10143         GO TO 1950-NOT-FOUND.
 10144
 10145     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
 10146
 10147     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
 10148         IF PI-PMTTYPE = '4'
 10149             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10150                PI-LF-COVERAGE-TYPE = 'P'
 10151                 NEXT SENTENCE
 10152             ELSE
 10153                 MOVE ER-0461        TO EMI-ERROR
 10154                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10155         ELSE
 10156            NEXT SENTENCE
 10157     ELSE
 10158         IF PI-PMTTYPE = '2'
 10159            IF NOT CM-O-B-COVERAGE
 10160              AND CM-LF-CURRENT-STATUS = '7'
 10161                MOVE ER-0462     TO EMI-ERROR
 10162                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10163
 10164     IF PI-PMTTYPE = '2'
 10165         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
 10166            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
 10167             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
 10168             MOVE ER-0730            TO  EMI-ERROR
 10169             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 190
* EL156.cbl
 10170             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
 10171
 10172     IF PI-PMTTYPE = '2'
 10173         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10174            PI-LF-COVERAGE-TYPE = 'P'
 10175             IF CL-PAID-THRU-DT = CL-INCURRED-DT
 10176                 MOVE ER-0462    TO  EMI-ERROR
 10177                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10178
 10179     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 10180       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
 10181         MOVE ER-0466            TO EMI-ERROR
 10182         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10183
 10184     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10185         IF PI-PMTTYPE = '3'
 10186             MOVE 0436           TO EMI-ERROR
 10187             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10188             GO TO 1045-EDIT-PAYEE-ADDR
 10189         ELSE
 10190             GO TO 1045-EDIT-PAYEE-ADDR.
 10191
 10192     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10193        PI-LF-COVERAGE-TYPE = 'P'
 10194         IF PI-PMTTYPE = '3'
 10195             MOVE ER-0436          TO  EMI-ERROR
 10196             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10197         ELSE
 10198             NEXT SENTENCE
 10199     ELSE
 10200         IF PI-PMTTYPE = '1' OR '3'
 10201             MOVE ER-0436            TO EMI-ERROR
 10202             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10203*
 10204     IF PI-COMPANY-ID = 'CID' AND
 10205        CL-CERT-STATE = 'SC'  AND
 10206        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10207           MOVE ER-0879    TO  EMI-ERROR
 10208           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10209           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10210     END-IF.
 10211     IF PI-COMPANY-ID = 'AHL'
 10212        evaluate true
 10213           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10214              MOVE ER-0879       TO  EMI-ERROR
 10215              PERFORM 1040-PMTTYPE-ERROR
 10216                                 THRU 1040-EXIT
 10217              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10218           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10219                 '6D' OR '6H' OR '6R'
 10220              MOVE ER-0879       TO  EMI-ERROR
 10221              PERFORM 1040-PMTTYPE-ERROR
 10222                                 THRU 1040-EXIT
 10223              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10224           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10225              MOVE ER-0879       TO  EMI-ERROR
 10226              PERFORM 1040-PMTTYPE-ERROR
 10227                                 THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 191
* EL156.cbl
 10228              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10229        end-evaluate
 10230     END-IF
 10231     GO TO 1045-EDIT-PAYEE-ADDR.
 10232
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 192
* EL156.cbl
 10234 1030-DO-AH-EDITS.
 10235     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10236     IF CM-AH-BENEFIT-CD = '00'
 10237         IF PI-PMTTYPE = '5' OR '6'
 10238             MOVE ER-0658        TO EMI-ERROR
 10239             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10240         ELSE
 10241             MOVE ER-1775        TO EMI-ERROR
 10242             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10243
 10244     IF CL-TOTAL-PAID-AMT = ZEROS
 10245         IF PI-PMTTYPE = '4'
 10246             MOVE ER-0438        TO EMI-ERROR
 10247             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10248
 10249     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10250         IF PI-PMTTYPE = '3'
 10251             MOVE ER-0463        TO EMI-ERROR
 10252             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10253         ELSE
 10254             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10255              AND CM-LF-CURRENT-STATUS = '7'
 10256                 MOVE ER-0465    TO EMI-ERROR
 10257                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10258
 10259     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10260         IF PI-PMTTYPE = '3'
 10261             MOVE ER-0464        TO EMI-ERROR
 10262             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10263         ELSE
 10264             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10265                 MOVE ER-0469    TO EMI-ERROR
 10266                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10267
 10268     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10269         IF PI-PMTTYPE = '3'
 10270             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10271                 MOVE ER-0467    TO EMI-ERROR
 10272                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10273             ELSE
 10274                 NEXT SENTENCE
 10275         ELSE
 10276             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10277                 MOVE ER-0468    TO EMI-ERROR
 10278                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10279
 10280     GO TO 1045-EDIT-PAYEE-ADDR.
 10281
 10282 1040-PMTTYPE-ERROR.
 10283     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10284
 10285     IF EMI-MESSAGE-FORMATTED
 10286         MOVE -1                 TO PMTTYPEL
 10287         MOVE AL-UABON           TO PMTTYPEA.
 10288
 10289 1040-EXIT.
 10290     EXIT.
 10291
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 193
* EL156.cbl
 10293 1045-EDIT-PAYEE-ADDR.
 10294
 10295     IF PI-OFFLINE = 'N' AND
 10296        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10297           < PI-PAYEE-SEQ-NUM)
 10298        OR
 10299         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10300         (PI-PAYEE-TYPE = 'B')                 AND
 10301         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10302        OR
 10303         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10304           < PI-PAYEE-SEQ-NUM)
 10305        OR
 10306         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10307           < PI-PAYEE-SEQ-NUM)
 10308        OR
 10309         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10310           < PI-PAYEE-SEQ-NUM)
 10311        OR
 10312         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10313           < PI-PAYEE-SEQ-NUM)
 10314        OR
 10315         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10316           < PI-PAYEE-SEQ-NUM))
 10317             MOVE ER-0437        TO EMI-ERROR
 10318             MOVE -1             TO PAYEEL
 10319             MOVE AL-UABON       TO PAYEEA
 10320             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10321
 10322     IF PI-OFFLINE    = 'N' AND
 10323        PI-PAYEE-TYPE = 'B' AND
 10324        PI-PAYEE-SEQ  = '0'
 10325         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10326         IF BENE-FOUND-SW = 'N'
 10327             MOVE ER-0437        TO EMI-ERROR
 10328             MOVE -1             TO PAYEEL
 10329             MOVE AL-UABON       TO PAYEEA
 10330             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10331
 10332     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10333        IF PI-OFFLINE    = 'N'  AND
 10334           PI-PAYEE-TYPE = 'B'  AND
 10335           PI-PAYEE-SEQ  = '9'
 10336             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10337             IF BENE-FOUND-SW = 'N'
 10338                MOVE ER-0437        TO EMI-ERROR
 10339                MOVE -1             TO PAYEEL
 10340                MOVE AL-UABON       TO PAYEEA
 10341                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10342
 10343*    IF PI-COMPANY-ID = 'CRI'
 10344*        IF CL-CLAIM-TYPE = 'L'
 10345*            MOVE 'N'                TO  WS-GROUPED
 10346*                                        PI-GROUPED
 10347*                                        GROUPEDI
 10348*            MOVE AL-UANON           TO  GROUPEDA
 10349*            GO TO 1050-EDIT-CHECK-NO
 10350*        ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 194
* EL156.cbl
 10351*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10352*            IF WS-GROUP-1 = 'C'
 10353*                NEXT SENTENCE
 10354*            ELSE
 10355*                MOVE 'N'            TO  WS-GROUPED
 10356*                                        PI-GROUPED
 10357*                                        GROUPEDI
 10358*                MOVE AL-UANON       TO  GROUPEDA
 10359*                GO TO 1050-EDIT-CHECK-NO.
 10360
 10361*     IF PI-GROUPED = 'Y'
 10362*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10363*           NEXT SENTENCE
 10364*        ELSE
 10365*           MOVE ER-0437        TO EMI-ERROR
 10366*           MOVE -1             TO PAYEEL
 10367**02180            MOVE AL-UABON       TO PAYEEA
 10368*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10369*
 10370*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10371*        (PI-GROUPED    = ' ')
 10372*        NEXT SENTENCE
 10373*     ELSE
 10374*
 10375     GO TO 1050-EDIT-CHECK-NO.
 10376*     IF PI-COMPANY-ID = 'CRI'
 10377*        MOVE 'N'           TO GROUPEDI
 10378*                              PI-GROUPED
 10379*                              WS-GROUPED
 10380*        MOVE AL-UANON      TO GROUPEDA.
 10381*
 10382*     IF PI-COMPANY-ID = 'CRI'
 10383*        IF PI-PAYEE-TYPE = 'B'
 10384*           IF BENE-FOUND-SW = 'Y'
 10385*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10386*                 MOVE 'Y'           TO GROUPEDI
 10387*                                       PI-GROUPED
 10388*                                       WS-GROUPED
 10389*                 MOVE AL-UANON      TO GROUPEDA
 10390*              ELSE
 10391*                 NEXT SENTENCE
 10392*           ELSE
 10393*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10394*              IF BENE-FOUND-SW = 'Y'
 10395*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10396*                    MOVE 'Y'      TO GROUPEDI
 10397*                                     PI-GROUPED
 10398*                                     WS-GROUPED
 10399*                    MOVE AL-UANON TO GROUPEDA.
 10400*
 10401
 10402     IF PI-COMPANY-ID NOT = 'CRI'
 10403        GO TO 1050-EDIT-CHECK-NO.
 10404
 10405*************** CRI CODE START ******************
 10406     IF PI-PAYEE-TYPE NOT = 'A'
 10407        GO TO 1050-EDIT-CHECK-NO.
 10408
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 195
* EL156.cbl
 10409     MOVE LOW-VALUES             TO ERACCT-KEY.
 10410     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10411     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10412     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10413     MOVE PI-STATE               TO ACCT-STATE.
 10414     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10415     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10416     MOVE 'ACCT'                 TO FILE-SWITCH.
 10417
 10418     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10419     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10420
 10421
 10422* EXEC CICS HANDLE CONDITION
 10423*         NOTFND   (1950-NOT-FOUND)
 10424*         ENDFILE  (1950-NOT-FOUND)
 10425*    END-EXEC.
 10426*    MOVE '"$I''                  ! ( #00010050' TO DFHEIV0
 10427     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10428     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10429     MOVE X'2820233030303130303530' TO DFHEIV0(25:11)
 10430     CALL 'kxdfhei1' USING DFHEIV0
 10431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10432
 10433
 10434
 10435* EXEC CICS STARTBR
 10436*         DATASET   ('ERACCT')
 10437*         RIDFLD    (ERACCT-KEY)
 10438*         GTEQ
 10439*    END-EXEC.
 10440     MOVE 'ERACCT' TO DFHEIV1
 10441     MOVE 0
 10442       TO DFHEIV11
 10443*    MOVE '&,         G          &   #00010055' TO DFHEIV0
 10444     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10445     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10446     MOVE X'2020233030303130303535' TO DFHEIV0(25:11)
 10447     CALL 'kxdfhei1' USING DFHEIV0,
 10448           DFHEIV1,
 10449           ERACCT-KEY,
 10450           DFHEIV99,
 10451           DFHEIV11,
 10452           DFHEIV99
 10453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10454
 10455
 10456 1046-READNEXT-ERACCT.
 10457
 10458
 10459* EXEC CICS READNEXT
 10460*         DATASET   ('ERACCT')
 10461*         RIDFLD    (ERACCT-KEY)
 10462*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10463*    END-EXEC.
 10464     MOVE 'ERACCT' TO DFHEIV1
 10465     MOVE 0
 10466       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 196
* EL156.cbl
 10467*    MOVE '&.S                   )   #00010063' TO DFHEIV0
 10468     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10469     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10470     MOVE X'2020233030303130303633' TO DFHEIV0(25:11)
 10471     CALL 'kxdfhei1' USING DFHEIV0,
 10472           DFHEIV1,
 10473           DFHEIV20,
 10474           DFHEIV99,
 10475           ERACCT-KEY,
 10476           DFHEIV99,
 10477           DFHEIV11,
 10478           DFHEIV99,
 10479           DFHEIV99
 10480     SET ADDRESS OF ACCOUNT-MASTER TO
 10481         DFHEIV20
 10482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10483
 10484
 10485     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10486        IF WS-ERACCT-HOLD-RECORD = SPACES
 10487           GO TO 1950-NOT-FOUND
 10488        ELSE
 10489           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10490           GO TO 1048-CONTINUE.
 10491
 10492     IF ACCT-EXP-DT = HIGH-VALUES
 10493        NEXT SENTENCE
 10494     ELSE
 10495        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10496        GO TO 1046-READNEXT-ERACCT.
 10497
 10498 1048-CONTINUE.
 10499
 10500*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10501*       MOVE 'Y'                 TO GROUPEDI
 10502*                                   PI-GROUPED
 10503*                                   WS-GROUPED
 10504*       MOVE AL-UANON            TO GROUPEDA.
 10505*************** CRI CODE END ******************
 10506
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 197
* EL156.cbl
 10508 1050-EDIT-CHECK-NO.
 10509
 10510     IF PI-OFFLINE = 'Y'
 10511         IF PI-ECHECKNO = SPACES
 10512              MOVE ER-0439        TO EMI-ERROR
 10513              GO TO 1090-CHECK-NO-ERROR
 10514           ELSE
 10515*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10516*           IF PI-ECHECKNO-N = 'N' AND
 10517*              PI-CASH       = 'Y'
 10518*                MOVE ER-3535        TO EMI-ERROR
 10519*                GO TO 1090-CHECK-NO-ERROR
 10520*             ELSE
 10521*                MOVE AL-UANON    TO CHECKNOA
 10522*                GO TO 1100-EDIT-HOLDTIL
 10523*         ELSE
 10524            MOVE AL-UANON    TO CHECKNOA
 10525            GO TO 1100-EDIT-HOLDTIL.
 10526
 10527     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10528     MOVE '6'                    TO CNTL-REC-TYPE.
 10529
 10530     IF CONTROL-IS-ACTUAL-CARRIER
 10531         MOVE PI-CARRIER         TO WS-CARR
 10532     ELSE
 10533         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10534
 10535     IF PI-COMPANY-ID = 'FIA'
 10536         MOVE PI-CARRIER         TO WS-CARR.
 10537
 10538     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10539     MOVE 0                      TO CNTL-SEQ-NO.
 10540     MOVE 'CARR'                 TO FILE-SWITCH.
 10541
 10542     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10543
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 198
* EL156.cbl
 10545     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10546         GO TO 1051-EDIT-CHECKNO-CONT.
 10547
 10548**********************AIG LOGIC STARTS**********************
 10549     IF PI-ECHECKNO = SPACES
 10550         IF CHECK-NO-MANUAL
 10551             MOVE ER-0441        TO EMI-ERROR
 10552             GO TO 1090-CHECK-NO-ERROR
 10553         ELSE
 10554             MOVE AL-UANOF       TO CHECKNOA
 10555             GO TO 1100-EDIT-HOLDTIL.
 10556
 10557     IF PI-ECHECKNO NOT = SPACES
 10558         IF CHECK-NO-MANUAL
 10559             MOVE AL-UANON       TO CHECKNOA
 10560             GO TO 1100-EDIT-HOLDTIL.
 10561
 10562     IF PI-ECHECKNO-CR = 'CR'
 10563        IF PI-OFFLINE = 'Y'
 10564            MOVE AL-UANON       TO CHECKNOA
 10565            GO TO 1100-EDIT-HOLDTIL
 10566        ELSE
 10567            MOVE ER-3534        TO EMI-ERROR
 10568            GO TO 1090-CHECK-NO-ERROR.
 10569
 10570     IF PI-ECHECKNO-N = 'N'
 10571        IF PI-CASH = 'N'
 10572            MOVE AL-UANON       TO CHECKNOA
 10573            GO TO 1100-EDIT-HOLDTIL
 10574        ELSE
 10575            MOVE ER-3535          TO EMI-ERROR
 10576            GO TO 1090-CHECK-NO-ERROR.
 10577
 10578     MOVE ER-0442        TO EMI-ERROR
 10579     GO TO 1090-CHECK-NO-ERROR.
 10580**********************AIG LOGIC ENDS************************
 10581
 10582 1051-EDIT-CHECKNO-CONT.
 10583
 10584     IF PI-COMPANY-ID = 'DMD'
 10585        IF PI-ECHECKNO NOT = SPACES
 10586           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10587              MOVE ER-0442        TO EMI-ERROR
 10588              GO TO 1090-CHECK-NO-ERROR
 10589            ELSE
 10590              GO TO 1100-EDIT-HOLDTIL
 10591          ELSE
 10592           GO TO 1100-EDIT-HOLDTIL.
 10593
 10594     IF PI-ECHECKNO = SPACES
 10595         IF CHECK-NO-MANUAL
 10596             MOVE ER-0441        TO EMI-ERROR
 10597             GO TO 1090-CHECK-NO-ERROR
 10598         ELSE
 10599             MOVE AL-UANOF       TO CHECKNOA
 10600             GO TO 1100-EDIT-HOLDTIL
 10601     ELSE
 10602         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 199
* EL156.cbl
 10603             MOVE AL-UANON       TO CHECKNOA
 10604             GO TO 1100-EDIT-HOLDTIL
 10605         ELSE
 10606             MOVE ER-0442        TO EMI-ERROR
 10607             GO TO 1090-CHECK-NO-ERROR.
 10608
 10609 1090-CHECK-NO-ERROR.
 10610     MOVE -1                     TO CHECKNOL.
 10611     MOVE AL-UABON               TO CHECKNOA.
 10612     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10613
 10614     GO TO 2000-EDIT-DONE.
 10615
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 200
* EL156.cbl
 10617 1100-EDIT-HOLDTIL.
 10618     MOVE AL-UANON               TO HOLDTILA.
 10619
 10620     IF PI-HOLDTIL = ZEROS
 10621        IF PI-OFFLINE = 'Y'
 10622           MOVE ER-0572          TO EMI-ERROR
 10623           GO TO 1105-HOLDTIL-ERROR
 10624        ELSE
 10625           GO TO 1110-EDIT-PAID-FROM.
 10626
 10627     MOVE '4'                    TO DC-OPTION-CODE.
 10628     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10629     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10630
 10631     IF DATE-CONVERSION-ERROR
 10632         MOVE ER-0446            TO EMI-ERROR
 10633         GO TO 1105-HOLDTIL-ERROR
 10634     END-IF
 10635     IF PI-OFFLINE = 'Y'
 10636        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10637           MOVE ER-0446            TO EMI-ERROR
 10638           GO TO 1105-HOLDTIL-ERROR
 10639        END-IF
 10640     END-IF
 10641
 10642     IF PI-OFFLINE = 'Y'
 10643        GO TO 1110-EDIT-PAID-FROM.
 10644
 10645     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10646     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10647     MOVE '1'                    TO DC-OPTION-CODE.
 10648     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10649
 10650     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10651         MOVE ER-0447            TO EMI-ERROR
 10652         GO TO 1105-HOLDTIL-ERROR.
 10653
 10654     GO TO 1110-EDIT-PAID-FROM.
 10655
 10656 1105-HOLDTIL-ERROR.
 10657     MOVE -1                     TO HOLDTILL.
 10658     MOVE AL-UNBON               TO HOLDTILA.
 10659     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10660
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 201
* EL156.cbl
 10662 1110-EDIT-PAID-FROM.
 10663     MOVE AL-UANON               TO EPYFROMA.
 10664
 10665     IF PI-EPYFROM = ZEROS
 10666         GO TO 1120-CALCULATE-PAID-FROM.
 10667
 10668     IF PI-PMTTYPE = '5' OR '6'
 10669         MOVE ER-0448            TO EMI-ERROR
 10670         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10671         MOVE AL-UNBON           TO EPYFROMA
 10672         MOVE -1                 TO EPYFROML
 10673         GO TO 1150-EDIT-PAID-THRU.
 10674
 10675     MOVE '4'                    TO DC-OPTION-CODE.
 10676     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10677     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10678
 10679     IF DATE-CONVERSION-ERROR
 10680         MOVE ER-0449            TO EMI-ERROR
 10681         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10682         MOVE AL-UNBON           TO EPYFROMA
 10683         MOVE -1                 TO EPYFROML
 10684     ELSE
 10685         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10686
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 202
* EL156.cbl
 10688 1120-CALCULATE-PAID-FROM.
 10689     IF PI-PMTTYPE = '5' OR '6'
 10690         GO TO 1150-EDIT-PAID-THRU.
 10691
 10692*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10693*       IF PI-PMTTYPE = '4'
 10694*         GO TO 1150-EDIT-PAID-THRU.
 10695
 10696     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10697         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10698         MOVE ' '                TO DC-OPTION-CODE
 10699         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10700         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10701         GO TO 1145-TEST-PAID-FROM.
 10702
 10703     IF PI-PMTTYPE = '4'
 10704        GO TO 1150-EDIT-PAID-THRU.
 10705
 10706     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10707     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10708     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10709     MOVE '5'                    TO CNTL-REC-TYPE.
 10710     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10711     MOVE 'BENE'                 TO FILE-SWITCH.
 10712
 10713     IF WS-BEN-CD = ZEROS
 10714         GO TO 1950-NOT-FOUND.
 10715
 10716     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10717
 10718     IF NO-BENEFIT-FOUND
 10719         GO TO 1950-NOT-FOUND.
 10720
 10721     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10722     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10723
 10724     IF PI-BEN-DAYS NOT NUMERIC
 10725        MOVE ZEROS               TO PI-BEN-DAYS.
 10726
 10727     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10728
 10729     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10730        (CL-TOTAL-PAID-AMT > ZEROS)
 10731         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10732         MOVE '6'                 TO DC-OPTION-CODE
 10733         MOVE +0                  TO DC-ELAPSED-MONTHS
 10734         MOVE +1                  TO DC-ELAPSED-DAYS
 10735         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10736         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10737         GO TO 1145-TEST-PAID-FROM.
 10738
 10739******************************************************************
 10740****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10741****** SPECIAL ENTERED DATE.
 10742******************************************************************
 10743
 10744     IF PI-AIGFROM = ZEROS
 10745         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 203
* EL156.cbl
 10746
 10747     MOVE AL-UANON TO AIGFROMA.
 10748
 10749     MOVE '4'                    TO DC-OPTION-CODE.
 10750     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10751     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10752
 10753     IF DATE-CONVERSION-ERROR
 10754         MOVE ER-0449            TO EMI-ERROR
 10755         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10756         MOVE AL-UNBON           TO AIGFROMA
 10757         MOVE -1                 TO AIGFROML
 10758         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10759     ELSE
 10760         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10761         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10762
 10763     GO TO 1140-CONTINUE-PAID-FROM.
 10764
 10765 1130-CONTINUE-PAID-FROM.
 10766
 10767     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10768        (CL-TOTAL-PAID-AMT = ZEROS)
 10769           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10770
 10771 1140-CONTINUE-PAID-FROM.
 10772
 10773     IF PI-BEN-TYPE = 'R'
 10774         IF PI-BEN-DAYS = ZEROS
 10775             NEXT SENTENCE
 10776         ELSE
 10777         IF PI-COMPANY-ID NOT = 'DMD'
 10778             SUBTRACT 1 FROM PI-BEN-DAYS.
 10779
 10780     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10781
 10782     IF PI-COMPANY-ID = 'DMD'
 10783         MOVE -1                 TO DC-ELAPSED-DAYS
 10784         MOVE +0                 TO DC-ELAPSED-MONTHS
 10785         MOVE '6'                TO DC-OPTION-CODE
 10786         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10787         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10788         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10789                               REMAINDER DC-ELAPSED-DAYS
 10790      ELSE
 10791         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10792         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10793
 10794     MOVE '6'                    TO DC-OPTION-CODE.
 10795     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10796     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10797
 10798     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10799
 10800     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10801         MOVE ER-0541            TO EMI-ERROR
 10802         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10803         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 204
* EL156.cbl
 10804         MOVE AL-UNBON           TO EPYFROMA.
 10805
 10806     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10807        (PI-BENEFIT-SAVE = '60E')
 10808        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10809           (CL-TOTAL-PAID-AMT = ZEROS)
 10810             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10811             MOVE 30                  TO DC-ELAPSED-DAYS
 10812             MOVE +0                  TO DC-ELAPSED-MONTHS
 10813             MOVE '6'                 TO DC-OPTION-CODE
 10814             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10815
 10816     IF PI-BEN-TYPE = 'R'
 10817         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10818     ELSE
 10819         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10820         IF WS-SV-EPYFROM = LOW-VALUES
 10821            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10822
 10823     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10824         IF WS-USE-AIG-PAYFROM   OR
 10825            WS-AIG-RECALC-PAYFROM
 10826              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10827                                      DC-BIN-DATE-1
 10828              MOVE ' '            TO  DC-OPTION-CODE
 10829              MOVE +0             TO  DC-ELAPSED-MONTHS
 10830                                      DC-ELAPSED-DAYS
 10831              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10832              IF NO-CONVERSION-ERROR
 10833                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10834
 10835     IF PI-CPYFROM < CL-INCURRED-DT
 10836        MOVE -1                  TO EPYFROML
 10837        MOVE ER-3542             TO EMI-ERROR
 10838        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10839
 10840     IF CM-ENTRY-DT < CL-INCURRED-DT
 10841        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10842        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10843        MOVE +0                     TO DC-ELAPSED-DAYS
 10844        MOVE +0                     TO DC-ELAPSED-MONTHS
 10845        MOVE '1'                    TO DC-OPTION-CODE
 10846        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10847        ELSE
 10848        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10849
 10850     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10851         NEXT SENTENCE
 10852     ELSE
 10853         IF DC-ELAPSED-MONTHS < 2
 10854             MOVE ER-3255        TO EMI-ERROR
 10855             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10856
 10857 1145-TEST-PAID-FROM.
 10858     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10859         GO TO 1150-EDIT-PAID-THRU.
 10860
 10861     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 205
* EL156.cbl
 10862         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10863         MOVE ' '                TO DC-OPTION-CODE
 10864         MOVE +0                 TO DC-ELAPSED-MONTHS
 10865                                    DC-ELAPSED-DAYS
 10866         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10867         IF NO-CONVERSION-ERROR
 10868             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10869         ELSE
 10870             MOVE SPACES             TO EMI-DATE-FIELD.
 10871
 10872     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10873         IF CL-TOTAL-PAID-AMT = ZEROS
 10874             MOVE ER-3543            TO EMI-ERROR
 10875             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10876             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10877             IF EMI-MESSAGE-FORMATTED
 10878                MOVE -1             TO EPYFROML
 10879                MOVE AL-UNBON       TO EPYFROMA
 10880             ELSE
 10881                NEXT SENTENCE
 10882         ELSE
 10883             MOVE ER-0452            TO EMI-ERROR
 10884             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10885             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10886             IF EMI-MESSAGE-FORMATTED
 10887                MOVE -1             TO EPYFROML
 10888                MOVE AL-UNBON       TO EPYFROMA.
 10889
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 206
* EL156.cbl
 10891 1150-EDIT-PAID-THRU.
 10892
 10893     MOVE AL-UANON               TO EPYTHRUA.
 10894
 10895     IF PI-EPYTHRU = ZEROS
 10896*        IF PI-PMTTYPE = '4' OR '5' OR '6'
 10897         IF PI-PMTTYPE = '5' OR '6'
 10898           OR (CL-CLAIM-TYPE NOT = 'L' AND PI-PMTTYPE = '4')
 10899             GO TO 1200-EDIT-FIND-TOLERANCES
 10900         ELSE
 10901            IF (PI-PMTTYPE = '3') OR (PI-PMTTYPE = '4') OR
 10902               (PI-PMTTYPE = '2' AND
 10903                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10904               GO TO 1152-CHECK-TYPE
 10905            ELSE
 10906               MOVE ER-0473      TO EMI-ERROR
 10907               GO TO 1170-PAID-THRU-FATAL-ERROR
 10908     ELSE
 10909         IF PI-PMTTYPE = '5' OR '6'
 10910             MOVE ER-0474        TO EMI-ERROR
 10911             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10912
 10913     MOVE '4'                    TO DC-OPTION-CODE.
 10914     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10915     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10916
 10917     IF DATE-CONVERSION-ERROR
 10918         MOVE ER-0475            TO EMI-ERROR
 10919         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10920
 10921     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10922
 10923     IF PI-COMPANY-ID = 'DMD'
 10924         IF PI-PMTTYPE NOT = '2'
 10925                 AND
 10926            WS-EXP-DT > WS-SV-EPYTHRU
 10927             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10928             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10929             MOVE '1'              TO DC-OPTION-CODE
 10930             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10931             IF DATE-CONVERSION-ERROR
 10932                 MOVE ER-0944      TO EMI-ERROR
 10933                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10934             ELSE
 10935                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10936                    DC-ELAPSED-DAYS   = 1
 10937                     MOVE ER-0945  TO EMI-ERROR
 10938                     MOVE -1       TO EPYTHRUL
 10939                     MOVE AL-UABON TO EPYTHRUA
 10940                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10941
 10942     IF PI-PMTTYPE = '4'
 10943         NEXT SENTENCE
 10944     ELSE
 10945         IF WS-SV-EPYTHRU = WS-EXP-DT
 10946             IF PI-PMTTYPE NOT = '2' AND '3'
 10947                 MOVE ER-3541    TO EMI-ERROR
 10948                 MOVE -1         TO PMTTYPEL
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 207
* EL156.cbl
 10949                 MOVE AL-UABON   TO PMTTYPEA
 10950                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10951
 10952     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10953         MOVE ER-0501            TO EMI-ERROR
 10954         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10955
 10956     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10957        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 10958*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10959*              MOVE ER-0540         TO EMI-ERROR
 10960*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10961*              MOVE -1              TO EPYTHRUL
 10962*              MOVE AL-UNBON        TO EPYTHRUA
 10963*          ELSE
 10964*          IF PI-COMPANY-ID = 'DMD'
 10965*              MOVE ER-7540         TO EMI-ERROR
 10966*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10967*              MOVE -1              TO EPYTHRUL
 10968*              MOVE AL-UNBON        TO EPYTHRUA
 10969*          ELSE
 10970               IF PI-PMTTYPE NOT = '2' AND '3'
 10971                  IF PI-COMPANY-ID = '???'
 10972                      MOVE ER-7540  TO EMI-ERROR
 10973                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10974                      MOVE -1       TO EPYTHRUL
 10975                      MOVE AL-UNBON TO EPYTHRUA
 10976                  ELSE
 10977                      MOVE ER-0540  TO EMI-ERROR
 10978                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10979                      MOVE -1       TO EPYTHRUL
 10980                      MOVE AL-UNBON TO EPYTHRUA.
 10981
 10982     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10983            OR
 10984        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10985         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10986            OR
 10987        (PI-CPYFROM NOT = LOW-VALUES AND
 10988         PI-CPYFROM < CL-PAID-THRU-DT)
 10989        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10990
 10991 1152-CHECK-TYPE.
 10992     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 10993        OR (PI-PMTTYPE = '5' OR '6')
 10994         GO TO 1160-EDIT-PAID-THRU-AH.
 10995
 10996 1155-EDIT-PAID-THRU-LIFE.
 10997     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10998     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10999     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11000     MOVE '4'                    TO CNTL-REC-TYPE.
 11001     MOVE ZEROS                  TO CNTL-SEQ-NO.
 11002     MOVE 'BENE'                 TO FILE-SWITCH.
 11003
 11004     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11005
 11006     IF NO-BENEFIT-FOUND
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 208
* EL156.cbl
 11007         GO TO 1950-NOT-FOUND.
 11008
 11009     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 11010
 11011     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 11012
 11013     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11014        PI-LF-COVERAGE-TYPE = 'P'
 11015         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 11016         GO TO 1200-EDIT-FIND-TOLERANCES.
 11017
 11018     IF PI-EPYTHRU = ZEROS
 11019        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 11020
 11021     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11022         MOVE ER-0476            TO EMI-ERROR
 11023         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11024
 11025     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 11026*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 11027     move cl-critical-period    to dc-elapsed-months
 11028     MOVE +0                    TO DC-ELAPSED-DAYS.
 11029     MOVE '6'                   TO DC-OPTION-CODE.
 11030     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11031
 11032     IF (NO-CONVERSION-ERROR AND
 11033         WS-SPECIAL-CALC-CD = 'C')
 11034        IF CL-INCURRED-DT > DC-BIN-DATE-2
 11035            MOVE ER-0657 TO EMI-ERROR
 11036            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11037
 11038     IF PI-COMPANY-ID = 'NCL'
 11039         IF WS-SPECIAL-CALC-CD = 'C' AND
 11040            cl-critical-period = zeros
 11041*           CM-LF-CRITICAL-PERIOD = +0
 11042             MOVE ER-0844       TO EMI-ERROR
 11043             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11044
 11045     GO TO 1200-EDIT-FIND-TOLERANCES.
 11046
 11047 1160-EDIT-PAID-THRU-AH.
 11048     IF PI-EPYTHRU = ZEROS
 11049        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11050                                    WS-SV-EPYTHRU
 11051     ELSE
 11052        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 11053
 11054     IF WS-SV-EPYTHRU < PI-CPYFROM
 11055         MOVE ER-0508            TO EMI-ERROR
 11056         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11057
 11058     perform 7975-read-acct      thru 7975-exit
 11059     move zeros                  to pi-max-ext
 11060     if PI-DCC-PRODUCT-CODE NOT = SPACES
 11061        PERFORM 0900-GET-DDF-LIMITS
 11062                                 THRU 0900-EXIT
 11063        IF PDEF-FOUND
 11064           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 209
* EL156.cbl
 11065              (P1 > +8)
 11066              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11067           END-PERFORM
 11068           IF P1 < +9
 11069              MOVE PD-MAX-extension (P1)
 11070                                 TO pi-max-ext
 11071           else
 11072              move er-1674       to emi-error
 11073              PERFORM 9900-ERROR-FORMAT
 11074                                 THRU 9900-EXIT
 11075           END-IF
 11076        else
 11077           move er-1672          to emi-error
 11078           PERFORM 9900-ERROR-FORMAT
 11079                                 THRU 9900-EXIT
 11080        END-IF
 11081     end-if
 11082     move spaces                 to pi-max-ext-used
 11083     IF PI-PMTTYPE = '3'
 11084        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11085        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11086           MOVE ER-0477          TO EMI-ERROR
 11087           PERFORM 1165-PAID-THRU-ERROR
 11088                                 THRU 1165-EXIT
 11089        ELSE
 11090           continue
 11091        end-if
 11092     ELSE
 11093        IF WS-SV-EPYTHRU > WS-EXP-DT
 11094         IF PI-DCC-PRODUCT-CODE NOT > SPACES
 11095           move ws-exp-dt        to dc-bin-date-1
 11096           move ws-sv-epythru    to dc-bin-date-2
 11097           MOVE '1'              TO DC-OPTION-CODE
 11098           MOVE +0               TO DC-ELAPSED-DAYS
 11099                                    DC-ELAPSED-MONTHS
 11100           PERFORM 9700-LINK-DATE-CONVERT
 11101                                 THRU 9700-EXIT
 11102           if no-conversion-error
 11103              if dc-elapsed-days > zeros
 11104                 add +1 to dc-elapsed-months
 11105              end-if
 11106              if dc-elapsed-months > pi-max-ext
 11107                 MOVE ER-0557    TO EMI-ERROR
 11108                 PERFORM 1165-PAID-THRU-ERROR
 11109                                 THRU 1165-EXIT
 11110              else
 11111                 move 'Y'        to pi-max-ext-used
 11112                 move er-1670    to emi-error
 11113                 perform 9900-error-format
 11114                                 thru 9900-exit
 11115              end-if
 11116           end-if
 11117         ELSE
 11118            MOVE ER-0557    TO EMI-ERROR
 11119            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 11120         END-IF
 11121        end-if
 11122     end-if
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 210
* EL156.cbl
 11123
 11124     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 11125         PI-PMTTYPE NOT = '3'
 11126         MOVE ER-0541        TO EMI-ERROR
 11127         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11128
 11129     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 11130        (PI-PMTTYPE NOT = '3')
 11131         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 11132             MOVE ER-0478        TO EMI-ERROR
 11133             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11134
 11135     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 11136        (PI-PMTTYPE NOT = '4')
 11137         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 11138             MOVE ER-0479        TO EMI-ERROR
 11139             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11140
 11141     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 11142         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 11143             MOVE ER-0545        TO EMI-ERROR
 11144             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11145
 11146     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 11147         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 11148             MOVE ER-0481        TO EMI-ERROR
 11149             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11150
 11151*    IF PI-COMPANY-ID = 'NCL'
 11152*        IF WS-SPECIAL-CALC-CD = 'C' AND
 11153*           CM-AH-CRITICAL-PERIOD = +0
 11154*            MOVE ER-0844        TO  EMI-ERROR
 11155*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11156
 11157*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 11158     if (cl-critical-period = zeros)
 11159        or (WS-SPECIAL-CALC-CD NOT = 'C')
 11160          GO TO 1200-EDIT-FIND-TOLERANCES.
 11161
 11162     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 11163     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 11164     MOVE '1'        TO DC-OPTION-CODE.
 11165     MOVE +0         TO DC-ELAPSED-DAYS
 11166                        DC-ELAPSED-MONTHS.
 11167     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11168
 11169*    IF NO-CONVERSION-ERROR
 11170*       COMPUTE ws-benefits-paid =
 11171*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 11172*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 11173*           MOVE ER-0657 TO EMI-ERROR
 11174*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11175
 11176     GO TO 1200-EDIT-FIND-TOLERANCES.
 11177
 11178 1165-PAID-THRU-ERROR.
 11179     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11180
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 211
* EL156.cbl
 11181     IF EMI-MESSAGE-FORMATTED
 11182         MOVE -1                 TO EPYTHRUL
 11183         MOVE AL-UNBON           TO EPYTHRUA.
 11184
 11185 1165-EXIT.
 11186     EXIT.
 11187
 11188 1166-CHECK-ALL-TRLRS.
 11189
 11190     IF PI-PMTTYPE = '4'
 11191        GO TO 1166-TRLR-EXIT.
 11192
 11193     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11194
 11195     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11196        WS-SV-EPYFROM = LOW-VALUES
 11197          GO TO 1166-END-CHECK.
 11198
 11199
 11200* EXEC CICS HANDLE CONDITION
 11201*        ENDFILE   (1166-END-CHECK)
 11202*        NOTFND    (1166-END-CHECK)
 11203*    END-EXEC.
 11204*    MOVE '"$''I                  ! ) #00010783' TO DFHEIV0
 11205     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11206     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11207     MOVE X'2920233030303130373833' TO DFHEIV0(25:11)
 11208     CALL 'kxdfhei1' USING DFHEIV0
 11209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11210
 11211
 11212     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11213     MOVE +100                   TO TRLR-SEQ-NO.
 11214
 11215
 11216* EXEC CICS STARTBR
 11217*         DATASET    ('ELTRLR')
 11218*         RIDFLD     (ELTRLR-KEY)
 11219*         GTEQ
 11220*    END-EXEC.
 11221     MOVE 'ELTRLR' TO DFHEIV1
 11222     MOVE 0
 11223       TO DFHEIV11
 11224*    MOVE '&,         G          &   #00010791' TO DFHEIV0
 11225     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11226     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11227     MOVE X'2020233030303130373931' TO DFHEIV0(25:11)
 11228     CALL 'kxdfhei1' USING DFHEIV0,
 11229           DFHEIV1,
 11230           ELTRLR-KEY,
 11231           DFHEIV99,
 11232           DFHEIV11,
 11233           DFHEIV99
 11234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11235
 11236
 11237     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11238
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 212
* EL156.cbl
 11239 1166-READ-TRLR-NEXT.
 11240
 11241
 11242* EXEC CICS READNEXT
 11243*         DATASET    ('ELTRLR')
 11244*         RIDFLD     (ELTRLR-KEY)
 11245*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 11246*    END-EXEC.
 11247     MOVE 'ELTRLR' TO DFHEIV1
 11248     MOVE 0
 11249       TO DFHEIV11
 11250*    MOVE '&.S                   )   #00010801' TO DFHEIV0
 11251     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11252     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11253     MOVE X'2020233030303130383031' TO DFHEIV0(25:11)
 11254     CALL 'kxdfhei1' USING DFHEIV0,
 11255           DFHEIV1,
 11256           DFHEIV20,
 11257           DFHEIV99,
 11258           ELTRLR-KEY,
 11259           DFHEIV99,
 11260           DFHEIV11,
 11261           DFHEIV99,
 11262           DFHEIV99
 11263     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11264         DFHEIV20
 11265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11266
 11267
 11268     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11269        TRLR-CARRIER  = MSTR-CARRIER  AND
 11270        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11271        TRLR-CERT-NO  = MSTR-CERT-NO
 11272          NEXT SENTENCE
 11273      ELSE
 11274          GO TO 1166-END-CHECK.
 11275
 11276* **  BYPASS ALL NON-PAYMENT TRAILERS
 11277
 11278     IF AT-TRAILER-TYPE = '2'
 11279        NEXT SENTENCE
 11280     ELSE
 11281        GO TO 1166-READ-TRLR-NEXT.
 11282
 11283* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11284
 11285     IF AT-PAYMENT-TYPE = '1' OR '2'
 11286        NEXT SENTENCE
 11287     ELSE
 11288        GO TO 1166-READ-TRLR-NEXT.
 11289
 11290* **  BYPASS ALL VOID PAYMENTS
 11291
 11292     IF AT-VOID-DT NOT = LOW-VALUES
 11293        GO TO 1166-READ-TRLR-NEXT.
 11294
 11295     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11296        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 213
* EL156.cbl
 11297          GO TO 1166-READ-TRLR-NEXT.
 11298
 11299     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11300         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11301            OR
 11302        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11303         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 11304        NEXT SENTENCE
 11305     ELSE
 11306         IF CL-TOTAL-PAID-AMT > ZEROS
 11307             MOVE ER-0502            TO EMI-ERROR
 11308             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11309             MOVE -1                 TO EPYTHRUL
 11310             MOVE AL-UNBON           TO EPYTHRUA.
 11311
 11312     GO TO 1166-READ-TRLR-NEXT.
 11313
 11314 1166-END-CHECK.
 11315
 11316     IF WS-BROWSE-TRLR-SW = 'Y'
 11317
 11318* EXEC CICS ENDBR
 11319*            DATASET   ('ELTRLR')
 11320*       END-EXEC.
 11321     MOVE 'ELTRLR' TO DFHEIV1
 11322     MOVE 0
 11323       TO DFHEIV11
 11324*    MOVE '&2                    $   #00010856' TO DFHEIV0
 11325     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11326     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11327     MOVE X'2020233030303130383536' TO DFHEIV0(25:11)
 11328     CALL 'kxdfhei1' USING DFHEIV0,
 11329           DFHEIV1,
 11330           DFHEIV11,
 11331           DFHEIV99
 11332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11333
 11334
 11335     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11336
 11337 1166-TRLR-EXIT.
 11338     EXIT.
 11339
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 214
* EL156.cbl
 11341 1170-PAID-THRU-FATAL-ERROR.
 11342     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11343
 11344     MOVE -1                     TO EPYTHRUL.
 11345     MOVE AL-UNBON               TO EPYTHRUA.
 11346
 11347 1200-EDIT-FIND-TOLERANCES.
 11348
 11349* EXEC CICS HANDLE CONDITION
 11350*        ENDFILE(1950-NOT-FOUND)
 11351*        NOTFND (1950-NOT-FOUND)
 11352*    END-EXEC.
 11353*    MOVE '"$''I                  ! * #00010873' TO DFHEIV0
 11354     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11355     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11356     MOVE X'2A20233030303130383733' TO DFHEIV0(25:11)
 11357     CALL 'kxdfhei1' USING DFHEIV0
 11358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11359
 11360
 11361     IF PI-PROCESSOR-ID = 'LGXX'
 11362        GO TO 1240-FIND-ACCT-TOLERANCES.
 11363
 11364     MOVE 'N'                    TO FOUND-TOL-SW.
 11365     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11366     MOVE '2'                    TO CNTL-REC-TYPE.
 11367     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11368     MOVE +0                     TO CNTL-SEQ-NO.
 11369     MOVE 'PROC'                 TO FILE-SWITCH.
 11370
 11371     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11372
 11373     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11374     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11375                                    PI-MAX-PMT-TOL.
 11376     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11377
 11378     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11379         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11380
 11381     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11382     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11383                                    PI-MAX-LF-PMT-TOL.
 11384
 11385     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11386         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11387
 11388     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11389                                    PI-MAX-EXP-PMT.
 11390
 11391 1240-FIND-ACCT-TOLERANCES.
 11392
 11393     IF WS-PMT-TOL NOT = +0
 11394         MOVE 'Y'                TO FOUND-TOL-SW.
 11395
 11396     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11397         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11398         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 215
* EL156.cbl
 11399         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11400         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11401         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11402         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11403     ELSE
 11404         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11405         MOVE PI-CARRIER             TO ACCT-CARRIER
 11406         MOVE PI-GROUPING            TO ACCT-GROUPING
 11407         MOVE PI-STATE               TO ACCT-STATE
 11408         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11409         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11410
 11411     MOVE 'ACCT'                 TO FILE-SWITCH.
 11412
 11413     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11414     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11415
 11416
 11417* EXEC CICS HANDLE CONDITION
 11418*         NOTFND   (1950-NOT-FOUND)
 11419*         ENDFILE  (1950-NOT-FOUND)
 11420*    END-EXEC.
 11421*    MOVE '"$I''                  ! + #00010933' TO DFHEIV0
 11422     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11423     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11424     MOVE X'2B20233030303130393333' TO DFHEIV0(25:11)
 11425     CALL 'kxdfhei1' USING DFHEIV0
 11426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11427
 11428
 11429
 11430* EXEC CICS STARTBR
 11431*        DATASET('ERACCT')
 11432*        RIDFLD (ERACCT-KEY)
 11433*        GTEQ
 11434*    END-EXEC.
 11435     MOVE 'ERACCT' TO DFHEIV1
 11436     MOVE 0
 11437       TO DFHEIV11
 11438*    MOVE '&,         G          &   #00010938' TO DFHEIV0
 11439     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11440     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11441     MOVE X'2020233030303130393338' TO DFHEIV0(25:11)
 11442     CALL 'kxdfhei1' USING DFHEIV0,
 11443           DFHEIV1,
 11444           ERACCT-KEY,
 11445           DFHEIV99,
 11446           DFHEIV11,
 11447           DFHEIV99
 11448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11449
 11450
 11451 1245-FIND-ACCT-TOLERANCES-LOOP.
 11452
 11453
 11454* EXEC CICS READNEXT
 11455*        DATASET('ERACCT')
 11456*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 216
* EL156.cbl
 11457*        RIDFLD (ERACCT-KEY)
 11458*    END-EXEC.
 11459     MOVE 'ERACCT' TO DFHEIV1
 11460     MOVE 0
 11461       TO DFHEIV11
 11462*    MOVE '&.S                   )   #00010946' TO DFHEIV0
 11463     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11464     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11465     MOVE X'2020233030303130393436' TO DFHEIV0(25:11)
 11466     CALL 'kxdfhei1' USING DFHEIV0,
 11467           DFHEIV1,
 11468           DFHEIV20,
 11469           DFHEIV99,
 11470           ERACCT-KEY,
 11471           DFHEIV99,
 11472           DFHEIV11,
 11473           DFHEIV99,
 11474           DFHEIV99
 11475     SET ADDRESS OF ACCOUNT-MASTER TO
 11476         DFHEIV20
 11477     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11478
 11479
 11480     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11481        IF WS-ERACCT-HOLD-RECORD = SPACES
 11482           GO TO 1950-NOT-FOUND
 11483        ELSE
 11484           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11485           GO TO 1250-CONTINUE.
 11486
 11487     IF ACCT-EXP-DT = HIGH-VALUES
 11488        NEXT SENTENCE
 11489     ELSE
 11490        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11491        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11492
 11493 1250-CONTINUE.
 11494
 11495     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11496
 11497     IF FOUND-TOL-SW = 'N'
 11498         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11499
 11500********* 1260-FIND-STATE-TOLERANCES.
 11501
 11502     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11503     MOVE PI-STATE               TO WS-ST-ACCESS.
 11504     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11505     MOVE '3'                    TO CNTL-REC-TYPE.
 11506     MOVE +0                     TO CNTL-SEQ-NO.
 11507     MOVE 'STAT'                 TO FILE-SWITCH.
 11508
 11509     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11510
 11511     IF WS-PMT-TOL = +0
 11512         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11513
 11514     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 217
* EL156.cbl
 11515     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11516     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11517     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11518     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11519
 11520****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11521****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11522     IF PI-PAYEE-TYPE <> 'B'
 11523           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11524     END-IF.
 11525
 11526     IF PI-PMTTYPE      = '2'  AND
 11527        PI-SPLIT-PMT-SW = 'Y'  AND
 11528        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11529          MOVE ER-3530                TO EMI-ERROR
 11530          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11531
 11532********* 1280-FIND-BENEFIT-TOLERANCES.
 11533
 11534     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11535        OR (PI-PMTTYPE = '5' OR '6')
 11536         GO TO 1300-FIND-CARR-TOLERANCES.
 11537
 11538     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11539     MOVE '4'                    TO CNTL-REC-TYPE.
 11540     MOVE +0                     TO CNTL-SEQ-NO.
 11541     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11542     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11543     MOVE 'BENE'                 TO FILE-SWITCH.
 11544
 11545     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11546
 11547     IF NO-BENEFIT-FOUND
 11548         GO TO 1950-NOT-FOUND.
 11549
 11550     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11551     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11552     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11553
 11554
 11555* EXEC CICS HANDLE CONDITION
 11556*        NOTFND(1950-NOT-FOUND)
 11557*    END-EXEC.
 11558*    MOVE '"$I                   ! , #00011026' TO DFHEIV0
 11559     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11560     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11561     MOVE X'2C20233030303131303236' TO DFHEIV0(25:11)
 11562     CALL 'kxdfhei1' USING DFHEIV0
 11563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11564
 11565
 11566 1300-FIND-CARR-TOLERANCES.
 11567     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11568     MOVE '6'                    TO CNTL-REC-TYPE.
 11569
 11570     IF CONTROL-IS-ACTUAL-CARRIER
 11571         MOVE PI-CARRIER               TO WS-CARR
 11572     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 218
* EL156.cbl
 11573         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11574
 11575     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11576     MOVE +0                     TO CNTL-SEQ-NO.
 11577     MOVE 'CARR'                 TO FILE-SWITCH.
 11578
 11579     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11580
 11581     IF WS-DAYS-TOL = +0
 11582         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11583
 11584     IF WS-PMT-TOL = +0
 11585         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11586
 11587     IF WS-MAX-DAYS-TOL = +0
 11588         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11589
 11590     IF WS-MAX-PMT-TOL = +0
 11591         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11592                                    PI-MAX-PMT-TOL.
 11593
 11594     IF WS-MAX-LF-PMT-TOL = +0
 11595        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11596                                    PI-MAX-LF-PMT-TOL.
 11597
 11598     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11599
 11600********* 1320-FIND-COMP-TOLERANCES.
 11601
 11602     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11603     MOVE '1'                    TO CNTL-REC-TYPE.
 11604     MOVE SPACES                 TO CNTL-ACCESS.
 11605     MOVE +0                     TO CNTL-SEQ-NO.
 11606     MOVE 'COMP'                 TO FILE-SWITCH.
 11607
 11608     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11609
 11610     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11611     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11612
 11613     IF WS-PMT-TOL NOT = +0
 11614        IF WS-TOL-SEVERITY NOT = ' '
 11615         GO TO 1360-EDIT-DAYS.
 11616
 11617     IF WS-PMT-TOL = +0
 11618         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11619
 11620     IF WS-TOL-SEVERITY = ' '
 11621         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11622
 11623 1360-EDIT-DAYS.
 11624     IF PI-PMTTYPE NOT = '4'
 11625        IF PI-EDAYS NEGATIVE OR
 11626           PI-EPYAMT NEGATIVE
 11627          MOVE ER-0513             TO EMI-ERROR
 11628          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11629          MOVE -1                  TO PMTTYPEL.
 11630
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 219
* EL156.cbl
 11631     IF PI-PMTTYPE = '5' OR '6'
 11632        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11633
 11634     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11635        IF PI-PMTTYPE = '4'
 11636          MOVE PI-EDAYS          TO PI-CDAYS.
 11637
 11638     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11639         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11640
 11641     IF PI-PMTTYPE = '4'
 11642        MOVE PI-EDAYS            TO PI-CDAYS
 11643        GO TO 1400-EDIT-PAYMENT.
 11644
 11645     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11646        GO TO 1500-EDIT-EXPENSES.
 11647
 11648*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11649*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11650*          CM-AH-BENEFIT-CD = '23'              AND
 11651*          CL-CERT-STATE    = '04'              AND
 11652*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11653*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11654*            GO TO 1362-CHECK-MAX-DAYS.
 11655
 11656     IF PI-EDAYS = ZEROS
 11657*        IF PI-COMPANY-ID = 'DMD'
 11658*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11659*            MOVE -1             TO DC-ELAPSED-DAYS
 11660*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11661*            MOVE '6'            TO DC-OPTION-CODE
 11662*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11663*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11664*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11665*            MOVE '1'            TO DC-OPTION-CODE
 11666*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11667*            IF NO-CONVERSION-ERROR
 11668*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11669*                                 + DC-ODD-DAYS-OVER
 11670*               MOVE 6           TO EDAYSL
 11671*               MOVE AL-UNNON    TO EDAYSA
 11672*            ELSE
 11673*                NEXT SENTENCE
 11674*       ELSE
 11675            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11676            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11677            MOVE '1'             TO DC-OPTION-CODE
 11678            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11679            IF NO-CONVERSION-ERROR
 11680                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11681                ADD 1                 TO PI-EDAYS
 11682                MOVE AL-UNNON         TO EDAYSA.
 11683
 11684*    IF PI-COMPANY-ID = 'DMD'
 11685*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11686*        MOVE -1                 TO DC-ELAPSED-DAYS
 11687*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11688*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 220
* EL156.cbl
 11689*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11690*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11691*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11692*        MOVE '1'                TO DC-OPTION-CODE
 11693*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11694*    ELSE
 11695         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11696         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11697         MOVE '1'                TO DC-OPTION-CODE.
 11698         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11699
 11700     IF NO-CONVERSION-ERROR
 11701        IF PI-COMPANY-ID = 'DMD'
 11702            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11703                             + DC-ODD-DAYS-OVER
 11704        ELSE
 11705            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11706            ADD 1                TO PI-CDAYS.
 11707
 11708     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11709        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11710        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11711
 11712     IF PI-EDAYS NOT NUMERIC
 11713         MOVE ER-0491            TO EMI-ERROR
 11714         GO TO 1370-DAYS-ERROR.
 11715
 11716     IF CL-NO-OF-PMTS-MADE = 0
 11717        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11718        AND CL-CERT-STATE = 'MI'
 11719        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11720            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11721     END-IF.
 11722
 11723 1362-CHECK-MAX-DAYS.
 11724
 11725     IF WS-MAX-DAYS-TOL = +999
 11726         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11727
 11728     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11729         IF PI-EDAYS = ZEROS
 11730             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11731         ELSE
 11732             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11733
 11734     IF WS-MAX-DAYS-TOL NOT = ZERO
 11735        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11736           PI-CDAYS > WS-MAX-DAYS-TOL
 11737             MOVE ER-0492          TO EMI-ERROR
 11738             GO TO 1370-DAYS-ERROR.
 11739
 11740 1365-SKIP-MAX-DAYS-EDIT.
 11741     IF PI-EDAYS = ZEROS
 11742        GO TO 1400-EDIT-PAYMENT.
 11743
 11744     IF WS-DAYS-TOL NOT = ZERO
 11745        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11746           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 221
* EL156.cbl
 11747                MOVE ER-0493     TO EMI-ERROR
 11748                GO TO 1370-DAYS-ERROR.
 11749
 11750     GO TO 1400-EDIT-PAYMENT.
 11751
 11752 1370-DAYS-ERROR.
 11753     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11754
 11755     IF EMI-MESSAGE-FORMATTED
 11756         MOVE -1                 TO EDAYSL
 11757         MOVE AL-UABON           TO EDAYSA.
 11758
 11759     GO TO 1400-EDIT-PAYMENT.
 11760
 11761 1380-EDIT-EXPENSE-PMT-AMT.
 11762     IF PI-PMTTYPE = '5' OR '6'
 11763         NEXT SENTENCE
 11764     ELSE
 11765         GO TO 1400-EDIT-PAYMENT.
 11766
 11767     IF WS-MAX-EXP-PMT NOT = ZEROS
 11768        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11769            MOVE ER-3529            TO EMI-ERROR
 11770            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11771
 11772     GO TO 1500-EDIT-EXPENSES.
 11773
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 222
* EL156.cbl
 11775
 11776 1390-CHECK-PAYMENT-DAYS.
 11777
 11778     IF PI-EDAYS = 0
 11779         MOVE PI-CDAYS TO WS-PD-DAYS
 11780     ELSE
 11781         MOVE PI-EDAYS TO WS-PD-DAYS
 11782     END-IF.
 11783
 11784     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11785         IF WS-PD-DAYS = 14
 11786            GO TO 1390-EXIT
 11787         END-IF
 11788     END-IF.
 11789
 11790     IF PI-COMPANY-ID = 'AHL'  AND
 11791        CM-AH-BENEFIT-CD = '1K'
 11792         IF WS-PD-DAYS = 14
 11793            GO TO 1390-EXIT
 11794         END-IF
 11795     END-IF.
 11796
 11797     IF WS-PD-DAYS < 30
 11798         MOVE ER-3549              TO EMI-ERROR
 11799         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11800     END-IF.
 11801
 11802 1390-EXIT.
 11803      EXIT.
 11804
 11805 1400-EDIT-PAYMENT.
 11806*    IF PI-COMPANY-ID = 'DMD'
 11807*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11808*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11809
 11810     IF PI-COMPANY-ID = 'DCC' or 'CAP'
 11811        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11812        MOVE PI-CARRIER          TO ACCT-CARRIER
 11813        MOVE PI-GROUPING         TO ACCT-GROUPING
 11814        MOVE PI-STATE            TO ACCT-STATE
 11815        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11816        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11817        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11818        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11819
 11820
 11821* EXEC CICS READ
 11822*          DATASET ('ERACCT')
 11823*          RIDFLD  (ERACCT-KEY)
 11824*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11825*          GTEQ
 11826*          resp    (WS-RESPONSE)
 11827*       END-EXEC
 11828     MOVE 'ERACCT' TO DFHEIV1
 11829*    MOVE '&"S        G          (  N#00011284' TO DFHEIV0
 11830     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11831     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11832     MOVE X'204E233030303131323834' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 223
* EL156.cbl
 11833     CALL 'kxdfhei1' USING DFHEIV0,
 11834           DFHEIV1,
 11835           DFHEIV20,
 11836           DFHEIV99,
 11837           ERACCT-KEY,
 11838           DFHEIV99,
 11839           DFHEIV99,
 11840           DFHEIV99
 11841     SET ADDRESS OF ACCOUNT-MASTER TO
 11842         DFHEIV20
 11843     MOVE EIBRESP  TO WS-RESPONSE
 11844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11845        IF WS-RESP-NORMAL
 11846           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11847           and pi-cert-eff-dt < am-expiration-dt
 11848           and pi-cert-eff-dt >= am-effective-dt
 11849           move am-dcc-product-code to pi-dcc-product-code
 11850        else
 11851           move spaces           to pi-dcc-product-code
 11852        end-if
 11853        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11854           PERFORM 0900-GET-DDF-LIMITS
 11855                                 THRU 0900-EXIT
 11856           IF PDEF-FOUND
 11857              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11858                 (P1 > +8)
 11859                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11860              END-PERFORM
 11861              IF P1 < +9
 11862                 if pd-ben-pct (p1) not numeric
 11863                    move zeros   to pd-ben-pct (p1)
 11864                 end-if
 11865                 if pd-ben-pct (p1) = zeros
 11866                    move +1      to ws-work-ben-pct
 11867                 else
 11868                    move pd-ben-pct (p1)
 11869                                 to ws-work-ben-pct
 11870                 end-if
 11871                 compute cm-ah-benefit-amt =
 11872                    cm-ah-benefit-amt * ws-work-ben-pct
 11873                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11874                    move pd-max-amt (p1) to cm-ah-benefit-amt
 11875                 end-if
 11876              else
 11877                 move er-1674    to emi-error
 11878                 PERFORM 9900-ERROR-FORMAT
 11879                                 THRU 9900-EXIT
 11880              END-IF
 11881           else
 11882              move er-1672       to emi-error
 11883              PERFORM 9900-ERROR-FORMAT
 11884                                 THRU 9900-EXIT
 11885           END-IF
 11886        end-if
 11887     END-IF
 11888     IF PI-PMTTYPE NOT = '4'
 11889        GO TO 1405-CALC-PAYMENT.
 11890     IF PI-EDAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 224
* EL156.cbl
 11891         MOVE PI-EPYAMT           TO PI-CPYAMT
 11892         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11893         GO TO 1430-CHECK-AH-TOLERANCE.
 11894
 11895*    IF PI-COMPANY-ID = 'FIA'
 11896*       IF CERT-ACCOUNT = '0000011043'
 11897*        COMPUTE PI-DAILY-RATE ROUNDED =
 11898*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11899*        COMPUTE PI-CPYAMT ROUNDED =
 11900*                          PI-DAILY-RATE * PI-EDAYS
 11901*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11902*        GO TO 1430-CHECK-AH-TOLERANCE.
 11903
 11904     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11905         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11906         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 11907         GO TO 1420-CHECK-AIG-BENEFIT.
 11908
 11909     IF WS-CALC-METHOD = '2' OR  '5'
 11910         COMPUTE PI-DAILY-RATE ROUNDED =
 11911                        (CM-AH-BENEFIT-AMT * 12) / 365
 11912         COMPUTE PI-CPYAMT ROUNDED =
 11913                           PI-DAILY-RATE * PI-EDAYS
 11914        GO TO 1420-CHECK-AIG-BENEFIT.
 11915
 11916     IF WS-CALC-METHOD = '3'
 11917         COMPUTE PI-DAILY-RATE =
 11918                         (CM-AH-BENEFIT-AMT * 12) / 365
 11919         COMPUTE PI-CPYAMT ROUNDED =
 11920                           PI-DAILY-RATE * PI-EDAYS
 11921        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 225
* EL156.cbl
 11923*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11924
 11925****************************************************************
 11926****************************************************************
 11927*                  CALCULATED FROM      PAYMENT      PAYMENT
 11928*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11929* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11930*1-01-83  1-15-83    0    15     15        15           15
 11931*1-01-83  1-30-83    0    30     30        30           30
 11932*1-01-83  1-31-83    1     0     31        30           30
 11933*1-01-83  2-01-83    1     1     32        31           31
 11934*1-01-83  2-15-83    1    15     46        45           45
 11935*1-01-83  2-28-83    2     0     59        60           60
 11936*1-01-83  3-01-83    2     1     60        61           61
 11937*1-01-83  3-31-83    3     0     90        90           90
 11938*1-15-83  1-31-83    0    17     17        17           16
 11939*1-15-83  2-01-83    0    18     18        18           17
 11940*1-15-83  2-28-83    1    14     45        44           46
 11941*1-21-83  3-09-83    1    20     48        50           49
 11942*2-05-83  3-06-83    1     2     30        32           32
 11943*2-05-83  3-23-83    1    19     47        49           49
 11944*2-15-83  2-28-83    0    14     14        14           16
 11945*2-15-83  3-01-83    0    15     15        15           17
 11946*2-21-83  3-19-83    0    27     27        27           29
 11947*2-21-83  3-20-83    1     0     28        30           30
 11948*2-21-83  4-10-83    1    18     49        30           50
 11949*2-21-83  5-19-83    2    27     88        87           89
 11950*2-21-83  5-22-83    3     2     91        92           92
 11951*3-21-83  5-19-83    1    30     60        60           59
 11952****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 226
* EL156.cbl
 11954 1405-CALC-PAYMENT.
 11955     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11956     MOVE ' '                    TO DC-OPTION-CODE.
 11957     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11958     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11959     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11960
 11961     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11962     MOVE ' '                    TO DC-OPTION-CODE.
 11963     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11964     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11965     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11966
 11967     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11968     MOVE -1                     TO DC-ELAPSED-DAYS.
 11969     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11970     MOVE '6'                    TO DC-OPTION-CODE.
 11971     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11972     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11973
 11974     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11975     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11976     MOVE '1'                    TO DC-OPTION-CODE.
 11977     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11978
 11979     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11980     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11981     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11982
 11983******************************************************************
 11984*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11985*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11986*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11987******************************************************************
 11988
 11989     IF WS-CALC-METHOD = '1'           AND
 11990        DC-ELAPSED-MONTHS > ZERO AND
 11991        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11992        WDF-DAY > WDT-DAY
 11993          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11994          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11995          MOVE -1                  TO DC-ELAPSED-MONTHS
 11996          MOVE '6'                 TO DC-OPTION-CODE
 11997          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11998          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11999          COMPUTE WS-SAVE-ODD-DAYS =
 12000          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 12001          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 12002
 12003     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 12004     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 12005     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 12006
 12007     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 12008     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 12009
 12010*    IF PI-COMPANY-ID = 'FIA'
 12011*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 227
* EL156.cbl
 12012*        COMPUTE PI-DAILY-RATE ROUNDED =
 12013*                          (CM-AH-BENEFIT-AMT * 13) / 365
 12014*        COMPUTE PI-CPYAMT ROUNDED =
 12015*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 12016*        GO TO 1420-CHECK-AIG-BENEFIT.
 12017
 12018*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12019*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 12020*          CM-AH-BENEFIT-CD = '23'               AND
 12021*          CL-CERT-STATE    = '04'               AND
 12022*         (PI-PMTTYPE = '1' OR '2' OR '3')
 12023*            COMPUTE WS-DAILY-RATE ROUNDED =
 12024*                               CM-AH-BENEFIT-AMT / 30
 12025*            COMPUTE PI-CPYAMT ROUNDED =
 12026*                               (WS-DAILY-RATE * PI-CDAYS)
 12027*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12028*            GO TO 1420-CHECK-AIG-BENEFIT.
 12029
 12030     IF WS-CALC-METHOD = '1'
 12031         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 12032         COMPUTE PI-CPYAMT ROUNDED =
 12033             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12034             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12035         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 12036         GO TO 1420-CHECK-AIG-BENEFIT.
 12037
 12038     IF WS-CALC-METHOD = '2'
 12039         COMPUTE PI-DAILY-RATE ROUNDED =
 12040                          (CM-AH-BENEFIT-AMT * 12) / 365
 12041         COMPUTE PI-CPYAMT ROUNDED =
 12042             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12043             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12044         GO TO 1420-CHECK-AIG-BENEFIT.
 12045
 12046     IF WS-CALC-METHOD = '4'
 12047         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 12048         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 12049         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12050         COMPUTE PI-CPYAMT ROUNDED =
 12051                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 12052         GO TO 1420-CHECK-AIG-BENEFIT.
 12053
 12054     IF WS-CALC-METHOD = '5'
 12055         COMPUTE PI-DAILY-RATE ROUNDED =
 12056                            (CM-AH-BENEFIT-AMT * 12) / 365
 12057         COMPUTE PI-CPYAMT ROUNDED =
 12058                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 12059         GO TO 1420-CHECK-AIG-BENEFIT.
 12060
 12061     IF WS-CALC-METHOD NOT = '3'
 12062        GO TO 1410-CHECK-PAYMENT.
 12063
 12064******   CALCULATION METHOD  3  ROUTINE
 12065     COMPUTE PI-DAILY-RATE =
 12066                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 12067
 12068******CHECK TO SEE IF WITHIN SAME MONTH
 12069     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 228
* EL156.cbl
 12070        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 12071                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 12072         GO TO 1420-CHECK-AIG-BENEFIT.
 12073
 12074******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 12075     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 12076             SAVE-ODD-DAYS-OVER = ZEROS
 12077      COMPUTE PI-CPYAMT  ROUNDED =
 12078                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 12079      GO TO 1420-CHECK-AIG-BENEFIT.
 12080
 12081******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 12082******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 12083     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12084        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 12085        IF WDF-MONTH > 12
 12086           ADD 1                 TO WDF-YEAR
 12087           SUBTRACT 12         FROM WDF-MONTH.
 12088
 12089******CONVERT THE NEW FROM MONTH TO BINARY
 12090     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12091        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 12092        MOVE '4'              TO DC-OPTION-CODE
 12093        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12094        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 12095
 12096     IF WDF-MONTH = WDT-MONTH AND
 12097        WDF-YEAR  = WDT-YEAR
 12098          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 12099                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 12100                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 12101        ELSE
 12102          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 12103          MOVE WDT-DAY              TO THRU-PMT-DAYS
 12104          COMPUTE PI-CPYAMT ROUNDED =
 12105       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 12106       +
 12107       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 12108       +
 12109       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 12110
 12111     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 229
* EL156.cbl
 12113 1410-CHECK-PAYMENT.
 12114******PAYMENT OPTION 6
 12115******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 12116     IF SAVE-ELAPSED-MONTHS > ZERO
 12117        IF SAVE-ODD-DAYS-OVER = ZEROS
 12118           GO TO 1412-CHECK-TO-DAY
 12119        ELSE
 12120           IF WDF-DAY > WDT-DAY
 12121              IF WDF-MONTH = 02
 12122                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12123                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 12124                  GO TO 1412-CHECK-TO-DAY
 12125              ELSE
 12126                  IF FROM-DAYS-IN-MONTH = 31
 12127                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 12128                     GO TO 1412-CHECK-TO-DAY
 12129                  ELSE
 12130                     GO TO 1412-CHECK-TO-DAY
 12131           ELSE
 12132               GO TO 1412-CHECK-TO-DAY.
 12133
 12134     IF WDF-MONTH NOT = WDT-MONTH
 12135        IF WDF-MONTH = 02
 12136           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12137           IF WDF-DAY = 29
 12138              ADD 1              TO SAVE-ODD-DAYS-OVER
 12139           ELSE
 12140              ADD 2              TO SAVE-ODD-DAYS-OVER
 12141        ELSE
 12142           IF FROM-DAYS-IN-MONTH = 31
 12143              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12144
 12145 1412-CHECK-TO-DAY.
 12146        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 12147           IF WDT-DAY = 28
 12148              ADD 2              TO SAVE-ODD-DAYS-OVER
 12149           ELSE
 12150              IF WDT-DAY = 29
 12151                 ADD 1           TO SAVE-ODD-DAYS-OVER
 12152              ELSE
 12153                 NEXT SENTENCE
 12154        ELSE
 12155           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 12156              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12157
 12158     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 12159     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 12160     COMPUTE PI-CPYAMT ROUNDED =
 12161         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 12162         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 12163
 12164     GO TO 1420-CHECK-AIG-BENEFIT.
 12165
 12166 1415-CHECK-LEAP-YEAR.
 12167     IF FROM-DAYS-IN-MONTH = 29
 12168        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 12169
 12170 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 230
* EL156.cbl
 12171     EXIT.
 12172
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 231
* EL156.cbl
 12174 1420-CHECK-AIG-BENEFIT.
 12175
 12176     IF WS-SPECIAL-CALC-CD = 'Q'
 12177         GO TO 1425-CHECK-WHOLE-MONTH.
 12178
 12179*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 12180*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 12181*       (CL-NO-OF-PMTS-MADE < +6)          AND
 12182*       (PI-PMTTYPE = '1' OR '2')
 12183*        NEXT SENTENCE
 12184*    ELSE
 12185         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 12186         GO TO 1430-CHECK-AH-TOLERANCE.
 12187
 12188******************AIG LOGIC STARTS**********************
 12189*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 12190*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 12191*    MOVE ER-3533      TO EMI-ERROR.
 12192*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12193*    GO TO 1430-CHECK-AH-TOLERANCE.
 12194******************AIG LOGIC ENDS************************
 12195
 12196 1425-CHECK-WHOLE-MONTH.
 12197******************************************************************
 12198****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 12199****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12200****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12201****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12202****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12203****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12204****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12205****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12206****          PAID * MONTHLY BENEFIT.                         ****
 12207******************************************************************
 12208
 12209     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12210
 12211     IF CL-NO-OF-PMTS-MADE > +0
 12212         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12213
 12214     IF PI-CDAYS < WS-BEN-DAYS
 12215         GO TO 1430-CHECK-AH-TOLERANCE.
 12216
 12217     IF PI-CDAYS = WS-BEN-DAYS
 12218         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12219         GO TO 1430-CHECK-AH-TOLERANCE.
 12220
 12221*    IF PI-COMPANY-ID = 'ACM'
 12222*       NEXT SENTENCE
 12223*    ELSE
 12224        GO TO 1425-NOT-ACM-W15C.
 12225
 12226*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12227*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12228*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12229*    MOVE '6'                    TO  DC-OPTION-CODE.
 12230*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12231*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 232
* EL156.cbl
 12232*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12233*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12234*       MOVE '1'                 TO  DC-OPTION-CODE
 12235*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12236*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12237*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12238*       IF NO-CONVERSION-ERROR
 12239*          IF (DC-ELAPSED-MONTHS > +0) OR
 12240*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12241*             NEXT SENTENCE
 12242*          ELSE
 12243*             MOVE +0            TO  PI-CPYAMT
 12244*             MOVE ER-0846       TO  EMI-ERROR
 12245*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12246*             GO TO 1430-CHECK-AH-TOLERANCE
 12247*       ELSE
 12248*           MOVE ER-0846         TO  EMI-ERROR
 12249*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12250*           GO TO 1430-CHECK-AH-TOLERANCE.
 12251*
 12252*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12253*       ADD +1 TO DC-ELAPSED-MONTHS.
 12254*
 12255*    COMPUTE PI-CPYAMT ROUNDED =
 12256*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12257*
 12258*    GO TO 1430-CHECK-AH-TOLERANCE.
 12259
 12260 1425-NOT-ACM-W15C.
 12261
 12262     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12263     MOVE '6'                        TO  DC-OPTION-CODE.
 12264     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12265     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12266
 12267     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12268     IF NO-CONVERSION-ERROR
 12269         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12270     ELSE
 12271         MOVE ER-0846                TO  EMI-ERROR
 12272         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12273         GO TO 1430-CHECK-AH-TOLERANCE.
 12274
 12275     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12276     MOVE '1'                        TO  DC-OPTION-CODE.
 12277     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12278     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12279     IF NO-CONVERSION-ERROR
 12280         IF DC-ODD-DAYS-OVER = +0
 12281             NEXT SENTENCE
 12282         ELSE
 12283             MOVE ER-0846            TO  EMI-ERROR
 12284             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12285             GO TO 1430-CHECK-AH-TOLERANCE
 12286     ELSE
 12287         MOVE ER-0846                TO  EMI-ERROR
 12288         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12289         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 233
* EL156.cbl
 12290
 12291     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12292         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12293
 12294     GO TO 1430-CHECK-AH-TOLERANCE.
 12295
 12296 1425-CONT-WHOLE-MONTH-PMTS.
 12297******************************************************************
 12298****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12299****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12300****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12301******************************************************************
 12302
 12303     IF PI-COMPANY-ID = 'ACM'
 12304        NEXT SENTENCE
 12305     ELSE
 12306        IF DC-ODD-DAYS-OVER = +0
 12307            NEXT SENTENCE
 12308        ELSE
 12309            MOVE ER-0845            TO  EMI-ERROR
 12310            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12311            GO TO 1430-CHECK-AH-TOLERANCE.
 12312
 12313     COMPUTE PI-CPYAMT ROUNDED =
 12314                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12315
 12316 1430-CHECK-AH-TOLERANCE.
 12317     IF PI-PMT-APPR-SW = 'G'
 12318         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12319
 12320*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12321*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12322*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12323*
 12324*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12325*      IF WDF-MONTH = 02
 12326*        IF SAVE-ELAPSED-MONTHS = 0
 12327*          NEXT SENTENCE
 12328*        ELSE
 12329*          IF SAVE-ODD-DAYS-OVER > 0
 12330*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12331*            COMPUTE WS-PMT-MOS ROUNDED =
 12332*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12333*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12334*                                     WS-PMT-MOS
 12335*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12336*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12337*          ELSE
 12338*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12339*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12340*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12341*                                     WS-PMT-MOS.
 12342
 12343     IF WS-MAX-PMT-TOL NOT = ZERO
 12344        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12345           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12346            MOVE ER-0494         TO  EMI-ERROR
 12347            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 234
* EL156.cbl
 12348            GO TO 1500-EDIT-EXPENSES.
 12349
 12350 1430-CONT-CHECK-AH-TOLERANCE.
 12351
 12352     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12353        GO TO 1500-EDIT-EXPENSES.
 12354
 12355     IF CM-O-B-COVERAGE
 12356        GO TO 1500-EDIT-EXPENSES.
 12357
 12358     IF PI-COMPANY-ID = 'NCL'
 12359       IF FOUND-TOL-SW = 'Y'
 12360         IF WS-PMT-TOL NOT = ZERO
 12361           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12362              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12363                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12364                  IF WS-NCL-PMT-OPTION = SPACES
 12365                      MOVE ER-0699 TO EMI-ERROR
 12366                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12367                  ELSE
 12368                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12369                      NEXT SENTENCE
 12370                  ELSE
 12371                  IF NOT WS-VALID-NCL-OPTION
 12372                      MOVE ER-0699 TO EMI-ERROR
 12373                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12374
 12375     IF WS-PMT-TOL NOT = ZERO
 12376        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12377           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12378           MOVE ER-0495          TO EMI-ERROR
 12379           PERFORM 1490-PAYMENT-ERROR
 12380                                 THRU 1490-EXIT
 12381        end-if
 12382     end-if
 12383
 12384     GO TO 1500-EDIT-EXPENSES.
 12385
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 235
* EL156.cbl
 12387 1440-COMPUTE-LIFE-REMAINING.
 12388
 12389     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12390        IF PI-PMTTYPE = '4'
 12391          MOVE PI-EPYAMT TO PI-CPYAMT
 12392          GO TO 1460-TEST-TYPE.
 12393
 12394     IF WS-LF-COVERAGE-TYPE = 'L'
 12395        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12396                          - CL-TOTAL-PAID-AMT
 12397        GO TO 1450-CHECK-MAX.
 12398
 12399     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12400        PI-LF-COVERAGE-TYPE = 'P'
 12401          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12402                              CM-LF-ITD-DEATH-AMT
 12403          GO TO 1450-CHECK-MAX.
 12404
 12405     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12406     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12407     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12408     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12409     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12410     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12411     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12412     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12413     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12414
 12415     PERFORM 9800-LINK-REM-TERM.
 12416
 12417     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12418     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12419     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12420     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12421     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12422     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12423     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12424     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12425     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12426     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12427     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12428     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12429     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12430     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12431     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12432     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12433     IF PI-COMPANY-ID = 'DCC' or 'CAP'
 12434        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12435        MOVE PI-CARRIER          TO ACCT-CARRIER
 12436        MOVE PI-GROUPING         TO ACCT-GROUPING
 12437        MOVE PI-STATE            TO ACCT-STATE
 12438        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12439        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12440        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12441        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12442
 12443
 12444* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 236
* EL156.cbl
 12445*          DATASET ('ERACCT')
 12446*          RIDFLD  (ERACCT-KEY)
 12447*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12448*          GTEQ
 12449*          resp    (WS-RESPONSE)
 12450*       END-EXEC
 12451     MOVE 'ERACCT' TO DFHEIV1
 12452*    MOVE '&"S        G          (  N#00011889' TO DFHEIV0
 12453     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12454     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12455     MOVE X'204E233030303131383839' TO DFHEIV0(25:11)
 12456     CALL 'kxdfhei1' USING DFHEIV0,
 12457           DFHEIV1,
 12458           DFHEIV20,
 12459           DFHEIV99,
 12460           ERACCT-KEY,
 12461           DFHEIV99,
 12462           DFHEIV99,
 12463           DFHEIV99
 12464     SET ADDRESS OF ACCOUNT-MASTER TO
 12465         DFHEIV20
 12466     MOVE EIBRESP  TO WS-RESPONSE
 12467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12468        IF WS-RESP-NORMAL
 12469           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12470           and (pi-cert-eff-dt < am-expiration-dt)
 12471           and (pi-cert-eff-dt >= am-effective-dt)
 12472           move am-dcc-product-code to pi-dcc-product-code
 12473        else
 12474           move spaces           to pi-dcc-product-code
 12475        end-if
 12476        if pi-dcc-product-code not = spaces
 12477           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12478           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12479           PERFORM 0900-GET-DDF-limits
 12480                                 THRU 0900-EXIT
 12481           IF PDEF-FOUND
 12482              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12483                 (P1 > +8)
 12484                 OR (PD-PROD-CODE (P1) = 'L')
 12485              END-PERFORM
 12486              IF P1 < +9
 12487                 MOVE PD-MAX-AMT (P1)
 12488                                 TO CP-R-MAX-TOT-BEN
 12489              else
 12490                 move er-1674    to emi-error
 12491                 PERFORM 9900-ERROR-FORMAT
 12492                                 THRU 9900-EXIT
 12493              END-IF
 12494           else
 12495              move er-1672       to emi-error
 12496              PERFORM 9900-ERROR-FORMAT
 12497                                 THRU 9900-EXIT
 12498           END-IF
 12499        end-if
 12500     END-IF
 12501
 12502* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 237
* EL156.cbl
 12503*       PROGRAM  (LINK-REMAMT)
 12504*       COMMAREA (CALCULATION-PASS-AREA)
 12505*       LENGTH   (CP-COMM-LENGTH)
 12506*    END-EXEC.
 12507*    MOVE '."C                   (   #00011929' TO DFHEIV0
 12508     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12509     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12510     MOVE X'2020233030303131393239' TO DFHEIV0(25:11)
 12511     CALL 'kxdfhei1' USING DFHEIV0,
 12512           LINK-REMAMT,
 12513           CALCULATION-PASS-AREA,
 12514           CP-COMM-LENGTH,
 12515           DFHEIV99,
 12516           DFHEIV99,
 12517           DFHEIV99,
 12518           DFHEIV99
 12519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12520
 12521
 12522     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12523
 12524     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12525     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12526
 12527     IF PI-COMPANY-ID = 'BOA' AND
 12528        PI-PMTTYPE    = '2'   AND
 12529        PI-OFFLINE    = 'N'
 12530           GO TO 1441-COMPUTE-BOA-INTEREST.
 12531
 12532     IF PI-COMPANY-ID = 'NCL' AND
 12533        PI-PMTTYPE    = '2'   AND
 12534        PI-OFFLINE    = 'N'
 12535          GO TO 1442-COMPUTE-NCL-INTEREST
 12536       ELSE
 12537          GO TO 1445-CONTINUE.
 12538
 12539 1441-COMPUTE-BOA-INTEREST.
 12540     MOVE +0             TO WS-CALC-INT.
 12541
 12542     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12543     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12544     MOVE +0             TO DC-ELAPSED-MONTHS
 12545                            DC-ELAPSED-DAYS.
 12546     MOVE '1'            TO DC-OPTION-CODE.
 12547     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12548     IF NO-CONVERSION-ERROR
 12549         NEXT SENTENCE
 12550     ELSE
 12551         GO TO 1445-CONTINUE.
 12552
 12553     IF (PI-INT-RATE NOT > ZEROS)  AND
 12554        (DC-ELAPSED-DAYS > +30)
 12555         MOVE ER-3531            TO EMI-ERROR
 12556         MOVE -1                 TO PINTL
 12557         MOVE AL-UNBON           TO PINTA
 12558         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12559
 12560     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 238
* EL156.cbl
 12561         GO TO 1445-CONTINUE.
 12562
 12563     IF (PI-INT-RATE NOT > ZEROS)  OR
 12564        (DC-ELAPSED-DAYS NOT > +30)
 12565         MOVE PI-EPYAMT TO PI-CPYAMT
 12566         GO TO 1441-FORMAT-NOTE.
 12567
 12568     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12569                                 *  PI-INT-RATE
 12570                                 *  DC-ELAPSED-DAYS
 12571                                 /  365
 12572                                 /  100.
 12573
 12574     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12575
 12576 1441-FORMAT-NOTE.
 12577
 12578     MOVE SPACES        TO WS-BOANOTE1.
 12579     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12580     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12581     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12582     MOVE AL-UANON      TO NOTE1A.
 12583
 12584     IF WS-CALC-INT > ZEROS
 12585         MOVE SPACES        TO WS-BOANOTE2
 12586         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12587         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12588         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12589         MOVE AL-UANON      TO NOTE2A.
 12590
 12591     GO TO 1445-CONTINUE.
 12592
 12593 1442-COMPUTE-NCL-INTEREST.
 12594     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12595     MOVE PI-STATE               TO WS-ST-ACCESS.
 12596     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12597     MOVE '3'                    TO CNTL-REC-TYPE.
 12598     MOVE +0                     TO CNTL-SEQ-NO.
 12599     MOVE 'STAT'                 TO FILE-SWITCH.
 12600
 12601     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12602
 12603     MOVE +0                 TO WS-CALC-INT.
 12604
 12605     IF ST-STAT-FROM-INCURRED
 12606         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12607       ELSE
 12608     IF ST-STAT-FROM-REPORTED
 12609         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12610       ELSE
 12611         GO TO 1445-CONTINUE.
 12612
 12613     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12614     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12615     MOVE +0                 TO DC-ELAPSED-MONTHS
 12616                                DC-ELAPSED-DAYS.
 12617     MOVE '1'                TO DC-OPTION-CODE.
 12618     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 239
* EL156.cbl
 12619     IF NO-CONVERSION-ERROR
 12620         NEXT SENTENCE
 12621     ELSE
 12622         GO TO 1445-CONTINUE.
 12623
 12624     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12625        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12626         GO TO 1445-CONTINUE.
 12627
 12628     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12629                                 *  CF-ST-STAT-INTEREST.
 12630
 12631     MOVE SPACES              TO WS-NCLNOTE1.
 12632     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12633     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12634     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12635                                 PI-PMTNOTE1
 12636                                 NOTE1I.
 12637     MOVE AL-UANON            TO NOTE1A.
 12638
 12639     IF WS-CALC-INT > ZEROS
 12640         MOVE SPACES          TO WS-NCLNOTE2
 12641         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12642         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12643         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12644                                 PI-PMTNOTE2
 12645                                 NOTE2I
 12646         MOVE AL-UANON        TO NOTE2A.
 12647
 12648     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12649
 12650 1445-CONTINUE.
 12651
 12652     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12653        GO TO 1460-TEST-TYPE.
 12654
 12655     IF CM-O-B-COVERAGE
 12656        GO TO 1460-TEST-TYPE.
 12657
 12658     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12659         GO TO 1450-CHECK-MAX.
 12660
 12661     if (pi-company-id = 'DCC' or 'CAP')
 12662        and (pdef-found)
 12663        if pi-epyamt > pd-max-amt (p1)
 12664           move er-1657          to emi-error
 12665           perform 1490-payment-error
 12666                                 thru 1490-exit
 12667           go to 1460-test-type
 12668        end-if
 12669     else
 12670        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12671           > PI-EPYAMT)
 12672                         OR
 12673           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12674           < PI-EPYAMT)
 12675           MOVE ER-0594          TO EMI-ERROR
 12676           PERFORM 1490-PAYMENT-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 240
* EL156.cbl
 12677                                 THRU 1490-EXIT
 12678           GO TO 1460-TEST-TYPE
 12679        end-if
 12680     end-if
 12681     .
 12682 1450-CHECK-MAX.
 12683
 12684     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12685        PI-LF-COVERAGE-TYPE = 'P'
 12686         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12687                                   CM-LF-ITD-DEATH-AMT
 12688     ELSE
 12689         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12690                                   CL-TOTAL-PAID-AMT.
 12691
 12692     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12693          MOVE ER-0543           TO EMI-ERROR
 12694          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12695
 12696 1460-TEST-TYPE.
 12697
 12698     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12699        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12700           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12701                                   CM-LF-ALT-BENEFIT-AMT -
 12702                                   CL-TOTAL-PAID-AMT
 12703           IF PI-EPYAMT > WS-LF-BEN-AMT
 12704               MOVE ER-0543      TO EMI-ERROR
 12705               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12706           END-IF
 12707        END-IF
 12708     END-IF
 12709
 12710     IF PI-PMT-APPR-SW = 'G'
 12711       NEXT SENTENCE
 12712     ELSE
 12713       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12714         IF PI-EPYAMT = ZERO
 12715             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12716                 MOVE ER-0494    TO  EMI-ERROR
 12717                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12718                 GO TO 1500-EDIT-EXPENSES
 12719             ELSE
 12720                 NEXT SENTENCE
 12721         ELSE
 12722             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12723                 MOVE ER-0494    TO  EMI-ERROR
 12724                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12725                 GO TO 1500-EDIT-EXPENSES.
 12726
 12727     IF PI-PMTTYPE NOT = '2' OR
 12728        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12729         GO TO 1500-EDIT-EXPENSES.
 12730
 12731     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12732     MOVE ER-0526                TO EMI-ERROR.
 12733     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12734
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 241
* EL156.cbl
 12735     IF EMI-ERROR-NUMBER (1) = '0526'
 12736        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12737
 12738     IF EMI-ERROR-NUMBER (2) = '0526'
 12739        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12740
 12741     GO TO 1500-EDIT-EXPENSES.
 12742
 12743 1490-PAYMENT-ERROR.
 12744     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12745
 12746     IF EMI-MESSAGE-FORMATTED
 12747         MOVE -1                 TO EPYAMTL
 12748         MOVE AL-UNBON           TO EPYAMTA.
 12749
 12750 1490-EXIT.
 12751      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 242
* EL156.cbl
 12753 1500-EDIT-EXPENSES.
 12754     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12755         GO TO 1500-SKIP-ERROR-0556.
 12756
 12757 1500-CONTINUE-ON.
 12758
 12759     IF CM-O-B-COVERAGE
 12760        MOVE ER-0556             TO EMI-ERROR
 12761        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12762
 12763 1500-SKIP-ERROR-0556.
 12764     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12765        IF PI-EEXPENS NOT = ZEROS
 12766           MOVE ER-0524          TO EMI-ERROR
 12767           GO TO 1590-EXPENSE-ERROR
 12768        ELSE
 12769           GO TO 1600-EDIT-RESERVES.
 12770
 12771     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12772     MOVE '6'                    TO CNTL-REC-TYPE.
 12773
 12774     IF CONTROL-IS-ACTUAL-CARRIER
 12775         MOVE PI-CARRIER         TO WS-CARR
 12776     ELSE
 12777         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12778
 12779     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12780     MOVE +0                     TO CNTL-SEQ-NO.
 12781     MOVE 'CARR'                 TO FILE-SWITCH.
 12782
 12783     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12784
 12785     IF EXPENSE-CALC-MANUAL
 12786        GO TO 1600-EDIT-RESERVES.
 12787
 12788     IF DOLLARS-PER-PMT
 12789        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12790        GO TO 1600-EDIT-RESERVES.
 12791
 12792     IF DOLLARS-PER-MONTH AND
 12793        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 12794       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12795       GO TO 1600-EDIT-RESERVES.
 12796
 12797     IF PERCENT-OF-PAYMENT
 12798        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12799
 12800     GO TO 1600-EDIT-RESERVES.
 12801
 12802 1590-EXPENSE-ERROR.
 12803     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12804
 12805     IF EMI-MESSAGE-FORMATTED
 12806        MOVE -1                  TO EEXPENSL
 12807        MOVE AL-UNBON            TO EEXPENSA.
 12808
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 243
* EL156.cbl
 12810 1600-EDIT-RESERVES.
 12811     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12812        IF PI-ERESV = ZEROS
 12813           GO TO 1700-EDIT-EXPENSE-TYPE
 12814        ELSE
 12815           MOVE ER-0525          TO EMI-ERROR
 12816           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12817           GO TO 1700-EDIT-EXPENSE-TYPE.
 12818
 12819     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12820     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12821     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12822
 12823     IF NOT AT-MANUAL-RESERVES-USED
 12824        IF PI-ERESV NOT = ZEROS
 12825           MOVE ER-0518          TO EMI-ERROR
 12826           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12827
 12828     IF AT-MANUAL-RESERVES-USED
 12829        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12830        GO TO 1700-EDIT-EXPENSE-TYPE.
 12831
 12832     IF AT-FUTURE-RESERVES-USED
 12833        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12834
 12835     IF AT-FUTURE-RESERVES-USED
 12836        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12837
 12838     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12839        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12840
 12841     IF AT-IBNR-RESERVES-USED
 12842        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12843
 12844     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12845     GO TO 1700-EDIT-EXPENSE-TYPE.
 12846
 12847 1690-RESERVE-ERROR.
 12848     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12849
 12850     IF EMI-MESSAGE-FORMATTED
 12851        MOVE AL-UNBON            TO ERESVA
 12852        MOVE -1                  TO ERESVL.
 12853
 12854 1690-EXIT.
 12855      EXIT.
 12856
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 244
* EL156.cbl
 12858 1700-EDIT-EXPENSE-TYPE.
 12859     IF PI-PMTTYPE NOT = '5' AND '6'
 12860        GO TO 2000-EDIT-DONE.
 12861
 12862     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12863                   '6' OR '7' OR '8' OR '9'
 12864        GO TO 2000-EDIT-DONE.
 12865
 12866 1705-EXPENSE-ERROR.
 12867     MOVE ER-0573                TO EMI-ERROR.
 12868     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12869
 12870     IF EMI-MESSAGE-FORMATTED
 12871        MOVE AL-UABON            TO ETYPEA
 12872        MOVE -1                  TO ETYPEL.
 12873
 12874     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 245
* EL156.cbl
 12876 1950-NOT-FOUND.
 12877     IF FILE-SWITCH = 'MSTR'
 12878        MOVE ER-0204             TO EMI-ERROR.
 12879
 12880     IF FILE-SWITCH = 'CARR'
 12881        MOVE ER-0252             TO EMI-ERROR.
 12882
 12883     IF FILE-SWITCH = 'COMP'
 12884        MOVE ER-0254             TO EMI-ERROR.
 12885
 12886     IF FILE-SWITCH = 'STAT'
 12887        MOVE ER-0149             TO EMI-ERROR.
 12888
 12889     IF FILE-SWITCH = 'PROC'
 12890        MOVE ER-0019             TO EMI-ERROR.
 12891
 12892     IF FILE-SWITCH = 'ACCT'
 12893        MOVE ER-0198             TO EMI-ERROR.
 12894
 12895     IF FILE-SWITCH = 'BENE'
 12896        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12897           MOVE ER-0282          TO EMI-ERROR
 12898        ELSE
 12899           MOVE ER-0283          TO EMI-ERROR.
 12900
 12901     MOVE -1                     TO PMTTYPEL.
 12902     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12903
 12904     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12905                                     WS-FORCE-CTR.
 12906
 12907     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12908                                     WS-FATAL-CTR.
 12909
 12910     GO TO 8200-SEND-DATAONLY.
 12911
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 246
* EL156.cbl
 12913 2000-EDIT-DONE.
 12914     perform 2210-dcc-max-benes thru 2210-exit
 12915     if pi-company-id not = 'DCC' and 'CAP'
 12916        IF (WS-SPECIAL-CALC-CD = 'C')
 12917           and (cl-critical-period > 0)
 12918           IF CM-AH-BENEFIT-AMT NOT = ZERO
 12919              IF PI-EPYAMT > ZEROS
 12920                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12921                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12922              ELSE
 12923                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12924                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12925              END-IF
 12926              if ws-benefits-paid > cl-critical-period
 12927                 MOVE ER-0657          TO EMI-ERROR
 12928                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12929              END-IF
 12930           END-IF
 12931        END-IF
 12932     end-if
 12933     IF PI-HOLDTIL NOT = ZEROS
 12934        MOVE PI-HOLDTIL          TO HOLDTILO
 12935        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12936
 12937     IF PI-EPYFROM NOT = ZEROS
 12938        MOVE PI-EPYFROM          TO EPYFROMO
 12939        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12940
 12941     IF PI-EPYTHRU NOT = ZEROS
 12942        MOVE PI-EPYTHRU            TO EPYTHRUO
 12943        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12944        IF PI-USES-PAID-TO
 12945           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12946           MOVE '4'                TO DC-OPTION-CODE
 12947           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12948           IF NO-CONVERSION-ERROR
 12949              MOVE +1              TO DC-ELAPSED-DAYS
 12950              MOVE +0              TO DC-ELAPSED-MONTHS
 12951              MOVE '6'             TO DC-OPTION-CODE
 12952              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12953              IF NO-CONVERSION-ERROR
 12954                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12955
 12956     MOVE PI-EDAYS               TO EDAYSO.
 12957
 12958     IF PI-AIGFROM NOT = ZEROS
 12959        MOVE PI-AIGFROM          TO AIGFROMO
 12960        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12961
 12962     MOVE PI-EPYAMT              TO EPYAMTO.
 12963     MOVE PI-ERESV               TO ERESVO.
 12964     MOVE PI-EEXPENS             TO EEXPENSO.
 12965
 12966     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12967     MOVE SPACES                 TO DC-OPTION-CODE.
 12968     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12969
 12970     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 247
* EL156.cbl
 12971        MOVE SPACES              TO CPYFROMI
 12972     ELSE
 12973        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12974        IF PI-EPYFROM = ZEROS
 12975           MOVE AL-UANON             TO EPYFROMA
 12976           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12977           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12978
 12979     IF PI-USES-PAID-TO
 12980        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12981        MOVE +1                            TO DC-ELAPSED-DAYS
 12982        MOVE +0                            TO DC-ELAPSED-MONTHS
 12983        MOVE '6'                           TO DC-OPTION-CODE
 12984        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12985        IF NO-CONVERSION-ERROR
 12986           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12987           IF PI-EPYTHRU = ZEROS
 12988              MOVE AL-UANON                TO EPYTHRUA
 12989              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12990              MOVE ' '                     TO DC-OPTION-CODE
 12991              MOVE +0                      TO DC-ELAPSED-DAYS
 12992                                              DC-ELAPSED-MONTHS
 12993              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12994              IF NO-CONVERSION-ERROR
 12995                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12996                  GO TO 2001-CONTINUE
 12997              ELSE
 12998                  GO TO 2001-CONTINUE
 12999           ELSE
 13000              GO TO 2001-CONTINUE.
 13001
 13002     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13003     MOVE SPACES                 TO DC-OPTION-CODE.
 13004     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13005
 13006     IF DATE-CONVERSION-ERROR
 13007        MOVE SPACES              TO CPYTHRUI
 13008     ELSE
 13009        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13010        IF PI-EPYTHRU = ZEROS
 13011           MOVE AL-UANON TO EPYTHRUA
 13012           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 13013           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 13014
 13015 2001-CONTINUE.
 13016
 13017     MOVE PI-CDAYS               TO CDAYSO.
 13018
 13019     IF PI-EDAYS = ZEROS
 13020        MOVE AL-UNNON TO EDAYSA
 13021        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 13022
 13023     MOVE PI-CPYAMT              TO CPYAMTO.
 13024
 13025     IF PI-EPYAMT = ZEROS
 13026        MOVE AL-UNNON            TO EPYAMTA
 13027        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 13028
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 248
* EL156.cbl
 13029     MOVE PI-CRESV               TO CRESVO.
 13030     MOVE PI-CEXPENS             TO CEXPENSO.
 13031
 13032     IF PI-EEXPENS = ZEROS
 13033        MOVE AL-UNNON TO EEXPENSA
 13034        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 13035
 13036     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 13037        AND (CL-CLAIM-TYPE = 'L')
 13038        AND (PI-OFFLINE NOT EQUAL 'Y')
 13039        IF PI-PMTTYPE = '2' OR '4'
 13040           PERFORM 2200-CALC-INTEREST
 13041                                 THRU 2200-EXIT
 13042        END-IF
 13043     END-IF
 13044     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 13045     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 13046     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 13047
 13048     IF EMI-FATAL-CTR = ZEROS
 13049        MOVE 'B'                 TO PI-PASS-SW.
 13050
 13051     IF NOT EMI-MESSAGE-FORMATTED
 13052         MOVE -1                 TO EPYFROML
 13053     ELSE
 13054         IF EMI-ERROR-NUMBER (1) = '0526' AND
 13055            EMI-ERROR-NUMBER (2) = SPACES
 13056             MOVE -1             TO EPYFROML.
 13057
 13058     GO TO 8200-SEND-DATAONLY.
 13059
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 249
* EL156.cbl
 13061 2200-CALC-INTEREST.
 13062     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 13063        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 13064        MOVE '4'                 TO DC-OPTION-CODE
 13065        PERFORM 9700-LINK-DATE-CONVERT
 13066        IF DATE-CONVERSION-ERROR
 13067            MOVE LOW-VALUES      TO CP-PRF-DT
 13068        ELSE
 13069           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 13070        END-IF
 13071     END-IF
 13072     if (pi-int-to-rem-borr <> 'Y' and 'N')
 13073        if pi-rb-joint-coverage
 13074           move 'Y'              to pi-int-to-rem-borr
 13075        end-if
 13076     end-if
 13077     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 13078        IN CLAIM-INT-PASS-AREA
 13079     MOVE CL-CERT-STATE          TO CP-STATE
 13080        IN CLAIM-INT-PASS-AREA
 13081     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 13082     MOVE 'LF'                   TO CP-COVERAGE
 13083     MOVE CL-INCURRED-DT         TO CP-INC-DT
 13084     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 13085     MOVE LOW-VALUES             TO CP-LSTPD-DT
 13086     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 13087     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 13088     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 13089
 13090* EXEC CICS LINK
 13091*       PROGRAM   ('ELCLMI')
 13092*       COMMAREA  (CLAIM-INT-PASS-AREA)
 13093*       LENGTH    (CP-CLAIM-LENGTH)
 13094*    END-EXEC
 13095     MOVE 'ELCLMI' TO DFHEIV1
 13096*    MOVE '."C                   (   #00012502' TO DFHEIV0
 13097     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13098     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13099     MOVE X'2020233030303132353032' TO DFHEIV0(25:11)
 13100     CALL 'kxdfhei1' USING DFHEIV0,
 13101           DFHEIV1,
 13102           CLAIM-INT-PASS-AREA,
 13103           CP-CLAIM-LENGTH,
 13104           DFHEIV99,
 13105           DFHEIV99,
 13106           DFHEIV99,
 13107           DFHEIV99
 13108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13109     MOVE AL-PANOF               TO PINTHA
 13110                                    PINTA
 13111     if cp-clm-int-amt = zeros
 13112        move ' ' to pi-int-to-rem-borr
 13113     end-if
 13114     IF NO-CI-ERROR
 13115        MOVE CP-CLM-INT-AMT      TO PINTO
 13116                                    PI-INT-AMT
 13117        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 13118        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 250
* EL156.cbl
 13119        MOVE AL-PANOF            TO PINTHA
 13120                                    PINTA
 13121        if pi-rb-joint-coverage
 13122           and pi-int-amt > zeros
 13123           move '  INT TO'       to itrb1o
 13124           move ' REM BORR?'     to itrb2o
 13125           move pi-int-to-rem-borr
 13126                                 to itrbyno
 13127           move al-uanon         to itrbyna
 13128           move +1               to itrbynl
 13129        else
 13130           move ' '              to pi-int-to-rem-borr
 13131        end-if
 13132     ELSE
 13133        IF CI-RETURN-CODE = '8'
 13134           MOVE ER-3818          TO EMI-ERROR
 13135           MOVE -1               TO ZINTL
 13136           PERFORM 9900-ERROR-FORMAT
 13137                                 THRU 9900-EXIT
 13138           GO TO 2200-EXIT
 13139        ELSE
 13140           MOVE ZEROS            TO PINTO
 13141                                    PI-INT-AMT
 13142                                    PI-INT-DAYS
 13143                                    PI-INT-RATE-USED
 13144        END-IF
 13145     END-IF
 13146     IF PI-INT-AMT NOT = ZEROS
 13147        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 13148           AND (CL-SOC-SEC-NO NOT = ZEROS)
 13149           CONTINUE
 13150        ELSE
 13151           MOVE CL-SOC-SEC-NO (1:3)
 13152                                 TO WS-SSN (1:3)
 13153           MOVE CL-SOC-SEC-NO (5:2)
 13154                                 TO WS-SSN (4:2)
 13155           MOVE CL-SOC-SEC-NO (8:4)
 13156                                 TO WS-SSN (6:4)
 13157           IF (WS-SSN NUMERIC)
 13158              AND (WS-SSN NOT = ZEROS)
 13159              CONTINUE
 13160           ELSE
 13161              MOVE ER-2044       TO EMI-ERROR
 13162              PERFORM 9900-ERROR-FORMAT
 13163                                 THRU 9900-EXIT
 13164           END-IF
 13165        END-IF
 13166        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 13167        if pi-int-to-rem-borr = 'Y'
 13168           move +61              to trlr-seq-no
 13169        else
 13170           MOVE +51              TO TRLR-SEQ-NO
 13171        end-if
 13172
 13173* EXEC CICS READ
 13174*          DATASET  ('ELTRLR')
 13175*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13176*          RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 251
* EL156.cbl
 13177*          RESP     (WS-RESPONSE)
 13178*       END-EXEC
 13179     MOVE 'ELTRLR' TO DFHEIV1
 13180*    MOVE '&"S        E          (  N#00012570' TO DFHEIV0
 13181     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13182     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13183     MOVE X'204E233030303132353730' TO DFHEIV0(25:11)
 13184     CALL 'kxdfhei1' USING DFHEIV0,
 13185           DFHEIV1,
 13186           DFHEIV20,
 13187           DFHEIV99,
 13188           ELTRLR-KEY,
 13189           DFHEIV99,
 13190           DFHEIV99,
 13191           DFHEIV99
 13192     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13193         DFHEIV20
 13194     MOVE EIBRESP  TO WS-RESPONSE
 13195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13196        IF (NOT WS-RESP-NORMAL)
 13197                    OR
 13198           ((WS-RESP-NORMAL)
 13199           AND ((AT-ADDRESS-LINE-1 = SPACES)
 13200           OR (AT-CITY-STATE = SPACES)))
 13201           MOVE ER-0874          TO EMI-ERROR
 13202           if pi-rb-joint-coverage
 13203              move -1            to itrbynl
 13204           end-if
 13205           PERFORM 9900-ERROR-FORMAT
 13206                                 THRU 9900-EXIT
 13207        else
 13208           move at-mail-to-name  to pi-int-payees-name
 13209        END-IF
 13210     END-IF
 13211     .
 13212 2200-EXIT.
 13213     EXIT.
 13214 2210-dcc-max-benes.
 13215
 13216     move pi-ah-term             to ws-max-bens
 13217     if cl-critical-period not = zeros and spaces
 13218        move cl-critical-period  to ws-max-bens
 13219     end-if
 13220     move cm-ah-benefit-amt      to ws-monthly-benefit
 13221     if pdef-found
 13222        and (pd-max-amt (p1) not = zeros)
 13223        if pd-ben-pct (p1) not numeric
 13224           move zeros            to pd-ben-pct (p1)
 13225        end-if
 13226        if pd-ben-pct (p1) = zeros
 13227           move +1               to ws-work-ben-pct
 13228        else
 13229           move pd-ben-pct (p1)  to ws-work-ben-pct
 13230        end-if
 13231*       compute ws-monthly-benefit =
 13232*          ws-monthly-benefit * ws-work-ben-pct
 13233*       if ws-monthly-benefit > pd-max-amt (p1)
 13234*          move pd-max-amt (p1) to ws-monthly-benefit
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 252
* EL156.cbl
 13235*       end-if
 13236     end-if
 13237
 13238     move cl-cert-key-data       to elcrtt-key (2:21)
 13239     move cl-company-cd          to ctrlr-comp-cd
 13240     move cl-cert-no             to ctrlr-cert-no
 13241     move 'B'                    to ctrlr-rec-type
 13242
 13243
 13244* EXEC CICS READ
 13245*       DATASET  ('ELCRTT')
 13246*       set      (address of CERTIFICATE-TRAILERS)
 13247*       RIDFLD   (ELCRTT-KEY)
 13248*       RESP     (WS-RESPONSE)
 13249*    END-EXEC
 13250     MOVE 'ELCRTT' TO DFHEIV1
 13251*    MOVE '&"S        E          (  N#00012623' TO DFHEIV0
 13252     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13253     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13254     MOVE X'204E233030303132363233' TO DFHEIV0(25:11)
 13255     CALL 'kxdfhei1' USING DFHEIV0,
 13256           DFHEIV1,
 13257           DFHEIV20,
 13258           DFHEIV99,
 13259           ELCRTT-KEY,
 13260           DFHEIV99,
 13261           DFHEIV99,
 13262           DFHEIV99
 13263     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13264         DFHEIV20
 13265     MOVE EIBRESP  TO WS-RESPONSE
 13266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13267     IF not WS-RESP-NORMAL
 13268        go to 2210-exit
 13269     end-if
 13270
 13271*    if instypei = 'P'
 13272*       move +1 to s1
 13273*    else
 13274*       MOVE +2 to s1
 13275*    end-if
 13276
 13277*    move +1 to s1
 13278*    evaluate cl-claim-type
 13279*       when 'A'
 13280*          move +1 to s2
 13281*       when 'I'
 13282*          move +2 to s2
 13283*       when 'G'
 13284*          move +3 to s2
 13285*       when 'L'
 13286*          move +4 to s2
 13287*       when 'P'
 13288*          move +5 to s2
 13289*    end-evaluate
 13290
 13291     move zeros                  to ws-prev-days-paid
 13292                                    ws-benefits-paid
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 253
* EL156.cbl
 13293                                    ws-prev-amt-paid
 13294     perform varying s1 from +1 by +1 until
 13295        (s1 > +24)
 13296        or (cs-claim-type (s1) = spaces)
 13297        if pi-company-id not = 'DCC' and 'CAP'
 13298           if cs-claim-type (s1) = cl-claim-type
 13299              compute ws-prev-days-paid =
 13300                 ws-prev-days-paid + cs-days-paid (s1)
 13301              compute ws-prev-amt-paid =
 13302                 ws-prev-amt-paid + cs-total-paid (s1)
 13303           end-if
 13304        else
 13305           if (cs-claim-type (s1) = cl-claim-type)
 13306              and (cs-benefit-period (s1) = cl-benefit-period)
 13307              and (cs-insured-type (s1) = cl-insured-type)
 13308              compute ws-prev-days-paid =
 13309                 ws-prev-days-paid + cs-days-paid (s1)
 13310              compute ws-prev-amt-paid =
 13311                 ws-prev-amt-paid + cs-total-paid (s1)
 13312           end-if
 13313        end-if
 13314     end-perform
 13315     if pi-epyamt > zeros
 13316        compute ws-benefits-paid =
 13317           (ws-prev-amt-paid + pi-epyamt)
 13318           / ws-monthly-benefit
 13319     else
 13320        compute ws-benefits-paid =
 13321           (ws-prev-amt-paid + pi-cpyamt)
 13322           / ws-monthly-benefit
 13323     end-if
 13324*    if pi-company-id = 'DCC'
 13325     if cl-claim-type not = 'L' and 'P'
 13326        if ws-benefits-paid > ws-max-bens
 13327           move er-1658          to emi-error
 13328           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13329        end-if
 13330     end-if
 13331*    end-if
 13332*     if s1 < +25
 13333*        if pi-epyamt > zeros
 13334*           compute ws-benefits-paid =
 13335*              (cs-total-paid (s1) + PI-EPYAMT)
 13336*              / ws-monthly-benefit
 13337*        else
 13338*           compute ws-benefits-paid =
 13339*              (cs-total-paid (s1) + PI-CPYAMT)
 13340*              / ws-monthly-benefit
 13341*        end-if
 13342
 13343*       if ws-benefits-paid > pd-crit-period (p1)
 13344*        if ws-benefits-paid > ws-max-bens
 13345*           move er-1658          to emi-error
 13346*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13347*        end-if
 13348*     end-if
 13349     .
 13350 2210-exit.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 254
* EL156.cbl
 13351     exit.
 13352
 13353 2220-update-elcrtt.
 13354
 13355
 13356* EXEC CICS GETMAIN
 13357*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13358*       LENGTH   (ELCRTT-LENGTH)
 13359*       INITIMG  (GETMAIN-SPACE)
 13360*    END-EXEC
 13361*    MOVE ',"IL                  $   #00012717' TO DFHEIV0
 13362     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13363     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13364     MOVE X'2020233030303132373137' TO DFHEIV0(25:11)
 13365     CALL 'kxdfhei1' USING DFHEIV0,
 13366           DFHEIV20,
 13367           ELCRTT-LENGTH,
 13368           GETMAIN-SPACE
 13369     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13370         DFHEIV20
 13371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13372
 13373     move cl-cert-key-data       to elcrtt-key (2:21)
 13374     move cl-company-cd          to ctrlr-comp-cd
 13375     move cl-cert-no             to ctrlr-cert-no
 13376     move 'B'                    to ctrlr-rec-type
 13377
 13378
 13379* EXEC CICS READ
 13380*       UPDATE
 13381*       DATASET  (ELCRTT-DSID)
 13382*       into     (CERTIFICATE-TRAILERS)
 13383*       RIDFLD   (ELCRTT-KEY)
 13384*       RESP     (WS-RESPONSE)
 13385*    END-EXEC
 13386     MOVE LENGTH OF
 13387      CERTIFICATE-TRAILERS
 13388       TO DFHEIV11
 13389*    MOVE '&"IL       EU         (  N#00012728' TO DFHEIV0
 13390     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13391     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13392     MOVE X'204E233030303132373238' TO DFHEIV0(25:11)
 13393     CALL 'kxdfhei1' USING DFHEIV0,
 13394           ELCRTT-DSID,
 13395           CERTIFICATE-TRAILERS,
 13396           DFHEIV11,
 13397           ELCRTT-KEY,
 13398           DFHEIV99,
 13399           DFHEIV99,
 13400           DFHEIV99
 13401     MOVE EIBRESP  TO WS-RESPONSE
 13402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13403
 13404     IF WS-RESP-NORMAL
 13405        perform 2225-upd-crt-trlr thru 2225-exit
 13406
 13407* EXEC CICS REWRITE
 13408*          DATASET  (ELCRTT-DSID)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 255
* EL156.cbl
 13409*          from     (CERTIFICATE-TRAILERS)
 13410*          RESP     (WS-RESPONSE)
 13411*       END-EXEC
 13412     MOVE LENGTH OF
 13413      CERTIFICATE-TRAILERS
 13414       TO DFHEIV11
 13415*    MOVE '&& L                  %  N#00012738' TO DFHEIV0
 13416     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13417     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13418     MOVE X'204E233030303132373338' TO DFHEIV0(25:11)
 13419     CALL 'kxdfhei1' USING DFHEIV0,
 13420           ELCRTT-DSID,
 13421           CERTIFICATE-TRAILERS,
 13422           DFHEIV11,
 13423           DFHEIV99
 13424     MOVE EIBRESP  TO WS-RESPONSE
 13425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13426     else
 13427        if ws-resp-notfnd
 13428           move 'CS'             to certificate-trailers
 13429           move cl-company-cd    to cs-company-cd
 13430           move cl-cert-key-data to cs-control-primary (2:21)
 13431           move cl-cert-no       to cs-cert-no
 13432           move 'B'              to cs-trailer-type
 13433           perform varying s1 from +1 by +1 until s1 > +24
 13434              move zeros         to cs-benefit-period (s1)
 13435                                    cs-days-paid (s1)
 13436                                    cs-total-paid (s1)
 13437                                    cs-remaining-bens (s1)
 13438           end-perform
 13439           perform 2225-upd-crt-trlr
 13440                                 thru 2225-exit
 13441
 13442* EXEC CICS WRITE
 13443*             DATASET  (ELCRTT-DSID)
 13444*             from     (CERTIFICATE-TRAILERS)
 13445*             RIDFLD   (cs-control-primary)
 13446*             RESP     (WS-RESPONSE)
 13447*          END-EXEC
 13448     MOVE LENGTH OF
 13449      CERTIFICATE-TRAILERS
 13450       TO DFHEIV11
 13451*    MOVE '&$ L                  ''  N#00012758' TO DFHEIV0
 13452     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13453     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13454     MOVE X'204E233030303132373538' TO DFHEIV0(25:11)
 13455     CALL 'kxdfhei1' USING DFHEIV0,
 13456           ELCRTT-DSID,
 13457           CERTIFICATE-TRAILERS,
 13458           DFHEIV11,
 13459           cs-control-primary,
 13460           DFHEIV99,
 13461           DFHEIV99
 13462     MOVE EIBRESP  TO WS-RESPONSE
 13463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13464        end-if
 13465     END-IF
 13466
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 256
* EL156.cbl
 13467     .
 13468 2220-exit.
 13469     exit.
 13470
 13471 2225-upd-crt-trlr.
 13472
 13473*    if instypei = 'P'
 13474*       move +1 to s1
 13475*    else
 13476*       MOVE +2 to s1
 13477*    end-if
 13478
 13479*    move +1 to s1
 13480*    evaluate cl-claim-type
 13481*       when 'A'
 13482*          move +1 to s2
 13483*       when 'I'
 13484*          move +2 to s2
 13485*       when 'G'
 13486*          move +3 to s2
 13487*       when 'L'
 13488*          move +4 to s2
 13489*       when 'P'
 13490*          move +5 to s2
 13491*    end-evaluate
 13492     perform varying s1 from +1 by +1 until
 13493        (s1 > +24)
 13494        or (cl-claim-no = cs-claim-no (s1))
 13495     end-perform
 13496     if s1 < +25
 13497        compute cs-total-paid (s1) =
 13498           cs-total-paid (s1) + at-amount-paid
 13499        compute cs-days-paid (s1) =
 13500           cs-days-paid (s1) +  at-days-in-period
 13501*       compute cs-remaining-bens (s1) =
 13502*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13503        perform 2230-accum-bens-paid thru 2230-exit
 13504     end-if
 13505
 13506     .
 13507 2225-exit.
 13508     exit.
 13509 2230-accum-bens-paid.
 13510     if cl-claim-type not = 'L' and 'P'
 13511        move pi-ah-term          to ws-max-bens
 13512        if cl-critical-period not = zeros and spaces
 13513           move cl-critical-period
 13514                                 to ws-max-bens
 13515        end-if
 13516     else
 13517        move 01                  to ws-max-bens
 13518     end-if
 13519     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13520     perform varying s2 from +1 by +1 until
 13521        (s2 > +24)
 13522        or (cs-claim-no (s2) = spaces)
 13523        if pi-company-id not = 'DCC' and 'CAP'
 13524           if cs-claim-type (s2) = cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 257
* EL156.cbl
 13525              compute ws-tot-days-paid =
 13526                 ws-tot-days-paid + cs-days-paid (s2)
 13527              compute ws-tot-amt-paid =
 13528                 ws-tot-amt-paid + cs-total-paid (s2)
 13529           end-if
 13530        else
 13531           if (cs-benefit-period (s2) = cl-benefit-period)
 13532              and (cs-claim-type (s2) = cl-claim-type)
 13533              and (cs-insured-type (s2) = cl-insured-type)
 13534              compute ws-tot-days-paid =
 13535                 ws-tot-days-paid + cs-days-paid (s2)
 13536              compute ws-tot-amt-paid =
 13537                 ws-tot-amt-paid + cs-total-paid (s2)
 13538           end-if
 13539        end-if
 13540     end-perform
 13541     if cl-claim-type = 'L' and 'P'
 13542        if ws-tot-amt-paid > zeros
 13543           move zeros            to cs-remaining-bens (s1)
 13544        else
 13545           move 01               to cs-remaining-bens (s1)
 13546        end-if
 13547     else
 13548        compute ws-pd-bens rounded =
 13549           ws-tot-amt-paid / pi-ah-benefit-amt
 13550        compute cs-remaining-bens (s1) =
 13551           ws-max-bens - ws-pd-bens
 13552        if cs-remaining-bens (s1) < zeros
 13553           move zeros            to cs-remaining-bens (s1)
 13554        end-if
 13555     end-if
 13556     .
 13557 2230-exit.
 13558     exit.
 13559 3000-MOVE-INPUT-TO-SAVE-AREA.
 13560     IF PMTTYPEL > 0
 13561         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13562
 13563     if ws-pmttype = '4'
 13564        if pi-rb-joint-coverage
 13565           if payeel = +0
 13566              move +2            to payeel
 13567              move al-uanon      to payeea
 13568              move 'Q1'          to payeeo
 13569           else
 13570              if payeei not = 'Q1' and 'q1'
 13571                 move er-1582    to emi-error
 13572                 PERFORM 9900-ERROR-FORMAT thru 9900-exit
 13573              end-if
 13574           end-if
 13575        end-if
 13576     end-if
 13577     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13578
 13579     IF WS-PMTTYPE = '9'
 13580         MOVE 'P'                TO PI-PROVISIONAL-IND
 13581         MOVE '1'                TO WS-PMTTYPE.
 13582
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 258
* EL156.cbl
 13583     IF PAYEEL > 0
 13584         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13585         MOVE PAYEEI             TO WS-PAYEE.
 13586
 13587     IF NOTE1L > +0
 13588         MOVE NOTE1I             TO WS-PMTNOTE1
 13589                                    WS-FLI-PMTNOTE
 13590                                    WS-HAN-PMTNOTE.
 13591
 13592     IF NOTE2L > +0
 13593         MOVE NOTE2I             TO WS-PMTNOTE2.
 13594
 13595     IF OFFLINEL > 0
 13596         MOVE OFFLINEI           TO WS-OFFLINE.
 13597
 13598     IF PROOFDTL > 0
 13599         MOVE PROOFDTI            TO DATE-WORK
 13600         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13601         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13602         MOVE '4'                 TO DC-OPTION-CODE
 13603         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13604         IF NO-CONVERSION-ERROR
 13605            MOVE NUM-WORK         TO PROOFDTO
 13606            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13607            MOVE NUM-WORK         TO WS-PROOF-DATE
 13608         ELSE
 13609            MOVE ZEROS            TO WS-PROOF-DATE
 13610         END-IF
 13611     END-IF.
 13612
 13613     IF EOBYNL > +0
 13614         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13615         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13616     END-IF
 13617
 13618     IF CLMFMYNL > +0
 13619         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13620         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13621     END-IF
 13622
 13623     IF SURVYYNL > +0
 13624         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13625         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13626     END-IF
 13627
 13628     IF SPRELYNL > +0
 13629         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13630         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13631     END-IF
 13632     if itrbynl <> +0
 13633        move function upper-case(itrbyni) to itrbyni
 13634        move itrbyni             to ws-int-to-rem-borr
 13635     end-if
 13636*    IF GROUPEDL > +0
 13637*        MOVE GROUPEDI           TO WS-GROUPED.
 13638*
 13639*    IF CASHL > +0
 13640*       MOVE CASHI               TO WS-CASH.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 259
* EL156.cbl
 13641     IF LOANNOL > +0
 13642         MOVE LOANNOI            TO WS-LOAN-NO.
 13643
 13644     IF CHECKNOL > 0
 13645         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13646
 13647     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13648         IF WS-AIG-CREDIT-ENTERED
 13649             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13650             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13651             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13652             MOVE AL-UANON         TO CHECKNOA.
 13653
 13654     IF HOLDTILL > 0
 13655         MOVE HOLDTILI           TO DATE-WORK
 13656         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13657         MOVE NUM-WORK           TO WS-HOLDTIL.
 13658
 13659     IF ZINTL > +0
 13660
 13661* EXEC CICS BIF DEEDIT
 13662*           FIELD   (ZINTI)
 13663*           LENGTH  (07)
 13664*       END-EXEC
 13665     MOVE 07
 13666       TO DFHEIV11
 13667*    MOVE '@"L                   #   #00012960' TO DFHEIV0
 13668     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13669     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13670     MOVE X'2020233030303132393630' TO DFHEIV0(25:11)
 13671     CALL 'kxdfhei1' USING DFHEIV0,
 13672           ZINTI,
 13673           DFHEIV11
 13674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13675        IF ZINTI NOT NUMERIC
 13676           MOVE ER-0419          TO EMI-ERROR
 13677           PERFORM 9900-ERROR-FORMAT
 13678           MOVE AL-UABON         TO ZINTA
 13679           MOVE -1               TO ZINTL
 13680        ELSE
 13681           MOVE ZINTI            TO CP-INT-RATE
 13682                                    WS-INT-RATE
 13683           MOVE CP-INT-RATE      TO ZINTO
 13684           MOVE AL-UNNON         TO ZINTA
 13685        END-IF
 13686     ELSE
 13687        MOVE ZEROS               TO CP-INT-RATE
 13688     END-IF
 13689     IF EPYFROML > 0
 13690         MOVE EPYFROMI           TO DATE-WORK
 13691         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13692         MOVE NUM-WORK           TO WS-EPYFROM.
 13693
 13694     IF AIGFROML > 0
 13695         MOVE AIGFROMI           TO DATE-WORK
 13696         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13697         MOVE NUM-WORK           TO WS-AIGFROM
 13698     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 260
* EL156.cbl
 13699         IF (AIGFROMI = LOW-VALUES) AND
 13700            (PI-AIGFROM NOT = ZEROS)
 13701              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13702
 13703     IF EPYTHRUL > +0
 13704        MOVE EPYTHRUI           TO DATE-WORK
 13705        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13706        MOVE NUM-WORK           TO WS-EPYTHRU
 13707        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13708        MOVE '4'                TO DC-OPTION-CODE
 13709        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13710        IF NO-CONVERSION-ERROR
 13711           IF PI-USES-PAID-TO
 13712              MOVE '6'                TO DC-OPTION-CODE
 13713              MOVE -1                 TO DC-ELAPSED-DAYS
 13714              MOVE +0                 TO DC-ELAPSED-MONTHS
 13715              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13716              IF NO-CONVERSION-ERROR
 13717                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13718                 MOVE ' '             TO DC-OPTION-CODE
 13719                 MOVE +0              TO DC-ELAPSED-DAYS
 13720                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13721              IF NO-CONVERSION-ERROR
 13722                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13723
 13724*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13725*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13726     IF EDAYSL > 0
 13727
 13728* EXEC CICS BIF DEEDIT
 13729*            FIELD(EDAYSI)
 13730*            LENGTH(6)
 13731*        END-EXEC
 13732     MOVE 6
 13733       TO DFHEIV11
 13734*    MOVE '@"L                   #   #00013016' TO DFHEIV0
 13735     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13736     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13737     MOVE X'2020233030303133303136' TO DFHEIV0(25:11)
 13738     CALL 'kxdfhei1' USING DFHEIV0,
 13739           EDAYSI,
 13740           DFHEIV11
 13741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13742         MOVE EDAYSI             TO WS-DY-WORK
 13743         IF WS-DY-SIGN = SPACES
 13744            MOVE WS-DY-NUM       TO WS-EDAYS
 13745            ADD 0                TO WS-EDAYS
 13746         ELSE
 13747            MOVE EDAYSI          TO WS-EDAYS
 13748            ADD 0                TO WS-EDAYS.
 13749
 13750*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13751*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13752     IF EPYAMTL > 0
 13753
 13754* EXEC CICS BIF DEEDIT
 13755*            FIELD(EPYAMTI)
 13756*            LENGTH(10)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 261
* EL156.cbl
 13757*        END-EXEC
 13758     MOVE 10
 13759       TO DFHEIV11
 13760*    MOVE '@"L                   #   #00013031' TO DFHEIV0
 13761     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13762     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13763     MOVE X'2020233030303133303331' TO DFHEIV0(25:11)
 13764     CALL 'kxdfhei1' USING DFHEIV0,
 13765           EPYAMTI,
 13766           DFHEIV11
 13767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13768         MOVE EPYAMTI            TO WS-PY-WORK
 13769         IF WS-PY-SIGN = SPACES
 13770            MOVE WS-PY-NUM       TO WS-EPYAMT
 13771            ADD 0                TO WS-EPYAMT
 13772         ELSE
 13773            MOVE EPYAMTI         TO WS-EPYAMT
 13774            ADD 0                TO WS-EPYAMT.
 13775
 13776     IF ERESVL > 0
 13777
 13778* EXEC CICS BIF DEEDIT
 13779*            FIELD(ERESVI)
 13780*            LENGTH(9)
 13781*        END-EXEC
 13782     MOVE 9
 13783       TO DFHEIV11
 13784*    MOVE '@"L                   #   #00013044' TO DFHEIV0
 13785     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13786     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13787     MOVE X'2020233030303133303434' TO DFHEIV0(25:11)
 13788     CALL 'kxdfhei1' USING DFHEIV0,
 13789           ERESVI,
 13790           DFHEIV11
 13791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13792         MOVE ERESVI TO WS-ERESV.
 13793
 13794     IF EEXPENSL > 0
 13795
 13796* EXEC CICS BIF DEEDIT
 13797*            FIELD(EEXPENSI)
 13798*            LENGTH(8)
 13799*        END-EXEC
 13800     MOVE 8
 13801       TO DFHEIV11
 13802*    MOVE '@"L                   #   #00013051' TO DFHEIV0
 13803     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13804     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13805     MOVE X'2020233030303133303531' TO DFHEIV0(25:11)
 13806     CALL 'kxdfhei1' USING DFHEIV0,
 13807           EEXPENSI,
 13808           DFHEIV11
 13809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13810         MOVE EEXPENSI           TO WS-EEXPENS.
 13811
 13812     IF ETYPEL > ZEROS
 13813         MOVE ETYPEI             TO WS-ETYPE.
 13814
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 262
* EL156.cbl
 13815     IF PI-COMPANY-ID = 'BOA'
 13816        IF PINTL > ZEROS
 13817
 13818* EXEC CICS BIF DEEDIT
 13819*            FIELD (PINTI)
 13820*            LENGTH(05)
 13821*          END-EXEC
 13822     MOVE 05
 13823       TO DFHEIV11
 13824*    MOVE '@"L                   #   #00013062' TO DFHEIV0
 13825     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13826     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13827     MOVE X'2020233030303133303632' TO DFHEIV0(25:11)
 13828     CALL 'kxdfhei1' USING DFHEIV0,
 13829           PINTI,
 13830           DFHEIV11
 13831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13832           IF PINTI NUMERIC
 13833               MOVE AL-UNNON     TO PINTA
 13834               MOVE PINTI        TO WS-INT-RATE
 13835               MOVE WS-INT-RATE  TO PINTO.
 13836
 13837 3000-EXIT.
 13838     EXIT.
 13839
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 263
* EL156.cbl
 13841 3050-REBUILD-ENTERED.
 13842
 13843     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13844
 13845     IF PI-PROV-PMT
 13846         MOVE '9'           TO PMTTYPEO
 13847     ELSE
 13848         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13849
 13850     MOVE PI-PAYEE          TO PAYEEO.
 13851     MOVE PI-PMTNOTE1       TO NOTE1O.
 13852     MOVE PI-PMTNOTE2       TO NOTE2O.
 13853     MOVE PI-OFFLINE        TO OFFLINEO.
 13854     IF PI-PROOF-DATE NOT = ZEROS
 13855         MOVE PI-PROOF-DATE TO PROOFDTO
 13856         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13857     END-IF.
 13858*    MOVE PI-GROUPED        TO GROUPEDO.
 13859
 13860*    MOVE PI-CASH           TO CASHO.
 13861
 13862     IF PI-INT-RATE > ZEROS
 13863        MOVE PI-INT-RATE         TO PINTO
 13864     end-if
 13865     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13866        IF PI-INT-AMT > ZEROS
 13867           MOVE PI-INT-AMT       TO PINTO
 13868           MOVE AL-PANOF         TO PINTA
 13869                                    PINTHA
 13870           if pi-rb-joint-coverage
 13871              move '  INT TO'    to itrb1o
 13872              move ' REM BORR?'  to itrb2o
 13873              move 'Y'           to itrbyno
 13874              move al-uanon      to itrbyna
 13875              move +1            to itrbynl
 13876           end-if
 13877        END-IF
 13878     END-IF
 13879     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13880     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13881     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13882     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13883     IF PI-HOLDTIL NOT = ZEROS
 13884        MOVE PI-HOLDTIL          TO HOLDTILO
 13885        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13886
 13887     IF PI-EPYFROM NOT = ZEROS
 13888        MOVE PI-EPYFROM          TO EPYFROMO
 13889        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13890
 13891     IF PI-AIGFROM NOT = ZEROS
 13892        MOVE PI-AIGFROM          TO AIGFROMO
 13893        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13894
 13895     IF PI-EPYTHRU NOT = ZEROS
 13896        MOVE PI-EPYTHRU          TO EPYTHRUO
 13897        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13898        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 264
* EL156.cbl
 13899           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13900           MOVE '4'                TO DC-OPTION-CODE
 13901           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13902           IF NO-CONVERSION-ERROR
 13903              MOVE +1 TO DC-ELAPSED-DAYS
 13904              MOVE +0 TO DC-ELAPSED-MONTHS
 13905              MOVE '6' TO DC-OPTION-CODE
 13906              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13907              IF NO-CONVERSION-ERROR
 13908                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13909
 13910     IF PI-EDAYS NOT = ZEROS
 13911        MOVE PI-EDAYS TO EDAYSO.
 13912
 13913     IF PI-EPYAMT NOT = ZEROS
 13914        MOVE PI-EPYAMT TO EPYAMTO.
 13915
 13916     IF PI-ERESV NOT = ZEROS
 13917        MOVE PI-ERESV TO ERESVO.
 13918
 13919     IF PI-EEXPENS NOT = ZEROS
 13920        MOVE PI-EEXPENS TO EEXPENSO.
 13921
 13922     MOVE PI-ETYPE TO ETYPEO.
 13923
 13924     IF PI-ECHECKNO NOT = SPACES
 13925        MOVE PI-ECHECKNO         TO CHECKNOO
 13926     ELSE
 13927        MOVE PI-CCHECKNO         TO CHECKNOO.
 13928
 13929     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13930     MOVE SPACES                 TO DC-OPTION-CODE.
 13931     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13932
 13933     IF DATE-CONVERSION-ERROR
 13934        MOVE SPACES              TO CPYFROMI
 13935     ELSE
 13936        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13937
 13938     IF PI-USES-PAID-TO
 13939        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13940        MOVE +1                  TO DC-ELAPSED-DAYS
 13941        MOVE +0                  TO DC-ELAPSED-MONTHS
 13942        MOVE '6'                 TO DC-OPTION-CODE
 13943        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13944        IF NO-CONVERSION-ERROR
 13945           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13946           GO TO 3051-CONTINUE.
 13947
 13948     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13949     MOVE SPACES                 TO DC-OPTION-CODE.
 13950     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13951
 13952     IF DATE-CONVERSION-ERROR
 13953        MOVE SPACES              TO CPYTHRUI
 13954     ELSE
 13955        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13956
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 265
* EL156.cbl
 13957 3051-CONTINUE.
 13958
 13959     IF PI-CDAYS NOT = ZEROS
 13960        MOVE PI-CDAYS TO CDAYSO.
 13961
 13962     IF PI-CPYAMT NOT = ZEROS
 13963        MOVE PI-CPYAMT TO CPYAMTO.
 13964
 13965     IF PI-CRESV NOT = ZEROS
 13966        MOVE PI-CRESV TO CRESVO.
 13967
 13968     IF PI-CEXPENS NOT = ZEROS
 13969        MOVE PI-CEXPENS TO CEXPENSO.
 13970
 13971 3059-EXIT.
 13972     EXIT.
 13973
 13974 3100-DEEDIT-DATE.
 13975
 13976* EXEC CICS BIF DEEDIT
 13977*        FIELD(DATE-WORK)
 13978*        LENGTH(8)
 13979*    END-EXEC.
 13980     MOVE 8
 13981       TO DFHEIV11
 13982*    MOVE '@"L                   #   #00013209' TO DFHEIV0
 13983     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13984     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13985     MOVE X'2020233030303133323039' TO DFHEIV0(25:11)
 13986     CALL 'kxdfhei1' USING DFHEIV0,
 13987           DATE-WORK,
 13988           DFHEIV11
 13989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13990
 13991
 13992 3100-EXIT.
 13993     EXIT.
 13994
 13995 3200-CALC-AIG-DAYS.
 13996
 13997     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13998
 13999     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 14000     MOVE ' '                    TO DC-OPTION-CODE.
 14001     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14002     IF NO-CONVERSION-ERROR
 14003         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 14004     ELSE
 14005         GO TO 3290-ERROR.
 14006
 14007     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14008         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14009                                WS-BIN-FROM-DT
 14010     ELSE
 14011         IF CL-TOTAL-PAID-AMT > ZEROS
 14012             IF WS-SV-EPYFROM = LOW-VALUES
 14013                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14014                                        WS-BIN-FROM-DT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 266
* EL156.cbl
 14015             ELSE
 14016                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14017                                        WS-BIN-FROM-DT
 14018         ELSE
 14019             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14020                                        WS-BIN-FROM-DT.
 14021
 14022 3210-CONTINUE.
 14023
 14024     MOVE ' '                    TO DC-OPTION-CODE.
 14025     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14026     IF DATE-CONVERSION-ERROR
 14027         GO TO 3290-ERROR.
 14028
 14029     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 14030
 14031     IF PI-LOAN-DUE-DAY = 31
 14032         MOVE 30              TO WS-PMT-DUE-DA
 14033                                 WS-SAVE-DUE-DA
 14034     ELSE
 14035         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 14036                                 WS-SAVE-DUE-DA.
 14037
 14038     IF (PI-LOAN-DUE-DAY > 28) AND
 14039        (WS-PMT-DUE-MO = 2)
 14040         MOVE 'Y'                TO WS-DUE-DAY-SW
 14041         MOVE 28                 TO WS-PMT-DUE-DA.
 14042
 14043     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 14044     MOVE '4'                    TO DC-OPTION-CODE.
 14045     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14046     IF NO-CONVERSION-ERROR
 14047         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 14048     ELSE
 14049         GO TO 3290-ERROR.
 14050
 14051*--------------------------------------------------------------*
 14052*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 14053*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 14054*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 14055*                                                              *
 14056*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 14057*             INCURRED DATE      - 04/15/91                    *
 14058*             PMT DUE DATE       - 04/03/91                    *
 14059*             PMT DUE DATE       - 05/03/91                    *
 14060*--------------------------------------------------------------*
 14061
 14062     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14063        (WS-SV-AIGFROM = LOW-VALUES)
 14064         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 14065            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 14066             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14067             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14068             IF NO-CONVERSION-ERROR
 14069                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14070                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14071             ELSE
 14072                 GO TO 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 267
* EL156.cbl
 14073
 14074     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14075        (WS-SV-AIGFROM = LOW-VALUES)
 14076         GO TO 3205-CONT-CALC-PMT.
 14077
 14078     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 14079     MOVE ' '                    TO DC-OPTION-CODE.
 14080     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14081     IF NO-CONVERSION-ERROR
 14082         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 14083     ELSE
 14084         GO TO 3290-ERROR.
 14085
 14086     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 14087        (WS-PMT-DUE-DA < WS-FROM-DA)
 14088          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14089          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14090          IF NO-CONVERSION-ERROR
 14091              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14092              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14093          ELSE
 14094              GO TO 3290-ERROR.
 14095
 14096 3205-CONT-CALC-PMT.
 14097
 14098*--------------------------------------------------------------*
 14099*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 14100*    BETWEEN THE PAY FROM / THRU DATES.                        *
 14101*--------------------------------------------------------------*
 14102
 14103     IF CL-TOTAL-PAID-AMT = ZEROS AND
 14104        PI-PMTTYPE = '2'
 14105          NEXT SENTENCE
 14106     ELSE
 14107        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 14108           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 14109             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 14110             MOVE ER-3527            TO EMI-ERROR
 14111             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14112             MOVE -1                 TO EPYTHRUL
 14113             MOVE AL-UNBON           TO EPYTHRUA
 14114                                        EPYFROMA
 14115             GO TO 3299-EXIT.
 14116
 14117*--------------------------------------------------------------*
 14118*    CALCULATE RETRO ELIMINATION DATE                          *
 14119*--------------------------------------------------------------*
 14120
 14121     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14122         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14123     ELSE
 14124         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 14125
 14126     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 14127     MOVE +0             TO DC-ELAPSED-MONTHS.
 14128     MOVE '6'            TO DC-OPTION-CODE.
 14129     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14130     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 268
* EL156.cbl
 14131         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 14132     ELSE
 14133         GO TO 3290-ERROR.
 14134
 14135 3210-CHECK-PMT-DATE.
 14136
 14137*--------------------------------------------------------------*
 14138*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 14139*    THE ENTERED PAY FROM DATE                                 *
 14140*--------------------------------------------------------------*
 14141
 14142     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 14143         NEXT SENTENCE
 14144     ELSE
 14145         GO TO 3220-COMPUTE-DAYS.
 14146
 14147     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 14148     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14149     IF NO-CONVERSION-ERROR
 14150         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14151         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14152         GO TO 3210-CHECK-PMT-DATE
 14153     ELSE
 14154         GO TO 3290-ERROR.
 14155
 14156 3220-COMPUTE-DAYS.
 14157
 14158     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 14159     MOVE ZEROS         TO WS-CDAYS.
 14160     MOVE 'N'           TO WS-ELIMINATION-SW.
 14161
 14162*--------------------------------------------------------------*
 14163*    COMPUTE CALIFORNIA DUE DAYS                               *
 14164*--------------------------------------------------------------*
 14165
 14166     IF CL-TOTAL-PAID-AMT > ZEROS
 14167         MOVE 'Y' TO WS-ELIMINATION-SW
 14168         GO TO 3240-FIRST-PMT-DUE
 14169     ELSE
 14170        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 14171            NEXT SENTENCE
 14172        ELSE
 14173            GO TO 3240-FIRST-PMT-DUE.
 14174
 14175 3230-NEXT-PMT-DUE.
 14176
 14177     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 14178     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14179     IF NO-CONVERSION-ERROR
 14180         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 14181         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14182     ELSE
 14183         GO TO 3290-ERROR.
 14184
 14185 3240-FIRST-PMT-DUE.
 14186
 14187     IF CL-TOTAL-PAID-AMT > ZEROS
 14188         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 269
* EL156.cbl
 14189     ELSE
 14190        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 14191            GO TO 3230-NEXT-PMT-DUE.
 14192
 14193     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 14194         GO TO 3250-VERIFY-ELIMINATION.
 14195
 14196     ADD +30 TO WS-CDAYS.
 14197     MOVE 'Y' TO WS-ELIMINATION-SW.
 14198     GO TO 3230-NEXT-PMT-DUE.
 14199
 14200 3250-VERIFY-ELIMINATION.
 14201
 14202     IF ELIM-SATISFIED
 14203         GO TO 3260-END-CALC.
 14204
 14205     IF PI-PMTTYPE = '1'
 14206         MOVE ZEROS TO WS-CDAYS
 14207         GO TO 3260-END-CALC.
 14208
 14209     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14210         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14211     ELSE
 14212         IF CL-TOTAL-PAID-AMT > ZEROS
 14213             IF WS-SV-EPYFROM = LOW-VALUES
 14214                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14215             ELSE
 14216                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14217         ELSE
 14218             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 14219
 14220     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 14221     MOVE '1'                    TO DC-OPTION-CODE.
 14222     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14223     IF NO-CONVERSION-ERROR
 14224         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 14225     ELSE
 14226         GO TO 3290-ERROR.
 14227
 14228     IF CL-TOTAL-PAID-AMT > ZEROS
 14229         MOVE WS-DAYS-OFF TO WS-CDAYS
 14230     ELSE
 14231         IF PI-BEN-DAYS > WS-DAYS-OFF
 14232             MOVE ZEROS TO WS-CDAYS
 14233         ELSE
 14234             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 14235
 14236 3260-END-CALC.
 14237
 14238     MOVE WS-CDAYS TO PI-CDAYS.
 14239
 14240     IF PI-EDAYS = ZEROS
 14241         MOVE PI-CDAYS TO PI-EDAYS
 14242         MOVE AL-UNNON TO EDAYSA.
 14243
 14244     GO TO 3299-EXIT.
 14245
 14246 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 270
* EL156.cbl
 14247
 14248     MOVE ER-3528            TO EMI-ERROR.
 14249     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14250     MOVE -1                 TO CDAYSL.
 14251     MOVE AL-UNBON           TO CDAYSA.
 14252
 14253 3299-EXIT.
 14254     EXIT.
 14255
 14256 3300-BUMP-DATE.
 14257
 14258     IF WS-RESTORE-DUE-DAY
 14259         MOVE 'N'              TO WS-DUE-DAY-SW
 14260         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 14261         ADD 1                 TO WS-PMT-DUE-MO
 14262         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 14263         MOVE '4'              TO DC-OPTION-CODE
 14264         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14265         IF NO-CONVERSION-ERROR
 14266             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14267             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14268             GO TO 3399-EXIT
 14269         ELSE
 14270             MOVE '9'          TO DC-ERROR-CODE
 14271             GO TO 3399-EXIT.
 14272
 14273     IF (WS-PMT-DUE-MO = 1) AND
 14274        (WS-SAVE-DUE-DA > 28)
 14275           MOVE 'Y' TO WS-DUE-DAY-SW.
 14276
 14277     MOVE +0                 TO DC-ELAPSED-DAYS.
 14278     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14279     MOVE '6'                TO DC-OPTION-CODE.
 14280     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14281
 14282 3399-EXIT.
 14283     EXIT.
 14284
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 271
* EL156.cbl
 14286 3400-COMPUTE-EXPIRY.
 14287
 14288     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14289     MOVE +0                    TO DC-ELAPSED-DAYS
 14290                                   DC-ODD-DAYS-OVER.
 14291     MOVE '1'                   TO DC-END-OF-MONTH.
 14292     MOVE '6'                   TO DC-OPTION-CODE.
 14293
 14294     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14295         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14296     ELSE
 14297         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14298
 14299     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14300     IF NO-CONVERSION-ERROR
 14301         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14302     ELSE
 14303         GO TO 3390-CONTINUE.
 14304
 14305     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14306         GO TO 3390-CONTINUE.
 14307
 14308     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14309     MOVE '4'                    TO CNTL-REC-TYPE.
 14310     MOVE +0                     TO CNTL-SEQ-NO.
 14311     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14312     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14313     MOVE 'BENE'                 TO FILE-SWITCH.
 14314
 14315     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14316
 14317     IF NO-BENEFIT-FOUND
 14318         GO TO 3390-CONTINUE.
 14319
 14320     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 14321        IF (PI-OFFLINE = 'Y') OR
 14322           (PI-PMTTYPE = '7')
 14323           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14324                                     THRU 9870-EXIT
 14325           IF ERROR-ON-OUTPUT
 14326             MOVE -1                 TO ENTERPFL
 14327             MOVE AL-UANON           TO ENTERPFA
 14328             MOVE MAP-NAMEA          TO MAP-NAME
 14329             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14330             GO TO 8200-SEND-DATAONLY.
 14331
 14332     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 14333        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14334        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14335          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14336          MOVE +0        TO DC-ELAPSED-DAYS
 14337          MOVE +1        TO DC-ELAPSED-MONTHS
 14338          MOVE 6         TO DC-OPTION-CODE
 14339          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14340          IF NO-CONVERSION-ERROR
 14341              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14342
 14343 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 272
* EL156.cbl
 14344
 14345      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 14346         MOVE CM-AH-LOAN-EXPIRE-DT
 14347                                 TO DC-BIN-DATE-1
 14348      ELSE
 14349         MOVE CM-LF-LOAN-EXPIRE-DT
 14350                                 TO DC-BIN-DATE-1
 14351      END-IF
 14352
 14353      MOVE ' '                    TO DC-OPTION-CODE.
 14354      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14355      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14356      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14357
 14358 3499-EXIT.
 14359     EXIT.
 14360
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 273
* EL156.cbl
 14362
 14363 3600-CHECK-VERIFICATION.
 14364
 14365     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14366
 14367     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14368
 14369     IF PI-PAYEE-TYPE = 'I'
 14370        GO TO 3600-READ-TRAILER.
 14371
 14372     IF PI-PAYEE-TYPE = 'B'
 14373        ADD +10                  TO TRLR-SEQ-NO
 14374        GO TO 3600-READ-TRAILER.
 14375
 14376     IF PI-PAYEE-TYPE = 'A'
 14377        ADD +20                  TO TRLR-SEQ-NO
 14378        GO TO 3600-READ-TRAILER.
 14379
 14380     IF PI-PAYEE-TYPE = 'O'
 14381        ADD +50                  TO TRLR-SEQ-NO
 14382        GO TO 3600-READ-TRAILER.
 14383
 14384     IF PI-PAYEE-TYPE = 'Q'
 14385        ADD +60                  TO TRLR-SEQ-NO
 14386        GO TO 3600-READ-TRAILER.
 14387
 14388     IF PI-PAYEE-TYPE = 'P'
 14389        ADD +30                  TO TRLR-SEQ-NO
 14390        GO TO 3600-READ-TRAILER.
 14391
 14392     IF PI-PAYEE-TYPE = 'E'
 14393        ADD +40                  TO TRLR-SEQ-NO.
 14394
 14395 3600-READ-TRAILER.
 14396
 14397
 14398* EXEC CICS HANDLE CONDITION
 14399*         NOTFND(3600-CONTINUE)
 14400*    END-EXEC.
 14401*    MOVE '"$I                   ! - #00013619' TO DFHEIV0
 14402     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14403     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14404     MOVE X'2D20233030303133363139' TO DFHEIV0(25:11)
 14405     CALL 'kxdfhei1' USING DFHEIV0
 14406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14407
 14408
 14409     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14410
 14411 3600-CONTINUE.
 14412
 14413     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14414         GO TO 3600-AH-VERIFY
 14415     END-IF.
 14416
 14417     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14418       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14419         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 274
* EL156.cbl
 14420           MOVE ER-7576            TO EMI-ERROR
 14421           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14422           MOVE -1                 TO PAYEEL
 14423           MOVE AL-UABON           TO PAYEEA
 14424           GO TO 3600-EXIT
 14425         END-IF
 14426       END-IF
 14427     END-IF.
 14428
 14429     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14430     MOVE 1 TO WS-SUB2
 14431     MOVE SPACES TO WS-PAYEE-NAME
 14432     PERFORM VARYING WS-SUB FROM 1 BY 1
 14433             UNTIL WS-SUB > 30
 14434         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14435            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14436                 WS-PAYEE-NAME-X (WS-SUB2)
 14437            ADD +1 TO WS-SUB2
 14438         END-IF
 14439     END-PERFORM.
 14440
 14441     STRING CL-INSURED-1ST-NAME
 14442            CL-INSURED-MID-INIT
 14443            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14444     MOVE 1 TO WS-SUB2
 14445     MOVE SPACES TO WS-INSURED-NAME
 14446     PERFORM VARYING WS-SUB FROM 1 BY 1
 14447             UNTIL WS-SUB > 30
 14448         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14449            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14450                 WS-INSURED-NAME-X (WS-SUB2)
 14451            ADD +1 TO WS-SUB2
 14452         END-IF
 14453     END-PERFORM.
 14454
 14455     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14456        MOVE ER-7579            TO EMI-ERROR
 14457        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14458        MOVE -1                 TO PAYEEL
 14459        MOVE AL-UABON           TO PAYEEA
 14460     END-IF.
 14461
 14462     IF PI-PMTTYPE = '4'  AND
 14463        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14464        PI-PAYEE-TYPE <> 'I'
 14465          MOVE ER-7580          TO EMI-ERROR
 14466          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14467          MOVE -1               TO PAYEEL
 14468          MOVE AL-UABON         TO PAYEEA
 14469     END-IF.
 14470
 14471     GO TO 3600-EXIT.
 14472
 14473 3600-AH-VERIFY.
 14474
 14475     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14476        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14477           MOVE ER-7583            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 275
* EL156.cbl
 14478           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14479           MOVE -1                 TO PAYEEL
 14480           MOVE AL-UABON           TO PAYEEA
 14481        END-IF
 14482     END-IF.
 14483
 14484
 14485 3600-EXIT.
 14486     EXIT.
 14487
 14488 5000-UPDATE.
 14489
 14490     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14491
 14492     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14493
 14494     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14495        PI-OFFLINE = 'Y'
 14496        NEXT SENTENCE
 14497     ELSE
 14498        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14499
 14500*    IF PI-COMPANY-ID = 'CRI'
 14501*       IF PI-PMTTYPE = '1' OR  '2'
 14502*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14503*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14504*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14505
 14506*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14507*       IF PI-PMTTYPE = '1'
 14508*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14509*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14510
 14511     IF PI-PMTTYPE      = '2' AND
 14512        PI-SPLIT-PMT-SW = 'Y' AND
 14513        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 14514          MOVE ER-3530                TO EMI-ERROR
 14515          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14516
 14517     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14518        AND (CL-CLAIM-TYPE = 'L')
 14519        IF PI-PMTTYPE = '2' OR '4'
 14520           IF PI-INT-AMT NOT = ZEROS
 14521              PERFORM 7110-BUILD-PMT-TRLR
 14522                                 THRU 7130-EXIT
 14523           ELSE
 14524              IF PI-PMTTYPE = '2'
 14525                 PERFORM 7140-BUILD-NOTE-TRLR
 14526                                 THRU 7170-EXIT
 14527              END-IF
 14528           END-IF
 14529        END-IF
 14530     END-IF
 14531*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14532*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14533*            MOVE 'N'                 TO  WS-LETTER-SW.
 14534
 14535*    IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 276
* EL156.cbl
 14536*        IF CL-NO-OF-PMTS-MADE = +1
 14537*                OR
 14538*           PI-PMTTYPE = '2'
 14539*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14540
 14541     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14542
 14543*    IF PI-COMPANY-ID = 'DMD'
 14544*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14545*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14546
 14547
 14548* EXEC CICS REWRITE
 14549*         DATASET('ELMSTR')
 14550*         FROM(CLAIM-MASTER)
 14551*     END-EXEC.
 14552     MOVE LENGTH OF
 14553      CLAIM-MASTER
 14554       TO DFHEIV11
 14555     MOVE 'ELMSTR' TO DFHEIV1
 14556*    MOVE '&& L                  %   #00013761' TO DFHEIV0
 14557     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14558     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14559     MOVE X'2020233030303133373631' TO DFHEIV0(25:11)
 14560     CALL 'kxdfhei1' USING DFHEIV0,
 14561           DFHEIV1,
 14562           CLAIM-MASTER,
 14563           DFHEIV11,
 14564           DFHEIV99
 14565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14566
 14567
 14568     IF WS-LETTER-SW = 'N'
 14569         GO TO 5000-END-UPDATE.
 14570
 14571 5000-GENERATE-AUTO-LETTER.
 14572
 14573
 14574* EXEC CICS LINK
 14575*        PROGRAM    (LINK-1523)
 14576*        COMMAREA   (W-1523-LINKDATA)
 14577*        LENGTH     (W-1523-COMM-LENGTH)
 14578*    END-EXEC.
 14579*    MOVE '."C                   (   #00013771' TO DFHEIV0
 14580     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14581     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14582     MOVE X'2020233030303133373731' TO DFHEIV0(25:11)
 14583     CALL 'kxdfhei1' USING DFHEIV0,
 14584           LINK-1523,
 14585           W-1523-LINKDATA,
 14586           W-1523-COMM-LENGTH,
 14587           DFHEIV99,
 14588           DFHEIV99,
 14589           DFHEIV99,
 14590           DFHEIV99
 14591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14592
 14593
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 277
* EL156.cbl
 14594     IF W-1523-FATAL-ERROR
 14595         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14596         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14597         MOVE ER-0802                TO  EMI-ERROR
 14598         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14599
 14600     IF W-1523-ERROR-CODE = 0191
 14601         MOVE ER-0803                TO  EMI-ERROR
 14602         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14603
 14604     IF PI-COMPANY-ID      = 'HAN' AND
 14605        PI-PMTTYPE         = '1'   AND
 14606        PI-3RD-PARTY-SW    = 'Y'   AND
 14607        W-1523-FORM-NUMBER = 'EOB1'
 14608           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14609           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14610           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14611           GO TO 5000-GENERATE-AUTO-LETTER.
 14612
 14613 5000-END-UPDATE.
 14614
 14615     MOVE ER-0000                TO EMI-ERROR.
 14616     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14617     GO TO 7000-SHOW-CLAIM.
 14618
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 278
* EL156.cbl
 14620 5000-MOVE-NAME.
 14621     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14622     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14623     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14624
 14625 5000-EXIT.
 14626     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 279
* EL156.cbl
 14628 5300-CREATE-DMO.
 14629
 14630     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14631     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14632     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14633
 14634
 14635* EXEC CICS HANDLE CONDITION
 14636*         NOTFND   (5300-NOTE-NOT-FOUND)
 14637*    END-EXEC.
 14638*    MOVE '"$I                   ! . #00013817' TO DFHEIV0
 14639     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14640     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14641     MOVE X'2E20233030303133383137' TO DFHEIV0(25:11)
 14642     CALL 'kxdfhei1' USING DFHEIV0
 14643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14644
 14645
 14646
 14647* EXEC CICS READ
 14648*         DATASET('ERNOTE')
 14649*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14650*         RIDFLD (W-NOTE-KEY)
 14651*    END-EXEC.
 14652     MOVE 'ERNOTE' TO DFHEIV1
 14653*    MOVE '&"S        E          (   #00013821' TO DFHEIV0
 14654     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14655     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14656     MOVE X'2020233030303133383231' TO DFHEIV0(25:11)
 14657     CALL 'kxdfhei1' USING DFHEIV0,
 14658           DFHEIV1,
 14659           DFHEIV20,
 14660           DFHEIV99,
 14661           W-NOTE-KEY,
 14662           DFHEIV99,
 14663           DFHEIV99,
 14664           DFHEIV99
 14665     SET ADDRESS OF CERTIFICATE-NOTE TO
 14666         DFHEIV20
 14667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14668
 14669
 14670     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14671     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14672     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14673
 14674     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14675         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14676     ELSE
 14677         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14678
 14679     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14680     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14681     MOVE 'DLO006'               TO PGM-NAME.
 14682
 14683
 14684* EXEC CICS LINK
 14685*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 280
* EL156.cbl
 14686*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14687*        LENGTH     (DCT-RCRD-LENGTH)
 14688*    END-EXEC.
 14689*    MOVE '."C                   (   #00013840' TO DFHEIV0
 14690     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14691     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14692     MOVE X'2020233030303133383430' TO DFHEIV0(25:11)
 14693     CALL 'kxdfhei1' USING DFHEIV0,
 14694           PGM-NAME,
 14695           DCT-COMMUNICATION-AREA,
 14696           DCT-RCRD-LENGTH,
 14697           DFHEIV99,
 14698           DFHEIV99,
 14699           DFHEIV99,
 14700           DFHEIV99
 14701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14702
 14703
 14704     IF DCT-RETURN-CODE = 'OK'
 14705         GO TO 5300-CONT.
 14706
 14707     IF DCT-RETURN-CODE = '01' OR '02'
 14708         GO TO 5300-EXIT.
 14709
 14710     IF DCT-RETURN-CODE = '03'
 14711         MOVE ER-0951            TO EMI-ERROR
 14712         GO TO 5300-BAD-EXIT.
 14713
 14714     IF DCT-RETURN-CODE = '04'
 14715         MOVE ER-0946            TO EMI-ERROR
 14716         GO TO 5300-BAD-EXIT.
 14717
 14718     IF DCT-RETURN-CODE = '05'
 14719         MOVE ER-0947            TO EMI-ERROR
 14720         GO TO 5300-BAD-EXIT.
 14721
 14722     IF DCT-RETURN-CODE = '06'
 14723         MOVE ER-0921            TO EMI-ERROR
 14724         GO TO 5300-BAD-EXIT.
 14725
 14726     IF DCT-RETURN-CODE = '07'
 14727         MOVE ER-0849            TO EMI-ERROR
 14728         GO TO 5300-BAD-EXIT.
 14729
 14730     IF DCT-RETURN-CODE = '08'
 14731         MOVE ER-0948            TO EMI-ERROR
 14732         GO TO 5300-BAD-EXIT.
 14733
 14734     IF DCT-RETURN-CODE = 'N1'
 14735         MOVE ER-0950            TO EMI-ERROR
 14736         GO TO 5300-BAD-EXIT.
 14737
 14738     IF DCT-RETURN-CODE = 'E1'
 14739         MOVE ER-0974            TO EMI-ERROR
 14740         GO TO 5300-BAD-EXIT.
 14741
 14742     IF DCT-RETURN-CODE = 'E2'
 14743         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 281
* EL156.cbl
 14744         GO TO 5300-BAD-EXIT.
 14745
 14746     IF DCT-RETURN-CODE NOT = 'OK'
 14747         MOVE ER-0949            TO EMI-ERROR
 14748         GO TO 5300-BAD-EXIT.
 14749
 14750 5300-CONT.
 14751
 14752     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14753     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14754     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14755     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14756     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14757     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14758     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14759     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14760
 14761     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14762     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14763     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14764     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14765     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14766
 14767     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14768
 14769     IF PI-PMTTYPE = '2'
 14770         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14771         MOVE '4'                TO DM-CLAIM-STATUS
 14772     ELSE
 14773         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14774         MOVE '2'                TO DM-CLAIM-STATUS.
 14775
 14776     MOVE 'DLO025'               TO PGM-NAME.
 14777
 14778
 14779* EXEC CICS LINK
 14780*        PROGRAM    (PGM-NAME)
 14781*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14782*        LENGTH     (DM-DMO-LENGTH)
 14783*    END-EXEC.
 14784*    MOVE '."C                   (   #00013920' TO DFHEIV0
 14785     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14786     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14787     MOVE X'2020233030303133393230' TO DFHEIV0(25:11)
 14788     CALL 'kxdfhei1' USING DFHEIV0,
 14789           PGM-NAME,
 14790           DMO-COMMUNICATION-AREA,
 14791           DM-DMO-LENGTH,
 14792           DFHEIV99,
 14793           DFHEIV99,
 14794           DFHEIV99,
 14795           DFHEIV99
 14796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14797
 14798
 14799     IF DM-RETURN-CODE = 'OK'
 14800         GO TO 5300-EXIT.
 14801
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 282
* EL156.cbl
 14802     IF DM-RETURN-CODE = '01'
 14803         MOVE ER-8051            TO EMI-ERROR
 14804         GO TO 5300-BAD-EXIT.
 14805
 14806     IF DM-RETURN-CODE = '02'
 14807         MOVE ER-8052            TO EMI-ERROR
 14808         GO TO 5300-BAD-EXIT.
 14809
 14810     IF DM-RETURN-CODE = '03'
 14811         MOVE ER-8053            TO EMI-ERROR
 14812         GO TO 5300-BAD-EXIT.
 14813
 14814     IF DM-RETURN-CODE = '04'
 14815         MOVE ER-8054            TO EMI-ERROR
 14816         GO TO 5300-BAD-EXIT.
 14817
 14818     IF DM-RETURN-CODE = '05'
 14819         MOVE ER-8055            TO EMI-ERROR
 14820         GO TO 5300-BAD-EXIT.
 14821
 14822     IF DM-RETURN-CODE = '06'
 14823         MOVE ER-8056            TO EMI-ERROR
 14824         GO TO 5300-BAD-EXIT.
 14825
 14826     IF DM-RETURN-CODE = '07'
 14827         MOVE ER-8057            TO EMI-ERROR
 14828         GO TO 5300-BAD-EXIT.
 14829
 14830     IF DM-RETURN-CODE = '08'
 14831         MOVE ER-8058            TO EMI-ERROR
 14832         GO TO 5300-BAD-EXIT.
 14833
 14834     IF DM-RETURN-CODE = '09'
 14835         MOVE ER-8059            TO EMI-ERROR
 14836         GO TO 5300-BAD-EXIT.
 14837
 14838     IF DM-RETURN-CODE = '10'
 14839         MOVE ER-8060            TO EMI-ERROR
 14840         GO TO 5300-BAD-EXIT.
 14841
 14842     IF DM-RETURN-CODE = '11'
 14843         MOVE ER-8061            TO EMI-ERROR
 14844         GO TO 5300-BAD-EXIT.
 14845
 14846     IF DM-RETURN-CODE = '12'
 14847         MOVE ER-8062            TO EMI-ERROR
 14848         GO TO 5300-BAD-EXIT.
 14849
 14850     IF DM-RETURN-CODE = '13'
 14851         MOVE ER-8063            TO EMI-ERROR
 14852         GO TO 5300-BAD-EXIT.
 14853
 14854     IF DM-RETURN-CODE = '14'
 14855         MOVE ER-8064            TO EMI-ERROR
 14856         GO TO 5300-BAD-EXIT.
 14857
 14858     IF DM-RETURN-CODE = '15'
 14859         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 283
* EL156.cbl
 14860         GO TO 5300-BAD-EXIT.
 14861
 14862     IF DM-RETURN-CODE = '16'
 14863         MOVE ER-8154            TO EMI-ERROR
 14864         GO TO 5300-BAD-EXIT.
 14865
 14866     IF DM-RETURN-CODE = '17'
 14867         MOVE ER-8155            TO EMI-ERROR
 14868         GO TO 5300-BAD-EXIT.
 14869
 14870     IF DM-RETURN-CODE = 'N1'
 14871         MOVE ER-8152            TO EMI-ERROR
 14872         GO TO 5300-BAD-EXIT.
 14873
 14874     IF DM-RETURN-CODE = 'E1'
 14875         MOVE ER-8153            TO EMI-ERROR
 14876         GO TO 5300-BAD-EXIT.
 14877
 14878     MOVE ER-8066            TO EMI-ERROR.
 14879     GO TO 5300-BAD-EXIT.
 14880
 14881 5300-NOTE-NOT-FOUND.
 14882
 14883     MOVE ER-0954                TO EMI-ERROR.
 14884     GO TO 5300-BAD-EXIT.
 14885
 14886 5300-BAD-EXIT.
 14887
 14888* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14889*    MOVE '6"R                   !   #00014014' TO DFHEIV0
 14890     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14891     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14892     MOVE X'2020233030303134303134' TO DFHEIV0(25:11)
 14893     CALL 'kxdfhei1' USING DFHEIV0
 14894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14895
 14896     IF MAP-NAME = 'EL156A'
 14897         MOVE -1             TO ENTERPFL
 14898       ELSE
 14899         MOVE LOW-VALUES     TO EL156BI
 14900         MOVE -1             TO ENTPFBL.
 14901
 14902     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14903     GO TO 8200-SEND-DATAONLY.
 14904
 14905 5300-EXIT.
 14906     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 284
* EL156.cbl
 14908 5350-FORMAT-LAST-NAME-1ST.
 14909*****************************************************************
 14910*             M O V E   N A M E   R O U T I N E                 *
 14911*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14912*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14913*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14914*                  FIELD                   VALUE                *
 14915*           W-NAME-LAST    (CL15)      SMITH                    *
 14916*           W-NAME-FIRST   (CL15)      JOHN                     *
 14917*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14918*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14919*     CONTAIN                                                   *
 14920*                SMITH, JOHN ALLEN                              *
 14921*     OR                                                        *
 14922*                SMITH, JOHN A.                                 *
 14923*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14924*     COPYBOOK, ELCNWA.                                         *
 14925*****************************************************************.
 14926
 14927     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14928     MOVE ZERO                   TO  WS-NAME-SW.
 14929     SET NWA-INDEX               TO +1.
 14930
 14931     IF W-NAME-LAST   = SPACES AND
 14932        W-NAME-MIDDLE = SPACES
 14933         MOVE +1                 TO WS-NAME-SW.
 14934
 14935     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14936     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14937
 14938     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14939     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14940
 14941     SET NWA-INDEX UP BY +1.
 14942
 14943     IF W-NAME-MIDDLE NOT = SPACES
 14944         IF W-NAME-MIDDLE-2 = SPACES
 14945             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14946             SET NWA-INDEX UP BY +1
 14947             MOVE '.'            TO WS-NW (NWA-INDEX)
 14948             SET NWA-INDEX UP BY +2
 14949         ELSE
 14950             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14951             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14952
 14953 5350-EXIT.
 14954     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 285
* EL156.cbl
 14956 5360-MOVE-NAME.
 14957
 14958     IF WS-NAME-SW > +1
 14959         GO TO 5360-EXIT.
 14960
 14961     IF WS-NAME-WORK2 = SPACES
 14962         GO TO 5360-EXIT.
 14963
 14964     SET NWA-INDEX2            TO +1.
 14965     SET NWA-INDEX3            TO +2.
 14966
 14967 5360-MOVE-NAME-CYCLE.
 14968
 14969     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14970
 14971     IF NWA-INDEX < +30
 14972         SET NWA-INDEX UP BY +1
 14973     ELSE
 14974         ADD +2                TO  WS-NAME-SW
 14975         GO TO 5360-EXIT.
 14976
 14977     IF NWA-INDEX2 < +20
 14978         SET NWA-INDEX3 UP BY +1
 14979         SET NWA-INDEX2 UP BY +1.
 14980
 14981     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14982        WS-NW2 (NWA-INDEX3) = SPACES
 14983         IF WS-NAME-SW = ZERO
 14984             MOVE ','            TO  WS-NW (NWA-INDEX)
 14985             SET NWA-INDEX UP BY +2
 14986             MOVE +1             TO  WS-NAME-SW
 14987             GO TO 5360-EXIT
 14988         ELSE
 14989             GO TO 5360-EXIT.
 14990
 14991     GO TO 5360-MOVE-NAME-CYCLE.
 14992
 14993 5360-EXIT.
 14994     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 286
* EL156.cbl
 14996 6000-BUILD-SCREEN-B.
 14997     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14998     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14999     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15000     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15001
 15002     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 15003
 15004 6050-BUILD-SCREEN.
 15005     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 15006     MOVE LOW-VALUES             TO EL156BI.
 15007     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 15008
 15009     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 15010
 15011     IF PI-PAYEE-TYPE = 'I'
 15012        GO TO 6060-READ-TRAILER.
 15013
 15014     IF PI-PAYEE-TYPE = 'B'
 15015        ADD +10                  TO TRLR-SEQ-NO
 15016        GO TO 6060-READ-TRAILER.
 15017
 15018     IF PI-PAYEE-TYPE = 'A'
 15019        ADD +20                  TO TRLR-SEQ-NO
 15020        GO TO 6060-READ-TRAILER.
 15021
 15022     IF PI-PAYEE-TYPE = 'O'
 15023        ADD +50                  TO TRLR-SEQ-NO
 15024        GO TO 6060-READ-TRAILER.
 15025
 15026     IF PI-PAYEE-TYPE = 'Q'
 15027        ADD +60                  TO TRLR-SEQ-NO
 15028        GO TO 6060-READ-TRAILER.
 15029
 15030     IF PI-PAYEE-TYPE = 'P'
 15031        ADD +30                  TO TRLR-SEQ-NO
 15032        GO TO 6060-READ-TRAILER.
 15033
 15034     IF PI-PAYEE-TYPE = 'E'
 15035        ADD +40                  TO TRLR-SEQ-NO.
 15036
 15037 6060-READ-TRAILER.
 15038
 15039     IF PI-PAYEE-TYPE    = 'A' AND
 15040        PI-PAYEE-SEQ-NUM = 0
 15041          GO TO 6061-READ-ACCOUNT.
 15042
 15043     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 15044        (PI-PAYEE-TYPE    = 'B')             AND
 15045        (PI-PAYEE-SEQ-NUM = 9)
 15046          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15047          IF BENE-FOUND-SW = 'N'
 15048            GO TO 6065-NOT-FOUND
 15049          ELSE
 15050            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15051            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15052            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15053*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 287
* EL156.cbl
 15054            STRING BE-CITY ' ' BE-STATE
 15055               DELIMITED BY '  ' INTO CITYSTBO
 15056            END-STRING
 15057            MOVE BE-ZIP-CODE       TO ZIPBO
 15058            GO TO 6061-READ-ACCOUNT.
 15059
 15060     IF PI-PAYEE-TYPE    = 'B' AND
 15061        PI-PAYEE-SEQ-NUM = 0
 15062          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15063          IF BENE-FOUND-SW = 'N'
 15064            GO TO 6065-NOT-FOUND
 15065          ELSE
 15066            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15067            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15068            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15069*           MOVE BE-CITY-STATE     TO CITYSTBO
 15070            STRING BE-CITY ' ' BE-STATE
 15071               DELIMITED BY '  ' INTO CITYSTBO
 15072            END-STRING
 15073            MOVE BE-ZIP-CODE       TO ZIPBO
 15074            if be-ach-yes-or-no = 'Y'
 15075               move 'Y'          to pi-ach-payment
 15076            else
 15077               move 'N'          to pi-ach-payment
 15078            end-if
 15079            GO TO 6061-READ-ACCOUNT.
 15080
 15081
 15082* EXEC CICS HANDLE CONDITION
 15083*         NOTFND(6065-NOT-FOUND)
 15084*     END-EXEC.
 15085*    MOVE '"$I                   ! / #00014200' TO DFHEIV0
 15086     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15087     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15088     MOVE X'2F20233030303134323030' TO DFHEIV0(25:11)
 15089     CALL 'kxdfhei1' USING DFHEIV0
 15090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15091
 15092
 15093     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15094
 15095     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 15096     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 15097     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 15098     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 15099*    MOVE AT-CITY-STATE          TO CITYSTBO.
 15100     STRING AT-CITY ' ' AT-STATE
 15101        DELIMITED BY '  ' INTO CITYSTBO
 15102     END-STRING
 15103     MOVE AT-ZIP-CODE            TO ZIPBO.
 15104
 15105 6061-READ-ACCOUNT.
 15106
 15107* EXEC CICS HANDLE CONDITION
 15108*         NOTFND(6068-ACCT-NOT-FND)
 15109*     END-EXEC.
 15110*    MOVE '"$I                   ! 0 #00014217' TO DFHEIV0
 15111     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 288
* EL156.cbl
 15112     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15113     MOVE X'3020233030303134323137' TO DFHEIV0(25:11)
 15114     CALL 'kxdfhei1' USING DFHEIV0
 15115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15116
 15117
 15118
 15119* EXEC CICS READ
 15120*         DATASET('ERACCT')
 15121*         SET    (ADDRESS OF ACCOUNT-MASTER)
 15122*         RIDFLD (PI-ACCT-KEY)
 15123*     END-EXEC.
 15124     MOVE 'ERACCT' TO DFHEIV1
 15125*    MOVE '&"S        E          (   #00014221' TO DFHEIV0
 15126     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15127     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15128     MOVE X'2020233030303134323231' TO DFHEIV0(25:11)
 15129     CALL 'kxdfhei1' USING DFHEIV0,
 15130           DFHEIV1,
 15131           DFHEIV20,
 15132           DFHEIV99,
 15133           PI-ACCT-KEY,
 15134           DFHEIV99,
 15135           DFHEIV99,
 15136           DFHEIV99
 15137     SET ADDRESS OF ACCOUNT-MASTER TO
 15138         DFHEIV20
 15139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15140
 15141
 15142     MOVE AM-CARRIER             TO ACARRBO.
 15143     MOVE AM-GROUPING            TO GROUPBO.
 15144     MOVE AM-STATE               TO STATEBO.
 15145     MOVE AM-ACCOUNT             TO ACCTBO.
 15146     MOVE AM-NAME                TO ACCTNMBO.
 15147
 15148     IF PI-PAYEE-TYPE = 'A' AND
 15149        PI-PAYEE-SEQ-NUM = 0
 15150          MOVE AM-NAME             TO NAMEBO
 15151                                      PI-PAYEE-NAME
 15152          MOVE AM-ADDRS            TO ADDR1BO
 15153          MOVE SPACES              TO ADDR2BO
 15154*         MOVE AM-CITY             TO CITYSTBO
 15155          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 15156             DELIMITED BY '  ' INTO CITYSTBO
 15157          END-STRING
 15158          MOVE AM-ZIP-PRIME        TO WS-ZIP
 15159          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 15160          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 15161          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 15162
 15163***  We don't really need the code below because we don't do the
 15164***  AK thing anymore.  However, we may have a state special
 15165***  of some sort in the future so why not just leave it??
 15166     IF CITYSTBO EQUAL SPACES
 15167         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15168         GO TO 6070-FORMAT-DATA
 15169     END-IF.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 289
* EL156.cbl
 15170
 15171     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 15172     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 15173     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 15174     PERFORM VARYING WS-SUB FROM 30 BY -1
 15175          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 15176        IF WS-END-SUB = 0  AND
 15177           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
 15178              OR LOW-VALUES  OR '.')
 15179            CONTINUE
 15180        ELSE
 15181            IF WS-END-SUB = 0
 15182                MOVE WS-SUB TO WS-END-SUB
 15183            ELSE
 15184                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 15185                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 15186                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15187                END-IF
 15188            END-IF
 15189        END-IF
 15190        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 15191            COMPUTE WS-BEG-SUB = WS-SUB + 1
 15192            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15193        END-IF
 15194     END-PERFORM.
 15195
 15196     IF WS-BEG-SUB > 0
 15197         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 15198         IF WS-STATE-LENGTH = 2
 15199             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 15200                  TO PI-CHECK-STATE-FOR-AK
 15201         ELSE
 15202             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 15203                'ALASKA'
 15204                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 15205             ELSE
 15206                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15207             END-IF
 15208         END-IF
 15209     ELSE
 15210         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15211     END-IF.
 15212
 15213     GO TO 6070-FORMAT-DATA.
 15214
 15215 6065-NOT-FOUND.
 15216     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 15217     GO TO 6061-READ-ACCOUNT.
 15218
 15219 6068-ACCT-NOT-FND.
 15220     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 15221
 15222 6070-FORMAT-DATA.
 15223     IF PI-HOLDTIL = ZEROS
 15224        MOVE SAVE-DATE           TO PAYDTBI
 15225       ELSE
 15226        MOVE PI-HOLDTIL          TO PAYDTBO
 15227        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 290
* EL156.cbl
 15228
 15229     MOVE PI-PROOF-DATE          TO PROOFDBO.
 15230     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 15231
 15232     IF EIBAID = DFHPF3 OR DFHPF4
 15233        NEXT SENTENCE
 15234     ELSE
 15235       GO TO 6071-CONTINUE.
 15236
 15237     MOVE PI-EPYFROM          TO PYFROMBO.
 15238     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 15239
 15240     IF NOT PI-USES-PAID-TO
 15241        MOVE PI-EPYTHRU          TO PYTHRUBO
 15242        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 15243     ELSE
 15244        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 15245        MOVE '4'              TO DC-OPTION-CODE
 15246        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15247        IF NO-CONVERSION-ERROR
 15248           MOVE +1            TO DC-ELAPSED-DAYS
 15249           MOVE +0            TO DC-ELAPSED-MONTHS
 15250           MOVE '6'           TO DC-OPTION-CODE
 15251           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15252           IF NO-CONVERSION-ERROR
 15253              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15254
 15255     MOVE PI-EDAYS            TO DAYSBO.
 15256     MOVE PI-EPYAMT           TO PAYAMTBO.
 15257     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15258        IF PI-INT-AMT > ZEROS
 15259           MOVE PI-INT-AMT       TO INTAMTBO
 15260        END-IF
 15261     END-IF
 15262     GO TO 6072-SET-TYPE.
 15263
 15264 6071-CONTINUE.
 15265
 15266     IF PI-CPYFROM NOT = LOW-VALUES
 15267        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 15268        MOVE SPACES              TO DC-OPTION-CODE
 15269        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15270        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 15271
 15272     IF PI-CPYTHRU NOT = LOW-VALUES
 15273        IF NOT PI-USES-PAID-TO
 15274           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15275           MOVE SPACES             TO DC-OPTION-CODE
 15276           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15277           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15278        ELSE
 15279           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15280           MOVE '6'                TO DC-OPTION-CODE
 15281           MOVE +1                 TO DC-ELAPSED-DAYS
 15282           MOVE +0                 TO DC-ELAPSED-MONTHS
 15283           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15284           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15285
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 291
* EL156.cbl
 15286     MOVE PI-CDAYS               TO DAYSBO.
 15287     MOVE PI-CPYAMT              TO PAYAMTBO.
 15288     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15289        IF PI-INT-AMT > ZEROS
 15290           MOVE PI-INT-AMT       TO INTAMTBO
 15291        END-IF
 15292     END-IF
 15293     .
 15294 6072-SET-TYPE.
 15295     IF PI-PMTTYPE = '1'
 15296        MOVE 'PARTIAL'           TO PAYTYPBO.
 15297
 15298     IF PI-PMTTYPE = '2'
 15299        MOVE 'FINAL'             TO PAYTYPBO.
 15300
 15301     IF PI-PMTTYPE = '3'
 15302        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15303
 15304     IF PI-PMTTYPE = '4'
 15305        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15306
 15307     IF PI-PMTTYPE = '5'
 15308        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15309
 15310     IF PI-PMTTYPE = '6'
 15311        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15312
 15313     IF PI-PROV-PMT
 15314        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15315
 15316     IF PI-ECHECKNO NOT = SPACES
 15317        MOVE PI-ECHECKNO         TO CKNUMBO
 15318     ELSE
 15319        MOVE PI-CCHECKNO         TO CKNUMBO.
 15320
 15321     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 15322        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15323        MOVE +91                 TO  TRLR-SEQ-NO
 15324
 15325* EXEC CICS READ
 15326*           DATASET  ('ELTRLR')
 15327*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15328*           RIDFLD   (ELTRLR-KEY)
 15329*           RESP     (WS-RESPONSE)
 15330*       END-EXEC
 15331     MOVE 'ELTRLR' TO DFHEIV1
 15332*    MOVE '&"S        E          (  N#00014409' TO DFHEIV0
 15333     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15334     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15335     MOVE X'204E233030303134343039' TO DFHEIV0(25:11)
 15336     CALL 'kxdfhei1' USING DFHEIV0,
 15337           DFHEIV1,
 15338           DFHEIV20,
 15339           DFHEIV99,
 15340           ELTRLR-KEY,
 15341           DFHEIV99,
 15342           DFHEIV99,
 15343           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 292
* EL156.cbl
 15344     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15345         DFHEIV20
 15346     MOVE EIBRESP  TO WS-RESPONSE
 15347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15348
 15349        IF WS-RESP-NORMAL
 15350           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15351        ELSE
 15352           MOVE SPACES           TO  LOANNBO
 15353        END-IF
 15354     END-IF
 15355
 15356*       MOVE PI-LOAN-NO          TO LOANNBO
 15357
 15358     IF CKNUMBO = SPACES
 15359         MOVE SPACES             TO CKNUMHDO.
 15360
 15361     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15362     MOVE CL-CARRIER             TO CARRBO.
 15363     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15364     MOVE CL-CERT-SFX            TO SUFXBO.
 15365
 15366     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 15367        EVALUATE CL-CLAIM-TYPE
 15368           WHEN 'I'
 15369              MOVE '  IU  '      TO CLMTYPBO
 15370           WHEN 'G'
 15371              MOVE ' GAP  '      TO CLMTYPBO
 15372           WHEN 'F'
 15373              MOVE ' FMLA '      TO CLMTYPBO
 15374           WHEN OTHER
 15375              MOVE PI-AH-OVERRIDE-L6
 15376                                 TO CLMTYPBO
 15377        END-EVALUATE
 15378        MOVE ZEROS               TO UNDISBO
 15379*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15380        IF PI-PMTTYPE = '5' OR '6'
 15381           GO TO 6073-GET-NOTIFY-DATA
 15382        ELSE
 15383           MOVE PI-DAILY-RATE    TO RATEBO
 15384           GO TO 6073-GET-NOTIFY-DATA.
 15385
 15386     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15387
 15388     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15389        MOVE ZEROS               TO UNDISBO
 15390     ELSE
 15391        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15392
 15393 6073-GET-NOTIFY-DATA.
 15394
 15395     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15396
 15397     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15398         MOVE SPACES             TO  NAMEB2O
 15399                                     ADDR1B2O
 15400                                     ADDR2B2O
 15401                                     CITYST2O
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 293
* EL156.cbl
 15402                                     AGTHDGO
 15403         MOVE ZEROS              TO  ZIPB2O
 15404         GO TO 6080-SET-INCURRED.
 15405
 15406     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 15407     MOVE +29                    TO  TRLR-SEQ-NO.
 15408
 15409
 15410* EXEC CICS HANDLE CONDITION
 15411*        NOTFND   (6074-GET-COMP-DATA)
 15412*    END-EXEC.
 15413*    MOVE '"$I                   ! 1 #00014476' TO DFHEIV0
 15414     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15415     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15416     MOVE X'3120233030303134343736' TO DFHEIV0(25:11)
 15417     CALL 'kxdfhei1' USING DFHEIV0
 15418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15419
 15420
 15421     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15422
 15423     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15424     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15425     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15426*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15427     STRING AT-CITY ' ' AT-STATE
 15428        DELIMITED BY '  ' INTO CITYST2O
 15429     END-STRING
 15430     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15431     GO TO 6080-SET-INCURRED.
 15432
 15433 6074-GET-COMP-DATA.
 15434
 15435     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15436         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15437
 15438     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15439         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15440                                         ADDR1B2O
 15441                                         ADDR2B2O
 15442                                         CITYST2O
 15443         MOVE ZEROS                  TO  ZIPB2O
 15444         GO TO 6080-SET-INCURRED.
 15445
 15446     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15447     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15448     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15449     MOVE AM-GROUPING            TO  COMP-GROUP.
 15450     MOVE 'A'                    TO  COMP-TYPE.
 15451     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15452                                 TO  COMP-FIN-RESP.
 15453
 15454     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15455         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15456                                       'G' OR 'B' or 'S'
 15457             MOVE 'G'            TO  COMP-TYPE
 15458             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15459         ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 294
* EL156.cbl
 15460             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15461                                 TO  COMP-ACCOUNT
 15462     ELSE
 15463         MOVE 'G'                TO  COMP-TYPE
 15464         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 15465
 15466     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15467
 15468     IF COMP-REC-FOUND
 15469         MOVE CO-ACCT-NAME       TO  NAMEB2O
 15470         MOVE CO-ADDR-1          TO  ADDR1B2O
 15471         MOVE CO-ADDR-2          TO  ADDR2B2O
 15472*        MOVE CO-ADDR-3          TO  CITYST2O
 15473         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15474            DELIMITED BY '  ' INTO CITYST2O
 15475         END-STRING
 15476         MOVE CO-ZIP             TO  ZIPB2O
 15477     ELSE
 15478         MOVE 'NO COMP ADDRESS AVAILABLE'
 15479                                 TO  NAMEB2O
 15480                                     ADDR1B2O
 15481                                     ADDR2B2O
 15482                                     CITYST2O
 15483         MOVE ZEROS               TO ZIPB2O.
 15484
 15485 6080-SET-INCURRED.
 15486     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15487     MOVE SPACES                 TO DC-OPTION-CODE.
 15488     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15489     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15490     MOVE PI-PROCESSOR-ID        TO BYBO.
 15491     MOVE MAP-NAMEB              TO MAP-NAME.
 15492     MOVE 'C'                    TO PI-PASS-SW.
 15493     MOVE EIBAID                 TO PI-PFKEY-USED.
 15494     MOVE -1                     TO ENTPFBL.
 15495     GO TO 8100-SEND-INITIAL-MAP.
 15496
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 295
* EL156.cbl
 15498 6100-BUILD-PAYMENT-TRAILER.
 15499
 15500     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15501     MOVE '6'                    TO CNTL-REC-TYPE.
 15502
 15503     IF CONTROL-IS-ACTUAL-CARRIER
 15504         MOVE PI-CARRIER         TO WS-CARR
 15505     ELSE
 15506         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15507
 15508     IF PI-COMPANY-ID = 'FIA'
 15509         MOVE PI-CARRIER         TO  WS-CARR.
 15510
 15511     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15512     MOVE 0                      TO CNTL-SEQ-NO.
 15513     MOVE 'CARR'                 TO FILE-SWITCH.
 15514
 15515     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15516
 15517     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15518         IF PI-OFFLINE     = 'Y' AND
 15519            PI-ECHECKNO-CR = 'CR'
 15520              GO TO 6110-READ-CONTROL
 15521         ELSE
 15522            IF PI-CASH = 'N'
 15523                GO TO 6110-READ-CONTROL.
 15524
 15525     IF CHECK-NO-MANUAL    OR
 15526        CHECK-NO-AT-PRINT  OR
 15527        PI-OFFLINE = 'Y'
 15528          GO TO 6130-BUILD-TRAILER.
 15529     IF PI-COMPANY-ID = 'FIA'
 15530         NEXT SENTENCE
 15531     ELSE
 15532         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15533             GO TO 6110-READ-CONTROL.
 15534
 15535     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15536
 15537     IF CHECK-CNT-RESET-VALUE
 15538        MOVE +1                  TO CF-CHECK-COUNTER
 15539     ELSE
 15540        ADD +1                   TO CF-CHECK-COUNTER.
 15541
 15542     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15543
 15544     IF CHECK-NO-CARR-SEQ
 15545        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15546
 15547     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15548
 15549     MOVE 'N' TO PI-REAUDIT-NEEDED.
 15550     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15551        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15552         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15553         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15554            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 15555         MOVE WRK-NEXT-AUDIT-CHK-NO TO
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 296
* EL156.cbl
 15556                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15557     END-IF.
 15558
 15559     GO TO 6120-REWRITE.
 15560
 15561 6105-STATE-CHECK-NUMBER.
 15562     IF CHECK-NO-MANUAL    OR
 15563        CHECK-NO-AT-PRINT  OR
 15564        PI-OFFLINE = 'Y'
 15565           GO TO 6130-BUILD-TRAILER
 15566     END-IF.
 15567
 15568     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15569     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15570     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15571     MOVE '3'                TO CNTL-REC-TYPE.
 15572     MOVE +0                 TO CNTL-SEQ-NO.
 15573     MOVE 'STAT'             TO FILE-SWITCH.
 15574     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15575
 15576     IF CF-ST-CHECK-CNT-RESET
 15577         MOVE +1             TO CF-ST-CHECK-COUNTER
 15578     ELSE
 15579         ADD +1              TO CF-ST-CHECK-COUNTER
 15580     END-IF.
 15581
 15582     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15583     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15584     GO TO 6120-REWRITE.
 15585
 15586 6110-READ-CONTROL.
 15587     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15588     MOVE '1'                    TO CNTL-REC-TYPE.
 15589     MOVE SPACES                 TO CNTL-ACCESS.
 15590     MOVE 0                      TO CNTL-SEQ-NO.
 15591
 15592     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15593
 15594     IF CO-CHECK-COUNT-RESET
 15595        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15596     ELSE
 15597        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15598
 15599     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15600
 15601     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15602         IF PI-OFFLINE     = 'Y'  AND
 15603            PI-ECHECKNO-CR = 'CR'
 15604              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15605              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15606              MOVE AL-UANON           TO CHECKNOA
 15607              GO TO 6120-REWRITE
 15608         ELSE
 15609         IF PI-CASH = 'N'
 15610             MOVE 'N'                TO PI-ECHECKNO-N
 15611             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15612             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15613             MOVE AL-UANON           TO CHECKNOA
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 297
* EL156.cbl
 15614             GO TO 6120-REWRITE.
 15615
 15616     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15617
 15618 6120-REWRITE.
 15619
 15620* EXEC CICS REWRITE
 15621*         DATASET('ELCNTL')
 15622*         FROM(CONTROL-FILE)
 15623*     END-EXEC.
 15624     MOVE LENGTH OF
 15625      CONTROL-FILE
 15626       TO DFHEIV11
 15627     MOVE 'ELCNTL' TO DFHEIV1
 15628*    MOVE '&& L                  %   #00014678' TO DFHEIV0
 15629     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15630     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15631     MOVE X'2020233030303134363738' TO DFHEIV0(25:11)
 15632     CALL 'kxdfhei1' USING DFHEIV0,
 15633           DFHEIV1,
 15634           CONTROL-FILE,
 15635           DFHEIV11,
 15636           DFHEIV99
 15637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15638
 15639
 15640     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15641
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 298
* EL156.cbl
 15643 6130-BUILD-TRAILER.
 15644
 15645
 15646* EXEC CICS GETMAIN
 15647*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15648*         LENGTH    (200)
 15649*         INITIMG   (GETMAIN-SPACE)
 15650*     END-EXEC.
 15651     MOVE 200
 15652       TO DFHEIV11
 15653*    MOVE ',"IL                  $   #00014688' TO DFHEIV0
 15654     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15655     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15656     MOVE X'2020233030303134363838' TO DFHEIV0(25:11)
 15657     CALL 'kxdfhei1' USING DFHEIV0,
 15658           DFHEIV20,
 15659           DFHEIV11,
 15660           GETMAIN-SPACE
 15661     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15662         DFHEIV20
 15663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15664
 15665
 15666     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15667                                    AT-PREV-PAID-THRU-DT.
 15668     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15669     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15670     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15671     MOVE 'AT'                   TO AT-RECORD-ID.
 15672     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15673
 15674     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15675        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15676           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15677     ELSE
 15678           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15679           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15680
 15681     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15682         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15683             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15684             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15685           ELSE
 15686             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15687             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15688
 15689     MOVE '2'                    TO AT-TRAILER-TYPE.
 15690     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15691                                    AT-PAYMENT-LAST-MAINT-DT.
 15692     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15693                                    AT-PAYMENT-LAST-UPDATED-BY.
 15694     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15695     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15696     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15697     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15698
 15699     IF PI-PMT-APPROVED
 15700        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 299
* EL156.cbl
 15701           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15702
 15703     IF PI-PFKEY-USED = DFHPF5
 15704        GO TO 6140-PF5-ENTERED.
 15705
 15706     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15707     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15708
 15709     IF PI-AIG-SPECIAL-BENEFIT
 15710         IF WS-1ST-SPECIAL-PMT
 15711             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15712             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15713                                        AT-AMOUNT-PAID
 15714         ELSE
 15715             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15716
 15717     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15718
 15719     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15720     MOVE '4'                    TO DC-OPTION-CODE.
 15721     PERFORM 9700-LINK-DATE-CONVERT.
 15722
 15723     IF DATE-CONVERSION-ERROR
 15724        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15725     ELSE
 15726        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15727
 15728     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15729     MOVE '4'                    TO DC-OPTION-CODE.
 15730     PERFORM 9700-LINK-DATE-CONVERT.
 15731
 15732     IF DATE-CONVERSION-ERROR
 15733        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15734     ELSE
 15735        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15736
 15737     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD
 15738     move pi-ach-payment         to at-ach-payment
 15739     GO TO 6150-FINISH-MOVE.
 15740
 15741 6140-PF5-ENTERED.
 15742     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15743     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15744
 15745     IF PI-AIG-SPECIAL-BENEFIT
 15746         IF WS-1ST-SPECIAL-PMT
 15747             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15748             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15749                                        AT-AMOUNT-PAID
 15750         ELSE
 15751             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15752
 15753     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15754     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15755     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15756
 15757 6150-FINISH-MOVE.
 15758
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 300
* EL156.cbl
 15759     IF PI-ECHECKNO = SPACES
 15760         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15761     ELSE
 15762         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15763
 15764     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15765     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15766
 15767*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15768*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15769
 15770     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15771         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15772
 15773     IF PI-OFFLINE = 'N'
 15774        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15775        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15776     ELSE
 15777        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15778        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15779
 15780     move pi-ach-payment         to at-ach-payment
 15781     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15782
 15783     IF WS-2ND-SPECIAL-PMT
 15784         MOVE 'Y'                TO AT-CASH-PAYMENT
 15785         MOVE SPACES             TO AT-CHECK-NO
 15786         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15787         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15788         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15789         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15790
 15791     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15792                                    AT-TO-BE-WRITTEN-DT.
 15793
 15794     IF PI-HOLDTIL NOT = ZEROS
 15795        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15796        MOVE '4'                 TO DC-OPTION-CODE
 15797        PERFORM 9700-LINK-DATE-CONVERT
 15798        IF PI-OFFLINE = 'N'
 15799           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15800        ELSE
 15801           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15802
 15803     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15804     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15805                                    AT-CHECK-QUE-SEQUENCE.
 15806
 15807     IF PI-PFKEY-USED = DFHPF4
 15808        MOVE '1'                 TO AT-FORCE-CONTROL.
 15809
 15810     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15811        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15812        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15813        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15814
 15815     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15816                                    AT-VOID-SELECT-DT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 301
* EL156.cbl
 15817                                    AT-VOID-ACCEPT-DT
 15818                                    AT-VOID-DT.
 15819     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 15820        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15821        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15822        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15823        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15824     ELSE
 15825        MOVE ZEROS               TO AT-DAILY-RATE
 15826                                    AT-ELIMINATION-DAYS
 15827        MOVE SPACES              TO AT-BENEFIT-TYPE
 15828     END-IF
 15829     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15830     MOVE '4'                    TO DC-OPTION-CODE.
 15831     PERFORM 9700-LINK-DATE-CONVERT.
 15832     IF DATE-CONVERSION-ERROR
 15833         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15834     ELSE
 15835         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15836     END-IF.
 15837     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15838     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15839     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15840     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15841     IF (PI-REAUDIT-NEEDED = 'Y')
 15842        or (pi-max-ext-used = 'Y')
 15843        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 15844         PERFORM 6155-READ-CONTROL
 15845         PERFORM 6157-SET-APP-LEVEL
 15846         IF AT-APPROVAL-LEVEL-REQD < '4'
 15847            MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15848         END-IF
 15849         MOVE 'Y' TO WS-NEED-APPROVAL
 15850         GO TO 6170-WRITE
 15851     END-IF.
 15852*******************************************************
 15853     IF NOT PI-PMT-GRADUATED
 15854         GO TO 6170-WRITE.
 15855     PERFORM 6155-READ-CONTROL.
 15856
 15857     IF PAID-FOR-LIFE
 15858         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15859             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15860                                     WS-PMT-APPROVAL-SW
 15861             GO TO 6170-WRITE.
 15862
 15863*05999      IF PAID-FOR-AH
 15864     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15865         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15866             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15867                                     WS-PMT-APPROVAL-SW
 15868             GO TO 6170-WRITE.
 15869
 15870     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15871
 15872     PERFORM 6157-SET-APP-LEVEL.
 15873
 15874     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 302
* EL156.cbl
 15875
 15876     IF NOT PI-PMT-GRADUATED
 15877         GO TO 6170-WRITE.
 15878
 15879
 15880* EXEC CICS HANDLE CONDITION
 15881*        NOTFND   (6170-WRITE)
 15882*    END-EXEC.
 15883*    MOVE '"$I                   ! 2 #00014907' TO DFHEIV0
 15884     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15885     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15886     MOVE X'3220233030303134393037' TO DFHEIV0(25:11)
 15887     CALL 'kxdfhei1' USING DFHEIV0
 15888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15889
 15890
 15891     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15892     MOVE '2'                    TO CNTL-REC-TYPE.
 15893     MOVE +0                     TO CNTL-SEQ-NO.
 15894     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15895
 15896
 15897* EXEC CICS READ
 15898*         DATASET  ('ELCNTL')
 15899*         SET      (ADDRESS OF CONTROL-FILE)
 15900*         RIDFLD   (ELCNTL-KEY)
 15901*    END-EXEC.
 15902     MOVE 'ELCNTL' TO DFHEIV1
 15903*    MOVE '&"S        E          (   #00014916' TO DFHEIV0
 15904     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15905     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15906     MOVE X'2020233030303134393136' TO DFHEIV0(25:11)
 15907     CALL 'kxdfhei1' USING DFHEIV0,
 15908           DFHEIV1,
 15909           DFHEIV20,
 15910           DFHEIV99,
 15911           ELCNTL-KEY,
 15912           DFHEIV99,
 15913           DFHEIV99,
 15914           DFHEIV99
 15915     SET ADDRESS OF CONTROL-FILE TO
 15916         DFHEIV20
 15917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15918
 15919
 15920     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 15921
 15922     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15923                         OR '4' OR '5'
 15924         NEXT SENTENCE
 15925     ELSE
 15926         MOVE 'Y' TO WS-NEED-APPROVAL
 15927         GO TO 6170-WRITE.
 15928
 15929     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15930         MOVE 'Y' TO WS-NEED-APPROVAL
 15931         IF WS-APPROVAL-LEVEL = '1'
 15932             MOVE '2'        TO  AT-APPROVED-LEVEL
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 303
* EL156.cbl
 15933                            WS-SAVE-APPROVED-LEVEL
 15934             GO TO 6170-WRITE
 15935         ELSE
 15936             IF WS-APPROVAL-LEVEL = '2'
 15937                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15938                                WS-SAVE-APPROVED-LEVEL
 15939                 GO TO 6170-WRITE
 15940             ELSE IF WS-APPROVAL-LEVEL = '3'
 15941                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15942                                WS-SAVE-APPROVED-LEVEL
 15943                 GO TO 6170-WRITE
 15944             ELSE IF WS-APPROVAL-LEVEL = '4'
 15945                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15946                                WS-SAVE-APPROVED-LEVEL
 15947                 GO TO 6170-WRITE.
 15948
 15949     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15950                             WS-PMT-APPROVAL-SW.
 15951     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15952                             AT-APPROVAL-LEVEL-REQD.
 15953
 15954*******************************************************
 15955 6155-READ-CONTROL.
 15956     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15957     MOVE '1'                    TO CNTL-REC-TYPE.
 15958     MOVE SPACES                 TO CNTL-ACCESS.
 15959     MOVE +0                     TO CNTL-SEQ-NO.
 15960     MOVE 'COMP'                 TO FILE-SWITCH.
 15961
 15962     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15963 6157-SET-APP-LEVEL.
 15964******A&H Limits are set as a monthly payment.  Calculate the mont
 15965******equivalent of the amount paid today
 15966     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 15967        PI-SAVE-ODD-DAYS-OVER > 0
 15968           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 15969                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15970           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15971                                  WS-CALC-PMT-MONTHS
 15972     ELSE
 15973           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15974     END-IF.
 15975*06007      IF ((PAID-FOR-AH) AND
 15976     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 15977           OR PAID-FOR-FAM) AND
 15978*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15979        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15980              OR
 15981        ((PAID-FOR-LIFE) AND
 15982        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15983            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15984       ELSE
 15985*06014      IF ((PAID-FOR-AH)  AND
 15986         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 15987           OR PAID-FOR-FAM) AND
 15988*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15989           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15990              OR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 304
* EL156.cbl
 15991        ((PAID-FOR-LIFE) AND
 15992        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15993            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15994         ELSE
 15995*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15996           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 15997                OR PAID-FOR-FAM) AND
 15998               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15999              OR
 16000          ((PAID-FOR-LIFE) AND
 16001          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 16002            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16003       ELSE
 16004           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16005                OR PAID-FOR-FAM) AND
 16006               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 16007              OR
 16008          ((PAID-FOR-LIFE) AND
 16009          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 16010            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16011       ELSE
 16012            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16013
 16014     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16015           OR PAID-FOR-FAM) AND
 16016        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 16017        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 16018            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 16019        END-IF
 16020     ELSE
 16021     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16022           OR PAID-FOR-FAM) AND
 16023        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 16024        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 16025            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 16026        END-IF
 16027     ELSE
 16028     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16029           OR PAID-FOR-FAM) AND
 16030        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 16031        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 16032            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16033        END-IF
 16034     ELSE
 16035     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16036           OR PAID-FOR-FAM) AND
 16037        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 16038        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 16039            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16040        END-IF
 16041     ELSE
 16042     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16043           OR PAID-FOR-FAM)
 16044            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16045
 16046 6170-WRITE.
 16047
 16048     if pi-company-id = 'DCC' or 'CAP'
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 305
* EL156.cbl
 16049        PERFORM 0900-GET-DDF-limits
 16050                                 THRU 0900-EXIT
 16051     end-if
 16052     perform 2220-update-elcrtt  thru 2220-exit
 16053     IF PI-COMPANY-ID = 'DMD'
 16054        IF PI-AT-EOB-CODES NOT = SPACES
 16055           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16056           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16057           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16058           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16059           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16060
 16061
 16062* EXEC CICS HANDLE CONDITION
 16063*        DUPREC    (6180-DUPREC)
 16064*    END-EXEC.
 16065*    MOVE '"$%                   ! 3 #00015063' TO DFHEIV0
 16066     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16067     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16068     MOVE X'3320233030303135303633' TO DFHEIV0(25:11)
 16069     CALL 'kxdfhei1' USING DFHEIV0
 16070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16071
 16072
 16073
 16074* EXEC CICS WRITE
 16075*         DATASET       ('ELTRLR')
 16076*         FROM          (ACTIVITY-TRAILERS)
 16077*         RIDFLD        (AT-CONTROL-PRIMARY)
 16078*     END-EXEC.
 16079     MOVE LENGTH OF
 16080      ACTIVITY-TRAILERS
 16081       TO DFHEIV11
 16082     MOVE 'ELTRLR' TO DFHEIV1
 16083*    MOVE '&$ L                  ''   #00015067' TO DFHEIV0
 16084     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16085     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16086     MOVE X'2020233030303135303637' TO DFHEIV0(25:11)
 16087     CALL 'kxdfhei1' USING DFHEIV0,
 16088           DFHEIV1,
 16089           ACTIVITY-TRAILERS,
 16090           DFHEIV11,
 16091           AT-CONTROL-PRIMARY,
 16092           DFHEIV99,
 16093           DFHEIV99
 16094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16095
 16096
 16097     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 16098        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 16099*06088           GO TO 6199-EXIT.
 16100           GO TO 6176-APPROVAL-NOTE.
 16101
 16102
 16103* EXEC CICS GETMAIN
 16104*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16105*         LENGTH    (200)
 16106*         INITIMG   (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 306
* EL156.cbl
 16107*     END-EXEC.
 16108     MOVE 200
 16109       TO DFHEIV11
 16110*    MOVE ',"IL                  $   #00015078' TO DFHEIV0
 16111     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16112     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16113     MOVE X'2020233030303135303738' TO DFHEIV0(25:11)
 16114     CALL 'kxdfhei1' USING DFHEIV0,
 16115           DFHEIV20,
 16116           DFHEIV11,
 16117           GETMAIN-SPACE
 16118     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16119         DFHEIV20
 16120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16121
 16122
 16123     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16124
 16125     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 16126     MOVE 'AT'                   TO AT-RECORD-ID.
 16127     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16128     MOVE '6'                    TO AT-TRAILER-TYPE.
 16129     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16130                                    AT-GEN-INFO-LAST-MAINT-DT
 16131     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16132                                    AT-GEN-INFO-LAST-UPDATED-BY
 16133     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16134
 16135     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 16136     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 16137     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 16138
 16139     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 16140
 16141 6175-WRITE.
 16142
 16143
 16144* EXEC CICS HANDLE CONDITION
 16145*        DUPREC    (6190-DUPREC)
 16146*    END-EXEC.
 16147*    MOVE '"$%                   ! 4 #00015104' TO DFHEIV0
 16148     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16149     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16150     MOVE X'3420233030303135313034' TO DFHEIV0(25:11)
 16151     CALL 'kxdfhei1' USING DFHEIV0
 16152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16153
 16154
 16155
 16156* EXEC CICS WRITE
 16157*         DATASET     ('ELTRLR')
 16158*         FROM        (ACTIVITY-TRAILERS)
 16159*         RIDFLD      (AT-CONTROL-PRIMARY)
 16160*     END-EXEC.
 16161     MOVE LENGTH OF
 16162      ACTIVITY-TRAILERS
 16163       TO DFHEIV11
 16164     MOVE 'ELTRLR' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 307
* EL156.cbl
 16165*    MOVE '&$ L                  ''   #00015108' TO DFHEIV0
 16166     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16167     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16168     MOVE X'2020233030303135313038' TO DFHEIV0(25:11)
 16169     CALL 'kxdfhei1' USING DFHEIV0,
 16170           DFHEIV1,
 16171           ACTIVITY-TRAILERS,
 16172           DFHEIV11,
 16173           AT-CONTROL-PRIMARY,
 16174           DFHEIV99,
 16175           DFHEIV99
 16176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16177
 16178
 16179 6176-APPROVAL-NOTE.
 16180
 16181     IF NOT APPROVAL-NEEDED
 16182         GO TO 6199-EXIT.
 16183
 16184
 16185* EXEC CICS GETMAIN
 16186*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16187*        LENGTH    (200)
 16188*        INITIMG   (GETMAIN-SPACE)
 16189*    END-EXEC.
 16190     MOVE 200
 16191       TO DFHEIV11
 16192*    MOVE ',"IL                  $   #00015119' TO DFHEIV0
 16193     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16194     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16195     MOVE X'2020233030303135313139' TO DFHEIV0(25:11)
 16196     CALL 'kxdfhei1' USING DFHEIV0,
 16197           DFHEIV20,
 16198           DFHEIV11,
 16199           GETMAIN-SPACE
 16200     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16201         DFHEIV20
 16202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16203
 16204
 16205     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 16206
 16207     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 16208     MOVE 'AT'               TO AT-RECORD-ID
 16209     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 16210     MOVE '6'                TO AT-TRAILER-TYPE
 16211     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 16212                                AT-GEN-INFO-LAST-MAINT-DT
 16213     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 16214                                AT-GEN-INFO-LAST-UPDATED-BY
 16215     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 16216
 16217     IF PI-REAUDIT-NEEDED = 'Y'
 16218         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 16219     ELSE
 16220         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 16221     END-IF
 16222     IF PI-APPROVAL-3550-NEEDED = 'Y'
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 308
* EL156.cbl
 16223         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 16224     END-IF
 16225     MOVE SPACES             TO AT-INFO-LINE-2
 16226
 16227     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 16228 6177-WRITE.
 16229
 16230
 16231* EXEC CICS HANDLE CONDITION
 16232*        DUPREC    (6185-DUPREC)
 16233*    END-EXEC.
 16234*    MOVE '"$%                   ! 5 #00015150' TO DFHEIV0
 16235     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16236     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16237     MOVE X'3520233030303135313530' TO DFHEIV0(25:11)
 16238     CALL 'kxdfhei1' USING DFHEIV0
 16239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16240
 16241
 16242
 16243* EXEC CICS WRITE
 16244*         DATASET     ('ELTRLR')
 16245*         FROM        (ACTIVITY-TRAILERS)
 16246*         RIDFLD      (AT-CONTROL-PRIMARY)
 16247*     END-EXEC.
 16248     MOVE LENGTH OF
 16249      ACTIVITY-TRAILERS
 16250       TO DFHEIV11
 16251     MOVE 'ELTRLR' TO DFHEIV1
 16252*    MOVE '&$ L                  ''   #00015154' TO DFHEIV0
 16253     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16254     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16255     MOVE X'2020233030303135313534' TO DFHEIV0(25:11)
 16256     CALL 'kxdfhei1' USING DFHEIV0,
 16257           DFHEIV1,
 16258           ACTIVITY-TRAILERS,
 16259           DFHEIV11,
 16260           AT-CONTROL-PRIMARY,
 16261           DFHEIV99,
 16262           DFHEIV99
 16263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16264
 16265
 16266
 16267     GO TO 6199-EXIT.
 16268
 16269 6180-DUPREC.
 16270
 16271     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16272     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16273     GO TO 6170-WRITE.
 16274
 16275 6185-DUPREC.
 16276     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16277     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16278     GO TO 6177-WRITE.
 16279
 16280 6190-DUPREC.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 309
* EL156.cbl
 16281     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16282     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16283     GO TO 6175-WRITE.
 16284
 16285 6199-EXIT.
 16286      EXIT.
 16287
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 310
* EL156.cbl
 16289 6200-UPDATE-CLAIM-MSTR.
 16290     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16291     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16292     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16293     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16294
 16295     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16296
 16297     MOVE ZEROS                  TO W-INTEREST.
 16298
 16299     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 16300        IF (PI-OFFLINE = 'Y') OR
 16301           (PI-PMTTYPE = '7')
 16302           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16303                                 THRU 9870-EXIT
 16304        END-IF
 16305     END-IF
 16306     IF NOT ERROR-ON-OUTPUT
 16307        CONTINUE
 16308     ELSE
 16309
 16310* EXEC CICS REWRITE
 16311*          DATASET('ELMSTR')
 16312*          FROM(CLAIM-MASTER)
 16313*       END-EXEC
 16314     MOVE LENGTH OF
 16315      CLAIM-MASTER
 16316       TO DFHEIV11
 16317     MOVE 'ELMSTR' TO DFHEIV1
 16318*    MOVE '&& L                  %   #00015203' TO DFHEIV0
 16319     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16320     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16321     MOVE X'2020233030303135323033' TO DFHEIV0(25:11)
 16322     CALL 'kxdfhei1' USING DFHEIV0,
 16323           DFHEIV1,
 16324           CLAIM-MASTER,
 16325           DFHEIV11,
 16326           DFHEIV99
 16327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16328
 16329        MOVE -1                  TO ENTPFBL
 16330        MOVE AL-UANON            TO ENTPFBA
 16331        MOVE MAP-NAMEB           TO MAP-NAME
 16332        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16333        GO TO 8200-SEND-DATAONLY
 16334     END-IF
 16335
 16336     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16337
 16338     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16339
 16340     IF PI-AIG-SPECIAL-BENEFIT
 16341         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16342
 16343     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16344
 16345     IF PI-SPECIAL-BEN-SW = 'Y'
 16346         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 311
* EL156.cbl
 16347         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16348
 16349     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16350         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16351     ELSE
 16352         IF PI-PMTTYPE NOT = '4'
 16353            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16354
 16355     IF PI-PMTTYPE = '5' OR '6'
 16356        GO TO  6250-SET-MAINT.
 16357
 16358     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16359                                         CL-LAG-REPORT-CODE.
 16360
 16361     IF CL-ACTIVITY-CODE = 09
 16362         GO TO 6200-CONT-UPDATE.
 16363
 16364     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16365         IF CL-ACTIVITY-CODE = 11
 16366             GO TO 6200-CONT-UPDATE.
 16367
 16368     IF WS-ACT-REC-FOUND-SW = 'N'
 16369         GO TO 6200-CONT-UPDATE.
 16370
 16371     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16372         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16373         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16374         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16375
 16376     IF WS-UPDATE-SW = 'Y'
 16377         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16378                                         CL-NEXT-FOLLOWUP-DT.
 16379
 16380 6200-CONT-UPDATE.
 16381
 16382     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16383       IF CLAIM-IS-CLOSED
 16384         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16385           IF WS-OPEN-CLOSE-SW = '2'
 16386             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16387                                        CL-LAST-CLOSE-DT.
 16388
 16389     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16390        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16391        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16392
 16393     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16394        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16395        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16396        MOVE 'C'                 TO CL-CLAIM-STATUS
 16397        IF PI-PMTTYPE = '2'
 16398           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16399              or 'F')
 16400           CONTINUE
 16401        ELSE
 16402           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16403        END-IF
 16404     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 312
* EL156.cbl
 16405        IF PI-PMTTYPE = '2' OR '3'
 16406           IF PI-PMTTYPE = '2' AND
 16407              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16408                 or 'F')
 16409              CONTINUE
 16410           ELSE
 16411              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16412           END-IF
 16413        END-IF
 16414     END-IF
 16415
 16416     IF PI-PMTTYPE = '4'
 16417        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16418
 16419     IF PI-COMPANY-ID = 'CVL'
 16420         IF PI-LOAN-UPDATE-SW = 'Y'
 16421             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16422             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16423             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16424             MOVE CL-CERT-STATE      TO  CERT-STATE
 16425             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16426             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16427             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16428             MOVE 'CERT'             TO  FILE-SWITCH
 16429             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16430             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16431             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16432
 16433     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16434        GO TO 6220-USE-COMPUTED.
 16435
 16436     IF (PI-PMTTYPE = '4')  AND
 16437        (PI-EPYAMT < ZEROS)
 16438          COMPUTE CL-NO-OF-DAYS-PAID =
 16439                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16440          IF CL-NO-OF-DAYS-PAID < +0
 16441              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16442          ELSE
 16443              NEXT SENTENCE
 16444     ELSE
 16445          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16446
 16447     IF PI-PROCESSOR-ID = 'FIX '
 16448        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16449           NEXT SENTENCE
 16450        ELSE
 16451           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16452     ELSE
 16453        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16454
 16455     IF PI-PMTTYPE = '4'
 16456        GO TO 6250-SET-MAINT.
 16457
 16458     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16459
 16460     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16461     MOVE '4'                    TO DC-OPTION-CODE.
 16462     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 313
* EL156.cbl
 16463     IF DATE-CONVERSION-ERROR
 16464        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
 16465     ELSE
 16466        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16467           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16468           IF PI-AIG-SPECIAL-BENEFIT
 16469               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16470           ELSE
 16471               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16472
 16473     GO TO 6250-SET-MAINT.
 16474
 16475 6220-USE-COMPUTED.
 16476
 16477     IF (PI-PMTTYPE = '4')  AND
 16478        (PI-CPYAMT < ZEROS)
 16479          COMPUTE CL-NO-OF-DAYS-PAID =
 16480                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16481          IF CL-NO-OF-DAYS-PAID < +0
 16482              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16483          ELSE
 16484              NEXT SENTENCE
 16485     ELSE
 16486          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16487
 16488     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 16489
 16490     IF PI-PMTTYPE = '4'
 16491        GO TO 6250-SET-MAINT.
 16492
 16493     IF PI-AIG-SPECIAL-BENEFIT
 16494         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16495     ELSE
 16496         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16497
 16498     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16499
 16500     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16501        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16502
 16503 6250-SET-MAINT.
 16504     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16505
 16506     IF PI-PROCESSOR-ID = 'FIX '
 16507        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16508           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16509        ELSE
 16510           NEXT SENTENCE
 16511     ELSE
 16512        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16513
 16514     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 16515     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16516     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16517
 16518 6299-EXIT.
 16519      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 314
* EL156.cbl
 16521 6300-UPDATE-CERT.
 16522
 16523*  ADD CERTNOTE FOR SC NP+6
 16524     IF PI-COMPANY-ID = 'CID' AND
 16525       (PI-PMTTYPE = '2' OR '3') AND
 16526        CL-CERT-STATE = 'SC'  AND
 16527        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16528           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16529     END-IF.
 16530
 16531     IF PI-COMPANY-ID = 'AHL' AND
 16532       (PI-PMTTYPE = '2' OR '3') AND
 16533        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16534           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16535           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16536     END-IF.
 16537
 16538     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16539     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16540     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16541     MOVE CL-CERT-STATE    TO CERT-STATE.
 16542     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16543     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16544     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16545     MOVE 'CERT'           TO FILE-SWITCH.
 16546
 16547     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16548
 16549     IF CERT-NOTE-ADDED
 16550        IF CM-NOTE-SW = ' '
 16551           MOVE '4'             TO CM-NOTE-SW
 16552        ELSE
 16553           IF CM-NOTE-SW = '1'
 16554               MOVE '5'           TO CM-NOTE-SW
 16555           ELSE
 16556              IF CM-NOTE-SW = '2'
 16557                 MOVE '6'         TO CM-NOTE-SW
 16558              ELSE
 16559                 IF CM-NOTE-SW = '3'
 16560                    MOVE '7'      TO CM-NOTE-SW
 16561                 END-IF
 16562              END-IF
 16563           END-IF
 16564        END-IF
 16565     END-IF.
 16566
 16567     IF PI-COMPANY-ID = 'CVL'
 16568         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16569         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16570
 16571     IF PI-PMTTYPE NOT = '4'
 16572        GO TO 6340-UPDATE-CERT.
 16573
 16574     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16575        IF PI-PFKEY-USED = DFHPF5
 16576           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16577        ELSE
 16578           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 315
* EL156.cbl
 16579
 16580*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16581*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16582*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16583*               PI-LF-COVERAGE-TYPE = 'P'
 16584*                GO TO 6350-REWRITE-CERT.
 16585
 16586     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16587       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16588          PI-LF-COVERAGE-TYPE = 'P'
 16589           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16590                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16591                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16592                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16593                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16594                GO TO 6350-REWRITE-CERT
 16595            ELSE
 16596                GO TO 6350-REWRITE-CERT.
 16597
 16598     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16599         GO TO 6350-REWRITE-CERT.
 16600
 16601     IF NOT CM-AH-LUMP-SUM-DISAB
 16602        GO TO 6380-UNLOCK-CERT.
 16603
 16604     IF PI-PFKEY-USED = DFHPF5
 16605        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16606                                    CM-AH-ITD-AH-PMT
 16607        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16608        GO TO 6350-REWRITE-CERT
 16609     ELSE
 16610        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16611                                    CM-AH-ITD-AH-PMT
 16612        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16613        GO TO 6350-REWRITE-CERT.
 16614
 16615 6340-UPDATE-CERT.
 16616
 16617     IF CL-CLAIM-TYPE = 'L'
 16618         IF PI-PFKEY-USED = DFHPF5
 16619             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16620         ELSE
 16621             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16622
 16623     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16624         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16625             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16626                PI-LF-COVERAGE-TYPE = 'P'
 16627                 GO TO 6350-REWRITE-CERT.
 16628
 16629     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16630       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16631          PI-LF-COVERAGE-TYPE = 'P'
 16632           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16633                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16634                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16635                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16636                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 316
* EL156.cbl
 16637                GO TO 6350-REWRITE-CERT.
 16638
 16639     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16640         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16641            PI-LF-COVERAGE-TYPE NOT = 'P'
 16642             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16643             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16644             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16645             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16646             GO TO 6350-REWRITE-CERT.
 16647
 16648     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 16649         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16650         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16651         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16652         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16653         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16654         IF PI-PFKEY-USED = DFHPF5
 16655             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16656                                        CM-AH-ITD-AH-PMT
 16657             GO TO 6350-REWRITE-CERT
 16658         ELSE
 16659             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16660                                        CM-AH-ITD-AH-PMT
 16661             GO TO 6350-REWRITE-CERT.
 16662
 16663 6350-REWRITE-CERT.
 16664
 16665
 16666* EXEC CICS REWRITE
 16667*         DATASET  ('ELCERT')
 16668*         FROM(CERTIFICATE-MASTER)
 16669*     END-EXEC.
 16670     MOVE LENGTH OF
 16671      CERTIFICATE-MASTER
 16672       TO DFHEIV11
 16673     MOVE 'ELCERT' TO DFHEIV1
 16674*    MOVE '&& L                  %   #00015544' TO DFHEIV0
 16675     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16676     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16677     MOVE X'2020233030303135353434' TO DFHEIV0(25:11)
 16678     CALL 'kxdfhei1' USING DFHEIV0,
 16679           DFHEIV1,
 16680           CERTIFICATE-MASTER,
 16681           DFHEIV11,
 16682           DFHEIV99
 16683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16684
 16685
 16686     GO TO 6399-EXIT.
 16687
 16688 6380-UNLOCK-CERT.
 16689
 16690* EXEC CICS UNLOCK
 16691*         DATASET  ('ELCERT')
 16692*     END-EXEC.
 16693     MOVE 'ELCERT' TO DFHEIV1
 16694*    MOVE '&*                    #   #00015552' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 317
* EL156.cbl
 16695     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16696     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16697     MOVE X'2020233030303135353532' TO DFHEIV0(25:11)
 16698     CALL 'kxdfhei1' USING DFHEIV0,
 16699           DFHEIV1,
 16700           DFHEIV99
 16701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16702
 16703
 16704 6399-EXIT.
 16705      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 318
* EL156.cbl
 16707 6400-UPDATE-ZERO-TRAILER.
 16708     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16709     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16710
 16711     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16712
 16713     IF PI-EPYAMT NOT = ZEROS
 16714         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16715     ELSE
 16716         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16717
 16718     IF PI-ERESV NOT = ZEROS
 16719        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16720
 16721     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16722        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16723
 16724     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16725        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16726     ELSE
 16727        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16728
 16729     IF PI-PMTTYPE = '5'
 16730        IF PI-EPYAMT = ZEROS
 16731           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16732        ELSE
 16733           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16734
 16735     IF PI-PMTTYPE = '6'
 16736        IF PI-EPYAMT = ZEROS
 16737           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16738        ELSE
 16739           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16740
 16741 6420-CHECK-OPEN-CLOSE.
 16742     IF PI-PMTTYPE = '5' OR '6'
 16743        GO TO 6450-REWRITE.
 16744
 16745     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16746         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16747             IF CLAIM-IS-CLOSED
 16748                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16749                 MOVE 1          TO  SUB-1
 16750                 GO TO 6440-AIG-LOOP.
 16751
 16752     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16753        GO TO 6450-REWRITE.
 16754
 16755     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16756        GO TO 6450-REWRITE.
 16757
 16758     MOVE 1                      TO SUB-1.
 16759
 16760 6430-LOOP.
 16761     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16762        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16763        IF PI-PMTTYPE = '1' OR '4'
 16764           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 319
* EL156.cbl
 16765           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16766           GO TO 6450-REWRITE
 16767        ELSE
 16768           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16769           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16770           GO TO 6450-REWRITE.
 16771
 16772     IF SUB-1 = 6
 16773      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16774      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16775      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16776      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16777      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16778      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16779      GO TO 6430-LOOP.
 16780
 16781     ADD 1                       TO SUB-1.
 16782     GO TO 6430-LOOP.
 16783
 16784
 16785 6440-AIG-LOOP.
 16786
 16787     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16788       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16789       IF WS-OPEN-CLOSE-SW = '1'
 16790         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16791         IF PI-PMTTYPE = '2'
 16792           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16793           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16794         ELSE
 16795           IF PI-PMTTYPE = '3'
 16796             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16797             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16798           ELSE
 16799             IF PI-PMTTYPE = '4'
 16800               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16801               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16802             ELSE
 16803               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16804               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16805       ELSE
 16806         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16807         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16808         GO TO 6450-REWRITE.
 16809
 16810     IF SUB-1 = 6
 16811      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16812      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16813      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16814      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16815      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16816      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16817      GO TO 6440-AIG-LOOP.
 16818
 16819     ADD 1                       TO SUB-1.
 16820     GO TO 6440-AIG-LOOP.
 16821
 16822 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 320
* EL156.cbl
 16823     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16824     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16825     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16826
 16827     IF PI-COMPANY-ID = 'DMD'
 16828         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16829         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16830         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16831         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16832         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16833
 16834
 16835* EXEC CICS REWRITE
 16836*         DATASET  ('ELTRLR')
 16837*         FROM     (ACTIVITY-TRAILERS)
 16838*     END-EXEC.
 16839     MOVE LENGTH OF
 16840      ACTIVITY-TRAILERS
 16841       TO DFHEIV11
 16842     MOVE 'ELTRLR' TO DFHEIV1
 16843*    MOVE '&& L                  %   #00015686' TO DFHEIV0
 16844     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16845     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16846     MOVE X'2020233030303135363836' TO DFHEIV0(25:11)
 16847     CALL 'kxdfhei1' USING DFHEIV0,
 16848           DFHEIV1,
 16849           ACTIVITY-TRAILERS,
 16850           DFHEIV11,
 16851           DFHEIV99
 16852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16853
 16854
 16855 6499-EXIT.
 16856      EXIT.
 16857
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 321
* EL156.cbl
 16859 6500-READ-DLO035.
 16860     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16861     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16862     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16863     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16864
 16865
 16866* EXEC CICS LINK
 16867*        PROGRAM    ('DLO035')
 16868*        COMMAREA   (DLO035-KEY)
 16869*        LENGTH     (DL35-LENGTH)
 16870*    END-EXEC.
 16871     MOVE 'DLO035' TO DFHEIV1
 16872*    MOVE '."C                   (   #00015701' TO DFHEIV0
 16873     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16874     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16875     MOVE X'2020233030303135373031' TO DFHEIV0(25:11)
 16876     CALL 'kxdfhei1' USING DFHEIV0,
 16877           DFHEIV1,
 16878           DLO035-KEY,
 16879           DL35-LENGTH,
 16880           DFHEIV99,
 16881           DFHEIV99,
 16882           DFHEIV99,
 16883           DFHEIV99
 16884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16885
 16886
 16887     IF DL35-RETURN-CODE = 'OK'
 16888         GO TO 6500-EXIT.
 16889
 16890     IF DL35-RETURN-CODE = '01'
 16891         MOVE ER-7830            TO EMI-ERROR
 16892         GO TO 6500-BAD-EXIT.
 16893
 16894     IF DL35-RETURN-CODE = '02'
 16895         MOVE ER-7831            TO EMI-ERROR
 16896         GO TO 6500-BAD-EXIT.
 16897
 16898     IF DL35-RETURN-CODE = '03'
 16899         MOVE ER-7832            TO EMI-ERROR
 16900         GO TO 6500-BAD-EXIT.
 16901
 16902     IF DL35-RETURN-CODE = '04'
 16903         MOVE ER-7833            TO EMI-ERROR
 16904         GO TO 6500-BAD-EXIT.
 16905
 16906     IF DL35-RETURN-CODE = '05'
 16907         MOVE ER-7834            TO EMI-ERROR
 16908         GO TO 6500-BAD-EXIT.
 16909
 16910     IF DL35-RETURN-CODE = '06'
 16911         MOVE ER-7835            TO EMI-ERROR
 16912         GO TO 6500-BAD-EXIT.
 16913
 16914     IF DL35-RETURN-CODE = '07'
 16915         MOVE ER-7836            TO EMI-ERROR
 16916         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 322
* EL156.cbl
 16917
 16918     IF DL35-RETURN-CODE = 'E1'
 16919         MOVE ER-7837            TO EMI-ERROR
 16920         GO TO 6500-BAD-EXIT.
 16921
 16922     IF DL35-RETURN-CODE NOT = 'OK'
 16923         MOVE ER-7838            TO EMI-ERROR
 16924         GO TO 6500-BAD-EXIT.
 16925
 16926 6500-EXIT.
 16927      EXIT.
 16928
 16929 6500-BAD-EXIT.
 16930
 16931* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16932*    MOVE '6"R                   !   #00015750' TO DFHEIV0
 16933     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16934     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16935     MOVE X'2020233030303135373530' TO DFHEIV0(25:11)
 16936     CALL 'kxdfhei1' USING DFHEIV0
 16937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16938
 16939     MOVE -1                 TO PMTTYPEL.
 16940     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16941     GO TO 8200-SEND-DATAONLY.
 16942
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 323
* EL156.cbl
 16944 6600-UPDATE-DLO035.
 16945     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16946     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16947     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16948     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16949
 16950
 16951* EXEC CICS LINK
 16952*        PROGRAM    ('DLO035')
 16953*        COMMAREA   (DLO035-KEY)
 16954*        LENGTH     (DL35-LENGTH)
 16955*    END-EXEC.
 16956     MOVE 'DLO035' TO DFHEIV1
 16957*    MOVE '."C                   (   #00015762' TO DFHEIV0
 16958     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16959     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16960     MOVE X'2020233030303135373632' TO DFHEIV0(25:11)
 16961     CALL 'kxdfhei1' USING DFHEIV0,
 16962           DFHEIV1,
 16963           DLO035-KEY,
 16964           DL35-LENGTH,
 16965           DFHEIV99,
 16966           DFHEIV99,
 16967           DFHEIV99,
 16968           DFHEIV99
 16969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16970
 16971
 16972     IF DL35-RETURN-CODE = 'OK'
 16973         GO TO 6600-EXIT.
 16974
 16975     IF DL35-RETURN-CODE = '01'
 16976         MOVE ER-7830            TO EMI-ERROR
 16977         GO TO 6500-BAD-EXIT.
 16978
 16979     IF DL35-RETURN-CODE = '02'
 16980         MOVE ER-7831            TO EMI-ERROR
 16981         GO TO 6500-BAD-EXIT.
 16982
 16983     IF DL35-RETURN-CODE = '03'
 16984         MOVE ER-7832            TO EMI-ERROR
 16985         GO TO 6500-BAD-EXIT.
 16986
 16987     IF DL35-RETURN-CODE = '04'
 16988         MOVE ER-7833            TO EMI-ERROR
 16989         GO TO 6500-BAD-EXIT.
 16990
 16991     IF DL35-RETURN-CODE = '05'
 16992         MOVE ER-7834            TO EMI-ERROR
 16993         GO TO 6500-BAD-EXIT.
 16994
 16995     IF DL35-RETURN-CODE = '06'
 16996         MOVE ER-7835            TO EMI-ERROR
 16997         GO TO 6500-BAD-EXIT.
 16998
 16999     IF DL35-RETURN-CODE = '07'
 17000         MOVE ER-7836            TO EMI-ERROR
 17001         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 324
* EL156.cbl
 17002
 17003     IF DL35-RETURN-CODE = 'E1'
 17004         MOVE ER-7837            TO EMI-ERROR
 17005         GO TO 6500-BAD-EXIT.
 17006
 17007     IF DL35-RETURN-CODE NOT = 'OK'
 17008         MOVE ER-7838            TO EMI-ERROR
 17009         GO TO 6500-BAD-EXIT.
 17010
 17011 6600-EXIT.
 17012      EXIT.
 17013
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 325
* EL156.cbl
 17015 6700-UPDATE-ACTQ.
 17016***************************************************************
 17017*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 17018*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 17019*    ONE ALREADY THERE.                                       *
 17020***************************************************************
 17021
 17022
 17023* EXEC CICS HANDLE CONDITION
 17024*         NOTFND(6720-BUILD-NEW-RECORD)
 17025*     END-EXEC.
 17026*    MOVE '"$I                   ! 6 #00015818' TO DFHEIV0
 17027     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17028     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17029     MOVE X'3620233030303135383138' TO DFHEIV0(25:11)
 17030     CALL 'kxdfhei1' USING DFHEIV0
 17031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17032
 17033
 17034
 17035* EXEC CICS READ
 17036*         DATASET('ELACTQ')
 17037*         RIDFLD (ELMSTR-KEY)
 17038*         SET    (ADDRESS OF ACTIVITY-QUE)
 17039*         UPDATE
 17040*     END-EXEC.
 17041     MOVE 'ELACTQ' TO DFHEIV1
 17042*    MOVE '&"S        EU         (   #00015822' TO DFHEIV0
 17043     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17044     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17045     MOVE X'2020233030303135383232' TO DFHEIV0(25:11)
 17046     CALL 'kxdfhei1' USING DFHEIV0,
 17047           DFHEIV1,
 17048           DFHEIV20,
 17049           DFHEIV99,
 17050           ELMSTR-KEY,
 17051           DFHEIV99,
 17052           DFHEIV99,
 17053           DFHEIV99
 17054     SET ADDRESS OF ACTIVITY-QUE TO
 17055         DFHEIV20
 17056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17057
 17058
 17059     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17060
 17061     IF PI-AIG-SPECIAL-BENEFIT AND
 17062        PI-CASH = 'Y'
 17063         ADD 2                   TO AQ-PAYMENT-COUNTER
 17064     ELSE
 17065         ADD 1                   TO AQ-PAYMENT-COUNTER.
 17066
 17067     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 17068         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 17069
 17070     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 17071
 17072     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 326
* EL156.cbl
 17073         IF WS-PMT-APPROVAL-SW = 'A'
 17074             NEXT SENTENCE
 17075         ELSE
 17076            IF PI-AIG-SPECIAL-BENEFIT AND
 17077               PI-CASH = 'Y'
 17078                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17079                                     WS-PMT-UNAPPROVED-CNT
 17080            ELSE
 17081                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17082                                     WS-PMT-UNAPPROVED-CNT
 17083     ELSE
 17084         IF PI-PMT-APPR-SW = 'Y'
 17085            IF PI-AIG-SPECIAL-BENEFIT AND
 17086               PI-CASH = 'Y'
 17087                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17088                                     WS-PMT-UNAPPROVED-CNT
 17089            ELSE
 17090                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17091                                     WS-PMT-UNAPPROVED-CNT.
 17092
 17093     IF WS-PMT-UNAPPROVED-CNT > ZERO
 17094         MOVE ER-3536 TO EMI-ERROR
 17095         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17096
 17097     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 17098
 17099
 17100* EXEC CICS REWRITE
 17101*         DATASET('ELACTQ')
 17102*         FROM   (ACTIVITY-QUE)
 17103*     END-EXEC.
 17104     MOVE LENGTH OF
 17105      ACTIVITY-QUE
 17106       TO DFHEIV11
 17107     MOVE 'ELACTQ' TO DFHEIV1
 17108*    MOVE '&& L                  %   #00015869' TO DFHEIV0
 17109     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17110     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17111     MOVE X'2020233030303135383639' TO DFHEIV0(25:11)
 17112     CALL 'kxdfhei1' USING DFHEIV0,
 17113           DFHEIV1,
 17114           ACTIVITY-QUE,
 17115           DFHEIV11,
 17116           DFHEIV99
 17117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17118
 17119
 17120     GO TO 6799-EXIT.
 17121
 17122 6720-BUILD-NEW-RECORD.
 17123
 17124* EXEC CICS GETMAIN
 17125*         SET    (ADDRESS OF ACTIVITY-QUE)
 17126*         LENGTH (60)
 17127*         INITIMG(GETMAIN-SPACE)
 17128*     END-EXEC.
 17129     MOVE 60
 17130       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 327
* EL156.cbl
 17131*    MOVE ',"IL                  $   #00015877' TO DFHEIV0
 17132     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17133     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17134     MOVE X'2020233030303135383737' TO DFHEIV0(25:11)
 17135     CALL 'kxdfhei1' USING DFHEIV0,
 17136           DFHEIV20,
 17137           DFHEIV11,
 17138           GETMAIN-SPACE
 17139     SET ADDRESS OF ACTIVITY-QUE TO
 17140         DFHEIV20
 17141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17142
 17143
 17144     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 17145
 17146     IF PI-AIG-SPECIAL-BENEFIT AND
 17147        PI-CASH = 'Y'
 17148         MOVE 2                  TO AQ-PAYMENT-COUNTER
 17149     ELSE
 17150         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 17151
 17152     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 17153     MOVE 'AQ'                   TO AQ-RECORD-ID.
 17154     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 17155     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 17156                                    AQ-FOLLOWUP-DATE.
 17157     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 17158     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17159
 17160     IF PI-PMT-GRADUATED
 17161         IF WS-PMT-APPROVAL-SW = 'A'
 17162             NEXT SENTENCE
 17163         ELSE
 17164            IF PI-AIG-SPECIAL-BENEFIT AND
 17165               PI-CASH = 'Y'
 17166                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17167            ELSE
 17168                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17169     ELSE
 17170         IF PI-PMT-APPR-SW = 'Y'
 17171            IF PI-AIG-SPECIAL-BENEFIT AND
 17172               PI-CASH = 'Y'
 17173                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17174            ELSE
 17175                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 17176
 17177     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 17178         MOVE ER-3536 TO EMI-ERROR
 17179         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17180
 17181
 17182* EXEC CICS WRITE
 17183*         DATASET('ELACTQ')
 17184*         RIDFLD (ELMSTR-KEY)
 17185*         FROM   (ACTIVITY-QUE)
 17186*     END-EXEC.
 17187     MOVE LENGTH OF
 17188      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 328
* EL156.cbl
 17189       TO DFHEIV11
 17190     MOVE 'ELACTQ' TO DFHEIV1
 17191*    MOVE '&$ L                  ''   #00015920' TO DFHEIV0
 17192     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17193     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17194     MOVE X'2020233030303135393230' TO DFHEIV0(25:11)
 17195     CALL 'kxdfhei1' USING DFHEIV0,
 17196           DFHEIV1,
 17197           ACTIVITY-QUE,
 17198           DFHEIV11,
 17199           ELMSTR-KEY,
 17200           DFHEIV99,
 17201           DFHEIV99
 17202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17203
 17204
 17205 6799-EXIT.
 17206      EXIT.
 17207
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 329
* EL156.cbl
 17209 6800-BUILD-FORM-TRAILER.
 17210
 17211
 17212* EXEC CICS GETMAIN
 17213*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17214*         LENGTH   (200)
 17215*         INITIMG  (GETMAIN-SPACE)
 17216*    END-EXEC.
 17217     MOVE 200
 17218       TO DFHEIV11
 17219*    MOVE ',"IL                  $   #00015932' TO DFHEIV0
 17220     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17221     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17222     MOVE X'2020233030303135393332' TO DFHEIV0(25:11)
 17223     CALL 'kxdfhei1' USING DFHEIV0,
 17224           DFHEIV20,
 17225           DFHEIV11,
 17226           GETMAIN-SPACE
 17227     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17228         DFHEIV20
 17229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17230
 17231
 17232     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 17233
 17234     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 17235     MOVE 'AT'                   TO AT-RECORD-ID.
 17236     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 17237
 17238     MOVE 'A'                    TO AT-TRAILER-TYPE.
 17239     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17240                                    AT-FORM-LAST-MAINT-DT
 17241                                    AT-FORM-SEND-ON-DT.
 17242     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17243                                    AT-FORM-LAST-UPDATED-BY.
 17244     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 17245     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 17246     MOVE '6'                    TO DC-OPTION-CODE.
 17247     MOVE +29                    TO DC-ELAPSED-DAYS.
 17248     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17249     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17250     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 17251
 17252     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17253         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 17254
 17255     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 17256                                    AT-FORM-RE-SEND-DT
 17257                                    AT-EMP-FORM-ANSWERED-DT
 17258                                    AT-PHY-FORM-ANSWERED-DT
 17259                                    AT-EMP-FORM-SEND-ON-DT
 17260                                    AT-PHY-FORM-SEND-ON-DT
 17261                                    AT-FORM-PRINTED-DT
 17262                                    AT-FORM-REPRINT-DT.
 17263     MOVE '2'                    TO AT-FORM-TYPE.
 17264
 17265     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 17266     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 330
* EL156.cbl
 17267
 17268     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17269         NEXT SENTENCE
 17270     ELSE
 17271         IF CL-PROG-FORM-TYPE NOT = 'S'
 17272            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 17273
 17274
 17275* EXEC CICS WRITE
 17276*         DATASET  ('ELTRLR')
 17277*         FROM     (ACTIVITY-TRAILERS)
 17278*         RIDFLD   (AT-CONTROL-PRIMARY)
 17279*     END-EXEC.
 17280     MOVE LENGTH OF
 17281      ACTIVITY-TRAILERS
 17282       TO DFHEIV11
 17283     MOVE 'ELTRLR' TO DFHEIV1
 17284*    MOVE '&$ L                  ''   #00015980' TO DFHEIV0
 17285     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17286     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17287     MOVE X'2020233030303135393830' TO DFHEIV0(25:11)
 17288     CALL 'kxdfhei1' USING DFHEIV0,
 17289           DFHEIV1,
 17290           ACTIVITY-TRAILERS,
 17291           DFHEIV11,
 17292           AT-CONTROL-PRIMARY,
 17293           DFHEIV99,
 17294           DFHEIV99
 17295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17296
 17297
 17298 6899-EXIT.
 17299      EXIT.
 17300
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 331
* EL156.cbl
 17302 6900-BUILD-ARCHIVE-HEADER.
 17303
 17304     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17305     MOVE '1'                    TO CNTL-REC-TYPE.
 17306     MOVE +0                     TO CNTL-SEQ-NO.
 17307     MOVE SPACES                 TO CNTL-ACCESS.
 17308
 17309
 17310* EXEC CICS READ
 17311*         DATASET  ('ELCNTL')
 17312*         SET      (ADDRESS OF CONTROL-FILE)
 17313*         RIDFLD   (ELCNTL-KEY)
 17314*         UPDATE
 17315*    END-EXEC.
 17316     MOVE 'ELCNTL' TO DFHEIV1
 17317*    MOVE '&"S        EU         (   #00015997' TO DFHEIV0
 17318     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17319     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17320     MOVE X'2020233030303135393937' TO DFHEIV0(25:11)
 17321     CALL 'kxdfhei1' USING DFHEIV0,
 17322           DFHEIV1,
 17323           DFHEIV20,
 17324           DFHEIV99,
 17325           ELCNTL-KEY,
 17326           DFHEIV99,
 17327           DFHEIV99,
 17328           DFHEIV99
 17329     SET ADDRESS OF CONTROL-FILE TO
 17330         DFHEIV20
 17331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17332
 17333
 17334     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17335     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17336
 17337
 17338* EXEC CICS REWRITE
 17339*         FROM     (CONTROL-FILE)
 17340*         DATASET  ('ELCNTL')
 17341*    END-EXEC.
 17342     MOVE LENGTH OF
 17343      CONTROL-FILE
 17344       TO DFHEIV11
 17345     MOVE 'ELCNTL' TO DFHEIV1
 17346*    MOVE '&& L                  %   #00016007' TO DFHEIV0
 17347     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17348     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17349     MOVE X'2020233030303136303037' TO DFHEIV0(25:11)
 17350     CALL 'kxdfhei1' USING DFHEIV0,
 17351           DFHEIV1,
 17352           CONTROL-FILE,
 17353           DFHEIV11,
 17354           DFHEIV99
 17355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17356
 17357
 17358
 17359* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 332
* EL156.cbl
 17360*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17361*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17362*    END-EXEC.
 17363*    MOVE '"$$%                  ! 7 #00016012' TO DFHEIV0
 17364     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17365     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17366     MOVE X'3720233030303136303132' TO DFHEIV0(25:11)
 17367     CALL 'kxdfhei1' USING DFHEIV0
 17368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17369
 17370
 17371
 17372* EXEC CICS GETMAIN
 17373*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17374*         LENGTH  (ELARCH-LENGTH)
 17375*         INITIMG (GETMAIN-SPACE)
 17376*    END-EXEC.
 17377*    MOVE ',"IL                  $   #00016017' TO DFHEIV0
 17378     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17379     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17380     MOVE X'2020233030303136303137' TO DFHEIV0(25:11)
 17381     CALL 'kxdfhei1' USING DFHEIV0,
 17382           DFHEIV20,
 17383           ELARCH-LENGTH,
 17384           GETMAIN-SPACE
 17385     SET ADDRESS OF LETTER-ARCHIVE TO
 17386         DFHEIV20
 17387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17388
 17389
 17390     MOVE 'LA'                   TO LA-RECORD-ID.
 17391     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17392                                    LA-ARCHIVE-NO-A1.
 17393     MOVE '4'                    TO LA-RECORD-TYPE
 17394                                    LA-RECORD-TYPE-A1.
 17395     MOVE +0                     TO LA-LINE-SEQ-NO
 17396                                    LA-LINE-SEQ-NO-A1.
 17397     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17398                                    LA-COMPANY-CD-A1.
 17399     MOVE CL-CARRIER             TO LA4-CARRIER.
 17400     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17401     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17402     MOVE CL-CERT-STATE          TO LA4-STATE.
 17403     MOVE +0                     TO LA4-NO-OF-COPIES.
 17404     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17405     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17406     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17407                                    LA4-INITIAL-PRINT-DATE
 17408                                    LA4-RESEND-PRINT-DATE
 17409                                    LA4-FORM-REM-PRINT-DT.
 17410     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17411     MOVE '2'                    TO LA4-FORM-TYPE.
 17412
 17413
 17414* EXEC CICS WRITE
 17415*         DATASET  ('ELARCH')
 17416*         FROM     (LETTER-ARCHIVE)
 17417*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 333
* EL156.cbl
 17418*    END-EXEC.
 17419     MOVE LENGTH OF
 17420      LETTER-ARCHIVE
 17421       TO DFHEIV11
 17422     MOVE 'ELARCH' TO DFHEIV1
 17423*    MOVE '&$ L                  ''   #00016046' TO DFHEIV0
 17424     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17425     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17426     MOVE X'2020233030303136303436' TO DFHEIV0(25:11)
 17427     CALL 'kxdfhei1' USING DFHEIV0,
 17428           DFHEIV1,
 17429           LETTER-ARCHIVE,
 17430           DFHEIV11,
 17431           LA-CONTROL-PRIMARY,
 17432           DFHEIV99,
 17433           DFHEIV99
 17434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17435
 17436
 17437 6999-EXIT.
 17438      EXIT.
 17439
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 334
* EL156.cbl
 17441 7000-SHOW-CLAIM.
 17442     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17443     MOVE 'A'                    TO PI-PASS-SW.
 17444     MOVE LOW-VALUES             TO PI-CPYFROM
 17445                                    PI-MONTH-END-SAVE
 17446                                    PI-CPYTHRU.
 17447
 17448     MOVE ZEROS                  TO PI-FATAL-COUNT
 17449                                    PI-DAILY-RATE
 17450                                    PI-BEN-DAYS
 17451                                    PI-MANUAL-SW
 17452                                    PI-SAVE-CURSOR
 17453                                    PI-FORCE-COUNT
 17454                                    PI-HOLDTIL
 17455                                    PI-EPYFROM
 17456                                    PI-EPYTHRU
 17457                                    PI-EDAYS
 17458                                    PI-EPYAMT
 17459                                    PI-ERESV
 17460                                    PI-EEXPENS
 17461                                    PI-CDAYS
 17462                                    PI-CPYAMT
 17463                                    PI-CRESV
 17464                                    PI-CEXPENS
 17465                                    PI-INT-RATE
 17466                                    PI-AIGFROM.
 17467     MOVE ZEROS                  TO PI-PROOF-DATE.
 17468     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17469                                    PI-REM-BEN-AMT
 17470                                    PI-MO-BEN-AMT
 17471                                    pi-ah-term.
 17472
 17473     MOVE LOW-VALUES             TO EL156AI.
 17474     MOVE MAP-NAMEA              TO MAP-NAME.
 17475
 17476* EXEC CICS HANDLE CONDITION
 17477*        NOTFND   (7010-BUILD-MAP)
 17478*    END-EXEC.
 17479*    MOVE '"$I                   ! 8 #00016090' TO DFHEIV0
 17480     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17481     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17482     MOVE X'3820233030303136303930' TO DFHEIV0(25:11)
 17483     CALL 'kxdfhei1' USING DFHEIV0
 17484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17485
 17486
 17487     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17488     MOVE '2'                    TO CNTL-REC-TYPE.
 17489     MOVE +0                     TO CNTL-SEQ-NO.
 17490     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17491
 17492
 17493* EXEC CICS READ
 17494*         DATASET  ('ELCNTL')
 17495*         SET      (ADDRESS OF CONTROL-FILE)
 17496*         RIDFLD   (ELCNTL-KEY)
 17497*    END-EXEC.
 17498     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 335
* EL156.cbl
 17499*    MOVE '&"S        E          (   #00016099' TO DFHEIV0
 17500     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17501     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17502     MOVE X'2020233030303136303939' TO DFHEIV0(25:11)
 17503     CALL 'kxdfhei1' USING DFHEIV0,
 17504           DFHEIV1,
 17505           DFHEIV20,
 17506           DFHEIV99,
 17507           ELCNTL-KEY,
 17508           DFHEIV99,
 17509           DFHEIV99,
 17510           DFHEIV99
 17511     SET ADDRESS OF CONTROL-FILE TO
 17512         DFHEIV20
 17513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17514
 17515
 17516     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17517
 17518     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17519         MOVE AL-UANON      TO SURVYYNA
 17520     END-IF.
 17521
 17522
 17523     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17524     MOVE '1'                    TO CNTL-REC-TYPE.
 17525     MOVE SPACES                 TO CNTL-ACCESS.
 17526     MOVE +0                     TO CNTL-SEQ-NO.
 17527
 17528
 17529* EXEC CICS READ
 17530*         DATASET  ('ELCNTL')
 17531*         SET      (ADDRESS OF CONTROL-FILE)
 17532*         RIDFLD   (ELCNTL-KEY)
 17533*    END-EXEC.
 17534     MOVE 'ELCNTL' TO DFHEIV1
 17535*    MOVE '&"S        E          (   #00016117' TO DFHEIV0
 17536     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17537     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17538     MOVE X'2020233030303136313137' TO DFHEIV0(25:11)
 17539     CALL 'kxdfhei1' USING DFHEIV0,
 17540           DFHEIV1,
 17541           DFHEIV20,
 17542           DFHEIV99,
 17543           ELCNTL-KEY,
 17544           DFHEIV99,
 17545           DFHEIV99,
 17546           DFHEIV99
 17547     SET ADDRESS OF CONTROL-FILE TO
 17548         DFHEIV20
 17549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17550
 17551
 17552     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17553
 17554 7010-BUILD-MAP.
 17555
 17556
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 336
* EL156.cbl
 17557* EXEC CICS HANDLE CONDITION
 17558*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17559*    END-EXEC.
 17560*    MOVE '"$I                   ! 9 #00016127' TO DFHEIV0
 17561     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17562     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17563     MOVE X'3920233030303136313237' TO DFHEIV0(25:11)
 17564     CALL 'kxdfhei1' USING DFHEIV0
 17565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17566
 17567
 17568     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17569     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17570     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17571     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17572     MOVE 'MSTR'                 TO FILE-SWITCH.
 17573
 17574     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17575
 17576     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17577     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17578     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17579     MOVE CL-CCN                 TO PI-SV-CCN.
 17580
 17581     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17582     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17583     MOVE CL-CLAIM-NO            TO CLMNOO.
 17584     MOVE CL-CARRIER             TO CARRO.
 17585     MOVE CL-CERT-PRIME          TO CERTNOO.
 17586     MOVE CL-CERT-SFX            TO SUFXO.
 17587
 17588     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17589        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 17590        CONTINUE
 17591     ELSE
 17592        MOVE AL-SADOF            TO ZINTHA
 17593                                    ZINTA
 17594                                    PINTHA
 17595                                    PINTA
 17596     END-IF
 17597     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17598     EVALUATE TRUE
 17599     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17600         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17601     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17602         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17603
 17604     WHEN CL-CLAIM-TYPE = 'I'
 17605         MOVE '  IU  '           TO CLMTYPO
 17606     WHEN CL-CLAIM-TYPE = 'G'
 17607         MOVE ' GAP  '           TO CLMTYPO
 17608     WHEN CL-CLAIM-TYPE = 'F'
 17609         MOVE ' FMLA '           TO CLMTYPO
 17610     END-EVALUATE.
 17611     IF CLAIM-IS-OPEN
 17612         MOVE ' OPEN'            TO CLMSTATO
 17613     ELSE
 17614         MOVE 'CLOSED'           TO CLMSTATO.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 337
* EL156.cbl
 17615
 17616     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17617
 17618     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17619         MOVE SPACES             TO  PCERTNOO
 17620                                     PSUFXO
 17621                                     PRIMHDGO
 17622                                     SEQUO
 17623         MOVE AL-SADOF           TO  PCERTNOA
 17624                                     PSUFXA
 17625                                     PRIMHDGA
 17626                                     SEQUA
 17627     ELSE
 17628         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17629         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17630         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17631         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17632         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17633         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17634         MOVE AL-SANON               TO  PCERTNOA
 17635                                         PSUFXA
 17636                                         PRIMHDGA
 17637         MOVE AL-SABON               TO  SEQUA.
 17638
 17639     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17640
 17641     IF CL-NO-OF-PMTS-MADE = 0 AND
 17642        CL-TOTAL-PAID-AMT = 0
 17643         NEXT SENTENCE
 17644     ELSE
 17645         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17646             IF NOT PI-USES-PAID-TO
 17647                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17648                 MOVE ' '                 TO DC-OPTION-CODE
 17649                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17650                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17651             ELSE
 17652                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17653                 MOVE '6'                 TO DC-OPTION-CODE
 17654                 MOVE +1                  TO DC-ELAPSED-DAYS
 17655                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17656                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17657                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17658
 17659     IF MAP-NAME = 'EL156A'
 17660        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17661           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17662             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17663           end-if
 17664        end-if
 17665     end-if
 17666     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17667         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17668         MOVE ' '                TO DC-OPTION-CODE
 17669         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17670         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17671
 17672     IF CL-INCURRED-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 338
* EL156.cbl
 17673         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17674         MOVE ' '                TO DC-OPTION-CODE
 17675         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17676         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17677
 17678     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17679
 17680     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17681         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17682         MOVE ' '                TO DC-OPTION-CODE
 17683         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17684         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17685
 17686     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17687         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17688         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17689     ELSE
 17690         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17691         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17692
 17693     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17694     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17695     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17696     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17697                                    PI-GROUPING.
 17698     MOVE CL-CERT-STATE          TO CERT-STATE
 17699                                    PI-STATE.
 17700     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17701                                    PI-ACCOUNT.
 17702     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17703     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17704     MOVE 'CERT'                 TO FILE-SWITCH.
 17705
 17706     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17707     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17708        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17709        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17710            MOVE 'N' TO PI-JOINT-INSURED-IND
 17711     ELSE
 17712            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17713     END-IF.
 17714
 17715     perform 7975-read-acct      thru 7975-exit
 17716     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17717     MOVE PI-STATE               TO WS-ST-ACCESS.
 17718     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17719     MOVE '3'                    TO CNTL-REC-TYPE.
 17720     MOVE +0                     TO CNTL-SEQ-NO.
 17721     MOVE 'STAT'                 TO FILE-SWITCH.
 17722
 17723     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17724
 17725     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17726     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17727
 17728     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17729        GO TO 7020-BYPASS-BENEFIT.
 17730
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 339
* EL156.cbl
 17731     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17732     MOVE '4'                    TO CNTL-REC-TYPE.
 17733     MOVE +0                     TO CNTL-SEQ-NO.
 17734     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17735     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17736     MOVE 'BENE'                 TO FILE-SWITCH.
 17737
 17738     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17739
 17740     IF NO-BENEFIT-FOUND
 17741        GO TO 7020-BYPASS-BENEFIT.
 17742
 17743     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17744     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17745     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17746
 17747 7020-BYPASS-BENEFIT.
 17748
 17749*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17750*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17751*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17752
 17753     move zeros                  to PI-MAX-BENEFIT-AMT
 17754     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17755     move cm-ah-orig-term        to pi-ah-term
 17756     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17757     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND
 17758          'G' and 'F'
 17759         GO TO 7021-GO-TO-LIFE.
 17760
 17761     IF (PI-COMPANY-ID = 'DCC' or 'CAP')
 17762        and (acct-found)
 17763        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17764        PERFORM 0900-GET-DDF-limits
 17765                                 THRU 0900-EXIT
 17766        IF PDEF-FOUND
 17767           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17768              (P1 > +8)
 17769              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17770           END-PERFORM
 17771           IF P1 < +9
 17772              if pd-ben-pct (p1) not numeric
 17773                 move zeros      to pd-ben-pct (p1)
 17774              end-if
 17775              if pd-ben-pct (p1) = zeros
 17776                 move +1         to ws-work-ben-pct
 17777              else
 17778                 move pd-ben-pct (p1)
 17779                                 to ws-work-ben-pct
 17780              end-if
 17781              compute cm-ah-benefit-amt =
 17782                 cm-ah-benefit-amt * ws-work-ben-pct
 17783              move pd-max-amt (p1) to pi-max-benefit-amt
 17784           END-IF
 17785        END-IF
 17786     end-if
 17787     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17788     MOVE 'MO. BENEFIT :'        TO BENECAPO.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 340
* EL156.cbl
 17789     if (pi-max-benefit-amt not = zeros)
 17790        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17791        move pi-max-benefit-amt  to beneo
 17792     else
 17793        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17794     end-if
 17795     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17796     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17797                                    CP-ORIGINAL-TERM.
 17798     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17799
 17800*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17801*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17802*    ELSE
 17803         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17804
 17805     MOVE ' '                    TO DC-OPTION-CODE.
 17806     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17807     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17808
 17809     IF PI-COMPANY-ID = 'DMD'
 17810         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17811         GO TO 7023-BYPASS-REMAINING-TERM.
 17812
 17813     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17814     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17815     GO TO 7022-AROUND-LIFE.
 17816
 17817 7021-GO-TO-LIFE.
 17818
 17819     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17820     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17821     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17822                                    CP-ORIGINAL-TERM.
 17823     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17824     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17825     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17826     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17827
 17828     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17829         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17830     ELSE
 17831         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17832
 17833     MOVE ' '                    TO DC-OPTION-CODE.
 17834     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17835     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17836
 17837 7022-AROUND-LIFE.
 17838
 17839     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17840     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17841     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17842     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17843     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17844     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17845     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17846
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 341
* EL156.cbl
 17847     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17848
 17849     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17850        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17851           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17852
 17853     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17854        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17855           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17856
 17857 7023-BYPASS-REMAINING-TERM.
 17858     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17859       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17860          MOVE ZEROS                  TO BENEO
 17861       ELSE
 17862          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17863          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17864          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17865          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17866          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17867          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 17868          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17869          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17870          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17871          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17872          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17873          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17874          IF (PI-COMPANY-ID = 'DCC' or 'CAP')
 17875             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17876             PERFORM 0900-GET-DDF-limits
 17877                                 THRU 0900-EXIT
 17878             IF PDEF-FOUND
 17879                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17880                   (P1 > +8)
 17881                   OR (PD-PROD-CODE (P1) = 'L')
 17882                END-PERFORM
 17883                IF P1 < +9
 17884                   MOVE PD-MAX-AMT (P1)
 17885                                 TO CP-R-MAX-TOT-BEN
 17886                END-IF
 17887             END-IF
 17888          END-IF
 17889
 17890* EXEC CICS LINK
 17891*            PROGRAM  (LINK-REMAMT)
 17892*            COMMAREA (CALCULATION-PASS-AREA)
 17893*            LENGTH   (CP-COMM-LENGTH)
 17894*         END-EXEC
 17895*    MOVE '."C                   (   #00016452' TO DFHEIV0
 17896     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17897     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17898     MOVE X'2020233030303136343532' TO DFHEIV0(25:11)
 17899     CALL 'kxdfhei1' USING DFHEIV0,
 17900           LINK-REMAMT,
 17901           CALCULATION-PASS-AREA,
 17902           CP-COMM-LENGTH,
 17903           DFHEIV99,
 17904           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 342
* EL156.cbl
 17905           DFHEIV99,
 17906           DFHEIV99
 17907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17908          MOVE CP-REMAINING-AMT       TO BENEO
 17909       end-if
 17910     end-if
 17911     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17912     MOVE +95                    TO TRLR-SEQ-NO
 17913
 17914* EXEC CICS READ
 17915*       DATASET  ('ELTRLR')
 17916*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17917*       RIDFLD   (ELTRLR-KEY)
 17918*       RESP     (WS-RESPONSE)
 17919*    END-EXEC
 17920     MOVE 'ELTRLR' TO DFHEIV1
 17921*    MOVE '&"S        E          (  N#00016462' TO DFHEIV0
 17922     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17923     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17924     MOVE X'204E233030303136343632' TO DFHEIV0(25:11)
 17925     CALL 'kxdfhei1' USING DFHEIV0,
 17926           DFHEIV1,
 17927           DFHEIV20,
 17928           DFHEIV99,
 17929           ELTRLR-KEY,
 17930           DFHEIV99,
 17931           DFHEIV99,
 17932           DFHEIV99
 17933     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17934         DFHEIV20
 17935     MOVE EIBRESP  TO WS-RESPONSE
 17936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17937
 17938     if ws-resp-normal
 17939        perform varying s1 from +1 by +1 until
 17940           at-note-error-no (s1) = spaces
 17941           move at-note-error-no (s1)
 17942                                 to emi-error
 17943           if at-note-error-no (s1) = '1653'
 17944              evaluate true
 17945                 when cl-claim-type = 'L'
 17946                    move '  LF  '
 17947                                 to emi-claim-type
 17948                 when cl-claim-type = 'I'
 17949                    move '  IU  '
 17950                                 to emi-claim-type
 17951                 when cl-claim-type = 'F'
 17952                    move ' FMLA '
 17953                                 to emi-claim-type
 17954                 when other
 17955                    move '  AH  '
 17956                                 to emi-claim-type
 17957              end-evaluate
 17958           end-if
 17959           PERFORM 9900-ERROR-FORMAT
 17960                                 THRU 9900-EXIT
 17961        end-perform
 17962     end-if
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 343
* EL156.cbl
 17963     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17964         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17965            WS-LF-COVERAGE-TYPE = 'P'
 17966             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17967                                        CM-LF-ITD-DEATH-AMT
 17968             MOVE WS-REMAINING-AMT  TO  BENEO.
 17969
 17970     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17971     MOVE BENEO                  TO PI-REM-BEN-AMT.
 17972     MOVE WS-TERMS               TO TERMSO.
 17973
 17974     IF WS-STATUS = '6' OR '7' OR '8'
 17975         MOVE AL-SABOF           TO CRTSTATA.
 17976
 17977     IF WS-STATUS = '1' OR '4'
 17978        IF CP-REMAINING-TERM-3 = ZEROS
 17979           MOVE 'EXPIRED'        TO CRTSTATO
 17980        ELSE
 17981           MOVE 'ACTIVE  '       TO CRTSTATO.
 17982
 17983     IF WS-STATUS = '2'
 17984         MOVE 'PEND    '         TO CRTSTATO.
 17985
 17986     IF WS-STATUS = '3'
 17987         MOVE 'RESTORE '         TO CRTSTATO.
 17988
 17989     IF WS-STATUS = '5'
 17990         MOVE 'REISSUE '         TO CRTSTATO.
 17991
 17992     IF WS-STATUS = '6'
 17993         MOVE 'LMP DIS'          TO CRTSTATO.
 17994
 17995     IF WS-STATUS = '7'
 17996         MOVE 'DEATH'            TO CRTSTATO.
 17997
 17998     IF WS-STATUS = '8'
 17999         MOVE 'CANCEL'           TO CRTSTATO.
 18000
 18001     IF WS-STATUS = '9'
 18002         MOVE 'RE-ONLY '         TO CRTSTATO.
 18003
 18004     IF WS-STATUS = 'V'
 18005         MOVE 'VOID  '           TO CRTSTATO.
 18006
 18007     IF WS-STATUS = 'D'
 18008         MOVE 'DECLINE '         TO CRTSTATO.
 18009
 18010     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 18011         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 18012         MOVE '5'                TO CNTL-REC-TYPE
 18013     ELSE
 18014         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 18015         MOVE '4'                TO CNTL-REC-TYPE.
 18016
 18017     MOVE '** NONE **'           TO COVERO.
 18018     MOVE AL-SABON               TO COVERA.
 18019
 18020     IF PI-COMPANY-ID = 'CVL'
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 344
* EL156.cbl
 18021         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 18022             MOVE CM-BENEFICIARY TO LOANNOO
 18023             MOVE AL-UANON       TO LOANNOA.
 18024
 18025     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 18026        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 18027        MOVE +91                 TO  TRLR-SEQ-NO
 18028
 18029* EXEC CICS READ
 18030*           DATASET  ('ELTRLR')
 18031*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18032*           RIDFLD   (ELTRLR-KEY)
 18033*           RESP     (WS-RESPONSE)
 18034*       END-EXEC
 18035     MOVE 'ELTRLR' TO DFHEIV1
 18036*    MOVE '&"S        E          (  N#00016559' TO DFHEIV0
 18037     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18038     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18039     MOVE X'204E233030303136353539' TO DFHEIV0(25:11)
 18040     CALL 'kxdfhei1' USING DFHEIV0,
 18041           DFHEIV1,
 18042           DFHEIV20,
 18043           DFHEIV99,
 18044           ELTRLR-KEY,
 18045           DFHEIV99,
 18046           DFHEIV99,
 18047           DFHEIV99
 18048     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18049         DFHEIV20
 18050     MOVE EIBRESP  TO WS-RESPONSE
 18051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18052
 18053        IF WS-RESP-NORMAL
 18054           MOVE AT-INFO-LINE-1   TO  LOANNOO
 18055        ELSE
 18056           MOVE SPACES           TO  LOANNOO
 18057        END-IF
 18058*052506
 18059*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 18060*052506
 18061     END-IF
 18062
 18063     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 18064        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 18065
 18066     IF WS-BEN-CD = ZEROS
 18067         GO TO 7050-SHOW-CONTINUE.
 18068
 18069     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 18070     MOVE WS-ACCESS              TO CNTL-ACCESS.
 18071     MOVE +0                     TO CNTL-SEQ-NO.
 18072     MOVE 'BENE'                 TO FILE-SWITCH.
 18073
 18074     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 18075     IF BENEFIT-FOUND
 18076        MOVE CF-JOINT-INDICATOR (SUB-1)
 18077                                 TO PI-JOINT-COV-IND
 18078                                    PI-RB-JOINT-COV-IND
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 345
* EL156.cbl
 18079        MOVE CF-BENEFIT-DESCRIP (SUB-1)
 18080                                 TO COVERO
 18081        MOVE AL-SANON            TO COVERA
 18082     END-IF
 18083     if (cntl-rec-type = '4')   *> Life claim
 18084        and (cm-ah-benefit-cd not = zeros) *> AH coverage
 18085        MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
 18086        MOVE CM-AH-BENEFIT-CD TO WS-BEN-CD
 18087        MOVE '5'              TO CNTL-REC-TYPE
 18088        MOVE WS-ACCESS        TO CNTL-ACCESS
 18089        MOVE +0               TO CNTL-SEQ-NO
 18090        MOVE 'BENE'           TO FILE-SWITCH
 18091        PERFORM 7200-FIND-BENEFIT
 18092                              THRU 7200-EXIT
 18093        IF (BENEFIT-FOUND)
 18094           and (pi-rb-joint-cov-ind) not = 'J'
 18095           MOVE CF-JOINT-INDICATOR (SUB-1)
 18096                              TO PI-rb-JOINT-COV-IND
 18097        end-if
 18098     end-if
 18099     .
 18100 7050-SHOW-CONTINUE.
 18101
 18102     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 18103        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 18104            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 18105     END-IF
 18106
 18107     IF PI-COMPANY-ID = 'DMD'
 18108         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 18109
 18110     MOVE -1                     TO PMTTYPEL.
 18111     GO TO 8100-SEND-INITIAL-MAP.
 18112
 18113 7100-SHOW-RECORD-NOT-FOUND.
 18114     IF FILE-SWITCH = 'MSTR'
 18115         MOVE ER-0204            TO EMI-ERROR.
 18116
 18117     IF FILE-SWITCH = 'CERT'
 18118         MOVE ER-0206            TO EMI-ERROR.
 18119
 18120     IF FILE-SWITCH = 'STAT'
 18121         MOVE ER-0149            TO EMI-ERROR.
 18122
 18123     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18124
 18125     MOVE -1                     TO PMTTYPEL.
 18126     GO TO 8100-SEND-INITIAL-MAP
 18127
 18128     .
 18129 7110-BUILD-PMT-TRLR.
 18130     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18131     MOVE +51                    TO TRLR-SEQ-NO
 18132
 18133* EXEC CICS READ
 18134*        DATASET  ('ELTRLR')
 18135*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18136*        RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 346
* EL156.cbl
 18137*        RESP     (WS-RESPONSE)
 18138*    END-EXEC
 18139     MOVE 'ELTRLR' TO DFHEIV1
 18140*    MOVE '&"S        E          (  N#00016645' TO DFHEIV0
 18141     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18142     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18143     MOVE X'204E233030303136363435' TO DFHEIV0(25:11)
 18144     CALL 'kxdfhei1' USING DFHEIV0,
 18145           DFHEIV1,
 18146           DFHEIV20,
 18147           DFHEIV99,
 18148           ELTRLR-KEY,
 18149           DFHEIV99,
 18150           DFHEIV99,
 18151           DFHEIV99
 18152     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18153         DFHEIV20
 18154     MOVE EIBRESP  TO WS-RESPONSE
 18155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18156     IF WS-RESP-NORMAL
 18157        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 18158     END-IF
 18159     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 18160
 18161* EXEC CICS GETMAIN
 18162*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18163*         LENGTH    (200)
 18164*         INITIMG   (GETMAIN-SPACE)
 18165*     END-EXEC
 18166     MOVE 200
 18167       TO DFHEIV11
 18168*    MOVE ',"IL                  $   #00016655' TO DFHEIV0
 18169     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18170     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18171     MOVE X'2020233030303136363535' TO DFHEIV0(25:11)
 18172     CALL 'kxdfhei1' USING DFHEIV0,
 18173           DFHEIV20,
 18174           DFHEIV11,
 18175           GETMAIN-SPACE
 18176     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18177         DFHEIV20
 18178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18179     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 18180                                    AT-PREV-PAID-THRU-DT
 18181     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 18182     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18183     MOVE 'AT'                   TO AT-RECORD-ID
 18184     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18185     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 18186     MOVE '2'                    TO AT-TRAILER-TYPE
 18187     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18188                                    AT-PAYMENT-LAST-MAINT-DT
 18189     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18190                                    AT-PAYMENT-LAST-UPDATED-BY
 18191     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18192     MOVE 'I'                    TO AT-PAYMENT-TYPE
 18193     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 18194     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 347
* EL156.cbl
 18195     MOVE +0                     TO AT-EXPENSE-PER-PMT
 18196     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 18197     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 18198     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 18199     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 18200     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 18201     if pi-int-to-rem-borr = 'Y'
 18202        move 'Q1'                to at-payee-type-cd
 18203     else
 18204        MOVE 'O1'                TO AT-PAYEE-TYPE-CD
 18205     end-if
 18206     MOVE PI-int-payees-name     TO AT-PAYEES-NAME
 18207     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 18208     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 18209     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 18210     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 18211                                    AT-TO-BE-WRITTEN-DT
 18212     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 18213                                    AT-CHECK-QUE-SEQUENCE
 18214                                    AT-ADDL-RESERVE
 18215     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 18216                                    AT-VOID-SELECT-DT
 18217                                    AT-VOID-ACCEPT-DT
 18218                                    AT-VOID-DT
 18219                                    AT-PMT-PROOF-DT
 18220                                    AT-INT-PMT-SELECT-DT
 18221     MOVE ZEROS                  TO AT-DAILY-RATE
 18222                                    AT-ELIMINATION-DAYS
 18223     MOVE SPACES                 TO AT-BENEFIT-TYPE
 18224*    EXEC CICS HANDLE CONDITION
 18225*        DUPREC    (7120-DUPREC)
 18226*    END-EXEC
 18227     .
 18228 7115-WRITE-INT-TRLR.
 18229
 18230* EXEC CICS WRITE
 18231*         DATASET       ('ELTRLR')
 18232*         FROM          (ACTIVITY-TRAILERS)
 18233*         RIDFLD        (AT-CONTROL-PRIMARY)
 18234*         RESP          (WS-RESPONSE)
 18235*     END-EXEC
 18236     MOVE LENGTH OF
 18237      ACTIVITY-TRAILERS
 18238       TO DFHEIV11
 18239     MOVE 'ELTRLR' TO DFHEIV1
 18240*    MOVE '&$ L                  ''  N#00016710' TO DFHEIV0
 18241     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18242     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18243     MOVE X'204E233030303136373130' TO DFHEIV0(25:11)
 18244     CALL 'kxdfhei1' USING DFHEIV0,
 18245           DFHEIV1,
 18246           ACTIVITY-TRAILERS,
 18247           DFHEIV11,
 18248           AT-CONTROL-PRIMARY,
 18249           DFHEIV99,
 18250           DFHEIV99
 18251     MOVE EIBRESP  TO WS-RESPONSE
 18252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 348
* EL156.cbl
 18253      IF WS-RESP-DUPREC
 18254         GO TO 7120-DUPREC
 18255      END-IF
 18256     GO TO 7130-EXIT
 18257     .
 18258 7120-DUPREC.
 18259     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18260     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18261     GO TO 7115-WRITE-INT-TRLR
 18262     .
 18263 7130-EXIT.
 18264      EXIT.
 18265 7140-BUILD-NOTE-TRLR.
 18266
 18267
 18268* EXEC CICS GETMAIN
 18269*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18270*         LENGTH    (200)
 18271*         INITIMG   (GETMAIN-SPACE)
 18272*     END-EXEC
 18273     MOVE 200
 18274       TO DFHEIV11
 18275*    MOVE ',"IL                  $   #00016730' TO DFHEIV0
 18276     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18277     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18278     MOVE X'2020233030303136373330' TO DFHEIV0(25:11)
 18279     CALL 'kxdfhei1' USING DFHEIV0,
 18280           DFHEIV20,
 18281           DFHEIV11,
 18282           GETMAIN-SPACE
 18283     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18284         DFHEIV20
 18285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18286     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18287     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18288     MOVE 'AT'                   TO AT-RECORD-ID
 18289     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18290     MOVE '6'                    TO AT-TRAILER-TYPE
 18291     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18292                                    AT-GEN-INFO-LAST-MAINT-DT
 18293     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18294                                    AT-GEN-INFO-LAST-UPDATED-BY
 18295     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18296     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 18297     .
 18298 7150-WRITE.
 18299
 18300* EXEC CICS HANDLE CONDITION
 18301*        DUPREC    (7160-DUPREC)
 18302*    END-EXEC
 18303*    MOVE '"$%                   ! : #00016748' TO DFHEIV0
 18304     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18305     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18306     MOVE X'3A20233030303136373438' TO DFHEIV0(25:11)
 18307     CALL 'kxdfhei1' USING DFHEIV0
 18308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18309
 18310* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 349
* EL156.cbl
 18311*         DATASET     ('ELTRLR')
 18312*         FROM        (ACTIVITY-TRAILERS)
 18313*         RIDFLD      (AT-CONTROL-PRIMARY)
 18314*         RESP        (WS-RESPONSE)
 18315*     END-EXEC
 18316     MOVE LENGTH OF
 18317      ACTIVITY-TRAILERS
 18318       TO DFHEIV11
 18319     MOVE 'ELTRLR' TO DFHEIV1
 18320*    MOVE '&$ L                  ''  N#00016751' TO DFHEIV0
 18321     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18322     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18323     MOVE X'204E233030303136373531' TO DFHEIV0(25:11)
 18324     CALL 'kxdfhei1' USING DFHEIV0,
 18325           DFHEIV1,
 18326           ACTIVITY-TRAILERS,
 18327           DFHEIV11,
 18328           AT-CONTROL-PRIMARY,
 18329           DFHEIV99,
 18330           DFHEIV99
 18331     MOVE EIBRESP  TO WS-RESPONSE
 18332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18333      IF WS-RESP-DUPREC
 18334         GO TO 7160-DUPREC
 18335      END-IF
 18336     GO TO 7170-EXIT
 18337     .
 18338 7160-DUPREC.
 18339     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18340     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18341     GO TO 7150-WRITE
 18342     .
 18343 7170-EXIT.
 18344      EXIT.
 18345
 18346 7180-ADD-CERT-NOTE.
 18347*ADD CERT NOTE FOR SC NP+6
 18348
 18349
 18350* EXEC CICS GETMAIN
 18351*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18352*         LENGTH    (150)
 18353*         INITIMG   (GETMAIN-SPACE)
 18354*     END-EXEC.
 18355     MOVE 150
 18356       TO DFHEIV11
 18357*    MOVE ',"IL                  $   #00016773' TO DFHEIV0
 18358     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18359     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18360     MOVE X'2020233030303136373733' TO DFHEIV0(25:11)
 18361     CALL 'kxdfhei1' USING DFHEIV0,
 18362           DFHEIV20,
 18363           DFHEIV11,
 18364           GETMAIN-SPACE
 18365     SET ADDRESS OF CERT-NOTE-FILE TO
 18366         DFHEIV20
 18367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18368
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 350
* EL156.cbl
 18369
 18370     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18371     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18372     MOVE +1                     TO WRK-NOTE-SEQ.
 18373     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18374     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18375     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18376     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18377     MOVE CL-CERT-STATE          TO CZ-STATE.
 18378     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18379     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18380     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18381     MOVE '2'                    TO CZ-RECORD-TYPE.
 18382     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18383     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18384     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18385     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18386     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18387     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18388     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18389     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18390     IF PI-COMPANY-ID = 'AHL'
 18391        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18392           CONTINUE
 18393        ELSE
 18394           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18395              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18396           ELSE
 18397              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18398           END-IF
 18399        END-IF
 18400     END-IF
 18401     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18402     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18403
 18404 7181-WRITE.
 18405
 18406
 18407* EXEC CICS WRITE
 18408*         DATASET     ('ERCNOT')
 18409*         FROM        (CERT-NOTE-FILE)
 18410*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18411*         RESP        (WS-RESPONSE)
 18412*    END-EXEC.
 18413     MOVE LENGTH OF
 18414      CERT-NOTE-FILE
 18415       TO DFHEIV11
 18416     MOVE 'ERCNOT' TO DFHEIV1
 18417*    MOVE '&$ L                  ''  N#00016815' TO DFHEIV0
 18418     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18419     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18420     MOVE X'204E233030303136383135' TO DFHEIV0(25:11)
 18421     CALL 'kxdfhei1' USING DFHEIV0,
 18422           DFHEIV1,
 18423           CERT-NOTE-FILE,
 18424           DFHEIV11,
 18425           CZ-CONTROL-PRIMARY,
 18426           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 351
* EL156.cbl
 18427           DFHEIV99
 18428     MOVE EIBRESP  TO WS-RESPONSE
 18429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18430
 18431
 18432     IF WS-RESP-DUPREC
 18433         GO TO 7182-DUPREC
 18434     END-IF.
 18435
 18436     SET CERT-NOTE-ADDED TO TRUE.
 18437
 18438     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18439         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18440     END-IF.
 18441
 18442     GO TO 7189-EXIT.
 18443
 18444 7182-DUPREC.
 18445
 18446     ADD +1                      TO  WRK-NOTE-SEQ.
 18447     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18448     GO TO 7181-WRITE.
 18449
 18450 7189-EXIT.
 18451      EXIT.
 18452
 18453 7190-ADD-ORIG-NOTE.
 18454
 18455
 18456* EXEC CICS GETMAIN
 18457*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18458*         LENGTH    (150)
 18459*         INITIMG   (GETMAIN-SPACE)
 18460*     END-EXEC.
 18461     MOVE 150
 18462       TO DFHEIV11
 18463*    MOVE ',"IL                  $   #00016845' TO DFHEIV0
 18464     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18465     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18466     MOVE X'2020233030303136383435' TO DFHEIV0(25:11)
 18467     CALL 'kxdfhei1' USING DFHEIV0,
 18468           DFHEIV20,
 18469           DFHEIV11,
 18470           GETMAIN-SPACE
 18471     SET ADDRESS OF CERT-NOTE-FILE TO
 18472         DFHEIV20
 18473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18474
 18475
 18476     ADD +1                      TO WRK-NOTE-SEQ.
 18477     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18478     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18479     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18480     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18481     MOVE CL-CERT-STATE          TO CZ-STATE.
 18482     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18483     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18484     MOVE CL-CERT-NO             TO CZ-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 352
* EL156.cbl
 18485     MOVE '2'                    TO CZ-RECORD-TYPE.
 18486     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18487     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18488     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18489     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18490     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18491     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18492
 18493 7191-WRITE.
 18494
 18495
 18496* EXEC CICS WRITE
 18497*         DATASET     ('ERCNOT')
 18498*         FROM        (CERT-NOTE-FILE)
 18499*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18500*         RESP        (WS-RESPONSE)
 18501*    END-EXEC.
 18502     MOVE LENGTH OF
 18503      CERT-NOTE-FILE
 18504       TO DFHEIV11
 18505     MOVE 'ERCNOT' TO DFHEIV1
 18506*    MOVE '&$ L                  ''  N#00016870' TO DFHEIV0
 18507     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18508     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18509     MOVE X'204E233030303136383730' TO DFHEIV0(25:11)
 18510     CALL 'kxdfhei1' USING DFHEIV0,
 18511           DFHEIV1,
 18512           CERT-NOTE-FILE,
 18513           DFHEIV11,
 18514           CZ-CONTROL-PRIMARY,
 18515           DFHEIV99,
 18516           DFHEIV99
 18517     MOVE EIBRESP  TO WS-RESPONSE
 18518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18519
 18520
 18521     IF WS-RESP-DUPREC
 18522         GO TO 7192-DUPREC
 18523     END-IF.
 18524
 18525     GO TO 7199-EXIT.
 18526
 18527 7192-DUPREC.
 18528
 18529     ADD +1                      TO  WRK-NOTE-SEQ.
 18530     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18531     GO TO 7191-WRITE.
 18532
 18533 7199-EXIT.
 18534      EXIT.
 18535 7200-FIND-BENEFIT.
 18536     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18537
 18538
 18539* EXEC CICS HANDLE CONDITION
 18540*        ENDFILE(7200-EXIT)
 18541*        NOTFND(7200-EXIT)
 18542*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 353
* EL156.cbl
 18543*    MOVE '"$''I                  ! ; #00016894' TO DFHEIV0
 18544     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18545     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18546     MOVE X'3B20233030303136383934' TO DFHEIV0(25:11)
 18547     CALL 'kxdfhei1' USING DFHEIV0
 18548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18549
 18550
 18551
 18552* EXEC CICS READ
 18553*        DATASET('ELCNTL')
 18554*        SET(ADDRESS OF CONTROL-FILE)
 18555*        RIDFLD(ELCNTL-KEY)
 18556*        GTEQ
 18557*    END-EXEC.
 18558     MOVE 'ELCNTL' TO DFHEIV1
 18559*    MOVE '&"S        G          (   #00016899' TO DFHEIV0
 18560     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18561     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18562     MOVE X'2020233030303136383939' TO DFHEIV0(25:11)
 18563     CALL 'kxdfhei1' USING DFHEIV0,
 18564           DFHEIV1,
 18565           DFHEIV20,
 18566           DFHEIV99,
 18567           ELCNTL-KEY,
 18568           DFHEIV99,
 18569           DFHEIV99,
 18570           DFHEIV99
 18571     SET ADDRESS OF CONTROL-FILE TO
 18572         DFHEIV20
 18573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18574
 18575
 18576     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18577        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18578           GO TO 7200-EXIT.
 18579
 18580     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18581         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18582            ((SUB-1 > 8) OR
 18583            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18584
 18585     IF SUB-1 NOT = 9
 18586         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18587
 18588     GO TO 7200-EXIT.
 18589
 18590 7200-BENEFIT-DUMMY.
 18591
 18592 7200-DUMMY-EXIT.
 18593     EXIT.
 18594
 18595 7200-EXIT.
 18596     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 354
* EL156.cbl
 18598*052506
 18599*052506 7250-FIND-LETTER-TRLR.
 18600*052506     EXEC CICS HANDLE CONDITION
 18601*052506         ENDFILE  (7250-END)
 18602*052506         NOTFND   (7250-END)
 18603*052506     END-EXEC.
 18604*052506
 18605*052506     EXEC CICS STARTBR
 18606*052506         DATASET   ('ELTRLR')
 18607*052506         RIDFLD    (ELTRLR-KEY)
 18608*052506         GTEQ
 18609*052506     END-EXEC.
 18610*052506
 18611*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18612*052506
 18613*052506 7250-FIND-LOOP.
 18614*052506     EXEC CICS READNEXT
 18615*052506         DATASET   ('ELTRLR')
 18616*052506         RIDFLD    (ELTRLR-KEY)
 18617*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18618*052506     END-EXEC.
 18619*052506
 18620*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18621*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18622*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18623*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18624*052506        GO TO 7250-END
 18625*052506     END-IF.
 18626*052506
 18627*052506     IF AT-TRAILER-TYPE NOT = '4'
 18628*052506         GO TO 7250-FIND-LOOP
 18629*052506     END-IF.
 18630*052506
 18631*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18632*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18633*052506     END-IF.
 18634*052506
 18635*052506     GO TO 7250-FIND-LOOP.
 18636*052506
 18637*052506 7250-END.
 18638*052506
 18639*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18640*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18641*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18642*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18643*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18644*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18645*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18646*052506     END-IF.
 18647*052506
 18648*052506     EXEC CICS ENDBR
 18649*052506          DATASET    ('ELTRLR')
 18650*052506     END-EXEC.
 18651*052506
 18652*052506 7250-EXIT.
 18653*052506     EXIT.
 18654*052506     EJECT
 18655*052506
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 355
* EL156.cbl
 18656 7300-CHECK-AUTO-ACTIVITY.
 18657
 18658     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18659         NEXT SENTENCE
 18660     ELSE
 18661         GO TO 7399-EXIT.
 18662
 18663     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18664
 18665     IF WS-ACT-REC-FOUND-SW = 'N'
 18666         GO TO 7399-EXIT.
 18667
 18668     IF PI-ACTIVITY-CODE = 09
 18669         GO TO 7300-CONT-AUTO-ACTIVITY.
 18670
 18671     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18672        (PI-ACTIVITY-CODE = 11)
 18673         GO TO 7300-CONT-AUTO-ACTIVITY.
 18674
 18675     IF PI-PROVISIONAL-IND = 'P'
 18676         IF PI-PMTTYPE = '1'
 18677             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18678                 MOVE 'N'    TO  PI-RESET-SW
 18679                 GO TO 7399-EXIT.
 18680
 18681     IF PI-PMTTYPE = '1'
 18682         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18683             MOVE 'N'        TO  PI-RESET-SW
 18684             GO TO 7399-EXIT.
 18685
 18686     IF PI-PMTTYPE = '2' OR '3'
 18687         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18688             MOVE 'N'        TO  PI-RESET-SW
 18689             GO TO 7399-EXIT.
 18690
 18691     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18692         IF PI-PROVISIONAL-IND = 'P'
 18693             NEXT SENTENCE
 18694         ELSE
 18695             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18696
 18697 7300-CONT-AUTO-ACTIVITY.
 18698
 18699     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18700         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18701         MOVE '4'            TO DC-OPTION-CODE
 18702         MOVE +0             TO DC-ELAPSED-DAYS
 18703                                DC-ELAPSED-MONTHS
 18704         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18705         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18706         IF PI-USES-PAID-TO
 18707             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18708             IF NO-CONVERSION-ERROR
 18709                 MOVE +1     TO DC-ELAPSED-DAYS
 18710                 MOVE +0     TO DC-ELAPSED-MONTHS
 18711                 MOVE '6'    TO DC-OPTION-CODE
 18712                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18713                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 356
* EL156.cbl
 18714                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18715
 18716     IF PI-PFKEY-USED = DFHPF5
 18717         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18718         IF PI-USES-PAID-TO
 18719             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18720             MOVE +1                  TO DC-ELAPSED-DAYS
 18721             MOVE +0                  TO DC-ELAPSED-MONTHS
 18722             MOVE '6'                 TO DC-OPTION-CODE
 18723             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18724             IF NO-CONVERSION-ERROR
 18725                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18726
 18727     IF WS-CHK-THRU-DT < PI-EXP-DT
 18728         NEXT SENTENCE
 18729     ELSE
 18730         MOVE 03                     TO  WS-ACTIVITY-CODE
 18731         GO TO 7390-PROCESS-ACTIVITY.
 18732
 18733     IF PI-PROV-PMT
 18734         MOVE 09                     TO  WS-ACTIVITY-CODE
 18735     ELSE
 18736        IF PI-PMTTYPE = '1'
 18737            MOVE 02                  TO  WS-ACTIVITY-CODE
 18738        ELSE
 18739        IF PI-PMTTYPE = '2' OR '3'
 18740            MOVE 07                  TO  WS-ACTIVITY-CODE
 18741        ELSE
 18742        IF PI-PMTTYPE = '4'
 18743            MOVE 00                  TO  WS-ACTIVITY-CODE
 18744        ELSE
 18745            MOVE 'N'                 TO  PI-RESET-SW
 18746            GO TO 7399-EXIT.
 18747
 18748 7390-PROCESS-ACTIVITY.
 18749
 18750     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18751
 18752 7399-EXIT.
 18753     EXIT.
 18754
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 357
* EL156.cbl
 18756 7400-CHECK-AUTO-ACTIVITY.
 18757
 18758
 18759* EXEC CICS HANDLE CONDITION
 18760*        NOTFND   (7400-NOT-FOUND)
 18761*    END-EXEC.
 18762*    MOVE '"$I                   ! < #00017088' TO DFHEIV0
 18763     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18764     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18765     MOVE X'3C20233030303137303838' TO DFHEIV0(25:11)
 18766     CALL 'kxdfhei1' USING DFHEIV0
 18767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18768
 18769
 18770     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18771     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18772     MOVE SPACES                 TO  CNTL-ACCESS.
 18773     MOVE +0                     TO  CNTL-SEQ-NO.
 18774
 18775
 18776* EXEC CICS READ
 18777*        DATASET   ('ELCNTL')
 18778*        RIDFLD    (ELCNTL-KEY)
 18779*        SET       (ADDRESS OF CONTROL-FILE)
 18780*    END-EXEC.
 18781     MOVE 'ELCNTL' TO DFHEIV1
 18782*    MOVE '&"S        E          (   #00017097' TO DFHEIV0
 18783     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18784     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18785     MOVE X'2020233030303137303937' TO DFHEIV0(25:11)
 18786     CALL 'kxdfhei1' USING DFHEIV0,
 18787           DFHEIV1,
 18788           DFHEIV20,
 18789           DFHEIV99,
 18790           ELCNTL-KEY,
 18791           DFHEIV99,
 18792           DFHEIV99,
 18793           DFHEIV99
 18794     SET ADDRESS OF CONTROL-FILE TO
 18795         DFHEIV20
 18796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18797
 18798
 18799     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18800     GO TO 7400-EXIT.
 18801
 18802 7400-NOT-FOUND.
 18803     MOVE 'N'                        TO  PI-RESET-SW
 18804                                         WS-LETTER-SW
 18805                                         WS-ACT-REC-FOUND-SW.
 18806
 18807     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18808
 18809 7400-EXIT.
 18810     EXIT.
 18811
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 358
* EL156.cbl
 18813 7450-FORMAT-AUTO-LETTER.
 18814
 18815     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18816         MOVE 'Y'                    TO PI-RESET-SW
 18817         GO TO 7450-CONTINUE-PROCESS.
 18818
 18819     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18820
 18821     IF SUB > 9
 18822         SUBTRACT 9 FROM SUB
 18823         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18824     ELSE
 18825         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18826
 18827 7450-CONTINUE-PROCESS.
 18828
 18829     IF WS-ACTIVITY-CODE = ZEROS
 18830         MOVE 'N'                    TO  WS-LETTER-SW
 18831         GO TO 7450-EXIT.
 18832
 18833     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18834
 18835     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18836         MOVE 'N'                    TO  PI-RESET-SW
 18837                                         WS-LETTER-SW
 18838         GO TO 7450-EXIT.
 18839
 18840     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18841         MOVE 'N'                    TO  WS-LETTER-SW
 18842         GO TO 7450-EXIT.
 18843
 18844     MOVE 'Y'                        TO  WS-LETTER-SW.
 18845     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18846     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18847
 18848     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18849
 18850     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18851         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18852         MOVE '6'                    TO  DC-OPTION-CODE
 18853         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18854         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18855         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18856         IF NO-CONVERSION-ERROR
 18857             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18858         ELSE
 18859              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18860
 18861     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18862         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18863         MOVE '6'                    TO  DC-OPTION-CODE
 18864         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18865         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18866         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18867         IF NO-CONVERSION-ERROR
 18868             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18869         ELSE
 18870             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 359
* EL156.cbl
 18871
 18872 7450-EXIT.
 18873     EXIT.
 18874
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 360
* EL156.cbl
 18876 7500-RESET-AUTO-ACTIVITY.
 18877
 18878     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18879     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18880     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18881     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18882     MOVE +100                   TO  TRLR-SEQ-NO.
 18883
 18884 7500-STARTBR-TRLR.
 18885
 18886
 18887* EXEC CICS HANDLE CONDITION
 18888*        ENDFILE  (7590-END)
 18889*        NOTFND   (7590-END)
 18890*    END-EXEC.
 18891*    MOVE '"$''I                  ! = #00017190' TO DFHEIV0
 18892     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18893     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18894     MOVE X'3D20233030303137313930' TO DFHEIV0(25:11)
 18895     CALL 'kxdfhei1' USING DFHEIV0
 18896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18897
 18898
 18899
 18900* EXEC CICS STARTBR
 18901*        DATASET   ('ELTRLR')
 18902*        RIDFLD    (ELTRLR-KEY)
 18903*        GTEQ
 18904*    END-EXEC.
 18905     MOVE 'ELTRLR' TO DFHEIV1
 18906     MOVE 0
 18907       TO DFHEIV11
 18908*    MOVE '&,         G          &   #00017195' TO DFHEIV0
 18909     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18910     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18911     MOVE X'2020233030303137313935' TO DFHEIV0(25:11)
 18912     CALL 'kxdfhei1' USING DFHEIV0,
 18913           DFHEIV1,
 18914           ELTRLR-KEY,
 18915           DFHEIV99,
 18916           DFHEIV11,
 18917           DFHEIV99
 18918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18919
 18920
 18921     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18922
 18923 7500-READ-NEXT.
 18924
 18925
 18926* EXEC CICS READNEXT
 18927*        DATASET   ('ELTRLR')
 18928*        RIDFLD    (ELTRLR-KEY)
 18929*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18930*    END-EXEC.
 18931     MOVE 'ELTRLR' TO DFHEIV1
 18932     MOVE 0
 18933       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 361
* EL156.cbl
 18934*    MOVE '&.S                   )   #00017205' TO DFHEIV0
 18935     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18936     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18937     MOVE X'2020233030303137323035' TO DFHEIV0(25:11)
 18938     CALL 'kxdfhei1' USING DFHEIV0,
 18939           DFHEIV1,
 18940           DFHEIV20,
 18941           DFHEIV99,
 18942           ELTRLR-KEY,
 18943           DFHEIV99,
 18944           DFHEIV11,
 18945           DFHEIV99,
 18946           DFHEIV99
 18947     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18948         DFHEIV20
 18949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18950
 18951
 18952     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18953        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18954        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18955        PI-CERT-NO    NOT = TRLR-CERT-NO
 18956         GO TO 7590-END.
 18957
 18958     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18959         GO TO 7500-READ-NEXT.
 18960
 18961     IF AT-TRAILER-TYPE NOT = '4'
 18962         GO TO 7500-READ-NEXT.
 18963
 18964     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18965         GO TO 7500-READ-NEXT.
 18966
 18967     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18968        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18969         GO TO 7500-READ-NEXT.
 18970
 18971     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18972        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18973        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18974         GO TO 7500-READ-NEXT.
 18975
 18976     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18977                         AND
 18978        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18979                         AND
 18980        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18981            GO TO 7500-READ-NEXT.
 18982
 18983     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18984
 18985
 18986* EXEC CICS ENDBR
 18987*        DATASET   ('ELTRLR')
 18988*    END-EXEC.
 18989     MOVE 'ELTRLR' TO DFHEIV1
 18990     MOVE 0
 18991       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 362
* EL156.cbl
 18992*    MOVE '&2                    $   #00017244' TO DFHEIV0
 18993     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18994     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18995     MOVE X'2020233030303137323434' TO DFHEIV0(25:11)
 18996     CALL 'kxdfhei1' USING DFHEIV0,
 18997           DFHEIV1,
 18998           DFHEIV11,
 18999           DFHEIV99
 19000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19001
 19002
 19003     MOVE 'N'                        TO  WS-BROWSE-SW.
 19004
 19005
 19006* EXEC CICS READ
 19007*        DATASET   ('ELTRLR')
 19008*        RIDFLD    (ELTRLR-KEY)
 19009*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 19010*        UPDATE
 19011*    END-EXEC.
 19012     MOVE 'ELTRLR' TO DFHEIV1
 19013*    MOVE '&"S        EU         (   #00017250' TO DFHEIV0
 19014     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19015     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19016     MOVE X'2020233030303137323530' TO DFHEIV0(25:11)
 19017     CALL 'kxdfhei1' USING DFHEIV0,
 19018           DFHEIV1,
 19019           DFHEIV20,
 19020           DFHEIV99,
 19021           ELTRLR-KEY,
 19022           DFHEIV99,
 19023           DFHEIV99,
 19024           DFHEIV99
 19025     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19026         DFHEIV20
 19027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19028
 19029
 19030     MOVE 'Y'                        TO  WS-UPDATE-SW.
 19031
 19032     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 19033         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 19034     ELSE
 19035         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 19036             NEXT SENTENCE
 19037         ELSE
 19038             GO TO 7500-REWRITE-TRLR.
 19039
 19040     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 19041
 19042     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 19043     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 19044     MOVE '1'                        TO  ARCH-REC-TYPE.
 19045     MOVE +0                         TO  ARCH-SEQ.
 19046
 19047     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 19048
 19049 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 363
* EL156.cbl
 19050
 19051
 19052* EXEC CICS REWRITE
 19053*        DATASET   ('ELTRLR')
 19054*        FROM      (ACTIVITY-TRAILERS)
 19055*    END-EXEC.
 19056     MOVE LENGTH OF
 19057      ACTIVITY-TRAILERS
 19058       TO DFHEIV11
 19059     MOVE 'ELTRLR' TO DFHEIV1
 19060*    MOVE '&& L                  %   #00017278' TO DFHEIV0
 19061     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19062     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19063     MOVE X'2020233030303137323738' TO DFHEIV0(25:11)
 19064     CALL 'kxdfhei1' USING DFHEIV0,
 19065           DFHEIV1,
 19066           ACTIVITY-TRAILERS,
 19067           DFHEIV11,
 19068           DFHEIV99
 19069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19070
 19071
 19072     GO TO 7500-STARTBR-TRLR.
 19073
 19074 7590-END.
 19075
 19076     IF WS-BROWSE-SW = 'Y'
 19077         MOVE 'N'                    TO  WS-BROWSE-SW
 19078
 19079* EXEC CICS ENDBR
 19080*            DATASET   ('ELTRLR')
 19081*        END-EXEC.
 19082     MOVE 'ELTRLR' TO DFHEIV1
 19083     MOVE 0
 19084       TO DFHEIV11
 19085*    MOVE '&2                    $   #00017289' TO DFHEIV0
 19086     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19087     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19088     MOVE X'2020233030303137323839' TO DFHEIV0(25:11)
 19089     CALL 'kxdfhei1' USING DFHEIV0,
 19090           DFHEIV1,
 19091           DFHEIV11,
 19092           DFHEIV99
 19093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19094
 19095
 19096 7599-EXIT.
 19097     EXIT.
 19098
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 364
* EL156.cbl
 19100 7600-READ-ARCH-UPDATE.
 19101
 19102
 19103* EXEC CICS HANDLE CONDITION
 19104*        NOTFND   (7699-EXIT)
 19105*    END-EXEC.
 19106*    MOVE '"$I                   ! > #00017299' TO DFHEIV0
 19107     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19108     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19109     MOVE X'3E20233030303137323939' TO DFHEIV0(25:11)
 19110     CALL 'kxdfhei1' USING DFHEIV0
 19111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19112
 19113
 19114
 19115* EXEC CICS READ
 19116*        DATASET   ('ELARCH')
 19117*        RIDFLD    (ELARCH-KEY)
 19118*        SET       (ADDRESS OF LETTER-ARCHIVE)
 19119*        UPDATE
 19120*    END-EXEC.
 19121     MOVE 'ELARCH' TO DFHEIV1
 19122*    MOVE '&"S        EU         (   #00017303' TO DFHEIV0
 19123     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19124     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19125     MOVE X'2020233030303137333033' TO DFHEIV0(25:11)
 19126     CALL 'kxdfhei1' USING DFHEIV0,
 19127           DFHEIV1,
 19128           DFHEIV20,
 19129           DFHEIV99,
 19130           ELARCH-KEY,
 19131           DFHEIV99,
 19132           DFHEIV99,
 19133           DFHEIV99
 19134     SET ADDRESS OF LETTER-ARCHIVE TO
 19135         DFHEIV20
 19136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19137
 19138
 19139     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 19140
 19141
 19142* EXEC CICS REWRITE
 19143*        DATASET   ('ELARCH')
 19144*        FROM      (LETTER-ARCHIVE)
 19145*    END-EXEC.
 19146     MOVE LENGTH OF
 19147      LETTER-ARCHIVE
 19148       TO DFHEIV11
 19149     MOVE 'ELARCH' TO DFHEIV1
 19150*    MOVE '&& L                  %   #00017312' TO DFHEIV0
 19151     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19152     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19153     MOVE X'2020233030303137333132' TO DFHEIV0(25:11)
 19154     CALL 'kxdfhei1' USING DFHEIV0,
 19155           DFHEIV1,
 19156           LETTER-ARCHIVE,
 19157           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 365
* EL156.cbl
 19158           DFHEIV99
 19159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19160
 19161
 19162 7699-EXIT.
 19163     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 366
* EL156.cbl
 19165 7700-GET-DCT.
 19166
 19167     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 19168     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 19169     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 19170     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 19171                                    PI-MAX-BENEFIT-AMT
 19172                                    PI-MAX-BENEFIT-PYMT
 19173                                    PI-MIN-PAYMENT-AMT
 19174                                    PI-TIME-OF-LOSS-BAL.
 19175
 19176
 19177* EXEC CICS HANDLE CONDITION
 19178*         NOTFND (5300-NOTE-NOT-FOUND)
 19179*     END-EXEC.
 19180*    MOVE '"$I                   ! ? #00017331' TO DFHEIV0
 19181     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19182     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19183     MOVE X'3F20233030303137333331' TO DFHEIV0(25:11)
 19184     CALL 'kxdfhei1' USING DFHEIV0
 19185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19186
 19187
 19188
 19189* EXEC CICS READ
 19190*         DATASET('ERNOTE')
 19191*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 19192*         RIDFLD (W-NOTE-KEY)
 19193*     END-EXEC.
 19194     MOVE 'ERNOTE' TO DFHEIV1
 19195*    MOVE '&"S        E          (   #00017335' TO DFHEIV0
 19196     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19197     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19198     MOVE X'2020233030303137333335' TO DFHEIV0(25:11)
 19199     CALL 'kxdfhei1' USING DFHEIV0,
 19200           DFHEIV1,
 19201           DFHEIV20,
 19202           DFHEIV99,
 19203           W-NOTE-KEY,
 19204           DFHEIV99,
 19205           DFHEIV99,
 19206           DFHEIV99
 19207     SET ADDRESS OF CERTIFICATE-NOTE TO
 19208         DFHEIV20
 19209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19210
 19211
 19212     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 19213     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 19214     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 19215     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 19216     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 19217
 19218     IF PI-PAYEE-TYPE NOT = 'B'
 19219         GO TO 7700-EXIT.
 19220
 19221     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 19222     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 367
* EL156.cbl
 19223     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 19224
 19225     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 19226         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 19227     ELSE
 19228         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 19229
 19230     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 19231     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 19232     MOVE 'DLO006'               TO PGM-NAME.
 19233
 19234
 19235* EXEC CICS LINK
 19236*        PROGRAM    (PGM-NAME)
 19237*        COMMAREA   (DCT-COMMUNICATION-AREA)
 19238*        LENGTH     (DCT-RCRD-LENGTH)
 19239*    END-EXEC.
 19240*    MOVE '."C                   (   #00017363' TO DFHEIV0
 19241     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19242     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19243     MOVE X'2020233030303137333633' TO DFHEIV0(25:11)
 19244     CALL 'kxdfhei1' USING DFHEIV0,
 19245           PGM-NAME,
 19246           DCT-COMMUNICATION-AREA,
 19247           DCT-RCRD-LENGTH,
 19248           DFHEIV99,
 19249           DFHEIV99,
 19250           DFHEIV99,
 19251           DFHEIV99
 19252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19253
 19254
 19255     IF DCT-RETURN-CODE = 'OK'
 19256         GO TO 7700-CONT.
 19257
 19258     IF DCT-RETURN-CODE = '01' OR '02'
 19259         GO TO 7700-SET-TO-YES.
 19260
 19261     IF DCT-RETURN-CODE = '03'
 19262
 19263* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19264*    MOVE '6"R                   !   #00017376' TO DFHEIV0
 19265     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19266     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19267     MOVE X'2020233030303137333736' TO DFHEIV0(25:11)
 19268     CALL 'kxdfhei1' USING DFHEIV0
 19269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19270         MOVE ER-0951            TO EMI-ERROR
 19271         MOVE -1                 TO PMTTYPEL
 19272         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19273         GO TO 8200-SEND-DATAONLY.
 19274
 19275     IF DCT-RETURN-CODE = '04'
 19276
 19277* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19278*    MOVE '6"R                   !   #00017383' TO DFHEIV0
 19279     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19280     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 368
* EL156.cbl
 19281     MOVE X'2020233030303137333833' TO DFHEIV0(25:11)
 19282     CALL 'kxdfhei1' USING DFHEIV0
 19283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19284         MOVE ER-0946            TO EMI-ERROR
 19285         MOVE -1                 TO PMTTYPEL
 19286         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19287         GO TO 8200-SEND-DATAONLY.
 19288
 19289     IF DCT-RETURN-CODE = '05'
 19290
 19291* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19292*    MOVE '6"R                   !   #00017390' TO DFHEIV0
 19293     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19294     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19295     MOVE X'2020233030303137333930' TO DFHEIV0(25:11)
 19296     CALL 'kxdfhei1' USING DFHEIV0
 19297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19298         MOVE ER-0947            TO EMI-ERROR
 19299         MOVE -1                 TO PMTTYPEL
 19300         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19301         GO TO 8200-SEND-DATAONLY.
 19302
 19303     IF DCT-RETURN-CODE = '06'
 19304
 19305* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19306*    MOVE '6"R                   !   #00017397' TO DFHEIV0
 19307     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19308     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19309     MOVE X'2020233030303137333937' TO DFHEIV0(25:11)
 19310     CALL 'kxdfhei1' USING DFHEIV0
 19311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19312         MOVE ER-0921            TO EMI-ERROR
 19313         MOVE -1                 TO PMTTYPEL
 19314         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19315         GO TO 8200-SEND-DATAONLY.
 19316
 19317     IF DCT-RETURN-CODE = '07'
 19318
 19319* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19320*    MOVE '6"R                   !   #00017404' TO DFHEIV0
 19321     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19322     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19323     MOVE X'2020233030303137343034' TO DFHEIV0(25:11)
 19324     CALL 'kxdfhei1' USING DFHEIV0
 19325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19326         MOVE ER-0919            TO EMI-ERROR
 19327         MOVE -1                 TO PMTTYPEL
 19328         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19329         GO TO 8200-SEND-DATAONLY.
 19330
 19331     IF DCT-RETURN-CODE = '08'
 19332
 19333* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19334*    MOVE '6"R                   !   #00017411' TO DFHEIV0
 19335     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19336     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19337     MOVE X'2020233030303137343131' TO DFHEIV0(25:11)
 19338     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 369
* EL156.cbl
 19339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19340         MOVE ER-0948            TO EMI-ERROR
 19341         MOVE -1                 TO PMTTYPEL
 19342         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19343         GO TO 8200-SEND-DATAONLY.
 19344
 19345     IF DCT-RETURN-CODE = 'N1'
 19346
 19347* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19348*    MOVE '6"R                   !   #00017418' TO DFHEIV0
 19349     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19350     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19351     MOVE X'2020233030303137343138' TO DFHEIV0(25:11)
 19352     CALL 'kxdfhei1' USING DFHEIV0
 19353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19354         MOVE ER-0950            TO EMI-ERROR
 19355         MOVE -1                 TO PMTTYPEL
 19356         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19357         GO TO 8200-SEND-DATAONLY.
 19358
 19359     IF DCT-RETURN-CODE = 'E1'
 19360
 19361* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19362*    MOVE '6"R                   !   #00017425' TO DFHEIV0
 19363     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19364     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19365     MOVE X'2020233030303137343235' TO DFHEIV0(25:11)
 19366     CALL 'kxdfhei1' USING DFHEIV0
 19367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19368         MOVE ER-0974            TO EMI-ERROR
 19369         MOVE -1                 TO PMTTYPEL
 19370         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19371         GO TO 8200-SEND-DATAONLY.
 19372
 19373     IF DCT-RETURN-CODE = 'E2'
 19374
 19375* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19376*    MOVE '6"R                   !   #00017432' TO DFHEIV0
 19377     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19378     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19379     MOVE X'2020233030303137343332' TO DFHEIV0(25:11)
 19380     CALL 'kxdfhei1' USING DFHEIV0
 19381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19382         MOVE ER-0975            TO EMI-ERROR
 19383         MOVE -1                 TO PMTTYPEL
 19384         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19385         GO TO 8200-SEND-DATAONLY.
 19386
 19387     IF DCT-RETURN-CODE NOT = 'OK'
 19388
 19389* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19390*    MOVE '6"R                   !   #00017439' TO DFHEIV0
 19391     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19392     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19393     MOVE X'2020233030303137343339' TO DFHEIV0(25:11)
 19394     CALL 'kxdfhei1' USING DFHEIV0
 19395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19396         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 370
* EL156.cbl
 19397         MOVE -1                 TO PMTTYPEL
 19398         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19399         GO TO 8200-SEND-DATAONLY.
 19400
 19401 7700-CONT.
 19402
 19403*    MOVE 'N'                    TO CASHO.
 19404*    MOVE +1                     TO CASHL.
 19405*    MOVE AL-UANON               TO CASHA.
 19406
 19407     IF PI-OFFLINE = 'Y'
 19408         GO TO 7700-EXIT.
 19409
 19410     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19411     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19412     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19413     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19414     MOVE +7                     TO CHECKNOL.
 19415     MOVE AL-UANON               TO CHECKNOA.
 19416     GO TO 7700-EXIT.
 19417
 19418 7700-SET-TO-YES.
 19419
 19420*    MOVE 'Y'                    TO CASHO.
 19421*    MOVE +1                     TO CASHL.
 19422*    MOVE AL-UANON               TO CASHA.
 19423
 19424 7700-EXIT.
 19425     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 371
* EL156.cbl
 19427 7800-READ-COMP-MSTR.
 19428
 19429
 19430* EXEC CICS HANDLE CONDITION
 19431*        NOTFND   (7800-COMP-NOTFND)
 19432*    END-EXEC.
 19433*    MOVE '"$I                   ! @ #00017473' TO DFHEIV0
 19434     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19435     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19436     MOVE X'4020233030303137343733' TO DFHEIV0(25:11)
 19437     CALL 'kxdfhei1' USING DFHEIV0
 19438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19439
 19440
 19441
 19442* EXEC CICS READ
 19443*        DATASET   ('ERCOMP')
 19444*        RIDFLD    (ERCOMP-KEY)
 19445*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19446*    END-EXEC.
 19447     MOVE 'ERCOMP' TO DFHEIV1
 19448*    MOVE '&"S        E          (   #00017477' TO DFHEIV0
 19449     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19450     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19451     MOVE X'2020233030303137343737' TO DFHEIV0(25:11)
 19452     CALL 'kxdfhei1' USING DFHEIV0,
 19453           DFHEIV1,
 19454           DFHEIV20,
 19455           DFHEIV99,
 19456           ERCOMP-KEY,
 19457           DFHEIV99,
 19458           DFHEIV99,
 19459           DFHEIV99
 19460     SET ADDRESS OF COMPENSATION-MASTER TO
 19461         DFHEIV20
 19462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19463
 19464
 19465     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19466     GO TO 7800-COMP-EXIT.
 19467
 19468 7800-COMP-NOTFND.
 19469     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19470
 19471 7800-COMP-EXIT.
 19472     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 372
* EL156.cbl
 19474 7900-READ-CLAIM.
 19475
 19476* EXEC CICS READ
 19477*        DATASET  ('ELMSTR')
 19478*        SET      (ADDRESS OF CLAIM-MASTER)
 19479*        RIDFLD   (ELMSTR-KEY)
 19480*    END-EXEC.
 19481     MOVE 'ELMSTR' TO DFHEIV1
 19482*    MOVE '&"S        E          (   #00017493' TO DFHEIV0
 19483     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19484     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19485     MOVE X'2020233030303137343933' TO DFHEIV0(25:11)
 19486     CALL 'kxdfhei1' USING DFHEIV0,
 19487           DFHEIV1,
 19488           DFHEIV20,
 19489           DFHEIV99,
 19490           ELMSTR-KEY,
 19491           DFHEIV99,
 19492           DFHEIV99,
 19493           DFHEIV99
 19494     SET ADDRESS OF CLAIM-MASTER TO
 19495         DFHEIV20
 19496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19497
 19498
 19499 7900-EXIT.
 19500      EXIT.
 19501
 19502 7910-READ-CLAIM-UPDATE.
 19503
 19504* EXEC CICS READ
 19505*        DATASET  ('ELMSTR')
 19506*        SET      (ADDRESS OF CLAIM-MASTER)
 19507*        RIDFLD   (ELMSTR-KEY)
 19508*        UPDATE
 19509*    END-EXEC.
 19510     MOVE 'ELMSTR' TO DFHEIV1
 19511*    MOVE '&"S        EU         (   #00017503' TO DFHEIV0
 19512     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19513     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19514     MOVE X'2020233030303137353033' TO DFHEIV0(25:11)
 19515     CALL 'kxdfhei1' USING DFHEIV0,
 19516           DFHEIV1,
 19517           DFHEIV20,
 19518           DFHEIV99,
 19519           ELMSTR-KEY,
 19520           DFHEIV99,
 19521           DFHEIV99,
 19522           DFHEIV99
 19523     SET ADDRESS OF CLAIM-MASTER TO
 19524         DFHEIV20
 19525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19526
 19527
 19528 7910-EXIT.
 19529      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 373
* EL156.cbl
 19531 7920-READ-BENE.
 19532     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19533     MOVE 'B'                TO BENE-RECORD-TYPE.
 19534     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19535
 19536     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19537        IF PI-PAYEE-TYPE    = 'B' AND
 19538           PI-PAYEE-SEQ-NUM = 9
 19539             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19540             MOVE WS-A-BENE           TO BENE-NUMBER.
 19541
 19542
 19543* EXEC CICS HANDLE CONDITION
 19544*        NOTFND   (7920-NOT-FOUND)
 19545*    END-EXEC.
 19546*    MOVE '"$I                   ! A #00017524' TO DFHEIV0
 19547     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19548     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19549     MOVE X'4120233030303137353234' TO DFHEIV0(25:11)
 19550     CALL 'kxdfhei1' USING DFHEIV0
 19551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19552
 19553
 19554
 19555* EXEC CICS READ
 19556*        DATASET  ('ELBENE')
 19557*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19558*        RIDFLD   (ELBENE-KEY)
 19559*    END-EXEC.
 19560     MOVE 'ELBENE' TO DFHEIV1
 19561*    MOVE '&"S        E          (   #00017528' TO DFHEIV0
 19562     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19563     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19564     MOVE X'2020233030303137353238' TO DFHEIV0(25:11)
 19565     CALL 'kxdfhei1' USING DFHEIV0,
 19566           DFHEIV1,
 19567           DFHEIV20,
 19568           DFHEIV99,
 19569           ELBENE-KEY,
 19570           DFHEIV99,
 19571           DFHEIV99,
 19572           DFHEIV99
 19573     SET ADDRESS OF BENEFICIARY-MASTER TO
 19574         DFHEIV20
 19575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19576
 19577
 19578     MOVE 'Y' TO BENE-FOUND-SW.
 19579     GO TO 7920-EXIT.
 19580
 19581 7920-NOT-FOUND.
 19582     MOVE 'N'                    TO BENE-FOUND-SW.
 19583
 19584 7920-EXIT.
 19585      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 374
* EL156.cbl
 19587 7930-READ-CONTROL.
 19588
 19589* EXEC CICS READ
 19590*        DATASET  ('ELCNTL')
 19591*        SET      (ADDRESS OF CONTROL-FILE)
 19592*        RIDFLD   (ELCNTL-KEY)
 19593*    END-EXEC.
 19594     MOVE 'ELCNTL' TO DFHEIV1
 19595*    MOVE '&"S        E          (   #00017544' TO DFHEIV0
 19596     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19597     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19598     MOVE X'2020233030303137353434' TO DFHEIV0(25:11)
 19599     CALL 'kxdfhei1' USING DFHEIV0,
 19600           DFHEIV1,
 19601           DFHEIV20,
 19602           DFHEIV99,
 19603           ELCNTL-KEY,
 19604           DFHEIV99,
 19605           DFHEIV99,
 19606           DFHEIV99
 19607     SET ADDRESS OF CONTROL-FILE TO
 19608         DFHEIV20
 19609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19610
 19611
 19612 7930-EXIT.
 19613      EXIT.
 19614
 19615 7940-READ-CONTROL-UPDATE.
 19616
 19617* EXEC CICS READ
 19618*        DATASET  ('ELCNTL')
 19619*        SET      (ADDRESS OF CONTROL-FILE)
 19620*        RIDFLD   (ELCNTL-KEY)
 19621*        UPDATE
 19622*    END-EXEC.
 19623     MOVE 'ELCNTL' TO DFHEIV1
 19624*    MOVE '&"S        EU         (   #00017554' TO DFHEIV0
 19625     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19626     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19627     MOVE X'2020233030303137353534' TO DFHEIV0(25:11)
 19628     CALL 'kxdfhei1' USING DFHEIV0,
 19629           DFHEIV1,
 19630           DFHEIV20,
 19631           DFHEIV99,
 19632           ELCNTL-KEY,
 19633           DFHEIV99,
 19634           DFHEIV99,
 19635           DFHEIV99
 19636     SET ADDRESS OF CONTROL-FILE TO
 19637         DFHEIV20
 19638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19639
 19640
 19641 7940-EXIT.
 19642      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 375
* EL156.cbl
 19644 7950-READ-TRAILER.
 19645
 19646* EXEC CICS READ
 19647*        DATASET  ('ELTRLR')
 19648*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19649*        RIDFLD   (ELTRLR-KEY)
 19650*    END-EXEC.
 19651     MOVE 'ELTRLR' TO DFHEIV1
 19652*    MOVE '&"S        E          (   #00017565' TO DFHEIV0
 19653     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19654     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19655     MOVE X'2020233030303137353635' TO DFHEIV0(25:11)
 19656     CALL 'kxdfhei1' USING DFHEIV0,
 19657           DFHEIV1,
 19658           DFHEIV20,
 19659           DFHEIV99,
 19660           ELTRLR-KEY,
 19661           DFHEIV99,
 19662           DFHEIV99,
 19663           DFHEIV99
 19664     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19665         DFHEIV20
 19666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19667
 19668
 19669 7950-EXIT.
 19670      EXIT.
 19671
 19672 7960-READ-TRAILER-UPDATE.
 19673
 19674* EXEC CICS READ
 19675*        DATASET  ('ELTRLR')
 19676*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19677*        RIDFLD   (ELTRLR-KEY)
 19678*        UPDATE
 19679*    END-EXEC.
 19680     MOVE 'ELTRLR' TO DFHEIV1
 19681*    MOVE '&"S        EU         (   #00017575' TO DFHEIV0
 19682     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19683     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19684     MOVE X'2020233030303137353735' TO DFHEIV0(25:11)
 19685     CALL 'kxdfhei1' USING DFHEIV0,
 19686           DFHEIV1,
 19687           DFHEIV20,
 19688           DFHEIV99,
 19689           ELTRLR-KEY,
 19690           DFHEIV99,
 19691           DFHEIV99,
 19692           DFHEIV99
 19693     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19694         DFHEIV20
 19695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19696
 19697
 19698 7960-EXIT.
 19699      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 376
* EL156.cbl
 19701 7970-READ-CERT.
 19702
 19703* EXEC CICS READ
 19704*        DATASET  ('ELCERT')
 19705*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19706*        RIDFLD   (ELCERT-KEY)
 19707*    END-EXEC.
 19708     MOVE 'ELCERT' TO DFHEIV1
 19709*    MOVE '&"S        E          (   #00017586' TO DFHEIV0
 19710     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19711     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19712     MOVE X'2020233030303137353836' TO DFHEIV0(25:11)
 19713     CALL 'kxdfhei1' USING DFHEIV0,
 19714           DFHEIV1,
 19715           DFHEIV20,
 19716           DFHEIV99,
 19717           ELCERT-KEY,
 19718           DFHEIV99,
 19719           DFHEIV99,
 19720           DFHEIV99
 19721     SET ADDRESS OF CERTIFICATE-MASTER TO
 19722         DFHEIV20
 19723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19724
 19725
 19726 7970-EXIT.
 19727      EXIT.
 19728 7975-read-acct.
 19729
 19730     move spaces              to WS-ACCT-RECORD-SW
 19731                                 pi-dcc-product-code
 19732
 19733     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19734     MOVE PI-CARRIER          TO ACCT-CARRIER
 19735     MOVE PI-GROUPING         TO ACCT-GROUPING
 19736     MOVE PI-STATE            TO ACCT-STATE
 19737     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19738     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19739     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19740     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19741
 19742
 19743* EXEC CICS READ
 19744*       DATASET ('ERACCT')
 19745*       RIDFLD  (ERACCT-KEY)
 19746*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19747*       GTEQ
 19748*       resp    (WS-RESPONSE)
 19749*    END-EXEC
 19750     MOVE 'ERACCT' TO DFHEIV1
 19751*    MOVE '&"S        G          (  N#00017608' TO DFHEIV0
 19752     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19753     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19754     MOVE X'204E233030303137363038' TO DFHEIV0(25:11)
 19755     CALL 'kxdfhei1' USING DFHEIV0,
 19756           DFHEIV1,
 19757           DFHEIV20,
 19758           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 377
* EL156.cbl
 19759           ERACCT-KEY,
 19760           DFHEIV99,
 19761           DFHEIV99,
 19762           DFHEIV99
 19763     SET ADDRESS OF ACCOUNT-MASTER TO
 19764         DFHEIV20
 19765     MOVE EIBRESP  TO WS-RESPONSE
 19766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19767     IF WS-RESP-NORMAL
 19768        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19769        and pi-cert-eff-dt < am-expiration-dt
 19770        and pi-cert-eff-dt >= am-effective-dt
 19771        move am-dcc-product-code to pi-dcc-product-code
 19772        set acct-found to true
 19773     end-if
 19774
 19775     .
 19776 7975-exit.
 19777     exit.
 19778 7980-READ-CERT-UPDATE.
 19779
 19780* EXEC CICS READ
 19781*        DATASET  ('ELCERT')
 19782*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19783*        RIDFLD   (ELCERT-KEY)
 19784*        UPDATE
 19785*    END-EXEC.
 19786     MOVE 'ELCERT' TO DFHEIV1
 19787*    MOVE '&"S        EU         (   #00017627' TO DFHEIV0
 19788     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19789     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19790     MOVE X'2020233030303137363237' TO DFHEIV0(25:11)
 19791     CALL 'kxdfhei1' USING DFHEIV0,
 19792           DFHEIV1,
 19793           DFHEIV20,
 19794           DFHEIV99,
 19795           ELCERT-KEY,
 19796           DFHEIV99,
 19797           DFHEIV99,
 19798           DFHEIV99
 19799     SET ADDRESS OF CERTIFICATE-MASTER TO
 19800         DFHEIV20
 19801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19802
 19803
 19804 7980-EXIT.
 19805      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 378
* EL156.cbl
 19807 8000-LOAD-ERROR-MESSAGES.
 19808     IF PI-PASS-SW = 'C'
 19809        MOVE EMI-LINE1           TO ERMSG1BO
 19810     ELSE
 19811        MOVE EMI-LINE1           TO ERRMSG1O
 19812        MOVE EMI-LINE2           TO ERRMSG2O.
 19813
 19814 8000-EXIT.
 19815     EXIT.
 19816
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 379
* EL156.cbl
 19818
 19819 8010-DMD-ERROR-CHECKS.
 19820     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19821
 19822     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19823         GO TO 8051-ISSUE-ERROR.
 19824
 19825     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19826     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19827     MOVE '3'                    TO DC-OPTION-CODE.
 19828     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19829     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19830         GO TO 8051-ISSUE-ERROR.
 19831
 19832     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19833       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19834                           OR
 19835          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19836           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19837             MOVE ER-0851         TO EMI-ERROR
 19838             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19839       END-IF
 19840       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19841             MOVE ER-8147         TO EMI-ERROR
 19842             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19843
 19844     GO TO 8090-EXIT.
 19845
 19846 8051-ISSUE-ERROR.
 19847     MOVE ER-8146            TO EMI-ERROR.
 19848     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19849     GO TO 8090-EXIT.
 19850
 19851 8090-EXIT.
 19852      EXIT.
 19853
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 380
* EL156.cbl
 19855 8100-SEND-INITIAL-MAP.
 19856
 19857     MOVE SAVE-DATE              TO RUNDTEAO.
 19858     MOVE EIBTIME                TO TIME-IN.
 19859     MOVE TIME-OUT               TO RUNTIMAO.
 19860     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19861
 19862     IF MAP-NAME = 'EL156A'
 19863        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 19864           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19865        END-IF
 19866        IF PI-COMPANY-ID = 'DCC' or 'CAP'
 19867           MOVE 'N'     TO SURVYYNO
 19868        END-IF
 19869     END-IF
 19870*    IF MAP-NAME = 'EL156A'
 19871*       IF PI-COMPANY-ID = 'CRI'
 19872*          NEXT SENTENCE
 19873*       ELSE
 19874*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19875
 19876     IF MAP-NAME = 'EL156A'
 19877        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19878           NEXT SENTENCE
 19879        ELSE
 19880           MOVE AL-SADOF TO  PINTA    PINTHA.
 19881
 19882     IF MAP-NAME = 'EL156A'
 19883        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19884            NEXT SENTENCE
 19885        ELSE
 19886           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19887
 19888*    IF MAP-NAME = 'EL156A'
 19889*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19890*          NEXT SENTENCE
 19891*       ELSE
 19892*          MOVE AL-SADOF TO CASHHA CASHA.
 19893
 19894     IF MAP-NAME = 'EL156A'
 19895        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19896                        or 'CAP'
 19897           NEXT SENTENCE
 19898        ELSE
 19899           MOVE AL-SADOF        TO  LOANHA
 19900                                    LOANNOA.
 19901
 19902     IF MAP-NAME = 'EL156A'
 19903        MOVE -1                 TO  ENTERPFL
 19904        IF PI-USES-PAID-TO
 19905           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19906           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19907           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19908        ELSE
 19909           NEXT SENTENCE
 19910     ELSE
 19911        IF MAP-NAME = 'EL156B'
 19912           IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 381
* EL156.cbl
 19913              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19914              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19915
 19916
 19917* EXEC CICS SEND
 19918*        MAP   (MAP-NAME)
 19919*        MAPSET(MAPSET-NAME)
 19920*        FROM  (EL156AI)
 19921*        ERASE
 19922*        CURSOR
 19923*    END-EXEC.
 19924     MOVE LENGTH OF
 19925      EL156AI
 19926       TO DFHEIV12
 19927     MOVE -1
 19928       TO DFHEIV11
 19929*    MOVE '8$     CT  E    H L F ,   #00017746' TO DFHEIV0
 19930     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19931     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19932     MOVE X'2020233030303137373436' TO DFHEIV0(25:11)
 19933     CALL 'kxdfhei1' USING DFHEIV0,
 19934           MAP-NAME,
 19935           EL156AI,
 19936           DFHEIV12,
 19937           MAPSET-NAME,
 19938           DFHEIV99,
 19939           DFHEIV99,
 19940           DFHEIV99,
 19941           DFHEIV11,
 19942           DFHEIV99,
 19943           DFHEIV99,
 19944           DFHEIV99
 19945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19946
 19947
 19948     GO TO 9100-RETURN-TRAN.
 19949
 19950 8200-SEND-DATAONLY.
 19951
 19952     IF FIRST-ENTRY = 'Y'
 19953         GO TO 8100-SEND-INITIAL-MAP.
 19954
 19955     IF RETURNED-FROM-B = 'Y'
 19956         GO TO 8100-SEND-INITIAL-MAP.
 19957
 19958     MOVE SAVE-DATE              TO RUNDTEAO.
 19959     MOVE EIBTIME                TO TIME-IN.
 19960     MOVE TIME-OUT               TO RUNTIMAO.
 19961
 19962     IF EIBAID = DFHPF11
 19963        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19964        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19965        MOVE 'EL001   '          TO RETURNED-FROM
 19966        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19967        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19968        GO TO 8100-SEND-INITIAL-MAP.
 19969
 19970     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 382
* EL156.cbl
 19971
 19972     IF MAP-NAME =  'EL156A'
 19973        MOVE -1                 TO  ENTERPFL
 19974        IF PI-USES-PAID-TO
 19975           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19976           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19977           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19978        ELSE
 19979           NEXT SENTENCE
 19980     ELSE
 19981        IF MAP-NAME = 'EL156B'
 19982           IF PI-USES-PAID-TO
 19983              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19984              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19985
 19986     IF MAP-NAME =  'EL156A'
 19987        IF PI-COMPANY-ID = 'BOA'
 19988            IF PI-INT-RATE NUMERIC
 19989                MOVE PI-INT-RATE TO PINTO.
 19990     IF MAP-NAME = 'EL156A'
 19991        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'CAP'
 19992           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19993*          MOVE 'Y'              TO EOBYNO
 19994        END-IF
 19995     END-IF
 19996
 19997
 19998* EXEC CICS SEND
 19999*        MAP   (MAP-NAME)
 20000*        MAPSET(MAPSET-NAME)
 20001*        FROM  (EL156AI)
 20002*        DATAONLY
 20003*        CURSOR
 20004*    END-EXEC.
 20005     MOVE LENGTH OF
 20006      EL156AI
 20007       TO DFHEIV12
 20008     MOVE -1
 20009       TO DFHEIV11
 20010*    MOVE '8$D    CT       H L F ,   #00017803' TO DFHEIV0
 20011     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 20012     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 20013     MOVE X'2020233030303137383033' TO DFHEIV0(25:11)
 20014     CALL 'kxdfhei1' USING DFHEIV0,
 20015           MAP-NAME,
 20016           EL156AI,
 20017           DFHEIV12,
 20018           MAPSET-NAME,
 20019           DFHEIV99,
 20020           DFHEIV99,
 20021           DFHEIV99,
 20022           DFHEIV11,
 20023           DFHEIV99,
 20024           DFHEIV99,
 20025           DFHEIV99
 20026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20027
 20028
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 383
* EL156.cbl
 20029     GO TO 9100-RETURN-TRAN.
 20030
 20031 8300-SEND-TEXT.
 20032
 20033* EXEC CICS SEND TEXT
 20034*        FROM(LOGOFF-TEXT)
 20035*        LENGTH(LOGOFF-LENGTH)
 20036*        ERASE
 20037*        FREEKB
 20038*    END-EXEC.
 20039*    MOVE '8&      T  E F  H   F -   #00017814' TO DFHEIV0
 20040     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 20041     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 20042     MOVE X'2020233030303137383134' TO DFHEIV0(25:11)
 20043     CALL 'kxdfhei1' USING DFHEIV0,
 20044           LOGOFF-TEXT,
 20045           LOGOFF-LENGTH,
 20046           DFHEIV99,
 20047           DFHEIV99,
 20048           DFHEIV99,
 20049           DFHEIV99,
 20050           DFHEIV99,
 20051           DFHEIV99,
 20052           DFHEIV99,
 20053           DFHEIV99,
 20054           DFHEIV99,
 20055           DFHEIV99
 20056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20057
 20058
 20059
 20060* EXEC CICS RETURN
 20061*    END-EXEC.
 20062*    MOVE '.(                    ''   #00017821' TO DFHEIV0
 20063     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20064     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20065     MOVE X'2020233030303137383231' TO DFHEIV0(25:11)
 20066     CALL 'kxdfhei1' USING DFHEIV0,
 20067           DFHEIV99,
 20068           DFHEIV99,
 20069           DFHEIV99,
 20070           DFHEIV99,
 20071           DFHEIV99,
 20072           DFHEIV99
 20073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20074
 20075
 20076 8500-FILE-NOTOPEN.
 20077     IF FILE-SWITCH = 'MSTR'
 20078         MOVE ER-0154            TO EMI-ERROR.
 20079     IF FILE-SWITCH = 'TRLR'
 20080         MOVE ER-0172            TO EMI-ERROR.
 20081     IF FILE-SWITCH = 'CERT'
 20082         MOVE ER-0169            TO EMI-ERROR.
 20083     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 20084                      'PROC' OR 'STAT'
 20085         MOVE ER-0042            TO EMI-ERROR.
 20086     IF FILE-SWITCH = 'ACTQ'
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 384
* EL156.cbl
 20087         MOVE ER-0338            TO EMI-ERROR.
 20088     IF FILE-SWITCH = 'ACCT'
 20089         MOVE ER-0168            TO EMI-ERROR.
 20090
 20091     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20092     MOVE -1                     TO PMTTYPEL.
 20093
 20094     IF FIRST-ENTRY = 'Y'
 20095         GO TO 8100-SEND-INITIAL-MAP.
 20096
 20097     GO TO 8200-SEND-DATAONLY.
 20098
 20099 8600-PGRM-NOT-FOUND.
 20100
 20101     MOVE ER-0923                TO EMI-ERROR.
 20102     MOVE -1                     TO ENTPFBL.
 20103     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20104
 20105     IF FIRST-ENTRY = 'Y'
 20106         GO TO 8100-SEND-INITIAL-MAP
 20107     ELSE
 20108         GO TO 8200-SEND-DATAONLY.
 20109
 20110 8800-UNAUTHORIZED-ACCESS.
 20111     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 20112     GO TO 8300-SEND-TEXT.
 20113
 20114 8810-PF23.
 20115     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 20116     MOVE XCTL-005               TO PGM-NAME.
 20117     GO TO 9300-XCTL.
 20118
 20119 8820-PF7-8.
 20120     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 20121     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 20122                                    PI-SAVED-PROGRAM-2
 20123                                    PI-SAVED-PROGRAM-3
 20124                                    PI-SAVED-PROGRAM-4
 20125                                    PI-SAVED-PROGRAM-5
 20126                                    PI-SAVED-PROGRAM-6
 20127                                    PI-RETURN-TO-PROGRAM.
 20128     IF EIBAID = DFHPF8
 20129        MOVE XCTL-132            TO PGM-NAME
 20130     ELSE
 20131        MOVE XCTL-130            TO PGM-NAME.
 20132
 20133     GO TO 9300-XCTL.
 20134
 20135 9100-RETURN-TRAN.
 20136     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 20137     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 20138
 20139
 20140* EXEC CICS RETURN
 20141*        TRANSID(TRANS-ID)
 20142*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20143*        LENGTH(PI-COMM-LENGTH)
 20144*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 385
* EL156.cbl
 20145*    MOVE '.(CT                  ''   #00017887' TO DFHEIV0
 20146     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 20147     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20148     MOVE X'2020233030303137383837' TO DFHEIV0(25:11)
 20149     CALL 'kxdfhei1' USING DFHEIV0,
 20150           TRANS-ID,
 20151           PROGRAM-INTERFACE-BLOCK,
 20152           PI-COMM-LENGTH,
 20153           DFHEIV99,
 20154           DFHEIV99,
 20155           DFHEIV99
 20156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20157
 20158
 20159 9200-RETURN-MAIN-MENU.
 20160     MOVE XCTL-126               TO PGM-NAME.
 20161     GO TO 9300-XCTL.
 20162
 20163 9300-XCTL.
 20164
 20165* EXEC CICS XCTL
 20166*        PROGRAM(PGM-NAME)
 20167*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20168*        LENGTH(PI-COMM-LENGTH)
 20169*    END-EXEC.
 20170*    MOVE '.$C                   %   #00017898' TO DFHEIV0
 20171     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 20172     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20173     MOVE X'2020233030303137383938' TO DFHEIV0(25:11)
 20174     CALL 'kxdfhei1' USING DFHEIV0,
 20175           PGM-NAME,
 20176           PROGRAM-INTERFACE-BLOCK,
 20177           PI-COMM-LENGTH,
 20178           DFHEIV99
 20179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20180
 20181
 20182 9400-CLEAR.
 20183     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 20184     GO TO 9300-XCTL.
 20185
 20186 9500-PF12.
 20187     MOVE XCTL-010               TO PGM-NAME.
 20188     GO TO 9300-XCTL.
 20189
 20190 9700-LINK-DATE-CONVERT.
 20191     MOVE LINK-ELDATCV           TO PGM-NAME.
 20192
 20193* EXEC CICS LINK
 20194*        PROGRAM   (PGM-NAME)
 20195*        COMMAREA  (DATE-CONVERSION-DATA)
 20196*        LENGTH    (DC-COMM-LENGTH)
 20197*    END-EXEC.
 20198*    MOVE '."C                   (   #00017914' TO DFHEIV0
 20199     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20200     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20201     MOVE X'2020233030303137393134' TO DFHEIV0(25:11)
 20202     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 386
* EL156.cbl
 20203           PGM-NAME,
 20204           DATE-CONVERSION-DATA,
 20205           DC-COMM-LENGTH,
 20206           DFHEIV99,
 20207           DFHEIV99,
 20208           DFHEIV99,
 20209           DFHEIV99
 20210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20211
 20212
 20213 9700-EXIT.
 20214     EXIT.
 20215
 20216 9800-LINK-REM-TERM.
 20217     MOVE LINK-REMTERM TO PGM-NAME.
 20218
 20219
 20220* EXEC CICS LINK
 20221*        PROGRAM   (PGM-NAME)
 20222*        COMMAREA  (CALCULATION-PASS-AREA)
 20223*        LENGTH    (CP-COMM-LENGTH)
 20224*    END-EXEC.
 20225*    MOVE '."C                   (   #00017926' TO DFHEIV0
 20226     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20227     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20228     MOVE X'2020233030303137393236' TO DFHEIV0(25:11)
 20229     CALL 'kxdfhei1' USING DFHEIV0,
 20230           PGM-NAME,
 20231           CALCULATION-PASS-AREA,
 20232           CP-COMM-LENGTH,
 20233           DFHEIV99,
 20234           DFHEIV99,
 20235           DFHEIV99,
 20236           DFHEIV99
 20237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20238
 20239
 20240 9800-EXIT.
 20241     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 387
* EL156.cbl
 20243 9830-DMD-REMAINING-TERM.
 20244
 20245     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 20246         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 20247
 20248     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 20249                              CM-PMT-EXTENSION-DAYS.
 20250
 20251     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 20252                                  CL-NO-OF-DAYS-PAID.
 20253
 20254     DIVIDE W-REM-TERM-IN-DAYS BY +30
 20255         GIVING W-REM REMAINDER W-REM-DAYS.
 20256
 20257     MOVE W-REM                  TO WST-REM.
 20258
 20259     IF W-REM-DAYS > ZEROS
 20260         MOVE '/'                TO WST-SLASH
 20261         MOVE W-REM-DAYS         TO WST-REM-DAYS
 20262     ELSE
 20263         MOVE SPACES             TO WST-REM-DAYS-GRP.
 20264
 20265 9830-EXIT.
 20266     EXIT.
 20267
 20268 9870-OUTPUT-ACTIVITY-RECORD.
 20269
 20270
 20271* EXEC CICS GETMAIN
 20272*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 20273*         LENGTH(25)
 20274*         INITIMG(WS-BLANK)
 20275*    END-EXEC.
 20276     MOVE 25
 20277       TO DFHEIV11
 20278*    MOVE ',"IL                  $   #00017962' TO DFHEIV0
 20279     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20280     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20281     MOVE X'2020233030303137393632' TO DFHEIV0(25:11)
 20282     CALL 'kxdfhei1' USING DFHEIV0,
 20283           DFHEIV20,
 20284           DFHEIV11,
 20285           WS-BLANK
 20286     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 20287         DFHEIV20
 20288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20289
 20290
 20291     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 20292     MOVE ELMSTR-KEY             TO DA-KEY.
 20293     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 20294
 20295     IF PI-PMTTYPE EQUAL '7'
 20296         MOVE 'V'                TO DA-RECORD-TYPE
 20297     ELSE
 20298         MOVE 'P'                TO DA-RECORD-TYPE.
 20299
 20300
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 388
* EL156.cbl
 20301* EXEC CICS HANDLE CONDITION
 20302*         NOTOPEN(9870-NOTOPEN)
 20303*         DUPREC(9870-EXIT)
 20304*    END-EXEC.
 20305*    MOVE '"$J%                  ! B #00017977' TO DFHEIV0
 20306     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 20307     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20308     MOVE X'4220233030303137393737' TO DFHEIV0(25:11)
 20309     CALL 'kxdfhei1' USING DFHEIV0
 20310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20311
 20312
 20313
 20314* EXEC CICS WRITE
 20315*         DATASET('DLYACTV')
 20316*         RIDFLD(DA-KEY)
 20317*         FROM(DAILY-ACTIVITY-RECORD)
 20318*         LENGTH(25)
 20319*    END-EXEC.
 20320     MOVE 'DLYACTV' TO DFHEIV1
 20321     MOVE 25
 20322       TO DFHEIV11
 20323*    MOVE '&$ L                  ''   #00017982' TO DFHEIV0
 20324     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20325     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20326     MOVE X'2020233030303137393832' TO DFHEIV0(25:11)
 20327     CALL 'kxdfhei1' USING DFHEIV0,
 20328           DFHEIV1,
 20329           DAILY-ACTIVITY-RECORD,
 20330           DFHEIV11,
 20331           DA-KEY,
 20332           DFHEIV99,
 20333           DFHEIV99
 20334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20335
 20336     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20337     GO TO 9870-EXIT.
 20338
 20339 9870-NOTOPEN.
 20340
 20341     MOVE '2955'                 TO EMI-ERROR.
 20342     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20343
 20344 9870-EXIT.
 20345     EXIT.
 20346
 20347 9900-ERROR-FORMAT.
 20348
 20349     IF EMI-ERROR = ER-0923
 20350         MOVE PGM-NAME           TO W-CALLED-NAME.
 20351
 20352     MOVE LINK-001      TO PGM-NAME.
 20353     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20354
 20355
 20356* EXEC CICS LINK
 20357*        PROGRAM (PGM-NAME)
 20358*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 389
* EL156.cbl
 20359*        LENGTH  (EMI-COMM-LENGTH)
 20360*    END-EXEC.
 20361*    MOVE '."C                   (   #00018007' TO DFHEIV0
 20362     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20363     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20364     MOVE X'2020233030303138303037' TO DFHEIV0(25:11)
 20365     CALL 'kxdfhei1' USING DFHEIV0,
 20366           PGM-NAME,
 20367           ERROR-MESSAGE-INTERFACE-BLOCK,
 20368           EMI-COMM-LENGTH,
 20369           DFHEIV99,
 20370           DFHEIV99,
 20371           DFHEIV99,
 20372           DFHEIV99
 20373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20374
 20375
 20376     IF EMI-ERROR = ER-0923
 20377         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20378
 20379 9900-EXIT.
 20380     EXIT.
 20381
 20382 9990-ABEND.
 20383     MOVE LINK-004               TO PGM-NAME.
 20384     MOVE DFHEIBLK               TO EMI-LINE1.
 20385
 20386* EXEC CICS LINK
 20387*        PROGRAM   (PGM-NAME)
 20388*        COMMAREA  (EMI-LINE1)
 20389*        LENGTH    (64)
 20390*    END-EXEC.
 20391     MOVE 64
 20392       TO DFHEIV11
 20393*    MOVE '."C                   (   #00018022' TO DFHEIV0
 20394     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20395     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20396     MOVE X'2020233030303138303232' TO DFHEIV0(25:11)
 20397     CALL 'kxdfhei1' USING DFHEIV0,
 20398           PGM-NAME,
 20399           EMI-LINE1,
 20400           DFHEIV11,
 20401           DFHEIV99,
 20402           DFHEIV99,
 20403           DFHEIV99,
 20404           DFHEIV99
 20405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20406
 20407
 20408     MOVE 'EL156A'               TO  MAP-NAME.
 20409     MOVE LOW-VALUES             TO  EL156AO.
 20410     GO TO 8100-SEND-INITIAL-MAP.
 20411
 20412 9995-SECURITY-VIOLATION.
 20413*    COPY ELCSCTP.
 20414******************************************************************
 20415*                                                                *
 20416*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 390
* EL156.cbl
 20417*                            VMOD=2.001                          *
 20418*                                                                *
 20419*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20420******************************************************************
 20421
 20422
 20423     MOVE EIBDATE          TO SM-JUL-DATE.
 20424     MOVE EIBTRMID         TO SM-TERMID.
 20425     MOVE THIS-PGM         TO SM-PGM.
 20426     MOVE EIBTIME          TO TIME-IN.
 20427     MOVE TIME-OUT         TO SM-TIME.
 20428     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20429
 20430
 20431* EXEC CICS LINK
 20432*         PROGRAM  ('EL003')
 20433*         COMMAREA (SECURITY-MESSAGE)
 20434*         LENGTH   (80)
 20435*    END-EXEC.
 20436     MOVE 'EL003' TO DFHEIV1
 20437     MOVE 80
 20438       TO DFHEIV11
 20439*    MOVE '."C                   (   #00018050' TO DFHEIV0
 20440     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20441     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20442     MOVE X'2020233030303138303530' TO DFHEIV0(25:11)
 20443     CALL 'kxdfhei1' USING DFHEIV0,
 20444           DFHEIV1,
 20445           SECURITY-MESSAGE,
 20446           DFHEIV11,
 20447           DFHEIV99,
 20448           DFHEIV99,
 20449           DFHEIV99,
 20450           DFHEIV99
 20451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20452
 20453
 20454******************************************************************
 20455
 20456
 20457
 20458 9999-DFHBACK SECTION.
 20459     MOVE '9%                    "   ' TO DFHEIV0
 20460     MOVE 'EL156' TO DFHEIV1
 20461     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20462     GOBACK.
 20463 9999-DFHEXIT.
 20464     IF DFHEIGDJ EQUAL 0001
 20465         NEXT SENTENCE
 20466     ELSE IF DFHEIGDJ EQUAL 2
 20467         GO TO 9990-ABEND,
 20468               8600-PGRM-NOT-FOUND,
 20469               0400-FIRST-TIME,
 20470               6180-DUPREC,
 20471               9990-ABEND
 20472         DEPENDING ON DFHEIGDI
 20473     ELSE IF DFHEIGDJ EQUAL 3
 20474         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 391
* EL156.cbl
 20475               0380-CLAIM-END-FILE
 20476         DEPENDING ON DFHEIGDI
 20477     ELSE IF DFHEIGDJ EQUAL 4
 20478         GO TO 0380-CLAIM-END-FILE,
 20479               0380-CLAIM-END-FILE
 20480         DEPENDING ON DFHEIGDI
 20481     ELSE IF DFHEIGDJ EQUAL 5
 20482         GO TO 0800-EXIT
 20483         DEPENDING ON DFHEIGDI
 20484     ELSE IF DFHEIGDJ EQUAL 6
 20485         GO TO 1950-NOT-FOUND,
 20486               1950-NOT-FOUND
 20487         DEPENDING ON DFHEIGDI
 20488     ELSE IF DFHEIGDJ EQUAL 7
 20489         GO TO 1950-NOT-FOUND
 20490         DEPENDING ON DFHEIGDI
 20491     ELSE IF DFHEIGDJ EQUAL 8
 20492         GO TO 1950-NOT-FOUND,
 20493               1950-NOT-FOUND
 20494         DEPENDING ON DFHEIGDI
 20495     ELSE IF DFHEIGDJ EQUAL 9
 20496         GO TO 1166-END-CHECK,
 20497               1166-END-CHECK
 20498         DEPENDING ON DFHEIGDI
 20499     ELSE IF DFHEIGDJ EQUAL 10
 20500         GO TO 1950-NOT-FOUND,
 20501               1950-NOT-FOUND
 20502         DEPENDING ON DFHEIGDI
 20503     ELSE IF DFHEIGDJ EQUAL 11
 20504         GO TO 1950-NOT-FOUND,
 20505               1950-NOT-FOUND
 20506         DEPENDING ON DFHEIGDI
 20507     ELSE IF DFHEIGDJ EQUAL 12
 20508         GO TO 1950-NOT-FOUND
 20509         DEPENDING ON DFHEIGDI
 20510     ELSE IF DFHEIGDJ EQUAL 13
 20511         GO TO 3600-CONTINUE
 20512         DEPENDING ON DFHEIGDI
 20513     ELSE IF DFHEIGDJ EQUAL 14
 20514         GO TO 5300-NOTE-NOT-FOUND
 20515         DEPENDING ON DFHEIGDI
 20516     ELSE IF DFHEIGDJ EQUAL 15
 20517         GO TO 6065-NOT-FOUND
 20518         DEPENDING ON DFHEIGDI
 20519     ELSE IF DFHEIGDJ EQUAL 16
 20520         GO TO 6068-ACCT-NOT-FND
 20521         DEPENDING ON DFHEIGDI
 20522     ELSE IF DFHEIGDJ EQUAL 17
 20523         GO TO 6074-GET-COMP-DATA
 20524         DEPENDING ON DFHEIGDI
 20525     ELSE IF DFHEIGDJ EQUAL 18
 20526         GO TO 6170-WRITE
 20527         DEPENDING ON DFHEIGDI
 20528     ELSE IF DFHEIGDJ EQUAL 19
 20529         GO TO 6180-DUPREC
 20530         DEPENDING ON DFHEIGDI
 20531     ELSE IF DFHEIGDJ EQUAL 20
 20532         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 26-Oct-17 09:30 Page 392
* EL156.cbl
 20533         DEPENDING ON DFHEIGDI
 20534     ELSE IF DFHEIGDJ EQUAL 21
 20535         GO TO 6185-DUPREC
 20536         DEPENDING ON DFHEIGDI
 20537     ELSE IF DFHEIGDJ EQUAL 22
 20538         GO TO 6720-BUILD-NEW-RECORD
 20539         DEPENDING ON DFHEIGDI
 20540     ELSE IF DFHEIGDJ EQUAL 23
 20541         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20542               6900-BUILD-ARCHIVE-HEADER
 20543         DEPENDING ON DFHEIGDI
 20544     ELSE IF DFHEIGDJ EQUAL 24
 20545         GO TO 7010-BUILD-MAP
 20546         DEPENDING ON DFHEIGDI
 20547     ELSE IF DFHEIGDJ EQUAL 25
 20548         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20549         DEPENDING ON DFHEIGDI
 20550     ELSE IF DFHEIGDJ EQUAL 26
 20551         GO TO 7160-DUPREC
 20552         DEPENDING ON DFHEIGDI
 20553     ELSE IF DFHEIGDJ EQUAL 27
 20554         GO TO 7200-EXIT,
 20555               7200-EXIT
 20556         DEPENDING ON DFHEIGDI
 20557     ELSE IF DFHEIGDJ EQUAL 28
 20558         GO TO 7400-NOT-FOUND
 20559         DEPENDING ON DFHEIGDI
 20560     ELSE IF DFHEIGDJ EQUAL 29
 20561         GO TO 7590-END,
 20562               7590-END
 20563         DEPENDING ON DFHEIGDI
 20564     ELSE IF DFHEIGDJ EQUAL 30
 20565         GO TO 7699-EXIT
 20566         DEPENDING ON DFHEIGDI
 20567     ELSE IF DFHEIGDJ EQUAL 31
 20568         GO TO 5300-NOTE-NOT-FOUND
 20569         DEPENDING ON DFHEIGDI
 20570     ELSE IF DFHEIGDJ EQUAL 32
 20571         GO TO 7800-COMP-NOTFND
 20572         DEPENDING ON DFHEIGDI
 20573     ELSE IF DFHEIGDJ EQUAL 33
 20574         GO TO 7920-NOT-FOUND
 20575         DEPENDING ON DFHEIGDI
 20576     ELSE IF DFHEIGDJ EQUAL 34
 20577         GO TO 9870-NOTOPEN,
 20578               9870-EXIT
 20579         DEPENDING ON DFHEIGDI.
 20580     MOVE '9%                    "   ' TO DFHEIV0
 20581     MOVE 'EL156' TO DFHEIV1
 20582     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20583     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12764     Code:       76567
