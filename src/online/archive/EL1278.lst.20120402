* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page   1
* EL1278.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL1278.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1278.lst" LISTPATH
*          "" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1278.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/21/94 14:09:26.
     7*                            VMOD=2.030.
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page   2
* EL1278.cbl
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXXA - CANCELLATION QUOTE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101201    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37* 070105    2005063000003  PEMA  COMMENT OUT CODE THAT ADDS 1
    38*         TO THE TERM AND REMAINING TERM
    39* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    40* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    41* 111907  CR2004020600011  PEMA  FORCE FP TO REFUND AS FP
    42* 022608  CR2008010200006  PEMA  CHANGE MO RTERM MTHOD
    43* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
    44* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
    45* 021710  IR2010021000002  PEMA  ADD CANCEL DATE EDIT
    46* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
    47* 042011  CR2010030900001  PEMA ADD CLM PROCESSING ON QUOTES
    48* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    49******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page   3
* EL1278.cbl
    51 ENVIRONMENT DIVISION.
    52 DATA DIVISION.
    53 WORKING-STORAGE SECTION.
    54 01  DFH-START PIC X(04).
    55 77  FILLER  PIC  X(32) VALUE '********************************'.
    56 77  FILLER  PIC  X(32) VALUE '*    EL1278 WORKING STORAGE    *'.
    57 77  FILLER  PIC  X(32) VALUE '*********** VMOD=2.030 *********'.
    58 77  S1                          PIC S999 COMP-3 VALUE +0.
    59 77  P1                          PIC S999 COMP-3 VALUE +0.
    60 77  P2                          PIC S999 COMP-3 VALUE +0.
    61 77  C0                          PIC S999 COMP-3 VALUE +0.
    62 77  C1                          PIC S999 COMP-3 VALUE +0.
    63 77  C2                          PIC S999 COMP-3 VALUE +0.
    64 77  C3                          PIC S999 COMP-3 VALUE +0.
    65 77  WS-STOP-SW                  PIC X  VALUE ' '.
    66     88  I-SAY-TO-STOP      VALUE 'Y'.
    67 77  WS-OPEN-LF-CLAIM            PIC X  VALUE ' '.
    68     88  OPEN-LF-CLAIM              VALUE 'Y'.
    69 77  WS-CLOSED-LF-CLAIM          PIC X  VALUE ' '.
    70     88  CLOSED-LF-CLAIM            VALUE 'Y'.
    71 77  WS-OPEN-AH-CLAIM            PIC X  VALUE ' '.
    72     88  OPEN-AH-CLAIM              VALUE 'Y'.
    73 77  WS-CLOSED-AH-CLAIM          PIC X  VALUE ' '.
    74     88  CLOSED-AH-CLAIM            VALUE 'Y'.
    75 77  WS-FOUND-A-CLAIM            PIC X  VALUE ' '.
    76     88  FOUND-A-CLAIM              VALUE 'Y'.
    77 77  WS-ST-REF-IND               PIC X.
    78 77  WS-LF-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    79 77  WS-AH-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    80 77  WS-AH-PAID-THRU-DT          PIC XX  VALUE LOW-VALUES.
    81 77  WS-LF-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    82 77  WS-AH-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    83 77  DD-IU-SW                    PIC X   VALUE ' '.
    84     88  DD-IU-PRESENT                 VALUE 'Y'.
    85 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    86 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    87 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    88 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    89 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    90 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    91 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    92 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    93
    94*                            COPY ELCSCTM.
    95******************************************************************
    96*                                                                *
    97*                                                                *
    98*                            ELCSCTM                             *
    99*                            VMOD=2.001                          *
   100*                                                                *
   101*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   102*                                                                *
   103******************************************************************
   104 01  SECURITY-MESSAGE.
   105     12  FILLER                          PIC X(30)
   106            VALUE '** LOGIC SECURITY VIOLATION -'.
   107     12  SM-READ                         PIC X(6).
   108     12  FILLER                          PIC X(5)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page   4
* EL1278.cbl
   109            VALUE ' PGM='.
   110     12  SM-PGM                          PIC X(6).
   111     12  FILLER                          PIC X(5)
   112            VALUE ' OPR='.
   113     12  SM-PROCESSOR-ID                 PIC X(4).
   114     12  FILLER                          PIC X(6)
   115            VALUE ' TERM='.
   116     12  SM-TERMID                       PIC X(4).
   117     12  FILLER                          PIC XX   VALUE SPACE.
   118     12  SM-JUL-DATE                     PIC 9(5).
   119     12  FILLER                          PIC X    VALUE SPACE.
   120     12  SM-TIME                         PIC 99.99.
   121
   122
   123*                            COPY ELCSCRTY.
   124******************************************************************
   125*                                                                *
   126*                                                                *
   127*                            ELCSCRTY                            *
   128*                            VMOD=2.001                          *
   129*                                                                *
   130*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   131*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   132*        SAVED IN PI-SECURITY-ADDRESS.                           *
   133*                                                                *
   134******************************************************************
   135 01  SECURITY-CONTROL.
   136     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   137     12  FILLER                       PIC XX    VALUE 'SC'.
   138     12  SC-CREDIT-CODES.
   139         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   140             20  SC-CREDIT-DISPLAY    PIC X.
   141             20  SC-CREDIT-UPDATE     PIC X.
   142     12  SC-CLAIMS-CODES.
   143         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   144             20  SC-CLAIMS-DISPLAY    PIC X.
   145             20  SC-CLAIMS-UPDATE     PIC X.
   146
   147 01  FILLER          COMP-3.
   148     12  WS-BALLOON-RTRM         PIC S9(03)      VALUE ZERO.
   149     12  WS-ELAPSED-MONTHS       PIC S9(03)      VALUE ZERO.
   150     12  WS-TOT-AH-PREM          PIC S9(9)V99    VALUE ZERO.
   151     12  WS-TOT-LF-PREM          PIC S9(9)V99    VALUE ZERO.
   152     12  WS-TOT-AH-RFND          PIC S9(9)V99    VALUE ZERO.
   153     12  WS-TOT-LF-RFND          PIC S9(9)V99    VALUE ZERO.
   154     12  WS-TOT-PREM             PIC S9(9)V99    VALUE ZERO.
   155     12  WS-TOT-RFND             PIC S9(9)V99    VALUE ZERO.
   156     12  WS-TOT-ITDR             PIC S9(9)V99    VALUE ZERO.
   157
   158 01  WS-DATE-AREA.
   159     12  SAVE-DATE               PIC  X(08)      VALUE SPACES.
   160     12  SAVE-BIN-DATE           PIC  X(02)      VALUE SPACES.
   161     12  WS-LF-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   162     12  WS-AH-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   163     12  WS-LF-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   164     12  WS-AH-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   165
   166 01  ERPDEF-KEY-SAVE             PIC X(18).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page   5
* EL1278.cbl
   167 01  ERPDEF-KEY.
   168     12  ERPDEF-COMPANY-CD       PIC X.
   169     12  ERPDEF-STATE            PIC XX.
   170     12  ERPDEF-PROD-CD          PIC XXX.
   171     12  F                       PIC X(7).
   172     12  ERPDEF-BEN-TYPE         PIC X.
   173     12  ERPDEF-BEN-CODE         PIC XX.
   174     12  ERPDEF-EXP-DT           PIC XX.
   175 01  ELMSTR-KEY.
   176     12  ELMSTR-COMP-CD          PIC X.
   177     12  ELMSTR-CERT-NO          PIC X(11).
   178 01  STANDARD-AREAS.
   179     12  SC-ITEM                 PIC S9(04) COMP VALUE +0001.
   180     12  SUB3                    PIC S9(04) COMP VALUE +0.
   181     12  SUB4                    PIC S9(04) COMP VALUE +0.
   182     12  GETMAIN-SPACE           PIC  X(01)      VALUE SPACE.
   183     12  MAP-NAME                PIC  X(08)      VALUE 'EL127H'.
   184     12  MAPSET-NAME             PIC  X(08)      VALUE 'EL1278S'.
   185     12  SCREEN-NUMBER           PIC  X(04)      VALUE '127H'.
   186     12  TRANS-ID                PIC  X(04)      VALUE 'EXXA'.
   187     12  THIS-PGM                PIC  X(08)      VALUE 'EL1278'.
   188     12  PGM-NAME                PIC  X(08).
   189     12  TIME-IN                 PIC S9(07).
   190     12  TIME-OUT-R  REDEFINES  TIME-IN.
   191         16  FILLER              PIC  X(01).
   192         16  TIME-OUT            PIC  9(02)V99.
   193         16  FILLER              PIC  X(02).
   194     12  XCTL-005                PIC  X(08)      VALUE 'EL005'.
   195     12  XCTL-010                PIC  X(08)      VALUE 'EL010'.
   196     12  XCTL-126                PIC  X(08)      VALUE 'EL126'.
   197     12  LINK-001                PIC  X(08)      VALUE 'EL001'.
   198     12  LINK-004                PIC  X(08)      VALUE 'EL004'.
   199     12  LINK-ELDATCV            PIC  X(08)      VALUE 'ELDATCV'.
   200     12  ELRTRM-ID               PIC  X(08)      VALUE 'ELRTRM'.
   201     12  ELRAMT-ID               PIC  X(08)      VALUE 'ELRAMT'.
   202     12  ELRFND-ID               PIC  X(08)      VALUE 'ELRFND'.
   203     12  ELCNTL-ID               PIC  X(08)      VALUE 'ELCNTL'.
   204     12  ERACCT-ID               PIC  X(08)      VALUE 'ERACCT'.
   205     12  ELCERT-ID               PIC  X(08)      VALUE 'ELCERT'.
   206     12  ERMAIL-ID               PIC  X(08)      VALUE 'ERMAIL'.
   207     12  ERFORM-ID               PIC  X(08)      VALUE 'ERFORM'.
   208     12  ERNOTE-ID               PIC  X(08)      VALUE 'ERNOTE'.
   209     12  DATE-RANGE-SW           PIC  X(01)      VALUE SPACE.
   210     12  WS-REFUND-SEARCH-SW     PIC  X(01)      VALUE ' '.
   211         88  LIFE-REFUND-SEARCH                  VALUE 'L'.
   212     12  WS-BROWSE-STARTED-SW    PIC  X(01)      VALUE SPACE.
   213         88  BROWSE-STARTED                      VALUE 'Y'.
   214     12  WS-FORM-RECORD-SW       PIC  X(01)      VALUE SPACE.
   215         88  FORM-FOUND                          VALUE 'Y'.
   216     12  BEN-SEARCH-SW           PIC  X(01)      VALUE SPACE.
   217         88  NO-BENEFIT-FOUND                    VALUE 'N'.
   218     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   219         88  WS-REDUCING                         VALUE 'R'.
   220         88  WS-LEVEL                            VALUE 'L'  'P'.
   221     12  WS-NEW-LF-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   222         88  WS-NEW-LF-CANCEL                    VALUE 'Y'.
   223     12  WS-NEW-AH-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   224         88  WS-NEW-AH-CANCEL                    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page   6
* EL1278.cbl
   225     12  WS-BENEFIT-DESCRIP      PIC  X(10)      VALUE SPACES.
   226     12  WS-PMT-DESCRIP          PIC  X(10)      VALUE
   227         'CLAIM PMTS'.
   228     12  WS-REFUND-DESCRIP       PIC  X(10)      VALUE
   229         'ITD REFUND'.
   230     12  WS-ACCESS.
   231         16  FILLER              PIC  X(02).
   232         16  WS-BEN-CD           PIC  X(02).
   233     12  WS-KIND                 PIC  X(03)      VALUE SPACES.
   234     12  WS-LOOKUP-TYPE          PIC  X(01).
   235     12  WS-BENEFIT-NO           PIC  X(02)      VALUE ZERO.
   236     12  WS-STATE-ABBREVIATION   PIC  X(02)      VALUE SPACES.
   237     12  WS-CALC-CD              PIC  X(01).
   238     12  DEEDIT-FIELD            PIC  X(15).
   239     12  DEEDIT-FIELD-V0  REDEFINES
   240         DEEDIT-FIELD            PIC S9(15).
   241     12  WS-CURRENT-DATE         PIC  X(02)  VALUE LOW-VALUES.
   242     12  RETURN-FROM             PIC  X(08).
   243     12  QID.
   244         16  QID-TERM            PIC  X(04).
   245         16  FILLER              PIC  X(04)      VALUE '127H'.
   246     12  WS-FIRST-ENTRY-SW       PIC  X(01)      VALUE SPACE.
   247         88  FIRST-ENTRY                         VALUE 'Y'.
   248     12  WS-PDEF-RECORD-SW       PIC X           VALUE ' '.
   249         88  PDEF-FOUND                          VALUE 'Y'.
   250     12  WS-CERT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   251         88  CERT-FOUND                          VALUE 'Y'.
   252         88  CERT-NOT-FOUND                      VALUE 'N'.
   253     12  WS-CNTL-RECORD-SW       PIC  X(01)      VALUE SPACE.
   254         88  CNTL-FOUND                          VALUE 'Y'.
   255         88  CNTL-NOT-FOUND                      VALUE 'N'.
   256     12  WS-BEN-RECORD-SW        PIC  X(01)      VALUE SPACE.
   257         88  BEN-FOUND                           VALUE 'Y'.
   258     12  WS-STATE-RECORD-SW      PIC  X(01)      VALUE SPACE.
   259         88  STATE-FOUND                         VALUE 'Y'.
   260     12  WS-ST-BEN-RECORD-SW     PIC  X(01)      VALUE SPACE.
   261         88  ST-BEN-FOUND                        VALUE 'Y'.
   262     12  WS-ACCT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   263         88  ACCT-FOUND                          VALUE 'Y'.
   264     12  WS-DUPREC-SW            PIC  X(01)      VALUE SPACE.
   265         88  DUPLICATE-RECORD-FOUND              VALUE 'Y'.
   266     12  WS-NOT-FOUND            PIC S9(01) COMP-3
   267                                                 VALUE ZERO.
   268         88  BENEFIT-FOUND                       VALUE +1.
   269     12  WS-CALC-REFUND          PIC S9(07)V99 COMP-3
   270                                                 VALUE ZERO.
   271     12  WS-LIFE-PREMIUM         PIC S9(07)V99 COMP-3
   272                                                 VALUE ZERO.
   273     12  WS-INDEX                PIC S9(04) COMP VALUE ZERO.
   274     12  WS-SUB1                 PIC S99    COMP.
   275     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   276     12  WS-CF-DEFAULT-APR       PIC  S9(03)V9(04) COMP-3.
   277     12  WS-CF-CR-R78-METHOD     PIC  X(01)      VALUE SPACE.
   278     12  WS-CF-CR-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   279     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   280     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   281     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   282     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page   7
* EL1278.cbl
   283     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   284     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   285     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   286     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   287     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   288     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   289     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   290     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   291     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   292     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   293     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   294     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   295     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   296     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   297     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   298     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   299     12  ERROR-MESSAGES.
   300         16  ER-0000             PIC  X(04)      VALUE '0000'.
   301         16  ER-0004             PIC  X(04)      VALUE '0004'.
   302         16  ER-0008             PIC  X(04)      VALUE '0008'.
   303         16  ER-0028             PIC  X(04)      VALUE '0028'.
   304         16  ER-0029             PIC  X(04)      VALUE '0029'.
   305         16  ER-0070             PIC  X(04)      VALUE '0070'.
   306         16  ER-0214             PIC  X(04)      VALUE '0214'.
   307         16  ER-0681             PIC  X(04)      VALUE '0681'.
   308         16  ER-0682             PIC  X(04)      VALUE '0682'.
   309         16  ER-0683             PIC  X(04)      VALUE '0683'.
   310         16  ER-0684             PIC  X(04)      VALUE '0684'.
   311         16  ER-2227             PIC  X(04)      VALUE '2227'.
   312         16  ER-2601             PIC  X(04)      VALUE '2601'.
   313         16  ER-2616             PIC  X(04)      VALUE '2616'.
   314         16  ER-2617             PIC  X(04)      VALUE '2617'.
   315         16  ER-2619             PIC  X(04)      VALUE '2619'.
   316         16  ER-2740             PIC  X(04)      VALUE '2740'.
   317         16  ER-2756             PIC  X(04)      VALUE '2756'.
   318         16  ER-2768             PIC  X(04)      VALUE '2768'.
   319         16  ER-2774             PIC  X(04)      VALUE '2774'.
   320         16  ER-2775             PIC  X(04)      VALUE '2775'.
   321         16  ER-2965             PIC  X(04)      VALUE '2965'.
   322         16  ER-2966             PIC  X(04)      VALUE '2966'.
   323         16  ER-2967             PIC  X(04)      VALUE '2967'.
   324         16  ER-2968             PIC  X(04)      VALUE '2968'.
   325         16  ER-2969             PIC  X(04)      VALUE '2969'.
   326         16  ER-3037             PIC  X(04)      VALUE '3037'.
   327         16  ER-3038             PIC  X(04)      VALUE '3038'.
   328         16  ER-3039             PIC  X(04)      VALUE '3039'.
   329         16  ER-3780             PIC  X(04)      VALUE '3780'.
   330         16  ER-3781             PIC  X(04)      VALUE '3781'.
   331         16  ER-8160             PIC  X(04)      VALUE '8160'.
   332         16  ER-8161             PIC  X(04)      VALUE '8161'.
   333         16  ER-9999             PIC  X(04)      VALUE '9999'.
   334     12  WS-CF-LIFE-OVERRIDE-L1  PIC  X(01).
   335     12  WS-CF-LIFE-OVERRIDE-L2  PIC  X(02).
   336     12  WS-CF-AH-OVERRIDE-L1    PIC  X(01).
   337     12  WS-CF-AH-OVERRIDE-L2    PIC  X(02).
   338
   339     12  WS-RESPONSE             PIC S9(8)       COMP.
   340         88  WS-RESP-NORMAL                      VALUE +00.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page   8
* EL1278.cbl
   341         88  WS-RESP-NOTFND                      VALUE +13.
   342         88  WS-RESP-DUPKEY                      VALUE +15.
   343         88  WS-RESP-NOTOPEN                     VALUE +19.
   344         88  WS-RESP-ENDFILE                     VALUE +20.
   345
   346 01  WS-SAVE-ALLOWABLE-BENEFIT.
   347     16  WS-SAVE-BENEFIT-CODE      PIC XX.
   348     16  WS-SAVE-BENEFIT-TYPE      PIC X.
   349     16  WS-SAVE-BENEFIT-REVISION  PIC XXX.
   350     16  WS-SAVE-BENEFIT-REM-TERM  PIC X.
   351     16  WS-SAVE-BENEFIT-RETRO-Y-N PIC X.
   352     16  FILLER                    PIC XX.
   353 01  CTBL-KEY-SAVE               PIC X(5).
   354 01  CTBL-KEY.
   355     05  CTBL-COMPANY-CD         PIC X.
   356     05  CTBL-TABLE              PIC XXX.
   357     05  CTBL-BEN-TYPE           PIC X.
   358     05  CTBL-BEN-CODE           PIC XX.
   359 01  WS-CAN-QUOTE-NOTE.
   360     12  WS-CN-DT-QUOTED         PIC  X(09).
   361     12  FILLER                  PIC  X(10)      VALUE
   362         'RF QUOTE: '.
   363     12  WS-CN-LIFE-AMT-RF       PIC  Z,ZZ9.99.
   364     12  FILLER                  PIC  X(4)       VALUE
   365         ' LF '.
   366     12  WS-CN-LF-REF-METH       PIC  X.
   367     12  FILLER                  PIC  X          VALUE ','.
   368     12  WS-CN-AH-AMT-RF         PIC  Z,ZZ9.99.
   369     12  FILLER                  PIC  X(5)       VALUE
   370         ' AH '.
   371     12  WS-CN-AH-REF-METH       PIC  X.
   372     12  FILLER                  PIC  XX         VALUE ','.
   373     12  FILLER                  PIC  X(6)       VALUE
   374         'TOTAL '.
   375     12  WS-CN-TOTAL-RF          PIC  Z,ZZ9.99.
   376     12  FILLER                  PIC  X(01)      VALUE ' '.
   377     12  WS-CN-CANCEL-DT         PIC  X(08).
   378     12  FILLER                  PIC  X(01)      VALUE ';'.
   379     12  WS-CN-PROCESSOR-ID      PIC  X(04).
   380
   381 01  WS-CM-CONTROL-PRIMARY.
   382     12  WS-CM-COMPANY-CD        PIC  X(01).
   383     12  WS-CM-CARRIER           PIC  X(01).
   384     12  WS-CM-GROUPING          PIC  X(06).
   385     12  WS-CM-STATE             PIC  X(02).
   386     12  WS-CM-ACCOUNT           PIC  X(10).
   387     12  WS-CM-CERT-EFF-DT       PIC  X(02).
   388     12  WS-CM-CERT-NO.
   389         16  WS-CM-CERT-PRIME    PIC  X(10).
   390         16  WS-CM-CERT-SFX      PIC  X(01).
   391
   392 01  WS-MA-CONTROL-PRIMARY.
   393     12  WS-MA-COMPANY-CD        PIC  X(01).
   394     12  WS-MA-CARRIER           PIC  X(01).
   395     12  WS-MA-GROUPING          PIC  X(06).
   396     12  WS-MA-STATE             PIC  X(02).
   397     12  WS-MA-ACCOUNT           PIC  X(10).
   398     12  WS-MA-CERT-EFF-DT       PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page   9
* EL1278.cbl
   399     12  WS-MA-CERT-NO.
   400         16  WS-MA-CERT-PRIME    PIC  X(10).
   401         16  WS-MA-CERT-SFX      PIC  X(01).
   402 01  WS-CF-CONTROL-PRIMARY.
   403     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   404     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   405*        88  COMPANY-MASTER                      VALUE '1'.
   406*        88  STATE-MASTER                        VALUE '3'.
   407*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   408*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   409     12  WS-CF-ACCESS.
   410         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   411         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   412             20  FILLER          PIC  X(01).
   413             20  WS-CF-CARRIER   PIC  X(01).
   414     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   415
   416 01  WS-AM-CONTROL-PRIMARY.
   417     12  WS-AM-COMPANY-CD        PIC  X(01).
   418     12  WS-AM-CARRIER           PIC  X(01).
   419     12  WS-AM-GROUPING          PIC  X(06).
   420     12  WS-AM-STATE             PIC  X(02).
   421     12  WS-AM-ACCOUNT           PIC  X(10).
   422     12  WS-AM-EXPIRATION-DT     PIC  X(02).
   423     12  WS-AM-FILLER            PIC  X(04).
   424
   425 01  WS-CN-CONTROL-PRIMARY.
   426     12  WS-CN-COMPANY-CD        PIC  X(01).
   427     12  WS-CN-CARRIER           PIC  X(01).
   428     12  WS-CN-GROUPING          PIC  X(06).
   429     12  WS-CN-STATE             PIC  X(02).
   430     12  WS-CN-ACCOUNT           PIC  X(10).
   431     12  WS-CN-CERT-EFF-DT       PIC  X(02).
   432     12  WS-CN-CERT-NO.
   433         16  WS-CN-CERT-PRIME    PIC  X(10).
   434         16  WS-CN-CERT-SFX      PIC  X.
   435
   436 01  WS-FO-CONTROL-PRIMARY.
   437     12  WS-FO-COMPANY-CD        PIC  X(01).
   438     12  WS-FO-STATE             PIC  X(02).
   439     12  WS-FO-FORM-ID           PIC  X(12).
   440     12  WS-FO-EXP-DT            PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  10
* EL1278.cbl
   442*                            COPY ELCDATE.
   443******************************************************************
   444*                                                                *
   445*                                                                *
   446*                            ELCDATE.                            *
   447*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   448*                            VMOD=2.003
   449*                                                                *
   450*                                                                *
   451*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   452*                 LENGTH = 200                                   *
   453******************************************************************
   454
   455 01  DATE-CONVERSION-DATA.
   456     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   457     12  DC-OPTION-CODE                PIC X.
   458         88  BIN-TO-GREG                VALUE ' '.
   459         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   460         88  EDIT-GREG-TO-BIN           VALUE '2'.
   461         88  YMD-GREG-TO-BIN            VALUE '3'.
   462         88  MDY-GREG-TO-BIN            VALUE '4'.
   463         88  JULIAN-TO-BIN              VALUE '5'.
   464         88  BIN-PLUS-ELAPSED           VALUE '6'.
   465         88  FIND-CENTURY               VALUE '7'.
   466         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   467         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   468         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   469         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   470         88  JULIAN-TO-BIN-3            VALUE 'C'.
   471         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   472         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   473         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   474         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   475         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   476         88  CHECK-LEAP-YEAR            VALUE 'H'.
   477         88  BIN-3-TO-GREG              VALUE 'I'.
   478         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   479         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   480         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   481         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   482         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   483         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   484         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   485         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   486         88  THREE-CHARACTER-BIN
   487                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   488         88  GREGORIAN-TO-BIN
   489                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   490         88  BIN-TO-GREGORIAN
   491                  VALUES ' ' '1' 'I' '8' 'G'.
   492         88  JULIAN-TO-BINARY
   493                  VALUES '5' 'C' 'E' 'F'.
   494     12  DC-ERROR-CODE                 PIC X.
   495         88  NO-CONVERSION-ERROR        VALUE ' '.
   496         88  DATE-CONVERSION-ERROR
   497                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   498         88  DATE-IS-ZERO               VALUE '1'.
   499         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  11
* EL1278.cbl
   500         88  DATE-IS-INVALID            VALUE '3'.
   501         88  DATE1-GREATER-DATE2        VALUE '4'.
   502         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   503         88  DATE-INVALID-OPTION        VALUE '9'.
   504         88  INVALID-CENTURY            VALUE 'A'.
   505         88  ONLY-CENTURY               VALUE 'B'.
   506         88  ONLY-LEAP-YEAR             VALUE 'C'.
   507         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   508     12  DC-END-OF-MONTH               PIC X.
   509         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   510     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   511         88  USE-NORMAL-PROCESS         VALUE ' '.
   512         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   513         88  ADJUST-UP-100-YRS          VALUE '2'.
   514     12  FILLER                        PIC X.
   515     12  DC-CONVERSION-DATES.
   516         16  DC-BIN-DATE-1             PIC XX.
   517         16  DC-BIN-DATE-2             PIC XX.
   518         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   519         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   520                       DC-GREG-DATE-1-EDIT.
   521             20  DC-EDIT1-MONTH        PIC 99.
   522             20  SLASH1-1              PIC X.
   523             20  DC-EDIT1-DAY          PIC 99.
   524             20  SLASH1-2              PIC X.
   525             20  DC-EDIT1-YEAR         PIC 99.
   526         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   527         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   528                     DC-GREG-DATE-2-EDIT.
   529             20  DC-EDIT2-MONTH        PIC 99.
   530             20  SLASH2-1              PIC X.
   531             20  DC-EDIT2-DAY          PIC 99.
   532             20  SLASH2-2              PIC X.
   533             20  DC-EDIT2-YEAR         PIC 99.
   534         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   535         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   536                     DC-GREG-DATE-1-YMD.
   537             20  DC-YMD-YEAR           PIC 99.
   538             20  DC-YMD-MONTH          PIC 99.
   539             20  DC-YMD-DAY            PIC 99.
   540         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   541         16  DC-GREG-DATE-1-MDY-R REDEFINES
   542                      DC-GREG-DATE-1-MDY.
   543             20  DC-MDY-MONTH          PIC 99.
   544             20  DC-MDY-DAY            PIC 99.
   545             20  DC-MDY-YEAR           PIC 99.
   546         16  DC-GREG-DATE-1-ALPHA.
   547             20  DC-ALPHA-MONTH        PIC X(10).
   548             20  DC-ALPHA-DAY          PIC 99.
   549             20  FILLER                PIC XX.
   550             20  DC-ALPHA-CENTURY.
   551                 24 DC-ALPHA-CEN-N     PIC 99.
   552             20  DC-ALPHA-YEAR         PIC 99.
   553         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   554         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   555         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   556         16  DC-JULIAN-DATE            PIC 9(05).
   557         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  12
* EL1278.cbl
   558                                       PIC 9(05).
   559         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   560             20  DC-JULIAN-YEAR        PIC 99.
   561             20  DC-JULIAN-DAYS        PIC 999.
   562         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   563         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   564         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   565     12  DATE-CONVERSION-VARIBLES.
   566         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   567         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   568             20  FILLER                PIC 9(3).
   569             20  HOLD-CEN-1-CCYY.
   570                 24  HOLD-CEN-1-CC     PIC 99.
   571                 24  HOLD-CEN-1-YY     PIC 99.
   572             20  HOLD-CEN-1-MO         PIC 99.
   573             20  HOLD-CEN-1-DA         PIC 99.
   574         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   575             20  HOLD-CEN-1-R-MO       PIC 99.
   576             20  HOLD-CEN-1-R-DA       PIC 99.
   577             20  HOLD-CEN-1-R-CCYY.
   578                 24  HOLD-CEN-1-R-CC   PIC 99.
   579                 24  HOLD-CEN-1-R-YY   PIC 99.
   580             20  FILLER                PIC 9(3).
   581         16  HOLD-CENTURY-1-X.
   582             20  FILLER                PIC X(3)  VALUE SPACES.
   583             20  HOLD-CEN-1-X-CCYY.
   584                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   585                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   586             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   587             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   588         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   589             20  HOLD-CEN-1-R-X-MO     PIC XX.
   590             20  HOLD-CEN-1-R-X-DA     PIC XX.
   591             20  HOLD-CEN-1-R-X-CCYY.
   592                 24  HOLD-CEN-1-R-X-CC PIC XX.
   593                 24  HOLD-CEN-1-R-X-YY PIC XX.
   594             20  FILLER                PIC XXX.
   595         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   596         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   597         16  DC-JULIAN-DATE-1          PIC 9(07).
   598         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   599             20  DC-JULIAN-1-CCYY.
   600                 24  DC-JULIAN-1-CC    PIC 99.
   601                 24  DC-JULIAN-1-YR    PIC 99.
   602             20  DC-JULIAN-DA-1        PIC 999.
   603         16  DC-JULIAN-DATE-2          PIC 9(07).
   604         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   605             20  DC-JULIAN-2-CCYY.
   606                 24  DC-JULIAN-2-CC    PIC 99.
   607                 24  DC-JULIAN-2-YR    PIC 99.
   608             20  DC-JULIAN-DA-2        PIC 999.
   609         16  DC-GREG-DATE-A-EDIT.
   610             20  DC-EDITA-MONTH        PIC 99.
   611             20  SLASHA-1              PIC X VALUE '/'.
   612             20  DC-EDITA-DAY          PIC 99.
   613             20  SLASHA-2              PIC X VALUE '/'.
   614             20  DC-EDITA-CCYY.
   615                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  13
* EL1278.cbl
   616                 24  DC-EDITA-YEAR     PIC 99.
   617         16  DC-GREG-DATE-B-EDIT.
   618             20  DC-EDITB-MONTH        PIC 99.
   619             20  SLASHB-1              PIC X VALUE '/'.
   620             20  DC-EDITB-DAY          PIC 99.
   621             20  SLASHB-2              PIC X VALUE '/'.
   622             20  DC-EDITB-CCYY.
   623                 24  DC-EDITB-CENT     PIC 99.
   624                 24  DC-EDITB-YEAR     PIC 99.
   625         16  DC-GREG-DATE-CYMD         PIC 9(08).
   626         16  DC-GREG-DATE-CYMD-R REDEFINES
   627                              DC-GREG-DATE-CYMD.
   628             20  DC-CYMD-CEN           PIC 99.
   629             20  DC-CYMD-YEAR          PIC 99.
   630             20  DC-CYMD-MONTH         PIC 99.
   631             20  DC-CYMD-DAY           PIC 99.
   632         16  DC-GREG-DATE-MDCY         PIC 9(08).
   633         16  DC-GREG-DATE-MDCY-R REDEFINES
   634                              DC-GREG-DATE-MDCY.
   635             20  DC-MDCY-MONTH         PIC 99.
   636             20  DC-MDCY-DAY           PIC 99.
   637             20  DC-MDCY-CEN           PIC 99.
   638             20  DC-MDCY-YEAR          PIC 99.
   639    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   640        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   641    12  DC-EL310-DATE                  PIC X(21).
   642    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  14
* EL1278.cbl
   644*                            COPY ELCLOGOF.
   645******************************************************************
   646*                                                                *
   647*                                                                *
   648*                            ELCLOGOF.                           *
   649*                            VMOD=2.001                          *
   650*                                                                *
   651*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   652*                                                                *
   653******************************************************************
   654 01  CLASIC-LOGOFF.
   655     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   656     12  LOGOFF-TEXT.
   657         16  FILLER          PIC X(5)    VALUE SPACES.
   658         16  LOGOFF-MSG.
   659             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   660             20  FILLER      PIC X       VALUE SPACES.
   661             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   662         16  FILLER          PIC X(80)
   663           VALUE '* YOU ARE NOW LOGGED OFF'.
   664         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   665         16  FILLER          PIC X       VALUE QUOTE.
   666         16  LOGOFF-SYS-MSG  PIC X(17)
   667           VALUE 'S CLAS-IC SYSTEM '.
   668     12  TEXT-MESSAGES.
   669         16  UNACCESS-MSG    PIC X(29)
   670             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   671         16  PGMIDERR-MSG    PIC X(17)
   672             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  15
* EL1278.cbl
   674*                            COPY ELCATTR.
   675******************************************************************
   676*                                                                *
   677*                            ELCATTR.                            *
   678*                            VMOD=2.001                          *
   679*                                                                *
   680*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   681*                                                                *
   682*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   683*                                                                *
   684*                   POS 1   P=PROTECTED                          *
   685*                           U=UNPROTECTED                        *
   686*                           S=ASKIP                              *
   687*                   POS 2   A=ALPHA/NUMERIC                      *
   688*                           N=NUMERIC                            *
   689*                   POS 3   N=NORMAL                             *
   690*                           B=BRIGHT                             *
   691*                           D=DARK                               *
   692*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   693*                           OF=MODIFIED DATA TAG OFF             *
   694*                                                                *
   695*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   696******************************************************************
   697 01  ATTRIBUTE-LIST.
   698     12  AL-PABOF            PIC X       VALUE 'Y'.
   699     12  AL-PABON            PIC X       VALUE 'Z'.
   700     12  AL-PADOF            PIC X       VALUE '%'.
   701     12  AL-PADON            PIC X       VALUE '_'.
   702     12  AL-PANOF            PIC X       VALUE '-'.
   703     12  AL-PANON            PIC X       VALUE '/'.
   704     12  AL-SABOF            PIC X       VALUE '8'.
   705     12  AL-SABON            PIC X       VALUE '9'.
   706     12  AL-SADOF            PIC X       VALUE '@'.
   707     12  AL-SADON            PIC X       VALUE QUOTE.
   708     12  AL-SANOF            PIC X       VALUE '0'.
   709     12  AL-SANON            PIC X       VALUE '1'.
   710     12  AL-UABOF            PIC X       VALUE 'H'.
   711     12  AL-UABON            PIC X       VALUE 'I'.
   712     12  AL-UADOF            PIC X       VALUE '<'.
   713     12  AL-UADON            PIC X       VALUE '('.
   714     12  AL-UANOF            PIC X       VALUE ' '.
   715     12  AL-UANON            PIC X       VALUE 'A'.
   716     12  AL-UNBOF            PIC X       VALUE 'Q'.
   717     12  AL-UNBON            PIC X       VALUE 'R'.
   718     12  AL-UNDOF            PIC X       VALUE '*'.
   719     12  AL-UNDON            PIC X       VALUE ')'.
   720     12  AL-UNNOF            PIC X       VALUE '&'.
   721     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  16
* EL1278.cbl
   723*                            COPY ELCEMIB.
   724******************************************************************
   725*                                                                *
   726*                                                                *
   727*                            ELCEMIB.                            *
   728*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   729*                            VMOD=2.005                          *
   730*                                                                *
   731*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   732*                                                                *
   733******************************************************************
   734 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   735     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   736     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   737     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   738     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   739     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   740     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   741     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   742     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   743     12  EMI-SWITCH1             PIC X        VALUE '1'.
   744         88  EMI-NO-ERRORS                    VALUE '1'.
   745         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   746         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   747     12  EMI-SWITCH2             PIC X        VALUE '1'.
   748         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   749     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   750         88  EMI-AREA1-EMPTY                  VALUE '1'.
   751         88  EMI-AREA1-FULL                   VALUE '2'.
   752     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   753         88  EMI-AREA2-EMPTY                  VALUE '1'.
   754         88  EMI-AREA2-FULL                   VALUE '2'.
   755     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   756         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   757         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   758         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   759         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   760         88  EMI-BYPASS-FATALS                VALUE 'X'.
   761     12  EMI-ERROR-LINES.
   762         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   763         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   764         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   765         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   766             20  EMI-ERR-CODES OCCURS 10 TIMES.
   767                 24  EMI-ERR-NUM         PIC X(4).
   768                 24  EMI-FILLER          PIC X.
   769                 24  EMI-SEV             PIC X.
   770                 24  FILLER              PIC X.
   771             20  FILLER                  PIC X(02).
   772     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   773         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   774             20  EMI-ERROR-NUMBER    PIC X(4).
   775             20  EMI-FILL            PIC X.
   776             20  EMI-SEVERITY        PIC X.
   777             20  FILLER              PIC X.
   778             20  EMI-ERROR-TEXT.
   779                 24  EMI-TEXT-VARIABLE   PIC X(10).
   780                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  17
* EL1278.cbl
   781     12  EMI-SEVERITY-SAVE           PIC X.
   782         88  EMI-NOTE                    VALUE 'N'.
   783         88  EMI-WARNING                 VALUE 'W'.
   784         88  EMI-FORCABLE                VALUE 'F'.
   785         88  EMI-FATAL                   VALUE 'X'.
   786     12  EMI-MESSAGE-FLAG            PIC X.
   787         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   788         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   789     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   790     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   791         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   792         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   793         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   794     12  FILLER                      PIC X(137)  VALUE SPACES.
   795     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   796     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   797     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   798     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  18
* EL1278.cbl
   800*                            COPY ELCINTF.
   801******************************************************************
   802*                                                                *
   803*                                                                *
   804*                            ELCINTF.                            *
   805*                            VMOD=2.017                          *
   806*                                                                *
   807*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   808*                                                                *
   809*       LENGTH = 1024                                            *
   810*                                                                *
   811******************************************************************
   812 01  PROGRAM-INTERFACE-BLOCK.
   813     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   814     12  PI-CALLING-PROGRAM              PIC X(8).
   815     12  PI-SAVED-PROGRAM-1              PIC X(8).
   816     12  PI-SAVED-PROGRAM-2              PIC X(8).
   817     12  PI-SAVED-PROGRAM-3              PIC X(8).
   818     12  PI-SAVED-PROGRAM-4              PIC X(8).
   819     12  PI-SAVED-PROGRAM-5              PIC X(8).
   820     12  PI-SAVED-PROGRAM-6              PIC X(8).
   821     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   822     12  PI-COMPANY-ID                   PIC XXX.
   823     12  PI-COMPANY-CD                   PIC X.
   824
   825     12  PI-COMPANY-PASSWORD             PIC X(8).
   826
   827     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   828
   829     12  PI-CONTROL-IN-PROGRESS.
   830         16  PI-CARRIER                  PIC X.
   831         16  PI-GROUPING                 PIC X(6).
   832         16  PI-STATE                    PIC XX.
   833         16  PI-ACCOUNT                  PIC X(10).
   834         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   835                                         PIC X(10).
   836         16  PI-CLAIM-CERT-GRP.
   837             20  PI-CLAIM-NO             PIC X(7).
   838             20  PI-CERT-NO.
   839                 25  PI-CERT-PRIME       PIC X(10).
   840                 25  PI-CERT-SFX         PIC X.
   841             20  PI-CERT-EFF-DT          PIC XX.
   842         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   843             20  PI-PLAN-CODE            PIC X(2).
   844             20  PI-REVISION-NUMBER      PIC X(3).
   845             20  PI-PLAN-EFF-DT          PIC X(2).
   846             20  PI-PLAN-EXP-DT          PIC X(2).
   847             20  FILLER                  PIC X(11).
   848         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   849             20  PI-OE-REFERENCE-1.
   850                 25  PI-OE-REF-1-PRIME   PIC X(18).
   851                 25  PI-OE-REF-1-SUFF    PIC XX.
   852
   853     12  PI-SESSION-IN-PROGRESS          PIC X.
   854         88  CLAIM-SESSION                   VALUE '1'.
   855         88  CREDIT-SESSION                  VALUE '2'.
   856         88  WARRANTY-SESSION                VALUE '3'.
   857         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  19
* EL1278.cbl
   858         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   859
   860
   861*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   862
   863     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   864     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   865
   866     12  PI-CREDIT-USER                  PIC X.
   867         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   868         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   869
   870     12  PI-CLAIM-USER                   PIC X.
   871         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   872         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   873
   874     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   875         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   876         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   877         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   878         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   879         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   880
   881     12  PI-PROCESSOR-ID                 PIC X(4).
   882
   883     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   884
   885     12  PI-MEMBER-CAPTION               PIC X(10).
   886
   887     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   888         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   889
   890     12  PI-LIFE-OVERRIDE-L1             PIC X.
   891     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   892     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   893     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   894
   895     12  PI-AH-OVERRIDE-L1               PIC X.
   896     12  PI-AH-OVERRIDE-L2               PIC XX.
   897     12  PI-AH-OVERRIDE-L6               PIC X(6).
   898     12  PI-AH-OVERRIDE-L12              PIC X(12).
   899
   900     12  PI-NEW-SYSTEM                   PIC X(2).
   901
   902     12  PI-PRIMARY-CERT-NO              PIC X(11).
   903     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   904         88  PI-USES-PAID-TO                 VALUE '1'.
   905     12  PI-CRDTCRD-SYSTEM.
   906         16  PI-CRDTCRD-USER             PIC X.
   907             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   908             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   909         16  PI-CC-MONTH-END-DT          PIC XX.
   910     12  PI-PROCESSOR-PRINTER            PIC X(4).
   911
   912     12  PI-OE-REFERENCE-2.
   913         16  PI-OE-REF-2-PRIME           PIC X(10).
   914         16  PI-OE-REF-2-SUFF            PIC X.
   915
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  20
* EL1278.cbl
   916     12  PI-REM-TRM-CALC-OPTION          PIC X.
   917
   918     12  PI-LANGUAGE-TYPE                PIC X.
   919             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   920             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   921             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   922
   923     12  PI-POLICY-LINKAGE-IND           PIC X.
   924         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   925         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   926                                                   LOW-VALUES.
   927
   928     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   929     12  PI-CLAIM-PW-SESSION             PIC X(1).
   930         88  PI-CLAIM-CREDIT                 VALUE '1'.
   931         88  PI-CLAIM-CONVEN                 VALUE '2'.
   932     12  FILLER                          PIC X(4).
   933
   934     12  PI-SYSTEM-LEVEL                 PIC X(145).
   935
   936     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   937         PI-SYSTEM-LEVEL.
   938
   939         16  PI-ENTRY-CODES.
   940             20  PI-ENTRY-CD-1           PIC X.
   941             20  PI-ENTRY-CD-2           PIC X.
   942
   943         16  PI-RETURN-CODES.
   944             20  PI-RETURN-CD-1          PIC X.
   945             20  PI-RETURN-CD-2          PIC X.
   946
   947         16  PI-UPDATE-STATUS-SAVE.
   948             20  PI-UPDATE-BY            PIC X(4).
   949             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   950
   951         16  PI-LOWER-CASE-LETTERS       PIC X.
   952             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   953
   954*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   955*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   956*            88  CARRIER-CLM-CNTL            VALUE '2'.
   957
   958         16  PI-CERT-ACCESS-CONTROL      PIC X.
   959             88  ST-ACCNT-CNTL               VALUE ' '.
   960             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   961             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   962             88  ACCNT-CNTL                  VALUE '3'.
   963             88  CARR-ACCNT-CNTL             VALUE '4'.
   964
   965         16  PI-PROCESSOR-CAP-LIST.
   966             20  PI-SYSTEM-CONTROLS.
   967                24 PI-SYSTEM-DISPLAY     PIC X.
   968                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   969                24 PI-SYSTEM-MODIFY      PIC X.
   970                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   971             20  FILLER                  PIC XX.
   972             20  PI-DISPLAY-CAP          PIC X.
   973                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  21
* EL1278.cbl
   974             20  PI-MODIFY-CAP           PIC X.
   975                 88  MODIFY-CAP              VALUE 'Y'.
   976             20  PI-MSG-AT-LOGON-CAP     PIC X.
   977                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   978             20  PI-FORCE-CAP            PIC X.
   979                 88  FORCE-CAP               VALUE 'Y'.
   980
   981         16  PI-PROGRAM-CONTROLS.
   982             20  PI-PGM-PRINT-OPT        PIC X.
   983             20  PI-PGM-FORMAT-OPT       PIC X.
   984             20  PI-PGM-PROCESS-OPT      PIC X.
   985             20  PI-PGM-TOTALS-OPT       PIC X.
   986
   987         16  PI-HELP-INTERFACE.
   988             20  PI-LAST-ERROR-NO        PIC X(4).
   989             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   990
   991         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   992             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   993
   994         16  PI-CR-CONTROL-IN-PROGRESS.
   995             20  PI-CR-CARRIER           PIC X.
   996             20  PI-CR-GROUPING          PIC X(6).
   997             20  PI-CR-STATE             PIC XX.
   998             20  PI-CR-ACCOUNT           PIC X(10).
   999             20  PI-CR-FIN-RESP          PIC X(10).
  1000             20  PI-CR-TYPE              PIC X.
  1001
  1002         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1003
  1004         16  PI-CR-MONTH-END-DT          PIC XX.
  1005
  1006         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1007             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1008             88  PI-ZERO-CARRIER             VALUE '1'.
  1009             88  PI-ZERO-GROUPING            VALUE '2'.
  1010             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1011
  1012         16  PI-CARRIER-SECURITY         PIC X.
  1013             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1014
  1015         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1016             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1017             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1018
  1019         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1020             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1021                                         INDEXED BY PI-ACCESS-NDX
  1022                                         PIC X.
  1023
  1024         16  PI-GA-BILLING-CONTROL       PIC X.
  1025             88  PI-GA-BILLING               VALUE '1'.
  1026
  1027         16  PI-MAIL-PROCESSING          PIC X.
  1028             88  PI-MAIL-YES                 VALUE 'Y'.
  1029
  1030         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1031
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  22
* EL1278.cbl
  1032         16  PI-AR-SYSTEM.
  1033             20  PI-AR-PROCESSING-CNTL   PIC X.
  1034                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1035             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1036             20  PI-AR-MONTH-END-DT      PIC XX.
  1037
  1038         16  PI-MP-SYSTEM.
  1039             20  PI-MORTGAGE-USER            PIC X.
  1040                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1041                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1042             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1043                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1044                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1045                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1046                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1047                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1048             20  PI-MP-MONTH-END-DT          PIC XX.
  1049             20  PI-MP-REFERENCE-NO.
  1050                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1051                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1052
  1053         16  PI-LABEL-CONTROL            PIC X(01).
  1054             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1055             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1056
  1057         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1058             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1059
  1060         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1061             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1062             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1063
  1064         16  FILLER                      PIC X(14).
  1065
  1066     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1067******************************************************************
  1068     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1069         16  FILLER                PIC  X(500).
  1070         16  PI-PEND-SW            PIC  X(01).
  1071         16  PI-LF-CANCEL-DATE     PIC  X(02).
  1072         16  PI-AH-CANCEL-DATE     PIC  X(02).
  1073         16  PI-LF-CANCEL-DATE-ED  PIC  X(08).
  1074         16  PI-AH-CANCEL-DATE-ED  PIC  X(08).
  1075         16  PI-EARNING-METHOD-LF  PIC  X.
  1076         16  PI-EARNING-METHOD-AH  PIC  X.
  1077         16  PI-LF-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1078         16  PI-LF-REFUND-METH     PIC  X.
  1079         16  PI-AH-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1080         16  PI-AH-REFUND-METH     PIC  X.
  1081         16  PI-TOTAL-REFUND-AMT   PIC  S9(7)V99 COMP-3.
  1082         16  PI-MODIFY-CERT-CAP    PIC  X.
  1083             88 MODIFY-CERT-CAP    VALUE 'Y'.
  1084         16  PI-CLP-YN             PIC X.
  1085         16  PI-CANCEL-REASON      PIC X.
  1086         16  FILLER                PIC  X(97).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  23
* EL1278.cbl
  1088*                            COPY ELCAID.
  1089******************************************************************
  1090*                                                                *
  1091*                            ELCAID.                             *
  1092*                            VMOD=2.001                          *
  1093*                                                                *
  1094*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1095*                                                                *
  1096*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1097*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1098******************************************************************
  1099
  1100 01  DFHAID.
  1101   02  DFHNULL   PIC  X  VALUE  ' '.
  1102   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1103   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1104   02  DFHPEN    PIC  X  VALUE  '='.
  1105   02  DFHOPID   PIC  X  VALUE  'W'.
  1106   02  DFHPA1    PIC  X  VALUE  '%'.
  1107   02  DFHPA2    PIC  X  VALUE  '>'.
  1108   02  DFHPA3    PIC  X  VALUE  ','.
  1109   02  DFHPF1    PIC  X  VALUE  '1'.
  1110   02  DFHPF2    PIC  X  VALUE  '2'.
  1111   02  DFHPF3    PIC  X  VALUE  '3'.
  1112   02  DFHPF4    PIC  X  VALUE  '4'.
  1113   02  DFHPF5    PIC  X  VALUE  '5'.
  1114   02  DFHPF6    PIC  X  VALUE  '6'.
  1115   02  DFHPF7    PIC  X  VALUE  '7'.
  1116   02  DFHPF8    PIC  X  VALUE  '8'.
  1117   02  DFHPF9    PIC  X  VALUE  '9'.
  1118   02  DFHPF10   PIC  X  VALUE  ':'.
  1119   02  DFHPF11   PIC  X  VALUE  '#'.
  1120   02  DFHPF12   PIC  X  VALUE  '@'.
  1121   02  DFHPF13   PIC  X  VALUE  'A'.
  1122   02  DFHPF14   PIC  X  VALUE  'B'.
  1123   02  DFHPF15   PIC  X  VALUE  'C'.
  1124   02  DFHPF16   PIC  X  VALUE  'D'.
  1125   02  DFHPF17   PIC  X  VALUE  'E'.
  1126   02  DFHPF18   PIC  X  VALUE  'F'.
  1127   02  DFHPF19   PIC  X  VALUE  'G'.
  1128   02  DFHPF20   PIC  X  VALUE  'H'.
  1129   02  DFHPF21   PIC  X  VALUE  'I'.
  1130*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1131   02  DFHPF22   PIC  X  VALUE  '['.
  1132   02  DFHPF23   PIC  X  VALUE  '.'.
  1133   02  DFHPF24   PIC  X  VALUE  '<'.
  1134   02  DFHMSRE   PIC  X  VALUE  'X'.
  1135   02  DFHSTRF   PIC  X  VALUE  'h'.
  1136   02  DFHTRIG   PIC  X  VALUE  '"'.
  1137
  1138 01  FILLER  REDEFINES  DFHAID.
  1139     12  FILLER                  PIC  X(08).
  1140     12  PF-VALUES               PIC  X(01)      OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  24
* EL1278.cbl
  1142*                            COPY EL1278S.
  1143 01  EL127HI.
  1144     05  FILLER            PIC  X(0012).
  1145*    -------------------------------
  1146     05  HDATEL PIC S9(0004) COMP.
  1147     05  HDATEF PIC  X(0001).
  1148     05  FILLER REDEFINES HDATEF.
  1149         10  HDATEA PIC  X(0001).
  1150     05  HDATEI PIC  X(0008).
  1151*    -------------------------------
  1152     05  HTIMEL PIC S9(0004) COMP.
  1153     05  HTIMEF PIC  X(0001).
  1154     05  FILLER REDEFINES HTIMEF.
  1155         10  HTIMEA PIC  X(0001).
  1156     05  HTIMEI PIC  999V99.
  1157*    -------------------------------
  1158     05  CMPNYIDL PIC S9(0004) COMP.
  1159     05  CMPNYIDF PIC  X(0001).
  1160     05  FILLER REDEFINES CMPNYIDF.
  1161         10  CMPNYIDA PIC  X(0001).
  1162     05  CMPNYIDI PIC  X(0003).
  1163*    -------------------------------
  1164     05  USERIDL PIC S9(0004) COMP.
  1165     05  USERIDF PIC  X(0001).
  1166     05  FILLER REDEFINES USERIDF.
  1167         10  USERIDA PIC  X(0001).
  1168     05  USERIDI PIC  X(0004).
  1169*    -------------------------------
  1170     05  HCARIERL PIC S9(0004) COMP.
  1171     05  HCARIERF PIC  X(0001).
  1172     05  FILLER REDEFINES HCARIERF.
  1173         10  HCARIERA PIC  X(0001).
  1174     05  HCARIERI PIC  X(0001).
  1175*    -------------------------------
  1176     05  HGROUPL PIC S9(0004) COMP.
  1177     05  HGROUPF PIC  X(0001).
  1178     05  FILLER REDEFINES HGROUPF.
  1179         10  HGROUPA PIC  X(0001).
  1180     05  HGROUPI PIC  X(0006).
  1181*    -------------------------------
  1182     05  HSTATEL PIC S9(0004) COMP.
  1183     05  HSTATEF PIC  X(0001).
  1184     05  FILLER REDEFINES HSTATEF.
  1185         10  HSTATEA PIC  X(0001).
  1186     05  HSTATEI PIC  X(0002).
  1187*    -------------------------------
  1188     05  HACCTNOL PIC S9(0004) COMP.
  1189     05  HACCTNOF PIC  X(0001).
  1190     05  FILLER REDEFINES HACCTNOF.
  1191         10  HACCTNOA PIC  X(0001).
  1192     05  HACCTNOI PIC  X(0010).
  1193*    -------------------------------
  1194     05  HEFFDTL PIC S9(0004) COMP.
  1195     05  HEFFDTF PIC  X(0001).
  1196     05  FILLER REDEFINES HEFFDTF.
  1197         10  HEFFDTA PIC  X(0001).
  1198     05  HEFFDTI PIC  X(0008).
  1199*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  25
* EL1278.cbl
  1200     05  HCERTNOL PIC S9(0004) COMP.
  1201     05  HCERTNOF PIC  X(0001).
  1202     05  FILLER REDEFINES HCERTNOF.
  1203         10  HCERTNOA PIC  X(0001).
  1204     05  HCERTNOI PIC  X(0010).
  1205*    -------------------------------
  1206     05  HCRTSFXL PIC S9(0004) COMP.
  1207     05  HCRTSFXF PIC  X(0001).
  1208     05  FILLER REDEFINES HCRTSFXF.
  1209         10  HCRTSFXA PIC  X(0001).
  1210     05  HCRTSFXI PIC  X(0001).
  1211*    -------------------------------
  1212     05  HLNAMEL PIC S9(0004) COMP.
  1213     05  HLNAMEF PIC  X(0001).
  1214     05  FILLER REDEFINES HLNAMEF.
  1215         10  HLNAMEA PIC  X(0001).
  1216     05  HLNAMEI PIC  X(0015).
  1217*    -------------------------------
  1218     05  HFNAMEL PIC S9(0004) COMP.
  1219     05  HFNAMEF PIC  X(0001).
  1220     05  FILLER REDEFINES HFNAMEF.
  1221         10  HFNAMEA PIC  X(0001).
  1222     05  HFNAMEI PIC  X(0010).
  1223*    -------------------------------
  1224     05  HINITL PIC S9(0004) COMP.
  1225     05  HINITF PIC  X(0001).
  1226     05  FILLER REDEFINES HINITF.
  1227         10  HINITA PIC  X(0001).
  1228     05  HINITI PIC  X(0001).
  1229*    -------------------------------
  1230     05  LCLMDTHL PIC S9(0004) COMP.
  1231     05  LCLMDTHF PIC  X(0001).
  1232     05  FILLER REDEFINES LCLMDTHF.
  1233         10  LCLMDTHA PIC  X(0001).
  1234     05  LCLMDTHI PIC  X(0022).
  1235*    -------------------------------
  1236     05  LCLMDTL PIC S9(0004) COMP.
  1237     05  LCLMDTF PIC  X(0001).
  1238     05  FILLER REDEFINES LCLMDTF.
  1239         10  LCLMDTA PIC  X(0001).
  1240     05  LCLMDTI PIC  X(0008).
  1241*    -------------------------------
  1242     05  HPCYNL PIC S9(0004) COMP.
  1243     05  HPCYNF PIC  X(0001).
  1244     05  FILLER REDEFINES HPCYNF.
  1245         10  HPCYNA PIC  X(0001).
  1246     05  HPCYNI PIC  X(0001).
  1247*    -------------------------------
  1248     05  ACLMDTHL PIC S9(0004) COMP.
  1249     05  ACLMDTHF PIC  X(0001).
  1250     05  FILLER REDEFINES ACLMDTHF.
  1251         10  ACLMDTHA PIC  X(0001).
  1252     05  ACLMDTHI PIC  X(0023).
  1253*    -------------------------------
  1254     05  ACLMDTL PIC S9(0004) COMP.
  1255     05  ACLMDTF PIC  X(0001).
  1256     05  FILLER REDEFINES ACLMDTF.
  1257         10  ACLMDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  26
* EL1278.cbl
  1258     05  ACLMDTI PIC  X(0008).
  1259*    -------------------------------
  1260     05  PMTHDL PIC S9(0004) COMP.
  1261     05  PMTHDF PIC  X(0001).
  1262     05  FILLER REDEFINES PMTHDF.
  1263         10  PMTHDA PIC  X(0001).
  1264     05  PMTHDI PIC  X(0010).
  1265*    -------------------------------
  1266     05  CNCDTHDL PIC S9(0004) COMP.
  1267     05  CNCDTHDF PIC  X(0001).
  1268     05  FILLER REDEFINES CNCDTHDF.
  1269         10  CNCDTHDA PIC  X(0001).
  1270     05  CNCDTHDI PIC  X(0007).
  1271*    -------------------------------
  1272     05  HLKINDL PIC S9(0004) COMP.
  1273     05  HLKINDF PIC  X(0001).
  1274     05  FILLER REDEFINES HLKINDF.
  1275         10  HLKINDA PIC  X(0001).
  1276     05  HLKINDI PIC  X(0002).
  1277*    -------------------------------
  1278     05  HLCDL PIC S9(0004) COMP.
  1279     05  HLCDF PIC  X(0001).
  1280     05  FILLER REDEFINES HLCDF.
  1281         10  HLCDA PIC  X(0001).
  1282     05  HLCDI PIC  X(0002).
  1283*    -------------------------------
  1284     05  HLEDESCL PIC S9(0004) COMP.
  1285     05  HLEDESCF PIC  X(0001).
  1286     05  FILLER REDEFINES HLEDESCF.
  1287         10  HLEDESCA PIC  X(0001).
  1288     05  HLEDESCI PIC  X(0003).
  1289*    -------------------------------
  1290     05  HLTERML PIC S9(0004) COMP.
  1291     05  HLTERMF PIC  X(0001).
  1292     05  FILLER REDEFINES HLTERMF.
  1293         10  HLTERMA PIC  X(0001).
  1294     05  HLTERMI PIC  9(3).
  1295*    -------------------------------
  1296     05  HLREML PIC S9(0004) COMP.
  1297     05  HLREMF PIC  X(0001).
  1298     05  FILLER REDEFINES HLREMF.
  1299         10  HLREMA PIC  X(0001).
  1300     05  HLREMI PIC  X(0003).
  1301*    -------------------------------
  1302     05  HLPREML PIC S9(0004) COMP.
  1303     05  HLPREMF PIC  X(0001).
  1304     05  FILLER REDEFINES HLPREMF.
  1305         10  HLPREMA PIC  X(0001).
  1306     05  HLPREMI PIC  X(0011).
  1307*    -------------------------------
  1308     05  HLITDRL PIC S9(0004) COMP.
  1309     05  HLITDRF PIC  X(0001).
  1310     05  FILLER REDEFINES HLITDRF.
  1311         10  HLITDRA PIC  X(0001).
  1312     05  HLITDRI PIC  X(0011).
  1313*    -------------------------------
  1314     05  HLREFNDL PIC S9(0004) COMP.
  1315     05  HLREFNDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  27
* EL1278.cbl
  1316     05  FILLER REDEFINES HLREFNDF.
  1317         10  HLREFNDA PIC  X(0001).
  1318     05  HLREFNDI PIC  X(0011).
  1319*    -------------------------------
  1320     05  HLCANCL PIC S9(0004) COMP.
  1321     05  HLCANCF PIC  X(0001).
  1322     05  FILLER REDEFINES HLCANCF.
  1323         10  HLCANCA PIC  X(0001).
  1324     05  HLCANCI PIC  X(0008).
  1325*    -------------------------------
  1326     05  HLCAL1L PIC S9(0004) COMP.
  1327     05  HLCAL1F PIC  X(0001).
  1328     05  FILLER REDEFINES HLCAL1F.
  1329         10  HLCAL1A PIC  X(0001).
  1330     05  HLCAL1I PIC  X(0001).
  1331*    -------------------------------
  1332     05  HLCALCL PIC S9(0004) COMP.
  1333     05  HLCALCF PIC  X(0001).
  1334     05  FILLER REDEFINES HLCALCF.
  1335         10  HLCALCA PIC  X(0001).
  1336     05  HLCALCI PIC  X(0012).
  1337*    -------------------------------
  1338     05  HAKINDL PIC S9(0004) COMP.
  1339     05  HAKINDF PIC  X(0001).
  1340     05  FILLER REDEFINES HAKINDF.
  1341         10  HAKINDA PIC  X(0001).
  1342     05  HAKINDI PIC  X(0002).
  1343*    -------------------------------
  1344     05  HACDL PIC S9(0004) COMP.
  1345     05  HACDF PIC  X(0001).
  1346     05  FILLER REDEFINES HACDF.
  1347         10  HACDA PIC  X(0001).
  1348     05  HACDI PIC  X(0002).
  1349*    -------------------------------
  1350     05  HAEDESCL PIC S9(0004) COMP.
  1351     05  HAEDESCF PIC  X(0001).
  1352     05  FILLER REDEFINES HAEDESCF.
  1353         10  HAEDESCA PIC  X(0001).
  1354     05  HAEDESCI PIC  X(0003).
  1355*    -------------------------------
  1356     05  HATERML PIC S9(0004) COMP.
  1357     05  HATERMF PIC  X(0001).
  1358     05  FILLER REDEFINES HATERMF.
  1359         10  HATERMA PIC  X(0001).
  1360     05  HATERMI PIC  9(3).
  1361*    -------------------------------
  1362     05  HAREML PIC S9(0004) COMP.
  1363     05  HAREMF PIC  X(0001).
  1364     05  FILLER REDEFINES HAREMF.
  1365         10  HAREMA PIC  X(0001).
  1366     05  HAREMI PIC  X(0003).
  1367*    -------------------------------
  1368     05  HAPREML PIC S9(0004) COMP.
  1369     05  HAPREMF PIC  X(0001).
  1370     05  FILLER REDEFINES HAPREMF.
  1371         10  HAPREMA PIC  X(0001).
  1372     05  HAPREMI PIC  X(0011).
  1373*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  28
* EL1278.cbl
  1374     05  HAITDRL PIC S9(0004) COMP.
  1375     05  HAITDRF PIC  X(0001).
  1376     05  FILLER REDEFINES HAITDRF.
  1377         10  HAITDRA PIC  X(0001).
  1378     05  HAITDRI PIC  X(0011).
  1379*    -------------------------------
  1380     05  HAREFNDL PIC S9(0004) COMP.
  1381     05  HAREFNDF PIC  X(0001).
  1382     05  FILLER REDEFINES HAREFNDF.
  1383         10  HAREFNDA PIC  X(0001).
  1384     05  HAREFNDI PIC  X(0011).
  1385*    -------------------------------
  1386     05  HACANCL PIC S9(0004) COMP.
  1387     05  HACANCF PIC  X(0001).
  1388     05  FILLER REDEFINES HACANCF.
  1389         10  HACANCA PIC  X(0001).
  1390     05  HACANCI PIC  X(0008).
  1391*    -------------------------------
  1392     05  HACAL1L PIC S9(0004) COMP.
  1393     05  HACAL1F PIC  X(0001).
  1394     05  FILLER REDEFINES HACAL1F.
  1395         10  HACAL1A PIC  X(0001).
  1396     05  HACAL1I PIC  X(0001).
  1397*    -------------------------------
  1398     05  HACALCL PIC S9(0004) COMP.
  1399     05  HACALCF PIC  X(0001).
  1400     05  FILLER REDEFINES HACALCF.
  1401         10  HACALCA PIC  X(0001).
  1402     05  HACALCI PIC  X(0012).
  1403*    -------------------------------
  1404     05  TOPREML PIC S9(0004) COMP.
  1405     05  TOPREMF PIC  X(0001).
  1406     05  FILLER REDEFINES TOPREMF.
  1407         10  TOPREMA PIC  X(0001).
  1408     05  TOPREMI PIC  X(0011).
  1409*    -------------------------------
  1410     05  TOITDRL PIC S9(0004) COMP.
  1411     05  TOITDRF PIC  X(0001).
  1412     05  FILLER REDEFINES TOITDRF.
  1413         10  TOITDRA PIC  X(0001).
  1414     05  TOITDRI PIC  X(0011).
  1415*    -------------------------------
  1416     05  TORFNDL PIC S9(0004) COMP.
  1417     05  TORFNDF PIC  X(0001).
  1418     05  FILLER REDEFINES TORFNDF.
  1419         10  TORFNDA PIC  X(0001).
  1420     05  TORFNDI PIC  X(0011).
  1421*    -------------------------------
  1422     05  CANREAHL PIC S9(0004) COMP.
  1423     05  CANREAHF PIC  X(0001).
  1424     05  FILLER REDEFINES CANREAHF.
  1425         10  CANREAHA PIC  X(0001).
  1426     05  CANREAHI PIC  X(0015).
  1427*    -------------------------------
  1428     05  CANREAL PIC S9(0004) COMP.
  1429     05  CANREAF PIC  X(0001).
  1430     05  FILLER REDEFINES CANREAF.
  1431         10  CANREAA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  29
* EL1278.cbl
  1432     05  CANREAI PIC  X(0001).
  1433*    -------------------------------
  1434     05  CLPYNHL PIC S9(0004) COMP.
  1435     05  CLPYNHF PIC  X(0001).
  1436     05  FILLER REDEFINES CLPYNHF.
  1437         10  CLPYNHA PIC  X(0001).
  1438     05  CLPYNHI PIC  X(0005).
  1439*    -------------------------------
  1440     05  CLPYNL PIC S9(0004) COMP.
  1441     05  CLPYNF PIC  X(0001).
  1442     05  FILLER REDEFINES CLPYNF.
  1443         10  CLPYNA PIC  X(0001).
  1444     05  CLPYNI PIC  X(0001).
  1445*    -------------------------------
  1446     05  HLREDL PIC S9(0004) COMP.
  1447     05  HLREDF PIC  X(0001).
  1448     05  FILLER REDEFINES HLREDF.
  1449         10  HLREDA PIC  X(0001).
  1450     05  HLREDI PIC  X(0014).
  1451*    -------------------------------
  1452     05  FREMTRML PIC S9(0004) COMP.
  1453     05  FREMTRMF PIC  X(0001).
  1454     05  FILLER REDEFINES FREMTRMF.
  1455         10  FREMTRMA PIC  X(0001).
  1456     05  FREMTRMI PIC  X(0003).
  1457*    -------------------------------
  1458     05  HERMSG1L PIC S9(0004) COMP.
  1459     05  HERMSG1F PIC  X(0001).
  1460     05  FILLER REDEFINES HERMSG1F.
  1461         10  HERMSG1A PIC  X(0001).
  1462     05  HERMSG1I PIC  X(0079).
  1463*    -------------------------------
  1464     05  HERMSG2L PIC S9(0004) COMP.
  1465     05  HERMSG2F PIC  X(0001).
  1466     05  FILLER REDEFINES HERMSG2F.
  1467         10  HERMSG2A PIC  X(0001).
  1468     05  HERMSG2I PIC  X(0079).
  1469*    -------------------------------
  1470     05  HPFKEYL PIC S9(0004) COMP.
  1471     05  HPFKEYF PIC  X(0001).
  1472     05  FILLER REDEFINES HPFKEYF.
  1473         10  HPFKEYA PIC  X(0001).
  1474     05  HPFKEYI PIC  99.
  1475*    -------------------------------
  1476     05  PFKEY11L PIC S9(0004) COMP.
  1477     05  PFKEY11F PIC  X(0001).
  1478     05  FILLER REDEFINES PFKEY11F.
  1479         10  PFKEY11A PIC  X(0001).
  1480     05  PFKEY11I PIC  X(0021).
  1481 01  EL127HO REDEFINES EL127HI.
  1482     05  FILLER            PIC  X(0012).
  1483*    -------------------------------
  1484     05  FILLER            PIC  X(0003).
  1485     05  HDATEO PIC  X(0008).
  1486*    -------------------------------
  1487     05  FILLER            PIC  X(0003).
  1488     05  HTIMEO PIC  99.99.
  1489*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  30
* EL1278.cbl
  1490     05  FILLER            PIC  X(0003).
  1491     05  CMPNYIDO PIC  X(0003).
  1492*    -------------------------------
  1493     05  FILLER            PIC  X(0003).
  1494     05  USERIDO PIC  X(0004).
  1495*    -------------------------------
  1496     05  FILLER            PIC  X(0003).
  1497     05  HCARIERO PIC  X(0001).
  1498*    -------------------------------
  1499     05  FILLER            PIC  X(0003).
  1500     05  HGROUPO PIC  X(0006).
  1501*    -------------------------------
  1502     05  FILLER            PIC  X(0003).
  1503     05  HSTATEO PIC  X(0002).
  1504*    -------------------------------
  1505     05  FILLER            PIC  X(0003).
  1506     05  HACCTNOO PIC  X(0010).
  1507*    -------------------------------
  1508     05  FILLER            PIC  X(0003).
  1509     05  HEFFDTO PIC  X(0008).
  1510*    -------------------------------
  1511     05  FILLER            PIC  X(0003).
  1512     05  HCERTNOO PIC  X(0010).
  1513*    -------------------------------
  1514     05  FILLER            PIC  X(0003).
  1515     05  HCRTSFXO PIC  X(0001).
  1516*    -------------------------------
  1517     05  FILLER            PIC  X(0003).
  1518     05  HLNAMEO PIC  X(0015).
  1519*    -------------------------------
  1520     05  FILLER            PIC  X(0003).
  1521     05  HFNAMEO PIC  X(0010).
  1522*    -------------------------------
  1523     05  FILLER            PIC  X(0003).
  1524     05  HINITO PIC  X(0001).
  1525*    -------------------------------
  1526     05  FILLER            PIC  X(0003).
  1527     05  LCLMDTHO PIC  X(0022).
  1528*    -------------------------------
  1529     05  FILLER            PIC  X(0003).
  1530     05  LCLMDTO PIC  X(0008).
  1531*    -------------------------------
  1532     05  FILLER            PIC  X(0003).
  1533     05  HPCYNO PIC  X(0001).
  1534*    -------------------------------
  1535     05  FILLER            PIC  X(0003).
  1536     05  ACLMDTHO PIC  X(0023).
  1537*    -------------------------------
  1538     05  FILLER            PIC  X(0003).
  1539     05  ACLMDTO PIC  X(0008).
  1540*    -------------------------------
  1541     05  FILLER            PIC  X(0003).
  1542     05  PMTHDO PIC  X(0010).
  1543*    -------------------------------
  1544     05  FILLER            PIC  X(0003).
  1545     05  CNCDTHDO PIC  X(0007).
  1546*    -------------------------------
  1547     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  31
* EL1278.cbl
  1548     05  HLKINDO PIC  X(0002).
  1549*    -------------------------------
  1550     05  FILLER            PIC  X(0003).
  1551     05  HLCDO PIC  X(0002).
  1552*    -------------------------------
  1553     05  FILLER            PIC  X(0003).
  1554     05  HLEDESCO PIC  X(0003).
  1555*    -------------------------------
  1556     05  FILLER            PIC  X(0003).
  1557     05  HLTERMO PIC  ZZ9.
  1558*    -------------------------------
  1559     05  FILLER            PIC  X(0003).
  1560     05  HLREMO PIC  ZZ9.
  1561*    -------------------------------
  1562     05  FILLER            PIC  X(0003).
  1563     05  HLPREMO PIC  ZZZZ,ZZ9.99.
  1564*    -------------------------------
  1565     05  FILLER            PIC  X(0003).
  1566     05  HLITDRO PIC  ZZZZ,ZZ9.99.
  1567*    -------------------------------
  1568     05  FILLER            PIC  X(0003).
  1569     05  HLREFNDO PIC  ZZZZ,ZZ9.99.
  1570*    -------------------------------
  1571     05  FILLER            PIC  X(0003).
  1572     05  HLCANCO PIC  X(0008).
  1573*    -------------------------------
  1574     05  FILLER            PIC  X(0003).
  1575     05  HLCAL1O PIC  X(0001).
  1576*    -------------------------------
  1577     05  FILLER            PIC  X(0003).
  1578     05  HLCALCO PIC  X(0012).
  1579*    -------------------------------
  1580     05  FILLER            PIC  X(0003).
  1581     05  HAKINDO PIC  X(0002).
  1582*    -------------------------------
  1583     05  FILLER            PIC  X(0003).
  1584     05  HACDO PIC  X(0002).
  1585*    -------------------------------
  1586     05  FILLER            PIC  X(0003).
  1587     05  HAEDESCO PIC  X(0003).
  1588*    -------------------------------
  1589     05  FILLER            PIC  X(0003).
  1590     05  HATERMO PIC  ZZ9.
  1591*    -------------------------------
  1592     05  FILLER            PIC  X(0003).
  1593     05  HAREMO PIC  ZZ9.
  1594*    -------------------------------
  1595     05  FILLER            PIC  X(0003).
  1596     05  HAPREMO PIC  ZZZZ,ZZ9.99.
  1597*    -------------------------------
  1598     05  FILLER            PIC  X(0003).
  1599     05  HAITDRO PIC  ZZZZ,ZZ9.99.
  1600*    -------------------------------
  1601     05  FILLER            PIC  X(0003).
  1602     05  HAREFNDO PIC  ZZZZ,ZZ9.99.
  1603*    -------------------------------
  1604     05  FILLER            PIC  X(0003).
  1605     05  HACANCO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  32
* EL1278.cbl
  1606*    -------------------------------
  1607     05  FILLER            PIC  X(0003).
  1608     05  HACAL1O PIC  X(0001).
  1609*    -------------------------------
  1610     05  FILLER            PIC  X(0003).
  1611     05  HACALCO PIC  X(0012).
  1612*    -------------------------------
  1613     05  FILLER            PIC  X(0003).
  1614     05  TOPREMO PIC  ZZZZ,ZZ9.99.
  1615*    -------------------------------
  1616     05  FILLER            PIC  X(0003).
  1617     05  TOITDRO PIC  ZZZZ,ZZ9.99.
  1618*    -------------------------------
  1619     05  FILLER            PIC  X(0003).
  1620     05  TORFNDO PIC  ZZZZ,ZZ9.99.
  1621*    -------------------------------
  1622     05  FILLER            PIC  X(0003).
  1623     05  CANREAHO PIC  X(0015).
  1624*    -------------------------------
  1625     05  FILLER            PIC  X(0003).
  1626     05  CANREAO PIC  X(0001).
  1627*    -------------------------------
  1628     05  FILLER            PIC  X(0003).
  1629     05  CLPYNHO PIC  X(0005).
  1630*    -------------------------------
  1631     05  FILLER            PIC  X(0003).
  1632     05  CLPYNO PIC  X(0001).
  1633*    -------------------------------
  1634     05  FILLER            PIC  X(0003).
  1635     05  HLREDO PIC  ZZZ,ZZZ,ZZ9.99.
  1636*    -------------------------------
  1637     05  FILLER            PIC  X(0003).
  1638     05  FREMTRMO PIC  ZZ9.
  1639*    -------------------------------
  1640     05  FILLER            PIC  X(0003).
  1641     05  HERMSG1O PIC  X(0079).
  1642*    -------------------------------
  1643     05  FILLER            PIC  X(0003).
  1644     05  HERMSG2O PIC  X(0079).
  1645*    -------------------------------
  1646     05  FILLER            PIC  X(0003).
  1647     05  HPFKEYO PIC  99.
  1648*    -------------------------------
  1649     05  FILLER            PIC  X(0003).
  1650     05  PFKEY11O PIC  X(0021).
  1651*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  33
* EL1278.cbl
  1653*                            COPY ELCCALC.
  1654******************************************************************
  1655*                                                                *
  1656*                           ELCCALC.                            *
  1657*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1658*                            VMOD=2.025                          *
  1659*                                                                *
  1660*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1661*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1662*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1663*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1664*                                                                *
  1665*  PASSED TO ELRTRM                                              *
  1666*  -----------------                                             *
  1667*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1668*  ORIGINAL TERM                                                 *
  1669*  BEGINNING DATE                                                *
  1670*  ENDING DATE                                                   *
  1671*  COMPANY I.D.                                                  *
  1672*  ACCOUNT MASTER USER FIELD                                     *
  1673*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1674*  FREE LOOK DAYS                                                *
  1675*                                                                *
  1676*  RETURNED FROM ELRTRM                                          *
  1677*  ---------------------                                         *
  1678*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1679*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1680*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1681*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1682*----------------------------------------------------------------*
  1683*  PASSED TO ELRAMT                                              *
  1684*  ----------------                                              *
  1685*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1686*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1687*  ORIGINAL AMOUNT                                               *
  1688*  ALTERNATE BENEFIT (BALLON)                                    *
  1689*  A.P.R. - NET PAY ONLY                                         *
  1690*  METHOD
  1691*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1692*  COMPANY I.D.                                                  *
  1693*  BENEFIT TYPE                                                  *
  1694*                                                                *
  1695*  RETURNED FROM ELRAMT                                          *
  1696*  --------------------                                          *
  1697*  REMAINING AMOUNT 1 - CURRENT                                  *
  1698*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1699*  REMAINING AMOUNT FACTOR
  1700*----------------------------------------------------------------*
  1701*  PASSED TO ELRESV                                              *
  1702*  -----------------                                             *
  1703*  CERTIFICATE EFFECTIVE DATE                                    *
  1704*  VALUATION DATE                                                *
  1705*  PAID THRU DATE                                                *
  1706*  BENEFIT                                                       *
  1707*  INCURRED DATE                                                 *
  1708*  REPORTED DATE                                                 *
  1709*  ISSUE AGE                                                     *
  1710*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  34
* EL1278.cbl
  1711*  CDT PERCENT                                                   *
  1712*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1713* *CLAIM TYPE (LIFE, A/H)                                        *
  1714* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1715* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1716*                                                                *
  1717*  RETURNED FROM ELRESV                                          *
  1718*  --------------------                                          *
  1719*  CDT TABLE USED                                                *
  1720*  CDT FACTOR USED                                               *
  1721*  PAY TO CURRENT RESERVE                                        *
  1722*  I.B.N.R. - A/H ONLY                                           *
  1723*  FUTURE (ACCRUED) AH ONLY                                      *
  1724*----------------------------------------------------------------*
  1725*  PASSED TO ELRATE                                              *
  1726*  ----------------                                              *
  1727*  CERT ISSUE DATE                                               *
  1728*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1729*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1730*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1731*  STATE CODE (CLIENT DEFINED)                                   *
  1732*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1733*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1734*  DEVIATION CODE                                                *
  1735*  ISSUE AGE                                                     *
  1736*  ORIGINAL BENEFIT AMOUNT                                       *
  1737*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1738*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1739*  BENEFIT KIND (LIFE OR A/H)                                    *
  1740*  A.P.R.                                                        *
  1741*  METHOD
  1742*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1743*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1744*  COMPANY I.D. (3 CHARACTER)                                    *
  1745*  BENEFIT CODE                                                  *
  1746*  BENEFIT OVERRIDE CODE                                         *
  1747*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1748*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1749*  JOINT INDICATOR (CSL ONLY)                                    *
  1750*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1751*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1752*                                                                *
  1753*  RETURNED FROM ELRATE                                          *
  1754*  --------------------                                          *
  1755*  CALCULATED PREMIUM                                            *
  1756*  PREMIUM RATE                                                  *
  1757*  MORTALITY CODE                                                *
  1758*  MAX ATTAINED AGE                                              *
  1759*  MAX AGE                                                       *
  1760*  MAX TERM                                                      *
  1761*  MAX MONTHLY BENEFIT                                           *
  1762*  MAX TOTAL BENIFIT                                             *
  1763*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1764*----------------------------------------------------------------*
  1765*  PASSED TO ELRFND                                              *
  1766*  ----------------                                              *
  1767*  CERT ISSUE DATE                                               *
  1768*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  35
* EL1278.cbl
  1769*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1770*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1771*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1772*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1773*  STATE CODE (CLIENT DEFINED)                                   *
  1774*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1775*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1776*  DEVIATION CODE                                                *
  1777*  ISSUE AGE                                                     *
  1778*  ORIGINAL BENEFIT AMOUNT                                       *
  1779*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1780*  PROCESS TYPE (CANCEL)                                         *
  1781*  BENEFIT KIND (LIFE OR A/H)                                    *
  1782*  A.P.R.                                                        *
  1783*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1784*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1785*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1786*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1787*  COMPANY I.D. (3 CHARACTER)                                    *
  1788*  BENEFIT CODE                                                  *
  1789*  BENEFIT OVERRIDE CODE                                         *
  1790*                                                                *
  1791*  RETURNED FROM ELRFND                                          *
  1792*  --------------------                                          *
  1793*  CALCULATED REFUND                                             *
  1794*----------------------------------------------------------------*
  1795*  PASSED TO ELEARN                                              *
  1796*  ----------------                                              *
  1797*  CERT ISSUE DATE                                               *
  1798*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1799*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1800*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1801*  STATE CODE (CLIENT DEFINED)                                   *
  1802*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1803*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1804*  DEVIATION CODE                                                *
  1805*  ISSUE AGE                                                     *
  1806*  ORIGINAL BENEFIT AMOUNT                                       *
  1807*  BENEFIT KIND (LIFE OR A/H)                                    *
  1808*  A.P.R.                                                        *
  1809*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1810*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1811*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1812*  COMPANY I.D. (3 CHARACTER)                                    *
  1813*  BENEFIT CODE                                                  *
  1814*  BENEFIT OVERRIDE CODE                                         *
  1815*                                                                *
  1816*  RETURNED FROM ELEARN                                          *
  1817*  --------------------                                          *
  1818*  INDICATED  EARNINGS                                           *
  1819*----------------------------------------------------------------*
  1820*                 LENGTH = 450                                   *
  1821*                                                                *
  1822******************************************************************
  1823******************************************************************
  1824*                   C H A N G E   L O G
  1825*
  1826* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  36
* EL1278.cbl
  1827*-----------------------------------------------------------------
  1828*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1829* EFFECTIVE    NUMBER
  1830*-----------------------------------------------------------------
  1831* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1832* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1833* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1834* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1835* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1836* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1837* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1838* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1839* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1840******************************************************************
  1841
  1842 01  CALCULATION-PASS-AREA.
  1843     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1844                                     COMP.
  1845
  1846     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1847       88  NO-CP-ERROR                             VALUE ZERO.
  1848       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1849                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1850       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1851       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1852       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1853       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1854       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1855       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1856       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1857       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1858       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1859       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1860       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1861       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1862       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1863       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1864       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1865       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1866       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1867
  1868     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1869       88  NO-CP-ERROR-2                           VALUE ZERO.
  1870***********************  INPUT AREAS ****************************
  1871
  1872     12  CP-CALCULATION-AREA.
  1873         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1874         16  CP-CERT-EFF-DT        PIC XX.
  1875         16  CP-VALUATION-DT       PIC XX.
  1876         16  CP-PAID-THRU-DT       PIC XX.
  1877         16  CP-BENEFIT-TYPE       PIC X.
  1878           88  CP-AH                               VALUE 'A' 'D'
  1879                                                   'I' 'U'.
  1880           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1881           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1882         16  CP-INCURRED-DT        PIC XX.
  1883         16  CP-REPORTED-DT        PIC XX.
  1884         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  37
* EL1278.cbl
  1885         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1886         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1887                                     COMP-3.
  1888         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1889                                     COMP-3.
  1890         16  CP-CDT-METHOD         PIC X.
  1891           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1892           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1893           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1894         16  CP-CLAIM-TYPE         PIC X.
  1895           88  CP-AH-CLAIM                         VALUE 'A'.
  1896           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1897         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1898                                     COMP-3.
  1899         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1900                                     COMP-3.
  1901         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1902                                     COMP-3.
  1903         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1904                                     COMP-3.
  1905         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1906                                     COMP-3.
  1907         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1908                                     COMP-3.
  1909         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1910                                     COMP-3.
  1911         16  CP-REM-TERM-METHOD    PIC X.
  1912           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1913           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1914           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1915           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1916           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1917           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1918           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1919         16  CP-EARNING-METHOD     PIC X.
  1920           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1921           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1922           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1923           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1924           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1925           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1926           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1927           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1928           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1929           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1930           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1931           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1932           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1933           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1934         16  CP-PROCESS-TYPE       PIC X.
  1935           88  CP-CLAIM                            VALUE '1'.
  1936           88  CP-CANCEL                           VALUE '2'.
  1937           88  CP-ISSUE                            VALUE '3'.
  1938         16  CP-SPECIAL-CALC-CD    PIC X.
  1939           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1940           88  CP-1-MTH-INTEREST               VALUE ' '.
  1941           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1942           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  38
* EL1278.cbl
  1943           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1944           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1945           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1946           88  CP-FARM-PLAN                    VALUE 'F'.
  1947           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1948           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1949           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1950           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1951           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1952           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1953           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1954           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1955           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1956           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1957                                                     'W' 'X'.
  1958           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1959           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1960           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1961           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1962           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1963           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1964           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1965           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1966           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1967           88  CP-CSL-METH-1                   VALUE '5'.
  1968           88  CP-CSL-METH-2                   VALUE '6'.
  1969           88  CP-CSL-METH-3                   VALUE '7'.
  1970           88  CP-CSL-METH-4                   VALUE '8'.
  1971
  1972         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1973                                     COMP-3.
  1974         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1975         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1976         16  CP-STATE              PIC XX          VALUE SPACE.
  1977         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1978         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1979           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1980               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1981         16  CP-R78-OPTION         PIC X.
  1982           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1983           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1984
  1985         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1986         16  CP-IBNR-RESERVE-SW    PIC X.
  1987         16  CP-CLAIM-STATUS       PIC X.
  1988         16  CP-RATE-FILE          PIC X.
  1989         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1990                                     COMP-3.
  1991
  1992         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1993         16  CP-AH-OVERRIDE-CODE   PIC X.
  1994
  1995         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1996                                     COMP-3.
  1997         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1998                                   PIC S9(5)V99 COMP-3.
  1999         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2000                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  39
* EL1278.cbl
  2001         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2002                                     COMP-3.
  2003         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2004                                     COMP-3.
  2005         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2006                                  PIC S9(7)V99 COMP-3.
  2007
  2008         16  CP-PAID-FROM-DATE     PIC X(02).
  2009         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2010         16  CP-EXT-DAYS-CALC      PIC X.
  2011           88  CP-EXT-NO-CHG                   VALUE ' '.
  2012           88  CP-EXT-CHG-LF                   VALUE '1'.
  2013           88  CP-EXT-CHG-AH                   VALUE '2'.
  2014           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2015         16  CP-DOMICILE-STATE     PIC XX.
  2016         16  CP-CARRIER            PIC X.
  2017         16  CP-REIN-FLAG          PIC X.
  2018         16  CP-REM-TRM-CALC-OPTION PIC X.
  2019           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2020                      '2' '3' '4' '5'.
  2021           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2022           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2023           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2024           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2025           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2026           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2027           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2028           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2029         16  CP-SIG-SWITCH         PIC X.
  2030         16  CP-RATING-METHOD      PIC X.
  2031           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2032           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2033           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2034           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2035           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2036           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2037           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2038           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2039           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2040         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2041                                     COMP-3.
  2042         16  CP-BEN-CATEGORY       PIC X.
  2043         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2044         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2045                                   PIC S99V9(5) COMP-3.
  2046         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2047         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2048                                   PIC S99V9(5) COMP-3.
  2049         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2050         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2051         16  CP-EXPIRE-DT          PIC XX.
  2052         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2053         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2054         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2055         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2056         16  CP-DDF-SPEC-CALC      PIC X.
  2057             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2058             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  40
* EL1278.cbl
  2059         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2060         16  CP-CANCEL-REASON      PIC X.
  2061         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2062         16  CP-PMT-MODE           PIC X.
  2063         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2064         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2065         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2066         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2067         16  FILLER                PIC X.
  2068
  2069***************    OUTPUT FROM ELRESV   ************************
  2070
  2071         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2072
  2073         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2074                                     COMP-3.
  2075         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2076                                     COMP-3.
  2077         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2078                                     COMP-3.
  2079         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2080                                     COMP-3.
  2081         16  FILLER                PIC X(09).
  2082***************    OUTPUT FROM ELRTRM   *************************
  2083
  2084         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2085                                     COMP-3.
  2086         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2087                                     COMP-3.
  2088         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2089                                     COMP-3.
  2090         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2091                                     COMP-3.
  2092         16  FILLER                PIC X(12).
  2093
  2094***************    OUTPUT FROM ELRAMT   *************************
  2095
  2096         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2097                                     COMP-3.
  2098         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2099                                     COMP-3.
  2100         16  FILLER                PIC X(12).
  2101
  2102***************    OUTPUT FROM ELRATE   *************************
  2103
  2104         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2105                                     COMP-3.
  2106         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2107                                     COMP-3.
  2108         16  CP-MORTALITY-CODE     PIC X(4).
  2109         16  CP-RATE-EDIT-FLAG     PIC X.
  2110             88  CP-RATES-NEED-APR                  VALUE '1'.
  2111         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2112                                     COMP-3.
  2113         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2114         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2115         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2116                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  41
* EL1278.cbl
  2117         16  FILLER                PIC X(07).
  2118
  2119***************    OUTPUT FROM ELRFND   *************************
  2120
  2121         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2122                                     COMP-3.
  2123         16  CP-REFUND-TYPE-USED   PIC X.
  2124           88  CP-R-AS-R78                         VALUE '1'.
  2125           88  CP-R-AS-PRORATA                     VALUE '2'.
  2126           88  CP-R-AS-CALIF                       VALUE '3'.
  2127           88  CP-R-AS-TEXAS                       VALUE '4'.
  2128           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2129           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2130           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2131           88  CP-R-AS-MEAN                        VALUE '8'.
  2132           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2133           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2134           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2135           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2136           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2137           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2138         16  FILLER                PIC X(12).
  2139
  2140***************    OUTPUT FROM ELEARN   *************************
  2141
  2142         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2143                                     COMP-3.
  2144         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2145                                     COMP-3.
  2146         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2147                                     COMP-3.
  2148         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2149                                     COMP-3.
  2150         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2151                                     COMP-3.
  2152         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2153                                     COMP-3.
  2154         16  CP-EARNING-TYPE-USED  PIC X.
  2155           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2156           88  CP-E-AS-R78                         VALUE '1'.
  2157           88  CP-E-AS-PRORATA                     VALUE '2'.
  2158           88  CP-E-AS-TEXAS                       VALUE '4'.
  2159           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2160           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2161           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2162           88  CP-E-AS-MEAN                        VALUE '8'.
  2163           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2164         16  FILLER                PIC X(12).
  2165
  2166***************    OUTPUT FROM ELPMNT   *************************
  2167
  2168         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2169                                     COMP-3.
  2170         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2171                                     COMP-3.
  2172         16  FILLER                PIC X(12).
  2173
  2174***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  42
* EL1278.cbl
  2175         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2176                                     COMP-3.
  2177         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2178                                     COMP-3.
  2179         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2180                                     COMP-3.
  2181         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2182                                     COMP-3.
  2183         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2184                                     COMP-3.
  2185         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2186                                     COMP-3.
  2187         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2188             88  OPEN-RATE-FILE                   VALUE 'O'.
  2189             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2190             88  IO-ERROR                         VALUE 'E'.
  2191
  2192         16  CP-FIRST-PAY-DATE     PIC XX.
  2193
  2194         16  CP-JOINT-INDICATOR    PIC X.
  2195
  2196         16  CP-RESERVE-REMAINING-TERM
  2197                                   PIC S9(4)V9    VALUE ZERO
  2198                                     COMP-3.
  2199
  2200         16  CP-INSURED-BIRTH-DT   PIC XX.
  2201
  2202         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2203                                     COMP-3.
  2204
  2205         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2206                                     COMP-3.
  2207
  2208         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2209                                     COMP-3.
  2210
  2211         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2212                                     COMP-3.
  2213
  2214         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2215                                     COMP-3.
  2216
  2217         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2218                                     COMP-3.
  2219
  2220         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2221                                     COMP-3.
  2222
  2223         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2224             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2225
  2226         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2227                                     COMP-3.
  2228         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2229                                     COMP-3.
  2230         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2231         16  FILLER                PIC X(15).
  2232******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  43
* EL1278.cbl
  2234*                            COPY ERCNOTE.
  2235******************************************************************
  2236*                                                                *
  2237*                                                                *
  2238*                            ERCNOTE                             *
  2239*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2240*                            VMOD=2.003                          *
  2241*                                                                *
  2242*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  2243*                                                                *
  2244*        FILE TYPE= VSAM,KSDS                                    *
  2245*        RECORD SIZE = 825    RECFORM = FIXED                    *
  2246*                                                                *
  2247*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  2248*                                                                *
  2249*        LOG = YES                                               *
  2250*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2251*                                                                *
  2252******************************************************************
  2253*                   C H A N G E   L O G
  2254*
  2255* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2256*-----------------------------------------------------------------
  2257*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2258* EFFECTIVE    NUMBER
  2259*-----------------------------------------------------------------
  2260* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  2261*                                FILE WILL CONTAIN BILLING NOTES O
  2262******************************************************************
  2263
  2264 01  CERTIFICATE-NOTE.
  2265     12  CN-RECORD-ID                PIC  XX.
  2266         88  VALID-CN-ID                  VALUE 'CN'.
  2267
  2268     12  CN-CONTROL-PRIMARY.
  2269         16  CN-COMPANY-CD           PIC X.
  2270         16  CN-CARRIER              PIC X.
  2271         16  CN-GROUPING.
  2272             20 CN-GROUPING-PREFIX   PIC XXX.
  2273             20 CN-GROUPING-PRIME    PIC XXX.
  2274         16  CN-STATE                PIC XX.
  2275         16  CN-ACCOUNT.
  2276             20 CN-ACCOUNT-PREFIX    PIC X(4).
  2277             20 CN-ACCOUNT-PRIME     PIC X(6).
  2278         16  CN-CERT-EFF-DT          PIC XX.
  2279         16  CN-CERT-NO.
  2280             20  CN-CERT-PRIME       PIC X(10).
  2281             20  CN-CERT-SFX         PIC X.
  2282
  2283     12  CN-BILLING-START-LINE-NO    PIC 99.
  2284     12  CN-BILLING-END-LINE-NO      PIC 99.
  2285
  2286     12  CN-LINES.
  2287         16  CN-LINE OCCURS 10       PIC X(77).
  2288
  2289     12  CN-LAST-MAINT-DT            PIC XX.
  2290     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2291     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  44
* EL1278.cbl
  2292     12  FILLER                      PIC X(6).
  2293******************************************************************
  2294*                            COPY ERCCTBL.
  2295******************************************************************
  2296*                                                                *
  2297*                                                                *
  2298*                            ERCCTBL                             *
  2299*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2300*                            VMOD=2.003
  2301*                                                                *
  2302*   ONLINE CREDIT SYSTEM                                         *
  2303*                                                                *
  2304*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  2305*                                                                *
  2306*   FILE TYPE = VSAM,KSDS                                        *
  2307*   RECORD SIZE = 200   RECFORM = FIXED                          *
  2308*                                                                *
  2309*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  2310*       ALTERNATE PATH = NONE                                    *
  2311*                                                                *
  2312*   LOG = NO                                                     *
  2313*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2314*                                                                *
  2315*                                                                *
  2316******************************************************************
  2317
  2318 01  COMM-TABLE-RECORD.
  2319     12  CT-RECORD-ID                      PIC XX.
  2320         88  VALID-CT-ID                      VALUE 'CT'.
  2321
  2322     12  CT-CONTROL-PRIMARY.
  2323         16  CT-COMPANY-CD                 PIC X.
  2324         16  CT-TABLE                      PIC XXX.
  2325         16  CT-CNTRL-2.
  2326             20  CT-BEN-TYPE               PIC X.
  2327             20  CT-BEN-CODE               PIC XX.
  2328
  2329     12  CT-MAINT-INFORMATION.
  2330         16  CT-LAST-MAINT-DT              PIC XX.
  2331         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2332         16  CT-LAST-MAINT-USER            PIC X(4).
  2333         16  FILLER                        PIC X(31).
  2334
  2335     12  CT-LIMITS.
  2336         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  2337
  2338         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  2339
  2340         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  2341
  2342     12  CT-RATES.
  2343         16  CT-RTX          OCCURS 27 TIMES.
  2344             20  CT-RT                     PIC SV9(5)     COMP-3.
  2345             20  CT-RT-R   REDEFINES
  2346                 CT-RT                     PIC XXX.
  2347
  2348     12  FILLER                            PIC  X(42).
  2349
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  45
* EL1278.cbl
  2350******************************************************************
  2351
  2352****************************************************************
  2353*
  2354* Copyright (c) 2007 by Clerity Solutions, Inc.
  2355* All rights reserved.
  2356*
  2357****************************************************************
  2358 01  DFHEIV.
  2359   02  DFHEIV0               PIC X(35).
  2360   02  DFHEIV1               PIC X(08).
  2361   02  DFHEIV2               PIC X(08).
  2362   02  DFHEIV3               PIC X(08).
  2363   02  DFHEIV4               PIC X(06).
  2364   02  DFHEIV5               PIC X(04).
  2365   02  DFHEIV6               PIC X(04).
  2366   02  DFHEIV7               PIC X(02).
  2367   02  DFHEIV8               PIC X(02).
  2368   02  DFHEIV9               PIC X(01).
  2369   02  DFHEIV10              PIC S9(7) COMP-3.
  2370   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2371   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2372   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2373   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2374   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2375   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2376   02  DFHEIV17              PIC X(04).
  2377   02  DFHEIV18              PIC X(04).
  2378   02  DFHEIV19              PIC X(04).
  2379   02  DFHEIV20              USAGE IS POINTER.
  2380   02  DFHEIV21              USAGE IS POINTER.
  2381   02  DFHEIV22              USAGE IS POINTER.
  2382   02  DFHEIV23              USAGE IS POINTER.
  2383   02  DFHEIV24              USAGE IS POINTER.
  2384   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2385   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2386   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2387   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2388   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2389   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2390   02  FILLER                PIC X(02).
  2391   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2392   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2393   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2394   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2395   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2396 LINKAGE  SECTION.
  2397*****************************************************************
  2398*                                                               *
  2399* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2400* All rights reserved.                                          *
  2401*                                                               *
  2402*****************************************************************
  2403 01  dfheiblk.
  2404     02  eibtime          pic s9(7) comp-3.
  2405     02  eibdate          pic s9(7) comp-3.
  2406     02  eibtrnid         pic x(4).
  2407     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  46
* EL1278.cbl
  2408     02  eibtrmid         pic x(4).
  2409     02  dfheigdi         pic s9(4) comp.
  2410     02  eibcposn         pic s9(4) comp.
  2411     02  eibcalen         pic s9(4) comp.
  2412     02  eibaid           pic x(1).
  2413     02  eibfiller1       pic x(1).
  2414     02  eibfn            pic x(2).
  2415     02  eibfiller2       pic x(2).
  2416     02  eibrcode         pic x(6).
  2417     02  eibfiller3       pic x(2).
  2418     02  eibds            pic x(8).
  2419     02  eibreqid         pic x(8).
  2420     02  eibrsrce         pic x(8).
  2421     02  eibsync          pic x(1).
  2422     02  eibfree          pic x(1).
  2423     02  eibrecv          pic x(1).
  2424     02  eibsend          pic x(1).
  2425     02  eibatt           pic x(1).
  2426     02  eibeoc           pic x(1).
  2427     02  eibfmh           pic x(1).
  2428     02  eibcompl         pic x(1).
  2429     02  eibsig           pic x(1).
  2430     02  eibconf          pic x(1).
  2431     02  eiberr           pic x(1).
  2432     02  eibrldbk         pic x(1).
  2433     02  eiberrcd         pic x(4).
  2434     02  eibsynrb         pic x(1).
  2435     02  eibnodat         pic x(1).
  2436     02  eibfiller5       pic x(2).
  2437     02  eibresp          pic 9(09) comp.
  2438     02  eibresp2         pic 9(09) comp.
  2439     02  dfheigdj         pic s9(4) comp.
  2440     02  dfheigdk         pic s9(4) comp.
  2441
  2442 01  DFHCOMMAREA                 PIC  X(1024).
  2443
  2444*01 PARMLIST .
  2445*    12  FILLER                  PIC S9(08)      COMP.
  2446*    12  ELCNTL-POINTER          PIC S9(08)      COMP.
  2447*    12  ELACCT-POINTER          PIC S9(08)      COMP.
  2448*    12  ELCERT-POINTER          PIC S9(08)      COMP.
  2449*                            COPY ELCCNTL.
  2450******************************************************************
  2451*                                                                *
  2452*                                                                *
  2453*                            ELCCNTL.                            *
  2454*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2455*                            VMOD=2.059                          *
  2456*                                                                *
  2457*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2458*                                                                *
  2459*   FILE TYPE = VSAM,KSDS                                        *
  2460*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2461*                                                                *
  2462*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2463*       ALTERNATE INDEX = NONE                                   *
  2464*                                                                *
  2465*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  47
* EL1278.cbl
  2466*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2467******************************************************************
  2468*                   C H A N G E   L O G
  2469*
  2470* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2471*-----------------------------------------------------------------
  2472*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2473* EFFECTIVE    NUMBER
  2474*-----------------------------------------------------------------
  2475* 082503                   PEMA  ADD BENEFIT GROUP
  2476* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2477* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2478* 092705    2005050300006  PEMA  ADD SPP LEASES
  2479* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2480* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2481* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2482* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2483* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2484******************************************************************
  2485*
  2486 01  CONTROL-FILE.
  2487     12  CF-RECORD-ID                       PIC XX.
  2488         88  VALID-CF-ID                        VALUE 'CF'.
  2489
  2490     12  CF-CONTROL-PRIMARY.
  2491         16  CF-COMPANY-ID                  PIC XXX.
  2492         16  CF-RECORD-TYPE                 PIC X.
  2493             88  CF-COMPANY-MASTER              VALUE '1'.
  2494             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2495             88  CF-STATE-MASTER                VALUE '3'.
  2496             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2497             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2498             88  CF-CARRIER-MASTER              VALUE '6'.
  2499             88  CF-MORTALITY-MASTER            VALUE '7'.
  2500             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2501             88  CF-TERMINAL-MASTER             VALUE '9'.
  2502             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2503             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2504             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2505             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2506             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2507             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2508             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2509             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2510             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2511         16  CF-ACCESS-CD-GENL              PIC X(4).
  2512         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2513             20  CF-PROCESSOR               PIC X(4).
  2514         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2515             20  CF-STATE-CODE              PIC XX.
  2516             20  FILLER                     PIC XX.
  2517         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2518             20  FILLER                     PIC XX.
  2519             20  CF-HI-BEN-IN-REC           PIC XX.
  2520         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2521             20  FILLER                     PIC XXX.
  2522             20  CF-CARRIER-CNTL            PIC X.
  2523         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  48
* EL1278.cbl
  2524             20  FILLER                     PIC XX.
  2525             20  CF-HI-TYPE-IN-REC          PIC 99.
  2526         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2527             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2528                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2529             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2530             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2531         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2532             20  FILLER                     PIC X.
  2533             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2534         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2535             20  FILLER                     PIC XX.
  2536             20  CF-MORTGAGE-PLAN           PIC XX.
  2537         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2538
  2539     12  CF-LAST-MAINT-DT                   PIC XX.
  2540     12  CF-LAST-MAINT-BY                   PIC X(4).
  2541     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2542
  2543     12  CF-RECORD-BODY                     PIC X(728).
  2544
  2545
  2546****************************************************************
  2547*             COMPANY MASTER RECORD                            *
  2548****************************************************************
  2549
  2550     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2551         16  CF-COMPANY-ADDRESS.
  2552             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2553             20  CF-CL-IN-CARE-OF           PIC X(30).
  2554             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2555             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2556             20  CF-CL-CITY-STATE           PIC X(30).
  2557             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2558             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2559         16  CF-COMPANY-CD                  PIC X.
  2560         16  CF-COMPANY-PASSWORD            PIC X(8).
  2561         16  CF-SECURITY-OPTION             PIC X.
  2562             88  ALL-SECURITY                   VALUE '1'.
  2563             88  COMPANY-VERIFY                 VALUE '2'.
  2564             88  PROCESSOR-VERIFY               VALUE '3'.
  2565             88  NO-SECURITY                    VALUE '4'.
  2566             88  ALL-BUT-TERM                   VALUE '5'.
  2567         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2568             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2569         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2570             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2571         16  CF-INFORCE-LOCATION            PIC X.
  2572             88  CERTS-ARE-ONLINE               VALUE '1'.
  2573             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2574             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2575         16  CF-LOWER-CASE-LETTERS          PIC X.
  2576         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2577             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2578             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2579             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2580             88  CF-ACCNT-CNTL                  VALUE '3'.
  2581             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  49
* EL1278.cbl
  2582
  2583         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2584         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2585
  2586         16  CF-LGX-CREDIT-USER             PIC X.
  2587             88  CO-IS-NOT-USER                 VALUE 'N'.
  2588             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2589
  2590         16 CF-CREDIT-CALC-CODES.
  2591             20  CF-CR-REM-TERM-CALC PIC X.
  2592               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2593               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2594               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2595               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2596               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2597               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2598               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2599             20  CF-CR-R78-METHOD           PIC X.
  2600               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2601               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2602
  2603         16  CF-CLAIM-CONTROL-COUNTS.
  2604             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2605                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2606
  2607             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2608                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2609
  2610             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2611                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2612
  2613             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2614                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2615
  2616         16  CF-CURRENT-MONTH-END           PIC XX.
  2617
  2618         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2619             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2620             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2621             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2622             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2623                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2624                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2625             20  CF-CO-PREM-REJECT-SW       PIC X.
  2626                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2627                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2628             20  CF-CO-REF-REJECT-SW        PIC X.
  2629                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2630                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2631
  2632         16  CF-CO-REPORTING-DT             PIC XX.
  2633         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2634         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2635           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2636           88  CF-CO-MONTH-END                  VALUE '1'.
  2637
  2638         16  CF-LGX-CLAIM-USER              PIC X.
  2639             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  50
* EL1278.cbl
  2640             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2641
  2642         16  CF-CREDIT-EDIT-CONTROLS.
  2643             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2644             20  CF-MIN-AGE                 PIC 99.
  2645             20  CF-DEFAULT-AGE             PIC 99.
  2646             20  CF-MIN-TERM                PIC S999      COMP-3.
  2647             20  CF-MAX-TERM                PIC S999      COMP-3.
  2648             20  CF-DEFAULT-SEX             PIC X.
  2649             20  CF-JOINT-AGE-INPUT         PIC X.
  2650                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2651             20  CF-BIRTH-DATE-INPUT        PIC X.
  2652                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2653             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2654                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2655                 88  CF-ZERO-CARRIER            VALUE '1'.
  2656                 88  CF-ZERO-GROUPING           VALUE '2'.
  2657                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2658             20  CF-EDIT-SW                 PIC X.
  2659                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2660             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2661             20  CF-CR-PR-METHOD            PIC X.
  2662               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2663               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2664             20  FILLER                     PIC X.
  2665
  2666         16  CF-CREDIT-MISC-CONTROLS.
  2667             20  CF-REIN-TABLE-SW           PIC X.
  2668                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2669             20  CF-COMP-TABLE-SW           PIC X.
  2670                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2671             20  CF-EXPERIENCE-RETENTION-AGE
  2672                                            PIC S9        COMP-3.
  2673             20  CF-CONVERSION-DT           PIC XX.
  2674             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2675             20  CF-RUN-FREQUENCY-SW        PIC X.
  2676                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2677                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2678
  2679             20  CF-CR-CHECK-NO-CONTROL.
  2680                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2681                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2682                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2683                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2684                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2685                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2686
  2687                 24  CF-CR-CHECK-COUNT       REDEFINES
  2688                     CF-CR-CHECK-COUNTER      PIC X(4).
  2689
  2690                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2691                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2692
  2693                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2694                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2695                 24  CF-MAIL-PROCESSING       PIC X.
  2696                     88  MAIL-PROCESSING          VALUE 'Y'.
  2697
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  51
* EL1278.cbl
  2698         16  CF-MISC-SYSTEM-CONTROL.
  2699             20  CF-SYSTEM-C                 PIC X.
  2700                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2701             20  CF-SYSTEM-D                 PIC X.
  2702                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2703             20  CF-SOC-SEC-NO-SW            PIC X.
  2704                 88  SOC-SEC-NO-USED             VALUE '1'.
  2705             20  CF-MEMBER-NO-SW             PIC X.
  2706                 88  MEMBER-NO-USED              VALUE '1'.
  2707             20  CF-TAX-ID-NUMBER            PIC X(11).
  2708             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2709             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2710                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2711                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2712                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2713                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2714             20  CF-SYSTEM-E                 PIC X.
  2715                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2716
  2717         16  CF-LGX-LIFE-USER               PIC X.
  2718             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2719             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2720
  2721         16  CF-CR-MONTH-END-DT             PIC XX.
  2722
  2723         16  CF-FILE-MAINT-DATES.
  2724             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2725                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2726             20  CF-LAST-BATCH       REDEFINES
  2727                 CF-LAST-BATCH-NO               PIC X(4).
  2728             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2729             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2730             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2731             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2732             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2733             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2734             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2735             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2736             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2737             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2738
  2739         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2740         16  FILLER                         PIC X.
  2741
  2742         16  CF-ALT-MORT-CODE               PIC X(4).
  2743         16  CF-MEMBER-CAPTION              PIC X(10).
  2744
  2745         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2746             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2747             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2748             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2749             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2750             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2751
  2752         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2753
  2754         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2755         16  CF-LIFE-OVERRIDE-L2            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  52
* EL1278.cbl
  2756         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2757         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2758
  2759         16  CF-AH-OVERRIDE-L1              PIC X.
  2760         16  CF-AH-OVERRIDE-L2              PIC XX.
  2761         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2762         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2763
  2764         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2765         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2766
  2767         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2768         16  CF-AR-LAST-EL860-DT            PIC XX.
  2769         16  CF-MP-MONTH-END-DT             PIC XX.
  2770
  2771         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2772         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2773             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2774
  2775         16  CF-AR-MONTH-END-DT             PIC XX.
  2776
  2777         16  CF-CRDTCRD-USER                PIC X.
  2778             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2779             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2780
  2781         16  CF-CC-MONTH-END-DT             PIC XX.
  2782
  2783         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2784
  2785         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2786             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2787             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2788             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2789         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2790         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2791         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2792         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2793             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2794             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2795         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2796         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2797         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2798             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2799         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2800
  2801         16  CF-CL-ZIP-CODE.
  2802             20  CF-CL-ZIP-PRIME.
  2803                 24  CF-CL-ZIP-1ST          PIC X.
  2804                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2805                 24  FILLER                 PIC X(4).
  2806             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2807         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2808             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2809             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2810             20  FILLER                     PIC XXX.
  2811
  2812         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2813         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  53
* EL1278.cbl
  2814         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2815         16  CF-CO-OPTION-START-DATE        PIC XX.
  2816         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2817           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2818                                                      '3' '4'.
  2819           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2820           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2821           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2822           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2823           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2824           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2825
  2826         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2827
  2828         16  CF-PAYMENT-APPROVAL-LEVELS.
  2829             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2830             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2831             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2832             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2833             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2834             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2835
  2836         16  CF-END-USER-REPORTING-USER     PIC X.
  2837             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2838             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2839
  2840         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2841             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2842             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2843
  2844         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2845
  2846         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2847         16  FILLER                         PIC X.
  2848
  2849         16  CF-CREDIT-ARCHIVE-CNTL.
  2850             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2851             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2852             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2853
  2854         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2855
  2856         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2857             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2858             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2859
  2860         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2861             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2862             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2863
  2864         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2865
  2866         16  CF-CO-ACH-ID-CODE              PIC  X.
  2867             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2868             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2869             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2870         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2871         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  54
* EL1278.cbl
  2872         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2873         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2874         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2875         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2876         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2877         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2878         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2879                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2880         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2881                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2882
  2883         16  CF-CO-OVER-SHORT.
  2884             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2885             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2886
  2887*         16  FILLER                         PIC X(102).
  2888         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2889             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2890             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2891
  2892         16  CF-AH-APPROVAL-DAYS.
  2893             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2894             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2895             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2896             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2897
  2898         16  FILLER                         PIC X(82).
  2899****************************************************************
  2900*             PROCESSOR/USER RECORD                            *
  2901****************************************************************
  2902
  2903     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2904         16  CF-PROCESSOR-NAME              PIC X(30).
  2905         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2906         16  CF-PROCESSOR-TITLE             PIC X(26).
  2907         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2908                 88  MESSAGE-YES                VALUE 'Y'.
  2909                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2910
  2911*****************************************************
  2912****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2913****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2914****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2915****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2916*****************************************************
  2917
  2918         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2919             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2920             20  CF-APPLICATION-FORCE       PIC X.
  2921             20  CF-INDIVIDUAL-APP.
  2922                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2923                     28  CF-BROWSE-APP      PIC X.
  2924                     28  CF-UPDATE-APP      PIC X.
  2925
  2926         16  CF-CURRENT-TERM-ON             PIC X(4).
  2927         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2928             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2929             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  55
* EL1278.cbl
  2930             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2931             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2932             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2933             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2934             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2935         16  CF-PROCESSOR-CARRIER           PIC X.
  2936             88  NO-CARRIER-SECURITY            VALUE ' '.
  2937         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2938             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2939         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2940             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2941         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2942             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2943
  2944         16  CF-PROC-SYS-ACCESS-SW.
  2945             20  CF-PROC-CREDIT-CLAIMS-SW.
  2946                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2947                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2948                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2949                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2950             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2951                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2952                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2953             20  CF-PROC-LIFE-GNRLDGR-SW.
  2954                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2955                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2956                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2957                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2958             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2959                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2960                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2961         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2962             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2963             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2964         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2965
  2966         16  CF-APPROVAL-LEVEL                  PIC X.
  2967             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2968             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2969             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2970             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2971
  2972         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2973
  2974         16  CF-LANGUAGE-TYPE                   PIC X.
  2975             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2976             88  CF-LANG-IS-FR                      VALUE 'F'.
  2977         16  FILLER                             PIC  X(240).
  2978
  2979****************************************************************
  2980*             PROCESSOR/REMINDERS RECORD                       *
  2981****************************************************************
  2982
  2983     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2984         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2985             20  CF-START-REMIND-DT         PIC XX.
  2986             20  CF-END-REMIND-DT           PIC XX.
  2987             20  CF-REMINDER-TEXT           PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  56
* EL1278.cbl
  2988         16  FILLER                         PIC X(296).
  2989
  2990
  2991****************************************************************
  2992*             STATE MASTER RECORD                              *
  2993****************************************************************
  2994
  2995     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2996         16  CF-STATE-ABBREVIATION          PIC XX.
  2997         16  CF-STATE-NAME                  PIC X(25).
  2998         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2999         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3000             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3001             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3002             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3003             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3004                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3005                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3006             20  CF-ST-PREM-REJECT-SW       PIC X.
  3007                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3008                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3009             20  CF-ST-REF-REJECT-SW        PIC X.
  3010                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3011                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3012         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3013         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3014         16  CF-ST-REFUND-RULES.
  3015             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3016             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3017             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3018         16  CF-ST-FST-PMT-EXTENSION.
  3019             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3020             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3021                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3022                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3023                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3024                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3025         16  CF-ST-STATE-CALL.
  3026             20  CF-ST-CALL-UNEARNED        PIC X.
  3027             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3028             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3029         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3030             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3031             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3032         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3033         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3034         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3035         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3036         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3037         16  FILLER                         PIC X.
  3038         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3039             20  CF-ST-BENEFIT-CD           PIC XX.
  3040             20  CF-ST-BENEFIT-KIND         PIC X.
  3041                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3042                 88  CF-ST-AH-KIND              VALUE 'A'.
  3043             20  CF-ST-REM-TERM-CALC        PIC X.
  3044                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3045                 88  ST-EARN-AFTER-15TH         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  57
* EL1278.cbl
  3046                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3047                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3048                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3049                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3050                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3051                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3052
  3053             20  CF-ST-REFUND-CALC          PIC X.
  3054                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3055                 88  ST-REFD-BY-R78             VALUE '1'.
  3056                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3057                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3058                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3059                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3060                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3061                 88  ST-REFD-UTAH               VALUE '7'.
  3062                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3063                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3064                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3065
  3066             20  CF-ST-EARNING-CALC         PIC X.
  3067                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3068                 88  ST-EARN-BY-R78             VALUE '1'.
  3069                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3070                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3071                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3072                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3073                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3074                 88  ST-EARN-MEAN               VALUE '8'.
  3075                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3076
  3077             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3078                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3079                 88  ST-OVRD-BY-R78             VALUE '1'.
  3080                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3081                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3082                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3083                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3084                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3085                 88  ST-OVRD-MEAN               VALUE '8'.
  3086                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3087             20  FILLER                     PIC X.
  3088
  3089         16  CF-ST-COMMISSION-CAPS.
  3090             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3091             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3092             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3093             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3094         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3095                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3096
  3097         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3098
  3099         16  CF-ST-STATUTORY-INTEREST.
  3100             20  CF-ST-STAT-DATE-FROM       PIC X.
  3101                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3102                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3103             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  58
* EL1278.cbl
  3104             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3105             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3106             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3107             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3108
  3109         16  CF-ST-OVER-SHORT.
  3110             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3111             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3112
  3113         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3114
  3115         16  CF-ST-RT-CALC                  PIC X.
  3116
  3117         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3118         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3119         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3120         16  CF-ST-RF-LR-CALC               PIC X.
  3121         16  CF-ST-RF-LL-CALC               PIC X.
  3122         16  CF-ST-RF-LN-CALC               PIC X.
  3123         16  CF-ST-RF-AH-CALC               PIC X.
  3124         16  CF-ST-RF-CP-CALC               PIC X.
  3125*        16  FILLER                         PIC X(206).
  3126*CIDMOD         16  FILLER                         PIC X(192).
  3127         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3128             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3129         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3130         16  CF-ST-VFY-2ND-BENE             PIC X.
  3131         16  FILLER                         PIC X(186).
  3132
  3133****************************************************************
  3134*             BENEFIT MASTER RECORD                            *
  3135****************************************************************
  3136
  3137     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3138         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3139             20  CF-BENEFIT-CODE            PIC XX.
  3140             20  CF-BENEFIT-NUMERIC  REDEFINES
  3141                 CF-BENEFIT-CODE            PIC XX.
  3142             20  CF-BENEFIT-ALPHA           PIC XXX.
  3143             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3144             20  CF-BENEFIT-COMMENT         PIC X(10).
  3145
  3146             20  CF-LF-COVERAGE-TYPE        PIC X.
  3147                 88  CF-REDUCING                VALUE 'R'.
  3148                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3149
  3150             20  CF-SPECIAL-CALC-CD         PIC X.
  3151                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3152                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3153                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3154                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3155                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3156                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3157                 88  CF-FARM-PLAN               VALUE 'F'.
  3158                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3159                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3160                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3161                 88  CF-4-MTH-INTEREST          VALUE 'K'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  59
* EL1278.cbl
  3162                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3163                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3164                 88  CF-PRUDENTIAL              VALUE 'P'.
  3165                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3166                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3167                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3168                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3169                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3170                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3171
  3172             20  CF-JOINT-INDICATOR         PIC X.
  3173                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3174
  3175*            20  FILLER                     PIC X(12).
  3176             20  FILLER                     PIC X(11).
  3177             20  CF-BENEFIT-CATEGORY        PIC X.
  3178             20  CF-LOAN-TYPE               PIC X(8).
  3179
  3180             20  CF-CO-REM-TERM-CALC        PIC X.
  3181                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3182                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3183                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3184                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3185                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3186
  3187             20  CF-CO-EARNINGS-CALC        PIC X.
  3188                 88  CO-EARN-BY-R78             VALUE '1'.
  3189                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3190                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3191                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3192                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3193                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3194                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3195                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3196
  3197             20  CF-CO-REFUND-CALC          PIC X.
  3198                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3199                 88  CO-REFD-BY-R78             VALUE '1'.
  3200                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3201                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3202                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3203                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3204                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3205                 88  CO-REFD-MEAN               VALUE '8'.
  3206                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3207                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3208                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3209
  3210             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3211                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3212                 88  CO-OVRD-BY-R78             VALUE '1'.
  3213                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3214                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3215                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3216                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3217                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3218                 88  CO-OVRD-MEAN               VALUE '8'.
  3219                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  60
* EL1278.cbl
  3220
  3221             20  CF-CO-BEN-I-G-CD           PIC X.
  3222                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3223                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3224                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3225
  3226         16  FILLER                         PIC X(304).
  3227
  3228
  3229****************************************************************
  3230*             CARRIER MASTER RECORD                            *
  3231****************************************************************
  3232
  3233     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3234         16  CF-ADDRESS-DATA.
  3235             20  CF-MAIL-TO-NAME            PIC X(30).
  3236             20  CF-IN-CARE-OF              PIC X(30).
  3237             20  CF-ADDRESS-LINE-1          PIC X(30).
  3238             20  CF-ADDRESS-LINE-2          PIC X(30).
  3239             20  CF-CITY-STATE              PIC X(30).
  3240             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3241             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3242
  3243         16  CF-CLAIM-NO-CONTROL.
  3244             20  CF-CLAIM-NO-METHOD         PIC X.
  3245                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3246                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3247                 88  CLAIM-NO-SEQ               VALUE '3'.
  3248                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3249             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3250                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3251                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3252                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3253
  3254         16  CF-CHECK-NO-CONTROL.
  3255             20  CF-CHECK-NO-METHOD         PIC X.
  3256                 88  CHECK-NO-MANUAL            VALUE '1'.
  3257                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3258                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3259                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3260             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3261                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3262
  3263         16  CF-DOMICILE-STATE              PIC XX.
  3264
  3265         16  CF-EXPENSE-CONTROLS.
  3266             20  CF-EXPENSE-METHOD          PIC X.
  3267                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3268                 88  DOLLARS-PER-PMT            VALUE '2'.
  3269                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3270                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3271             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3272             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3273
  3274         16  CF-CORRESPONDENCE-CONTROL.
  3275             20  CF-LETTER-RESEND-OPT       PIC X.
  3276                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3277                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  61
* EL1278.cbl
  3278             20  FILLER                     PIC X(4).
  3279
  3280         16  CF-RESERVE-CONTROLS.
  3281             20  CF-MANUAL-SW               PIC X.
  3282                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3283             20  CF-FUTURE-SW               PIC X.
  3284                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3285             20  CF-PTC-SW                  PIC X.
  3286                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3287             20  CF-IBNR-SW                 PIC X.
  3288                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3289             20  CF-PTC-LF-SW               PIC X.
  3290                 88  CF-LF-PTC-USED             VALUE '1'.
  3291             20  CF-CDT-ACCESS-METHOD       PIC X.
  3292                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3293                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3294                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3295             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3296
  3297         16  CF-CLAIM-CALC-METHOD           PIC X.
  3298             88  360-PLUS-MONTHS                VALUE '1'.
  3299             88  365-PLUS-MONTHS                VALUE '2'.
  3300             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3301             88  360-DAILY                      VALUE '4'.
  3302             88  365-DAILY                      VALUE '5'.
  3303
  3304         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3305         16  FILLER                         PIC X(11).
  3306
  3307         16  CF-LIMIT-AMOUNTS.
  3308             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3309             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3310             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3311             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3312             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3313             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3314             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3315             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3316             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3317             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3318
  3319         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3320         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3321         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3322
  3323         16  CF-ZIP-CODE.
  3324             20  CF-ZIP-PRIME.
  3325                 24  CF-ZIP-1ST             PIC X.
  3326                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3327                 24  FILLER                 PIC X(4).
  3328             20  CF-ZIP-PLUS4               PIC X(4).
  3329         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3330             20  CF-CAN-POSTAL-1            PIC XXX.
  3331             20  CF-CAN-POSTAL-2            PIC XXX.
  3332             20  FILLER                     PIC XXX.
  3333
  3334         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3335         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  62
* EL1278.cbl
  3336         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3337
  3338         16  CF-RATING-SWITCH               PIC X.
  3339             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3340             88  CF-NO-RATING                   VALUE 'N'.
  3341
  3342         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3343
  3344         16  CF-CARRIER-OVER-SHORT.
  3345             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3346             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3347
  3348         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3349         16  CF-SECPAY-SWITCH               PIC X.
  3350             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3351             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3352         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3353         16  FILLER                         PIC X(448).
  3354*        16  FILLER                         PIC X(452).
  3355
  3356
  3357****************************************************************
  3358*             MORTALITY MASTER RECORD                          *
  3359****************************************************************
  3360
  3361     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3362         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3363                                INDEXED BY CF-MORT-NDX.
  3364             20  CF-MORT-TABLE              PIC X(5).
  3365             20  CF-MORT-TABLE-TYPE         PIC X.
  3366                 88  CF-MORT-JOINT              VALUE 'J'.
  3367                 88  CF-MORT-SINGLE             VALUE 'S'.
  3368                 88  CF-MORT-COMBINED           VALUE 'C'.
  3369                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3370                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3371             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3372             20  CF-MORT-AGE-METHOD         PIC XX.
  3373                 88  CF-AGE-LAST                VALUE 'AL'.
  3374                 88  CF-AGE-NEAR                VALUE 'AN'.
  3375             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3376             20  CF-MORT-ADJUSTMENT-DIRECTION
  3377                                            PIC X.
  3378                 88  CF-MINUS                   VALUE '-'.
  3379                 88  CF-PLUS                    VALUE '+'.
  3380             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3381             20  CF-MORT-JOINT-CODE         PIC X.
  3382                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3383             20  CF-MORT-PC-Q               PIC X.
  3384                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3385             20  CF-MORT-TABLE-CODE         PIC X(4).
  3386             20  CF-MORT-COMMENTS           PIC X(15).
  3387             20  FILLER                     PIC X(14).
  3388
  3389         16  FILLER                         PIC X(251).
  3390
  3391
  3392****************************************************************
  3393*             BUSSINESS TYPE MASTER RECORD                     *
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  63
* EL1278.cbl
  3394****************************************************************
  3395
  3396     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3397* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3398* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3399* AND RECORD 05 IS TYPES 81-99
  3400         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3401             20  CF-BUSINESS-TITLE          PIC  X(19).
  3402             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3403                                            PIC S9V9(4) COMP-3.
  3404             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3405             20  FILLER                     PIC  X.
  3406         16  FILLER                         PIC  X(248).
  3407
  3408
  3409****************************************************************
  3410*             TERMINAL MASTER RECORD                           *
  3411****************************************************************
  3412
  3413     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3414
  3415         16  CF-COMPANY-TERMINALS.
  3416             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3417                                  PIC X(4).
  3418         16  FILLER               PIC X(248).
  3419
  3420
  3421****************************************************************
  3422*             LIFE EDIT MASTER RECORD                          *
  3423****************************************************************
  3424
  3425     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3426         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3427             20  CF-LIFE-CODE-IN            PIC XX.
  3428             20  CF-LIFE-CODE-OUT           PIC XX.
  3429         16  FILLER                         PIC X(248).
  3430
  3431
  3432****************************************************************
  3433*             AH EDIT MASTER RECORD                            *
  3434****************************************************************
  3435
  3436     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3437         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3438             20  CF-AH-CODE-IN              PIC XXX.
  3439             20  CF-AH-CODE-OUT             PIC XX.
  3440         16  FILLER                         PIC X(248).
  3441
  3442
  3443****************************************************************
  3444*             CREDIBILITY TABLES                               *
  3445****************************************************************
  3446
  3447     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3448         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3449                             INDEXED BY CF-CRDB-NDX.
  3450             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3451             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  64
* EL1278.cbl
  3452             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3453         16  FILLER                         PIC  X(332).
  3454
  3455
  3456****************************************************************
  3457*             REPORT CUSTOMIZATION RECORD                      *
  3458****************************************************************
  3459
  3460     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3461         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3462             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3463             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3464             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3465**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3466****       A T-TRANSFER.                                   ****
  3467             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3468
  3469         16  FILLER                         PIC XX.
  3470
  3471         16  CF-CARRIER-CNTL-OPT.
  3472             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3473                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3474                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3475             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3476                                            PIC X.
  3477         16  CF-GROUP-CNTL-OPT.
  3478             20  CF-GROUP-OPT-SEQ           PIC 9.
  3479                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3480                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3481             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3482                                            PIC X(6).
  3483         16  CF-STATE-CNTL-OPT.
  3484             20  CF-STATE-OPT-SEQ           PIC 9.
  3485                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3486                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3487             20  CF-STATE-SELECT OCCURS 3 TIMES
  3488                                            PIC XX.
  3489         16  CF-ACCOUNT-CNTL-OPT.
  3490             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3491                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3492                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3493             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3494                                            PIC X(10).
  3495         16  CF-BUS-TYP-CNTL-OPT.
  3496             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3497                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3498                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3499             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3500                                            PIC XX.
  3501         16  CF-LF-TYP-CNTL-OPT.
  3502             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3503                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3504                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3505             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3506                                            PIC XX.
  3507         16  CF-AH-TYP-CNTL-OPT.
  3508             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3509                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  65
* EL1278.cbl
  3510                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3511             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3512                                            PIC XX.
  3513         16  CF-REPTCD1-CNTL-OPT.
  3514             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3515                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3516                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3517             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3518                                            PIC X(10).
  3519         16  CF-REPTCD2-CNTL-OPT.
  3520             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3521                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3522                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3523             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3524                                            PIC X(10).
  3525         16  CF-USER1-CNTL-OPT.
  3526             20  CF-USER1-OPT-SEQ           PIC 9.
  3527                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3528                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3529             20  CF-USER1-SELECT OCCURS 3 TIMES
  3530                                            PIC X(10).
  3531         16  CF-USER2-CNTL-OPT.
  3532             20  CF-USER2-OPT-SEQ           PIC 9.
  3533                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3534                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3535             20  CF-USER2-SELECT OCCURS 3 TIMES
  3536                                            PIC X(10).
  3537         16  CF-USER3-CNTL-OPT.
  3538             20  CF-USER3-OPT-SEQ           PIC 9.
  3539                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3540                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3541             20  CF-USER3-SELECT OCCURS 3 TIMES
  3542                                            PIC X(10).
  3543         16  CF-USER4-CNTL-OPT.
  3544             20  CF-USER4-OPT-SEQ           PIC 9.
  3545                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3546                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3547             20  CF-USER4-SELECT OCCURS 3 TIMES
  3548                                            PIC X(10).
  3549         16  CF-USER5-CNTL-OPT.
  3550             20  CF-USER5-OPT-SEQ           PIC 9.
  3551                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3552                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3553             20  CF-USER5-SELECT OCCURS 3 TIMES
  3554                                            PIC X(10).
  3555         16  CF-REINS-CNTL-OPT.
  3556             20  CF-REINS-OPT-SEQ           PIC 9.
  3557                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3558                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3559             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3560                 24  CF-REINS-PRIME         PIC XXX.
  3561                 24  CF-REINS-SUB           PIC XXX.
  3562
  3563         16  CF-AGENT-CNTL-OPT.
  3564             20  CF-AGENT-OPT-SEQ           PIC 9.
  3565                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3566                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3567             20  CF-AGENT-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  66
* EL1278.cbl
  3568                                            PIC X(10).
  3569
  3570         16  FILLER                         PIC X(43).
  3571
  3572         16  CF-LOSS-RATIO-SELECT.
  3573             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3574             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3575         16  CF-ENTRY-DATE-SELECT.
  3576             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3577             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3578         16  CF-EFFECTIVE-DATE-SELECT.
  3579             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3580             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3581
  3582         16  CF-EXCEPTION-LIST-IND          PIC X.
  3583             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3584
  3585         16  FILLER                         PIC X(318).
  3586
  3587****************************************************************
  3588*                  EXCEPTION REPORTING RECORD                  *
  3589****************************************************************
  3590
  3591     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3592         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3593             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3594
  3595         16  CF-COMBINED-LIFE-AH-OPT.
  3596             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3597             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3598             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3599             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3600
  3601         16  CF-LIFE-OPT.
  3602             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3603             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3604             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3605             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3606             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3607             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3608             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3609             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3610             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3611             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3612
  3613         16  CF-AH-OPT.
  3614             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3615             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3616             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3617             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3618             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3619             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3620             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3621             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3622             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3623             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3624
  3625         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  67
* EL1278.cbl
  3626             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3627             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3628             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3629
  3630         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3631
  3632         16  FILLER                         PIC X(673).
  3633
  3634
  3635****************************************************************
  3636*             MORTGAGE SYSTEM PLAN RECORD                      *
  3637****************************************************************
  3638
  3639     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3640         16  CF-PLAN-TYPE                   PIC X.
  3641             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3642             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3643             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3644         16  CF-PLAN-ABBREV                 PIC XXX.
  3645         16  CF-PLAN-DESCRIPT               PIC X(10).
  3646         16  CF-PLAN-NOTES                  PIC X(20).
  3647         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3648         16  CF-PLAN-UNDERWRITING.
  3649             20  CF-PLAN-TERM-DATA.
  3650                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3651                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3652             20  CF-PLAN-AGE-DATA.
  3653                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3654                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3655                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3656             20  CF-PLAN-BENEFIT-DATA.
  3657                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3658                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3659                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3660                                            PIC S9(7)V99  COMP-3.
  3661         16  CF-PLAN-POLICY-FORMS.
  3662             20  CF-POLICY-FORM             PIC X(12).
  3663             20  CF-MASTER-APPLICATION      PIC X(12).
  3664             20  CF-MASTER-POLICY           PIC X(12).
  3665         16  CF-PLAN-RATING.
  3666             20  CF-RATE-CODE               PIC X(5).
  3667             20  CF-SEX-RATING              PIC X.
  3668                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3669                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3670             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3671             20  CF-SUB-STD-TYPE            PIC X.
  3672                 88  CF-PCT-OF-PREM            VALUE '1'.
  3673                 88  CF-PCT-OF-BENE            VALUE '2'.
  3674         16  CF-PLAN-PREM-TOLERANCES.
  3675             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3676             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3677         16  CF-PLAN-PYMT-TOLERANCES.
  3678             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3679             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3680         16  CF-PLAN-MISC-DATA.
  3681             20  FILLER                     PIC X.
  3682             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3683             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  68
* EL1278.cbl
  3684         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3685         16  CF-PLAN-IND-GRP                PIC X.
  3686             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3687                                                     '1'.
  3688             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3689                                                     '2'.
  3690         16  CF-MIB-SEARCH-SW               PIC X.
  3691             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3692             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3693             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3694             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3695         16  CF-ALPHA-SEARCH-SW             PIC X.
  3696             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3697             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3698             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3699             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3700             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3701             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3702             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3703             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3704             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3705             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3706                                                     'A' 'B' 'C'
  3707                                                     'X' 'Y' 'Z'.
  3708         16  CF-EFF-DT-RULE-SW              PIC X.
  3709             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3710             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3711             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3712             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3713             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3714         16  FILLER                         PIC X(4).
  3715         16  CF-HEALTH-QUESTIONS            PIC X.
  3716             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3717         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3718         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3719         16  CF-PLAN-SNGL-JNT               PIC X.
  3720             88  CF-COMBINED-PLAN              VALUE 'C'.
  3721             88  CF-JNT-PLAN                   VALUE 'J'.
  3722             88  CF-SNGL-PLAN                  VALUE 'S'.
  3723         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3724         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3725         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3726         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3727         16  CF-RERATE-CNTL                 PIC  X.
  3728             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3729             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3730             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3731             88  CF-AUTO-RECALC                 VALUE '4'.
  3732         16  CF-BENEFIT-TYPE                PIC  X.
  3733             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3734             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3735         16  CF-POLICY-FEE                  PIC S999V99
  3736                                                    COMP-3.
  3737         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3738         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3739         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3740         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3741         16  FILLER                         PIC  X(32).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  69
* EL1278.cbl
  3742         16  CF-TERMINATION-FORM            PIC  X(04).
  3743         16  FILLER                         PIC  X(08).
  3744         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3745                                                       COMP-3.
  3746         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3747         16  CF-ISSUE-LETTER                PIC  X(4).
  3748         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3749         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3750             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3751             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3752         16  CF-MP-REFUND-CALC              PIC X.
  3753             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3754             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3755             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3756             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3757             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3758             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3759             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3760             88  CF-MP-REFD-MEAN                VALUE '8'.
  3761         16  CF-ALT-RATE-CODE               PIC  X(5).
  3762
  3763
  3764         16  FILLER                         PIC X(498).
  3765****************************************************************
  3766*             MORTGAGE COMPANY MASTER RECORD                   *
  3767****************************************************************
  3768
  3769     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3770         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3771         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3772             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3773             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3774             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3775             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3776             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3777
  3778         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3779         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3780         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3781         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3782         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3783
  3784         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3785             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3786         16  CF-MP-RECON-USE-IND            PIC X(1).
  3787             88  CF-MP-USE-RECON             VALUE 'Y'.
  3788         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3789             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3790         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3791             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3792             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3793         16  FILLER                         PIC X(1).
  3794         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3795             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3796         16  CF-MORTG-MIB-VERSION           PIC X.
  3797             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3798             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3799             88  CF-MORTG-MIB-BOTH          VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  70
* EL1278.cbl
  3800         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3801             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3802                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3803             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3804                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3805             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3806                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3807             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3808                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3809             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3810                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3811             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3812                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3813         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3814         16  FILLER                         PIC X(7).
  3815         16  CF-MORTG-DESTINATION-SYMBOL.
  3816             20  CF-MORTG-MIB-COMM          PIC X(5).
  3817             20  CF-MORTG-MIB-TERM          PIC X(5).
  3818         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3819             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3820         16  FILLER                         PIC X(03).
  3821         16  CF-MP-CHECK-NO-CONTROL.
  3822             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3823                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3824                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3825                                                ' ' LOW-VALUES.
  3826                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3827                                               VALUE '3'.
  3828         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3829         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3830         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3831             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3832                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3833             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3834                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3835             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3836                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3837             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3838                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3839             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3840                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3841             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3842                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3843         16  CF-MORTG-BILLING-AREA.
  3844             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3845                                            PIC X.
  3846         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3847         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3848         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3849         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3850             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3851             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3852         16  FILLER                         PIC X.
  3853         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3854             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3855             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3856         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3857         16  FILLER                         PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  71
* EL1278.cbl
  3858         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3859         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3860         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3861         16  CF-ACH-COMPANY-ID.
  3862             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3863                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3864                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3865                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3866             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3867         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3868             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3869         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3870             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3871             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3872         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3873         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3874         16  FILLER                         PIC X(536).
  3875
  3876****************************************************************
  3877*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3878****************************************************************
  3879
  3880     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3881         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3882             20  CF-FEMALE-HEIGHT.
  3883                 24  CF-FEMALE-FT           PIC 99.
  3884                 24  CF-FEMALE-IN           PIC 99.
  3885             20  CF-FEMALE-MIN-WT           PIC 999.
  3886             20  CF-FEMALE-MAX-WT           PIC 999.
  3887         16  FILLER                         PIC X(428).
  3888
  3889     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3890         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3891             20  CF-MALE-HEIGHT.
  3892                 24  CF-MALE-FT             PIC 99.
  3893                 24  CF-MALE-IN             PIC 99.
  3894             20  CF-MALE-MIN-WT             PIC 999.
  3895             20  CF-MALE-MAX-WT             PIC 999.
  3896         16  FILLER                         PIC X(428).
  3897******************************************************************
  3898*             AUTOMATIC ACTIVITY RECORD                          *
  3899******************************************************************
  3900     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3901         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3902             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3903             20  CF-SYS-LETTER-ID           PIC X(04).
  3904             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3905             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3906             20  CF-SYS-RESET-SW            PIC X(01).
  3907             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3908             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3909
  3910         16  FILLER                         PIC X(50).
  3911
  3912         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3913             20  CF-USER-ACTIVE-SW          PIC X(01).
  3914             20  CF-USER-LETTER-ID          PIC X(04).
  3915             20  CF-USER-RESEND-DAYS        PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  72
* EL1278.cbl
  3916             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3917             20  CF-USER-RESET-SW           PIC X(01).
  3918             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3919             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3920             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3921
  3922         16  FILLER                         PIC X(246).
  3923*                            COPY ERCACCT.
  3924******************************************************************
  3925*                                                                *
  3926*                                                                *
  3927*                            ERCACCT                             *
  3928*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3929*                            VMOD=2.031                          *
  3930*                                                                *
  3931*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3932*                                                                *
  3933*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3934*   VSAM ACCOUNT MASTER FILES.                                   *
  3935*                                                                *
  3936*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3937*                                                                *
  3938*   FILE TYPE = VSAM,KSDS                                        *
  3939*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3940*                                                                *
  3941*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3942*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3943*                                                                *
  3944*   LOG = NO                                                     *
  3945*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3946*                                                                *
  3947*                                                                *
  3948******************************************************************
  3949*                   C H A N G E   L O G
  3950*
  3951* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3952*-----------------------------------------------------------------
  3953*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3954* EFFECTIVE    NUMBER
  3955*-----------------------------------------------------------------
  3956* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3957* 092705    2005050300006  PEMA  ADD SPP LEASES
  3958* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3959* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3960* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3961* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3962* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3963******************************************************************
  3964
  3965 01  ACCOUNT-MASTER.
  3966     12  AM-RECORD-ID                      PIC XX.
  3967         88  VALID-AM-ID                      VALUE 'AM'.
  3968
  3969     12  AM-CONTROL-PRIMARY.
  3970         16  AM-COMPANY-CD                 PIC X.
  3971         16  AM-MSTR-CNTRL.
  3972             20  AM-CONTROL-A.
  3973                 24  AM-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  73
* EL1278.cbl
  3974                 24  AM-GROUPING.
  3975                     28 AM-GROUPING-PREFIX PIC XXX.
  3976                     28 AM-GROUPING-PRIME  PIC XXX.
  3977                 24  AM-STATE              PIC XX.
  3978                 24  AM-ACCOUNT.
  3979                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3980                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3981             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3982                                           PIC X(19).
  3983             20  AM-CNTRL-B.
  3984                 24  AM-EXPIRATION-DT      PIC XX.
  3985                 24  FILLER                PIC X(4).
  3986             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3987                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3988
  3989     12  AM-CONTROL-BY-VAR-GRP.
  3990         16  AM-COMPANY-CD-A1              PIC X.
  3991         16  AM-VG-CARRIER                 PIC X.
  3992         16  AM-VG-GROUPING                PIC X(6).
  3993         16  AM-VG-STATE                   PIC XX.
  3994         16  AM-VG-ACCOUNT                 PIC X(10).
  3995         16  AM-VG-DATE.
  3996             20  AM-VG-EXPIRATION-DT       PIC XX.
  3997             20  FILLER                    PIC X(4).
  3998         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3999                                           PIC 9(11)      COMP-3.
  4000     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4001         16  FILLER                        PIC X(10).
  4002         16  AM-VG-KEY3.
  4003             20  AM-VG3-ACCOUNT            PIC X(10).
  4004             20  AM-VG3-EXP-DT             PIC XX.
  4005         16  FILLER                        PIC X(4).
  4006     12  AM-MAINT-INFORMATION.
  4007         16  AM-LAST-MAINT-DT              PIC XX.
  4008         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4009         16  AM-LAST-MAINT-USER            PIC X(4).
  4010         16  FILLER                        PIC XX.
  4011
  4012     12  AM-EFFECTIVE-DT                   PIC XX.
  4013     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4014
  4015     12  AM-PREV-DATES  COMP-3.
  4016         16  AM-PREV-EXP-DT                PIC 9(11).
  4017         16  AM-PREV-EFF-DT                PIC 9(11).
  4018
  4019     12  AM-REPORT-CODE-1                  PIC X(10).
  4020     12  AM-REPORT-CODE-2                  PIC X(10).
  4021
  4022     12  AM-CITY-CODE                      PIC X(4).
  4023     12  AM-COUNTY-PARISH                  PIC X(6).
  4024
  4025     12  AM-NAME                           PIC X(30).
  4026     12  AM-PERSON                         PIC X(30).
  4027     12  AM-ADDRS                          PIC X(30).
  4028     12  AM-CITY.
  4029         16  AM-ADDR-CITY                  PIC X(28).
  4030         16  AM-ADDR-STATE                 PIC XX.
  4031     12  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  74
* EL1278.cbl
  4032         16  AM-ZIP-PRIME.
  4033             20  AM-ZIP-PRI-1ST            PIC X.
  4034                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4035             20  FILLER                    PIC X(4).
  4036         16  AM-ZIP-PLUS4                  PIC X(4).
  4037     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4038         16  AM-CAN-POSTAL-1               PIC XXX.
  4039         16  AM-CAN-POSTAL-2               PIC XXX.
  4040         16  FILLER                        PIC XXX.
  4041     12  AM-TEL-NO.
  4042         16  AM-AREA-CODE                  PIC 999.
  4043         16  AM-TEL-PRE                    PIC 999.
  4044         16  AM-TEL-NBR                    PIC 9(4).
  4045     12  AM-TEL-LOC                        PIC X.
  4046         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4047         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4048
  4049     12  AM-COMM-STRUCTURE.
  4050         16  AM-DEFN-1.
  4051             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4052                 24  AM-AGT.
  4053                     28  AM-AGT-PREFIX     PIC X(4).
  4054                     28  AM-AGT-PRIME      PIC X(6).
  4055                 24  AM-COM-TYP            PIC X.
  4056                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4057                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4058                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4059                 24  AM-RECALC-LV-INDIC    PIC X.
  4060                 24  AM-RETRO-LV-INDIC     PIC X.
  4061                 24  AM-GL-CODES           PIC X.
  4062                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4063                 24  FILLER                PIC X(01).
  4064         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4065             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4066                 24  FILLER                PIC X(11).
  4067                 24  AM-L-COMA             PIC XXX.
  4068                 24  AM-J-COMA             PIC XXX.
  4069                 24  AM-A-COMA             PIC XXX.
  4070                 24  FILLER                PIC X(6).
  4071
  4072     12  AM-COMM-CHANGE-STATUS             PIC X.
  4073         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4074
  4075     12  AM-CSR-CODE                       PIC X(4).
  4076
  4077     12  AM-BILLING-STATUS                 PIC X.
  4078         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4079         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4080     12  AM-AUTO-REFUND-SW                 PIC X.
  4081         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4082         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4083     12  AM-GPCD                           PIC 99.
  4084     12  AM-IG                             PIC X.
  4085         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4086         88  AM-HAS-GROUP                     VALUE '2'.
  4087     12  AM-STATUS                         PIC X.
  4088         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4089         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  75
* EL1278.cbl
  4090         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4091         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4092         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4093         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4094     12  AM-REMIT-TO                       PIC 99.
  4095     12  AM-ID-NO                          PIC X(11).
  4096
  4097     12  AM-CAL-TABLE                      PIC XX.
  4098     12  AM-LF-DEVIATION                   PIC XXX.
  4099     12  AM-AH-DEVIATION                   PIC XXX.
  4100     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4101     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4102     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4103     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4104     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4105     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4106
  4107     12  AM-USER-FIELDS.
  4108         16  AM-FLD-1                      PIC XX.
  4109         16  AM-FLD-2                      PIC XX.
  4110         16  AM-FLD-3                      PIC XX.
  4111         16  AM-FLD-4                      PIC XX.
  4112         16  AM-FLD-5                      PIC XX.
  4113
  4114     12  AM-1ST-PROD-DATE.
  4115         16  AM-1ST-PROD-YR                PIC XX.
  4116         16  AM-1ST-PROD-MO                PIC XX.
  4117         16  AM-1ST-PROD-DA                PIC XX.
  4118     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4119     12  AM-CERTS-PURGED-DATE.
  4120         16  AM-PUR-YR                     PIC XX.
  4121         16  AM-PUR-MO                     PIC XX.
  4122         16  AM-PUR-DA                     PIC XX.
  4123     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4124     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4125     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4126     12  AM-INACTIVE-DATE.
  4127         16  AM-INA-MO                     PIC 99.
  4128         16  AM-INA-DA                     PIC 99.
  4129         16  AM-INA-YR                     PIC 99.
  4130     12  AM-AR-HI-CERT-DATE                PIC XX.
  4131
  4132     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4133     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4134
  4135     12  AM-OB-PAYMENT-MODE                PIC X.
  4136         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4137         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4138         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4139         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4140
  4141     12  AM-AH-ONLY-INDICATOR              PIC X.
  4142         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4143         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4144
  4145     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4146
  4147     12  AM-OVER-SHORT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  76
* EL1278.cbl
  4148         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4149         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4150
  4151     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4152     12  AM-DCC-CLP-STATE                  PIC XX.
  4153
  4154     12  AM-RECALC-COMM                    PIC X.
  4155     12  AM-RECALC-REIN                    PIC X.
  4156
  4157     12  AM-REI-TABLE                      PIC XXX.
  4158     12  AM-REI-ET-LF                      PIC X.
  4159     12  AM-REI-ET-AH                      PIC X.
  4160     12  AM-REI-PE-LF                      PIC X.
  4161     12  AM-REI-PE-AH                      PIC X.
  4162     12  AM-REI-PRT-ST                     PIC X.
  4163     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4164     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4165     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4166     12  AM-REI-GROUP-A                    PIC X(6).
  4167     12  AM-REI-MORT                       PIC X(4).
  4168     12  AM-REI-PRT-OW                     PIC X.
  4169     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4170     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4171     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4172     12  AM-REI-GROUP-B                    PIC X(6).
  4173
  4174     12  AM-TRUST-TYPE                     PIC X(2).
  4175
  4176     12  AM-EMPLOYER-STMT-USED             PIC X.
  4177     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4178
  4179     12  AM-STD-AH-TYPE                    PIC XX.
  4180     12  AM-EARN-METHODS.
  4181         16  AM-EARN-METHOD-R              PIC X.
  4182             88 AM-REF-RL-R78                 VALUE 'R'.
  4183             88 AM-REF-RL-PR                  VALUE 'P'.
  4184             88 AM-REF-RL-MEAN                VALUE 'M'.
  4185             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4186         16  AM-EARN-METHOD-L              PIC X.
  4187             88 AM-REF-LL-R78                 VALUE 'R'.
  4188             88 AM-REF-LL-PR                  VALUE 'P'.
  4189             88 AM-REF-LL-MEAN                VALUE 'M'.
  4190             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4191         16  AM-EARN-METHOD-A              PIC X.
  4192             88 AM-REF-AH-R78                 VALUE 'R'.
  4193             88 AM-REF-AH-PR                  VALUE 'P'.
  4194             88 AM-REF-AH-MEAN                VALUE 'M'.
  4195             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4196             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4197             88 AM-REF-AH-NET                 VALUE 'N'.
  4198
  4199     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4200     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4201     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4202
  4203     12  AM-RET-Y-N                        PIC X.
  4204     12  AM-RET-P-E                        PIC X.
  4205     12  AM-LF-RET                         PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  77
* EL1278.cbl
  4206     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4207     12  AM-RET-GRP                        PIC X(6).
  4208     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4209         16  AM-POOL-PRIME                 PIC XXX.
  4210         16  AM-POOL-SUB                   PIC XXX.
  4211     12  AM-RETRO-EARNINGS.
  4212         16  AM-RET-EARN-R                 PIC X.
  4213         16  AM-RET-EARN-L                 PIC X.
  4214         16  AM-RET-EARN-A                 PIC X.
  4215     12  AM-RET-ST-TAX-USE                 PIC X.
  4216         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4217         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4218     12  AM-RETRO-BEG-EARNINGS.
  4219         16  AM-RET-BEG-EARN-R             PIC X.
  4220         16  AM-RET-BEG-EARN-L             PIC X.
  4221         16  AM-RET-BEG-EARN-A             PIC X.
  4222     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4223     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4224
  4225     12  AM-USER-SELECT-OPTIONS.
  4226         16  AM-USER-SELECT-1              PIC X(10).
  4227         16  AM-USER-SELECT-2              PIC X(10).
  4228         16  AM-USER-SELECT-3              PIC X(10).
  4229         16  AM-USER-SELECT-4              PIC X(10).
  4230         16  AM-USER-SELECT-5              PIC X(10).
  4231
  4232     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4233
  4234     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4235
  4236     12  AM-RPT045A-SWITCH                 PIC X.
  4237         88  RPT045A-OFF                   VALUE 'N'.
  4238
  4239     12  AM-INSURANCE-LIMITS.
  4240         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4241         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4242
  4243     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4244         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4245
  4246     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4247         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4248         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4249
  4250     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4251
  4252     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4253     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4254     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4255     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4256     12  AM-DCC-UEF-STATE                  PIC XX.
  4257     12  FILLER                            PIC XXX.
  4258     12  AM-REPORT-CODE-3                  PIC X(10).
  4259*    12  FILLER                            PIC X(22).
  4260
  4261     12  AM-RESERVE-DATE.
  4262         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4263         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  78
* EL1278.cbl
  4264         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4265
  4266     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4267     12  AM-NOTIFICATION-TYPES.
  4268         16  AM-NOTIF-OF-LETTERS           PIC X.
  4269         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4270         16  AM-NOTIF-OF-REPORTS           PIC X.
  4271         16  AM-NOTIF-OF-STATUS            PIC X.
  4272
  4273     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4274         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4275         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4276         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4277         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4278
  4279     12  AM-BENEFIT-CONTROLS.
  4280         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4281             20  AM-BENEFIT-CODE           PIC XX.
  4282             20  AM-BENEFIT-TYPE           PIC X.
  4283             20  AM-BENEFIT-REVISION       PIC XXX.
  4284             20  AM-BENEFIT-REM-TERM       PIC X.
  4285             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4286             20  FILLER                    PIC XX.
  4287         16  FILLER                        PIC X(80).
  4288
  4289     12  AM-TRANSFER-DATA.
  4290         16  AM-TRANSFERRED-FROM.
  4291             20  AM-TRNFROM-CARRIER        PIC X.
  4292             20  AM-TRNFROM-GROUPING.
  4293                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4294                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4295             20  AM-TRNFROM-STATE          PIC XX.
  4296             20  AM-TRNFROM-ACCOUNT.
  4297                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4298                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4299             20  AM-TRNFROM-DTE            PIC XX.
  4300         16  AM-TRANSFERRED-TO.
  4301             20  AM-TRNTO-CARRIER          PIC X.
  4302             20  AM-TRNTO-GROUPING.
  4303                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4304                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4305             20  AM-TRNTO-STATE            PIC XX.
  4306             20  AM-TRNTO-ACCOUNT.
  4307                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4308                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4309             20  AM-TRNTO-DTE              PIC XX.
  4310         16  FILLER                        PIC X(10).
  4311
  4312     12  AM-SAVED-REMIT-TO                 PIC 99.
  4313
  4314     12  AM-COMM-STRUCTURE-SAVED.
  4315         16  AM-DEFN-1-SAVED.
  4316             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4317                 24  AM-AGT-SV             PIC X(10).
  4318                 24  AM-COM-TYP-SV         PIC X.
  4319                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4320                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4321                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  79
* EL1278.cbl
  4322                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4323                 24  FILLER                PIC X.
  4324                 24  AM-GL-CODES-SV        PIC X.
  4325                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4326                 24  FILLER                PIC X.
  4327         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4328             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4329                 24  FILLER                PIC X(11).
  4330                 24  AM-L-COMA-SV          PIC XXX.
  4331                 24  AM-J-COMA-SV          PIC XXX.
  4332                 24  AM-A-COMA-SV          PIC XXX.
  4333                 24  FILLER                PIC X(6).
  4334
  4335     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4336         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4337            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4338            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4339            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4340
  4341     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4342     12  FILLER                            PIC X(120).
  4343
  4344     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4345         16  AM-CONTROL-NAME               PIC X(30).
  4346         16  AM-EXECUTIVE-ONE.
  4347             20  AM-EXEC1-NAME             PIC X(15).
  4348             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4349                                                          COMP-3.
  4350             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4351                                                          COMP-3.
  4352         16  AM-EXECUTIVE-TWO.
  4353             20  AM-EXEC2-NAME             PIC X(15).
  4354             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4355                                                          COMP-3.
  4356             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4357                                                          COMP-3.
  4358
  4359     12  AM-RETRO-ADDITIONAL-DATA.
  4360         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4361         16  AM-RETRO-PREM-P-E             PIC X.
  4362         16  AM-RETRO-CLMS-P-I             PIC X.
  4363         16  AM-RETRO-RET-BRACKET-LF.
  4364             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4365                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4366                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4367             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4368                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4369                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4370             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4371                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4372                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4373         16  AM-RETRO-RET-BRACKET-AH.
  4374             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4375                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4376                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4377                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4378             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4379                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  80
* EL1278.cbl
  4380                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4381             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4382                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4383                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4384
  4385     12  AM-COMMENTS.
  4386         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4387
  4388     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4389         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4390         16  AM-FLI-BILLING-CODE           PIC X.
  4391         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4392         16  AM-FLI-UNITED-IDENT           PIC X.
  4393         16  AM-FLI-INTEREST-LOST-DATA.
  4394             20  AM-FLI-BANK-NO            PIC X(5).
  4395             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4396             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4397             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4398         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4399             20  AM-FLI-AGT                PIC X(9).
  4400             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4401             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4402         16  FILLER                        PIC X(102).
  4403
  4404     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4405         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4406             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4407             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4408             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4409             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4410             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4411         16  FILLER                          PIC X(10).
  4412******************************************************************
  4413*                            COPY ELCCERT.
  4414******************************************************************
  4415*                                                                *
  4416*                            ELCCERT.                            *
  4417*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4418*                            VMOD=2.013                          *
  4419*                                                                *
  4420*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4421*                                                                *
  4422*   FILE TYPE = VSAM,KSDS                                        *
  4423*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4424*                                                                *
  4425*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4426*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4427*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4428*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4429*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4430*                                                                *
  4431*   LOG = YES                                                    *
  4432*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4433******************************************************************
  4434*                   C H A N G E   L O G
  4435*
  4436* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4437*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  81
* EL1278.cbl
  4438*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4439* EFFECTIVE    NUMBER
  4440*-----------------------------------------------------------------
  4441* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4442* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4443* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4444* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4445* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4446* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4447* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4448******************************************************************
  4449
  4450 01  CERTIFICATE-MASTER.
  4451     12  CM-RECORD-ID                      PIC XX.
  4452         88  VALID-CM-ID                      VALUE 'CM'.
  4453
  4454     12  CM-CONTROL-PRIMARY.
  4455         16  CM-COMPANY-CD                 PIC X.
  4456         16  CM-CARRIER                    PIC X.
  4457         16  CM-GROUPING.
  4458             20  CM-GROUPING-PREFIX        PIC X(3).
  4459             20  CM-GROUPING-PRIME         PIC X(3).
  4460         16  CM-STATE                      PIC XX.
  4461         16  CM-ACCOUNT.
  4462             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4463             20  CM-ACCOUNT-PRIME          PIC X(6).
  4464         16  CM-CERT-EFF-DT                PIC XX.
  4465         16  CM-CERT-NO.
  4466             20  CM-CERT-PRIME             PIC X(10).
  4467             20  CM-CERT-SFX               PIC X.
  4468
  4469     12  CM-CONTROL-BY-NAME.
  4470         16  CM-COMPANY-CD-A1              PIC X.
  4471         16  CM-INSURED-LAST-NAME          PIC X(15).
  4472         16  CM-INSURED-INITIALS.
  4473             20  CM-INSURED-INITIAL1       PIC X.
  4474             20  CM-INSURED-INITIAL2       PIC X.
  4475
  4476     12  CM-CONTROL-BY-SSN.
  4477         16  CM-COMPANY-CD-A2              PIC X.
  4478         16  CM-SOC-SEC-NO.
  4479             20  CM-SSN-STATE              PIC XX.
  4480             20  CM-SSN-ACCOUNT            PIC X(6).
  4481             20  CM-SSN-LN3.
  4482                 25  CM-INSURED-INITIALS-A2.
  4483                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4484                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4485                 25 CM-PART-LAST-NAME-A2         PIC X.
  4486
  4487     12  CM-CONTROL-BY-CERT-NO.
  4488         16  CM-COMPANY-CD-A4              PIC X.
  4489         16  CM-CERT-NO-A4                 PIC X(11).
  4490
  4491     12  CM-CONTROL-BY-MEMB.
  4492         16  CM-COMPANY-CD-A5              PIC X.
  4493         16  CM-MEMBER-NO.
  4494             20  CM-MEMB-STATE             PIC XX.
  4495             20  CM-MEMB-ACCOUNT           PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  82
* EL1278.cbl
  4496             20  CM-MEMB-LN4.
  4497                 25  CM-INSURED-INITIALS-A5.
  4498                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4499                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4500                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4501
  4502     12  CM-INSURED-PROFILE-DATA.
  4503         16  CM-INSURED-FIRST-NAME.
  4504             20  CM-INSURED-1ST-INIT       PIC X.
  4505             20  FILLER                    PIC X(9).
  4506         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4507         16  CM-INSURED-SEX                PIC X.
  4508             88  CM-SEX-MALE                  VALUE 'M'.
  4509             88  CM-SEX-FEMAL                 VALUE 'F'.
  4510         16  CM-INSURED-JOINT-AGE          PIC 99.
  4511         16  CM-JOINT-INSURED-NAME.
  4512             20  CM-JT-LAST-NAME           PIC X(15).
  4513             20  CM-JT-FIRST-NAME.
  4514                 24  CM-JT-1ST-INIT        PIC X.
  4515                 24  FILLER                PIC X(9).
  4516             20  CM-JT-INITIAL             PIC X.
  4517
  4518     12  CM-LIFE-DATA.
  4519         16  CM-LF-BENEFIT-CD              PIC XX.
  4520         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4521         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4522         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4523         16  CM-LF-DEV-CODE                PIC XXX.
  4524         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4525         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4526         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4527         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4528         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4529         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4530         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4531         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4532         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4533         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4534         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4535         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4536         16  FILLER                        PIC XX.
  4537
  4538     12  CM-AH-DATA.
  4539         16  CM-AH-BENEFIT-CD              PIC XX.
  4540         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4541         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4542         16  CM-AH-DEV-CODE                PIC XXX.
  4543         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4544         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4545         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4546         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4547         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4548         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4549         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4550         16  CM-AH-PAID-THRU-DT            PIC XX.
  4551             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4552         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4553         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  83
* EL1278.cbl
  4554         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4555         16  FILLER                        PIC X.
  4556
  4557     12  CM-LOAN-INFORMATION.
  4558         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4559         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4560                                           PIC S9(5)V99  COMP-3.
  4561         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4562         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4563         16  CM-PAY-FREQUENCY              PIC S99.
  4564         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4565         16  CM-RATE-CLASS                 PIC XX.
  4566         16  CM-BENEFICIARY                PIC X(25).
  4567         16  CM-POLICY-FORM-NO             PIC X(12).
  4568         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4569         16  CM-LAST-ADD-ON-DT             PIC XX.
  4570         16  CM-DEDUCTIBLE-AMOUNTS.
  4571             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4572             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4573         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4574             20  CM-RESIDENT-STATE         PIC XX.
  4575             20  CM-RATE-CODE              PIC X(4).
  4576             20  FILLER                    PIC XX.
  4577         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4578             20  CM-LOAN-OFFICER           PIC X(5).
  4579             20  FILLER                    PIC XXX.
  4580         16  CM-CSR-CODE                   PIC XXX.
  4581         16  CM-UNDERWRITING-CODE          PIC X.
  4582             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4583         16  CM-POST-CARD-IND              PIC X.
  4584         16  CM-NH-INTERFACE-SW            PIC X.
  4585         16  CM-PREMIUM-TYPE               PIC X.
  4586             88  CM-SING-PRM                  VALUE '1'.
  4587             88  CM-O-B-COVERAGE              VALUE '2'.
  4588             88  CM-OPEN-END                  VALUE '3'.
  4589         16  CM-IND-GRP-TYPE               PIC X.
  4590             88  CM-INDIVIDUAL                VALUE 'I'.
  4591             88  CM-GROUP                     VALUE 'G'.
  4592         16  CM-SKIP-CODE                  PIC X.
  4593             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4594             88  SKIP-JULY                    VALUE '1'.
  4595             88  SKIP-AUGUST                  VALUE '2'.
  4596             88  SKIP-SEPTEMBER               VALUE '3'.
  4597             88  SKIP-JULY-AUG                VALUE '4'.
  4598             88  SKIP-AUG-SEPT                VALUE '5'.
  4599             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4600             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4601             88  SKIP-JUNE                    VALUE '8'.
  4602             88  SKIP-JUNE-JULY               VALUE '9'.
  4603             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4604             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4605         16  CM-PAYMENT-MODE               PIC X.
  4606             88  PAY-MONTHLY                  VALUE SPACE.
  4607             88  PAY-WEEKLY                   VALUE '1'.
  4608             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4609             88  PAY-BI-WEEKLY                VALUE '3'.
  4610             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4611         16  CM-LOAN-NUMBER                PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  84
* EL1278.cbl
  4612         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4613         16  CM-OLD-LOF                    PIC XXX.
  4614*        16  CM-LOAN-OFFICER               PIC XXX.
  4615         16  CM-REIN-TABLE                 PIC XXX.
  4616         16  CM-SPECIAL-REIN-CODE          PIC X.
  4617         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4618         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4619         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4620
  4621     12  CM-STATUS-DATA.
  4622         16  CM-ENTRY-STATUS               PIC X.
  4623         16  CM-ENTRY-DT                   PIC XX.
  4624
  4625         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4626         16  CM-LF-CANCEL-DT               PIC XX.
  4627         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4628
  4629         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4630         16  CM-LF-DEATH-DT                PIC XX.
  4631         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4632
  4633         16  CM-LF-CURRENT-STATUS          PIC X.
  4634             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4635                                                'M' '4' '5' '9'.
  4636             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4637             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4638             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4639             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4640             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4641             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4642             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4643             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4644             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4645             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4646             88  CM-LF-DECLINED               VALUE 'D'.
  4647             88  CM-LF-VOIDED                 VALUE 'V'.
  4648
  4649         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4650         16  CM-AH-CANCEL-DT               PIC XX.
  4651         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4652
  4653         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4654         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4655         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4656
  4657         16  CM-AH-CURRENT-STATUS          PIC X.
  4658             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4659                                                'M' '4' '5' '9'.
  4660             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4661             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4662             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4663             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4664             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4665             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4666             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4667             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4668             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4669             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  85
* EL1278.cbl
  4670             88  CM-AH-DECLINED               VALUE 'D'.
  4671             88  CM-AH-VOIDED                 VALUE 'V'.
  4672
  4673         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4674             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4675             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4676             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4677         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4678
  4679         16  CM-ENTRY-BATCH                PIC X(6).
  4680         16  CM-LF-EXIT-BATCH              PIC X(6).
  4681         16  CM-AH-EXIT-BATCH              PIC X(6).
  4682         16  CM-LAST-MONTH-END             PIC XX.
  4683
  4684     12  CM-NOTE-SW                        PIC X.
  4685         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4686         88  CERT-NOTES-PRESENT               VALUE '1'.
  4687         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4688         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4689         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4690         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4691         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4692         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4693     12  CM-COMP-EXCP-SW                   PIC X.
  4694         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4695         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4696     12  CM-INSURED-ADDRESS-SW             PIC X.
  4697         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4698         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4699
  4700*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4701     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4702     12  FILLER                            PIC X.
  4703
  4704*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4705     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4706     12  FILLER                            PIC X.
  4707*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4708     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4709
  4710     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4711         88  CERT-ADDED-BATCH                 VALUE ' '.
  4712         88  CERT-ADDED-ONLINE                VALUE '1'.
  4713         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4714         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4715         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4716     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4717         88  CERT-AS-LOADED                   VALUE ' '.
  4718         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4719         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4720         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4721         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4722         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4723         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4724         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4725
  4726     12  CM-ACCOUNT-COMM-PCTS.
  4727         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  86
* EL1278.cbl
  4728         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4729
  4730     12  CM-USER-FIELD                     PIC X.
  4731     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4732     12  CM-CLP-STATE                      PIC XX.
  4733     12  CM-USER-RESERVED                  PIC XXX.
  4734******************************************************************
  4735*                            COPY ERCMAIL.
  4736******************************************************************
  4737*                                                                *
  4738*                                                                *
  4739*                            ERCMAIL                             *
  4740*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4741*                            VMOD=2.003                          *
  4742*                                                                *
  4743*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  4744*                                                                *
  4745*   FILE TYPE = VSAM,KSDS                                        *
  4746*   RECORD SIZE = 374   RECFORM = FIX                            *
  4747*                                                                *
  4748*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  4749*   ALTERNATE PATH    = NOT USED                                 *
  4750*                                                                *
  4751*   LOG = YES                                                    *
  4752*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4753******************************************************************
  4754*                   C H A N G E   L O G
  4755*
  4756* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4757*-----------------------------------------------------------------
  4758*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4759* EFFECTIVE    NUMBER
  4760*-----------------------------------------------------------------
  4761* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  4762* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4763* 111108                   PEMA  ADD CRED BENE ADDR2
  4764******************************************************************
  4765
  4766 01  MAILING-DATA.
  4767     12  MA-RECORD-ID                      PIC XX.
  4768         88  VALID-MA-ID                       VALUE 'MA'.
  4769
  4770     12  MA-CONTROL-PRIMARY.
  4771         16  MA-COMPANY-CD                 PIC X.
  4772         16  MA-CARRIER                    PIC X.
  4773         16  MA-GROUPING.
  4774             20  MA-GROUPING-PREFIX        PIC XXX.
  4775             20  MA-GROUPING-PRIME         PIC XXX.
  4776         16  MA-STATE                      PIC XX.
  4777         16  MA-ACCOUNT.
  4778             20  MA-ACCOUNT-PREFIX         PIC X(4).
  4779             20  MA-ACCOUNT-PRIME          PIC X(6).
  4780         16  MA-CERT-EFF-DT                PIC XX.
  4781         16  MA-CERT-NO.
  4782             20  MA-CERT-PRIME             PIC X(10).
  4783             20  MA-CERT-SFX               PIC X.
  4784
  4785     12  FILLER                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  87
* EL1278.cbl
  4786
  4787     12  MA-ACCESS-CONTROL.
  4788         16  MA-SOURCE-SYSTEM              PIC XX.
  4789             88  MA-FROM-CREDIT                VALUE 'CR'.
  4790             88  MA-FROM-VSI                   VALUE 'VS'.
  4791             88  MA-FROM-WARRANTY              VALUE 'WA'.
  4792             88  MA-FROM-OTHER                 VALUE 'OT'.
  4793         16  MA-RECORD-ADD-DT              PIC XX.
  4794         16  MA-RECORD-ADDED-BY            PIC XXXX.
  4795         16  MA-LAST-MAINT-DT              PIC XX.
  4796         16  MA-LAST-MAINT-BY              PIC XXXX.
  4797         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  4798
  4799     12  MA-PROFILE-INFO.
  4800         16  MA-QUALIFY-CODE-1             PIC XX.
  4801         16  MA-QUALIFY-CODE-2             PIC XX.
  4802         16  MA-QUALIFY-CODE-3             PIC XX.
  4803         16  MA-QUALIFY-CODE-4             PIC XX.
  4804         16  MA-QUALIFY-CODE-5             PIC XX.
  4805
  4806         16  MA-INSURED-LAST-NAME          PIC X(15).
  4807         16  MA-INSURED-FIRST-NAME         PIC X(10).
  4808         16  MA-INSURED-MIDDLE-INIT        PIC X.
  4809         16  MA-INSURED-ISSUE-AGE          PIC 99.
  4810         16  MA-INSURED-BIRTH-DT           PIC XX.
  4811         16  MA-INSURED-SEX                PIC X.
  4812             88  MA-SEX-MALE                   VALUE 'M'.
  4813             88  MA-SEX-FEMALE                 VALUE 'F'.
  4814         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  4815
  4816         16  MA-ADDRESS-CORRECTED          PIC X.
  4817         16  MA-JOINT-BIRTH-DT             PIC XX.
  4818*        16  FILLER                        PIC X(12).
  4819
  4820         16  MA-ADDRESS-LINE-1             PIC X(30).
  4821         16  MA-ADDRESS-LINE-2             PIC X(30).
  4822         16  MA-CITY-STATE.
  4823             20  MA-CITY                   PIC X(28).
  4824             20  MA-ADDR-STATE             PIC XX.
  4825         16  MA-ZIP.
  4826             20  MA-ZIP-CODE.
  4827                 24  MA-ZIP-CODE-1ST       PIC X(1).
  4828                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4829                 24  FILLER                PIC X(4).
  4830             20  MA-ZIP-PLUS4              PIC X(4).
  4831         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  4832             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  4833             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  4834             20  FILLER                    PIC X(3).
  4835
  4836         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  4837
  4838         16  FILLER                        PIC XXX.
  4839*        16  FILLER                        PIC X(10).
  4840
  4841     12  MA-CRED-BENE-INFO.
  4842         16  MA-CRED-BENE-NAME                 PIC X(25).
  4843         16  MA-CRED-BENE-ADDR                 PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  88
* EL1278.cbl
  4844         16  MA-CRED-BENE-ADDR2                PIC X(30).
  4845         16  MA-CRED-BENE-CTYST.
  4846             20  MA-CRED-BENE-CITY             PIC X(28).
  4847             20  MA-CRED-BENE-STATE            PIC XX.
  4848         16  MA-CRED-BENE-ZIP.
  4849             20  MA-CB-ZIP-CODE.
  4850                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  4851                     88  MA-CB-CANADIAN-POST-CODE
  4852                                           VALUE 'A' THRU 'Z'.
  4853                 24  FILLER                    PIC X(4).
  4854             20  MA-CB-ZIP-PLUS4               PIC X(4).
  4855         16  MA-CB-CANADIAN-POSTAL-CODE
  4856                            REDEFINES MA-CRED-BENE-ZIP.
  4857             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  4858             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  4859             20  FILLER                        PIC X(3).
  4860     12  MA-POST-CARD-MAIL-DATA.
  4861         16  MA-MAIL-DATA OCCURS 7.
  4862             20  MA-MAIL-TYPE              PIC X.
  4863                 88  MA-12MO-MAILING           VALUE '1'.
  4864                 88  MA-EXP-MAILING            VALUE '2'.
  4865             20  MA-MAIL-STATUS            PIC X.
  4866                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  4867                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  4868                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  4869             20  MA-MAIL-DATE              PIC XX.
  4870     12  FILLER                            PIC XX.
  4871     12  FILLER                            PIC XX.
  4872*    12  FILLER                            PIC X(30).
  4873******************************************************************
  4874*                            COPY ERCFORM.
  4875******************************************************************
  4876*                                                                *
  4877*                                                                *
  4878*                            ERCFORM.                            *
  4879*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4880*                            VMOD=2.003                          *
  4881*                                                                *
  4882*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  4883*                                                                *
  4884*    FILE TYPE = VSAM,KSDS                                       *
  4885*    RECORD SIZE = 500  RECFORM = FIXED                          *
  4886*                                                                *
  4887*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  4888*                                                                *
  4889*    LOG = YES                                                   *
  4890*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4891******************************************************************
  4892 01  FORM-MASTER.
  4893    12  FO-RECORD-ID                 PIC X(02).
  4894        88  VALID-FO-ID                  VALUE 'FO'.
  4895
  4896    12  FO-CONTROL-PRIMARY.
  4897        16  FO-COMPANY-CD            PIC X(01).
  4898        16  FO-STATE                 PIC X(02).
  4899        16  FO-FORM-ID               PIC X(12).
  4900        16  FO-FORM-EXP-DT           PIC X(02).
  4901
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  89
* EL1278.cbl
  4902    12  FO-POLICY-FORM-DATA.
  4903        16  FO-IND-GRP-CD            PIC X(01).
  4904        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  4905        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  4906        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  4907        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  4908        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  4909        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  4910        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  4911        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  4912        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  4913        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  4914        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  4915        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  4916        16  FO-DIS-DEF-TYPE          PIC 9(02).
  4917        16  FO-DISMEMBERMENT-CD      PIC X(01).
  4918        16  FO-APP-CERT-USE-CD       PIC X(01).
  4919
  4920    12  FILLER                       PIC X(29).
  4921
  4922    12  FO-FORM-PLAN-TABLE.
  4923        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  4924            20  FO-PLAN-TYPE         PIC X(01).
  4925            20  FO-PLAN-ID           PIC X(02).
  4926            20  FO-PLAN-TERM         PIC 9(03).
  4927            20  FO-PLAN-REFUND-METHOD
  4928                                     PIC X.
  4929
  4930    12  FILLER                       PIC X(30).
  4931
  4932    12  FO-COMMENTS-AREA.
  4933        16  FO-COMMENT-LINE-1        PIC X(78).
  4934
  4935    12  FILLER                       PIC X(20).
  4936
  4937    12  FO-MAINT-INFORMATION.
  4938        16  FO-LAST-MAINT-DT         PIC X(02).
  4939        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  4940        16  FO-LAST-MAINT-BY         PIC X(04).
  4941*                            COPY ELCMSTR.
  4942******************************************************************
  4943*                                                                *
  4944*                            ELCMSTR.                            *
  4945*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4946*                            VMOD=2.012                          *
  4947*                                                                *
  4948*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  4949*                                                                *
  4950*   FILE TYPE = VSAM,KSDS                                        *
  4951*   RECORD SIZE = 350  RECFORM = FIXED                           *
  4952*                                                                *
  4953*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  4954*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  4955*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  4956*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  4957*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  4958*                                                 RKP=75,LEN=21  *
  4959*                                                                *
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  90
* EL1278.cbl
  4960*   **** NOTE ****                                               *
  4961*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  4962*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  4963*                                                                *
  4964*   LOG = YES                                                    *
  4965*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4966******************************************************************
  4967*                   C H A N G E   L O G
  4968*
  4969* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4970*-----------------------------------------------------------------
  4971*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4972* EFFECTIVE    NUMBER
  4973*-----------------------------------------------------------------
  4974* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4975* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  4976******************************************************************
  4977 01  CLAIM-MASTER.
  4978     12  CL-RECORD-ID                PIC XX.
  4979         88  VALID-CL-ID         VALUE 'CL'.
  4980
  4981     12  CL-CONTROL-PRIMARY.
  4982         16  CL-COMPANY-CD           PIC X.
  4983         16  CL-CARRIER              PIC X.
  4984         16  CL-CLAIM-NO             PIC X(7).
  4985         16  CL-CERT-NO.
  4986             20  CL-CERT-PRIME       PIC X(10).
  4987             20  CL-CERT-SFX         PIC X.
  4988
  4989     12  CL-CONTROL-BY-NAME.
  4990         16  CL-COMPANY-CD-A1        PIC X.
  4991         16  CL-INSURED-LAST-NAME    PIC X(15).
  4992         16  CL-INSURED-NAME.
  4993             20  CL-INSURED-1ST-NAME PIC X(12).
  4994             20  CL-INSURED-MID-INIT PIC X.
  4995
  4996     12  CL-CONTROL-BY-SSN.
  4997         16  CL-COMPANY-CD-A2        PIC X.
  4998         16  CL-SOC-SEC-NO.
  4999             20  CL-SSN-STATE        PIC XX.
  5000             20  CL-SSN-ACCOUNT      PIC X(6).
  5001             20  CL-SSN-LN3          PIC X(3).
  5002
  5003     12  CL-CONTROL-BY-CERT-NO.
  5004         16  CL-COMPANY-CD-A4        PIC X.
  5005         16  CL-CERT-NO-A4.
  5006             20  CL-CERT-A4-PRIME    PIC X(10).
  5007             20  CL-CERT-A4-SFX      PIC X.
  5008
  5009     12  CL-CONTROL-BY-CCN.
  5010         16  CL-COMPANY-CD-A5        PIC X.
  5011         16  CL-CCN-A5.
  5012             20  CL-CCN.
  5013                 24  CL-CCN-PREFIX-A5 PIC X(4).
  5014                 24  CL-CCN-PRIME-A5 PIC X(12).
  5015             20  CL-CCN-FILLER-A5    PIC X(4).
  5016
  5017     12  CL-INSURED-PROFILE-DATA.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  91
* EL1278.cbl
  5018         16  CL-INSURED-BIRTH-DT     PIC XX.
  5019         16  CL-INSURED-SEX-CD       PIC X.
  5020             88  INSURED-IS-MALE        VALUE 'M'.
  5021             88  INSURED-IS-FEMALE      VALUE 'F'.
  5022             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  5023         16  CL-INSURED-OCC-CD       PIC X(6).
  5024         16  FILLER                  PIC X(5).
  5025
  5026     12  CL-PROCESSING-INFO.
  5027         16  CL-PROCESSOR-ID         PIC X(4).
  5028         16  CL-CLAIM-STATUS         PIC X.
  5029             88  CLAIM-IS-OPEN          VALUE 'O'.
  5030             88  CLAIM-IS-CLOSED        VALUE 'C'.
  5031         16  CL-CLAIM-TYPE           PIC X.
  5032*            88  AH-CLAIM               VALUE 'A'.
  5033*            88  LIFE-CLAIM             VALUE 'L'.
  5034*            88  PROPERTY-CLAIM         VALUE 'P'.
  5035*            88  IUI-CLAIM              VALUE 'I'.
  5036*            88  GAP-CLAIM              VALUE 'G'.
  5037         16  CL-CLAIM-PREM-TYPE      PIC X.
  5038             88  SINGLE-PREMIUM         VALUE '1'.
  5039             88  O-B-COVERAGE           VALUE '2'.
  5040             88  OPEN-END-COVERAGE      VALUE '3'.
  5041         16  CL-INCURRED-DT          PIC XX.
  5042         16  CL-REPORTED-DT          PIC XX.
  5043         16  CL-FILE-ESTABLISH-DT    PIC XX.
  5044         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  5045         16  CL-LAST-PMT-DT          PIC XX.
  5046         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  5047         16  CL-PAID-THRU-DT         PIC XX.
  5048         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  5049         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  5050         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  5051         16  CL-PMT-CALC-METHOD      PIC X.
  5052             88  CL-360-DAY-YR          VALUE '1'.
  5053             88  CL-365-DAY-YR          VALUE '2'.
  5054             88  CL-FULL-MONTHS         VALUE '3'.
  5055         16  CL-CAUSE-CD             PIC X(6).
  5056
  5057         16  CL-PRIME-CERT-NO.
  5058             20  CL-PRIME-CERT-PRIME PIC X(10).
  5059             20  CL-PRIME-CERT-SFX   PIC X.
  5060
  5061         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  5062             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  5063             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  5064
  5065         16  CL-MICROFILM-NO         PIC X(10).
  5066         16  CL-PROG-FORM-TYPE       PIC X.
  5067         16  CL-LAST-ADD-ON-DT       PIC XX.
  5068
  5069         16  CL-LAST-REOPEN-DT       PIC XX.
  5070         16  CL-LAST-CLOSE-DT        PIC XX.
  5071         16  CL-LAST-CLOSE-REASON    PIC X(01).
  5072             88  FINAL-PAID             VALUE '1'.
  5073             88  CLAIM-DENIED           VALUE '2'.
  5074             88  AUTO-CLOSE             VALUE '3'.
  5075             88  MANUAL-CLOSE           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  92
* EL1278.cbl
  5076             88  BENEFITS-CHANGED       VALUE 'C'.
  5077             88  SETUP-ERRORS           VALUE 'E'.
  5078         16  CL-ASSOC-CERT-SEQU      PIC S99.
  5079         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  5080         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  5081             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  5082         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  5083         16  FILLER                  PIC X.
  5084
  5085     12  CL-CERTIFICATE-DATA.
  5086         16  CL-CERT-ORIGIN          PIC X.
  5087             88  CERT-WAS-ONLINE        VALUE '1'.
  5088             88  CERT-WAS-CREATED       VALUE '2'.
  5089             88  COVERAGE-WAS-ADDED     VALUE '3'.
  5090         16  CL-CERT-KEY-DATA.
  5091             20  CL-CERT-CARRIER     PIC X.
  5092             20  CL-CERT-GROUPING    PIC X(6).
  5093             20  CL-CERT-STATE       PIC XX.
  5094             20  CL-CERT-ACCOUNT.
  5095                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  5096                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  5097             20  CL-CERT-EFF-DT      PIC XX.
  5098
  5099     12  CL-STATUS-CONTROLS.
  5100         16  CL-PRIORITY-CD          PIC X.
  5101             88  CONFIDENTIAL-DATA      VALUE '8'.
  5102             88  HIGHEST-PRIORITY       VALUE '9'.
  5103         16  CL-SUPV-ATTN-CD         PIC X.
  5104             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  5105             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  5106         16  CL-PURGED-DT            PIC XX.
  5107         16  CL-RESTORED-DT          PIC XX.
  5108         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  5109         16  CL-NEXT-RESEND-DT       PIC XX.
  5110         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  5111         16  FILLER                  PIC XX.
  5112         16  CL-LAST-MAINT-DT        PIC XX.
  5113         16  CL-LAST-MAINT-USER      PIC X(4).
  5114         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  5115         16  CL-LAST-MAINT-TYPE      PIC X.
  5116             88  CLAIM-SET-UP           VALUE ' '.
  5117             88  PAYMENT-MADE           VALUE '1'.
  5118             88  LETTER-SENT            VALUE '2'.
  5119             88  MASTER-WAS-ALTERED     VALUE '3'.
  5120             88  MASTER-WAS-RESTORED    VALUE '4'.
  5121             88  INCURRED-DATE-CHANGED  VALUE '5'.
  5122             88  FILE-CONVERTED         VALUE '6'.
  5123             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  5124             88  ERROR-CORRECTION       VALUE 'E'.
  5125         16  CL-RELATED-CLAIM-NO     PIC X(7).
  5126         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  5127         16  CL-BENEFICIARY          PIC X(10).
  5128         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  5129         16  CL-DENIAL-TYPE          PIC X.
  5130             88  CL-TYPE-DENIAL          VALUE '1'.
  5131             88  CL-TYPE-RESCISSION      VALUE '2'.
  5132             88  CL-TYPE-REFORMATION     VALUE '3'.
  5133             88  CL-TYPE-REF-TO-RES      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  93
* EL1278.cbl
  5134             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  5135         16  FILLER                  PIC X(5).
  5136
  5137     12  CL-TRAILER-CONTROLS.
  5138         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  5139             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  5140             88  CL-LAST-TRL-AVAIL      VALUE +100.
  5141             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  5142         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  5143         16  FILLER                  PIC XX.
  5144         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  5145         16  CL-ADDRESS-TRAILER-CNT.
  5146             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  5147                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  5148             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  5149                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  5150             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  5151                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  5152             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  5153                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  5154             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  5155                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  5156             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  5157                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  5158             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  5159                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  5160
  5161     12  CL-CV-REFERENCE-NO.
  5162         16  CL-CV-REFNO-PRIME       PIC X(18).
  5163         16  CL-CV-REFNO-SFX         PIC XX.
  5164
  5165     12  CL-FILE-LOCATION            PIC X(4).
  5166
  5167     12  CL-PROCESS-ERRORS.
  5168         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  5169             88  NO-FATAL-ERRORS        VALUE ZERO.
  5170         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  5171             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  5172
  5173     12  CL-PRODUCT-CD               PIC X.
  5174
  5175     12  CL-CURRENT-KEY-DATA.
  5176         16  CL-CURRENT-CARRIER      PIC X.
  5177         16  CL-CURRENT-GROUPING     PIC X(6).
  5178         16  CL-CURRENT-STATE        PIC XX.
  5179         16  CL-CURRENT-ACCOUNT      PIC X(10).
  5180
  5181     12  CL-ASSOCIATES               PIC X.
  5182         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  5183         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  5184         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  5185         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  5186
  5187     12  CL-ACTIVITY-CODE            PIC 99.
  5188     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  5189     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  5190
  5191     12  CL-LAPSE-REPORT-CODE        PIC 9.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  94
* EL1278.cbl
  5192     12  CL-LAG-REPORT-CODE          PIC 9.
  5193     12  CL-LOAN-TYPE                PIC XX.
  5194     12  CL-LEGAL-STATE              PIC XX.
  5195
  5196*    12  FILLER                      PIC X(5).
  5197     12  CL-YESNOSW                  PIC X.
  5198     12  FILLER                      PIC X(4).
  5199*                            COPY ERCPDEF.
  5200******************************************************************
  5201*                                                                *
  5202*                                                                *
  5203*                            ERCPDEF.                            *
  5204*                                                                *
  5205*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5206*                                                                *
  5207*    FILE TYPE = VSAM,KSDS                                       *
  5208*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5209*                                                                *
  5210*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5211*                                                                *
  5212*    LOG = YES                                                   *
  5213*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5214******************************************************************
  5215 01  PRODUCT-MASTER.
  5216    12  PD-RECORD-ID                 PIC X(02).
  5217        88  VALID-PD-ID                  VALUE 'PD'.
  5218    12  PD-CONTROL-PRIMARY.
  5219        16  PD-COMPANY-CD            PIC X.
  5220        16  PD-STATE                 PIC XX.
  5221        16  PD-PRODUCT-CD            PIC XXX.
  5222        16  PD-FILLER                PIC X(7).
  5223        16  PD-BEN-TYPE              PIC X.
  5224        16  PD-BEN-CODE              PIC XX.
  5225        16  PD-PROD-EXP-DT           PIC XX.
  5226    12  FILLER                       PIC X(50).
  5227    12  PD-PRODUCT-DATA OCCURS 8.
  5228        16  PD-PROD-CODE             PIC X.
  5229            88  PD-PROD-LIFE           VALUE 'L'.
  5230            88  PD-PROD-PROP           VALUE 'P'.
  5231            88  PD-PROD-AH             VALUE 'A'.
  5232            88  PD-PROD-IU             VALUE 'I'.
  5233            88  PD-PROD-GAP            VALUE 'G'.
  5234        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5235        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5236        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5237        16  PD-MAX-TERM              PIC S999        COMP-3.
  5238        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5239        16  FILLER                   PIC X.
  5240        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5241        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5242        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5243        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5244        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5245        16  PD-REC-CRIT-PERIOD       PIC X.
  5246        16  PD-RTW-MOS               PIC 99.
  5247        16  FILLER                   PIC X(5).
  5248    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5249    12  PD-TERM-LIMITS OCCURS 15.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  95
* EL1278.cbl
  5250        16  PD-LOW-TERM              PIC S999        COMP-3.
  5251        16  PD-HI-TERM               PIC S999        COMP-3.
  5252*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5253    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5254        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5255        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5256    12  PD-EARN-FACTORS.
  5257        16  FILLER OCCURS 15.
  5258            20  FILLER OCCURS 15.
  5259                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5260    12  PD-PRODUCT-DESC              PIC X(80).
  5261    12  PD-TRUNCATED                 PIC X.
  5262    12  FILLER                       PIC X(59).
  5263    12  PD-MAINT-INFORMATION.
  5264        16  PD-LAST-MAINT-DT         PIC X(02).
  5265        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5266        16  PD-LAST-MAINT-BY         PIC X(04).
  5267 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  5268                          ACCOUNT-MASTER CERTIFICATE-MASTER
  5269                          MAILING-DATA FORM-MASTER CLAIM-MASTER
  5270                          PRODUCT-MASTER.
  5271 0000-DFHEXIT SECTION.
  5272     MOVE '9#                    $   ' TO DFHEIV0.
  5273     MOVE 'EL1278' TO DFHEIV1.
  5274     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5275*    SERVICE RELOAD PARMLIST.
  5276
  5277     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5278     MOVE '5'                    TO  DC-OPTION-CODE.
  5279
  5280     PERFORM 9600-DATE-LINK.
  5281
  5282     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5283     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5284     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5285     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5286     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  5287     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  5288     MOVE EIBTRMID               TO  QID-TERM.
  5289
  5290     IF EIBCALEN  IS EQUAL TO  ZERO
  5291         GO TO 8700-UNAUTHORIZED-ACCESS.
  5292
  5293     IF PI-CALLING-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5294         IF PI-RETURN-TO-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5295             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  5296             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  5297             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  5298             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  5299             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  5300             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  5301             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  5302             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  5303         ELSE
  5304             MOVE PI-CALLING-PROGRAM    TO  RETURN-FROM
  5305             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  5306             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  5307             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  96
* EL1278.cbl
  5308             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  5309             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  5310             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  5311             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  5312             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  5313
  5314     IF EIBAID  IS EQUAL TO  DFHCLEAR
  5315         GO TO 9300-CLEAR.
  5316
  5317     IF PI-PROCESSOR-ID  IS EQUAL TO  'LGXX'
  5318         NEXT SENTENCE
  5319     ELSE
  5320
  5321* EXEC CICS READQ TS
  5322*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  5323*            INTO    (SECURITY-CONTROL)
  5324*            LENGTH  (SC-COMM-LENGTH)
  5325*            ITEM    (SC-ITEM)
  5326*        END-EXEC
  5327*    MOVE '*$II   L              ''   #00005316' TO DFHEIV0
  5328     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5329     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5330     MOVE X'2020233030303035333136' TO DFHEIV0(25:11)
  5331     CALL 'kxdfhei1' USING DFHEIV0,
  5332           PI-SECURITY-TEMP-STORE-ID,
  5333           SECURITY-CONTROL,
  5334           SC-COMM-LENGTH,
  5335           SC-ITEM,
  5336           DFHEIV99,
  5337           DFHEIV99
  5338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5339         MOVE SC-CREDIT-DISPLAY (33)
  5340                                 TO  PI-DISPLAY-CAP
  5341         MOVE SC-CREDIT-UPDATE  (33)
  5342                                 TO  PI-MODIFY-CAP
  5343         MOVE SC-CREDIT-UPDATE  (32)
  5344                                 TO  PI-MODIFY-CERT-CAP
  5345         IF NOT  DISPLAY-CAP
  5346             MOVE 'READ'         TO  SM-READ
  5347             PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5348             MOVE ER-0070        TO  EMI-ERROR
  5349             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5350             GO TO 8100-SEND-INITIAL-MAP.
  5351
  5352     IF EIBTRNID  IS NOT EQUAL TO  TRANS-ID
  5353         MOVE 'Y' TO WS-FIRST-ENTRY-SW
  5354         MOVE LOW-VALUES         TO  EL127HI
  5355         MOVE SAVE-BIN-DATE      TO  WS-LF-CANCEL-DATE
  5356                                     PI-LF-CANCEL-DATE
  5357                                     WS-AH-CANCEL-DATE
  5358                                     PI-AH-CANCEL-DATE
  5359         MOVE SAVE-DATE          TO  WS-LF-CANCEL-DATE-ED
  5360                                     PI-LF-CANCEL-DATE-ED
  5361                                     WS-AH-CANCEL-DATE-ED
  5362                                     PI-AH-CANCEL-DATE-ED
  5363         MOVE SPACES             TO  PI-EARNING-METHOD-LF
  5364                                     PI-EARNING-METHOD-AH
  5365         PERFORM 0500-FORMAT-SCREEN
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  97
* EL1278.cbl
  5366         GO TO 8100-SEND-INITIAL-MAP.
  5367
  5368     IF NOT  MODIFY-CAP
  5369         MOVE 'UPDATE'           TO  SM-READ
  5370         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5371         MOVE ER-0070            TO  EMI-ERROR
  5372         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5373         GO TO 8100-SEND-INITIAL-MAP.
  5374
  5375
  5376* EXEC CICS HANDLE CONDITION
  5377*        PGMIDERR  (9500-PGMID-ERROR)
  5378*        ERROR     (9900-ABEND)
  5379*    END-EXEC.
  5380*    MOVE '"$L.                  ! " #00005358' TO DFHEIV0
  5381     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5382     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5383     MOVE X'2220233030303035333538' TO DFHEIV0(25:11)
  5384     CALL 'kxdfhei1' USING DFHEIV0
  5385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5386
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  98
* EL1278.cbl
  5388 0200-RECEIVE.
  5389     IF EIBAID  IS EQUAL TO  DFHPA1  OR  DFHPA2  OR  DFHPA3
  5390         MOVE ER-0008            TO  EMI-ERROR
  5391         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5392         MOVE -1                 TO  HLCANCL
  5393         GO TO 8200-SEND-DATAONLY.
  5394
  5395
  5396* EXEC CICS RECEIVE
  5397*        MAP     (MAP-NAME)
  5398*        MAPSET  (MAPSET-NAME)
  5399*        INTO    (EL127HI)
  5400*    END-EXEC.
  5401     MOVE LENGTH OF
  5402      EL127HI
  5403       TO DFHEIV11
  5404*    MOVE '8"T I  L              ''   #00005370' TO DFHEIV0
  5405     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5406     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5407     MOVE X'2020233030303035333730' TO DFHEIV0(25:11)
  5408     CALL 'kxdfhei1' USING DFHEIV0,
  5409           MAP-NAME,
  5410           EL127HI,
  5411           DFHEIV11,
  5412           MAPSET-NAME,
  5413           DFHEIV99,
  5414           DFHEIV99
  5415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5416
  5417
  5418     IF HPFKEYL  IS EQUAL TO  ZERO
  5419         GO TO 0300-CHECK-PFKEYS.
  5420
  5421     IF EIBAID  IS NOT EQUAL TO  DFHENTER
  5422         MOVE ER-0004            TO  EMI-ERROR
  5423         GO TO 0320-INPUT-ERROR.
  5424
  5425     IF HPFKEYI NUMERIC
  5426         IF HPFKEYI  IS EQUAL TO  '12'  OR  '23'  OR  '24' OR '11'
  5427             MOVE PF-VALUES (HPFKEYI)
  5428                                 TO  EIBAID
  5429         ELSE
  5430             MOVE ER-0029        TO  EMI-ERROR
  5431             GO TO 0320-INPUT-ERROR.
  5432
  5433 0300-CHECK-PFKEYS.
  5434     IF EIBAID  IS EQUAL TO  DFHPF23
  5435         GO TO 8800-PF23.
  5436
  5437     IF EIBAID  IS EQUAL TO  DFHPF24
  5438         GO TO 9100-RETURN-MAIN-MENU.
  5439
  5440     IF EIBAID  IS EQUAL TO  DFHPF11 AND
  5441         PI-COMPANY-ID = 'NCL'
  5442         GO TO 1700-WRITE-CERT-NOTE.
  5443
  5444     IF EIBAID  IS EQUAL TO  DFHPF12
  5445         GO TO 9400-PF12.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page  99
* EL1278.cbl
  5446
  5447     IF EIBAID  IS EQUAL TO  DFHENTER
  5448         GO TO 0400-EDIT-INPUT-DATA.
  5449
  5450     MOVE ER-0029                TO  EMI-ERROR.
  5451
  5452 0320-INPUT-ERROR.
  5453     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  5454
  5455     MOVE AL-UNBON               TO  HPFKEYA.
  5456
  5457     IF HPFKEYL  IS EQUAL TO  ZERO
  5458         MOVE -1                 TO  HLCANCL
  5459     ELSE
  5460         MOVE -1                 TO  HPFKEYL.
  5461
  5462     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 100
* EL1278.cbl
  5464 0400-EDIT-INPUT-DATA.
  5465     MOVE 'N'                    TO  WS-NEW-AH-CANCEL-SW
  5466                                     WS-NEW-LF-CANCEL-SW.
  5467
  5468     IF (HPCYNL > 0)
  5469        AND (HPCYNI = 'Y' OR 'N')
  5470        PERFORM 1800-READ-ELCERT-UPDATE
  5471                                 THRU 1800-EXIT
  5472        IF WS-RESP-NORMAL
  5473           MOVE HPCYNI           TO CM-POST-CARD-IND
  5474           PERFORM 1810-REWRITE-ELCERT
  5475                                 THRU 1810-EXIT
  5476        END-IF
  5477     END-IF
  5478     IF HLCAL1L GREATER ZERO
  5479         MOVE HLCAL1I              TO  PI-EARNING-METHOD-LF.
  5480     IF CLPYNI = 'Y'
  5481        MOVE 'Y'                   TO PI-CLP-YN
  5482        MOVE AL-UANON              TO CLPYNA
  5483     ELSE
  5484        MOVE ' '                   TO PI-CLP-YN
  5485        MOVE AL-UANON              TO CLPYNA
  5486     END-IF
  5487     IF CANREAI = 'R'
  5488        MOVE 'R'                 TO PI-CANCEL-REASON
  5489        MOVE AL-UANON            TO CANREAA
  5490     ELSE
  5491        MOVE ' '                 TO PI-CANCEL-REASON
  5492        MOVE AL-UANON            TO CANREAA
  5493     END-IF
  5494
  5495     IF HLCANCL  IS EQUAL TO  ZERO
  5496       AND HACANCL  IS EQUAL TO  ZERO
  5497         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  5498         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  5499         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  5500         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  5501         GO TO 0420-CHECK-ERRORS.
  5502
  5503     IF HLCANCL  IS EQUAL TO  ZERO
  5504         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  5505         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  5506         GO TO 0410-CHECK-AH-DATE.
  5507
  5508     MOVE AL-UNNON               TO  HLCANCA.
  5509     MOVE HLCANCI                TO  DEEDIT-FIELD.
  5510     MOVE 'Y'                    TO  WS-NEW-LF-CANCEL-SW.
  5511
  5512     PERFORM 8600-DEEDIT.
  5513
  5514     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  5515     MOVE '4'                    TO  DC-OPTION-CODE.
  5516
  5517     PERFORM 9600-DATE-LINK.
  5518
  5519     IF DATE-CONVERSION-ERROR
  5520         MOVE -1                 TO  HLCANCL
  5521         MOVE AL-UABON           TO  HLCANCA
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 101
* EL1278.cbl
  5522         MOVE ER-2227            TO  EMI-ERROR
  5523         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5524     ELSE
  5525        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  5526           MOVE -1               TO  HACANCL
  5527           MOVE AL-UABON         TO  HACANCA
  5528           MOVE ER-2774          TO  EMI-ERROR
  5529           PERFORM 9700-ERROR-FORMAT
  5530                                 THRU  9799-EXIT
  5531        ELSE
  5532           MOVE DC-BIN-DATE-1    TO WS-LF-CANCEL-DATE
  5533                                    PI-LF-CANCEL-DATE
  5534           MOVE DC-GREG-DATE-1-EDIT
  5535                                 TO HLCANCO
  5536                                    WS-LF-CANCEL-DATE-ED
  5537                                    PI-LF-CANCEL-DATE-ED
  5538        END-IF
  5539     END-IF
  5540     .
  5541 0410-CHECK-AH-DATE.
  5542     IF HACAL1L GREATER ZERO
  5543         MOVE HACAL1I              TO  PI-EARNING-METHOD-AH.
  5544
  5545     IF HACANCL  IS EQUAL TO  ZERO
  5546         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  5547         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  5548         GO TO 0420-CHECK-ERRORS.
  5549
  5550     MOVE AL-UNNON               TO  HACANCA.
  5551     MOVE HACANCI                TO  DEEDIT-FIELD.
  5552     MOVE 'Y'                    TO  WS-NEW-AH-CANCEL-SW.
  5553
  5554     PERFORM 8600-DEEDIT.
  5555
  5556     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  5557     MOVE '4'                    TO  DC-OPTION-CODE.
  5558
  5559     PERFORM 9600-DATE-LINK.
  5560
  5561     IF DATE-CONVERSION-ERROR
  5562         MOVE -1                 TO  HACANCL
  5563         MOVE AL-UABON           TO  HACANCA
  5564         MOVE ER-2227            TO  EMI-ERROR
  5565         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5566     ELSE
  5567        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  5568           MOVE -1               TO  HACANCL
  5569           MOVE AL-UABON         TO  HACANCA
  5570           MOVE ER-2775          TO  EMI-ERROR
  5571           PERFORM 9700-ERROR-FORMAT
  5572                                 THRU  9799-EXIT
  5573        ELSE
  5574           MOVE DC-BIN-DATE-1    TO WS-AH-CANCEL-DATE
  5575                                    PI-AH-CANCEL-DATE
  5576           MOVE DC-GREG-DATE-1-EDIT
  5577                                 TO HACANCO
  5578                                    WS-AH-CANCEL-DATE-ED
  5579                                    PI-AH-CANCEL-DATE-ED
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 102
* EL1278.cbl
  5580        END-IF
  5581     END-IF
  5582     .
  5583 0420-CHECK-ERRORS.
  5584     IF EMI-ERROR  IS EQUAL TO  ZEROS
  5585         NEXT SENTENCE
  5586     ELSE
  5587         GO TO 8200-SEND-DATAONLY.
  5588
  5589     PERFORM 0500-FORMAT-SCREEN.
  5590
  5591     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 103
* EL1278.cbl
  5593 0500-FORMAT-SCREEN  SECTION.
  5594     MOVE LOW-VALUES             TO  EL127HO.
  5595     MOVE PI-CARRIER             TO  HCARIERO.
  5596     MOVE PI-GROUPING            TO  HGROUPO.
  5597     MOVE PI-STATE               TO  HSTATEO.
  5598     MOVE PI-ACCOUNT             TO  HACCTNOO.
  5599     MOVE ' '                    TO  DC-OPTION-CODE.
  5600     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5601
  5602     PERFORM 9600-DATE-LINK.
  5603
  5604     MOVE DC-GREG-DATE-1-EDIT    TO  HEFFDTO.
  5605     MOVE PI-CERT-PRIME          TO  HCERTNOO.
  5606     MOVE PI-CERT-SFX            TO  HCRTSFXO.
  5607     MOVE PI-CLP-YN              TO  CLPYNO
  5608     MOVE PI-CANCEL-REASON       TO  CANREAO
  5609     .
  5610 0510-GET-CERT.
  5611     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  5612     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  5613     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  5614     MOVE PI-STATE               TO  WS-CM-STATE.
  5615     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  5616     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  5617     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  5618     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  5619
  5620     PERFORM 0900-READ-CERT-FILE.
  5621
  5622     IF CERT-NOT-FOUND
  5623         MOVE -1                 TO  HLCANCL
  5624         MOVE AL-SANON           TO  HLCANCA
  5625         MOVE ER-0214            TO  EMI-ERROR
  5626         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5627         GO TO 8100-SEND-INITIAL-MAP.
  5628
  5629     IF CM-CLAIM-ATTACHED-COUNT = +0
  5630        GO TO 0510-SKIP-CLAIM-CHECK
  5631     END-IF
  5632*    DISPLAY ' STARTING CLAIM TEST '
  5633     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5634     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5635
  5636* EXEC CICS STARTBR
  5637*       DATASET     ('ELMSTR5')
  5638*       RIDFLD      (ELMSTR-KEY)
  5639*       RESP        (WS-RESPONSE)
  5640*    END-EXEC
  5641     MOVE 'ELMSTR5' TO DFHEIV1
  5642     MOVE 0
  5643       TO DFHEIV11
  5644*    MOVE '&,         G          &  N#00005593' TO DFHEIV0
  5645     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5646     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5647     MOVE X'204E233030303035353933' TO DFHEIV0(25:11)
  5648     CALL 'kxdfhei1' USING DFHEIV0,
  5649           DFHEIV1,
  5650           ELMSTR-KEY,
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 104
* EL1278.cbl
  5651           DFHEIV99,
  5652           DFHEIV11,
  5653           DFHEIV99
  5654     MOVE EIBRESP  TO WS-RESPONSE
  5655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5656     IF WS-RESP-NORMAL
  5657     PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5658
  5659* EXEC CICS READNEXT
  5660*          DATASET   ('ELMSTR5')
  5661*          RIDFLD    (ELMSTR-KEY)
  5662*          SET       (ADDRESS OF CLAIM-MASTER)
  5663*          RESP      (WS-RESPONSE)
  5664*       END-EXEC
  5665     MOVE 'ELMSTR5' TO DFHEIV1
  5666     MOVE 0
  5667       TO DFHEIV11
  5668*    MOVE '&.S                   )  N#00005600' TO DFHEIV0
  5669     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5670     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5671     MOVE X'204E233030303035363030' TO DFHEIV0(25:11)
  5672     CALL 'kxdfhei1' USING DFHEIV0,
  5673           DFHEIV1,
  5674           DFHEIV20,
  5675           DFHEIV99,
  5676           ELMSTR-KEY,
  5677           DFHEIV99,
  5678           DFHEIV11,
  5679           DFHEIV99,
  5680           DFHEIV99
  5681     SET ADDRESS OF CLAIM-MASTER TO
  5682         DFHEIV20
  5683     MOVE EIBRESP  TO WS-RESPONSE
  5684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5685        IF (WS-RESP-NORMAL OR WS-RESP-DUPKEY)
  5686           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  5687           AND (CM-CERT-NO = CL-CERT-NO)
  5688           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  5689              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  5690              SET FOUND-A-CLAIM  TO TRUE
  5691              IF CL-CLAIM-TYPE = 'L'
  5692                 IF CL-INCURRED-DT > WS-LF-INCUR-DT
  5693                    MOVE CL-INCURRED-DT TO WS-LF-INCUR-DT
  5694                 END-IF
  5695                 IF CLAIM-IS-OPEN
  5696                    SET OPEN-LF-CLAIM TO TRUE
  5697                 ELSE
  5698                    IF CL-LAST-CLOSE-DT > WS-LF-LAST-CLOSE-DT
  5699                       MOVE CL-LAST-CLOSE-DT
  5700                                 TO WS-LF-LAST-CLOSE-DT
  5701                    END-IF
  5702                    SET CLOSED-LF-CLAIM TO TRUE
  5703                 END-IF
  5704              ELSE
  5705                 IF CLAIM-IS-OPEN
  5706                    MOVE CL-PAID-THRU-DT
  5707                                 TO WS-AH-PAID-THRU-DT
  5708                    SET OPEN-AH-CLAIM TO TRUE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 105
* EL1278.cbl
  5709                 ELSE
  5710                    IF CL-PAID-THRU-DT > WS-AH-PAID-THRU-DT
  5711                       MOVE CL-PAID-THRU-DT
  5712                                 TO WS-AH-PAID-THRU-DT
  5713                    END-IF
  5714                    IF CL-LAST-CLOSE-DT > WS-AH-LAST-CLOSE-DT
  5715                       MOVE CL-LAST-CLOSE-DT
  5716                                 TO WS-AH-LAST-CLOSE-DT
  5717                    END-IF
  5718                    SET CLOSED-AH-CLAIM TO TRUE
  5719                 END-IF
  5720              END-IF
  5721           END-IF
  5722        ELSE
  5723           SET I-SAY-TO-STOP TO TRUE
  5724        END-IF
  5725     END-PERFORM
  5726     END-IF
  5727     IF FOUND-A-CLAIM
  5728        IF WS-LF-INCUR-DT NOT = LOW-VALUES
  5729           MOVE WS-LF-INCUR-DT   TO DC-BIN-DATE-1
  5730           MOVE ' '              TO DC-OPTION-CODE
  5731           PERFORM 9600-DATE-LINK
  5732           IF NO-CONVERSION-ERROR
  5733              MOVE DC-GREG-DATE-1-EDIT TO LCLMDTO
  5734              MOVE AL-SANOF      TO LCLMDTHA
  5735           END-IF
  5736        END-IF
  5737        IF WS-AH-PAID-THRU-DT NOT = LOW-VALUES
  5738           MOVE WS-AH-PAID-THRU-DT TO DC-BIN-DATE-1
  5739           MOVE ' '              TO DC-OPTION-CODE
  5740           PERFORM 9600-DATE-LINK
  5741           IF NO-CONVERSION-ERROR
  5742              MOVE DC-GREG-DATE-1-EDIT TO ACLMDTO
  5743              MOVE AL-SANOF      TO ACLMDTHA
  5744           END-IF
  5745        END-IF
  5746        MOVE PI-COMPANY-ID       TO WS-CF-COMPANY-ID
  5747        MOVE '3'                 TO WS-CF-RECORD-TYPE
  5748        MOVE CM-STATE            TO WS-CF-ACCESS
  5749        MOVE +0                  TO WS-CF-SEQUENCE-NO
  5750
  5751* EXEC CICS READ
  5752*          DATASET  (ELCNTL-ID)
  5753*          SET      (ADDRESS OF CONTROL-FILE)
  5754*          RIDFLD   (WS-CF-CONTROL-PRIMARY)
  5755*          RESP     (WS-RESPONSE)
  5756*       END-EXEC
  5757*    MOVE '&"S        E          (  N#00005671' TO DFHEIV0
  5758     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5759     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5760     MOVE X'204E233030303035363731' TO DFHEIV0(25:11)
  5761     CALL 'kxdfhei1' USING DFHEIV0,
  5762           ELCNTL-ID,
  5763           DFHEIV20,
  5764           DFHEIV99,
  5765           WS-CF-CONTROL-PRIMARY,
  5766           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 106
* EL1278.cbl
  5767           DFHEIV99,
  5768           DFHEIV99
  5769     SET ADDRESS OF CONTROL-FILE TO
  5770         DFHEIV20
  5771     MOVE EIBRESP  TO WS-RESPONSE
  5772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5773        IF WS-RESP-NORMAL
  5774           MOVE CF-ST-REF-AH-DEATH-IND
  5775                                 TO WS-ST-REF-IND
  5776        END-IF
  5777     END-IF
  5778     .
  5779 0510-SKIP-CLAIM-CHECK.
  5780     MOVE CM-INSURED-LAST-NAME   TO  HLNAMEO.
  5781     MOVE CM-INSURED-FIRST-NAME  TO  HFNAMEO.
  5782     MOVE CM-INSURED-INITIAL2    TO  HINITO.
  5783     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  5784
  5785* EXEC CICS READ
  5786*        DATASET  (ERMAIL-ID)
  5787*        RIDFLD   (WS-MA-CONTROL-PRIMARY)
  5788*        SET      (ADDRESS OF MAILING-DATA)
  5789*        RESP     (WS-RESPONSE)
  5790*    END-EXEC.
  5791*    MOVE '&"S        E          (  N#00005688' TO DFHEIV0
  5792     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5793     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5794     MOVE X'204E233030303035363838' TO DFHEIV0(25:11)
  5795     CALL 'kxdfhei1' USING DFHEIV0,
  5796           ERMAIL-ID,
  5797           DFHEIV20,
  5798           DFHEIV99,
  5799           WS-MA-CONTROL-PRIMARY,
  5800           DFHEIV99,
  5801           DFHEIV99,
  5802           DFHEIV99
  5803     SET ADDRESS OF MAILING-DATA TO
  5804         DFHEIV20
  5805     MOVE EIBRESP  TO WS-RESPONSE
  5806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5807
  5808     IF WS-RESP-NORMAL
  5809        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5810           (S1 > +7)
  5811           OR (MA-MAIL-STATUS (S1) = '1')
  5812        END-PERFORM
  5813        IF S1 > +7
  5814           MOVE AL-SANOF         TO HPCYNA
  5815        END-IF
  5816     END-IF
  5817     IF CM-POST-CARD-IND = 'Y'
  5818        MOVE 'Y'                 TO HPCYNO
  5819     ELSE
  5820        MOVE 'N'                 TO HPCYNO
  5821     END-IF
  5822     IF ('8' NOT = CM-LF-CURRENT-STATUS AND CM-AH-CURRENT-STATUS)
  5823        OR (NOT CERT-AS-LOADED)
  5824        MOVE AL-SANOF            TO HPCYNA
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 107
* EL1278.cbl
  5825     END-IF
  5826*    IF (CERT-ADDED-BATCH)
  5827*       CONTINUE
  5828*    ELSE
  5829*       MOVE AL-SANOF            TO HPCYNA
  5830*    END-IF
  5831     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5832     MOVE '5'                    TO  DC-OPTION-CODE.
  5833
  5834     PERFORM 9600-DATE-LINK.
  5835
  5836     MOVE DC-BIN-DATE-1          TO  DC-BIN-DATE-2.
  5837     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5838     MOVE '1'                    TO  DC-OPTION-CODE.
  5839
  5840     PERFORM 9600-DATE-LINK.
  5841
  5842     MOVE DC-ELAPSED-MONTHS      TO  WS-ELAPSED-MONTHS.
  5843
  5844     MOVE ZEROS TO WS-TOT-ITDR.
  5845     MOVE WS-REFUND-DESCRIP TO PMTHDO.
  5846
  5847 0510-CHECK-LF-STATUS.
  5848
  5849     IF (CM-LF-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  5850         MOVE LOW-VALUES         TO WS-LF-CANCEL-DATE
  5851                                    PI-LF-CANCEL-DATE
  5852         MOVE SPACES             TO WS-LF-CANCEL-DATE-ED
  5853                                    PI-LF-CANCEL-DATE-ED
  5854                                    PI-LF-REFUND-METH
  5855         MOVE ZEROS              TO PI-LF-REFUND-AMT
  5856         GO TO 0510-CHECK-AH-STATUS.
  5857
  5858     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '8') AND
  5859        (CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  5860          MOVE CM-LF-ITD-CANCEL-AMT TO HLITDRO
  5861          ADD  CM-LF-ITD-CANCEL-AMT TO WS-TOT-ITDR
  5862          IF FIRST-ENTRY
  5863              MOVE CM-LF-CANCEL-DT      TO DC-BIN-DATE-1
  5864              MOVE SPACES               TO DC-OPTION-CODE
  5865              PERFORM 9600-DATE-LINK
  5866              IF NOT DATE-CONVERSION-ERROR
  5867                   MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  5868                                            PI-LF-CANCEL-DATE-ED
  5869                                            WS-LF-CANCEL-DATE-ED
  5870                   MOVE CM-LF-CANCEL-DT TO  PI-LF-CANCEL-DATE
  5871                                            WS-LF-CANCEL-DATE.
  5872
  5873     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '7')  AND
  5874        (CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES)
  5875          MOVE WS-PMT-DESCRIP       TO PMTHDO
  5876          MOVE CM-LF-ITD-DEATH-AMT  TO HLITDRO
  5877          ADD  CM-LF-ITD-DEATH-AMT TO WS-TOT-ITDR
  5878        IF FIRST-ENTRY
  5879            MOVE CM-LF-DEATH-DT       TO DC-BIN-DATE-1
  5880            MOVE SPACES               TO DC-OPTION-CODE
  5881            PERFORM 9600-DATE-LINK
  5882            IF NOT DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 108
* EL1278.cbl
  5883                 MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  5884                                          PI-LF-CANCEL-DATE-ED
  5885                                          WS-LF-CANCEL-DATE-ED
  5886                 MOVE CM-LF-DEATH-DT  TO  PI-LF-CANCEL-DATE
  5887                                          WS-LF-CANCEL-DATE.
  5888
  5889 0510-CHECK-AH-STATUS.
  5890
  5891     IF (CM-AH-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  5892         MOVE LOW-VALUES         TO WS-AH-CANCEL-DATE
  5893                                    PI-AH-CANCEL-DATE
  5894         MOVE SPACES             TO WS-AH-CANCEL-DATE-ED
  5895                                    PI-AH-CANCEL-DATE-ED
  5896                                    PI-AH-REFUND-METH
  5897         MOVE ZEROS              TO PI-AH-REFUND-AMT
  5898         GO TO 0510-CONT.
  5899
  5900     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '8')  AND
  5901        (CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  5902          MOVE CM-AH-ITD-CANCEL-AMT TO HAITDRO
  5903          ADD  CM-AH-ITD-CANCEL-AMT TO WS-TOT-ITDR
  5904        IF FIRST-ENTRY
  5905            MOVE CM-AH-CANCEL-DT      TO DC-BIN-DATE-1
  5906            MOVE SPACES               TO DC-OPTION-CODE
  5907            PERFORM 9600-DATE-LINK
  5908            IF NOT DATE-CONVERSION-ERROR
  5909                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  5910                                            PI-AH-CANCEL-DATE-ED
  5911                                            WS-AH-CANCEL-DATE-ED
  5912                 MOVE CM-AH-CANCEL-DT  TO   PI-AH-CANCEL-DATE
  5913                                            WS-AH-CANCEL-DATE.
  5914
  5915     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '6' OR '7')   AND
  5916        (CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES)
  5917          MOVE WS-PMT-DESCRIP       TO PMTHDO
  5918          MOVE CM-AH-ITD-LUMP-PMT   TO HAITDRO
  5919          ADD  CM-AH-ITD-LUMP-PMT   TO WS-TOT-ITDR
  5920         IF FIRST-ENTRY
  5921             MOVE CM-AH-SETTLEMENT-DT  TO DC-BIN-DATE-1
  5922             MOVE SPACES               TO DC-OPTION-CODE
  5923             PERFORM 9600-DATE-LINK
  5924             IF NOT DATE-CONVERSION-ERROR
  5925                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  5926                                            PI-AH-CANCEL-DATE-ED
  5927                                            WS-AH-CANCEL-DATE-ED
  5928                MOVE CM-AH-SETTLEMENT-DT TO PI-AH-CANCEL-DATE
  5929                                            WS-AH-CANCEL-DATE.
  5930
  5931     IF CM-AH-CURRENT-STATUS IS EQUAL TO '8'
  5932         MOVE 'CANC DT'              TO  CNCDTHDO
  5933         GO TO 0510-CONT.
  5934
  5935     IF CM-LF-CURRENT-STATUS IS EQUAL TO '7'
  5936         MOVE 'DTH DT '              TO  CNCDTHDO
  5937         IF FIRST-ENTRY
  5938             MOVE CM-LF-DEATH-DT     TO  DC-BIN-DATE-1
  5939             MOVE ' '                TO  DC-OPTION-CODE
  5940             PERFORM 9600-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 109
* EL1278.cbl
  5941             IF NOT DATE-CONVERSION-ERROR
  5942                 MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  5943                                             PI-AH-CANCEL-DATE-ED
  5944                                             WS-AH-CANCEL-DATE-ED
  5945                 MOVE CM-LF-DEATH-DT      TO PI-AH-CANCEL-DATE
  5946                                             WS-AH-CANCEL-DATE.
  5947
  5948 0510-CONT.
  5949
  5950     IF WS-TOT-ITDR GREATER THAN ZEROS
  5951         MOVE WS-TOT-ITDR TO TOITDRO.
  5952
  5953 0520-GET-COMPANY-RECORD.
  5954     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  5955     MOVE '1'                    TO  WS-CF-RECORD-TYPE.
  5956     MOVE SPACES                 TO  WS-CF-ACCESS.
  5957     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  5958
  5959     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  5960
  5961     IF CNTL-NOT-FOUND
  5962         MOVE -1                 TO  HLCANCL
  5963         MOVE AL-SANON           TO  HLCANCA
  5964         MOVE ER-2616            TO  EMI-ERROR
  5965         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5966         GO TO 8100-SEND-INITIAL-MAP.
  5967
  5968     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  5969       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  5970         MOVE CF-LIFE-OVERRIDE-L1
  5971                                 TO  WS-CF-LIFE-OVERRIDE-L1
  5972         MOVE CF-LIFE-OVERRIDE-L2
  5973                                 TO  WS-CF-LIFE-OVERRIDE-L2
  5974         MOVE CF-AH-OVERRIDE-L1  TO  WS-CF-AH-OVERRIDE-L1
  5975         MOVE CF-AH-OVERRIDE-L2  TO  WS-CF-AH-OVERRIDE-L2
  5976         MOVE CF-CR-REM-TERM-CALC
  5977                                 TO  WS-CF-CR-REM-TERM-CALC
  5978         MOVE CF-CR-R78-METHOD   TO  WS-CF-CR-R78-METHOD
  5979         IF CF-DEFAULT-APR NUMERIC
  5980             MOVE CF-DEFAULT-APR     TO  WS-CF-DEFAULT-APR
  5981             GO TO 0525-GET-LF-BENEFIT
  5982         ELSE
  5983             MOVE ZEROS              TO  WS-CF-DEFAULT-APR
  5984             GO TO 0525-GET-LF-BENEFIT.
  5985
  5986     MOVE -1                     TO  HLCANCL.
  5987     MOVE AL-SANON               TO  HLCANCA.
  5988     MOVE ER-2616                TO  EMI-ERROR.
  5989
  5990     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  5991
  5992     GO TO 8100-SEND-INITIAL-MAP.
  5993
  5994 0525-GET-LF-BENEFIT.
  5995
  5996     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  5997        GO TO 0527-GET-AH-BENEFIT
  5998     END-IF
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 110
* EL1278.cbl
  5999
  6000     MOVE '4'                    TO  WS-CF-RECORD-TYPE.
  6001     MOVE CM-LF-BENEFIT-CD       TO  WS-BENEFIT-NO
  6002                                     HLCDO.
  6003     MOVE WS-CF-LIFE-OVERRIDE-L2
  6004                                 TO  HLKINDO.
  6005
  6006     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6007
  6008     IF BENEFIT-FOUND
  6009         NEXT SENTENCE
  6010     ELSE
  6011         MOVE -1                 TO  HLCDL
  6012         MOVE AL-SANON           TO  HLCDA
  6013         MOVE ER-0028            TO  EMI-ERROR
  6014         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6015         GO TO 8100-SEND-INITIAL-MAP.
  6016
  6017     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6018         MOVE AL-UNNOF           TO  HLTERMA.
  6019
  6020*****MOVE WS-BENEFIT-DESCRIP     TO  HLDESCO.
  6021     MOVE CF-LF-COVERAGE-TYPE (WS-INDEX)
  6022                                 TO  WS-CF-LF-COVERAGE-TYPE.
  6023
  6024     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6025         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6026                                 TO  WS-LF-CO-REM-TERM-CALC.
  6027
  6028     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6029         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6030                                 TO  WS-LF-CO-EARNINGS-CALC
  6031                                     WS-LF-CO-REFUND-CALC.
  6032
  6033     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6034         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6035                                 TO  WS-LF-SPECIAL-CALC-CD.
  6036
  6037     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6038         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6039                                 TO  WS-LF-CO-REFUND-CALC.
  6040
  6041 0527-GET-AH-BENEFIT.
  6042
  6043     IF CM-AH-BENEFIT-CD = '00' OR '  '
  6044        GO TO 0530-GET-STATE-RECORD
  6045     END-IF
  6046
  6047     MOVE '5'                    TO  WS-CF-RECORD-TYPE.
  6048     MOVE CM-AH-BENEFIT-CD       TO  WS-BENEFIT-NO
  6049                                     HACDO.
  6050     MOVE WS-CF-AH-OVERRIDE-L2   TO  HAKINDO.
  6051
  6052     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6053
  6054     IF BENEFIT-FOUND
  6055         NEXT SENTENCE
  6056     ELSE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 111
* EL1278.cbl
  6057         MOVE -1                 TO  HACDL
  6058         MOVE AL-SANON           TO  HACDA
  6059         MOVE ER-0028            TO  EMI-ERROR
  6060         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6061         GO TO 8100-SEND-INITIAL-MAP.
  6062
  6063     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6064         MOVE AL-UNNOF           TO  HATERMA.
  6065
  6066*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  6067
  6068     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6069         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6070                                 TO  WS-AH-CO-REM-TERM-CALC.
  6071
  6072     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6073         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6074                                 TO  WS-AH-CO-EARNINGS-CALC
  6075                                     WS-AH-CO-REFUND-CALC.
  6076
  6077     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6078         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6079                                 TO  WS-AH-SPECIAL-CALC-CD.
  6080
  6081     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6082         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6083                                 TO  WS-AH-CO-REFUND-CALC.
  6084     IF CF-BENEFIT-CATEGORY (WS-INDEX) > ' '
  6085        MOVE CF-BENEFIT-CATEGORY (WS-INDEX)
  6086                                 TO WS-AH-BEN-CATEGORY
  6087     END-IF
  6088     .
  6089 0530-GET-STATE-RECORD.
  6090     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6091     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  6092     MOVE CM-STATE               TO  WS-CF-ACCESS.
  6093     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6094
  6095     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6096
  6097     IF CNTL-NOT-FOUND
  6098         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6099                                     WS-LF-ST-REM-TERM-CALC
  6100         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6101         GO TO 0560-FIND-ACCOUNT.
  6102
  6103     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6104       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6105       AND CM-STATE  IS EQUAL TO  CF-STATE-CODE
  6106         MOVE 'Y'                TO  WS-STATE-RECORD-SW
  6107     ELSE
  6108         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6109                                     WS-LF-ST-REM-TERM-CALC
  6110         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6111         GO TO 0560-FIND-ACCOUNT.
  6112
  6113     MOVE CF-STATE-ABBREVIATION  TO  WS-STATE-ABBREVIATION.
  6114     MOVE CF-ST-FST-PMT-DAYS-CHG TO  WS-STATE-EXT-DAYS-CHG
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 112
* EL1278.cbl
  6115
  6116     IF CM-LF-BENEFIT-CD  = '00'
  6117         GO TO 0550-GET-AH-BEN-IN-STATE.
  6118
  6119 0540-GET-LF-BEN-IN-STATE.
  6120     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  6121     MOVE PI-LIFE-OVERRIDE-L1    TO  WS-LOOKUP-TYPE.
  6122
  6123     MOVE '0'                    TO WS-LF-ST-REM-TERM-CALC
  6124     IF CF-ST-RT-CALC NOT = SPACES
  6125        MOVE CF-ST-RT-CALC       TO WS-LF-ST-REM-TERM-CALC
  6126     END-IF
  6127
  6128     IF WS-CF-LF-COVERAGE-TYPE = 'R'
  6129        IF CF-ST-RF-LR-CALC > '0'
  6130           MOVE CF-ST-RF-LR-CALC TO WS-LF-ST-REFUND-CALC
  6131        END-IF
  6132        IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  6133           IF CF-ST-RF-LN-CALC > '0'
  6134              MOVE CF-ST-RF-LN-CALC
  6135                                 TO WS-LF-ST-REFUND-CALC
  6136           END-IF
  6137        END-IF
  6138     ELSE
  6139        IF CF-ST-RF-LL-CALC > '0'
  6140           MOVE CF-ST-RF-LL-CALC TO WS-LF-ST-REFUND-CALC
  6141        END-IF
  6142     END-IF
  6143
  6144     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6145
  6146     IF NO-BENEFIT-FOUND
  6147*        MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6148         GO TO 0550-GET-AH-BEN-IN-STATE.
  6149
  6150     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6151         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6152                                 TO  WS-LF-ST-REM-TERM-CALC.
  6153
  6154     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6155         MOVE CF-ST-REFUND-CALC (SUB3)
  6156                                 TO  WS-LF-ST-REFUND-CALC.
  6157
  6158 0550-GET-AH-BEN-IN-STATE.
  6159     IF CM-AH-BENEFIT-CD  = '00'
  6160         GO TO 0560-FIND-ACCOUNT.
  6161
  6162     MOVE '0'                    TO WS-AH-ST-REM-TERM-CALC
  6163     IF CF-ST-RT-CALC NOT = SPACES
  6164        MOVE CF-ST-RT-CALC       TO WS-AH-ST-REM-TERM-CALC
  6165     END-IF
  6166
  6167     IF CF-ST-RF-AH-CALC > '0'
  6168        MOVE CF-ST-RF-AH-CALC    TO WS-AH-ST-REFUND-CALC
  6169     END-IF
  6170     IF WS-AH-SPECIAL-CALC-CD = 'C'
  6171        IF CF-ST-RF-CP-CALC > '0'
  6172           MOVE CF-ST-RF-CP-CALC TO WS-AH-ST-REFUND-CALC
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 113
* EL1278.cbl
  6173        END-IF
  6174     END-IF
  6175
  6176     MOVE CM-AH-BENEFIT-CD       TO  WS-BEN-CD.
  6177     MOVE PI-AH-OVERRIDE-L1      TO  WS-LOOKUP-TYPE.
  6178
  6179     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6180
  6181     IF NO-BENEFIT-FOUND
  6182*        MOVE '0'                TO  WS-AH-ST-REFUND-CALC
  6183         GO TO 0560-FIND-ACCOUNT.
  6184
  6185     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6186         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6187                                 TO  WS-AH-ST-REM-TERM-CALC.
  6188
  6189     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6190         MOVE CF-ST-REFUND-CALC (SUB3)
  6191                                 TO  WS-AH-ST-REFUND-CALC.
  6192
  6193 0560-FIND-ACCOUNT.
  6194     MOVE CM-COMPANY-CD          TO  WS-AM-COMPANY-CD.
  6195     MOVE CM-CARRIER             TO  WS-AM-CARRIER.
  6196     MOVE CM-GROUPING            TO  WS-AM-GROUPING.
  6197     MOVE CM-STATE               TO  WS-AM-STATE.
  6198     MOVE CM-ACCOUNT             TO  WS-AM-ACCOUNT.
  6199     MOVE CM-CERT-EFF-DT         TO  WS-AM-EXPIRATION-DT.
  6200     MOVE LOW-VALUES             TO  WS-AM-FILLER.
  6201
  6202     PERFORM 1200-START-ACCOUNT-MASTER  THRU  1299-EXIT.
  6203
  6204     IF ACCT-FOUND
  6205         NEXT SENTENCE
  6206     ELSE
  6207         GO TO 0585-NO-ACCT.
  6208
  6209 0570-READ-NEXT-RANGE.
  6210     PERFORM 1300-READ-ACCOUNT-MASTER  THRU  1399-EXIT.
  6211
  6212     IF ACCT-FOUND
  6213         NEXT SENTENCE
  6214     ELSE
  6215         GO TO 0580-ACCT-NOT-FOUND.
  6216
  6217     IF CM-COMPANY-CD  IS EQUAL TO  AM-COMPANY-CD
  6218       AND CM-CARRIER  IS EQUAL TO  AM-CARRIER
  6219       AND CM-GROUPING  IS EQUAL TO  AM-GROUPING
  6220       AND CM-STATE  IS EQUAL TO  AM-STATE
  6221       AND CM-ACCOUNT  IS EQUAL TO  AM-ACCOUNT
  6222         NEXT SENTENCE
  6223     ELSE
  6224         GO TO 0580-ACCT-NOT-FOUND.
  6225
  6226     MOVE 'X'                    TO  DATE-RANGE-SW.
  6227
  6228     IF CM-CERT-EFF-DT  IS LESS THAN  AM-EFFECTIVE-DT
  6229         MOVE 'X'                TO  DATE-RANGE-SW
  6230         GO TO 0580-ACCT-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 114
* EL1278.cbl
  6231
  6232     IF CM-CERT-EFF-DT  IS NOT LESS THAN  AM-EXPIRATION-DT
  6233         GO TO 0570-READ-NEXT-RANGE.
  6234
  6235     MOVE ' '                    TO  DATE-RANGE-SW.
  6236     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  6237
  6238     GO TO 0590-SET-ACCOUNT.
  6239
  6240 0580-ACCT-NOT-FOUND.
  6241     IF DATE-RANGE-SW  IS NOT EQUAL TO  SPACES
  6242         MOVE ER-2601            TO  EMI-ERROR
  6243     ELSE
  6244         MOVE ER-2619            TO  EMI-ERROR.
  6245
  6246     MOVE 'N'                    TO  WS-ACCT-RECORD-SW.
  6247
  6248     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6249
  6250 0585-NO-ACCT.
  6251     MOVE SPACES                 TO  WS-ACCT-USER-FLD-5.
  6252     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  6253                                     WS-AM-EARN-METHOD-R
  6254                                     WS-AM-EARN-METHOD-A
  6255                                     WS-LF-AM-REM-TERM-CALC
  6256                                     WS-AH-AM-REM-TERM-CALC.
  6257
  6258     GO TO 0600-CHECK-FOR-LIFE.
  6259
  6260 0590-SET-ACCOUNT.
  6261******************************************************************
  6262******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  6263******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  6264******* METHODS.
  6265******************************************************************
  6266     MOVE SPACES              TO WS-LF-FO-REFUND-CALC.
  6267     MOVE SPACES              TO WS-AH-FO-REFUND-CALC.
  6268     IF PI-COMPANY-ID EQUAL TO 'NCL'
  6269          IF ((CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  6270                 OR (CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  6271                  PERFORM 7000-GET-ERFORM THRU 7000-EXIT
  6272                  IF FORM-FOUND
  6273                      PERFORM 7100-BENEFIT-SEARCH THRU 7100-EXIT.
  6274******************************************************************
  6275
  6276     MOVE AM-FLD-5               TO  WS-ACCT-USER-FLD-5.
  6277     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  6278                                     WS-AM-EARN-METHOD-R
  6279                                     WS-AM-EARN-METHOD-A.
  6280
  6281*    EVALUATE AM-EARN-METHOD-R
  6282*       WHEN 'R'
  6283*           MOVE '1'                TO  WS-AM-EARN-METHOD-R
  6284*       WHEN 'P'
  6285*           MOVE '2'                TO  WS-AM-EARN-METHOD-R
  6286*       WHEN 'C'
  6287*           MOVE '3'                TO  WS-AM-EARN-METHOD-R
  6288*       WHEN 'A'
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 115
* EL1278.cbl
  6289*           MOVE '6'                TO  WS-AM-EARN-METHOD-R
  6290*       WHEN 'M'
  6291*           MOVE '8'                TO  WS-AM-EARN-METHOD-R
  6292*       WHEN 'S'
  6293*           MOVE '9'                TO  WS-AM-EARN-METHOD-R
  6294*    END-EVALUATE.
  6295
  6296*    EVALUATE AM-EARN-METHOD-L
  6297*       WHEN 'R'
  6298*           MOVE '1'                TO  WS-AM-EARN-METHOD-L
  6299*       WHEN 'P'
  6300*           MOVE '2'                TO  WS-AM-EARN-METHOD-L
  6301*       WHEN 'C'
  6302*           MOVE '3'                TO  WS-AM-EARN-METHOD-L
  6303*       WHEN 'A'
  6304*           MOVE '6'                TO  WS-AM-EARN-METHOD-L
  6305*       WHEN 'M'
  6306*           MOVE '8'                 TO  WS-AM-EARN-METHOD-L
  6307*       WHEN 'S'
  6308*           MOVE '9'                 TO  WS-AM-EARN-METHOD-L
  6309*    END-EVALUATE.
  6310
  6311*    EVALUATE AM-EARN-METHOD-A
  6312*       WHEN 'R'
  6313*           MOVE '1'                TO  WS-AM-EARN-METHOD-A
  6314*       WHEN 'P'
  6315*           MOVE '2'                TO  WS-AM-EARN-METHOD-A
  6316*       WHEN 'C'
  6317*           MOVE '3'                TO  WS-AM-EARN-METHOD-A
  6318*       WHEN 'A'
  6319*           MOVE '6'                TO  WS-AM-EARN-METHOD-A
  6320*       WHEN 'M'
  6321*           MOVE '8'                TO  WS-AM-EARN-METHOD-A
  6322*       WHEN 'N'
  6323*           MOVE '5'                TO  WS-AM-EARN-METHOD-A
  6324*       WHEN 'S'
  6325*           MOVE '9'                TO  WS-AM-EARN-METHOD-A
  6326*    END-EVALUATE.
  6327
  6328     MOVE ZEROS                  TO  WS-TOT-AH-PREM
  6329                                     WS-TOT-LF-PREM
  6330                                     WS-TOT-AH-RFND
  6331                                     WS-TOT-LF-RFND.
  6332
  6333 0600-CHECK-FOR-LIFE.
  6334     IF CM-LF-BENEFIT-CD  = '00'
  6335         GO TO 0640-AH-BENEFIT.
  6336
  6337 0610-GET-LIFE-BENEFIT.
  6338
  6339     IF ACCT-FOUND
  6340         MOVE +1                 TO SUB3
  6341         PERFORM 5000-GET-LF-AM-REM-TERM THRU 5900-EXIT.
  6342     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  6343     MOVE WS-KIND                TO  HLEDESCO.
  6344     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  6345     IF WS-LF-CO-EARNINGS-CALC = 'B'
  6346        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 116
* EL1278.cbl
  6347                             + CM-LF-ALT-PREMIUM-AMT
  6348     ELSE
  6349        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  6350     END-IF
  6351
  6352     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  6353     EVALUATE TRUE
  6354        WHEN ((OPEN-LF-CLAIM)
  6355           OR (CLOSED-LF-CLAIM))
  6356           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  6357           MOVE ZEROS            TO HLREFNDO  WS-CALC-REFUND
  6358                                    WS-TOT-LF-RFND
  6359                                    PI-LF-REFUND-AMT
  6360           IF CM-AH-BENEFIT-CD NOT = '00'
  6361              MOVE ZEROS         TO HAREFNDO
  6362                                    WS-TOT-AH-RFND
  6363                                    PI-AH-REFUND-AMT
  6364              MOVE SPACES        TO PI-AH-REFUND-METH
  6365           END-IF
  6366           MOVE ER-2965          TO EMI-ERROR
  6367           PERFORM 9700-ERROR-FORMAT
  6368                                 THRU  9799-EXIT
  6369           GO TO 0640-AH-BENEFIT
  6370        WHEN OPEN-LF-CLAIM
  6371           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6372           AND WS-ST-REF-IND = '4'
  6373           MOVE ER-2966          TO EMI-ERROR
  6374           PERFORM 9700-ERROR-FORMAT
  6375                                 THRU  9799-EXIT
  6376        WHEN OPEN-LF-CLAIM
  6377           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6378           AND WS-ST-REF-IND NOT = '4'
  6379           MOVE ER-2967          TO EMI-ERROR
  6380           PERFORM 9700-ERROR-FORMAT
  6381                                 THRU  9799-EXIT
  6382           GO TO 0640-AH-BENEFIT
  6383        WHEN CLOSED-LF-CLAIM
  6384           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6385           AND WS-ST-REF-IND = '4'
  6386           MOVE ER-2968          TO EMI-ERROR
  6387           PERFORM 9700-ERROR-FORMAT
  6388                                 THRU  9799-EXIT
  6389        WHEN CLOSED-LF-CLAIM
  6390           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6391           AND WS-ST-REF-IND NOT = '4'
  6392           MOVE ER-2969          TO EMI-ERROR
  6393           PERFORM 9700-ERROR-FORMAT
  6394                                 THRU  9799-EXIT
  6395           GO TO 0640-AH-BENEFIT
  6396        WHEN OTHER
  6397           CONTINUE
  6398     END-EVALUATE
  6399     .
  6400 0620-GET-REM-TERM.
  6401     MOVE WS-CF-LIFE-OVERRIDE-L1
  6402                                 TO  CP-LIFE-OVERRIDE-CODE.
  6403     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  6404     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 117
* EL1278.cbl
  6405     MOVE WS-LF-CANCEL-DATE      TO  CP-VALUATION-DT.
  6406     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  6407     MOVE CM-STATE               TO  CP-STATE.
  6408     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  6409     MOVE WS-CF-LF-COVERAGE-TYPE
  6410                                 TO  CP-BENEFIT-TYPE.
  6411     MOVE WS-KIND                TO  HLEDESCO.
  6412     MOVE WS-LF-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  6413     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6414     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6415     MOVE '2'                    TO  CP-PROCESS-TYPE.
  6416     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  6417     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  6418     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  6419     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  6420     MOVE WS-CF-CR-REM-TERM-CALC
  6421                                 TO  CP-REM-TERM-METHOD.
  6422
  6423     IF WS-LF-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  6424         MOVE WS-LF-CO-REM-TERM-CALC
  6425                                 TO  CP-REM-TERM-METHOD.
  6426
  6427     IF WS-LF-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  6428         MOVE WS-LF-ST-REM-TERM-CALC
  6429                                 TO  CP-REM-TERM-METHOD.
  6430
  6431     IF WS-LF-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  6432         MOVE WS-LF-AM-REM-TERM-CALC
  6433                                 TO  CP-REM-TERM-METHOD.
  6434
  6435     IF (PI-COMPANY-ID = 'CID')
  6436        AND (CP-STATE-STD-ABBRV = 'WI')
  6437        MOVE '7'                 TO CP-REM-TERM-METHOD
  6438        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6439     END-IF
  6440     IF (PI-COMPANY-ID = 'CID')
  6441        AND (CP-STATE-STD-ABBRV = 'MO')
  6442        AND (CM-CERT-EFF-DT >= X'9B41')
  6443        AND (CM-CERT-EFF-DT <= X'A2FB')
  6444        MOVE '7'                 TO CP-REM-TERM-METHOD
  6445        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6446     END-IF
  6447     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  6448                                     CP-ORIGINAL-TERM
  6449                                     CP-LOAN-TERM.
  6450
  6451     IF CP-TRUNCATED-LIFE
  6452         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  6453
  6454     IF CP-TERM-IS-DAYS
  6455         IF CM-LF-TERM-IN-DAYS  IS NUMERIC
  6456             MOVE CM-LF-TERM-IN-DAYS
  6457                                 TO  CP-TERM-OR-EXT-DAYS
  6458         ELSE
  6459             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS
  6460     ELSE
  6461         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  6462             MOVE CM-PMT-EXTENSION-DAYS
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 118
* EL1278.cbl
  6463                                 TO  CP-TERM-OR-EXT-DAYS
  6464         ELSE
  6465             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  6466
  6467*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  6468     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6469     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  6470     MOVE CM-STATE               TO  WS-CF-ACCESS.
  6471     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6472
  6473
  6474* EXEC CICS READ
  6475*        DATASET  (ELCNTL-ID)
  6476*        SET      (ADDRESS OF CONTROL-FILE)
  6477*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  6478*        RESP     (WS-RESPONSE)
  6479*    END-EXEC.
  6480*    MOVE '&"S        E          (  N#00006359' TO DFHEIV0
  6481     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6482     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6483     MOVE X'204E233030303036333539' TO DFHEIV0(25:11)
  6484     CALL 'kxdfhei1' USING DFHEIV0,
  6485           ELCNTL-ID,
  6486           DFHEIV20,
  6487           DFHEIV99,
  6488           WS-CF-CONTROL-PRIMARY,
  6489           DFHEIV99,
  6490           DFHEIV99,
  6491           DFHEIV99
  6492     SET ADDRESS OF CONTROL-FILE TO
  6493         DFHEIV20
  6494     MOVE EIBRESP  TO WS-RESPONSE
  6495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6496
  6497
  6498     IF WS-RESP-NOTOPEN
  6499         MOVE ER-2617            TO  EMI-ERROR
  6500         GO TO 0320-INPUT-ERROR.
  6501
  6502     IF WS-RESP-NOTFND
  6503         MOVE ZERO               TO  CP-FREE-LOOK
  6504     ELSE
  6505         MOVE CF-ST-FREE-LOOK-PERIOD
  6506                                 TO CP-FREE-LOOK.
  6507
  6508     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6509        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6510        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  6511     END-IF
  6512
  6513     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  6514
  6515     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6516        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6517        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  6518        COMPUTE CP-REMAINING-TERM-1 =
  6519                CP-REMAINING-TERM-1 - +1
  6520        COMPUTE CP-REMAINING-TERM-2 =
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 119
* EL1278.cbl
  6521                CP-REMAINING-TERM-2 - +1
  6522     END-IF
  6523
  6524     IF CP-REMAINING-TERM-1 NEGATIVE
  6525        MOVE ZEROS               TO CP-REMAINING-TERM-1
  6526     END-IF
  6527     IF CP-REMAINING-TERM-2 NEGATIVE
  6528        MOVE ZEROS               TO CP-REMAINING-TERM-2
  6529     END-IF
  6530     MOVE CP-REMAINING-TERM-1    TO  HLREMO.
  6531
  6532*    IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-LF-ORIG-TERM
  6533*        MOVE CM-LF-ORIG-TERM    TO  HLREMO.
  6534
  6535     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '8'
  6536         IF CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  6537             MOVE ER-0681        TO  EMI-ERROR
  6538             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6539
  6540     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '7'
  6541         IF CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES
  6542             MOVE ER-0682        TO  EMI-ERROR
  6543             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6544
  6545 0630-CONTINUE-LIFE.
  6546
  6547     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6548        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6549        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  6550                                    FREMTRMO
  6551     ELSE
  6552        MOVE CP-REMAINING-TERM-2 TO  CP-REMAINING-TERM
  6553                                     FREMTRMO
  6554     END-IF
  6555     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  6556     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  6557     MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE
  6558     IF (PI-COMPANY-ID = 'DCC')
  6559        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6560        MOVE ' '                 TO WS-PDEF-RECORD-SW
  6561        PERFORM 0730-GET-DDF-FACTORS
  6562                                 THRU 0730-EXIT
  6563        IF PDEF-FOUND
  6564           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  6565              (P1 > +8)
  6566              OR (PD-PROD-CODE (P1) = 'L')
  6567           END-PERFORM
  6568           IF P1 < +9
  6569              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  6570           END-IF
  6571        END-IF
  6572     END-IF
  6573     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT.
  6574
  6575     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
  6576
  6577     IF WS-LF-CO-EARNINGS-CALC = 'B'
  6578        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 120
* EL1278.cbl
  6579                             + CM-LF-ALT-PREMIUM-AMT
  6580     ELSE
  6581        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  6582     END-IF
  6583
  6584     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  6585                                     WS-TOT-LF-PREM.
  6586
  6587     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6588        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6589        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  6590     ELSE
  6591        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  6592     END-IF
  6593
  6594     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6595     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6596
  6597     IF WS-LF-ST-REFUND-CALC  IS GREATER THAN  ZERO
  6598         MOVE WS-LF-ST-REFUND-CALC
  6599                                 TO  CP-EARNING-METHOD.
  6600
  6601     IF WS-LF-FO-REFUND-CALC  IS GREATER THAN  ZERO
  6602         MOVE WS-LF-FO-REFUND-CALC
  6603                                 TO  CP-EARNING-METHOD.
  6604
  6605     IF CP-RATING-METHOD = '4'
  6606        MOVE '4'                 TO CP-EARNING-METHOD
  6607     END-IF
  6608*    IF WS-CF-LF-COVERAGE-TYPE = 'R'
  6609*        IF WS-AM-EARN-METHOD-R  IS GREATER THAN  ZERO
  6610*            MOVE WS-AM-EARN-METHOD-R
  6611*                                TO  CP-EARNING-METHOD
  6612*        END-IF
  6613*    ELSE
  6614*        IF WS-AM-EARN-METHOD-L  IS GREATER THAN  ZERO
  6615*            MOVE WS-AM-EARN-METHOD-L
  6616*                                TO  CP-EARNING-METHOD.
  6617
  6618     MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6619     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6620     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6621                                     CP-RATING-BENEFIT-AMT.
  6622     IF CP-STATE-STD-ABBRV = 'OR'
  6623         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  6624                                         CM-LF-ALT-BENEFIT-AMT.
  6625****   N O T E   ****
  6626*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  6627*      THE OH HARD CODING IN ELCRFNDP
  6628
  6629     IF PI-COMPANY-ID = 'CID'
  6630        IF CP-STATE-STD-ABBRV = 'OH'
  6631           MOVE WS-LF-CO-EARNINGS-CALC
  6632                                 TO CP-EARNING-METHOD
  6633        END-IF
  6634     END-IF
  6635
  6636****   N O T E   ****
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 121
* EL1278.cbl
  6637
  6638****   MN   NOTE  ****  CID HAS THE STATE REFUND METHOD SET AS
  6639****      R78 BUT THEY WANT THE BALLOONS REFUNDED WITH A
  6640****      CUSTOM FORMULA THAT IS IN ELRFND SO I AM SETTING
  6641****     THE APPROPRIATE OPTIONS HERE
  6642*    IF PI-COMPANY-ID = 'CID'
  6643*       IF (CP-STATE-STD-ABBRV = 'MN')
  6644*          AND (CM-CERT-EFF-DT > X'A4FF')
  6645*          AND (WS-LF-CO-EARNINGS-CALC = 'B')
  6646*          MOVE '5'              TO CP-EARNING-METHOD
  6647*       END-IF
  6648*    END-IF
  6649     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6650     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6651     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  6652     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6653     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6654     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  6655
  6656*    IF CP-EARN-AS-NET-PAY
  6657*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
  6658*           IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  6659*               MOVE WS-CF-DEFAULT-APR
  6660*                                TO  CP-LOAN-APR
  6661*               MOVE ER-3780     TO  EMI-ERROR
  6662*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6663*           ELSE
  6664*               MOVE ER-3781     TO  EMI-ERROR
  6665*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6666
  6667*    DISPLAY ' 1278 REM AMT      ' CP-REMAINING-BENEFIT
  6668*    DISPLAY ' 1278 REM TRM      ' CP-REMAINING-TERM
  6669*    DISPLAY ' 1278 EARN METH    ' CP-EARNING-METHOD
  6670*    DISPLAY ' 1278 RATE METH    ' CP-RATING-METHOD
  6671*    DISPLAY ' 1278 CLASS        ' CP-CLASS-CODE
  6672*    DISPLAY ' 1278 BENE CODE    ' CP-BENEFIT-CD
  6673*    DISPLAY ' 1278 ORIG BENE    ' CP-ORIGINAL-BENEFIT
  6674*    DISPLAY ' 1278 RATE BENE    ' CP-RATING-BENEFIT-AMT
  6675*    DISPLAY ' 1278 ORIG PREM    ' CP-ORIGINAL-PREMIUM
  6676*    DISPLAY ' 1278 ISS AGE      ' CP-ISSUE-AGE
  6677*    DISPLAY ' 1278 DEV CODE     ' CP-DEVIATION-CODE
  6678*    DISPLAY ' 1278 DEV PCT      ' CP-RATE-DEV-PCT
  6679*    DISPLAY ' 1278 APR          ' CP-LOAN-APR
  6680*    DISPLAY ' 1278 EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  6681*    DISPLAY ' 1278 LOAN TERM    ' CP-LOAN-TERM
  6682*    DISPLAY ' 1278 SPEC CALC    ' CP-SPECIAL-CALC-CD
  6683*    DISPLAY ' 1278 ST STD ABB   ' CP-STATE-STD-ABBRV
  6684     MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  6685     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  6686
  6687     MOVE 'L'                    TO  WS-REFUND-SEARCH-SW.
  6688
  6689     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  6690
  6691     IF CP-ERROR-RATE-IS-ZERO
  6692       OR CP-ERROR-RATE-NOT-FOUND
  6693         MOVE ER-2740            TO  EMI-ERROR
  6694         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 122
* EL1278.cbl
  6695
  6696     IF CP-ERROR-RATE-FILE-NOTOPEN
  6697         MOVE ER-2617            TO  EMI-ERROR
  6698         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6699
  6700     MOVE ZEROS                  TO  WS-CALC-REFUND.
  6701     MOVE CP-CALC-REFUND         TO  HLREFNDO  WS-CALC-REFUND
  6702                                     WS-TOT-LF-RFND
  6703                                     PI-LF-REFUND-AMT.
  6704     MOVE CP-REMAINING-AMT       TO  HLREDO.
  6705
  6706     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  6707
  6708     IF WS-LF-CO-EARNINGS-CALC  IS NOT EQUAL TO  'B'
  6709         GO TO 0640-AH-BENEFIT.
  6710
  6711*    IF WS-LF-SPECIAL-CALC-CD = 'L'
  6712*        ADD +1                  TO  CP-REMAINING-TERM
  6713*                                    CP-ORIGINAL-TERM.
  6714
  6715     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  6716     MOVE '2'                    TO  CP-EARNING-METHOD
  6717                                     CP-RATING-METHOD.
  6718     IF PI-COMPANY-ID = 'CID'
  6719        IF (CP-STATE-STD-ABBRV = 'MN')
  6720           AND (CM-CERT-EFF-DT > X'A4FF')
  6721           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  6722           MOVE '5'              TO CP-EARNING-METHOD
  6723           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  6724        END-IF
  6725     END-IF
  6726     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  6727                                     CP-REMAINING-BENEFIT
  6728                                     CP-RATING-BENEFIT-AMT.
  6729     IF CP-STATE-STD-ABBRV = 'OR'
  6730         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  6731                                         CM-LF-ALT-BENEFIT-AMT.
  6732     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  6733     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  6734
  6735     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  6736
  6737     IF CP-ERROR-RATE-IS-ZERO
  6738       OR CP-ERROR-RATE-NOT-FOUND
  6739         MOVE ER-2740            TO  EMI-ERROR
  6740         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6741
  6742     IF CP-ERROR-RATE-FILE-NOTOPEN
  6743         MOVE ER-2617            TO  EMI-ERROR
  6744         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6745
  6746     ADD CP-CALC-REFUND          TO  WS-CALC-REFUND.
  6747
  6748     MOVE WS-CALC-REFUND         TO  HLREFNDO
  6749                                     WS-TOT-LF-RFND
  6750                                     PI-LF-REFUND-AMT.
  6751
  6752     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 123
* EL1278.cbl
  6753
  6754 0640-AH-BENEFIT.
  6755     IF CM-AH-BENEFIT-CD = '00'
  6756         GO TO 0680-CONTINUE.
  6757
  6758 0650-GET-AH-BENEFIT.
  6759     IF ACCT-FOUND
  6760         MOVE +1                 TO SUB3
  6761         PERFORM 6000-GET-AH-AM-REM-TERM THRU 6900-EXIT.
  6762     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  6763     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  6764     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  6765     MOVE WS-KIND                TO  HAEDESCO.
  6766     EVALUATE TRUE
  6767        WHEN ((OPEN-LF-CLAIM)
  6768           OR (CLOSED-LF-CLAIM))
  6769           AND (WS-AH-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  6770           MOVE ZEROS            TO HAREFNDO  WS-CALC-REFUND
  6771                                    WS-TOT-AH-RFND
  6772                                    PI-AH-REFUND-AMT
  6773           MOVE SPACES           TO PI-AH-REFUND-METH
  6774           MOVE ER-2965          TO EMI-ERROR
  6775           PERFORM 9700-ERROR-FORMAT
  6776                                 THRU  9799-EXIT
  6777           GO TO 0680-CONTINUE
  6778        WHEN (CM-LF-BENEFIT-CD NOT = '00')
  6779           AND ((OPEN-LF-CLAIM) OR (CLOSED-LF-CLAIM))
  6780           AND (EMI-ERROR = ER-2965)
  6781           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  6782           MOVE ZEROS            TO HAREFNDO
  6783                                    WS-TOT-AH-RFND
  6784                                    PI-AH-REFUND-AMT
  6785           MOVE SPACES           TO PI-AH-REFUND-METH
  6786           GO TO 0680-CONTINUE
  6787        WHEN (OPEN-AH-CLAIM)
  6788           AND (WS-ST-REF-IND = '1')
  6789           MOVE ZEROS            TO HAREFNDO
  6790                                    WS-TOT-AH-RFND
  6791                                    PI-AH-REFUND-AMT
  6792           MOVE ER-3039          TO EMI-ERROR
  6793           PERFORM 9700-ERROR-FORMAT
  6794                                 THRU  9799-EXIT
  6795           GO TO 0680-CONTINUE
  6796        WHEN (OPEN-AH-CLAIM)
  6797           AND (WS-ST-REF-IND = '2' OR '3' OR '4')
  6798           MOVE ER-3037          TO EMI-ERROR
  6799           PERFORM 9700-ERROR-FORMAT
  6800                                 THRU  9799-EXIT
  6801*          CONTINUE
  6802        WHEN (OPEN-AH-CLAIM)
  6803           AND (WS-ST-REF-IND = '5')
  6804           MOVE ER-3038          TO EMI-ERROR
  6805           PERFORM 9700-ERROR-FORMAT
  6806                                 THRU  9799-EXIT
  6807*          CONTINUE
  6808        WHEN (OPEN-AH-CLAIM)
  6809           AND (WS-ST-REF-IND = ' ')
  6810           MOVE ER-2768          TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 124
* EL1278.cbl
  6811           PERFORM 9700-ERROR-FORMAT
  6812                                 THRU  9799-EXIT
  6813        WHEN (CLOSED-AH-CLAIM)
  6814           AND (WS-AH-CANCEL-DATE <= WS-AH-PAID-THRU-DT)
  6815           MOVE ZEROS            TO HAREFNDO
  6816                                    WS-TOT-AH-RFND
  6817                                    PI-AH-REFUND-AMT
  6818           MOVE ER-2756          TO EMI-ERROR
  6819           PERFORM 9700-ERROR-FORMAT
  6820                                 THRU  9799-EXIT
  6821           IF WS-TOT-LF-RFND > 0
  6822              MOVE ZEROS         TO HLREFNDO
  6823                                    WS-TOT-LF-RFND
  6824                                    PI-LF-REFUND-AMT
  6825              MOVE SPACES        TO PI-LF-REFUND-METH
  6826           END-IF
  6827           GO TO 0680-CONTINUE
  6828*       WHEN OTHER
  6829*          CONTINUE
  6830     END-EVALUATE
  6831     .
  6832 0660-GET-REM-TERM.
  6833     MOVE WS-CF-AH-OVERRIDE-L1   TO  CP-AH-OVERRIDE-CODE.
  6834     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  6835     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  6836     MOVE WS-AH-CANCEL-DATE      TO  CP-VALUATION-DT.
  6837     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  6838*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  6839     MOVE WS-KIND                TO  HAEDESCO.
  6840     MOVE CM-STATE               TO  CP-STATE.
  6841     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  6842     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  6843     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  6844     MOVE '2'                    TO  CP-PROCESS-TYPE.
  6845     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  6846     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  6847     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  6848     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  6849     MOVE WS-CF-CR-REM-TERM-CALC
  6850                                 TO  CP-REM-TERM-METHOD.
  6851
  6852     IF WS-AH-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  6853         MOVE WS-AH-CO-REM-TERM-CALC
  6854                                 TO  CP-REM-TERM-METHOD.
  6855
  6856     IF WS-AH-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  6857         MOVE WS-AH-ST-REM-TERM-CALC
  6858                                 TO  CP-REM-TERM-METHOD.
  6859
  6860     IF WS-AH-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  6861         MOVE WS-AH-AM-REM-TERM-CALC
  6862                                 TO  CP-REM-TERM-METHOD.
  6863     IF (PI-COMPANY-ID = 'CID')
  6864        AND (CP-STATE-STD-ABBRV = 'WI')
  6865        MOVE '7'                 TO CP-REM-TERM-METHOD
  6866        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6867     END-IF
  6868     IF (PI-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 125
* EL1278.cbl
  6869        AND (CP-STATE-STD-ABBRV = 'MO')
  6870        AND (CM-CERT-EFF-DT >= X'9B41')
  6871        AND (CM-CERT-EFF-DT <= X'A2FB')
  6872        MOVE '7'                 TO CP-REM-TERM-METHOD
  6873        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6874     END-IF
  6875
  6876     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  6877                                     CP-ORIGINAL-TERM
  6878                                     CP-LOAN-TERM.
  6879
  6880     IF  NOT  CP-TERM-IS-DAYS
  6881         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  6882             MOVE CM-PMT-EXTENSION-DAYS
  6883                                 TO  CP-TERM-OR-EXT-DAYS
  6884         ELSE
  6885             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  6886
  6887*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  6888     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6889     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  6890     MOVE CM-STATE               TO  WS-CF-ACCESS.
  6891     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6892
  6893
  6894* EXEC CICS READ
  6895*        DATASET  (ELCNTL-ID)
  6896*        SET      (ADDRESS OF CONTROL-FILE)
  6897*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  6898*        RESP     (WS-RESPONSE)
  6899*    END-EXEC.
  6900*    MOVE '&"S        E          (  N#00006761' TO DFHEIV0
  6901     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6902     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6903     MOVE X'204E233030303036373631' TO DFHEIV0(25:11)
  6904     CALL 'kxdfhei1' USING DFHEIV0,
  6905           ELCNTL-ID,
  6906           DFHEIV20,
  6907           DFHEIV99,
  6908           WS-CF-CONTROL-PRIMARY,
  6909           DFHEIV99,
  6910           DFHEIV99,
  6911           DFHEIV99
  6912     SET ADDRESS OF CONTROL-FILE TO
  6913         DFHEIV20
  6914     MOVE EIBRESP  TO WS-RESPONSE
  6915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6916
  6917
  6918     IF WS-RESP-NOTOPEN
  6919         MOVE ER-2617            TO  EMI-ERROR
  6920         GO TO 0320-INPUT-ERROR.
  6921
  6922     IF WS-RESP-NOTFND
  6923         MOVE ZERO               TO CP-FREE-LOOK
  6924     ELSE
  6925         MOVE CF-ST-FREE-LOOK-PERIOD
  6926                                 TO CP-FREE-LOOK.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 126
* EL1278.cbl
  6927
  6928     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  6929
  6930     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  6931
  6932     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '8'
  6933         IF CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  6934             MOVE ER-0683        TO  EMI-ERROR
  6935             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6936
  6937     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '6'  OR  '7'
  6938         IF CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES
  6939             MOVE ER-0684        TO  EMI-ERROR
  6940             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6941
  6942 0670-CONTINUE-AH.
  6943     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  6944                                     WS-TOT-AH-PREM.
  6945     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  6946
  6947     IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-AH-ORIG-TERM
  6948         MOVE CM-AH-ORIG-TERM    TO  HAREMO.
  6949
  6950     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM.
  6951     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6952     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6953
  6954     IF WS-AH-ST-REFUND-CALC  IS GREATER THAN  ZERO
  6955         MOVE WS-AH-ST-REFUND-CALC
  6956                                 TO  CP-EARNING-METHOD.
  6957
  6958     IF WS-AH-FO-REFUND-CALC  IS GREATER THAN  ZERO
  6959         MOVE WS-AH-FO-REFUND-CALC
  6960                                 TO  CP-EARNING-METHOD.
  6961
  6962*    IF WS-AM-EARN-METHOD-A  IS GREATER THAN  ZERO
  6963*        MOVE WS-AM-EARN-METHOD-A
  6964*                                TO  CP-EARNING-METHOD.
  6965
  6966     MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6967     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6968     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6969                                     CP-RATING-BENEFIT-AMT.
  6970     IF CP-STATE-STD-ABBRV = 'OR'
  6971         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  6972                                         CM-AH-ORIG-TERM.
  6973     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6974     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6975     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6976     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  6977     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6978     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6979
  6980     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6981     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6982     MOVE ' '                    TO  DC-OPTION-CODE.
  6983
  6984     PERFORM 9600-DATE-LINK.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 127
* EL1278.cbl
  6985
  6986     IF CP-STATE-STD-ABBRV = 'OH'
  6987        IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  6988         IF (CP-ORIGINAL-TERM  IS GREATER THAN  60)
  6989           AND (DC-GREG-DATE-1-YMD  IS GREATER THAN  '831101')
  6990           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  6991             MOVE '6'            TO  CP-EARNING-METHOD
  6992         END-IF
  6993        END-IF
  6994        IF PI-COMPANY-ID = 'CID'
  6995           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  6996                           LOW-VALUES)
  6997              IF CP-CRITICAL-PERIOD
  6998                 MOVE '2'       TO CP-EARNING-METHOD
  6999              ELSE
  7000                 MOVE '6'       TO CP-EARNING-METHOD
  7001              END-IF
  7002           ELSE
  7003              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  7004                 MOVE '2'       TO CP-EARNING-METHOD
  7005              ELSE
  7006                 IF ((CM-LF-ORIG-TERM > 60) AND
  7007                    (CM-RATE-CLASS NOT = 'L '))
  7008                               OR
  7009                    (WS-LF-CO-EARNINGS-CALC = '5')
  7010                    IF CP-CRITICAL-PERIOD
  7011                       MOVE '2'  TO CP-EARNING-METHOD
  7012                    ELSE
  7013                       MOVE '6'  TO CP-EARNING-METHOD
  7014                    END-IF
  7015                 ELSE
  7016                    MOVE '1'     TO CP-EARNING-METHOD
  7017                 END-IF
  7018              END-IF
  7019           END-IF
  7020        END-IF
  7021     END-IF
  7022
  7023     IF CP-STATE-STD-ABBRV = 'VA'
  7024       IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7025         IF DC-GREG-DATE-1-YMD  IS GREATER THAN  '921231'
  7026            IF CP-ORIGINAL-TERM  IS GREATER THAN  61
  7027                MOVE '6'            TO  CP-EARNING-METHOD
  7028            ELSE
  7029                MOVE '1'            TO  CP-EARNING-METHOD.
  7030
  7031     IF CP-EARN-AS-NET-PAY
  7032         IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7033            IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7034                MOVE WS-CF-DEFAULT-APR
  7035                                 TO  CP-LOAN-APR
  7036                MOVE ER-3780     TO  EMI-ERROR
  7037                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7038            ELSE
  7039                MOVE ER-3781     TO  EMI-ERROR
  7040                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7041     IF PI-COMPANY-ID = 'DCC'
  7042        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 128
* EL1278.cbl
  7043           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  7044           MOVE 'S'              TO CP-EARNING-METHOD
  7045        END-IF
  7046     END-IF
  7047     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7048     IF (PI-COMPANY-ID = 'DCC')
  7049        AND (CP-EARNING-METHOD = 'D')
  7050        MOVE +0                  TO WS-DDF-ADMIN-FEES
  7051                                    WS-DDF-CSO-ADMIN-FEE
  7052                                    WS-DDF-1ST-YR-TOT-EXP
  7053                                    WS-DDF-COMM-AND-MFEE
  7054        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  7055           S1 > +10
  7056           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  7057              IF (AM-A-COM (S1) NUMERIC)
  7058                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  7059                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  7060              ELSE
  7061                 MOVE +0         TO WS-COMM-PCT C0
  7062                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  7063                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  7064              END-IF
  7065              IF AM-COM-TYP (S1) = 'L' OR 'N'
  7066                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  7067                    + WS-COMM-PCT
  7068              END-IF
  7069              IF AM-COM-TYP (S1) = 'N'
  7070                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  7071                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  7072              END-IF
  7073              IF AM-COM-TYP (S1) = 'J' OR 'L'
  7074                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  7075                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  7076              END-IF
  7077              IF AM-COM-TYP (S1) = 'I'
  7078                 COMPUTE WS-DDF-COMM-AND-MFEE
  7079                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  7080              END-IF
  7081           END-IF
  7082        END-PERFORM
  7083        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  7084        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  7085        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  7086           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  7087     END-IF
  7088     IF (PI-COMPANY-ID = 'DCC')
  7089        AND (CP-EARNING-METHOD = 'D')
  7090        AND (PI-CANCEL-REASON NOT = 'R')
  7091        PERFORM 0730-GET-DDF-FACTORS
  7092                                 THRU 0730-EXIT
  7093        IF NOT PDEF-FOUND
  7094           MOVE ER-9999          TO EMI-ERROR
  7095           PERFORM 9700-ERROR-FORMAT
  7096                                 THRU 9799-EXIT
  7097           GO TO 8200-SEND-DATAONLY
  7098        END-IF
  7099        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  7100                                 TO CP-DDF-LO-FACT
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 129
* EL1278.cbl
  7101        MOVE PD-UEP-FACTOR (P1 P2)
  7102                                 TO CP-DDF-HI-FACT
  7103        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  7104        MOVE CM-AH-CLP           TO CP-DDF-CLP
  7105        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  7106        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  7107           + PD-1ST-YR-ADMIN-ALLOW
  7108        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  7109        IF PI-CLP-YN = 'Y'
  7110           MOVE 'C'              TO CP-DDF-SPEC-CALC
  7111           MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  7112                                    CP-DDF-CLP
  7113           MOVE ZEROS            TO CP-1ST-YR-ALLOW
  7114        END-IF
  7115        IF DD-IU-PRESENT
  7116           MOVE 'I'              TO CP-EARNING-METHOD
  7117        END-IF
  7118        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  7119                                    CP-CLP-RATE-UP
  7120        IF (CP-CALC-GROSS-FEE)
  7121           AND (CP-IU-RATE-UP NOT = ZEROS)
  7122           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  7123              / CP-ORIGINAL-PREMIUM)
  7124           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  7125              / (1 - TEX-FACT-8)
  7126        END-IF
  7127     END-IF
  7128     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT
  7129
  7130     MOVE ' '                    TO  WS-REFUND-SEARCH-SW.
  7131
  7132     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7133
  7134     IF CP-ERROR-RATE-IS-ZERO
  7135       OR CP-ERROR-RATE-NOT-FOUND
  7136         MOVE ER-2740            TO  EMI-ERROR
  7137         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7138
  7139     IF CP-ERROR-RATE-FILE-NOTOPEN
  7140         MOVE ER-2617            TO  EMI-ERROR
  7141         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7142
  7143     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7144     MOVE CP-CALC-REFUND         TO  HAREFNDO  WS-CALC-REFUND
  7145                                     WS-TOT-AH-RFND
  7146                                     PI-AH-REFUND-AMT.
  7147
  7148     MOVE CP-REFUND-TYPE-USED    TO  PI-AH-REFUND-METH.
  7149
  7150     MOVE AL-UANON               TO  HACANCA.
  7151
  7152 0680-CONTINUE.
  7153     IF BROWSE-STARTED
  7154         PERFORM 1500-END-BROWSE  THRU  1599-EXIT
  7155         MOVE SPACES             TO  WS-BROWSE-STARTED-SW.
  7156
  7157     IF CM-LF-BENEFIT-CD = '00'
  7158         MOVE -1                 TO  HACANCL
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 130
* EL1278.cbl
  7159     ELSE
  7160         MOVE -1                 TO  HLCANCL.
  7161
  7162     ADD WS-TOT-LF-PREM    WS-TOT-AH-PREM GIVING
  7163                           WS-TOT-PREM.
  7164     ADD WS-TOT-LF-RFND    WS-TOT-AH-RFND GIVING
  7165                           WS-TOT-RFND.
  7166
  7167     MOVE WS-TOT-PREM            TO  TOPREMO.
  7168     MOVE WS-TOT-RFND            TO  TORFNDO.
  7169
  7170 0680-EXIT.
  7171     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 131
* EL1278.cbl
  7173 0700-LINK-REM-TERM SECTION.
  7174
  7175* EXEC CICS LINK
  7176*        PROGRAM   (ELRTRM-ID)
  7177*        COMMAREA  (CALCULATION-PASS-AREA)
  7178*        LENGTH    (CP-COMM-LENGTH)
  7179*    END-EXEC.
  7180*    MOVE '."C                   ''   #00007024' TO DFHEIV0
  7181     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7182     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7183     MOVE X'2020233030303037303234' TO DFHEIV0(25:11)
  7184     CALL 'kxdfhei1' USING DFHEIV0,
  7185           ELRTRM-ID,
  7186           CALCULATION-PASS-AREA,
  7187           CP-COMM-LENGTH,
  7188           DFHEIV99,
  7189           DFHEIV99,
  7190           DFHEIV99
  7191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7192
  7193
  7194 0700-EXIT.
  7195     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 132
* EL1278.cbl
  7197 0710-LINK-REM-AMOUNT SECTION.
  7198
  7199* EXEC CICS LINK
  7200*        PROGRAM   (ELRAMT-ID)
  7201*        COMMAREA  (CALCULATION-PASS-AREA)
  7202*        LENGTH    (CP-COMM-LENGTH)
  7203*    END-EXEC.
  7204*    MOVE '."C                   ''   #00007034' TO DFHEIV0
  7205     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7206     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7207     MOVE X'2020233030303037303334' TO DFHEIV0(25:11)
  7208     CALL 'kxdfhei1' USING DFHEIV0,
  7209           ELRAMT-ID,
  7210           CALCULATION-PASS-AREA,
  7211           CP-COMM-LENGTH,
  7212           DFHEIV99,
  7213           DFHEIV99,
  7214           DFHEIV99
  7215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7216
  7217
  7218 0710-EXIT.
  7219     EXIT.
  7220 0730-GET-DDF-FACTORS.
  7221     MOVE ' '                    TO WS-PDEF-RECORD-SW
  7222     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  7223     MOVE CM-STATE               TO ERPDEF-STATE
  7224     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  7225     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  7226     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  7227     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  7228     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  7229
  7230* EXEC CICS STARTBR
  7231*        DATASET  ('ERPDEF')
  7232*        RIDFLD   (ERPDEF-KEY)
  7233*        GTEQ
  7234*        RESP     (WS-RESPONSE)
  7235*    END-EXEC
  7236     MOVE 'ERPDEF' TO DFHEIV1
  7237     MOVE 0
  7238       TO DFHEIV11
  7239*    MOVE '&,         G          &  N#00007051' TO DFHEIV0
  7240     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7241     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7242     MOVE X'204E233030303037303531' TO DFHEIV0(25:11)
  7243     CALL 'kxdfhei1' USING DFHEIV0,
  7244           DFHEIV1,
  7245           ERPDEF-KEY,
  7246           DFHEIV99,
  7247           DFHEIV11,
  7248           DFHEIV99
  7249     MOVE EIBRESP  TO WS-RESPONSE
  7250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7251     IF NOT WS-RESP-NORMAL
  7252        GO TO 0730-EXIT
  7253     END-IF
  7254     .
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 133
* EL1278.cbl
  7255 0730-READNEXT.
  7256
  7257* EXEC CICS READNEXT
  7258*       DATASET  ('ERPDEF')
  7259*       SET      (ADDRESS OF PRODUCT-MASTER)
  7260*       RIDFLD   (ERPDEF-KEY)
  7261*       RESP     (WS-RESPONSE)
  7262*    END-EXEC
  7263     MOVE 'ERPDEF' TO DFHEIV1
  7264     MOVE 0
  7265       TO DFHEIV11
  7266*    MOVE '&.S                   )  N#00007062' TO DFHEIV0
  7267     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7268     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7269     MOVE X'204E233030303037303632' TO DFHEIV0(25:11)
  7270     CALL 'kxdfhei1' USING DFHEIV0,
  7271           DFHEIV1,
  7272           DFHEIV20,
  7273           DFHEIV99,
  7274           ERPDEF-KEY,
  7275           DFHEIV99,
  7276           DFHEIV11,
  7277           DFHEIV99,
  7278           DFHEIV99
  7279     SET ADDRESS OF PRODUCT-MASTER TO
  7280         DFHEIV20
  7281     MOVE EIBRESP  TO WS-RESPONSE
  7282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7283     IF NOT WS-RESP-NORMAL
  7284        GO TO 0730-ENDBR
  7285     END-IF
  7286     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  7287        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  7288           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  7289        ELSE
  7290           GO TO 0730-READNEXT
  7291        END-IF
  7292     ELSE
  7293        GO TO 0730-ENDBR
  7294     END-IF
  7295     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7296        (P1 > +8)
  7297        OR (PD-PROD-CODE (P1) = 'I')
  7298     END-PERFORM
  7299     IF P1 < +9
  7300        SET DD-IU-PRESENT        TO TRUE
  7301     END-IF
  7302     IF CM-LOAN-TERM = ZEROS
  7303        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  7304     END-IF
  7305     IF PD-TRUNCATED = 'Y'
  7306        MOVE CM-LOAN-TERM        TO WS-TERM
  7307     ELSE
  7308        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  7309     END-IF
  7310     EVALUATE TRUE
  7311        WHEN WS-TERM > +168
  7312           MOVE 15               TO P1
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 134
* EL1278.cbl
  7313        WHEN WS-TERM > +156
  7314           MOVE 14               TO P1
  7315        WHEN WS-TERM > +144
  7316           MOVE 13               TO P1
  7317        WHEN WS-TERM > +132
  7318           MOVE 12               TO P1
  7319        WHEN WS-TERM > +120
  7320           MOVE 11               TO P1
  7321        WHEN WS-TERM > +108
  7322           MOVE 10               TO P1
  7323        WHEN WS-TERM > +96
  7324           MOVE 9                TO P1
  7325        WHEN WS-TERM > +84
  7326           MOVE 8                TO P1
  7327        WHEN WS-TERM > +72
  7328           MOVE 7                TO P1
  7329        WHEN WS-TERM > +60
  7330           MOVE 6                TO P1
  7331        WHEN WS-TERM > +48
  7332           MOVE 5                TO P1
  7333        WHEN WS-TERM > +36
  7334           MOVE 4                TO P1
  7335        WHEN WS-TERM > +24
  7336           MOVE 3                TO P1
  7337        WHEN WS-TERM > +12
  7338           MOVE 2                TO P1
  7339        WHEN OTHER
  7340           MOVE 1                TO P1
  7341     END-EVALUATE
  7342     EVALUATE TRUE
  7343*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  7344*          AND (DD-IU-PRESENT)
  7345*          MOVE 2                TO P2
  7346*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  7347*          MOVE 1                TO P2
  7348        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  7349           MOVE 2                TO P2
  7350        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  7351           MOVE 3                TO P2
  7352        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  7353           MOVE 4                TO P2
  7354        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  7355           MOVE 5                TO P2
  7356        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  7357           MOVE 6                TO P2
  7358        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  7359           MOVE 7                TO P2
  7360        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  7361           MOVE 8                TO P2
  7362        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  7363           MOVE 9                TO P2
  7364        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  7365           MOVE 10               TO P2
  7366        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  7367           MOVE 11               TO P2
  7368        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  7369           MOVE 12               TO P2
  7370        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 135
* EL1278.cbl
  7371           MOVE 13               TO P2
  7372        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  7373           MOVE 14               TO P2
  7374        WHEN OTHER
  7375           MOVE 15               TO P2
  7376     END-EVALUATE
  7377     .
  7378 0730-ENDBR.
  7379
  7380* EXEC CICS ENDBR
  7381*       DATASET  ('ERPDEF')
  7382*    END-EXEC
  7383     MOVE 'ERPDEF' TO DFHEIV1
  7384     MOVE 0
  7385       TO DFHEIV11
  7386*    MOVE '&2                    $   #00007164' TO DFHEIV0
  7387     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7388     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7389     MOVE X'2020233030303037313634' TO DFHEIV0(25:11)
  7390     CALL 'kxdfhei1' USING DFHEIV0,
  7391           DFHEIV1,
  7392           DFHEIV11,
  7393           DFHEIV99
  7394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7395     .
  7396 0730-EXIT.
  7397     EXIT.
  7398 0740-GET-ERCTBL.
  7399     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7400     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7401     MOVE 'A'                    TO CTBL-BEN-TYPE
  7402     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  7403     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7404     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7405     IF WS-RESP-NORMAL
  7406        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7407     ELSE
  7408        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7409        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7410        MOVE 'A'                    TO CTBL-BEN-TYPE
  7411        MOVE 'AA'                   TO CTBL-BEN-CODE
  7412        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7413        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7414        IF WS-RESP-NORMAL
  7415           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7416        END-IF
  7417     END-IF
  7418     .
  7419 0740-EXIT.
  7420     EXIT.
  7421 0750-READ-ERCTBL.
  7422
  7423* EXEC CICS READ
  7424*         INTO    (COMM-TABLE-RECORD)
  7425*         DATASET ('ERCTBL')
  7426*         RIDFLD  (CTBL-KEY)
  7427*         RESP    (WS-RESPONSE)
  7428*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 136
* EL1278.cbl
  7429     MOVE LENGTH OF
  7430      COMM-TABLE-RECORD
  7431       TO DFHEIV11
  7432     MOVE 'ERCTBL' TO DFHEIV1
  7433*    MOVE '&"IL       E          (  N#00007194' TO DFHEIV0
  7434     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7435     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7436     MOVE X'204E233030303037313934' TO DFHEIV0(25:11)
  7437     CALL 'kxdfhei1' USING DFHEIV0,
  7438           DFHEIV1,
  7439           COMM-TABLE-RECORD,
  7440           DFHEIV11,
  7441           CTBL-KEY,
  7442           DFHEIV99,
  7443           DFHEIV99,
  7444           DFHEIV99
  7445     MOVE EIBRESP  TO WS-RESPONSE
  7446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7447     .
  7448 0750-EXIT.
  7449     EXIT.
  7450 0760-FIND-COMM.
  7451     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  7452        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  7453        OR (C1 > +3)
  7454     END-PERFORM
  7455     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  7456        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  7457        OR (C2 > +3)
  7458     END-PERFORM
  7459     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  7460        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  7461        OR (C3 > +3)
  7462     END-PERFORM
  7463     IF C1 > +3
  7464        MOVE +1                  TO C1
  7465     END-IF
  7466     IF C2 > +3
  7467        MOVE +1                  TO C2
  7468     END-IF
  7469     IF C3 > +3
  7470        MOVE +1                  TO C3
  7471     END-IF
  7472     IF C1 = +3
  7473        MOVE +18                 TO C0
  7474     ELSE
  7475        IF C1 = +2
  7476           MOVE +9               TO C0
  7477        END-IF
  7478     END-IF
  7479     IF C2 = +3
  7480        ADD +6                   TO C0
  7481     ELSE
  7482        IF C2 = +2
  7483           ADD +3                TO C0
  7484        END-IF
  7485     END-IF
  7486     ADD C3                      TO C0
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 137
* EL1278.cbl
  7487     MOVE CT-RT (C0)             TO WS-COMM-PCT
  7488     .
  7489 0760-EXIT.
  7490     EXIT.
  7491 0800-LINK-REFUND SECTION.
  7492     IF CP-AH
  7493       IF PI-EARNING-METHOD-AH NOT = SPACES
  7494         MOVE PI-EARNING-METHOD-AH   TO CP-EARNING-METHOD
  7495        ELSE
  7496         NEXT SENTENCE
  7497      ELSE
  7498       IF PI-EARNING-METHOD-LF NOT = SPACES
  7499         MOVE PI-EARNING-METHOD-LF   TO CP-EARNING-METHOD.
  7500
  7501
  7502* EXEC CICS LINK
  7503*        PROGRAM   (ELRFND-ID)
  7504*        COMMAREA  (CALCULATION-PASS-AREA)
  7505*        LENGTH    (CP-COMM-LENGTH)
  7506*    END-EXEC.
  7507*    MOVE '."C                   ''   #00007254' TO DFHEIV0
  7508     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7509     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7510     MOVE X'2020233030303037323534' TO DFHEIV0(25:11)
  7511     CALL 'kxdfhei1' USING DFHEIV0,
  7512           ELRFND-ID,
  7513           CALCULATION-PASS-AREA,
  7514           CP-COMM-LENGTH,
  7515           DFHEIV99,
  7516           DFHEIV99,
  7517           DFHEIV99
  7518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7519
  7520
  7521 0899-EXIT.
  7522     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 138
* EL1278.cbl
  7524 0900-READ-CERT-FILE  SECTION.
  7525
  7526* EXEC CICS HANDLE CONDITION
  7527*        NOTFND  (0910-NOT-FOUND)
  7528*    END-EXEC.
  7529*    MOVE '"$I                   ! # #00007264' TO DFHEIV0
  7530     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7531     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7532     MOVE X'2320233030303037323634' TO DFHEIV0(25:11)
  7533     CALL 'kxdfhei1' USING DFHEIV0
  7534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7535
  7536
  7537
  7538* EXEC CICS READ
  7539*        DATASET  (ELCERT-ID)
  7540*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  7541*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  7542*    END-EXEC.
  7543*    MOVE '&"S        E          (   #00007268' TO DFHEIV0
  7544     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7545     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7546     MOVE X'2020233030303037323638' TO DFHEIV0(25:11)
  7547     CALL 'kxdfhei1' USING DFHEIV0,
  7548           ELCERT-ID,
  7549           DFHEIV20,
  7550           DFHEIV99,
  7551           WS-CM-CONTROL-PRIMARY,
  7552           DFHEIV99,
  7553           DFHEIV99,
  7554           DFHEIV99
  7555     SET ADDRESS OF CERTIFICATE-MASTER TO
  7556         DFHEIV20
  7557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7558
  7559
  7560*    SERVICE RELOAD CERTIFICATE-MASTER.
  7561
  7562     GO TO 0999-EXIT.
  7563
  7564 0910-NOT-FOUND.
  7565     MOVE 'N'                    TO  WS-CERT-RECORD-SW.
  7566
  7567 0999-EXIT.
  7568     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 139
* EL1278.cbl
  7570 1000-READ-CONTROL  SECTION.
  7571
  7572* EXEC CICS HANDLE CONDITION
  7573*        NOTFND   (1010-NOTFND)
  7574*        NOTOPEN  (1020-NOTOPEN)
  7575*    END-EXEC.
  7576*    MOVE '"$IJ                  ! $ #00007285' TO DFHEIV0
  7577     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  7578     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7579     MOVE X'2420233030303037323835' TO DFHEIV0(25:11)
  7580     CALL 'kxdfhei1' USING DFHEIV0
  7581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7582
  7583
  7584
  7585* EXEC CICS READ
  7586*        DATASET  (ELCNTL-ID)
  7587*        SET      (ADDRESS OF CONTROL-FILE)
  7588*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7589*        GTEQ
  7590*    END-EXEC.
  7591*    MOVE '&"S        G          (   #00007290' TO DFHEIV0
  7592     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7593     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7594     MOVE X'2020233030303037323930' TO DFHEIV0(25:11)
  7595     CALL 'kxdfhei1' USING DFHEIV0,
  7596           ELCNTL-ID,
  7597           DFHEIV20,
  7598           DFHEIV99,
  7599           WS-CF-CONTROL-PRIMARY,
  7600           DFHEIV99,
  7601           DFHEIV99,
  7602           DFHEIV99
  7603     SET ADDRESS OF CONTROL-FILE TO
  7604         DFHEIV20
  7605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7606
  7607
  7608*    SERVICE RELOAD CONTROL-FILE.
  7609
  7610     GO TO 1099-EXIT.
  7611
  7612 1010-NOTFND.
  7613     MOVE 'N'                    TO  WS-CNTL-RECORD-SW.
  7614
  7615     GO TO 1099-EXIT.
  7616
  7617 1020-NOTOPEN.
  7618     MOVE ER-2617                TO  EMI-ERROR.
  7619
  7620     GO TO 0320-INPUT-ERROR.
  7621
  7622 1099-EXIT.
  7623     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 140
* EL1278.cbl
  7625 1100-FIND-BENEFIT-IN-STATE  SECTION.
  7626     MOVE 'N'                    TO  BEN-SEARCH-SW.
  7627
  7628     PERFORM 1110-BENEFIT-DUMMY  THRU  1119-EXIT
  7629         VARYING  SUB3  FROM  1  BY  1
  7630             UNTIL  ((SUB3  IS GREATER THAN  50)
  7631               OR ((CF-ST-BENEFIT-CD (SUB3)
  7632                      IS EQUAL TO  WS-BEN-CD)
  7633               AND (WS-LOOKUP-TYPE
  7634                      IS EQUAL TO  CF-ST-BENEFIT-KIND (SUB3)))).
  7635
  7636     IF SUB3  IS NOT EQUAL TO  51
  7637         MOVE 'Y'                TO  BEN-SEARCH-SW.
  7638
  7639     GO TO 1199-EXIT.
  7640
  7641 1110-BENEFIT-DUMMY.
  7642
  7643 1119-EXIT.
  7644     EXIT.
  7645
  7646 1199-EXIT.
  7647     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 141
* EL1278.cbl
  7649 1200-START-ACCOUNT-MASTER  SECTION.
  7650
  7651* EXEC CICS HANDLE CONDITION
  7652*        NOTFND   (1290-ACCT-NOT-FOUND)
  7653*        ENDFILE  (1290-ACCT-NOT-FOUND)
  7654*    END-EXEC.
  7655*    MOVE '"$I''                  ! % #00007339' TO DFHEIV0
  7656     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7657     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7658     MOVE X'2520233030303037333339' TO DFHEIV0(25:11)
  7659     CALL 'kxdfhei1' USING DFHEIV0
  7660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7661
  7662
  7663     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  7664
  7665
  7666* EXEC CICS STARTBR
  7667*        DATASET  (ERACCT-ID)
  7668*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  7669*        GTEQ
  7670*    END-EXEC.
  7671     MOVE 0
  7672       TO DFHEIV11
  7673*    MOVE '&,         G          &   #00007346' TO DFHEIV0
  7674     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7675     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7676     MOVE X'2020233030303037333436' TO DFHEIV0(25:11)
  7677     CALL 'kxdfhei1' USING DFHEIV0,
  7678           ERACCT-ID,
  7679           WS-AM-CONTROL-PRIMARY,
  7680           DFHEIV99,
  7681           DFHEIV11,
  7682           DFHEIV99
  7683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7684
  7685
  7686     MOVE 'Y'                    TO  WS-BROWSE-STARTED-SW.
  7687     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  7688
  7689     GO TO 1299-EXIT.
  7690
  7691 1290-ACCT-NOT-FOUND.
  7692     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  7693
  7694 1299-EXIT.
  7695     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 142
* EL1278.cbl
  7697 1300-READ-ACCOUNT-MASTER  SECTION.
  7698
  7699* EXEC CICS HANDLE CONDITION
  7700*        NOTFND   (0580-ACCT-NOT-FOUND)
  7701*        ENDFILE  (0580-ACCT-NOT-FOUND)
  7702*    END-EXEC.
  7703*    MOVE '"$I''                  ! & #00007364' TO DFHEIV0
  7704     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7705     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7706     MOVE X'2620233030303037333634' TO DFHEIV0(25:11)
  7707     CALL 'kxdfhei1' USING DFHEIV0
  7708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7709
  7710
  7711
  7712* EXEC CICS READNEXT
  7713*        DATASET  (ERACCT-ID)
  7714*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7715*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  7716*    END-EXEC.
  7717     MOVE 0
  7718       TO DFHEIV11
  7719*    MOVE '&.S                   )   #00007369' TO DFHEIV0
  7720     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7721     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7722     MOVE X'2020233030303037333639' TO DFHEIV0(25:11)
  7723     CALL 'kxdfhei1' USING DFHEIV0,
  7724           ERACCT-ID,
  7725           DFHEIV20,
  7726           DFHEIV99,
  7727           WS-AM-CONTROL-PRIMARY,
  7728           DFHEIV99,
  7729           DFHEIV11,
  7730           DFHEIV99,
  7731           DFHEIV99
  7732     SET ADDRESS OF ACCOUNT-MASTER TO
  7733         DFHEIV20
  7734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7735
  7736
  7737*    SERVICE RELOAD ACCOUNT-MASTER.
  7738
  7739 1399-EXIT.
  7740     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 143
* EL1278.cbl
  7742 1400-GET-REFUND-TYPE  SECTION.
  7743     IF LIFE-REFUND-SEARCH
  7744         NEXT SENTENCE
  7745     ELSE
  7746         GO TO 1410-AH-REFUND-TYPE.
  7747
  7748     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  7749         MOVE SPACES             TO  HLCALCO
  7750                                     HLCAL1O
  7751         GO TO 1499-EXIT.
  7752
  7753     MOVE CP-REFUND-TYPE-USED    TO  HLCAL1O.
  7754
  7755     EVALUATE TRUE
  7756        WHEN CP-R-AS-REPOSSESSION
  7757           MOVE 'REPOSSESSION'     TO  HLCALCO
  7758        WHEN CP-R-AS-R78
  7759           MOVE 'RULE 78'          TO  HLCALCO
  7760        WHEN  CP-R-AS-PRORATA
  7761           MOVE 'PRO RATA'         TO  HLCALCO
  7762        WHEN CP-R-AS-CALIF
  7763           MOVE 'CALIF'            TO  HLCALCO
  7764        WHEN CP-R-AS-TEXAS
  7765           MOVE 'IRREG'            TO  HLCALCO
  7766        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  7767           MOVE 'UTAH'             TO  HLCALCO
  7768        WHEN CP-R-AS-FARM-PLAN
  7769           MOVE 'FARM PLAN'        TO  HLCALCO
  7770        WHEN CP-R-AS-NET-PAY
  7771           MOVE 'NET PAY'          TO  HLCALCO
  7772        WHEN CP-R-AS-ANTICIPATION
  7773           MOVE 'ANTICIPATION'     TO  HLCALCO
  7774        WHEN CP-R-AS-MEAN
  7775           MOVE 'MEAN'             TO  HLCALCO
  7776        WHEN CP-R-AS-SUM-OF-DIGITS
  7777           MOVE 'SUM OF DIGIT'     TO  HLCALCO
  7778        WHEN OTHER
  7779           MOVE 'UNDEFINED'        TO  HLCALCO
  7780     END-EVALUATE.
  7781
  7782     GO TO 1499-EXIT.
  7783
  7784 1410-AH-REFUND-TYPE.
  7785     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  7786         MOVE SPACES             TO  HACALCO
  7787                                     HACAL1O
  7788         GO TO 1499-EXIT.
  7789
  7790     MOVE CP-REFUND-TYPE-USED    TO  HACAL1O.
  7791
  7792     EVALUATE TRUE
  7793        WHEN CP-R-AS-REPOSSESSION
  7794           MOVE 'REPOSSESSION'     TO HACALCO
  7795        WHEN CP-R-AS-R78
  7796           MOVE 'RULE 78'          TO HACALCO
  7797        WHEN CP-R-AS-PRORATA
  7798           MOVE 'PRO RATA'         TO HACALCO
  7799        WHEN CP-REFUND-TYPE-USED = '3'
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 144
* EL1278.cbl
  7800           MOVE 'CALIF'            TO HACALCO
  7801        WHEN CP-R-AS-TEXAS
  7802           MOVE 'IRREG'            TO HACALCO
  7803        WHEN CP-R-AS-FARM-PLAN
  7804           MOVE 'FARM PLAN'        TO HACALCO
  7805        WHEN CP-R-AS-NET-PAY
  7806           MOVE 'NET PAY'          TO HACALCO
  7807        WHEN CP-R-AS-ANTICIPATION
  7808           MOVE 'ANTICIPATION'     TO HACALCO
  7809        WHEN CP-R-AS-MEAN
  7810           MOVE 'MEAN'             TO HACALCO
  7811        WHEN CP-R-AS-SUM-OF-DIGITS
  7812           MOVE 'SUM OF DIGIT'     TO HACALCO
  7813        WHEN CP-GAP-ACTUARIAL
  7814           MOVE 'SP ACTUARIAL'     TO HACALCO
  7815        WHEN CP-R-AS-SPP-DDF
  7816           MOVE 'SPEC DDF'         TO HACALCO
  7817        WHEN CP-R-AS-SPP-DDF-IU
  7818           MOVE 'SPEC DDF IU'      TO HACALCO
  7819        WHEN OTHER
  7820           MOVE 'UNKNOWN'          TO HLCALCO
  7821     END-EVALUATE
  7822     .
  7823 1499-EXIT.
  7824     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 145
* EL1278.cbl
  7826 1500-END-BROWSE  SECTION.
  7827     IF BROWSE-STARTED
  7828
  7829* EXEC CICS ENDBR
  7830*            DATASET  (ERACCT-ID)
  7831*        END-EXEC.
  7832     MOVE 0
  7833       TO DFHEIV11
  7834*    MOVE '&2                    $   #00007466' TO DFHEIV0
  7835     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7836     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7837     MOVE X'2020233030303037343636' TO DFHEIV0(25:11)
  7838     CALL 'kxdfhei1' USING DFHEIV0,
  7839           ERACCT-ID,
  7840           DFHEIV11,
  7841           DFHEIV99
  7842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7843
  7844
  7845 1599-EXIT.
  7846     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 146
* EL1278.cbl
  7848 1600-LOCATE-BENEFIT  SECTION.
  7849
  7850* EXEC CICS HANDLE CONDITION
  7851*        NOTFND  (1699-EXIT)
  7852*    END-EXEC.
  7853*    MOVE '"$I                   ! '' #00007474' TO DFHEIV0
  7854     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7855     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7856     MOVE X'2720233030303037343734' TO DFHEIV0(25:11)
  7857     CALL 'kxdfhei1' USING DFHEIV0
  7858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7859
  7860
  7861     MOVE SPACES                 TO  WS-KIND.
  7862     MOVE ZERO                   TO  WS-NOT-FOUND.
  7863     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7864     MOVE SPACES                 TO  WS-CF-STATE.
  7865     MOVE WS-BENEFIT-NO          TO  WS-CF-BENEFIT-NO.
  7866
  7867
  7868* EXEC CICS READ
  7869*        DATASET  (ELCNTL-ID)
  7870*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7871*        SET      (ADDRESS OF CONTROL-FILE)
  7872*        GTEQ
  7873*    END-EXEC.
  7874*    MOVE '&"S        G          (   #00007484' TO DFHEIV0
  7875     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7876     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7877     MOVE X'2020233030303037343834' TO DFHEIV0(25:11)
  7878     CALL 'kxdfhei1' USING DFHEIV0,
  7879           ELCNTL-ID,
  7880           DFHEIV20,
  7881           DFHEIV99,
  7882           WS-CF-CONTROL-PRIMARY,
  7883           DFHEIV99,
  7884           DFHEIV99,
  7885           DFHEIV99
  7886     SET ADDRESS OF CONTROL-FILE TO
  7887         DFHEIV20
  7888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7889
  7890
  7891*    SERVICE RELOAD CONTROL-FILE.
  7892
  7893     IF WS-CF-COMPANY-ID  IS NOT EQUAL TO  CF-COMPANY-ID
  7894       OR WS-CF-RECORD-TYPE  IS NOT EQUAL TO  CF-RECORD-TYPE
  7895         GO TO 1699-EXIT.
  7896
  7897     MOVE +1                     TO  WS-INDEX.
  7898
  7899 1610-LOOKUP-BENEFIT.
  7900     IF WS-BENEFIT-NO  IS EQUAL TO  CF-BENEFIT-CODE (WS-INDEX)
  7901         MOVE CF-BENEFIT-ALPHA (WS-INDEX)
  7902                                 TO  WS-KIND
  7903         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  7904                                 TO  WS-CALC-CD
  7905         MOVE CF-BENEFIT-DESCRIP (WS-INDEX)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 147
* EL1278.cbl
  7906                                 TO  WS-BENEFIT-DESCRIP
  7907         MOVE +1                 TO  WS-NOT-FOUND
  7908         GO TO 1699-EXIT.
  7909
  7910     IF CF-BENEFIT-CODE (WS-INDEX)
  7911             IS NOT LESS THAN  CF-HI-BEN-IN-REC
  7912         GO TO 1699-EXIT.
  7913
  7914     IF WS-INDEX  IS LESS THAN  +8
  7915         ADD +1                  TO  WS-INDEX
  7916         GO TO 1610-LOOKUP-BENEFIT.
  7917
  7918 1699-EXIT.
  7919     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 148
* EL1278.cbl
  7921 1700-WRITE-CERT-NOTE      SECTION.
  7922
  7923     IF NOT MODIFY-CERT-CAP
  7924         MOVE 'UPDATE'           TO  SM-READ
  7925         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  7926         MOVE ER-0070            TO  EMI-ERROR
  7927         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7928         GO TO 8200-SEND-DATAONLY.
  7929
  7930**MOVE CANCEL QUOTE NOTE INFO
  7931     IF PI-LF-REFUND-AMT NUMERIC
  7932        MOVE PI-LF-REFUND-AMT    TO WS-CN-LIFE-AMT-RF
  7933        MOVE PI-LF-REFUND-METH   TO WS-CN-LF-REF-METH
  7934     ELSE
  7935        MOVE ZERO                TO WS-CN-LIFE-AMT-RF
  7936                                    PI-LF-REFUND-AMT
  7937        MOVE SPACE               TO WS-CN-LF-REF-METH
  7938                                    PI-LF-REFUND-METH.
  7939
  7940     IF PI-AH-REFUND-AMT NUMERIC
  7941        MOVE PI-AH-REFUND-AMT    TO WS-CN-AH-AMT-RF
  7942        MOVE PI-AH-REFUND-METH   TO WS-CN-AH-REF-METH
  7943     ELSE
  7944        MOVE ZERO                TO WS-CN-AH-AMT-RF
  7945                                    PI-AH-REFUND-AMT
  7946        MOVE SPACE               TO WS-CN-AH-REF-METH
  7947                                    PI-AH-REFUND-METH.
  7948
  7949     COMPUTE PI-TOTAL-REFUND-AMT = PI-LF-REFUND-AMT +
  7950                                   PI-AH-REFUND-AMT.
  7951
  7952     MOVE PI-TOTAL-REFUND-AMT    TO WS-CN-TOTAL-RF.
  7953
  7954     MOVE SAVE-DATE              TO WS-CN-DT-QUOTED.
  7955     MOVE PI-PROCESSOR-ID        TO WS-CN-PROCESSOR-ID.
  7956     IF PI-LF-CANCEL-DATE-ED NOT EQUAL SPACE
  7957        MOVE PI-LF-CANCEL-DATE-ED
  7958                                 TO WS-CN-CANCEL-DT
  7959     ELSE
  7960        MOVE PI-AH-CANCEL-DATE-ED
  7961                                 TO WS-CN-CANCEL-DT.
  7962** READ ERNOTE FILE
  7963     MOVE PI-CARRIER             TO WS-CN-CARRIER.
  7964     MOVE PI-GROUPING            TO WS-CN-GROUPING.
  7965     MOVE PI-STATE               TO WS-CN-STATE.
  7966     MOVE PI-ACCOUNT             TO WS-CN-ACCOUNT.
  7967     MOVE PI-CERT-PRIME          TO WS-CN-CERT-PRIME.
  7968     MOVE PI-CERT-SFX            TO WS-CN-CERT-SFX.
  7969     MOVE PI-CERT-EFF-DT         TO WS-CN-CERT-EFF-DT.
  7970     MOVE PI-COMPANY-CD          TO WS-CN-COMPANY-CD.
  7971     MOVE SPACES                 TO CERTIFICATE-NOTE.
  7972
  7973
  7974* EXEC CICS READ
  7975*        EQUAL
  7976*        DATASET  (ERNOTE-ID)
  7977*        INTO     (CERTIFICATE-NOTE)
  7978*        RIDFLD   (WS-CN-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 149
* EL1278.cbl
  7979*        RESP     (WS-RESPONSE)
  7980*        UPDATE
  7981*    END-EXEC.
  7982     MOVE LENGTH OF
  7983      CERTIFICATE-NOTE
  7984       TO DFHEIV11
  7985*    MOVE '&"IL       EU         (  N#00007573' TO DFHEIV0
  7986     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7987     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7988     MOVE X'204E233030303037353733' TO DFHEIV0(25:11)
  7989     CALL 'kxdfhei1' USING DFHEIV0,
  7990           ERNOTE-ID,
  7991           CERTIFICATE-NOTE,
  7992           DFHEIV11,
  7993           WS-CN-CONTROL-PRIMARY,
  7994           DFHEIV99,
  7995           DFHEIV99,
  7996           DFHEIV99
  7997     MOVE EIBRESP  TO WS-RESPONSE
  7998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7999
  8000
  8001     IF WS-RESP-NOTFND
  8002         GO TO 1750-WRITE-NOTE.
  8003
  8004     MOVE +0                     TO WS-SUB1.
  8005
  8006 1710-BUILD-NOTE-LINE.
  8007     ADD +1                      TO WS-SUB1.
  8008
  8009     IF WS-SUB1 GREATER 10
  8010        MOVE ER-8161            TO  EMI-ERROR
  8011        PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  8012        GO TO 8200-SEND-DATAONLY.
  8013
  8014     IF CN-LINE (WS-SUB1) GREATER SPACES
  8015        GO TO 1710-BUILD-NOTE-LINE
  8016     ELSE
  8017        MOVE WS-CAN-QUOTE-NOTE   TO CN-LINE (WS-SUB1).
  8018
  8019     MOVE PI-PROCESSOR-ID        TO CN-LAST-MAINT-USER.
  8020     MOVE EIBTIME                TO CN-LAST-MAINT-HHMMSS.
  8021     MOVE SAVE-BIN-DATE          TO CN-LAST-MAINT-DT.
  8022
  8023
  8024* EXEC CICS REWRITE
  8025*        FROM      (CERTIFICATE-NOTE)
  8026*        DATASET   (ERNOTE-ID)
  8027*    END-EXEC.
  8028     MOVE LENGTH OF
  8029      CERTIFICATE-NOTE
  8030       TO DFHEIV11
  8031*    MOVE '&& L                  %   #00007604' TO DFHEIV0
  8032     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8033     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8034     MOVE X'2020233030303037363034' TO DFHEIV0(25:11)
  8035     CALL 'kxdfhei1' USING DFHEIV0,
  8036           ERNOTE-ID,
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 150
* EL1278.cbl
  8037           CERTIFICATE-NOTE,
  8038           DFHEIV11,
  8039           DFHEIV99
  8040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8041
  8042
  8043     MOVE ER-8160                TO EMI-ERROR.
  8044     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  8045     GO TO 8200-SEND-DATAONLY.
  8046
  8047 1750-WRITE-NOTE.
  8048
  8049     MOVE SPACES                 TO CERTIFICATE-NOTE.
  8050     MOVE 'CN'                   TO CN-RECORD-ID.
  8051     MOVE PI-CARRIER             TO CN-CARRIER.
  8052     MOVE PI-GROUPING            TO CN-GROUPING.
  8053     MOVE PI-STATE               TO CN-STATE.
  8054     MOVE PI-ACCOUNT             TO CN-ACCOUNT.
  8055     MOVE PI-CERT-PRIME          TO CN-CERT-PRIME.
  8056     MOVE PI-CERT-SFX            TO CN-CERT-SFX.
  8057     MOVE PI-CERT-EFF-DT         TO CN-CERT-EFF-DT.
  8058     MOVE PI-COMPANY-CD          TO CN-COMPANY-CD.
  8059     MOVE ZEROS                  TO CN-BILLING-START-LINE-NO.
  8060     MOVE ZEROS                  TO CN-BILLING-END-LINE-NO.
  8061
  8062     MOVE ZERO                   TO WS-SUB1.
  8063 1760-BUILD-NOTE-LINES.
  8064     ADD +1                      TO WS-SUB1.
  8065
  8066     IF WS-SUB1 GREATER +10
  8067        GO TO 1770-WRITE-NEW-NOTE.
  8068
  8069     IF WS-SUB1 EQUAL +1
  8070        MOVE WS-CAN-QUOTE-NOTE   TO CN-LINE (WS-SUB1)
  8071     ELSE
  8072        MOVE SPACES              TO CN-LINE (WS-SUB1).
  8073
  8074     GO TO 1760-BUILD-NOTE-LINES.
  8075
  8076 1770-WRITE-NEW-NOTE.
  8077
  8078     MOVE PI-PROCESSOR-ID        TO CN-LAST-MAINT-USER.
  8079     MOVE EIBTIME                TO CN-LAST-MAINT-HHMMSS.
  8080     MOVE SAVE-BIN-DATE          TO CN-LAST-MAINT-DT.
  8081
  8082
  8083* EXEC CICS WRITE
  8084*        FROM      (CERTIFICATE-NOTE)
  8085*        DATASET   (ERNOTE-ID)
  8086*        RIDFLD    (CN-CONTROL-PRIMARY)
  8087*    END-EXEC.
  8088     MOVE LENGTH OF
  8089      CERTIFICATE-NOTE
  8090       TO DFHEIV11
  8091*    MOVE '&$ L                  ''   #00007648' TO DFHEIV0
  8092     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8093     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8094     MOVE X'2020233030303037363438' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 151
* EL1278.cbl
  8095     CALL 'kxdfhei1' USING DFHEIV0,
  8096           ERNOTE-ID,
  8097           CERTIFICATE-NOTE,
  8098           DFHEIV11,
  8099           CN-CONTROL-PRIMARY,
  8100           DFHEIV99,
  8101           DFHEIV99
  8102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8103
  8104
  8105     MOVE ER-8160                TO EMI-ERROR.
  8106     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  8107     GO TO 8200-SEND-DATAONLY.
  8108
  8109 1799-EXIT.
  8110     EXIT.
  8111 1800-READ-ELCERT-UPDATE.
  8112     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8113     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8114     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8115     MOVE PI-STATE               TO  WS-CM-STATE.
  8116     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  8117     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8118     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8119     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8120
  8121* EXEC CICS READ
  8122*        UPDATE
  8123*        DATASET  (ELCERT-ID)
  8124*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8125*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8126*        RESP     (WS-RESPONSE)
  8127*    END-EXEC
  8128*    MOVE '&"S        EU         (  N#00007669' TO DFHEIV0
  8129     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8130     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8131     MOVE X'204E233030303037363639' TO DFHEIV0(25:11)
  8132     CALL 'kxdfhei1' USING DFHEIV0,
  8133           ELCERT-ID,
  8134           DFHEIV20,
  8135           DFHEIV99,
  8136           WS-CM-CONTROL-PRIMARY,
  8137           DFHEIV99,
  8138           DFHEIV99,
  8139           DFHEIV99
  8140     SET ADDRESS OF CERTIFICATE-MASTER TO
  8141         DFHEIV20
  8142     MOVE EIBRESP  TO WS-RESPONSE
  8143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8144     .
  8145 1800-EXIT.
  8146     EXIT.
  8147 1810-REWRITE-ELCERT.
  8148
  8149* EXEC CICS REWRITE
  8150*        FROM      (CERTIFICATE-MASTER)
  8151*        DATASET   (ELCERT-ID)
  8152*        RESP     (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 152
* EL1278.cbl
  8153*    END-EXEC.
  8154     MOVE LENGTH OF
  8155      CERTIFICATE-MASTER
  8156       TO DFHEIV11
  8157*    MOVE '&& L                  %  N#00007680' TO DFHEIV0
  8158     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8159     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8160     MOVE X'204E233030303037363830' TO DFHEIV0(25:11)
  8161     CALL 'kxdfhei1' USING DFHEIV0,
  8162           ELCERT-ID,
  8163           CERTIFICATE-MASTER,
  8164           DFHEIV11,
  8165           DFHEIV99
  8166     MOVE EIBRESP  TO WS-RESPONSE
  8167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8168
  8169     .
  8170 1810-EXIT.
  8171     EXIT.
  8172 5000-GET-LF-AM-REM-TERM.
  8173     MOVE +1                     TO SUB3.
  8174
  8175 5100-GET-LF-AM-REM-TERM.
  8176     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  8177        IF CM-LF-BENEFIT-CD = AM-BENEFIT-CODE (SUB3)
  8178           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  8179                         TO WS-SAVE-ALLOWABLE-BENEFIT
  8180           GO TO 5300-MOVE-LF-REM-TERM.
  8181
  8182     IF SUB3 LESS THAN +20
  8183        ADD +1                   TO SUB3
  8184        GO TO 5100-GET-LF-AM-REM-TERM.
  8185
  8186     MOVE +1                     TO SUB3.
  8187
  8188     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  8189         GO TO 5200-EDIT-FOR-NINETY-LF.
  8190
  8191 5100-GET-LF-DMD-AM-REM-TERM.
  8192
  8193     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  8194        IF CM-LF-BENEFIT-CD = AM-BENEFIT-DMD-CODE (SUB3)
  8195           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  8196                         TO WS-SAVE-ALLOWABLE-BENEFIT
  8197           GO TO 5300-MOVE-LF-REM-TERM.
  8198
  8199     IF SUB3 LESS THAN +30
  8200        ADD +1                   TO SUB3
  8201        GO TO 5100-GET-LF-DMD-AM-REM-TERM.
  8202
  8203     MOVE +1                     TO SUB3.
  8204
  8205 5200-EDIT-FOR-NINETY-LF.
  8206
  8207***************************************************************
  8208*                                                             *
  8209*    NINETY BENEFIT PLAN TYPES:                               *
  8210*                                                             *
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 153
* EL1278.cbl
  8211*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8212*      92 = ALL GROUP REDUCING BENEFITS                       *
  8213*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8214*      94 = ALL GROUP LEVEL BENEFITS                          *
  8215*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8216*           BENEFIT CONTROLS.                                 *
  8217*      99 = ALL BENEFITS                                      *
  8218*                                                             *
  8219***************************************************************
  8220
  8221     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  8222                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  8223
  8224     IF (AM-BENEFIT-CODE (SUB3) = '99')
  8225       AND
  8226        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  8227           GO TO 5300-MOVE-LF-REM-TERM.
  8228
  8229     IF (AM-BENEFIT-CODE (SUB3) = '91')
  8230       AND
  8231        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  8232        IF CF-REDUCING (WS-INDEX)
  8233           IF CM-INDIVIDUAL
  8234               GO TO 5300-MOVE-LF-REM-TERM.
  8235
  8236     IF (AM-BENEFIT-CODE (SUB3) = '92')
  8237       AND
  8238        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  8239        IF CF-REDUCING (WS-INDEX)
  8240           IF CM-GROUP
  8241               GO TO 5300-MOVE-LF-REM-TERM.
  8242
  8243     IF (AM-BENEFIT-CODE (SUB3) = '93')
  8244       AND
  8245        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  8246        IF CF-LEVEL (WS-INDEX)
  8247           IF CM-INDIVIDUAL
  8248               GO TO 5300-MOVE-LF-REM-TERM.
  8249
  8250     IF (AM-BENEFIT-CODE (SUB3) = '94')
  8251       AND
  8252        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  8253        IF CF-LEVEL (WS-INDEX)
  8254           IF CM-GROUP
  8255               GO TO 5300-MOVE-LF-REM-TERM.
  8256
  8257     IF (AM-BENEFIT-CODE (SUB3) = '98')
  8258       AND
  8259        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  8260            GO TO 5300-MOVE-LF-REM-TERM.
  8261
  8262     IF SUB3 LESS THAN +20
  8263        ADD +1           TO SUB3
  8264          GO TO 5200-EDIT-FOR-NINETY-LF.
  8265
  8266     MOVE SPACES         TO WS-SAVE-ALLOWABLE-BENEFIT.
  8267
  8268     IF PI-COMPANY-ID NOT EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 154
* EL1278.cbl
  8269         MOVE '0'                 TO WS-LF-AM-REM-TERM-CALC
  8270         GO TO 5900-EXIT.
  8271
  8272     MOVE 1                       TO SUB3.
  8273
  8274 5200-EDIT-FOR-DMD-NINETY-LF.
  8275
  8276     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  8277                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  8278
  8279     IF (AM-BENEFIT-DMD-CODE (SUB3) = '99')
  8280       AND
  8281        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  8282           GO TO 5300-MOVE-LF-REM-TERM.
  8283
  8284     IF (AM-BENEFIT-DMD-CODE (SUB3) = '91')
  8285       AND
  8286        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  8287        IF CF-REDUCING (WS-INDEX)
  8288           IF CM-INDIVIDUAL
  8289               GO TO 5300-MOVE-LF-REM-TERM.
  8290
  8291     IF (AM-BENEFIT-DMD-CODE (SUB3) = '92')
  8292       AND
  8293        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  8294        IF CF-REDUCING (WS-INDEX)
  8295           IF CM-GROUP
  8296               GO TO 5300-MOVE-LF-REM-TERM.
  8297
  8298     IF (AM-BENEFIT-DMD-CODE (SUB3) = '93')
  8299       AND
  8300        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  8301        IF CF-LEVEL (WS-INDEX)
  8302           IF CM-INDIVIDUAL
  8303               GO TO 5300-MOVE-LF-REM-TERM.
  8304
  8305     IF (AM-BENEFIT-DMD-CODE (SUB3) = '94')
  8306       AND
  8307        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  8308        IF CF-LEVEL (WS-INDEX)
  8309           IF CM-GROUP
  8310               GO TO 5300-MOVE-LF-REM-TERM.
  8311
  8312     IF (AM-BENEFIT-DMD-CODE (SUB3) = '98')
  8313       AND
  8314        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  8315            GO TO 5300-MOVE-LF-REM-TERM.
  8316
  8317     IF SUB3 LESS THAN +30
  8318        ADD +1                   TO SUB3
  8319          GO TO 5200-EDIT-FOR-DMD-NINETY-LF.
  8320
  8321     MOVE '0'                    TO WS-LF-AM-REM-TERM-CALC.
  8322
  8323     GO TO 5900-EXIT.
  8324
  8325 5300-MOVE-LF-REM-TERM.
  8326     MOVE WS-SAVE-BENEFIT-REM-TERM
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 155
* EL1278.cbl
  8327                                 TO WS-LF-AM-REM-TERM-CALC.
  8328
  8329 5900-EXIT.
  8330      EXIT.
  8331
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 156
* EL1278.cbl
  8333
  8334 6000-GET-AH-AM-REM-TERM.
  8335     MOVE +1                     TO SUB3.
  8336
  8337 6100-GET-AH-AM-REM-TERM.
  8338
  8339     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  8340        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB3)
  8341           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  8342                         TO WS-SAVE-ALLOWABLE-BENEFIT
  8343           GO TO 6300-MOVE-AH-REM-TERM.
  8344
  8345     IF SUB3 LESS THAN +20
  8346        ADD +1                   TO SUB3
  8347        GO TO 6100-GET-AH-AM-REM-TERM.
  8348
  8349     MOVE +1                     TO SUB3.
  8350
  8351     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  8352         GO TO 6200-EDIT-FOR-NINETY-AH.
  8353
  8354 6100-GET-AH-AM-DMD-REM-TERM.
  8355     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  8356        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB3)
  8357           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  8358                         TO WS-SAVE-ALLOWABLE-BENEFIT
  8359           GO TO 6300-MOVE-AH-REM-TERM.
  8360
  8361     IF SUB3 LESS THAN +30
  8362        ADD +1                   TO SUB3
  8363        GO TO 6100-GET-AH-AM-DMD-REM-TERM.
  8364
  8365     MOVE +1                     TO SUB3.
  8366
  8367 6200-EDIT-FOR-NINETY-AH.
  8368
  8369***************************************************************
  8370*                                                             *
  8371*    NINETY BENEFIT PLAN TYPES:                               *
  8372*                                                             *
  8373*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8374*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8375*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8376*           BENEFIT CONTROLS.                                 *
  8377*      99 = ALL BENEFITS.                                     *
  8378*                                                             *
  8379***************************************************************
  8380
  8381     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  8382                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  8383
  8384     IF AM-BENEFIT-CODE (SUB3) = '99'
  8385       AND
  8386        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  8387           GO TO 6300-MOVE-AH-REM-TERM.
  8388
  8389     IF AM-BENEFIT-CODE (SUB3) = '91'
  8390       AND
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 157
* EL1278.cbl
  8391        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  8392           IF CM-INDIVIDUAL
  8393               GO TO 6300-MOVE-AH-REM-TERM.
  8394
  8395     IF AM-BENEFIT-CODE (SUB3) = '92'
  8396       AND
  8397        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  8398           IF CM-GROUP
  8399               GO TO 6300-MOVE-AH-REM-TERM.
  8400
  8401     IF AM-BENEFIT-CODE (SUB3) = '98'
  8402       AND
  8403        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  8404           GO TO 6300-MOVE-AH-REM-TERM.
  8405
  8406     IF SUB3 LESS THAN +20
  8407        ADD +1                    TO SUB3
  8408        GO TO 6200-EDIT-FOR-NINETY-AH.
  8409
  8410     MOVE +1                      TO SUB3.
  8411
  8412     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  8413         MOVE '0'                 TO WS-AH-AM-REM-TERM-CALC
  8414         GO TO 6900-EXIT.
  8415
  8416 6200-EDIT-FOR-DMD-NINETY-AH.
  8417
  8418     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  8419                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  8420
  8421     IF AM-BENEFIT-DMD-CODE (SUB3) = '99'
  8422       AND
  8423        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  8424           GO TO 6300-MOVE-AH-REM-TERM.
  8425
  8426     IF AM-BENEFIT-DMD-CODE (SUB3) = '91'
  8427       AND
  8428        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  8429           IF CM-INDIVIDUAL
  8430               GO TO 6300-MOVE-AH-REM-TERM.
  8431
  8432     IF AM-BENEFIT-DMD-CODE (SUB3) = '92'
  8433       AND
  8434        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  8435           IF CM-GROUP
  8436               GO TO 6300-MOVE-AH-REM-TERM.
  8437
  8438     IF AM-BENEFIT-DMD-CODE (SUB3) = '98'
  8439       AND
  8440        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  8441           GO TO 6300-MOVE-AH-REM-TERM.
  8442
  8443     IF SUB3 LESS THAN +30
  8444        ADD +1                   TO SUB3
  8445        GO TO 6200-EDIT-FOR-DMD-NINETY-AH.
  8446
  8447     MOVE '0'                    TO WS-AH-AM-REM-TERM-CALC.
  8448
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 158
* EL1278.cbl
  8449     GO TO 6900-EXIT.
  8450
  8451 6300-MOVE-AH-REM-TERM.
  8452
  8453     MOVE WS-SAVE-BENEFIT-REM-TERM
  8454                                 TO WS-AH-AM-REM-TERM-CALC.
  8455
  8456 6900-EXIT.
  8457      EXIT.
  8458
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 159
* EL1278.cbl
  8460 7000-GET-ERFORM     SECTION.
  8461
  8462* EXEC CICS HANDLE CONDITION
  8463*        NOTFND  (7000-EXIT)
  8464*    END-EXEC.
  8465*    MOVE '"$I                   ! ( #00007977' TO DFHEIV0
  8466     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8467     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8468     MOVE X'2820233030303037393737' TO DFHEIV0(25:11)
  8469     CALL 'kxdfhei1' USING DFHEIV0
  8470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8471
  8472
  8473     MOVE ' '                    TO  WS-FORM-RECORD-SW.
  8474     MOVE PI-COMPANY-CD          TO  WS-FO-COMPANY-CD.
  8475     MOVE PI-STATE               TO  WS-FO-STATE.
  8476     MOVE CM-POLICY-FORM-NO      TO  WS-FO-FORM-ID.
  8477     MOVE CM-CERT-EFF-DT         TO  WS-FO-EXP-DT.
  8478
  8479
  8480* EXEC CICS READ
  8481*        DATASET  (ERFORM-ID)
  8482*        RIDFLD   (WS-FO-CONTROL-PRIMARY)
  8483*        SET      (ADDRESS OF FORM-MASTER)
  8484*        GTEQ
  8485*    END-EXEC.
  8486*    MOVE '&"S        G          (   #00007987' TO DFHEIV0
  8487     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8488     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8489     MOVE X'2020233030303037393837' TO DFHEIV0(25:11)
  8490     CALL 'kxdfhei1' USING DFHEIV0,
  8491           ERFORM-ID,
  8492           DFHEIV20,
  8493           DFHEIV99,
  8494           WS-FO-CONTROL-PRIMARY,
  8495           DFHEIV99,
  8496           DFHEIV99,
  8497           DFHEIV99
  8498     SET ADDRESS OF FORM-MASTER TO
  8499         DFHEIV20
  8500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8501
  8502
  8503     IF PI-COMPANY-CD     EQUAL FO-COMPANY-CD AND
  8504        PI-STATE          EQUAL FO-STATE      AND
  8505        CM-POLICY-FORM-NO EQUAL FO-FORM-ID
  8506         MOVE 'Y'  TO WS-FORM-RECORD-SW
  8507         GO TO 7000-EXIT.
  8508 7000-EXIT.
  8509     EXIT.
  8510 7100-BENEFIT-SEARCH SECTION.
  8511
  8512     IF CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES
  8513        MOVE +1                  TO  SUB4
  8514        PERFORM 7150-BENEFIT-LIFE-SEARCH THRU 7150-EXIT.
  8515
  8516     IF CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES
  8517        MOVE +1                  TO  SUB4
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 160
* EL1278.cbl
  8518        PERFORM 7250-BENEFIT-AH-SEARCH THRU 7250-EXIT.
  8519 7100-EXIT.
  8520     EXIT.
  8521 7150-BENEFIT-LIFE-SEARCH.
  8522     IF PI-LIFE-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  8523       IF CM-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  8524         IF (CM-LF-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  8525          OR CM-LF-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  8526            IF FO-PLAN-REFUND-METHOD (SUB4)
  8527                    IS GREATER THAN SPACES
  8528               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  8529                                    WS-LF-FO-REFUND-CALC
  8530               GO TO 7150-EXIT.
  8531
  8532     IF SUB4 LESS THAN +40
  8533         ADD +1              TO SUB4
  8534         GO TO 7150-BENEFIT-LIFE-SEARCH.
  8535
  8536 7150-EXIT.
  8537     EXIT.
  8538 7250-BENEFIT-AH-SEARCH.
  8539     IF PI-AH-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  8540       IF CM-AH-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  8541         IF (CM-AH-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  8542          OR CM-AH-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  8543            IF FO-PLAN-REFUND-METHOD (SUB4)
  8544                    IS GREATER THAN SPACES
  8545               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  8546                                    WS-AH-FO-REFUND-CALC
  8547               GO TO 7250-EXIT.
  8548
  8549     IF SUB4 LESS THAN +40
  8550         ADD +1              TO SUB4
  8551         GO TO 7250-BENEFIT-AH-SEARCH.
  8552
  8553 7250-EXIT.
  8554     EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 161
* EL1278.cbl
  8556
  8557 8100-SEND-INITIAL-MAP  SECTION.
  8558     MOVE SAVE-DATE              TO  HDATEO.
  8559     MOVE EIBTIME                TO  TIME-IN.
  8560     MOVE TIME-OUT               TO  HTIMEO.
  8561     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  8562     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  8563     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  8564     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  8565
  8566     IF CM-LF-BENEFIT-CD = '00'
  8567         MOVE -1                 TO  HACANCL
  8568     ELSE
  8569         MOVE -1                 TO  HLCANCL.
  8570
  8571     IF PI-COMPANY-ID  EQUAL 'NCL'
  8572         MOVE AL-SANOF           TO  PFKEY11A.
  8573     IF PI-COMPANY-ID NOT = 'DCC'
  8574        MOVE AL-SADOF            TO CANREAHA
  8575                                    CLPYNHA
  8576                                    CANREAA
  8577                                    CLPYNA
  8578     END-IF
  8579
  8580
  8581* EXEC CICS SEND
  8582*        FROM    (EL127HO)
  8583*        MAPSET  (MAPSET-NAME)
  8584*        MAP     (MAP-NAME)
  8585*        CURSOR
  8586*        ERASE
  8587*    END-EXEC.
  8588     MOVE LENGTH OF
  8589      EL127HO
  8590       TO DFHEIV12
  8591     MOVE -1
  8592       TO DFHEIV11
  8593*    MOVE '8$     CT  E    H L F ,   #00008071' TO DFHEIV0
  8594     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8595     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8596     MOVE X'2020233030303038303731' TO DFHEIV0(25:11)
  8597     CALL 'kxdfhei1' USING DFHEIV0,
  8598           MAP-NAME,
  8599           EL127HO,
  8600           DFHEIV12,
  8601           MAPSET-NAME,
  8602           DFHEIV99,
  8603           DFHEIV99,
  8604           DFHEIV99,
  8605           DFHEIV11,
  8606           DFHEIV99,
  8607           DFHEIV99,
  8608           DFHEIV99
  8609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8610
  8611
  8612     GO TO 9000-RETURN-TRAN.
  8613
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 162
* EL1278.cbl
  8614 8200-SEND-DATAONLY  SECTION.
  8615     IF FIRST-ENTRY
  8616         GO TO 8100-SEND-INITIAL-MAP.
  8617
  8618     MOVE SAVE-DATE              TO  HDATEO.
  8619     MOVE EIBTIME                TO  TIME-IN.
  8620     MOVE TIME-OUT               TO  HTIMEO.
  8621     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  8622     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  8623     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  8624     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  8625     MOVE -1                     TO  HLCANCL.
  8626
  8627
  8628* EXEC CICS SEND DATAONLY
  8629*        FROM    (EL127HO)
  8630*        MAPSET  (MAPSET-NAME)
  8631*        MAP     (MAP-NAME)
  8632*        CURSOR
  8633*    END-EXEC.
  8634     MOVE LENGTH OF
  8635      EL127HO
  8636       TO DFHEIV12
  8637     MOVE -1
  8638       TO DFHEIV11
  8639*    MOVE '8$D    CT       H L F ,   #00008094' TO DFHEIV0
  8640     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  8641     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8642     MOVE X'2020233030303038303934' TO DFHEIV0(25:11)
  8643     CALL 'kxdfhei1' USING DFHEIV0,
  8644           MAP-NAME,
  8645           EL127HO,
  8646           DFHEIV12,
  8647           MAPSET-NAME,
  8648           DFHEIV99,
  8649           DFHEIV99,
  8650           DFHEIV99,
  8651           DFHEIV11,
  8652           DFHEIV99,
  8653           DFHEIV99,
  8654           DFHEIV99
  8655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8656
  8657
  8658     GO TO 9000-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 163
* EL1278.cbl
  8660 8300-SEND-TEXT  SECTION.
  8661
  8662* EXEC CICS SEND TEXT
  8663*        FROM    (LOGOFF-TEXT)
  8664*        LENGTH  (LOGOFF-LENGTH)
  8665*        ERASE
  8666*        FREEKB
  8667*    END-EXEC.
  8668*    MOVE '8&      T  E F  H   F -   #00008104' TO DFHEIV0
  8669     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8670     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8671     MOVE X'2020233030303038313034' TO DFHEIV0(25:11)
  8672     CALL 'kxdfhei1' USING DFHEIV0,
  8673           LOGOFF-TEXT,
  8674           LOGOFF-LENGTH,
  8675           DFHEIV99,
  8676           DFHEIV99,
  8677           DFHEIV99,
  8678           DFHEIV99,
  8679           DFHEIV99,
  8680           DFHEIV99,
  8681           DFHEIV99,
  8682           DFHEIV99,
  8683           DFHEIV99,
  8684           DFHEIV99
  8685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8686
  8687
  8688
  8689* EXEC CICS RETURN
  8690*    END-EXEC.
  8691*    MOVE '.(                    &   #00008111' TO DFHEIV0
  8692     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8693     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8694     MOVE X'2020233030303038313131' TO DFHEIV0(25:11)
  8695     CALL 'kxdfhei1' USING DFHEIV0,
  8696           DFHEIV99,
  8697           DFHEIV99,
  8698           DFHEIV99,
  8699           DFHEIV99,
  8700           DFHEIV99
  8701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8702
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 164
* EL1278.cbl
  8704 8600-DEEDIT  SECTION.
  8705
  8706* EXEC CICS BIF DEEDIT
  8707*        FIELD   (DEEDIT-FIELD)
  8708*        LENGTH  (15)
  8709*    END-EXEC.
  8710     MOVE 15
  8711       TO DFHEIV11
  8712*    MOVE '@"L                   #   #00008115' TO DFHEIV0
  8713     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8714     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8715     MOVE X'2020233030303038313135' TO DFHEIV0(25:11)
  8716     CALL 'kxdfhei1' USING DFHEIV0,
  8717           DEEDIT-FIELD,
  8718           DFHEIV11
  8719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8720
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 165
* EL1278.cbl
  8722 8700-UNAUTHORIZED-ACCESS  SECTION.
  8723     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  8724
  8725     GO TO 8300-SEND-TEXT.
  8726
  8727 8800-PF23  SECTION.
  8728     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  8729     MOVE XCTL-005               TO  PGM-NAME.
  8730
  8731     GO TO 9200-XCTL.
  8732
  8733 8900-RETURN-CICS  SECTION.
  8734
  8735* EXEC CICS RETURN
  8736*    END-EXEC.
  8737*    MOVE '.(                    &   #00008132' TO DFHEIV0
  8738     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8739     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8740     MOVE X'2020233030303038313332' TO DFHEIV0(25:11)
  8741     CALL 'kxdfhei1' USING DFHEIV0,
  8742           DFHEIV99,
  8743           DFHEIV99,
  8744           DFHEIV99,
  8745           DFHEIV99,
  8746           DFHEIV99
  8747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8748
  8749
  8750 9000-RETURN-TRAN  SECTION.
  8751     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  8752     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  8753
  8754
  8755* EXEC CICS RETURN
  8756*        TRANSID   (TRANS-ID)
  8757*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8758*        LENGTH    (PI-COMM-LENGTH)
  8759*    END-EXEC.
  8760*    MOVE '.(CT                  &   #00008139' TO DFHEIV0
  8761     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8762     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8763     MOVE X'2020233030303038313339' TO DFHEIV0(25:11)
  8764     CALL 'kxdfhei1' USING DFHEIV0,
  8765           TRANS-ID,
  8766           PROGRAM-INTERFACE-BLOCK,
  8767           PI-COMM-LENGTH,
  8768           DFHEIV99,
  8769           DFHEIV99
  8770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8771
  8772
  8773 9100-RETURN-MAIN-MENU  SECTION.
  8774     MOVE XCTL-126               TO  PGM-NAME.
  8775
  8776     GO TO 9200-XCTL.
  8777
  8778 9200-XCTL  SECTION.
  8779
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 166
* EL1278.cbl
  8780* EXEC CICS XCTL
  8781*        PROGRAM   (PGM-NAME)
  8782*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8783*        LENGTH    (PI-COMM-LENGTH)
  8784*    END-EXEC.
  8785*    MOVE '.$C                   $   #00008151' TO DFHEIV0
  8786     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8787     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8788     MOVE X'2020233030303038313531' TO DFHEIV0(25:11)
  8789     CALL 'kxdfhei1' USING DFHEIV0,
  8790           PGM-NAME,
  8791           PROGRAM-INTERFACE-BLOCK,
  8792           PI-COMM-LENGTH
  8793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8794
  8795
  8796 9300-CLEAR  SECTION.
  8797     MOVE ' '                    TO  PI-PEND-SW.
  8798     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  8799
  8800     GO TO 9200-XCTL.
  8801
  8802 9400-PF12  SECTION.
  8803     MOVE XCTL-010               TO  PGM-NAME.
  8804
  8805     GO TO 9200-XCTL.
  8806
  8807 9500-PGMID-ERROR  SECTION.
  8808
  8809* EXEC CICS HANDLE CONDITION
  8810*        PGMIDERR  (8300-SEND-TEXT)
  8811*    END-EXEC.
  8812*    MOVE '"$L                   ! ) #00008169' TO DFHEIV0
  8813     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8814     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8815     MOVE X'2920233030303038313639' TO DFHEIV0(25:11)
  8816     CALL 'kxdfhei1' USING DFHEIV0
  8817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8818
  8819
  8820     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  8821     MOVE ' '                    TO  PI-ENTRY-CD-1.
  8822     MOVE XCTL-005               TO  PGM-NAME.
  8823     MOVE PGM-NAME               TO  LOGOFF-PGM.
  8824     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  8825
  8826     GO TO 9200-XCTL.
  8827
  8828 9600-DATE-LINK  SECTION.
  8829     MOVE LINK-ELDATCV           TO  PGM-NAME
  8830
  8831
  8832* EXEC CICS LINK
  8833*        PROGRAM   (PGM-NAME)
  8834*        COMMAREA  (DATE-CONVERSION-DATA)
  8835*        LENGTH    (DC-COMM-LENGTH)
  8836*    END-EXEC.
  8837*    MOVE '."C                   ''   #00008184' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 167
* EL1278.cbl
  8838     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8839     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8840     MOVE X'2020233030303038313834' TO DFHEIV0(25:11)
  8841     CALL 'kxdfhei1' USING DFHEIV0,
  8842           PGM-NAME,
  8843           DATE-CONVERSION-DATA,
  8844           DC-COMM-LENGTH,
  8845           DFHEIV99,
  8846           DFHEIV99,
  8847           DFHEIV99
  8848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8849
  8850
  8851
  8852 9700-ERROR-FORMAT  SECTION.
  8853     IF NOT EMI-ERRORS-COMPLETE
  8854         MOVE LINK-001               TO  PGM-NAME
  8855
  8856* EXEC CICS LINK
  8857*            PROGRAM   (PGM-NAME)
  8858*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  8859*            LENGTH    (EMI-COMM-LENGTH)
  8860*        END-EXEC.
  8861*    MOVE '."C                   ''   #00008194' TO DFHEIV0
  8862     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8863     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8864     MOVE X'2020233030303038313934' TO DFHEIV0(25:11)
  8865     CALL 'kxdfhei1' USING DFHEIV0,
  8866           PGM-NAME,
  8867           ERROR-MESSAGE-INTERFACE-BLOCK,
  8868           EMI-COMM-LENGTH,
  8869           DFHEIV99,
  8870           DFHEIV99,
  8871           DFHEIV99
  8872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8873
  8874
  8875 9799-EXIT.
  8876     EXIT.
  8877
  8878 9800-SECURITY-VIOLATION  SECTION.
  8879*                            COPY ELCSCTP.
  8880******************************************************************
  8881*                                                                *
  8882*                            ELCSCTP                             *
  8883*                            VMOD=2.001                          *
  8884*                                                                *
  8885*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8886******************************************************************
  8887
  8888
  8889     MOVE EIBDATE          TO SM-JUL-DATE.
  8890     MOVE EIBTRMID         TO SM-TERMID.
  8891     MOVE THIS-PGM         TO SM-PGM.
  8892     MOVE EIBTIME          TO TIME-IN.
  8893     MOVE TIME-OUT         TO SM-TIME.
  8894     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8895
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 168
* EL1278.cbl
  8896
  8897* EXEC CICS LINK
  8898*         PROGRAM  ('EL003')
  8899*         COMMAREA (SECURITY-MESSAGE)
  8900*         LENGTH   (80)
  8901*    END-EXEC.
  8902     MOVE 'EL003' TO DFHEIV1
  8903     MOVE 80
  8904       TO DFHEIV11
  8905*    MOVE '."C                   ''   #00008221' TO DFHEIV0
  8906     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8907     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8908     MOVE X'2020233030303038323231' TO DFHEIV0(25:11)
  8909     CALL 'kxdfhei1' USING DFHEIV0,
  8910           DFHEIV1,
  8911           SECURITY-MESSAGE,
  8912           DFHEIV11,
  8913           DFHEIV99,
  8914           DFHEIV99,
  8915           DFHEIV99
  8916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8917
  8918
  8919******************************************************************
  8920
  8921
  8922 9899-EXIT.
  8923     EXIT.
  8924
  8925 9900-ABEND  SECTION.
  8926     MOVE LINK-004               TO  PGM-NAME.
  8927     MOVE DFHEIBLK               TO  EMI-LINE1.
  8928
  8929
  8930* EXEC CICS LINK
  8931*        PROGRAM   (PGM-NAME)
  8932*        COMMAREA  (EMI-LINE1)
  8933*        LENGTH    (72)
  8934*    END-EXEC.
  8935     MOVE 72
  8936       TO DFHEIV11
  8937*    MOVE '."C                   ''   #00008237' TO DFHEIV0
  8938     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8939     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8940     MOVE X'2020233030303038323337' TO DFHEIV0(25:11)
  8941     CALL 'kxdfhei1' USING DFHEIV0,
  8942           PGM-NAME,
  8943           EMI-LINE1,
  8944           DFHEIV11,
  8945           DFHEIV99,
  8946           DFHEIV99,
  8947           DFHEIV99
  8948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8949
  8950
  8951     MOVE -1                     TO  HLCANCL.
  8952
  8953     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 08:31 Page 169
* EL1278.cbl
  8954
  8955 9999-LAST-PARAGRAPH.
  8956
  8957* GOBACK.
  8958     MOVE '9%                    "   ' TO DFHEIV0
  8959     MOVE 'EL1278' TO DFHEIV1
  8960     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8961     GOBACK.
  8962
  8963 9999-DFHBACK SECTION.
  8964     MOVE '9%                    "   ' TO DFHEIV0
  8965     MOVE 'EL1278' TO DFHEIV1
  8966     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8967     GOBACK.
  8968 9999-DFHEXIT.
  8969     IF DFHEIGDJ EQUAL 0001
  8970         NEXT SENTENCE
  8971     ELSE IF DFHEIGDJ EQUAL 2
  8972         GO TO 9500-PGMID-ERROR,
  8973               9900-ABEND
  8974         DEPENDING ON DFHEIGDI
  8975     ELSE IF DFHEIGDJ EQUAL 3
  8976         GO TO 0910-NOT-FOUND
  8977         DEPENDING ON DFHEIGDI
  8978     ELSE IF DFHEIGDJ EQUAL 4
  8979         GO TO 1010-NOTFND,
  8980               1020-NOTOPEN
  8981         DEPENDING ON DFHEIGDI
  8982     ELSE IF DFHEIGDJ EQUAL 5
  8983         GO TO 1290-ACCT-NOT-FOUND,
  8984               1290-ACCT-NOT-FOUND
  8985         DEPENDING ON DFHEIGDI
  8986     ELSE IF DFHEIGDJ EQUAL 6
  8987         GO TO 0580-ACCT-NOT-FOUND,
  8988               0580-ACCT-NOT-FOUND
  8989         DEPENDING ON DFHEIGDI
  8990     ELSE IF DFHEIGDJ EQUAL 7
  8991         GO TO 1699-EXIT
  8992         DEPENDING ON DFHEIGDI
  8993     ELSE IF DFHEIGDJ EQUAL 8
  8994         GO TO 7000-EXIT
  8995         DEPENDING ON DFHEIGDI
  8996     ELSE IF DFHEIGDJ EQUAL 9
  8997         GO TO 8300-SEND-TEXT
  8998         DEPENDING ON DFHEIGDI.
  8999     MOVE '9%                    "   ' TO DFHEIV0
  9000     MOVE 'EL1278' TO DFHEIV1
  9001     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9002     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        6608     Code:       23496
