* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
    57* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    58* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    59* 092618  CR2018050200001  PEMA  Add check for open clm on issue
    60* 101019  CR2019100700001  PEMA  Disallow V status with claim
    61******************************************************************
    62 ENVIRONMENT DIVISION.
    63
    64 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page   3
* EL050.cbl
    66 WORKING-STORAGE SECTION.
    67 01  DFH-START PIC X(04).
    68
    69 77  FILLER   PIC X(32) VALUE '********************************'.
    70 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    71 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    72
    73 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    74 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    75                                   USAGE POINTER.
    76 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    77 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    78 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    79                                   USAGE IS POINTER.
    80 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    81 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    82                                   USAGE IS POINTER.
    83 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    84 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    85                                   USAGE IS POINTER.
    86
    87 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    88 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    89                                   USAGE IS POINTER.
    90
    91*    COPY ELC50WS.
    92*****************************************************************
    93*                                                               *
    94*                            ELC50WS.                           *
    95*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    96*                            VMOD=2.061.                        *
    97*                                                               *
    98*   THIS IS THE WORKING STORAGE FOR EL050                       *
    99*                                   EL517                       *
   100*****************************************************************
   101******************************************************************
   102*                   C H A N G E   L O G
   103*
   104* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   105*-----------------------------------------------------------------
   106*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   107* EFFECTIVE    NUMBER
   108*-----------------------------------------------------------------
   109* 123102                   PEMA  ADD DCC PROCESSING
   110* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   111* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   112* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   113* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   114* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   115* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   116* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   117* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   118* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   119* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   120* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   121* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   122* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   123* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page   4
* EL050.cbl
   124* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   125* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   126* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   127* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   128* 030309  CR2009021700001  PEMA  ADD ER-2883
   129* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   130* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   131* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   132* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   133* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   134* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   135* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   136* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   137* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   138* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   139* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   140* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   141* 061412  CR2011022800001  AJRA  NAPERSOFT
   142* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   143* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   144* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   145* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   146* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   147* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   148* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   149* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   150* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   151* 091114  IR2014091000001  TANA  ADD ERROR 2898
   152* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   153* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   154* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   155* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
   156* 100617  CR2017062000003  PEMA  Inforce state comm cap
   157* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
   158* 062017  CR2015091000001  PEMA  ADD ST INT RATE FIELD
   159* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
   160* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
   161* 100518  CR2017061500001  TANA  ADD NEW ERROR MSGS
   162* 092618  CR2018050200001  PEMA  Add check for open clm on issue
   163* 101019  CR2019100700001  PEMA  Add error 3281 V stat on claim
   164* 011020  IR2019121100004  PEMA  Add error 3069 name&age equal
   165* 012220  CR2018092700002  TANA  ADD NEW ERROR MSGS
   166*-----------------------------------------------------------------
   167
   168 01  WORK-AREAS.
   169
   170*****************************************************************
   171*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   172*****************************************************************
   173
   174     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   175     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   176     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   177     12  WS-NAME-EDIT-WORK-AREA.
   178         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   179         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   180             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   181         16  WS-WORK-NAME.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page   5
* EL050.cbl
   182             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   183             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   184             20  FILLER           PIC X(10)     VALUE SPACES.
   185         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   186             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   187
   188*****************************************************************
   189*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   190*****************************************************************
   191
   192     12  WS-ERRESC-KEY.
   193         16 WS-ERRESC-SEARCH-KEY.
   194             20  WS-ERRESC-COMPANY-CD PIC  X.
   195             20  WS-ERRESC-CARRIER    PIC  X.
   196             20  WS-ERRESC-GROUP      PIC X(6).
   197             20  WS-ERRESC-STATE      PIC XX.
   198             20  WS-ERRESC-ACCOUNT    PIC X(10).
   199         16 WS-ERRESC-RESIDUAL-KEY.
   200             20  WS-ERRESC-AGENT      PIC X(10).
   201             20  WS-ERRESC-RES-STATE  PIC XX.
   202             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   203*                                          YYYYMMDD
   204     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   205     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   206
   207*RESIDENT STATE TAX MASTER(ERRESS)
   208*
   209     12  WS-ERRESS-KEY.
   210         16  WS-ERRESS-COMPANY-CD      PIC  X.
   211         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   212         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   213         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   214*                                          YYYYMMDD
   215
   216     12  WS-CONTRACT-DATE              PIC 9(8).
   217*                                          YYYYMMDD
   218     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   219     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   220         16 WS-YEAR-YY                 PIC   9999.
   221         16 FILLER                     PIC 9(4).
   222*                                          YYYYMMDD
   223     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   224     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   225     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   226     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   227
   228     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   229         88  DPRB-1ST-TIME                      VALUE ' '.
   230
   231*****************************************************************
   232*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   233*****************************************************************
   234
   235     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   236     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   237     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   238     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   239     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page   6
* EL050.cbl
   240     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   241     12  ws-st-refund-int-rate   pic s9v9(4) comp-3 value +0.
   242     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   243     12  ws-st-agent-sig-edit    pic x          value spaces.
   244     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   245     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   246     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   247     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   248         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   249         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   250     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   251         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   252         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   253     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   254
   255     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   256     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   257
   258     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   259     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   260     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   261     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   262     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   263     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   264     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   265     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   266     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   267     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   268     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   269     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   270     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   271     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   272     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   273     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   274     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   275     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   276     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   277     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   278     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   279     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   280     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   281     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   282     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   283     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   284     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   285     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   286     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   287     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   288     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   289     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   290     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   291     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   292     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   293     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   294     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   295     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   296     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   297     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page   7
* EL050.cbl
   298     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   299     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   300     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   301     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   302     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   303     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   304     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   305     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   306     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   307     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   308     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   309     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   310     12  WS-2671-SW               PIC X         VALUE SPACE.
   311     12  WS-2672-SW               PIC X         VALUE SPACE.
   312     12  ws-9813-sw               pic x         value spaces.
   313     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   314         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   315     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   316         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   317     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   318
   319     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   320         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   321         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   322         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   323         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   324
   325     12  WS-CREDIT-EDIT-CONTROLS.
   326         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   327         16  WS-MIN-AGE           PIC 99                VALUE  0.
   328         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   329         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   330         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   331         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   332
   333     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   334     12  WS-AGE-FIELDS.
   335         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   336         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   337         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   338         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   339
   340     12  WS-SAVE-ALLOWABLE-BENEFIT.
   341         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   342         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   343         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   344         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   345         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   346         16  FILLER                      PIC XX.
   347
   348     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   349     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   350     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   351     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   352     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   353     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   354     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   355     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page   8
* EL050.cbl
   356     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   357     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   358
   359     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   360     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   361     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   362     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   363     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   364     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   365     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   366     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   367         88  WS-REDUCING              VALUE 'R'.
   368         88  WS-LEVEL                 VALUE 'L' 'P'.
   369     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   370
   371     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   372     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   373     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   374     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   375     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   376     12  ws-ah-max-bens           pic 99        value zeros.
   377     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   378     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   379     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   380     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   381
   382     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   383     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   384     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   385     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   386     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   387     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   388     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   389     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   390     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   391     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   392     12  WS-ACCT-SIG-SW.
   393         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   394         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   395     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   396     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   397     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   398     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   399     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   400     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   401     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   402     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   403     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   404     12  WS-INITIALS.
   405         16  WS-INIT-1            PIC X         VALUE SPACES.
   406         16  WS-INIT-2            PIC X         VALUE SPACES.
   407
   408     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   409     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   410     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   411     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   412     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   413*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page   9
* EL050.cbl
   414     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   415     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   416     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   417     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   418     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   419     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   420     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   421     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   422     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   423     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   424     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   425     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   426     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   427     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   428     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   429     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   430     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   431     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   432     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   433     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   434     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   435     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   436******** FLA
   437     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   438     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   439     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   440     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   441     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   442********
   443     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   444     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   445     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   446     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   447     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   448     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   449     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   450     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   451     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   452     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   453
   454     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   455         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   456                                         '0' THRU '9'.
   457
   458     12  NUMBER-OF-MONTHS.
   459         16  SK-MO OCCURS 12 TIMES PIC X.
   460
   461     12  WS-WORK-DATE.
   462         16  WS-YEAR            PIC 99    VALUE 00.
   463         16  WS-MONTH           PIC 99    VALUE 00.
   464         16  WS-DAY             PIC 99    VALUE 00.
   465
   466     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   467     12  WS-WORK-CRIT-DEV       REDEFINES
   468         WS-WORK-LF-CRIT-PER    PIC X(03).
   469
   470     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   471     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  10
* EL050.cbl
   472
   473     12  WS-WORK-DATE-FROM.
   474         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   475         16  FILLER             PIC X  VALUE SPACE.
   476         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   477         16  FILLER             PIC X         VALUE SPACE.
   478         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   479
   480     12  WS-WORK-DATE-THRU.
   481         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   482         16  FILLER             PIC X         VALUE SPACE.
   483         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   484         16  FILLER             PIC X         VALUE SPACE.
   485         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   486
   487     12  WS-LF-INPUT-CD.
   488         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   489         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   490
   491     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   492     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   493         16  WS-AH-INPUT-CD-1   PIC X.
   494         16  WS-AH-INPUT-CD-2-3 PIC XX.
   495
   496     12  WS-SWITCHES.
   497         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   498         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   499             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   500         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   501             88  BANK-ACCT-FOUND          VALUE 'Y'.
   502         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   503             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   504         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   505             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   506         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   507             88  COMP-MASTER-FOUND        VALUE 'Y'.
   508         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   509             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   510         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   511             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   512         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   513             88  STAT-MASTER-FOUND        VALUE 'Y'.
   514         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   515             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   516         16  ELCRTT-FOUND-SW          PIC X    VALUE SPACES.
   517             88  ELCRTT-FOUND             VALUE 'Y'.
   518         16  ELCRTT-UPDATE-SW         PIC X    VALUE SPACES.
   519             88  ELCRTT-UPDATE            VALUE 'Y'.
   520         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   521             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   522         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   523             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   524         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   525             88  FORM-MASTER-FOUND        VALUE 'Y'.
   526         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   527             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   528         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   529             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  11
* EL050.cbl
   530         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   531             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   532         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   533             88  NO-BENEFIT-FOUND         VALUE 'N'.
   534         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   535             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   536         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   537             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   538         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   539             88  AH-BENEFIT-FOUND         VALUE ' '.
   540             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   541         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   542             88  LF-BENEFIT-FOUND         VALUE ' '.
   543             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   544         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   545             88  NO-STATE-RECORD          VALUE '1'.
   546         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   547             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   548         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   549             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   550         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   551             88  CERT-WAS-FOUND           VALUE ' '.
   552             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   553         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   554             88  BROWSE-STARTED           VALUE 'Y'.
   555         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   556             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   557         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   558             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   559         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   560             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   561         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   562             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   563         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   564             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   565         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   566             88  APP-CERT-USED            VALUE 'Y' 'A'.
   567         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   568             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   569             88  FIRST-TIME-THROUGH       VALUE '1'.
   570             88  CTBL-NOT-FOUND           VALUE '2'.
   571
   572         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   573             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   574
   575         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   576             88  DLO-ERROR-FOUND          VALUE 'Y'.
   577
   578********FLA
   579     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   580     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   581********
   582     12  RC-SW-1                  PIC X           VALUE '0'.
   583     12  RC-SW-2                  PIC X           VALUE '0'.
   584     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   585     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   586     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   587     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  12
* EL050.cbl
   588     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   589     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   590     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   591     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   592     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   593     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   594     12  LIT-SPACES               PIC X           VALUE SPACES.
   595     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   596     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   597     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   598     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   599     12  erpndm-unlock-sw         pic x           value spaces.
   600         88  need-to-unlock-erpndm  value 'Y'.
   601     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   602     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   603     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   604         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   605         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   606     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   607         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   608
   609 01  WS-EXTRA-PERIODS-BY-STATE.
   610     12  WS-INT-PERIODS          PIC 9.
   611     12  WS-EXTRA-PMTS           PIC 9.
   612 01  ws-net-only-state           pic x value 'N'.
   613 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   614     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   615     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   616 01  WS-CRI-SSN-WORK-AREA.
   617     05  WS-CRI-SOC-SEC-NO.
   618         10  WS-SS-REPT-CD       PIC X(5).
   619         10  WS-SS-LAST-NAME     PIC X(5).
   620         10  WS-SS-INITIAL       PIC X.
   621
   622     05  WS-CRI-REPORT-CODE.
   623         10  FILLER              PIC X(5).
   624         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   625
   626     05  WS-CRI-LAST-NAME.
   627         10  WS-CRI-NAME-MOVE    PIC X(5).
   628         10  FILLER              PIC X(10).
   629
   630 01  ws-state-commission-caps.
   631     05  ws-sl-wk-rate           pic sv9(5) comp-3 value zeros.
   632     05  ws-jl-wk-rate           pic sv9(5) comp-3 value zeros.
   633     05  ws-sa-wk-rate           pic sv9(5) comp-3 value zeros.
   634     05  ws-ja-wk-rate           pic sv9(5) comp-3 value zeros.
   635     05  ws-ga-sl-wk-rate        pic sv9(5) comp-3 value zeros.
   636     05  ws-ga-jl-wk-rate        pic sv9(5) comp-3 value zeros.
   637     05  ws-ga-sa-wk-rate        pic sv9(5) comp-3 value zeros.
   638     05  ws-ga-ja-wk-rate        pic sv9(5) comp-3 value zeros.
   639     05  ws-tot-sl-wk-rate       pic sv9(5) comp-3 value zeros.
   640     05  ws-tot-jl-wk-rate       pic sv9(5) comp-3 value zeros.
   641     05  ws-tot-sa-wk-rate       pic sv9(5) comp-3 value zeros.
   642     05  ws-tot-ja-wk-rate       pic sv9(5) comp-3 value zeros.
   643     05  ws-st-cap-limit-to      pic x.
   644     05  ws-st-comm-cap-sl       pic s9v9(4) comp-3.
   645     05  ws-st-comm-cap-jl       pic s9v9(4) comp-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  13
* EL050.cbl
   646     05  ws-st-comm-cap-sa       pic s9v9(4) comp-3.
   647     05  ws-st-comm-cap-ja       pic s9v9(4) comp-3.
   648     05  ws-st-ga-comm-cap-sl    pic s9v9(4) comp-3.
   649     05  ws-st-ga-comm-cap-jl    pic s9v9(4) comp-3.
   650     05  ws-st-ga-comm-cap-sa    pic s9v9(4) comp-3.
   651     05  ws-st-ga-comm-cap-ja    pic s9v9(4) comp-3.
   652     05  ws-st-tot-comm-cap-sl   pic s9v9(4) comp-3.
   653     05  ws-st-tot-comm-cap-jl   pic s9v9(4) comp-3.
   654     05  ws-st-tot-comm-cap-sa   pic s9v9(4) comp-3.
   655     05  ws-st-tot-comm-cap-ja   pic s9v9(4) comp-3.
   656 01  WS-NUM-TABLE                PIC X(26)  VALUE
   657     '12345678012345070923456789'.
   658 01  FILLER REDEFINES WS-NUM-TABLE.
   659     05  WS-NUM OCCURS 26        PIC 9.
   660 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   661 01  V1                          PIC S999 COMP-3.
   662 01  V2                          PIC S999 COMP-3.
   663 01  V3                          PIC S999 COMP-3.
   664 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   665 01  FILLER REDEFINES WS-WORK-VIN.
   666     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   667 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   668 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   669 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   670 01  WS-HEX-WORK.
   671     05  FILLER                  PIC X  VALUE LOW-VALUES.
   672     05  WS-HEX-BYTE             PIC X.
   673 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   674 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   675 01  WS-WORK-HIN-ROW-B.
   676     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   677
   678 01  ws-benefit-cd-chg-sw      pic x value spaces.
   679     88  benefit-code-chg           value 'Y'.
   680 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   681 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   682     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   683 01  WS-ROW-D-TABLE.
   684     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   685
   686 01  WS-HIN-TABLE-B.
   687     05  F                       PIC XX VALUE 'A2'.
   688     05  F                       PIC XX VALUE 'B3'.
   689     05  F                       PIC XX VALUE 'C4'.
   690     05  F                       PIC XX VALUE 'D5'.
   691     05  F                       PIC XX VALUE 'E6'.
   692     05  F                       PIC XX VALUE 'F7'.
   693     05  F                       PIC XX VALUE 'G8'.
   694     05  F                       PIC XX VALUE 'H9'.
   695     05  F                       PIC XX VALUE 'I1'.
   696     05  F                       PIC XX VALUE 'J2'.
   697     05  F                       PIC XX VALUE 'K3'.
   698     05  F                       PIC XX VALUE 'L4'.
   699     05  F                       PIC XX VALUE 'M5'.
   700     05  F                       PIC XX VALUE 'N6'.
   701     05  F                       PIC XX VALUE 'O0'.
   702     05  F                       PIC XX VALUE 'P7'.
   703     05  F                       PIC XX VALUE 'Q0'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  14
* EL050.cbl
   704     05  F                       PIC XX VALUE 'R8'.
   705     05  F                       PIC XX VALUE 'S9'.
   706     05  F                       PIC XX VALUE 'T2'.
   707     05  F                       PIC XX VALUE 'U3'.
   708     05  F                       PIC XX VALUE 'V4'.
   709     05  F                       PIC XX VALUE 'W5'.
   710     05  F                       PIC XX VALUE 'X6'.
   711     05  F                       PIC XX VALUE 'Y7'.
   712     05  F                       PIC XX VALUE 'Z8'.
   713 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   714     05  WS-VAL-IN               PIC X.
   715     05  WS-VAL-OUT              PIC 9.
   716 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   717 01  ws-greg-eff-date            pic x(10) value ' '.
   718 01  WS-COMPARE-BINARY-DATES.
   719     05  WS-971231                PIC XX VALUE X'92FF'.
   720     05  WS-931231                PIC XX VALUE X'8CFF'.
   721     05  WS-791231                PIC XX VALUE X'77FF'.
   722     05  WS-771001                PIC XX VALUE X'74A1'.
   723     05  WS-820301                PIC XX VALUE X'7B41'.
   724     05  WS-831031                PIC XX VALUE X'7DBF'.
   725     05  WS-831231                PIC XX VALUE X'7DFF'.
   726     05  WS-810831                PIC XX VALUE X'7A7F'.
   727     05  WS-830901                PIC XX VALUE X'7D81'.
   728
   729 01  FILE-ACCESS-IDS.
   730     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   731     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   732     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   733     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   734     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   735     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   736     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   737     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   738     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   739     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   740     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   741     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   742     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   743     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   744     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   745     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   746     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   747 01  DD-IU-SW                    PIC X   VALUE ' '.
   748     88  DD-IU-PRESENT                 VALUE 'Y'.
   749
   750 01  ACCESS-KEYS.
   751     12  ELMSTR-KEY.
   752         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   753         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   754     12  W-CLAIM-KEY.
   755         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   756         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   757
   758     12  ELCNTL-KEY.
   759         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   760         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   761         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  15
* EL050.cbl
   762         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   763
   764     12  ELCERT-KEY.
   765         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   766         16  CERT-CARRIER         PIC X       VALUE SPACE.
   767         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   768         16  CERT-STATE           PIC XX      VALUE SPACES.
   769         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   770         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   771         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   772
   773     12  ELCERT2-KEY.
   774         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   775         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   776
   777     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   778
   779     12  ELCERT-SAVE.
   780         16  FILLER                      PIC XX    VALUE SPACES.
   781
   782         16  WCS-CONTROL-PRIMARY.
   783             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   784             20  WCS-CARRIER             PIC X     VALUE SPACE.
   785             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   786             20  WCS-STATE               PIC XX    VALUE SPACES.
   787             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   788             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   789             20  WCS-CERT-NO.
   790                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   791                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   792
   793         16  CS-CONTROL-BY-NAME.
   794             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   795             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   796             20  CS-INSURED-INITIALS.
   797                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   798                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   799
   800         16  CS-CONTROL-BY-SSN.
   801             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   802             20  CS-SOC-SEC-NO.
   803                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   804                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   805                 24  CS-SSN-LN3.
   806                     28 CS-INSURED-INITIALS-A2   PIC XX
   807                                     VALUE SPACES.
   808                     28 CS-PART-LAST-NAME-A2     PIC X
   809                                     VALUE SPACE.
   810
   811         16  CS-CONTROL-BY-CERT-NO.
   812             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   813             20  CS-CERT-NO-A4           PIC X(11)
   814                                     VALUE SPACES.
   815
   816         16  CS-CONTROL-BY-MEMB.
   817             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   818             20  CS-MEMBER-NO.
   819                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  16
* EL050.cbl
   820                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   821                 24  CS-MEMB-LN4.
   822                     28 CS-INSURED-INITIALS-A5   PIC XX
   823                                      VALUE SPACES.
   824                     28 CS-PART-LAST-NAME-A5     PIC XX
   825                                      VALUE SPACES.
   826
   827         16  FILLER              PIC X(360) VALUE SPACES.
   828
   829     12  ERACCT-KEY.
   830         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   831         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   832         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   833         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   834         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   835         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   836
   837     12  ERCOMP-KEY.
   838         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   839         16  COMP-CARRIER         PIC X     VALUE SPACES.
   840         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   841         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   842         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   843         16  COMP-TYPE            PIC X     VALUE SPACES.
   844
   845     12  ERLOFC-KEY.
   846         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   847         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   848         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   849         16  LOFC-STATE           PIC XX    VALUE SPACES.
   850         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   851         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   852
   853     12  WS-ELCRTT-KEY.
   854         16  WS-ELCRTT-PRIMARY       PIC X(33).
   855         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   856
   857     12  ERBXRF-KEY.
   858         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   859         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   860         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   861         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   862
   863     12  ERAGTC-KEY.
   864         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   865         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   866         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   867         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   868         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   869         16  AGTC-TYPE            PIC X     VALUE SPACES.
   870
   871     12  ERPLAN-KEY.
   872         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   873         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   874         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   875         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   876         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   877         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  17
* EL050.cbl
   878         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   879         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   880
   881     12  ERFORM-KEY.
   882         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   883         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   884         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   885         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   886
   887     12  ERREIN-KEY.
   888         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   889         16  REIN-TYPE            PIC X     VALUE SPACES.
   890         16  REIN-TABLE-CO.
   891             20  REIN-CODE-1      PIC X     VALUE SPACE.
   892             20  REIN-CODE-2      PIC X     VALUE SPACE.
   893             20  REIN-CODE-3      PIC X     VALUE SPACE.
   894         16  FILLER               PIC X(3)  VALUE SPACES.
   895
   896     12  ERCTBL-KEY.
   897         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   898         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   899         16  CTBL-CNTRL-2.
   900             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   901             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   902
   903     12  ELCRTO-KEY.
   904         16  ELCRTO-COMPANY-CD       PIC X.
   905         16  ELCRTO-CARRIER          PIC X.
   906         16  ELCRTO-GROUPING         PIC X(6).
   907         16  ELCRTO-STATE            PIC XX.
   908         16  ELCRTO-ACCOUNT          PIC X(10).
   909         16  ELCRTO-CERT-EFF-DT      PIC XX.
   910         16  ELCRTO-CERT-NO.
   911             20  ELCRTO-CERT-PRIME   PIC X(10).
   912             20  ELCRTO-CERT-SFX     PIC X.
   913         16  ELCRTO-RECORD-TYPE      PIC X.
   914         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   915
   916
   917     12  WS-ACCESS.
   918         16  FILLER               PIC XX    VALUE SPACES.
   919         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   920
   921     12  WS-CARR-ACCESS.
   922         16  FILLER               PIC X(3)  VALUE SPACES.
   923         16  WS-CARR              PIC X     VALUE SPACE.
   924*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   925*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   926     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   927         88  WS-DMD-LF-RATING   VALUE 'Y'.
   928         88  WS-DMD-AH-RATING   VALUE 'Y'.
   929         88  WS-DMD-NO-RATING   VALUE 'N'.
   930
   931     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   932         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   933                                         'NJ' 'NL'
   934                                         'PJ' 'PL'
   935                                         'SJ' 'SL'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  18
* EL050.cbl
   936     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   937         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   938                                         'NI' 'NJ' 'NL' 'NU'
   939                                         'PJ' 'PL' 'PI' 'PU'
   940                                         'SI' 'SJ' 'SL' 'SU'
   941                                         'MX' 'MY' 'MZ'.
   942 01  ERPDEF-KEY-SAVE             PIC X(18).
   943 01  ERPDEF-KEY.
   944     12  ERPDEF-COMPANY-CD       PIC X.
   945     12  ERPDEF-STATE            PIC XX.
   946     12  ERPDEF-PROD-CD          PIC XXX.
   947     12  F                       PIC X(7).
   948     12  ERPDEF-BEN-TYPE         PIC X.
   949     12  ERPDEF-BEN-CODE         PIC XX.
   950     12  ERPDEF-EXP-DT           PIC XX.
   951
   952 01  ELSTAT-KEY-SAVE             PIC X(20).
   953 01  ELSTAT-KEY.
   954     12  ELSTAT-COMPANY-ID       PIC XXX.
   955     12  ELSTAT-CARRIER          PIC X.
   956     12  ELSTAT-GROUP            PIC X(6).
   957     12  ELSTAT-STATE            PIC XX.
   958     12  ELSTAT-EXP-DT           PIC 9(8).
   959 01  WS-ERROR-VALUES.
   960     12  ER-1570                     PIC S9(4)   VALUE +1570.
   961     12  ER-1571                     PIC S9(4)   VALUE +1571.
   962     12  er-1572                     pic s9(4)   value +1572.
   963     12  er-1573                     pic s9(4)   value +1573.
   964     12  er-1574                     pic s9(4)   value +1574.
   965     12  ER-1575                     PIC S9(4)   VALUE +1575.
   966     12  er-1576                     pic s9(4)   value +1576.
   967     12  er-1577                     pic s9(4)   value +1577.
   968     12  er-1583                     pic s9(4)   value +1583.
   969     12  er-1584                     pic s9(4)   value +1584.
   970     12  er-1743                     pic s9(4)   value +1743.
   971     12  er-1744                     pic s9(4)   value +1744.
   972     12  er-1745                     pic s9(4)   value +1745.
   973     12  er-1746                     pic s9(4)   value +1746.
   974     12  er-1747                     pic s9(4)   value +1747.
   975     12  er-1748                     pic s9(4)   value +1748.
   976     12  er-1749                     pic s9(4)   value +1749.
   977     12  er-1750                     pic s9(4)   value +1750.
   978     12  er-1751                     pic s9(4)   value +1751.
   979     12  er-1752                     pic s9(4)   value +1752.
   980     12  er-1753                     pic s9(4)   value +1753.
   981     12  er-1754                     pic s9(4)   value +1754.
   982     12  er-1755                     pic s9(4)   value +1755.
   983     12  er-1756                     pic s9(4)   value +1756.
   984     12  er-1757                     pic s9(4)   value +1757.
   985     12  er-1758                     pic s9(4)   value +1758.
   986     12  er-1759                     pic s9(4)   value +1759.
   987     12  er-1760                     pic s9(4)   value +1760.
   988     12  er-1761                     pic s9(4)   value +1761.
   989     12  ER-1891                     PIC S9(4)   VALUE +1891.
   990     12  ER-1892                     PIC S9(4)   VALUE +1892.
   991     12  ER-1893                     PIC S9(4)   VALUE +1893.
   992     12  ER-1894                     PIC S9(4)   VALUE +1894.
   993     12  ER-1895                     PIC S9(4)   VALUE +1895.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  19
* EL050.cbl
   994     12  ER-1896                     PIC S9(4)   VALUE +1896.
   995     12  ER-1897                     PIC S9(4)   VALUE +1897.
   996     12  ER-1898                     PIC S9(4)   VALUE +1898.
   997     12  ER-1899                     PIC S9(4)   VALUE +1899.
   998     12  ER-1900                     PIC S9(4)   VALUE +1900.
   999     12  ER-1901                     PIC S9(4)   VALUE +1901.
  1000     12  ER-1902                     PIC S9(4)   VALUE +1902.
  1001     12  ER-1903                     PIC S9(4)   VALUE +1903.
  1002     12  ER-1904                     PIC S9(4)   VALUE +1904.
  1003     12  ER-1905                     PIC S9(4)   VALUE +1905.
  1004     12  ER-1906                     PIC S9(4)   VALUE +1906.
  1005     12  ER-1907                     PIC S9(4)   VALUE +1907.
  1006     12  ER-1909                     PIC S9(4)   VALUE +1909.
  1007     12  ER-1910                     PIC S9(4)   VALUE +1910.
  1008     12  ER-1911                     PIC S9(4)   VALUE +1911.
  1009     12  ER-1912                     PIC S9(4)   VALUE +1912.
  1010     12  ER-1913                     PIC S9(4)   VALUE +1913.
  1011     12  ER-1914                     PIC S9(4)   VALUE +1914.
  1012     12  ER-1915                     PIC S9(4)   VALUE +1915.
  1013     12  ER-1916                     PIC S9(4)   VALUE +1916.
  1014     12  ER-1917                     PIC S9(4)   VALUE +1917.
  1015     12  ER-1918                     PIC S9(4)   VALUE +1918.
  1016     12  ER-1919                     PIC S9(4)   VALUE +1919.
  1017     12  ER-1920                     PIC S9(4)   VALUE +1920.
  1018     12  ER-1921                     PIC S9(4)   VALUE +1921.
  1019     12  ER-1922                     PIC S9(4)   VALUE +1922.
  1020     12  ER-1923                     PIC S9(4)   VALUE +1923.
  1021     12  ER-1924                     PIC S9(4)   VALUE +1924.
  1022     12  ER-1925                     PIC S9(4)   VALUE +1925.
  1023     12  ER-1926                     PIC S9(4)   VALUE +1926.
  1024     12  ER-1927                     PIC S9(4)   VALUE +1927.
  1025     12  ER-1955                     PIC s9(4)   VALUE +1955.
  1026     12  ER-1956                     PIC s9(4)   VALUE +1956.
  1027     12  ER-1957                     PIC s9(4)   VALUE +1957.
  1028     12  ER-1958                     PIC s9(4)   VALUE +1958.
  1029     12  ER-1959                     PIC s9(4)   VALUE +1959.
  1030     12  ER-1960                     PIC s9(4)   VALUE +1960.
  1031     12  ER-1961                     PIC s9(4)   VALUE +1961.
  1032     12  ER-1962                     PIC s9(4)   VALUE +1962.
  1033     12  ER-1963                     PIC s9(4)   VALUE +1963.
  1034     12  ER-2393                     PIC S9(4)   VALUE +2393.
  1035     12  ER-2600                     PIC S9(4)   VALUE +2600.
  1036     12  ER-2601                     PIC S9(4)   VALUE +2601.
  1037     12  ER-2602                     PIC S9(4)   VALUE +2602.
  1038     12  ER-2603                     PIC S9(4)   VALUE +2603.
  1039     12  ER-2604                     PIC S9(4)   VALUE +2604.
  1040     12  ER-2605                     PIC S9(4)   VALUE +2605.
  1041     12  ER-2606                     PIC S9(4)   VALUE +2606.
  1042     12  ER-2607                     PIC S9(4)   VALUE +2607.
  1043     12  ER-2608                     PIC S9(4)   VALUE +2608.
  1044     12  ER-2609                     PIC S9(4)   VALUE +2609.
  1045     12  ER-2610                     PIC S9(4)   VALUE +2610.
  1046     12  ER-2611                     PIC S9(4)   VALUE +2611.
  1047     12  ER-2612                     PIC S9(4)   VALUE +2612.
  1048     12  ER-2613                     PIC S9(4)   VALUE +2613.
  1049     12  ER-2614                     PIC S9(4)   VALUE +2614.
  1050     12  ER-2615                     PIC S9(4)   VALUE +2615.
  1051     12  ER-2616                     PIC S9(4)   VALUE +2616.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  20
* EL050.cbl
  1052     12  ER-2617                     PIC S9(4)   VALUE +2617.
  1053     12  ER-2618                     PIC S9(4)   VALUE +2618.
  1054     12  ER-2619                     PIC S9(4)   VALUE +2619.
  1055     12  ER-2620                     PIC S9(4)   VALUE +2620.
  1056     12  ER-2621                     PIC S9(4)   VALUE +2621.
  1057     12  ER-2622                     PIC S9(4)   VALUE +2622.
  1058     12  ER-2623                     PIC S9(4)   VALUE +2623.
  1059     12  ER-2624                     PIC S9(4)   VALUE +2624.
  1060     12  ER-2625                     PIC S9(4)   VALUE +2625.
  1061     12  ER-2626                     PIC S9(4)   VALUE +2626.
  1062     12  ER-2627                     PIC S9(4)   VALUE +2627.
  1063     12  ER-2628                     PIC S9(4)   VALUE +2628.
  1064     12  ER-2629                     PIC S9(4)   VALUE +2629.
  1065     12  ER-2630                     PIC S9(4)   VALUE +2630.
  1066     12  ER-2631                     PIC S9(4)   VALUE +2631.
  1067     12  ER-2632                     PIC S9(4)   VALUE +2632.
  1068     12  ER-2633                     PIC S9(4)   VALUE +2633.
  1069     12  ER-2634                     PIC S9(4)   VALUE +2634.
  1070     12  ER-2635                     PIC S9(4)   VALUE +2635.
  1071     12  ER-2636                     PIC S9(4)   VALUE +2636.
  1072     12  ER-2637                     PIC S9(4)   VALUE +2637.
  1073     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1074     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1075     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1076     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1077     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1078     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1079     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1080     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1081     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1082     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1083     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1084     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1085     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1086     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1087     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1088     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1089     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1090     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1091     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1092     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1093     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1094     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1095     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1096     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1097     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1098     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1099     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1100     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1101     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1102     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1103     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1104     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1105     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1106     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1107     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1108     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1109     12  ER-2674                     PIC S9(4)   VALUE +2674.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  21
* EL050.cbl
  1110     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1111     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1112     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1113     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1114     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1115     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1116     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1117     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1118     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1119     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1120     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1121     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1122     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1123     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1124     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1125     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1126     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1127     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1128     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1129     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1130     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1131     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1132     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1133     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1134     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1135     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1136     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1137     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1138     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1139     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1140     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1141     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1142     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1143     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1144     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1145     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1146     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1147     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1148     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1149     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1150     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1151     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1152     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1153     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1154     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1155     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1156     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1157     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1158     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1159     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1160     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1161     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1162     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1163     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1164     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1165     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1166     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1167     12  ER-2742                     PIC S9(4)   VALUE +2742.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  22
* EL050.cbl
  1168     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1169     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1170     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1171     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1172     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1173     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1174     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1175     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1176     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1177     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1178     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1179     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1180     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1181     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1182     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1183     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1184     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1185     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1186     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1187     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1188     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1189     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1190     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1191     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1192     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1193     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1194     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1195     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1196     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1197     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1198     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1199     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1200     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1201     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1202     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1203     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1204     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1205     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1206     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1207     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1208     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1209     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1210     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1211     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1212     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1213     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1214     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1215     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1216     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1217     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1218     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1219     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1220     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1221     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1222     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1223     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1224     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1225     12  ER-2884                     PIC S9(4)   VALUE +2884.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  23
* EL050.cbl
  1226     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1227     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1228     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1229     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1230     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1231     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1232     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1233     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1234     12  ER-2894                     PIC S9(4)   VALUE +2894.
  1235     12  ER-2895                     PIC S9(4)   VALUE +2895.
  1236     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1237     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1238     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1239     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1240     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1241     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1242     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1243     12  ER-2998                     PIC S9(4)   VALUE +2998.
  1244     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1245     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1246     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1247     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1248     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1249     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1250     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1251     12  ER-3059                     PIC S9(4)   VALUE +3059.
  1252     12  ER-3060                     PIC S9(4)   VALUE +3060.
  1253     12  ER-3061                     PIC S9(4)   VALUE +3061.
  1254     12  ER-3062                     PIC S9(4)   VALUE +3062.
  1255     12  ER-3063                     PIC S9(4)   VALUE +3063.
  1256     12  ER-3068                     PIC S9(4)   VALUE +3068.
  1257     12  ER-3069                     PIC S9(4)   VALUE +3069.
  1258     12  er-3270                     pic s9(4)   value +3270.
  1259     12  er-3273                     pic s9(4)   value +3273.
  1260     12  er-3281                     pic s9(4)   value +3281.
  1261     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1262     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1263     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1264     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1265     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1266     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1267     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1268     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1269     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1270     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1271     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1272     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1273     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1274     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1275     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1276     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1277     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1278     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1279     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1280     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1281     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1282     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1283     12  ER-8036                     PIC S9(4)   VALUE +8036.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  24
* EL050.cbl
  1284     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1285     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1286     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1287     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1288     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1289     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1290     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1291     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1292     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1293     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1294     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1295     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1296     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1297     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1298     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1299     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1300     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1301     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1302     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1303     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1304     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1305     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1306     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1307     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1308     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1309     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1310     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1311     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1312     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1313     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1314     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1315     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1316     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1317     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1318     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1319     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1320     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1321     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1322     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1323     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1324     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1325     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1326     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1327     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1328     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1329     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1330     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1331     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1332     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1333     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1334     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1335     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1336     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1337     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1338     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1339     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1340     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1341     12  ER-8310                     PIC S9(4)   VALUE +8310.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  25
* EL050.cbl
  1342     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1343     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1344     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1345     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1346     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1347     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1348     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1349     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1350     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1351     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1352     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1353     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1354     12  er-9823                     pic s9(4)   value +9823.
  1355     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1356******************************************************************
  1357***************   END OF ELC50WS     ****************************
  1358******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  26
* EL050.cbl
  1361 01  WORKING-STORAGE-WORK-AREAS.
  1362     12  WS-RESPONSE             PIC S9(8)  COMP.
  1363         88  WS-RESP-NORMAL           VALUE +00.
  1364         88  WS-RESP-ERROR            VALUE +01.
  1365         88  WS-RESP-NOTFND           VALUE +13.
  1366         88  WS-RESP-DUPREC           VALUE +14.
  1367         88  WS-RESP-ENDFILE          VALUE +20.
  1368     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1369     12  WORK-AREAS.
  1370         16  WK-CONV-GREG.
  1371             24  WCG-CENT             PIC XX.
  1372             24  WCG-REST             PIC X(4).
  1373         16  WORK-GREGORIAN-DATE.
  1374             24  WK-GREG-CENT         PIC XX.
  1375             24  WK-GREG-DATE-YYMMDD.
  1376                 28  WK-GREG-YYMM     PIC X(4).
  1377                 28  WK-GREG-DD       PIC XX.
  1378
  1379         16  WORK-SELECT-DATE.
  1380             24  WK-SELECT-CENT            PIC XX.
  1381             24  WK-SELECT-DATE-YYMMDD.
  1382                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1383                 28  FILLER                PIC XX.
  1384
  1385         16  WK-FORM-NO.
  1386             24  WK-FORM-BANK-ID       PIC X(5).
  1387             24  WK-FORM-UNDRWRTR      PIC X(1).
  1388             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1389
  1390         16  WK-MEMBER-NO.
  1391             24  WK-MEMBER-1-6        PIC X(6).
  1392             24  WK-MEMBER-7-12       PIC X(6).
  1393
  1394         16  WK-FULL-CERT-NO.
  1395             24  WK-CERT-POS-1-2      PIC X(2).
  1396             24  WK-CERT-POS-3        PIC X(1).
  1397             24  WK-CERT-POS-4        PIC X(1).
  1398             24  WK-CERT-POS-5-6      PIC X(2).
  1399             24  WK-CERT-POS-7        PIC X(1).
  1400             24  WK-CERT-POS-8-11     PIC X(4).
  1401
  1402         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1403             88  VALID-RATE-CODE        VALUE 'Y'.
  1404             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1405
  1406         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1407         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1408         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1409         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1410         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1411         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1412         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1413         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1414         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1415         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1416
  1417* DLO001
  1418 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  27
* EL050.cbl
  1419     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1420     12  DMPF-RETURN-CODE          PIC XX.
  1421         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1422         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1423         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1424         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1425         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1426         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1427
  1428* DLO002
  1429 01  WS-DLO-INTERNAL-POLICY-FORM.
  1430     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1431     12  DIPF-RETURN-CODE          PIC XX.
  1432         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1433         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1434         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1435         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1436         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1437         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1438
  1439* DLO003
  1440 01  WS-DLO-VALID-BANK-ID.
  1441     12  DVBI-BANK-ID              PIC X(5).
  1442     12  DVBI-BANK-ID-TYPE         PIC X.
  1443         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1444         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1445         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1446         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1447         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1448     12  DVBI-RETURN-CODE          PIC XX.
  1449         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1450         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1451         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1452         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1453         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1454         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1455         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1456         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1457         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1458
  1459* DLO007
  1460 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1461     12  DCUA-RES-STATE            PIC XX.
  1462     12  DCUA-BEN-TYPE             PIC XX.
  1463     12  DCUA-SYS-IDENT            PIC X.
  1464         88  DCUA-CLAIM                        VALUE 'C'.
  1465         88  DCUA-PREMIUM                      VALUE 'P'.
  1466     12  DCUA-COVERAGE-RULE        PIC X.
  1467     12  DCUA-CLIENT-ID            PIC X(10).
  1468     12  DCUA-EFF-DATE             PIC X(8).
  1469     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1470     12  DCUA-RETURN-CODE          PIC XX.
  1471         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1472     12  DCUA-CERT-NUMBER          PIC X(11).
  1473     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1474     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1475
  1476* DLO011
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  28
* EL050.cbl
  1477 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1478     12  DPRB-RATE-CODE            PIC X(4).
  1479     12  DPRB-COVERAGE-CATEG       PIC X.
  1480     12  DPRB-RETURN-CODE          PIC XX.
  1481         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1482         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1483         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1484         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1485         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1486         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1487         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1488         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1489         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1490     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1491     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1492     12  DPRB-BEN-TYPE             PIC XX.
  1493
  1494* DLO017
  1495 01  WS-DLO-VALID-RATE-CODE.
  1496     12  DVRC-RATE-CODE            PIC X(4).
  1497     12  DVRC-RETURN-CODE          PIC XX.
  1498         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1499         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1500         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1501         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1502         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1503         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1504
  1505* DLO019
  1506 01  WS-DLO-ORIG-COV-CAT.
  1507     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1508     12  DOCC-RETURN-CODE          PIC XX.
  1509     12  DOCC-ORIG-COV-CAT         PIC X.
  1510     12  DOCC-UNDERWITER           PIC XX.
  1511     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1512     12  DOCC-FILLER               PIC X(6).
  1513
  1514* DLO021
  1515 01  WS-DLO-VALID-LOAN-OFFICER.
  1516     12  DVLO-LOAN-OFFICER.
  1517         16  DVLO-BILL-TYPE        PIC X.
  1518         16  DVLO-BILL-SOURCE      PIC X.
  1519         16  DVLO-BATCH-TYPE       PIC X.
  1520     12  DVLO-RETURN-CODE          PIC XX.
  1521         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1522         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1523         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1524         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1525         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1526         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1527
  1528* DLO022
  1529 01  WS-DLO-VALID-STATE-CODE.
  1530     12  DVSC-STATE-CODE           PIC XX.
  1531     12  DVSC-RETURN-CODE          PIC XX.
  1532         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1533
  1534* DLO023
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  29
* EL050.cbl
  1535 01  WS-DLO-VALID-CODE-VALUES.
  1536     12  DVCV-SYSTEM-ID            PIC XX.
  1537         88  DVCV-CLAIMS                       VALUE 'CL'.
  1538         88  DVCV-CREDIT                       VALUE 'CR'.
  1539     12  DVCV-RECORD-TYPE          PIC XX.
  1540         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1541         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1542         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1543         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1544         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1545         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1546         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1547         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1548     12  DVCV-RECORD-KEY           PIC X(6).
  1549     12  DVCV-RETURN-CODE          PIC XX.
  1550         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1551         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1552         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1553         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1554         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1555         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1556         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1557     12  DVCV-CODE-DESC            PIC X(60).
  1558     12  DVCV-GEN-DESC-1           PIC X(20).
  1559     12  DVCV-GEN-DESC-2           PIC X(20).
  1560     12  DVCV-GEN-DESC-3           PIC X(20).
  1561
  1562 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1563 01  hldi-pass-area.
  1564     03  PA-VIN                  PIC X(17).
  1565     03  PA-ErrorCode            PIC X(10).
  1566     03  PA-ErrorDesc            PIC X(30).
  1567     03  PA-ModelYear            PIC 9(7).
  1568     03  PA-MakeName             PIC X(50).
  1569     03  PA-ModelName            PIC X(50).
  1570     03  PA-SeriesName           PIC X(50).
  1571 01  zipcd-pass-area-len         pic s9(4) comp value +67.
  1572 01  zipcd-pass-area.
  1573     03  PA-zip                  PIC X(5).
  1574     03  PA-ErrorCode-zip        PIC X(10).
  1575     03  PA-city                 PIC x(50).
  1576     03  PA-state                PIC Xx.
  1577 01  clmhs-pass-area-len         pic s9(4) comp value +40.
  1578 01  clmhs-pass-area.
  1579     03  pa-clmhs-state          pic xx.
  1580     03  pa-account              pic x(10).
  1581     03  pa-eff-dt               pic x(10).
  1582     03  pa-cert-no              pic x(11).
  1583     03  pa-clm-count            pic 9(5).
  1584****  this is for aggregate report.
  1585****  Length is erpndb + 100 of passed-key-area
  1586 01  ws-passed-key-length        pic s9(4) comp value +587.
  1587 01  ws-pass-to-pemaggo.
  1588     05  ws-passed-erpndb        pic x(585).
  1589     05  ws-exceed-limit-yn      pic x.
  1590     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  30
* EL050.cbl
  1592*    COPY ERCBXRF.
  1593******************************************************************
  1594*                                                                *
  1595*                                                                *
  1596*                            ERCBXRF                             *
  1597*                                                                *
  1598*   ONLINE CREDIT SYSTEM                                         *
  1599*                                                                *
  1600*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1601*                                                                *
  1602*   FILE TYPE = VSAM,KSDS                                        *
  1603*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1604*                                                                *
  1605*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1606*       ALTERNATE PATH = NONE                                    *
  1607*                                                                *
  1608*   LOG = NO                                                     *
  1609*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1610*                                                                *
  1611******************************************************************
  1612
  1613 01  BANK-CROSS-REFERENCE.
  1614     12  BK-RECORD-ID                PIC XX.
  1615         88  VALID-BK-ID             VALUE 'BK'.
  1616
  1617     12  BK-CONTROL-PRIMARY.
  1618         16  BK-COMPANY-CD           PIC X.
  1619         16  BK-CARRIER              PIC X.
  1620         16  BK-GROUPING             PIC X(6).
  1621         16  BK-BANK-NO              PIC X(10).
  1622
  1623     12  BK-MAINT-INFORMATION.
  1624         16  BK-LAST-MAINT-DT        PIC XX.
  1625         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1626         16  BK-LAST-MAINT-USER      PIC X(4).
  1627         16  FILLER                  PIC X(9).
  1628
  1629     12  FILLER                      PIC X(37).
  1630
  1631     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1632
  1633     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1634                            DEPENDING ON BK-BANK-POINTER-CNT.
  1635         16  BK-AM-ACCOUNT           PIC X(10).
  1636         16  BK-AM-EXP-DT            PIC XX.
  1637         16  BK-AM-EFF-DT            PIC XX.
  1638         16  BK-AM-STATE             PIC XX.
  1639         16  FILLER                  PIC X(20).
  1640
  1641******************************************************************
  1642
  1643*    COPY ERCCOMP.
  1644******************************************************************
  1645*                                                                *
  1646*                                                                *
  1647*                            ERCCOMP                             *
  1648*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1649*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  31
* EL050.cbl
  1650*                                                                *
  1651*   ONLINE CREDIT SYSTEM                                         *
  1652*                                                                *
  1653*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1654*                                                                *
  1655*   FILE TYPE = VSAM,KSDS                                        *
  1656*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1657*                                                                *
  1658*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1659*       ALTERNATE PATH = NONE                                    *
  1660*                                                                *
  1661*   LOG = NO                                                     *
  1662*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1663*                                                                *
  1664******************************************************************
  1665*                   C H A N G E   L O G
  1666*
  1667* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1668*-----------------------------------------------------------------
  1669*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1670* EFFECTIVE    NUMBER
  1671*-----------------------------------------------------------------
  1672* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1673* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1674* 092205    2005050300006  PEMA  ADD LEASE FEE
  1675* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1676* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1677* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1678* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1679* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1680* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1681******************************************************************
  1682
  1683 01  COMPENSATION-MASTER.
  1684     12  CO-RECORD-ID                          PIC XX.
  1685         88  VALID-CO-ID                          VALUE 'CO'.
  1686
  1687     12  CO-CONTROL-PRIMARY.
  1688         16  CO-COMPANY-CD                     PIC X.
  1689         16  CO-CONTROL.
  1690             20  CO-CTL-1.
  1691                 24  CO-CARR-GROUP.
  1692                     28  CO-CARRIER            PIC X.
  1693                     28  CO-GROUPING.
  1694                         32  CO-GROUP-PREFIX   PIC XXX.
  1695                         32  CO-GROUP-PRIME    PIC XXX.
  1696                 24  CO-RESP-NO.
  1697                     28  CO-RESP-PREFIX        PIC X(4).
  1698                     28  CO-RESP-PRIME         PIC X(6).
  1699             20  CO-CTL-2.
  1700                 24  CO-ACCOUNT.
  1701                     28  CO-ACCT-PREFIX        PIC X(4).
  1702                     28  CO-ACCT-PRIME         PIC X(6).
  1703         16  CO-TYPE                           PIC X.
  1704             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1705             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1706             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1707
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  32
* EL050.cbl
  1708     12  CO-MAINT-INFORMATION.
  1709         16  CO-LAST-MAINT-DT                  PIC XX.
  1710         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1711         16  CO-LAST-MAINT-USER                PIC X(4).
  1712     12  FILLER                                PIC XX.
  1713     12  CO-STMT-TYPE                          PIC XXX.
  1714     12  CO-COMP-TYPE                          PIC X.
  1715         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1716     12  CO-STMT-OWNER                         PIC X(4).
  1717     12  CO-BALANCE-CONTROL                    PIC X.
  1718         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1719         88  CO-NO-BALANCE                        VALUE 'N'.
  1720
  1721     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1722         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1723         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1724         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1725
  1726     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1727         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1728         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1729
  1730     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1731     12  CO-GA-DIRECT-DEP                      PIC X.
  1732     12  CO-FUTURE-SPACE                       PIC X.
  1733         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1734
  1735     12  CO-ACCT-NAME                          PIC X(30).
  1736     12  CO-MAIL-NAME                          PIC X(30).
  1737     12  CO-ADDR-1                             PIC X(30).
  1738     12  CO-ADDR-2                             PIC X(30).
  1739     12  CO-ADDR-3.
  1740         16  CO-ADDR-CITY                      PIC X(27).
  1741         16  CO-ADDR-STATE                     PIC XX.
  1742     12  CO-CSO-1099                           PIC X.
  1743     12  CO-ZIP.
  1744         16  CO-ZIP-PRIME.
  1745             20  CO-ZIP-PRI-1ST                PIC X.
  1746                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1747             20  FILLER                        PIC X(4).
  1748         16  CO-ZIP-PLUS4                      PIC X(4).
  1749     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1750         16  CO-CAN-POSTAL-1                   PIC XXX.
  1751         16  CO-CAN-POSTAL-2                   PIC XXX.
  1752         16  FILLER                            PIC XXX.
  1753     12  CO-SOC-SEC                            PIC X(13).
  1754     12  CO-TELEPHONE.
  1755         16  CO-AREA-CODE                      PIC XXX.
  1756         16  CO-PREFIX                         PIC XXX.
  1757         16  CO-PHONE                          PIC X(4).
  1758
  1759     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1760
  1761     12  CO-AR-BAL-LEVEL                       PIC X.
  1762         88  CO-AR-REF-LVL                        VALUE '1'.
  1763         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1764         88  CO-AR-BILL-LVL                       VALUE '2'.
  1765         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  33
* EL050.cbl
  1766         88  CO-AR-FR-LVL                         VALUE '4'.
  1767
  1768     12  CO-AR-NORMAL-PRINT                    PIC X.
  1769         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1770         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1771
  1772     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1773
  1774     12  CO-AR-REPORTING                       PIC X.
  1775         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1776         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1777
  1778     12  CO-AR-PULL-CHECK                      PIC X.
  1779         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1780         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1781
  1782     12  CO-AR-BALANCE-PRINT                   PIC X.
  1783         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1784
  1785     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1786         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1787         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1788         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1789
  1790     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1791
  1792     12  CO-USER-CODE                          PIC X.
  1793     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1794
  1795******************************************************************
  1796*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1797*    THE LAST MONTH END RUN.
  1798******************************************************************
  1799
  1800     12  CO-LAST-ACTIVITY-DATE.
  1801         16  CO-ACT-YEAR                       PIC 99.
  1802         16  CO-ACT-MONTH                      PIC 99.
  1803         16  CO-ACT-DAY                        PIC 99.
  1804
  1805     12  CO-LAST-STMT-DT.
  1806         16  CO-LAST-STMT-YEAR                 PIC 99.
  1807         16  CO-LAST-STMT-MONTH                PIC 99.
  1808         16  CO-LAST-STMT-DAY                  PIC 99.
  1809
  1810     12  CO-MO-END-TOTALS.
  1811         16  CO-MONTHLY-TOTALS.
  1812             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1813             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1814             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1815             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1816             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1817
  1818         16  CO-AGING-TOTALS.
  1819             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1820             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1821             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1822             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1823
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  34
* EL050.cbl
  1824         16  CO-YTD-TOTALS.
  1825             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1826             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1827
  1828         16  CO-OVER-UNDER-TOTALS.
  1829             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1830             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1831
  1832     12  CO-MISCELLANEOUS-TOTALS.
  1833         16  CO-FICA-TOTALS.
  1834             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1835             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1836
  1837         16  CO-CLAIM-TOTALS.
  1838             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1839             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1840
  1841******************************************************************
  1842*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1843*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1844******************************************************************
  1845
  1846     12  CO-CURRENT-TOTALS.
  1847         16  CO-CURRENT-LAST-STMT-DT.
  1848             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1849             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1850             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1851
  1852         16  CO-CURRENT-MONTHLY-TOTALS.
  1853             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1854             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1855             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1856             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1857             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1858
  1859         16  CO-CURRENT-AGING-TOTALS.
  1860             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1861             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1862             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1863             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1864
  1865         16  CO-CURRENT-YTD-TOTALS.
  1866             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1867             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1868
  1869     12  CO-PAID-COMM-TOTALS.
  1870         16  CO-YTD-PAID-COMMS.
  1871             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1872             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1873
  1874     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1875         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1876         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1877
  1878     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1879         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1880         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1881         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  35
* EL050.cbl
  1882         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1883         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1884         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1885         88  CO-FINAL-LETTER                  VALUE 'F'.
  1886         88  CO-RECONCILING                   VALUE 'R'.
  1887         88  CO-PHONE-CALL                    VALUE 'P'.
  1888         88  CO-LEGAL                         VALUE 'L'.
  1889         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1890         88  CO-WRITE-OFF                     VALUE 'W'.
  1891         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1892
  1893     12  CO-CSR-CODE                       PIC X(4).
  1894
  1895     12  CO-GA-STATUS-INFO.
  1896         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1897         16  CO-GA-TERMINATION-DT          PIC XX.
  1898         16  CO-GA-STATUS-CODE             PIC X.
  1899             88  CO-GA-ACTIVE                 VALUE 'A'.
  1900             88  CO-GA-INACTIVE               VALUE 'I'.
  1901             88  CO-GA-PENDING                VALUE 'P'.
  1902         16  CO-GA-COMMENTS.
  1903             20  CO-GA-COMMENT-1           PIC X(40).
  1904             20  CO-GA-COMMENT-2           PIC X(40).
  1905             20  CO-GA-COMMENT-3           PIC X(40).
  1906             20  CO-GA-COMMENT-4           PIC X(40).
  1907
  1908     12  CO-RPTCD2                         PIC X(10).
  1909     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1910         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1911         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1912
  1913     12  CO-TYPE-AGENT                     PIC X(01).
  1914         88  CO-CORPORATION                   VALUE 'C'.
  1915         88  CO-PARTNERSHIP                   VALUE 'P'.
  1916         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1917         88  CO-TRUST                         VALUE 'T'.
  1918         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1919
  1920     12  CO-FAXNO.
  1921         16  CO-FAX-AREA-CODE                  PIC XXX.
  1922         16  CO-FAX-PREFIX                     PIC XXX.
  1923         16  CO-FAX-PHONE                      PIC X(4).
  1924
  1925     12  CO-BANK-INFORMATION.
  1926         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1927         16  CO-BANK-TRANSIT-NON REDEFINES
  1928             CO-BANK-TRANSIT-NO                PIC 9(8).
  1929
  1930         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1931     12  CO-MISC-DEDUCT-INFO REDEFINES
  1932                  CO-BANK-INFORMATION.
  1933         16  CO-MD-GL-ACCT                     PIC X(10).
  1934         16  CO-MD-DIV                         PIC XX.
  1935         16  CO-MD-CENTER                      PIC X(4).
  1936         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1937         16  CO-CREATE-AP-CHECK                PIC X.
  1938         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1939         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  36
* EL050.cbl
  1940     12  CO-ACH-STATUS                         PIC X.
  1941         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1942         88  CO-ACH-PENDING                        VALUE 'P'.
  1943
  1944     12  CO-BILL-SW                            PIC X.
  1945     12  CO-CONTROL-NAME                       PIC X(30).
  1946     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1947     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1948     12  CO-CLP-STATE                          PIC XX.
  1949     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1950     12  CO-SPP-REFUND-EDIT                    PIC X.
  1951
  1952******************************************************************
  1953
  1954*    COPY ERCAGTC.
  1955******************************************************************
  1956*                                                                *
  1957*                                                                *
  1958*                            ERCAGTC                             *
  1959*                            VMOD=2.001                          *
  1960*                                                                *
  1961*   ONLINE CREDIT SYSTEM                                         *
  1962*                                                                *
  1963*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1964*                                                                *
  1965*   FILE TYPE = VSAM,KSDS                                        *
  1966*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1967*                                                                *
  1968*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1969*       ALTERNATE PATH = NONE                                    *
  1970*                                                                *
  1971*   LOG = NO                                                     *
  1972*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1973*                                                                *
  1974******************************************************************
  1975*                   C H A N G E   L O G
  1976*
  1977* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1978*-----------------------------------------------------------------
  1979*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1980* EFFECTIVE    NUMBER
  1981*-----------------------------------------------------------------
  1982* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1983* 111004                         NEW FILE AND COPYBOOK
  1984* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1985******************************************************************
  1986 01  AGENT-COMMISSIONS.
  1987     12  AG-RECORD-ID                          PIC XX.
  1988         88  VALID-CO-ID                          VALUE 'AG'.
  1989     12  AG-CONTROL-PRIMARY.
  1990         16  AG-COMPANY-CD                     PIC X.
  1991         16  AG-CONTROL.
  1992             20  AG-CTL-1.
  1993                 24  AG-CARR-GROUP.
  1994                     28  AG-CARRIER            PIC X.
  1995                     28  AG-GROUPING           PIC X(6).
  1996                 24  AG-BANK                   PIC X(10).
  1997             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  37
* EL050.cbl
  1998                 24  AG-EXP-DT                 PIC XX.
  1999         16  AG-TYPE                           PIC X.
  2000             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2001             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2002     12  AG-MAINT-INFORMATION.
  2003         16  AG-LAST-MAINT-DT                  PIC XX.
  2004         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2005         16  AG-LAST-MAINT-USER                PIC X(4).
  2006         16  FILLER                            PIC X(10).
  2007     12  AG-EFF-DT                             PIC XX.
  2008     12  AG-COMM-STRUCTURE.
  2009         16  AG-AGT-COMMS OCCURS 10.
  2010             20  AG-AGT                PIC X(10).
  2011             20  AG-COM-TYP            PIC X.
  2012             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2013             20  AG-RECALC-LV-INDIC    PIC X.
  2014             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2015             20  AG-LRCALC-LV-INDIC    PIC X.
  2016             20  FILLER                PIC X(05).
  2017     12  FILLER                  PIC X(145).
  2018******************************************************************
  2019*    COPY ERCRESS.
  2020******************************************************************
  2021*                                                                *
  2022*                            ERCRESS                             *
  2023*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2024*                            VMOD=2.002                          *
  2025*                                                                *
  2026*   CREDIT RESIDENT STATE TAXES MASTER                          *
  2027*                                                                *
  2028*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  2029*   VSAM RESIDENT STATE TAX MASTER                              *
  2030*                                                                *
  2031*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  2032*                                                                *
  2033*   FILE TYPE = VSAM,KSDS                                        *
  2034*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  2035*                                                                *
  2036*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  2037*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  2038*                                                                *
  2039*   LOG = NO                                                     *
  2040*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2041*                                                                *
  2042*                                                                *
  2043******************************************************************
  2044
  2045 01  RESIDENT-STATE-TAX-MASTER.
  2046
  2047     10  ERRESS-PRIMARY-KEY.
  2048         15  RES-COMPANY-CD        PIC X.
  2049         15  RES-RESIDENT-STATE    PIC XX.
  2050         15  RES-COVERAGE-CATEGORY PIC X.
  2051         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  2052*                                      YYYYMMDD
  2053*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  2054
  2055     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  38
* EL050.cbl
  2056
  2057         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  2058         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2059         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  2060         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2061
  2062     10 RES-RECALC-SW              PIC   X.
  2063         88 RECALC                VALUE 'Y'.
  2064         88 NO-RECALC             VALUE 'N'.
  2065     10  RES-MAINT-BY              PIC X(4).
  2066     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  2067     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  2068*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  39
* EL050.cbl
  2070*    COPY ERCRESC.
  2071******************************************************************
  2072*                                                                *
  2073*                            ERCRESC                             *
  2074*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2075*                            VMOD=2.003                          *
  2076*                                                                *
  2077*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  2078*                                                                *
  2079*   FILE TYPE = VSAM,KSDS                                        *
  2080*   RECORD SIZE = 103 RECFORM = FIXED                            *
  2081*                                                                *
  2082*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  2083*       ALTERNATE PATH1 = NONE                                   *
  2084*                                                                *
  2085*   LOG = NO                                                     *
  2086*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2087*                                                                *
  2088******************************************************************
  2089
  2090 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  2091
  2092     10  ERRESC-RECORD-KEY.
  2093         15  RESC-COMPANY-CD           PIC   X.
  2094         15  RESC-CARRIER              PIC   X.
  2095         15  RESC-GROUP                PIC   X(6).
  2096         15  RESC-STATE                PIC   XX.
  2097         15  RESC-ACCOUNT              PIC   X(10).
  2098         15  RESC-AGENT                PIC   X(10).
  2099         15  RESC-RESIDENT-STATE       PIC   XX.
  2100         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2101*                                           YYYYMMDD
  2102     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2103
  2104     10  RESC-COMM-RECORD-DATA.
  2105         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2106             20 RESC-COVERAGE-CAT      PIC    X.
  2107             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2108             20 RESC-COMMISSION-TAB REDEFINES
  2109                RESC-COMMISSION-PER    PIC  XXX.
  2110
  2111     10  RESC-MAINT-BY                 PIC X(4).
  2112     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2113     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2114*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  40
* EL050.cbl
  2116*    COPY ERCPLAN.
  2117******************************************************************
  2118*                                                                *
  2119*                                                                *
  2120*                            ERCPLAN                             *
  2121*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2122*                            VMOD=2.003                          *
  2123*                                                                *
  2124*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2125*                                                                *
  2126*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2127*   PLAN MASTER                                                  *
  2128*                                                                *
  2129*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2130*                                                                *
  2131*   FILE TYPE = VSAM,KSDS                                        *
  2132*   RECORD SIZE = 420   RECFORM = FIX                            *
  2133*                                                                *
  2134*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2135*       ALTERNATE PATH1 = N/A                                    *
  2136*                                                                *
  2137*   LOG = NO                                                     *
  2138*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2139*                                                                *
  2140*                                                                *
  2141******************************************************************
  2142
  2143 01  PLAN-MASTER.
  2144     12  PL-RECORD-ID                      PIC XX.
  2145         88  VALID-PL-ID                      VALUE 'PL'.
  2146
  2147     12  PL-CONTROL-PRIMARY.
  2148         16  PL-COMPANY-CD                 PIC X.
  2149         16  PL-MSTR-CNTRL.
  2150             20  PL-CONTROL-A.
  2151                 24  PL-CARRIER            PIC X.
  2152                 24  PL-GROUPING           PIC X(6).
  2153                 24  PL-STATE              PIC XX.
  2154                 24  PL-ACCOUNT            PIC X(10).
  2155             20  PL-BENEFIT-TYPE           PIC X.
  2156             20  PL-BENEFIT-CODE           PIC XX.
  2157             20  PL-REVISION-NO            PIC X(3).
  2158
  2159     12  PL-CONTROL-BY-VAR-GRP.
  2160         16  PL-COMPANY-CD-A1              PIC X.
  2161         16  PL-VG-CARRIER                 PIC X.
  2162         16  PL-VG-GROUPING                PIC X(6).
  2163         16  PL-VG-STATE                   PIC XX.
  2164         16  PL-VG-ACCOUNT                 PIC X(10).
  2165         16  PL-BENEFIT-TYPE-A1            PIC X.
  2166         16  PL-BENEFIT-CODE-A1            PIC XX.
  2167         16  PL-REVISION-NO-A1             PIC 999.
  2168
  2169     12  PL-MAINT-INFORMATION.
  2170         16  PL-LAST-MAINT-DT              PIC XX.
  2171         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2172         16  PL-LAST-MAINT-USER            PIC X(4).
  2173         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  41
* EL050.cbl
  2174
  2175     12  PL-LIABILITY-LIMITS.
  2176         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2177         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2178             20  PL-LM-AGE                 PIC S99        COMP-3.
  2179             20  PL-LM-DUR                 PIC S999       COMP-3.
  2180             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2181             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2182
  2183     12  FILLER                            PIC X(30).
  2184
  2185     12  PL-GL-ACCOUNT-NOS.
  2186         16  PL-PREMIUM-GL                 PIC X(8).
  2187         16  PL-COMM-GL                    PIC X(8).
  2188         16  PL-CLAIM-GL                   PIC X(8).
  2189     12  FILLER                            PIC X(24).
  2190     12  PL-TOLERANCES.
  2191         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2192         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2193         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2194         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2195         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2196         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2197     12  PL-OVER-SHORT.
  2198         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2199         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2200     12  FILLER                            PIC X(24).
  2201     12  PLAN-MISC.
  2202         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2203         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2204         16  PL-IG                         PIC X.
  2205         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2206         16  PL-POLICY-FORM                PIC X(12).
  2207         16  PL-EDIT-FOR-FORM              PIC X(01).
  2208         16  PL-DEV-CODE                   PIC XXX.
  2209         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2210         16  PL-CALC-METHOD                PIC X.
  2211         16  PL-BENEFIT-GROUP              PIC X(05).
  2212         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2213
  2214         16  FILLER                        PIC X(99).
  2215******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  42
* EL050.cbl
  2217*    COPY ELCCERT.
  2218******************************************************************
  2219*                                                                *
  2220*                            ELCCERT.                            *
  2221*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2222*                            VMOD=2.013                          *
  2223*                                                                *
  2224*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2225*                                                                *
  2226*   FILE TYPE = VSAM,KSDS                                        *
  2227*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2228*                                                                *
  2229*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2230*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2231*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2232*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2233*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2234*                                                                *
  2235*   LOG = YES                                                    *
  2236*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2237******************************************************************
  2238*                   C H A N G E   L O G
  2239*
  2240* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2241*-----------------------------------------------------------------
  2242*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2243* EFFECTIVE    NUMBER
  2244*-----------------------------------------------------------------
  2245* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2246* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2247* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2248* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2249* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2250* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2251* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2252* 032612  CR2011110200001  PEMA  AHL CHANGES
  2253* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2254* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2255* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  2256******************************************************************
  2257
  2258 01  CERTIFICATE-MASTER.
  2259     12  CM-RECORD-ID                      PIC XX.
  2260         88  VALID-CM-ID                      VALUE 'CM'.
  2261
  2262     12  CM-CONTROL-PRIMARY.
  2263         16  CM-COMPANY-CD                 PIC X.
  2264         16  CM-CARRIER                    PIC X.
  2265         16  CM-GROUPING.
  2266             20  CM-GROUPING-PREFIX        PIC X(3).
  2267             20  CM-GROUPING-PRIME         PIC X(3).
  2268         16  CM-STATE                      PIC XX.
  2269         16  CM-ACCOUNT.
  2270             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2271             20  CM-ACCOUNT-PRIME          PIC X(6).
  2272         16  CM-CERT-EFF-DT                PIC XX.
  2273         16  CM-CERT-NO.
  2274             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  43
* EL050.cbl
  2275             20  CM-CERT-SFX               PIC X.
  2276
  2277     12  CM-CONTROL-BY-NAME.
  2278         16  CM-COMPANY-CD-A1              PIC X.
  2279         16  CM-INSURED-LAST-NAME          PIC X(15).
  2280         16  CM-INSURED-INITIALS.
  2281             20  CM-INSURED-INITIAL1       PIC X.
  2282             20  CM-INSURED-INITIAL2       PIC X.
  2283
  2284     12  CM-CONTROL-BY-SSN.
  2285         16  CM-COMPANY-CD-A2              PIC X.
  2286         16  CM-SOC-SEC-NO.
  2287             20  CM-SSN-STATE              PIC XX.
  2288             20  CM-SSN-ACCOUNT            PIC X(6).
  2289             20  CM-SSN-LN3.
  2290                 25  CM-INSURED-INITIALS-A2.
  2291                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2292                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2293                 25 CM-PART-LAST-NAME-A2         PIC X.
  2294
  2295     12  CM-CONTROL-BY-CERT-NO.
  2296         16  CM-COMPANY-CD-A4              PIC X.
  2297         16  CM-CERT-NO-A4                 PIC X(11).
  2298
  2299     12  CM-CONTROL-BY-MEMB.
  2300         16  CM-COMPANY-CD-A5              PIC X.
  2301         16  CM-MEMBER-NO.
  2302             20  CM-MEMB-STATE             PIC XX.
  2303             20  CM-MEMB-ACCOUNT           PIC X(6).
  2304             20  CM-MEMB-LN4.
  2305                 25  CM-INSURED-INITIALS-A5.
  2306                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2307                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2308                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2309
  2310     12  CM-INSURED-PROFILE-DATA.
  2311         16  CM-INSURED-FIRST-NAME.
  2312             20  CM-INSURED-1ST-INIT       PIC X.
  2313             20  FILLER                    PIC X(9).
  2314         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2315         16  CM-INSURED-SEX                PIC X.
  2316             88  CM-SEX-MALE                  VALUE 'M'.
  2317             88  CM-SEX-FEMAL                 VALUE 'F'.
  2318         16  CM-INSURED-JOINT-AGE          PIC 99.
  2319         16  CM-JOINT-INSURED-NAME.
  2320             20  CM-JT-LAST-NAME           PIC X(15).
  2321             20  CM-JT-FIRST-NAME.
  2322                 24  CM-JT-1ST-INIT        PIC X.
  2323                 24  FILLER                PIC X(9).
  2324             20  CM-JT-INITIAL             PIC X.
  2325
  2326     12  CM-LIFE-DATA.
  2327         16  CM-LF-BENEFIT-CD              PIC XX.
  2328         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2329         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2330         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2331         16  CM-LF-DEV-CODE                PIC XXX.
  2332         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  44
* EL050.cbl
  2333         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2334         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2335         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2336         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2337         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2338         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2339         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2340         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2341         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2342         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2343         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2344         16  cm-temp-epiq                  pic xx.
  2345             88  EPIQ-CLASS                  value 'EQ'.
  2346*        16  FILLER                        PIC XX.
  2347
  2348     12  CM-AH-DATA.
  2349         16  CM-AH-BENEFIT-CD              PIC XX.
  2350         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2351         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2352         16  CM-AH-DEV-CODE                PIC XXX.
  2353         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2354         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2355         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2356         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2357         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2358         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2359         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2360         16  CM-AH-PAID-THRU-DT            PIC XX.
  2361             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2362         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2363         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2364         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2365         16  FILLER                        PIC X.
  2366
  2367     12  CM-LOAN-INFORMATION.
  2368         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2369         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2370                                           PIC S9(5)V99  COMP-3.
  2371         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2372         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2373         16  CM-PAY-FREQUENCY              PIC S99.
  2374         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2375         16  CM-RATE-CLASS                 PIC XX.
  2376         16  CM-BENEFICIARY                PIC X(25).
  2377         16  CM-POLICY-FORM-NO             PIC X(12).
  2378         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2379         16  CM-LAST-ADD-ON-DT             PIC XX.
  2380         16  CM-DEDUCTIBLE-AMOUNTS.
  2381             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2382             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2383         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2384             20  CM-RESIDENT-STATE         PIC XX.
  2385             20  CM-RATE-CODE              PIC X(4).
  2386             20  FILLER                    PIC XX.
  2387         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2388             20  CM-LOAN-OFFICER           PIC X(5).
  2389             20  FILLER                    PIC XXX.
  2390         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  45
* EL050.cbl
  2391         16  CM-UNDERWRITING-CODE          PIC X.
  2392             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2393         16  CM-POST-CARD-IND              PIC X.
  2394         16  CM-REF-INTERFACE-SW           PIC X.
  2395         16  CM-PREMIUM-TYPE               PIC X.
  2396             88  CM-SING-PRM                  VALUE '1'.
  2397             88  CM-O-B-COVERAGE              VALUE '2'.
  2398             88  CM-OPEN-END                  VALUE '3'.
  2399         16  CM-IND-GRP-TYPE               PIC X.
  2400             88  CM-INDIVIDUAL                VALUE 'I'.
  2401             88  CM-GROUP                     VALUE 'G'.
  2402         16  CM-SKIP-CODE                  PIC X.
  2403             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2404             88  SKIP-JULY                    VALUE '1'.
  2405             88  SKIP-AUGUST                  VALUE '2'.
  2406             88  SKIP-SEPTEMBER               VALUE '3'.
  2407             88  SKIP-JULY-AUG                VALUE '4'.
  2408             88  SKIP-AUG-SEPT                VALUE '5'.
  2409             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2410             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2411             88  SKIP-JUNE                    VALUE '8'.
  2412             88  SKIP-JUNE-JULY               VALUE '9'.
  2413             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2414             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2415         16  CM-PAYMENT-MODE               PIC X.
  2416             88  PAY-MONTHLY                  VALUE SPACE.
  2417             88  PAY-WEEKLY                   VALUE '1'.
  2418             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2419             88  PAY-BI-WEEKLY                VALUE '3'.
  2420             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2421         16  CM-LOAN-NUMBER                PIC X(8).
  2422         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2423         16  CM-OLD-LOF                    PIC XXX.
  2424*        16  CM-LOAN-OFFICER               PIC XXX.
  2425         16  CM-REIN-TABLE                 PIC XXX.
  2426         16  CM-SPECIAL-REIN-CODE          PIC X.
  2427         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2428         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2429         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2430
  2431     12  CM-STATUS-DATA.
  2432         16  CM-ENTRY-STATUS               PIC X.
  2433         16  CM-ENTRY-DT                   PIC XX.
  2434
  2435         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2436         16  CM-LF-CANCEL-DT               PIC XX.
  2437         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2438
  2439         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2440         16  CM-LF-DEATH-DT                PIC XX.
  2441         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2442
  2443         16  CM-LF-CURRENT-STATUS          PIC X.
  2444             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2445                                                'M' '4' '5' '9'.
  2446             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2447             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2448             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  46
* EL050.cbl
  2449             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2450             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2451             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2452             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2453             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2454             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2455             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2456             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2457             88  CM-LF-DECLINED               VALUE 'D'.
  2458             88  CM-LF-VOIDED                 VALUE 'V'.
  2459
  2460         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2461         16  CM-AH-CANCEL-DT               PIC XX.
  2462         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2463
  2464         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2465         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2466         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2467
  2468         16  CM-AH-CURRENT-STATUS          PIC X.
  2469             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2470                                                'M' '4' '5' '9'.
  2471             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2472             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2473             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2474             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2475             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2476             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2477             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2478             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2479             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2480             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2481             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2482             88  CM-AH-DECLINED               VALUE 'D'.
  2483             88  CM-AH-VOIDED                 VALUE 'V'.
  2484
  2485         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2486             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2487             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2488             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2489         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2490
  2491         16  CM-ENTRY-BATCH                PIC X(6).
  2492         16  CM-LF-EXIT-BATCH              PIC X(6).
  2493         16  CM-AH-EXIT-BATCH              PIC X(6).
  2494         16  CM-LAST-MONTH-END             PIC XX.
  2495
  2496     12  CM-NOTE-SW                        PIC X.
  2497         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2498         88  CERT-NOTES-PRESENT               VALUE '1'.
  2499         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2500         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2501         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2502         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2503         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2504         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2505     12  CM-COMP-EXCP-SW                   PIC X.
  2506         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  47
* EL050.cbl
  2507         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2508     12  CM-INSURED-ADDRESS-SW             PIC X.
  2509         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2510         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2511
  2512*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2513     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2514     12  FILLER                            PIC X.
  2515
  2516*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2517     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2518     12  FILLER                            PIC X.
  2519*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2520     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  2521
  2522     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2523         88  CERT-ADDED-BATCH                 VALUE ' '.
  2524         88  CERT-ADDED-ONLINE                VALUE '1'.
  2525         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2526         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2527         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2528     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2529         88  CERT-AS-LOADED                   VALUE ' '.
  2530         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2531         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2532         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2533         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2534         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2535         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2536         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2537
  2538     12  CM-ACCOUNT-COMM-PCTS.
  2539         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2540         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2541
  2542     12  CM-USER-FIELD                     PIC X.
  2543     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2544     12  CM-CLP-STATE                      PIC XX.
  2545     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2546     12  CM-USER-RESERVED                  PIC XXX.
  2547     12  FILLER REDEFINES CM-USER-RESERVED.
  2548         16  CM-AH-CLASS-CD                PIC XX.
  2549         16  F                             PIC X.
  2550******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  48
* EL050.cbl
  2552*    COPY ERCMAIL.
  2553******************************************************************
  2554*                                                                *
  2555*                                                                *
  2556*                            ERCMAIL                             *
  2557*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2558*                            VMOD=2.003                          *
  2559*                                                                *
  2560*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2561*                                                                *
  2562*   FILE TYPE = VSAM,KSDS                                        *
  2563*   RECORD SIZE = 374   RECFORM = FIX                            *
  2564*                                                                *
  2565*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2566*   ALTERNATE PATH    = NOT USED                                 *
  2567*                                                                *
  2568*   LOG = YES                                                    *
  2569*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2570******************************************************************
  2571*                   C H A N G E   L O G
  2572*
  2573* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2574*-----------------------------------------------------------------
  2575*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2576* EFFECTIVE    NUMBER
  2577*-----------------------------------------------------------------
  2578* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2579* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2580* 111108                   PEMA  ADD CRED BENE ADDR2
  2581******************************************************************
  2582
  2583 01  MAILING-DATA.
  2584     12  MA-RECORD-ID                      PIC XX.
  2585         88  VALID-MA-ID                       VALUE 'MA'.
  2586
  2587     12  MA-CONTROL-PRIMARY.
  2588         16  MA-COMPANY-CD                 PIC X.
  2589         16  MA-CARRIER                    PIC X.
  2590         16  MA-GROUPING.
  2591             20  MA-GROUPING-PREFIX        PIC XXX.
  2592             20  MA-GROUPING-PRIME         PIC XXX.
  2593         16  MA-STATE                      PIC XX.
  2594         16  MA-ACCOUNT.
  2595             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2596             20  MA-ACCOUNT-PRIME          PIC X(6).
  2597         16  MA-CERT-EFF-DT                PIC XX.
  2598         16  MA-CERT-NO.
  2599             20  MA-CERT-PRIME             PIC X(10).
  2600             20  MA-CERT-SFX               PIC X.
  2601
  2602     12  FILLER                            PIC XX.
  2603
  2604     12  MA-ACCESS-CONTROL.
  2605         16  MA-SOURCE-SYSTEM              PIC XX.
  2606             88  MA-FROM-CREDIT                VALUE 'CR'.
  2607             88  MA-FROM-VSI                   VALUE 'VS'.
  2608             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2609             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  49
* EL050.cbl
  2610         16  MA-RECORD-ADD-DT              PIC XX.
  2611         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2612         16  MA-LAST-MAINT-DT              PIC XX.
  2613         16  MA-LAST-MAINT-BY              PIC XXXX.
  2614         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2615
  2616     12  MA-PROFILE-INFO.
  2617         16  MA-QUALIFY-CODE-1             PIC XX.
  2618         16  MA-QUALIFY-CODE-2             PIC XX.
  2619         16  MA-QUALIFY-CODE-3             PIC XX.
  2620         16  MA-QUALIFY-CODE-4             PIC XX.
  2621         16  MA-QUALIFY-CODE-5             PIC XX.
  2622
  2623         16  MA-INSURED-LAST-NAME          PIC X(15).
  2624         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2625         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2626         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2627         16  MA-INSURED-BIRTH-DT           PIC XX.
  2628         16  MA-INSURED-SEX                PIC X.
  2629             88  MA-SEX-MALE                   VALUE 'M'.
  2630             88  MA-SEX-FEMALE                 VALUE 'F'.
  2631         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2632
  2633         16  MA-ADDRESS-CORRECTED          PIC X.
  2634         16  MA-JOINT-BIRTH-DT             PIC XX.
  2635*        16  FILLER                        PIC X(12).
  2636
  2637         16  MA-ADDRESS-LINE-1             PIC X(30).
  2638         16  MA-ADDRESS-LINE-2             PIC X(30).
  2639         16  MA-CITY-STATE.
  2640             20  MA-CITY                   PIC X(28).
  2641             20  MA-ADDR-STATE             PIC XX.
  2642         16  MA-ZIP.
  2643             20  MA-ZIP-CODE.
  2644                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2645                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2646                 24  FILLER                PIC X(4).
  2647             20  MA-ZIP-PLUS4              PIC X(4).
  2648         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2649             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2650             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2651             20  FILLER                    PIC X(3).
  2652
  2653         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2654
  2655         16  FILLER                        PIC XXX.
  2656*        16  FILLER                        PIC X(10).
  2657
  2658     12  MA-CRED-BENE-INFO.
  2659         16  MA-CRED-BENE-NAME                 PIC X(25).
  2660         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2661         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2662         16  MA-CRED-BENE-CTYST.
  2663             20  MA-CRED-BENE-CITY             PIC X(28).
  2664             20  MA-CRED-BENE-STATE            PIC XX.
  2665         16  MA-CRED-BENE-ZIP.
  2666             20  MA-CB-ZIP-CODE.
  2667                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  50
* EL050.cbl
  2668                     88  MA-CB-CANADIAN-POST-CODE
  2669                                           VALUE 'A' THRU 'Z'.
  2670                 24  FILLER                    PIC X(4).
  2671             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2672         16  MA-CB-CANADIAN-POSTAL-CODE
  2673                            REDEFINES MA-CRED-BENE-ZIP.
  2674             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2675             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2676             20  FILLER                        PIC X(3).
  2677     12  MA-POST-CARD-MAIL-DATA.
  2678         16  MA-MAIL-DATA OCCURS 7.
  2679             20  MA-MAIL-TYPE              PIC X.
  2680                 88  MA-12MO-MAILING           VALUE '1'.
  2681                 88  MA-EXP-MAILING            VALUE '2'.
  2682             20  MA-MAIL-STATUS            PIC X.
  2683                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2684                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2685                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2686             20  MA-MAIL-DATE              PIC XX.
  2687     12  FILLER                            PIC XX.
  2688     12  FILLER                            PIC XX.
  2689*    12  FILLER                            PIC X(30).
  2690******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  51
* EL050.cbl
  2692*    COPY ERCPNDM.
  2693******************************************************************
  2694*                                                                *
  2695*                                                                *
  2696*                            ERCPNDM                             *
  2697*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2698*                            VMOD=2.003                          *
  2699*                                                                *
  2700*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2701*                                                                *
  2702*   FILE TYPE = VSAM,KSDS                                        *
  2703*   RECORD SIZE = 374   RECFORM = FIX                            *
  2704*                                                                *
  2705*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2706*   ALTERNATE PATH    = NOT USED                                 *
  2707*                                                                *
  2708*   LOG = YES                                                    *
  2709*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2710******************************************************************
  2711*                   C H A N G E   L O G
  2712*
  2713* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2714*-----------------------------------------------------------------
  2715*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2716* EFFECTIVE    NUMBER
  2717*-----------------------------------------------------------------
  2718* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2719* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2720* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2721* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  2722******************************************************************
  2723
  2724 01  PENDING-MAILING-DATA.
  2725     12  PM-RECORD-ID                      PIC XX.
  2726         88  VALID-MA-ID                       VALUE 'PM'.
  2727
  2728     12  PM-CONTROL-PRIMARY.
  2729         16  PM-COMPANY-CD                 PIC X.
  2730         16  PM-ENTRY-BATCH                PIC X(6).
  2731         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2732         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2733
  2734     12  FILLER                            PIC X(14).
  2735
  2736     12  PM-ACCESS-CONTROL.
  2737         16  PM-SOURCE-SYSTEM              PIC XX.
  2738             88  PM-FROM-CREDIT                VALUE 'CR'.
  2739             88  PM-FROM-VSI                   VALUE 'VS'.
  2740             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2741             88  PM-FROM-OTHER                 VALUE 'OT'.
  2742         16  PM-RECORD-ADD-DT              PIC XX.
  2743         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2744         16  PM-LAST-MAINT-DT              PIC XX.
  2745         16  PM-LAST-MAINT-BY              PIC XXXX.
  2746         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2747
  2748     12  PM-PROFILE-INFO.
  2749         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  52
* EL050.cbl
  2750         16  PM-QUALIFY-CODE-2             PIC XX.
  2751         16  PM-QUALIFY-CODE-3             PIC XX.
  2752         16  PM-QUALIFY-CODE-4             PIC XX.
  2753         16  PM-QUALIFY-CODE-5             PIC XX.
  2754
  2755         16  PM-INSURED-LAST-NAME          PIC X(15).
  2756         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2757         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2758         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2759         16  PM-INSURED-BIRTH-DT           PIC XX.
  2760         16  PM-INSURED-SEX                PIC X.
  2761             88  PM-SEX-MALE                   VALUE 'M'.
  2762             88  PM-SEX-FEMALE                 VALUE 'F'.
  2763         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2764
  2765         16  PM-ADDRESS-CORRECTED          PIC X.
  2766         16  PM-JOINT-BIRTH-DT             PIC XX.
  2767*        16  FILLER                        PIC X(12).
  2768
  2769         16  PM-ADDRESS-LINE-1             PIC X(30).
  2770         16  PM-ADDRESS-LINE-2             PIC X(30).
  2771         16  PM-CITY-STATE.
  2772             20  PM-CITY                   PIC X(28).
  2773             20  PM-STATE                  PIC XX.
  2774         16  PM-ZIP.
  2775             20  PM-ZIP-CODE.
  2776                 24  PM-ZIP-1              PIC X.
  2777                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2778                 24  FILLER                PIC X(4).
  2779             20  PM-ZIP-PLUS4              PIC X(4).
  2780         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2781             20  PM-CAN-POST1              PIC XXX.
  2782             20  PM-CAN-POST2              PIC XXX.
  2783             20  FILLER                    PIC XXX.
  2784
  2785         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2786         16  pm-city-st-zip-verified       pic x.
  2787         16  FILLER                        PIC XX.
  2788
  2789     12  PM-CRED-BENE-INFO.
  2790         16  PM-CRED-BENE-NAME             PIC X(25).
  2791         16  PM-CRED-BENE-ADDR             PIC X(30).
  2792         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2793         16  PM-CRED-BENE-CTYST.
  2794             20  PM-CRED-BENE-CITY         PIC X(28).
  2795             20  PM-CRED-BENE-STATE        PIC XX.
  2796         16  PM-CRED-BENE-ZIP.
  2797             20  PM-CB-ZIP-CODE.
  2798                 24  PM-CB-ZIP-1           PIC X.
  2799                     88  PM-CB-CANADIAN-POST-CODE
  2800                                  VALUE 'A' THRU 'Z'.
  2801                 24  FILLER                PIC X(4).
  2802             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2803         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2804             20  PM-CB-CAN-POST1           PIC XXX.
  2805             20  PM-CB-CAN-POST2           PIC XXX.
  2806             20  FILLER                    PIC XXX.
  2807     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  53
* EL050.cbl
  2808         16  PM-MAIL-DATA OCCURS 7.
  2809             20  PM-MAIL-TYPE              PIC X.
  2810                 88  PM-12MO-MAILING           VALUE '1'.
  2811                 88  PM-EXP-MAILING            VALUE '2'.
  2812             20  PM-MAIL-STATUS            PIC X.
  2813                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2814                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2815                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2816             20  PM-MAIL-DATE              PIC XX.
  2817     12  FILLER                            PIC XX.
  2818     12  FILLER                            PIC X(12).
  2819*    12  FILLER                            PIC X(30).
  2820
  2821******************************************************************
  2822*                                COPY ERCLOFC.
  2823******************************************************************
  2824*                                                                *
  2825*                                                                *
  2826*                            ERCLOFC                             *
  2827*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2828*                            VMOD=2.003                          *
  2829*                                                                *
  2830*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2831*                                                                *
  2832*   FILE TYPE = VSAM,KSDS                                        *
  2833*   RECORD SIZE = 670   RECFORM = FIX                            *
  2834*                                                                *
  2835*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2836*                                                                *
  2837*   LOG = YES                                                    *
  2838*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2839*                                                                *
  2840******************************************************************
  2841
  2842 01  LOAN-OFFICER-MASTER.
  2843     12  LO-RECORD-ID                PIC XX.
  2844         88  VALID-LO-ID                VALUE 'LO'.
  2845
  2846     12  LO-CONTROL-PRIMARY.
  2847         16  LO-COMPANY-CD           PIC X.
  2848         16  LO-CARRIER              PIC X.
  2849         16  LO-GROUPING.
  2850             20  LO-GROUPING-PREFIX  PIC XXX.
  2851             20  LO-GROUPING-PRIME   PIC XXX.
  2852         16  LO-STATE                PIC XX.
  2853         16  LO-ACCOUNT.
  2854             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2855             20  LO-ACCOUNT-PRIME    PIC X(6).
  2856         16  LO-OFFICER-CODE         PIC X(5).
  2857
  2858     12  LO-OFFICER-NAME             PIC X(30).
  2859
  2860     12  LO-LAST-MAINT-DT            PIC XX.
  2861     12  LO-LAST-USER                PIC X(4).
  2862     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2863
  2864     12  LO-COMP-CONTROL             PIC X.
  2865             88  LO-SHOW-COMP           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  54
* EL050.cbl
  2866             88  LO-SUPPRESS-COMP       VALUE 'N'.
  2867     12  LO-DETAIL-CONTROL           PIC X.
  2868             88  LO-PRINT-DETAIL        VALUE 'D'.
  2869             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2870
  2871     12  LO-SV-CARRIER               PIC X.
  2872     12  LO-SV-GROUPING              PIC X(6).
  2873     12  LO-SV-STATE                 PIC XX.
  2874
  2875     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2876     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2877
  2878     12  LO-OFFICER-INFO.
  2879         16  FILLER OCCURS 12 TIMES.
  2880             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2881             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2882             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2883             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2884             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2885             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2886             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2887             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2888     12  FILLER                      PIC X(198).
  2889******************************************************************
  2890*                                COPY ERCPDEF.
  2891******************************************************************
  2892*                                                                *
  2893*                                                                *
  2894*                            ERCPDEF.                            *
  2895*                                                                *
  2896*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2897*                                                                *
  2898*    FILE TYPE = VSAM,KSDS                                       *
  2899*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2900*                                                                *
  2901*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2902*                                                                *
  2903*    LOG = YES                                                   *
  2904*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2905******************************************************************
  2906*                   C H A N G E   L O G
  2907*
  2908* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2909*-----------------------------------------------------------------
  2910*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2911* EFFECTIVE    NUMBER
  2912*-----------------------------------------------------------------
  2913* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2914* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2915* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2916* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  2917******************************************************************
  2918 01  PRODUCT-MASTER.
  2919    12  PD-RECORD-ID                 PIC X(02).
  2920        88  VALID-PD-ID                  VALUE 'PD'.
  2921    12  PD-CONTROL-PRIMARY.
  2922        16  PD-COMPANY-CD            PIC X.
  2923        16  PD-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  55
* EL050.cbl
  2924        16  PD-PRODUCT-CD            PIC XXX.
  2925        16  PD-FILLER                PIC X(7).
  2926        16  PD-BEN-TYPE              PIC X.
  2927        16  PD-BEN-CODE              PIC XX.
  2928        16  PD-PROD-EXP-DT           PIC XX.
  2929    12  FILLER                       PIC X(50).
  2930    12  PD-PRODUCT-DATA OCCURS 8.
  2931        16  PD-PROD-CODE             PIC X.
  2932            88  PD-PROD-LIFE           VALUE 'L'.
  2933            88  PD-PROD-PROP           VALUE 'P'.
  2934            88  PD-PROD-AH             VALUE 'A'.
  2935            88  PD-PROD-IU             VALUE 'I'.
  2936            88  PD-PROD-GAP            VALUE 'G'.
  2937            88  PD-PROD-FAML           VALUE 'F'.
  2938            88  PD-PROD-OTH            VALUE 'O'.
  2939        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2940        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2941        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2942        16  PD-MAX-TERM              PIC S999        COMP-3.
  2943        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2944        16  FILLER                   PIC X.
  2945        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2946        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2947        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2948        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2949        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2950        16  PD-REC-CRIT-PERIOD       PIC 99.
  2951        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2952            20  PD-RECURRING-YN      PIC X.
  2953            20  FILLER               PIC X.
  2954        16  PD-RTW-MOS               PIC 99.
  2955        16  PD-MAX-EXTENSION         PIC 99.
  2956        16  pd-ben-pct               pic sv999 comp-3.
  2957*       16  FILLER                   PIC XX.
  2958    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2959    12  PD-TERM-LIMITS OCCURS 15.
  2960        16  PD-LOW-TERM              PIC S999        COMP-3.
  2961        16  PD-HI-TERM               PIC S999        COMP-3.
  2962*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2963    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2964        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2965        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2966    12  PD-EARN-FACTORS.
  2967        16  FILLER OCCURS 15.
  2968            20  FILLER OCCURS 15.
  2969                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2970    12  PD-PRODUCT-DESC              PIC X(80).
  2971    12  PD-TRUNCATED                 PIC X.
  2972    12  FILLER                       PIC X(59).
  2973    12  PD-MAINT-INFORMATION.
  2974        16  PD-LAST-MAINT-DT         PIC X(02).
  2975        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2976        16  PD-LAST-MAINT-BY         PIC X(04).
  2977*                                COPY ELCSTATE.
  2978******************************************************************
  2979*                                                                *
  2980*                                                                *
  2981*                            ELCSTATE.                           *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  56
* EL050.cbl
  2982*                                                                *
  2983*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2984*                                                                *
  2985*   FILE TYPE = VSAM,KSDS                                        *
  2986*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2987*                                                                *
  2988*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2989*       ALTERNATE INDEX = NONE                                   *
  2990*                                                                *
  2991*   LOG = YES                                                    *
  2992*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2993******************************************************************
  2994*                   C H A N G E   L O G
  2995*
  2996* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2997*-----------------------------------------------------------------
  2998*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2999* EFFECTIVE    NUMBER
  3000*-----------------------------------------------------------------
  3001* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  3002******************************************************************
  3003*
  3004 01  STATE-FILE.
  3005     12  SF-RECORD-ID                       PIC XX.
  3006         88  VALID-CF-ID                        VALUE 'SF'.
  3007     12  SF-CONTROL-PRIMARY.
  3008         16  SF-COMPANY-ID                  PIC XXX.
  3009         16  SF-CARRIER-CODE                PIC X.
  3010         16  SF-GROUPING                    PIC X(6).
  3011         16  SF-STATE-CODE                  PIC XX.
  3012         16  SF-EXPIRE-DATE                 PIC 9(8).
  3013****************************************************************
  3014*             STATE CONTROLS
  3015****************************************************************
  3016     12  SF-LAST-MAINT-DT                   PIC XX.
  3017     12  SF-LAST-MAINT-BY                   PIC X(4).
  3018     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3019     12  SF-STATE-RT-CONTROLS.
  3020         16  SF-ST-RT-CALC                  PIC X.
  3021     12  SF-ST-TAX-CONTROLS.
  3022         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3023         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3024         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3025     12  SF-ST-REFUND-OPTIONS.
  3026         16  SF-ST-RF-LR-CALC               PIC X.
  3027         16  SF-ST-RF-LL-CALC               PIC X.
  3028         16  SF-ST-RF-LN-CALC               PIC X.
  3029         16  SF-ST-RF-AH-CALC               PIC X.
  3030         16  SF-ST-RF-CP-CALC               PIC X.
  3031     12  SF-ST-UNEARN-PREM-OPTIONS.
  3032         16  SF-ST-LUEP-R78                 PIC X.
  3033         16  SF-ST-LUEP-PRO                 PIC X.
  3034         16  SF-ST-LUEP-ST                  PIC X.
  3035         16  SF-ST-LUEP-DOM                 PIC X.
  3036         16  SF-ST-AUEP-R78                 PIC X.
  3037         16  SF-ST-AUEP-PRO                 PIC X.
  3038         16  SF-ST-AUEP-ST                  PIC X.
  3039         16  SF-ST-AUEP-DOM                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  57
* EL050.cbl
  3040         16  SF-ST-CUEP-R78                 PIC X.
  3041         16  SF-ST-CUEP-PRO                 PIC X.
  3042         16  SF-ST-CUEP-ST                  PIC X.
  3043         16  SF-ST-CUEP-DOM                 PIC X.
  3044     12  SF-ST-EARN-PREM-OPTIONS.
  3045         16  SF-ST-LEP-R78                  PIC X.
  3046         16  SF-ST-LEP-PRO                  PIC X.
  3047         16  SF-ST-LEP-ST                   PIC X.
  3048         16  SF-ST-LEP-DOM                  PIC X.
  3049         16  SF-ST-AEP-R78                  PIC X.
  3050         16  SF-ST-AEP-PRO                  PIC X.
  3051         16  SF-ST-AEP-ST                   PIC X.
  3052         16  SF-ST-AEP-DOM                  PIC X.
  3053         16  SF-ST-CEP-R78                  PIC X.
  3054         16  SF-ST-CEP-PRO                  PIC X.
  3055         16  SF-ST-CEP-ST                   PIC X.
  3056         16  SF-ST-CEP-DOM                  PIC X.
  3057     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  58
* EL050.cbl
  3059*    COPY ELCCRTT.
  3060******************************************************************
  3061*                                                                *
  3062*                            ELCCRTT.                            *
  3063*                                                                *
  3064*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3065*                                                                *
  3066*   FILE TYPE = VSAM,KSDS                                        *
  3067*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3068*                                                                *
  3069*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3070*                                                                *
  3071*   LOG = YES                                                    *
  3072*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3073******************************************************************
  3074*                   C H A N G E   L O G
  3075*
  3076* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3077*-----------------------------------------------------------------
  3078*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3079* EFFECTIVE    NUMBER
  3080*-----------------------------------------------------------------
  3081* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3082* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3083* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3084* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3085* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3086* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3087* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3088* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3089* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3090* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3091* 091318  CR2018073000001  PEMA  ADD Refund methods
  3092* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3093******************************************************************
  3094
  3095 01  CERTIFICATE-TRAILERS.
  3096     12  CS-RECORD-ID                      PIC XX.
  3097         88  VALID-CS-ID                      VALUE 'CS'.
  3098
  3099     12  CS-CONTROL-PRIMARY.
  3100         16  CS-COMPANY-CD                 PIC X.
  3101         16  CS-CARRIER                    PIC X.
  3102         16  CS-GROUPING                   PIC X(6).
  3103         16  CS-STATE                      PIC XX.
  3104         16  CS-ACCOUNT                    PIC X(10).
  3105         16  CS-CERT-EFF-DT                PIC XX.
  3106         16  CS-CERT-NO.
  3107             20  CS-CERT-PRIME             PIC X(10).
  3108             20  CS-CERT-SFX               PIC X.
  3109         16  CS-TRAILER-TYPE               PIC X.
  3110             88  COMM-TRLR           VALUE 'A'.
  3111             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3112             88  CERT-DATA-TRLR      VALUE 'C'.
  3113
  3114     12  CS-DATA-AREA                      PIC X(516).
  3115
  3116     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  59
* EL050.cbl
  3117         16  CS-BANK-COMMISSION-AREA.
  3118             20  CS-BANK-COMMS       OCCURS 10.
  3119                 24  CS-AGT                PIC X(10).
  3120                 24  CS-COM-TYP            PIC X.
  3121                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3122                 24  CS-RECALC-LV-INDIC    PIC X.
  3123                 24  FILLER                PIC X(10).
  3124         16  FILLER                        PIC X(256).
  3125
  3126     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3127****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3128         16  CS-MB-CLAIM-DATA OCCURS 24.
  3129             20  CS-CLAIM-NO               PIC X(7).
  3130             20  CS-CLAIM-TYPE             PIC X.
  3131                 88  CS-AH-CLM               VALUE 'A'.
  3132                 88  CS-IU-CLM               VALUE 'I'.
  3133                 88  CS-GP-CLM               VALUE 'G'.
  3134                 88  CS-LF-CLM               VALUE 'L'.
  3135                 88  CS-PR-CLM               VALUE 'P'.
  3136                 88  CS-FL-CLM               VALUE 'F'.
  3137                 88  CS-OT-CLM               VALUE 'O'.
  3138             20  CS-INSURED-TYPE           PIC X.
  3139                 88  CS-PRIM-INSURED          VALUE 'P'.
  3140                 88  CS-CO-BORROWER           VALUE 'C'.
  3141             20  CS-BENEFIT-PERIOD         PIC 99.
  3142             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3143             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3144             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3145         16  FILLER                        PIC X(12).
  3146     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3147         16  CS-VIN-NUMBER                 PIC X(17).
  3148         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3149         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3150         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3151         16  cs-agent-name.
  3152             20  cs-agent-fname            pic x(20).
  3153             20  cs-agent-mi               pic x.
  3154             20  cs-agent-lname            pic x(25).
  3155         16  cs-license-no                 pic x(15).
  3156         16  cs-npn-number                 pic x(10).
  3157         16  cs-agent-edit-status          pic x.
  3158             88  cs-ae-refer-to-manager      value 'M'.
  3159             88  cs-ae-cover-sheet           value 'C'.
  3160             88  cs-ae-sig-form              value 'S'.
  3161             88  cs-ae-verified              value 'V'.
  3162             88  cs-unidentified-signature   value 'U'.
  3163             88  cs-cert-returned            value 'R'.
  3164             88  cs-accept-no-commission     value 'N'.
  3165         16  cs-year                       pic 9999.
  3166         16  cs-make                       pic x(20).
  3167         16  cs-model                      pic x(20).
  3168         16  cs-future                     pic x(20).
  3169         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3170         16  cs-claim-verification-status  pic x.
  3171             88  cs-clm-ver-eligible         value 'A'.
  3172             88  cs-clm-ver-partial-elig     value 'B'.
  3173             88  cs-clm-ver-not-eligible     value 'C'.
  3174             88  cs-clm-ver-not-elig-opn-clm value 'D'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  60
* EL050.cbl
  3175             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3176             88  cs-clm-ver-ND-CERT          value 'F'.
  3177             88  cs-clm-ver-spec-other       value 'G'.
  3178             88  cs-clam-ver-pratial-corrected
  3179                                             value 'H'.
  3180             88  cs-clm-ver-no-matches       value 'I'.
  3181             88  cs-clm-ver-not-elig-corrected
  3182                                             value 'J'.
  3183             88  cs-clm-ver-needs-review     value 'R'.
  3184             88  cs-clm-ver-sent-to-claims   value 'W'.
  3185         16  CS-LF-REFUND-METHOD           PIC X.
  3186         16  CS-AH-REFUND-METHOD           PIC X.
  3187         16  FILLER                        PIC X(353). *> was 420
  3188*        16  FILLER                        PIC X(496).
  3189*    COPY ELCCRTO.
  3190******************************************************************
  3191*                                                                *
  3192*                            ELCCRTO.                            *
  3193*                                                                *
  3194*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3195*                                                                *
  3196*   FILE TYPE = VSAM,KSDS                                        *
  3197*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3198*                                                                *
  3199*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3200*                                                                *
  3201*   LOG = YES                                                    *
  3202*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3203******************************************************************
  3204*                   C H A N G E   L O G
  3205*
  3206* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3207*-----------------------------------------------------------------
  3208*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3209* EFFECTIVE    NUMBER
  3210*-----------------------------------------------------------------
  3211* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3212* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3213* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3214* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3215* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3216******************************************************************
  3217 01  ORIGINAL-CERTIFICATE.
  3218     12  OC-RECORD-ID                      PIC XX.
  3219         88  VALID-OC-ID                      VALUE 'OC'.
  3220     12  OC-CONTROL-PRIMARY.
  3221         16  OC-COMPANY-CD                 PIC X.
  3222         16  OC-CARRIER                    PIC X.
  3223         16  OC-GROUPING                   PIC X(6).
  3224         16  OC-STATE                      PIC XX.
  3225         16  OC-ACCOUNT                    PIC X(10).
  3226         16  OC-CERT-EFF-DT                PIC XX.
  3227         16  OC-CERT-NO.
  3228             20  OC-CERT-PRIME             PIC X(10).
  3229             20  OC-CERT-SFX               PIC X.
  3230         16  OC-RECORD-TYPE                PIC X.
  3231         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3232     12  OC-LAST-MAINT-DT                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  61
* EL050.cbl
  3233     12  OC-LAST-MAINT-BY                  PIC X(4).
  3234     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3235     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3236     12  FILLER                            PIC X(49).
  3237     12  OC-ORIG-REC.
  3238         16  OC-INS-LAST-NAME              PIC X(15).
  3239         16  OC-INS-FIRST-NAME             PIC X(10).
  3240         16  OC-INS-MIDDLE-INIT            PIC X.
  3241         16  OC-INS-AGE                    PIC S999     COMP-3.
  3242         16  OC-JNT-LAST-NAME              PIC X(15).
  3243         16  OC-JNT-FIRST-NAME             PIC X(10).
  3244         16  OC-JNT-MIDDLE-INIT            PIC X.
  3245         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3246         16  OC-LF-BENCD                   PIC XX.
  3247         16  OC-LF-TERM                    PIC S999      COMP-3.
  3248         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3249         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3250         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3251         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3252         16  OC-LF-EXP-DT                  PIC XX.
  3253         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3254         16  OC-LF-CANCEL-DT               PIC XX.
  3255         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3256         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3257         16  OC-AH-BENCD                   PIC XX.
  3258         16  OC-AH-TERM                    PIC S999      COMP-3.
  3259         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3260         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3261         16  OC-AH-EXP-DT                  PIC XX.
  3262         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3263         16  OC-AH-CP                      PIC 99.
  3264         16  OC-AH-CANCEL-DT               PIC XX.
  3265         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3266         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3267         16  OC-CRED-BENE-NAME             PIC X(25).
  3268         16  OC-1ST-PMT-DT                 PIC XX.
  3269         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3270         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3271         16  OC-ISSUE-TRAN-IND             PIC X.
  3272         16  OC-CANCEL-TRAN-IND            PIC X.
  3273         16  FILLER                        PIC X(211).
  3274
  3275     12  FILLER                            PIC X(50).
  3276******************************************************************
  3277
  3278*    COPY ELCDATE.
  3279******************************************************************
  3280*                                                                *
  3281*                                                                *
  3282*                            ELCDATE.                            *
  3283*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3284*                            VMOD=2.003
  3285*                                                                *
  3286*                                                                *
  3287*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3288*                 LENGTH = 200                                   *
  3289******************************************************************
  3290
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  62
* EL050.cbl
  3291 01  DATE-CONVERSION-DATA.
  3292     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3293     12  DC-OPTION-CODE                PIC X.
  3294         88  BIN-TO-GREG                VALUE ' '.
  3295         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3296         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3297         88  YMD-GREG-TO-BIN            VALUE '3'.
  3298         88  MDY-GREG-TO-BIN            VALUE '4'.
  3299         88  JULIAN-TO-BIN              VALUE '5'.
  3300         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3301         88  FIND-CENTURY               VALUE '7'.
  3302         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3303         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3304         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3305         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3306         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3307         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3308         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3309         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3310         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3311         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3312         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3313         88  BIN-3-TO-GREG              VALUE 'I'.
  3314         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3315         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3316         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3317         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3318         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3319         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3320         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3321         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3322         88  THREE-CHARACTER-BIN
  3323                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3324         88  GREGORIAN-TO-BIN
  3325                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3326         88  BIN-TO-GREGORIAN
  3327                  VALUES ' ' '1' 'I' '8' 'G'.
  3328         88  JULIAN-TO-BINARY
  3329                  VALUES '5' 'C' 'E' 'F'.
  3330     12  DC-ERROR-CODE                 PIC X.
  3331         88  NO-CONVERSION-ERROR        VALUE ' '.
  3332         88  DATE-CONVERSION-ERROR
  3333                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3334         88  DATE-IS-ZERO               VALUE '1'.
  3335         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3336         88  DATE-IS-INVALID            VALUE '3'.
  3337         88  DATE1-GREATER-DATE2        VALUE '4'.
  3338         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3339         88  DATE-INVALID-OPTION        VALUE '9'.
  3340         88  INVALID-CENTURY            VALUE 'A'.
  3341         88  ONLY-CENTURY               VALUE 'B'.
  3342         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3343         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3344     12  DC-END-OF-MONTH               PIC X.
  3345         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3346     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3347         88  USE-NORMAL-PROCESS         VALUE ' '.
  3348         88  ADJUST-DOWN-100-YRS        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  63
* EL050.cbl
  3349         88  ADJUST-UP-100-YRS          VALUE '2'.
  3350     12  FILLER                        PIC X.
  3351     12  DC-CONVERSION-DATES.
  3352         16  DC-BIN-DATE-1             PIC XX.
  3353         16  DC-BIN-DATE-2             PIC XX.
  3354         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3355         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3356                       DC-GREG-DATE-1-EDIT.
  3357             20  DC-EDIT1-MONTH        PIC 99.
  3358             20  SLASH1-1              PIC X.
  3359             20  DC-EDIT1-DAY          PIC 99.
  3360             20  SLASH1-2              PIC X.
  3361             20  DC-EDIT1-YEAR         PIC 99.
  3362         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3363         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3364                     DC-GREG-DATE-2-EDIT.
  3365             20  DC-EDIT2-MONTH        PIC 99.
  3366             20  SLASH2-1              PIC X.
  3367             20  DC-EDIT2-DAY          PIC 99.
  3368             20  SLASH2-2              PIC X.
  3369             20  DC-EDIT2-YEAR         PIC 99.
  3370         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3371         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3372                     DC-GREG-DATE-1-YMD.
  3373             20  DC-YMD-YEAR           PIC 99.
  3374             20  DC-YMD-MONTH          PIC 99.
  3375             20  DC-YMD-DAY            PIC 99.
  3376         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3377         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3378                      DC-GREG-DATE-1-MDY.
  3379             20  DC-MDY-MONTH          PIC 99.
  3380             20  DC-MDY-DAY            PIC 99.
  3381             20  DC-MDY-YEAR           PIC 99.
  3382         16  DC-GREG-DATE-1-ALPHA.
  3383             20  DC-ALPHA-MONTH        PIC X(10).
  3384             20  DC-ALPHA-DAY          PIC 99.
  3385             20  FILLER                PIC XX.
  3386             20  DC-ALPHA-CENTURY.
  3387                 24 DC-ALPHA-CEN-N     PIC 99.
  3388             20  DC-ALPHA-YEAR         PIC 99.
  3389         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3390         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3391         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3392         16  DC-JULIAN-DATE            PIC 9(05).
  3393         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3394                                       PIC 9(05).
  3395         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3396             20  DC-JULIAN-YEAR        PIC 99.
  3397             20  DC-JULIAN-DAYS        PIC 999.
  3398         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3399         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3400         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3401     12  DATE-CONVERSION-VARIBLES.
  3402         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3403         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3404             20  FILLER                PIC 9(3).
  3405             20  HOLD-CEN-1-CCYY.
  3406                 24  HOLD-CEN-1-CC     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  64
* EL050.cbl
  3407                 24  HOLD-CEN-1-YY     PIC 99.
  3408             20  HOLD-CEN-1-MO         PIC 99.
  3409             20  HOLD-CEN-1-DA         PIC 99.
  3410         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3411             20  HOLD-CEN-1-R-MO       PIC 99.
  3412             20  HOLD-CEN-1-R-DA       PIC 99.
  3413             20  HOLD-CEN-1-R-CCYY.
  3414                 24  HOLD-CEN-1-R-CC   PIC 99.
  3415                 24  HOLD-CEN-1-R-YY   PIC 99.
  3416             20  FILLER                PIC 9(3).
  3417         16  HOLD-CENTURY-1-X.
  3418             20  FILLER                PIC X(3)  VALUE SPACES.
  3419             20  HOLD-CEN-1-X-CCYY.
  3420                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3421                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3422             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3423             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3424         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3425             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3426             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3427             20  HOLD-CEN-1-R-X-CCYY.
  3428                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3429                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3430             20  FILLER                PIC XXX.
  3431         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3432         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3433         16  DC-JULIAN-DATE-1          PIC 9(07).
  3434         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3435             20  DC-JULIAN-1-CCYY.
  3436                 24  DC-JULIAN-1-CC    PIC 99.
  3437                 24  DC-JULIAN-1-YR    PIC 99.
  3438             20  DC-JULIAN-DA-1        PIC 999.
  3439         16  DC-JULIAN-DATE-2          PIC 9(07).
  3440         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3441             20  DC-JULIAN-2-CCYY.
  3442                 24  DC-JULIAN-2-CC    PIC 99.
  3443                 24  DC-JULIAN-2-YR    PIC 99.
  3444             20  DC-JULIAN-DA-2        PIC 999.
  3445         16  DC-GREG-DATE-A-EDIT.
  3446             20  DC-EDITA-MONTH        PIC 99.
  3447             20  SLASHA-1              PIC X VALUE '/'.
  3448             20  DC-EDITA-DAY          PIC 99.
  3449             20  SLASHA-2              PIC X VALUE '/'.
  3450             20  DC-EDITA-CCYY.
  3451                 24  DC-EDITA-CENT     PIC 99.
  3452                 24  DC-EDITA-YEAR     PIC 99.
  3453         16  DC-GREG-DATE-B-EDIT.
  3454             20  DC-EDITB-MONTH        PIC 99.
  3455             20  SLASHB-1              PIC X VALUE '/'.
  3456             20  DC-EDITB-DAY          PIC 99.
  3457             20  SLASHB-2              PIC X VALUE '/'.
  3458             20  DC-EDITB-CCYY.
  3459                 24  DC-EDITB-CENT     PIC 99.
  3460                 24  DC-EDITB-YEAR     PIC 99.
  3461         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3462         16  DC-GREG-DATE-CYMD-R REDEFINES
  3463                              DC-GREG-DATE-CYMD.
  3464             20  DC-CYMD-CEN           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  65
* EL050.cbl
  3465             20  DC-CYMD-YEAR          PIC 99.
  3466             20  DC-CYMD-MONTH         PIC 99.
  3467             20  DC-CYMD-DAY           PIC 99.
  3468         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3469         16  DC-GREG-DATE-MDCY-R REDEFINES
  3470                              DC-GREG-DATE-MDCY.
  3471             20  DC-MDCY-MONTH         PIC 99.
  3472             20  DC-MDCY-DAY           PIC 99.
  3473             20  DC-MDCY-CEN           PIC 99.
  3474             20  DC-MDCY-YEAR          PIC 99.
  3475    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3476        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3477    12  DC-EL310-DATE                  PIC X(21).
  3478    12  FILLER                         PIC X(28).
  3479
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  66
* EL050.cbl
  3481*    COPY ELCCALC.
  3482******************************************************************
  3483*                                                                *
  3484*                           ELCCALC.                            *
  3485*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3486*                            VMOD=2.025                          *
  3487*                                                                *
  3488*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3489*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3490*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3491*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3492*                                                                *
  3493*  PASSED TO ELRTRM                                              *
  3494*  -----------------                                             *
  3495*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3496*  ORIGINAL TERM                                                 *
  3497*  BEGINNING DATE                                                *
  3498*  ENDING DATE                                                   *
  3499*  COMPANY I.D.                                                  *
  3500*  ACCOUNT MASTER USER FIELD                                     *
  3501*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3502*  FREE LOOK DAYS                                                *
  3503*                                                                *
  3504*  RETURNED FROM ELRTRM                                          *
  3505*  ---------------------                                         *
  3506*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3507*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3508*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3509*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3510*----------------------------------------------------------------*
  3511*  PASSED TO ELRAMT                                              *
  3512*  ----------------                                              *
  3513*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3514*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3515*  ORIGINAL AMOUNT                                               *
  3516*  ALTERNATE BENEFIT (BALLON)                                    *
  3517*  A.P.R. - NET PAY ONLY                                         *
  3518*  METHOD
  3519*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3520*  COMPANY I.D.                                                  *
  3521*  BENEFIT TYPE                                                  *
  3522*                                                                *
  3523*  RETURNED FROM ELRAMT                                          *
  3524*  --------------------                                          *
  3525*  REMAINING AMOUNT 1 - CURRENT                                  *
  3526*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3527*  REMAINING AMOUNT FACTOR
  3528*----------------------------------------------------------------*
  3529*  PASSED TO ELRESV                                              *
  3530*  -----------------                                             *
  3531*  CERTIFICATE EFFECTIVE DATE                                    *
  3532*  VALUATION DATE                                                *
  3533*  PAID THRU DATE                                                *
  3534*  BENEFIT                                                       *
  3535*  INCURRED DATE                                                 *
  3536*  REPORTED DATE                                                 *
  3537*  ISSUE AGE                                                     *
  3538*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  67
* EL050.cbl
  3539*  CDT PERCENT                                                   *
  3540*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3541* *CLAIM TYPE (LIFE, A/H)                                        *
  3542* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3543* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3544*                                                                *
  3545*  RETURNED FROM ELRESV                                          *
  3546*  --------------------                                          *
  3547*  CDT TABLE USED                                                *
  3548*  CDT FACTOR USED                                               *
  3549*  PAY TO CURRENT RESERVE                                        *
  3550*  I.B.N.R. - A/H ONLY                                           *
  3551*  FUTURE (ACCRUED) AH ONLY                                      *
  3552*----------------------------------------------------------------*
  3553*  PASSED TO ELRATE                                              *
  3554*  ----------------                                              *
  3555*  CERT ISSUE DATE                                               *
  3556*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3557*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3558*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3559*  STATE CODE (CLIENT DEFINED)                                   *
  3560*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3561*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3562*  DEVIATION CODE                                                *
  3563*  ISSUE AGE                                                     *
  3564*  ORIGINAL BENEFIT AMOUNT                                       *
  3565*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3566*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3567*  BENEFIT KIND (LIFE OR A/H)                                    *
  3568*  A.P.R.                                                        *
  3569*  METHOD
  3570*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3571*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3572*  COMPANY I.D. (3 CHARACTER)                                    *
  3573*  BENEFIT CODE                                                  *
  3574*  BENEFIT OVERRIDE CODE                                         *
  3575*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3576*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3577*  JOINT INDICATOR (CSL ONLY)                                    *
  3578*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3579*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3580*                                                                *
  3581*  RETURNED FROM ELRATE                                          *
  3582*  --------------------                                          *
  3583*  CALCULATED PREMIUM                                            *
  3584*  PREMIUM RATE                                                  *
  3585*  MORTALITY CODE                                                *
  3586*  MAX ATTAINED AGE                                              *
  3587*  MAX AGE                                                       *
  3588*  MAX TERM                                                      *
  3589*  MAX MONTHLY BENEFIT                                           *
  3590*  MAX TOTAL BENIFIT                                             *
  3591*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3592*----------------------------------------------------------------*
  3593*  PASSED TO ELRFND                                              *
  3594*  ----------------                                              *
  3595*  CERT ISSUE DATE                                               *
  3596*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  68
* EL050.cbl
  3597*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3598*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3599*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3600*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3601*  STATE CODE (CLIENT DEFINED)                                   *
  3602*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3603*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3604*  DEVIATION CODE                                                *
  3605*  ISSUE AGE                                                     *
  3606*  ORIGINAL BENEFIT AMOUNT                                       *
  3607*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3608*  PROCESS TYPE (CANCEL)                                         *
  3609*  BENEFIT KIND (LIFE OR A/H)                                    *
  3610*  A.P.R.                                                        *
  3611*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3612*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3613*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3614*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3615*  COMPANY I.D. (3 CHARACTER)                                    *
  3616*  BENEFIT CODE                                                  *
  3617*  BENEFIT OVERRIDE CODE                                         *
  3618*                                                                *
  3619*  RETURNED FROM ELRFND                                          *
  3620*  --------------------                                          *
  3621*  CALCULATED REFUND                                             *
  3622*----------------------------------------------------------------*
  3623*  PASSED TO ELEARN                                              *
  3624*  ----------------                                              *
  3625*  CERT ISSUE DATE                                               *
  3626*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3627*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3628*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3629*  STATE CODE (CLIENT DEFINED)                                   *
  3630*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3631*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3632*  DEVIATION CODE                                                *
  3633*  ISSUE AGE                                                     *
  3634*  ORIGINAL BENEFIT AMOUNT                                       *
  3635*  BENEFIT KIND (LIFE OR A/H)                                    *
  3636*  A.P.R.                                                        *
  3637*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3638*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3639*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3640*  COMPANY I.D. (3 CHARACTER)                                    *
  3641*  BENEFIT CODE                                                  *
  3642*  BENEFIT OVERRIDE CODE                                         *
  3643*                                                                *
  3644*  RETURNED FROM ELEARN                                          *
  3645*  --------------------                                          *
  3646*  INDICATED  EARNINGS                                           *
  3647*----------------------------------------------------------------*
  3648*                 LENGTH = 450                                   *
  3649*                                                                *
  3650******************************************************************
  3651******************************************************************
  3652*                   C H A N G E   L O G
  3653*
  3654* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  69
* EL050.cbl
  3655*-----------------------------------------------------------------
  3656*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3657* EFFECTIVE    NUMBER
  3658*-----------------------------------------------------------------
  3659* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3660* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3661* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3662* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3663* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3664* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3665* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3666* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3667* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3668* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3669* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3670******************************************************************
  3671
  3672 01  CALCULATION-PASS-AREA.
  3673     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3674                                     COMP.
  3675
  3676     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3677       88  NO-CP-ERROR                             VALUE ZERO.
  3678       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3679                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3680       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3681       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3682       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3683       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3684       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3685       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3686       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3687       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3688       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3689       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3690       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3691       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3692       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3693       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3694       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3695       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3696       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3697
  3698     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3699       88  NO-CP-ERROR-2                           VALUE ZERO.
  3700***********************  INPUT AREAS ****************************
  3701
  3702     12  CP-CALCULATION-AREA.
  3703         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3704         16  CP-CERT-EFF-DT        PIC XX.
  3705         16  CP-VALUATION-DT       PIC XX.
  3706         16  CP-PAID-THRU-DT       PIC XX.
  3707         16  CP-BENEFIT-TYPE       PIC X.
  3708           88  CP-AH                               VALUE 'A' 'D'
  3709                                                   'I' 'U'.
  3710           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3711           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3712         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  70
* EL050.cbl
  3713         16  CP-REPORTED-DT        PIC XX.
  3714         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3715         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3716         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3717                                     COMP-3.
  3718         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3719                                     COMP-3.
  3720         16  CP-CDT-METHOD         PIC X.
  3721           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3722           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3723           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3724         16  CP-CLAIM-TYPE         PIC X.
  3725           88  CP-AH-CLAIM                         VALUE 'A'.
  3726           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3727         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3728                                     COMP-3.
  3729         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3730                                     COMP-3.
  3731         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3732                                     COMP-3.
  3733         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3734                                     COMP-3.
  3735         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3736                                     COMP-3.
  3737         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3738                                     COMP-3.
  3739         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3740                                     COMP-3.
  3741         16  CP-REM-TERM-METHOD    PIC X.
  3742           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3743           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3744           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3745           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3746           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3747           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3748           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3749         16  CP-EARNING-METHOD     PIC X.
  3750           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3751           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3752           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3753           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3754           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3755           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3756           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3757           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3758           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3759           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3760           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3761           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3762           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3763           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3764         16  CP-PROCESS-TYPE       PIC X.
  3765           88  CP-CLAIM                            VALUE '1'.
  3766           88  CP-CANCEL                           VALUE '2'.
  3767           88  CP-ISSUE                            VALUE '3'.
  3768         16  CP-SPECIAL-CALC-CD    PIC X.
  3769           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3770           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  71
* EL050.cbl
  3771           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3772           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3773           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3774           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3775           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3776           88  CP-FARM-PLAN                    VALUE 'F'.
  3777           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3778           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3779           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3780           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3781           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3782           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3783           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3784           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3785           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3786           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3787                                                     'W' 'X'.
  3788           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3789           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3790           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3791           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3792           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3793           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3794           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3795           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3796           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3797           88  CP-CSL-METH-1                   VALUE '5'.
  3798           88  CP-CSL-METH-2                   VALUE '6'.
  3799           88  CP-CSL-METH-3                   VALUE '7'.
  3800           88  CP-CSL-METH-4                   VALUE '8'.
  3801
  3802         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3803                                     COMP-3.
  3804         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3805         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3806         16  CP-STATE              PIC XX          VALUE SPACE.
  3807         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3808         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3809           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3810               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3811         16  CP-R78-OPTION         PIC X.
  3812           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3813           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3814
  3815         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3816         16  CP-IBNR-RESERVE-SW    PIC X.
  3817         16  CP-CLAIM-STATUS       PIC X.
  3818         16  CP-RATE-FILE          PIC X.
  3819         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3820                                     COMP-3.
  3821
  3822         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3823         16  CP-AH-OVERRIDE-CODE   PIC X.
  3824
  3825         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3826                                     COMP-3.
  3827         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3828                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  72
* EL050.cbl
  3829         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3830                                     COMP-3.
  3831         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3832                                     COMP-3.
  3833         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3834                                     COMP-3.
  3835         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3836                                  PIC S9(7)V99 COMP-3.
  3837
  3838         16  CP-PAID-FROM-DATE     PIC X(02).
  3839         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3840         16  CP-EXT-DAYS-CALC      PIC X.
  3841           88  CP-EXT-NO-CHG                   VALUE ' '.
  3842           88  CP-EXT-CHG-LF                   VALUE '1'.
  3843           88  CP-EXT-CHG-AH                   VALUE '2'.
  3844           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3845         16  CP-DOMICILE-STATE     PIC XX.
  3846         16  CP-CARRIER            PIC X.
  3847         16  CP-REIN-FLAG          PIC X.
  3848         16  CP-REM-TRM-CALC-OPTION PIC X.
  3849           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3850                      '2' '3' '4' '5'.
  3851           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3852           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3853           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3854           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3855           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3856           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3857           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3858           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3859         16  CP-SIG-SWITCH         PIC X.
  3860         16  CP-RATING-METHOD      PIC X.
  3861           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3862           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3863           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3864           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3865           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3866           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3867           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3868           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3869           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3870         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3871                                     COMP-3.
  3872         16  CP-BEN-CATEGORY       PIC X.
  3873         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3874         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3875                                   PIC S99V9(5) COMP-3.
  3876         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3877         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3878                                   PIC S99V9(5) COMP-3.
  3879         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3880         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3881         16  CP-EXPIRE-DT          PIC XX.
  3882         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3883         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3884         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3885         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3886         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  73
* EL050.cbl
  3887             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3888             88  CP-CALC-CLP              VALUE 'C'.
  3889         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3890         16  CP-CANCEL-REASON      PIC X.
  3891         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3892         16  CP-PMT-MODE           PIC X.
  3893         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3894         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3895         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3896         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3897         16  FILLER                PIC X.
  3898
  3899***************    OUTPUT FROM ELRESV   ************************
  3900
  3901         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3902
  3903         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3904                                     COMP-3.
  3905         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3906                                     COMP-3.
  3907         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3908                                     COMP-3.
  3909         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3910                                     COMP-3.
  3911         16  FILLER                PIC X(09).
  3912***************    OUTPUT FROM ELRTRM   *************************
  3913
  3914         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3915                                     COMP-3.
  3916         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3917                                     COMP-3.
  3918         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3919                                     COMP-3.
  3920         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3921                                     COMP-3.
  3922         16  FILLER                PIC X(12).
  3923
  3924***************    OUTPUT FROM ELRAMT   *************************
  3925
  3926         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3927                                     COMP-3.
  3928         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3929                                     COMP-3.
  3930         16  FILLER                PIC X(12).
  3931
  3932***************    OUTPUT FROM ELRATE   *************************
  3933
  3934         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3935                                     COMP-3.
  3936         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3937                                     COMP-3.
  3938         16  CP-MORTALITY-CODE     PIC X(4).
  3939         16  CP-RATE-EDIT-FLAG     PIC X.
  3940             88  CP-RATES-NEED-APR                  VALUE '1'.
  3941         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3942                                     COMP-3.
  3943         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3944         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  74
* EL050.cbl
  3945         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3946                                   PIC S9(7)V99 COMP-3.
  3947         16  FILLER                PIC X(07).
  3948
  3949***************    OUTPUT FROM ELRFND   *************************
  3950
  3951         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3952                                     COMP-3.
  3953         16  CP-REFUND-TYPE-USED   PIC X.
  3954           88  CP-R-AS-R78                         VALUE '1'.
  3955           88  CP-R-AS-PRORATA                     VALUE '2'.
  3956           88  CP-R-AS-CALIF                       VALUE '3'.
  3957           88  CP-R-AS-TEXAS                       VALUE '4'.
  3958           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3959           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3960           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3961           88  CP-R-AS-MEAN                        VALUE '8'.
  3962           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3963           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3964           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3965           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3966           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3967           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3968         16  FILLER                PIC X(12).
  3969
  3970***************    OUTPUT FROM ELEARN   *************************
  3971
  3972         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3973                                     COMP-3.
  3974         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3975                                     COMP-3.
  3976         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3977                                     COMP-3.
  3978         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3979                                     COMP-3.
  3980         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3981                                     COMP-3.
  3982         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3983                                     COMP-3.
  3984         16  CP-EARNING-TYPE-USED  PIC X.
  3985           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3986           88  CP-E-AS-R78                         VALUE '1'.
  3987           88  CP-E-AS-PRORATA                     VALUE '2'.
  3988           88  CP-E-AS-TEXAS                       VALUE '4'.
  3989           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3990           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3991           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3992           88  CP-E-AS-MEAN                        VALUE '8'.
  3993           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3994         16  FILLER                PIC X(12).
  3995
  3996***************    OUTPUT FROM ELPMNT   *************************
  3997
  3998         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3999                                     COMP-3.
  4000         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  4001                                     COMP-3.
  4002         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  75
* EL050.cbl
  4003
  4004***************   MISC WORK AREAS    *****************************
  4005         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  4006                                     COMP-3.
  4007         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  4008                                     COMP-3.
  4009         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  4010                                     COMP-3.
  4011         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  4012                                     COMP-3.
  4013         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  4014                                     COMP-3.
  4015         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  4016                                     COMP-3.
  4017         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  4018             88  OPEN-RATE-FILE                   VALUE 'O'.
  4019             88  CLOSE-RATE-FILE                  VALUE 'C'.
  4020             88  IO-ERROR                         VALUE 'E'.
  4021
  4022         16  CP-FIRST-PAY-DATE     PIC XX.
  4023
  4024         16  CP-JOINT-INDICATOR    PIC X.
  4025
  4026         16  CP-RESERVE-REMAINING-TERM
  4027                                   PIC S9(4)V9    VALUE ZERO
  4028                                     COMP-3.
  4029
  4030         16  CP-INSURED-BIRTH-DT   PIC XX.
  4031
  4032         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  4033                                     COMP-3.
  4034
  4035         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  4036                                     COMP-3.
  4037
  4038         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  4039                                     COMP-3.
  4040
  4041         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  4042                                     COMP-3.
  4043
  4044         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  4045                                     COMP-3.
  4046
  4047         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  4048                                     COMP-3.
  4049
  4050         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  4051                                     COMP-3.
  4052
  4053         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  4054             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  4055
  4056         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  4057                                     COMP-3.
  4058         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  4059                                     COMP-3.
  4060         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  76
* EL050.cbl
  4061         16  cp-extra-periods      pic 9 value zeros.
  4062         16  cp-net-only-state     pic x value spaces.
  4063         16  FILLER                PIC X(13).
  4064******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  77
* EL050.cbl
  4066******************************************************************
  4067*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  4068*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  4069*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  4070*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  4071*** MODIFICATION.                                              ***
  4072*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  4073*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  4074******************************************************************
  4075*    COPY ERCPNDB.
  4076******************************************************************
  4077*                                                                *
  4078*                                                                *
  4079*                            ERCPNDB.                            *
  4080*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4081*                            VMOD=2.025                          *
  4082*                                                                *
  4083*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4084*                                                                *
  4085******************************************************************
  4086*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4087*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4088******************************************************************
  4089*                                                                *
  4090*                                                                *
  4091*   FILE TYPE = VSAM,KSDS                                        *
  4092*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4093*                                                                *
  4094*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4095*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4096*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4097*                                                 RKP=13,LEN=36  *
  4098*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4099*                                      AND CHG-SEQ.)             *
  4100*                                                RKP=49,LEN=11   *
  4101*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4102*                                      AND CHG-SEQ.)             *
  4103*                                                RKP=60,LEN=15   *
  4104*                                                                *
  4105*   LOG = NO                                                     *
  4106*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4107******************************************************************
  4108******************************************************************
  4109*                   C H A N G E   L O G
  4110*
  4111* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4112*-----------------------------------------------------------------
  4113*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4114* EFFECTIVE    NUMBER
  4115*-----------------------------------------------------------------
  4116* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4117* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4118* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4119* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4120* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4121* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4122* 032306                   PEMA  ADD BOW LOAN NUMBER
  4123* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  78
* EL050.cbl
  4124* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4125* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4126* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4127* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4128* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4129* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4130* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4131* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4132* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4133* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4134* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4135* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
  4136******************************************************************
  4137
  4138 01  PENDING-BUSINESS.
  4139     12  PB-RECORD-ID                     PIC XX.
  4140         88  VALID-PB-ID                        VALUE 'PB'.
  4141
  4142     12  PB-CONTROL-PRIMARY.
  4143         16  PB-COMPANY-CD                PIC X.
  4144         16  PB-ENTRY-BATCH               PIC X(6).
  4145         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4146         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4147
  4148     12  PB-CONTROL-BY-ACCOUNT.
  4149         16  PB-COMPANY-CD-A1             PIC X.
  4150         16  PB-CARRIER                   PIC X.
  4151         16  PB-GROUPING.
  4152             20  PB-GROUPING-PREFIX       PIC XXX.
  4153             20  PB-GROUPING-PRIME        PIC XXX.
  4154         16  PB-STATE                     PIC XX.
  4155         16  PB-ACCOUNT.
  4156             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4157             20  PB-ACCOUNT-PRIME         PIC X(6).
  4158         16  PB-CERT-EFF-DT               PIC XX.
  4159         16  PB-CERT-NO.
  4160             20  PB-CERT-PRIME            PIC X(10).
  4161             20  PB-CERT-SFX              PIC X.
  4162         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4163
  4164         16  PB-RECORD-TYPE               PIC X.
  4165             88  PB-MAILING-DATA                VALUE '0'.
  4166             88  PB-ISSUE                       VALUE '1'.
  4167             88  PB-CANCELLATION                VALUE '2'.
  4168             88  PB-BATCH-TRAILER               VALUE '9'.
  4169
  4170     12  PB-CONTROL-BY-ORIG-BATCH.
  4171         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4172         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4173         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4174         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4175
  4176     12  PB-CONTROL-BY-CSR.
  4177         16  PB-CSR-COMPANY-CD            PIC X.
  4178         16  PB-CSR-ID                    PIC X(4).
  4179         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4180         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4181         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  79
* EL050.cbl
  4182******************************************************************
  4183*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4184******************************************************************
  4185
  4186     12  PB-LAST-MAINT-DT                 PIC XX.
  4187     12  PB-LAST-MAINT-BY                 PIC X(4).
  4188     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4189
  4190     12  PB-RECORD-BODY                   PIC X(375).
  4191
  4192     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4193         16  PB-CERT-ORIGIN               PIC X.
  4194             88  CLASIC-CREATED-CERT         VALUE '1'.
  4195         16  PB-I-NAME.
  4196             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4197             20  PB-I-INSURED-FIRST-NAME.
  4198                 24  PB-I-INSURED-1ST-INIT PIC X.
  4199                 24  FILLER                PIC X(9).
  4200             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4201         16  PB-I-AGE                     PIC S99   COMP-3.
  4202         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4203         16  PB-I-BIRTHDAY                PIC XX.
  4204         16  PB-I-INSURED-SEX             PIC X.
  4205             88  PB-SEX-MALE     VALUE 'M'.
  4206             88  PB-SEX-FEMALE   VALUE 'F'.
  4207
  4208         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4209         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4210         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4211         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4212         16  PB-I-SKIP-CODE               PIC X.
  4213             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4214             88  PB-SKIP-JULY              VALUE '1'.
  4215             88  PB-SKIP-AUGUST            VALUE '2'.
  4216             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4217             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4218             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4219             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4220             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4221             88  PB-SKIP-JUNE              VALUE '8'.
  4222             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4223             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4224             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4225         16  PB-I-TERM-TYPE               PIC X.
  4226             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4227             88  PB-PAID-WEEKLY            VALUE 'W'.
  4228             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4229             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4230             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4231         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4232         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4233         16  PB-I-DATA-ENTRY-SW           PIC X.
  4234             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4235             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4236             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4237             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4238         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4239         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  80
* EL050.cbl
  4240*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4241         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4242         16  PB-I-LETTER-REQD             PIC X.
  4243
  4244         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4245             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4246             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4247                                                   '90' THRU '99'.
  4248         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4249                                          PIC XX.
  4250         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4251         16  PB-I-AMOUNT-FINANCED REDEFINES
  4252                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4253         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4254         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4255                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4256         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4257         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4258         16  PB-I-CLP-AMOUNT REDEFINES
  4259                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4260         16  PB-I-LF-CALC-FLAG            PIC X.
  4261             88 PB-COMP-LF-PREM               VALUE '?'.
  4262         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4263         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4264         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4265         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4266         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4267         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4268         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4269         16  PB-I-LF-ABBR                 PIC XXX.
  4270         16  PB-I-LF-INPUT-CD             PIC XX.
  4271
  4272         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4273             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4274             88  PB-INVALID-AH               VALUE '  ' '00'
  4275                                                   '90' THRU '99'.
  4276         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4277         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4278         16  PB-I-AH-CALC-FLAG            PIC X.
  4279             88 PB-COMP-AH-PREM                  VALUE '?'.
  4280         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4281         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4282         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4283         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4284         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4285         16  PB-I-AH-ABBR                 PIC XXX.
  4286         16  PB-I-AH-INPUT-CD             PIC XXX.
  4287
  4288         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4289         16  PB-I-REIN-TABLE              PIC XXX.
  4290         16  PB-I-BUSINESS-TYPE           PIC 99.
  4291         16  PB-I-INDV-GRP-CD             PIC X.
  4292         16  PB-I-MORT-CODE.
  4293             20  PB-I-TABLE               PIC X.
  4294             20  PB-I-INTEREST            PIC XX.
  4295             20  PB-I-MORT-TYP            PIC X.
  4296         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4297         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  81
* EL050.cbl
  4298         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4299         16  PB-I-INDV-GRP-OVRD           PIC X.
  4300         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4301         16  PB-I-SIG-SW                  PIC X.
  4302             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4303         16  PB-I-RATE-CLASS              PIC XX.
  4304         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4305         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4306         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4307         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4308         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4309         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4310         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4311         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4312         16  PB-I-OB-FLAG                 PIC X.
  4313             88  PB-I-OB                      VALUE 'B'.
  4314             88  PB-I-SUMMARY                 VALUE 'Z'.
  4315         16  PB-I-ENTRY-STATUS            PIC X.
  4316             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4317                                              'M' '5' '9' '2'.
  4318             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4319             88  PB-I-POLICY-PENDING          VALUE '2'.
  4320             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4321             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4322             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4323             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4324             88  PB-I-REIN-ONLY               VALUE '9'.
  4325             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4326             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4327             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4328             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4329         16  PB-I-INT-CODE                PIC X.
  4330             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4331             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4332         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4333         16  PB-I-SOC-SEC-NO              PIC X(11).
  4334         16  PB-I-MEMBER-NO               PIC X(12).
  4335         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4336*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4337         16  PB-I-OLD-LOF                 PIC XXX.
  4338         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4339         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4340         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4341         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4342         16  PB-I-LIFE-INDICATOR          PIC X.
  4343             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4344         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4345         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4346                                          PIC S9(5)V99    COMP-3.
  4347         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4348             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4349             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4350         16  PB-I-1ST-PMT-DT              PIC XX.
  4351         16  PB-I-JOINT-INSURED.
  4352             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4353             20 PB-I-JOINT-FIRST-NAME.
  4354                24  PB-I-JOINT-FIRST-INIT PIC X.
  4355                24  FILLER                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  82
* EL050.cbl
  4356             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4357*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4358         16  PB-I-BENEFICIARY-NAME.
  4359             20  PB-I-BANK-NUMBER         PIC X(10).
  4360             20  FILLER                   PIC X(15).
  4361         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4362         16  PB-I-REFERENCE               PIC X(12).
  4363         16  FILLER REDEFINES PB-I-REFERENCE.
  4364             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4365             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4366             20  PB-I-CLP-STATE           PIC XX.
  4367         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4368             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4369             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4370             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4371         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4372         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4373         16  PB-I-RESIDENT-STATE          PIC XX.
  4374         16  PB-I-RATE-CODE               PIC X(4).
  4375         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4376         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4377         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4378         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4379         16  PB-I-BANK-NOCHRGB            PIC 99.
  4380         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4381         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4382
  4383     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4384         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4385             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4386         16  PB-C-CANCEL-ORIGIN           PIC X.
  4387             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4388         16  PB-C-LF-CANCEL-DT            PIC XX.
  4389         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4390         16  PB-C-LF-CALC-REQ             PIC X.
  4391             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4392         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4393         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4394         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4395             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4396         16  PB-C-AH-CANCEL-DT            PIC XX.
  4397         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4398         16  PB-C-AH-CALC-REQ             PIC X.
  4399             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4400         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4401         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4402         16  PB-C-LAST-NAME               PIC X(15).
  4403         16  PB-C-REFUND-SW               PIC X.
  4404             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4405             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4406         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4407         16  PB-C-PAYEE-CODE              PIC X(6).
  4408         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4409         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4410         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4411         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4412         16  PB-C-REFERENCE               PIC X(12).
  4413         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  83
* EL050.cbl
  4414         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4415         16  PB-C-POST-CARD-IND           PIC X.
  4416         16  PB-C-CANCEL-REASON           PIC X.
  4417         16  PB-C-REF-INTERFACE-SW        PIC X.
  4418         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4419         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4420         16  FILLER                       PIC X(01).
  4421*        16  FILLER                       PIC X(18).
  4422         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4423*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4424         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  4425         16  PB-CANCELED-CERT-DATA.
  4426             20  PB-CI-INSURED-NAME.
  4427                 24  PB-CI-LAST-NAME      PIC X(15).
  4428                 24  PB-CI-INITIALS       PIC XX.
  4429             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4430             20  PB-CI-INSURED-SEX        PIC X.
  4431             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4432             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4433             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4434             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4435             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4436             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4437             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4438             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4439             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4440             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4441             20  PB-CI-RATE-CLASS         PIC XX.
  4442             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4443             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4444             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4445             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4446             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4447             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4448             20  PB-CI-LF-ABBR            PIC X(3).
  4449             20  PB-CI-AH-ABBR            PIC X(3).
  4450             20  PB-CI-OB-FLAG            PIC X.
  4451                 88  PB-CI-OB                VALUE 'B'.
  4452             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4453                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4454                                           'M' '4' '5' '9' '2'.
  4455                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4456                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4457                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4458                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4459                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4460                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4461                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4462                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4463                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4464                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4465                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4466                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4467                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4468             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4469                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4470                                           'M' '4' '5' '9' '2'.
  4471                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  84
* EL050.cbl
  4472                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4473                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4474                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4475                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4476                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4477                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4478                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4479                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4480                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4481                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4482                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4483                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4484             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4485             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4486             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4487             20  PB-CI-MEMBER-NO          PIC X(12).
  4488             20  PB-CI-INT-CODE           PIC X.
  4489                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4490                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4491             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4492             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4493             20  PB-CI-COMP-EXCP-SW       PIC X.
  4494                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4495                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4496             20  PB-CI-ENTRY-STATUS       PIC X.
  4497             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4498             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4499             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4500             20  PB-CI-DEATH-DT           PIC XX.
  4501             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4502             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4503             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4504             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4505             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4506             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4507             20  PB-CI-ENTRY-DT              PIC XX.
  4508             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4509             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4510             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4511             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4512             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4513             20  PB-CI-OLD-LOF               PIC XXX.
  4514*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4515             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4516             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4517             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4518             20  PB-CI-INDV-GRP-CD           PIC X.
  4519             20  PB-CI-BENEFICIARY-NAME.
  4520                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4521                 24  FILLER                  PIC X(15).
  4522             20  PB-CI-NOTE-SW               PIC X.
  4523             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4524             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4525             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4526             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4527             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4528             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4529             20  PB-CI-FIRST-NAME            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  85
* EL050.cbl
  4530             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4531
  4532         16  FILLER                       PIC X(13).
  4533*032306  16  FILLER                       PIC X(27).
  4534*        16  FILLER                       PIC X(46).
  4535
  4536     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4537         16  FILLER                       PIC X(10).
  4538         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4539         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4540         16  PB-M-INSURED-MID-INIT        PIC X.
  4541         16  PB-M-INSURED-AGE             PIC 99.
  4542         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4543         16  PB-M-INSURED-SEX             PIC X.
  4544         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4545         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4546         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4547         16  PB-M-INSURED-CITY-STATE.
  4548             20  PB-M-INSURED-CITY        PIC X(28).
  4549             20  PB-M-INSURED-STATE       PIC XX.
  4550         16  PB-M-INSURED-ZIP-CODE.
  4551             20  PB-M-INSURED-ZIP-PRIME.
  4552                 24  PB-M-INSURED-ZIP-1   PIC X.
  4553                     88  PB-M-CANADIAN-POST-CODE
  4554                                             VALUE 'A' THRU 'Z'.
  4555                 24  FILLER               PIC X(4).
  4556             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4557         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4558                                        PB-M-INSURED-ZIP-CODE.
  4559             20  PM-M-INS-CAN-POST1       PIC XXX.
  4560             20  PM-M-INS-CAN-POST2       PIC XXX.
  4561             20  FILLER                   PIC XXX.
  4562         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4563         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4564         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4565         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4566         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4567         16  PB-M-CRED-BENE-CITYST.
  4568             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4569             20  PB-M-CRED-BENE-STATE     PIC XX.
  4570         16  FILLER                       PIC X(92).
  4571
  4572     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4573         16  FILLER                       PIC X(10).
  4574         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4575         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4576         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4577         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4578         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4579         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4580         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4581         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4582         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4583         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4584         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4585         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4586         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4587         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  86
* EL050.cbl
  4588         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4589         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4590         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4591         16  PB-ACCOUNT-NAME              PIC X(30).
  4592         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4593         16  PB-REFERENCE                 PIC X(12).
  4594         16  PB-B-RECEIVED-DT             PIC XX.
  4595         16  FILLER                       PIC X(234).
  4596
  4597     12  PB-RECORD-STATUS.
  4598         16  PB-CREDIT-SELECT-DT          PIC XX.
  4599         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4600         16  PB-BILLED-DT                 PIC XX.
  4601         16  PB-BILLING-STATUS            PIC X.
  4602             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4603             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4604             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4605         16  PB-RECORD-BILL               PIC X.
  4606             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4607             88  PB-RECORD-RETURNED           VALUE 'R'.
  4608             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4609             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4610             88  PB-OVERRIDE-AH               VALUE 'A'.
  4611             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4612         16  PB-BATCH-ENTRY               PIC X.
  4613             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4614             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4615             88  PB-REISSUED-CERT             VALUE 'E'.
  4616             88  PB-CASH-CERT                 VALUE 'C'.
  4617             88  PB-MONTHLY-CERT              VALUE 'M'.
  4618             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4619             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4620             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4621         16  PB-FORCE-CODE                PIC X.
  4622             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4623             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4624             88  PB-CANCEL-FORCE              VALUE '8'.
  4625             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4626             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4627             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4628             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4629             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4630             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4631             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4632             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4633         16  PB-FATAL-FLAG                PIC X.
  4634             88  PB-FATAL-ERRORS              VALUE 'X'.
  4635         16  PB-FORCE-ER-CD               PIC X.
  4636             88  PB-FORCE-ERRORS              VALUE 'F'.
  4637             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4638         16  PB-WARN-ER-CD                PIC X.
  4639             88  PB-WARNING-ERRORS            VALUE 'W'.
  4640         16  FILLER                       PIC X.
  4641         16  PB-OUT-BAL-CD                PIC X.
  4642             88  PB-OUT-OF-BAL                VALUE 'O'.
  4643         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4644         16  PB-AH-OVERRIDE-L1            PIC X.
  4645         16  PB-INPUT-DT                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  87
* EL050.cbl
  4646         16  PB-INPUT-BY                  PIC X(4).
  4647         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4648         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4649         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4650         16  PB-LF-EARNING-METHOD         PIC X.
  4651         16  PB-AH-EARNING-METHOD         PIC X.
  4652         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4653         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4654         16  PB-REIN-CD                   PIC XXX.
  4655         16  PB-LF-REFUND-TYPE            PIC X.
  4656         16  PB-AH-REFUND-TYPE            PIC X.
  4657         16  PB-ACCT-EFF-DT               PIC XX.
  4658         16  PB-ACCT-EXP-DT               PIC XX.
  4659         16  PB-COMPANY-ID                PIC X(3).
  4660         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4661         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4662         16  PB-SV-CARRIER                PIC X.
  4663         16  PB-SV-GROUPING               PIC X(6).
  4664         16  PB-SV-STATE                  PIC XX.
  4665         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4666         16  PB-GA-BILLING-INFO.
  4667             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4668                                          PIC XX.
  4669         16  PB-SV-REMIT-TO  REDEFINES
  4670             PB-GA-BILLING-INFO           PIC X(10).
  4671         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4672         16  PB-I-LOAN-OFFICER            PIC X(5).
  4673         16  PB-I-VIN                     PIC X(17).
  4674
  4675         16  FILLER                       PIC X(04).
  4676         16  IMNET-BYPASS-SW              PIC X.
  4677
  4678******************************************************************
  4679*                COMMON EDIT ERRORS                              *
  4680******************************************************************
  4681
  4682     12  PB-COMMON-ERRORS.
  4683         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4684                                           PIC S9(4)     COMP.
  4685
  4686******************************************************************
  4687
  4688* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4689*    COPY ELC50W1.
  4690******************************************************************
  4691*                                                                *
  4692*                                                                *
  4693*                             ELC50W1                            *
  4694*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4695*                            VMOD=2.004                          *
  4696*                                                                *
  4697*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4698*                                                                *
  4699*                                                                *
  4700******************************************************************
  4701
  4702     12  WK-WORK-AREA.
  4703         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  88
* EL050.cbl
  4704         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4705         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4706         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4707         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4708         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4709         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4710         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4711         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4712         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4713         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4714         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4715         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4716         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4717         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4718         16  WK-CREDIT-EDIT-CONTROLS.
  4719             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4720             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4721             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4722             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4723             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4724             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4725         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4726         16  WK-SAVE-REIN-DATA.
  4727             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4728             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4729             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4730         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4731             88  ENTRY-FROM-EL6311       VALUE '6'.
  4732         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4733         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4734     12  WK-RECORD-ADDRESSES.
  4735         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4736         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4737         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4738         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4739         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4740         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4741         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4742         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4743     12  WK-OVER-SHORT-AREA.
  4744         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4745         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4746         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4747             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4748         16  FILLER                   PIC X(5) VALUE SPACES.
  4749
  4750*    COPY ELCEDITC.
  4751******************************************************************
  4752*                                                                *
  4753*                                                                *
  4754*                            ELCEDITC                            *
  4755*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4756*                            VMOD=2.012                          *
  4757*                                                                *
  4758*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4759*                     EL6313, EL050 AND EL517.                   *
  4760*                                                                *
  4761******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  89
* EL050.cbl
  4762******************************************************************
  4763*                   C H A N G E   L O G
  4764*
  4765* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4766*-----------------------------------------------------------------
  4767*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4768* EFFECTIVE    NUMBER
  4769*-----------------------------------------------------------------
  4770* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4771******************************************************************
  4772
  4773     12  EDIT-CRITERIA-DATA.
  4774         16  EC-CO-MONTH-END-DT       PIC XX.
  4775         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4776         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4777         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4778         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4779         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4780         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4781         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4782         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4783         16  EC-CO-REM-TERM-CALC      PIC X.
  4784               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4785               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4786               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4787               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4788
  4789         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4790               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4791               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4792               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4793               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4794               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4795               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4796               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4797               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4798               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4799               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4800
  4801         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4802               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4803               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4804               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4805               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4806               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4807               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4808               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4809               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4810
  4811         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4812                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4813                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4814
  4815         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4816                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4817                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4818                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4819                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  90
* EL050.cbl
  4820                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4821                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4822                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4823                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4824
  4825         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4826               88  EC-BR-REDUCING                   VALUE 'R'.
  4827               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4828
  4829         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4830         16  EC-BR-LF-DESC             PIC X(10).
  4831         16  EC-BR-AH-DESC             PIC X(10).
  4832         16  EC-BR-LF-COMMENT          PIC X(10).
  4833         16  EC-BR-AH-COMMENT          PIC X(10).
  4834
  4835         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4836               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4837               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4838               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4839               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4840
  4841         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4842               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4843               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4844               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4845               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4846
  4847         16  EC-BR-LF-REFUND-CALC      PIC X.
  4848                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4849                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4850                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4851                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4852                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4853                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4854                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4855
  4856         16  EC-BR-AH-REFUND-CALC      PIC X.
  4857                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4858                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4859                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4860                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4861                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4862                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4863                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4864                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4865
  4866         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4867                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4868                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4869                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4870
  4871         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4872                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4873                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4874                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4875
  4876         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4877         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  91
* EL050.cbl
  4878         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4879         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4880
  4881         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4882         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4883                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4884                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4885                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4886                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4887
  4888         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4889               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4890               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4891               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4892               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4893               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4894
  4895         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4896               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4897               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4898               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4899               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4900               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4901
  4902         16  EC-ST-LF-REFUND-CALC      PIC X.
  4903                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4904                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4905                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4906                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4907                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4908                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4909                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4910                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4911
  4912         16  EC-ST-AH-REFUND-CALC      PIC X.
  4913                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4914                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4915                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4916                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4917                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4918                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4919                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4920                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4921
  4922         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4923         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4924         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4925         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4926         16  EC-AM-EXPIRATION-DT       PIC XX.
  4927         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4928         16  EC-AM-CLASS-CD            PIC XX.
  4929         16  EC-AM-LF-DEVIATION        PIC XXX.
  4930         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4931         16  EC-AM-AH-DEVIATION        PIC XXX.
  4932         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4933         16  EC-AM-PHONE-NO            PIC X(10).
  4934
  4935         16  EC-AM-LF-REFUND-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  92
* EL050.cbl
  4936                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4937                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4938                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4939                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4940                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4941                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4942                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4943
  4944         16  EC-AM-AH-REFUND-CALC      PIC X.
  4945                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4946                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4947                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4948                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4949                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4950                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4951                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4952
  4953         16  EC-AM-BEN-I-G-CD          PIC X.
  4954                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4955                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4956                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4957
  4958         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4959         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4960         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4961         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4962         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4963         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4964         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4965         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4966         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4967
  4968         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4969         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4970         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4971         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4972         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4973         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4974         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4975         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4976         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4977         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4978         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4979         16  EC-RT-LF-NSP-ST           PIC XX.
  4980         16  EC-RT-AH-NSP-ST           PIC XX.
  4981         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4982         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4983
  4984         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4985             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4986                                             'M' '5' '9' '2'.
  4987             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4988             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4989             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4990             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4991             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4992             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4993             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  93
* EL050.cbl
  4994             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4995             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4996             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4997
  4998         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4999             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  5000                                             'M' '5' '9' '2'.
  5001             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  5002             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  5003             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  5004             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  5005             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  5006             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  5007             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  5008             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  5009             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  5010             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  5011
  5012         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  5013         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  5014         16  EC-CM-LF-CANCEL-DT        PIC XX.
  5015         16  EC-CM-AH-CANCEL-DT        PIC XX.
  5016         16  EC-CM-DEATH-DT            PIC XX.
  5017
  5018*DMD CUSTOM CODING FIELDS BELOW
  5019*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  5020         16  EC-BR-DMD-RATING-SW       PIC X.
  5021                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  5022                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  5023                 88  NO-DMD-RATING               VALUE 'N'.
  5024
  5025         16  EC-NEW-CERT               PIC X(11).
  5026         16  EC-NEW-STATE              PIC XX.
  5027         16  FILLER                    PIC X.
  5028*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  5029         16  OVER-SHORT-EDIT-FIELDS.
  5030             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5031             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5032             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5033             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5034             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  5035             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5036             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5037             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5038             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5039         16  FILLER                    PIC X(71).
  5040******************************************************************
  5041
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  94
* EL050.cbl
  5043*    COPY ELCDIFRD.
  5044******************************************************************
  5045*                                                                *
  5046*                                                                *
  5047*                            ELCDIFRD.                           *
  5048*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5049*                            VMOD=2.004                          *
  5050*                                                                *
  5051*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  5052*                                                                *
  5053******************************************************************
  5054*
  5055  01  WS-DIFFERENCE-CALCULATION.
  5056        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  5057        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  5058        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  5059        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  5060        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  5061        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5062        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5063        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5064        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5065        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5066        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5067
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  95
* EL050.cbl
  5069****************************************************************
  5070*
  5071* Copyright (c) 2007-2013 Dell Inc.
  5072* All rights reserved.
  5073*
  5074****************************************************************
  5075 01  DFHEIV.
  5076   02  DFHEIV0               PIC X(35).
  5077   02  DFHEIV1               PIC X(08).
  5078   02  DFHEIV2               PIC X(08).
  5079   02  DFHEIV3               PIC X(08).
  5080   02  DFHEIV4               PIC X(06).
  5081   02  DFHEIV5               PIC X(04).
  5082   02  DFHEIV6               PIC X(04).
  5083   02  DFHEIV7               PIC X(02).
  5084   02  DFHEIV8               PIC X(02).
  5085   02  DFHEIV9               PIC X(01).
  5086   02  DFHEIV10              PIC S9(7) COMP-3.
  5087   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5088   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5089   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5090   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5091   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5092   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5093   02  DFHEIV17              PIC X(04).
  5094   02  DFHEIV18              PIC X(04).
  5095   02  DFHEIV19              PIC X(04).
  5096   02  DFHEIV20              USAGE IS POINTER.
  5097   02  DFHEIV21              USAGE IS POINTER.
  5098   02  DFHEIV22              USAGE IS POINTER.
  5099   02  DFHEIV23              USAGE IS POINTER.
  5100   02  DFHEIV24              USAGE IS POINTER.
  5101   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5102   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5103   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5104   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5105   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5106   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5107   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5108   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5109   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5110   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5111   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5112   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5113   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5114   02  FILLER                PIC X(02).
  5115   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5116   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5117   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5118   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5119   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5120   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5121   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5122 LINKAGE  SECTION.
  5123*****************************************************************
  5124*                                                               *
  5125* Copyright (c) 2007-2013 Dell Inc.                             *
  5126* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  96
* EL050.cbl
  5127*                                                               *
  5128*****************************************************************
  5129 01  dfheiblk.
  5130     02  eibtime          pic s9(7) comp-3.
  5131     02  eibdate          pic s9(7) comp-3.
  5132     02  eibtrnid         pic x(4).
  5133     02  eibtaskn         pic s9(7) comp-3.
  5134     02  eibtrmid         pic x(4).
  5135     02  dfheigdi         pic s9(4) comp.
  5136     02  eibcposn         pic s9(4) comp.
  5137     02  eibcalen         pic s9(4) comp.
  5138     02  eibaid           pic x(1).
  5139     02  eibfiller1       pic x(1).
  5140     02  eibfn            pic x(2).
  5141     02  eibfiller2       pic x(2).
  5142     02  eibrcode         pic x(6).
  5143     02  eibfiller3       pic x(2).
  5144     02  eibds            pic x(8).
  5145     02  eibreqid         pic x(8).
  5146     02  eibrsrce         pic x(8).
  5147     02  eibsync          pic x(1).
  5148     02  eibfree          pic x(1).
  5149     02  eibrecv          pic x(1).
  5150     02  eibsend          pic x(1).
  5151     02  eibatt           pic x(1).
  5152     02  eibeoc           pic x(1).
  5153     02  eibfmh           pic x(1).
  5154     02  eibcompl         pic x(1).
  5155     02  eibsig           pic x(1).
  5156     02  eibconf          pic x(1).
  5157     02  eiberr           pic x(1).
  5158     02  eibrldbk         pic x(1).
  5159     02  eiberrcd         pic x(4).
  5160     02  eibsynrb         pic x(1).
  5161     02  eibnodat         pic x(1).
  5162     02  eibfiller5       pic x(2).
  5163     02  eibresp          pic s9(8) comp.
  5164     02  eibresp2         pic s9(8) comp.
  5165     02  dfheigdj         pic s9(4) comp.
  5166     02  dfheigdk         pic s9(4) comp.
  5167
  5168 01  DFHCOMMAREA                   PIC X(1036).
  5169
  5170*01 PARMLIST .
  5171*    02  FILLER                    PIC S9(8)   COMP.
  5172*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5173*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5174*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5175*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5176*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5177*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5178*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5179
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  97
* EL050.cbl
  5181*    COPY ELCCNTL.
  5182******************************************************************
  5183*                                                                *
  5184*                                                                *
  5185*                            ELCCNTL.                            *
  5186*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5187*                            VMOD=2.059                          *
  5188*                                                                *
  5189*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5190*                                                                *
  5191*   FILE TYPE = VSAM,KSDS                                        *
  5192*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5193*                                                                *
  5194*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5195*       ALTERNATE INDEX = NONE                                   *
  5196*                                                                *
  5197*   LOG = YES                                                    *
  5198*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5199******************************************************************
  5200*                   C H A N G E   L O G
  5201*
  5202* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5203*-----------------------------------------------------------------
  5204*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5205* EFFECTIVE    NUMBER
  5206*-----------------------------------------------------------------
  5207* 082503                   PEMA  ADD BENEFIT GROUP
  5208* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5209* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5210* 092705    2005050300006  PEMA  ADD SPP LEASES
  5211* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5212* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5213* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5214* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5215* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5216* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5217* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5218* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5219* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5220* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5221* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  5222******************************************************************
  5223*
  5224 01  CONTROL-FILE.
  5225     12  CF-RECORD-ID                       PIC XX.
  5226         88  VALID-CF-ID                        VALUE 'CF'.
  5227
  5228     12  CF-CONTROL-PRIMARY.
  5229         16  CF-COMPANY-ID                  PIC XXX.
  5230         16  CF-RECORD-TYPE                 PIC X.
  5231             88  CF-COMPANY-MASTER              VALUE '1'.
  5232             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5233             88  CF-STATE-MASTER                VALUE '3'.
  5234             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5235             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5236             88  CF-CARRIER-MASTER              VALUE '6'.
  5237             88  CF-MORTALITY-MASTER            VALUE '7'.
  5238             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  98
* EL050.cbl
  5239             88  CF-TERMINAL-MASTER             VALUE '9'.
  5240             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5241             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5242             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5243             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5244             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5245             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5246             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5247             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5248             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5249         16  CF-ACCESS-CD-GENL              PIC X(4).
  5250         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5251             20  CF-PROCESSOR               PIC X(4).
  5252         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5253             20  CF-STATE-CODE              PIC XX.
  5254             20  FILLER                     PIC XX.
  5255         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5256             20  FILLER                     PIC XX.
  5257             20  CF-HI-BEN-IN-REC           PIC XX.
  5258         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5259             20  FILLER                     PIC XXX.
  5260             20  CF-CARRIER-CNTL            PIC X.
  5261         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5262             20  FILLER                     PIC XX.
  5263             20  CF-HI-TYPE-IN-REC          PIC 99.
  5264         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5265             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5266                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5267             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5268             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5269         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5270             20  FILLER                     PIC X.
  5271             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5272         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5273             20  FILLER                     PIC XX.
  5274             20  CF-MORTGAGE-PLAN           PIC XX.
  5275         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5276
  5277     12  CF-LAST-MAINT-DT                   PIC XX.
  5278     12  CF-LAST-MAINT-BY                   PIC X(4).
  5279     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5280
  5281     12  CF-RECORD-BODY                     PIC X(728).
  5282
  5283
  5284****************************************************************
  5285*             COMPANY MASTER RECORD                            *
  5286****************************************************************
  5287
  5288     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5289         16  CF-COMPANY-ADDRESS.
  5290             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5291             20  CF-CL-IN-CARE-OF           PIC X(30).
  5292             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5293             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5294             20  CF-CL-CITY-STATE           PIC X(30).
  5295             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5296             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page  99
* EL050.cbl
  5297         16  CF-COMPANY-CD                  PIC X.
  5298         16  CF-COMPANY-PASSWORD            PIC X(8).
  5299         16  CF-SECURITY-OPTION             PIC X.
  5300             88  ALL-SECURITY                   VALUE '1'.
  5301             88  COMPANY-VERIFY                 VALUE '2'.
  5302             88  PROCESSOR-VERIFY               VALUE '3'.
  5303             88  NO-SECURITY                    VALUE '4'.
  5304             88  ALL-BUT-TERM                   VALUE '5'.
  5305         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5306             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5307         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5308             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5309         16  CF-INFORCE-LOCATION            PIC X.
  5310             88  CERTS-ARE-ONLINE               VALUE '1'.
  5311             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5312             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5313         16  CF-LOWER-CASE-LETTERS          PIC X.
  5314         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5315             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5316             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5317             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5318             88  CF-ACCNT-CNTL                  VALUE '3'.
  5319             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5320
  5321         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5322         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5323
  5324         16  CF-LGX-CREDIT-USER             PIC X.
  5325             88  CO-IS-NOT-USER                 VALUE 'N'.
  5326             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5327
  5328         16 CF-CREDIT-CALC-CODES.
  5329             20  CF-CR-REM-TERM-CALC PIC X.
  5330               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5331               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5332               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5333               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5334               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5335               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5336               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5337             20  CF-CR-R78-METHOD           PIC X.
  5338               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5339               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5340
  5341         16  CF-CLAIM-CONTROL-COUNTS.
  5342             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5343                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5344
  5345             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5346                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5347
  5348             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5349                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5350
  5351             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5352                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5353
  5354         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 100
* EL050.cbl
  5355
  5356         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5357             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5358             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5359             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5360             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5361                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5362                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5363             20  CF-CO-PREM-REJECT-SW       PIC X.
  5364                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5365                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5366             20  CF-CO-REF-REJECT-SW        PIC X.
  5367                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5368                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5369
  5370         16  CF-CO-REPORTING-DT             PIC XX.
  5371         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5372         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5373           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5374           88  CF-CO-MONTH-END                  VALUE '1'.
  5375
  5376         16  CF-LGX-CLAIM-USER              PIC X.
  5377             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5378             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5379
  5380         16  CF-CREDIT-EDIT-CONTROLS.
  5381             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5382             20  CF-MIN-AGE                 PIC 99.
  5383             20  CF-DEFAULT-AGE             PIC 99.
  5384             20  CF-MIN-TERM                PIC S999      COMP-3.
  5385             20  CF-MAX-TERM                PIC S999      COMP-3.
  5386             20  CF-DEFAULT-SEX             PIC X.
  5387             20  CF-JOINT-AGE-INPUT         PIC X.
  5388                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5389             20  CF-BIRTH-DATE-INPUT        PIC X.
  5390                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5391             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5392                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5393                 88  CF-ZERO-CARRIER            VALUE '1'.
  5394                 88  CF-ZERO-GROUPING           VALUE '2'.
  5395                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5396             20  CF-EDIT-SW                 PIC X.
  5397                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5398             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5399             20  CF-CR-PR-METHOD            PIC X.
  5400               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5401               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5402             20  FILLER                     PIC X.
  5403
  5404         16  CF-CREDIT-MISC-CONTROLS.
  5405             20  CF-REIN-TABLE-SW           PIC X.
  5406                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5407             20  CF-COMP-TABLE-SW           PIC X.
  5408                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5409             20  CF-EXPERIENCE-RETENTION-AGE
  5410                                            PIC S9        COMP-3.
  5411             20  CF-CONVERSION-DT           PIC XX.
  5412             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 101
* EL050.cbl
  5413             20  CF-RUN-FREQUENCY-SW        PIC X.
  5414                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5415                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5416
  5417             20  CF-CR-CHECK-NO-CONTROL.
  5418                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5419                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5420                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5421                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5422                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5423                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5424
  5425                 24  CF-CR-CHECK-COUNT       REDEFINES
  5426                     CF-CR-CHECK-COUNTER      PIC X(4).
  5427
  5428                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5429                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5430
  5431                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5432                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5433                 24  CF-MAIL-PROCESSING       PIC X.
  5434                     88  MAIL-PROCESSING          VALUE 'Y'.
  5435
  5436         16  CF-MISC-SYSTEM-CONTROL.
  5437             20  CF-SYSTEM-C                 PIC X.
  5438                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5439             20  CF-SYSTEM-D                 PIC X.
  5440                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5441             20  CF-SOC-SEC-NO-SW            PIC X.
  5442                 88  SOC-SEC-NO-USED             VALUE '1'.
  5443             20  CF-MEMBER-NO-SW             PIC X.
  5444                 88  MEMBER-NO-USED              VALUE '1'.
  5445             20  CF-TAX-ID-NUMBER            PIC X(11).
  5446             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5447             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5448                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5449                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5450                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5451                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5452             20  CF-SYSTEM-E                 PIC X.
  5453                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5454
  5455         16  CF-LGX-LIFE-USER               PIC X.
  5456             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5457             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5458
  5459         16  CF-CR-MONTH-END-DT             PIC XX.
  5460
  5461         16  CF-FILE-MAINT-DATES.
  5462             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5463                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5464             20  CF-LAST-BATCH       REDEFINES
  5465                 CF-LAST-BATCH-NO               PIC X(4).
  5466             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5467             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5468             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5469             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5470             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 102
* EL050.cbl
  5471             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5472             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5473             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5474             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5475             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5476
  5477         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5478         16  FILLER                         PIC X.
  5479
  5480         16  CF-ALT-MORT-CODE               PIC X(4).
  5481         16  CF-MEMBER-CAPTION              PIC X(10).
  5482
  5483         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5484             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5485             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5486             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5487             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5488             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5489
  5490         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5491
  5492         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5493         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5494         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5495         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5496
  5497         16  CF-AH-OVERRIDE-L1              PIC X.
  5498         16  CF-AH-OVERRIDE-L2              PIC XX.
  5499         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5500         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5501
  5502         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5503         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5504
  5505         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5506         16  CF-AR-LAST-EL860-DT            PIC XX.
  5507         16  CF-MP-MONTH-END-DT             PIC XX.
  5508
  5509         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5510         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5511             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5512
  5513         16  CF-AR-MONTH-END-DT             PIC XX.
  5514
  5515         16  CF-CRDTCRD-USER                PIC X.
  5516             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5517             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5518
  5519         16  CF-CC-MONTH-END-DT             PIC XX.
  5520
  5521         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5522
  5523         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5524             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5525             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5526             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5527         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5528         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 103
* EL050.cbl
  5529         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5530         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5531             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5532             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5533         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5534         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5535         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5536             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5537         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5538
  5539         16  CF-CL-ZIP-CODE.
  5540             20  CF-CL-ZIP-PRIME.
  5541                 24  CF-CL-ZIP-1ST          PIC X.
  5542                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5543                 24  FILLER                 PIC X(4).
  5544             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5545         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5546             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5547             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5548             20  FILLER                     PIC XXX.
  5549
  5550         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5551         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5552         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5553         16  CF-CO-OPTION-START-DATE        PIC XX.
  5554         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5555           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5556                                                      '3' '4'.
  5557           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5558           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5559           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5560           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5561           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5562           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5563
  5564         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5565
  5566         16  CF-PAYMENT-APPROVAL-LEVELS.
  5567             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5568             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5569             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5570             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5571             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5572             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5573
  5574         16  CF-END-USER-REPORTING-USER     PIC X.
  5575             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5576             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5577
  5578         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5579             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5580             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5581
  5582         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5583
  5584         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5585         16  FILLER                         PIC X.
  5586
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 104
* EL050.cbl
  5587         16  CF-CREDIT-ARCHIVE-CNTL.
  5588             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5589             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5590             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5591
  5592         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5593
  5594         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5595             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5596             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5597
  5598         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5599             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5600             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5601
  5602         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5603
  5604         16  CF-CO-ACH-ID-CODE              PIC  X.
  5605             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5606             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5607             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5608         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5609         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5610         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5611         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5612         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5613         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5614         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5615         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5616         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5617                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5618         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5619                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5620
  5621         16  CF-CO-OVER-SHORT.
  5622             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5623             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5624
  5625*         16  FILLER                         PIC X(102).
  5626         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5627             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5628             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5629
  5630         16  CF-AH-APPROVAL-DAYS.
  5631             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5632             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5633             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5634             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5635
  5636         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5637
  5638         16  CF-APPROV-LEV-5.
  5639             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5640             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5641             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5642
  5643         16  FILLER                         PIC X(68).
  5644****************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 105
* EL050.cbl
  5645*             PROCESSOR/USER RECORD                            *
  5646****************************************************************
  5647
  5648     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5649         16  CF-PROCESSOR-NAME              PIC X(30).
  5650         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5651         16  CF-PROCESSOR-TITLE             PIC X(26).
  5652         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5653                 88  MESSAGE-YES                VALUE 'Y'.
  5654                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5655
  5656*****************************************************
  5657****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5658****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5659****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5660****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5661*****************************************************
  5662
  5663         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5664             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5665             20  CF-APPLICATION-FORCE       PIC X.
  5666             20  CF-INDIVIDUAL-APP.
  5667                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5668                     28  CF-BROWSE-APP      PIC X.
  5669                     28  CF-UPDATE-APP      PIC X.
  5670
  5671         16  CF-CURRENT-TERM-ON             PIC X(4).
  5672         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5673             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5674             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5675             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5676             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5677             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5678             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5679             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5680         16  CF-PROCESSOR-CARRIER           PIC X.
  5681             88  NO-CARRIER-SECURITY            VALUE ' '.
  5682         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5683             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5684         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5685             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5686         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5687             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5688
  5689         16  CF-PROC-SYS-ACCESS-SW.
  5690             20  CF-PROC-CREDIT-CLAIMS-SW.
  5691                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5692                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5693                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5694                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5695             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5696                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5697                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5698             20  CF-PROC-LIFE-GNRLDGR-SW.
  5699                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5700                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5701                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5702                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 106
* EL050.cbl
  5703             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5704                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5705                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5706         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5707             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5708             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5709         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5710
  5711         16  CF-APPROVAL-LEVEL                  PIC X.
  5712             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5713             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5714             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5715             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5716             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5717
  5718         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5719
  5720         16  CF-LANGUAGE-TYPE                   PIC X.
  5721             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5722             88  CF-LANG-IS-FR                      VALUE 'F'.
  5723
  5724         16  CF-CSR-IND                         PIC X.
  5725         16  FILLER                             PIC X(239).
  5726
  5727****************************************************************
  5728*             PROCESSOR/REMINDERS RECORD                       *
  5729****************************************************************
  5730
  5731     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5732         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5733             20  CF-START-REMIND-DT         PIC XX.
  5734             20  CF-END-REMIND-DT           PIC XX.
  5735             20  CF-REMINDER-TEXT           PIC X(50).
  5736         16  FILLER                         PIC X(296).
  5737
  5738
  5739****************************************************************
  5740*             STATE MASTER RECORD                              *
  5741****************************************************************
  5742
  5743     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5744         16  CF-STATE-ABBREVIATION          PIC XX.
  5745         16  CF-STATE-NAME                  PIC X(25).
  5746         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5747         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5748             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5749             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5750             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5751             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5752                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5753                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5754             20  CF-ST-PREM-REJECT-SW       PIC X.
  5755                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5756                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5757             20  CF-ST-REF-REJECT-SW        PIC X.
  5758                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5759                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5760         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 107
* EL050.cbl
  5761         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5762         16  CF-ST-REFUND-RULES.
  5763             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5764             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5765             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5766         16  CF-ST-FST-PMT-EXTENSION.
  5767             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5768             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5769                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5770                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5771                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5772                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5773         16  CF-ST-STATE-CALL.
  5774             20  CF-ST-CALL-UNEARNED        PIC X.
  5775             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5776             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5777         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5778             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5779             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5780         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5781         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5782         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5783         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5784         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5785         16  FILLER                         PIC X.
  5786         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5787             20  CF-ST-BENEFIT-CD           PIC XX.
  5788             20  CF-ST-BENEFIT-KIND         PIC X.
  5789                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5790                 88  CF-ST-AH-KIND              VALUE 'A'.
  5791             20  CF-ST-REM-TERM-CALC        PIC X.
  5792                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5793                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5794                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5795                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5796                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5797                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5798                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5799                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5800
  5801             20  CF-ST-REFUND-CALC          PIC X.
  5802                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5803                 88  ST-REFD-BY-R78             VALUE '1'.
  5804                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5805                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5806                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5807                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5808                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5809                 88  ST-REFD-UTAH               VALUE '7'.
  5810                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5811                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5812                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5813
  5814             20  CF-ST-EARNING-CALC         PIC X.
  5815                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5816                 88  ST-EARN-BY-R78             VALUE '1'.
  5817                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5818                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 108
* EL050.cbl
  5819                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5820                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5821                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5822                 88  ST-EARN-MEAN               VALUE '8'.
  5823                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5824
  5825             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5826                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5827                 88  ST-OVRD-BY-R78             VALUE '1'.
  5828                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5829                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5830                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5831                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5832                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5833                 88  ST-OVRD-MEAN               VALUE '8'.
  5834                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5835             20  cf-st-extra-periods        pic 9.
  5836*            20  FILLER                     PIC X.
  5837
  5838         16  CF-ST-COMMISSION-CAPS.
  5839             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5840             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5841             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5842             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5843         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5844                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5845                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5846                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5847
  5848         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5849
  5850         16  CF-ST-STATUTORY-INTEREST.
  5851             20  CF-ST-STAT-DATE-FROM       PIC X.
  5852                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5853                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5854             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5855             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5856             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5857             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5858             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5859
  5860         16  CF-ST-OVER-SHORT.
  5861             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5862             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5863
  5864         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5865
  5866         16  CF-ST-RT-CALC                  PIC X.
  5867
  5868         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5869         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5870         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5871         16  CF-ST-RF-LR-CALC               PIC X.
  5872         16  CF-ST-RF-LL-CALC               PIC X.
  5873         16  CF-ST-RF-LN-CALC               PIC X.
  5874         16  CF-ST-RF-AH-CALC               PIC X.
  5875         16  CF-ST-RF-CP-CALC               PIC X.
  5876*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 109
* EL050.cbl
  5877*CIDMOD         16  FILLER                         PIC X(192).
  5878         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5879             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5880         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5881         16  CF-ST-VFY-2ND-BENE             PIC X.
  5882         16  CF-ST-CAUSAL-STATE             PIC X.
  5883         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5884         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5885         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5886             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5887         16  CF-ST-NET-ONLY-STATE           PIC X.
  5888             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5889         16  cf-commission-cap-required     pic x.
  5890         16  CF-ST-GA-COMMISSION-CAPS.
  5891             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5892             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5893             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5894             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5895         16  CF-ST-TOT-COMMISSION-CAPS.
  5896             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5897             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5898             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5899             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5900         16  FILLER                         PIC X(156).
  5901
  5902****************************************************************
  5903*             BENEFIT MASTER RECORD                            *
  5904****************************************************************
  5905
  5906     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5907         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5908             20  CF-BENEFIT-CODE            PIC XX.
  5909             20  CF-BENEFIT-NUMERIC  REDEFINES
  5910                 CF-BENEFIT-CODE            PIC XX.
  5911             20  CF-BENEFIT-ALPHA           PIC XXX.
  5912             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5913             20  CF-BENEFIT-COMMENT         PIC X(10).
  5914
  5915             20  CF-LF-COVERAGE-TYPE        PIC X.
  5916                 88  CF-REDUCING                VALUE 'R'.
  5917                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5918
  5919             20  CF-SPECIAL-CALC-CD         PIC X.
  5920                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5921                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5922                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5923                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5924                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5925                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5926                 88  CF-FARM-PLAN               VALUE 'F'.
  5927                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5928                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5929                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5930                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5931                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5932                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5933                 88  CF-PRUDENTIAL              VALUE 'P'.
  5934                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 110
* EL050.cbl
  5935                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5936                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5937                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5938                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5939                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5940
  5941             20  CF-JOINT-INDICATOR         PIC X.
  5942                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5943
  5944*            20  FILLER                     PIC X(12).
  5945             20  cf-maximum-benefits        pic s999 comp-3.
  5946             20  FILLER                     PIC X(09).
  5947             20  CF-BENEFIT-CATEGORY        PIC X.
  5948             20  CF-LOAN-TYPE               PIC X(8).
  5949
  5950             20  CF-CO-REM-TERM-CALC        PIC X.
  5951                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5952                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5953                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5954                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5955                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5956
  5957             20  CF-CO-EARNINGS-CALC        PIC X.
  5958                 88  CO-EARN-BY-R78             VALUE '1'.
  5959                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5960                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5961                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5962                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5963                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5964                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5965                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5966
  5967             20  CF-CO-REFUND-CALC          PIC X.
  5968                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5969                 88  CO-REFD-BY-R78             VALUE '1'.
  5970                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5971                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5972                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5973                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5974                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5975                 88  CO-REFD-MEAN               VALUE '8'.
  5976                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5977                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5978                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5979
  5980             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5981                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5982                 88  CO-OVRD-BY-R78             VALUE '1'.
  5983                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5984                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5985                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5986                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5987                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5988                 88  CO-OVRD-MEAN               VALUE '8'.
  5989                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5990
  5991             20  CF-CO-BEN-I-G-CD           PIC X.
  5992                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 111
* EL050.cbl
  5993                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5994                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5995
  5996         16  FILLER                         PIC X(304).
  5997
  5998
  5999****************************************************************
  6000*             CARRIER MASTER RECORD                            *
  6001****************************************************************
  6002
  6003     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6004         16  CF-ADDRESS-DATA.
  6005             20  CF-MAIL-TO-NAME            PIC X(30).
  6006             20  CF-IN-CARE-OF              PIC X(30).
  6007             20  CF-ADDRESS-LINE-1          PIC X(30).
  6008             20  CF-ADDRESS-LINE-2          PIC X(30).
  6009             20  CF-CITY-STATE              PIC X(30).
  6010             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  6011             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  6012
  6013         16  CF-CLAIM-NO-CONTROL.
  6014             20  CF-CLAIM-NO-METHOD         PIC X.
  6015                 88  CLAIM-NO-MANUAL            VALUE '1'.
  6016                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  6017                 88  CLAIM-NO-SEQ               VALUE '3'.
  6018                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  6019             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  6020                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  6021                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  6022                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  6023
  6024         16  CF-CHECK-NO-CONTROL.
  6025             20  CF-CHECK-NO-METHOD         PIC X.
  6026                 88  CHECK-NO-MANUAL            VALUE '1'.
  6027                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  6028                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  6029                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  6030             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  6031                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  6032
  6033         16  CF-DOMICILE-STATE              PIC XX.
  6034
  6035         16  CF-EXPENSE-CONTROLS.
  6036             20  CF-EXPENSE-METHOD          PIC X.
  6037                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  6038                 88  DOLLARS-PER-PMT            VALUE '2'.
  6039                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  6040                 88  DOLLARS-PER-MONTH          VALUE '4'.
  6041             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  6042             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  6043
  6044         16  CF-CORRESPONDENCE-CONTROL.
  6045             20  CF-LETTER-RESEND-OPT       PIC X.
  6046                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  6047                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  6048             20  FILLER                     PIC X(4).
  6049
  6050         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 112
* EL050.cbl
  6051             20  CF-MANUAL-SW               PIC X.
  6052                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  6053             20  CF-FUTURE-SW               PIC X.
  6054                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  6055             20  CF-PTC-SW                  PIC X.
  6056                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  6057             20  CF-IBNR-SW                 PIC X.
  6058                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  6059             20  CF-PTC-LF-SW               PIC X.
  6060                 88  CF-LF-PTC-USED             VALUE '1'.
  6061             20  CF-CDT-ACCESS-METHOD       PIC X.
  6062                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  6063                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  6064                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  6065             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  6066
  6067         16  CF-CLAIM-CALC-METHOD           PIC X.
  6068             88  360-PLUS-MONTHS                VALUE '1'.
  6069             88  365-PLUS-MONTHS                VALUE '2'.
  6070             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  6071             88  360-DAILY                      VALUE '4'.
  6072             88  365-DAILY                      VALUE '5'.
  6073
  6074         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6075         16  FILLER                         PIC X(11).
  6076
  6077         16  CF-LIMIT-AMOUNTS.
  6078             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6079             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6080             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6081             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6082             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6083             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6084             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6085             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6086             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6087             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6088
  6089         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6090         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6091         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6092
  6093         16  CF-ZIP-CODE.
  6094             20  CF-ZIP-PRIME.
  6095                 24  CF-ZIP-1ST             PIC X.
  6096                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6097                 24  FILLER                 PIC X(4).
  6098             20  CF-ZIP-PLUS4               PIC X(4).
  6099         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6100             20  CF-CAN-POSTAL-1            PIC XXX.
  6101             20  CF-CAN-POSTAL-2            PIC XXX.
  6102             20  FILLER                     PIC XXX.
  6103
  6104         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6105         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6106         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6107
  6108         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 113
* EL050.cbl
  6109             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6110             88  CF-NO-RATING                   VALUE 'N'.
  6111
  6112         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6113
  6114         16  CF-CARRIER-OVER-SHORT.
  6115             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6116             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6117
  6118         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6119         16  CF-SECPAY-SWITCH               PIC X.
  6120             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6121             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6122         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6123         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6124         16  FILLER                         PIC X(444).
  6125*        16  FILLER                         PIC X(452).
  6126
  6127
  6128****************************************************************
  6129*             MORTALITY MASTER RECORD                          *
  6130****************************************************************
  6131
  6132     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6133         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6134                                INDEXED BY CF-MORT-NDX.
  6135             20  CF-MORT-TABLE              PIC X(5).
  6136             20  CF-MORT-TABLE-TYPE         PIC X.
  6137                 88  CF-MORT-JOINT              VALUE 'J'.
  6138                 88  CF-MORT-SINGLE             VALUE 'S'.
  6139                 88  CF-MORT-COMBINED           VALUE 'C'.
  6140                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6141                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6142             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6143             20  CF-MORT-AGE-METHOD         PIC XX.
  6144                 88  CF-AGE-LAST                VALUE 'AL'.
  6145                 88  CF-AGE-NEAR                VALUE 'AN'.
  6146             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6147             20  CF-MORT-ADJUSTMENT-DIRECTION
  6148                                            PIC X.
  6149                 88  CF-MINUS                   VALUE '-'.
  6150                 88  CF-PLUS                    VALUE '+'.
  6151             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6152             20  CF-MORT-JOINT-CODE         PIC X.
  6153                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6154             20  CF-MORT-PC-Q               PIC X.
  6155                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6156             20  CF-MORT-TABLE-CODE         PIC X(4).
  6157             20  CF-MORT-COMMENTS           PIC X(15).
  6158             20  FILLER                     PIC X(14).
  6159
  6160         16  FILLER                         PIC X(251).
  6161
  6162
  6163****************************************************************
  6164*             BUSSINESS TYPE MASTER RECORD                     *
  6165****************************************************************
  6166
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 114
* EL050.cbl
  6167     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6168* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6169* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6170* AND RECORD 05 IS TYPES 81-99
  6171         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6172             20  CF-BUSINESS-TITLE          PIC  X(19).
  6173             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6174                                            PIC S9V9(4) COMP-3.
  6175             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6176             20  FILLER                     PIC  X.
  6177         16  FILLER                         PIC  X(248).
  6178
  6179
  6180****************************************************************
  6181*             TERMINAL MASTER RECORD                           *
  6182****************************************************************
  6183
  6184     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6185
  6186         16  CF-COMPANY-TERMINALS.
  6187             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6188                                  PIC X(4).
  6189         16  FILLER               PIC X(248).
  6190
  6191
  6192****************************************************************
  6193*             LIFE EDIT MASTER RECORD                          *
  6194****************************************************************
  6195
  6196     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6197         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6198             20  CF-LIFE-CODE-IN            PIC XX.
  6199             20  CF-LIFE-CODE-OUT           PIC XX.
  6200         16  FILLER                         PIC X(248).
  6201
  6202
  6203****************************************************************
  6204*             AH EDIT MASTER RECORD                            *
  6205****************************************************************
  6206
  6207     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6208         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6209             20  CF-AH-CODE-IN              PIC XXX.
  6210             20  CF-AH-CODE-OUT             PIC XX.
  6211         16  FILLER                         PIC X(248).
  6212
  6213
  6214****************************************************************
  6215*             CREDIBILITY TABLES                               *
  6216****************************************************************
  6217
  6218     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6219         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6220                             INDEXED BY CF-CRDB-NDX.
  6221             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6222             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6223             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6224         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 115
* EL050.cbl
  6225
  6226
  6227****************************************************************
  6228*             REPORT CUSTOMIZATION RECORD                      *
  6229****************************************************************
  6230
  6231     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6232         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6233             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6234             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6235             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6236**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6237****       A T-TRANSFER.                                   ****
  6238             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6239
  6240         16  FILLER                         PIC XX.
  6241
  6242         16  CF-CARRIER-CNTL-OPT.
  6243             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6244                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6245                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6246             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6247                                            PIC X.
  6248         16  CF-GROUP-CNTL-OPT.
  6249             20  CF-GROUP-OPT-SEQ           PIC 9.
  6250                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6251                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6252             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6253                                            PIC X(6).
  6254         16  CF-STATE-CNTL-OPT.
  6255             20  CF-STATE-OPT-SEQ           PIC 9.
  6256                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6257                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6258             20  CF-STATE-SELECT OCCURS 3 TIMES
  6259                                            PIC XX.
  6260         16  CF-ACCOUNT-CNTL-OPT.
  6261             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6262                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6263                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6264             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6265                                            PIC X(10).
  6266         16  CF-BUS-TYP-CNTL-OPT.
  6267             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6268                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6269                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6270             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6271                                            PIC XX.
  6272         16  CF-LF-TYP-CNTL-OPT.
  6273             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6274                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6275                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6276             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6277                                            PIC XX.
  6278         16  CF-AH-TYP-CNTL-OPT.
  6279             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6280                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6281                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6282             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 116
* EL050.cbl
  6283                                            PIC XX.
  6284         16  CF-REPTCD1-CNTL-OPT.
  6285             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6286                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6287                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6288             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6289                                            PIC X(10).
  6290         16  CF-REPTCD2-CNTL-OPT.
  6291             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6292                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6293                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6294             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6295                                            PIC X(10).
  6296         16  CF-USER1-CNTL-OPT.
  6297             20  CF-USER1-OPT-SEQ           PIC 9.
  6298                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6299                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6300             20  CF-USER1-SELECT OCCURS 3 TIMES
  6301                                            PIC X(10).
  6302         16  CF-USER2-CNTL-OPT.
  6303             20  CF-USER2-OPT-SEQ           PIC 9.
  6304                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6305                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6306             20  CF-USER2-SELECT OCCURS 3 TIMES
  6307                                            PIC X(10).
  6308         16  CF-USER3-CNTL-OPT.
  6309             20  CF-USER3-OPT-SEQ           PIC 9.
  6310                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6311                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6312             20  CF-USER3-SELECT OCCURS 3 TIMES
  6313                                            PIC X(10).
  6314         16  CF-USER4-CNTL-OPT.
  6315             20  CF-USER4-OPT-SEQ           PIC 9.
  6316                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6317                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6318             20  CF-USER4-SELECT OCCURS 3 TIMES
  6319                                            PIC X(10).
  6320         16  CF-USER5-CNTL-OPT.
  6321             20  CF-USER5-OPT-SEQ           PIC 9.
  6322                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6323                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6324             20  CF-USER5-SELECT OCCURS 3 TIMES
  6325                                            PIC X(10).
  6326         16  CF-REINS-CNTL-OPT.
  6327             20  CF-REINS-OPT-SEQ           PIC 9.
  6328                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6329                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6330             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6331                 24  CF-REINS-PRIME         PIC XXX.
  6332                 24  CF-REINS-SUB           PIC XXX.
  6333
  6334         16  CF-AGENT-CNTL-OPT.
  6335             20  CF-AGENT-OPT-SEQ           PIC 9.
  6336                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6337                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6338             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6339                                            PIC X(10).
  6340
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 117
* EL050.cbl
  6341         16  FILLER                         PIC X(43).
  6342
  6343         16  CF-LOSS-RATIO-SELECT.
  6344             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6345             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6346         16  CF-ENTRY-DATE-SELECT.
  6347             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6348             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6349         16  CF-EFFECTIVE-DATE-SELECT.
  6350             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6351             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6352
  6353         16  CF-EXCEPTION-LIST-IND          PIC X.
  6354             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6355
  6356         16  FILLER                         PIC X(318).
  6357
  6358****************************************************************
  6359*                  EXCEPTION REPORTING RECORD                  *
  6360****************************************************************
  6361
  6362     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6363         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6364             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6365
  6366         16  CF-COMBINED-LIFE-AH-OPT.
  6367             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6368             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6369             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6370             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6371
  6372         16  CF-LIFE-OPT.
  6373             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6374             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6375             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6376             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6377             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6378             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6379             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6380             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6381             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6382             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6383
  6384         16  CF-AH-OPT.
  6385             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6386             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6387             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6388             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6389             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6390             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6391             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6392             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6393             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6394             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6395
  6396         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6397             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6398             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 118
* EL050.cbl
  6399             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6400
  6401         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6402
  6403         16  FILLER                         PIC X(673).
  6404
  6405
  6406****************************************************************
  6407*             MORTGAGE SYSTEM PLAN RECORD                      *
  6408****************************************************************
  6409
  6410     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6411         16  CF-PLAN-TYPE                   PIC X.
  6412             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6413             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6414             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6415         16  CF-PLAN-ABBREV                 PIC XXX.
  6416         16  CF-PLAN-DESCRIPT               PIC X(10).
  6417         16  CF-PLAN-NOTES                  PIC X(20).
  6418         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6419         16  CF-PLAN-UNDERWRITING.
  6420             20  CF-PLAN-TERM-DATA.
  6421                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6422                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6423             20  CF-PLAN-AGE-DATA.
  6424                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6425                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6426                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6427             20  CF-PLAN-BENEFIT-DATA.
  6428                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6429                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6430                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6431                                            PIC S9(7)V99  COMP-3.
  6432         16  CF-PLAN-POLICY-FORMS.
  6433             20  CF-POLICY-FORM             PIC X(12).
  6434             20  CF-MASTER-APPLICATION      PIC X(12).
  6435             20  CF-MASTER-POLICY           PIC X(12).
  6436         16  CF-PLAN-RATING.
  6437             20  CF-RATE-CODE               PIC X(5).
  6438             20  CF-SEX-RATING              PIC X.
  6439                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6440                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6441             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6442             20  CF-SUB-STD-TYPE            PIC X.
  6443                 88  CF-PCT-OF-PREM            VALUE '1'.
  6444                 88  CF-PCT-OF-BENE            VALUE '2'.
  6445         16  CF-PLAN-PREM-TOLERANCES.
  6446             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6447             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6448         16  CF-PLAN-PYMT-TOLERANCES.
  6449             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6450             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6451         16  CF-PLAN-MISC-DATA.
  6452             20  FILLER                     PIC X.
  6453             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6454             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6455         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6456         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 119
* EL050.cbl
  6457             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6458                                                     '1'.
  6459             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6460                                                     '2'.
  6461         16  CF-MIB-SEARCH-SW               PIC X.
  6462             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6463             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6464             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6465             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6466         16  CF-ALPHA-SEARCH-SW             PIC X.
  6467             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6468             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6469             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6470             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6471             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6472             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6473             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6474             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6475             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6476             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6477                                                     'A' 'B' 'C'
  6478                                                     'X' 'Y' 'Z'.
  6479         16  CF-EFF-DT-RULE-SW              PIC X.
  6480             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6481             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6482             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6483             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6484             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6485         16  FILLER                         PIC X(4).
  6486         16  CF-HEALTH-QUESTIONS            PIC X.
  6487             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6488         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6489         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6490         16  CF-PLAN-SNGL-JNT               PIC X.
  6491             88  CF-COMBINED-PLAN              VALUE 'C'.
  6492             88  CF-JNT-PLAN                   VALUE 'J'.
  6493             88  CF-SNGL-PLAN                  VALUE 'S'.
  6494         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6495         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6496         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6497         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6498         16  CF-RERATE-CNTL                 PIC  X.
  6499             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6500             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6501             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6502             88  CF-AUTO-RECALC                 VALUE '4'.
  6503         16  CF-BENEFIT-TYPE                PIC  X.
  6504             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6505             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6506         16  CF-POLICY-FEE                  PIC S999V99
  6507                                                    COMP-3.
  6508         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6509         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6510         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6511         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6512         16  FILLER                         PIC  X(32).
  6513         16  CF-TERMINATION-FORM            PIC  X(04).
  6514         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 120
* EL050.cbl
  6515         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6516                                                       COMP-3.
  6517         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6518         16  CF-ISSUE-LETTER                PIC  X(4).
  6519         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6520         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6521             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6522             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6523         16  CF-MP-REFUND-CALC              PIC X.
  6524             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6525             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6526             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6527             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6528             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6529             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6530             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6531             88  CF-MP-REFD-MEAN                VALUE '8'.
  6532         16  CF-ALT-RATE-CODE               PIC  X(5).
  6533
  6534
  6535         16  FILLER                         PIC X(498).
  6536****************************************************************
  6537*             MORTGAGE COMPANY MASTER RECORD                   *
  6538****************************************************************
  6539
  6540     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6541         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6542         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6543             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6544             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6545             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6546             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6547             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6548
  6549         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6550         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6551         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6552         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6553         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6554
  6555         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6556             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6557         16  CF-MP-RECON-USE-IND            PIC X(1).
  6558             88  CF-MP-USE-RECON             VALUE 'Y'.
  6559         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6560             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6561         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6562             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6563             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6564         16  FILLER                         PIC X(1).
  6565         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6566             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6567         16  CF-MORTG-MIB-VERSION           PIC X.
  6568             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6569             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6570             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6571         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6572             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 121
* EL050.cbl
  6573                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6574             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6575                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6576             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6577                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6578             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6579                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6580             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6581                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6582             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6583                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6584         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6585         16  FILLER                         PIC X(7).
  6586         16  CF-MORTG-DESTINATION-SYMBOL.
  6587             20  CF-MORTG-MIB-COMM          PIC X(5).
  6588             20  CF-MORTG-MIB-TERM          PIC X(5).
  6589         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6590             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6591         16  FILLER                         PIC X(03).
  6592         16  CF-MP-CHECK-NO-CONTROL.
  6593             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6594                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6595                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6596                                                ' ' LOW-VALUES.
  6597                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6598                                               VALUE '3'.
  6599         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6600         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6601         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6602             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6603                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6604             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6605                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6606             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6607                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6608             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6609                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6610             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6611                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6612             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6613                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6614         16  CF-MORTG-BILLING-AREA.
  6615             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6616                                            PIC X.
  6617         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6618         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6619         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6620         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6621             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6622             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6623         16  FILLER                         PIC X.
  6624         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6625             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6626             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6627         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6628         16  FILLER                         PIC X(8).
  6629         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6630         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 122
* EL050.cbl
  6631         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6632         16  CF-ACH-COMPANY-ID.
  6633             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6634                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6635                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6636                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6637             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6638         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6639             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6640         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6641             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6642             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6643         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6644         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6645         16  FILLER                         PIC X(536).
  6646
  6647****************************************************************
  6648*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6649****************************************************************
  6650
  6651     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6652         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6653             20  CF-FEMALE-HEIGHT.
  6654                 24  CF-FEMALE-FT           PIC 99.
  6655                 24  CF-FEMALE-IN           PIC 99.
  6656             20  CF-FEMALE-MIN-WT           PIC 999.
  6657             20  CF-FEMALE-MAX-WT           PIC 999.
  6658         16  FILLER                         PIC X(428).
  6659
  6660     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6661         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6662             20  CF-MALE-HEIGHT.
  6663                 24  CF-MALE-FT             PIC 99.
  6664                 24  CF-MALE-IN             PIC 99.
  6665             20  CF-MALE-MIN-WT             PIC 999.
  6666             20  CF-MALE-MAX-WT             PIC 999.
  6667         16  FILLER                         PIC X(428).
  6668******************************************************************
  6669*             AUTOMATIC ACTIVITY RECORD                          *
  6670******************************************************************
  6671     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6672         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6673             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6674             20  CF-SYS-LETTER-ID           PIC X(04).
  6675             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6676             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6677             20  CF-SYS-RESET-SW            PIC X(01).
  6678             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6679             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6680
  6681         16  FILLER                         PIC X(50).
  6682
  6683         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6684             20  CF-USER-ACTIVE-SW          PIC X(01).
  6685             20  CF-USER-LETTER-ID          PIC X(04).
  6686             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6687             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6688             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 123
* EL050.cbl
  6689             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6690             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6691             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6692
  6693         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 124
* EL050.cbl
  6695*    COPY ERCACCT.
  6696******************************************************************
  6697*                                                                *
  6698*                                                                *
  6699*                            ERCACCT                             *
  6700*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6701*                            VMOD=2.031                          *
  6702*                                                                *
  6703*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6704*                                                                *
  6705*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6706*   VSAM ACCOUNT MASTER FILES.                                   *
  6707*                                                                *
  6708*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6709*                                                                *
  6710*   FILE TYPE = VSAM,KSDS                                        *
  6711*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6712*                                                                *
  6713*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6714*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6715*                                                                *
  6716*   LOG = NO                                                     *
  6717*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6718*                                                                *
  6719*                                                                *
  6720******************************************************************
  6721*                   C H A N G E   L O G
  6722*
  6723* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6724*-----------------------------------------------------------------
  6725*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6726* EFFECTIVE    NUMBER
  6727*-----------------------------------------------------------------
  6728* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6729* 092705    2005050300006  PEMA  ADD SPP LEASES
  6730* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6731* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6732* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6733* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6734* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6735* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6736******************************************************************
  6737
  6738 01  ACCOUNT-MASTER.
  6739     12  AM-RECORD-ID                      PIC XX.
  6740         88  VALID-AM-ID                      VALUE 'AM'.
  6741
  6742     12  AM-CONTROL-PRIMARY.
  6743         16  AM-COMPANY-CD                 PIC X.
  6744         16  AM-MSTR-CNTRL.
  6745             20  AM-CONTROL-A.
  6746                 24  AM-CARRIER            PIC X.
  6747                 24  AM-GROUPING.
  6748                     28 AM-GROUPING-PREFIX PIC XXX.
  6749                     28 AM-GROUPING-PRIME  PIC XXX.
  6750                 24  AM-STATE              PIC XX.
  6751                 24  AM-ACCOUNT.
  6752                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 125
* EL050.cbl
  6753                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6754             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6755                                           PIC X(19).
  6756             20  AM-CNTRL-B.
  6757                 24  AM-EXPIRATION-DT      PIC XX.
  6758                 24  FILLER                PIC X(4).
  6759             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6760                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6761
  6762     12  AM-CONTROL-BY-VAR-GRP.
  6763         16  AM-COMPANY-CD-A1              PIC X.
  6764         16  AM-VG-CARRIER                 PIC X.
  6765         16  AM-VG-GROUPING                PIC X(6).
  6766         16  AM-VG-STATE                   PIC XX.
  6767         16  AM-VG-ACCOUNT                 PIC X(10).
  6768         16  AM-VG-DATE.
  6769             20  AM-VG-EXPIRATION-DT       PIC XX.
  6770             20  FILLER                    PIC X(4).
  6771         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6772                                           PIC 9(11)      COMP-3.
  6773     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6774         16  FILLER                        PIC X(10).
  6775         16  AM-VG-KEY3.
  6776             20  AM-VG3-ACCOUNT            PIC X(10).
  6777             20  AM-VG3-EXP-DT             PIC XX.
  6778         16  FILLER                        PIC X(4).
  6779     12  AM-MAINT-INFORMATION.
  6780         16  AM-LAST-MAINT-DT              PIC XX.
  6781         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6782         16  AM-LAST-MAINT-USER            PIC X(4).
  6783         16  FILLER                        PIC XX.
  6784
  6785     12  AM-EFFECTIVE-DT                   PIC XX.
  6786     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6787
  6788     12  AM-PREV-DATES  COMP-3.
  6789         16  AM-PREV-EXP-DT                PIC 9(11).
  6790         16  AM-PREV-EFF-DT                PIC 9(11).
  6791
  6792     12  AM-REPORT-CODE-1                  PIC X(10).
  6793     12  AM-REPORT-CODE-2                  PIC X(10).
  6794
  6795     12  AM-CITY-CODE                      PIC X(4).
  6796     12  AM-COUNTY-PARISH                  PIC X(6).
  6797
  6798     12  AM-NAME                           PIC X(30).
  6799     12  AM-PERSON                         PIC X(30).
  6800     12  AM-ADDRS                          PIC X(30).
  6801     12  AM-CITY.
  6802         16  AM-ADDR-CITY                  PIC X(28).
  6803         16  AM-ADDR-STATE                 PIC XX.
  6804     12  AM-ZIP.
  6805         16  AM-ZIP-PRIME.
  6806             20  AM-ZIP-PRI-1ST            PIC X.
  6807                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6808             20  FILLER                    PIC X(4).
  6809         16  AM-ZIP-PLUS4                  PIC X(4).
  6810     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 126
* EL050.cbl
  6811         16  AM-CAN-POSTAL-1               PIC XXX.
  6812         16  AM-CAN-POSTAL-2               PIC XXX.
  6813         16  FILLER                        PIC XXX.
  6814     12  AM-TEL-NO.
  6815         16  AM-AREA-CODE                  PIC 999.
  6816         16  AM-TEL-PRE                    PIC 999.
  6817         16  AM-TEL-NBR                    PIC 9(4).
  6818     12  AM-TEL-LOC                        PIC X.
  6819         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6820         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6821
  6822     12  AM-COMM-STRUCTURE.
  6823         16  AM-DEFN-1.
  6824             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6825                 24  AM-AGT.
  6826                     28  AM-AGT-PREFIX     PIC X(4).
  6827                     28  AM-AGT-PRIME      PIC X(6).
  6828                 24  AM-COM-TYP            PIC X.
  6829                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6830                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6831                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6832                 24  AM-RECALC-LV-INDIC    PIC X.
  6833                 24  AM-RETRO-LV-INDIC     PIC X.
  6834                 24  AM-GL-CODES           PIC X.
  6835                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6836                 24  FILLER                PIC X(01).
  6837         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6838             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6839                 24  FILLER                PIC X(11).
  6840                 24  AM-L-COMA             PIC XXX.
  6841                 24  AM-J-COMA             PIC XXX.
  6842                 24  AM-A-COMA             PIC XXX.
  6843                 24  FILLER                PIC X(6).
  6844
  6845     12  AM-COMM-CHANGE-STATUS             PIC X.
  6846         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6847
  6848     12  AM-CSR-CODE                       PIC X(4).
  6849
  6850     12  AM-BILLING-STATUS                 PIC X.
  6851         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6852         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6853     12  AM-AUTO-REFUND-SW                 PIC X.
  6854         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6855         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6856     12  AM-GPCD                           PIC 99.
  6857     12  AM-IG                             PIC X.
  6858         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6859         88  AM-HAS-GROUP                     VALUE '2'.
  6860     12  AM-STATUS                         PIC X.
  6861         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6862         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6863         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6864         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6865         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6866         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6867         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6868         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 127
* EL050.cbl
  6869         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6870         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6871     12  AM-REMIT-TO                       PIC 99.
  6872     12  AM-ID-NO                          PIC X(11).
  6873
  6874     12  AM-CAL-TABLE                      PIC XX.
  6875     12  AM-LF-DEVIATION                   PIC XXX.
  6876     12  AM-AH-DEVIATION                   PIC XXX.
  6877     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6878     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6879     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6880     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6881     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6882     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6883
  6884     12  AM-USER-FIELDS.
  6885         16  AM-FLD-1                      PIC XX.
  6886         16  AM-FLD-2                      PIC XX.
  6887         16  AM-FLD-3                      PIC XX.
  6888         16  AM-FLD-4                      PIC XX.
  6889         16  AM-FLD-5                      PIC XX.
  6890
  6891     12  AM-1ST-PROD-DATE.
  6892         16  AM-1ST-PROD-YR                PIC XX.
  6893         16  AM-1ST-PROD-MO                PIC XX.
  6894         16  AM-1ST-PROD-DA                PIC XX.
  6895     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6896     12  AM-CERTS-PURGED-DATE.
  6897         16  AM-PUR-YR                     PIC XX.
  6898         16  AM-PUR-MO                     PIC XX.
  6899         16  AM-PUR-DA                     PIC XX.
  6900     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6901     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6902     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6903     12  AM-INACTIVE-DATE.
  6904         16  AM-INA-MO                     PIC 99.
  6905         16  AM-INA-DA                     PIC 99.
  6906         16  AM-INA-YR                     PIC 99.
  6907     12  AM-AR-HI-CERT-DATE                PIC XX.
  6908
  6909     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6910     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6911
  6912     12  AM-OB-PAYMENT-MODE                PIC X.
  6913         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6914         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6915         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6916         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6917
  6918     12  AM-AH-ONLY-INDICATOR              PIC X.
  6919         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6920         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6921
  6922     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6923
  6924     12  AM-OVER-SHORT.
  6925         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6926         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 128
* EL050.cbl
  6927
  6928     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6929     12  AM-DCC-CLP-STATE                  PIC XX.
  6930
  6931     12  AM-RECALC-COMM                    PIC X.
  6932     12  AM-RECALC-REIN                    PIC X.
  6933
  6934     12  AM-REI-TABLE                      PIC XXX.
  6935     12  AM-REI-ET-LF                      PIC X.
  6936     12  AM-REI-ET-AH                      PIC X.
  6937     12  AM-REI-PE-LF                      PIC X.
  6938     12  AM-REI-PE-AH                      PIC X.
  6939     12  AM-REI-PRT-ST                     PIC X.
  6940     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6941     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6942     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6943     12  AM-REI-GROUP-A                    PIC X(6).
  6944     12  AM-REI-MORT                       PIC X(4).
  6945     12  AM-REI-PRT-OW                     PIC X.
  6946     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6947     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6948     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6949     12  AM-REI-GROUP-B                    PIC X(6).
  6950
  6951     12  AM-TRUST-TYPE                     PIC X(2).
  6952
  6953     12  AM-EMPLOYER-STMT-USED             PIC X.
  6954     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6955
  6956     12  AM-STD-AH-TYPE                    PIC XX.
  6957     12  AM-EARN-METHODS.
  6958         16  AM-EARN-METHOD-R              PIC X.
  6959             88 AM-REF-RL-R78                 VALUE 'R'.
  6960             88 AM-REF-RL-PR                  VALUE 'P'.
  6961             88 AM-REF-RL-MEAN                VALUE 'M'.
  6962             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6963         16  AM-EARN-METHOD-L              PIC X.
  6964             88 AM-REF-LL-R78                 VALUE 'R'.
  6965             88 AM-REF-LL-PR                  VALUE 'P'.
  6966             88 AM-REF-LL-MEAN                VALUE 'M'.
  6967             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6968         16  AM-EARN-METHOD-A              PIC X.
  6969             88 AM-REF-AH-R78                 VALUE 'R'.
  6970             88 AM-REF-AH-PR                  VALUE 'P'.
  6971             88 AM-REF-AH-MEAN                VALUE 'M'.
  6972             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6973             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6974             88 AM-REF-AH-NET                 VALUE 'N'.
  6975
  6976     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6977     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6978     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6979
  6980     12  AM-RET-Y-N                        PIC X.
  6981     12  AM-RET-P-E                        PIC X.
  6982     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6983     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6984     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 129
* EL050.cbl
  6985     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6986         16  AM-POOL-PRIME                 PIC XXX.
  6987         16  AM-POOL-SUB                   PIC XXX.
  6988     12  AM-RETRO-EARNINGS.
  6989         16  AM-RET-EARN-R                 PIC X.
  6990         16  AM-RET-EARN-L                 PIC X.
  6991         16  AM-RET-EARN-A                 PIC X.
  6992     12  AM-RET-ST-TAX-USE                 PIC X.
  6993         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6994         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6995     12  AM-RETRO-BEG-EARNINGS.
  6996         16  AM-RET-BEG-EARN-R             PIC X.
  6997         16  AM-RET-BEG-EARN-L             PIC X.
  6998         16  AM-RET-BEG-EARN-A             PIC X.
  6999     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  7000     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  7001
  7002     12  AM-USER-SELECT-OPTIONS.
  7003         16  AM-USER-SELECT-1              PIC X(10).
  7004         16  AM-USER-SELECT-2              PIC X(10).
  7005         16  AM-USER-SELECT-3              PIC X(10).
  7006         16  AM-USER-SELECT-4              PIC X(10).
  7007         16  AM-USER-SELECT-5              PIC X(10).
  7008
  7009     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  7010
  7011     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  7012
  7013     12  AM-RPT045A-SWITCH                 PIC X.
  7014         88  RPT045A-OFF                   VALUE 'N'.
  7015
  7016     12  AM-INSURANCE-LIMITS.
  7017         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  7018         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  7019
  7020     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  7021         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  7022
  7023     12  AM-DISMBR-COVERAGE-SW             PIC X.
  7024         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  7025         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  7026
  7027     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  7028
  7029     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  7030     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  7031     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  7032     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  7033     12  AM-DCC-UEF-STATE                  PIC XX.
  7034     12  FILLER                            PIC XXX.
  7035     12  AM-REPORT-CODE-3                  PIC X(10).
  7036*    12  FILLER                            PIC X(22).
  7037
  7038     12  AM-RESERVE-DATE.
  7039         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  7040         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  7041         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  7042
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 130
* EL050.cbl
  7043     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  7044     12  AM-NOTIFICATION-TYPES.
  7045         16  AM-NOTIF-OF-LETTERS           PIC X.
  7046         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  7047         16  AM-NOTIF-OF-REPORTS           PIC X.
  7048         16  AM-NOTIF-OF-STATUS            PIC X.
  7049
  7050     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  7051         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  7052         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  7053         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  7054         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  7055
  7056     12  AM-BENEFIT-CONTROLS.
  7057         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  7058             20  AM-BENEFIT-CODE           PIC XX.
  7059             20  AM-BENEFIT-TYPE           PIC X.
  7060             20  AM-BENEFIT-REVISION       PIC XXX.
  7061             20  AM-BENEFIT-REM-TERM       PIC X.
  7062             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  7063             20  FILLER                    PIC XX.
  7064         16  FILLER                        PIC X(80).
  7065
  7066     12  AM-TRANSFER-DATA.
  7067         16  AM-TRANSFERRED-FROM.
  7068             20  AM-TRNFROM-CARRIER        PIC X.
  7069             20  AM-TRNFROM-GROUPING.
  7070                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  7071                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  7072             20  AM-TRNFROM-STATE          PIC XX.
  7073             20  AM-TRNFROM-ACCOUNT.
  7074                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  7075                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  7076             20  AM-TRNFROM-DTE            PIC XX.
  7077         16  AM-TRANSFERRED-TO.
  7078             20  AM-TRNTO-CARRIER          PIC X.
  7079             20  AM-TRNTO-GROUPING.
  7080                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  7081                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  7082             20  AM-TRNTO-STATE            PIC XX.
  7083             20  AM-TRNTO-ACCOUNT.
  7084                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  7085                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  7086             20  AM-TRNTO-DTE              PIC XX.
  7087         16  FILLER                        PIC X(10).
  7088
  7089     12  AM-SAVED-REMIT-TO                 PIC 99.
  7090
  7091     12  AM-COMM-STRUCTURE-SAVED.
  7092         16  AM-DEFN-1-SAVED.
  7093             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  7094                 24  AM-AGT-SV             PIC X(10).
  7095                 24  AM-COM-TYP-SV         PIC X.
  7096                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7097                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7098                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7099                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7100                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 131
* EL050.cbl
  7101                 24  AM-GL-CODES-SV        PIC X.
  7102                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7103                 24  FILLER                PIC X.
  7104         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7105             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7106                 24  FILLER                PIC X(11).
  7107                 24  AM-L-COMA-SV          PIC XXX.
  7108                 24  AM-J-COMA-SV          PIC XXX.
  7109                 24  AM-A-COMA-SV          PIC XXX.
  7110                 24  FILLER                PIC X(6).
  7111
  7112     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7113         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7114            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7115            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7116            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7117
  7118     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7119     12  FILLER                            PIC X(120).
  7120
  7121     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7122         16  AM-CONTROL-NAME               PIC X(30).
  7123         16  AM-EXECUTIVE-ONE.
  7124             20  AM-EXEC1-NAME             PIC X(15).
  7125             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7126                                                          COMP-3.
  7127             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7128                                                          COMP-3.
  7129         16  AM-EXECUTIVE-TWO.
  7130             20  AM-EXEC2-NAME             PIC X(15).
  7131             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7132                                                          COMP-3.
  7133             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7134                                                          COMP-3.
  7135
  7136     12  AM-RETRO-ADDITIONAL-DATA.
  7137         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7138         16  AM-RETRO-PREM-P-E             PIC X.
  7139         16  AM-RETRO-CLMS-P-I             PIC X.
  7140         16  AM-RETRO-RET-BRACKET-LF.
  7141             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7142                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7143                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7144             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7145                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7146                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7147             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7148                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7149                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7150         16  AM-RETRO-RET-BRACKET-AH.
  7151             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7152                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7153                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7154                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7155             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7156                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7157                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7158             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 132
* EL050.cbl
  7159                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7160                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7161
  7162     12  AM-COMMENTS.
  7163         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7164
  7165     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7166         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7167         16  AM-FLI-BILLING-CODE           PIC X.
  7168         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7169         16  AM-FLI-UNITED-IDENT           PIC X.
  7170         16  AM-FLI-INTEREST-LOST-DATA.
  7171             20  AM-FLI-BANK-NO            PIC X(5).
  7172             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7173             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7174             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7175         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7176             20  AM-FLI-AGT                PIC X(9).
  7177             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7178             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7179         16  FILLER                        PIC X(102).
  7180
  7181     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7182         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7183             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7184             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7185             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7186             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7187             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7188         16  FILLER                          PIC X(10).
  7189******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 133
* EL050.cbl
  7191*    COPY ERCREIN.
  7192******************************************************************
  7193*                                                                *
  7194*                            ERCREIN                             *
  7195*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7196*                            VMOD=2.010                          *
  7197*                                                                *
  7198*   ONLINE CREDIT SYSTEM                                         *
  7199*                                                                *
  7200*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7201*                                                                *
  7202*   FILE TYPE = VSAM,KSDS                                        *
  7203*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7204*                                                                *
  7205*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7206*       ALTERNATE PATH = NONE                                    *
  7207*                                                                *
  7208*   LOG = NO                                                     *
  7209*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7210*                                                                *
  7211******************************************************************
  7212*                   C H A N G E   L O G
  7213*
  7214* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7215*-----------------------------------------------------------------
  7216*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7217* EFFECTIVE    NUMBER
  7218*-----------------------------------------------------------------
  7219* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7220* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7221******************************************************************
  7222 01  REINSURANCE-RECORD.
  7223     12  RE-RECORD-ID                      PIC XX.
  7224         88  VALID-RE-ID                      VALUE 'RE'.
  7225
  7226     12  RE-CONTROL-PRIMARY.
  7227         16  RE-COMPANY-CD                 PIC X.
  7228         16  RE-KEY.
  7229             20  RE-CODE                   PIC X.
  7230                 88  RE-TABLE-RECORD          VALUE 'A'.
  7231                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7232             20  RE-TABLE                  PIC XXX.
  7233             20  FILLER                    PIC XXX.
  7234         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7235             20  FILLER                    PIC X.
  7236             20  RE-COMPANY.
  7237                 24  RE-COMP-PRIME         PIC XXX.
  7238                 24  RE-COMP-SUB           PIC XXX.
  7239
  7240     12  RE-MAINT-INFORMATION.
  7241         16  RE-LAST-MAINT-DT              PIC XX.
  7242         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7243         16  RE-LAST-MAINT-USER            PIC X(4).
  7244         16  FILLER                        PIC X(10).
  7245
  7246     12  RE-TABLE-DATA.
  7247         16  RE-100-COMP                   PIC 99.
  7248
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 134
* EL050.cbl
  7249         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7250             20  RE-REI-COMP-NO.
  7251                 24  RE-REI-COMP           PIC XXX.
  7252                 24  RE-REI-COMP-SUB       PIC XXX.
  7253             20  RE-LF-QC                  PIC X.
  7254             20  RE-AH-QC                  PIC X.
  7255             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7256             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7257             20  RE-LFAGE-LO               PIC 99.
  7258             20  RE-LFAGE-HI               PIC 99.
  7259             20  RE-AHAGE-LO               PIC 99.
  7260             20  RE-AHAGE-HI               PIC 99.
  7261             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7262             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7263             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7264             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7265             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7266             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7267             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7268             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7269             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7270             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7271             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7272             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7273             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7274             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7275             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7276             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7277             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7278             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7279             20  RE-LF-BEN-CODE            PIC X.
  7280             20  RE-AH-BEN-CODE            PIC X.
  7281             20  RE-INTERACTIVE            PIC X.
  7282             20  RE-REMAINING              PIC X.
  7283             20  RE-LF-RUNOFF-SW           PIC X.
  7284             20  RE-AH-RUNOFF-SW           PIC X.
  7285             20  FILLER                    PIC X(19).
  7286
  7287         16  RE-COMP-INFO-END              PIC X(6).
  7288         16  RE-NSP-ST-CD-LF               PIC XX.
  7289         16  RE-NSP-ST-CD-AH               PIC XX.
  7290         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7291             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7292
  7293         16  FILLER                        PIC X(27).
  7294
  7295     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7296         16  RE-NAME                       PIC X(30).
  7297         16  RE-LF-PE                      PIC X.
  7298         16  RE-AH-PE                      PIC X.
  7299         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7300         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7301         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7302         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7303         16  RE-PRT-ST                     PIC X.
  7304         16  RE-PRT-OW                     PIC X.
  7305         16  RE-MORT-CODE                  PIC X(4).
  7306         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 135
* EL050.cbl
  7307         16  RE-ZERO-LF-FEE                PIC X.
  7308         16  RE-ZERO-AH-FEE                PIC X.
  7309         16  RE-CEDE-NAME                  PIC X(30).
  7310         16  RE-LF-COMM                    PIC X.
  7311         16  RE-AH-COMM                    PIC X.
  7312         16  RE-LF-TAX                     PIC X.
  7313         16  RE-AH-TAX                     PIC X.
  7314         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7315         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7316         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7317
  7318         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7319             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7320
  7321         16  RE-LF-CEDING-FEE-BRACKETS.
  7322             20  RE-LF-FEE-METHOD          PIC X.
  7323                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7324                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7325                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7326                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7327             20  RE-LF-FEE-BASIS           PIC X.
  7328                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7329                 88  RE-LF-NET-CEDED               VALUE '2'.
  7330                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7331                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7332                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7333                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7334                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7335                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7336             20  FILLER                    PIC XXX.
  7337             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7338                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7339                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7340
  7341         16  RE-AH-CEDING-FEE-BRACKETS.
  7342             20  RE-AH-FEE-METHOD          PIC X.
  7343                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7344                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7345                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7346                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7347             20  RE-AH-FEE-BASIS           PIC X.
  7348                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7349                 88  RE-AH-NET-CEDED               VALUE '2'.
  7350                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7351                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7352                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7353                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7354                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7355                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7356             20  FILLER                    PIC XXX.
  7357             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7358                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7359                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7360
  7361         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7362
  7363         16  RE-OLD-CEDING-STMT            PIC X.
  7364
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 136
* EL050.cbl
  7365         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7366         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7367         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7368         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7369         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7370         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7371         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7372         16  RE-MORT-SW                    PIC X.
  7373         16  RE-CEDING-TYPE-FLAG           PIC X.
  7374             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7375             88  RE-CEDED                          VALUE 'C'.
  7376             88  RE-ASSUMED                        VALUE 'A'.
  7377             88  RE-PHANTOM                        VALUE 'P'.
  7378
  7379         16  RE-CEDING-STMT-OPT-A          PIC X.
  7380             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7381         16  RE-CEDING-STMT-OPT-B          PIC X.
  7382             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7383         16  RE-CEDING-STMT-OPT-C          PIC X.
  7384             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7385         16  RE-CEDING-STMT-OPT-D          PIC X.
  7386             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7387         16  RE-CEDING-STMT-OPT-E          PIC X.
  7388             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7389
  7390         16  RE-PRT-CRSV                   PIC X.
  7391
  7392         16  RE-GL-CENTER                  PIC X(4).
  7393
  7394         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7395
  7396         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7397
  7398         16  RE-EARN-STOP-CODE             PIC X.
  7399             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7400             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7401
  7402         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7403             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7404
  7405         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7406         16  FILLER                        PIC X(2281).
  7407
  7408         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7409
  7410******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 137
* EL050.cbl
  7412*    COPY ERCCTBL.
  7413******************************************************************
  7414*                                                                *
  7415*                                                                *
  7416*                            ERCCTBL                             *
  7417*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7418*                            VMOD=2.003
  7419*                                                                *
  7420*   ONLINE CREDIT SYSTEM                                         *
  7421*                                                                *
  7422*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7423*                                                                *
  7424*   FILE TYPE = VSAM,KSDS                                        *
  7425*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7426*                                                                *
  7427*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7428*       ALTERNATE PATH = NONE                                    *
  7429*                                                                *
  7430*   LOG = NO                                                     *
  7431*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7432*                                                                *
  7433*                                                                *
  7434******************************************************************
  7435
  7436 01  COMM-TABLE-RECORD.
  7437     12  CT-RECORD-ID                      PIC XX.
  7438         88  VALID-CT-ID                      VALUE 'CT'.
  7439
  7440     12  CT-CONTROL-PRIMARY.
  7441         16  CT-COMPANY-CD                 PIC X.
  7442         16  CT-TABLE                      PIC XXX.
  7443         16  CT-CNTRL-2.
  7444             20  CT-BEN-TYPE               PIC X.
  7445             20  CT-BEN-CODE               PIC XX.
  7446
  7447     12  CT-MAINT-INFORMATION.
  7448         16  CT-LAST-MAINT-DT              PIC XX.
  7449         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7450         16  CT-LAST-MAINT-USER            PIC X(4).
  7451         16  FILLER                        PIC X(31).
  7452
  7453     12  CT-LIMITS.
  7454         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7455
  7456         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7457
  7458         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7459
  7460     12  CT-RATES.
  7461         16  CT-RTX          OCCURS 27 TIMES.
  7462             20  CT-RT                     PIC SV9(5)     COMP-3.
  7463             20  CT-RT-R   REDEFINES
  7464                 CT-RT                     PIC XXX.
  7465
  7466     12  FILLER                            PIC  X(42).
  7467
  7468******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 138
* EL050.cbl
  7470*    COPY ERCFORM.
  7471******************************************************************
  7472*                                                                *
  7473*                                                                *
  7474*                            ERCFORM.                            *
  7475*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7476*                            VMOD=2.003                          *
  7477*                                                                *
  7478*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7479*                                                                *
  7480*    FILE TYPE = VSAM,KSDS                                       *
  7481*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7482*                                                                *
  7483*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7484*                                                                *
  7485*    LOG = YES                                                   *
  7486*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7487******************************************************************
  7488 01  FORM-MASTER.
  7489    12  FO-RECORD-ID                 PIC X(02).
  7490        88  VALID-FO-ID                  VALUE 'FO'.
  7491
  7492    12  FO-CONTROL-PRIMARY.
  7493        16  FO-COMPANY-CD            PIC X(01).
  7494        16  FO-STATE                 PIC X(02).
  7495        16  FO-FORM-ID               PIC X(12).
  7496        16  FO-FORM-EXP-DT           PIC X(02).
  7497
  7498    12  FO-POLICY-FORM-DATA.
  7499        16  FO-IND-GRP-CD            PIC X(01).
  7500        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7501        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7502        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7503        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7504        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7505        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7506        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7507        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7508        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7509        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7510        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7511        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7512        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7513        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7514        16  FO-APP-CERT-USE-CD       PIC X(01).
  7515
  7516    12  FILLER                       PIC X(29).
  7517
  7518    12  FO-FORM-PLAN-TABLE.
  7519        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7520            20  FO-PLAN-TYPE         PIC X(01).
  7521            20  FO-PLAN-ID           PIC X(02).
  7522            20  FO-PLAN-TERM         PIC 9(03).
  7523            20  FO-PLAN-REFUND-METHOD
  7524                                     PIC X.
  7525
  7526    12  FILLER                       PIC X(30).
  7527
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 139
* EL050.cbl
  7528    12  FO-COMMENTS-AREA.
  7529        16  FO-COMMENT-LINE-1        PIC X(78).
  7530
  7531    12  FILLER                       PIC X(20).
  7532
  7533    12  FO-MAINT-INFORMATION.
  7534        16  FO-LAST-MAINT-DT         PIC X(02).
  7535        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7536        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 140
* EL050.cbl
  7538*    COPY ELCMSTR.
  7539******************************************************************
  7540*                                                                *
  7541*                            ELCMSTR.                            *
  7542*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7543*                            VMOD=2.012                          *
  7544*                                                                *
  7545*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7546*                                                                *
  7547*   FILE TYPE = VSAM,KSDS                                        *
  7548*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7549*                                                                *
  7550*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7551*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7552*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7553*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7554*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7555*                                                 RKP=75,LEN=21  *
  7556*                                                                *
  7557*   **** NOTE ****                                               *
  7558*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7559*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7560*                                                                *
  7561*   LOG = YES                                                    *
  7562*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7563******************************************************************
  7564*                   C H A N G E   L O G
  7565*
  7566* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7567*-----------------------------------------------------------------
  7568*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7569* EFFECTIVE    NUMBER
  7570*-----------------------------------------------------------------
  7571* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7572* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7573* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7574* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7575* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7576* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7577* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7578******************************************************************
  7579 01  CLAIM-MASTER.
  7580     12  CL-RECORD-ID                PIC XX.
  7581         88  VALID-CL-ID         VALUE 'CL'.
  7582
  7583     12  CL-CONTROL-PRIMARY.
  7584         16  CL-COMPANY-CD           PIC X.
  7585         16  CL-CARRIER              PIC X.
  7586         16  CL-CLAIM-NO             PIC X(7).
  7587         16  CL-CERT-NO.
  7588             20  CL-CERT-PRIME       PIC X(10).
  7589             20  CL-CERT-SFX         PIC X.
  7590
  7591     12  CL-CONTROL-BY-NAME.
  7592         16  CL-COMPANY-CD-A1        PIC X.
  7593         16  CL-INSURED-LAST-NAME    PIC X(15).
  7594         16  CL-INSURED-NAME.
  7595             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 141
* EL050.cbl
  7596             20  CL-INSURED-MID-INIT PIC X.
  7597
  7598     12  CL-CONTROL-BY-SSN.
  7599         16  CL-COMPANY-CD-A2        PIC X.
  7600         16  CL-SOC-SEC-NO.
  7601             20  CL-SSN-STATE        PIC XX.
  7602             20  CL-SSN-ACCOUNT      PIC X(6).
  7603             20  CL-SSN-LN3          PIC X(3).
  7604
  7605     12  CL-CONTROL-BY-CERT-NO.
  7606         16  CL-COMPANY-CD-A4        PIC X.
  7607         16  CL-CERT-NO-A4.
  7608             20  CL-CERT-A4-PRIME    PIC X(10).
  7609             20  CL-CERT-A4-SFX      PIC X.
  7610
  7611     12  CL-CONTROL-BY-CCN.
  7612         16  CL-COMPANY-CD-A5        PIC X.
  7613         16  CL-CCN-A5.
  7614             20  CL-CCN.
  7615                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7616                 24  CL-CCN-PRIME-A5 PIC X(12).
  7617             20  CL-CCN-FILLER-A5    PIC X(4).
  7618
  7619     12  CL-INSURED-PROFILE-DATA.
  7620         16  CL-INSURED-BIRTH-DT     PIC XX.
  7621         16  CL-INSURED-SEX-CD       PIC X.
  7622             88  INSURED-IS-MALE        VALUE 'M'.
  7623             88  INSURED-IS-FEMALE      VALUE 'F'.
  7624             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7625         16  CL-INSURED-OCC-CD       PIC X(6).
  7626         16  FILLER                  PIC X(5).
  7627
  7628     12  CL-PROCESSING-INFO.
  7629         16  CL-PROCESSOR-ID         PIC X(4).
  7630         16  CL-CLAIM-STATUS         PIC X.
  7631             88  CLAIM-IS-OPEN          VALUE 'O'.
  7632             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7633         16  CL-CLAIM-TYPE           PIC X.
  7634*            88  AH-CLAIM               VALUE 'A'.
  7635*            88  LIFE-CLAIM             VALUE 'L'.
  7636*            88  PROPERTY-CLAIM         VALUE 'P'.
  7637*            88  IUI-CLAIM              VALUE 'I'.
  7638*            88  GAP-CLAIM              VALUE 'G'.
  7639*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7640*            88  OTHER-CLAIM            VALUE 'O'.
  7641         16  CL-CLAIM-PREM-TYPE      PIC X.
  7642             88  SINGLE-PREMIUM         VALUE '1'.
  7643             88  O-B-COVERAGE           VALUE '2'.
  7644             88  OPEN-END-COVERAGE      VALUE '3'.
  7645         16  CL-INCURRED-DT          PIC XX.
  7646         16  CL-REPORTED-DT          PIC XX.
  7647         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7648         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7649         16  CL-LAST-PMT-DT          PIC XX.
  7650         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7651         16  CL-PAID-THRU-DT         PIC XX.
  7652         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7653         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 142
* EL050.cbl
  7654         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7655         16  CL-PMT-CALC-METHOD      PIC X.
  7656             88  CL-360-DAY-YR          VALUE '1'.
  7657             88  CL-365-DAY-YR          VALUE '2'.
  7658             88  CL-FULL-MONTHS         VALUE '3'.
  7659         16  CL-CAUSE-CD             PIC X(6).
  7660
  7661         16  CL-PRIME-CERT-NO.
  7662             20  CL-PRIME-CERT-PRIME PIC X(10).
  7663             20  CL-PRIME-CERT-SFX   PIC X.
  7664
  7665         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7666             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7667             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7668
  7669         16  CL-MICROFILM-NO         PIC X(10).
  7670         16  FILLER REDEFINES CL-MICROFILM-NO.
  7671             20  CL-BENEFIT-PERIOD   PIC 99.
  7672             20  FILLER              PIC X(8).
  7673         16  CL-PROG-FORM-TYPE       PIC X.
  7674         16  CL-LAST-ADD-ON-DT       PIC XX.
  7675
  7676         16  CL-LAST-REOPEN-DT       PIC XX.
  7677         16  CL-LAST-CLOSE-DT        PIC XX.
  7678         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7679             88  FINAL-PAID             VALUE '1'.
  7680             88  CLAIM-DENIED           VALUE '2'.
  7681             88  AUTO-CLOSE             VALUE '3'.
  7682             88  MANUAL-CLOSE           VALUE '4'.
  7683             88  BENEFITS-CHANGED       VALUE 'C'.
  7684             88  SETUP-ERRORS           VALUE 'E'.
  7685         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7686         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7687         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7688             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7689         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7690         16  FILLER                  PIC X.
  7691
  7692     12  CL-CERTIFICATE-DATA.
  7693         16  CL-CERT-ORIGIN          PIC X.
  7694             88  CERT-WAS-ONLINE        VALUE '1'.
  7695             88  CERT-WAS-CREATED       VALUE '2'.
  7696             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7697         16  CL-CERT-KEY-DATA.
  7698             20  CL-CERT-CARRIER     PIC X.
  7699             20  CL-CERT-GROUPING    PIC X(6).
  7700             20  CL-CERT-STATE       PIC XX.
  7701             20  CL-CERT-ACCOUNT.
  7702                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7703                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7704             20  CL-CERT-EFF-DT      PIC XX.
  7705
  7706     12  CL-STATUS-CONTROLS.
  7707         16  CL-PRIORITY-CD          PIC X.
  7708             88  CONFIDENTIAL-DATA      VALUE '8'.
  7709             88  HIGHEST-PRIORITY       VALUE '9'.
  7710         16  CL-SUPV-ATTN-CD         PIC X.
  7711             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 143
* EL050.cbl
  7712             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7713         16  CL-PURGED-DT            PIC XX.
  7714         16  CL-RESTORED-DT          PIC XX.
  7715         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7716         16  CL-NEXT-RESEND-DT       PIC XX.
  7717         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7718         16  CL-CRITICAL-PERIOD      PIC 99.
  7719*        16  FILLER                  PIC XX.
  7720         16  CL-LAST-MAINT-DT        PIC XX.
  7721         16  CL-LAST-MAINT-USER      PIC X(4).
  7722         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7723         16  CL-LAST-MAINT-TYPE      PIC X.
  7724             88  CLAIM-SET-UP           VALUE ' '.
  7725             88  PAYMENT-MADE           VALUE '1'.
  7726             88  LETTER-SENT            VALUE '2'.
  7727             88  MASTER-WAS-ALTERED     VALUE '3'.
  7728             88  MASTER-WAS-RESTORED    VALUE '4'.
  7729             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7730             88  FILE-CONVERTED         VALUE '6'.
  7731             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7732             88  ERROR-CORRECTION       VALUE 'E'.
  7733         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7734         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7735         16  CL-BENEFICIARY          PIC X(10).
  7736         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7737         16  CL-DENIAL-TYPE          PIC X.
  7738             88  CL-TYPE-DENIAL          VALUE '1'.
  7739             88  CL-TYPE-RESCISSION      VALUE '2'.
  7740             88  CL-TYPE-REFORMATION     VALUE '3'.
  7741             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7742             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7743         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7744         16  filler                  pic x(3).
  7745*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7746*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7747*        16  CL-RTW-DT               PIC XX.
  7748
  7749     12  CL-TRAILER-CONTROLS.
  7750         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7751             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7752             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7753             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7754         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7755         16  FILLER                  PIC XX.
  7756         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7757         16  CL-ADDRESS-TRAILER-CNT.
  7758             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7759                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7760             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7761                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7762             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7763                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7764             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7765                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7766             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7767                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7768             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7769                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 144
* EL050.cbl
  7770             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7771                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7772
  7773     12  CL-CV-REFERENCE-NO.
  7774         16  CL-CV-REFNO-PRIME       PIC X(18).
  7775         16  CL-CV-REFNO-SFX         PIC XX.
  7776
  7777     12  CL-FILE-LOCATION            PIC X(4).
  7778
  7779     12  CL-PROCESS-ERRORS.
  7780         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7781             88  NO-FATAL-ERRORS        VALUE ZERO.
  7782         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7783             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7784
  7785     12  CL-PRODUCT-CD               PIC X.
  7786
  7787     12  CL-CURRENT-KEY-DATA.
  7788         16  CL-CURRENT-CARRIER      PIC X.
  7789         16  CL-CURRENT-GROUPING     PIC X(6).
  7790         16  CL-CURRENT-STATE        PIC XX.
  7791         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7792
  7793     12  CL-ASSOCIATES               PIC X.
  7794         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7795         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7796         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7797         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7798
  7799     12  CL-ACTIVITY-CODE            PIC 99.
  7800     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7801     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7802
  7803     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7804     12  CL-LAG-REPORT-CODE          PIC 9.
  7805     12  CL-LOAN-TYPE                PIC XX.
  7806     12  CL-LEGAL-STATE              PIC XX.
  7807
  7808     12  CL-YESNOSW                  PIC X.
  7809     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7810         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7811         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7812         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7813     12  cl-insured-type             pic x.
  7814         88  cl-claim-on-primary         value 'P'.
  7815         88  cl-claim-on-co-borrower     value 'C'.
  7816     12  cl-benefit-expiration-dt    PIC XX.
  7817
  7818 01  PLAN-RECORDS.
  7819     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7820     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7821
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 145
* EL050.cbl
  7823 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7824                          ACCOUNT-MASTER REINSURANCE-RECORD
  7825                          COMM-TABLE-RECORD FORM-MASTER
  7826                          CLAIM-MASTER PLAN-RECORDS.
  7827 0000-DFHEXIT SECTION.
  7828     MOVE '9#                    $   ' TO DFHEIV0.
  7829     MOVE 'EL050' TO DFHEIV1.
  7830     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7831
  7832     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7833
  7834
  7835* EXEC CICS  HANDLE CONDITION
  7836*           ERROR    (9300-ABEND)
  7837*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7838*    END-EXEC.
  7839*    MOVE '"$.J                  ! " #00007830' TO DFHEIV0
  7840     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7841     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7842     MOVE X'2220233030303037383330' TO DFHEIV0(25:11)
  7843     CALL 'kxdfhei1' USING DFHEIV0
  7844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7845
  7846
  7847 0000-COPY-PROCEDURE-DIV.
  7848*                          COPY ELC50PD.
  7849******************************************************************
  7850*                                                                *
  7851*                            ELC50PD                             *
  7852*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7853*                            VMOD=2.188                          *
  7854*                                                                *
  7855******************************************************************
  7856*                   C H A N G E   L O G
  7857*
  7858* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7859*-----------------------------------------------------------------
  7860*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7861* EFFECTIVE    NUMBER
  7862*-----------------------------------------------------------------
  7863* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7864* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7865* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7866*                             2709 AND 2718
  7867* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7868* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7869* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7870* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7871* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7872*                                IS OPEN OR CNC DT < PD THRU
  7873* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7874* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7875* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7876* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7877* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7878* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7879* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7880* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 146
* EL050.cbl
  7881* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7882* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7883* 020906                   PEMA  EXPAND LOAN OFFICER
  7884* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7885* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7886* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7887* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7888* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7889* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7890* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7891* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7892* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7893* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7894* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7895* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7896* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7897* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7898* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7899* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7900* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7901* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7902* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7903* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7904* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7905* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7906* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7907* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7908* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7909*                                UPDATE VIN ON CERT TRAILER
  7910* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7911* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7912* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7913* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7914* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7915* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7916* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7917* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7918* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7919* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7920* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7921* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7922* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7923* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7924* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7925* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7926* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7927* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7928* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7929* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7930* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7931* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7932* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7933* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7934* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7935* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7936* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7937* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7938* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 147
* EL050.cbl
  7939* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7940* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7941* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7942* 032912  CR2011110200001  PEMA  AHL CHANGES
  7943* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7944* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7945* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7946* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7947* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7948* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7949* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7950* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7951* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7952* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7953* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7954* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7955* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7956* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7957* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7958* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7959* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7960* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7961* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7962* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7963* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7964* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7965* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7966* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7967* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7968* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7969* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7970*                                CERT #, ADD 2898 FORCIBLE ERROR
  7971* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7972* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7973* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7974* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7975* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7976* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7977* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7978* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7979* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7980* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7981* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7982* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7983* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
  7984* 062717  IR2017061900003  PEMA  Fix 0% APR on refunds
  7985* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7986* 100617  CR2017062000003  PEMA  New comm cap edits
  7987* 121117  IR2017121100002  PEMA  INITIALIZE NEW COMM CAP FIELDS.
  7988* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
  7989* 011718  IR2018011200001  PEMA  CORRECT ROA EXTENSION DAYS ISSUE
  7990* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
  7991* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  7992* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
  7993* 070218  IR2018062700001  PEMA  Fix edit for spaces in certno
  7994* 092118  CR2018073000001  PEMA  Add lf & ah refund method to ELCR
  7995* 092618  CR2018050200001  PEMA  Add check for open clm on issue
  7996* 021519  CR2019021100001  PEMA  Non-monthly calcs for AL.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 148
* EL050.cbl
  7997* 101019  CR2019100700001  PEMA  Disallow V status with claim
  7998* 011020  IR2019121100004  PEMA  Add error 3069 name&age equal
  7999* 012220  CR2018092700002  TANA  Add edit for letter required
  8000******************************************************************
  8001************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  8002******************************************************************
  8003
  8004     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  8005
  8006     MOVE SPACES                 TO PB-FATAL-FLAG
  8007                                    PB-FORCE-ER-CD
  8008                                    PB-WARN-ER-CD
  8009                                    PB-OUT-BAL-CD.
  8010
  8011     MOVE SPACE                  TO WS-IG-OVRD-AH
  8012                                    WS-IG-OVRD-LF
  8013                                    WS-IG-OVRD-AM
  8014                                    WS-IG-OVRD
  8015                                    WS-IG-OVRD-AH-PL
  8016                                    WS-IG-OVRD-LF-PL
  8017                                    WS-IG-OVRD-AH-BEN
  8018                                    WS-IG-OVRD-LF-BEN.
  8019
  8020******************************************************************
  8021*************       INITIALIZE COMMON ERRORS       ***************
  8022******************************************************************
  8023
  8024     MOVE +0                     TO PB-NO-OF-ERRORS.
  8025     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  8026
  8027******************************************************************
  8028
  8029     MOVE EIBDATE                TO DC-JULIAN-DATE.
  8030     SET JULIAN-TO-BIN           TO TRUE.
  8031*    MOVE 5                      TO DC-OPTION-CODE.
  8032     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8033     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  8034
  8035     MOVE ZERO                   TO  SUB4.
  8036
  8037 0040-INITIALIZE-GA-BILL-DT.
  8038
  8039     ADD +1                      TO  SUB4.
  8040
  8041     IF  SUB4 GREATER THAN +5
  8042         GO TO 0050-CHECK-CNTL-FOUND.
  8043
  8044     IF  PB-GA-BILL-DT (SUB4) = SPACES
  8045         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  8046
  8047     GO TO 0040-INITIALIZE-GA-BILL-DT.
  8048
  8049 0050-CHECK-CNTL-FOUND.
  8050
  8051     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  8052        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  8053                                         WS-AH-REM-TERM-CALC
  8054                                         EC-CO-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 149
* EL050.cbl
  8055        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  8056        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  8057        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  8058                                         WS-TOL-AH-CLAIM
  8059        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  8060                                         WS-TOL-AH-PREM
  8061                                         EC-CO-TOL-PREM
  8062        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  8063                                         WS-TOL-AH-REFUND
  8064                                         EC-CO-TOL-REFUND
  8065        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  8066                                         WS-AH-REFUND-OVS-AMT
  8067                                         EC-CO-OVR-SHT-AMT
  8068        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  8069                                         WS-TOL-AH-PREM-PCT
  8070                                         EC-CO-TOL-PREM-PCT
  8071        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  8072                                         WS-TOL-AH-REFUND-PCT
  8073                                         EC-CO-TOL-REFUND-PCT
  8074        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  8075                                         WS-AH-REFUND-OVS-PCT
  8076                                         EC-CO-OVR-SHT-PCT
  8077        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  8078        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  8079        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  8080        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  8081        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  8082        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  8083        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  8084        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  8085        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  8086        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  8087        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  8088        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  8089                                         EC-CO-MONTH-END-DT
  8090        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  8091          GO TO 0100-READ-ACCT.
  8092
  8093     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8094     MOVE SPACES                 TO CNTL-ACCESS.
  8095     MOVE '1'                    TO CNTL-REC-TYPE.
  8096     MOVE +0                     TO CNTL-SEQ-NO.
  8097
  8098     MOVE '1' TO RC-SW-1.
  8099     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  8100     IF NOT CF-COMPANY-MASTER
  8101         MOVE ZEROS             TO WK-CO-TOL-PREM
  8102                                   WK-CO-TOL-CLAIM
  8103                                   WK-CO-TOL-REFUND
  8104                                   WK-REFUND-OVS-AMT
  8105                                   WK-REFUND-OVS-PCT
  8106                                   WK-CO-TOL-PREM-PCT
  8107                                   WK-CO-TOL-REFUND-PCT
  8108                                   WK-DEFAULT-APR
  8109                                   WK-CO-MAX-CAP
  8110        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  8111                                   WK-CR-R78-METHOD
  8112                                   WK-CO-REF-REJECT-SW
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 150
* EL050.cbl
  8113                                   WK-CO-PREM-REJECT-SW
  8114                                   WK-REM-TRM-CALC-OPTION
  8115                                   WK-BIRTH-DATE-INPUT
  8116                                   WK-JOINT-AGE-INPUT
  8117        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  8118        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  8119        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  8120        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  8121          GO TO 0099-COMPANY-NOT-FOUND.
  8122
  8123     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  8124        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  8125     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  8126        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  8127     IF CF-CO-TOL-CAP NOT NUMERIC
  8128        MOVE +0                    TO CF-CO-TOL-CAP.
  8129     IF CF-DEFAULT-APR NOT NUMERIC
  8130        MOVE +0                    TO CF-DEFAULT-APR.
  8131
  8132     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  8133     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  8134     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  8135     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  8136     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  8137     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  8138     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  8139     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  8140     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  8141     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  8142     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  8143     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  8144
  8145     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  8146          CF-CO-OVR-SHT-AMT > +0
  8147        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  8148
  8149     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  8150          CF-CO-OVR-SHT-PCT > +0
  8151        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  8152
  8153     IF CF-VALID-REM-TRM-OPTION
  8154         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  8155     ELSE
  8156         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  8157
  8158     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  8159     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  8160     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  8161     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8162
  8163     GO TO 0050-CHECK-CNTL-FOUND.
  8164
  8165 0099-COMPANY-NOT-FOUND.
  8166
  8167     MOVE ER-2616                TO WS-ERROR.
  8168     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8169
  8170 0100-READ-ACCT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 151
* EL050.cbl
  8171
  8172     MOVE SPACES                 TO DATE-RANGE-SW.
  8173
  8174     IF WK-ACCT-ADDR = ZEROS
  8175        GO TO 0102-ACCT-GETMAIN.
  8176
  8177     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  8178     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  8179     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8180
  8181     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8182        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8183        GO TO 0105-READ-ACCT
  8184     END-IF
  8185
  8186     IF PB-CARRIER NOT = SPACES
  8187        IF PB-CARRIER NOT = AM-VG-CARRIER
  8188           GO TO 0105-READ-ACCT.
  8189
  8190     IF PB-STATE NOT = SPACES
  8191        IF PB-STATE NOT = AM-VG-STATE
  8192           GO TO 0105-READ-ACCT.
  8193
  8194     IF PB-GROUPING NOT = SPACES
  8195        IF PB-GROUPING NOT = AM-VG-GROUPING
  8196           GO TO 0105-READ-ACCT.
  8197
  8198     MOVE 'X'                 TO DATE-RANGE-SW.
  8199
  8200     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8201        MOVE 'X'                 TO DATE-RANGE-SW
  8202        GO TO 0105-READ-ACCT.
  8203
  8204     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8205        GO TO 0105-READ-ACCT.
  8206
  8207     GO TO 0180-ACCOUNT-FOUND.
  8208
  8209 0102-ACCT-GETMAIN.
  8210     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8211     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8212
  8213 0105-READ-ACCT.
  8214     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8215     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8216     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8217     MOVE PB-STATE               TO ACCT-STATE.
  8218     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8219     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8220
  8221     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8222
  8223     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8224
  8225 0110-FIND-ACCT-TOLERANCES-LOOP.
  8226     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8227
  8228     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 152
* EL050.cbl
  8229        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8230        GO TO 0199-ACCT-NOT-FOUND
  8231     END-IF
  8232     IF PB-CARRIER NOT = SPACES
  8233        IF PB-CARRIER NOT = AM-VG-CARRIER
  8234           GO TO 0199-ACCT-NOT-FOUND.
  8235
  8236     IF PB-STATE NOT = SPACES
  8237        IF PB-STATE NOT = AM-VG-STATE
  8238           GO TO 0199-ACCT-NOT-FOUND.
  8239
  8240     IF PB-GROUPING NOT = SPACES
  8241        IF PB-GROUPING NOT = AM-VG-GROUPING
  8242           GO TO 0199-ACCT-NOT-FOUND.
  8243
  8244     MOVE 'X'                    TO DATE-RANGE-SW.
  8245
  8246     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8247        MOVE 'X'                 TO DATE-RANGE-SW
  8248        GO TO 0199-ACCT-NOT-FOUND.
  8249
  8250     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8251        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8252
  8253 0180-ACCOUNT-FOUND.
  8254     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8255     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8256     MOVE AM-STATE               TO PB-SV-STATE.
  8257     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8258
  8259     IF AM-CANCEL-FEE  NOT NUMERIC
  8260        MOVE ZEROS TO AM-CANCEL-FEE.
  8261
  8262     IF AM-MAX-MON-BEN NOT NUMERIC
  8263        MOVE ZEROS TO AM-MAX-MON-BEN.
  8264
  8265     IF AM-MAX-TOT-BEN NOT NUMERIC
  8266        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8267
  8268     IF AM-CLP-TOL-PCT NOT NUMERIC
  8269        MOVE +0                  TO AM-CLP-TOL-PCT
  8270     END-IF
  8271     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8272        MOVE +0                  TO AM-SPP-LEASE-COMM
  8273     END-IF
  8274     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8275        MOVE ER-2611             TO   WS-ERROR
  8276        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8277
  8278     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8279        MOVE ER-2621             TO   WS-ERROR
  8280        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8281
  8282     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8283        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8284        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8285        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8286         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 153
* EL050.cbl
  8287
  8288     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8289     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8290     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8291     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8292     IF AM-CLP-TOL-PCT NOT = ZEROS
  8293        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8294     END-IF
  8295     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8296        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8297     END-IF
  8298*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8299*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8300*                                   WS-ADMIN-FEES
  8301*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8302*          (SUB5 > +10)
  8303*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8304*             AND (AM-A-COM (SUB5) NUMERIC)
  8305*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8306*                + (AM-A-COM (SUB5) * 1000)
  8307*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8308*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8309*                + (AM-A-COM (SUB5) * 1000)
  8310*             END-IF
  8311*             IF AM-COM-TYP (SUB5) = 'N'
  8312*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8313*                + (AM-A-COM (SUB5) * 1000)
  8314*             END-IF
  8315*          END-IF
  8316*       END-PERFORM
  8317*    END-IF
  8318     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8319        AND (PB-ISSUE)
  8320        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8321                                    ws-cred-union-fees
  8322        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8323           (SUB5 > +10)
  8324           MOVE +0 TO WS-WK-RATE
  8325           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8326                                   'O' OR 'S')
  8327              IF (AM-A-COM (SUB5) NUMERIC)
  8328                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8329                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8330              ELSE
  8331                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8332                 IF PB-ISSUE
  8333                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8334                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8335                 ELSE
  8336                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8337                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8338                 END-IF
  8339                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8340                 MOVE ZEROS             TO WS-SUB1
  8341                                           WS-COMMISSION
  8342                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8343                 MOVE '0530'               TO CTBL-SW
  8344                 MOVE ' '                  TO WS-CTBL-READ-SW
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 154
* EL050.cbl
  8345                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8346                 IF FIRST-TIME-THROUGH
  8347                    MOVE 'AA'              TO CTBL-BEN-CODE
  8348                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8349                 END-IF
  8350                 IF CTBL-TABLE-FOUND
  8351                    IF PB-ISSUE
  8352                       COMPUTE WS-COMM-CK-AMT =
  8353                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8354                    ELSE
  8355                       COMPUTE WS-COMM-CK-AMT =
  8356                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8357                    END-IF
  8358                    PERFORM 8800-GET-COMP-RATE
  8359                              THRU 8800-EXIT
  8360                 END-IF
  8361              END-IF
  8362              if am-com-typ (sub5) = 'O' or 'S'
  8363                 compute ws-cred-union-fees rounded =
  8364                    ws-cred-union-fees +
  8365                    (pb-i-ah-premium-amt * ws-wk-rate)
  8366              else
  8367                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8368                + (WS-WK-RATE * 1000)
  8369              end-if
  8370           END-IF
  8371        END-PERFORM
  8372     END-IF
  8373     IF PB-COMPANY-ID EQUAL 'CRI'
  8374         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8375
  8376     IF PB-COMPANY-ID EQUAL 'NCL'
  8377         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8378     END-IF
  8379
  8380     GO TO 0200-READ-CERT.
  8381
  8382 0199-ACCT-NOT-FOUND.
  8383
  8384     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8385
  8386     IF DATE-RANGE-SW NOT = SPACES
  8387        MOVE ER-2601             TO WS-ERROR
  8388        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8389     ELSE
  8390        MOVE ER-2619             TO WS-ERROR
  8391        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8392
  8393     GO TO 9990-RETURN.
  8394
  8395 0200-READ-CERT.
  8396
  8397     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8398     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8399     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8400     MOVE PB-SV-STATE            TO CERT-STATE.
  8401     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8402     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 155
* EL050.cbl
  8403     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8404
  8405     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8406
  8407     IF CERT-WAS-NOT-FOUND
  8408        GO TO 0299-CERT-NOT-FOUND.
  8409
  8410     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8411        MOVE ER-2759             TO WS-ERROR
  8412        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8413        GO TO 0298-UNLOCK-RETURN.
  8414
  8415     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8416         MOVE ER-2758            TO WS-ERROR
  8417         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8418         GO TO 0298-UNLOCK-RETURN.
  8419
  8420     IF PB-ISSUE
  8421        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8422           IF CERT-WAS-CREATED-FOR-CLAIM
  8423              NEXT SENTENCE
  8424            ELSE
  8425              MOVE ER-2626       TO WS-ERROR
  8426              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8427              GO TO 0298-UNLOCK-RETURN.
  8428
  8429     IF NOT PB-CANCELLATION
  8430        GO TO 0300-CONTINUE-EDIT.
  8431
  8432     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8433     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8434     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8435     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8436     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8437     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8438
  8439     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8440     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8441     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8442     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8443     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8444     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8445     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8446     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8447     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8448
  8449     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8450     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8451     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8452     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8453     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8454     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8455     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8456
  8457     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8458     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8459
  8460     MOVE CM-CREDIT-INTERFACE-SW-1
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 156
* EL050.cbl
  8461                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8462     MOVE CM-CREDIT-INTERFACE-SW-2
  8463                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8464
  8465     IF CM-O-B-COVERAGE
  8466         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8467
  8468     IF CM-LIVES NOT NUMERIC
  8469         MOVE ZERO                TO CM-LIVES.
  8470
  8471     IF CM-BILLED NOT NUMERIC
  8472         MOVE ZERO                TO CM-BILLED.
  8473
  8474     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8475         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8476         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8477         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8478         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8479         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8480         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8481         MOVE CM-LIVES             TO PB-CI-LIVES
  8482*The next line causes a problem with my change  I dont think it is
  8483*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8484
  8485     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8486     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8487     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8488     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8489     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8490     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8491
  8492     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8493     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8494     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8495     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8496
  8497     IF CM-LIFE-COMM-PCT NUMERIC
  8498         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8499     ELSE
  8500         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8501
  8502     IF CM-AH-COMM-PCT NUMERIC
  8503         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8504     ELSE
  8505         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8506
  8507     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8508
  8509     IF CM-LOAN-APR       NOT NUMERIC
  8510           MOVE ZERO               TO CM-LOAN-APR.
  8511
  8512     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8513           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8514
  8515     IF CM-LOAN-TERM      NOT NUMERIC
  8516           MOVE ZERO               TO CM-LOAN-TERM.
  8517
  8518     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 157
* EL050.cbl
  8519           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8520
  8521     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8522           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8523
  8524     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8525     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8526     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8527     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8528     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8529     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8530     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8531     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8532     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8533     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8534     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8535     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8536     MOVE CM-BENEFICIARY           TO PB-CI-BENEFICIARY-NAME
  8537
  8538     IF CM-STATE = CM-SSN-STATE
  8539         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8540
  8541     IF CM-STATE NOT = CM-MEMB-STATE
  8542         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8543
  8544     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8545
  8546     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8547*       MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8548        IF CM-ADDL-CLP NOT NUMERIC
  8549           MOVE +0               TO CM-ADDL-CLP
  8550        END-IF
  8551        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8552        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8553           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8554        END-IF
  8555     END-IF
  8556     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8557        MOVE +0                  TO WS-ADMIN-FEES
  8558                                    WS-CSO-ADMIN-FEE
  8559                                    WS-COMM-AND-MFEE
  8560                                    WS-1ST-YR-ALLOW
  8561        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8562           (SUB5 > +10)
  8563           MOVE +0 TO WS-WK-RATE
  8564           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8565              IF (AM-A-COM (SUB5) NUMERIC)
  8566                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8567                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8568              ELSE
  8569                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8570                 IF PB-ISSUE
  8571                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8572                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8573                 ELSE
  8574                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8575                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8576                 END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 158
* EL050.cbl
  8577                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8578                 MOVE ZEROS             TO WS-SUB1
  8579                                           WS-COMMISSION
  8580                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8581                 MOVE '0530'               TO CTBL-SW
  8582                 MOVE ' '                  TO WS-CTBL-READ-SW
  8583                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8584                 IF FIRST-TIME-THROUGH
  8585                    MOVE 'AA'              TO CTBL-BEN-CODE
  8586                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8587                 END-IF
  8588                 IF CTBL-TABLE-FOUND
  8589                    IF PB-ISSUE
  8590                       COMPUTE WS-COMM-CK-AMT =
  8591                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8592                    ELSE
  8593                       COMPUTE WS-COMM-CK-AMT =
  8594                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8595                    END-IF
  8596                    PERFORM 8800-GET-COMP-RATE
  8597                              THRU 8800-EXIT
  8598                 END-IF
  8599              END-IF
  8600              IF AM-COM-TYP (SUB5) = 'I'
  8601                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8602                   + (WS-WK-RATE * 1000)
  8603              END-IF
  8604              IF AM-COM-TYP (SUB5) = 'N'
  8605                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8606                   + (WS-WK-RATE * 1000)
  8607              END-IF
  8608              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8609                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8610                   + (WS-WK-RATE * 1000)
  8611              END-IF
  8612              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8613                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8614                   + (WS-WK-RATE * 1000)
  8615              END-IF
  8616           END-IF
  8617        END-PERFORM
  8618     END-IF
  8619     GO TO 0300-CONTINUE-EDIT.
  8620
  8621 0298-UNLOCK-RETURN.
  8622      PERFORM 9250-UNLOCK-RETURN
  8623      GO TO 9990-RETURN.
  8624
  8625 0299-CERT-NOT-FOUND.
  8626
  8627     MOVE '1'                     TO CERT-STATUS-SW.
  8628
  8629     IF PB-COMPANY-ID = 'UCL'
  8630         IF WS-ERROR = ER-2799
  8631             GO TO 3000-CONTINUE-EDIT.
  8632
  8633     IF NOT PB-CANCELLATION
  8634         GO TO 0300-CONTINUE-EDIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 159
* EL050.cbl
  8635
  8636     MOVE ER-2726                  TO  WS-ERROR.
  8637     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8638     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8639     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8640                                    PB-CI-LF-TERM
  8641                                    PB-C-LF-REM-TERM
  8642                                    PB-CI-AH-TERM
  8643                                    PB-C-AH-REM-TERM
  8644                                    PB-CI-LF-BENEFIT-CD
  8645                                    PB-CI-LF-BENEFIT-AMT
  8646                                    PB-CI-LF-ALT-BENEFIT-AMT
  8647                                    PB-CI-LF-PREMIUM-AMT
  8648                                    PB-CI-LF-ALT-PREMIUM-AMT
  8649                                    PB-CI-AH-BENEFIT-CD
  8650                                    PB-CI-AH-BENEFIT-AMT
  8651                                    PB-CI-AH-PREMIUM-AMT
  8652                                    PB-CI-PAY-FREQUENCY
  8653                                    PB-CI-LOAN-APR
  8654                                    PB-CI-LOAN-TERM
  8655                                    PB-CI-LIFE-COMMISSION
  8656                                    PB-CI-AH-COMMISSION
  8657                                    PB-CI-CURR-SEQ
  8658                                    PB-CI-AH-CANCEL-AMT
  8659                                    PB-CI-LF-CANCEL-AMT
  8660                                    PB-CI-RATE-DEV-PCT-LF
  8661                                    PB-CI-RATE-DEV-PCT-AH
  8662                                    PB-CI-EXTENTION-DAYS
  8663                                    PB-CI-TERM-IN-DAYS
  8664                                    PB-CI-LIVES
  8665                                    PB-CI-LF-CRIT-PER
  8666                                    PB-CI-AH-CRIT-PER
  8667                                    PB-CI-ADDL-CLP
  8668                                    PB-CI-DDF-IU-RATE-UP.
  8669
  8670     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8671                                    PB-CI-AH-SETTLEMENT-DT
  8672                                    PB-CI-DEATH-DT
  8673                                    PB-CI-LF-PRIOR-CANCEL-DT
  8674                                    PB-CI-AH-PRIOR-CANCEL-DT
  8675                                    PB-CI-ENTRY-DT
  8676                                    PB-CI-LF-EXPIRE-DT
  8677                                    PB-CI-AH-EXPIRE-DT
  8678                                    PB-CI-LOAN-1ST-PMT-DT.
  8679
  8680     IF ACCOUNT-MAST-FOUND
  8681        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8682        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8683
  8684
  8685 0300-CONTINUE-EDIT.
  8686
  8687     IF PB-ISSUE
  8688        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8689            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8690
  8691     IF PB-ISSUE
  8692        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 160
* EL050.cbl
  8693            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8694
  8695     IF PB-ISSUE
  8696       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8697          (AM-NO-AH-ONLY)
  8698           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8699               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8700                   MOVE ER-2679 TO WS-ERROR
  8701                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8702
  8703     IF PB-ISSUE
  8704        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8705        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8706        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8707     ELSE
  8708        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8709        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8710        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8711
  8712     MOVE 'N'                    TO PLAN-MASTER-SW
  8713                                    PLAN-MASTER-LIFE-SW
  8714                                    FORM-MASTER-SW
  8715                                    WS-APP-CERT-SW.
  8716
  8717     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8718                                    WS-PL-TOL-LF-REFUND
  8719                                    WS-PL-REF-OVS-AMT
  8720                                    WS-PL-TOL-LF-PREM-PCT
  8721                                    WS-PL-TOL-LF-REFUND-PCT
  8722                                    WS-PL-REF-OVS-PCT
  8723                                    WS-PL-TOL-LF-CLAIM.
  8724
  8725     IF PB-COMPANY-ID = 'NCL'
  8726       IF PB-ISSUE
  8727         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8728             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8729             IF FORM-MASTER-FOUND
  8730                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8731
  8732     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8733        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8734
  8735********************** MON CODE **********************
  8736     IF PB-COMPANY-ID = 'MON'
  8737     IF PB-ISSUE
  8738     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8739        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8740             PB-I-LOAN-APR = ZERO)
  8741               MOVE 14.0         TO PB-I-LOAN-APR.
  8742******************************************************
  8743
  8744     IF PB-COMPANY-ID = 'NCL'
  8745       IF PB-ISSUE
  8746           IF FORM-MASTER-FOUND
  8747             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8748                AM-DISMBR-COVERAGE
  8749                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8750                 IF WS-LF-INPUT-CD-1 NOT = 'B'
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 161
* EL050.cbl
  8751                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8752                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8753                                           PB-I-LIFE-BENEFIT-CD.
  8754
  8755     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8756
  8757     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8758         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8759         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8760         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8761         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8762         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8763           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8764             GO TO 0301-LIFE-BENEFIT-SEARCH
  8765         ELSE
  8766             NEXT SENTENCE
  8767     ELSE
  8768         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8769
  8770     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8771     MOVE '4'                    TO CNTL-REC-TYPE.
  8772     MOVE +0                     TO CNTL-SEQ-NO.
  8773     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8774
  8775     MOVE '1' TO RC-SW-2.
  8776     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8777
  8778     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8779        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8780         GO TO 0305-BENEFIT-NOT-FOUND.
  8781
  8782     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8783
  8784 0301-LIFE-BENEFIT-SEARCH.
  8785
  8786     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8787
  8788     IF NO-BENEFIT-FOUND
  8789        GO TO 0305-BENEFIT-NOT-FOUND.
  8790
  8791     IF WS-BEN-CD = '99'
  8792        GO TO 0305-BENEFIT-NOT-FOUND.
  8793
  8794     IF PB-COMPANY-ID = 'NCL'
  8795         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8796             GO TO 0304-LIFE-BENEFIT-FOUND.
  8797
  8798     MOVE +1                     TO SUB5.
  8799     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8800
  8801* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8802* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8803     IF PB-COMPANY-ID = 'DMD'
  8804         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8805
  8806 0302-EDIT-ACCT-LF-BENEFITS.
  8807
  8808     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 162
* EL050.cbl
  8809        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8810           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8811                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8812           GO TO 03XX-GET-LIFE-ERPLAN.
  8813
  8814     IF SUB5 LESS THAN +20
  8815        ADD +1                   TO SUB5
  8816        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8817
  8818     MOVE +1                     TO SUB5.
  8819
  8820     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8821        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8822
  8823 0303-EDIT-DMD-EXTRA-BENEFITS.
  8824
  8825     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8826        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8827           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8828                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8829           GO TO 03XX-GET-LIFE-ERPLAN.
  8830
  8831     IF SUB5 LESS THAN +30
  8832        ADD +1                   TO SUB5
  8833        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8834
  8835     MOVE +1                     TO SUB5.
  8836
  8837 03XX-EDIT-FOR-NINETY-LF.
  8838
  8839***************************************************************
  8840*                                                             *
  8841*    NINETY BENEFIT PLAN TYPES:                               *
  8842*                                                             *
  8843*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8844*      92 = ALL GROUP REDUCING BENEFITS                       *
  8845*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8846*      94 = ALL GROUP LEVEL BENEFITS                          *
  8847*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8848*           BENEFIT CONTROLS.                                 *
  8849*      99 = ALL BENEFITS                                      *
  8850*                                                             *
  8851***************************************************************
  8852
  8853     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8854                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8855
  8856     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8857       AND
  8858        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8859        GO TO 03XX-GET-LIFE-ERPLAN.
  8860
  8861     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8862       AND
  8863        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8864        IF CF-REDUCING (SUB3)
  8865           IF (PB-I-INDV-GRP-OVRD = 'I')
  8866              OR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 163
* EL050.cbl
  8867           ((AM-IG = '1') AND
  8868           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8869              OR
  8870           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8871           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8872           (AM-IG NOT = '2'))
  8873              GO TO 03XX-GET-LIFE-ERPLAN.
  8874
  8875     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8876       AND
  8877        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8878        IF CF-REDUCING (SUB3)
  8879           IF (PB-I-INDV-GRP-OVRD = 'G')
  8880              OR
  8881           ((AM-IG = '2') AND
  8882           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8883              OR
  8884           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8885           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8886           (AM-IG NOT = '1'))
  8887              GO TO 03XX-GET-LIFE-ERPLAN.
  8888
  8889     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8890       AND
  8891        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8892        IF CF-LEVEL    (SUB3)
  8893           IF (PB-I-INDV-GRP-OVRD = 'I')
  8894              OR
  8895           ((AM-IG = '1') AND
  8896           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8897              OR
  8898           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8899           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8900            (AM-IG NOT = '2'))
  8901              GO TO 03XX-GET-LIFE-ERPLAN.
  8902
  8903     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8904       AND
  8905        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8906        IF CF-LEVEL    (SUB3)
  8907           IF (PB-I-INDV-GRP-OVRD = 'G')
  8908              OR
  8909           ((AM-IG = '2') AND
  8910           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8911              OR
  8912           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8913           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8914           (AM-IG NOT = '1'))
  8915              GO TO 03XX-GET-LIFE-ERPLAN.
  8916
  8917     IF SUB5 LESS THAN +20
  8918        ADD +1                   TO SUB5
  8919        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8920
  8921     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8922
  8923     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8924        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 164
* EL050.cbl
  8925
  8926     MOVE +1                     TO SUB5.
  8927
  8928 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8929
  8930     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8931                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8932
  8933     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8934       AND
  8935        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8936        GO TO 03XX-GET-LIFE-ERPLAN.
  8937
  8938     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8939       AND
  8940        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8941        IF CF-REDUCING (SUB3)
  8942           IF (PB-I-INDV-GRP-OVRD = 'I')
  8943              OR
  8944           ((AM-IG = '1') AND
  8945           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8946              OR
  8947           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8948           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8949           (AM-IG NOT = '2'))
  8950              GO TO 03XX-GET-LIFE-ERPLAN.
  8951
  8952     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8953       AND
  8954        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8955        IF CF-REDUCING (SUB3)
  8956           IF (PB-I-INDV-GRP-OVRD = 'G')
  8957              OR
  8958           ((AM-IG = '2') AND
  8959           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8960              OR
  8961           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8962           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8963           (AM-IG NOT = '1'))
  8964              GO TO 03XX-GET-LIFE-ERPLAN.
  8965
  8966     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8967       AND
  8968        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8969        IF CF-LEVEL    (SUB3)
  8970           IF (PB-I-INDV-GRP-OVRD = 'I')
  8971              OR
  8972           ((AM-IG = '1') AND
  8973           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8974              OR
  8975           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8976           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8977            (AM-IG NOT = '2'))
  8978              GO TO 03XX-GET-LIFE-ERPLAN.
  8979
  8980     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8981       AND
  8982        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 165
* EL050.cbl
  8983        IF CF-LEVEL    (SUB3)
  8984           IF (PB-I-INDV-GRP-OVRD = 'G')
  8985              OR
  8986           ((AM-IG = '2') AND
  8987           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8988              OR
  8989           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8990           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8991           (AM-IG NOT = '1'))
  8992              GO TO 03XX-GET-LIFE-ERPLAN.
  8993
  8994     IF SUB5 LESS THAN +30
  8995        ADD +1                   TO SUB5
  8996        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8997
  8998     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8999
  9000 03XX-EDIT-FOR-NINETY-LF-CONT.
  9001
  9002     MOVE +99                    TO SUB5.
  9003
  9004     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9005        IF PB-ISSUE
  9006           MOVE ER-1924          TO  WS-ERROR
  9007           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9008
  9009     GO TO 0304-LIFE-BENEFIT-FOUND.
  9010
  9011 03XX-GET-LIFE-ERPLAN.
  9012
  9013     IF WK-PLAN-ADDR EQUAL +0
  9014        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  9015
  9016     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9017     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9018     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9019     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  9020     MOVE 'Y'                    TO PLAN-MASTER-SW
  9021                                    PLAN-MASTER-LIFE-SW.
  9022     GO TO XXXX-CHECK-LF-PLAN-KEY.
  9023
  9024 03XX-ERPLAN-LIFE-GETMAIN.
  9025
  9026     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9027     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9028
  9029 03XX-ERPLAN-LIFE-READ.
  9030
  9031     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9032     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9033     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9034     MOVE PB-SV-STATE            TO PLAN-STATE.
  9035     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9036     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  9037     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9038     MOVE WS-SAVE-BENEFIT-REVISION
  9039                                 TO PLAN-REVISION-NO.
  9040
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 166
* EL050.cbl
  9041     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9042     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  9043
  9044     IF PB-COMPANY-ID = 'NCL'
  9045       IF NOT LF-PLAN-MASTER-FOUND
  9046         IF NOT PB-POLICY-IS-DECLINED  AND
  9047            NOT PB-POLICY-IS-VOIDED
  9048             MOVE  ER-1921         TO  WS-ERROR
  9049             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9050             GO TO 0304-LIFE-BENEFIT-FOUND.
  9051
  9052     IF NOT LF-PLAN-MASTER-FOUND
  9053        GO TO 0304-LIFE-BENEFIT-FOUND.
  9054
  9055 XXXX-CHECK-LF-PLAN-KEY.
  9056
  9057     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9058        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9059        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9060        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9061        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9062        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9063        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9064        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9065        MOVE 'N'                 TO PLAN-MASTER-SW
  9066          GO TO 03XX-ERPLAN-LIFE-READ.
  9067
  9068     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  9069
  9070     IF  PB-CANCELLATION
  9071         GO TO  0303-LF-ACCT-BEN-FOUND.
  9072
  9073     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9074        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9075           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9076           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9077              MOVE ER-2644             TO WS-ERROR
  9078              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9079           ELSE
  9080              NEXT SENTENCE
  9081        ELSE
  9082           IF PB-COMPANY-ID NOT = 'NCL'
  9083              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9084                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9085
  9086 0303-LF-ACCT-BEN-FOUND.
  9087
  9088     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  9089
  9090     IF PL-DEV-CODE NOT = SPACES
  9091        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  9092
  9093     IF PL-DEV-PCT NUMERIC AND
  9094        PL-DEV-PCT NOT = ZEROS
  9095        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  9096
  9097     IF PL-TOL-PREM-AMT GREATER THAN +0
  9098        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 167
* EL050.cbl
  9099
  9100     IF PL-TOL-REF-AMT GREATER THAN +0
  9101        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  9102
  9103     IF PL-TOL-PREM-PCT GREATER THAN +0
  9104        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  9105
  9106     IF PL-TOL-REF-PCT GREATER THAN +0
  9107        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  9108
  9109     IF PL-TOL-CLM-AMT GREATER THAN +0
  9110        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  9111
  9112     IF PL-OVER-SHORT-AMT NUMERIC  AND
  9113                          PL-OVER-SHORT-AMT > +0
  9114        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  9115
  9116     IF PL-OVER-SHORT-PCT NUMERIC  AND
  9117                          PL-OVER-SHORT-PCT > +0
  9118        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  9119
  9120     IF PL-SALES-TAX NUMERIC AND
  9121                          PL-SALES-TAX > +0
  9122         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  9123
  9124     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9125        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  9126                                    WS-IG-OVRD-AM.
  9127
  9128 0304-LIFE-BENEFIT-FOUND.
  9129
  9130     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  9131
  9132     IF PB-ISSUE
  9133        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  9134     ELSE
  9135        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  9136
  9137     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  9138     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  9139     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  9140     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  9141     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  9142                                         WS-LF-REFUND-CALC.
  9143     if (ws-lf-earnings-calc = '5')
  9144        and (pb-i-loan-apr = zeros)
  9145        and (benefit-code-chg)
  9146        move +99.9999 to pb-i-loan-apr
  9147     end-if
  9148
  9149     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9150        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  9151
  9152     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9153        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  9154     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  9155
  9156     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 168
* EL050.cbl
  9157     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  9158     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  9159     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  9160     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  9161     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  9162
  9163     IF PB-COMPANY-ID = 'NCL'  AND
  9164        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9165         NEXT SENTENCE
  9166     ELSE
  9167         IF SUB5 NOT GREATER THAN +20
  9168            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  9169               MOVE WS-SAVE-BENEFIT-REM-TERM
  9170                                      TO WS-AM-LF-BENE-REM-TERM
  9171                                         EC-BR-LF-REM-TERM-CALC.
  9172
  9173     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  9174     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  9175
  9176     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9177
  9178 0305-BENEFIT-NOT-FOUND.
  9179
  9180     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9181     MOVE ER-2604                TO WS-ERROR.
  9182     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9183
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 169
* EL050.cbl
  9185
  9186 0310-FIND-AH-BENEFIT-RECORD.
  9187
  9188     MOVE 'N'                    TO PLAN-MASTER-SW
  9189                                    PLAN-MASTER-AH-SW.
  9190
  9191     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9192                                    WS-PL-TOL-AH-REFUND
  9193                                    WS-AH-PL-REF-OVS-AMT
  9194                                    WS-PL-TOL-AH-PREM-PCT
  9195                                    WS-PL-TOL-AH-REFUND-PCT
  9196                                    WS-AH-PL-REF-OVS-PCT
  9197                                    WS-PL-TOL-AH-CLAIM.
  9198     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9199
  9200
  9201     if pb-issue
  9202        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9203           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9204        end-if
  9205        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9206           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9207           GO TO 0399-BENEFIT-NOT-FOUND
  9208        end-if
  9209     end-if
  9210
  9211     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9212        GO TO 0400-FIND-CARRIER.
  9213
  9214     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9215
  9216     IF WK-AH-BEN-ADDR NOT = ZEROS
  9217         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9218         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9219         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9220         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9221           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9222             GO TO 0311-AH-BENEFIT-SEARCH
  9223         ELSE
  9224             NEXT SENTENCE
  9225     ELSE
  9226         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9227
  9228     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9229     MOVE '5'                    TO CNTL-REC-TYPE.
  9230     MOVE +0                     TO CNTL-SEQ-NO.
  9231     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9232
  9233     MOVE '2' TO RC-SW-2.
  9234     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9235
  9236     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9237        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9238          GO TO 0399-BENEFIT-NOT-FOUND.
  9239
  9240     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9241
  9242 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 170
* EL050.cbl
  9243
  9244     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9245
  9246     IF NO-BENEFIT-FOUND
  9247         GO TO 0399-BENEFIT-NOT-FOUND.
  9248
  9249     IF WS-BEN-CD = '99'
  9250        GO TO 0399-BENEFIT-NOT-FOUND.
  9251
  9252     IF PB-COMPANY-ID  =  'NCL'
  9253         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9254             GO TO 0314-A-H-BENEFIT-FOUND.
  9255
  9256     MOVE +1                     TO SUB5.
  9257     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9258
  9259* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9260* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9261     IF PB-COMPANY-ID = 'DMD'
  9262         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9263
  9264 0312-EDIT-ACCT-AH-BENEFITS.
  9265
  9266     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9267        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9268           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9269                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9270           GO TO 03XX-GET-AH-ERPLAN.
  9271
  9272     IF SUB5 LESS THAN +20
  9273        ADD +1                   TO SUB5
  9274        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9275
  9276     MOVE +1                     TO SUB5.
  9277
  9278     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9279        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9280
  9281 0313-EDIT-DMD-EXTRA-BENEFITS.
  9282
  9283     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9284        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9285           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9286                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9287           GO TO 03XX-GET-AH-ERPLAN.
  9288
  9289     IF SUB5 LESS THAN +30
  9290        ADD +1                   TO SUB5
  9291        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9292
  9293     MOVE +1                     TO SUB5.
  9294
  9295 03XX-EDIT-FOR-NINETY-AH.
  9296
  9297***************************************************************
  9298*                                                             *
  9299*    NINETY BENEFIT PLAN TYPES:                               *
  9300*                                                             *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 171
* EL050.cbl
  9301*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9302*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9303*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9304*           BENEFIT CONTROLS.                                 *
  9305*      99 = ALL BENEFITS.                                     *
  9306*                                                             *
  9307***************************************************************
  9308
  9309     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9310                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9311
  9312     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9313       AND
  9314        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9315        GO TO 03XX-GET-AH-ERPLAN.
  9316
  9317     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9318       AND
  9319        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9320           IF (PB-I-INDV-GRP-OVRD = 'I')
  9321              OR
  9322           ((AM-IG = '1') AND
  9323           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9324              OR
  9325           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9326           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9327           (AM-IG NOT = '2'))
  9328              GO TO 03XX-GET-AH-ERPLAN.
  9329
  9330     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9331       AND
  9332        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9333           IF (PB-I-INDV-GRP-OVRD = 'G')
  9334              OR
  9335           ((AM-IG = '2') AND
  9336           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9337              OR
  9338           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9339           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9340           (AM-IG NOT = '1'))
  9341              GO TO 03XX-GET-AH-ERPLAN.
  9342
  9343     IF SUB5 LESS THAN +20
  9344        ADD +1                   TO SUB5
  9345        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9346
  9347     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9348        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9349
  9350     MOVE +1                    TO SUB5.
  9351
  9352 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9353
  9354     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9355                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9356
  9357     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9358       AND
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 172
* EL050.cbl
  9359        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9360        GO TO 03XX-GET-AH-ERPLAN.
  9361
  9362     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9363       AND
  9364        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9365           IF (PB-I-INDV-GRP-OVRD = 'I')
  9366              OR
  9367           ((AM-IG = '1') AND
  9368           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9369              OR
  9370           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9371           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9372           (AM-IG NOT = '2'))
  9373              GO TO 03XX-GET-AH-ERPLAN.
  9374
  9375     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9376       AND
  9377        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9378           IF (PB-I-INDV-GRP-OVRD = 'G')
  9379              OR
  9380           ((AM-IG = '2') AND
  9381           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9382              OR
  9383           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9384           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9385           (AM-IG NOT = '1'))
  9386              GO TO 03XX-GET-AH-ERPLAN.
  9387
  9388     IF SUB5 LESS THAN +30
  9389        ADD +1                   TO SUB5
  9390        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9391
  9392 03XX-EDIT-FOR-NINETY-AH-CONT.
  9393
  9394     MOVE +99                    TO SUB5.
  9395
  9396     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9397
  9398     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9399        IF PB-ISSUE
  9400           MOVE ER-1925          TO  WS-ERROR
  9401           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9402
  9403     GO TO 0314-A-H-BENEFIT-FOUND.
  9404
  9405 03XX-GET-AH-ERPLAN.
  9406
  9407     IF WK-PLAN-ADDR EQUAL +0
  9408         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9409
  9410     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9411     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9412     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9413     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9414     MOVE 'Y'                    TO PLAN-MASTER-SW
  9415                                    PLAN-MASTER-AH-SW.
  9416*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 173
* EL050.cbl
  9417     GO TO 03XX-ERPLAN-AH-READ.
  9418
  9419 03XX-ERPLAN-AH-GETMAIN.
  9420
  9421     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9422     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9423
  9424 03XX-ERPLAN-AH-READ.
  9425
  9426     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9427     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9428     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9429     MOVE PB-SV-STATE            TO PLAN-STATE.
  9430     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9431     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9432     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9433     MOVE WS-SAVE-BENEFIT-REVISION
  9434                                 TO PLAN-REVISION-NO.
  9435
  9436     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9437     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9438
  9439     IF PB-COMPANY-ID = 'NCL'
  9440       IF NOT AH-PLAN-MASTER-FOUND
  9441         IF NOT PB-POLICY-IS-DECLINED  AND
  9442            NOT PB-POLICY-IS-VOIDED
  9443             MOVE  ER-1922         TO  WS-ERROR
  9444             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9445             GO TO 0314-A-H-BENEFIT-FOUND.
  9446
  9447     IF NOT AH-PLAN-MASTER-FOUND
  9448        GO TO 0314-A-H-BENEFIT-FOUND.
  9449
  9450 XXXX-CHECK-AH-PLAN-KEY.
  9451
  9452     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9453        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9454        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9455        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9456        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9457        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9458        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9459        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9460        MOVE 'N'                 TO PLAN-MASTER-SW
  9461          GO TO 03XX-ERPLAN-AH-READ.
  9462
  9463     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9464
  9465     IF  PB-CANCELLATION
  9466         GO TO  0313-AH-ACCT-BEN-FOUND.
  9467
  9468     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9469       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9470          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9471          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9472             MOVE ER-2644             TO WS-ERROR
  9473             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9474          ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 174
* EL050.cbl
  9475             NEXT SENTENCE
  9476       ELSE
  9477          IF PB-COMPANY-ID NOT = 'NCL'
  9478             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9479                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9480
  9481 0313-AH-ACCT-BEN-FOUND.
  9482
  9483     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9484
  9485     IF PL-DEV-CODE NOT = SPACES
  9486        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9487
  9488     IF PL-DEV-PCT NUMERIC AND
  9489        PL-DEV-PCT NOT = ZEROS
  9490        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9491
  9492     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9493        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9494
  9495     IF PL-TOL-REF-AMT NOT EQUAL +0
  9496        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9497
  9498     IF PL-TOL-PREM-PCT GREATER THAN +0
  9499        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9500
  9501     IF PL-TOL-REF-PCT GREATER THAN +0
  9502        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9503
  9504     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9505        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9506
  9507     IF PL-OVER-SHORT-AMT NUMERIC AND
  9508                          PL-OVER-SHORT-AMT > +0
  9509        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9510
  9511     IF PL-OVER-SHORT-PCT NUMERIC AND
  9512                          PL-OVER-SHORT-PCT > +0
  9513        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9514
  9515     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9516        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9517        IF WS-IG-OVRD-AM EQUAL SPACES
  9518            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9519
  9520 0314-A-H-BENEFIT-FOUND.
  9521
  9522     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9523
  9524     IF PB-ISSUE
  9525        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9526       ELSE
  9527        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9528
  9529     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9530     if cf-maximum-benefits (sub3) numeric
  9531        move cf-maximum-benefits (sub3)
  9532                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 175
* EL050.cbl
  9533     else
  9534        move zeros               to ws-ah-max-bens
  9535     end-if
  9536     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9537     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9538     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9539                                         WS-AH-REFUND-CALC.
  9540
  9541     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9542        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9543
  9544     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9545        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9546     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9547
  9548     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9549     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9550     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9551     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9552     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9553     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9554
  9555     IF PB-COMPANY-ID = 'NCL'  AND
  9556        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9557         NEXT SENTENCE
  9558     ELSE
  9559         IF SUB5 NOT GREATER THAN +20
  9560            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9561                MOVE WS-SAVE-BENEFIT-REM-TERM
  9562                                      TO WS-AM-AH-BENE-REM-TERM
  9563                                         EC-BR-AH-REM-TERM-CALC.
  9564
  9565     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9566     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9567
  9568     GO TO 0400-FIND-CARRIER.
  9569
  9570 0399-BENEFIT-NOT-FOUND.
  9571
  9572     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9573     MOVE ER-2605                TO WS-ERROR.
  9574     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9575
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 176
* EL050.cbl
  9577
  9578 0400-FIND-CARRIER.
  9579
  9580     MOVE PB-SV-CARRIER          TO WS-CARR.
  9581
  9582     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9583     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9584     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9585     MOVE '6'                    TO CNTL-REC-TYPE.
  9586
  9587*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9588     MOVE SPACE                  TO WS-DMD-RATING-SW
  9589                                    EC-BR-DMD-RATING-SW.
  9590
  9591     MOVE '2'                    TO RC-SW-1.
  9592     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9593
  9594     IF NOT CF-CARRIER-MASTER
  9595        GO TO 0400-CARRIER-NOT-FOUND.
  9596
  9597 0400-BUILD-CARR-TOL.
  9598
  9599     IF CF-CR-TOL-PREM NUMERIC AND
  9600        CF-CR-TOL-PREM GREATER THAN +0
  9601        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9602                                    WS-TOL-AH-PREM.
  9603
  9604     IF CF-CR-TOL-REFUND NUMERIC AND
  9605        CF-CR-TOL-REFUND GREATER THAN +0
  9606        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9607                                    WS-TOL-AH-REFUND.
  9608
  9609     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9610        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9611        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9612                                    WS-AH-REFUND-OVS-AMT.
  9613
  9614     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9615        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9616        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9617                                    WS-AH-REFUND-OVS-PCT.
  9618
  9619     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9620        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9621        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9622                                    WS-TOL-AH-PREM-PCT.
  9623
  9624     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9625        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9626        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9627                                     WS-TOL-AH-REFUND-PCT.
  9628
  9629     IF CF-COMPANY-ID EQUAL 'DMD'
  9630         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9631                                    EC-BR-DMD-RATING-SW.
  9632
  9633     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9634     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 177
* EL050.cbl
  9635        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9636     END-IF
  9637     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9638        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9639     END-IF
  9640     IF WS-TOL-CLP-PCT = ZEROS
  9641        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9642     END-IF
  9643
  9644     IF WS-SPP-LEASE-COMM = ZEROS
  9645        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9646     END-IF
  9647     GO TO 0400-FIND-ERPDEF.
  9648
  9649 0400-CARRIER-NOT-FOUND.
  9650
  9651     MOVE ER-2602                TO WS-ERROR.
  9652     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9653
  9654 0400-FIND-ERPDEF.
  9655*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9656     IF (PB-COMPANY-ID = 'DCC')
  9657        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9658        CONTINUE
  9659     ELSE
  9660        GO TO 0400-FIND-ERCOMP
  9661     END-IF
  9662     MOVE ' '                    TO PDEF-MASTER-SW
  9663     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9664     MOVE PB-STATE               TO ERPDEF-STATE
  9665     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9666        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9667     END-IF
  9668     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9669     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9670     IF PB-ISSUE
  9671        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9672     ELSE
  9673        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9674     END-IF
  9675     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9676     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9677     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9678     IF PDEF-MASTER-FOUND
  9679        MOVE 'N'                 TO PDEF-MASTER-SW
  9680        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9681        IF PDEF-MASTER-FOUND
  9682           IF (ERPDEF-KEY-SAVE (1:16) =
  9683                        PD-CONTROL-PRIMARY (1:16))
  9684              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9685              CONTINUE
  9686           ELSE
  9687              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9688              IF (ERPDEF-KEY-SAVE (1:16) =
  9689                        PD-CONTROL-PRIMARY (1:16))
  9690                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9691                 CONTINUE
  9692              ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 178
* EL050.cbl
  9693                 MOVE 'N'        TO PDEF-MASTER-SW
  9694              END-IF
  9695           END-IF
  9696        END-IF
  9697        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9698     END-IF
  9699     IF PDEF-MASTER-FOUND
  9700        IF PD-TRUNCATED = 'Y'
  9701           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9702        END-IF
  9703     END-IF
  9704     .
  9705 0400-FIND-ERCOMP.
  9706     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9707        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9708           (WS-SUB1 > +10)
  9709           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9710                 OR 'A' OR 'N'
  9711              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9712              MOVE PB-CARRIER    TO COMP-CARRIER
  9713              MOVE PB-GROUPING   TO COMP-GROUPING
  9714              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9715              MOVE AM-AGT (WS-SUB1)
  9716                                 TO COMP-FIN-RESP
  9717              MOVE 'G'           TO COMP-TYPE
  9718              PERFORM 8582-READ-COMPENSATION-MASTER
  9719                                 THRU 8582-EXIT
  9720              IF COMP-MASTER-FOUND
  9721                 IF CO-GA-INACTIVE
  9722                    MOVE ER-2763 TO WS-ERROR
  9723                    PERFORM 9900-ERROR-FORMAT
  9724                                 THRU 9900-EXIT
  9725                    MOVE +11     TO WS-SUB1
  9726                 END-IF
  9727                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9728                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9729                    MOVE ER-2788 TO WS-ERROR
  9730                    PERFORM 9900-ERROR-FORMAT
  9731                                 THRU 9900-EXIT
  9732                    MOVE +11     TO WS-SUB1
  9733                 END-IF
  9734              END-IF
  9735           END-IF
  9736        END-PERFORM
  9737     END-IF
  9738     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9739        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9740           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9741                                    WS-CLP-STATE
  9742        ELSE
  9743           MOVE SPACES           TO PB-I-CLP-STATE
  9744                                    WS-CLP-STATE
  9745        END-IF
  9746     END-IF
  9747
  9748     IF (PB-COMPANY-ID = 'DCC')
  9749        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9750        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 179
* EL050.cbl
  9751        CONTINUE
  9752     ELSE
  9753        GO TO 0400-FIND-STATE-RECORD
  9754     END-IF
  9755     MOVE SPACES                 TO WS-CLP-STATE
  9756     MOVE +0                     TO WS-BANK-FEE
  9757                                    WS-BANK-LFEE
  9758                                    WS-BANK-NOCHRGB
  9759
  9760     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9761     IF (PB-ISSUE)
  9762        AND (PB-I-BANK-NUMBER NOT =
  9763            SPACES AND ZEROS AND LOW-VALUES)
  9764        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9765     ELSE
  9766        IF (PB-CANCELLATION)
  9767           AND (PB-CI-BANK-NUMBER NOT =
  9768                SPACES AND ZEROS AND LOW-VALUES)
  9769           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9770        END-IF
  9771     END-IF
  9772     IF COMP-FIN-RESP NOT = LOW-VALUES
  9773        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9774        MOVE PB-CARRIER          TO COMP-CARRIER
  9775        MOVE PB-GROUPING         TO COMP-GROUPING
  9776        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9777        MOVE 'B'                 TO COMP-TYPE
  9778        PERFORM 8582-READ-COMPENSATION-MASTER
  9779                                 THRU 8582-EXIT
  9780        IF COMP-MASTER-FOUND
  9781           IF CO-MAX-BANK-FEE NOT NUMERIC
  9782              MOVE +0            TO CO-MAX-BANK-FEE
  9783           END-IF
  9784           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9785              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9786           END-IF
  9787           IF CO-GA-INACTIVE
  9788              MOVE ER-2763       TO WS-ERROR
  9789              PERFORM 9900-ERROR-FORMAT
  9790                                 THRU 9900-EXIT
  9791           END-IF
  9792           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9793              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9794              MOVE ER-2788 TO WS-ERROR
  9795              PERFORM 9900-ERROR-FORMAT
  9796                                 THRU 9900-EXIT
  9797              MOVE +11     TO WS-SUB1
  9798           END-IF
  9799           IF WS-AH-BEN-CATEGORY = 'G'
  9800              MOVE CO-MAX-BANK-FEE
  9801                                 TO WS-BANK-FEE
  9802                                    PB-I-BANK-FEE
  9803           ELSE
  9804              MOVE CO-MAX-BANK-FEE-LEASE
  9805                                 TO WS-BANK-LFEE
  9806                                    PB-I-BANK-FEE
  9807           END-IF
  9808           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 180
* EL050.cbl
  9809              AND (WS-AH-REFUND-CALC = 'G'))
  9810                        OR
  9811              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9812              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9813              CONTINUE
  9814           ELSE
  9815              MOVE ER-2789 TO WS-ERROR
  9816              PERFORM 9900-ERROR-FORMAT
  9817                                 THRU 9900-EXIT
  9818           END-IF
  9819           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9820                                    PB-I-CLP-STATE
  9821           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9822           MOVE CO-CARRIER       TO BXRF-CARRIER
  9823           MOVE CO-GROUPING      TO BXRF-GROUPING
  9824           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9825           MOVE BXRF-MAX-REC-LENGTH
  9826                                 TO BXRF-REC-LENGTH
  9827           PERFORM 8584-READ-BANK-CROSS-REF
  9828                                 THRU 8584-EXIT
  9829           IF BXRF-MASTER-FOUND
  9830              MOVE ' '           TO BANK-ACCT-SW
  9831              MOVE BK-BANK-POINTER-CNT
  9832                                 TO BK-BANK-POINTER-CNT
  9833              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9834                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9835                 OR (BANK-ACCT-FOUND)
  9836                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9837                    AND (BK-AM-EXP-DT (WS-SUB1)
  9838                                 > PB-CERT-EFF-DT)
  9839                    AND (BK-AM-EFF-DT (WS-SUB1)
  9840                                 NOT > PB-CERT-EFF-DT)
  9841                    SET BANK-ACCT-FOUND TO TRUE
  9842                 END-IF
  9843              END-PERFORM
  9844              IF NOT BANK-ACCT-FOUND
  9845                 MOVE ZEROS      TO WS-BANK-FEE
  9846                                    WS-BANK-LFEE
  9847                 MOVE ER-2869    TO WS-ERROR
  9848                 PERFORM 9900-ERROR-FORMAT
  9849                                 THRU 9900-EXIT
  9850              ELSE
  9851                 PERFORM 5000-PROCESS-REPS
  9852                                 THRU 5000-EXIT
  9853                 IF AGENT-MASTER-FOUND
  9854                    MOVE +0      TO WS-BANK-FEE
  9855                                    WS-BANK-LFEE
  9856*                   MOVE AG-SPP-FEES (1)
  9857*                                TO PB-I-BANK-FEE
  9858*                                   WS-BANK-FEE
  9859                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9860                       (WS-SUB1 > +10)
  9861                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9862                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9863                       END-IF
  9864                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9865                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9866                       END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 181
* EL050.cbl
  9867                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9868                          AG-SPP-FEES (WS-SUB1)
  9869                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9870                          AG-SPP-LFEES (WS-SUB1)
  9871                    END-PERFORM
  9872                    IF WS-AH-BEN-CATEGORY = 'G'
  9873                       MOVE WS-BANK-FEE
  9874                                 TO PB-I-BANK-FEE
  9875                    ELSE
  9876                       MOVE WS-BANK-LFEE
  9877                                 TO PB-I-BANK-FEE
  9878                    END-IF
  9879                 END-IF
  9880              END-IF
  9881           END-IF
  9882        ELSE
  9883           MOVE ER-2879          TO WS-ERROR
  9884           PERFORM 9900-ERROR-FORMAT
  9885                                 THRU 9900-EXIT
  9886        END-IF
  9887     ELSE
  9888        MOVE ER-2879             TO WS-ERROR
  9889        PERFORM 9900-ERROR-FORMAT
  9890                                 THRU 9900-EXIT
  9891     END-IF
  9892     IF WS-AH-BEN-CATEGORY = 'G'
  9893        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9894        + WS-BANK-FEE
  9895     ELSE
  9896        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9897        + WS-BANK-LFEE
  9898     END-IF
  9899     .
  9900 0400-FIND-STATE-RECORD.
  9901
  9902     IF WK-STATE-ADDR NOT = ZEROS
  9903         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9904         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9905         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9906         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9907         IF PB-SV-STATE = CF-STATE-CODE
  9908             GO TO 0405-CONTINUE-EDIT
  9909         ELSE
  9910             NEXT SENTENCE
  9911     ELSE
  9912         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9913
  9914     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9915     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9916     MOVE '3'                    TO CNTL-REC-TYPE.
  9917     MOVE +0                     TO CNTL-SEQ-NO.
  9918
  9919     MOVE '3'                    TO RC-SW-2.
  9920     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9921
  9922     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9923        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9924        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 182
* EL050.cbl
  9925        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9926                                    WS-TOL-AH-CLAIM
  9927                                    WS-MINIMUM-REFUND
  9928                                    WS-TOL-LF-PREM
  9929                                    WS-TOL-AH-PREM
  9930                                    WS-TOL-LF-REFUND
  9931                                    WS-TOL-AH-REFUND
  9932                                    EC-ST-TOL-PREM-PCT
  9933                                    WS-TOL-LF-PREM-PCT
  9934                                    WS-TOL-AH-PREM-PCT
  9935                                    EC-ST-TOL-REFUND-PCT
  9936                                    WS-TOL-LF-REFUND-PCT
  9937                                    WS-TOL-AH-REFUND-PCT
  9938                                    EC-ST-TOL-PREM
  9939                                    EC-ST-TOL-REFUND
  9940                                    EC-ST-FST-PMT-DAYS-MAX
  9941                                    WS-FREE-LOOK-PERIOD
  9942                                    WS-ST-LF-PREM-TAX
  9943                                    WS-ST-AH-PREM-TAX-I
  9944                                    WS-ST-AH-PREM-TAX-G
  9945                                    WS-BANK-FEE
  9946                                    WS-BANK-LFEE
  9947                                    WS-TOL-CLP-PCT
  9948                                    WS-SPP-LEASE-COMM
  9949                                    WS-INT-PERIODS
  9950                                    WS-EXTRA-PMTS
  9951        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9952                                    EC-ST-FST-PMT-DAYS-CHG
  9953                                    WS-LF-REM-TERM-CALC
  9954                                    WS-LF-REFUND-CALC
  9955                                    EC-ST-LF-REM-TERM-CALC
  9956                                    EC-ST-LF-REFUND-CALC
  9957                                    WS-AH-REM-TERM-CALC
  9958                                    WS-AH-REFUND-CALC
  9959                                    WS-LF-BEN-CATEGORY
  9960                                    WS-AH-BEN-CATEGORY
  9961                                    WS-CLP-STATE
  9962                                    WS-ST-REFUND-CLAIM-FLAG
  9963                                    WS-ST-CAUSAL-STATE
  9964                                    ws-st-agent-sig-edit
  9965                                    EC-ST-AH-REM-TERM-CALC
  9966                                    EC-ST-AH-REFUND-CALC
  9967          GO TO 0499-STATE-NOT-FOUND.
  9968
  9969     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9970
  9971 0405-CONTINUE-EDIT.
  9972
  9973     IF (PB-COMPANY-ID <> 'AHL')
  9974        and (pb-issue)
  9975        MOVE +0                  TO SUB3
  9976        INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9977        IF SUB3 > +0
  9978           MOVE ER-3270          TO WS-ERROR
  9979           PERFORM 9900-ERROR-FORMAT
  9980                                 THRU 9900-EXIT
  9981        else
  9982           IF PB-CERT-PRIME NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 183
* EL050.cbl
  9983              MOVE ER-2722       TO WS-ERROR
  9984              PERFORM 9900-ERROR-FORMAT
  9985                                 THRU 9900-EXIT
  9986           end-if
  9987        END-IF
  9988     END-IF
  9989     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9990
  9991     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9992        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9993                                    WS-TOL-AH-CLAIM.
  9994
  9995     IF CF-ST-REFUND-MIN NOT NUMERIC
  9996        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9997
  9998     IF CF-ST-REFUND-MIN NOT = ZEROS
  9999        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
 10000
 10001     IF CF-ST-TOL-PREM  NOT = ZEROS
 10002        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
 10003                                    WS-TOL-AH-PREM
 10004        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
 10005
 10006     IF CF-ST-TOL-REFUND NOT = ZEROS
 10007        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
 10008                                    WS-TOL-AH-REFUND
 10009        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
 10010
 10011     IF CF-ST-OVR-SHT-AMT NUMERIC AND
 10012        CF-ST-OVR-SHT-AMT GREATER THAN +0
 10013        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
 10014                                    WS-AH-REFUND-OVS-AMT
 10015                                    EC-ST-OVR-SHT-AMT.
 10016
 10017     IF CF-ST-TOL-PREM-PCT NUMERIC AND
 10018        CF-ST-TOL-PREM-PCT GREATER THAN +0
 10019        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
 10020                                    WS-TOL-LF-PREM-PCT
 10021                                    WS-TOL-AH-PREM-PCT.
 10022
 10023     IF CF-ST-TOL-REF-PCT NUMERIC AND
 10024        CF-ST-TOL-REF-PCT GREATER THAN +0
 10025        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
 10026                                    WS-TOL-LF-REFUND-PCT
 10027                                    WS-TOL-AH-REFUND-PCT.
 10028
 10029     IF CF-ST-OVR-SHT-PCT NUMERIC AND
 10030        CF-ST-OVR-SHT-PCT GREATER THAN +0
 10031        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
 10032                                    WS-AH-REFUND-OVS-PCT
 10033                                    EC-ST-OVR-SHT-PCT.
 10034
 10035     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
 10036     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
 10037
 10038     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
 10039          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
 10040
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 184
* EL050.cbl
 10041     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
 10042     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
 10043     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
 10044
 10045     IF CF-ST-LF-PREM-TAX NUMERIC
 10046        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10047     END-IF
 10048     IF CF-ST-AH-PREM-TAX-I NUMERIC
 10049        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10050     END-IF
 10051     IF CF-ST-AH-PREM-TAX-G NUMERIC
 10052        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10053     END-IF
 10054
 10055     IF CF-ST-REF-AH-DEATH-IND > SPACES
 10056         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 10057     END-IF.
 10058
 10059     IF CF-ST-CAUSAL-STATE > SPACES
 10060         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
 10061     END-IF.
 10062     if cf-st-extra-interest-periods not numeric
 10063        move zeros               to cf-st-extra-interest-periods
 10064     end-if
 10065     if cf-st-extra-payments not numeric
 10066        move zeros               to cf-st-extra-payments
 10067     end-if
 10068
 10069     move cf-st-extra-interest-periods
 10070                                 to ws-int-periods
 10071     move cf-st-extra-payments   to ws-extra-pmts
 10072     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
 10073     move cf-st-net-only-state   to ws-net-only-state
 10074     if cf-st-comm-cap-sl not numeric
 10075        move zeros               to cf-st-comm-cap-sl
 10076     end-if
 10077     if cf-st-comm-cap-jl not numeric
 10078        move zeros               to cf-st-comm-cap-jl
 10079     end-if
 10080     if cf-st-comm-cap-sa not numeric
 10081        move zeros               to cf-st-comm-cap-sa
 10082     end-if
 10083     if cf-st-comm-cap-ja not numeric
 10084        move zeros               to cf-st-comm-cap-ja
 10085     end-if
 10086     if cf-st-ga-comm-cap-sl not numeric
 10087        move zeros               to cf-st-ga-comm-cap-sl
 10088     end-if
 10089     if cf-st-ga-comm-cap-jl not numeric
 10090        move zeros               to cf-st-ga-comm-cap-jl
 10091     end-if
 10092     if cf-st-ga-comm-cap-sa not numeric
 10093        move zeros               to cf-st-ga-comm-cap-sa
 10094     end-if
 10095     if cf-st-ga-comm-cap-ja not numeric
 10096        move zeros               to cf-st-ga-comm-cap-ja
 10097     end-if
 10098
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 185
* EL050.cbl
 10099     if cf-st-tot-comm-cap-sl not numeric
 10100        move zeros               to cf-st-tot-comm-cap-sl
 10101     end-if
 10102     if cf-st-tot-comm-cap-jl not numeric
 10103        move zeros               to cf-st-tot-comm-cap-jl
 10104     end-if
 10105     if cf-st-tot-comm-cap-sa not numeric
 10106        move zeros               to cf-st-tot-comm-cap-sa
 10107     end-if
 10108     if cf-st-tot-comm-cap-ja not numeric
 10109        move zeros               to cf-st-tot-comm-cap-ja
 10110     end-if
 10111
 10112     move cf-comm-cap-limit-to   to ws-st-cap-limit-to
 10113     move cf-st-comm-cap-sl      to ws-st-comm-cap-sl
 10114     move cf-st-comm-cap-jl      to ws-st-comm-cap-jl
 10115     move cf-st-comm-cap-sa      to ws-st-comm-cap-sa
 10116     move cf-st-comm-cap-ja      to ws-st-comm-cap-ja
 10117     move cf-st-ga-comm-cap-sl   to ws-st-ga-comm-cap-sl
 10118     move cf-st-ga-comm-cap-jl   to ws-st-ga-comm-cap-jl
 10119     move cf-st-ga-comm-cap-sa   to ws-st-ga-comm-cap-sa
 10120     move cf-st-ga-comm-cap-ja   to ws-st-ga-comm-cap-ja
 10121     move cf-st-tot-comm-cap-sl  to ws-st-tot-comm-cap-sl
 10122     move cf-st-tot-comm-cap-jl  to ws-st-tot-comm-cap-jl
 10123     move cf-st-tot-comm-cap-sa  to ws-st-tot-comm-cap-sa
 10124     move cf-st-tot-comm-cap-ja  to ws-st-tot-comm-cap-ja
 10125     IF WS-LF-BENEFIT-CD = ZEROS
 10126        GO TO 0410-CHECK-AH.
 10127
 10128     IF CF-ST-RT-CALC NOT = SPACES
 10129        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10130                                    EC-ST-LF-REM-TERM-CALC
 10131     END-IF
 10132
 10133     IF WS-LF-COVERAGE-TYPE = 'R'
 10134        IF WS-LF-EARNINGS-CALC = '5'
 10135           IF CF-ST-RF-LN-CALC > '0'
 10136              MOVE CF-ST-RF-LN-CALC
 10137                                 TO WS-LF-REFUND-CALC
 10138                                    EC-ST-LF-REFUND-CALC
 10139           END-IF
 10140        ELSE
 10141           IF CF-ST-RF-LR-CALC > '0'
 10142              MOVE CF-ST-RF-LR-CALC
 10143                                 TO WS-LF-REFUND-CALC
 10144                                    EC-ST-LF-REFUND-CALC
 10145           END-IF
 10146        END-IF
 10147     ELSE
 10148        IF CF-ST-RF-LL-CALC > '0'
 10149           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 10150                                    EC-ST-LF-REFUND-CALC
 10151        END-IF
 10152     END-IF
 10153
 10154     IF CF-ST-RT-CALC NOT = SPACES
 10155        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10156                                    EC-ST-LF-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 186
* EL050.cbl
 10157     END-IF
 10158
 10159     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
 10160     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
 10161
 10162     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10163
 10164     IF NO-BENEFIT-FOUND
 10165        GO TO 0410-CHECK-AH.
 10166
 10167     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10168        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 10169                                 TO EC-ST-LF-REM-TERM-CALC
 10170                                    WS-LF-REM-TERM-CALC
 10171     END-IF
 10172
 10173     IF CF-ST-REFUND-CALC (SUB3) > '0'
 10174        MOVE CF-ST-REFUND-CALC (SUB3)
 10175                                 TO WS-LF-REFUND-CALC
 10176                                    EC-ST-LF-REFUND-CALC
 10177     END-IF
 10178*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
 10179     if cf-st-extra-periods (sub3) not numeric
 10180        move zeros               to cf-st-extra-periods (sub3)
 10181     end-if
 10182     if cf-st-extra-periods (sub3) > zeros
 10183        if ws-lf-ben-category = 'P'
 10184           move cf-st-extra-periods (sub3)
 10185                                 to ws-extra-pmts
 10186        else
 10187           if ws-lf-ben-category = 'I'
 10188              move cf-st-extra-periods (sub3)
 10189                                 to ws-int-periods
 10190           end-if
 10191        end-if
 10192     end-if
 10193     .
 10194 0410-CHECK-AH.
 10195
 10196     IF WS-AH-BENEFIT-CD = ZEROS
 10197        GO TO 0500-SET-ACCOUNT.
 10198
 10199     IF CF-ST-RT-CALC NOT = SPACES
 10200        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10201                                    EC-ST-AH-REM-TERM-CALC
 10202     END-IF
 10203
 10204     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10205        IF CF-ST-RF-CP-CALC > '0'
 10206           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10207                                    EC-ST-AH-REFUND-CALC
 10208        END-IF
 10209     ELSE
 10210        IF CF-ST-RF-AH-CALC > '0'
 10211           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10212                                    EC-ST-AH-REFUND-CALC
 10213        END-IF
 10214     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 187
* EL050.cbl
 10215     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
 10216     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
 10217
 10218     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10219
 10220     IF NO-BENEFIT-FOUND
 10221        GO TO 0500-SET-ACCOUNT.
 10222
 10223     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10224        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10225                                 TO WS-AH-REM-TERM-CALC
 10226                                    EC-ST-AH-REM-TERM-CALC
 10227     END-IF
 10228
 10229     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10230        MOVE CF-ST-REFUND-CALC (SUB3)
 10231                                 TO WS-AH-REFUND-CALC
 10232                                    EC-ST-AH-REFUND-CALC
 10233     END-IF
 10234
 10235*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10236
 10237     GO TO 0500-SET-ACCOUNT.
 10238
 10239 0499-STATE-NOT-FOUND.
 10240
 10241     MOVE ER-2603                TO WS-ERROR.
 10242     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10243
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 188
* EL050.cbl
 10245
 10246 0500-SET-ACCOUNT.
 10247*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10248     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10249        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10250        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10251        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10252        MOVE '3'                 TO CNTL-REC-TYPE
 10253        MOVE +0                  TO CNTL-SEQ-NO
 10254
 10255        MOVE '3'                 TO RC-SW-2
 10256        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10257
 10258        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10259           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10260           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10261           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10262                                    WS-ST-AH-PREM-TAX-I
 10263                                    WS-ST-AH-PREM-TAX-G
 10264        ELSE
 10265           IF CF-ST-LF-PREM-TAX NUMERIC
 10266              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10267           END-IF
 10268           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10269              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10270           END-IF
 10271           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10272              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10273           END-IF
 10274        END-IF
 10275        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10276     END-IF
 10277*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10278*  FOR DCC ONLY
 10279     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10280
 10281        MOVE ' '                 TO STAT-MASTER-SW
 10282        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10283        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10284        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10285        MOVE PB-STATE            TO ELSTAT-STATE
 10286        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10287           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10288        END-IF
 10289
 10290        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10291        SET BIN-TO-GREG          TO TRUE
 10292        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10293        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10294        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10295
 10296        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10297        IF STAT-MASTER-FOUND
 10298           MOVE 'N'              TO STAT-MASTER-SW
 10299           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10300           IF STAT-MASTER-FOUND
 10301              IF (ELSTAT-KEY-SAVE (1:12) =
 10302                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 189
* EL050.cbl
 10303                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10304                    MOVE 'F'        TO STAT-MASTER-SW
 10305                 ELSE
 10306                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10307                    IF (STAT-MASTER-FOUND)
 10308                       AND (ELSTAT-KEY-SAVE (1:12) =
 10309                           SF-CONTROL-PRIMARY (1:12))
 10310                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10311                       MOVE 'F'     TO STAT-MASTER-SW
 10312                    END-IF
 10313                 END-IF
 10314              END-IF
 10315           END-IF
 10316        END-IF
 10317
 10318        IF STAT-MASTER-SW = 'F'
 10319           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10320              and (sf-st-lf-prem-tax > zeros)
 10321              MOVE SF-ST-LF-PREM-TAX
 10322                                 TO WS-ST-LF-PREM-TAX
 10323           END-IF
 10324           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10325              and (sf-st-ah-prem-tax-i > zeros)
 10326              MOVE SF-ST-AH-PREM-TAX-I
 10327                                 TO WS-ST-AH-PREM-TAX-I
 10328           END-IF
 10329           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10330              and (sf-st-ah-prem-tax-g > zeros)
 10331              MOVE SF-ST-AH-PREM-TAX-G
 10332                                 TO WS-ST-AH-PREM-TAX-G
 10333           END-IF
 10334        END-IF
 10335     END-IF
 10336     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10337        AND (PB-ISSUE)
 10338        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10339        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10340        AND (AM-GPCD = 06)
 10341        MOVE 'Y'                 TO WS-GOOD-HIN
 10342        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10343           MOVE PB-I-VIN         TO WS-WORK-VIN
 10344           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10345              (V1 > 16)
 10346              IF WS-WORK-VIN (V1:1) NUMERIC
 10347                 MOVE WS-WORK-VIN-N (V1)
 10348                                 TO WS-ROW-B-VAL (V1)
 10349              ELSE
 10350                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10351                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10352                    OR (V2 > 26)
 10353                 END-PERFORM
 10354                 IF V2 < 27
 10355                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10356                 ELSE
 10357                    MOVE 'N'     TO WS-GOOD-HIN
 10358                 END-IF
 10359              END-IF
 10360              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 190
* EL050.cbl
 10361                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10362              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10363                 WS-ROW-D-VAL (V1)
 10364           END-PERFORM
 10365           MOVE ZEROS            TO WS-VIN-REMAINDER
 10366           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10367             REMAINDER WS-VIN-REMAINDER
 10368           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10369              CONTINUE
 10370           ELSE
 10371              MOVE 'N'           TO WS-GOOD-HIN
 10372           END-IF
 10373        ELSE
 10374           MOVE 'N'              TO WS-GOOD-HIN
 10375        END-IF
 10376        IF WS-GOOD-HIN NOT = 'Y'
 10377           MOVE ER-3826           TO WS-ERROR
 10378           PERFORM 9900-ERROR-FORMAT
 10379                                 THRU 9900-EXIT
 10380        END-IF
 10381     END-IF
 10382     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10383        AND (PB-ISSUE)
 10384        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10385        AND (AM-GPCD NOT = 06)
 10386        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10387           perform 3400-edit-vin thru 3400-exit
 10388        ELSE
 10389          MOVE ER-3826           TO WS-ERROR
 10390          PERFORM 9900-ERROR-FORMAT
 10391                                 THRU 9900-EXIT
 10392        END-IF
 10393     END-IF
 10394     if (pb-company-id = 'CID')
 10395        and (pb-issue)
 10396        and (pb-i-vin not = spaces and low-values and zeros)
 10397        perform 3400-edit-vin    thru 3400-exit
 10398     end-if
 10399******************************************************************
 10400******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10401******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10402******* METHODS.
 10403******************************************************************
 10404     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10405        IF PB-CANCELLATION
 10406           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10407              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10408                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10409                IF FORM-MASTER-FOUND
 10410                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10411******************************************************************
 10412
 10413     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10414     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10415
 10416     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10417     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10418     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 191
* EL050.cbl
 10419     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10420
 10421
 10422     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10423     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10424     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10425
 10426     IF AM-LF-OB-RATE NOT NUMERIC
 10427         MOVE ZERO               TO AM-LF-OB-RATE.
 10428
 10429     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10430         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10431
 10432     IF AM-AH-OB-RATE NOT NUMERIC
 10433         MOVE ZERO               TO AM-AH-OB-RATE.
 10434
 10435     IF WS-LF-JOINT-INDICATOR = 'J'
 10436         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10437     ELSE
 10438         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10439
 10440     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10441
 10442     IF WS-IG-OVRD-AM  EQUAL SPACE
 10443         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10444
 10445     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10446         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10447                                       WS-IG-OVRD
 10448     ELSE
 10449         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10450             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10451                                       WS-IG-OVRD
 10452         ELSE
 10453             MOVE AM-IG             TO WS-IG-OVRD-AH
 10454                                       WS-IG-OVRD.
 10455
 10456     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10457         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10458                                       WS-IG-OVRD
 10459     ELSE
 10460         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10461             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10462                                       WS-IG-OVRD
 10463         ELSE
 10464             MOVE AM-IG             TO WS-IG-OVRD-LF
 10465                                       WS-IG-OVRD.
 10466
 10467     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10468     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10469     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10470     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10471*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10472     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10473                                              TO 'PRLDSFCTIA'.
 10474
 10475     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10476     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 192
* EL050.cbl
 10477     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10478     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10479
 10480     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10481     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10482     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10483     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10484     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10485     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10486     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10487
 10488     IF WS-ACCT-AH-DEV-PCT > +0
 10489        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10490     ELSE
 10491        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10492
 10493     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10494        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10495     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10496        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10497
 10498        IF AM-EARN-METHOD-L = 'S'
 10499            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10500                                        WS-LF-REFUND-CALC.
 10501
 10502        IF AM-EARN-METHOD-R = 'S'
 10503            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10504                                        WS-LF-REFUND-CALC.
 10505
 10506     IF WS-LF-COVERAGE-TYPE = 'R'
 10507         IF AM-EARN-METHOD-R = 'R'
 10508            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10509                                    WS-LF-REFUND-CALC.
 10510     IF WS-LF-COVERAGE-TYPE = 'R'
 10511         IF AM-EARN-METHOD-R = 'P'
 10512            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10513                                    WS-LF-REFUND-CALC.
 10514     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10515         IF AM-EARN-METHOD-L = 'R'
 10516            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10517                                    WS-LF-REFUND-CALC.
 10518     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10519         IF AM-EARN-METHOD-L = 'P'
 10520            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10521                                    WS-LF-REFUND-CALC.
 10522     IF WS-LF-COVERAGE-TYPE = 'R'
 10523         IF AM-EARN-METHOD-R = 'A'
 10524            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10525                                    WS-LF-REFUND-CALC.
 10526     IF WS-LF-COVERAGE-TYPE = 'R'
 10527         IF AM-EARN-METHOD-R = 'M'
 10528            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10529                                    WS-LF-REFUND-CALC.
 10530     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10531         IF AM-EARN-METHOD-L = 'A'
 10532            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10533                                    WS-LF-REFUND-CALC.
 10534     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 193
* EL050.cbl
 10535         IF AM-EARN-METHOD-L = 'M'
 10536            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10537                                    WS-LF-REFUND-CALC.
 10538
 10539     IF AM-EARN-METHOD-A = 'R'
 10540        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10541                                    WS-AH-REFUND-CALC.
 10542     IF AM-EARN-METHOD-A = 'P'
 10543        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10544                                    WS-AH-REFUND-CALC.
 10545     IF AM-EARN-METHOD-A = 'C'
 10546        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10547                                    WS-AH-REFUND-CALC.
 10548     IF AM-EARN-METHOD-A = 'A'
 10549        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10550                                    WS-AH-REFUND-CALC.
 10551     IF AM-EARN-METHOD-A = 'M'
 10552        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10553                                    WS-AH-REFUND-CALC.
 10554     IF AM-EARN-METHOD-A = 'N'
 10555        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10556                                    WS-AH-REFUND-CALC.
 10557     IF AM-EARN-METHOD-A = 'S'
 10558        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10559                                    WS-AH-REFUND-CALC.
 10560
 10561     IF AM-TOL-PREM NOT = ZEROS
 10562        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10563                                    WS-TOL-AH-PREM.
 10564
 10565     IF AM-OVR-SHT-AMT NUMERIC AND
 10566                  AM-OVR-SHT-AMT > 0
 10567        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10568                                    EC-AM-LF-OVR-SHT-AMT
 10569                                    WS-AH-REFUND-OVS-AMT
 10570                                    EC-AM-AH-OVR-SHT-AMT.
 10571
 10572     IF AM-OVR-SHT-PCT NUMERIC AND
 10573                    AM-OVR-SHT-PCT > 0
 10574        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10575                                    EC-AM-LF-OVR-SHT-PCT
 10576                                    WS-AH-REFUND-OVS-PCT
 10577                                    EC-AM-AH-OVR-SHT-PCT.
 10578
 10579     IF AM-TOL-REF-PCT NUMERIC AND
 10580                  AM-TOL-REF-PCT > 0
 10581        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10582                                    WS-TOL-AH-REFUND-PCT.
 10583
 10584     IF AM-TOL-REF  NOT = ZEROS  AND
 10585                  AM-TOL-REF NUMERIC
 10586        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10587                                    EC-AM-LF-TOL-REFUND
 10588                                    WS-TOL-AH-REFUND
 10589                                    EC-AM-AH-TOL-REFUND.
 10590
 10591     IF AM-TOL-CLM  NOT = ZEROS
 10592        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 194
* EL050.cbl
 10593                                    WS-TOL-AH-CLAIM.
 10594
 10595     IF AM-CLP-TOL-PCT NOT NUMERIC
 10596        MOVE +0                  TO AM-CLP-TOL-PCT
 10597     END-IF
 10598
 10599     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10600        MOVE +0                  TO AM-SPP-LEASE-COMM
 10601     END-IF
 10602     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10603        MOVE WS-PL-TOL-LF-PREM-PCT
 10604                                 TO WS-TOL-LF-PREM-PCT.
 10605
 10606     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10607        MOVE WS-PL-TOL-AH-PREM-PCT
 10608                                 TO WS-TOL-AH-PREM-PCT.
 10609
 10610     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10611        MOVE WS-PL-TOL-LF-REFUND-PCT
 10612                                 TO WS-TOL-LF-REFUND-PCT.
 10613
 10614     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10615        MOVE WS-PL-TOL-AH-REFUND-PCT
 10616                                 TO WS-TOL-AH-REFUND-PCT.
 10617
 10618     IF WS-PL-REF-OVS-AMT > +0
 10619        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10620
 10621     IF WS-PL-REF-OVS-PCT > +0
 10622        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10623
 10624     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10625        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10626     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10627        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10628     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10629        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10630     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10631        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10632     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10633        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10634     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10635        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10636
 10637     IF WS-AH-PL-REF-OVS-AMT > +0
 10638        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10639
 10640     IF WS-AH-PL-REF-OVS-PCT > +0
 10641        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10642
 10643     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10644     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10645
 10646     IF PB-CANCELLATION
 10647        GO TO 3000-CONTINUE-EDIT.
 10648
 10649     MOVE +1 TO SUB1.
 10650     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 195
* EL050.cbl
 10651     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10652
 10653     IF CF-COMPANY-ID = 'DMD'
 10654       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10655         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10656        ELSE
 10657         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10658
 10659  0525-FIND-ACCT-COMM.
 10660     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10661        NEXT SENTENCE
 10662      ELSE
 10663         ADD +1 TO SUB1
 10664         IF SUB1 LESS +11
 10665            GO TO 0525-FIND-ACCT-COMM
 10666          ELSE
 10667             GO TO 0550-st-comm-cap-check.
 10668
 10669     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10670     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10671                                    PB-I-LIFE-COMMISSION.
 10672***  IF PB-COMPANY-ID = 'CRI'
 10673     IF PB-PREM-ACCTNG-ONLY
 10674         GO TO 0550-st-comm-cap-check.
 10675
 10676     MOVE '0530' TO CTBL-SW.
 10677     MOVE ' '    TO WS-CTBL-READ-SW.
 10678
 10679
 10680 0530-GET-AH-COMP.
 10681     IF NO-AH-COVERAGE  OR
 10682        NO-AH-BENEFIT-MATCH
 10683           GO TO 0540-NEXT-READ-STEP.
 10684
 10685     IF AM-A-COM (SUB1) NUMERIC
 10686        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10687         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10688         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10689         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10690         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10691     ELSE
 10692          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10693          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10694          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10695          MOVE ZEROS             TO WS-SUB1
 10696                                    WS-COMMISSION
 10697          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10698          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10699          IF WS-COMMISSION > ZEROS
 10700             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10701             GO TO 0540-NEXT-READ-STEP
 10702          END-IF
 10703          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10704          IF CTBL-TABLE-FOUND
 10705             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10706                                        PB-I-AH-TERM
 10707             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10708             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 196
* EL050.cbl
 10709             GO TO 0540-NEXT-READ-STEP
 10710          ELSE
 10711             IF FIRST-TIME-THROUGH
 10712                 GO TO 0530-GET-AH-COMP
 10713             ELSE
 10714                 MOVE ER-2609                TO WS-ERROR
 10715                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10716
 10717 0540-NEXT-READ-STEP.
 10718     MOVE '0540' TO CTBL-SW.
 10719     MOVE ' '    TO WS-CTBL-READ-SW.
 10720
 10721 0540-GET-LF-COMP.
 10722     IF NO-LIFE-COVERAGE  OR
 10723        NO-LF-BENEFIT-MATCH
 10724           GO TO 0550-st-comm-cap-check.
 10725
 10726     IF WS-LF-JOINT-INDICATOR = 'J'
 10727        IF AM-J-COM (SUB1) NUMERIC
 10728           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10729           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10730           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10731           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10732           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10733        ELSE
 10734           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10735           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10736           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10737           MOVE ZEROS                TO WS-SUB1
 10738                                        WS-COMMISSION
 10739           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10740           IF WS-COMMISSION > ZEROS
 10741              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10742              GO TO 0550-st-comm-cap-check
 10743           END-IF
 10744           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10745           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10746           IF CTBL-TABLE-FOUND
 10747              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10748              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10749              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10750              GO TO 0550-st-comm-cap-check
 10751           ELSE
 10752              IF FIRST-TIME-THROUGH
 10753                  GO TO 0540-GET-LF-COMP
 10754              ELSE
 10755                  MOVE ER-2609                TO WS-ERROR
 10756                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10757                  GO TO 0550-st-comm-cap-check.
 10758
 10759     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10760        IF AM-L-COM (SUB1) NUMERIC
 10761           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10762           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10763           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10764           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10765           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10766        ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 197
* EL050.cbl
 10767           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10768           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10769           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10770           MOVE ZEROS                TO WS-SUB1
 10771                                        WS-COMMISSION
 10772           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10773           IF WS-COMMISSION IS GREATER THAN ZEROS
 10774              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10775              GO TO 0550-st-comm-cap-check
 10776           END-IF
 10777           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10778           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10779           IF CTBL-TABLE-FOUND
 10780              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10781              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10782              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10783              GO TO 0550-st-comm-cap-check
 10784           ELSE
 10785              IF FIRST-TIME-THROUGH
 10786                  GO TO 0540-GET-LF-COMP
 10787              ELSE
 10788                  MOVE ER-2609                TO WS-ERROR
 10789                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10790
 10791 0550-st-comm-cap-check.
 10792
 10793     move +0                     to ws-tot-sl-wk-rate
 10794                                    ws-sl-wk-rate
 10795                                    ws-ga-sl-wk-rate
 10796                                    ws-tot-jl-wk-rate
 10797                                    ws-jl-wk-rate
 10798                                    ws-ga-jl-wk-rate
 10799                                    ws-tot-sa-wk-rate
 10800                                    ws-sa-wk-rate
 10801                                    ws-ga-sa-wk-rate
 10802                                    ws-tot-ja-wk-rate
 10803                                    ws-ja-wk-rate
 10804                                    ws-ga-ja-wk-rate
 10805     perform varying sub5 from +1 by +1 until
 10806        (sub5 > +10)
 10807        move +0                  to ws-wk-rate
 10808        if (am-gl-codes (sub5) <> 'Y')
 10809           and (am-com-typ(sub5) = 'C' or 'D' or 'O' or 'P')
 10810           if pb-i-lf-benefit-cd <> '  ' and '00'
 10811              move zeros         to ws-wk-rate
 10812              if (am-l-com (sub5) numeric)
 10813                 and (am-l-coma (sub5) (3:1) not = 'L' and 'M')
 10814                 move am-l-com(sub5)
 10815                                 to ws-wk-rate
 10816              else
 10817                 move pb-company-cd to ctbl-company-cd
 10818                 move pb-i-lf-benefit-cd
 10819                                 to ctbl-ben-code
 10820                 move pb-i-lf-term  to ws-work-term
 10821                 move pb-life-override-l1
 10822                                 to ctbl-ben-type
 10823                 move zeros      to ws-sub1
 10824                                    ws-commission
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 198
* EL050.cbl
 10825                 move am-l-coma (sub5)
 10826                                 to ctbl-table
 10827                 move '0540'     to ctbl-sw
 10828                 perform 0552-get-it
 10829                                 thru 0552-exit
 10830              end-if
 10831              compute ws-tot-sl-wk-rate =
 10832                 ws-tot-sl-wk-rate + ws-wk-rate
 10833              if am-com-typ(sub5) = 'C' or 'D'
 10834                 compute ws-sl-wk-rate =
 10835                    ws-sl-wk-rate + ws-wk-rate
 10836              else
 10837                 if am-com-typ(sub5) = 'O' or 'P'
 10838                    compute ws-ga-sl-wk-rate =
 10839                       ws-ga-sl-wk-rate + ws-wk-rate
 10840                 end-if
 10841              end-if
 10842
 10843              move zeros         to ws-wk-rate
 10844              if (am-j-com (sub5) numeric)
 10845                 and (am-j-coma (sub5) (3:1) not = 'L' and 'M')
 10846                 move am-j-com(sub5)
 10847                                 to ws-wk-rate
 10848              else
 10849                 move pb-company-cd to ctbl-company-cd
 10850                 move pb-i-lf-benefit-cd
 10851                                 to ctbl-ben-code
 10852                 move pb-i-lf-term  to ws-work-term
 10853                 move pb-life-override-l1
 10854                                 to ctbl-ben-type
 10855                 move zeros      to ws-sub1
 10856                                    ws-commission
 10857                 move am-j-coma (sub5)
 10858                                 to ctbl-table
 10859                 move '0540'     to ctbl-sw
 10860                 perform 0552-get-it
 10861                                 thru 0552-exit
 10862              end-if
 10863              compute ws-tot-jl-wk-rate =
 10864                 ws-tot-jl-wk-rate + ws-wk-rate
 10865              if am-com-typ(sub5) = 'C' or 'D'
 10866                 compute ws-jl-wk-rate =
 10867                    ws-jl-wk-rate + ws-wk-rate
 10868              else
 10869                 if am-com-typ(sub5) = 'O' or 'P'
 10870                    compute ws-ga-jl-wk-rate =
 10871                       ws-ga-jl-wk-rate + ws-wk-rate
 10872                 end-if
 10873              end-if
 10874           end-if
 10875           move zeros            to ws-wk-rate
 10876
 10877           if pb-i-ah-benefit-cd <> '  ' and '00'
 10878              if (am-a-com (sub5) numeric)
 10879                 and (am-a-coma (sub5) (3:1) not = 'L' and 'M')
 10880                 move am-a-com(sub5)
 10881                                 to ws-wk-rate
 10882              else
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 199
* EL050.cbl
 10883                 move pb-company-cd to ctbl-company-cd
 10884                 move pb-i-ah-benefit-cd
 10885                                 to ctbl-ben-code
 10886                 move pb-i-ah-term  to ws-work-term
 10887                 move pb-ah-override-l1
 10888                                 to ctbl-ben-type
 10889                 move zeros      to ws-sub1
 10890                                    ws-commission
 10891                 move am-a-coma (sub5)
 10892                                 to ctbl-table
 10893                 move '0530'     to ctbl-sw
 10894                 perform 0552-get-it
 10895                                 thru 0552-exit
 10896              end-if
 10897              compute ws-tot-sa-wk-rate =
 10898                 ws-tot-sa-wk-rate + ws-wk-rate
 10899              if am-com-typ(sub5) = 'C' or 'D'
 10900                 compute ws-sa-wk-rate =
 10901                    ws-sa-wk-rate + ws-wk-rate
 10902              else
 10903                 if am-com-typ(sub5) = 'O' or 'P'
 10904                    compute ws-ga-sa-wk-rate =
 10905                       ws-ga-sa-wk-rate + ws-wk-rate
 10906                 end-if
 10907              end-if
 10908           end-if
 10909        end-if
 10910     end-perform
 10911
 10912     go to 0550-continue
 10913
 10914     .
 10915 0552-get-it.
 10916
 10917     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD
 10918     MOVE ZEROS                  TO WS-SUB1
 10919                                    WS-COMMISSION
 10920     MOVE ' '                    TO WS-CTBL-READ-SW
 10921     PERFORM 8300-READ-CTBL-TABLE
 10922                                 THRU 8300-EXIT
 10923     IF FIRST-TIME-THROUGH
 10924        MOVE 'AA'                TO CTBL-BEN-CODE
 10925        PERFORM 8300-READ-CTBL-TABLE
 10926                                 THRU 8300-EXIT
 10927     END-IF
 10928     IF CTBL-TABLE-FOUND
 10929        if pb-life-override-l1 = ctbl-ben-type
 10930           move pb-i-lf-benefit-amt
 10931                                 to WS-COMM-CK-AMT
 10932        else
 10933           compute ws-comm-ck-amt =
 10934              pb-I-ah-benefit-amt * pb-i-ah-term
 10935        end-if
 10936        PERFORM 8800-GET-COMP-RATE
 10937                                 THRU 8800-EXIT
 10938     else
 10939        move zeros               to ws-wk-rate
 10940     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 200
* EL050.cbl
 10941
 10942     .
 10943 0552-exit.
 10944     exit.
 10945
 10946 0550-continue.
 10947
 10948     if ws-lf-joint-indicator = 'J'
 10949        if (ws-jl-wk-rate > ws-st-comm-cap-jl)
 10950           and (ws-st-comm-cap-jl <> zeros)
 10951           MOVE ER-1956          TO WS-ERROR
 10952           PERFORM 9900-ERROR-FORMAT
 10953                                 THRU 9900-EXIT
 10954        end-if
 10955        if (ws-ga-jl-wk-rate > ws-st-ga-comm-cap-jl)
 10956           and (ws-st-ga-comm-cap-jl <> zeros)
 10957           MOVE ER-1959          TO WS-ERROR
 10958           PERFORM 9900-ERROR-FORMAT
 10959                                 THRU 9900-EXIT
 10960        end-if
 10961        if (ws-tot-jl-wk-rate > ws-st-tot-comm-cap-jl)
 10962           and (ws-st-tot-comm-cap-jl <> zeros)
 10963           MOVE ER-1962          TO WS-ERROR
 10964           PERFORM 9900-ERROR-FORMAT
 10965                                 THRU 9900-EXIT
 10966        end-if
 10967     else
 10968        if (ws-sl-wk-rate > ws-st-comm-cap-sl)
 10969           and (ws-st-comm-cap-sl <> zeros)
 10970           MOVE ER-1955          TO WS-ERROR
 10971           PERFORM 9900-ERROR-FORMAT
 10972                                 THRU 9900-EXIT
 10973        end-if
 10974        if (ws-ga-sl-wk-rate > ws-st-ga-comm-cap-sl)
 10975           and (ws-st-ga-comm-cap-sl <> zeros)
 10976           MOVE ER-1958          TO WS-ERROR
 10977           PERFORM 9900-ERROR-FORMAT
 10978                                 THRU 9900-EXIT
 10979        end-if
 10980        if (ws-tot-sl-wk-rate > ws-st-tot-comm-cap-sl)
 10981           and (ws-st-tot-comm-cap-sl <> zeros)
 10982           MOVE ER-1961          TO WS-ERROR
 10983           PERFORM 9900-ERROR-FORMAT
 10984                                 THRU 9900-EXIT
 10985        end-if
 10986
 10987     if ws-ah-joint-indicator = 'J'
 10988        if (ws-sa-wk-rate > ws-st-comm-cap-ja)
 10989           and (ws-st-comm-cap-ja <> zeros)
 10990           MOVE ER-1957          TO WS-ERROR
 10991           PERFORM 9900-ERROR-FORMAT
 10992                                 THRU 9900-EXIT
 10993        end-if
 10994        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-ja)
 10995           and (ws-st-ga-comm-cap-ja <> zeros)
 10996           MOVE ER-1960          TO WS-ERROR
 10997           PERFORM 9900-ERROR-FORMAT
 10998                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 201
* EL050.cbl
 10999        end-if
 11000        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-ja)
 11001           and (ws-st-tot-comm-cap-ja <> zeros)
 11002           MOVE ER-1963          TO WS-ERROR
 11003           PERFORM 9900-ERROR-FORMAT
 11004                                 THRU 9900-EXIT
 11005        end-if
 11006     else
 11007        if (ws-sa-wk-rate > ws-st-comm-cap-sa)
 11008           and (ws-st-comm-cap-sa <> zeros)
 11009           MOVE ER-1957          TO WS-ERROR
 11010           PERFORM 9900-ERROR-FORMAT
 11011                                 THRU 9900-EXIT
 11012        end-if
 11013        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-sa)
 11014           and (ws-st-ga-comm-cap-sa <> zeros)
 11015           MOVE ER-1960          TO WS-ERROR
 11016           PERFORM 9900-ERROR-FORMAT
 11017                                 THRU 9900-EXIT
 11018        end-if
 11019        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-sa)
 11020           and (ws-st-tot-comm-cap-sa <> zeros)
 11021           MOVE ER-1963          TO WS-ERROR
 11022           PERFORM 9900-ERROR-FORMAT
 11023                                 THRU 9900-EXIT
 11024        end-if
 11025     end-if
 11026     .
 11027 0560-EDIT-CONTINUE.
 11028     MOVE ZEROS                  TO WS-LF-PMF-COMM
 11029                                    WS-AH-PMF-COMM
 11030*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 11031*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 11032     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 11033        (SUB1 > +10)
 11034        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 11035           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 11036           MOVE '0530'           TO CTBL-SW
 11037           MOVE ' '              TO WS-CTBL-READ-SW
 11038           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 11039           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 11040           MOVE '0540'           TO CTBL-SW
 11041           MOVE ' '              TO WS-CTBL-READ-SW
 11042           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 11043        END-IF
 11044     END-PERFORM
 11045     GO TO 0564-EDIT-CONTINUE
 11046     .
 11047 0561-CHECK-AH.
 11048     IF (NO-AH-COVERAGE)
 11049        OR (NO-AH-BENEFIT-MATCH)
 11050        CONTINUE
 11051     ELSE
 11052        IF (AM-A-COM (SUB1) NUMERIC)
 11053           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11054           IF (AM-COM-TYP (SUB1) = 'A')
 11055              AND (WS-AH-PMF-COMM = ZEROS)
 11056              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 202
* EL050.cbl
 11057           END-IF
 11058           CONTINUE
 11059        ELSE
 11060           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 11061           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 11062           MOVE PB-AH-OVERRIDE-L1
 11063                                 TO CTBL-BEN-TYPE
 11064           MOVE ZEROS            TO WS-SUB1
 11065                                    WS-COMMISSION
 11066           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 11067           PERFORM 8300-READ-CTBL-TABLE
 11068                                 THRU 8300-EXIT
 11069           IF CTBL-TABLE-FOUND
 11070              IF (AM-COM-TYP (SUB1) = 'A')
 11071                 AND (WS-AH-PMF-COMM = ZEROS)
 11072                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 11073                                        PB-I-AH-TERM
 11074                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11075                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 11076              END-IF
 11077              CONTINUE
 11078           ELSE
 11079              IF FIRST-TIME-THROUGH
 11080                 GO TO 0561-CHECK-AH
 11081              ELSE
 11082                 MOVE ER-2609    TO WS-ERROR
 11083                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11084              END-IF
 11085           END-IF
 11086        END-IF
 11087     END-IF
 11088     .
 11089 0561-EXIT.
 11090     EXIT.
 11091 0563-CHECK-LF.
 11092     IF (NO-LIFE-COVERAGE)
 11093        OR (NO-LF-BENEFIT-MATCH)
 11094        CONTINUE
 11095     ELSE
 11096        IF WS-LF-JOINT-INDICATOR = 'J'
 11097           IF AM-J-COM (SUB1) NUMERIC
 11098              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11099              IF (AM-COM-TYP (SUB1) = 'A')
 11100                 AND (WS-LF-PMF-COMM = ZEROS)
 11101                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 11102              END-IF
 11103              CONTINUE
 11104           ELSE
 11105              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11106              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11107              MOVE PB-LIFE-OVERRIDE-L1
 11108                                 TO CTBL-BEN-TYPE
 11109              MOVE ZEROS         TO WS-SUB1
 11110                                    WS-COMMISSION
 11111              MOVE AM-J-COMA (SUB1)
 11112                                 TO CTBL-TABLE
 11113              PERFORM 8300-READ-CTBL-TABLE
 11114                                 THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 203
* EL050.cbl
 11115              IF CTBL-TABLE-FOUND
 11116                 IF (AM-COM-TYP (SUB1) = 'A')
 11117                    AND (WS-LF-PMF-COMM = ZEROS)
 11118                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 11119                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11120                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 11121                 END-IF
 11122                 CONTINUE
 11123              ELSE
 11124                 IF FIRST-TIME-THROUGH
 11125                    GO TO 0563-CHECK-LF
 11126                 ELSE
 11127                    MOVE ER-2609 TO WS-ERROR
 11128                    PERFORM 9900-ERROR-FORMAT
 11129                                 THRU 9900-EXIT
 11130*                   GO TO 0560-EDIT-CONTINUE
 11131                 END-IF
 11132              END-IF
 11133           END-IF
 11134        ELSE
 11135           IF AM-L-COM (SUB1) NUMERIC
 11136              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11137              IF (AM-COM-TYP (SUB1) = 'A')
 11138                 AND (WS-LF-PMF-COMM = ZEROS)
 11139                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 11140              END-IF
 11141              CONTINUE
 11142           ELSE
 11143              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11144              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11145              MOVE PB-LIFE-OVERRIDE-L1
 11146                                 TO CTBL-BEN-TYPE
 11147              MOVE ZEROS         TO WS-SUB1
 11148                                    WS-COMMISSION
 11149              MOVE AM-L-COMA (SUB1)
 11150                                 TO CTBL-TABLE
 11151              PERFORM 8300-READ-CTBL-TABLE
 11152                                 THRU 8300-EXIT
 11153              IF CTBL-TABLE-FOUND
 11154                 CONTINUE
 11155              ELSE
 11156                 IF FIRST-TIME-THROUGH
 11157                    GO TO 0563-CHECK-LF
 11158                 ELSE
 11159                    MOVE ER-2609 TO WS-ERROR
 11160                    PERFORM 9900-ERROR-FORMAT
 11161                                 THRU 9900-EXIT
 11162                 END-IF
 11163              END-IF
 11164           END-IF
 11165        END-IF
 11166     END-IF
 11167     .
 11168 0563-EXIT.
 11169     EXIT.
 11170 0564-EDIT-CONTINUE.
 11171
 11172     IF  PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 204
* EL050.cbl
 11173         IF PB-I-NUM-BILLED EQUAL ZEROS
 11174            MOVE ER-8148       TO WS-ERROR
 11175            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11176
 11177*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 11178*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11179*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 11180*         SET ELAPSED-BETWEEN-BIN TO TRUE
 11181*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11182*         IF NO-CONVERSION-ERROR
 11183*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 11184*         ELSE
 11185*             IF PB-COMPANY-ID EQUAL 'HAN'
 11186*                 MOVE ZEROS     TO PB-I-AGE.
 11187     IF PB-I-BIRTHDAY > LOW-VALUES
 11188        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 11189        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11190        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11191        PERFORM 8500-DATE-CONVERT
 11192                                 THRU 8500-EXIT
 11193        IF NO-CONVERSION-ERROR
 11194           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11195           IF PB-I-AGE > ZEROS
 11196              IF WS-WORK-AGE NOT = PB-I-AGE
 11197                 MOVE ER-9501    TO WS-ERROR
 11198                 PERFORM 9900-ERROR-FORMAT
 11199                                 THRU 9900-EXIT
 11200              END-IF
 11201           ELSE
 11202              MOVE WS-WORK-AGE   TO PB-I-AGE
 11203           END-IF
 11204        END-IF
 11205     END-IF
 11206     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 11207                                   WS-INS-AGE-SET
 11208     IF PB-I-AGE = ZEROS
 11209        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 11210           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11211                                   WS-INS-AGE-SET
 11212           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 11213
 11214     MOVE PB-I-AGE              TO WS-EDIT-AGE
 11215                                   WS-AH-EDIT-AGE.
 11216
 11217     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11218        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 11219        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11220        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11221        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11222        IF NO-CONVERSION-ERROR
 11223           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11224           IF PB-I-JOINT-AGE > 0
 11225              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 11226                 MOVE ER-9503    TO WS-ERROR
 11227                 PERFORM 9900-ERROR-FORMAT
 11228                                 THRU 9900-EXIT
 11229              END-IF
 11230           ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 205
* EL050.cbl
 11231              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 11232           END-IF
 11233        ELSE
 11234           MOVE ZEROS            TO PB-I-JOINT-AGE
 11235        END-IF
 11236     END-IF
 11237     IF PB-I-JOINT-AGE NOT NUMERIC
 11238        MOVE ZERO               TO PB-I-JOINT-AGE.
 11239
 11240     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 11241                                   WS-JNT-AGE-SET
 11242     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11243        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 11244           (WS-AH-JOINT-INDICATOR = 'J')
 11245           IF PB-I-JOINT-AGE = ZEROS
 11246               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 11247                                          WS-JNT-AGE-SET
 11248               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 11249           END-IF
 11250        END-IF
 11251     END-IF
 11252
 11253     MOVE ' ' TO PB-I-LIFE-INDICATOR
 11254     IF WS-LF-JOINT-INDICATOR = 'J'
 11255        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 11256        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11257            IF  PB-I-JOINT-AGE = ZERO
 11258                MOVE ER-2686       TO WS-ERROR
 11259                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11260            ELSE
 11261                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11262                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 11263                    IF PB-COMPANY-ID NOT = 'LBL'
 11264                        MOVE ER-2685    TO WS-ERROR
 11265                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11266
 11267     IF WS-AH-JOINT-INDICATOR = 'J'
 11268        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11269            IF  PB-I-JOINT-AGE = ZERO
 11270                MOVE ER-2686       TO WS-ERROR
 11271                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11272            ELSE
 11273                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11274                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 11275                                           WS-EDIT-AGE
 11276                    IF PB-COMPANY-ID NOT = 'LBL'
 11277                        MOVE ER-2685    TO WS-ERROR
 11278                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11279
 11280******************************************************************
 11281*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 11282******************************************************************
 11283
 11284     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11285        (WS-AH-SPECIAL-CALC-CD = 'O')
 11286        NEXT SENTENCE
 11287     ELSE
 11288        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 206
* EL050.cbl
 11289          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 11290           (WS-LF-JOINT-INDICATOR = 'J'  OR
 11291            WS-AH-JOINT-INDICATOR = 'J')  AND
 11292           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 11293            MOVE ER-2627             TO WS-ERROR
 11294            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11295
 11296     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11297        (WS-AH-SPECIAL-CALC-CD = 'O')
 11298         NEXT SENTENCE
 11299     ELSE
 11300         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11301            WS-AH-JOINT-INDICATOR = 'J'
 11302             IF PB-I-JOINT-INSURED = SPACES
 11303                 IF PB-COMPANY-ID NOT = 'JAL'
 11304                     MOVE ER-2696    TO WS-ERROR
 11305                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11306
 11307     IF PB-COMPANY-ID NOT = 'BOA'
 11308        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11309           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11310           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 11311               PB-I-JOINT-INSURED NOT = SPACES)
 11312                MOVE ER-2691         TO WS-ERROR
 11313                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11314
 11315     IF PB-COMPANY-ID = 'BOA'
 11316        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11317           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11318            IF PB-I-JOINT-AGE NOT = ZEROS
 11319                MOVE ER-2691         TO WS-ERROR
 11320                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11321
 11322     IF PB-COMPANY-ID = 'CRI'
 11323        IF PB-I-SIG-SW = 'J'
 11324           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 11325              WS-AH-JOINT-INDICATOR NOT = 'J'
 11326              MOVE ER-2675       TO WS-ERROR
 11327              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11328
 11329     IF PB-COMPANY-ID = 'CRI'
 11330        IF PB-I-SIG-SW = 'S'
 11331           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11332              WS-AH-JOINT-INDICATOR = 'J'
 11333              MOVE ER-2676       TO WS-ERROR
 11334              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11335
 11336     IF PB-COMPANY-ID = 'CVL'
 11337         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 11338            (WS-LF-JOINT-INDICATOR NOT = 'J')
 11339              MOVE ER-2783           TO WS-ERROR
 11340              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11341     IF (WS-LF-JOINT-INDICATOR = 'J')
 11342        AND (WS-AH-JOINT-INDICATOR = 'J')
 11343        AND (PB-I-LF-TERM > 120)
 11344        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 11345        MOVE ER-2783             TO WS-ERROR
 11346        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 207
* EL050.cbl
 11347     END-IF
 11348     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 11349
 11350     IF PB-I-INDV-GRP-OVRD = 'I'
 11351        MOVE ER-2666             TO WS-ERROR
 11352        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11353        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 11354
 11355     IF PB-I-INDV-GRP-OVRD = 'G'
 11356        MOVE ER-2666             TO WS-ERROR
 11357        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11358        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 11359
 11360     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 11361        NEXT SENTENCE
 11362     ELSE
 11363        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 11364
 11365     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 11366        IF WS-ERROR = ER-2666
 11367           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11368           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 11369
 11370     IF PB-COMPANY-ID = 'CID'
 11371        IF PB-STATE = 'UT' OR 'MO'
 11372           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 11373                 OR '76' OR '77')
 11374                      OR
 11375               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 11376                   OR '41' OR '42' OR '63' OR '64' OR '65'
 11377                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 11378                   OR '2K' OR '2L'))
 11379              AND PB-I-INDV-GRP-CD = 'I'
 11380              MOVE ER-2721             TO WS-ERROR
 11381              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11382           END-IF
 11383        END-IF
 11384     END-IF
 11385
 11386     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 11387     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 11388        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 11389     ELSE
 11390        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 11391     END-IF
 11392
 11393*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 11394*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 11395     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 11396                                    ACCOUNT-AH-CK-SW.
 11397
 11398     IF PB-REISSUED-CERT       OR
 11399        PB-REIN-ONLY-CERT      OR
 11400        PB-POLICY-IS-DECLINED  OR
 11401        PB-POLICY-IS-VOIDED
 11402*       OR PB-MONTHLY-CERT
 11403         GO TO 3000-CONTINUE-EDIT.
 11404
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 208
* EL050.cbl
 11405     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11406        IF WS-EDIT-AGE           > +65
 11407           MOVE ER-2709          TO WS-ERROR
 11408           PERFORM 9900-ERROR-FORMAT
 11409                                 THRU 9900-EXIT
 11410        ELSE
 11411           IF WS-EDIT-AGE        > +55
 11412              MOVE ER-2718       TO WS-ERROR
 11413              PERFORM 9900-ERROR-FORMAT
 11414                                 THRU 9900-EXIT
 11415           END-IF
 11416        END-IF
 11417     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11418        IF WS-EDIT-AGE           > +65
 11419           MOVE ER-2709          TO WS-ERROR
 11420           PERFORM 9900-ERROR-FORMAT
 11421                                 THRU 9900-EXIT
 11422        END-IF
 11423     END-IF
 11424     .
 11425
 11426 0565-LIFE-PLAN-LIMIT-EDITS.
 11427
 11428     IF NOT LF-PLAN-MASTER-FOUND
 11429        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 11430                                    EC-AM-LF-MAX-TOT-BEN
 11431        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11432
 11433     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11434
 11435     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11436         IF PL-LM-AGE (1) = ZEROS
 11437             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11438
 11439     IF NO-LF-BENEFIT-MATCH          OR
 11440        WS-LF-BENEFIT-CD = ZEROS     OR
 11441        WS-LF-SPECIAL-CALC-CD = 'M'
 11442        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11443
 11444     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11445     MOVE +1                     TO SUB2.
 11446
 11447     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11448        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11449           MOVE +5   TO SUB2
 11450           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11451              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11452              (PL-LM-AGE (SUB2) EQUAL +0)
 11453              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11454              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11455
 11456     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11457
 11458     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11459                               + PB-I-LF-ALT-BENEFIT-AMT.
 11460
 11461 0568-CHECK-LIFE-ATT-AGE.
 11462
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 209
* EL050.cbl
 11463     IF PL-ATT-AGE NUMERIC AND
 11464        PL-ATT-AGE > +0
 11465        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11466     END-IF
 11467*    IF PL-ATT-AGE NUMERIC AND
 11468*       PL-ATT-AGE > +0
 11469*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11470*       IF PB-I-BIRTHDAY > LOW-VALUES
 11471*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11472*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11473*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11474*          SET BIN-PLUS-ELAPSED  TO TRUE
 11475*          PERFORM 8500-DATE-CONVERT
 11476*                                THRU 8500-EXIT
 11477*          IF NO-CONVERSION-ERROR
 11478*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11479*             MOVE ER-2669       TO WS-ERROR
 11480*             PERFORM 9900-ERROR-FORMAT
 11481*                                THRU 9900-EXIT
 11482*          END-IF
 11483*       ELSE
 11484*          IF WS-ATT-AGE >= PL-ATT-AGE
 11485*             MOVE ER-2669       TO WS-ERROR
 11486*             PERFORM 9900-ERROR-FORMAT
 11487*                                THRU 9900-EXIT
 11488*          END-IF
 11489*       END-IF
 11490*    END-IF
 11491     .
 11492 0570-CHECK-LIFE-LIMITS.
 11493
 11494     IF PB-COMPANY-ID EQUAL 'CRI'
 11495        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11496           IF SUB2 GREATER THAN +4
 11497              MOVE ER-2637 TO WS-ERROR
 11498              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11499              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11500
 11501     IF PB-COMPANY-ID  =  'NCL'
 11502        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11503            SUB2 GREATER THAN +8
 11504             MOVE 'U'         TO PB-BATCH-ENTRY
 11505             MOVE ER-2637     TO WS-ERROR
 11506             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11507             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11508
 11509     IF SUB2 > +8
 11510        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11511           AND (PB-I-SIG-SW = 'Y')
 11512           CONTINUE
 11513        ELSE
 11514           MOVE ER-2637          TO WS-ERROR
 11515           PERFORM 9900-ERROR-FORMAT
 11516                                 THRU 9900-EXIT
 11517        END-IF
 11518        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11519     END-IF
 11520     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 210
* EL050.cbl
 11521     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11522     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11523
 11524     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11525        ADD +1  TO SUB2
 11526        GO TO 0570-CHECK-LIFE-LIMITS.
 11527
 11528     IF PB-COMPANY-ID = 'NCL'
 11529         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11530
 11531     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11532        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11533        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11534           AND (PB-I-SIG-SW = 'Y')
 11535           CONTINUE
 11536        ELSE
 11537           MOVE ER-2637          TO WS-ERROR
 11538           PERFORM 9900-ERROR-FORMAT
 11539                                 THRU 9900-EXIT
 11540        END-IF
 11541     END-IF
 11542     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11543
 11544
 11545 0570-CHECK-NCL-LIFE-LIMITS.
 11546
 11547     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11548        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11549         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11550
 11551     IF APP-CERT-USED
 11552         IF SUB2  LESS THAN  +5
 11553             MOVE +5          TO SUB2
 11554             GO TO 0570-CHECK-LIFE-LIMITS.
 11555
 11556     MOVE ER-2637             TO WS-ERROR.
 11557     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11558
 11559     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11560
 11561 0575-CHECK-NCL-SIG-SWITCH.
 11562
 11563     IF NOT APP-CERT-USED
 11564         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11565
 11566     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11567        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11568        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11569        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11570         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11571
 11572     IF SUB2 GREATER THAN +4
 11573         IF PL-LM-AGE (5) = ZEROS  AND
 11574            PL-LM-AGE (6) = ZEROS  AND
 11575            PL-LM-AGE (7) = ZEROS  AND
 11576            PL-LM-AGE (8) = ZEROS
 11577             MOVE  ER-1927        TO WS-ERROR
 11578             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 211
* EL050.cbl
 11579             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11580         ELSE
 11581             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11582                 MOVE  ER-1920    TO WS-ERROR
 11583                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11584
 11585     IF PB-I-SIG-SW  = 'Y'
 11586       IF NOT PB-I-POLICY-ACCEPTED  AND
 11587          NOT PB-I-POLICY-DECLINED
 11588           MOVE 'U'               TO PB-BATCH-ENTRY
 11589           MOVE  ER-1926          TO WS-ERROR
 11590           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11591
 11592
 11593 0580-AH-PLAN-LIMIT-EDITS.
 11594
 11595     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11596        IF PB-I-AH-BENEFIT-AMT > +1250
 11597           MOVE ER-2702          TO WS-ERROR
 11598           PERFORM 9900-ERROR-FORMAT
 11599                                 THRU 9900-EXIT
 11600        END-IF
 11601     END-IF
 11602
 11603     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11604        AND (PB-MONTHLY-CERT)
 11605        IF PB-I-AH-BENEFIT-AMT > +3000
 11606           MOVE ER-2881          TO WS-ERROR
 11607           PERFORM 9900-ERROR-FORMAT
 11608                                 THRU 9900-EXIT
 11609        END-IF
 11610     END-IF
 11611     IF NOT AH-PLAN-MASTER-FOUND
 11612        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11613        GO TO 3000-CONTINUE-EDIT.
 11614
 11615     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11616
 11617     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11618         IF PL-LM-AGE (1) = ZEROS
 11619             GO TO 3000-CONTINUE-EDIT.
 11620
 11621     IF NO-AH-BENEFIT-MATCH          OR
 11622        WS-AH-BENEFIT-CD = ZEROS     OR
 11623        WS-AH-SPECIAL-CALC-CD = 'M'
 11624        GO TO 3000-CONTINUE-EDIT.
 11625
 11626     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11627     MOVE +1                     TO SUB2.
 11628
 11629     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11630        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11631           MOVE +5 TO SUB2
 11632           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11633              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11634              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11635              (PL-LM-AGE (SUB2) EQUAL +0)
 11636              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 212
* EL050.cbl
 11637              GO TO 3000-CONTINUE-EDIT.
 11638
 11639     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11640
 11641 0590-CHECK-AH-ATT-AGE.
 11642
 11643     IF PL-ATT-AGE NUMERIC AND
 11644        PL-ATT-AGE GREATER THAN +0
 11645        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11646     END-IF
 11647*       IF WS-ATT-AGE >= PL-ATT-AGE
 11648*          MOVE ER-3054          TO WS-ERROR
 11649*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11650     .
 11651 0597-CHECK-AH-LIMITS.
 11652
 11653     IF PB-COMPANY-ID EQUAL 'CRI'
 11654        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11655           IF SUB2 GREATER THAN +4
 11656              MOVE ER-2638       TO WS-ERROR
 11657              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11658              GO TO 3000-CONTINUE-EDIT.
 11659
 11660     IF PB-COMPANY-ID  =  'NCL'
 11661        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11662            SUB2 GREATER THAN +8
 11663             MOVE 'U'            TO PB-BATCH-ENTRY
 11664             MOVE ER-2638        TO WS-ERROR
 11665             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11666             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11667
 11668     IF SUB2 > +8
 11669        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11670           AND (PB-I-SIG-SW = 'Y')
 11671           CONTINUE
 11672        ELSE
 11673           MOVE ER-2638          TO WS-ERROR
 11674           PERFORM 9900-ERROR-FORMAT
 11675                                 THRU 9900-EXIT
 11676        END-IF
 11677        GO TO 3000-CONTINUE-EDIT
 11678     END-IF
 11679
 11680     IF PB-COMPANY-ID = 'CRI'
 11681        IF WS-ERROR = ER-2638
 11682           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11683
 11684     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11685     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11686     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11687     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11688
 11689     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11690        ADD +1                   TO SUB2
 11691        GO TO 0597-CHECK-AH-LIMITS.
 11692
 11693     IF PB-COMPANY-ID = 'NCL'
 11694         GO TO 0597-CHECK-NCL-AH-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 213
* EL050.cbl
 11695
 11696     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11697        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11698        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11699                                 > PL-LM-AMT (SUB2))
 11700        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11701           AND (PB-I-SIG-SW = 'Y')
 11702           CONTINUE
 11703        ELSE
 11704           MOVE ER-2638          TO WS-ERROR
 11705           PERFORM 9900-ERROR-FORMAT
 11706                                 THRU 9900-EXIT
 11707        END-IF
 11708     END-IF
 11709
 11710     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11711         IF  WS-ERROR    EQUAL    ER-2638
 11712             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11713                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11714                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11715                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11716                MOVE  ER-1910    TO  WS-ERROR
 11717                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11718
 11719     IF PB-COMPANY-ID = 'CRI'
 11720        IF WS-ERROR = ER-2638
 11721            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11722            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11723            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11724
 11725     GO TO 3000-CONTINUE-EDIT.
 11726
 11727 0597-CHECK-NCL-AH-LIMITS.
 11728
 11729     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11730        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11731        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11732                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11733         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11734
 11735     IF APP-CERT-USED
 11736         IF SUB2  LESS THAN  +5
 11737             MOVE +5             TO SUB2
 11738             GO TO 0597-CHECK-AH-LIMITS.
 11739
 11740     MOVE ER-2638                TO WS-ERROR.
 11741     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11742
 11743     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11744
 11745 0599-CHECK-NCL-SIG-SWITCH.
 11746
 11747     IF NOT APP-CERT-USED
 11748         GO TO 3000-CONTINUE-EDIT.
 11749
 11750     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11751        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11752        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 214
* EL050.cbl
 11753        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11754         GO TO 3000-CONTINUE-EDIT.
 11755
 11756     IF SUB2 GREATER THAN +4
 11757         IF PL-LM-AGE (5) = ZEROS  AND
 11758            PL-LM-AGE (6) = ZEROS  AND
 11759            PL-LM-AGE (7) = ZEROS  AND
 11760            PL-LM-AGE (8) = ZEROS
 11761             MOVE  ER-1927        TO WS-ERROR
 11762             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11763             GO TO 3000-CONTINUE-EDIT
 11764         ELSE
 11765             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11766                 MOVE  ER-1920    TO WS-ERROR
 11767                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11768
 11769     IF PB-I-SIG-SW  = 'Y'
 11770       IF NOT PB-I-POLICY-ACCEPTED  AND
 11771          NOT PB-I-POLICY-DECLINED
 11772           MOVE 'U'               TO PB-BATCH-ENTRY
 11773           MOVE  ER-1926          TO WS-ERROR
 11774           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11775
 11776******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 215
* EL050.cbl
 11778
 11779 3000-CONTINUE-EDIT.
 11780
 11781     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11782     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11783     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11784     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11785     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11786
 11787     IF BROWSE-STARTED
 11788        PERFORM 9990-RETURN THRU 9990-EXIT
 11789        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11790
 11791     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11792        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11793        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11794        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11795*       MOVE 1                   TO DC-OPTION-CODE
 11796        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11797        IF DATE-CONVERSION-ERROR
 11798           MOVE ER-2622          TO WS-ERROR
 11799           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11800        ELSE
 11801           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11802              MOVE ER-2623       TO WS-ERROR
 11803              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11804           ELSE
 11805              MOVE ER-2622       TO WS-ERROR
 11806              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11807
 11808     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11809     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11810     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11811*    MOVE 1                      TO DC-OPTION-CODE.
 11812     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11813     IF DATE-CONVERSION-ERROR
 11814        GO TO 3005-EDIT-CONTINUE
 11815     ELSE
 11816        IF DC-ELAPSED-DAYS GREATER +180
 11817           MOVE ER-2613          TO WS-ERROR
 11818           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11819        ELSE
 11820           IF DC-ELAPSED-DAYS GREATER +90
 11821              MOVE ER-2612       TO WS-ERROR
 11822              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11823           ELSE
 11824             IF DC-ELAPSED-DAYS GREATER +60
 11825                MOVE ER-2614     TO WS-ERROR
 11826                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11827
 11828 3005-EDIT-CONTINUE.
 11829
 11830     IF PB-CANCELLATION
 11831         GO TO 3700-EDIT-CANCEL.
 11832
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 216
* EL050.cbl
 11834******************************************************************
 11835*                  E D I T   I S S U E                           *
 11836******************************************************************
 11837
 11838 3020-EDIT-ISSUE.
 11839
 11840      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11841      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11842      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11843      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11844      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11845
 11846     IF PB-ISSUE-FORCE
 11847        OR PB-ISSUE-DATE-FORCED
 11848        OR PB-FORCE-OFF
 11849        OR PB-OVERCHARGE-FORCE
 11850        or pb-exceeded-limit-forced
 11851        CONTINUE
 11852     ELSE
 11853        MOVE ER-2670             TO WS-ERROR
 11854        PERFORM 9900-ERROR-FORMAT
 11855                                 THRU 9900-EXIT
 11856     END-IF
 11857     .
 11858 3022-SET-POLICY-STATUS.
 11859
 11860     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11861
 11862     IF (PB-REISSUED-CERT)
 11863             OR
 11864        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11865         AND (PB-MONTHLY-CERT))
 11866         MOVE '5'                TO PB-I-ENTRY-STATUS
 11867         MOVE 'E'                TO PB-BATCH-ENTRY
 11868     END-IF
 11869
 11870     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11871        IF PB-MONTHLY-CERT
 11872           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11873        END-IF
 11874        IF PB-CASH-CERT
 11875           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11876        END-IF
 11877     END-IF
 11878     IF PB-POLICY-IS-DECLINED
 11879         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11880     IF PB-POLICY-IS-VOIDED
 11881         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11882     IF PB-NEEDS-UNDERWRITING
 11883         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11884     IF PB-REIN-ONLY-CERT
 11885         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11886     IF PB-PREM-ACCTNG-ONLY
 11887         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11888
 11889     MOVE SPACE                  TO PB-I-OB-FLAG.
 11890
 11891     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 217
* EL050.cbl
 11892         MOVE ER-2665            TO WS-ERROR
 11893         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11894         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11895
 11896     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11897        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11898           MOVE 'Z'             TO PB-I-OB-FLAG.
 11899
 11900     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11901        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11902           MOVE 'Z'             TO PB-I-OB-FLAG.
 11903
 11904     IF ACCOUNT-MAST-FOUND
 11905         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11906         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11907         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11908         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11909         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11910         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11911         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11912     END-IF
 11913
 11914     IF ACCOUNT-MAST-FOUND
 11915        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11916         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11917
 11918     IF (ACCOUNT-MAST-FOUND)
 11919*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11920        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11921        IF PB-REISSUED-CERT
 11922           CONTINUE
 11923        ELSE
 11924           MOVE ER-2608          TO WS-ERROR
 11925           PERFORM 9900-ERROR-FORMAT
 11926                                 THRU 9900-EXIT
 11927         END-IF
 11928     END-IF
 11929
 11930     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11931        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11932        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11933
 11934**********   DMD CUSTOM CODE FOLLOWS  **********
 11935 3024-EDIT-DMD-FIELDS.
 11936     IF PB-COMPANY-ID NOT = 'DMD'
 11937        GO TO 3025-EDIT-REINSURANCE.
 11938
 11939*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11940*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11941*** ERROR IF THEY ARE NOT EQUAL.
 11942
 11943     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11944     SET BIN-TO-GREG               TO TRUE.
 11945     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11946     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11947**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11948
 11949     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 218
* EL050.cbl
 11950     SET BIN-TO-GREG               TO TRUE.
 11951     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11952     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11953**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11954
 11955     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11956        MOVE ER-8116               TO WS-ERROR
 11957        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11958
 11959     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11960
 11961     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11962                                      WK-FULL-CERT-NO.
 11963     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11964
 11965     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11966
 11967     IF PB-VALID-LIFE
 11968        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11969     ELSE
 11970        IF PB-VALID-AH
 11971          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11972
 11973
 11974     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11975     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11976     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11977                                      DCUA-UNDRWRTR-CODE
 11978                                      DCUA-UNDRWRTR-GROUP-CODE
 11979                                      DCUA-RETURN-CODE.
 11980
 11981****************************************************************
 11982*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11983***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11984***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11985***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11986***   TO THIS RECORD.                                        ***
 11987****************************************************************
 11988     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11989     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11990     IF DCUA-SUCCESSFUL-PROCESS
 11991        GO TO 3024-EDIT-DL7-CONT.
 11992
 11993     IF DCUA-RETURN-CODE EQUAL '01'
 11994        MOVE ER-8110               TO WS-ERROR
 11995        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11996        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11997        GO TO 3024-EDIT-DL7-CONT.
 11998
 11999     IF DCUA-RETURN-CODE EQUAL '02'
 12000        MOVE ER-8111               TO WS-ERROR
 12001        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12002        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12003        GO TO 3024-EDIT-DL7-CONT.
 12004
 12005     IF DCUA-RETURN-CODE EQUAL '03'
 12006        MOVE ER-8074               TO WS-ERROR
 12007        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 219
* EL050.cbl
 12008        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12009        GO TO 3024-EDIT-DL7-CONT.
 12010
 12011     IF DCUA-RETURN-CODE EQUAL '04'
 12012        MOVE ER-8075               TO WS-ERROR
 12013        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12014        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12015        GO TO 3024-EDIT-DL7-CONT.
 12016
 12017     IF DCUA-RETURN-CODE EQUAL '05'
 12018        MOVE ER-8076               TO WS-ERROR
 12019        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12020        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12021        GO TO 3024-EDIT-DL7-CONT.
 12022
 12023     IF DCUA-RETURN-CODE EQUAL '06'
 12024        MOVE ER-8077               TO WS-ERROR
 12025        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12026        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12027        GO TO 3024-EDIT-DL7-CONT.
 12028
 12029     IF DCUA-RETURN-CODE EQUAL '07'
 12030        MOVE ER-8078               TO WS-ERROR
 12031        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12032        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12033        GO TO 3024-EDIT-DL7-CONT.
 12034
 12035     IF DCUA-RETURN-CODE EQUAL 'E1'
 12036        MOVE ER-8079               TO WS-ERROR
 12037        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12038        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12039        GO TO 3024-EDIT-DL7-CONT.
 12040
 12041     IF DCUA-RETURN-CODE EQUAL 'E2'
 12042        MOVE ER-8080               TO WS-ERROR
 12043        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12044        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12045        GO TO 3024-EDIT-DL7-CONT.
 12046
 12047     IF DCUA-RETURN-CODE EQUAL 'E3'
 12048        MOVE ER-8098               TO WS-ERROR
 12049        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12050        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12051        GO TO 3024-EDIT-DL7-CONT.
 12052
 12053     IF DCUA-RETURN-CODE EQUAL 'C1'
 12054        MOVE ER-8099               TO WS-ERROR
 12055        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12056        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12057        GO TO 3024-EDIT-DL7-CONT.
 12058
 12059     IF DCUA-RETURN-CODE EQUAL 'U1'
 12060        MOVE ER-8109               TO WS-ERROR
 12061        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12062        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12063        GO TO 3024-EDIT-DL7-CONT.
 12064
 12065     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 220
* EL050.cbl
 12066        MOVE ER-8112               TO WS-ERROR
 12067        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12068        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12069        GO TO 3024-EDIT-DL7-CONT.
 12070
 12071     IF DCUA-RETURN-CODE EQUAL 'N2'
 12072        MOVE ER-8113               TO WS-ERROR
 12073        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12074        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12075        GO TO 3024-EDIT-DL7-CONT.
 12076
 12077     IF DCUA-RETURN-CODE EQUAL 'N3'
 12078        MOVE ER-8114               TO WS-ERROR
 12079        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12080        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12081        GO TO 3024-EDIT-DL7-CONT.
 12082
 12083     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 12084     MOVE ER-8097                  TO WS-ERROR.
 12085     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 12086     GO TO 3024-EDIT-DL7-CONT.
 12087
 12088 3024-EDIT-DL7-CONT.
 12089
 12090     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 12091     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 12092     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 12093        NEXT SENTENCE
 12094     ELSE
 12095        MOVE ER-9263               TO WS-ERROR
 12096        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12097
 12098******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 12099******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 12100     IF DCUA-CERT-NUMBER = PB-CERT-NO
 12101        NEXT SENTENCE
 12102     ELSE
 12103        MOVE ER-8039               TO WS-ERROR
 12104        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12105
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 221
* EL050.cbl
 12107****************************************************************
 12108*** VALIDATE STATE  : DLO022                                 ***
 12109****************************************************************
 12110     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 12111     MOVE SPACES                   TO DVSC-RETURN-CODE.
 12112
 12113     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 12114     IF DVSC-SUCCESSFUL-EDIT
 12115        GO TO 3024-EDIT-DL22-CONT.
 12116
 12117     IF DVSC-RETURN-CODE EQUAL '01'
 12118        MOVE ER-8300               TO WS-ERROR
 12119        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12120        GO TO 3024-EDIT-DL22-CONT.
 12121
 12122     IF DVSC-RETURN-CODE EQUAL '02'
 12123        MOVE ER-8301               TO WS-ERROR
 12124        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12125        GO TO 3024-EDIT-DL22-CONT.
 12126
 12127     IF DVSC-RETURN-CODE EQUAL '03'
 12128        MOVE ER-8302               TO WS-ERROR
 12129        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12130        GO TO 3024-EDIT-DL22-CONT.
 12131
 12132     IF DVSC-RETURN-CODE EQUAL 'N1'
 12133        MOVE ER-8304               TO WS-ERROR
 12134        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12135        GO TO 3024-EDIT-DL22-CONT.
 12136
 12137     MOVE ER-8303                  TO WS-ERROR
 12138     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12139
 12140 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 222
* EL050.cbl
 12142****************************************************************
 12143*** VALIDATE LOAN OFFICER : DLO021                           ***
 12144****************************************************************
 12145
 12146     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 12147     MOVE SPACES                    TO DVLO-RETURN-CODE.
 12148     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 12149     IF DVLO-SUCCESSFUL-EDIT
 12150        GO TO 3024-EDIT-DL21-CONT.
 12151
 12152     IF DVLO-RETURN-CODE EQUAL '01'
 12153        MOVE ER-8081               TO WS-ERROR
 12154        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12155        GO TO 3024-EDIT-DL21-CONT.
 12156
 12157     IF DVLO-RETURN-CODE EQUAL '02'
 12158        MOVE ER-8082               TO WS-ERROR
 12159        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12160        GO TO 3024-EDIT-DL21-CONT.
 12161
 12162     IF DVLO-RETURN-CODE EQUAL '03'
 12163        MOVE ER-8083               TO WS-ERROR
 12164        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12165        GO TO 3024-EDIT-DL21-CONT.
 12166
 12167     IF DVLO-RETURN-CODE EQUAL '04'
 12168        MOVE ER-8084               TO WS-ERROR
 12169        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12170        GO TO 3024-EDIT-DL21-CONT.
 12171
 12172     IF DVLO-RETURN-CODE EQUAL '05'
 12173        MOVE ER-8085               TO WS-ERROR
 12174        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12175        GO TO 3024-EDIT-DL21-CONT.
 12176
 12177     MOVE ER-7825                  TO WS-ERROR
 12178     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12179     GO TO 3024-EDIT-DL21-CONT.
 12180
 12181 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 223
* EL050.cbl
 12183
 12184****************************************************************
 12185*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 12186****************************************************************
 12187
 12188     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 12189     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 12190     MOVE SPACES                 TO DIPF-RETURN-CODE.
 12191     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 12192     IF DIPF-SUCCESSFUL-EDIT
 12193        GO TO 3024-EDIT-DL02-CONT.
 12194
 12195     IF DIPF-RETURN-CODE EQUAL '01'
 12196        MOVE ER-8086               TO WS-ERROR
 12197        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12198        GO TO 3024-EDIT-DL02-CONT.
 12199
 12200     IF DIPF-RETURN-CODE EQUAL '02'
 12201        MOVE ER-8087               TO WS-ERROR
 12202        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12203        GO TO 3024-EDIT-DL02-CONT.
 12204
 12205     IF DIPF-RETURN-CODE EQUAL '03'
 12206        MOVE ER-8088               TO WS-ERROR
 12207        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12208        GO TO 3024-EDIT-DL02-CONT.
 12209
 12210     MOVE ER-8095                  TO WS-ERROR
 12211     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12212     GO TO 3024-EDIT-DL02-CONT.
 12213
 12214 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 224
* EL050.cbl
 12216
 12217****************************************************************
 12218*** VALIDATE BANK ID : DLO003                                ***
 12219****************************************************************
 12220
 12221     MOVE WK-GREG-CENT           TO WCG-CENT.
 12222     MOVE WK-GREG-YYMM           TO WCG-REST.
 12223     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 12224        MOVE ER-8040               TO WS-ERROR
 12225        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12226
 12227     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 12228     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 12229     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 12230     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 12231     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 12232     IF DVBI-SUCCESSFUL-EDIT
 12233        GO TO 3024-EDIT-DL03-CONT.
 12234
 12235     IF DVBI-RETURN-CODE EQUAL '01'
 12236        MOVE ER-8089               TO WS-ERROR
 12237        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12238        GO TO 3024-EDIT-DL03-CONT.
 12239
 12240     IF DVBI-RETURN-CODE EQUAL '02'
 12241        MOVE ER-8090               TO WS-ERROR
 12242        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12243        GO TO 3024-EDIT-DL03-CONT.
 12244
 12245     IF DVBI-RETURN-CODE EQUAL '03'
 12246        MOVE ER-8091               TO WS-ERROR
 12247        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12248        GO TO 3024-EDIT-DL03-CONT.
 12249
 12250     IF DVBI-RETURN-CODE EQUAL '04'
 12251        MOVE ER-8092               TO WS-ERROR
 12252        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12253        GO TO 3024-EDIT-DL03-CONT.
 12254
 12255     IF DVBI-RETURN-CODE EQUAL '05'
 12256        MOVE ER-8093               TO WS-ERROR
 12257        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12258        GO TO 3024-EDIT-DL03-CONT.
 12259
 12260     IF DVBI-RETURN-CODE EQUAL '06'
 12261        MOVE ER-8094               TO WS-ERROR
 12262        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12263        GO TO 3024-EDIT-DL03-CONT.
 12264
 12265     MOVE ER-8096                  TO WS-ERROR
 12266     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12267     GO TO 3024-EDIT-DL03-CONT.
 12268
 12269 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 225
* EL050.cbl
 12271
 12272     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 12273        NEXT SENTENCE
 12274     ELSE
 12275        MOVE ER-8042               TO WS-ERROR
 12276        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12277
 12278     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 12279     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 12280     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 12281
 12282     IF DMPF-RETURN-CODE = '01'
 12283        MOVE ER-8067               TO WS-ERROR
 12284        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12285        GO TO 3024-EDIT-DL01-CONT.
 12286
 12287     IF DMPF-RETURN-CODE = '02'
 12288        MOVE ER-8068               TO WS-ERROR
 12289        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12290        GO TO 3024-EDIT-DL01-CONT.
 12291
 12292     IF DMPF-RETURN-CODE = '03'
 12293        MOVE ER-8069               TO WS-ERROR
 12294        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12295        GO TO 3024-EDIT-DL01-CONT.
 12296
 12297     IF DMPF-RETURN-CODE = 'E1'
 12298        MOVE ER-8070               TO WS-ERROR
 12299        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12300        GO TO 3024-EDIT-DL01-CONT.
 12301
 12302     IF DMPF-RETURN-CODE = 'N1'
 12303        MOVE ER-8071               TO WS-ERROR
 12304        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12305        GO TO 3024-EDIT-DL01-CONT.
 12306
 12307     IF DMPF-RETURN-CODE NOT = 'OK'
 12308        MOVE ER-8072               TO WS-ERROR
 12309        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12310
 12311 3024-EDIT-DL01-CONT.
 12312******************************************************************
 12313***  VALIDATES RATE CODES : DLO017                             ***
 12314******************************************************************
 12315
 12316      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 12317      MOVE SPACES                   TO DVRC-RETURN-CODE.
 12318      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 12319      IF DVRC-SUCCESSFUL-EDIT
 12320        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 12321        GO TO 3024-CHECK-VALID-RATE.
 12322
 12323      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 12324
 12325      IF DVRC-RETURN-CODE EQUAL '01'
 12326         MOVE ER-7817                   TO WS-ERROR
 12327         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12328         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 226
* EL050.cbl
 12329
 12330      IF DVRC-RETURN-CODE EQUAL '02'
 12331         MOVE ER-7818                   TO WS-ERROR
 12332         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12333         GO TO 3025-EDIT-REINSURANCE.
 12334
 12335      IF DVRC-RETURN-CODE EQUAL '03'
 12336         MOVE ER-7819                   TO WS-ERROR
 12337         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12338         GO TO 3025-EDIT-REINSURANCE.
 12339
 12340       MOVE ER-7820                     TO WS-ERROR.
 12341       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12342       GO TO 3025-EDIT-REINSURANCE.
 12343
 12344******************************************************************
 12345***  GET PREMIUM RATES : DLO011                                ***
 12346******************************************************************
 12347
 12348 3024-CHECK-VALID-RATE.
 12349
 12350     IF VALID-RATE-CODE
 12351        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 12352        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 12353        MOVE SPACES                TO DPRB-RETURN-CODE
 12354        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 12355     ELSE
 12356         GO TO 3025-EDIT-REINSURANCE.
 12357
 12358      IF DPRB-SUCCESSFUL-PROCESS
 12359         IF PB-VALID-LIFE
 12360             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 12361             GO TO 3025-EDIT-REINSURANCE
 12362         ELSE
 12363             IF PB-VALID-AH
 12364                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 12365                 GO TO 3025-EDIT-REINSURANCE.
 12366
 12367      IF DPRB-RETURN-CODE EQUAL '01'
 12368         MOVE ER-7812                   TO WS-ERROR
 12369         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12370         GO TO 3025-EDIT-REINSURANCE.
 12371
 12372      IF DPRB-RETURN-CODE EQUAL '02'
 12373         MOVE ER-7813                   TO WS-ERROR
 12374         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12375         GO TO 3025-EDIT-REINSURANCE.
 12376
 12377      IF DPRB-RETURN-CODE EQUAL '03'
 12378         MOVE ER-7814                   TO WS-ERROR
 12379         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12380         GO TO 3025-EDIT-REINSURANCE.
 12381
 12382      IF DPRB-RETURN-CODE EQUAL '04'
 12383         IF NOT DPRB-1ST-TIME
 12384            MOVE ER-7815                   TO WS-ERROR
 12385            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12386            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 227
* EL050.cbl
 12387          ELSE
 12388         IF PB-VALID-LIFE
 12389            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12390          ELSE
 12391            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12392         END-IF
 12393         MOVE SPACES                TO DOCC-RETURN-CODE
 12394         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 12395         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 12396         IF DOCC-RETURN-CODE = 'OK'
 12397             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 12398             GO TO 3024-CHECK-VALID-RATE
 12399           ELSE
 12400             MOVE ER-7823               TO WS-ERROR
 12401             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 12402             GO TO 3025-EDIT-REINSURANCE.
 12403
 12404       MOVE ER-7816                     TO WS-ERROR.
 12405       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12406       GO TO 3025-EDIT-REINSURANCE.
 12407
 12408**********   DMD CUSTOM CODE ABOVE    **********
 12409
 12410 3025-EDIT-REINSURANCE.
 12411     IF PB-I-SPECIAL-REIN-CODE = SPACE
 12412         GO TO 3027-EDIT-CONTINUE.
 12413
 12414     MOVE LOW-VALUES               TO ERREIN-KEY.
 12415     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 12416     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 12417                                      REIN-CODE-2
 12418                                      REIN-CODE-3.
 12419     MOVE 'A'                      TO REIN-TYPE.
 12420
 12421     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 12422
 12423     MOVE '3026' TO REIN-SW.
 12424     MOVE ' '                   TO WS-REIN-READ-SW.
 12425
 12426     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12427     IF REIN-TABLE-NOT-FOUND
 12428         GO TO 3026-NO-SPEC-TABLE.
 12429
 12430     MOVE RE-TABLE              TO WK-REIN-TABLE.
 12431     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12432                                   WS-NSP-ST-CD-LF.
 12433     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12434                                   WS-NSP-ST-CD-AH.
 12435
 12436     GO TO 3040-EDIT-CONTINUE.
 12437
 12438 3026-NO-SPEC-TABLE.
 12439
 12440     MOVE ER-2664                TO WS-ERROR.
 12441     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12442     GO TO 3040-EDIT-CONTINUE.
 12443
 12444 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 228
* EL050.cbl
 12445
 12446     IF PB-I-REIN-TABLE = SPACES
 12447       GO TO 3040-EDIT-CONTINUE.
 12448
 12449     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12450          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12451          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12452           GO TO 3040-EDIT-CONTINUE.
 12453
 12454     MOVE LOW-VALUES            TO ERREIN-KEY.
 12455     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12456     MOVE 'A'                   TO REIN-TYPE.
 12457     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12458
 12459     MOVE '3028'                TO REIN-SW.
 12460     MOVE ' '                   TO WS-REIN-READ-SW.
 12461
 12462     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12463     IF REIN-TABLE-NOT-FOUND
 12464         GO TO 3028-NO-REIN-TABLE.
 12465
 12466     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12467     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12468                                   WS-NSP-ST-CD-LF.
 12469     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12470                                   WS-NSP-ST-CD-AH.
 12471
 12472     GO TO 3040-EDIT-CONTINUE.
 12473
 12474 3028-NO-REIN-TABLE.
 12475
 12476     MOVE ER-2615                TO WS-ERROR.
 12477     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12478     GO TO 3040-EDIT-CONTINUE.
 12479
 12480 3040-EDIT-CONTINUE.
 12481
 12482     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12483         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12484
 12485     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12486         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12487
 12488     IF (NOT PB-REISSUED-CERT)
 12489        AND (NOT PB-MONTHLY-CERT)
 12490        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12491            MOVE '001'           TO PB-I-LF-TERM
 12492            MOVE 'M'             TO PB-I-INSURED-SEX.
 12493
 12494     IF (NOT PB-REISSUED-CERT)
 12495        AND (NOT PB-MONTHLY-CERT)
 12496        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12497            MOVE '001'           TO PB-I-AH-TERM
 12498            MOVE 'M'             TO PB-I-INSURED-SEX.
 12499
 12500 3040-EDIT-1ST-PMT-DT.
 12501     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12502     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 229
* EL050.cbl
 12503         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12504
 12505******************************************************************
 12506*                                                                *
 12507*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12508*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12509*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12510*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12511*                                                                *
 12512******************************************************************
 12513
 12514     IF PB-EFF-DT-PROCESSING
 12515        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12516                                    PB-I-LF-EXPIRE-DT
 12517                                    PB-I-AH-EXPIRE-DT
 12518        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12519        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12520        MOVE ZERO                TO DC-ELAPSED-DAYS
 12521        MOVE +1                  TO DC-ELAPSED-MONTHS
 12522        SET BIN-PLUS-ELAPSED     TO TRUE
 12523*       MOVE 6                   TO DC-OPTION-CODE
 12524        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12525        IF NO-CONVERSION-ERROR
 12526           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12527
 12528******************************************************************
 12529*                                                                *
 12530*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12531*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12532*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12533*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12534*                                                                *
 12535******************************************************************
 12536
 12537     IF PB-EXT-DAYS-PROCESSING
 12538          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12539                                         PB-I-LF-EXPIRE-DT
 12540                                         PB-I-AH-EXPIRE-DT
 12541          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12542          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12543          MOVE +1                     TO DC-ELAPSED-MONTHS
 12544          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12545          SET BIN-PLUS-ELAPSED        TO TRUE
 12546*         MOVE 6                      TO DC-OPTION-CODE
 12547          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12548          IF NO-CONVERSION-ERROR
 12549             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12550
 12551******************************************************************
 12552*                                                                *
 12553*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12554*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12555*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12556*        (EXPIRE DATE - (TERM -1))  *  -1.
 12557*                                                                *
 12558******************************************************************
 12559
 12560     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 230
* EL050.cbl
 12561        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12562           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12563              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12564              MOVE PB-I-AH-TERM      TO WS-TERM
 12565           ELSE
 12566              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12567              MOVE PB-I-LF-TERM      TO WS-TERM
 12568        ELSE
 12569           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12570              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12571              MOVE PB-I-LF-TERM      TO WS-TERM
 12572           ELSE
 12573              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12574              MOVE PB-I-AH-TERM      TO WS-TERM.
 12575
 12576     IF PB-EXPIRE-DT-PROCESSING
 12577        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12578        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12579        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12580        MOVE ZERO                TO DC-ELAPSED-DAYS
 12581                                    DC-ODD-DAYS-OVER
 12582          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12583          SET BIN-PLUS-ELAPSED    TO TRUE
 12584*         MOVE 6                  TO DC-OPTION-CODE
 12585          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12586          IF NO-CONVERSION-ERROR
 12587             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12588
 12589******************************************************************
 12590*                                                                *
 12591*            1ST PAYMENT DATE PROCESSING                         *
 12592*                                                                *
 12593******************************************************************
 12594
 12595     IF PB-1ST-PMT-DT-PROCESSING
 12596        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12597                                    PB-I-AH-EXPIRE-DT
 12598        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12599
 12600     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12601         NEXT SENTENCE
 12602     ELSE
 12603         MOVE ER-2680                 TO WS-ERROR
 12604         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12605         GO TO 3060-ORIG-TERM-CHECK.
 12606
 12607     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12608     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12609     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12610*    MOVE 1                      TO DC-OPTION-CODE.
 12611     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12612                                    DC-ELAPSED-DAYS
 12613                                    DC-ODD-DAYS-OVER.
 12614
 12615     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12616
 12617     IF DATE-CONVERSION-ERROR
 12618        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 231
* EL050.cbl
 12619
 12620     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12621     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12622        AND (WS-LF-COVERAGE-TYPE = 'L')
 12623        IF (DC-ELAPSED-MONTHS > 1)
 12624                      OR
 12625           ((DC-ELAPSED-MONTHS = 1)
 12626           AND (DC-ODD-DAYS-OVER > 0))
 12627           MOVE ER-2882          TO WS-ERROR
 12628           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12629        END-IF
 12630     END-IF
 12631     if dc-elapsed-months > 0
 12632        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12633        + dc-odd-days-over
 12634     end-if
 12635     IF PB-EXT-DAYS-PROCESSING
 12636        CONTINUE
 12637     ELSE
 12638        IF DC-ELAPSED-MONTHS = +0
 12639           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12640        ELSE
 12641           IF (WS-LF-EARNINGS-CALC = '4')
 12642              AND (DC-ELAPSED-MONTHS > ZERO)
 12643              AND (DC-ELAPSED-DAYS > ZERO)
 12644              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12645           ELSE
 12646              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12647                                 THRU 6499-EXIT
 12648              MOVE WS-ODD-DAYS-OVER
 12649                                 TO PB-I-EXTENTION-DAYS
 12650           END-IF
 12651        END-IF
 12652     END-IF
 12653******************************************************************
 12654*                                                                *
 12655*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12656*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12657*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12658*            AND ANY ODD DAYS.                                   *
 12659*                                                                *
 12660******************************************************************
 12661
 12662     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12663                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12664     IF WS-LF-EARNINGS-CALC NOT = '4'
 12665        IF DC-ELAPSED-DAYS > ZEROS
 12666           MOVE ER-2681          TO WS-ERROR
 12667           PERFORM 9900-ERROR-FORMAT
 12668                                 THRU 9900-EXIT
 12669        END-IF
 12670     END-IF
 12671
 12672     IF WS-LF-EARNINGS-CALC NOT = '4'
 12673        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12674           MOVE ER-2681          TO WS-ERROR
 12675           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12676
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 232
* EL050.cbl
 12677     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12678        (PB-I-LF-TERM NOT = ZERO) AND
 12679         NOT NO-LIFE-COVERAGE
 12680          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12681          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12682          IF WS-LF-EARNINGS-CALC = '4'
 12683             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12684             PB-I-PAY-FREQUENCY
 12685          END-IF
 12686          MOVE ZERO              TO DC-ELAPSED-DAYS
 12687                                    DC-ODD-DAYS-OVER
 12688          MOVE 1                 TO DC-END-OF-MONTH
 12689          SET BIN-PLUS-ELAPSED        TO TRUE
 12690*         MOVE 6                 TO DC-OPTION-CODE
 12691          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12692          IF NO-CONVERSION-ERROR
 12693             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12694             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12695                (WS-LF-SPECIAL-CALC-CD = 'L')
 12696                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12697                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12698                  MOVE +1             TO DC-ELAPSED-MONTHS
 12699                  SET BIN-PLUS-ELAPSED  TO TRUE
 12700*                 MOVE 6              TO DC-OPTION-CODE
 12701                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12702                  IF NO-CONVERSION-ERROR
 12703                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12704
 12705* okay, i had to move the new att age edit down here because the
 12706* expiration date could get recalculated and i need the exp date
 12707     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12708        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12709        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12710        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12711           AND ZEROS
 12712           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12713           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12714           SET ELAPSED-BETWEEN-BIN TO TRUE
 12715           PERFORM 8500-DATE-CONVERT
 12716                                 THRU 8500-EXIT
 12717           IF NO-CONVERSION-ERROR
 12718              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12719                 MOVE ER-2669       TO WS-ERROR
 12720*                PERFORM 9900-ERROR-FORMAT
 12721*                                THRU 9900-EXIT
 12722              END-IF
 12723           END-IF
 12724        ELSE
 12725           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12726           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12727              MOVE ER-2669       TO WS-ERROR
 12728*             PERFORM 9900-ERROR-FORMAT
 12729*                                THRU 9900-EXIT
 12730           ELSE
 12731              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12732                 MOVE ER-1570    TO WS-ERROR
 12733                 PERFORM 9900-ERROR-FORMAT
 12734                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 233
* EL050.cbl
 12735              END-IF
 12736           END-IF
 12737        END-IF
 12738        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12739           AND ZEROS
 12740           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12741           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12742           SET ELAPSED-BETWEEN-BIN TO TRUE
 12743           PERFORM 8500-DATE-CONVERT
 12744                                 THRU 8500-EXIT
 12745           IF NO-CONVERSION-ERROR
 12746              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12747                 MOVE ER-2669       TO WS-ERROR
 12748*                PERFORM 9900-ERROR-FORMAT
 12749*                                THRU 9900-EXIT
 12750              END-IF
 12751           END-IF
 12752        ELSE
 12753           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12754             (PB-I-LF-TERM / 12)
 12755           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12756              MOVE ER-2669       TO WS-ERROR
 12757*             PERFORM 9900-ERROR-FORMAT
 12758*                                THRU 9900-EXIT
 12759           ELSE
 12760              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12761                 MOVE ER-1571    TO WS-ERROR
 12762                 PERFORM 9900-ERROR-FORMAT
 12763                                 THRU 9900-EXIT
 12764              END-IF
 12765           END-IF
 12766        END-IF
 12767        IF WS-ERROR = ER-2669
 12768           PERFORM 9900-ERROR-FORMAT
 12769                                 THRU 9900-EXIT
 12770        END-IF
 12771     END-IF
 12772     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12773        (PB-I-AH-TERM NOT = ZERO) AND
 12774         NOT NO-AH-COVERAGE
 12775          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12776             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12777             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12778             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12779          ELSE
 12780             IF WS-LF-EARNINGS-CALC = '4'
 12781                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12782                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12783                PB-I-PAY-FREQUENCY
 12784             ELSE
 12785                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12786                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12787             END-IF
 12788          END-IF
 12789          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12790                                         DC-ODD-DAYS-OVER
 12791          MOVE 1                      TO DC-END-OF-MONTH
 12792          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 234
* EL050.cbl
 12793*         MOVE 6                      TO DC-OPTION-CODE
 12794          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12795          IF NO-CONVERSION-ERROR
 12796             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12797     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12798        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12799        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12800        IF PB-I-BIRTHDAY > LOW-VALUES
 12801           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12802           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12803           SET ELAPSED-BETWEEN-BIN TO TRUE
 12804           PERFORM 8500-DATE-CONVERT
 12805                                 THRU 8500-EXIT
 12806           IF NO-CONVERSION-ERROR
 12807              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12808                 MOVE ER-3054       TO WS-ERROR
 12809*                PERFORM 9900-ERROR-FORMAT
 12810*                                THRU 9900-EXIT
 12811              END-IF
 12812           END-IF
 12813        ELSE
 12814           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12815           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12816              MOVE ER-3054       TO WS-ERROR
 12817*             PERFORM 9900-ERROR-FORMAT
 12818*                                THRU 9900-EXIT
 12819           END-IF
 12820        END-IF
 12821        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12822           AND ZEROS
 12823           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12824           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12825           SET ELAPSED-BETWEEN-BIN TO TRUE
 12826           PERFORM 8500-DATE-CONVERT
 12827                                 THRU 8500-EXIT
 12828           IF NO-CONVERSION-ERROR
 12829              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12830                 MOVE ER-3054       TO WS-ERROR
 12831*                PERFORM 9900-ERROR-FORMAT
 12832*                                THRU 9900-EXIT
 12833              END-IF
 12834           END-IF
 12835        ELSE
 12836           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12837             (PB-I-AH-TERM / 12)
 12838           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12839              MOVE ER-3054       TO WS-ERROR
 12840*             PERFORM 9900-ERROR-FORMAT
 12841*                                THRU 9900-EXIT
 12842           END-IF
 12843        END-IF
 12844        IF WS-ERROR = ER-3054
 12845           PERFORM 9900-ERROR-FORMAT
 12846                                 THRU 9900-EXIT
 12847        END-IF
 12848     END-IF
 12849     MOVE SPACE                       TO DC-END-OF-MONTH.
 12850
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 235
* EL050.cbl
 12851     IF PB-COMPANY-ID = 'NCB'
 12852        GO TO 3040-EDIT-EXTENSION-DAYS.
 12853
 12854     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12855       AND
 12856        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12857        NEXT SENTENCE
 12858     ELSE
 12859        GO TO 3040-EDIT-EXTENSION-DAYS.
 12860
 12861     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12862        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12863        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12864     ELSE
 12865        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12866        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12867
 12868     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12869*    MOVE '1'      TO DC-OPTION-CODE
 12870     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12871     IF (NO-CONVERSION-ERROR)
 12872        AND (DC-ELAPSED-MONTHS > +1)
 12873        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12874        MOVE ER-2668   TO WS-ERROR
 12875        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12876
 12877 3040-EDIT-EXTENSION-DAYS.
 12878
 12879     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12880        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12881         GO TO 3050-EDIT-TERM-IN-DAYS
 12882     ELSE
 12883         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12884
 12885     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12886         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12887     ELSE
 12888        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12889           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12890           MOVE ER-2681         TO WS-ERROR
 12891           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12892
 12893     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12894        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12895        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12896         GO TO 3060-ORIG-TERM-CHECK.
 12897
 12898     GO TO 3060-ORIG-TERM-CHECK.
 12899
 12900 3050-EDIT-TERM-IN-DAYS.
 12901
 12902     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12903
 12904     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12905         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12906     ELSE
 12907         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12908            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 236
* EL050.cbl
 12909            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12910
 12911     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12912                                       REMAINDER WS-WORK-TERM.
 12913     IF WS-WORK-TERM GREATER THAN ZERO
 12914         ADD +1 TO PB-I-LF-TERM.
 12915
 12916     IF NOT NO-AH-COVERAGE
 12917         MOVE ER-2684            TO WS-ERROR
 12918         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12919
 12920
 12921 3060-ORIG-TERM-CHECK.
 12922
 12923******************************************************************
 12924*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12925******************************************************************
 12926
 12927     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12928        NEXT SENTENCE
 12929     ELSE
 12930        IF NOT NO-LIFE-COVERAGE
 12931           IF PB-I-LF-TERM NUMERIC
 12932              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12933              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12934              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12935                  NEXT SENTENCE
 12936           ELSE
 12937              MOVE ER-2647       TO WS-ERROR
 12938              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12939
 12940     IF NOT NO-AH-COVERAGE
 12941         IF PB-I-AH-TERM NUMERIC
 12942            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12943            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12944            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12945             NEXT SENTENCE
 12946          ELSE
 12947              MOVE ER-2658       TO WS-ERROR
 12948              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12949
 12950     IF PB-COMPANY-ID = 'NCB'
 12951        GO TO 3070-LOAN-TERM-CHECK.
 12952
 12953     IF POLICY-HAS-AH
 12954       AND
 12955        POLICY-HAS-LIFE
 12956       AND
 12957        PB-I-LF-TERM NUMERIC
 12958       AND
 12959        PB-I-AH-TERM NUMERIC
 12960        NEXT SENTENCE
 12961     ELSE
 12962        GO TO 3070-LOAN-TERM-CHECK.
 12963
 12964     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12965     IF WS-TEX-FACT-2 LESS THAN +0
 12966        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 237
* EL050.cbl
 12967
 12968     IF WS-TEX-FACT-2 GREATER THAN +1
 12969        MOVE ER-2668             TO WS-ERROR
 12970        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12971
 12972 3070-LOAN-TERM-CHECK.
 12973
 12974     IF (WS-LF-BENEFIT-CD = ZERO)
 12975         OR (NO-LF-BENEFIT-MATCH)
 12976            GO TO 3125-EDIT-PMT-FREQ.
 12977*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12978*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12979*          AND 'V' AND 'W' AND 'X'
 12980*          GO TO 3125-EDIT-PMT-FREQ
 12981*       END-IF
 12982*    ELSE
 12983*       IF WS-AH-DCC-TRUNC = 'T'
 12984*          CONTINUE
 12985*       ELSE
 12986*          GO TO 3125-EDIT-PMT-FREQ
 12987*       END-IF
 12988*    END-IF
 12989     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12990                    OR
 12991        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12992        AND (WS-AH-DCC-TRUNC = 'T'))
 12993        CONTINUE
 12994     ELSE
 12995        GO TO 3125-EDIT-PMT-FREQ
 12996     END-IF
 12997     IF PB-I-LOAN-TERM NOT NUMERIC
 12998         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12999
 13000     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 13001        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 13002*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 13003        PB-I-LOAN-TERM NOT GREATER THAN +360
 13004         NEXT SENTENCE
 13005     ELSE
 13006         MOVE ER-2648            TO WS-ERROR
 13007         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13008
 13009     if  PB-I-LOAN-TERM > WS-MAX-TERM
 13010        MOVE ER-3058             TO WS-ERROR
 13011        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13012     end-if
 13013
 13014     IF WS-STATE-ABBREVIATION = 'NC'
 13015        IF PB-I-LOAN-TERM > +59
 13016           CONTINUE
 13017        ELSE
 13018           MOVE ER-2792          TO WS-ERROR
 13019           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13020        END-IF
 13021     END-IF
 13022
 13023     .
 13024 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 238
* EL050.cbl
 13025     IF (WS-LF-BENEFIT-CD = ZERO)
 13026         OR (NO-LF-BENEFIT-MATCH)
 13027         or (pb-state = 'AL')
 13028            GO TO 3127-EDIT-LOAN-OFFICER.
 13029     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 13030                    OR
 13031        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 13032        AND (WS-AH-DCC-TRUNC = 'T'))
 13033                    OR
 13034         (PB-COMPANY-ID = 'AHL')
 13035        CONTINUE
 13036     ELSE
 13037        IF (PB-I-LOAN-TERM > ZEROS)
 13038           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 13039           MOVE ER-1575          TO WS-ERROR
 13040           PERFORM 9900-ERROR-FORMAT
 13041                                 THRU 9900-EXIT
 13042        END-IF
 13043     END-IF
 13044     IF WS-LF-EARNINGS-CALC NOT = '4'
 13045         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 13046            MOVE ER-2653         TO WS-ERROR
 13047            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13048            GO TO 3127-EDIT-LOAN-OFFICER
 13049         ELSE
 13050            GO TO 3127-EDIT-LOAN-OFFICER.
 13051
 13052     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 13053         MOVE ER-2655            TO WS-ERROR
 13054         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13055         GO TO 3127-EDIT-LOAN-OFFICER.
 13056
 13057     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 13058         MOVE ER-2654            TO WS-ERROR
 13059         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13060         GO TO 3127-EDIT-LOAN-OFFICER.
 13061
 13062     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 13063         GIVING WS-TEX-FACT-2
 13064             REMAINDER WS-TEX-FACT-3.
 13065
 13066*    IF WS-TEX-FACT-3 NOT = ZERO
 13067*       MOVE ER-2654             TO WS-ERROR
 13068*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13069
 13070
 13071 3127-EDIT-LOAN-OFFICER.
 13072
 13073     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 13074        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 13075           MOVE ER-2690          TO WS-ERROR
 13076           PERFORM 9900-ERROR-FORMAT
 13077                                 THRU 9900-EXIT
 13078        ELSE
 13079           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 13080           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 13081           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 13082           MOVE PB-SV-STATE      TO LOFC-STATE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 239
* EL050.cbl
 13083           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 13084           MOVE PB-I-LOAN-OFFICER
 13085                                 TO LOFC-CODE
 13086           PERFORM 8586-READ-LOAN-OFFICER
 13087                                 THRU 8586-EXIT
 13088           IF (NOT LOFC-MASTER-FOUND)
 13089              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 13090              MOVE ER-3006       TO WS-ERROR
 13091              PERFORM 9900-ERROR-FORMAT
 13092                                 THRU 9900-EXIT
 13093           END-IF
 13094        END-IF
 13095     END-IF
 13096     .
 13097 3129-EDIT-APR.
 13098
 13099     IF (WS-LF-BENEFIT-CD = ZERO)
 13100        OR (NO-LF-BENEFIT-MATCH)
 13101        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 13102           GO TO 3130-EDIT-AGE
 13103*       ELSE
 13104*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13105*             GO TO 3130-EDIT-AGE
 13106*          END-IF
 13107        END-IF
 13108     END-IF
 13109
 13110     IF (WS-STATE-ABBREVIATION = 'OH')
 13111         AND (PB-I-RATE-CLASS NOT = 'L ')
 13112         AND (PB-I-LF-TERM GREATER THAN 60)
 13113         AND (PB-CERT-EFF-DT GREATER WS-831031)
 13114         GO TO 3129-APR-CONT.
 13115
 13116     IF (WS-STATE-ABBREVIATION = 'RI')
 13117         AND (PB-I-LF-TERM GREATER THAN 60)
 13118         AND (PB-CERT-EFF-DT GREATER WS-831231)
 13119         GO TO 3129-APR-CONT.
 13120
 13121     IF (WS-STATE-ABBREVIATION = 'UT')
 13122         AND (PB-I-LF-TERM GREATER THAN 62)
 13123         AND (PB-CERT-EFF-DT GREATER WS-810831)
 13124         AND (PB-CERT-EFF-DT LESS WS-830901)
 13125         GO TO 3129-APR-CONT.
 13126
 13127     IF PB-COMPANY-ID = 'LAP'
 13128        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 13129           IF PB-I-LOAN-APR GREATER THAN ZEROS
 13130              MOVE ER-2656         TO WS-ERROR
 13131              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13132              GO TO 3130-EDIT-AGE.
 13133
 13134     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13135        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13136        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 13137        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13138        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 13139        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 13140         GO TO 3130-EDIT-AGE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 240
* EL050.cbl
 13141
 13142 3129-APR-CONT.
 13143     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 13144         (WS-LF-SPECIAL-CALC-CD = 'M'))
 13145         GO TO 3130-EDIT-AGE.
 13146
 13147     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 13148         WS-AH-BENEFIT-CD (1:1) = 'S')
 13149        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 13150        AND (PB-I-LOAN-APR = ZERO)
 13151        MOVE ER-2657             TO WS-ERROR
 13152        PERFORM 9900-ERROR-FORMAT
 13153                                 THRU 9900-EXIT
 13154        GO TO 3130-EDIT-AGE
 13155     END-IF
 13156*    IF PB-I-LOAN-APR = ZERO
 13157*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 13158*    END-IF
 13159
 13160     if pb-i-loan-apr = +99.9999
 13161        move er-2656             to ws-error
 13162        PERFORM 9900-ERROR-FORMAT
 13163                                 THRU 9900-EXIT
 13164        GO TO 3130-EDIT-AGE
 13165     end-if
 13166*    IF PB-I-LOAN-APR = ZERO
 13167*       MOVE ER-2656             TO WS-ERROR
 13168*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13169*       GO TO 3130-EDIT-AGE.
 13170
 13171*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 13172     if pb-i-loan-apr not = +99.9999
 13173        IF PB-I-LOAN-APR > +30.000
 13174           MOVE ER-2657          TO WS-ERROR
 13175           PERFORM 9900-ERROR-FORMAT
 13176                                 THRU 9900-EXIT
 13177        end-if
 13178     end-if
 13179     .
 13180 3130-EDIT-AGE.
 13181
 13182******************************************************************
 13183*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 13184******************************************************************
 13185
 13186     IF NOT NO-LIFE-COVERAGE
 13187        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13188           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 13189               MOVE ER-2628             TO WS-ERROR
 13190               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13191
 13192     IF NOT NO-AH-COVERAGE
 13193        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13194           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 13195               MOVE ER-2628         TO WS-ERROR
 13196               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13197
 13198 3133-SEX-CODE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 241
* EL050.cbl
 13199     IF PB-I-INSURED-SEX = SPACE OR ZERO
 13200         IF WS-DEFAULT-SEX = 'M'
 13201             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 13202          ELSE
 13203             IF WS-DEFAULT-SEX = 'F'
 13204             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 13205
 13206     IF PB-I-INSURED-SEX = '1'
 13207         MOVE 'M' TO PB-I-INSURED-SEX.
 13208
 13209     IF PB-I-INSURED-SEX = '2'
 13210         MOVE 'F' TO PB-I-INSURED-SEX.
 13211
 13212 3134-SIG-SW-EDIT.
 13213     IF PB-I-SIG-SW = SPACE
 13214         MOVE 'N'                TO  PB-I-SIG-SW.
 13215
 13216     IF PB-COMPANY-ID = 'NCL'
 13217         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 13218             NEXT SENTENCE
 13219         ELSE
 13220             MOVE ER-1923        TO  WS-ERROR
 13221             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13222     ELSE
 13223     IF PB-COMPANY-ID = 'CRI'
 13224         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 13225             NEXT SENTENCE
 13226         ELSE
 13227             MOVE ER-2606        TO  WS-ERROR
 13228             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13229     ELSE
 13230     IF PB-COMPANY-ID = 'TMS'
 13231         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 13232             NEXT SENTENCE
 13233         ELSE
 13234             MOVE ER-2689        TO  WS-ERROR
 13235             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13236     ELSE
 13237         IF PB-I-SIG-SW = 'Y' OR 'N'
 13238             NEXT SENTENCE
 13239         ELSE
 13240             MOVE ER-2651        TO  WS-ERROR
 13241             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13242
 13243     IF PB-COMPANY-ID = 'FLA'
 13244         IF (WS-EDIT-AGE GREATER 54  OR
 13245             WS-AH-EDIT-AGE GREATER 54)  AND
 13246            PB-I-SIG-SW = 'N'
 13247            MOVE ER-2651         TO  WS-ERROR
 13248            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13249
 13250 3135-NAME-EDIT.
 13251
 13252     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 13253        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 13254        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 13255           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 13256                                 TO PB-I-JOINT-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 242
* EL050.cbl
 13257        END-PERFORM
 13258     END-IF
 13259     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 13260        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 13261        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 13262           MOVE PB-I-JOINT-LAST-NAME (2:14)
 13263                                 TO PB-I-JOINT-LAST-NAME
 13264        END-PERFORM
 13265     END-IF
 13266     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 13267        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 13268        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 13269           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 13270                                 TO PB-I-INSURED-FIRST-NAME
 13271        END-PERFORM
 13272     END-IF
 13273     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 13274        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 13275        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 13276           MOVE PB-I-INSURED-LAST-NAME (2:14)
 13277                                 TO PB-I-INSURED-LAST-NAME
 13278        END-PERFORM
 13279     END-IF
 13280     if PB-I-JOINT-COVERAGE *> and
 13281*       pb-i-insured-last-name <> spaces
 13282        if pb-i-insured-last-name = pb-i-joint-last-name and
 13283           pb-i-insured-first-name = pb-i-joint-first-name and
 13284           pb-i-birthday = pb-i-joint-birthday
 13285           move er-3069          to ws-error
 13286           perform 9900-error-format
 13287                                 thru 9900-exit
 13288        end-if
 13289     end-if
 13290     IF PB-I-INSURED-LAST-NAME = SPACES
 13291       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13292       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13293           MOVE ER-2660    TO WS-ERROR
 13294           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13295
 13296 3136-EDIT-SEX.
 13297
 13298******************************************************************
 13299*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 13300******************************************************************
 13301
 13302     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 13303        (WS-AH-SPECIAL-CALC-CD = 'O')
 13304        NEXT SENTENCE
 13305     ELSE
 13306        IF PB-I-INSURED-SEX = 'M' OR 'F'
 13307           NEXT SENTENCE
 13308        ELSE
 13309           MOVE ER-2629            TO WS-ERROR
 13310           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13311
 13312 3137-EDIT-EFF-DATE.
 13313
 13314     IF PB-REISSUED-CERT       OR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 243
* EL050.cbl
 13315        PB-POLICY-IS-DECLINED  OR
 13316        PB-POLICY-IS-VOIDED
 13317         GO TO 3139-EDIT-COVERAGE-CODES.
 13318
 13319     MOVE SPACE                  TO WS-2671-SW
 13320                                    WS-2672-SW.
 13321
 13322     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 13323         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 13324             MOVE ER-2703        TO WS-ERROR
 13325             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13326             GO TO 3139-EDIT-COVERAGE-CODES.
 13327
 13328     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 13329         GO TO 3139-EDIT-COVERAGE-CODES.
 13330
 13331     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13332     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 13333*    MOVE '1'                    TO DC-OPTION-CODE.
 13334     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 13335     MOVE +0                     TO DC-ELAPSED-MONTHS
 13336                                    DC-ELAPSED-DAYS.
 13337     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13338
 13339     IF DATE-CONVERSION-ERROR
 13340         GO TO 3139-EDIT-COVERAGE-CODES.
 13341
 13342     IF DC-ELAPSED-DAYS GREATER +180
 13343         MOVE ER-2672            TO WS-ERROR
 13344         MOVE 'Y'                TO WS-2672-SW
 13345         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13346     END-IF
 13347
 13348     IF WS-ERROR = ER-2671  AND
 13349        PB-COMPANY-ID  = 'LBL'
 13350        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13351        MOVE SPACE               TO WS-2671-SW
 13352        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 13353
 13354     IF PB-ISSUE-DATE-FORCED  AND
 13355      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 13356         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 13357         MOVE ER-2673            TO WS-ERROR
 13358         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13359         MOVE SPACE              TO WS-2671-SW
 13360                                    WS-2672-SW.
 13361
 13362     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 13363         IF PB-ISSUE-DATE-FORCED
 13364             MOVE ER-2600          TO  WS-ERROR
 13365             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13366         ELSE
 13367             MOVE ER-2692          TO  WS-ERROR
 13368             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13369
 13370
 13371 3139-EDIT-COVERAGE-CODES.
 13372
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 244
* EL050.cbl
 13373     if pb-company-id not = 'AHL'
 13374        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 13375           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 13376           MOVE ER-2787          TO WS-ERROR
 13377           PERFORM 9900-ERROR-FORMAT
 13378                                 THRU 9900-EXIT
 13379        END-IF
 13380     end-if
 13381     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13382        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 13383                                 > 250000.00
 13384           MOVE ER-2719          TO WS-ERROR
 13385           PERFORM 9900-ERROR-FORMAT
 13386                                 THRU 9900-EXIT
 13387        END-IF
 13388     END-IF
 13389
 13390     IF PB-POLICY-IS-DECLINED  OR
 13391        PB-POLICY-IS-VOIDED
 13392         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13393
 13394     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 13395        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 13396         MOVE ER-2630                TO WS-ERROR
 13397         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13398
 13399     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 13400        PB-I-LF-BENEFIT-AMT = ZERO  AND
 13401        PB-I-LF-PREMIUM-AMT = ZERO
 13402         GO TO 3140-CHECK-AH-FOR-ZERO.
 13403
 13404     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 13405        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 13406        PB-I-LF-PREMIUM-AMT NOT = ZERO
 13407         GO TO 3140-CHECK-AH-FOR-ZERO.
 13408
 13409     IF (PB-I-LF-BENEFIT-CD = ZERO)
 13410        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13411        MOVE ER-2631             TO WS-ERROR
 13412        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13413     END-IF
 13414
 13415
 13416******************************************************************
 13417*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13418******************************************************************
 13419
 13420     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13421        NEXT SENTENCE
 13422     ELSE
 13423        IF PB-I-LF-BENEFIT-AMT = ZERO
 13424           MOVE ER-2632             TO WS-ERROR
 13425           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13426
 13427
 13428******************************************************************
 13429*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13430******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 245
* EL050.cbl
 13431
 13432     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13433        CONTINUE
 13434     ELSE
 13435        IF PB-I-LF-PREMIUM-AMT = ZERO
 13436           IF (NOT PB-COMP-LF-PREM)
 13437              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13438              and (ws-lf-ben-category not = 'C')
 13439              MOVE ER-2633       TO WS-ERROR
 13440              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13441           END-IF
 13442        END-IF
 13443     END-IF
 13444     .
 13445 3140-CHECK-AH-FOR-ZERO.
 13446
 13447     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13448        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13449        PB-I-AH-PREMIUM-AMT = ZERO
 13450         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13451
 13452     IF PB-COMPANY-ID = 'CSL'  AND
 13453        PB-I-AH-BENEFIT-CD = ZERO  AND
 13454        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13455        PB-I-AH-PREMIUM-AMT = ZERO
 13456         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13457
 13458     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13459        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13460        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13461         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13462
 13463     IF PB-I-AH-BENEFIT-CD = ZERO
 13464         MOVE ER-2634            TO WS-ERROR
 13465         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13466
 13467******************************************************************
 13468*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13469******************************************************************
 13470
 13471     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13472        NEXT SENTENCE
 13473     ELSE
 13474        IF PB-I-AH-BENEFIT-AMT = ZERO
 13475           MOVE ER-2635             TO WS-ERROR
 13476           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13477
 13478******************************************************************
 13479*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13480******************************************************************
 13481
 13482     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13483        NEXT SENTENCE
 13484     ELSE
 13485        IF PB-I-AH-PREMIUM-AMT = ZERO
 13486            IF NOT PB-COMP-AH-PREM
 13487                MOVE ER-2636    TO WS-ERROR
 13488                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 246
* EL050.cbl
 13489
 13490
 13491 3140-EDIT-MAX-AMT-SIZES.
 13492* CUSTOM CODE FOR CLIENT    'DMD'
 13493     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13494                                     WS-RES-MUNI-TAX
 13495                                     PB-I-STATE-TAX
 13496                                     PB-I-MUNI-TAX.
 13497
 13498     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13499
 13500     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13501        GO TO 3150-RATE-OUTSTAND-BAL.
 13502
 13503     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13504        GO TO 3150-RATE-OUTSTAND-BAL.
 13505
 13506     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13507        GO TO 3150-RATE-OUTSTAND-BAL.
 13508
 13509     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13510                             OR 'RIC')
 13511        GO TO 3150-RATE-OUTSTAND-BAL.
 13512
 13513     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13514        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13515            GO TO 3150-RATE-OUTSTAND-BAL
 13516        ELSE
 13517           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13518               GO TO 3150-RATE-OUTSTAND-BAL.
 13519
 13520     IF NOT PB-NO-MONTHS-SKIPPED
 13521        GO TO 3150-RATE-OUTSTAND-BAL.
 13522
 13523     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13524        GO TO 3150-RATE-OUTSTAND-BAL.
 13525
 13526     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13527        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13528           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13529             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13530           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13531           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13532              MOVE ER-2693     TO WS-ERROR
 13533              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13534              GO TO 3150-RATE-OUTSTAND-BAL
 13535           ELSE
 13536              GO TO 3150-RATE-OUTSTAND-BAL.
 13537
 13538 3150-RATE-OUTSTAND-BAL.
 13539
 13540* DMD RATING TEST
 13541     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13542         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13543         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13544         MOVE ER-2687                 TO WS-ERROR
 13545         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13546         MOVE 'B'                     TO PB-I-OB-FLAG
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 247
* EL050.cbl
 13547         GO TO 3260-EDIT-CONTINUE.
 13548
 13549     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13550         IF  WS-ERROR    EQUAL    ER-2693
 13551             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13552                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13553                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13554                 MOVE  +0            TO  WS-ERROR.
 13555
 13556     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13557         IF  WS-ERROR    EQUAL    ER-2693
 13558             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13559                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13560                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13561                 MOVE  +0            TO  WS-ERROR.
 13562
 13563     IF PLAN-MASTER-AH-SW = 'Y'
 13564        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13565            IF  WS-ERROR    EQUAL    ER-2693
 13566              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13567                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13568                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13569                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13570                 MOVE  ER-1910           TO  WS-ERROR
 13571                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13572
 13573     IF PLAN-MASTER-AH-SW = 'Y'
 13574        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13575            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13576               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13577               MOVE  ER-1910           TO  WS-ERROR
 13578               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13579
 13580     IF PLAN-MASTER-AH-SW = 'Y'
 13581        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13582            IF  WS-ERROR    EQUAL    ER-2693
 13583                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13584                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13585                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13586                 MOVE  +0       TO  WS-ERROR.
 13587
 13588     IF WS-ERROR = ER-2693
 13589        IF PB-COMPANY-ID = 'JAL' AND
 13590           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13591           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13592           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13593
 13594     IF WS-ERROR = ER-2693
 13595        IF PB-COMPANY-ID = 'NCL'  AND
 13596           PB-I-AH-BENEFIT-CD = 'OA'
 13597           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13598           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13599
 13600     IF WS-ERROR = ER-2693
 13601        IF PB-COMPANY-ID = 'CNL' AND
 13602           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13603           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13604           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 248
* EL050.cbl
 13605
 13606     IF WS-ERROR = ER-2693
 13607        IF PB-COMPANY-ID = 'HER'
 13608           IF WS-LEVEL
 13609              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13610              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13611
 13612     IF ((LF-BENEFIT-FOUND) AND
 13613         (NOT NO-LIFE-COVERAGE)  AND
 13614         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13615       OR   ((AH-BENEFIT-FOUND) AND
 13616             (NOT NO-AH-COVERAGE)    AND
 13617             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13618         NEXT SENTENCE
 13619     ELSE
 13620         GO TO 3215-EDIT-RATES.
 13621
 13622     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13623        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13624           MOVE ER-2674          TO WS-ERROR
 13625           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13626           GO TO 3215-EDIT-RATES.
 13627
 13628     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13629        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13630           MOVE ER-2674          TO WS-ERROR
 13631           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13632           GO TO 3215-EDIT-RATES.
 13633
 13634     MOVE 'B'                    TO PB-I-OB-FLAG.
 13635
 13636     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13637         NEXT SENTENCE
 13638     ELSE
 13639         IF NOT NO-LIFE-COVERAGE
 13640             IF WS-ACCT-LF-OB-RT = ZERO
 13641                MOVE ER-2641    TO WS-ERROR
 13642                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13643
 13644     IF PB-COMPANY-ID = 'CRI'
 13645       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13646         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13647         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13648         IF WS-ERROR = ER-2675
 13649            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13650            MOVE ER-2687              TO WS-ERROR
 13651            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13652         ELSE
 13653            MOVE ER-2687              TO WS-ERROR
 13654            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13655
 13656
 13657     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13658         NEXT SENTENCE
 13659     ELSE
 13660       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13661            NEXT SENTENCE
 13662       ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 249
* EL050.cbl
 13663         IF NOT NO-AH-COVERAGE
 13664             IF WS-ACCT-AH-OB-RT = ZERO
 13665                MOVE ER-2642    TO WS-ERROR
 13666                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13667
 13668     IF PB-COMPANY-ID = 'CRI'
 13669       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13670         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13671         IF WS-ERROR = ER-2676
 13672            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13673            MOVE ER-2687              TO WS-ERROR
 13674            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13675         ELSE
 13676            MOVE ER-2687              TO WS-ERROR
 13677            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13678
 13679     IF PB-COMPANY-ID NOT = 'GIC'
 13680         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13681            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13682     ELSE
 13683         IF PB-I-LF-PREM-CALC = ZEROS
 13684             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13685                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13686
 13687     IF PB-COMPANY-ID NOT = 'GIC'
 13688         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13689            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13690     ELSE
 13691         IF PB-I-AH-PREM-CALC = ZEROS
 13692             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13693                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13694
 13695     MOVE ZEROS TO PB-I-MORT-CODE.
 13696
 13697     GO TO 3260-EDIT-CONTINUE.
 13698
 13699
 13700 3215-EDIT-RATES.
 13701     IF ACCOUNT-MAST-FOUND
 13702         NEXT SENTENCE
 13703     ELSE
 13704         GO TO 3999-END-EDIT.
 13705
 13706 3220-CHECK-LF-RATES.
 13707
 13708     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13709        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13710        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13711        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13712           AND (NOT WS-LF-CASH))
 13713                           OR
 13714           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13715           AND (NOT WS-AH-CASH)))
 13716                       AND
 13717           (PB-I-ENTRY-STATUS NOT = '5')
 13718           MOVE 'M'              TO PB-BATCH-ENTRY
 13719                                    PB-I-ENTRY-STATUS
 13720        END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 250
* EL050.cbl
 13721     END-IF
 13722     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13723                                    PB-I-AH-PREM-CALC
 13724                                    PB-I-LF-ALT-PREM-CALC
 13725                                    PB-I-LF-ALT-RATE
 13726                                    PB-I-LF-REI-RATE
 13727                                    PB-I-LF-ALT-REI-RATE
 13728                                    PB-I-AH-REI-RATE
 13729                                    PB-I-TOT-FEES-CALC.
 13730
 13731     IF PB-COMPANY-ID EQUAL 'DMD'
 13732        NEXT SENTENCE
 13733     ELSE
 13734        MOVE ZEROS               TO PB-I-LF-RATE
 13735                                    PB-I-AH-RATE.
 13736
 13737     IF PB-I-TOT-FEES NOT NUMERIC
 13738        MOVE ZEROS               TO PB-I-TOT-FEES
 13739     END-IF
 13740     IF PB-I-LIVES NOT NUMERIC
 13741         MOVE ZERO               TO PB-I-LIVES.
 13742
 13743     IF PB-I-NUM-BILLED NOT NUMERIC
 13744         MOVE ZERO               TO PB-I-NUM-BILLED.
 13745
 13746     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13747        MOVE +0                  TO PB-I-LF-PREM-TAX
 13748     END-IF
 13749
 13750     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13751        MOVE +0                  TO PB-I-AH-PREM-TAX
 13752     END-IF
 13753
 13754     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13755        PB-I-PAY-FREQUENCY = ZEROS
 13756            MOVE 12 TO CP-PAY-FREQUENCY
 13757     ELSE
 13758            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13759
 13760     IF PB-I-STATE-TAX NOT NUMERIC
 13761         MOVE ZEROS               TO PB-I-STATE-TAX.
 13762
 13763     IF PB-I-MUNI-TAX NOT NUMERIC
 13764         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13765
 13766     MOVE SPACES                 TO CP-BEN-CATEGORY
 13767     IF PB-COMPANY-ID  = 'CSL'  AND
 13768        PB-I-LF-TERM NOT = ZERO
 13769        COMPUTE WS-PAYMENT-AMT =
 13770             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13771        COMPUTE WS-CSL-AMT1 =
 13772             PB-I-LF-TERM * AM-MAX-MON-BEN
 13773        COMPUTE WS-CSL-AMT2 =
 13774             WS-PAYMENT-AMT * PB-I-LF-TERM
 13775        IF CP-PAY-FREQUENCY NOT = 12
 13776           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13777           MOVE '8' TO WS-CSL-CALC-CD
 13778        ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 251
* EL050.cbl
 13779           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13780              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13781               AM-MAX-TOT-BEN
 13782               MOVE '6' TO WS-CSL-CALC-CD
 13783           ELSE
 13784              IF (WS-CSL-AMT1  GREATER THAN
 13785                 AM-MAX-TOT-BEN) AND
 13786                 (WS-CSL-AMT2  GREATER THAN
 13787                 AM-MAX-TOT-BEN)
 13788                 MOVE '7' TO WS-CSL-CALC-CD
 13789              ELSE
 13790                 MOVE '5' TO WS-CSL-CALC-CD.
 13791
 13792     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13793         NEXT SENTENCE
 13794     ELSE
 13795         GO TO 3300-CHECK-AH-RATES.
 13796
 13797*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13798
 13799     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13800        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13801              OR
 13802           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13803           MOVE ER-2618          TO WS-ERROR
 13804           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13805           GO TO 3300-CHECK-AH-RATES.
 13806
 13807     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13808           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13809                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13810
 13811     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13812         MOVE ER-2687             TO WS-ERROR
 13813         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13814         MOVE 'Z000'              TO PB-I-MORT-CODE
 13815         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13816         GO TO 3300-CHECK-AH-RATES.
 13817
 13818     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13819        IF PB-I-LIVES = ZERO
 13820           MOVE ER-2688          TO WS-ERROR
 13821           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13822
 13823     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13824
 13825     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13826     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13827     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13828     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13829     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13830     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13831     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13832     MOVE '3'                    TO CP-PROCESS-TYPE.
 13833     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13834     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13835
 13836******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 252
* EL050.cbl
 13837     IF PB-COMPANY-ID EQUAL 'CDL'
 13838         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13839            CP-EARN-AS-NET-PAY)
 13840             IF PB-CERT-EFF-DT GREATER  WS-931231
 13841                 MOVE '1'        TO CP-EARNING-METHOD.
 13842*******
 13843
 13844     MOVE PB-SV-STATE            TO CP-STATE.
 13845     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13846     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13847     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13848     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13849     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13850                                    CP-RATING-BENEFIT-AMT.
 13851     IF CP-STATE-STD-ABBRV = 'OR'
 13852         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13853                                         PB-I-LF-ALT-BENEFIT-AMT.
 13854     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13855     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13856     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13857     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13858     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13859     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13860     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13861     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13862     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13863                                    CP-REMAINING-TERM
 13864                                    CP-LOAN-TERM.
 13865
 13866     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13867         NEXT SENTENCE
 13868     ELSE
 13869         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13870             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13871                                           PB-I-LF-PREMIUM-AMT.
 13872
 13873     IF PB-COMPANY-ID EQUAL 'CSL'
 13874        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13875           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13876                                         PB-I-LF-PREMIUM-AMT.
 13877
 13878     IF PB-COMPANY-ID EQUAL 'NCB'
 13879         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13880            CP-EARN-AS-NET-PAY
 13881             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13882                 PB-I-LF-PREMIUM-AMT.
 13883
 13884     IF (CP-TRUNCATED-LIFE)
 13885        or ((pb-company-id = 'AHL')
 13886           and (pb-i-loan-term > pb-i-lf-term))
 13887        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13888
 13889     IF PB-COMPANY-ID EQUAL 'CRI'
 13890        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13891
 13892     IF CP-TERM-IS-DAYS
 13893         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13894     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 253
* EL050.cbl
 13895         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13896     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13897        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13898        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13899        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13900        IF WS-LF-BEN-CATEGORY = 'D'
 13901           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13902           MOVE PB-I-LIFE-COMMISSION
 13903                                 TO CP-DCC-ACT-COMM
 13904           MOVE WS-LF-BEN-CATEGORY
 13905                                 TO CP-BEN-CATEGORY
 13906        END-IF
 13907        IF (CP-BENEFIT-CD (1:1) = 'P')
 13908           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13909           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13910           add pb-i-ah-premium-amt to cp-original-premium
 13911        END-IF
 13912     END-IF
 13913     IF PB-COMPANY-ID = 'CSL'
 13914         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13915         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13916         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13917
 13918     IF PB-COMPANY-ID = 'CSL'
 13919        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13920
 13921     IF (CP-SPECIAL-CALC-CD = 'H')
 13922        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13923         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13924                                    TO CP-ALTERNATE-BENEFIT
 13925         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13926     if (pb-company-id = 'CID')
 13927        and (ws-lf-earnings-calc = '4')
 13928        and (cp-state-std-abbrv = 'MN' OR 'WA' or 'AL')
 13929        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13930        move pb-i-term-type      to cp-pmt-mode
 13931        move pb-i-no-of-payments to cp-no-of-pmts
 13932        move pb-i-ah-benefit-amt to cp-monthly-payment
 13933     end-if
 13934     move ws-net-only-state      to cp-net-only-state
 13935     IF (PB-COMPANY-ID = 'CID')
 13936        AND (WS-LF-EARNINGS-CALC = 'B')
 13937        AND (CP-STATE-STD-ABBRV = 'MN')
 13938        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13939                                 TO CP-ALTERNATE-BENEFIT
 13940        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13941     END-IF
 13942     IF (PB-COMPANY-ID = 'CID')
 13943        AND (WS-LF-EARNINGS-CALC = 'B')
 13944        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13945                                 TO CP-ALTERNATE-BENEFIT
 13946        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13947        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13948*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13949*         pb-i-lf-alt-premium-amt
 13950        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13951        IF WS-LF-BEN-CATEGORY = 'P'
 13952           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 254
* EL050.cbl
 13953        ELSE
 13954           IF WS-LF-BEN-CATEGORY = 'I'
 13955              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13956           END-IF
 13957        END-IF
 13958     END-IF
 13959     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13960     MOVE 'R'                   TO CP-RATE-FILE.
 13961     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13962
 13963     IF CP-ERROR-RATE-NOT-FOUND
 13964        MOVE ER-2641            TO WS-ERROR
 13965        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13966        GO TO 3300-CHECK-AH-RATES.
 13967
 13968     IF PB-COMPANY-ID EQUAL 'CRI'
 13969        IF CP-ERROR-NO-LIMITS-CRI
 13970           IF NOT ACCOUNT-LIFE-CHECKED
 13971              MOVE ER-2607      TO WS-ERROR
 13972              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13973
 13974******************************************************************
 13975*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13976*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13977******************************************************************
 13978
 13979* CALC LIFE AGE AT EXPIRATION.
 13980
 13981     COMPUTE WS-AGE-AT-EXPIRE =
 13982          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13983
 13984*    IF PB-STATE = 'CO' OR 'UT'
 13985*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13986*        MOVE 'F'            TO PB-FATAL-FLAG
 13987*        MOVE ER-2709        TO WS-ERROR
 13988*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13989*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13990
 13991*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13992*        MOVE 'X'            TO PB-FATAL-FLAG
 13993*        MOVE ER-2718        TO WS-ERROR
 13994*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13995*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13996
 13997* CALC A & H AGE AT EXPIRATION.
 13998
 13999     COMPUTE WS-AGE-AT-EXPIRE =
 14000          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 14001
 14002*    IF PB-STATE = 'CO' OR 'UT'
 14003*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 14004*        MOVE 'F'            TO PB-FATAL-FLAG
 14005*        MOVE ER-2709        TO WS-ERROR
 14006*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14007*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 14008
 14009*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 14010*        MOVE 'X'            TO PB-FATAL-FLAG
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 255
* EL050.cbl
 14011*        MOVE ER-2718        TO WS-ERROR
 14012*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14013*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 14014
 14015     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 14016        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 14017
 14018     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14019        and (not pb-monthly-cert)
 14020        GO TO 3221-CHECK-ERROR-RATE-OPEN
 14021     end-if
 14022
 14023     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14024        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 14025
 14026     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14027         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 14028         MOVE ER-2639        TO WS-ERROR
 14029         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14030
 14031
 14032******************************************************************
 14033*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14034******************************************************************
 14035
 14036 PREMIUM-EDITING-IS-BYPASSED.
 14037     IF (CP-R-MAX-ATT-AGE NUMERIC)
 14038        AND (CP-R-MAX-ATT-AGE > +0)
 14039        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 14040        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14041           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 14042           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14043           MOVE '1'              TO DC-OPTION-CODE
 14044           PERFORM 8500-DATE-CONVERT
 14045                                 THRU 8500-EXIT
 14046           IF NO-CONVERSION-ERROR
 14047              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14048                 MOVE ER-2661       TO WS-ERROR
 14049*                PERFORM 9900-ERROR-FORMAT
 14050*                                THRU 9900-EXIT
 14051              END-IF
 14052           END-IF
 14053        ELSE
 14054           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 14055           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14056              MOVE ER-2661       TO WS-ERROR
 14057*             PERFORM 9900-ERROR-FORMAT
 14058*                                THRU 9900-EXIT
 14059           ELSE
 14060              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14061                 MOVE ER-1570    TO WS-ERROR
 14062                 PERFORM 9900-ERROR-FORMAT
 14063                                 THRU 9900-EXIT
 14064              END-IF
 14065           END-IF
 14066        END-IF
 14067        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14068           MOVE PB-I-JOINT-BIRTHDAY
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 256
* EL050.cbl
 14069                                 TO DC-BIN-DATE-1
 14070           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14071           MOVE '1'              TO DC-OPTION-CODE
 14072           PERFORM 8500-DATE-CONVERT
 14073                                 THRU 8500-EXIT
 14074           IF NO-CONVERSION-ERROR
 14075              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14076                 MOVE ER-2661       TO WS-ERROR
 14077*                PERFORM 9900-ERROR-FORMAT
 14078*                                THRU 9900-EXIT
 14079              END-IF
 14080           ELSE
 14081              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 14082           END-IF
 14083        ELSE
 14084           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14085             (PB-I-LF-TERM / 12)
 14086           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14087              MOVE ER-2661       TO WS-ERROR
 14088*             PERFORM 9900-ERROR-FORMAT
 14089*                                THRU 9900-EXIT
 14090           ELSE
 14091              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14092                 MOVE ER-1571    TO WS-ERROR
 14093                 PERFORM 9900-ERROR-FORMAT
 14094                                 THRU 9900-EXIT
 14095              END-IF
 14096           END-IF
 14097        END-IF
 14098        IF WS-ERROR = ER-2661
 14099           PERFORM 9900-ERROR-FORMAT
 14100                                 THRU 9900-EXIT
 14101        END-IF
 14102     END-IF
 14103*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14104*       MOVE ER-2661             TO WS-ERROR
 14105*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14106
 14107     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14108        MOVE ER-2662             TO WS-ERROR
 14109        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14110
 14111     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14112        MOVE ER-2677             TO WS-ERROR
 14113        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14114
 14115     IF CP-ERROR-LOAN-TERM
 14116        MOVE ER-2648             TO WS-ERROR
 14117        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14118
 14119 3221-CHECK-ERROR-RATE-OPEN.
 14120
 14121     IF CP-ERROR-RATE-FILE-NOTOPEN
 14122         GO TO 3990-FILES-NOT-OPEN.
 14123
 14124     IF PB-COMPANY-ID NOT = 'DMD'
 14125        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 14126     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 257
* EL050.cbl
 14127     .
 14128 3221-CONTINUE.
 14129     MOVE ZEROS                  TO WS-DCC-LF-RATE
 14130                                    WS-DCC-AH-RATE
 14131     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14132        IF WS-LF-BEN-CATEGORY = 'D'
 14133           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 14134              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14135        END-IF
 14136     END-IF
 14137     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 14138*   X'A4FF' = 12/31/2009
 14139     IF (PB-COMPANY-ID = 'CID')
 14140        AND (WS-LF-EARNINGS-CALC = 'B')
 14141        AND (CP-STATE-STD-ABBRV = 'MN')
 14142        AND (PB-CERT-EFF-DT > X'A4FF')
 14143        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 14144     END-IF
 14145     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 14146
 14147     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 14148     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14149        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14150        AND (PB-I-POLICY-IS-MONTHLY)
 14151        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 14152        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 14153     END-IF
 14154     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 14155     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 14156     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 14157     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 14158     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14159        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 14160        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14161        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 14162        MOVE ER-2786             TO WS-ERROR
 14163        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14164     END-IF
 14165
 14166     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 14167
 14168******************************************************************
 14169*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14170******************************************************************
 14171     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14172        and ((not pb-monthly-cert)
 14173        or (ws-lf-ben-category = 'C'))
 14174        GO TO 3225-CHECK-ALT-LIFE-RATE.
 14175
 14176     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14177        GO TO 3225-CHECK-ALT-LIFE-RATE
 14178     ELSE
 14179       IF PB-I-LF-RATE = ZERO
 14180          MOVE ER-2641          TO WS-ERROR
 14181          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14182
 14183 3225-CHECK-ALT-LIFE-RATE.
 14184
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 258
* EL050.cbl
 14185     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14186        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14187        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14188         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14189
 14190     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 14191         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 14192             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14193                   OR
 14194              (PB-I-LF-ALT-PREMIUM-AMT > +0
 14195              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 14196              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14197             MOVE ER-2720        TO  WS-ERROR
 14198             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14199             GO TO 3225-RATING-CONT
 14200         ELSE
 14201             GO TO 3225-RATING-CONT.
 14202     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 14203        AND (AM-GPCD = 01 OR 06 OR 15)
 14204        MOVE ER-2798             TO WS-ERROR
 14205        PERFORM 9900-ERROR-FORMAT
 14206                                 THRU 9900-EXIT
 14207*       GO TO 3225-RATING-CONT
 14208     END-IF
 14209     if (pb-company-id = 'CID')
 14210        and (ws-lf-earnings-calc = 'B')
 14211        and (ws-lf-ben-category = 'P' or 'I')
 14212        and (ws-net-only-state = 'Y')
 14213        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 14214*       display ' balloon prem ' pb-i-lf-alt-prem-calc
 14215        go to 3225-rating-cont
 14216     end-if
 14217     IF (PB-COMPANY-ID = 'CID')
 14218        AND (WS-LF-EARNINGS-CALC = 'B')
 14219        AND (CP-STATE-STD-ABBRV = 'MN')
 14220        AND (PB-CERT-EFF-DT > X'A4FF')
 14221        GO TO 3225-RATING-CONT
 14222     END-IF
 14223     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14224        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14225           AND (PB-I-POLICY-IS-MONTHLY)
 14226           GO TO 3225-RATING-CONT
 14227        END-IF
 14228     END-IF
 14229
 14230     IF PB-COMPANY-ID EQUAL 'WDS' AND
 14231        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 14232        CP-EARN-AS-REG-BALLOON
 14233        NEXT SENTENCE
 14234     ELSE
 14235        MOVE '2'                 TO CP-EARNING-METHOD.
 14236
 14237 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14238
 14239     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14240
 14241     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14242        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 259
* EL050.cbl
 14243        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14244         NEXT SENTENCE
 14245     ELSE
 14246         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 14247
 14248     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14249     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14250     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14251                                     CP-RATING-BENEFIT-AMT.
 14252     IF CP-STATE-STD-ABBRV = 'OR'
 14253         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14254                                         PB-I-LF-ALT-BENEFIT-AMT.
 14255     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14256        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14257     END-IF
 14258     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14259     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14260     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14261                                    CP-REMAINING-TERM
 14262                                    CP-LOAN-TERM.
 14263     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14264        ADD +1                   TO CP-ORIGINAL-TERM
 14265                                    CP-REMAINING-TERM
 14266                                    CP-LOAN-TERM.
 14267
 14268     MOVE 'R'                   TO CP-RATE-FILE.
 14269     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14270
 14271     IF CP-ERROR-RATE-NOT-FOUND
 14272         MOVE ER-2641            TO WS-ERROR
 14273         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14274         GO TO 3300-CHECK-AH-RATES.
 14275
 14276     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 14277     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 14278
 14279     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 14280         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 14281
 14282     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 14283                               + PB-I-LF-ALT-BENEFIT-AMT.
 14284
 14285     IF ACCOUNT-LIFE-CHECKED  OR
 14286        PB-POLICY-IS-VOIDED   OR
 14287        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14288        and (not pb-monthly-cert))
 14289        GO TO 3225-CONTINUE.
 14290
 14291     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14292        GO TO 3225-CONTINUE.
 14293
 14294     IF WS-LF-BENEFIT-AMT  GREATER THAN
 14295                             EC-RT-LF-MAX-TOT-BEN
 14296        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 14297        MOVE ER-2639       TO WS-ERROR
 14298        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14299
 14300 3225-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 260
* EL050.cbl
 14301     IF PB-I-LF-ALT-RATE = ZERO
 14302         MOVE ER-2659            TO WS-ERROR
 14303         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14304
 14305     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 14306        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 14307        MOVE ER-2698             TO WS-ERROR
 14308        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14309
 14310 3225-RATING-CONT.
 14311
 14312     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14313        and (not pb-monthly-cert)
 14314         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14315         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14316         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14317            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14318            CONTINUE
 14319         ELSE
 14320            MOVE ER-2687         TO WS-ERROR
 14321            PERFORM 9900-ERROR-FORMAT
 14322                                 THRU 9900-EXIT
 14323         END-IF
 14324         GO TO 3290-EDIT-LF-REIN-RATE
 14325     END-IF
 14326
 14327* DMD RATING TEST
 14328     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14329         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14330         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14331         MOVE ER-2687                 TO WS-ERROR
 14332         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14333         GO TO 3290-EDIT-LF-REIN-RATE.
 14334
 14335 3230-CLIENT-MORT-CD-SPECIALS.
 14336
 14337     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 14338     SET BIN-TO-GREG          TO TRUE.
 14339*    MOVE ' '                 TO DC-OPTION-CODE.
 14340     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14341     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 14342
 14343 C-POS-3230-MORT-CD.
 14344     IF PB-COMPANY-ID = 'POS' AND
 14345        PB-SV-CARRIER = '2'
 14346         NEXT SENTENCE
 14347     ELSE
 14348         GO TO C-POS-3240-MORT-CD.
 14349
 14350     IF PB-SV-GROUPING = '030'
 14351        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 14352         MOVE '2350' TO PB-I-MORT-CODE
 14353      ELSE
 14354         MOVE '3300' TO PB-I-MORT-CODE.
 14355
 14356
 14357 C-POS-3240-MORT-CD.
 14358     IF PB-COMPANY-ID = 'POS' AND
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 261
* EL050.cbl
 14359        PB-SV-CARRIER = '1'
 14360         NEXT SENTENCE
 14361     ELSE
 14362         GO TO 3230-CONTINUE.
 14363
 14364     IF PB-SV-STATE = '45' OR '47'
 14365        OR PB-CERT-EFF-DT LESS THAN WS-771001
 14366         MOVE '5200' TO PB-I-MORT-CODE
 14367     ELSE
 14368         MOVE '8300' TO PB-I-MORT-CODE.
 14369
 14370 3230-CONTINUE.
 14371
 14372     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 14373        GO TO 3240-CONTINUE
 14374     END-IF
 14375
 14376     IF PB-CERT-EFF-DT > WS-971231
 14377        GO TO 3240-CONTINUE
 14378     END-IF
 14379
 14380     IF LF-BENEFIT-FOUND AND
 14381        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 14382         MOVE 'F250'       TO PB-I-MORT-CODE
 14383     ELSE
 14384         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 14385             MOVE '7250'   TO PB-I-MORT-CODE
 14386         ELSE
 14387             MOVE '4251'   TO PB-I-MORT-CODE
 14388         END-IF
 14389     END-IF
 14390
 14391     .
 14392 3240-CONTINUE.
 14393
 14394     IF PB-COMPANY-ID NOT = 'GNL'
 14395         GO TO 3256-CONTINUE.
 14396
 14397     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 14398         MOVE 'A300' TO PB-I-MORT-CODE
 14399     ELSE
 14400         MOVE '8350' TO PB-I-MORT-CODE.
 14401
 14402 3256-CONTINUE.
 14403     IF PB-COMPANY-ID NOT = 'ABL'
 14404         GO TO 3260-EDIT-CONTINUE.
 14405
 14406     IF PB-I-LF-TERM GREATER THAN 59
 14407         MOVE 'F550' TO PB-I-MORT-CODE
 14408     ELSE
 14409         MOVE 'E550' TO PB-I-MORT-CODE.
 14410
 14411 3260-EDIT-CONTINUE.
 14412     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 14413
 14414 3290-EDIT-LF-REIN-RATE.
 14415     IF LF-REIN-NSP-NOT-USED
 14416         GO TO 3290-RATING-CONT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 262
* EL050.cbl
 14417
 14418     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14419        GO TO 3290-RATING-CONT.
 14420     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 14421     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14422     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 14423     MOVE '3'                   TO CP-PROCESS-TYPE.
 14424     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14425
 14426******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 14427     IF PB-COMPANY-ID EQUAL 'CDL'
 14428         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14429            CP-EARN-AS-NET-PAY)
 14430             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 14431*            MOVE SPACE          TO DC-OPTION-CODE
 14432             SET BIN-TO-GREG     TO TRUE
 14433             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14434***  Y2K PROJ 7744
 14435             IF DC-GREG-DATE-CYMD GREATER 19931231
 14436                 MOVE '1'        TO CP-EARNING-METHOD.
 14437***  Y2K PROJ 7744
 14438*******
 14439
 14440     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14441     MOVE PB-SV-STATE           TO CP-STATE.
 14442     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 14443     MOVE ZERO                  TO CP-DEVIATION-CODE
 14444                                   CP-RATE-DEV-PCT.
 14445     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14446     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14447                                   CP-RATING-BENEFIT-AMT.
 14448
 14449************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14450     IF PB-COMPANY-ID EQUAL 'NCB'
 14451         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14452            CP-EARN-AS-NET-PAY
 14453             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14454                 PB-I-LF-PREMIUM-AMT.
 14455************
 14456
 14457     IF CP-STATE-STD-ABBRV = 'OR'
 14458         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14459                                         PB-I-LF-ALT-BENEFIT-AMT.
 14460     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 14461     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14462     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14463     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14464     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14465     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14466     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14467     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14468                                   CP-REMAINING-TERM
 14469                                   CP-LOAN-TERM.
 14470     IF CP-TRUNCATED-LIFE
 14471        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14472
 14473     IF CP-TERM-IS-DAYS
 14474         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 263
* EL050.cbl
 14475     ELSE
 14476         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14477
 14478     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14479        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14480     END-IF
 14481     IF PB-COMPANY-ID NOT = 'TIC'
 14482          MOVE ZERO          TO CP-CLASS-CODE.
 14483
 14484     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 14485
 14486     MOVE 'R'                   TO CP-RATE-FILE.
 14487     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14488
 14489     IF CP-ERROR-RATE-NOT-FOUND
 14490        IF PB-I-OB
 14491           MOVE ER-2625      TO WS-ERROR
 14492           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14493           GO TO 3299-EDIT-CONTINUE
 14494        ELSE
 14495           MOVE ER-2643      TO WS-ERROR
 14496           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14497           GO TO 3299-EDIT-CONTINUE.
 14498
 14499     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14500
 14501     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14502     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14503
 14504     IF PB-I-LF-REI-RATE = ZERO
 14505         MOVE ER-2643        TO WS-ERROR
 14506         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14507
 14508 3290-CHECK-ALT-REIN-RATE.
 14509
 14510     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14511        GO TO 3290-RATING-CONT.
 14512
 14513     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14514     MOVE '2'                    TO CP-EARNING-METHOD.
 14515     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14516     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14517     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14518     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14519                                     CP-RATING-BENEFIT-AMT.
 14520     IF CP-STATE-STD-ABBRV = 'OR'
 14521         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14522                                         PB-I-LF-ALT-BENEFIT-AMT.
 14523     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14524        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14525     END-IF
 14526     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14527     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14528     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14529                                    CP-REMAINING-TERM
 14530                                    CP-LOAN-TERM.
 14531     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14532        ADD +1                   TO CP-ORIGINAL-TERM
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 264
* EL050.cbl
 14533                                    CP-REMAINING-TERM
 14534                                    CP-LOAN-TERM.
 14535
 14536     MOVE 'R'                   TO CP-RATE-FILE.
 14537     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14538
 14539     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14540
 14541     IF PB-I-LF-ALT-REI-RATE = ZERO
 14542         MOVE ER-2643            TO WS-ERROR
 14543         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14544
 14545 3290-RATING-CONT.
 14546
 14547     IF PB-I-OB
 14548*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14549        GO TO 3300-CHECK-AH-RATES.
 14550
 14551 3299-EDIT-CONTINUE.
 14552
 14553     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14554         NEXT SENTENCE
 14555     ELSE
 14556         MOVE ER-2620           TO WS-ERROR
 14557         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14558
 14559 3300-CHECK-AH-RATES.
 14560     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14561         NEXT SENTENCE
 14562     ELSE
 14563         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14564
 14565     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14566        and (not pb-monthly-cert))
 14567                  or
 14568        ((CF-COMPANY-ID = 'DMD') AND
 14569                (NO-DMD-RATING))
 14570         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14571            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14572            CONTINUE
 14573         ELSE
 14574            MOVE ER-2687         TO WS-ERROR
 14575            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14576         END-IF
 14577         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14578         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14579     END-IF
 14580
 14581     IF PB-I-OB
 14582        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14583
 14584     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14585         MOVE ER-2687             TO WS-ERROR
 14586         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14587         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14588         GO TO 3999-END-EDIT.
 14589
 14590*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 265
* EL050.cbl
 14591     if pb-company-id = 'AHL'
 14592        go to 3300-skip-crit-per
 14593     end-if
 14594     if (pb-i-ah-crit-per not = zeros)
 14595        and (ws-ah-special-calc-cd not = 'C')
 14596        MOVE ER-1572             TO WS-ERROR
 14597        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14598        go to 3300-skip-crit-per
 14599     END-IF
 14600     if (pb-company-id = 'DCC' or 'VPP')
 14601        and (am-dcc-product-code not = spaces)
 14602        go to 3300-skip-crit-per
 14603     end-if
 14604     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14605        IF PB-I-AH-CRIT-PER = ZERO
 14606           move ws-ah-max-bens   to pb-i-ah-crit-per
 14607*          MOVE ER-2618       TO WS-ERROR
 14608*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14609*          GO TO 3999-END-EDIT
 14610        END-IF
 14611     END-IF
 14612     if (ws-ah-special-calc-cd = 'C')
 14613        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14614        MOVE ER-1576             TO WS-ERROR
 14615        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14616     end-if
 14617
 14618     .
 14619 3300-skip-crit-per.
 14620     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14621     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14622     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14623     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14624     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14625     MOVE PB-SV-STATE            TO CP-STATE.
 14626     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14627     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14628     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14629*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14630     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14631     MOVE '3'                    TO CP-PROCESS-TYPE.
 14632     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14633     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14634                                    CP-RATING-BENEFIT-AMT.
 14635     IF PB-COMPANY-ID = 'CID'
 14636               OR
 14637        CP-STATE-STD-ABBRV = 'OR'
 14638         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14639                                         PB-I-AH-TERM.
 14640     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14641        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14642           AND (PB-I-POLICY-IS-MONTHLY)
 14643           MOVE PB-I-LF-BENEFIT-AMT
 14644                                 TO CP-NET-BENEFIT-AMT
 14645           move pb-i-ah-premium-amt to cp-original-premium
 14646           add pb-i-lf-premium-amt to cp-original-premium
 14647        END-IF
 14648     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 266
* EL050.cbl
 14649     MOVE SPACES                 TO CP-BEN-CATEGORY
 14650     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14651        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14652        EVALUATE TRUE
 14653           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14654              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14655              MOVE PB-I-LF-BENEFIT-AMT
 14656                                 TO CP-RATING-BENEFIT-AMT
 14657              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14658           WHEN WS-AH-BEN-CATEGORY = 'G'
 14659              MOVE PB-I-UNPAID-CASH-PRICE
 14660                                 TO CP-RATING-BENEFIT-AMT
 14661           WHEN WS-AH-BEN-CATEGORY = 'D'
 14662              MOVE WS-AH-PMF-COMM
 14663                                 TO CP-DCC-PMF-COMM
 14664              MOVE PB-I-AH-COMMISSION
 14665                                 TO CP-DCC-ACT-COMM
 14666        END-EVALUATE
 14667     END-IF
 14668     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14669     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14670     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14671     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14672     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14673     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14674     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14675                                    CP-REMAINING-TERM
 14676                                    WS-WORK-TERM.
 14677     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14678
 14679     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14680     SET BIN-TO-GREG             TO TRUE.
 14681*    MOVE ' '                    TO DC-OPTION-CODE.
 14682     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14683     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE
 14684
 14685     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14686     IF NOT VALID-SKIP-CODE
 14687         MOVE ER-2683            TO WS-ERROR
 14688         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14689         GO TO 3320-RATE-CONTINUE.
 14690
 14691     IF PB-NO-MONTHS-SKIPPED
 14692         GO TO 3320-RATE-CONTINUE.
 14693
 14694     MOVE SPACE TO NUMBER-OF-MONTHS.
 14695
 14696     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14697         MOVE 'S'                TO SK-MO (6).
 14698     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14699         MOVE 'S'                TO SK-MO (7).
 14700     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14701         MOVE 'S'                TO SK-MO (8).
 14702     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14703         MOVE 'S'                TO SK-MO (9).
 14704     IF PB-I-SKIP-CODE = 'A'
 14705         MOVE 'S'                TO SK-MO (10).
 14706
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 267
* EL050.cbl
 14707     MOVE 1                      TO SUB2.
 14708     MOVE PB-I-AH-TERM           TO SUB3.
 14709     MOVE WS-MONTH               TO SUB1.
 14710     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14711     GO TO 3320-RATE-CONTINUE.
 14712
 14713 3310-GET-SKIP-MO.
 14714     IF SUB1 = 13
 14715         MOVE 1                  TO SUB1.
 14716
 14717     IF SK-MO (SUB1) = 'S'
 14718         SUBTRACT 1 FROM WS-WORK-TERM.
 14719
 14720     ADD 1 TO SUB2
 14721              SUB1.
 14722
 14723 3320-RATE-CONTINUE.
 14724
 14725     IF WS-WORK-TERM = ZERO
 14726         MOVE 1                  TO WS-WORK-TERM.
 14727
 14728     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14729                                    CP-LOAN-TERM.
 14730
 14731     IF PB-COMPANY-ID EQUAL 'DMD'
 14732         NEXT SENTENCE
 14733     ELSE
 14734         MOVE ZERO               TO PB-I-AH-RATE
 14735                                    PB-I-AH-REI-RATE.
 14736
 14737
 14738     IF PB-COMPANY-ID EQUAL 'CRI'
 14739        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14740
 14741     IF PB-COMPANY-ID = 'CSL'
 14742         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14743         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14744         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14745         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14746
 14747     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14748        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14749           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14750              PB-I-RATE-DEV-PCT-LF
 14751        END-IF
 14752        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14753                                 TO CP-ALTERNATE-BENEFIT
 14754        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14755        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14756        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14757     END-IF
 14758*    if ws-clp-state not = spaces
 14759*       move ws-clp-state to cp-state
 14760*    end-if
 14761     IF (PB-COMPANY-ID = 'CID')
 14762        AND (WS-LF-EARNINGS-CALC = 'B')
 14763        AND (CP-STATE-STD-ABBRV = 'MN')
 14764        MOVE 'Y'                 TO CP-AH-BALLOON-SW
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 268
* EL050.cbl
 14765     ELSE
 14766        MOVE ' '                 TO CP-AH-BALLOON-SW
 14767     END-IF
 14768     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14769     MOVE 'R'                   TO CP-RATE-FILE.
 14770     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14771
 14772     IF (CP-ERROR-RATE-NOT-FOUND)
 14773        and (not pb-monthly-cert)
 14774        IF PB-I-OB
 14775           MOVE ER-2624          TO WS-ERROR
 14776           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14777           GO TO 3340-CALCULATE-PREMIUM-AMT
 14778        ELSE
 14779          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14780              NEXT SENTENCE
 14781          ELSE
 14782           MOVE ER-2642          TO WS-ERROR
 14783           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14784           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14785
 14786     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14787        CP-ERROR-DIV-BY-ZERO
 14788           MOVE ER-3782          TO WS-ERROR
 14789           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14790
 14791     IF PB-COMPANY-ID EQUAL 'CRI'
 14792        IF CP-ERROR-NO-LIMITS-CRI
 14793           IF NOT ACCOUNT-AH-CHECKED
 14794              MOVE ER-2607          TO WS-ERROR
 14795              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14796
 14797     IF ACCOUNT-AH-CHECKED
 14798        NEXT SENTENCE
 14799     ELSE
 14800       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14801          MOVE ER-2640           TO WS-ERROR
 14802          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14803
 14804     IF PB-COMPANY-ID = 'CRI'
 14805         IF WS-ERROR = ER-2640
 14806             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14807     IF ACCOUNT-AH-CHECKED
 14808        CONTINUE
 14809     ELSE
 14810        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14811           AND (CP-R-MAX-ATT-AGE > +0)
 14812           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14813           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14814              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14815              MOVE PB-I-AH-EXPIRE-DT
 14816                                 TO DC-BIN-DATE-2
 14817              MOVE '1'           TO DC-OPTION-CODE
 14818              PERFORM 8500-DATE-CONVERT
 14819                                 THRU 8500-EXIT
 14820              IF NO-CONVERSION-ERROR
 14821                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14822                    MOVE ER-2661       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 269
* EL050.cbl
 14823*                   PERFORM 9900-ERROR-FORMAT
 14824*                                THRU 9900-EXIT
 14825                 END-IF
 14826              END-IF
 14827           ELSE
 14828              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14829              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14830                 MOVE ER-2661    TO WS-ERROR
 14831*                PERFORM 9900-ERROR-FORMAT
 14832*                                THRU 9900-EXIT
 14833              ELSE
 14834                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14835                    MOVE ER-1570 TO WS-ERROR
 14836                    PERFORM 9900-ERROR-FORMAT
 14837                                 THRU 9900-EXIT
 14838                 END-IF
 14839              END-IF
 14840           END-IF
 14841           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14842              MOVE PB-I-JOINT-BIRTHDAY
 14843                                    TO DC-BIN-DATE-1
 14844              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14845              MOVE '1'              TO DC-OPTION-CODE
 14846              PERFORM 8500-DATE-CONVERT
 14847                                    THRU 8500-EXIT
 14848              IF NO-CONVERSION-ERROR
 14849                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14850                    MOVE ER-2661       TO WS-ERROR
 14851*                   PERFORM 9900-ERROR-FORMAT
 14852*                                   THRU 9900-EXIT
 14853                 END-IF
 14854              END-IF
 14855           ELSE
 14856              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14857                (PB-I-AH-TERM / 12)
 14858              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14859                 MOVE ER-2661       TO WS-ERROR
 14860*                PERFORM 9900-ERROR-FORMAT
 14861*                                   THRU 9900-EXIT
 14862              ELSE
 14863                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14864                    MOVE ER-1571 TO WS-ERROR
 14865                    PERFORM 9900-ERROR-FORMAT
 14866                                 THRU 9900-EXIT
 14867                 END-IF
 14868              END-IF
 14869           END-IF
 14870           IF WS-ERROR = ER-2661
 14871              PERFORM 9900-ERROR-FORMAT
 14872                                    THRU 9900-EXIT
 14873           END-IF
 14874        END-IF
 14875     END-IF
 14876*    IF ACCOUNT-AH-CHECKED
 14877*       NEXT SENTENCE
 14878*    ELSE
 14879*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14880*          MOVE ER-2661          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 270
* EL050.cbl
 14881*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14882
 14883     IF ACCOUNT-AH-CHECKED
 14884        NEXT SENTENCE
 14885     ELSE
 14886        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14887           MOVE ER-2663          TO WS-ERROR
 14888           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14889
 14890     IF ACCOUNT-AH-CHECKED OR
 14891        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14892         PB-POLICY-IS-VOIDED
 14893        NEXT SENTENCE
 14894     ELSE
 14895        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14896           MOVE ER-2667            TO WS-ERROR
 14897           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14898
 14899     IF PB-COMPANY-ID = 'CRI'
 14900         IF WS-ERROR = ER-2667
 14901             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14902
 14903     IF ACCOUNT-AH-CHECKED
 14904        NEXT SENTENCE
 14905     ELSE
 14906        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14907           MOVE ER-2678            TO WS-ERROR
 14908           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14909
 14910     IF CP-ERROR-RATE-FILE-NOTOPEN
 14911         GO TO 3990-FILES-NOT-OPEN.
 14912
 14913 3321-CONTINUE.
 14914     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14915     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14916     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14917*    IF (PB-COMPANY-ID = 'DCC')
 14918        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14919        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14920                                    PB-I-LF-ALT-PREM-CALC
 14921        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14922        IF WS-AH-BEN-CATEGORY = 'G'
 14923           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14924           + PB-I-ADDL-CLP)
 14925           * (1 + WS-TOL-CLP-PCT)
 14926*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14927        ELSE
 14928           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14929           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14930*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14931        END-IF
 14932        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14933                                 TO PB-I-AH-PREM-CALC
 14934        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14935           MOVE ER-8152          TO WS-ERROR
 14936           PERFORM 9900-ERROR-FORMAT
 14937                                 THRU 9900-EXIT
 14938        ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 271
* EL050.cbl
 14939           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14940                 PB-I-ADDL-CLP)
 14941              MOVE ER-8148       TO WS-ERROR
 14942              PERFORM 9900-ERROR-FORMAT
 14943                                 THRU 9900-EXIT
 14944           END-IF
 14945        END-IF
 14946     END-IF
 14947     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14948        AND (PB-I-POLICY-IS-MONTHLY)
 14949        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14950        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14951        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14952           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14953        END-IF
 14954     END-IF
 14955     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14956        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14957        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14958        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14959        MOVE ER-2786             TO WS-ERROR
 14960        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14961     END-IF
 14962     MOVE +0                     TO PB-I-AH-CLP
 14963     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14964        evaluate true
 14965           when WS-AH-BEN-CATEGORY = 'D'
 14966              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14967                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14968           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14969              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14970           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14971              compute ws-cred-union-fees rounded =
 14972                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14973                    pb-i-ah-commission)
 14974              COMPUTE PB-I-AH-CLP =
 14975                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14976        end-evaluate
 14977     END-IF
 14978     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14979
 14980     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14981         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14982
 14983     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14984         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14985
 14986     if (ws-ah-special-calc-cd = 'E')
 14987        and (pb-monthly-cert)
 14988        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14989     end-if
 14990     IF PB-COMPANY-ID = 'CRI'
 14991         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14992            PB-I-PAYMENT-AMOUNT = ZERO
 14993             NEXT SENTENCE
 14994         ELSE
 14995             COMPUTE PB-I-AH-PREM-CALC =
 14996                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 272
* EL050.cbl
 14997                 (CP-PREMIUM-RATE / 100)
 14998             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14999                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 15000                                             PB-I-RATE-DEV-PCT-AH.
 15001
 15002     IF (PB-I-AH-RATE  = ZERO)
 15003        and (not pb-monthly-cert)
 15004       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 15005           NEXT SENTENCE
 15006       ELSE
 15007         MOVE ER-2642            TO WS-ERROR
 15008         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15009
 15010     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 15011     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 15012     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 15013     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 15014     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 15015     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 15016
 15017     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15018        AND (WS-AH-BEN-CATEGORY = 'G')
 15019        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15020        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 15021        IF CP-DEVIATION-CODE NOT = '000'
 15022           MOVE '000'            TO CP-DEVIATION-CODE
 15023           PERFORM 7000-GET-RATE THRU 7000-EXIT
 15024           IF NO-CP-ERROR
 15025              COMPUTE PB-I-DDF-IU-RATE-UP =
 15026              PB-I-AH-CLP - CP-CALC-PREMIUM
 15027           ELSE
 15028              MOVE ER-3057        TO WS-ERROR
 15029              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15030           END-IF
 15031        END-IF
 15032     END-IF
 15033     .
 15034 3335-EDIT-AH-REIN-NSP-RATE.
 15035     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15036        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 15037              compute ws-cred-union-fees rounded =
 15038                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 15039                    pb-i-ah-commission)
 15040              COMPUTE PB-I-AH-CLP =
 15041                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 15042        end-if
 15043     END-IF
 15044     IF AH-REIN-NSP-NOT-USED
 15045         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15046
 15047     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 15048     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15049         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15050     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 15051     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 15052     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 15053     MOVE PB-SV-STATE            TO CP-STATE.
 15054     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 273
* EL050.cbl
 15055     MOVE ZERO                   TO CP-DEVIATION-CODE
 15056                                    CP-RATE-DEV-PCT.
 15057*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 15058     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15059     MOVE '3'                    TO CP-PROCESS-TYPE.
 15060     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 15061     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15062                                    CP-RATING-BENEFIT-AMT.
 15063     IF CP-STATE-STD-ABBRV = 'OR'
 15064         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 15065                                         PB-I-AH-TERM.
 15066     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 15067     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15068     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15069     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15070     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15071     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 15072                                    CP-REMAINING-TERM
 15073                                    WS-WORK-TERM.
 15074     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 15075     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15076        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15077     END-IF
 15078     IF  PB-COMPANY-ID = 'TIC'
 15079         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 15080            MOVE ZERO TO CP-CLASS-CODE.
 15081
 15082     IF PB-COMPANY-ID NOT = 'TIC'
 15083          MOVE ZERO          TO CP-CLASS-CODE.
 15084
 15085     MOVE ZERO               TO CP-DEVIATION-CODE.
 15086
 15087     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 15088
 15089     MOVE ZERO               TO PB-I-AH-REI-RATE.
 15090
 15091     MOVE 'R'                   TO CP-RATE-FILE.
 15092     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 15093
 15094     IF CP-ERROR-RATE-NOT-FOUND
 15095         MOVE ER-2645        TO WS-ERROR
 15096         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15097         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15098
 15099     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 15100
 15101     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 15102     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 15103
 15104     IF PB-I-AH-REI-RATE = ZERO
 15105         MOVE ER-2645        TO WS-ERROR
 15106         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15107
 15108
 15109 3340-CALCULATE-PREMIUM-AMT.
 15110     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15111     SET BIN-TO-GREG             TO TRUE
 15112     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 274
* EL050.cbl
 15113     move dc-greg-date-a-edit    to ws-greg-eff-date
 15114
 15115     IF PB-COMPANY-ID = 'NCL'
 15116         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 15117             WS-AH-SPECIAL-CALC-CD = 'O')
 15118             GO TO 3999-END-EDIT.
 15119
 15120     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 15121                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 15122                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 15123                         OR 'AHL'
 15124         NEXT SENTENCE
 15125     ELSE
 15126         IF WS-STATE-ABBREVIATION = 'CT'
 15127             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 15128                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 15129                 COMPUTE PB-I-LF-PREM-CALC =
 15130                                     PB-I-LF-PREM-CALC * .90
 15131                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 15132                                     PB-I-LF-ALT-PREM-CALC * .90
 15133                 COMPUTE PB-I-AH-PREM-CALC =
 15134                                     PB-I-AH-PREM-CALC * .90.
 15135
 15136     IF PB-COMP-LF-PREM
 15137        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 15138        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 15139
 15140     IF PB-COMP-AH-PREM
 15141        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 15142
 15143 3340-CHECK-DCC-TOT-FEES.
 15144     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15145        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15146        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 15147        AND (PB-I-POLICY-IS-MONTHLY)
 15148        CONTINUE
 15149     ELSE
 15150        GO TO 3340-EDIT-LF-AH-TOL
 15151     END-IF
 15152     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 15153     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 15154     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15155        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15156           PB-I-RATE-DEV-PCT-LF
 15157     END-IF
 15158     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 15159        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 15160           PB-I-RATE-DEV-PCT-AH
 15161     END-IF
 15162     MOVE 'N'                    TO CP-BEN-CATEGORY
 15163     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15164
 15165     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 15166     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 15167     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 15168     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15169     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15170     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 275
* EL050.cbl
 15171     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15172     MOVE '3'                    TO CP-PROCESS-TYPE.
 15173     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15174     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 15175
 15176     MOVE PB-SV-STATE            TO CP-STATE.
 15177     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15178     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 15179     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 15180     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 15181     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15182                                    CP-RATING-BENEFIT-AMT.
 15183     IF CP-STATE-STD-ABBRV = 'OR'
 15184         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 15185                                         PB-I-LF-ALT-BENEFIT-AMT.
 15186     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 15187     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 15188     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 15189     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15190     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15191     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15192     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15193     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 15194     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 15195                                    CP-REMAINING-TERM
 15196                                    CP-LOAN-TERM.
 15197     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 15198        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 15199           PB-I-LF-PREMIUM-AMT
 15200     end-if
 15201
 15202     IF CP-TRUNCATED-LIFE
 15203        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 15204
 15205     IF CP-TERM-IS-DAYS
 15206         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 15207     ELSE
 15208         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15209
 15210     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15211     IF CP-SPECIAL-CALC-CD = 'H'
 15212         MOVE PB-I-LF-ALT-BENEFIT-AMT
 15213                                    TO CP-ALTERNATE-BENEFIT
 15214         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 15215     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 15216     MOVE 'R'                    TO CP-RATE-FILE
 15217     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 15218     IF NOT CP-ERROR-RATE-NOT-FOUND
 15219        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 15220        IF (CP-DCC-LF-RATE NOT = ZEROS)
 15221           AND (CP-BENEFIT-CD (1:1) = 'S')
 15222           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 15223                                    PB-I-LF-PREMIUM-AMT
 15224        END-IF
 15225     ELSE
 15226        MOVE +0                  TO PB-I-TOT-FEES-CALC
 15227     END-IF
 15228     .
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 276
* EL050.cbl
 15229 3340-EDIT-LF-AH-TOL.
 15230
 15231***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 15232***    UNSIGN-WRK2    =    AH   DIFFERENCE
 15233***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 15234***
 15235     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 15236         PB-I-AH-PREMIUM-AMT
 15237          GIVING WS-CALC-WORK.
 15238
 15239     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 15240        AND WS-CALC-WORK NOT = ZERO
 15241         MOVE ER-2649            TO WS-ERROR
 15242         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15243
 15244     SUBTRACT PB-I-LF-PREM-CALC
 15245             FROM PB-I-LF-PREMIUM-AMT
 15246                 GIVING WS-UNSIGN-WRK1.
 15247
 15248     SUBTRACT PB-I-LF-ALT-PREM-CALC
 15249             FROM PB-I-LF-ALT-PREMIUM-AMT
 15250                 GIVING WS-UNSIGN-WRK4.
 15251
 15252     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 15253                                + WS-UNSIGN-WRK4.
 15254
 15255     SUBTRACT PB-I-AH-PREM-CALC
 15256             FROM PB-I-AH-PREMIUM-AMT
 15257                 GIVING WS-UNSIGN-WRK2.
 15258
 15259******************************************************************
 15260*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 15261******************************************************************
 15262
 15263     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15264         MOVE ZERO TO WS-UNSIGN-WRK1.
 15265
 15266     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15267         MOVE ZERO TO WS-UNSIGN-WRK2.
 15268
 15269     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 15270             GIVING WS-UNSIGN-WRK3.
 15271
 15272 3342-CONTINUE.
 15273
 15274     IF (PB-I-LF-RATE = ZERO  AND
 15275         PB-I-AH-RATE = ZERO)
 15276         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 15277            WS-AH-SPECIAL-CALC-CD = 'O'
 15278              NEXT SENTENCE
 15279         ELSE
 15280             GO TO 3345-EDIT-CONTINUE.
 15281
 15282     IF  PB-RECORD-BILL   =  'B' OR  'L'
 15283         NEXT SENTENCE
 15284     ELSE
 15285     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 15286        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 277
* EL050.cbl
 15287           IF (PB-REISSUED-CERT         OR
 15288               PB-POLICY-IS-DECLINED    OR
 15289               PB-POLICY-IS-VOIDED)
 15290              NEXT SENTENCE
 15291           ELSE
 15292              IF WS-PREM-REJECT-SW = SPACE
 15293                 MOVE ER-2652    TO WS-ERROR
 15294                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15295                 GO TO 3344-CHECK-AH
 15296              ELSE
 15297                 MOVE ER-2650    TO WS-ERROR
 15298                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15299                 GO TO 3344-CHECK-AH.
 15300
 15301***
 15302***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 15303***
 15304
 15305     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 15306         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 15307            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15308             (1 + WS-TOL-LF-PREM-PCT)
 15309         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 15310            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15311             (1 - WS-TOL-LF-PREM-PCT)
 15312     ELSE
 15313         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 15314         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 15315
 15316***
 15317***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 15318***
 15319
 15320     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 15321         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 15322          WS-TOL-LF-PREM.
 15323
 15324     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 15325         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 15326          WS-TOL-LF-PREM.
 15327
 15328     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15329        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 15330
 15331     IF PB-REISSUED-CERT
 15332        or PB-POLICY-IS-DECLINED
 15333        or PB-POLICY-IS-VOIDED
 15334        continue
 15335     ELSE
 15336        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15337              > WS-TOL-LF-HIGH-PREM-AMT)
 15338           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15339              < WS-TOL-LF-LOW-PREM-AMT))
 15340                      or
 15341           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15342              > WS-TOL-LF-HIGH-PREM-PCT)
 15343           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15344              < WS-TOL-LF-LOW-PREM-PCT))
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 278
* EL050.cbl
 15345           IF WS-PREM-REJECT-SW = SPACE
 15346              MOVE ER-2652       TO WS-ERROR
 15347              PERFORM 9900-ERROR-FORMAT
 15348                                 THRU 9900-EXIT
 15349           ELSE
 15350              MOVE ER-2650       TO WS-ERROR
 15351              PERFORM 9900-ERROR-FORMAT
 15352                                 THRU 9900-EXIT
 15353           end-if
 15354        end-if
 15355     end-if
 15356
 15357*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 15358*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 15359*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15360*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15361
 15362     IF WS-ERROR  =  ER-2650  OR  ER-2652
 15363        IF (PB-RECORD-BILL   =  'B' OR  'L')
 15364                      OR
 15365           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 15366           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 15367           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15368           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 15369        END-IF
 15370     END-IF
 15371
 15372     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15373        IF WS-COMP-MAX-CAP GREATER THAN +0
 15374           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 15375              IF (PB-REISSUED-CERT         OR
 15376                  PB-POLICY-IS-DECLINED    OR
 15377                  PB-POLICY-IS-VOIDED)
 15378                 NEXT SENTENCE
 15379              ELSE
 15380                  MOVE ER-2646   TO  WS-ERROR
 15381                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15382
 15383 3344-CVL-TOLERANCE-CHECK.
 15384
 15385      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 15386          GO TO 3344-CHECK-AH.
 15387
 15388      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 15389          GO TO 3344-CHECK-AH.
 15390
 15391      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 15392                                     WS-UNSIGN-WRK6.
 15393
 15394      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15395          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 15396                                 + PB-I-LF-PREMIUM-AMT
 15397                                 - PB-I-LF-PREM-CALC.
 15398
 15399      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15400          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 15401                                 + PB-I-LF-ALT-PREMIUM-AMT
 15402                                 - PB-I-LF-ALT-PREM-CALC.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 279
* EL050.cbl
 15403
 15404      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 15405          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 15406              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15407                 MOVE ER-2652    TO  WS-ERROR
 15408                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15409              ELSE
 15410                 MOVE ER-2650    TO  WS-ERROR
 15411                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15412
 15413      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 15414          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 15415              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15416                 MOVE ER-2652    TO  WS-ERROR
 15417                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15418              ELSE
 15419                 MOVE ER-2650    TO  WS-ERROR
 15420                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15421
 15422 3344-CHECK-AH.
 15423
 15424****************************************************************
 15425***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 15426***
 15427
 15428     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 15429         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 15430             (1 + WS-TOL-AH-PREM-PCT)
 15431         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 15432             (1 - WS-TOL-AH-PREM-PCT)
 15433     ELSE
 15434         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 15435         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 15436
 15437***
 15438***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 15439***
 15440
 15441     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 15442         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 15443
 15444     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 15445         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 15446
 15447     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15448        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15449
 15450     IF (PB-REISSUED-CERT)
 15451        OR (PB-POLICY-IS-DECLINED)
 15452        OR (PB-POLICY-IS-VOIDED)
 15453        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15454        CONTINUE
 15455     ELSE
 15456        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 15457              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15458                          or
 15459           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15460              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 280
* EL050.cbl
 15461           IF WS-PREM-REJECT-SW = SPACE
 15462              MOVE ER-3052       TO WS-ERROR
 15463              PERFORM 9900-ERROR-FORMAT
 15464                                 THRU 9900-EXIT
 15465           ELSE
 15466              MOVE ER-3050       TO WS-ERROR
 15467              PERFORM 9900-ERROR-FORMAT
 15468                                 THRU 9900-EXIT
 15469           END-IF
 15470        END-IF
 15471     END-IF
 15472     if (pb-company-id = 'DCC' or 'VPP')
 15473        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15474        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15475        and (pb-i-policy-is-monthly)
 15476        compute ws-tol-ah-high-prem-amt =
 15477           pb-i-tot-fees-calc + ws-tol-ah-prem
 15478        compute ws-tol-ah-low-prem-amt =
 15479           pb-i-tot-fees-calc - ws-tol-ah-prem
 15480        if ws-tol-ah-prem-pct > zeros
 15481           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15482              (1 + ws-tol-ah-prem-pct)
 15483           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15484              (1 - ws-tol-ah-prem-pct)
 15485        else
 15486           move +9999999.99      to ws-tol-ah-high-prem-pct
 15487           move +0               to ws-tol-ah-low-prem-pct
 15488        end-if
 15489        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15490            or
 15491           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15492                          or
 15493           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15494           or
 15495           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15496            move er-3049         to ws-error
 15497           perform 9900-error-format
 15498                                 thru 9900-exit
 15499
 15500        end-if
 15501     end-if
 15502     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15503         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15504             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15505             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15506
 15507     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15508        IF WS-COMP-MAX-CAP GREATER THAN +0
 15509           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15510              IF (PB-REISSUED-CERT         OR
 15511                  PB-POLICY-IS-DECLINED    OR
 15512                  PB-POLICY-IS-VOIDED)
 15513                 NEXT SENTENCE
 15514              ELSE
 15515                  MOVE ER-2646   TO  WS-ERROR
 15516                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15517
 15518     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 281
* EL050.cbl
 15519        (WS-COMP-MAX-CAP EQUAL +0)
 15520           GO TO 3345-EDIT-CONTINUE.
 15521
 15522     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15523        GREATER THAN WS-COMP-MAX-CAP
 15524           MOVE ER-2646          TO  WS-ERROR
 15525           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15526
 15527 3345-EDIT-CONTINUE.
 15528
 15529*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15530*       IF PB-ENTRY-BATCH   NUMERIC
 15531*          IF PB-ISSUE
 15532*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15533*          ELSE
 15534*              IF PB-CANCELLATION
 15535*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15536
 15537*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15538*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15539*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15540*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15541*        ELSE
 15542*            MOVE  ER-1909            TO  WS-ERROR
 15543*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15544
 15545     IF PB-I-POLICY-ACCEPTED
 15546        IF PB-POLICY-IS-DECLINED  OR
 15547           PB-REISSUED-CERT  OR
 15548           PB-REIN-ONLY-CERT  OR
 15549           PB-POLICY-IS-VOIDED
 15550            MOVE  ER-1891         TO  WS-ERROR
 15551            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15552        ELSE
 15553            MOVE SPACE            TO  PB-BATCH-ENTRY
 15554            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15555
 15556     IF PB-I-POLICY-DECLINED
 15557        IF PB-REISSUED-CERT  OR
 15558           PB-REIN-ONLY-CERT  OR
 15559           PB-POLICY-IS-VOIDED
 15560            MOVE  ER-1906         TO  WS-ERROR
 15561            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15562        ELSE
 15563            MOVE  'D'             TO  PB-BATCH-ENTRY
 15564                                      PB-I-ENTRY-STATUS.
 15565
 15566     IF PB-I-NEEDS-UNDERWRITING
 15567        IF PB-POLICY-IS-DECLINED OR
 15568           PB-REISSUED-CERT  OR
 15569           PB-REIN-ONLY-CERT  OR
 15570           PB-POLICY-IS-VOIDED
 15571            MOVE  ER-1907         TO  WS-ERROR
 15572            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15573        ELSE
 15574            MOVE 'U'              TO  PB-BATCH-ENTRY
 15575                                      PB-I-ENTRY-STATUS.
 15576
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 282
* EL050.cbl
 15577     IF PB-NEEDS-UNDERWRITING
 15578        MOVE  ER-1901             TO  WS-ERROR
 15579        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15580     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15581        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15582        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15583        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15584           AND (NOT WS-LF-CASH))
 15585                           OR
 15586           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15587           AND (NOT WS-AH-CASH)))
 15588                       AND
 15589           (PB-I-ENTRY-STATUS NOT = '5')
 15590           MOVE 'M'              TO PB-BATCH-ENTRY
 15591                                    PB-I-ENTRY-STATUS
 15592        END-IF
 15593     END-IF
 15594     move pending-business       to ws-passed-erpndb
 15595     move ' '                    to ws-exceed-limit-yn
 15596     perform 7780-call-agg       thru 7780-exit
 15597*    display ' el050 exceed ' ws-exceed-limit-yn
 15598     if ws-exceed-limit-yn = 'Y'
 15599        MOVE  ER-9813            TO WS-ERROR
 15600        move 'Y'                 to ws-9813-sw
 15601        PERFORM  9900-ERROR-FORMAT
 15602                                 THRU 9900-EXIT
 15603     end-if
 15604     if (PB-EXCEEDED-LIMIT-FORCED)
 15605        and (ws-9813-sw = 'Y')
 15606        subtract +1 from PB-NO-OF-ERRORS
 15607        move er-9823             to ws-error
 15608        PERFORM  9900-ERROR-FORMAT
 15609                                 THRU 9900-EXIT
 15610     end-if
 15611     IF  PB-COMPANY-ID NOT = 'NCL'
 15612         GO TO 3999-END-EDIT.
 15613
 15614     IF PB-REISSUED-CERT  OR
 15615        PB-POLICY-IS-DECLINED  OR
 15616        PB-POLICY-IS-VOIDED  OR
 15617        PB-I-OB
 15618         GO TO 3999-END-EDIT.
 15619
 15620     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15621         MOVE  ER-2644            TO  WS-ERROR
 15622         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15623         GO TO 3999-END-EDIT.
 15624
 15625     MOVE 'N'                     TO  FORM-MASTER-SW.
 15626     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15627
 15628     IF NOT FORM-MASTER-FOUND
 15629         GO TO 3999-END-EDIT.
 15630
 15631     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15632                                      FORM-MASTER-AH-SW.
 15633
 15634     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 283
* EL050.cbl
 15635         MOVE  +1                 TO SUB6
 15636         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15637
 15638     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15639         MOVE  +1                 TO SUB6
 15640         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15641
 15642     IF LF-FORM-MASTER-FOUND  OR
 15643        AH-FORM-MASTER-FOUND
 15644         GO TO 3360-CHECK-FORM-LIMITS
 15645     ELSE
 15646         GO TO 3999-END-EDIT.
 15647
 15648******************************************************************
 15649*                  3350-GET-ERFORM                               *
 15650*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15651*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15652******************************************************************
 15653
 15654 3350-GET-ERFORM.
 15655
 15656     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15657         GO TO  3350-ERFORM-GETMAIN.
 15658
 15659     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15660     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15661     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15662     MOVE 'Y'                     TO FORM-MASTER-SW.
 15663
 15664     IF PB-CANCELLATION
 15665         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15666            PB-SV-STATE          EQUAL   FO-STATE       AND
 15667            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15668              GO TO 3350-EXIT
 15669         ELSE
 15670             NEXT SENTENCE
 15671     ELSE
 15672         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15673            PB-SV-STATE          EQUAL   FO-STATE       AND
 15674            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15675              GO TO 3350-EXIT.
 15676
 15677 3350-ERFORM-GETMAIN.
 15678
 15679     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15680     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15681
 15682 3350-ERFORM-READ.
 15683
 15684     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15685     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15686     IF PB-CANCELLATION
 15687         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15688     ELSE
 15689         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15690     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15691
 15692     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 284
* EL050.cbl
 15693
 15694     IF FORM-MASTER-FOUND
 15695       IF PB-CANCELLATION
 15696          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15697             PB-SV-STATE          EQUAL   FO-STATE       AND
 15698             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15699              GO  TO 3350-EXIT
 15700          ELSE
 15701              NEXT SENTENCE
 15702       ELSE
 15703          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15704             PB-SV-STATE          EQUAL   FO-STATE       AND
 15705             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15706              GO  TO 3350-EXIT.
 15707
 15708     MOVE  'N'                    TO  FORM-MASTER-SW.
 15709     MOVE  ER-1895                TO  WS-ERROR.
 15710     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15711
 15712 3350-EXIT.
 15713      EXIT.
 15714
 15715******************************************************************
 15716*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15717*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15718*   VALID FOR THE POLICY FORM USED.                              *
 15719******************************************************************
 15720
 15721 3355-EDIT-FORM-LF-BENEFITS.
 15722
 15723     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15724        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15725         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15726         GO TO   3355-EXIT.
 15727
 15728     IF  SUB6    LESS THAN   +40
 15729         ADD  +1      TO  SUB6
 15730         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15731
 15732     MOVE  ER-1896         TO  WS-ERROR.
 15733     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15734
 15735 3355-EXIT.
 15736      EXIT.
 15737
 15738******************************************************************
 15739*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15740*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15741*   VALID FOR THE POLICY FORM USED.                              *
 15742******************************************************************
 15743
 15744 3356-EDIT-FORM-AH-BENEFITS.
 15745
 15746     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15747        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15748         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15749         GO TO  3356-EXIT.
 15750
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 285
* EL050.cbl
 15751      IF  SUB6    LESS THAN     +40
 15752          ADD  +1      TO  SUB6
 15753          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15754
 15755     MOVE  ER-1897         TO  WS-ERROR.
 15756     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15757
 15758 3356-EXIT.
 15759      EXIT.
 15760
 15761******************************************************************
 15762*                  3357-BENEFIT-SEARCH                           *
 15763*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15764*   CANCELLATIONS ONLY.                                          *
 15765******************************************************************
 15766 3357-BENEFIT-SEARCH.
 15767     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15768         MOVE +1                          TO SUB6
 15769         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15770
 15771     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15772         MOVE +1                          TO SUB6
 15773         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15774
 15775 3357-EXIT.
 15776     EXIT.
 15777
 15778******************************************************************
 15779*                  3358-BENEFIT-LIFE-SEARCH                      *
 15780*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15781*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15782*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15783******************************************************************
 15784 3358-BENEFIT-LIFE-SEARCH.
 15785     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15786       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15787         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15788           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15789              IF FO-PLAN-REFUND-METHOD (SUB6)
 15790                     IS GREATER THAN SPACES
 15791                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15792                                          WS-LF-REFUND-CALC
 15793                 GO TO 3358-EXIT.
 15794
 15795     IF SUB6 LESS THAN +40
 15796         ADD +1                 TO SUB6
 15797         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15798
 15799 3358-EXIT.
 15800     EXIT.
 15801******************************************************************
 15802*                  3359-BENEFIT-AH-SEARCH                        *
 15803*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15804*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15805*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15806******************************************************************
 15807 3359-BENEFIT-AH-SEARCH.
 15808     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 286
* EL050.cbl
 15809       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15810         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15811           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15812              IF FO-PLAN-REFUND-METHOD (SUB6)
 15813                      IS GREATER THAN SPACES
 15814                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15815                                          WS-AH-REFUND-CALC
 15816                 GO TO 3359-EXIT.
 15817
 15818     IF SUB6 LESS THAN +40
 15819         ADD +1                 TO SUB6
 15820         GO TO 3359-BENEFIT-AH-SEARCH.
 15821
 15822 3359-EXIT.
 15823     EXIT.
 15824
 15825******************************************************************
 15826*                  3360-CHECK-FORM-LIMITS                        *
 15827*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15828*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15829******************************************************************
 15830
 15831 3360-CHECK-FORM-LIMITS.
 15832
 15833     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15834         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15835
 15836     IF NOT LF-FORM-MASTER-FOUND
 15837         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15838
 15839 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15840
 15841     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15842       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15843        WS-LF-JOINT-INDICATOR = 'J'  AND
 15844        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15845         IF PB-COMPANY-ID = 'NCL'
 15846            MOVE  ER-1911          TO  WS-ERROR
 15847            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15848         ELSE
 15849            MOVE  ER-1892          TO  WS-ERROR
 15850            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15851
 15852 3360-CHECK-FORM-LF-ATT-AGE.
 15853
 15854     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15855
 15856     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15857         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15858         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15859            IF PB-COMPANY-ID = 'NCL'
 15860                MOVE  ER-1913      TO  WS-ERROR
 15861                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15862            ELSE
 15863                MOVE  ER-1894      TO  WS-ERROR
 15864                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15865
 15866 3360-CHECK-FORM-LF-MAX-ISS-AGE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 287
* EL050.cbl
 15867
 15868     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15869         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15870         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15871            IF PB-COMPANY-ID = 'NCL'
 15872                MOVE  ER-1914      TO  WS-ERROR
 15873                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15874            ELSE
 15875                MOVE  ER-1899      TO  WS-ERROR
 15876                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15877
 15878 3360-CHECK-FORM-LF-TERM-BAMT.
 15879
 15880     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15881         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15882         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15883           IF  PB-COMPANY-ID = 'NCL'
 15884               MOVE  ER-1916       TO  WS-ERROR
 15885               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15886           ELSE
 15887               MOVE  ER-1902       TO  WS-ERROR
 15888               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15889
 15890     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15891                                    PB-I-LF-ALT-BENEFIT-AMT.
 15892
 15893     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15894         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15895         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15896             IF  PB-COMPANY-ID = 'NCL'
 15897                 MOVE  ER-1918     TO  WS-ERROR
 15898                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15899             ELSE
 15900                 MOVE  ER-1904     TO  WS-ERROR
 15901                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15902
 15903******************************************************************
 15904*                  3360-CHECK-FORM-AH-LIMITS                     *
 15905*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15906*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15907******************************************************************
 15908
 15909 3360-CHECK-FORM-AH-LIMITS.
 15910
 15911     IF NOT AH-FORM-MASTER-FOUND
 15912         GO TO 3999-END-EDIT.
 15913
 15914 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15915
 15916     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15917       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15918        WS-AH-JOINT-INDICATOR = 'J'  AND
 15919        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15920         IF PB-COMPANY-ID = 'NCL'
 15921            MOVE  ER-1912          TO  WS-ERROR
 15922            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15923         ELSE
 15924            MOVE  ER-1893          TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 288
* EL050.cbl
 15925            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15926
 15927 3360-CHECK-FORM-AH-ATT-AGE.
 15928
 15929     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15930
 15931     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15932         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15933         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15934            IF PB-COMPANY-ID = 'NCL'
 15935                MOVE  ER-1913      TO  WS-ERROR
 15936                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15937            ELSE
 15938                MOVE  ER-1894      TO  WS-ERROR
 15939                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15940
 15941 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15942
 15943     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15944         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15945         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15946            IF PB-COMPANY-ID = 'NCL'
 15947                MOVE  ER-1915      TO  WS-ERROR
 15948                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15949            ELSE
 15950                MOVE  ER-1900      TO  WS-ERROR
 15951                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15952
 15953 3360-CHECK-FORM-AH-TERM-BAMT.
 15954
 15955     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15956         FO-AH-MAX-TERM    GREATER THAN  +0
 15957         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15958             IF  PB-COMPANY-ID = 'NCL'
 15959                 MOVE  ER-1917     TO  WS-ERROR
 15960                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15961             ELSE
 15962                  MOVE  ER-1903    TO  WS-ERROR
 15963                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15964
 15965     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15966         FO-MAX-AH-AMT    GREATER THAN  +0
 15967         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15968             IF  PB-COMPANY-ID = 'NCL'
 15969                 MOVE  ER-1919     TO  WS-ERROR
 15970                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15971             ELSE
 15972                 MOVE  ER-1905     TO  WS-ERROR
 15973                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15974
 15975     GO TO 3999-END-EDIT.
 15976
 15977******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 289
* EL050.cbl
 15979 3400-edit-vin.
 15980
 15981     move spaces                 to hldi-pass-area
 15982     MOVE PB-I-VIN               TO WS-WORK-VIN
 15983     MOVE +8                     TO V2
 15984     MOVE ZEROS                  TO WS-VIN-TOTAL
 15985     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15986      (V1 > 17)
 15987        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15988           MOVE ER-3825          TO WS-ERROR
 15989           PERFORM 9900-ERROR-FORMAT
 15990                                 THRU 9900-EXIT
 15991        ELSE
 15992           IF V1 = 8
 15993              MOVE 10            TO V2
 15994           END-IF
 15995           IF V1 = 9
 15996              MOVE 0             TO V2
 15997           END-IF
 15998           IF V1 = 10
 15999              MOVE 9             TO V2
 16000           END-IF
 16001           IF WS-WORK-VIN (V1:1) NUMERIC
 16002              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 16003               + (WS-WORK-VIN-N (V1) * V2)
 16004           ELSE
 16005              MOVE WS-WORK-VIN (V1:1)
 16006                            TO WS-HEX-BYTE
 16007              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 16008              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 16009               + (WS-NUM (V3) * V2)
 16010           END-IF
 16011           COMPUTE V2 = V2 - 1
 16012        END-IF
 16013     END-PERFORM
 16014     MOVE ZEROS                  TO WS-VIN-REMAINDER
 16015     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 16016        REMAINDER WS-VIN-REMAINDER
 16017     IF ((WS-WORK-VIN (9:1) = 'X')
 16018        AND (WS-VIN-REMAINDER = 10))
 16019                OR
 16020        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 16021        if pb-company-id = 'VPP'
 16022           perform 3410-check-with-hldi
 16023                                 thru 3410-exit
 16024        end-if
 16025     ELSE
 16026        IF WS-WORK-VIN (1:1) > 0 AND < 6
 16027           MOVE ER-3826          TO WS-ERROR
 16028           PERFORM 9900-ERROR-FORMAT
 16029                                 THRU 9900-EXIT
 16030        ELSE
 16031           MOVE ER-3827          TO WS-ERROR
 16032           PERFORM 9900-ERROR-FORMAT
 16033                                 THRU 9900-EXIT
 16034        END-IF
 16035     END-IF
 16036
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 290
* EL050.cbl
 16037     .
 16038 3400-exit.
 16039     exit.
 16040 3410-check-with-hldi.
 16041     move spaces                 to hldi-pass-area
 16042     move pb-i-vin               to pa-vin
 16043     perform 7785-call-hldi      thru 7785-exit
 16044*    display 'PA-VIN        ' PA-VIN
 16045*    display 'PA-ErrorCode  ' PA-ErrorCode
 16046*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 16047*    display 'PA-ModelYear  ' PA-ModelYear
 16048*    display 'PA-MakeName   ' PA-MakeName
 16049*    display 'PA-ModelName  ' PA-ModelName
 16050*    display 'PA-SeriesName ' PA-SeriesName
 16051     if pa-errorcode (1:1) not = '0'
 16052        move spaces              to hldi-pass-area
 16053        move pb-i-vin            to pa-vin
 16054*       move pa-errordesc        to pa-seriesname
 16055*       perform 7786-call-hldim  thru 7786-exit
 16056*       display 'PA-VIN        ' PA-VIN
 16057*       display 'PA-ErrorCode  ' PA-ErrorCode
 16058*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 16059*       display 'PA-ModelYear  ' PA-ModelYear
 16060*       display 'PA-MakeName   ' PA-MakeName
 16061*       display 'PA-ModelName  ' PA-ModelName
 16062*       display 'PA-SeriesName ' PA-SeriesName
 16063     end-if
 16064     .
 16065 3410-exit.
 16066     exit.
 16067******************************************************************
 16068*                  E D I T   C A N C E L                         *
 16069******************************************************************
 16070
 16071 3700-EDIT-CANCEL.
 16072     IF PB-COMPANY-ID = 'DMD'
 16073         MOVE ZEROS                   TO WS-RES-STATE-TAX
 16074                                         WS-RES-MUNI-TAX
 16075                                         PB-CI-STATE-TAX
 16076                                         PB-CI-MUNI-TAX
 16077         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 16078
 16079*    IF PB-COMPANY-ID  EQUAL  'NCL'
 16080*       IF PB-ENTRY-BATCH  NUMERIC
 16081*          IF PB-CANCELLATION
 16082*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 16083*          ELSE
 16084*             IF PB-ISSUE
 16085*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 16086
 16087     IF PB-C-INT-ON-REFS NOT NUMERIC
 16088        MOVE ZEROS               TO PB-C-INT-ON-REFS
 16089     END-IF
 16090*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 16091*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 16092
 16093     IF CM-ENTRY-STATUS = 'V'
 16094        MOVE ER-2780             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 291
* EL050.cbl
 16095        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16096        GO TO 3999-END-EDIT.
 16097
 16098     IF CM-ENTRY-STATUS = 'D'
 16099        MOVE ER-2781             TO WS-ERROR
 16100        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16101        GO TO 3999-END-EDIT.
 16102
 16103     IF CM-ENTRY-STATUS = 'U'
 16104        MOVE ER-2782             TO WS-ERROR
 16105        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16106
 16107***************************************************************
 16108*                                                             *
 16109*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 16110*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 16111*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 16112*   OF ANOTHER COVERAGE.                                      *
 16113*                                                             *
 16114***************************************************************
 16115
 16116     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 16117                                    PB-C-AH-CANCEL-VOID-SW.
 16118
 16119     if pb-company-id = 'DCC' or 'VPP'
 16120        if ((pb-ci-lf-cancel-amt <> zeros)
 16121                       or
 16122            (pb-ci-ah-cancel-amt <> zeros))
 16123           MOVE ER-3068          TO WS-ERROR
 16124           PERFORM 9900-ERROR-FORMAT
 16125                                 THRU 9900-EXIT
 16126           GO TO 3999-END-EDIT
 16127        end-if
 16128     end-if
 16129     IF PB-C-LF-CANCEL-AMT = ZERO
 16130        NEXT SENTENCE
 16131     ELSE
 16132        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16133           AND
 16134           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16135               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 16136               MOVE ER-2745           TO WS-ERROR
 16137               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16138
 16139     IF PB-C-AH-CANCEL-AMT = ZERO
 16140        NEXT SENTENCE
 16141     ELSE
 16142        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16143           AND
 16144           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 16145               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 16146               MOVE ER-2745           TO WS-ERROR
 16147               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16148
 16149     IF WS-LF-EARNINGS-CALC = '4'
 16150        MOVE '4'                   TO WS-LF-REFUND-CALC.
 16151
 16152     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 292
* EL050.cbl
 16153     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 16154     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 16155     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 16156     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 16157     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 16158
 16159     MOVE ZERO                     TO PB-C-LF-REF-CALC
 16160                                      PB-C-AH-REF-CALC.
 16161     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 16162
 16163******************************************************************
 16164*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 16165*             TO VALIDATE COVERAGE.                              *
 16166******************************************************************
 16167
 16168     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 16169        PB-C-LF-CANCEL-AMT = ZEROS
 16170          MOVE 'N'                 TO WS-LF-CANCEL-SW
 16171      ELSE
 16172          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 16173
 16174     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 16175        PB-C-AH-CANCEL-AMT = ZEROS
 16176          MOVE 'N'                 TO WS-AH-CANCEL-SW
 16177      ELSE
 16178          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 16179
 16180     EVALUATE TRUE
 16181         WHEN PB-CANCEL-FORCE             OR
 16182              PB-CANCEL-DATE-FORCED       OR
 16183              PB-FORCE-OFF
 16184                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16185                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 16186                  END-IF
 16187         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 16188               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 16189              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 16190                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 16191         WHEN OTHER
 16192              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16193                 MOVE ER-2794              TO WS-ERROR
 16194              ELSE
 16195                 MOVE ER-2749              TO WS-ERROR
 16196              END-IF
 16197              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16198     END-EVALUATE.
 16199
 16200
 16201*    IF  PB-COMPANY-ID    EQUAL    'HER'
 16202*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 16203*            MOVE  ER-1909            TO  WS-ERROR
 16204*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 16205*        ELSE
 16206*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 16207
 16208     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 16209     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 16210        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 293
* EL050.cbl
 16211     ELSE
 16212        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 16213     END-IF
 16214     .
 16215 3705-EDIT-CANCEL-DT.
 16216
 16217     IF LF-COVERAGE-CANCELLED
 16218        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16219         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 16220         MOVE WS-CURRENT-MONTH-END
 16221                                 TO DC-BIN-DATE-2
 16222         SET ELAPSED-BETWEEN-BIN TO TRUE
 16223*        MOVE 1                  TO DC-OPTION-CODE
 16224         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16225         IF DATE-CONVERSION-ERROR
 16226            NEXT SENTENCE
 16227          ELSE
 16228             IF DC-ELAPSED-DAYS GREATER +180
 16229                IF PB-CANCEL-DATE-FORCED  OR
 16230                   PB-CANCEL-DATE-FORCED-NO-FEE
 16231                      MOVE ER-2751  TO WS-ERROR
 16232                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16233                 ELSE
 16234                   MOVE ER-2752  TO WS-ERROR
 16235                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16236
 16237     IF AH-COVERAGE-CANCELLED
 16238        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16239         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 16240         MOVE WS-CURRENT-MONTH-END
 16241                                 TO DC-BIN-DATE-2
 16242         SET ELAPSED-BETWEEN-BIN TO TRUE
 16243*        MOVE 1                  TO DC-OPTION-CODE
 16244         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16245         IF DATE-CONVERSION-ERROR
 16246            NEXT SENTENCE
 16247          ELSE
 16248             IF DC-ELAPSED-DAYS GREATER +180
 16249                IF PB-CANCEL-DATE-FORCED OR
 16250                   PB-CANCEL-DATE-FORCED-NO-FEE
 16251                      MOVE ER-2751  TO WS-ERROR
 16252                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16253                 ELSE
 16254                   MOVE ER-2752  TO WS-ERROR
 16255                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16256
 16257     IF WS-ERROR = ER-2752
 16258        AND (PB-COMPANY-ID = 'ABL'
 16259         OR  PB-COMPANY-ID = 'FGL'
 16260         OR  PB-COMPANY-ID = 'IST'
 16261         OR  PB-COMPANY-ID = 'JHL'
 16262         OR  PB-COMPANY-ID = 'LAP'
 16263         OR  PB-COMPANY-ID = 'LBL'
 16264         OR  PB-COMPANY-ID = 'NCB'
 16265         OR  PB-COMPANY-ID = 'NLI'
 16266         OR  PB-COMPANY-ID = 'OFI'
 16267         OR  PB-COMPANY-ID = 'PLI'
 16268         OR  PB-COMPANY-ID = 'TAO'
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 294
* EL050.cbl
 16269         OR  PB-COMPANY-ID = 'TIC'
 16270         OR  PB-COMPANY-ID = 'HER'
 16271         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 16272         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 16273            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 16274            MOVE ER-2762     TO WS-ERROR
 16275            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16276
 16277     IF LF-COVERAGE-CANCELLED
 16278        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16279        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16280             MOVE ER-2733         TO WS-ERROR
 16281             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16282
 16283     IF AH-COVERAGE-CANCELLED
 16284        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16285        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16286              MOVE ER-2733        TO WS-ERROR
 16287              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16288
 16289     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 16290        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 16291        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 16292           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 16293            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 16294              IF PB-COMPANY-ID NOT = 'LAP'
 16295               MOVE ER-2704            TO WS-ERROR
 16296               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16297
 16298     IF CERT-WAS-NOT-FOUND
 16299         GO TO 3999-END-EDIT.
 16300
 16301     IF PB-COMPANY-ID EQUAL 'CDC'
 16302        IF LF-COVERAGE-CANCELLED
 16303           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16304            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16305            MOVE PB-C-LF-CANCEL-DT
 16306                                 TO DC-BIN-DATE-2
 16307            SET ELAPSED-BETWEEN-BIN TO TRUE
 16308*           MOVE 1               TO DC-OPTION-CODE
 16309            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16310            IF DATE-CONVERSION-ERROR
 16311               NEXT SENTENCE
 16312             ELSE
 16313                IF DC-ELAPSED-DAYS GREATER +60
 16314                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 16315
 16316     IF PB-COMPANY-ID EQUAL 'CDC'
 16317        IF AH-COVERAGE-CANCELLED
 16318           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16319            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16320            MOVE PB-C-AH-CANCEL-DT
 16321                                 TO DC-BIN-DATE-2
 16322            MOVE +0              TO DC-ELAPSED-DAYS
 16323                                    DC-ELAPSED-MONTHS
 16324            SET ELAPSED-BETWEEN-BIN  TO TRUE
 16325*           MOVE 1               TO DC-OPTION-CODE
 16326            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 295
* EL050.cbl
 16327            IF DATE-CONVERSION-ERROR
 16328               NEXT SENTENCE
 16329             ELSE
 16330                IF DC-ELAPSED-DAYS GREATER +60
 16331                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 16332
 16333     MOVE +0                     TO DC-ELAPSED-DAYS
 16334                                    DC-ELAPSED-MONTHS.
 16335
 16336     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 16337        (WS-AH-SPECIAL-CALC-CD = 'Z')
 16338          MOVE 'Z'                TO PB-CI-OB-FLAG
 16339          MOVE ER-2767            TO WS-ERROR
 16340          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16341          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16342          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16343          GO TO 3775-OVER-REF-CHK
 16344        ELSE
 16345          MOVE ZEROS              TO PB-CI-LIVES
 16346                                     PB-C-LIVES
 16347          IF PB-CI-OB-FLAG NOT = 'B'
 16348             MOVE SPACE           TO PB-CI-OB-FLAG.
 16349
 16350     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 16351         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 16352     ELSE
 16353         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 16354
 16355     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 16356        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 16357            MOVE ER-2760         TO WS-ERROR
 16358            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16359
 16360     IF LF-COVERAGE-CANCELLED
 16361        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16362         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 16363            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 16364               MOVE ER-2774       TO WS-ERROR
 16365               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16366
 16367     IF AH-COVERAGE-CANCELLED
 16368        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16369         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 16370            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 16371               MOVE ER-2775       TO WS-ERROR
 16372               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16373
 16374     IF LF-COVERAGE-CANCELLED
 16375        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16376         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 16377            MOVE ER-2776         TO WS-ERROR
 16378            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16379
 16380     IF AH-COVERAGE-CANCELLED
 16381        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16382         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 16383            MOVE ER-2777         TO WS-ERROR
 16384            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 296
* EL050.cbl
 16385
 16386     IF LF-COVERAGE-CANCELLED
 16387        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16388        if pb-ci-lf-expire-dt = low-values or spaces
 16389           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16390           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 16391           MOVE PB-CI-EXTENTION-DAYS
 16392                                 TO DC-ELAPSED-DAYS
 16393           SET BIN-PLUS-ELAPSED  TO TRUE
 16394           PERFORM 8500-DATE-CONVERT
 16395                                 THRU 8500-EXIT
 16396           IF DATE-CONVERSION-ERROR
 16397              move low-values    to dc-bin-date-2
 16398           end-if
 16399        else
 16400           move pb-ci-lf-expire-dt
 16401                                 to dc-bin-date-2
 16402        end-if
 16403        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16404           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16405                             OR  'FIA'
 16406              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 16407           ELSE
 16408              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16409              MOVE ER-2731       TO WS-ERROR
 16410              PERFORM 9900-ERROR-FORMAT
 16411                                 THRU 9900-EXIT
 16412           end-if
 16413        end-if
 16414     end-if
 16415*    IF LF-COVERAGE-CANCELLED
 16416*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16417*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16418*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 16419*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16420*        SET BIN-PLUS-ELAPSED      TO TRUE
 16421*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16422*        IF DATE-CONVERSION-ERROR
 16423*           NEXT SENTENCE
 16424*         ELSE
 16425*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16426*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16427*                            OR  'FIA'
 16428*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 16429*              ELSE
 16430*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16431*               MOVE ER-2731       TO WS-ERROR
 16432*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16433     .
 16434 3705-EDIT-AH-CANCEL-DT.
 16435     IF AH-COVERAGE-CANCELLED
 16436        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16437        if pb-ci-AH-expire-dt = low-values or spaces
 16438           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16439           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 16440           MOVE PB-CI-EXTENTION-DAYS
 16441                                 TO DC-ELAPSED-DAYS
 16442           SET BIN-PLUS-ELAPSED  TO TRUE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 297
* EL050.cbl
 16443           PERFORM 8500-DATE-CONVERT
 16444                                 THRU 8500-EXIT
 16445           IF DATE-CONVERSION-ERROR
 16446              move low-values    to dc-bin-date-2
 16447           end-if
 16448        else
 16449           move pb-ci-ah-expire-dt
 16450                                 to dc-bin-date-2
 16451        end-if
 16452        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16453           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16454                             OR  'FIA'
 16455              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 16456           ELSE
 16457              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16458              MOVE ER-2771       TO WS-ERROR
 16459              PERFORM 9900-ERROR-FORMAT
 16460                                 THRU 9900-EXIT
 16461           end-if
 16462        end-if
 16463     end-if
 16464*    IF AH-COVERAGE-CANCELLED
 16465*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16466*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16467*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16468*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16469**       MOVE 6                    TO DC-OPTION-CODE
 16470*        SET BIN-PLUS-ELAPSED      TO TRUE
 16471*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16472*        IF DATE-CONVERSION-ERROR
 16473*           NEXT SENTENCE
 16474*         ELSE
 16475*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16476*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16477*                             OR 'FIA'
 16478*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16479*             ELSE
 16480*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16481*              MOVE ER-2771       TO WS-ERROR
 16482*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16483     .
 16484 3705-EDIT-CONTINUED.
 16485
 16486*    IF LF-COVERAGE-CANCELLED
 16487*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16488*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16489*            MOVE ER-2727         TO WS-ERROR
 16490*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16491*
 16492*    IF AH-COVERAGE-CANCELLED
 16493*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16494*        IF PB-COMPANY-ID = 'ACE'
 16495*           MOVE ER-2727        TO WS-ERROR
 16496*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16497*        ELSE
 16498*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16499*              MOVE ER-2727     TO WS-ERROR
 16500*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 298
* EL050.cbl
 16501
 16502     IF PB-COMPANY-ID = 'ACE'
 16503       IF AH-COVERAGE-CANCELLED
 16504         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16505           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16506              MOVE ER-2732      TO WS-ERROR
 16507              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16508
 16509     IF PB-COMPANY-ID      EQUAL   'HER'
 16510        IF WS-ERROR        EQUAL   ER-2727
 16511            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 16512            MOVE  ER-2725          TO  WS-ERROR
 16513            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16514
 16515     IF PB-C-CLAIM-CREATED-CANCEL
 16516            MOVE ER-2748         TO WS-ERROR
 16517            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16518
 16519     IF PB-C-LAST-NAME NOT = SPACES
 16520         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16521            MOVE ER-2747         TO WS-ERROR
 16522            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16523
 16524 3710-EDIT-LUMP-SUM-PRIOR.
 16525
 16526     IF AH-COVERAGE-CANCELLED
 16527         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16528             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16529                MOVE ER-2735    TO WS-ERROR
 16530                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16531
 16532     IF LF-COVERAGE-CANCELLED
 16533         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16534             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16535                MOVE ER-2735    TO WS-ERROR
 16536                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16537
 16538 3710-EDIT-PRIOR-DEATH.
 16539
 16540*    IF LF-COVERAGE-CANCELLED
 16541*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16542*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16543*           (NOT PB-CI-OB)
 16544*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16545*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16546*                   MOVE ER-2732  TO WS-ERROR
 16547*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16548*
 16549*    IF AH-COVERAGE-CANCELLED
 16550*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16551*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16552*           (NOT PB-CI-OB)
 16553*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16554*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16555*                   MOVE ER-2732  TO WS-ERROR
 16556*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16557
 16558     IF PB-CI-DEATH-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 299
* EL050.cbl
 16559         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16560            (NOT PB-COMP-LF-CANCEL)
 16561             NEXT SENTENCE
 16562         ELSE
 16563           IF PB-C-LF-CANCEL-VOIDED
 16564              NEXT SENTENCE
 16565           ELSE
 16566              MOVE ER-2753      TO WS-ERROR
 16567              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16568
 16569     IF CANCEL-FUTURE-DT
 16570         GO TO 3999-END-EDIT.
 16571
 16572 3715-GET-REMAIN-TERM-LF.
 16573
 16574     IF NO-LF-BENEFIT-MATCH  OR
 16575        WS-LF-BENEFIT-CD = ZEROS
 16576        GO TO 3730-GET-AH-REMAIN-TERM.
 16577
 16578     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16579     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16580     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16581     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16582     MOVE PB-SV-STATE            TO CP-STATE.
 16583     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16584     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16585     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16586     MOVE '2'                    TO CP-PROCESS-TYPE.
 16587     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16588     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16589     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16590     IF (PB-COMPANY-ID = 'CID')
 16591        AND (CP-STATE-STD-ABBRV = 'WI')
 16592        MOVE '7'                 TO CP-REM-TERM-METHOD
 16593        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16594     ELSE
 16595        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16596        MOVE WS-REM-TRM-CALC-OPTION
 16597                                 TO CP-REM-TRM-CALC-OPTION
 16598     END-IF
 16599**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16600     IF (PB-COMPANY-ID = 'CID')
 16601        AND (CP-STATE-STD-ABBRV = 'MO')
 16602        AND (PB-CERT-EFF-DT >= X'9B41')
 16603        AND (PB-CERT-EFF-DT <= X'A2FB')
 16604        MOVE '7'                 TO CP-REM-TERM-METHOD
 16605        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16606     END-IF
 16607     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16608                                    CP-LOAN-TERM.
 16609     IF CP-TRUNCATED-LIFE
 16610        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16611
 16612     IF CP-TERM-IS-DAYS
 16613         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16614     ELSE
 16615         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16616
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 300
* EL050.cbl
 16617     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16618
 16619     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16620
 16621     IF LF-COVERAGE-CANCELLED
 16622        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16623        NEXT SENTENCE
 16624      ELSE
 16625          GO TO 3730-GET-AH-REMAIN-TERM.
 16626
 16627 3720-GET-LF-REFUND.
 16628
 16629     IF PB-C-LF-CANCEL-VOIDED
 16630        GO TO 3730-GET-AH-REMAIN-TERM
 16631     end-if
 16632
 16633     IF PB-COMPANY-ID EQUAL 'BOA'
 16634         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16635         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16636         GO TO 3730-GET-AH-REMAIN-TERM.
 16637
 16638     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16639        (WS-AH-SPECIAL-CALC-CD = 'M')
 16640         MOVE ER-2767            TO WS-ERROR
 16641         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16642         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16643         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16644         GO TO 3780-UPDATE-CANCEL-CERT.
 16645
 16646*    if (ws-lf-earnings-calc = '6')
 16647*       or (pb-c-lf-refund-override = '6')
 16648*       move cp-remaining-term-1 to cp-remaining-term-2
 16649*    end-if
 16650     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16651
 16652     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16653     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16654     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16655     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16656     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16657     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16658     IF PB-COMPANY-ID = 'DCC'
 16659        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16660        IF PDEF-MASTER-FOUND
 16661           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16662              (V1 > +8)
 16663              OR (PD-PROD-CODE (V1) = 'L')
 16664           END-PERFORM
 16665           IF V1 < +9
 16666              MOVE PD-MAX-AMT (V1)
 16667                           TO CP-R-MAX-TOT-BEN
 16668                              EC-AM-LF-MAX-TOT-BEN
 16669           END-IF
 16670        ELSE
 16671        MOVE ' '                 TO PDEF-MASTER-SW
 16672        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16673        MOVE PB-STATE            TO ERPDEF-STATE
 16674        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 301
* EL050.cbl
 16675           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16676        END-IF
 16677        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16678        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16679        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16680        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16681        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16682        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16683        IF PDEF-MASTER-FOUND
 16684           MOVE 'N'              TO PDEF-MASTER-SW
 16685           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16686           IF PDEF-MASTER-FOUND
 16687              IF (ERPDEF-KEY-SAVE (1:16) =
 16688                           PD-CONTROL-PRIMARY (1:16))
 16689                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16690                 CONTINUE
 16691              ELSE
 16692                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16693                 IF (ERPDEF-KEY-SAVE (1:16) =
 16694                           PD-CONTROL-PRIMARY (1:16))
 16695                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16696                    CONTINUE
 16697                 ELSE
 16698                    MOVE 'N'     TO PDEF-MASTER-SW
 16699                 END-IF
 16700              END-IF
 16701
 16702              IF PDEF-MASTER-FOUND
 16703                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16704                    (V1 > +8)
 16705                    OR (PD-PROD-CODE (V1) = 'L')
 16706                 END-PERFORM
 16707                 IF V1 < +9
 16708                    MOVE PD-MAX-AMT (V1)
 16709                                 TO CP-R-MAX-TOT-BEN
 16710                                    EC-AM-LF-MAX-TOT-BEN
 16711                 END-IF
 16712              END-IF
 16713           END-IF
 16714           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16715        END-IF
 16716        END-IF
 16717     END-IF
 16718     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16719
 16720     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16721
 16722     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16723                                    PB-C-LF-REM-TERM.
 16724
 16725     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16726     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16727
 16728     IF PB-COMPANY-ID EQUAL 'FLC'
 16729        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16730           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16731           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16732                    + PB-CI-LF-ALT-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 302
* EL050.cbl
 16733                    - CM-LF-ITD-DEATH-AMT
 16734           IF PB-C-LF-REF-CALC LESS THAN +0
 16735              MOVE +0            TO PB-C-LF-REF-CALC
 16736              GO TO 3730-GET-AH-REMAIN-TERM
 16737           ELSE
 16738              GO TO 3730-GET-AH-REMAIN-TERM.
 16739
 16740     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16741                            OR '4' OR '5' OR '6' OR '8'
 16742                            OR '9' OR 'G'
 16743        MOVE PB-C-LF-REFUND-OVERRIDE
 16744                                 TO CP-EARNING-METHOD.
 16745
 16746     if pb-company-id = 'AHL'
 16747        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16748        if cp-class-code = spaces
 16749           move zeros            to cp-class-code
 16750        end-if
 16751     ELSE
 16752        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16753     END-IF
 16754*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16755     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16756     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16757                                    CP-RATING-BENEFIT-AMT.
 16758     IF CP-STATE-STD-ABBRV = 'OR'
 16759         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16760                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16761     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16762     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16763     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16764     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16765     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16766     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16767     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16768     IF WS-DEFAULT-APR NOT NUMERIC
 16769         MOVE ZEROS TO WS-DEFAULT-APR.
 16770****   N O T E   ****
 16771*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16772*      THE OH HARD CODING IN ELCRFNDP
 16773
 16774     IF PB-COMPANY-ID = 'CID'
 16775        IF CP-STATE-STD-ABBRV = 'OH'
 16776           MOVE WS-LF-EARNINGS-CALC
 16777                                 TO CP-EARNING-METHOD
 16778        END-IF
 16779     END-IF
 16780
 16781****   N O T E   ****
 16782
 16783*    IF CP-EARN-AS-NET-PAY
 16784*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16785*           IF WS-DEFAULT-APR GREATER THAN ZEROS
 16786*               MOVE WS-DEFAULT-APR
 16787*                                TO  CP-LOAN-APR
 16788*               MOVE ER-3780     TO  WS-ERROR
 16789*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16790*           ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 303
* EL050.cbl
 16791*               MOVE ER-3781     TO  WS-ERROR
 16792*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16793*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16794     move ' '                    to cp-ext-days-calc
 16795     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16796
 16797     IF CP-REFUND-TYPE-USED NOT = SPACE
 16798         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16799
 16800     IF CP-ERROR-RATE-IS-ZERO OR
 16801        CP-ERROR-RATE-NOT-FOUND
 16802        MOVE ER-2740             TO WS-ERROR
 16803        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16804
 16805     IF CP-ERROR-RATE-FILE-NOTOPEN
 16806        MOVE ER-2617             TO WS-ERROR
 16807        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16808
 16809     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16810        AND PB-CI-ENTRY-STATUS = 'M'
 16811        MOVE +0                  TO PB-C-LF-REF-CALC
 16812     ELSE
 16813        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16814     END-IF
 16815
 16816     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16817         GO TO 3730-GET-AH-REMAIN-TERM.
 16818
 16819*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16820*       ADD +1                   TO PB-C-LF-REM-TERM
 16821*                                   CP-REMAINING-TERM
 16822*                                   CP-ORIGINAL-TERM.
 16823
 16824     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16825     MOVE '2'                    TO CP-EARNING-METHOD
 16826                                    CP-RATING-METHOD.
 16827     IF PB-COMPANY-ID = 'CID'
 16828        IF (CP-STATE-STD-ABBRV = 'MN')
 16829           AND (PB-CERT-EFF-DT > X'A4FF')
 16830           AND (WS-LF-EARNINGS-CALC = 'B')
 16831           MOVE '5'              TO CP-EARNING-METHOD
 16832           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16833        END-IF
 16834     END-IF
 16835     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16836                                        CP-REMAINING-BENEFIT
 16837                                        CP-RATING-BENEFIT-AMT.
 16838     IF CP-STATE-STD-ABBRV = 'OR'
 16839         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16840                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16841     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16842     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16843
 16844     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16845
 16846     IF CP-ERROR-RATE-IS-ZERO OR
 16847        CP-ERROR-RATE-NOT-FOUND
 16848        MOVE ER-2740             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 304
* EL050.cbl
 16849        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16850
 16851     IF CP-ERROR-RATE-FILE-NOTOPEN
 16852        MOVE ER-2617             TO WS-ERROR
 16853        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16854
 16855     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16856
 16857******************************************************************
 16858
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 305
* EL050.cbl
 16860 3730-GET-AH-REMAIN-TERM.
 16861     IF NO-AH-BENEFIT-MATCH  OR
 16862        WS-AH-BENEFIT-CD = ZEROS
 16863         GO TO 3770-CHECK-REFUNDS.
 16864
 16865     IF PB-CI-AH-LUMP-SUM-DISAB
 16866         IF  PB-C-AH-CANCEL-AMT = ZERO
 16867            IF NOT PB-COMP-AH-CANCEL
 16868             GO TO 3770-CHECK-REFUNDS.
 16869
 16870     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16871     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16872     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16873     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16874     MOVE PB-SV-STATE            TO CP-STATE.
 16875     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16876     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16877     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16878     MOVE '2'                    TO CP-PROCESS-TYPE.
 16879     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16880     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16881     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16882     IF (PB-COMPANY-ID = 'CID')
 16883        AND (CP-STATE-STD-ABBRV = 'WI')
 16884        MOVE '7'                 TO CP-REM-TERM-METHOD
 16885        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16886     ELSE
 16887        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16888        MOVE WS-REM-TRM-CALC-OPTION
 16889                                 TO CP-REM-TRM-CALC-OPTION
 16890     END-IF
 16891     IF (PB-COMPANY-ID = 'CID')
 16892        AND (CP-STATE-STD-ABBRV = 'MO')
 16893        AND (PB-CERT-EFF-DT >= X'9B41')
 16894        AND (PB-CERT-EFF-DT <= X'A2FB')
 16895        MOVE '7'                 TO CP-REM-TERM-METHOD
 16896        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16897     END-IF
 16898     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16899                                    CP-LOAN-TERM.
 16900     IF NOT CP-TERM-IS-DAYS
 16901         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16902
 16903     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16904
 16905     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16906
 16907     IF AH-COVERAGE-CANCELLED
 16908        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16909        NEXT SENTENCE
 16910      ELSE
 16911         GO TO 3770-CHECK-REFUNDS.
 16912
 16913 3740-GET-AH-REFUND.
 16914
 16915     IF PB-C-AH-CANCEL-VOIDED
 16916        GO TO 3780-UPDATE-CANCEL-CERT
 16917     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 306
* EL050.cbl
 16918
 16919     IF PB-COMPANY-ID = 'BOA'
 16920         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16921         GO TO 3770-CHECK-REFUNDS.
 16922
 16923     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16924*    MOVE ' '                    TO DC-OPTION-CODE
 16925     SET BIN-TO-GREG             TO TRUE
 16926     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16927     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16928                                    PB-C-AH-REM-TERM.
 16929     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16930     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16931
 16932     IF PB-COMPANY-ID EQUAL 'FLC'
 16933        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16934           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16935           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16936                    - CM-AH-ITD-AH-PMT)
 16937           IF PB-C-AH-REF-CALC LESS THAN +0
 16938              MOVE +0            TO PB-C-AH-REF-CALC
 16939              GO TO 3770-CHECK-REFUNDS
 16940           ELSE
 16941              GO TO 3770-CHECK-REFUNDS.
 16942
 16943     IF PB-COMPANY-ID = 'DCC'
 16944        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16945            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16946           MOVE 'S'              TO CP-EARNING-METHOD
 16947        END-IF
 16948     END-IF
 16949     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16950                            OR '4' OR '5' OR '6' OR '8'
 16951                            OR '9' OR 'G' OR 'S'
 16952        MOVE PB-C-AH-REFUND-OVERRIDE
 16953                                 TO CP-EARNING-METHOD.
 16954
 16955     if pb-company-id = 'AHL'
 16956        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16957        if cp-class-code = spaces
 16958           move zeros            to cp-class-code
 16959        end-if
 16960     ELSE
 16961        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16962     END-IF
 16963*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16964     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16965     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16966                                    CP-RATING-BENEFIT-AMT.
 16967     IF CP-STATE-STD-ABBRV = 'OR'
 16968         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16969                                         PB-CI-AH-TERM.
 16970     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16971     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16972     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16973     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16974     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16975     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 307
* EL050.cbl
 16976
 16977     IF CP-STATE-STD-ABBRV = 'OH'
 16978        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16979                                AND 'CID' AND 'DCC' and 'VPP'
 16980                                AND 'AHL')
 16981           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16982              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16983              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16984              MOVE '6' TO CP-EARNING-METHOD
 16985           END-IF
 16986        END-IF
 16987        IF PB-COMPANY-ID = 'CID'
 16988           IF NO-LIFE-COVERAGE
 16989              IF CP-CRITICAL-PERIOD
 16990                 MOVE '2'       TO CP-EARNING-METHOD
 16991              ELSE
 16992                 MOVE '6'       TO CP-EARNING-METHOD
 16993              END-IF
 16994           ELSE
 16995              IF WS-LF-COVERAGE-TYPE = 'L'
 16996                 MOVE '2'       TO CP-EARNING-METHOD
 16997              ELSE
 16998                 IF (PB-CI-LF-TERM > +60) OR
 16999                    (WS-LF-EARNINGS-CALC = '5')
 17000                    IF CP-CRITICAL-PERIOD
 17001                       MOVE '2'  TO CP-EARNING-METHOD
 17002                    ELSE
 17003                       MOVE '6'  TO CP-EARNING-METHOD
 17004                    END-IF
 17005                 ELSE
 17006                    MOVE '1'     TO CP-EARNING-METHOD
 17007                 END-IF
 17008              END-IF
 17009           END-IF
 17010        END-IF
 17011     END-IF
 17012
 17013*    IF CP-STATE-STD-ABBRV = 'VA'
 17014*       IF DC-GREG-DATE-CYMD GREATER 19921231
 17015*          IF CP-ORIGINAL-TERM GREATER 61
 17016*             MOVE '6' TO CP-EARNING-METHOD
 17017*          ELSE
 17018*             MOVE '1' TO CP-EARNING-METHOD.
 17019
 17020     IF WS-DEFAULT-APR NOT NUMERIC
 17021         MOVE ZEROS TO WS-DEFAULT-APR.
 17022     IF CP-EARN-AS-NET-PAY
 17023         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 17024            IF WS-DEFAULT-APR GREATER THAN ZEROS
 17025                MOVE WS-DEFAULT-APR
 17026                                 TO  CP-LOAN-APR
 17027                MOVE ER-3780     TO  WS-ERROR
 17028                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 17029            ELSE
 17030                MOVE ER-3781     TO  WS-ERROR
 17031                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 17032     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 17033     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 308
* EL050.cbl
 17034        AND CP-CANCEL-REASON = 'R'
 17035        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17036        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 17037     END-IF
 17038     IF PB-COMPANY-ID = 'DCC'
 17039        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17040        AND (CP-EARNING-METHOD = 'D')
 17041        AND (CP-CANCEL-REASON NOT = 'R')
 17042        CONTINUE
 17043     ELSE
 17044        GO TO 3750-CONTINUE
 17045     END-IF
 17046     MOVE ' '                    TO DD-IU-SW
 17047     IF NOT PDEF-MASTER-FOUND
 17048        MOVE ' '                 TO PDEF-MASTER-SW
 17049        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17050        MOVE PB-STATE            TO ERPDEF-STATE
 17051        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 17052           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 17053        END-IF
 17054        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17055        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17056        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17057        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17058        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17059        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17060        IF PDEF-MASTER-FOUND
 17061           MOVE 'N'              TO PDEF-MASTER-SW
 17062           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17063           IF PDEF-MASTER-FOUND
 17064              IF (ERPDEF-KEY-SAVE (1:16) =
 17065                           PD-CONTROL-PRIMARY (1:16))
 17066                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17067                 CONTINUE
 17068              ELSE
 17069                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17070                 IF (ERPDEF-KEY-SAVE (1:16) =
 17071                           PD-CONTROL-PRIMARY (1:16))
 17072                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17073                    CONTINUE
 17074                 ELSE
 17075                    MOVE ER-2740 TO WS-ERROR
 17076                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17077                    GO TO 3770-CHECK-REFUNDS
 17078                 END-IF
 17079              END-IF
 17080           END-IF
 17081           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17082        END-IF
 17083     END-IF
 17084     IF PDEF-MASTER-FOUND
 17085        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17086           (V1 > +8)
 17087           OR (PD-PROD-CODE (V1) = 'I')
 17088        END-PERFORM
 17089        IF V1 < +9
 17090           SET DD-IU-PRESENT        TO TRUE
 17091        END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 309
* EL050.cbl
 17092        IF WS-AH-DCC-TRUNC = 'T'
 17093           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 17094        ELSE
 17095           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 17096        END-IF
 17097        EVALUATE TRUE
 17098           WHEN WS-TERM > +168
 17099              MOVE 15               TO V1
 17100           WHEN WS-TERM > +156
 17101              MOVE 14               TO V1
 17102           WHEN WS-TERM > +144
 17103              MOVE 13               TO V1
 17104           WHEN WS-TERM > +132
 17105              MOVE 12               TO V1
 17106           WHEN WS-TERM > +120
 17107              MOVE 11               TO V1
 17108           WHEN WS-TERM > +108
 17109              MOVE 10               TO V1
 17110           WHEN WS-TERM > +96
 17111              MOVE 9                TO V1
 17112           WHEN WS-TERM > +84
 17113              MOVE 8                TO V1
 17114           WHEN WS-TERM > +72
 17115              MOVE 7                TO V1
 17116           WHEN WS-TERM > +60
 17117              MOVE 6                TO V1
 17118           WHEN WS-TERM > +48
 17119              MOVE 5                TO V1
 17120           WHEN WS-TERM > +36
 17121              MOVE 4                TO V1
 17122           WHEN WS-TERM > +24
 17123              MOVE 3                TO V1
 17124           WHEN WS-TERM > +12
 17125              MOVE 2                TO V1
 17126           WHEN OTHER
 17127              MOVE 1                TO V1
 17128        END-EVALUATE
 17129
 17130        EVALUATE TRUE
 17131*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 17132*             < +13)
 17133*             AND (DD-IU-PRESENT)
 17134*             MOVE 2                TO V2
 17135*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 17136*             MOVE 1                TO V2
 17137           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 17138              MOVE 2                TO V2
 17139           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 17140              MOVE 3                TO V2
 17141           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 17142              MOVE 4                TO V2
 17143           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 17144              MOVE 5                TO V2
 17145           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 17146              MOVE 6                TO V2
 17147           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 17148              MOVE 7                TO V2
 17149           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 310
* EL050.cbl
 17150              MOVE 8                TO V2
 17151           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 17152              MOVE 9                TO V2
 17153           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 17154              MOVE 10               TO V2
 17155           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 17156              MOVE 11               TO V2
 17157           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 17158              MOVE 12               TO V2
 17159           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 17160              MOVE 13               TO V2
 17161           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 17162              MOVE 14               TO V2
 17163           WHEN OTHER
 17164              MOVE 15               TO V2
 17165        END-EVALUATE
 17166
 17167        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 17168                                 TO CP-DDF-LO-FACT
 17169        MOVE PD-UEP-FACTOR (V1 V2)
 17170                                 TO CP-DDF-HI-FACT
 17171
 17172        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 17173        MOVE CM-AH-CLP     TO CP-DDF-CLP
 17174        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 17175           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 17176        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 17177        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 17178        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 17179           + PD-1ST-YR-ADMIN-ALLOW
 17180
 17181        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17182*       IF PI-CLP-YN = 'Y'
 17183*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 17184*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 17185*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 17186*       END-IF
 17187
 17188        IF DD-IU-PRESENT
 17189           MOVE 'I'              TO CP-EARNING-METHOD
 17190        END-IF
 17191        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17192                                     CP-CLP-RATE-UP
 17193        IF CP-IU-RATE-UP NOT = ZEROS
 17194           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 17195              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 17196           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 17197              / (1 - WS-WORK-FACT)
 17198        END-IF
 17199     END-IF
 17200     .
 17201 3750-CONTINUE.
 17202     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 17203
 17204     IF CP-REFUND-TYPE-USED NOT = SPACE
 17205         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 17206
 17207     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 311
* EL050.cbl
 17208        CP-ERROR-RATE-NOT-FOUND
 17209        MOVE ER-2740             TO WS-ERROR
 17210        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17211
 17212     IF CP-ERROR-RATE-FILE-NOTOPEN
 17213        MOVE ER-2617             TO WS-ERROR
 17214        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17215     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17216        AND (PB-CI-ENTRY-STATUS = 'M')
 17217        MOVE +0                  TO PB-C-AH-REF-CALC
 17218     ELSE
 17219        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 17220     END-IF
 17221     if pb-company-id = 'VPP'
 17222        MOVE cm-ah-clp           to cp-original-premium
 17223        move zeros               to cp-calc-refund
 17224        perform 7600-get-refund  thru 7600-exit
 17225        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 17226           move cp-calc-refund   to pb-c-ah-rfnd-clp
 17227        else
 17228           move zeros            to pb-c-ah-rfnd-clp
 17229        end-if
 17230        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 17231           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 17232           pb-ci-cancel-fee
 17233     end-if
 17234     IF PB-COMPANY-ID = 'DCC'
 17235        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17236        AND (CP-EARNING-METHOD = 'D' OR 'I')
 17237        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17238        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 17239        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 17240        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 17241        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 17242        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 17243*       if pb-c-cancel-amt < +0
 17244*          compute pb-c-ah-rfnd-clp = pb-c-ah-rfnd-clp * -1
 17245*       end-if
 17246*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 17247     END-IF
 17248     .
 17249 3770-CHECK-REFUNDS.
 17250
 17251     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 17252        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17253           MOVE ER-2766          TO WS-ERROR
 17254           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17255           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 17256           IF PB-C-LF-REF-CALC LESS THAN ZERO
 17257              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 17258
 17259     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 17260        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17261           MOVE ER-2766          TO WS-ERROR
 17262           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17263           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 17264           IF PB-C-AH-REF-CALC LESS THAN ZERO
 17265              MOVE ZEROS         TO PB-C-AH-REF-CALC.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 312
* EL050.cbl
 17266
 17267     IF PB-COMP-LF-CANCEL
 17268        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 17269        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17270           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 17271              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 17272
 17273     IF PB-COMP-AH-CANCEL
 17274        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 17275        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17276           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 17277              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 17278
 17279     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 17280             GIVING WS-UNSIGN-WRK1
 17281     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 17282             GIVING WS-UNSIGN-WRK2.
 17283
 17284     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17285         MOVE ZERO TO WS-UNSIGN-WRK1.
 17286
 17287     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17288         MOVE ZERO TO WS-UNSIGN-WRK2.
 17289
 17290     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 17291
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 313
* EL050.cbl
 17293
 17294 3772-CONTINUE.
 17295
 17296**********************************
 17297*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 17298*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 17299*** DOUBLES THE TOLERANCE AMOUNT.
 17300***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 17301**********************************
 17302     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 17303     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 17304         IF WS-REF-REJECT-SW = SPACE
 17305             MOVE ER-2754        TO WS-ERROR
 17306             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17307           ELSE
 17308             MOVE ER-2736        TO WS-ERROR
 17309             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17310**********************************
 17311
 17312 3773-CONTINUE.
 17313
 17314     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 17315        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17316           MOVE ER-2723          TO WS-ERROR
 17317           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17318
 17319     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 17320        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17321           MOVE ER-2724          TO WS-ERROR
 17322           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17323
 17324     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17325         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 17326             (1 + WS-LF-REFUND-OVS-PCT)
 17327     ELSE
 17328         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 17329
 17330     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 17331         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 17332             (1 - WS-TOL-LF-REFUND-PCT)
 17333     ELSE
 17334         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 17335
 17336     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17337        AND (PB-CI-ENTRY-STATUS = 'M')
 17338        AND (PB-C-LF-CANCEL-AMT > +0)
 17339        MOVE ER-3843             TO WS-ERROR
 17340        PERFORM 9900-ERROR-FORMAT
 17341                                 THRU 9900-EXIT
 17342     END-IF
 17343     EVALUATE TRUE
 17344        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17345           CONTINUE
 17346        WHEN PB-C-LF-CANCEL-AMT = +0
 17347                 AND PB-C-LF-REF-CALC > +0
 17348           CONTINUE
 17349        WHEN WS-LF-REFUND-OVS-AMT = 0
 17350                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 314
* EL050.cbl
 17351           CONTINUE
 17352        WHEN OTHER
 17353           IF WS-TOL-LF-REFUND  = +0
 17354              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 17355           END-IF
 17356           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17357                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 17358                          (PB-C-LF-CANCEL-AMT))
 17359              CONTINUE
 17360           ELSE
 17361              IF WS-LF-REFUND-OVS-AMT = +0
 17362                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 17363              END-IF
 17364              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17365                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 17366                                       PB-C-LF-CANCEL-AMT)
 17367                 CONTINUE
 17368              ELSE
 17369                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17370                   MOVE ER-2754   TO  WS-ERROR
 17371                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17372                 ELSE
 17373                    MOVE ER-2736   TO  WS-ERROR
 17374                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17375                 END-IF
 17376              END-IF
 17377           END-IF
 17378     END-EVALUATE.
 17379
 17380     EVALUATE TRUE
 17381        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17382           CONTINUE
 17383        WHEN PB-C-LF-CANCEL-AMT = +0
 17384                 AND PB-C-LF-REF-CALC > +0
 17385           CONTINUE
 17386        WHEN OTHER
 17387           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17388               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 17389              CONTINUE
 17390           ELSE
 17391              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17392               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 17393                CONTINUE
 17394              ELSE
 17395                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17396                     MOVE ER-2754   TO  WS-ERROR
 17397                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17398                 ELSE
 17399                     MOVE ER-2736   TO  WS-ERROR
 17400                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17401                 END-IF
 17402              END-IF
 17403           END-IF
 17404     END-EVALUATE.
 17405
 17406     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17407         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 17408             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 315
* EL050.cbl
 17409     ELSE
 17410         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 17411
 17412     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 17413         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 17414             (1 - WS-TOL-AH-REFUND-PCT)
 17415     ELSE
 17416         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 17417
 17418     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17419        AND (PB-CI-ENTRY-STATUS = 'M')
 17420        AND (PB-C-AH-CANCEL-AMT > +0)
 17421        MOVE ER-3843             TO WS-ERROR
 17422        PERFORM 9900-ERROR-FORMAT
 17423                                 THRU 9900-EXIT
 17424     END-IF
 17425     EVALUATE TRUE
 17426        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 17427           CONTINUE
 17428*       WHEN PB-C-AH-REF-CALC = +0 AND
 17429*                  PB-C-AH-CANCEL-AMT > +0
 17430        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 17431                   PB-C-AH-REF-CALC > +0
 17432           CONTINUE
 17433        WHEN WS-AH-REFUND-OVS-AMT = +0
 17434                AND WS-TOL-AH-REFUND = +0
 17435           CONTINUE
 17436        WHEN OTHER
 17437           IF WS-TOL-AH-REFUND = +0
 17438              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 17439           END-IF
 17440           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 17441               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 17442                                         PB-C-AH-CANCEL-AMT)
 17443              CONTINUE
 17444           ELSE
 17445              IF WS-AH-REFUND-OVS-AMT = +0
 17446                 MOVE +9999999.99 TO
 17447                         WS-AH-REFUND-OVS-AMT
 17448              END-IF
 17449              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17450                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 17451                                         PB-C-AH-CANCEL-AMT)
 17452                 CONTINUE
 17453              ELSE
 17454                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17455                    MOVE ER-2754   TO  WS-ERROR
 17456                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17457                 ELSE
 17458                    MOVE ER-2736   TO  WS-ERROR
 17459                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17460                 END-IF
 17461              END-IF
 17462           END-IF
 17463     END-EVALUATE.
 17464
 17465     EVALUATE TRUE
 17466        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 316
* EL050.cbl
 17467           CONTINUE
 17468*       WHEN PB-C-AH-REF-CALC > +0 AND
 17469*                  PB-C-AH-CANCEL-AMT = +0
 17470        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17471                   PB-C-AH-REF-CALC = +0
 17472           CONTINUE
 17473        WHEN OTHER
 17474           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17475               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17476              CONTINUE
 17477           ELSE
 17478              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17479                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17480                 CONTINUE
 17481              ELSE
 17482                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17483                     MOVE ER-2754   TO  WS-ERROR
 17484                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17485                 ELSE
 17486                     MOVE ER-2736   TO  WS-ERROR
 17487                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17488                 END-IF
 17489              END-IF
 17490           END-IF
 17491     END-EVALUATE.
 17492
 17493     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17494        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17495        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17496           AND  PB-C-LF-REF-CALC < +1.00
 17497           AND  PB-C-AH-REF-CALC < +1.00
 17498           CONTINUE
 17499        ELSE
 17500           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17501              AND (PB-CI-ENTRY-STATUS = 'M')
 17502              CONTINUE
 17503           ELSE
 17504              MOVE ER-2741       TO WS-ERROR
 17505              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17506           END-IF
 17507        END-IF
 17508     END-IF
 17509
 17510     IF (PB-C-LF-CANCEL-AMT = ZERO
 17511        AND WS-LF-BENEFIT-CD NOT = ZERO
 17512        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17513        AND PB-C-LF-REF-CALC NOT = ZERO)
 17514        OR
 17515        (PB-C-LF-CANCEL-AMT = ZERO
 17516        AND WS-LF-BENEFIT-CD NOT = ZERO
 17517        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17518             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17519                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17520                NEXT SENTENCE
 17521             ELSE
 17522                MOVE ER-2739        TO WS-ERROR
 17523                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17524
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 317
* EL050.cbl
 17525     IF (PB-C-AH-CANCEL-AMT = ZERO
 17526        AND WS-AH-BENEFIT-CD NOT = ZERO
 17527        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17528        AND PB-C-AH-REF-CALC NOT = ZERO)
 17529        OR
 17530        (PB-C-AH-CANCEL-AMT = ZERO
 17531        AND WS-AH-BENEFIT-CD NOT = ZERO
 17532        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17533             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17534                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17535                NEXT SENTENCE
 17536             ELSE
 17537                MOVE ER-2738        TO WS-ERROR
 17538                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17539
 17540 3775-OVER-REF-CHK.
 17541
 17542     IF PB-CI-ENTRY-STATUS = '5'
 17543        GO TO 3780-UPDATE-CANCEL-CERT.
 17544
 17545     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17546                              PB-CI-LF-ALT-PREMIUM-AMT.
 17547
 17548     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17549        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17550                                 PB-C-LF-REF-CALC
 17551      ELSE
 17552        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17553                                 PB-C-LF-CANCEL-AMT.
 17554
 17555     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17556        MOVE ER-2755             TO WS-ERROR
 17557        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17558
 17559     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17560
 17561     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17562        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17563                                 PB-C-AH-REF-CALC
 17564      ELSE
 17565        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17566                                 PB-C-AH-CANCEL-AMT.
 17567
 17568     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17569        MOVE ER-2778             TO WS-ERROR
 17570        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17571
 17572     IF PB-CI-OB-FLAG NOT = 'Z'
 17573        NEXT SENTENCE
 17574       ELSE
 17575         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17576            MOVE ER-2757           TO WS-ERROR
 17577            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17578
 17579 3780-UPDATE-CANCEL-CERT.
 17580
 17581     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17582        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 318
* EL050.cbl
 17583        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17584
 17585     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17586         MOVE ER-2729              TO WS-ERROR
 17587         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17588
 17589     IF PB-CI-LF-BENEFIT-CD = ZERO
 17590         GO TO 3780-UPDATE-CONT-1.
 17591
 17592     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17593         GO TO 3780-UPDATE-CONT-1.
 17594
 17595     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17596       AND
 17597        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17598       AND
 17599        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17600       AND
 17601        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17602            NEXT SENTENCE
 17603       ELSE
 17604        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17605          AND
 17606***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17607***       AND
 17608           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17609            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17610               MOVE ER-2730      TO WS-ERROR
 17611               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17612               GO TO 3999-END-EDIT
 17613            ELSE
 17614               GO TO 3999-END-EDIT
 17615        ELSE
 17616            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17617               MOVE ER-2765           TO WS-ERROR
 17618               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17619               GO TO 3785-CHECK-REF-INT.
 17620*              GO TO 3999-END-EDIT.
 17621
 17622 3780-UPDATE-CONT-1.
 17623     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17624
 17625     IF PB-CI-AH-BENEFIT-CD = ZERO
 17626         GO TO 3780-UPDATE-CONT-2.
 17627
 17628     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17629         GO TO 3780-UPDATE-CONT-2.
 17630
 17631     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17632
 17633     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17634       AND
 17635        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17636       AND
 17637        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17638       AND
 17639        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17640            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 319
* EL050.cbl
 17641       ELSE
 17642        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17643          AND
 17644***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17645***       AND
 17646           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17647           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17648            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17649               MOVE ER-2773      TO WS-ERROR
 17650               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17651               GO TO 3999-END-EDIT
 17652            ELSE
 17653               GO TO 3999-END-EDIT
 17654            END-IF
 17655           ELSE
 17656             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17657                IF MSTR-CERT-NO = W-CL-CERT-NO
 17658                   MOVE ER-2890 TO WS-ERROR
 17659                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17660                   GO TO 3999-END-EDIT
 17661                ELSE
 17662                   MOVE ER-2898 TO WS-ERROR
 17663                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17664                   GO TO 3999-END-EDIT
 17665                END-IF
 17666             ELSE
 17667                GO TO 3785-CHECK-REF-INT
 17668             END-IF
 17669           END-IF
 17670          ELSE
 17671            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17672              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17673                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17674                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17675                      MOVE ER-2890 TO WS-ERROR
 17676                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17677                      GO TO 3999-END-EDIT
 17678                   ELSE
 17679                      MOVE ER-2898 TO WS-ERROR
 17680                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17681                      GO TO 3999-END-EDIT
 17682                   END-IF
 17683                ELSE
 17684                   MOVE ER-2765 TO WS-ERROR
 17685                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17686                   GO TO 3785-CHECK-REF-INT
 17687                END-IF
 17688              ELSE
 17689               MOVE ER-2765      TO WS-ERROR
 17690               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17691               GO TO 3785-CHECK-REF-INT.
 17692*              GO TO 3999-END-EDIT.
 17693
 17694 3780-UPDATE-CONT-2.
 17695
 17696     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17697        AND WS-LF-BENEFIT-CD = ZERO
 17698           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 320
* EL050.cbl
 17699           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17700
 17701     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17702        AND WS-AH-BENEFIT-CD = ZERO
 17703           MOVE ER-2744           TO WS-ERROR
 17704           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17705
 17706     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17707        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17708        AND
 17709        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17710         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17711           MOVE ER-2746           TO WS-ERROR
 17712           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17713
 17714     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17715       AND
 17716        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17717             MOVE ER-2737        TO WS-ERROR
 17718             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17719
 17720     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17721       AND
 17722        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17723             MOVE ER-2737        TO WS-ERROR
 17724             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17725
 17726     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17727         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17728             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17729             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17730         ELSE
 17731             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17732                 MOVE ER-2768    TO WS-ERROR
 17733                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17734             ELSE
 17735                 MOVE ER-2756    TO WS-ERROR
 17736                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17737
 17738     IF CERT-PEND-ISSUE-RETURNED
 17739        MOVE ER-2772             TO WS-ERROR
 17740        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17741 3785-CHECK-REF-INT.
 17742*    IF PB-STATE NOT = 'NH' and 'TN'
 17743     IF PB-STATE NOT = 'NH'
 17744        GO TO 3999-END-EDIT
 17745     END-IF
 17746
 17747     MOVE ER-2796                TO WS-ERROR
 17748     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17749     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17750        OR (CM-REF-INTERFACE-SW = 'Y')
 17751        MOVE ER-2793             TO WS-ERROR
 17752        PERFORM 9900-ERROR-FORMAT
 17753                                 THRU 9900-EXIT
 17754     END-IF
 17755     MOVE +0                     TO WS-PAYMENT-AMT
 17756     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 321
* EL050.cbl
 17757        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17758               PB-C-AH-CANCEL-DT
 17759           GO TO 3999-END-EDIT
 17760        END-IF
 17761     end-if
 17762***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17763***-_-
 17764***-_-   For TN it's only flat cancels
 17765***-_-
 17766***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17767     if pb-state = 'TN'
 17768        if ((pb-c-lf-cancel-dt <> low-values)
 17769           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17770                      or
 17771           ((pb-c-ah-cancel-dt <> low-values)
 17772           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17773           GO TO 3999-END-EDIT
 17774        END-IF
 17775     end-if
 17776     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17777        GO TO 3999-END-EDIT
 17778     END-IF
 17779***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17780***-_-
 17781***-_-   if cancel date within 15 days of effective date, bypass
 17782***-_-
 17783***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17784     IF PB-STATE NOT = 'NH'
 17785        GO TO 3785-CONTINUE
 17786     END-IF
 17787     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17788     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17789     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17790        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17791     END-IF
 17792     MOVE '1'                    TO DC-OPTION-CODE
 17793     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17794     IF NO-CONVERSION-ERROR
 17795        IF DC-ELAPSED-DAYS < +16
 17796           GO TO 3999-END-EDIT
 17797        END-IF
 17798     END-IF
 17799***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17800***-_-
 17801***-_-   if cancel date within 30 days of current date then
 17802***-_-   bypass else subtract 15 days from period
 17803***-_-
 17804***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17805     MOVE +0                     TO DC-ELAPSED-DAYS
 17806     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17807     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17808     MOVE '1'                    TO DC-OPTION-CODE
 17809     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17810     IF NO-CONVERSION-ERROR
 17811        IF DC-ELAPSED-DAYS > +30
 17812           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17813        ELSE
 17814           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 322
* EL050.cbl
 17815        END-IF
 17816     ELSE
 17817        GO TO 3999-END-EDIT
 17818     END-IF
 17819     .
 17820 3785-CONTINUE.
 17821     if pb-state = 'TN'
 17822        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17823        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17824        MOVE '1'                 TO DC-OPTION-CODE
 17825        PERFORM 8500-DATE-CONVERT
 17826                                 THRU 8500-EXIT
 17827        IF no-CONVERSION-ERROR
 17828           IF DC-ELAPSED-DAYS < +16
 17829              GO TO 3999-END-EDIT
 17830           END-IF
 17831        END-IF
 17832     end-if
 17833***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17834***-_-
 17835***-_-   'NH' is 10%, TN is 3.5%
 17836***-_-
 17837***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17838*    if pb-state = 'NH'
 17839*       move +1.10               to ws-work-rate
 17840*    else
 17841*       move +1.035              to ws-work-rate
 17842*    end-if
 17843     compute ws-work-rate = (1 + ws-st-refund-int-rate)
 17844     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17845        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17846           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17847     IF WS-PAYMENT-AMT < 10.00
 17848        GO TO 3999-END-EDIT
 17849     END-IF
 17850*    PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17851
 17852     if (cm-soc-sec-no(1:9) numeric)
 17853        and (cm-soc-sec-no(1:9) not = zeros)
 17854        GO TO 3999-END-EDIT
 17855     END-IF
 17856     MOVE ER-2795                TO WS-ERROR
 17857     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17858
 17859     GO TO 3999-END-EDIT.
 17860******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 323
* EL050.cbl
 17862 3990-FILES-NOT-OPEN.
 17863
 17864     MOVE ER-2617                TO WS-ERROR.
 17865     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17866     GO TO 9990-RETURN.
 17867
 17868 3999-END-EDIT.
 17869
 17870     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17871
 17872     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17873         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17874         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17875             PERFORM 9250-UNLOCK-RETURN
 17876             GO TO 9990-RETURN
 17877          ELSE
 17878             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17879             GO TO 9990-RETURN.
 17880
 17881     IF PB-CANCELLATION
 17882          GO TO 9990-RETURN.
 17883
 17884     IF CERT-WAS-NOT-FOUND
 17885        MOVE SPACES              TO CERTIFICATE-MASTER.
 17886
 17887     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17888
 17889     IF CERT-WAS-FOUND
 17890         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17891             PERFORM 9250-UNLOCK-RETURN
 17892          ELSE
 17893            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17894      ELSE
 17895         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17896
 17897*    if pb-company-id = 'VPP'
 17898*       perform 8150-read-elcrtt thru 8150-exit
 17899*       if ws-vehicle-odometer numeric
 17900*          if ws-vehicle-odometer > 6000
 17901*             move er-1583       to ws-error
 17902*             PERFORM 9900-ERROR-FORMAT
 17903*                                THRU 9900-EXIT
 17904*          end-if
 17905*       end-if
 17906*    end-if
 17907     if (pb-cert-sfx not = ' ')
 17908                 or
 17909        (pb-i-entry-status = 'V')
 17910        perform 7320-CHECK-FOR-OPEN-CLMS-issue
 17911                                 thru 7320-exit
 17912     end-if
 17913     perform 8145-read-elcrtt-upd thru 8145-exit
 17914     if not elcrtt-found
 17915        move 'CS'                to certificate-trailers
 17916        move cm-control-primary  to cs-control-primary
 17917        move 'C'                 TO cs-trailer-type
 17918        move zeros               to cs-vehicle-odometer
 17919     end-if
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 324
* EL050.cbl
 17920     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17921        IF ((PB-COMPANY-ID = 'DCC')
 17922           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17923                         or
 17924           (pb-company-id = 'CID' or 'VPP')
 17925           IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
 17926               or (hldi-pass-area not = spaces)
 17927               move pa-modelyear        to cs-year
 17928               move pa-makename         to cs-make
 17929               move pa-modelname        to cs-model
 17930               move pa-seriesname       to cs-future
 17931               MOVE PB-I-VIN            TO CS-VIN-NUMBER
 17932               move 'Y'                 to elcrtt-update-sw
 17933           end-if
 17934        end-if
 17935     end-if
 17936     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17937        IF WS-INS-AGE-SET = 'Y'
 17938           MOVE WS-INS-AGE-DEFAULTED
 17939                                 TO CS-INS-AGE-DEFAULT-FLAG
 17940           move 'Y'              to elcrtt-update-sw
 17941        END-IF
 17942        IF WS-JNT-AGE-SET = 'Y'
 17943           MOVE WS-JNT-AGE-DEFAULTED
 17944                                 TO CS-JNT-AGE-DEFAULT-FLAG
 17945           move 'Y'              to elcrtt-update-sw
 17946        END-IF
 17947     end-if
 17948     IF PB-I-LETTER-REQD = 'Y'
 17949        MOVE ER-1577             TO WS-ERROR
 17950        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17951     ELSE
 17952     IF PB-I-LETTER-REQD = 'N'
 17953        MOVE ER-1584             TO WS-ERROR
 17954        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17955     END-IF.
 17956
 17957     move cs-ins-age-default-flag to ws-ins-age-defaulted
 17958     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 17959     move cs-vehicle-odometer    to ws-vehicle-odometer
 17960     if ws-ins-age-defaulted = 'Y'
 17961        move er-1573             to ws-error
 17962        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17963     end-if
 17964
 17965     if ws-jnt-age-defaulted = 'Y'
 17966        move er-1574             to ws-error
 17967        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17968     end-if
 17969***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17970***                                                           ****
 17971***  Set an error if the state requires verification of agent ****
 17972***  and agent hasn't verified yet and the status is not =    ****
 17973***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17974***  and the entry date > 09/01/2015.                         ****
 17975***                                                           ****
 17976***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17977     if (pb-input-dt >= X'AD81')    *> 09/01/2015
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 325
* EL050.cbl
 17978        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17979        and (pb-account (9:2) not = 'OB')
 17980        if (ws-st-agent-sig-edit = 'Y')
 17981           and (am-report-code-1 not = 'CONLEY')
 17982           evaluate true
 17983              when cs-agent-edit-status = 'C'
 17984                 move er-1743    to ws-error
 17985                 perform 9900-error-format
 17986                                 thru 9900-exit
 17987              when cs-agent-edit-status = 'S'
 17988                 move er-1744    to ws-error
 17989                 perform 9900-error-format
 17990                                 thru 9900-exit
 17991              when cs-agent-edit-status = 'M'
 17992                 move er-1745    to ws-error
 17993                 perform 9900-error-format
 17994                                 thru 9900-exit
 17995              when cs-agent-edit-status = 'R'
 17996                 move er-1747    to ws-error
 17997                 perform 9900-error-format
 17998                                 thru 9900-exit
 17999              when cs-agent-edit-status = 'N'
 18000                 move er-1748    to ws-error
 18001                 perform 9900-error-format
 18002                                 thru 9900-exit
 18003              when cs-agent-edit-status <> 'V' and 'U' and
 18004                                           'R' and 'N' and
 18005                                           'H'
 18006                 move er-1746    to ws-error
 18007                 perform 9900-error-format
 18008                                 thru 9900-exit
 18009           end-evaluate
 18010        end-if
 18011     end-if
 18012*    move ' ' to cs-claim-verification-status
 18013*    move 'Y' to elcrtt-update-sw
 18014     if cs-claim-verification-status = ' ' or 'R'
 18015        move pb-state            to pa-clmhs-state
 18016        move pb-account          to pa-account
 18017        move ws-greg-eff-date    to pa-eff-dt
 18018        move pb-cert-no          to pa-cert-no
 18019        perform 7795-call-sqlclmhs
 18020                                 thru 7795-exit
 18021        if pa-clm-count > 0
 18022           if cs-claim-verification-status = ' '
 18023              move 'R'           to cs-claim-verification-status
 18024*             display 'Updating elcrtt ' pb-state ' '
 18025*                pb-account ' ' pb-cert-no
 18026              move 'Y'           to elcrtt-update-sw
 18027           end-if
 18028        else
 18029           if cs-claim-verification-status = 'R'
 18030              move ' '           to cs-claim-verification-status
 18031              move 'Y'           to elcrtt-update-sw
 18032           end-if
 18033        end-if
 18034     end-if
 18035
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 326
* EL050.cbl
 18036     if cs-claim-verification-status <> ' '
 18037        evaluate true
 18038           when cs-claim-verification-status = 'R'
 18039              move er-1749    to ws-error
 18040              perform 9900-error-format
 18041                              thru 9900-exit
 18042           when cs-claim-verification-status = 'W'
 18043              move er-1750    to ws-error
 18044              perform 9900-error-format
 18045                              thru 9900-exit
 18046           when cs-claim-verification-status = 'I'
 18047              move er-1751    to ws-error
 18048              perform 9900-error-format
 18049                              thru 9900-exit
 18050           when cs-claim-verification-status = 'K'
 18051              move er-1761    to ws-error
 18052              perform 9900-error-format
 18053                              thru 9900-exit
 18054           when cs-claim-verification-status = 'A'
 18055              move er-1752    to ws-error
 18056              perform 9900-error-format
 18057                              thru 9900-exit
 18058           when cs-claim-verification-status = 'B'
 18059              move er-1754    to ws-error
 18060              perform 9900-error-format
 18061                              thru 9900-exit
 18062           when cs-claim-verification-status = 'C'
 18063              move er-1753    to ws-error
 18064              perform 9900-error-format
 18065                              thru 9900-exit
 18066           when cs-claim-verification-status = 'D'
 18067              move er-1757    to ws-error
 18068              perform 9900-error-format
 18069                              thru 9900-exit
 18070           when cs-claim-verification-status = 'E'
 18071              move er-1758    to ws-error
 18072              perform 9900-error-format
 18073                              thru 9900-exit
 18074           when cs-claim-verification-status = 'F'
 18075              move er-1759    to ws-error
 18076              perform 9900-error-format
 18077                              thru 9900-exit
 18078           when cs-claim-verification-status = 'G'
 18079              move er-1760    to ws-error
 18080              perform 9900-error-format
 18081                              thru 9900-exit
 18082*          when cs-claim-verification-status = 'H'
 18083*             move er-1756    to ws-error
 18084*             perform 9900-error-format
 18085*                             thru 9900-exit
 18086*          when cs-claim-verification-status = 'J'
 18087*             move er-1755    to ws-error
 18088*             perform 9900-error-format
 18089*                             thru 9900-exit
 18090        end-evaluate
 18091     end-if
 18092
 18093     IF ELCRTT-UPDATE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 327
* EL050.cbl
 18094        perform 8150-update-elcrtt thru 8150-exit
 18095*       display ' back from 8150 ' elcrtt-file-status
 18096     else
 18097        if elcrtt-found
 18098           perform 8155-unlock-elcrtt
 18099                                 thru 8155-exit
 18100        end-if
 18101     end-if
 18102     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 18103     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 18104        AND (WS-NO-SECURE-PAY))
 18105                  OR
 18106        (WS-LF-SPECIAL-CALC-CD = 'O'
 18107        OR WS-AH-SPECIAL-CALC-CD = 'O')
 18108        SET SKIP-ADDR-EDIT       TO TRUE
 18109     END-IF
 18110     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 18111        AND (NOT SKIP-ADDR-EDIT)
 18112        MOVE ER-2963             TO WS-ERROR
 18113        PERFORM 9900-ERROR-FORMAT
 18114                                 THRU 9900-EXIT
 18115        GO TO 9990-RETURN
 18116     END-IF
 18117     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 18118     IF ERPNDM-FOUND NOT = 'X'
 18119        move 'Y'                 to erpndm-unlock-sw
 18120        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18121           OR (PM-CITY        = SPACES OR LOW-VALUES)
 18122           OR (PM-STATE       = SPACES OR LOW-VALUES)
 18123           OR (PM-ZIP         = SPACES OR LOW-VALUES)
 18124           or (pm-zip-code    = zeros)
 18125           or (pm-zip-code not numeric))
 18126           AND (NOT SKIP-ADDR-EDIT)
 18127           MOVE ER-2694          TO WS-ERROR
 18128           PERFORM 9900-ERROR-FORMAT
 18129                                 THRU 9900-EXIT
 18130        END-IF
 18131        MOVE ' '                 TO STATE-RECORD-ERROR
 18132        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18133        MOVE PM-STATE            TO CNTL-ACCESS
 18134        MOVE '3'                 TO CNTL-REC-TYPE
 18135        MOVE +0                  TO CNTL-SEQ-NO
 18136        MOVE '0'                 TO RC-SW-2
 18137        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18138        IF (NO-STATE-RECORD)
 18139           OR (CF-RECORD-TYPE NOT = '3')
 18140           OR (PM-STATE NOT = CF-STATE-CODE)
 18141           IF (PM-STATE = SPACES)
 18142              AND (SKIP-ADDR-EDIT)
 18143              CONTINUE
 18144           ELSE
 18145              MOVE ER-2963       TO WS-ERROR
 18146              PERFORM 9900-ERROR-FORMAT
 18147                                 THRU 9900-EXIT
 18148           END-IF
 18149        END-IF
 18150        if (ws-error not = er-2963 and er-2694)
 18151           and (pm-city-st-zip-verified = ' ')
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 328
* EL050.cbl
 18152           and (pb-company-id = 'CID')
 18153           move spaces           to zipcd-pass-area
 18154           move pm-zip-code      to pa-zip
 18155           move pm-city          to pa-city
 18156           move pm-state         to pa-state
 18157           perform 7790-call-zip-verify
 18158                                 thru 7790-exit
 18159           if pa-errorcode-zip (1:1) = ' '
 18160                    move 'Y'     to pm-city-st-zip-verified
 18161                    PERFORM 8102-REWRITE-ERPNDM
 18162                                 THRU 8102-EXIT
 18163                    move 'N'     to erpndm-unlock-sw
 18164           else
 18165              MOVE ER-3061       TO WS-ERROR
 18166              PERFORM 9900-ERROR-FORMAT
 18167                                 THRU 9900-EXIT
 18168           end-if
 18169        end-if
 18170        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 18171           MOVE ER-2883          TO WS-ERROR
 18172           PERFORM 9900-ERROR-FORMAT
 18173                                 THRU 9900-EXIT
 18174        END-IF
 18175        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 18176           MOVE ' '                 TO STATE-RECORD-ERROR
 18177           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18178           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 18179           MOVE '3'                 TO CNTL-REC-TYPE
 18180           MOVE +0                  TO CNTL-SEQ-NO
 18181           MOVE '0'                 TO RC-SW-2
 18182           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18183           IF NO-STATE-RECORD
 18184              OR (CF-RECORD-TYPE NOT = '3')
 18185              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 18186              MOVE ER-2964          TO WS-ERROR
 18187              PERFORM 9900-ERROR-FORMAT
 18188                                    THRU 9900-EXIT
 18189           END-IF
 18190        END-IF
 18191     ELSE
 18192        IF NOT SKIP-ADDR-EDIT
 18193           MOVE ER-2393          TO WS-ERROR
 18194           PERFORM 9900-ERROR-FORMAT
 18195                                 THRU 9900-EXIT
 18196        END-IF
 18197     END-IF
 18198     if need-to-unlock-erpndm
 18199        perform 8104-unlock-erpndm
 18200                                 thru 8104-exit
 18201     end-if
 18202     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 18203
 18204     IF (ERMAIL-FOUND = ' ' AND
 18205        ERPNDM-FOUND = ' ')
 18206        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 18207           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 18208           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 18209          OR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 329
* EL050.cbl
 18210           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 18211          OR
 18212           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 18213           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 18214           GO TO 3999-UNLOCK-ERMAIL.
 18215
 18216     IF ERPNDM-FOUND = 'X'
 18217        GO TO 3999-UNLOCK-ERMAIL.
 18218
 18219     IF PM-INSURED-LAST-NAME      = SPACES
 18220        AND PM-INSURED-FIRST-NAME = SPACES
 18221        AND PM-ADDRESS-LINE-1     = SPACES
 18222        AND PM-ADDRESS-LINE-2     = SPACES
 18223        AND PM-CITY-STATE         = SPACES
 18224        AND PM-CRED-BENE-NAME     = SPACES
 18225        AND PM-CRED-BENE-ADDR     = SPACES
 18226        AND PM-CRED-BENE-CTYST    = SPACES
 18227        GO TO 3999-UNLOCK-ERMAIL
 18228     END-IF
 18229
 18230     MOVE SPACES                 TO MAILING-DATA.
 18231
 18232     MOVE 'MA'                   TO MA-RECORD-ID.
 18233     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 18234     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 18235     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 18236     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 18237     MOVE PB-SV-STATE            TO MA-STATE.
 18238     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 18239     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 18240
 18241     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 18242     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 18243
 18244     IF ERMAIL-FOUND = ' '
 18245        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 18246     ELSE
 18247        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 18248        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 18249        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 18250
 18251     GO TO 9990-RETURN.
 18252
 18253 3999-UNLOCK-ERMAIL.
 18254     IF ERMAIL-FOUND = ' '
 18255        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 18256
 18257     GO TO 9990-RETURN.
 18258******************************************************************
 18259
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 330
* EL050.cbl
 18261 4000-UPDATE-CANCELLED-CERT.
 18262     IF CERT-WAS-NOT-FOUND
 18263        GO TO 4299-EXIT.
 18264
 18265*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 18266     IF PB-C-INT-ON-REFS > ZEROS
 18267        MOVE PB-C-INT-ON-REFS TO CM-INT-ON-REFS
 18268     END-IF
 18269     IF PB-C-REF-INTERFACE-SW = 'Y'
 18270        MOVE PB-C-REF-INTERFACE-SW
 18271                                 TO CM-ref-INTERFACE-SW
 18272     END-IF
 18273*    IF ERMAIL-FOUND = ' '
 18274*       PERFORM 8140-UNLOCK-ERMAIL
 18275*                                THRU 8140-EXIT
 18276*    end-if
 18277     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18278     IF ERMAIL-FOUND = 'X'
 18279        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18280        OR (MA-CITY        = SPACES OR LOW-VALUES)
 18281        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 18282        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 18283           MOVE ER-2694          TO WS-ERROR
 18284           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18285     END-IF
 18286
 18287     IF PB-C-POST-CARD-IND = 'Y'
 18288        MOVE +8                  TO SUB
 18289*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18290        IF ERMAIL-FOUND = ' '
 18291           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 18292              (SUB > +7)
 18293              OR (MA-MAIL-STATUS (SUB) = '1')
 18294           END-PERFORM
 18295        END-IF
 18296        IF (SUB > +7)
 18297           OR (ERMAIL-FOUND = 'X')
 18298           MOVE ER-3789          TO WS-ERROR
 18299           PERFORM 9900-ERROR-FORMAT
 18300                                 THRU 9900-EXIT
 18301        END-IF
 18302     ELSE
 18303        MOVE 'N'                 TO PB-C-POST-CARD-IND
 18304     END-IF
 18305
 18306     IF ERMAIL-FOUND = ' '
 18307        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 18308     END-IF.
 18309
 18310     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 18311
 18312     IF PB-CI-OB-FLAG = 'Z'
 18313        GO TO 4150-SUMMARY-CERT-CANCEL.
 18314     perform 8145-read-elcrtt-upd thru 8145-exit
 18315     if not elcrtt-found
 18316        move 'CS'                to certificate-trailers
 18317        move cm-control-primary  to cs-control-primary
 18318        move 'C'                 TO cs-trailer-type
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 331
* EL050.cbl
 18319        move zeros               to cs-vehicle-odometer
 18320     end-if
 18321
 18322     if pb-lf-refund-type <> cs-lf-refund-method
 18323        move pb-lf-refund-type   to cs-lf-refund-method
 18324        set elcrtt-update to true
 18325     end-if
 18326     if pb-ah-refund-type <> cs-ah-refund-method
 18327        move pb-ah-refund-type   to cs-ah-refund-method
 18328        set elcrtt-update to true
 18329     end-if
 18330     IF PB-C-LF-CANCEL-VOIDED
 18331         PERFORM 4200-REVERSE-LF-CANCEL.
 18332     IF PB-C-AH-CANCEL-VOIDED
 18333         PERFORM 4200-REVERSE-AH-CANCEL.
 18334     IF ELCRTT-UPDATE
 18335        perform 8150-update-elcrtt thru 8150-exit
 18336     else
 18337        if elcrtt-found
 18338           perform 8155-unlock-elcrtt
 18339                                 thru 8155-exit
 18340        end-if
 18341     end-if
 18342     .
 18343 4100-APPLY-LF-CANCEL.
 18344
 18345     MOVE +0                     TO WS-SUB.
 18346
 18347 4100-CHECK-LF-ERRORS.
 18348
 18349     ADD +1                       TO WS-SUB.
 18350
 18351     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18352        IF LF-COVERAGE-CANCELLED
 18353           GO TO 4100-LF-CANCEL-CONT
 18354        ELSE
 18355           GO TO 4100-UPDATE-LF-COVERAGE.
 18356
 18357     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18358                                   ER-2729 OR
 18359                                   ER-2730 OR
 18360                                   ER-2731 OR
 18361                                   ER-2732 OR
 18362                                   ER-2737 OR
 18363                                   ER-2740 OR
 18364                                   ER-2743 OR
 18365                                   ER-2749 OR
 18366                                   ER-2750 OR
 18367                                   ER-2755 OR
 18368                                   ER-2757 OR
 18369                                   ER-2760 OR
 18370                                   ER-2772 OR
 18371                                   ER-2774 OR
 18372                                   ER-2776 OR
 18373                                   ER-2794
 18374        GO TO 4100-UPDATE-LF-COVERAGE.
 18375
 18376     GO TO 4100-CHECK-LF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 332
* EL050.cbl
 18377
 18378 4100-UPDATE-LF-COVERAGE.
 18379
 18380     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 18381     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 18382     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 18383        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 18384     END-IF
 18385     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18386                                      TO CM-CREDIT-INTERFACE-SW-2.
 18387     IF CM-LF-CANCEL-DT = LOW-VALUE
 18388         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 18389
 18390     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 18391         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 18392                                         CM-LF-STATUS-AT-CANCEL.
 18393
 18394     GO TO 4100-APPLY-AH-CANCEL.
 18395
 18396 4100-LF-CANCEL-CONT.
 18397     IF PB-C-LF-CANCEL-VOIDED
 18398         GO TO 4100-APPLY-AH-CANCEL.
 18399
 18400     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18401         GO TO 4100-APPLY-AH-CANCEL.
 18402
 18403     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 18404        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18405           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 18406        ELSE
 18407           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 18408
 18409     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 18410     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 18411
 18412     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 18413         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 18414
 18415     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 18416        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 18417         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 18418         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 18419
 18420     IF PB-RECORD-RETURNED
 18421        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18422      ELSE
 18423        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 18424
 18425 4100-APPLY-AH-CANCEL.
 18426
 18427     MOVE +0                      TO WS-SUB.
 18428
 18429 4100-CHECK-AH-ERRORS.
 18430
 18431     ADD +1                       TO WS-SUB.
 18432
 18433     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18434        IF AH-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 333
* EL050.cbl
 18435           GO TO 4100-AH-CANCEL-CONT
 18436        ELSE
 18437           GO TO 4100-UPDATE-AH-COVERAGE.
 18438
 18439     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18440                                   ER-2729 OR
 18441                                   ER-2732 OR
 18442                                   ER-2737 OR
 18443                                   ER-2740 OR
 18444                                   ER-2744 OR
 18445                                   ER-2749 OR
 18446                                   ER-2750 OR
 18447                                   ER-2755 OR
 18448                                   ER-2757 OR
 18449                                   ER-2760 OR
 18450                                   ER-2771 OR
 18451                                   ER-2772 OR
 18452                                   ER-2773 OR
 18453                                   ER-2775 OR
 18454                                   ER-2777 OR
 18455                                   ER-2778 OR
 18456                                   ER-2794
 18457        GO TO 4100-UPDATE-AH-COVERAGE.
 18458
 18459     GO TO 4100-CHECK-AH-ERRORS.
 18460
 18461 4100-UPDATE-AH-COVERAGE.
 18462
 18463     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 18464     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 18465     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 18466     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18467                                      TO CM-CREDIT-INTERFACE-SW-2.
 18468     IF CM-AH-CANCEL-DT = LOW-VALUE
 18469         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 18470
 18471     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 18472         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 18473                                         CM-AH-STATUS-AT-CANCEL.
 18474
 18475     IF LF-COVERAGE-CANCELLED
 18476         IF PB-RECORD-RETURNED
 18477              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 18478          ELSE
 18479              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 18480
 18481     GO TO 4299-EXIT.
 18482
 18483 4100-AH-CANCEL-CONT.
 18484     IF PB-C-AH-CANCEL-VOIDED
 18485         GO TO 4299-EXIT.
 18486
 18487     if cm-credit-interface-sw-2 = ' '
 18488        if pb-fatal-errors or pb-unforced-errors
 18489           move '4'              to cm-credit-interface-sw-2
 18490        else
 18491           move '1'              to cm-credit-interface-sw-2
 18492        end-if
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 334
* EL050.cbl
 18493     end-if
 18494     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18495         GO TO 4299-EXIT.
 18496
 18497     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 18498        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18499           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 18500        ELSE
 18501           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 18502
 18503     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 18504     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 18505
 18506     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 18507         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 18508
 18509     IF CM-AH-STATUS-AT-CANCEL = SPACE
 18510         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 18511         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 18512
 18513     IF PB-RECORD-RETURNED
 18514        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 18515      ELSE
 18516        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 18517
 18518     GO TO 4299-EXIT.
 18519
 18520 4150-SUMMARY-CERT-CANCEL.
 18521     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 18522
 18523     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18524        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18525                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 18526     ELSE
 18527        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18528                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 18529
 18530     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18531        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18532                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 18533     ELSE
 18534        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18535                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 18536
 18537     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 18538        NEXT SENTENCE
 18539     ELSE
 18540        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 18541
 18542     GO TO 4299-EXIT.
 18543
 18544 4200-REVERSE-LF-CANCEL.
 18545     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 18546
 18547     IF CM-LF-CANCEL-APPLIED
 18548        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 18549        MOVE SPACES                TO CM-LF-EXIT-BATCH
 18550        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 335
* EL050.cbl
 18551
 18552     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 18553
 18554     IF PB-RECORD-RETURNED
 18555        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18556       ELSE
 18557        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18558
 18559 4200-REVERSE-LF-EXIT.
 18560       EXIT.
 18561
 18562 4200-REVERSE-AH-CANCEL.
 18563     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 18564
 18565     IF CM-AH-CANCEL-APPLIED
 18566        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 18567        MOVE SPACES                TO CM-AH-EXIT-BATCH
 18568        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 18569
 18570     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 18571
 18572     IF PB-RECORD-RETURNED
 18573        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18574       ELSE
 18575        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18576
 18577 4200-REVERSE-AH-EXIT.
 18578       EXIT.
 18579
 18580 4299-EXIT.
 18581       EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 336
* EL050.cbl
 18583
 18584 4500-UPDATE-NEW-CERT.
 18585     IF CERT-WAS-FOUND
 18586         NEXT SENTENCE
 18587       ELSE
 18588         GO TO 4520-BUILD-NEW-KEY.
 18589
 18590     IF  CLASIC-CREATED-CERT
 18591         GO TO 4999-EXIT.
 18592
 18593     IF  CERT-WAS-CREATED-FOR-CLAIM
 18594         GO TO 4520-BUILD-NEW-KEY.
 18595
 18596     IF CERT-ADDED-BATCH
 18597        IF CM-RECORD-ID = 'CM'
 18598            GO TO 4999-EXIT.
 18599
 18600 4520-BUILD-NEW-KEY.
 18601* BUILD CONTROL PRIMARY
 18602
 18603     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 18604                                       CM-COMPANY-CD-A1
 18605                                       CM-COMPANY-CD-A2
 18606                                       CM-COMPANY-CD-A4
 18607                                       CM-COMPANY-CD-A5.
 18608
 18609     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 18610     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 18611     MOVE PB-SV-STATE               TO CM-STATE.
 18612     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 18613     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 18614     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 18615     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 18616
 18617     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 18618
 18619     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 18620     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 18621     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 18622     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 18623
 18624     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 18625        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 18626
 18627     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 18628         MOVE PB-SV-STATE            TO CM-SSN-STATE
 18629         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 18630         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 18631         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 18632     ELSE
 18633         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 18634
 18635     IF PB-COMPANY-ID   EQUAL  'CRI'
 18636         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 18637         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 18638         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 18639         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 18640         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 337
* EL050.cbl
 18641
 18642     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 18643        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18644         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 18645
 18646     IF PB-COMPANY-ID  = 'LBL'
 18647        IF PB-I-JOINT-COVERAGE
 18648            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18649                                           PB-I-MEMBER-NO
 18650            GO TO 4550-CONT-CERT-PROCESS.
 18651
 18652     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18653        NEXT SENTENCE
 18654     ELSE
 18655        GO TO 4540-BUILD-MEMBER-NO.
 18656
 18657******************************************************************
 18658*                                                                *
 18659*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18660*    FOR 'MON'.                                                  *
 18661*                                                                *
 18662******************************************************************
 18663
 18664     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18665     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18666     MOVE +1                     TO WS-SUB1
 18667                                    WS-SUB2.
 18668
 18669 4530-EDIT-MEMB-NAME.
 18670
 18671     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18672        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18673        ADD +1                       TO WS-SUB2.
 18674
 18675     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18676        ADD +1                       TO WS-SUB1
 18677        GO TO 4530-EDIT-MEMB-NAME.
 18678
 18679     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18680     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18681     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18682*    MOVE SPACE                      TO DC-OPTION-CODE.
 18683     SET  BIN-TO-GREG                TO TRUE.
 18684     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18685     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18686
 18687     GO TO 4550-CONT-CERT-PROCESS.
 18688
 18689******************************************************************
 18690*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18691******************************************************************
 18692
 18693 4540-BUILD-MEMBER-NO.
 18694
 18695     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18696         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18697         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18698         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 338
* EL050.cbl
 18699         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18700     ELSE
 18701         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18702
 18703     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18704        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18705         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18706
 18707 4550-CONT-CERT-PROCESS.
 18708
 18709*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18710*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18711*    ELSE
 18712*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18713
 18714     IF CERT-WAS-CREATED-FOR-CLAIM
 18715        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18716        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18717
 18718     IF CERT-AND-CLAIM-ONLINE
 18719        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18720        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18721
 18722     MOVE 'CM'                     TO CM-RECORD-ID.
 18723     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18724
 18725     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18726        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18727        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18728     ELSE
 18729        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18730        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18731
 18732     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18733     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18734     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18735     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18736     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18737     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18738     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18739                                      CM-LF-ITD-CANCEL-AMT
 18740                                      CM-LF-ITD-DEATH-AMT
 18741                                      CM-AH-ITD-AH-PMT
 18742                                      CM-AH-ITD-LUMP-PMT
 18743                                      CM-AH-ITD-CANCEL-AMT
 18744                                      CM-LF-NSP-PREMIUM-AMT
 18745                                      CM-AH-NSP-PREMIUM-AMT.
 18746*                                     CM-CLAIM-DEDUCT-WITHHELD
 18747*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18748     if pb-i-loan-apr = +99.9999
 18749        move zeros                 to cm-loan-apr
 18750     else
 18751        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18752     end-if
 18753     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18754     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18755     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18756     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 339
* EL050.cbl
 18757     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18758     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18759     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18760     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18761     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18762     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18763     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18764
 18765     IF PB-I-LIVES NOT NUMERIC
 18766         MOVE ZERO                 TO PB-I-LIVES.
 18767
 18768     IF PB-I-NUM-BILLED NOT NUMERIC
 18769         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18770
 18771     MOVE PB-I-LIVES               TO CM-LIVES.
 18772     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18773
 18774     IF PB-COMPANY-ID EQUAL  'DMD'
 18775         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18776         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18777
 18778     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18779     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18780     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18781     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18782     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18783     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18784
 18785     IF PB-I-LF-POLICY-FEE NUMERIC
 18786        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18787     ELSE
 18788        MOVE +0                    TO CM-LF-POLICY-FEE.
 18789
 18790     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18791        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18792        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18793     ELSE
 18794        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18795
 18796     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18797     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18798     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18799     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18800     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18801     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18802     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18803     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18804     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18805
 18806     IF PB-I-CANCEL-FEE NUMERIC
 18807        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18808     ELSE
 18809        MOVE +0                  TO CM-CANCEL-FEE
 18810     END-IF
 18811
 18812     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18813        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18814     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 340
* EL050.cbl
 18815        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18816
 18817     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18818     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18819
 18820     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18821                                      CM-LF-DEATH-EXIT-DT
 18822                                      CM-AH-SETTLEMENT-EXIT-DT.
 18823
 18824*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18825*                       'TIH' OR 'OFL' OR 'FLA' OR
 18826*                       'TII' OR 'TMS' OR 'CRI' OR
 18827*                       'NCL'
 18828     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18829
 18830     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18831         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18832            MOVE '2'                TO CM-PREMIUM-TYPE.
 18833
 18834     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18835         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18836            MOVE '2'                TO CM-PREMIUM-TYPE.
 18837
 18838     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18839         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18840     ELSE
 18841         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18842         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18843
 18844     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18845     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18846     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18847     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18848     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18849     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18850     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18851     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18852
 18853     IF PB-NO-MONTHS-SKIPPED
 18854         MOVE SPACE                 TO CM-SKIP-CODE
 18855     ELSE
 18856         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18857
 18858     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18859     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18860                                       CM-LF-STATUS-AT-CANCEL.
 18861
 18862     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18863     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18864                                       CM-AH-STATUS-AT-CANCEL.
 18865
 18866     MOVE '1'                       TO CM-ENTRY-STATUS.
 18867
 18868     IF PB-REISSUED-CERT
 18869        MOVE '5'                    TO CM-ENTRY-STATUS.
 18870
 18871     IF PB-MONTHLY-CERT
 18872        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 341
* EL050.cbl
 18873
 18874     IF PB-CASH-CERT
 18875        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18876
 18877     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18878     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18879     IF PB-POLICY-IS-DECLINED
 18880        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18881
 18882     IF PB-POLICY-IS-VOIDED
 18883        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18884
 18885     IF PB-NEEDS-UNDERWRITING
 18886        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18887
 18888     IF PB-REIN-ONLY-CERT
 18889        MOVE '9'                    TO CM-ENTRY-STATUS.
 18890
 18891     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18892         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18893     ELSE
 18894         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18895
 18896     IF PB-RECORD-RETURNED
 18897        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18898      ELSE
 18899        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18900
 18901     IF PB-I-MAIL-ADDRS-PRESENT
 18902        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18903
 18904     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18905                                       CM-ENTRY-DT.
 18906
 18907 4999-EXIT.
 18908     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 342
* EL050.cbl
 18910
 18911 5000-PROCESS-REPS.
 18912     MOVE ' '                    TO AGTC-MASTER-SW
 18913     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18914     MOVE CO-TYPE                TO AGTC-TYPE
 18915     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18916     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18917     IF (AGTC-MASTER-SW NOT = 'N')
 18918        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18919        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18920        PERFORM 8583-READ-ERAGTC-NEXT
 18921                                 THRU 8583-EXIT
 18922     END-IF
 18923     IF AGTC-MASTER-SW = 'N'
 18924        CONTINUE
 18925     ELSE
 18926        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18927           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18928              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18929              MOVE 'Y'           TO AGTC-MASTER-SW
 18930           END-IF
 18931        END-IF
 18932     END-IF
 18933     .
 18934 5000-EXIT.
 18935     EXIT.
 18936 6370-EDIT-INPUT-LF-CODE.
 18937     move ' ' to ws-benefit-cd-chg-sw
 18938     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18939        MOVE +1                  TO SUB
 18940        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18941        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18942        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18943        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18944        GO TO 6370-SEARCH-LOOP.
 18945
 18946     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18947
 18948     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18949     MOVE SPACES                 TO CNTL-ACCESS.
 18950*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18951     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18952     MOVE +0                     TO CNTL-SEQ-NO.
 18953     MOVE '4' TO RC-SW-2.
 18954     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18955
 18956     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18957        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18958        GO TO 6370-NO-LF-FOUND.
 18959
 18960     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18961     MOVE +1                     TO SUB.
 18962
 18963 6370-SEARCH-LOOP.
 18964     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18965         GO TO 6370-NO-LF-FOUND.
 18966
 18967     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 343
* EL050.cbl
 18968        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18969           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18970           set benefit-code-chg to true
 18971        end-if
 18972        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18973        GO TO 6370-HER-NET-PAY-CHECK.
 18974
 18975     ADD 1   TO SUB.
 18976*    IF SUB GREATER 120
 18977     IF SUB GREATER 200
 18978         GO TO 6370-NO-LF-FOUND.
 18979
 18980     GO TO 6370-SEARCH-LOOP.
 18981
 18982 6370-NO-LF-FOUND.
 18983
 18984     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18985        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18986        set benefit-code-chg to true
 18987     end-if
 18988     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18989
 18990 6370-HER-NET-PAY-CHECK.
 18991
 18992     IF PB-COMPANY-ID = 'CID'
 18993        IF PB-SV-STATE = 'CA' OR 'MN'
 18994           IF PB-I-LF-BENEFIT-CD = '02'
 18995              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18996           ELSE
 18997              IF PB-I-LF-BENEFIT-CD = '04'
 18998                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18999              END-IF
 19000           END-IF
 19001        END-IF
 19002     END-IF
 19003
 19004     IF PB-COMPANY-ID NOT = 'HER'
 19005         GO TO 6370-EXIT.
 19006
 19007     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 19008         GO TO 6370-EXIT.
 19009
 19010     IF PB-I-LF-TERM NOT NUMERIC
 19011         MOVE ZEROS              TO PB-I-LF-TERM.
 19012
 19013     IF PB-I-LOAN-TERM NOT NUMERIC
 19014         MOVE ZEROS              TO PB-I-LOAN-TERM.
 19015
 19016     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 19017         GO TO 6370-EXIT.
 19018
 19019     IF PB-I-LF-BENEFIT-CD = '33'
 19020         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 19021
 19022     IF PB-I-LF-BENEFIT-CD = '34'
 19023         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 19024
 19025 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 344
* EL050.cbl
 19026     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 345
* EL050.cbl
 19028
 19029 6380-EDIT-INPUT-AH-CODE.
 19030     IF WK-AH-EDIT-ADDR NOT = ZEROS
 19031        MOVE +1                  TO SUB
 19032        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 19033        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 19034        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 19035        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 19036        GO TO 6380-SEARCH-LOOP.
 19037
 19038     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 19039
 19040     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 19041     MOVE SPACES                 TO CNTL-ACCESS.
 19042     MOVE 'A'                    TO CNTL-REC-TYPE.
 19043*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 19044     MOVE +0                     TO CNTL-SEQ-NO.
 19045     MOVE '5' TO RC-SW-2.
 19046     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 19047
 19048     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 19049        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 19050        GO TO 6380-NO-AH-FOUND.
 19051
 19052     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 19053     MOVE +1 TO SUB.
 19054
 19055 6380-SEARCH-LOOP.
 19056     IF CF-AH-CODE-OUT (SUB) = ZEROS
 19057         GO TO 6380-NO-AH-FOUND.
 19058
 19059     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 19060         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 19061         GO TO 6380-CSO-AH-ONLY-CHECKS.
 19062
 19063     ADD 1   TO SUB.
 19064     IF SUB GREATER THAN 96
 19065*    IF SUB GREATER THAN 300
 19066         GO TO 6380-NO-AH-FOUND.
 19067
 19068     GO TO 6380-SEARCH-LOOP.
 19069
 19070 6380-NO-AH-FOUND.
 19071
 19072     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 19073
 19074     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 19075         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 19076     ELSE
 19077         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 19078
 19079 6380-CSO-AH-ONLY-CHECKS.
 19080
 19081     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 19082        NEXT SENTENCE
 19083      ELSE
 19084        GO TO 6380-EXIT.
 19085
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 346
* EL050.cbl
 19086     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 19087         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 19088
 19089
 19090     GO TO 6380-EXIT
 19091     .
 19092 6380-CSO-LIFE-WITH-AH-CHECKS.
 19093
 19094
 19095     .
 19096 6380-EXIT.
 19097     EXIT.
 19098
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 347
* EL050.cbl
 19100
 19101 6400-COMPUTE-EXTENSION-DAYS.
 19102
 19103******************************************************************
 19104*                                                                *
 19105*                   COMPUTE EXTENSION DAYS                       *
 19106*                                                                *
 19107*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 19108*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 19109*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 19110*    THE EXTENSION DAYS.                                         *
 19111*                                                                *
 19112******************************************************************
 19113
 19114     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 19115     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 19116
 19117******************************************************************
 19118*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 19119*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 19120******************************************************************
 19121
 19122     IF DC-ELAPSED-MONTHS GREATER THAN +0
 19123        COMPUTE WS-ODD-DAYS-OVER =
 19124               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 19125     ELSE
 19126        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 19127
 19128     IF WS-ODD-DAYS-OVER = ZEROS
 19129           GO TO 6499-EXIT
 19130     ELSE
 19131        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 19132           IF WS-WDF-MONTH = 02
 19133              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 19134              ADD 2       TO  WS-ODD-DAYS-OVER
 19135              GO TO 6499-EXIT
 19136           ELSE
 19137              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 19138                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 19139                 GO TO 6499-EXIT
 19140               ELSE
 19141                 GO TO 6499-EXIT
 19142        ELSE
 19143           GO TO 6499-EXIT.
 19144
 19145 6412-CHECK-TO-DAY.
 19146
 19147        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 19148           IF WS-WDT-DAY = 28
 19149              ADD 2              TO WS-ODD-DAYS-OVER
 19150           ELSE
 19151              IF WS-WDT-DAY = 29
 19152                 ADD 1           TO WS-ODD-DAYS-OVER
 19153              ELSE
 19154                 NEXT SENTENCE
 19155        ELSE
 19156           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 19157              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 348
* EL050.cbl
 19158
 19159     GO TO 6499-EXIT.
 19160
 19161
 19162 6415-CHECK-LEAP-YEAR.
 19163
 19164     IF DC-DAYS-IN-MONTH = 29
 19165        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 19166
 19167 6415-EXIT.
 19168     EXIT.
 19169
 19170 6499-EXIT.
 19171      EXIT.
 19172
 19173 6500-END.
 19174     EXIT.
 19175
 19176
 19177******************************************************************
 19178************* PROCEDURE DIVISION FOR EL050 ***********************
 19179********************** ELC50PD END *******************************
 19180
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 349
* EL050.cbl
 19182
 19183**START***********************************************************
 19184*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 19185*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 19186******************************************************************
 19187*
 19188 6600-GET-STATE-MUNICIPAL-TAX.
 19189
 19190     IF PB-COMPANY-ID NOT = 'DMD'
 19191         GO TO 6640-EXIT.
 19192
 19193     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 19194     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 19195     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 19196*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 19197*
 19198***  Y2K PROJ 7744
 19199     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19200     SET BIN-TO-GREG          TO TRUE.
 19201     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19202
 19203     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19204
 19205     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 19206     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 19207
 19208
 19209* EXEC CICS HANDLE CONDITION
 19210*        INVREQ    (6610-START-BROWSE)
 19211*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19212*        NOTFND    (6630-END-OF-FILE)
 19213*    END-EXEC.
 19214*    MOVE '"$8JI                 ! # #00019198' TO DFHEIV0
 19215     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 19216     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19217     MOVE X'2320233030303139313938' TO DFHEIV0(25:11)
 19218     CALL 'kxdfhei1' USING DFHEIV0
 19219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19220
 19221
 19222 6610-START-BROWSE.
 19223
 19224
 19225* EXEC CICS HANDLE CONDITION
 19226*        NOTFND    (6630-END-OF-FILE)
 19227*        DISABLED  (6630-ERRESS-PROBLEM)
 19228*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19229*        ENDFILE   (6630-END-OF-FILE)
 19230*    END-EXEC.
 19231*    MOVE '"$IcJ''                ! $ #00019206' TO DFHEIV0
 19232     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19233     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19234     MOVE X'2420233030303139323036' TO DFHEIV0(25:11)
 19235     CALL 'kxdfhei1' USING DFHEIV0
 19236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19237
 19238
 19239
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 350
* EL050.cbl
 19240* EXEC CICS STARTBR
 19241*        DATASET (FILE-ID-ERRESS)
 19242*        RIDFLD  (WS-ERRESS-KEY)
 19243*        GTEQ
 19244*    END-EXEC.
 19245     MOVE 0
 19246       TO DFHEIV11
 19247*    MOVE '&,         G          &   #00019213' TO DFHEIV0
 19248     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19249     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19250     MOVE X'2020233030303139323133' TO DFHEIV0(25:11)
 19251     CALL 'kxdfhei1' USING DFHEIV0,
 19252           FILE-ID-ERRESS,
 19253           WS-ERRESS-KEY,
 19254           DFHEIV99,
 19255           DFHEIV11,
 19256           DFHEIV99
 19257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19258
 19259
 19260 6620-READ-NEXT-ERRESS-MASTER.
 19261
 19262
 19263* EXEC CICS HANDLE CONDITION
 19264*        NOTFND    (6630-END-OF-FILE)
 19265*        ENDFILE   (6630-END-OF-FILE)
 19266*        DISABLED  (6630-ERRESS-PROBLEM)
 19267*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19268*    END-EXEC.
 19269*    MOVE '"$I''cJ                ! % #00019221' TO DFHEIV0
 19270     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 19271     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19272     MOVE X'2520233030303139323231' TO DFHEIV0(25:11)
 19273     CALL 'kxdfhei1' USING DFHEIV0
 19274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19275
 19276
 19277
 19278* EXEC CICS READNEXT
 19279*        DATASET (FILE-ID-ERRESS)
 19280*        INTO    (RESIDENT-STATE-TAX-MASTER)
 19281*        RIDFLD  (WS-ERRESS-KEY)
 19282*    END-EXEC.
 19283     MOVE LENGTH OF
 19284      RESIDENT-STATE-TAX-MASTER
 19285       TO DFHEIV12
 19286     MOVE 0
 19287       TO DFHEIV11
 19288*    MOVE '&.IL                  )   #00019228' TO DFHEIV0
 19289     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19290     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19291     MOVE X'2020233030303139323238' TO DFHEIV0(25:11)
 19292     CALL 'kxdfhei1' USING DFHEIV0,
 19293           FILE-ID-ERRESS,
 19294           RESIDENT-STATE-TAX-MASTER,
 19295           DFHEIV12,
 19296           WS-ERRESS-KEY,
 19297           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 351
* EL050.cbl
 19298           DFHEIV11,
 19299           DFHEIV99,
 19300           DFHEIV99
 19301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19302
 19303
 19304     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 19305
 19306* EXEC CICS ENDBR
 19307*            DATASET (FILE-ID-ERRESS)
 19308*       END-EXEC
 19309     MOVE 0
 19310       TO DFHEIV11
 19311*    MOVE '&2                    $   #00019235' TO DFHEIV0
 19312     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19313     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19314     MOVE X'2020233030303139323335' TO DFHEIV0(25:11)
 19315     CALL 'kxdfhei1' USING DFHEIV0,
 19316           FILE-ID-ERRESS,
 19317           DFHEIV11,
 19318           DFHEIV99
 19319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19320        GO TO 6630-END-OF-FILE.
 19321
 19322     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 19323        NEXT SENTENCE
 19324      ELSE
 19325        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 19326
 19327*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19328*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 19329*
 19330     MOVE +2                     TO WS-SUB1.
 19331
 19332     IF PB-ISSUE
 19333     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19334        MOVE +1                  TO WS-SUB1.
 19335
 19336     IF PB-CANCELLATION
 19337     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19338        MOVE +1                  TO WS-SUB1.
 19339*
 19340*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19341*
 19342***  Y2K PROJ 7744
 19343     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 19344***  Y2K PROJ 7744
 19345
 19346*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19347* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19348* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 19349
 19350     ADD 1                    TO WS-YEAR-YY.
 19351
 19352     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19353         MOVE RES-REN-STATE-TAX (WS-SUB1)
 19354                              TO WS-RES-STATE-TAX
 19355         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 352
* EL050.cbl
 19356                              TO WS-RES-MUNI-TAX
 19357     ELSE
 19358         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19359                              TO WS-RES-STATE-TAX
 19360         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19361                              TO WS-RES-MUNI-TAX.
 19362
 19363*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19364
 19365     IF PB-CANCELLATION
 19366         GO TO 6640-CANCEL-TAX.
 19367
 19368     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19369         COMPUTE PB-I-STATE-TAX ROUNDED =
 19370                                   PB-I-LF-PREMIUM-AMT
 19371                                 * WS-RES-STATE-TAX
 19372         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19373                                   PB-I-LF-PREMIUM-AMT
 19374                                 * WS-RES-MUNI-TAX
 19375     ELSE
 19376     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19377         COMPUTE PB-I-STATE-TAX ROUNDED =
 19378                                   PB-I-AH-PREMIUM-AMT
 19379                                 * WS-RES-STATE-TAX
 19380         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19381                                   PB-I-AH-PREMIUM-AMT
 19382                                 * WS-RES-MUNI-TAX.
 19383
 19384
 19385* EXEC CICS ENDBR
 19386*         DATASET (FILE-ID-ERRESS)
 19387*    END-EXEC.
 19388     MOVE 0
 19389       TO DFHEIV11
 19390*    MOVE '&2                    $   #00019302' TO DFHEIV0
 19391     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19392     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19393     MOVE X'2020233030303139333032' TO DFHEIV0(25:11)
 19394     CALL 'kxdfhei1' USING DFHEIV0,
 19395           FILE-ID-ERRESS,
 19396           DFHEIV11,
 19397           DFHEIV99
 19398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19399
 19400
 19401     GO TO 6640-EXIT.
 19402
 19403 6640-CANCEL-TAX.
 19404     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19405
 19406     IF PB-C-LF-CANCEL-AMT > ZEROS
 19407         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19408                                   PB-C-LF-CANCEL-AMT
 19409                                 * WS-RES-STATE-TAX
 19410         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19411                                   PB-C-LF-CANCEL-AMT
 19412                                *  WS-RES-MUNI-TAX
 19413     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 353
* EL050.cbl
 19414     IF PB-C-AH-CANCEL-AMT > ZEROS
 19415         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19416                                   PB-C-AH-CANCEL-AMT
 19417                                 * WS-RES-STATE-TAX
 19418         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19419                                   PB-C-AH-CANCEL-AMT
 19420                                *  WS-RES-MUNI-TAX.
 19421
 19422
 19423* EXEC CICS ENDBR
 19424*         DATASET (FILE-ID-ERRESS)
 19425*    END-EXEC.
 19426     MOVE 0
 19427       TO DFHEIV11
 19428*    MOVE '&2                    $   #00019327' TO DFHEIV0
 19429     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19430     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19431     MOVE X'2020233030303139333237' TO DFHEIV0(25:11)
 19432     CALL 'kxdfhei1' USING DFHEIV0,
 19433           FILE-ID-ERRESS,
 19434           DFHEIV11,
 19435           DFHEIV99
 19436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19437
 19438
 19439     GO TO 6640-EXIT.
 19440
 19441 6630-END-OF-FILE.
 19442     MOVE ER-8002              TO WS-ERROR.
 19443     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19444
 19445     GO TO 6640-EXIT.
 19446
 19447 6630-ERRESS-PROBLEM.
 19448     MOVE ER-8044              TO WS-ERROR.
 19449     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19450
 19451 6640-EXIT.
 19452     EXIT.
 19453
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 354
* EL050.cbl
 19455 6650-GET-RES-STATE-COMM.
 19456
 19457     IF PB-COMPANY-ID NOT = 'DMD'
 19458         GO TO 6700-COMM-EXIT.
 19459
 19460     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19461     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 19462     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 19463     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 19464     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19465     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 19466     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19467
 19468*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 19469*
 19470***  Y2K PROJ 7744
 19471     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19472     SET BIN-TO-GREG          TO TRUE.
 19473     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19474
 19475     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19476***  Y2K PROJ 7744
 19477
 19478     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 19479
 19480
 19481* EXEC CICS HANDLE CONDITION
 19482*        INVREQ    (6660-START-BROWSE)
 19483*        DISABLED  (6690-ERRESC-PROBLEM)
 19484*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19485*        NOTFND    (6690-END-OF-FILE)
 19486*    END-EXEC.
 19487*    MOVE '"$8cJI                ! & #00019372' TO DFHEIV0
 19488     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 19489     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19490     MOVE X'2620233030303139333732' TO DFHEIV0(25:11)
 19491     CALL 'kxdfhei1' USING DFHEIV0
 19492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19493
 19494
 19495
 19496* EXEC CICS RESETBR
 19497*        DATASET (FILE-ID-ERRESC)
 19498*        RIDFLD  (WS-ERRESC-KEY)
 19499*    END-EXEC.
 19500     MOVE 0
 19501       TO DFHEIV11
 19502*    MOVE '&4         G          &   #00019379' TO DFHEIV0
 19503     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19504     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19505     MOVE X'2020233030303139333739' TO DFHEIV0(25:11)
 19506     CALL 'kxdfhei1' USING DFHEIV0,
 19507           FILE-ID-ERRESC,
 19508           WS-ERRESC-KEY,
 19509           DFHEIV99,
 19510           DFHEIV11,
 19511           DFHEIV99
 19512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 355
* EL050.cbl
 19513
 19514
 19515 6660-START-BROWSE.
 19516
 19517
 19518* EXEC CICS HANDLE CONDITION
 19519*        NOTFND    (6690-END-OF-FILE)
 19520*        DISABLED  (6690-ERRESC-PROBLEM)
 19521*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19522*        ENDFILE   (6690-END-OF-FILE)
 19523*    END-EXEC.
 19524*    MOVE '"$IcJ''                ! '' #00019386' TO DFHEIV0
 19525     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19527     MOVE X'2720233030303139333836' TO DFHEIV0(25:11)
 19528     CALL 'kxdfhei1' USING DFHEIV0
 19529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19530
 19531
 19532
 19533* EXEC CICS STARTBR
 19534*        DATASET (FILE-ID-ERRESC)
 19535*        RIDFLD  (WS-ERRESC-KEY)
 19536*        GTEQ
 19537*    END-EXEC.
 19538     MOVE 0
 19539       TO DFHEIV11
 19540*    MOVE '&,         G          &   #00019393' TO DFHEIV0
 19541     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19542     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19543     MOVE X'2020233030303139333933' TO DFHEIV0(25:11)
 19544     CALL 'kxdfhei1' USING DFHEIV0,
 19545           FILE-ID-ERRESC,
 19546           WS-ERRESC-KEY,
 19547           DFHEIV99,
 19548           DFHEIV11,
 19549           DFHEIV99
 19550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19551
 19552
 19553     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 19554
 19555 6670-READ-NEXT-ERRESC-MASTER.
 19556
 19557
 19558* EXEC CICS HANDLE CONDITION
 19559*        NOTFND    (6690-END-OF-FILE)
 19560*        DISABLED  (6690-ERRESC-PROBLEM)
 19561*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19562*        ENDFILE   (6690-END-OF-FILE)
 19563*    END-EXEC.
 19564*    MOVE '"$IcJ''                ! ( #00019403' TO DFHEIV0
 19565     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19566     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19567     MOVE X'2820233030303139343033' TO DFHEIV0(25:11)
 19568     CALL 'kxdfhei1' USING DFHEIV0
 19569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19570
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 356
* EL050.cbl
 19571
 19572
 19573* EXEC CICS READNEXT
 19574*        DATASET (FILE-ID-ERRESC)
 19575*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 19576*        RIDFLD  (ERRESC-RECORD-KEY)
 19577*    END-EXEC.
 19578     MOVE LENGTH OF
 19579      ACCOUNT-RESIDENT-ST-COMMISSION
 19580       TO DFHEIV12
 19581     MOVE 0
 19582       TO DFHEIV11
 19583*    MOVE '&.IL                  )   #00019410' TO DFHEIV0
 19584     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19585     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19586     MOVE X'2020233030303139343130' TO DFHEIV0(25:11)
 19587     CALL 'kxdfhei1' USING DFHEIV0,
 19588           FILE-ID-ERRESC,
 19589           ACCOUNT-RESIDENT-ST-COMMISSION,
 19590           DFHEIV12,
 19591           ERRESC-RECORD-KEY,
 19592           DFHEIV99,
 19593           DFHEIV11,
 19594           DFHEIV99,
 19595           DFHEIV99
 19596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19597
 19598
 19599     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 19600        NEXT SENTENCE
 19601     ELSE
 19602
 19603* EXEC CICS ENDBR
 19604*            DATASET (FILE-ID-ERRESC)
 19605*       END-EXEC
 19606     MOVE 0
 19607       TO DFHEIV11
 19608*    MOVE '&2                    $   #00019419' TO DFHEIV0
 19609     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19610     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19611     MOVE X'2020233030303139343139' TO DFHEIV0(25:11)
 19612     CALL 'kxdfhei1' USING DFHEIV0,
 19613           FILE-ID-ERRESC,
 19614           DFHEIV11,
 19615           DFHEIV99
 19616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19617        GO TO 6690-END-OF-FILE.
 19618
 19619     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 19620
 19621* EXEC CICS ENDBR
 19622*            DATASET (FILE-ID-ERRESC)
 19623*       END-EXEC
 19624     MOVE 0
 19625       TO DFHEIV11
 19626*    MOVE '&2                    $   #00019425' TO DFHEIV0
 19627     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19628     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 357
* EL050.cbl
 19629     MOVE X'2020233030303139343235' TO DFHEIV0(25:11)
 19630     CALL 'kxdfhei1' USING DFHEIV0,
 19631           FILE-ID-ERRESC,
 19632           DFHEIV11,
 19633           DFHEIV99
 19634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19635        GO TO 6690-END-OF-FILE.
 19636
 19637     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 19638        NEXT SENTENCE
 19639      ELSE
 19640        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 19641
 19642* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19643*
 19644     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19645
 19646     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19647
 19648     IF WS-SUB1 > ZERO
 19649         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19650             PERFORM 6680-SET-COMMISSION
 19651         ELSE
 19652             PERFORM 6680-SET-TABLE-CODE.
 19653
 19654
 19655* EXEC CICS ENDBR
 19656*         DATASET (FILE-ID-ERRESC)
 19657*    END-EXEC.
 19658     MOVE 0
 19659       TO DFHEIV11
 19660*    MOVE '&2                    $   #00019447' TO DFHEIV0
 19661     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19662     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19663     MOVE X'2020233030303139343437' TO DFHEIV0(25:11)
 19664     CALL 'kxdfhei1' USING DFHEIV0,
 19665           FILE-ID-ERRESC,
 19666           DFHEIV11,
 19667           DFHEIV99
 19668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19669
 19670
 19671     GO TO 6700-COMM-EXIT.
 19672
 19673 6680-SET-TABLE-CODE.
 19674     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19675        MOVE ZEROS             TO WS-SUB1
 19676     ELSE
 19677* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19678* TO COMPUTE AH COMMISSION.
 19679        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19680        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19681        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19682        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19683        PERFORM 6680-READ-CTBL-TABLE
 19684        IF WS-CTBL-READ-SW NOT = 'Y'
 19685           MOVE ZEROS          TO WS-SUB1.
 19686
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 358
* EL050.cbl
 19687 6680-READ-CTBL-TABLE.
 19688*
 19689* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19690* TO COMPUTE LIFE COMMISSION
 19691
 19692     IF CTBL-SW = '0540'
 19693        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19694        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19695        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19696
 19697     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19698
 19699     IF CTBL-TABLE-FOUND
 19700        IF CTBL-SW = '0530'
 19701             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19702                                    * PB-I-AH-TERM
 19703             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19704             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19705        ELSE
 19706             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19707             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19708             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19709     ELSE
 19710        IF FIRST-TIME-THROUGH
 19711            GO TO 6680-READ-CTBL-TABLE
 19712        ELSE
 19713            MOVE ZEROS         TO WS-SUB1.
 19714
 19715 6680-SET-COMMISSION.
 19716     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19717           MOVE ZEROS          TO WS-SUB1
 19718       ELSE
 19719           MOVE RESC-COMMISSION-PER (WS-SUB)
 19720                               TO WS-COMMISSION
 19721           IF CTBL-SW = '0530'
 19722               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19723           ELSE
 19724               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19725
 19726 6680-SEARCH-CATEGORY.
 19727     ADD +1                   TO WS-SUB.
 19728     IF WS-SUB > +12
 19729         GO TO 6680-EXIT.
 19730
 19731     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19732          MOVE WS-SUB         TO WS-SUB1
 19733          GO TO 6680-EXIT.
 19734
 19735     GO TO 6680-SEARCH-CATEGORY.
 19736
 19737 6680-EXIT.
 19738     EXIT.
 19739
 19740 6690-END-OF-FILE.
 19741     GO TO 6700-COMM-EXIT.
 19742
 19743 6690-ERRESC-PROBLEM.
 19744      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 359
* EL050.cbl
 19745      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19746
 19747      GO TO 6700-COMM-EXIT.
 19748
 19749 6700-COMM-EXIT.
 19750     EXIT.
 19751
 19752 7000-GET-RATE.
 19753
 19754* EXEC CICS LINK
 19755*        PROGRAM    ('ELRATE')
 19756*        COMMAREA   (CALCULATION-PASS-AREA)
 19757*        LENGTH     (CP-COMM-LENGTH)
 19758*    END-EXEC.
 19759     MOVE 'ELRATE' TO DFHEIV1
 19760*    MOVE '."C                   (   #00019533' TO DFHEIV0
 19761     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19762     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19763     MOVE X'2020233030303139353333' TO DFHEIV0(25:11)
 19764     CALL 'kxdfhei1' USING DFHEIV0,
 19765           DFHEIV1,
 19766           CALCULATION-PASS-AREA,
 19767           CP-COMM-LENGTH,
 19768           DFHEIV99,
 19769           DFHEIV99,
 19770           DFHEIV99,
 19771           DFHEIV99
 19772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19773
 19774
 19775 7000-EXIT.
 19776     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 360
* EL050.cbl
 19778 7100-FIND-BENEFIT-IN-STATE.
 19779     MOVE 'N'                    TO BEN-SEARCH-SW.
 19780
 19781     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19782         VARYING SUB3 FROM 1 BY 1 UNTIL
 19783            ((SUB3 GREATER 50) OR
 19784              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19785               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19786
 19787     IF SUB3 NOT = 51
 19788         MOVE 'Y'                TO BEN-SEARCH-SW.
 19789
 19790     GO TO 7199-EXIT.
 19791
 19792 7100-BENEFIT-DUMMY.
 19793
 19794 7100-DUMMY-EXIT.
 19795     EXIT.
 19796
 19797 7199-EXIT.
 19798     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 361
* EL050.cbl
 19800 7200-FIND-BENEFIT.
 19801     MOVE 'N'                    TO BEN-SEARCH-SW.
 19802
 19803     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19804         VARYING SUB3 FROM 1 BY 1 UNTIL
 19805            ((SUB3 GREATER 8) OR
 19806            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19807
 19808     IF SUB3 NOT = 9
 19809         MOVE 'Y'                TO BEN-SEARCH-SW.
 19810
 19811     GO TO 7200-EXIT.
 19812
 19813 7200-BENEFIT-DUMMY.
 19814
 19815 7200-DUMMY-EXIT.
 19816     EXIT.
 19817
 19818 7200-EXIT.
 19819     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 362
* EL050.cbl
 19821 7250-LOOK-FOR-RESCINDED-CLAIM.
 19822     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19823                                    W-CL-COMP-CD.
 19824     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19825                                    W-CL-CERT-NO.
 19826
 19827
 19828* EXEC CICS HANDLE CONDITION
 19829*        NOTFND  (7250-CONTINUE)
 19830*        ENDFILE (7250-CONTINUE)
 19831*    END-EXEC.
 19832*    MOVE '"$I''                  ! ) #00019591' TO DFHEIV0
 19833     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19834     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19835     MOVE X'2920233030303139353931' TO DFHEIV0(25:11)
 19836     CALL 'kxdfhei1' USING DFHEIV0
 19837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19838
 19839
 19840
 19841* EXEC CICS IGNORE CONDITION
 19842*        DUPKEY
 19843*    END-EXEC.
 19844*    MOVE '"*$                   !   #00019596' TO DFHEIV0
 19845     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19846     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19847     MOVE X'2020233030303139353936' TO DFHEIV0(25:11)
 19848     CALL 'kxdfhei1' USING DFHEIV0
 19849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19850
 19851
 19852
 19853* EXEC CICS STARTBR
 19854*        DATASET   (CLMS-ID)
 19855*        RIDFLD    (ELMSTR-KEY)
 19856*        GENERIC   EQUAL
 19857*        KEYLENGTH (ELMSTR-LENGTH)
 19858*    END-EXEC.
 19859     MOVE 0
 19860       TO DFHEIV11
 19861*    MOVE '&,   KG    E          &   #00019600' TO DFHEIV0
 19862     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19863     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19864     MOVE X'2020233030303139363030' TO DFHEIV0(25:11)
 19865     CALL 'kxdfhei1' USING DFHEIV0,
 19866           CLMS-ID,
 19867           ELMSTR-KEY,
 19868           ELMSTR-LENGTH,
 19869           DFHEIV11,
 19870           DFHEIV99
 19871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19872
 19873
 19874     MOVE 'Y'                    TO W-BROWSE-SW.
 19875
 19876 7250-NEXT-CLAIM.
 19877
 19878
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 363
* EL050.cbl
 19879* EXEC CICS READNEXT
 19880*        DATASET   (CLMS-ID)
 19881*        RIDFLD    (ELMSTR-KEY)
 19882*        SET       (ADDRESS OF CLAIM-MASTER)
 19883*    END-EXEC.
 19884     MOVE 0
 19885       TO DFHEIV11
 19886*    MOVE '&.S                   )   #00019611' TO DFHEIV0
 19887     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19888     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19889     MOVE X'2020233030303139363131' TO DFHEIV0(25:11)
 19890     CALL 'kxdfhei1' USING DFHEIV0,
 19891           CLMS-ID,
 19892           DFHEIV20,
 19893           DFHEIV99,
 19894           ELMSTR-KEY,
 19895           DFHEIV99,
 19896           DFHEIV11,
 19897           DFHEIV99,
 19898           DFHEIV99
 19899     SET ADDRESS OF CLAIM-MASTER TO
 19900         DFHEIV20
 19901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19902
 19903
 19904     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19905        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19906         GO TO 7250-CONTINUE
 19907     END-IF.
 19908
 19909     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19910        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19911        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19912        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19913        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19914         GO TO 7250-NEXT-CLAIM
 19915     END-IF.
 19916
 19917     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19918        OR (CL-CLAIM-TYPE = 'I')
 19919        OR (CL-CLAIM-TYPE = 'G')
 19920        OR (CL-CLAIM-TYPE = 'F')
 19921          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19922              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19923              GO TO 7250-CONTINUE
 19924          END-IF
 19925     END-IF.
 19926
 19927     GO TO 7250-NEXT-CLAIM.
 19928
 19929 7250-CONTINUE.
 19930
 19931     IF W-BROWSE-SW = 'Y'
 19932
 19933* EXEC CICS ENDBR
 19934*            DATASET   (CLMS-ID)
 19935*        END-EXEC
 19936     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 364
* EL050.cbl
 19937       TO DFHEIV11
 19938*    MOVE '&2                    $   #00019645' TO DFHEIV0
 19939     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19940     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19941     MOVE X'2020233030303139363435' TO DFHEIV0(25:11)
 19942     CALL 'kxdfhei1' USING DFHEIV0,
 19943           CLMS-ID,
 19944           DFHEIV11,
 19945           DFHEIV99
 19946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19947         MOVE 'N' TO W-BROWSE-SW
 19948     END-IF.
 19949
 19950 7250-EXIT.
 19951     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 365
* EL050.cbl
 19953 7300-CHECK-FOR-OPEN-CLMS.
 19954
 19955*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19956*    MOVE SPACES                 TO CNTL-ACCESS.
 19957*    MOVE '1'                    TO CNTL-REC-TYPE.
 19958*    MOVE +0                     TO CNTL-SEQ-NO.
 19959
 19960*    MOVE '3'                    TO RC-SW-1.
 19961*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19962
 19963*    IF NOT CF-COMPANY-MASTER
 19964*         PERFORM 0099-COMPANY-NOT-FOUND
 19965*         GO TO 7300-EXIT.
 19966
 19967     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19968                                    W-CL-COMP-CD.
 19969     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19970                                    W-CL-CERT-NO.
 19971
 19972
 19973* EXEC CICS HANDLE CONDITION
 19974*        NOTFND  (7300-CONTINUE)
 19975*        ENDFILE (7300-CONTINUE)
 19976*    END-EXEC.
 19977*    MOVE '"$I''                  ! * #00019673' TO DFHEIV0
 19978     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19979     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19980     MOVE X'2A20233030303139363733' TO DFHEIV0(25:11)
 19981     CALL 'kxdfhei1' USING DFHEIV0
 19982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19983
 19984
 19985
 19986* EXEC CICS IGNORE CONDITION
 19987*        DUPKEY
 19988*    END-EXEC.
 19989*    MOVE '"*$                   !   #00019678' TO DFHEIV0
 19990     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19991     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19992     MOVE X'2020233030303139363738' TO DFHEIV0(25:11)
 19993     CALL 'kxdfhei1' USING DFHEIV0
 19994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19995
 19996
 19997
 19998* EXEC CICS STARTBR
 19999*        DATASET   (CLMS-ID)
 20000*        RIDFLD    (ELMSTR-KEY)
 20001*        GENERIC   EQUAL
 20002*        KEYLENGTH (ELMSTR-LENGTH)
 20003*    END-EXEC.
 20004     MOVE 0
 20005       TO DFHEIV11
 20006*    MOVE '&,   KG    E          &   #00019682' TO DFHEIV0
 20007     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 20008     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20009     MOVE X'2020233030303139363832' TO DFHEIV0(25:11)
 20010     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 366
* EL050.cbl
 20011           CLMS-ID,
 20012           ELMSTR-KEY,
 20013           ELMSTR-LENGTH,
 20014           DFHEIV11,
 20015           DFHEIV99
 20016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20017
 20018
 20019     MOVE 'Y'                    TO W-BROWSE-SW.
 20020
 20021 7300-NEXT-CLAIM.
 20022
 20023
 20024* EXEC CICS READNEXT
 20025*        DATASET   (CLMS-ID)
 20026*        RIDFLD    (ELMSTR-KEY)
 20027*        SET       (ADDRESS OF CLAIM-MASTER)
 20028*    END-EXEC.
 20029     MOVE 0
 20030       TO DFHEIV11
 20031*    MOVE '&.S                   )   #00019693' TO DFHEIV0
 20032     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20033     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20034     MOVE X'2020233030303139363933' TO DFHEIV0(25:11)
 20035     CALL 'kxdfhei1' USING DFHEIV0,
 20036           CLMS-ID,
 20037           DFHEIV20,
 20038           DFHEIV99,
 20039           ELMSTR-KEY,
 20040           DFHEIV99,
 20041           DFHEIV11,
 20042           DFHEIV99,
 20043           DFHEIV99
 20044     SET ADDRESS OF CLAIM-MASTER TO
 20045         DFHEIV20
 20046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20047
 20048
 20049     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 20050        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 20051         GO TO 7300-CONTINUE.
 20052
 20053     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 20054        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 20055        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 20056        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 20057        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20058         GO TO 7300-NEXT-CLAIM.
 20059
 20060*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 20061     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 20062        OR (CL-CLAIM-TYPE = 'I')
 20063        OR (CL-CLAIM-TYPE = 'G')
 20064        OR (CL-CLAIM-TYPE = 'F')
 20065        IF CLAIM-IS-OPEN
 20066           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20067             AND PB-C-AH-CANCEL-DT > SPACES
 20068              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 367
* EL050.cbl
 20069              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20070           END-IF
 20071           EVALUATE TRUE
 20072             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 20073                 MOVE ER-2884      TO WS-ERROR
 20074             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 20075                 MOVE ER-2887      TO WS-ERROR
 20076             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 20077                 MOVE ER-2886      TO WS-ERROR
 20078             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 20079                 MOVE ER-2888      TO WS-ERROR
 20080             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 20081                 MOVE ER-2885      TO WS-ERROR
 20082             WHEN OTHER
 20083                 MOVE ER-2768      TO WS-ERROR
 20084           END-EVALUATE
 20085           IF PB-C-AH-CANCEL-VOIDED OR
 20086              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20087                NOT AH-COVERAGE-CANCELLED)
 20088               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20089               MOVE ER-2768      TO WS-ERROR
 20090           END-IF
 20091           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20092           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20093              PB-FORCE-CODE NOT EQUAL '8'
 20094               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20095           END-IF
 20096           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 20097           GO TO 7300-NEXT-CLAIM
 20098        ELSE
 20099           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20100*****THIS IS A RESCISSION OR REFORMATION
 20101              IF AH-COVERAGE-CANCELLED
 20102                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 20103                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 20104                    MOVE 1                   TO DC-ELAPSED-DAYS
 20105                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 20106                    SET BIN-PLUS-ELAPSED     TO TRUE
 20107                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 20108                    IF NO-CONVERSION-ERROR
 20109                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 20110                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 20111                          MOVE ER-2897 TO WS-ERROR
 20112                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20113                          GO TO 7300-NEXT-CLAIM
 20114                       END-IF
 20115                    END-IF
 20116                 ELSE
 20117                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 20118                      IF MSTR-CERT-NO = W-CL-CERT-NO
 20119                         MOVE ER-2890 TO WS-ERROR
 20120                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20121                         GO TO 7300-NEXT-CLAIM
 20122                      ELSE
 20123                         MOVE ER-2898 TO WS-ERROR
 20124                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20125                         GO TO 7300-NEXT-CLAIM
 20126                      END-IF
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 368
* EL050.cbl
 20127                   END-IF
 20128                 END-IF
 20129              END-IF
 20130           ELSE
 20131              IF CL-DENIAL-TYPE = '1'  AND
 20132                 CL-TOTAL-PAID-AMT = 0
 20133                    GO TO 7300-NEXT-CLAIM
 20134              END-IF
 20135              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20136               AND PB-C-AH-CANCEL-DT > SPACES
 20137                 MOVE ER-2756        TO WS-ERROR
 20138                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20139                 GO TO 7300-NEXT-CLAIM
 20140              END-IF
 20141           END-IF
 20142        END-IF
 20143     ELSE
 20144*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 20145        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 20146          OR (CL-CLAIM-TYPE = 'O')
 20147           IF (CLAIM-IS-OPEN)
 20148              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 20149                 <> zeros
 20150              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 20151                 <> zeros)
 20152              MOVE ER-2889      TO WS-ERROR
 20153              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20154              GO TO 7300-NEXT-CLAIM
 20155           ELSE
 20156              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20157*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 20158                 IF (LF-COVERAGE-CANCELLED AND
 20159                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 20160                      IF MSTR-CERT-NO = W-CL-CERT-NO
 20161                         MOVE ER-2890 TO WS-ERROR
 20162                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20163                         GO TO 7300-NEXT-CLAIM
 20164                      ELSE
 20165                         MOVE ER-2898 TO WS-ERROR
 20166                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20167                         GO TO 7300-NEXT-CLAIM
 20168                      END-IF
 20169                 END-IF
 20170              ELSE
 20171                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 20172                    and (CL-TOTAL-PAID-AMT = 0)
 20173                    GO TO 7300-NEXT-CLAIM
 20174                 END-IF
 20175                 IF (
 20176                      (AH-COVERAGE-CANCELLED)
 20177                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 20178                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 20179                      and (pb-ci-ah-cancel-amt +
 20180                         pb-c-ah-cancel-amt) <> zeros
 20181                    )
 20182                               OR
 20183                    (
 20184                      (LF-COVERAGE-CANCELLED)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 369
* EL050.cbl
 20185                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
 20186                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 20187                      and (pb-ci-lf-cancel-amt +
 20188                         pb-c-lf-cancel-amt) <> zeros
 20189                    )
 20190                       IF CL-CLAIM-TYPE = 'O'
 20191                          MOVE ER-2998 TO WS-ERROR
 20192                       ELSE
 20193                          MOVE ER-2965 TO WS-ERROR
 20194                       END-IF
 20195                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20196                       GO TO 7300-NEXT-CLAIM
 20197                 END-IF
 20198                 IF LF-COVERAGE-CANCELLED
 20199                  IF CL-TOTAL-PAID-AMT > 0
 20200                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 20201                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 20202                        MOVE ER-2891 TO WS-ERROR
 20203                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20204                        GO TO 7300-NEXT-CLAIM
 20205                      END-IF
 20206                    ELSE
 20207****only show this error if cert num matches exactly
 20208                      IF PB-CERT-NO = CL-CERT-NO
 20209                         IF CL-CLAIM-TYPE = 'O'
 20210                            MOVE ER-2895 TO WS-ERROR
 20211                         ELSE
 20212                            MOVE ER-2892 TO WS-ERROR
 20213                         END-IF
 20214                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20215                         GO TO 7300-NEXT-CLAIM
 20216                      END-IF
 20217                    END-IF
 20218                  END-IF
 20219                 END-IF
 20220              END-IF
 20221           END-IF
 20222        END-IF
 20223     END-IF
 20224
 20225     GO TO 7300-NEXT-CLAIM.
 20226
 20227 7300-CONTINUE.
 20228
 20229     IF W-BROWSE-SW = 'Y'
 20230
 20231* EXEC CICS ENDBR
 20232*            DATASET   (CLMS-ID)
 20233*        END-EXEC.
 20234     MOVE 0
 20235       TO DFHEIV11
 20236*    MOVE '&2                    $   #00019880' TO DFHEIV0
 20237     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20238     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20239     MOVE X'2020233030303139383830' TO DFHEIV0(25:11)
 20240     CALL 'kxdfhei1' USING DFHEIV0,
 20241           CLMS-ID,
 20242           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 370
* EL050.cbl
 20243           DFHEIV99
 20244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20245
 20246
 20247 7300-EXIT.
 20248     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 371
* EL050.cbl
 20250 7320-CHECK-FOR-OPEN-CLMS-issue.
 20251
 20252     move ' '                    to w-browse-sw
 20253     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20254                                    W-CL-COMP-CD
 20255     MOVE PB-CERT-NO(1:10)       TO MSTR-CERT-NO
 20256                                    W-CL-CERT-NO
 20257
 20258
 20259* EXEC CICS HANDLE CONDITION
 20260*        NOTFND  (7320-CONTINUE)
 20261*        ENDFILE (7320-CONTINUE)
 20262*    END-EXEC.
 20263*    MOVE '"$I''                  ! + #00019895' TO DFHEIV0
 20264     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20265     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20266     MOVE X'2B20233030303139383935' TO DFHEIV0(25:11)
 20267     CALL 'kxdfhei1' USING DFHEIV0
 20268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20269
 20270
 20271
 20272* EXEC CICS IGNORE CONDITION
 20273*        DUPKEY
 20274*    END-EXEC.
 20275*    MOVE '"*$                   !   #00019900' TO DFHEIV0
 20276     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 20277     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20278     MOVE X'2020233030303139393030' TO DFHEIV0(25:11)
 20279     CALL 'kxdfhei1' USING DFHEIV0
 20280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20281
 20282
 20283
 20284* EXEC CICS STARTBR
 20285*        DATASET   (CLMS-ID)
 20286*        RIDFLD    (ELMSTR-KEY)
 20287*        GENERIC   EQUAL
 20288*        KEYLENGTH (ELMSTR-LENGTH)
 20289*    END-EXEC.
 20290     MOVE 0
 20291       TO DFHEIV11
 20292*    MOVE '&,   KG    E          &   #00019904' TO DFHEIV0
 20293     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 20294     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20295     MOVE X'2020233030303139393034' TO DFHEIV0(25:11)
 20296     CALL 'kxdfhei1' USING DFHEIV0,
 20297           CLMS-ID,
 20298           ELMSTR-KEY,
 20299           ELMSTR-LENGTH,
 20300           DFHEIV11,
 20301           DFHEIV99
 20302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20303
 20304
 20305     MOVE 'Y'                    TO W-BROWSE-SW.
 20306
 20307 7320-NEXT-CLAIM.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 372
* EL050.cbl
 20308
 20309
 20310* EXEC CICS READNEXT
 20311*        DATASET   (CLMS-ID)
 20312*        RIDFLD    (ELMSTR-KEY)
 20313*        SET       (ADDRESS OF CLAIM-MASTER)
 20314*    END-EXEC.
 20315     MOVE 0
 20316       TO DFHEIV11
 20317*    MOVE '&.S                   )   #00019915' TO DFHEIV0
 20318     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20319     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20320     MOVE X'2020233030303139393135' TO DFHEIV0(25:11)
 20321     CALL 'kxdfhei1' USING DFHEIV0,
 20322           CLMS-ID,
 20323           DFHEIV20,
 20324           DFHEIV99,
 20325           ELMSTR-KEY,
 20326           DFHEIV99,
 20327           DFHEIV11,
 20328           DFHEIV99,
 20329           DFHEIV99
 20330     SET ADDRESS OF CLAIM-MASTER TO
 20331         DFHEIV20
 20332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20333
 20334
 20335     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 20336        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 20337         GO TO 7320-CONTINUE.
 20338
 20339     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 20340        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 20341        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 20342        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 20343        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20344         GO TO 7320-NEXT-CLAIM.
 20345
 20346     IF CLAIM-IS-OPEN
 20347        MOVE ER-3273             TO WS-ERROR
 20348        PERFORM 9900-ERROR-FORMAT
 20349                                 THRU 9900-EXIT
 20350     END-IF
 20351     if pb-i-entry-status = 'V'
 20352        IF CLAIM-IS-OPEN
 20353             OR
 20354           CL-LAST-PMT-DT NOT = LOW-VALUES
 20355             OR
 20356           CL-LAST-PMT-AMT > 0
 20357           MOVE ER-3281          TO WS-ERROR
 20358           PERFORM 9900-ERROR-FORMAT
 20359                                 THRU 9900-EXIT
 20360        END-IF
 20361     END-IF
 20362
 20363     GO TO 7320-NEXT-CLAIM.
 20364
 20365 7320-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 373
* EL050.cbl
 20366
 20367     IF W-BROWSE-SW = 'Y'
 20368
 20369* EXEC CICS ENDBR
 20370*            DATASET   (CLMS-ID)
 20371*        END-EXEC.
 20372     MOVE 0
 20373       TO DFHEIV11
 20374*    MOVE '&2                    $   #00019954' TO DFHEIV0
 20375     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20376     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20377     MOVE X'2020233030303139393534' TO DFHEIV0(25:11)
 20378     CALL 'kxdfhei1' USING DFHEIV0,
 20379           CLMS-ID,
 20380           DFHEIV11,
 20381           DFHEIV99
 20382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20383
 20384
 20385 7320-EXIT.
 20386     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 374
* EL050.cbl
 20388 7400-GET-REMAIN-TERM.
 20389
 20390* EXEC CICS LINK
 20391*        PROGRAM    ('ELRTRM')
 20392*        COMMAREA   (CALCULATION-PASS-AREA)
 20393*        LENGTH     (CP-COMM-LENGTH)
 20394*    END-EXEC.
 20395     MOVE 'ELRTRM' TO DFHEIV1
 20396*    MOVE '."C                   (   #00019962' TO DFHEIV0
 20397     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20398     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20399     MOVE X'2020233030303139393632' TO DFHEIV0(25:11)
 20400     CALL 'kxdfhei1' USING DFHEIV0,
 20401           DFHEIV1,
 20402           CALCULATION-PASS-AREA,
 20403           CP-COMM-LENGTH,
 20404           DFHEIV99,
 20405           DFHEIV99,
 20406           DFHEIV99,
 20407           DFHEIV99
 20408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20409
 20410
 20411 7400-EXIT.
 20412     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 375
* EL050.cbl
 20414
 20415 7500-GET-REMAIN-AMOUNT.
 20416
 20417* EXEC CICS LINK
 20418*        PROGRAM    ('ELRAMT')
 20419*        COMMAREA   (CALCULATION-PASS-AREA)
 20420*        LENGTH     (CP-COMM-LENGTH)
 20421*    END-EXEC.
 20422     MOVE 'ELRAMT' TO DFHEIV1
 20423*    MOVE '."C                   (   #00019973' TO DFHEIV0
 20424     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20425     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20426     MOVE X'2020233030303139393733' TO DFHEIV0(25:11)
 20427     CALL 'kxdfhei1' USING DFHEIV0,
 20428           DFHEIV1,
 20429           CALCULATION-PASS-AREA,
 20430           CP-COMM-LENGTH,
 20431           DFHEIV99,
 20432           DFHEIV99,
 20433           DFHEIV99,
 20434           DFHEIV99
 20435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20436
 20437
 20438 7500-EXIT.
 20439     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 376
* EL050.cbl
 20441
 20442 7600-GET-REFUND.
 20443
 20444* EXEC CICS LINK
 20445*        PROGRAM    ('ELRFND')
 20446*        COMMAREA   (CALCULATION-PASS-AREA)
 20447*        LENGTH     (CP-COMM-LENGTH)
 20448*    END-EXEC.
 20449     MOVE 'ELRFND' TO DFHEIV1
 20450*    MOVE '."C                   (   #00019984' TO DFHEIV0
 20451     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20452     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20453     MOVE X'2020233030303139393834' TO DFHEIV0(25:11)
 20454     CALL 'kxdfhei1' USING DFHEIV0,
 20455           DFHEIV1,
 20456           CALCULATION-PASS-AREA,
 20457           CP-COMM-LENGTH,
 20458           DFHEIV99,
 20459           DFHEIV99,
 20460           DFHEIV99,
 20461           DFHEIV99
 20462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20463
 20464
 20465 7600-EXIT.
 20466     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 377
* EL050.cbl
 20468 7700-CALL-DL1.
 20469
 20470* EXEC CICS LINK
 20471*        PROGRAM    ('DLO001')
 20472*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 20473*        LENGTH     (DLO001-COMM-LENGTH)
 20474*    END-EXEC.
 20475     MOVE 'DLO001' TO DFHEIV1
 20476*    MOVE '."C                   (   #00019994' TO DFHEIV0
 20477     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20478     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20479     MOVE X'2020233030303139393934' TO DFHEIV0(25:11)
 20480     CALL 'kxdfhei1' USING DFHEIV0,
 20481           DFHEIV1,
 20482           WS-DLO-MASTER-POLICY-FORM,
 20483           DLO001-COMM-LENGTH,
 20484           DFHEIV99,
 20485           DFHEIV99,
 20486           DFHEIV99,
 20487           DFHEIV99
 20488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20489
 20490
 20491 7700-EXIT.
 20492     EXIT.
 20493
 20494 7710-CALL-DL2.
 20495
 20496* EXEC CICS LINK
 20497*        PROGRAM    ('DLO002')
 20498*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 20499*        LENGTH     (DLO002-COMM-LENGTH)
 20500*    END-EXEC.
 20501     MOVE 'DLO002' TO DFHEIV1
 20502*    MOVE '."C                   (   #00020004' TO DFHEIV0
 20503     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20504     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20505     MOVE X'2020233030303230303034' TO DFHEIV0(25:11)
 20506     CALL 'kxdfhei1' USING DFHEIV0,
 20507           DFHEIV1,
 20508           WS-DLO-INTERNAL-POLICY-FORM,
 20509           DLO002-COMM-LENGTH,
 20510           DFHEIV99,
 20511           DFHEIV99,
 20512           DFHEIV99,
 20513           DFHEIV99
 20514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20515
 20516
 20517 7710-EXIT.
 20518     EXIT.
 20519
 20520 7720-CALL-DL3.
 20521
 20522* EXEC CICS LINK
 20523*        PROGRAM    ('DLO003')
 20524*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 20525*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 378
* EL050.cbl
 20526*    END-EXEC.
 20527     MOVE 'DLO003' TO DFHEIV1
 20528*    MOVE '."C                   (   #00020014' TO DFHEIV0
 20529     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20530     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20531     MOVE X'2020233030303230303134' TO DFHEIV0(25:11)
 20532     CALL 'kxdfhei1' USING DFHEIV0,
 20533           DFHEIV1,
 20534           WS-DLO-VALID-BANK-ID,
 20535           DLO003-COMM-LENGTH,
 20536           DFHEIV99,
 20537           DFHEIV99,
 20538           DFHEIV99,
 20539           DFHEIV99
 20540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20541
 20542
 20543 7720-EXIT.
 20544     EXIT.
 20545
 20546 7730-CALL-DL7.
 20547
 20548* EXEC CICS LINK
 20549*        PROGRAM    ('DLO007')
 20550*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 20551*        LENGTH     (DLO007-COMM-LENGTH)
 20552*    END-EXEC.
 20553     MOVE 'DLO007' TO DFHEIV1
 20554*    MOVE '."C                   (   #00020024' TO DFHEIV0
 20555     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20556     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20557     MOVE X'2020233030303230303234' TO DFHEIV0(25:11)
 20558     CALL 'kxdfhei1' USING DFHEIV0,
 20559           DFHEIV1,
 20560           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 20561           DLO007-COMM-LENGTH,
 20562           DFHEIV99,
 20563           DFHEIV99,
 20564           DFHEIV99,
 20565           DFHEIV99
 20566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20567
 20568
 20569 7730-EXIT.
 20570     EXIT.
 20571
 20572 7740-CALL-DL11.
 20573
 20574* EXEC CICS LINK
 20575*        PROGRAM    ('DLO011')
 20576*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 20577*        LENGTH     (DLO011-COMM-LENGTH)
 20578*    END-EXEC.
 20579     MOVE 'DLO011' TO DFHEIV1
 20580*    MOVE '."C                   (   #00020034' TO DFHEIV0
 20581     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20582     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20583     MOVE X'2020233030303230303334' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 379
* EL050.cbl
 20584     CALL 'kxdfhei1' USING DFHEIV0,
 20585           DFHEIV1,
 20586           WS-DLO-PREM-RATES-BEN-TYPE,
 20587           DLO011-COMM-LENGTH,
 20588           DFHEIV99,
 20589           DFHEIV99,
 20590           DFHEIV99,
 20591           DFHEIV99
 20592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20593
 20594
 20595 7740-EXIT.
 20596     EXIT.
 20597
 20598 7750-CALL-DL17.
 20599
 20600* EXEC CICS LINK
 20601*        PROGRAM    ('DLO017')
 20602*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 20603*        LENGTH     (DLO017-COMM-LENGTH)
 20604*    END-EXEC.
 20605     MOVE 'DLO017' TO DFHEIV1
 20606*    MOVE '."C                   (   #00020044' TO DFHEIV0
 20607     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20608     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20609     MOVE X'2020233030303230303434' TO DFHEIV0(25:11)
 20610     CALL 'kxdfhei1' USING DFHEIV0,
 20611           DFHEIV1,
 20612           WS-DLO-VALID-RATE-CODE,
 20613           DLO017-COMM-LENGTH,
 20614           DFHEIV99,
 20615           DFHEIV99,
 20616           DFHEIV99,
 20617           DFHEIV99
 20618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20619
 20620
 20621 7750-EXIT.
 20622     EXIT.
 20623
 20624 7755-CALL-DL19.
 20625
 20626* EXEC CICS LINK
 20627*        PROGRAM    ('DLO019')
 20628*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 20629*        LENGTH     (DLO019-COMM-LENGTH)
 20630*    END-EXEC.
 20631     MOVE 'DLO019' TO DFHEIV1
 20632*    MOVE '."C                   (   #00020054' TO DFHEIV0
 20633     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20634     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20635     MOVE X'2020233030303230303534' TO DFHEIV0(25:11)
 20636     CALL 'kxdfhei1' USING DFHEIV0,
 20637           DFHEIV1,
 20638           WS-DLO-ORIG-COV-CAT,
 20639           DLO019-COMM-LENGTH,
 20640           DFHEIV99,
 20641           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 380
* EL050.cbl
 20642           DFHEIV99,
 20643           DFHEIV99
 20644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20645
 20646
 20647 7755-EXIT.
 20648     EXIT.
 20649
 20650 7760-CALL-DL21.
 20651
 20652* EXEC CICS LINK
 20653*        PROGRAM    ('DLO021')
 20654*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 20655*        LENGTH     (DLO021-COMM-LENGTH)
 20656*    END-EXEC.
 20657     MOVE 'DLO021' TO DFHEIV1
 20658*    MOVE '."C                   (   #00020064' TO DFHEIV0
 20659     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20660     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20661     MOVE X'2020233030303230303634' TO DFHEIV0(25:11)
 20662     CALL 'kxdfhei1' USING DFHEIV0,
 20663           DFHEIV1,
 20664           WS-DLO-VALID-LOAN-OFFICER,
 20665           DLO021-COMM-LENGTH,
 20666           DFHEIV99,
 20667           DFHEIV99,
 20668           DFHEIV99,
 20669           DFHEIV99
 20670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20671
 20672
 20673 7760-EXIT.
 20674     EXIT.
 20675
 20676 7770-CALL-DL22.
 20677
 20678* EXEC CICS LINK
 20679*        PROGRAM    ('DLO022')
 20680*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 20681*        LENGTH     (DLO022-COMM-LENGTH)
 20682*    END-EXEC.
 20683     MOVE 'DLO022' TO DFHEIV1
 20684*    MOVE '."C                   (   #00020074' TO DFHEIV0
 20685     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20686     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20687     MOVE X'2020233030303230303734' TO DFHEIV0(25:11)
 20688     CALL 'kxdfhei1' USING DFHEIV0,
 20689           DFHEIV1,
 20690           WS-DLO-VALID-STATE-CODE,
 20691           DLO022-COMM-LENGTH,
 20692           DFHEIV99,
 20693           DFHEIV99,
 20694           DFHEIV99,
 20695           DFHEIV99
 20696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20697
 20698
 20699 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 381
* EL050.cbl
 20700     EXIT.
 20701
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 382
* EL050.cbl
 20703
 20704 7780-CALL-AGG.
 20705
 20706* EXEC CICS LINK
 20707*        PROGRAM    ('ELAGGO')
 20708*        COMMAREA   (WS-PASS-to-pemaggo)
 20709*        LENGTH     (ws-passed-key-LENGTH)
 20710*    END-EXEC.
 20711     MOVE 'ELAGGO' TO DFHEIV1
 20712*    MOVE '."C                   (   #00020086' TO DFHEIV0
 20713     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20714     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20715     MOVE X'2020233030303230303836' TO DFHEIV0(25:11)
 20716     CALL 'kxdfhei1' USING DFHEIV0,
 20717           DFHEIV1,
 20718           WS-PASS-to-pemaggo,
 20719           ws-passed-key-LENGTH,
 20720           DFHEIV99,
 20721           DFHEIV99,
 20722           DFHEIV99,
 20723           DFHEIV99
 20724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20725
 20726 7780-EXIT.
 20727     EXIT.
 20728 7785-CALL-HLDI.
 20729
 20730* EXEC CICS LINK
 20731*        PROGRAM    ('ELHLDI')
 20732*        COMMAREA   (HLDI-PASS-AREA)
 20733*        LENGTH     (HLDI-PASS-AREA-LEN)
 20734*    END-EXEC.
 20735     MOVE 'ELHLDI' TO DFHEIV1
 20736*    MOVE '."C                   (   #00020094' TO DFHEIV0
 20737     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20738     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20739     MOVE X'2020233030303230303934' TO DFHEIV0(25:11)
 20740     CALL 'kxdfhei1' USING DFHEIV0,
 20741           DFHEIV1,
 20742           HLDI-PASS-AREA,
 20743           HLDI-PASS-AREA-LEN,
 20744           DFHEIV99,
 20745           DFHEIV99,
 20746           DFHEIV99,
 20747           DFHEIV99
 20748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20749
 20750 7785-EXIT.
 20751     EXIT.
 20752 7786-CALL-HLDIM.
 20753
 20754* EXEC CICS LINK
 20755*        PROGRAM    ('ELHLDIM')
 20756*        COMMAREA   (HLDI-PASS-AREA)
 20757*        LENGTH     (HLDI-PASS-AREA-LEN)
 20758*    END-EXEC.
 20759     MOVE 'ELHLDIM' TO DFHEIV1
 20760*    MOVE '."C                   (   #00020102' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 383
* EL050.cbl
 20761     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20762     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20763     MOVE X'2020233030303230313032' TO DFHEIV0(25:11)
 20764     CALL 'kxdfhei1' USING DFHEIV0,
 20765           DFHEIV1,
 20766           HLDI-PASS-AREA,
 20767           HLDI-PASS-AREA-LEN,
 20768           DFHEIV99,
 20769           DFHEIV99,
 20770           DFHEIV99,
 20771           DFHEIV99
 20772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20773
 20774 7786-EXIT.
 20775     EXIT.
 20776 7790-CALL-ZIP-VERIFY.
 20777
 20778
 20779* EXEC CICS LINK
 20780*        PROGRAM    ('WSZIPCD')
 20781*        COMMAREA   (ZIPCD-PASS-AREA)
 20782*        LENGTH     (ZIPCD-PASS-AREA-LEN)
 20783*    END-EXEC.
 20784     MOVE 'WSZIPCD' TO DFHEIV1
 20785*    MOVE '."C                   (   #00020111' TO DFHEIV0
 20786     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20787     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20788     MOVE X'2020233030303230313131' TO DFHEIV0(25:11)
 20789     CALL 'kxdfhei1' USING DFHEIV0,
 20790           DFHEIV1,
 20791           ZIPCD-PASS-AREA,
 20792           ZIPCD-PASS-AREA-LEN,
 20793           DFHEIV99,
 20794           DFHEIV99,
 20795           DFHEIV99,
 20796           DFHEIV99
 20797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20798
 20799
 20800 7790-EXIT.
 20801     EXIT.
 20802 7795-call-sqlclmhs.
 20803
 20804
 20805* EXEC CICS LINK
 20806*        PROGRAM    ('SQLCLMHS')
 20807*        COMMAREA   (clmhs-PASS-AREA)
 20808*        LENGTH     (clmhs-PASS-AREA-LEN)
 20809*    END-EXEC.
 20810     MOVE 'SQLCLMHS' TO DFHEIV1
 20811*    MOVE '."C                   (   #00020121' TO DFHEIV0
 20812     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20813     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20814     MOVE X'2020233030303230313231' TO DFHEIV0(25:11)
 20815     CALL 'kxdfhei1' USING DFHEIV0,
 20816           DFHEIV1,
 20817           clmhs-PASS-AREA,
 20818           clmhs-PASS-AREA-LEN,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 384
* EL050.cbl
 20819           DFHEIV99,
 20820           DFHEIV99,
 20821           DFHEIV99,
 20822           DFHEIV99
 20823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20824
 20825
 20826 7795-EXIT.
 20827     EXIT.
 20828 7800-REWRITE-CERT.
 20829******************************************************************
 20830*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 20831*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 20832******************************************************************
 20833
 20834     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 20835        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 20836        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 20837        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 20838
 20839* EXEC CICS REWRITE
 20840*                  DATASET (CERT-ID)
 20841*                  FROM    (CERTIFICATE-MASTER)
 20842*              END-EXEC
 20843     MOVE LENGTH OF
 20844      CERTIFICATE-MASTER
 20845       TO DFHEIV11
 20846*    MOVE '&& L                  %   #00020139' TO DFHEIV0
 20847     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20848     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20849     MOVE X'2020233030303230313339' TO DFHEIV0(25:11)
 20850     CALL 'kxdfhei1' USING DFHEIV0,
 20851           CERT-ID,
 20852           CERTIFICATE-MASTER,
 20853           DFHEIV11,
 20854           DFHEIV99
 20855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20856        GO TO 7800-EXIT.
 20857
 20858       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20859       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20860
 20861 7800-EXIT.
 20862      EXIT.
 20863
 20864 7900-DELETE-CERT.
 20865
 20866* EXEC CICS DELETE
 20867*        DATASET (CERT-ID)
 20868*    END-EXEC.
 20869*    MOVE '&(                    &   #00020152' TO DFHEIV0
 20870     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 20871     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20872     MOVE X'2020233030303230313532' TO DFHEIV0(25:11)
 20873     CALL 'kxdfhei1' USING DFHEIV0,
 20874           CERT-ID,
 20875           DFHEIV99,
 20876           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 385
* EL050.cbl
 20877           DFHEIV99,
 20878           DFHEIV99
 20879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20880
 20881
 20882 7900-EXIT.
 20883     EXIT.
 20884
 20885 8000-WRITE-CERT.
 20886
 20887* EXEC CICS HANDLE CONDITION
 20888*        DUPKEY    (8000-FREE-MAIN)
 20889*    END-EXEC.
 20890*    MOVE '"$$                   ! , #00020160' TO DFHEIV0
 20891     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20892     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20893     MOVE X'2C20233030303230313630' TO DFHEIV0(25:11)
 20894     CALL 'kxdfhei1' USING DFHEIV0
 20895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20896
 20897
 20898
 20899* EXEC CICS WRITE
 20900*        DATASET     (CERT-ID)
 20901*        FROM        (CERTIFICATE-MASTER)
 20902*        RIDFLD      (ELCERT-KEY)
 20903*    END-EXEC.
 20904     MOVE LENGTH OF
 20905      CERTIFICATE-MASTER
 20906       TO DFHEIV11
 20907*    MOVE '&$ L                  ''   #00020164' TO DFHEIV0
 20908     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20909     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20910     MOVE X'2020233030303230313634' TO DFHEIV0(25:11)
 20911     CALL 'kxdfhei1' USING DFHEIV0,
 20912           CERT-ID,
 20913           CERTIFICATE-MASTER,
 20914           DFHEIV11,
 20915           ELCERT-KEY,
 20916           DFHEIV99,
 20917           DFHEIV99
 20918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20919
 20920
 20921 8000-FREE-MAIN.
 20922
 20923 8000-EXIT.
 20924      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 386
* EL050.cbl
 20926
 20927 8100-READ-ERPNDM.
 20928
 20929* EXEC CICS HANDLE CONDITION
 20930*         NOTFND     (8100-NOTFND)
 20931*         ENDFILE    (8100-NOTFND)
 20932*    END-EXEC.
 20933*    MOVE '"$I''                  ! - #00020177' TO DFHEIV0
 20934     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20935     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20936     MOVE X'2D20233030303230313737' TO DFHEIV0(25:11)
 20937     CALL 'kxdfhei1' USING DFHEIV0
 20938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20939
 20940
 20941     MOVE SPACES                 TO ERPNDM-FOUND.
 20942     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20943
 20944
 20945* EXEC CICS READ UPDATE
 20946*         DATASET   (FILE-ERPNDM)
 20947*         RIDFLD    (PM-CONTROL-PRIMARY)
 20948*         INTO      (PENDING-MAILING-DATA)
 20949*    END-EXEC.
 20950     MOVE LENGTH OF
 20951      PENDING-MAILING-DATA
 20952       TO DFHEIV11
 20953*    MOVE '&"IL       EU         (   #00020185' TO DFHEIV0
 20954     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20955     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20956     MOVE X'2020233030303230313835' TO DFHEIV0(25:11)
 20957     CALL 'kxdfhei1' USING DFHEIV0,
 20958           FILE-ERPNDM,
 20959           PENDING-MAILING-DATA,
 20960           DFHEIV11,
 20961           PM-CONTROL-PRIMARY,
 20962           DFHEIV99,
 20963           DFHEIV99,
 20964           DFHEIV99
 20965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20966
 20967
 20968     GO TO 8100-EXIT.
 20969
 20970 8100-NOTFND.
 20971
 20972     MOVE 'X'                    TO ERPNDM-FOUND.
 20973     MOVE ER-2694                TO WS-ERROR.
 20974     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20975     MOVE ER-2883                TO WS-ERROR
 20976     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20977     .
 20978 8100-EXIT.
 20979     EXIT.
 20980 8102-REWRITE-ERPNDM.
 20981
 20982
 20983* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 387
* EL050.cbl
 20984*         DATASET    (FILE-ERPNDM)
 20985*         FROM       (PENDING-MAILING-DATA)
 20986*    END-EXEC
 20987     MOVE LENGTH OF
 20988      PENDING-MAILING-DATA
 20989       TO DFHEIV11
 20990*    MOVE '&& L                  %   #00020205' TO DFHEIV0
 20991     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20992     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20993     MOVE X'2020233030303230323035' TO DFHEIV0(25:11)
 20994     CALL 'kxdfhei1' USING DFHEIV0,
 20995           FILE-ERPNDM,
 20996           PENDING-MAILING-DATA,
 20997           DFHEIV11,
 20998           DFHEIV99
 20999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21000
 21001     .
 21002 8102-EXIT.
 21003     EXIT.
 21004 8104-UNLOCK-ERPNDM.
 21005
 21006
 21007* EXEC CICS UNLOCK
 21008*         DATASET   (FILE-ERPNDM)
 21009*    END-EXEC
 21010*    MOVE '&*                    #   #00020215' TO DFHEIV0
 21011     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21012     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21013     MOVE X'2020233030303230323135' TO DFHEIV0(25:11)
 21014     CALL 'kxdfhei1' USING DFHEIV0,
 21015           FILE-ERPNDM,
 21016           DFHEIV99
 21017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21018
 21019     .
 21020 8104-EXIT.
 21021     EXIT.
 21022 8110-READ-ERMAIL.
 21023
 21024* EXEC CICS HANDLE CONDITION
 21025*         NOTFND     (8110-NOTFND)
 21026*         ENDFILE    (8110-NOTFND)
 21027*    END-EXEC.
 21028*    MOVE '"$I''                  ! . #00020223' TO DFHEIV0
 21029     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21030     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21031     MOVE X'2E20233030303230323233' TO DFHEIV0(25:11)
 21032     CALL 'kxdfhei1' USING DFHEIV0
 21033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21034
 21035
 21036     MOVE SPACES                 TO ERMAIL-FOUND.
 21037     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 21038     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 21039     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 21040     MOVE PB-SV-STATE            TO MA-STATE.
 21041
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 388
* EL050.cbl
 21042
 21043* EXEC CICS READ
 21044*         UPDATE
 21045*         DATASET   (FILE-ERMAIL)
 21046*         RIDFLD    (MA-CONTROL-PRIMARY)
 21047*         INTO      (MAILING-DATA)
 21048*    END-EXEC.
 21049     MOVE LENGTH OF
 21050      MAILING-DATA
 21051       TO DFHEIV11
 21052*    MOVE '&"IL       EU         (   #00020234' TO DFHEIV0
 21053     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21054     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21055     MOVE X'2020233030303230323334' TO DFHEIV0(25:11)
 21056     CALL 'kxdfhei1' USING DFHEIV0,
 21057           FILE-ERMAIL,
 21058           MAILING-DATA,
 21059           DFHEIV11,
 21060           MA-CONTROL-PRIMARY,
 21061           DFHEIV99,
 21062           DFHEIV99,
 21063           DFHEIV99
 21064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21065
 21066
 21067     GO TO 8110-EXIT.
 21068
 21069 8110-NOTFND.
 21070     MOVE 'X'                    TO ERMAIL-FOUND.
 21071
 21072 8110-EXIT.
 21073     EXIT.
 21074
 21075 8120-REWRITE-ERMAIL.
 21076
 21077* EXEC CICS REWRITE
 21078*         DATASET    (FILE-ERMAIL)
 21079*         FROM       (MAILING-DATA)
 21080*    END-EXEC.
 21081     MOVE LENGTH OF
 21082      MAILING-DATA
 21083       TO DFHEIV11
 21084*    MOVE '&& L                  %   #00020250' TO DFHEIV0
 21085     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21086     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21087     MOVE X'2020233030303230323530' TO DFHEIV0(25:11)
 21088     CALL 'kxdfhei1' USING DFHEIV0,
 21089           FILE-ERMAIL,
 21090           MAILING-DATA,
 21091           DFHEIV11,
 21092           DFHEIV99
 21093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21094
 21095
 21096 8120-EXIT.
 21097     EXIT.
 21098
 21099 8130-WRITE-ERMAIL.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 389
* EL050.cbl
 21100
 21101* EXEC CICS HANDLE CONDITION
 21102*         DUPKEY   (8130-EXIT)
 21103*    END-EXEC.
 21104*    MOVE '"$$                   ! / #00020259' TO DFHEIV0
 21105     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 21106     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21107     MOVE X'2F20233030303230323539' TO DFHEIV0(25:11)
 21108     CALL 'kxdfhei1' USING DFHEIV0
 21109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21110
 21111
 21112
 21113* EXEC CICS WRITE
 21114*         DATASET     (FILE-ERMAIL)
 21115*         RIDFLD      (MA-CONTROL-PRIMARY)
 21116*         FROM        (MAILING-DATA)
 21117*    END-EXEC.
 21118     MOVE LENGTH OF
 21119      MAILING-DATA
 21120       TO DFHEIV11
 21121*    MOVE '&$ L                  ''   #00020263' TO DFHEIV0
 21122     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21123     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21124     MOVE X'2020233030303230323633' TO DFHEIV0(25:11)
 21125     CALL 'kxdfhei1' USING DFHEIV0,
 21126           FILE-ERMAIL,
 21127           MAILING-DATA,
 21128           DFHEIV11,
 21129           MA-CONTROL-PRIMARY,
 21130           DFHEIV99,
 21131           DFHEIV99
 21132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21133
 21134
 21135 8130-EXIT.
 21136     EXIT.
 21137
 21138 8140-UNLOCK-ERMAIL.
 21139
 21140* EXEC CICS UNLOCK
 21141*         DATASET   (FILE-ERMAIL)
 21142*    END-EXEC.
 21143*    MOVE '&*                    #   #00020273' TO DFHEIV0
 21144     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21145     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21146     MOVE X'2020233030303230323733' TO DFHEIV0(25:11)
 21147     CALL 'kxdfhei1' USING DFHEIV0,
 21148           FILE-ERMAIL,
 21149           DFHEIV99
 21150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21151
 21152
 21153 8140-EXIT.
 21154     EXIT.
 21155
 21156 8145-read-elcrtt-upd.
 21157
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 390
* EL050.cbl
 21158     move ' '                    to elcrtt-found-sw
 21159                                    elcrtt-update-sw
 21160
 21161* EXEC CICS HANDLE CONDITION
 21162*        NOTFND   (8145-exit)
 21163*    END-EXEC
 21164*    MOVE '"$I                   ! 0 #00020284' TO DFHEIV0
 21165     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21166     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21167     MOVE X'3020233030303230323834' TO DFHEIV0(25:11)
 21168     CALL 'kxdfhei1' USING DFHEIV0
 21169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21170
 21171     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21172     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21173
 21174
 21175* EXEC CICS READ UPDATE
 21176*        DATASET  (CRTT-ID)
 21177*        RIDFLD   (WS-ELCRTT-KEY)
 21178*        INTO     (CERTIFICATE-TRAILERS)
 21179*    END-EXEC
 21180     MOVE LENGTH OF
 21181      CERTIFICATE-TRAILERS
 21182       TO DFHEIV11
 21183*    MOVE '&"IL       EU         (   #00020291' TO DFHEIV0
 21184     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21185     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21186     MOVE X'2020233030303230323931' TO DFHEIV0(25:11)
 21187     CALL 'kxdfhei1' USING DFHEIV0,
 21188           CRTT-ID,
 21189           CERTIFICATE-TRAILERS,
 21190           DFHEIV11,
 21191           WS-ELCRTT-KEY,
 21192           DFHEIV99,
 21193           DFHEIV99,
 21194           DFHEIV99
 21195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21196
 21197     set elcrtt-found to true
 21198
 21199     .
 21200 8145-exit.
 21201     exit.
 21202 8150-UPDATE-ELCRTT.
 21203
 21204     if elcrtt-found
 21205
 21206* EXEC CICS REWRITE
 21207*           DATASET  (CRTT-ID)
 21208*           FROM     (CERTIFICATE-TRAILERS)
 21209*        END-EXEC
 21210     MOVE LENGTH OF
 21211      CERTIFICATE-TRAILERS
 21212       TO DFHEIV11
 21213*    MOVE '&& L                  %   #00020305' TO DFHEIV0
 21214     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21215     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 391
* EL050.cbl
 21216     MOVE X'2020233030303230333035' TO DFHEIV0(25:11)
 21217     CALL 'kxdfhei1' USING DFHEIV0,
 21218           CRTT-ID,
 21219           CERTIFICATE-TRAILERS,
 21220           DFHEIV11,
 21221           DFHEIV99
 21222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21223     ELSE
 21224
 21225* EXEC CICS WRITE
 21226*          DATASET  (CRTT-ID)
 21227*          RIDFLD   (WS-ELCRTT-KEY)
 21228*          FROM     (CERTIFICATE-TRAILERS)
 21229*       END-EXEC
 21230     MOVE LENGTH OF
 21231      CERTIFICATE-TRAILERS
 21232       TO DFHEIV11
 21233*    MOVE '&$ L                  ''   #00020310' TO DFHEIV0
 21234     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21235     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21236     MOVE X'2020233030303230333130' TO DFHEIV0(25:11)
 21237     CALL 'kxdfhei1' USING DFHEIV0,
 21238           CRTT-ID,
 21239           CERTIFICATE-TRAILERS,
 21240           DFHEIV11,
 21241           WS-ELCRTT-KEY,
 21242           DFHEIV99,
 21243           DFHEIV99
 21244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21245     end-if
 21246
 21247     .
 21248 8150-EXIT.
 21249     EXIT.
 21250
 21251 8155-unlock-elcrtt.
 21252
 21253
 21254* EXEC CICS UNLOCK
 21255*       DATASET  (CRTT-ID)
 21256*    END-EXEC
 21257*    MOVE '&*                    #   #00020323' TO DFHEIV0
 21258     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21259     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21260     MOVE X'2020233030303230333233' TO DFHEIV0(25:11)
 21261     CALL 'kxdfhei1' USING DFHEIV0,
 21262           CRTT-ID,
 21263           DFHEIV99
 21264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21265
 21266     .
 21267 8155-exit.
 21268     exit.
 21269
 21270 8190-UPDATE-REFUND-CLAIM-FLAG.
 21271
 21272* EXEC CICS HANDLE CONDITION
 21273*        NOTFND   (8190-NOTFND)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 392
* EL050.cbl
 21274*    END-EXEC.
 21275*    MOVE '"$I                   ! 1 #00020332' TO DFHEIV0
 21276     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21277     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21278     MOVE X'3120233030303230333332' TO DFHEIV0(25:11)
 21279     CALL 'kxdfhei1' USING DFHEIV0
 21280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21281
 21282
 21283     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21284     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21285
 21286
 21287* EXEC CICS READ
 21288*        UPDATE
 21289*        DATASET  (CRTT-ID)
 21290*        RIDFLD   (WS-ELCRTT-KEY)
 21291*        INTO     (CERTIFICATE-TRAILERS)
 21292*    END-EXEC.
 21293     MOVE LENGTH OF
 21294      CERTIFICATE-TRAILERS
 21295       TO DFHEIV11
 21296*    MOVE '&"IL       EU         (   #00020339' TO DFHEIV0
 21297     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21298     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21299     MOVE X'2020233030303230333339' TO DFHEIV0(25:11)
 21300     CALL 'kxdfhei1' USING DFHEIV0,
 21301           CRTT-ID,
 21302           CERTIFICATE-TRAILERS,
 21303           DFHEIV11,
 21304           WS-ELCRTT-KEY,
 21305           DFHEIV99,
 21306           DFHEIV99,
 21307           DFHEIV99
 21308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21309
 21310
 21311     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21312
 21313* EXEC CICS REWRITE
 21314*       DATASET  (CRTT-ID)
 21315*       FROM     (CERTIFICATE-TRAILERS)
 21316*    END-EXEC.
 21317     MOVE LENGTH OF
 21318      CERTIFICATE-TRAILERS
 21319       TO DFHEIV11
 21320*    MOVE '&& L                  %   #00020347' TO DFHEIV0
 21321     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21322     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21323     MOVE X'2020233030303230333437' TO DFHEIV0(25:11)
 21324     CALL 'kxdfhei1' USING DFHEIV0,
 21325           CRTT-ID,
 21326           CERTIFICATE-TRAILERS,
 21327           DFHEIV11,
 21328           DFHEIV99
 21329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21330
 21331
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 393
* EL050.cbl
 21332     GO TO 8190-EXIT.
 21333
 21334 8190-NOTFND.
 21335
 21336     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21337     MOVE 'CS'         TO CS-RECORD-ID.
 21338     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21339     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21340     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21341     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21342
 21343* EXEC CICS WRITE
 21344*       DATASET  (CRTT-ID)
 21345*       RIDFLD   (WS-ELCRTT-KEY)
 21346*       FROM     (CERTIFICATE-TRAILERS)
 21347*    END-EXEC.
 21348     MOVE LENGTH OF
 21349      CERTIFICATE-TRAILERS
 21350       TO DFHEIV11
 21351*    MOVE '&$ L                  ''   #00020362' TO DFHEIV0
 21352     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21353     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21354     MOVE X'2020233030303230333632' TO DFHEIV0(25:11)
 21355     CALL 'kxdfhei1' USING DFHEIV0,
 21356           CRTT-ID,
 21357           CERTIFICATE-TRAILERS,
 21358           DFHEIV11,
 21359           WS-ELCRTT-KEY,
 21360           DFHEIV99,
 21361           DFHEIV99
 21362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21363
 21364
 21365 8190-EXIT.
 21366     EXIT.
 21367
 21368 8195-UPDATE-AGE-FLAGS.
 21369
 21370* EXEC CICS HANDLE CONDITION
 21371*        NOTFND   (8195-NOTFND)
 21372*    END-EXEC.
 21373*    MOVE '"$I                   ! 2 #00020372' TO DFHEIV0
 21374     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21375     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21376     MOVE X'3220233030303230333732' TO DFHEIV0(25:11)
 21377     CALL 'kxdfhei1' USING DFHEIV0
 21378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21379
 21380
 21381     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21382     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21383
 21384
 21385* EXEC CICS READ
 21386*        UPDATE
 21387*        DATASET  (CRTT-ID)
 21388*        RIDFLD   (WS-ELCRTT-KEY)
 21389*        INTO     (CERTIFICATE-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 394
* EL050.cbl
 21390*    END-EXEC.
 21391     MOVE LENGTH OF
 21392      CERTIFICATE-TRAILERS
 21393       TO DFHEIV11
 21394*    MOVE '&"IL       EU         (   #00020379' TO DFHEIV0
 21395     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21396     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21397     MOVE X'2020233030303230333739' TO DFHEIV0(25:11)
 21398     CALL 'kxdfhei1' USING DFHEIV0,
 21399           CRTT-ID,
 21400           CERTIFICATE-TRAILERS,
 21401           DFHEIV11,
 21402           WS-ELCRTT-KEY,
 21403           DFHEIV99,
 21404           DFHEIV99,
 21405           DFHEIV99
 21406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21407
 21408
 21409     IF WS-INS-AGE-SET = 'Y'
 21410        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 21411     END-IF
 21412     IF WS-JNT-AGE-SET = 'Y'
 21413        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 21414     END-IF
 21415
 21416
 21417* EXEC CICS REWRITE
 21418*       DATASET  (CRTT-ID)
 21419*       FROM     (CERTIFICATE-TRAILERS)
 21420*    END-EXEC.
 21421     MOVE LENGTH OF
 21422      CERTIFICATE-TRAILERS
 21423       TO DFHEIV11
 21424*    MOVE '&& L                  %   #00020393' TO DFHEIV0
 21425     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21426     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21427     MOVE X'2020233030303230333933' TO DFHEIV0(25:11)
 21428     CALL 'kxdfhei1' USING DFHEIV0,
 21429           CRTT-ID,
 21430           CERTIFICATE-TRAILERS,
 21431           DFHEIV11,
 21432           DFHEIV99
 21433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21434
 21435
 21436     GO TO 8195-EXIT.
 21437
 21438 8195-NOTFND.
 21439
 21440     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21441     MOVE 'CS'         TO CS-RECORD-ID.
 21442     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21443     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21444     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21445     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 21446     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 21447
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 395
* EL050.cbl
 21448* EXEC CICS WRITE
 21449*       DATASET  (CRTT-ID)
 21450*       RIDFLD   (WS-ELCRTT-KEY)
 21451*       FROM     (CERTIFICATE-TRAILERS)
 21452*    END-EXEC.
 21453     MOVE LENGTH OF
 21454      CERTIFICATE-TRAILERS
 21455       TO DFHEIV11
 21456*    MOVE '&$ L                  ''   #00020409' TO DFHEIV0
 21457     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21458     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21459     MOVE X'2020233030303230343039' TO DFHEIV0(25:11)
 21460     CALL 'kxdfhei1' USING DFHEIV0,
 21461           CRTT-ID,
 21462           CERTIFICATE-TRAILERS,
 21463           DFHEIV11,
 21464           WS-ELCRTT-KEY,
 21465           DFHEIV99,
 21466           DFHEIV99
 21467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21468
 21469
 21470 8195-EXIT.
 21471     EXIT.
 21472
 21473 8200-READ-REIN-TABLE.
 21474
 21475* EXEC CICS HANDLE CONDITION
 21476*         NOTFND   (8200-NOTFND)
 21477*    END-EXEC.
 21478*    MOVE '"$I                   ! 3 #00020419' TO DFHEIV0
 21479     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21480     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21481     MOVE X'3320233030303230343139' TO DFHEIV0(25:11)
 21482     CALL 'kxdfhei1' USING DFHEIV0
 21483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21484
 21485
 21486
 21487* EXEC CICS READ
 21488*        DATASET     (REIN-ID)
 21489*        SET         (ADDRESS OF REINSURANCE-RECORD)
 21490*        RIDFLD      (ERREIN-KEY)
 21491*    END-EXEC.
 21492*    MOVE '&"S        E          (   #00020423' TO DFHEIV0
 21493     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21494     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21495     MOVE X'2020233030303230343233' TO DFHEIV0(25:11)
 21496     CALL 'kxdfhei1' USING DFHEIV0,
 21497           REIN-ID,
 21498           DFHEIV20,
 21499           DFHEIV99,
 21500           ERREIN-KEY,
 21501           DFHEIV99,
 21502           DFHEIV99,
 21503           DFHEIV99
 21504     SET ADDRESS OF REINSURANCE-RECORD TO
 21505         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 396
* EL050.cbl
 21506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21507
 21508
 21509     GO TO 8200-EXIT.
 21510
 21511 8200-NOTFND.
 21512     MOVE 'N'             TO WS-REIN-READ-SW.
 21513
 21514 8200-EXIT.
 21515      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 397
* EL050.cbl
 21517
 21518 8300-READ-CTBL-TABLE.
 21519
 21520* EXEC CICS HANDLE CONDITION
 21521*        NOTFND    (8300-NOTFND)
 21522*        DISABLED  (8300-ERRESS-PROBLEM)
 21523*        NOTOPEN   (8300-ERRESS-PROBLEM)
 21524*        ENDFILE   (8300-NOTFND)
 21525*    END-EXEC.
 21526*    MOVE '"$IcJ''                ! 4 #00020439' TO DFHEIV0
 21527     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 21528     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21529     MOVE X'3420233030303230343339' TO DFHEIV0(25:11)
 21530     CALL 'kxdfhei1' USING DFHEIV0
 21531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21532
 21533
 21534
 21535* EXEC CICS READ
 21536*        DATASET     (CTBL-ID)
 21537*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 21538*        RIDFLD      (ERCTBL-KEY)
 21539*    END-EXEC.
 21540*    MOVE '&"S        E          (   #00020446' TO DFHEIV0
 21541     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21542     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21543     MOVE X'2020233030303230343436' TO DFHEIV0(25:11)
 21544     CALL 'kxdfhei1' USING DFHEIV0,
 21545           CTBL-ID,
 21546           DFHEIV20,
 21547           DFHEIV99,
 21548           ERCTBL-KEY,
 21549           DFHEIV99,
 21550           DFHEIV99,
 21551           DFHEIV99
 21552     SET ADDRESS OF COMM-TABLE-RECORD TO
 21553         DFHEIV20
 21554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21555
 21556
 21557     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21558
 21559     GO TO 8300-EXIT.
 21560
 21561 8300-NOTFND.
 21562
 21563     IF CTBL-SW = '0530'
 21564         MOVE 'AA'                     TO WS-AH-COMP-CD
 21565         MOVE '0550'                   TO CTBL-SW
 21566         MOVE '1'                      TO WS-CTBL-READ-SW
 21567         GO TO 8300-EXIT.
 21568
 21569     IF CTBL-SW = '0540'
 21570         MOVE 'AA'                     TO WS-LF-COMP-CD
 21571         MOVE '0550'                   TO CTBL-SW
 21572         MOVE '1'                      TO WS-CTBL-READ-SW
 21573         GO TO 8300-EXIT.
 21574
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 398
* EL050.cbl
 21575     IF CTBL-SW = '0550'
 21576         MOVE '2'                      TO WS-CTBL-READ-SW
 21577         GO TO 8300-EXIT.
 21578
 21579     GO TO 8300-EXIT.
 21580
 21581 8300-ERRESS-PROBLEM.
 21582
 21583      MOVE ER-8050              TO WS-ERROR.
 21584      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21585
 21586     GO TO 8300-EXIT.
 21587
 21588 8300-EXIT.
 21589      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 399
* EL050.cbl
 21591
 21592
 21593 8400-GETMAIN-ERFORM.
 21594
 21595
 21596* EXEC CICS   GETMAIN
 21597*        LENGTH  (500)
 21598*        SET     (ADDRESS OF FORM-MASTER)
 21599*    END-EXEC.
 21600     MOVE 500
 21601       TO DFHEIV11
 21602*    MOVE '," L                  $   #00020490' TO DFHEIV0
 21603     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21604     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21605     MOVE X'2020233030303230343930' TO DFHEIV0(25:11)
 21606     CALL 'kxdfhei1' USING DFHEIV0,
 21607           DFHEIV20,
 21608           DFHEIV11,
 21609           DFHEIV99
 21610     SET ADDRESS OF FORM-MASTER TO
 21611         DFHEIV20
 21612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21613
 21614
 21615     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 21616
 21617 8400-EXIT.
 21618      EXIT.
 21619
 21620 8450-READ-FORM-MASTER.
 21621
 21622
 21623* EXEC CICS  HANDLE CONDITION
 21624*        NOTFND   (8450-FORM-NOT-FOUND)
 21625*        ENDFILE  (8450-FORM-NOT-FOUND)
 21626*    END-EXEC.
 21627*    MOVE '"$I''                  ! 5 #00020502' TO DFHEIV0
 21628     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21629     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21630     MOVE X'3520233030303230353032' TO DFHEIV0(25:11)
 21631     CALL 'kxdfhei1' USING DFHEIV0
 21632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21633
 21634
 21635
 21636* EXEC CICS   READ
 21637*        DATASET   (FORM-ID)
 21638*        RIDFLD    (ERFORM-KEY)
 21639*        INTO      (FORM-MASTER)
 21640*        GTEQ
 21641*    END-EXEC.
 21642     MOVE LENGTH OF
 21643      FORM-MASTER
 21644       TO DFHEIV11
 21645*    MOVE '&"IL       G          (   #00020507' TO DFHEIV0
 21646     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21647     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21648     MOVE X'2020233030303230353037' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 400
* EL050.cbl
 21649     CALL 'kxdfhei1' USING DFHEIV0,
 21650           FORM-ID,
 21651           FORM-MASTER,
 21652           DFHEIV11,
 21653           ERFORM-KEY,
 21654           DFHEIV99,
 21655           DFHEIV99,
 21656           DFHEIV99
 21657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21658
 21659
 21660     MOVE  'Y'           TO  FORM-MASTER-SW.
 21661
 21662     GO TO  8450-EXIT.
 21663
 21664 8450-FORM-NOT-FOUND.
 21665
 21666     MOVE  'N'           TO  FORM-MASTER-SW.
 21667
 21668 8450-EXIT.
 21669      EXIT.
 21670
 21671 8500-DATE-CONVERT.
 21672
 21673* EXEC CICS LINK
 21674*        PROGRAM    ('ELDATCV')
 21675*        COMMAREA   (DATE-CONVERSION-DATA)
 21676*        LENGTH     (DC-COMM-LENGTH)
 21677*    END-EXEC.
 21678     MOVE 'ELDATCV' TO DFHEIV1
 21679*    MOVE '."C                   (   #00020526' TO DFHEIV0
 21680     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21681     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21682     MOVE X'2020233030303230353236' TO DFHEIV0(25:11)
 21683     CALL 'kxdfhei1' USING DFHEIV0,
 21684           DFHEIV1,
 21685           DATE-CONVERSION-DATA,
 21686           DC-COMM-LENGTH,
 21687           DFHEIV99,
 21688           DFHEIV99,
 21689           DFHEIV99,
 21690           DFHEIV99
 21691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21692
 21693
 21694 8500-EXIT.
 21695     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 401
* EL050.cbl
 21697
 21698 8555-RELOAD-CONTROL-FILE.
 21699     CONTINUE.
 21700
 21701 8555-EXIT.
 21702     EXIT.
 21703
 21704 8557-GETMAIN-ERPLAN.
 21705
 21706
 21707* EXEC CICS GETMAIN
 21708*        LENGTH    (840)
 21709*        SET       (ADDRESS OF PLAN-RECORDS)
 21710*    END-EXEC.
 21711     MOVE 840
 21712       TO DFHEIV11
 21713*    MOVE '," L                  $   #00020544' TO DFHEIV0
 21714     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21715     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21716     MOVE X'2020233030303230353434' TO DFHEIV0(25:11)
 21717     CALL 'kxdfhei1' USING DFHEIV0,
 21718           DFHEIV20,
 21719           DFHEIV11,
 21720           DFHEIV99
 21721     SET ADDRESS OF PLAN-RECORDS TO
 21722         DFHEIV20
 21723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21724
 21725
 21726     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 21727
 21728 8557-EXIT.
 21729     EXIT.
 21730
 21731 8560-GETMAIN.
 21732
 21733* EXEC CICS GETMAIN
 21734*        LENGTH    (2000)
 21735*        SET       (ADDRESS OF ACCOUNT-MASTER)
 21736*    END-EXEC.
 21737     MOVE 2000
 21738       TO DFHEIV11
 21739*    MOVE '," L                  $   #00020555' TO DFHEIV0
 21740     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21741     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21742     MOVE X'2020233030303230353535' TO DFHEIV0(25:11)
 21743     CALL 'kxdfhei1' USING DFHEIV0,
 21744           DFHEIV20,
 21745           DFHEIV11,
 21746           DFHEIV99
 21747     SET ADDRESS OF ACCOUNT-MASTER TO
 21748         DFHEIV20
 21749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21750
 21751
 21752     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 21753
 21754 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 402
* EL050.cbl
 21755     EXIT.
 21756
 21757 8570-START-ACCOUNT-MASTER.
 21758
 21759* EXEC CICS HANDLE CONDITION
 21760*        NOTFND    (0199-ACCT-NOT-FOUND)
 21761*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21762*    END-EXEC.
 21763*    MOVE '"$I''                  ! 6 #00020566' TO DFHEIV0
 21764     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21765     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21766     MOVE X'3620233030303230353636' TO DFHEIV0(25:11)
 21767     CALL 'kxdfhei1' USING DFHEIV0
 21768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21769
 21770
 21771
 21772* EXEC CICS STARTBR
 21773*        DATASET    (ACCT-ID)
 21774*        RIDFLD     (ERACCT-KEY)
 21775*        GTEQ
 21776*    END-EXEC.
 21777     MOVE 0
 21778       TO DFHEIV11
 21779*    MOVE '&,         G          &   #00020571' TO DFHEIV0
 21780     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21781     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21782     MOVE X'2020233030303230353731' TO DFHEIV0(25:11)
 21783     CALL 'kxdfhei1' USING DFHEIV0,
 21784           ACCT-ID,
 21785           ERACCT-KEY,
 21786           DFHEIV99,
 21787           DFHEIV11,
 21788           DFHEIV99
 21789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21790
 21791
 21792 8570-EXIT.
 21793     EXIT.
 21794
 21795 8580-READ-ACCOUNT-MASTER.
 21796
 21797* EXEC CICS HANDLE CONDITION
 21798*        NOTFND    (0199-ACCT-NOT-FOUND)
 21799*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21800*    END-EXEC.
 21801*    MOVE '"$I''                  ! 7 #00020581' TO DFHEIV0
 21802     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21803     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21804     MOVE X'3720233030303230353831' TO DFHEIV0(25:11)
 21805     CALL 'kxdfhei1' USING DFHEIV0
 21806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21807
 21808
 21809
 21810* EXEC CICS READNEXT
 21811*        DATASET     (ACCT-ID)
 21812*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 403
* EL050.cbl
 21813*        RIDFLD      (ERACCT-KEY)
 21814*    END-EXEC.
 21815     MOVE LENGTH OF
 21816      ACCOUNT-MASTER
 21817       TO DFHEIV12
 21818     MOVE 0
 21819       TO DFHEIV11
 21820*    MOVE '&.IL                  )   #00020586' TO DFHEIV0
 21821     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21822     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21823     MOVE X'2020233030303230353836' TO DFHEIV0(25:11)
 21824     CALL 'kxdfhei1' USING DFHEIV0,
 21825           ACCT-ID,
 21826           ACCOUNT-MASTER,
 21827           DFHEIV12,
 21828           ERACCT-KEY,
 21829           DFHEIV99,
 21830           DFHEIV11,
 21831           DFHEIV99,
 21832           DFHEIV99
 21833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21834
 21835
 21836 8580-EXIT.
 21837     EXIT.
 21838
 21839 8582-READ-COMPENSATION-MASTER.
 21840
 21841* EXEC CICS HANDLE CONDITION
 21842*        NOTFND    (8582-COMP-NOT-FOUND)
 21843*        ENDFILE   (8582-COMP-NOT-FOUND)
 21844*    END-EXEC.
 21845*    MOVE '"$I''                  ! 8 #00020596' TO DFHEIV0
 21846     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21847     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21848     MOVE X'3820233030303230353936' TO DFHEIV0(25:11)
 21849     CALL 'kxdfhei1' USING DFHEIV0
 21850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21851
 21852
 21853
 21854* EXEC CICS READ
 21855*        DATASET     (COMP-ID)
 21856*        INTO        (COMPENSATION-MASTER)
 21857*        RIDFLD      (ERCOMP-KEY)
 21858*    END-EXEC.
 21859     MOVE LENGTH OF
 21860      COMPENSATION-MASTER
 21861       TO DFHEIV11
 21862*    MOVE '&"IL       E          (   #00020601' TO DFHEIV0
 21863     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21864     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21865     MOVE X'2020233030303230363031' TO DFHEIV0(25:11)
 21866     CALL 'kxdfhei1' USING DFHEIV0,
 21867           COMP-ID,
 21868           COMPENSATION-MASTER,
 21869           DFHEIV11,
 21870           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 404
* EL050.cbl
 21871           DFHEIV99,
 21872           DFHEIV99,
 21873           DFHEIV99
 21874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21875
 21876
 21877     MOVE 'Y'                    TO COMP-MASTER-SW
 21878
 21879     GO TO 8582-EXIT
 21880     .
 21881 8582-COMP-NOT-FOUND.
 21882
 21883     MOVE 'N'                    TO COMP-MASTER-SW.
 21884
 21885 8582-EXIT.
 21886     EXIT.
 21887
 21888 8583-READ-ERAGTC.
 21889
 21890* EXEC CICS HANDLE CONDITION
 21891*        NOTFND    (8583-AGTC-NOT-FOUND)
 21892*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21893*    END-EXEC.
 21894*    MOVE '"$I''                  ! 9 #00020619' TO DFHEIV0
 21895     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21896     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21897     MOVE X'3920233030303230363139' TO DFHEIV0(25:11)
 21898     CALL 'kxdfhei1' USING DFHEIV0
 21899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21900
 21901
 21902
 21903* EXEC CICS STARTBR
 21904*        DATASET    (AGTC-ID)
 21905*        RIDFLD     (ERAGTC-KEY)
 21906*        GTEQ
 21907*    END-EXEC.
 21908     MOVE 0
 21909       TO DFHEIV11
 21910*    MOVE '&,         G          &   #00020624' TO DFHEIV0
 21911     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21912     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21913     MOVE X'2020233030303230363234' TO DFHEIV0(25:11)
 21914     CALL 'kxdfhei1' USING DFHEIV0,
 21915           AGTC-ID,
 21916           ERAGTC-KEY,
 21917           DFHEIV99,
 21918           DFHEIV11,
 21919           DFHEIV99
 21920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21921
 21922
 21923 8583-READ-ERAGTC-NEXT.
 21924
 21925* EXEC CICS READNEXT
 21926*        DATASET     (AGTC-ID)
 21927*        INTO        (AGENT-COMMISSIONS)
 21928*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 405
* EL050.cbl
 21929*    END-EXEC.
 21930     MOVE LENGTH OF
 21931      AGENT-COMMISSIONS
 21932       TO DFHEIV12
 21933     MOVE 0
 21934       TO DFHEIV11
 21935*    MOVE '&.IL                  )   #00020631' TO DFHEIV0
 21936     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21937     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21938     MOVE X'2020233030303230363331' TO DFHEIV0(25:11)
 21939     CALL 'kxdfhei1' USING DFHEIV0,
 21940           AGTC-ID,
 21941           AGENT-COMMISSIONS,
 21942           DFHEIV12,
 21943           ERAGTC-KEY,
 21944           DFHEIV99,
 21945           DFHEIV11,
 21946           DFHEIV99,
 21947           DFHEIV99
 21948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21949
 21950
 21951*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21952
 21953     GO TO 8583-EXIT
 21954     .
 21955 8583-AGTC-NOT-FOUND.
 21956
 21957     MOVE 'N'                    TO AGTC-MASTER-SW.
 21958
 21959 8583-EXIT.
 21960     EXIT.
 21961
 21962 8584-READ-BANK-CROSS-REF.
 21963
 21964* EXEC CICS HANDLE CONDITION
 21965*        NOTFND    (8584-BXRF-NOT-FOUND)
 21966*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21967*    END-EXEC.
 21968*    MOVE '"$I''                  ! : #00020649' TO DFHEIV0
 21969     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21970     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21971     MOVE X'3A20233030303230363439' TO DFHEIV0(25:11)
 21972     CALL 'kxdfhei1' USING DFHEIV0
 21973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21974
 21975
 21976
 21977* EXEC CICS READ
 21978*        DATASET     (BXRF-ID)
 21979*        INTO        (BANK-CROSS-REFERENCE)
 21980*        RIDFLD      (ERBXRF-KEY)
 21981*        LENGTH      (BXRF-REC-LENGTH)
 21982*    END-EXEC.
 21983*    MOVE '&"IL       E          (   #00020654' TO DFHEIV0
 21984     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21985     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21986     MOVE X'2020233030303230363534' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 406
* EL050.cbl
 21987     CALL 'kxdfhei1' USING DFHEIV0,
 21988           BXRF-ID,
 21989           BANK-CROSS-REFERENCE,
 21990           BXRF-REC-LENGTH,
 21991           ERBXRF-KEY,
 21992           DFHEIV99,
 21993           DFHEIV99,
 21994           DFHEIV99
 21995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21996
 21997
 21998     MOVE 'Y'                    TO BXRF-MASTER-SW
 21999
 22000     GO TO 8584-EXIT
 22001     .
 22002 8584-BXRF-NOT-FOUND.
 22003
 22004     MOVE 'N'                    TO BXRF-MASTER-SW.
 22005
 22006 8584-EXIT.
 22007     EXIT.
 22008
 22009 8585-READ-PLAN-MASTER.
 22010
 22011
 22012* EXEC CICS HANDLE CONDITION
 22013*        NOTFND    (8585-PLAN-NOT-FOUND)
 22014*        ENDFILE   (8585-PLAN-NOT-FOUND)
 22015*    END-EXEC.
 22016*    MOVE '"$I''                  ! ; #00020674' TO DFHEIV0
 22017     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22018     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22019     MOVE X'3B20233030303230363734' TO DFHEIV0(25:11)
 22020     CALL 'kxdfhei1' USING DFHEIV0
 22021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22022
 22023
 22024
 22025* EXEC CICS READ
 22026*        DATASET     (PLAN-ID)
 22027*        INTO        (PLAN-MASTER)
 22028*        RIDFLD      (ERPLAN-KEY)
 22029*    END-EXEC.
 22030     MOVE LENGTH OF
 22031      PLAN-MASTER
 22032       TO DFHEIV11
 22033*    MOVE '&"IL       E          (   #00020679' TO DFHEIV0
 22034     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22035     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22036     MOVE X'2020233030303230363739' TO DFHEIV0(25:11)
 22037     CALL 'kxdfhei1' USING DFHEIV0,
 22038           PLAN-ID,
 22039           PLAN-MASTER,
 22040           DFHEIV11,
 22041           ERPLAN-KEY,
 22042           DFHEIV99,
 22043           DFHEIV99,
 22044           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 407
* EL050.cbl
 22045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22046
 22047
 22048     MOVE 'Y'                    TO PLAN-MASTER-SW.
 22049
 22050     GO TO 8585-EXIT.
 22051
 22052 8585-PLAN-NOT-FOUND.
 22053
 22054     MOVE 'N'                    TO PLAN-MASTER-SW.
 22055
 22056 8585-EXIT.
 22057     EXIT.
 22058
 22059 8586-READ-LOAN-OFFICER.
 22060
 22061* EXEC CICS READ
 22062*        DATASET     (LOFC-ID)
 22063*        INTO        (LOAN-OFFICER-MASTER)
 22064*        RIDFLD      (ERLOFC-KEY)
 22065*        RESP        (WS-RESPONSE)
 22066*    END-EXEC
 22067     MOVE LENGTH OF
 22068      LOAN-OFFICER-MASTER
 22069       TO DFHEIV11
 22070*    MOVE '&"IL       E          (  N#00020697' TO DFHEIV0
 22071     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22072     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22073     MOVE X'204E233030303230363937' TO DFHEIV0(25:11)
 22074     CALL 'kxdfhei1' USING DFHEIV0,
 22075           LOFC-ID,
 22076           LOAN-OFFICER-MASTER,
 22077           DFHEIV11,
 22078           ERLOFC-KEY,
 22079           DFHEIV99,
 22080           DFHEIV99,
 22081           DFHEIV99
 22082     MOVE EIBRESP  TO WS-RESPONSE
 22083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22084
 22085     IF WS-RESP-NORMAL
 22086        MOVE 'Y'                 TO LOFC-MASTER-SW
 22087     ELSE
 22088        MOVE 'N'                 TO LOFC-MASTER-SW
 22089     END-IF
 22090     .
 22091 8586-EXIT.
 22092     EXIT.
 22093 8587-START-ERPDEF.
 22094
 22095* EXEC CICS STARTBR
 22096*       DATASET   (PDEF-ID)
 22097*       RIDFLD    (ERPDEF-KEY)
 22098*       GTEQ
 22099*       RESP      (WS-RESPONSE)
 22100*    END-EXEC
 22101     MOVE 0
 22102       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 408
* EL050.cbl
 22103*    MOVE '&,         G          &  N#00020713' TO DFHEIV0
 22104     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22105     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22106     MOVE X'204E233030303230373133' TO DFHEIV0(25:11)
 22107     CALL 'kxdfhei1' USING DFHEIV0,
 22108           PDEF-ID,
 22109           ERPDEF-KEY,
 22110           DFHEIV99,
 22111           DFHEIV11,
 22112           DFHEIV99
 22113     MOVE EIBRESP  TO WS-RESPONSE
 22114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22115     IF WS-RESP-NORMAL
 22116        MOVE 'Y'                 TO PDEF-MASTER-SW
 22117     ELSE
 22118        MOVE 'N'                 TO PDEF-MASTER-SW
 22119     END-IF
 22120     .
 22121 8587-EXIT.
 22122     EXIT.
 22123 8588-READ-ERPDEF.
 22124
 22125* EXEC CICS READNEXT
 22126*       DATASET   (PDEF-ID)
 22127*       RIDFLD    (ERPDEF-KEY)
 22128*       INTO      (PRODUCT-MASTER)
 22129*       RESP      (WS-RESPONSE)
 22130*    END-EXEC
 22131     MOVE LENGTH OF
 22132      PRODUCT-MASTER
 22133       TO DFHEIV12
 22134     MOVE 0
 22135       TO DFHEIV11
 22136*    MOVE '&.IL                  )  N#00020728' TO DFHEIV0
 22137     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22138     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22139     MOVE X'204E233030303230373238' TO DFHEIV0(25:11)
 22140     CALL 'kxdfhei1' USING DFHEIV0,
 22141           PDEF-ID,
 22142           PRODUCT-MASTER,
 22143           DFHEIV12,
 22144           ERPDEF-KEY,
 22145           DFHEIV99,
 22146           DFHEIV11,
 22147           DFHEIV99,
 22148           DFHEIV99
 22149     MOVE EIBRESP  TO WS-RESPONSE
 22150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22151     IF WS-RESP-NORMAL
 22152        MOVE 'Y'                 TO PDEF-MASTER-SW
 22153     ELSE
 22154        MOVE 'N'                 TO PDEF-MASTER-SW
 22155     END-IF
 22156     .
 22157 8588-EXIT.
 22158     EXIT.
 22159 8589-ENDBR-ERPDEF.
 22160
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 409
* EL050.cbl
 22161* EXEC CICS ENDBR
 22162*       DATASET   (PDEF-ID)
 22163*    END-EXEC
 22164     MOVE 0
 22165       TO DFHEIV11
 22166*    MOVE '&2                    $   #00020743' TO DFHEIV0
 22167     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22168     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22169     MOVE X'2020233030303230373433' TO DFHEIV0(25:11)
 22170     CALL 'kxdfhei1' USING DFHEIV0,
 22171           PDEF-ID,
 22172           DFHEIV11,
 22173           DFHEIV99
 22174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22175     .
 22176 8589-EXIT.
 22177     EXIT.
 22178 8590-READ-CERT-MASTER.
 22179     IF PB-COMPANY-ID = 'UCL'
 22180         GO TO 8690-READ-CERT-MASTER-UCL.
 22181
 22182
 22183* EXEC CICS HANDLE CONDITION
 22184*         NOTFND    (0299-CERT-NOT-FOUND)
 22185*    END-EXEC.
 22186*    MOVE '"$I                   ! < #00020753' TO DFHEIV0
 22187     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22188     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22189     MOVE X'3C20233030303230373533' TO DFHEIV0(25:11)
 22190     CALL 'kxdfhei1' USING DFHEIV0
 22191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22192
 22193
 22194
 22195* EXEC CICS READ
 22196*        DATASET     (CERT-ID)
 22197*        INTO        (CERTIFICATE-MASTER)
 22198*        RIDFLD      (ELCERT-KEY)
 22199*        UPDATE
 22200*    END-EXEC.
 22201     MOVE LENGTH OF
 22202      CERTIFICATE-MASTER
 22203       TO DFHEIV11
 22204*    MOVE '&"IL       EU         (   #00020757' TO DFHEIV0
 22205     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22206     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22207     MOVE X'2020233030303230373537' TO DFHEIV0(25:11)
 22208     CALL 'kxdfhei1' USING DFHEIV0,
 22209           CERT-ID,
 22210           CERTIFICATE-MASTER,
 22211           DFHEIV11,
 22212           ELCERT-KEY,
 22213           DFHEIV99,
 22214           DFHEIV99,
 22215           DFHEIV99
 22216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22217
 22218
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 410
* EL050.cbl
 22219 8590-EXIT.
 22220     EXIT.
 22221
 22222 8690-READ-CERT-MASTER-UCL.
 22223
 22224* EXEC CICS HANDLE CONDITION
 22225*         NOTFND    (8700-READ-CERT-MASTER)
 22226*    END-EXEC.
 22227*    MOVE '"$I                   ! = #00020768' TO DFHEIV0
 22228     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22229     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22230     MOVE X'3D20233030303230373638' TO DFHEIV0(25:11)
 22231     CALL 'kxdfhei1' USING DFHEIV0
 22232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22233
 22234
 22235 8690-READ-CERT-CONT.
 22236
 22237* EXEC CICS READ
 22238*        DATASET     (CERT-ID)
 22239*        INTO        (CERTIFICATE-MASTER)
 22240*        RIDFLD      (ELCERT-KEY)
 22241*        UPDATE
 22242*    END-EXEC.
 22243     MOVE LENGTH OF
 22244      CERTIFICATE-MASTER
 22245       TO DFHEIV11
 22246*    MOVE '&"IL       EU         (   #00020773' TO DFHEIV0
 22247     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22248     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22249     MOVE X'2020233030303230373733' TO DFHEIV0(25:11)
 22250     CALL 'kxdfhei1' USING DFHEIV0,
 22251           CERT-ID,
 22252           CERTIFICATE-MASTER,
 22253           DFHEIV11,
 22254           ELCERT-KEY,
 22255           DFHEIV99,
 22256           DFHEIV99,
 22257           DFHEIV99
 22258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22259
 22260
 22261     GO TO 8590-EXIT.
 22262
 22263 8700-READ-CERT-MASTER.
 22264     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 22265     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 22266
 22267* EXEC CICS HANDLE CONDITION
 22268*         DUPKEY    (8720-COMP-ACCOUNTS)
 22269*         ENDFILE   (8730-END-BROWSE)
 22270*         NOTFND    (8740-NOT-FOUND)
 22271*    END-EXEC.
 22272*    MOVE '"$$''I                 ! > #00020785' TO DFHEIV0
 22273     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 22274     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22275     MOVE X'3E20233030303230373835' TO DFHEIV0(25:11)
 22276     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 411
* EL050.cbl
 22277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22278
 22279
 22280
 22281* EXEC CICS STARTBR
 22282*        DATASET     ('ELCERT5')
 22283*        RIDFLD      (ELCERT2-KEY)
 22284*        EQUAL
 22285*    END-EXEC.
 22286     MOVE 'ELCERT5' TO DFHEIV1
 22287     MOVE 0
 22288       TO DFHEIV11
 22289*    MOVE '&,         E          &   #00020791' TO DFHEIV0
 22290     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 22291     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22292     MOVE X'2020233030303230373931' TO DFHEIV0(25:11)
 22293     CALL 'kxdfhei1' USING DFHEIV0,
 22294           DFHEIV1,
 22295           ELCERT2-KEY,
 22296           DFHEIV99,
 22297           DFHEIV11,
 22298           DFHEIV99
 22299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22300
 22301
 22302 8710-READ-NEXT.
 22303
 22304* EXEC CICS READNEXT
 22305*        DATASET     ('ELCERT5')
 22306*        INTO        (CERTIFICATE-MASTER)
 22307*        RIDFLD      (ELCERT2-KEY)
 22308*    END-EXEC.
 22309     MOVE LENGTH OF
 22310      CERTIFICATE-MASTER
 22311       TO DFHEIV12
 22312     MOVE 'ELCERT5' TO DFHEIV1
 22313     MOVE 0
 22314       TO DFHEIV11
 22315*    MOVE '&.IL                  )   #00020798' TO DFHEIV0
 22316     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22317     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22318     MOVE X'2020233030303230373938' TO DFHEIV0(25:11)
 22319     CALL 'kxdfhei1' USING DFHEIV0,
 22320           DFHEIV1,
 22321           CERTIFICATE-MASTER,
 22322           DFHEIV12,
 22323           ELCERT2-KEY,
 22324           DFHEIV99,
 22325           DFHEIV11,
 22326           DFHEIV99,
 22327           DFHEIV99
 22328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22329
 22330
 22331 8720-COMP-ACCOUNTS.
 22332
 22333* EXEC CICS ENTER
 22334*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 412
* EL050.cbl
 22335*         FROM (PB-C-LAST-NAME)
 22336*    END-EXEC.
 22337     MOVE 001
 22338       TO DFHEIV11
 22339*    MOVE ':$F                   %   #00020805' TO DFHEIV0
 22340     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22341     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22342     MOVE X'2020233030303230383035' TO DFHEIV0(25:11)
 22343     CALL 'kxdfhei1' USING DFHEIV0,
 22344           DFHEIV11,
 22345           PB-C-LAST-NAME,
 22346           DFHEIV99,
 22347           DFHEIV99
 22348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22349
 22350
 22351
 22352* EXEC CICS ENTER
 22353*         TRACEID (002)
 22354*         FROM (CM-INSURED-LAST-NAME)
 22355*    END-EXEC.
 22356     MOVE 002
 22357       TO DFHEIV11
 22358*    MOVE ':$F                   %   #00020810' TO DFHEIV0
 22359     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22360     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22361     MOVE X'2020233030303230383130' TO DFHEIV0(25:11)
 22362     CALL 'kxdfhei1' USING DFHEIV0,
 22363           DFHEIV11,
 22364           CM-INSURED-LAST-NAME,
 22365           DFHEIV99,
 22366           DFHEIV99
 22367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22368
 22369
 22370     IF PB-CERT-NO NOT = CM-CERT-NO
 22371         GO TO 8730-END-BROWSE.
 22372
 22373     IF PB-ACCOUNT = CM-ACCOUNT
 22374         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 22375             MOVE ER-2799        TO WS-ERROR
 22376             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22377             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 22378             GO TO 8730-END-BROWSE.
 22379
 22380     GO TO 8710-READ-NEXT.
 22381
 22382 8730-END-BROWSE.
 22383
 22384* EXEC CICS ENDBR
 22385*         DATASET    ('ELCERT5')
 22386*    END-EXEC.
 22387     MOVE 'ELCERT5' TO DFHEIV1
 22388     MOVE 0
 22389       TO DFHEIV11
 22390*    MOVE '&2                    $   #00020828' TO DFHEIV0
 22391     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22392     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 413
* EL050.cbl
 22393     MOVE X'2020233030303230383238' TO DFHEIV0(25:11)
 22394     CALL 'kxdfhei1' USING DFHEIV0,
 22395           DFHEIV1,
 22396           DFHEIV11,
 22397           DFHEIV99
 22398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22399
 22400
 22401 8740-NOT-FOUND.
 22402     GO TO 0299-CERT-NOT-FOUND.
 22403
 22404 8750-START-ELSTAT.
 22405
 22406* EXEC CICS STARTBR
 22407*       DATASET   (STAT-ID)
 22408*       RIDFLD    (ELSTAT-KEY)
 22409*       GTEQ
 22410*       RESP      (WS-RESPONSE)
 22411*    END-EXEC
 22412     MOVE 0
 22413       TO DFHEIV11
 22414*    MOVE '&,         G          &  N#00020836' TO DFHEIV0
 22415     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22416     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22417     MOVE X'204E233030303230383336' TO DFHEIV0(25:11)
 22418     CALL 'kxdfhei1' USING DFHEIV0,
 22419           STAT-ID,
 22420           ELSTAT-KEY,
 22421           DFHEIV99,
 22422           DFHEIV11,
 22423           DFHEIV99
 22424     MOVE EIBRESP  TO WS-RESPONSE
 22425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22426     IF WS-RESP-NORMAL
 22427        MOVE 'Y'                 TO STAT-MASTER-SW
 22428     ELSE
 22429        MOVE 'N'                 TO STAT-MASTER-SW
 22430     END-IF
 22431     .
 22432 8750-EXIT.
 22433     EXIT.
 22434 8752-READ-ELSTAT.
 22435
 22436* EXEC CICS READNEXT
 22437*       DATASET   (STAT-ID)
 22438*       RIDFLD    (ELSTAT-KEY)
 22439*       INTO      (STATE-FILE)
 22440*       RESP      (WS-RESPONSE)
 22441*    END-EXEC
 22442     MOVE LENGTH OF
 22443      STATE-FILE
 22444       TO DFHEIV12
 22445     MOVE 0
 22446       TO DFHEIV11
 22447*    MOVE '&.IL                  )  N#00020851' TO DFHEIV0
 22448     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22449     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22450     MOVE X'204E233030303230383531' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 414
* EL050.cbl
 22451     CALL 'kxdfhei1' USING DFHEIV0,
 22452           STAT-ID,
 22453           STATE-FILE,
 22454           DFHEIV12,
 22455           ELSTAT-KEY,
 22456           DFHEIV99,
 22457           DFHEIV11,
 22458           DFHEIV99,
 22459           DFHEIV99
 22460     MOVE EIBRESP  TO WS-RESPONSE
 22461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22462     IF WS-RESP-NORMAL
 22463        MOVE 'Y'                 TO STAT-MASTER-SW
 22464     ELSE
 22465        MOVE 'N'                 TO STAT-MASTER-SW
 22466     END-IF
 22467     .
 22468 8752-EXIT.
 22469     EXIT.
 22470 8800-GET-COMP-RATE.
 22471     MOVE +1 TO IB.
 22472     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 22473         ADD +9 TO IB
 22474         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 22475             ADD +9 TO IB
 22476             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 22477                MOVE ZEROS       TO WS-WK-RATE
 22478                GO TO 8800-EXIT.
 22479
 22480     IF PB-I-AGE GREATER CT-AGE (1)
 22481         ADD +3 TO IB
 22482         IF PB-I-AGE GREATER CT-AGE (2)
 22483             ADD +3 TO IB
 22484             IF PB-I-AGE GREATER CT-AGE (3)
 22485                MOVE ZEROS       TO WS-WK-RATE
 22486                GO TO 8800-EXIT.
 22487
 22488     IF WS-WORK-TERM GREATER CT-TRM (1)
 22489         ADD +1 TO IB
 22490         IF WS-WORK-TERM GREATER CT-TRM (2)
 22491             ADD +1 TO IB
 22492             IF WS-WORK-TERM GREATER CT-TRM (3)
 22493                MOVE ZEROS       TO WS-WK-RATE
 22494                GO TO 8800-EXIT.
 22495
 22496     IF CT-RT (IB) NOT NUMERIC
 22497         MOVE CT-RT-R (IB) TO CTBL-TABLE
 22498         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 22499         GO TO 8800-GET-COMP-RATE.
 22500
 22501     MOVE CT-RT (IB) TO WS-WK-RATE.
 22502
 22503 8800-EXIT.
 22504     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 415
* EL050.cbl
 22506 8900-ADDRESS-FILE.
 22507     IF ERACCT-FILE-ADDRESSED
 22508         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 22509         GO TO 8900-ADDRESS-EXIT.
 22510
 22511     IF ELCNTL-FILE-ADDRESSED
 22512         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 22513         GO TO 8900-ADDRESS-EXIT.
 22514
 22515     IF ERPLAN-FILE-ADDRESSED
 22516         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 22517         GO TO 8900-ADDRESS-EXIT.
 22518
 22519     IF ERFORM-FILE-ADDRESSED
 22520         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 22521         GO TO 8900-ADDRESS-EXIT.
 22522
 22523 8900-ADDRESS-EXIT.
 22524     EXIT.
 22525
 22526 9000-READ-CONTROL.
 22527
 22528* EXEC CICS HANDLE CONDITION
 22529*        NOTFND    (9000-NOTFND)
 22530*    END-EXEC.
 22531*    MOVE '"$I                   ! ? #00020922' TO DFHEIV0
 22532     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22533     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22534     MOVE X'3F20233030303230393232' TO DFHEIV0(25:11)
 22535     CALL 'kxdfhei1' USING DFHEIV0
 22536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22537
 22538
 22539
 22540* EXEC CICS READ
 22541*        DATASET     (CNTL-ID)
 22542*        SET         (ADDRESS OF CONTROL-FILE)
 22543*        RIDFLD      (ELCNTL-KEY)
 22544*        GTEQ
 22545*    END-EXEC.
 22546*    MOVE '&"S        G          (   #00020926' TO DFHEIV0
 22547     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22548     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22549     MOVE X'2020233030303230393236' TO DFHEIV0(25:11)
 22550     CALL 'kxdfhei1' USING DFHEIV0,
 22551           CNTL-ID,
 22552           DFHEIV20,
 22553           DFHEIV99,
 22554           ELCNTL-KEY,
 22555           DFHEIV99,
 22556           DFHEIV99,
 22557           DFHEIV99
 22558     SET ADDRESS OF CONTROL-FILE TO
 22559         DFHEIV20
 22560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22561
 22562
 22563     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 416
* EL050.cbl
 22564
 22565 9000-NOTFND.
 22566     IF RC-SW-1 = '1'
 22567        MOVE ER-2616              TO WS-ERROR
 22568        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22569        GO TO 9000-EXIT.
 22570
 22571     IF RC-SW-1 = '2'
 22572        MOVE ER-2602              TO WS-ERROR
 22573        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22574
 22575 9000-EXIT.
 22576      EXIT.
 22577
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 417
* EL050.cbl
 22579 9100-READ-CONTROL.
 22580
 22581* EXEC CICS HANDLE CONDITION
 22582*        NOTFND  (9100-NOTFND)
 22583*        ENDFILE (9100-NOTFND)
 22584*    END-EXEC.
 22585*    MOVE '"$I''                  ! @ #00020950' TO DFHEIV0
 22586     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22587     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22588     MOVE X'4020233030303230393530' TO DFHEIV0(25:11)
 22589     CALL 'kxdfhei1' USING DFHEIV0
 22590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22591
 22592
 22593
 22594* EXEC CICS READ
 22595*        DATASET     (CNTL-ID)
 22596*        INTO        (CONTROL-FILE)
 22597*        RIDFLD      (ELCNTL-KEY)
 22598*        GTEQ
 22599*    END-EXEC.
 22600     MOVE LENGTH OF
 22601      CONTROL-FILE
 22602       TO DFHEIV11
 22603*    MOVE '&"IL       G          (   #00020955' TO DFHEIV0
 22604     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22605     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22606     MOVE X'2020233030303230393535' TO DFHEIV0(25:11)
 22607     CALL 'kxdfhei1' USING DFHEIV0,
 22608           CNTL-ID,
 22609           CONTROL-FILE,
 22610           DFHEIV11,
 22611           ELCNTL-KEY,
 22612           DFHEIV99,
 22613           DFHEIV99,
 22614           DFHEIV99
 22615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22616
 22617
 22618     GO TO 9100-EXIT.
 22619
 22620 9100-NOTFND.
 22621     IF RC-SW-2 = '0'
 22622        MOVE '1'                  TO STATE-RECORD-ERROR
 22623        GO TO 9100-EXIT
 22624     END-IF
 22625     IF RC-SW-2 = '1'
 22626        MOVE '1'                  TO LF-BENEFIT-ERROR
 22627        MOVE ER-2604              TO WS-ERROR
 22628        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22629        GO TO 9100-EXIT.
 22630
 22631     IF RC-SW-2 = '2'
 22632        MOVE '1'                  TO AH-BENEFIT-ERROR
 22633        MOVE ER-2605              TO WS-ERROR
 22634        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22635        GO TO 9100-EXIT.
 22636
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 418
* EL050.cbl
 22637     IF RC-SW-2 = '3'
 22638         MOVE ER-2603           TO WS-ERROR
 22639         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22640         GO TO 9100-EXIT.
 22641
 22642     IF RC-SW-2 = '4'
 22643         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 22644         GO TO 9100-EXIT.
 22645
 22646     IF RC-SW-2 = '5'
 22647         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 22648         IF WS-AH-INPUT-CD-1 = SPACE
 22649             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 22650         ELSE
 22651             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 22652
 22653 9100-EXIT.
 22654      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 419
* EL050.cbl
 22656 9200-CONTROL-GETMAIN.
 22657
 22658* EXEC CICS GETMAIN
 22659*         LENGTH   (750)
 22660*         SET      (ADDRESS OF CONTROL-FILE)
 22661*    END-EXEC.
 22662     MOVE 750
 22663       TO DFHEIV11
 22664*    MOVE '," L                  $   #00021001' TO DFHEIV0
 22665     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 22666     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22667     MOVE X'2020233030303231303031' TO DFHEIV0(25:11)
 22668     CALL 'kxdfhei1' USING DFHEIV0,
 22669           DFHEIV20,
 22670           DFHEIV11,
 22671           DFHEIV99
 22672     SET ADDRESS OF CONTROL-FILE TO
 22673         DFHEIV20
 22674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22675
 22676
 22677     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 22678
 22679 9200-EXIT.
 22680     EXIT.
 22681
 22682 9250-UNLOCK-RETURN.
 22683
 22684* EXEC CICS UNLOCK
 22685*        DATASET   (CERT-ID)
 22686*    END-EXEC.
 22687*    MOVE '&*                    #   #00021012' TO DFHEIV0
 22688     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22689     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22690     MOVE X'2020233030303231303132' TO DFHEIV0(25:11)
 22691     CALL 'kxdfhei1' USING DFHEIV0,
 22692           CERT-ID,
 22693           DFHEIV99
 22694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22695
 22696
 22697 9300-ABEND.
 22698     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 22699
 22700
 22701* EXEC CICS LINK
 22702*        PROGRAM   ('EL004')
 22703*        COMMAREA  (WS-ERROR-LINE)
 22704*        LENGTH    (72)
 22705*    END-EXEC.
 22706     MOVE 'EL004' TO DFHEIV1
 22707     MOVE 72
 22708       TO DFHEIV11
 22709*    MOVE '."C                   (   #00021019' TO DFHEIV0
 22710     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 22711     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22712     MOVE X'2020233030303231303139' TO DFHEIV0(25:11)
 22713     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 420
* EL050.cbl
 22714           DFHEIV1,
 22715           WS-ERROR-LINE,
 22716           DFHEIV11,
 22717           DFHEIV99,
 22718           DFHEIV99,
 22719           DFHEIV99,
 22720           DFHEIV99
 22721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22722
 22723
 22724     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 22725
 22726
 22727* EXEC CICS ABEND
 22728*        ABCODE ('EL50')
 22729*    END-EXEC.
 22730     MOVE 'EL50' TO DFHEIV5
 22731*    MOVE '.,A                   "   #00021027' TO DFHEIV0
 22732     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 22733     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 22734     MOVE X'2020233030303231303237' TO DFHEIV0(25:11)
 22735     CALL 'kxdfhei1' USING DFHEIV0,
 22736           DFHEIV5
 22737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22738
 22739
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 421
* EL050.cbl
 22741
 22742******************************************************************
 22743*                                                                *
 22744*            E R R O R   F O R M A T   R O U T I N E             *
 22745*                                                                *
 22746******************************************************************
 22747
 22748 9900-ERROR-FORMAT.
 22749
 22750     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 22751                    PB-COMMON-ERROR (2) OR
 22752                    PB-COMMON-ERROR (3) OR
 22753                    PB-COMMON-ERROR (4) OR
 22754                    PB-COMMON-ERROR (5) OR
 22755                    PB-COMMON-ERROR (6) OR
 22756                    PB-COMMON-ERROR (7) OR
 22757                    PB-COMMON-ERROR (8) OR
 22758                    PB-COMMON-ERROR (9) OR
 22759                    PB-COMMON-ERROR (10)
 22760        GO TO 9900-EXIT.
 22761
 22762     IF PB-NO-OF-ERRORS = +10
 22763        GO TO 9900-EXIT.
 22764
 22765     ADD +1  TO PB-NO-OF-ERRORS.
 22766     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22767                                       (PB-NO-OF-ERRORS).
 22768 9900-EXIT.
 22769     EXIT.
 22770
 22771 9990-RETURN.
 22772     IF BROWSE-STARTED
 22773
 22774* EXEC CICS ENDBR
 22775*            DATASET  (ACCT-ID)
 22776*       END-EXEC.
 22777     MOVE 0
 22778       TO DFHEIV11
 22779*    MOVE '&2                    $   #00021064' TO DFHEIV0
 22780     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22781     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22782     MOVE X'2020233030303231303634' TO DFHEIV0(25:11)
 22783     CALL 'kxdfhei1' USING DFHEIV0,
 22784           ACCT-ID,
 22785           DFHEIV11,
 22786           DFHEIV99
 22787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22788
 22789
 22790 9990-EXIT.
 22791     EXIT.
 22792
 22793
 22794****Check for CRTO record, add one if not found.
 22795 9991-CHECK-FOR-ELCRTO.
 22796
 22797* EXEC CICS HANDLE CONDITION
 22798*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 422
* EL050.cbl
 22799*         ENDFILE (9991-CRTO-NOT-FOUND)
 22800*     END-EXEC.
 22801*    MOVE '"$I''                  ! A #00021074' TO DFHEIV0
 22802     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22803     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22804     MOVE X'4120233030303231303734' TO DFHEIV0(25:11)
 22805     CALL 'kxdfhei1' USING DFHEIV0
 22806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22807
 22808     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 22809     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 22810     MOVE +0                     TO ELCRTO-SEQ-NO
 22811
 22812
 22813* EXEC CICS READ
 22814*       DATASET   ('ELCRTO')
 22815*       INTO      (ORIGINAL-CERTIFICATE)
 22816*       RIDFLD    (ELCRTO-KEY)
 22817*       GTEQ
 22818*       RESP      (WS-RESPONSE)
 22819*    END-EXEC
 22820     MOVE LENGTH OF
 22821      ORIGINAL-CERTIFICATE
 22822       TO DFHEIV11
 22823     MOVE 'ELCRTO' TO DFHEIV1
 22824*    MOVE '&"IL       G          (  N#00021082' TO DFHEIV0
 22825     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22826     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22827     MOVE X'204E233030303231303832' TO DFHEIV0(25:11)
 22828     CALL 'kxdfhei1' USING DFHEIV0,
 22829           DFHEIV1,
 22830           ORIGINAL-CERTIFICATE,
 22831           DFHEIV11,
 22832           ELCRTO-KEY,
 22833           DFHEIV99,
 22834           DFHEIV99,
 22835           DFHEIV99
 22836     MOVE EIBRESP  TO WS-RESPONSE
 22837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22838
 22839     IF WS-RESP-NORMAL
 22840        AND (OC-CONTROL-PRIMARY (1:33) =
 22841                 PB-CONTROL-BY-ACCOUNT (1:33))
 22842        AND (OC-RECORD-TYPE =  'I')
 22843           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22844               GO TO 9991-CHECK-INDICATORS
 22845           ELSE
 22846               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22847               GO TO 9991-CRTO-ADD-REC
 22848           END-IF
 22849     END-IF.
 22850
 22851 9991-CRTO-NOT-FOUND.
 22852
 22853     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22854     MOVE 'OC'                TO OC-RECORD-ID
 22855     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22856                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 423
* EL050.cbl
 22857     MOVE +4096               TO OC-KEY-SEQ-NO.
 22858
 22859 9991-CRTO-ADD-REC.
 22860
 22861     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22862     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22863     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22864     MOVE 'I'                 TO OC-RECORD-TYPE
 22865     IF PB-ISSUE
 22866         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22867         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22868         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22869         MOVE PB-I-AGE               TO OC-INS-AGE
 22870         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22871         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22872         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22873         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22874         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22875         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22876         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22877         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22878         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22879         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22880         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22881         IF PB-I-JOINT-COMMISSION > +0
 22882             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22883         ELSE
 22884             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22885         END-IF
 22886         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22887         MOVE +0                     TO OC-LF-CANCEL-AMT
 22888                                        OC-LF-ITD-CANCEL-AMT
 22889         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22890         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22891         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22892         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22893         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22894         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22895         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22896         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22897         MOVE +0                     TO OC-AH-CANCEL-AMT
 22898                                        OC-AH-ITD-CANCEL-AMT
 22899         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22900         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22901         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22902     ELSE
 22903         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22904         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22905         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22906         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22907         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22908         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22909         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22910         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22911         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22912          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22913             MOVE SPACES             TO OC-LF-BENCD
 22914             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 424
* EL050.cbl
 22915                                        OC-LF-BEN-AMT
 22916                                        OC-LF-PRM-AMT
 22917                                        OC-LF-ALT-BEN-AMT
 22918                                        OC-LF-ALT-PRM-AMT
 22919                                        OC-LF-COMM-PCT
 22920                                        OC-LF-CANCEL-AMT
 22921             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22922             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22923         ELSE
 22924             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22925             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22926             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22927             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22928             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22929             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22930             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22931             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22932             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22933             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22934         END-IF
 22935         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22936         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22937          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22938             MOVE SPACES             TO OC-AH-BENCD
 22939             MOVE ZEROS              TO OC-AH-TERM
 22940                                        OC-AH-BEN-AMT
 22941                                        OC-AH-PRM-AMT
 22942                                        OC-AH-COMM-PCT
 22943                                        OC-AH-CANCEL-AMT
 22944                                        OC-AH-CP
 22945             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22946             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22947         ELSE
 22948             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22949             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22950             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22951             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22952             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22953             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22954             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22955             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22956             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22957         END-IF
 22958         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22959         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22960         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22961         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22962     END-IF
 22963     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22964
 22965     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22966
 22967
 22968* EXEC CICS READ
 22969*         DATASET   (FILE-ERMAIL)
 22970*         RIDFLD    (MA-CONTROL-PRIMARY)
 22971*         INTO      (MAILING-DATA)
 22972*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 425
* EL050.cbl
 22973*    END-EXEC
 22974     MOVE LENGTH OF
 22975      MAILING-DATA
 22976       TO DFHEIV11
 22977*    MOVE '&"IL       E          (  N#00021218' TO DFHEIV0
 22978     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22979     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22980     MOVE X'204E233030303231323138' TO DFHEIV0(25:11)
 22981     CALL 'kxdfhei1' USING DFHEIV0,
 22982           FILE-ERMAIL,
 22983           MAILING-DATA,
 22984           DFHEIV11,
 22985           MA-CONTROL-PRIMARY,
 22986           DFHEIV99,
 22987           DFHEIV99,
 22988           DFHEIV99
 22989     MOVE EIBRESP  TO WS-RESPONSE
 22990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22991
 22992     IF WS-RESP-NORMAL
 22993         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22994     END-IF.
 22995
 22996     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22997     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22998
 22999
 23000* EXEC CICS READ
 23001*         DATASET  (CRTT-ID)
 23002*         RIDFLD   (WS-ELCRTT-KEY)
 23003*         INTO     (CERTIFICATE-TRAILERS)
 23004*         RESP     (WS-RESPONSE)
 23005*    END-EXEC
 23006     MOVE LENGTH OF
 23007      CERTIFICATE-TRAILERS
 23008       TO DFHEIV11
 23009*    MOVE '&"IL       E          (  N#00021232' TO DFHEIV0
 23010     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23011     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23012     MOVE X'204E233030303231323332' TO DFHEIV0(25:11)
 23013     CALL 'kxdfhei1' USING DFHEIV0,
 23014           CRTT-ID,
 23015           CERTIFICATE-TRAILERS,
 23016           DFHEIV11,
 23017           WS-ELCRTT-KEY,
 23018           DFHEIV99,
 23019           DFHEIV99,
 23020           DFHEIV99
 23021     MOVE EIBRESP  TO WS-RESPONSE
 23022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23023
 23024     IF WS-RESP-NORMAL
 23025         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 23026         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 23027     END-IF.
 23028
 23029
 23030* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 426
* EL050.cbl
 23031*       DATASET   ('ELCRTO')
 23032*       FROM      (ORIGINAL-CERTIFICATE)
 23033*       RIDFLD    (OC-CONTROL-PRIMARY)
 23034*       RESP      (WS-RESPONSE)
 23035*    END-EXEC.
 23036     MOVE LENGTH OF
 23037      ORIGINAL-CERTIFICATE
 23038       TO DFHEIV11
 23039     MOVE 'ELCRTO' TO DFHEIV1
 23040*    MOVE '&$ L                  ''  N#00021244' TO DFHEIV0
 23041     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 23042     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23043     MOVE X'204E233030303231323434' TO DFHEIV0(25:11)
 23044     CALL 'kxdfhei1' USING DFHEIV0,
 23045           DFHEIV1,
 23046           ORIGINAL-CERTIFICATE,
 23047           DFHEIV11,
 23048           OC-CONTROL-PRIMARY,
 23049           DFHEIV99,
 23050           DFHEIV99
 23051     MOVE EIBRESP  TO WS-RESPONSE
 23052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23053
 23054
 23055     GO TO 9991-EXIT.
 23056
 23057 9991-CHECK-INDICATORS.
 23058
 23059     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 23060         GO TO 9991-EXIT
 23061     END-IF.
 23062
 23063     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 23064         GO TO 9991-EXIT
 23065     END-IF.
 23066
 23067
 23068* EXEC CICS READ
 23069*       DATASET   ('ELCRTO')
 23070*       INTO      (ORIGINAL-CERTIFICATE)
 23071*       RIDFLD    (OC-CONTROL-PRIMARY)
 23072*       UPDATE
 23073*       RESP      (WS-RESPONSE)
 23074*    END-EXEC
 23075     MOVE LENGTH OF
 23076      ORIGINAL-CERTIFICATE
 23077       TO DFHEIV11
 23078     MOVE 'ELCRTO' TO DFHEIV1
 23079*    MOVE '&"IL       EU         (  N#00021263' TO DFHEIV0
 23080     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23081     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23082     MOVE X'204E233030303231323633' TO DFHEIV0(25:11)
 23083     CALL 'kxdfhei1' USING DFHEIV0,
 23084           DFHEIV1,
 23085           ORIGINAL-CERTIFICATE,
 23086           DFHEIV11,
 23087           OC-CONTROL-PRIMARY,
 23088           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 427
* EL050.cbl
 23089           DFHEIV99,
 23090           DFHEIV99
 23091     MOVE EIBRESP  TO WS-RESPONSE
 23092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23093     IF WS-RESP-NORMAL
 23094        IF PB-ISSUE
 23095          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 23096          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 23097          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 23098          MOVE PB-I-AGE               TO OC-INS-AGE
 23099          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 23100          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 23101          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 23102          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 23103          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 23104          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 23105          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 23106          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 23107          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 23108          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 23109          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 23110          IF PB-I-JOINT-COMMISSION > +0
 23111              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 23112          ELSE
 23113              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 23114          END-IF
 23115          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 23116          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 23117          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 23118          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 23119          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 23120          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 23121          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 23122          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 23123          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 23124
 23125          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 23126
 23127* EXEC CICS READ
 23128*             DATASET   (FILE-ERMAIL)
 23129*             RIDFLD    (MA-CONTROL-PRIMARY)
 23130*             INTO      (MAILING-DATA)
 23131*             RESP      (WS-RESPONSE)
 23132*         END-EXEC
 23133     MOVE LENGTH OF
 23134      MAILING-DATA
 23135       TO DFHEIV11
 23136*    MOVE '&"IL       E          (  N#00021303' TO DFHEIV0
 23137     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23138     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23139     MOVE X'204E233030303231333033' TO DFHEIV0(25:11)
 23140     CALL 'kxdfhei1' USING DFHEIV0,
 23141           FILE-ERMAIL,
 23142           MAILING-DATA,
 23143           DFHEIV11,
 23144           MA-CONTROL-PRIMARY,
 23145           DFHEIV99,
 23146           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 428
* EL050.cbl
 23147           DFHEIV99
 23148     MOVE EIBRESP  TO WS-RESPONSE
 23149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23150          IF WS-RESP-NORMAL
 23151             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 23152          END-IF
 23153
 23154          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 23155          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 23156
 23157* EXEC CICS READ
 23158*             DATASET  (CRTT-ID)
 23159*             RIDFLD   (WS-ELCRTT-KEY)
 23160*             INTO     (CERTIFICATE-TRAILERS)
 23161*             RESP     (WS-RESPONSE)
 23162*         END-EXEC
 23163     MOVE LENGTH OF
 23164      CERTIFICATE-TRAILERS
 23165       TO DFHEIV11
 23166*    MOVE '&"IL       E          (  N#00021315' TO DFHEIV0
 23167     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23168     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23169     MOVE X'204E233030303231333135' TO DFHEIV0(25:11)
 23170     CALL 'kxdfhei1' USING DFHEIV0,
 23171           CRTT-ID,
 23172           CERTIFICATE-TRAILERS,
 23173           DFHEIV11,
 23174           WS-ELCRTT-KEY,
 23175           DFHEIV99,
 23176           DFHEIV99,
 23177           DFHEIV99
 23178     MOVE EIBRESP  TO WS-RESPONSE
 23179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23180          IF WS-RESP-NORMAL
 23181             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 23182                               OC-INS-AGE-DEFAULT-FLAG
 23183             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 23184                               OC-JNT-AGE-DEFAULT-FLAG
 23185          END-IF
 23186
 23187        ELSE
 23188          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 23189             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 23190             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 23191             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 23192          END-IF
 23193          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 23194             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 23195             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 23196             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 23197          END-IF
 23198          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 23199        END-IF
 23200
 23201* EXEC CICS REWRITE
 23202*          DATASET   ('ELCRTO')
 23203*          FROM      (ORIGINAL-CERTIFICATE)
 23204*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 429
* EL050.cbl
 23205*       END-EXEC
 23206     MOVE LENGTH OF
 23207      ORIGINAL-CERTIFICATE
 23208       TO DFHEIV11
 23209     MOVE 'ELCRTO' TO DFHEIV1
 23210*    MOVE '&& L                  %  N#00021341' TO DFHEIV0
 23211     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23212     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23213     MOVE X'204E233030303231333431' TO DFHEIV0(25:11)
 23214     CALL 'kxdfhei1' USING DFHEIV0,
 23215           DFHEIV1,
 23216           ORIGINAL-CERTIFICATE,
 23217           DFHEIV11,
 23218           DFHEIV99
 23219     MOVE EIBRESP  TO WS-RESPONSE
 23220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23221     END-IF.
 23222
 23223 9991-EXIT.
 23224     EXIT.
 23225
 23226
 23227 9999-RETURN.
 23228     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 23229
 23230
 23231* EXEC CICS RETURN
 23232*    END-EXEC.
 23233*    MOVE '.(                    ''   #00021355' TO DFHEIV0
 23234     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 23235     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23236     MOVE X'2020233030303231333535' TO DFHEIV0(25:11)
 23237     CALL 'kxdfhei1' USING DFHEIV0,
 23238           DFHEIV99,
 23239           DFHEIV99,
 23240           DFHEIV99,
 23241           DFHEIV99,
 23242           DFHEIV99,
 23243           DFHEIV99
 23244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23245
 23246
 23247
 23248* GOBACK.
 23249     MOVE '9%                    "   ' TO DFHEIV0
 23250     MOVE 'EL050' TO DFHEIV1
 23251     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23252     GOBACK.
 23253
 23254 9999-DFHBACK SECTION.
 23255     MOVE '9%                    "   ' TO DFHEIV0
 23256     MOVE 'EL050' TO DFHEIV1
 23257     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23258     GOBACK.
 23259 9999-DFHEXIT.
 23260     IF DFHEIGDJ EQUAL 0001
 23261         NEXT SENTENCE
 23262     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 430
* EL050.cbl
 23263         GO TO 9300-ABEND,
 23264               3990-FILES-NOT-OPEN
 23265         DEPENDING ON DFHEIGDI
 23266     ELSE IF DFHEIGDJ EQUAL 3
 23267         GO TO 6610-START-BROWSE,
 23268               6630-ERRESS-PROBLEM,
 23269               6630-END-OF-FILE
 23270         DEPENDING ON DFHEIGDI
 23271     ELSE IF DFHEIGDJ EQUAL 4
 23272         GO TO 6630-END-OF-FILE,
 23273               6630-ERRESS-PROBLEM,
 23274               6630-ERRESS-PROBLEM,
 23275               6630-END-OF-FILE
 23276         DEPENDING ON DFHEIGDI
 23277     ELSE IF DFHEIGDJ EQUAL 5
 23278         GO TO 6630-END-OF-FILE,
 23279               6630-END-OF-FILE,
 23280               6630-ERRESS-PROBLEM,
 23281               6630-ERRESS-PROBLEM
 23282         DEPENDING ON DFHEIGDI
 23283     ELSE IF DFHEIGDJ EQUAL 6
 23284         GO TO 6660-START-BROWSE,
 23285               6690-ERRESC-PROBLEM,
 23286               6690-ERRESC-PROBLEM,
 23287               6690-END-OF-FILE
 23288         DEPENDING ON DFHEIGDI
 23289     ELSE IF DFHEIGDJ EQUAL 7
 23290         GO TO 6690-END-OF-FILE,
 23291               6690-ERRESC-PROBLEM,
 23292               6690-ERRESC-PROBLEM,
 23293               6690-END-OF-FILE
 23294         DEPENDING ON DFHEIGDI
 23295     ELSE IF DFHEIGDJ EQUAL 8
 23296         GO TO 6690-END-OF-FILE,
 23297               6690-ERRESC-PROBLEM,
 23298               6690-ERRESC-PROBLEM,
 23299               6690-END-OF-FILE
 23300         DEPENDING ON DFHEIGDI
 23301     ELSE IF DFHEIGDJ EQUAL 9
 23302         GO TO 7250-CONTINUE,
 23303               7250-CONTINUE
 23304         DEPENDING ON DFHEIGDI
 23305     ELSE IF DFHEIGDJ EQUAL 10
 23306         GO TO 7300-CONTINUE,
 23307               7300-CONTINUE
 23308         DEPENDING ON DFHEIGDI
 23309     ELSE IF DFHEIGDJ EQUAL 11
 23310         GO TO 7320-CONTINUE,
 23311               7320-CONTINUE
 23312         DEPENDING ON DFHEIGDI
 23313     ELSE IF DFHEIGDJ EQUAL 12
 23314         GO TO 8000-FREE-MAIN
 23315         DEPENDING ON DFHEIGDI
 23316     ELSE IF DFHEIGDJ EQUAL 13
 23317         GO TO 8100-NOTFND,
 23318               8100-NOTFND
 23319         DEPENDING ON DFHEIGDI
 23320     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 431
* EL050.cbl
 23321         GO TO 8110-NOTFND,
 23322               8110-NOTFND
 23323         DEPENDING ON DFHEIGDI
 23324     ELSE IF DFHEIGDJ EQUAL 15
 23325         GO TO 8130-EXIT
 23326         DEPENDING ON DFHEIGDI
 23327     ELSE IF DFHEIGDJ EQUAL 16
 23328         GO TO 8145-exit
 23329         DEPENDING ON DFHEIGDI
 23330     ELSE IF DFHEIGDJ EQUAL 17
 23331         GO TO 8190-NOTFND
 23332         DEPENDING ON DFHEIGDI
 23333     ELSE IF DFHEIGDJ EQUAL 18
 23334         GO TO 8195-NOTFND
 23335         DEPENDING ON DFHEIGDI
 23336     ELSE IF DFHEIGDJ EQUAL 19
 23337         GO TO 8200-NOTFND
 23338         DEPENDING ON DFHEIGDI
 23339     ELSE IF DFHEIGDJ EQUAL 20
 23340         GO TO 8300-NOTFND,
 23341               8300-ERRESS-PROBLEM,
 23342               8300-ERRESS-PROBLEM,
 23343               8300-NOTFND
 23344         DEPENDING ON DFHEIGDI
 23345     ELSE IF DFHEIGDJ EQUAL 21
 23346         GO TO 8450-FORM-NOT-FOUND,
 23347               8450-FORM-NOT-FOUND
 23348         DEPENDING ON DFHEIGDI
 23349     ELSE IF DFHEIGDJ EQUAL 22
 23350         GO TO 0199-ACCT-NOT-FOUND,
 23351               0199-ACCT-NOT-FOUND
 23352         DEPENDING ON DFHEIGDI
 23353     ELSE IF DFHEIGDJ EQUAL 23
 23354         GO TO 0199-ACCT-NOT-FOUND,
 23355               0199-ACCT-NOT-FOUND
 23356         DEPENDING ON DFHEIGDI
 23357     ELSE IF DFHEIGDJ EQUAL 24
 23358         GO TO 8582-COMP-NOT-FOUND,
 23359               8582-COMP-NOT-FOUND
 23360         DEPENDING ON DFHEIGDI
 23361     ELSE IF DFHEIGDJ EQUAL 25
 23362         GO TO 8583-AGTC-NOT-FOUND,
 23363               8583-AGTC-NOT-FOUND
 23364         DEPENDING ON DFHEIGDI
 23365     ELSE IF DFHEIGDJ EQUAL 26
 23366         GO TO 8584-BXRF-NOT-FOUND,
 23367               8584-BXRF-NOT-FOUND
 23368         DEPENDING ON DFHEIGDI
 23369     ELSE IF DFHEIGDJ EQUAL 27
 23370         GO TO 8585-PLAN-NOT-FOUND,
 23371               8585-PLAN-NOT-FOUND
 23372         DEPENDING ON DFHEIGDI
 23373     ELSE IF DFHEIGDJ EQUAL 28
 23374         GO TO 0299-CERT-NOT-FOUND
 23375         DEPENDING ON DFHEIGDI
 23376     ELSE IF DFHEIGDJ EQUAL 29
 23377         GO TO 8700-READ-CERT-MASTER
 23378         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 22-Jan-20 13:01 Page 432
* EL050.cbl
 23379     ELSE IF DFHEIGDJ EQUAL 30
 23380         GO TO 8720-COMP-ACCOUNTS,
 23381               8730-END-BROWSE,
 23382               8740-NOT-FOUND
 23383         DEPENDING ON DFHEIGDI
 23384     ELSE IF DFHEIGDJ EQUAL 31
 23385         GO TO 9000-NOTFND
 23386         DEPENDING ON DFHEIGDI
 23387     ELSE IF DFHEIGDJ EQUAL 32
 23388         GO TO 9100-NOTFND,
 23389               9100-NOTFND
 23390         DEPENDING ON DFHEIGDI
 23391     ELSE IF DFHEIGDJ EQUAL 33
 23392         GO TO 9991-CRTO-NOT-FOUND,
 23393               9991-CRTO-NOT-FOUND
 23394         DEPENDING ON DFHEIGDI.
 23395     MOVE '9%                    "   ' TO DFHEIV0
 23396     MOVE 'EL050' TO DFHEIV1
 23397     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23398     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41840     Code:       95991
