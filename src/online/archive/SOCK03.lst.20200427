* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page   1
* SOCK03.cbl
* Options: int("SOCK03.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK03.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK03.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK03.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK03.
     9*         This program is the first invoked by the SOC3
    10*         transaction. This transaction must be submited
    11*         by a message transmited over a stream socket.
    12*         The message format is:
    13*         xxxx,12345678901234567890123456789012345
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page   2
* SOCK03.cbl
    14*         where "xxxx" is the tran id SOCK (1 to 4 characters)
    15*         and "123456.........5" is up to 35 characters of
    16*         optional text.
    17*         Information on the originating message and
    18*         remote socket is provided in the DFHCOMMAREA.
    19*         As its first action this program must send a
    20*         message to the requesting socket. This lets the
    21*         remote program know its request has been
    22*         accepted and the transaction started.
    23*         The program will make four transmissions to
    24*         the initating program in response to received
    25*         messages and then close the socket.
    26*         This program is provided to show method and
    27*         has minimal checking and error messages.
    28*         The Cobol compiler, unless instructed otherwise,
    29*         will hold its working storage integer data items in
    30*         machine idependent form. This matches the network
    31*         ordering of information. Care should be exercised
    32*         to ensure that this data ordering is correct when
    33*         calling system library functions or passing data
    34*         structure containing such data to functions.
    35******************************************************************
    36*                   C H A N G E   L O G
    37*
    38* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    39*-----------------------------------------------------------------
    40*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    41* EFFECTIVE    NUMBER
    42*-----------------------------------------------------------------
    43* 071112  IR2012042700001  PEMA  AHL CHANGES
    44* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
    45* 010213  CR2011083000005  PEMA  ADD SPECIAL DCC SPP DDF REFUND
    46* 101813  IR2013101700003  PEMA  FIX MN Net Balloon calc.
    47* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    48* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
    49* 072415  IR2015071500003  PEMA  REMOVE CLOSE STATEMENT
    50* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
    51*071117   IR2017061900003  PEMA  ALLOW 0% APR ON REFUNDS
    52* 100417  CR2017051000002  PEMA  Add fields to interface
    53* 100418  CR2018073000001  PEMA  REWORD REFUND METHODS
    54* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    55* 052319  IR2019052300001  PEMA  VIN&BENE not being passed at time
    56* 062119  CR2019050800001  PEMA  Add option to search by VIN
    57* 080519  IR2019080200001  PEMA  Allow multiple quotes by VIN
    58* 080919  IR2019080900001  PEMA  Shorten allowed Linkage Section
    59******************************************************************
    60 environment division.
    61 data division.
    62 working-storage section.
    63 01  DFH-START PIC X(04).
    64*
    65* program buffers
    66*
    67 77  WS-BUFF-SENT-SW             PIC X  VALUE SPACES.
    68     88  ALREADY-SENT              VALUE 'Y'.
    69 77  WS-LENGTH                   PIC S9(4) COMP VALUE +0.
    70 77  WS-ELCERT-SW                PIC X  VALUE SPACES.
    71     88  ELCERT-FINISHED            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page   3
* SOCK03.cbl
    72 77  WS-BIN-EFF-DT               PIC XX VALUE LOW-VALUES.
    73 77  WS-ERACCT-SW                PIC X VALUE SPACES.
    74     88  ERACCT-FOUND               VALUE 'Y'.
    75 77  WS-FREE-LOOK                PIC S999 COMP-3 VALUE +0.
    76 77 ws-send-msg-size           pic s9(8) comp value 4096.
    77 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    78 77 ws-recv-buf                pic x(4096).
    79 77 ws-send-buf                pic x(4096) VALUE SPACES.
    80 77 ws-recv-total              pic s9(8) comp value 0.
    81 77 ws-recv-left               pic s9(8) comp value 0.
    82 77 ws-seq-num                 pic s9(8) comp value 0.
    83 77 ws-flags                   pic s9(8) comp value 0.
    84 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    85 77  WS-COMP-ID                  PIC XXX  VALUE SPACES.
    86 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    87 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    88 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    89 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    90 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    91 77  ws-cancel-reason            pic x   value spaces.
    92 77  P1                          PIC S999 COMP-3 VALUE +0.
    93 77  P2                          PIC S999 COMP-3 VALUE +0.
    94 77  C0                          PIC S999 COMP-3 VALUE +0.
    95 77  C1                          PIC S999 COMP-3 VALUE +0.
    96 77  C2                          PIC S999 COMP-3 VALUE +0.
    97 77  C3                          PIC S999 COMP-3 VALUE +0.
    98 77 S1                           PIC S999 COMP-3 VALUE +0.
    99 77 S2                           PIC S999 COMP-3 VALUE +0.
   100 77 L1                           PIC S999 COMP-3 VALUE +0.
   101 77 L2                           PIC S999 COMP-3 VALUE +0.
   102 77 F1                           PIC S999 COMP-3 VALUE +0.
   103 77 WS-BUILD-SW                  PIC X.
   104    88  TIME-TO-BUILD               VALUE 'Y'.
   105 77 WS-SAVE-ERACCT               PIC X(2000).
   106 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
   107 77 WS-STOP-SW                   PIC X  VALUE ' '.
   108    88  TOLD-TO-STOP               VALUE 'Y'.
   109 77 WS-PERFORM-SW                PIC X VALUE SPACES.
   110    88  GET-RATES                    VALUE 'R'.
   111    88  GET-ACT-ACCTS                VALUE 'A'.
   112 77 ws-bin-1st-pay-dt            pic xx  value low-values.
   113 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
   114 77 ws-disp-rate                 pic z9.99999.
   115 77  WS-ERCTBL-SW                PIC X VALUE ' '.
   116     88  END-OF-ERCTBL                 VALUE 'Y'.
   117 77  WS-STATUS                   PIC X.
   118 77  WS-CF-DEFAULT-APR           PIC S9(03)V9(04) COMP-3.
   119 77  WS-CF-CR-R78-METHOD         PIC X          VALUE SPACE.
   120 77  WS-CF-CR-REM-TERM-CALC      PIC X          VALUE SPACE.
   121 77  WS-BIN-VAL-DT               PIC XX         VALUE LOW-VALUES.
   122 77  WS-TOT-LF-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   123 77  WS-TOT-AH-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   124 77  WS-TOT-LF-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   125 77  WS-TOT-AH-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   126 77  WS-TOT-LF-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   127 77  WS-TOT-AH-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   128 77  WS-WORK-FACTOR              PIC S9V9(7)   COMP-3 VALUE +0.
   129 77  WS-ELCERT-KEY-SW            PIC X  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page   4
* SOCK03.cbl
   130     88  WS-ELCERT-FULL             VALUE '1'.
   131     88  WS-ELCERT-NAME             VALUE '2'.
   132     88  WS-ELCERT-CERT-NO          VALUE '3'.
   133     88  WS-ELCERT-ACT-NAME         VALUE '4'.
   134     88  WS-ELCERT-VIN              value '5'.
   135 77  ELMSTR-LENGTH               PIC S9(4) COMP VALUE +12.
   136 77  WS-CLM-STOP-SW              PIC X  VALUE ' '.
   137     88  I-SAY-TO-STOP      VALUE 'Y'.
   138 77  WS-HEX-0A                   PIC X.
   139 77  WS-CALL-TYPE                PIC X(6).
   140 77  WS-NCB-DIFF-MONTHS          PIC 999   VALUE ZEROS.
   141 77  WS-NCB-DIFF-ODD-DAYS        PIC 999   VALUE ZEROS.
   142 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   143 77  DD-IU-SW                    PIC X   VALUE ' '.
   144     88  DD-IU-PRESENT                 VALUE 'Y'.
   145 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
   146 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
   147 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
   148 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   149 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   150 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   151 77  ws-ah-rfnd-clp              pic s9(7)v99 comp-3 value +0.
   152 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   153 77  WS-PDEF-RECORD-SW           PIC X           VALUE ' '.
   154     88  PDEF-FOUND                              VALUE 'Y'.
   155 77  ws-epiq-sw                  pic x  value ' '.
   156     88  ws-epiq-request           value 'Y'.
   157 77  ws-epiq-max                 pic s999 value +0 comp-3.
   158 01  WS-STRING-DATA.
   159     05  WS-COMMENT              PIC X(30)    VALUE SPACES.
   160     05  WS-RESP                 PIC 99999    VALUE ZEROS.
   161     05  WS-CARRIER              PIC X        VALUE SPACES.
   162     05  WS-GROUPING             PIC X(6)     VALUE SPACES.
   163     05  WS-STATE                PIC XX       VALUE SPACES.
   164     05  WS-ACCOUNT              PIC X(10)    VALUE SPACES.
   165     05  WS-CERT-NO              PIC X(11)    VALUE SPACES.
   166     05  WS-CERT-EFF-DATE        PIC 9(8)     VALUE ZEROS.
   167     05  WS-LAST-NAME            PIC X(15)    VALUE SPACES.
   168     05  WS-FIRST-NAME           PIC X(15)    VALUE SPACES.
   169     05  WS-MID-INIT             PIC X        VALUE SPACES.
   170     05  WS-POST-CARD-SW         PIC X        VALUE SPACES.
   171     05  WS-LF-COVERAGE-TYPE     PIC X        VALUE SPACES.
   172     05  WS-LF-STATUS            PIC X        VALUE SPACES.
   173     05  WS-LF-BEN-CODE          PIC XX       VALUE SPACES.
   174     05  WS-LF-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   175     05  WS-LF-TERM              PIC 999      VALUE ZEROS.
   176     05  WS-LF-REM-TERM          PIC 999      VALUE ZEROS.
   177     05  WS-LF-PREM              PIC 9(7).99  VALUE ZEROS.
   178     05  WS-LF-REFUND            PIC 9(7).99  VALUE ZEROS.
   179     05  WS-LF-METHOD            PIC X(15)    VALUE SPACES.
   180     05  WS-LF-ORIG-BENEFIT      PIC 9(9).99  VALUE ZEROS.
   181     05  WS-LF-REM-BEN           PIC 9(9).99  VALUE ZEROS.
   182     05  WS-AH-COVERAGE-TYPE     PIC X        VALUE SPACES.
   183     05  WS-AH-STATUS            PIC X        VALUE SPACES.
   184     05  WS-AH-BEN-CODE          PIC XX       VALUE SPACES.
   185     05  WS-AH-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   186     05  WS-AH-TERM              PIC 999      VALUE ZEROS.
   187     05  WS-AH-REM-TERM          PIC 999      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page   5
* SOCK03.cbl
   188     05  WS-AH-PREM              PIC 9(7).99  VALUE ZEROS.
   189     05  WS-AH-REFUND            PIC 9(7).99  VALUE ZEROS.
   190     05  WS-AH-METHOD            PIC X(15)    VALUE SPACES.
   191     05  WS-AH-ORIG-BENEFIT      PIC 9(7).99  VALUE ZEROS.
   192     05  WS-AH-REM-BEN           PIC 9(7).99  VALUE ZEROS.
   193     05  WS-ACCOUNT-NAME         PIC X(30)    VALUE SPACES.
   194     05  WS-REPORT-CODE-1        PIC X(10)    VALUE SPACES.
   195     05  WS-REPORT-CODE-2        PIC X(10)    VALUE SPACES.
   196     05  WS-REPORT-CODE-3        PIC X(10)    VALUE SPACES.
   197     05  WS-LF-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   198     05  WS-AH-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   199     05  WS-LF-COMM              PIC 9(7).99  VALUE ZEROS.
   200     05  WS-AH-COMM              PIC 9(7).99  VALUE ZEROS.
   201     05  WS-LF-UEC               PIC 9(7).99  VALUE ZEROS.
   202     05  WS-AH-UEC               PIC 9(7).99  VALUE ZEROS.
   203     05  WS-LAST-JNAME           PIC X(15)    VALUE SPACES.
   204     05  WS-FIRST-JNAME          PIC X(15)    VALUE SPACES.
   205     05  WS-MID-JINIT            PIC X        VALUE SPACES.
   206     05  WS-CLM-PAID-THRU-DT     PIC 9(8)   VALUE ZEROS.
   207     05  WS-LF-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   208     05  WS-AH-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   209     05  WS-LF-CANCEL-DATE       PIC 9(8)   VALUE ZEROS.
   210     05  WS-AH-CANCEL-DATE       PIC 9(8)   VALUE ZEROS.
   211     05  WS-VIN                  PIC X(17)  VALUE SPACES.
   212     05  WS-CRED-BENE-NAME       PIC X(30)  VALUE SPACES.
   213 01  ws-work-date.
   214     05  ws-work-ccyy            pic x(4).
   215     05  ws-work-mm              pic xx.
   216     05  ws-work-dd              pic xx.
   217 01  ws-work-date-num redefines ws-work-date
   218                                 pic 9(8).
   219 01  FILLER.
   220     12  WS-CF-REM-TRM-CALC-OPTION PIC X  VALUE SPACE.
   221     12  WS-BALLOON-RTRM         PIC 999  VALUE ZEROS.
   222     12  WS-STATE-ABBREVIATION   PIC XX.
   223     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   224     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   225     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   226     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   227     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   228     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   229     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   230     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   231     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   232     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   233     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   234     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   235     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   236     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   237     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   238     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   239     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   240     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   241     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   242     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   243     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   244     12  WS-LF-OVERRIDE-L1       PIC  X(01).
   245     12  WS-LF-OVERRIDE-L2       PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page   6
* SOCK03.cbl
   246     12  WS-AH-OVERRIDE-L1       PIC  X(01).
   247     12  WS-AH-OVERRIDE-L2       PIC  X(02).
   248     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   249         88  WS-REDUCING                         VALUE 'R'.
   250         88  WS-LEVEL                            VALUE 'L'  'P'.
   251 01  ELMSTR-KEY.
   252     12  ELMSTR-COMP-CD          PIC X.
   253     12  ELMSTR-CERT-NO          PIC X(11).
   254 01  CTBL-KEY-SAVE               PIC X(5).
   255 01  CTBL-KEY.
   256     05  CTBL-COMPANY-CD         PIC X.
   257     05  CTBL-TABLE              PIC XXX.
   258     05  CTBL-BEN-TYPE           PIC X.
   259     05  CTBL-BEN-CODE           PIC XX.
   260 01  ERPDEF-KEY-SAVE             PIC X(18).
   261 01  ERPDEF-KEY.
   262     12  ERPDEF-COMPANY-CD       PIC X.
   263     12  ERPDEF-STATE            PIC XX.
   264     12  ERPDEF-PROD-CD          PIC XXX.
   265     12  F                       PIC X(7).
   266     12  ERPDEF-BEN-TYPE         PIC X.
   267     12  ERPDEF-BEN-CODE         PIC XX.
   268     12  ERPDEF-EXP-DT           PIC XX.
   269 01  WS-AM3-KEY.
   270     12  WS-AM3-ACCOUNT          PIC X(10).
   271     12  WS-AM3-EXP-DT           PIC XX.
   272 01  WS-AM-KEY.
   273     12  WS-AM-COMPANY-CD        PIC X.
   274     12  WS-AM-CARRIER           PIC X.
   275     12  WS-AM-GROUPING          PIC X(6).
   276     12  WS-AM-STATE             PIC XX.
   277     12  WS-AM-ACCOUNT           PIC X(10).
   278     12  WS-AM-EXPIRATION-DT     PIC XX.
   279     12  WS-AM-FILLER            PIC XXXX.
   280 01  WS-CO-DATA.
   281     05  WS-CO-NUM               PIC X(10).
   282     05  WS-CO-PRIMARY-CONTACT   PIC X(30).
   283     05  WS-CO-NAME              PIC X(30).
   284     05  WS-CO-MAIL-NAME         PIC X(30).
   285     05  WS-CO-ADDR1             PIC X(30).
   286     05  WS-CO-ADDR2             PIC X(30).
   287     05  WS-CO-ADDR3             PIC X(30).
   288     05  WS-CO-ZIP               PIC X(9).
   289     05  WS-CO-PHONE             PIC X(10).
   290 01  WS-CF-KEY.
   291     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   292     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   293*        88  COMPANY-MASTER                      VALUE '1'.
   294*        88  STATE-MASTER                        VALUE '3'.
   295*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   296*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   297     12  WS-CF-ACCESS.
   298         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   299         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   300             20  FILLER          PIC  X(01).
   301             20  WS-CF-CARRIER   PIC  X(01).
   302     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   303 01  WS-CS-KEY.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page   7
* SOCK03.cbl
   304     05  WS-CS-COMPANY-CD        PIC X.
   305     05  WS-CS-CARRIER           PIC X.
   306     05  WS-CS-GROUP             PIC X(6).
   307     05  WS-CS-STATE             PIC XX.
   308     05  WS-CS-ACCOUNT           PIC X(10).
   309     05  WS-CS-EFF-DT            PIC XX.
   310     05  WS-CS-CERT-NO           PIC X(11).
   311     05  WS-CS-TRLR-TYPE         PIC X.
   312 01  WS-MA-KEY.
   313     05  WS-MA-COMPANY-CD        PIC X.
   314     05  WS-MA-CARRIER           PIC X.
   315     05  WS-MA-GROUP             PIC X(6).
   316     05  WS-MA-STATE             PIC XX.
   317     05  WS-MA-ACCOUNT           PIC X(10).
   318     05  WS-MA-EFF-DT            PIC XX.
   319     05  WS-MA-CERT-NO           PIC X(11).
   320 01  WS-CM-KEY.
   321     05  WS-CM-COMPANY-CD        PIC X.
   322     05  WS-CM-CARRIER           PIC X.
   323     05  WS-CM-GROUP             PIC X(6).
   324     05  WS-CM-STATE             PIC XX.
   325     05  WS-CM-ACCOUNT           PIC X(10).
   326     05  WS-CM-EFF-DT            PIC XX.
   327     05  WS-CM-CERT-NO           PIC X(11).
   328 01  WS-CM-KEY-A1.
   329     05  WS-CM-COMPANY-CD-A1     PIC X.
   330     05  WS-CM-LAST-NAME         PIC X(15).
   331     05  WS-CM-INITIALS          PIC XX.
   332 01  WS-CM-KEY-A4.
   333     05  WS-CM-COMPANY-CD-A4     PIC X.
   334     05  WS-CM-CERT-NO-A4        PIC X(11).
   335 01  WS-CID-NO                   PIC X(8).
   336 01  soc-client-in-data.
   337     05  CLIENT-CAR              PIC X.
   338     05  CLIENT-GRP              PIC X(6).
   339     05  CLIENT-STATE            PIC XX.
   340     05  CLIENT-ACCOUNT          PIC X(10).
   341     05  CLIENT-EFF-DT           PIC X(8).  *> ccyymmdd
   342     05  CLIENT-CERT-NO          PIC X(11).
   343     05  CLIENT-LAST-NAME        PIC X(15).
   344     05  CLIENT-FIRST-NAME       PIC X(10).
   345     05  CLIENT-VAL-DT           PIC X(8).  *> ccyymmdd
   346     05  CLIENT-CAN-REASON       PIC X.
   347     05  client-vin              pic x(17).
   348 01  WS-DISP-RESP                PIC 9(5).
   349 01  WS-RESPONSE                 PIC S9(8)   COMP.
   350     88  RESP-NORMAL                  VALUE +00.
   351     88  RESP-NOTFND                  VALUE +13.
   352     88  RESP-DUPKEY                  VALUE +15.
   353     88  RESP-NOTOPEN                 VALUE +19.
   354     88  RESP-ENDFILE                 VALUE +20.
   355*                                 COPY ELCCERT.
   356******************************************************************
   357*                                                                *
   358*                            ELCCERT.                            *
   359*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   360*                            VMOD=2.013                          *
   361*                                                                *
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page   8
* SOCK03.cbl
   362*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   363*                                                                *
   364*   FILE TYPE = VSAM,KSDS                                        *
   365*   RECORD SIZE = 450  RECFORM = FIXED                           *
   366*                                                                *
   367*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   368*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   369*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   370*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   371*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   372*                                                                *
   373*   LOG = YES                                                    *
   374*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   375******************************************************************
   376*                   C H A N G E   L O G
   377*
   378* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   379*-----------------------------------------------------------------
   380*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   381* EFFECTIVE    NUMBER
   382*-----------------------------------------------------------------
   383* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   384* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   385* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   386* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   387* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   388* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   389* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   390* 032612  CR2011110200001  PEMA  AHL CHANGES
   391* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   392* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   393* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
   394******************************************************************
   395
   396 01  CERTIFICATE-MASTER.
   397     12  CM-RECORD-ID                      PIC XX.
   398         88  VALID-CM-ID                      VALUE 'CM'.
   399
   400     12  CM-CONTROL-PRIMARY.
   401         16  CM-COMPANY-CD                 PIC X.
   402         16  CM-CARRIER                    PIC X.
   403         16  CM-GROUPING.
   404             20  CM-GROUPING-PREFIX        PIC X(3).
   405             20  CM-GROUPING-PRIME         PIC X(3).
   406         16  CM-STATE                      PIC XX.
   407         16  CM-ACCOUNT.
   408             20  CM-ACCOUNT-PREFIX         PIC X(4).
   409             20  CM-ACCOUNT-PRIME          PIC X(6).
   410         16  CM-CERT-EFF-DT                PIC XX.
   411         16  CM-CERT-NO.
   412             20  CM-CERT-PRIME             PIC X(10).
   413             20  CM-CERT-SFX               PIC X.
   414
   415     12  CM-CONTROL-BY-NAME.
   416         16  CM-COMPANY-CD-A1              PIC X.
   417         16  CM-INSURED-LAST-NAME          PIC X(15).
   418         16  CM-INSURED-INITIALS.
   419             20  CM-INSURED-INITIAL1       PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page   9
* SOCK03.cbl
   420             20  CM-INSURED-INITIAL2       PIC X.
   421
   422     12  CM-CONTROL-BY-SSN.
   423         16  CM-COMPANY-CD-A2              PIC X.
   424         16  CM-SOC-SEC-NO.
   425             20  CM-SSN-STATE              PIC XX.
   426             20  CM-SSN-ACCOUNT            PIC X(6).
   427             20  CM-SSN-LN3.
   428                 25  CM-INSURED-INITIALS-A2.
   429                     30 CM-INSURED-INITIAL1-A2   PIC X.
   430                     30 CM-INSURED-INITIAL2-A2   PIC X.
   431                 25 CM-PART-LAST-NAME-A2         PIC X.
   432
   433     12  CM-CONTROL-BY-CERT-NO.
   434         16  CM-COMPANY-CD-A4              PIC X.
   435         16  CM-CERT-NO-A4                 PIC X(11).
   436
   437     12  CM-CONTROL-BY-MEMB.
   438         16  CM-COMPANY-CD-A5              PIC X.
   439         16  CM-MEMBER-NO.
   440             20  CM-MEMB-STATE             PIC XX.
   441             20  CM-MEMB-ACCOUNT           PIC X(6).
   442             20  CM-MEMB-LN4.
   443                 25  CM-INSURED-INITIALS-A5.
   444                     30 CM-INSURED-INITIAL1-A5   PIC X.
   445                     30 CM-INSURED-INITIAL2-A5   PIC X.
   446                 25 CM-PART-LAST-NAME-A5         PIC XX.
   447
   448     12  CM-INSURED-PROFILE-DATA.
   449         16  CM-INSURED-FIRST-NAME.
   450             20  CM-INSURED-1ST-INIT       PIC X.
   451             20  FILLER                    PIC X(9).
   452         16  CM-INSURED-ISSUE-AGE          PIC 99.
   453         16  CM-INSURED-SEX                PIC X.
   454             88  CM-SEX-MALE                  VALUE 'M'.
   455             88  CM-SEX-FEMAL                 VALUE 'F'.
   456         16  CM-INSURED-JOINT-AGE          PIC 99.
   457         16  CM-JOINT-INSURED-NAME.
   458             20  CM-JT-LAST-NAME           PIC X(15).
   459             20  CM-JT-FIRST-NAME.
   460                 24  CM-JT-1ST-INIT        PIC X.
   461                 24  FILLER                PIC X(9).
   462             20  CM-JT-INITIAL             PIC X.
   463
   464     12  CM-LIFE-DATA.
   465         16  CM-LF-BENEFIT-CD              PIC XX.
   466         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   467         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   468         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   469         16  CM-LF-DEV-CODE                PIC XXX.
   470         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   471         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   472         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   473         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   474         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   475         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   476         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   477         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  10
* SOCK03.cbl
   478         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   479         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   480         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   481         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   482         16  cm-temp-epiq                  pic xx.
   483             88  EPIQ-CLASS                  value 'EQ'.
   484*        16  FILLER                        PIC XX.
   485
   486     12  CM-AH-DATA.
   487         16  CM-AH-BENEFIT-CD              PIC XX.
   488         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   489         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   490         16  CM-AH-DEV-CODE                PIC XXX.
   491         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   492         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   493         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   494         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   495         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   496         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   497         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   498         16  CM-AH-PAID-THRU-DT            PIC XX.
   499             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   500         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   501         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
   502         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   503         16  FILLER                        PIC X.
   504
   505     12  CM-LOAN-INFORMATION.
   506         16  CM-LIVES                      PIC S9(7)     COMP-3.
   507         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   508                                           PIC S9(5)V99  COMP-3.
   509         16  CM-BILLED                     PIC S9(7)     COMP-3.
   510         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   511         16  CM-PAY-FREQUENCY              PIC S99.
   512         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   513         16  CM-RATE-CLASS                 PIC XX.
   514         16  CM-BENEFICIARY                PIC X(25).
   515         16  CM-POLICY-FORM-NO             PIC X(12).
   516         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   517         16  CM-LAST-ADD-ON-DT             PIC XX.
   518         16  CM-DEDUCTIBLE-AMOUNTS.
   519             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   520             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   521         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   522             20  CM-RESIDENT-STATE         PIC XX.
   523             20  CM-RATE-CODE              PIC X(4).
   524             20  FILLER                    PIC XX.
   525         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   526             20  CM-LOAN-OFFICER           PIC X(5).
   527             20  FILLER                    PIC XXX.
   528         16  CM-CSR-CODE                   PIC XXX.
   529         16  CM-UNDERWRITING-CODE          PIC X.
   530             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   531         16  CM-POST-CARD-IND              PIC X.
   532         16  CM-REF-INTERFACE-SW           PIC X.
   533         16  CM-PREMIUM-TYPE               PIC X.
   534             88  CM-SING-PRM                  VALUE '1'.
   535             88  CM-O-B-COVERAGE              VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  11
* SOCK03.cbl
   536             88  CM-OPEN-END                  VALUE '3'.
   537         16  CM-IND-GRP-TYPE               PIC X.
   538             88  CM-INDIVIDUAL                VALUE 'I'.
   539             88  CM-GROUP                     VALUE 'G'.
   540         16  CM-SKIP-CODE                  PIC X.
   541             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   542             88  SKIP-JULY                    VALUE '1'.
   543             88  SKIP-AUGUST                  VALUE '2'.
   544             88  SKIP-SEPTEMBER               VALUE '3'.
   545             88  SKIP-JULY-AUG                VALUE '4'.
   546             88  SKIP-AUG-SEPT                VALUE '5'.
   547             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   548             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   549             88  SKIP-JUNE                    VALUE '8'.
   550             88  SKIP-JUNE-JULY               VALUE '9'.
   551             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   552             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   553         16  CM-PAYMENT-MODE               PIC X.
   554             88  PAY-MONTHLY                  VALUE SPACE.
   555             88  PAY-WEEKLY                   VALUE '1'.
   556             88  PAY-SEMI-MONTHLY             VALUE '2'.
   557             88  PAY-BI-WEEKLY                VALUE '3'.
   558             88  PAY-SEMI-ANUALLY             VALUE '4'.
   559         16  CM-LOAN-NUMBER                PIC X(8).
   560         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   561         16  CM-OLD-LOF                    PIC XXX.
   562*        16  CM-LOAN-OFFICER               PIC XXX.
   563         16  CM-REIN-TABLE                 PIC XXX.
   564         16  CM-SPECIAL-REIN-CODE          PIC X.
   565         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   566         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   567         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   568
   569     12  CM-STATUS-DATA.
   570         16  CM-ENTRY-STATUS               PIC X.
   571         16  CM-ENTRY-DT                   PIC XX.
   572
   573         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   574         16  CM-LF-CANCEL-DT               PIC XX.
   575         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   576
   577         16  CM-LF-STATUS-AT-DEATH         PIC X.
   578         16  CM-LF-DEATH-DT                PIC XX.
   579         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   580
   581         16  CM-LF-CURRENT-STATUS          PIC X.
   582             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   583                                                'M' '4' '5' '9'.
   584             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   585             88  CM-LF-POLICY-PENDING         VALUE '2'.
   586             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   587             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   588             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   589             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   590             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   591             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   592             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   593             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  12
* SOCK03.cbl
   594             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   595             88  CM-LF-DECLINED               VALUE 'D'.
   596             88  CM-LF-VOIDED                 VALUE 'V'.
   597
   598         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   599         16  CM-AH-CANCEL-DT               PIC XX.
   600         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   601
   602         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   603         16  CM-AH-SETTLEMENT-DT           PIC XX.
   604         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   605
   606         16  CM-AH-CURRENT-STATUS          PIC X.
   607             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   608                                                'M' '4' '5' '9'.
   609             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   610             88  CM-AH-POLICY-PENDING         VALUE '2'.
   611             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   612             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   613             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   614             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   615             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   616             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   617             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   618             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   619             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   620             88  CM-AH-DECLINED               VALUE 'D'.
   621             88  CM-AH-VOIDED                 VALUE 'V'.
   622
   623         16  CM-CLAIM-INTERFACE-SW         PIC X.
   624             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   625             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   626             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   627         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   628
   629         16  CM-ENTRY-BATCH                PIC X(6).
   630         16  CM-LF-EXIT-BATCH              PIC X(6).
   631         16  CM-AH-EXIT-BATCH              PIC X(6).
   632         16  CM-LAST-MONTH-END             PIC XX.
   633
   634     12  CM-NOTE-SW                        PIC X.
   635         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   636         88  CERT-NOTES-PRESENT               VALUE '1'.
   637         88  BILLING-NOTES-PRESENT            VALUE '2'.
   638         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   639         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   640         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   641         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   642         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   643     12  CM-COMP-EXCP-SW                   PIC X.
   644         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   645         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   646     12  CM-INSURED-ADDRESS-SW             PIC X.
   647         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   648         88  INSURED-ADDR-PRESENT             VALUE '1'.
   649
   650*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   651     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  13
* SOCK03.cbl
   652     12  FILLER                            PIC X.
   653
   654*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   655     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   656     12  FILLER                            PIC X.
   657*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   658     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
   659
   660     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   661         88  CERT-ADDED-BATCH                 VALUE ' '.
   662         88  CERT-ADDED-ONLINE                VALUE '1'.
   663         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   664         88  CERT-PURGED-OFFLINE              VALUE '3'.
   665         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   666     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   667         88  CERT-AS-LOADED                   VALUE ' '.
   668         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   669         88  CERT-CLAIM-ONLINE                VALUE '2'.
   670         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   671         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   672         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   673         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   674         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   675
   676     12  CM-ACCOUNT-COMM-PCTS.
   677         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   678         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   679
   680     12  CM-USER-FIELD                     PIC X.
   681     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   682     12  CM-CLP-STATE                      PIC XX.
   683     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   684     12  CM-USER-RESERVED                  PIC XXX.
   685     12  FILLER REDEFINES CM-USER-RESERVED.
   686         16  CM-AH-CLASS-CD                PIC XX.
   687         16  F                             PIC X.
   688******************************************************************
   689*                                 COPY ELCMSTR.
   690******************************************************************
   691*                                                                *
   692*                            ELCMSTR.                            *
   693*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   694*                            VMOD=2.012                          *
   695*                                                                *
   696*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   697*                                                                *
   698*   FILE TYPE = VSAM,KSDS                                        *
   699*   RECORD SIZE = 350  RECFORM = FIXED                           *
   700*                                                                *
   701*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   702*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   703*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   704*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   705*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   706*                                                 RKP=75,LEN=21  *
   707*                                                                *
   708*   **** NOTE ****                                               *
   709*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  14
* SOCK03.cbl
   710*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   711*                                                                *
   712*   LOG = YES                                                    *
   713*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   714******************************************************************
   715*                   C H A N G E   L O G
   716*
   717* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   718*-----------------------------------------------------------------
   719*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   720* EFFECTIVE    NUMBER
   721*-----------------------------------------------------------------
   722* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   723* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   724* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   725* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   726* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   727* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
   728* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   729******************************************************************
   730 01  CLAIM-MASTER.
   731     12  CL-RECORD-ID                PIC XX.
   732         88  VALID-CL-ID         VALUE 'CL'.
   733
   734     12  CL-CONTROL-PRIMARY.
   735         16  CL-COMPANY-CD           PIC X.
   736         16  CL-CARRIER              PIC X.
   737         16  CL-CLAIM-NO             PIC X(7).
   738         16  CL-CERT-NO.
   739             20  CL-CERT-PRIME       PIC X(10).
   740             20  CL-CERT-SFX         PIC X.
   741
   742     12  CL-CONTROL-BY-NAME.
   743         16  CL-COMPANY-CD-A1        PIC X.
   744         16  CL-INSURED-LAST-NAME    PIC X(15).
   745         16  CL-INSURED-NAME.
   746             20  CL-INSURED-1ST-NAME PIC X(12).
   747             20  CL-INSURED-MID-INIT PIC X.
   748
   749     12  CL-CONTROL-BY-SSN.
   750         16  CL-COMPANY-CD-A2        PIC X.
   751         16  CL-SOC-SEC-NO.
   752             20  CL-SSN-STATE        PIC XX.
   753             20  CL-SSN-ACCOUNT      PIC X(6).
   754             20  CL-SSN-LN3          PIC X(3).
   755
   756     12  CL-CONTROL-BY-CERT-NO.
   757         16  CL-COMPANY-CD-A4        PIC X.
   758         16  CL-CERT-NO-A4.
   759             20  CL-CERT-A4-PRIME    PIC X(10).
   760             20  CL-CERT-A4-SFX      PIC X.
   761
   762     12  CL-CONTROL-BY-CCN.
   763         16  CL-COMPANY-CD-A5        PIC X.
   764         16  CL-CCN-A5.
   765             20  CL-CCN.
   766                 24  CL-CCN-PREFIX-A5 PIC X(4).
   767                 24  CL-CCN-PRIME-A5 PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  15
* SOCK03.cbl
   768             20  CL-CCN-FILLER-A5    PIC X(4).
   769
   770     12  CL-INSURED-PROFILE-DATA.
   771         16  CL-INSURED-BIRTH-DT     PIC XX.
   772         16  CL-INSURED-SEX-CD       PIC X.
   773             88  INSURED-IS-MALE        VALUE 'M'.
   774             88  INSURED-IS-FEMALE      VALUE 'F'.
   775             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   776         16  CL-INSURED-OCC-CD       PIC X(6).
   777         16  FILLER                  PIC X(5).
   778
   779     12  CL-PROCESSING-INFO.
   780         16  CL-PROCESSOR-ID         PIC X(4).
   781         16  CL-CLAIM-STATUS         PIC X.
   782             88  CLAIM-IS-OPEN          VALUE 'O'.
   783             88  CLAIM-IS-CLOSED        VALUE 'C'.
   784         16  CL-CLAIM-TYPE           PIC X.
   785*            88  AH-CLAIM               VALUE 'A'.
   786*            88  LIFE-CLAIM             VALUE 'L'.
   787*            88  PROPERTY-CLAIM         VALUE 'P'.
   788*            88  IUI-CLAIM              VALUE 'I'.
   789*            88  GAP-CLAIM              VALUE 'G'.
   790*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   791*            88  OTHER-CLAIM            VALUE 'O'.
   792         16  CL-CLAIM-PREM-TYPE      PIC X.
   793             88  SINGLE-PREMIUM         VALUE '1'.
   794             88  O-B-COVERAGE           VALUE '2'.
   795             88  OPEN-END-COVERAGE      VALUE '3'.
   796         16  CL-INCURRED-DT          PIC XX.
   797         16  CL-REPORTED-DT          PIC XX.
   798         16  CL-FILE-ESTABLISH-DT    PIC XX.
   799         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   800         16  CL-LAST-PMT-DT          PIC XX.
   801         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   802         16  CL-PAID-THRU-DT         PIC XX.
   803         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   804         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   805         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   806         16  CL-PMT-CALC-METHOD      PIC X.
   807             88  CL-360-DAY-YR          VALUE '1'.
   808             88  CL-365-DAY-YR          VALUE '2'.
   809             88  CL-FULL-MONTHS         VALUE '3'.
   810         16  CL-CAUSE-CD             PIC X(6).
   811
   812         16  CL-PRIME-CERT-NO.
   813             20  CL-PRIME-CERT-PRIME PIC X(10).
   814             20  CL-PRIME-CERT-SFX   PIC X.
   815
   816         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   817             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   818             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   819
   820         16  CL-MICROFILM-NO         PIC X(10).
   821         16  FILLER REDEFINES CL-MICROFILM-NO.
   822             20  CL-BENEFIT-PERIOD   PIC 99.
   823             20  FILLER              PIC X(8).
   824         16  CL-PROG-FORM-TYPE       PIC X.
   825         16  CL-LAST-ADD-ON-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  16
* SOCK03.cbl
   826
   827         16  CL-LAST-REOPEN-DT       PIC XX.
   828         16  CL-LAST-CLOSE-DT        PIC XX.
   829         16  CL-LAST-CLOSE-REASON    PIC X(01).
   830             88  FINAL-PAID             VALUE '1'.
   831             88  CLAIM-DENIED           VALUE '2'.
   832             88  AUTO-CLOSE             VALUE '3'.
   833             88  MANUAL-CLOSE           VALUE '4'.
   834             88  BENEFITS-CHANGED       VALUE 'C'.
   835             88  SETUP-ERRORS           VALUE 'E'.
   836         16  CL-ASSOC-CERT-SEQU      PIC S99.
   837         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   838         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   839             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   840         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   841         16  FILLER                  PIC X.
   842
   843     12  CL-CERTIFICATE-DATA.
   844         16  CL-CERT-ORIGIN          PIC X.
   845             88  CERT-WAS-ONLINE        VALUE '1'.
   846             88  CERT-WAS-CREATED       VALUE '2'.
   847             88  COVERAGE-WAS-ADDED     VALUE '3'.
   848         16  CL-CERT-KEY-DATA.
   849             20  CL-CERT-CARRIER     PIC X.
   850             20  CL-CERT-GROUPING    PIC X(6).
   851             20  CL-CERT-STATE       PIC XX.
   852             20  CL-CERT-ACCOUNT.
   853                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   854                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   855             20  CL-CERT-EFF-DT      PIC XX.
   856
   857     12  CL-STATUS-CONTROLS.
   858         16  CL-PRIORITY-CD          PIC X.
   859             88  CONFIDENTIAL-DATA      VALUE '8'.
   860             88  HIGHEST-PRIORITY       VALUE '9'.
   861         16  CL-SUPV-ATTN-CD         PIC X.
   862             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   863             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   864         16  CL-PURGED-DT            PIC XX.
   865         16  CL-RESTORED-DT          PIC XX.
   866         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   867         16  CL-NEXT-RESEND-DT       PIC XX.
   868         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   869         16  CL-CRITICAL-PERIOD      PIC 99.
   870*        16  FILLER                  PIC XX.
   871         16  CL-LAST-MAINT-DT        PIC XX.
   872         16  CL-LAST-MAINT-USER      PIC X(4).
   873         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   874         16  CL-LAST-MAINT-TYPE      PIC X.
   875             88  CLAIM-SET-UP           VALUE ' '.
   876             88  PAYMENT-MADE           VALUE '1'.
   877             88  LETTER-SENT            VALUE '2'.
   878             88  MASTER-WAS-ALTERED     VALUE '3'.
   879             88  MASTER-WAS-RESTORED    VALUE '4'.
   880             88  INCURRED-DATE-CHANGED  VALUE '5'.
   881             88  FILE-CONVERTED         VALUE '6'.
   882             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   883             88  ERROR-CORRECTION       VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  17
* SOCK03.cbl
   884         16  CL-RELATED-CLAIM-NO     PIC X(7).
   885         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   886         16  CL-BENEFICIARY          PIC X(10).
   887         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   888         16  CL-DENIAL-TYPE          PIC X.
   889             88  CL-TYPE-DENIAL          VALUE '1'.
   890             88  CL-TYPE-RESCISSION      VALUE '2'.
   891             88  CL-TYPE-REFORMATION     VALUE '3'.
   892             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   893             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   894         16  CL-NO-OF-EXTENSIONS     PIC 99.
   895         16  filler                  pic x(3).
   896*        16  CL-CRIT-PER-RECURRENT   PIC X.
   897*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
   898*        16  CL-RTW-DT               PIC XX.
   899
   900     12  CL-TRAILER-CONTROLS.
   901         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   902             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   903             88  CL-LAST-TRL-AVAIL      VALUE +100.
   904             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   905         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   906         16  FILLER                  PIC XX.
   907         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   908         16  CL-ADDRESS-TRAILER-CNT.
   909             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   910                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   911             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   912                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   913             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   914                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   915             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   916                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   917             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   918                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   919             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   920                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   921             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   922                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   923
   924     12  CL-CV-REFERENCE-NO.
   925         16  CL-CV-REFNO-PRIME       PIC X(18).
   926         16  CL-CV-REFNO-SFX         PIC XX.
   927
   928     12  CL-FILE-LOCATION            PIC X(4).
   929
   930     12  CL-PROCESS-ERRORS.
   931         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   932             88  NO-FATAL-ERRORS        VALUE ZERO.
   933         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   934             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   935
   936     12  CL-PRODUCT-CD               PIC X.
   937
   938     12  CL-CURRENT-KEY-DATA.
   939         16  CL-CURRENT-CARRIER      PIC X.
   940         16  CL-CURRENT-GROUPING     PIC X(6).
   941         16  CL-CURRENT-STATE        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  18
* SOCK03.cbl
   942         16  CL-CURRENT-ACCOUNT      PIC X(10).
   943
   944     12  CL-ASSOCIATES               PIC X.
   945         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   946         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   947         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   948         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   949
   950     12  CL-ACTIVITY-CODE            PIC 99.
   951     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   952     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   953
   954     12  CL-LAPSE-REPORT-CODE        PIC 9.
   955     12  CL-LAG-REPORT-CODE          PIC 9.
   956     12  CL-LOAN-TYPE                PIC XX.
   957     12  CL-LEGAL-STATE              PIC XX.
   958
   959     12  CL-YESNOSW                  PIC X.
   960     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   961         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   962         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   963         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   964     12  cl-insured-type             pic x.
   965         88  cl-claim-on-primary         value 'P'.
   966         88  cl-claim-on-co-borrower     value 'C'.
   967     12  cl-benefit-expiration-dt    PIC XX.
   968*                                 COPY ERCPDEF.
   969******************************************************************
   970*                                                                *
   971*                                                                *
   972*                            ERCPDEF.                            *
   973*                                                                *
   974*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   975*                                                                *
   976*    FILE TYPE = VSAM,KSDS                                       *
   977*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   978*                                                                *
   979*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   980*                                                                *
   981*    LOG = YES                                                   *
   982*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   983******************************************************************
   984*                   C H A N G E   L O G
   985*
   986* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   987*-----------------------------------------------------------------
   988*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   989* EFFECTIVE    NUMBER
   990*-----------------------------------------------------------------
   991* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   992* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   993* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   994* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   995******************************************************************
   996 01  PRODUCT-MASTER.
   997    12  PD-RECORD-ID                 PIC X(02).
   998        88  VALID-PD-ID                  VALUE 'PD'.
   999    12  PD-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  19
* SOCK03.cbl
  1000        16  PD-COMPANY-CD            PIC X.
  1001        16  PD-STATE                 PIC XX.
  1002        16  PD-PRODUCT-CD            PIC XXX.
  1003        16  PD-FILLER                PIC X(7).
  1004        16  PD-BEN-TYPE              PIC X.
  1005        16  PD-BEN-CODE              PIC XX.
  1006        16  PD-PROD-EXP-DT           PIC XX.
  1007    12  FILLER                       PIC X(50).
  1008    12  PD-PRODUCT-DATA OCCURS 8.
  1009        16  PD-PROD-CODE             PIC X.
  1010            88  PD-PROD-LIFE           VALUE 'L'.
  1011            88  PD-PROD-PROP           VALUE 'P'.
  1012            88  PD-PROD-AH             VALUE 'A'.
  1013            88  PD-PROD-IU             VALUE 'I'.
  1014            88  PD-PROD-GAP            VALUE 'G'.
  1015            88  PD-PROD-FAML           VALUE 'F'.
  1016            88  PD-PROD-OTH            VALUE 'O'.
  1017        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  1018        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  1019        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  1020        16  PD-MAX-TERM              PIC S999        COMP-3.
  1021        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  1022        16  FILLER                   PIC X.
  1023        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  1024        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  1025        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  1026        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  1027        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  1028        16  PD-REC-CRIT-PERIOD       PIC 99.
  1029        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  1030            20  PD-RECURRING-YN      PIC X.
  1031            20  FILLER               PIC X.
  1032        16  PD-RTW-MOS               PIC 99.
  1033        16  PD-MAX-EXTENSION         PIC 99.
  1034        16  pd-ben-pct               pic sv999 comp-3.
  1035*       16  FILLER                   PIC XX.
  1036    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  1037    12  PD-TERM-LIMITS OCCURS 15.
  1038        16  PD-LOW-TERM              PIC S999        COMP-3.
  1039        16  PD-HI-TERM               PIC S999        COMP-3.
  1040*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  1041    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  1042        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  1043        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  1044    12  PD-EARN-FACTORS.
  1045        16  FILLER OCCURS 15.
  1046            20  FILLER OCCURS 15.
  1047                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  1048    12  PD-PRODUCT-DESC              PIC X(80).
  1049    12  PD-TRUNCATED                 PIC X.
  1050    12  FILLER                       PIC X(59).
  1051    12  PD-MAINT-INFORMATION.
  1052        16  PD-LAST-MAINT-DT         PIC X(02).
  1053        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  1054        16  PD-LAST-MAINT-BY         PIC X(04).
  1055*                                 COPY ERCCTBL.
  1056******************************************************************
  1057*                                                                *
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  20
* SOCK03.cbl
  1058*                                                                *
  1059*                            ERCCTBL                             *
  1060*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1061*                            VMOD=2.003
  1062*                                                                *
  1063*   ONLINE CREDIT SYSTEM                                         *
  1064*                                                                *
  1065*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  1066*                                                                *
  1067*   FILE TYPE = VSAM,KSDS                                        *
  1068*   RECORD SIZE = 200   RECFORM = FIXED                          *
  1069*                                                                *
  1070*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  1071*       ALTERNATE PATH = NONE                                    *
  1072*                                                                *
  1073*   LOG = NO                                                     *
  1074*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1075*                                                                *
  1076*                                                                *
  1077******************************************************************
  1078
  1079 01  COMM-TABLE-RECORD.
  1080     12  CT-RECORD-ID                      PIC XX.
  1081         88  VALID-CT-ID                      VALUE 'CT'.
  1082
  1083     12  CT-CONTROL-PRIMARY.
  1084         16  CT-COMPANY-CD                 PIC X.
  1085         16  CT-TABLE                      PIC XXX.
  1086         16  CT-CNTRL-2.
  1087             20  CT-BEN-TYPE               PIC X.
  1088             20  CT-BEN-CODE               PIC XX.
  1089
  1090     12  CT-MAINT-INFORMATION.
  1091         16  CT-LAST-MAINT-DT              PIC XX.
  1092         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1093         16  CT-LAST-MAINT-USER            PIC X(4).
  1094         16  FILLER                        PIC X(31).
  1095
  1096     12  CT-LIMITS.
  1097         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  1098
  1099         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  1100
  1101         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  1102
  1103     12  CT-RATES.
  1104         16  CT-RTX          OCCURS 27 TIMES.
  1105             20  CT-RT                     PIC SV9(5)     COMP-3.
  1106             20  CT-RT-R   REDEFINES
  1107                 CT-RT                     PIC XXX.
  1108
  1109     12  FILLER                            PIC  X(42).
  1110
  1111******************************************************************
  1112*                                 COPY ELCCNTL.
  1113******************************************************************
  1114*                                                                *
  1115*                                                                *
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  21
* SOCK03.cbl
  1116*                            ELCCNTL.                            *
  1117*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1118*                            VMOD=2.059                          *
  1119*                                                                *
  1120*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1121*                                                                *
  1122*   FILE TYPE = VSAM,KSDS                                        *
  1123*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1124*                                                                *
  1125*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1126*       ALTERNATE INDEX = NONE                                   *
  1127*                                                                *
  1128*   LOG = YES                                                    *
  1129*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1130******************************************************************
  1131*                   C H A N G E   L O G
  1132*
  1133* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1134*-----------------------------------------------------------------
  1135*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1136* EFFECTIVE    NUMBER
  1137*-----------------------------------------------------------------
  1138* 082503                   PEMA  ADD BENEFIT GROUP
  1139* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1140* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1141* 092705    2005050300006  PEMA  ADD SPP LEASES
  1142* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1143* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1144* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1145* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1146* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1147* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1148* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1149* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1150* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1151* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1152* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  1153******************************************************************
  1154*
  1155 01  CONTROL-FILE.
  1156     12  CF-RECORD-ID                       PIC XX.
  1157         88  VALID-CF-ID                        VALUE 'CF'.
  1158
  1159     12  CF-CONTROL-PRIMARY.
  1160         16  CF-COMPANY-ID                  PIC XXX.
  1161         16  CF-RECORD-TYPE                 PIC X.
  1162             88  CF-COMPANY-MASTER              VALUE '1'.
  1163             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1164             88  CF-STATE-MASTER                VALUE '3'.
  1165             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1166             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1167             88  CF-CARRIER-MASTER              VALUE '6'.
  1168             88  CF-MORTALITY-MASTER            VALUE '7'.
  1169             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1170             88  CF-TERMINAL-MASTER             VALUE '9'.
  1171             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1172             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1173             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  22
* SOCK03.cbl
  1174             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1175             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1176             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1177             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1178             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1179             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1180         16  CF-ACCESS-CD-GENL              PIC X(4).
  1181         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1182             20  CF-PROCESSOR               PIC X(4).
  1183         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1184             20  CF-STATE-CODE              PIC XX.
  1185             20  FILLER                     PIC XX.
  1186         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1187             20  FILLER                     PIC XX.
  1188             20  CF-HI-BEN-IN-REC           PIC XX.
  1189         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1190             20  FILLER                     PIC XXX.
  1191             20  CF-CARRIER-CNTL            PIC X.
  1192         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1193             20  FILLER                     PIC XX.
  1194             20  CF-HI-TYPE-IN-REC          PIC 99.
  1195         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1196             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1197                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1198             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1199             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1200         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1201             20  FILLER                     PIC X.
  1202             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1203         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1204             20  FILLER                     PIC XX.
  1205             20  CF-MORTGAGE-PLAN           PIC XX.
  1206         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1207
  1208     12  CF-LAST-MAINT-DT                   PIC XX.
  1209     12  CF-LAST-MAINT-BY                   PIC X(4).
  1210     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1211
  1212     12  CF-RECORD-BODY                     PIC X(728).
  1213
  1214
  1215****************************************************************
  1216*             COMPANY MASTER RECORD                            *
  1217****************************************************************
  1218
  1219     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1220         16  CF-COMPANY-ADDRESS.
  1221             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1222             20  CF-CL-IN-CARE-OF           PIC X(30).
  1223             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1224             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1225             20  CF-CL-CITY-STATE           PIC X(30).
  1226             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1227             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1228         16  CF-COMPANY-CD                  PIC X.
  1229         16  CF-COMPANY-PASSWORD            PIC X(8).
  1230         16  CF-SECURITY-OPTION             PIC X.
  1231             88  ALL-SECURITY                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  23
* SOCK03.cbl
  1232             88  COMPANY-VERIFY                 VALUE '2'.
  1233             88  PROCESSOR-VERIFY               VALUE '3'.
  1234             88  NO-SECURITY                    VALUE '4'.
  1235             88  ALL-BUT-TERM                   VALUE '5'.
  1236         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1237             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1238         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1239             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1240         16  CF-INFORCE-LOCATION            PIC X.
  1241             88  CERTS-ARE-ONLINE               VALUE '1'.
  1242             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1243             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1244         16  CF-LOWER-CASE-LETTERS          PIC X.
  1245         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1246             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1247             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1248             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1249             88  CF-ACCNT-CNTL                  VALUE '3'.
  1250             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1251
  1252         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1253         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1254
  1255         16  CF-LGX-CREDIT-USER             PIC X.
  1256             88  CO-IS-NOT-USER                 VALUE 'N'.
  1257             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1258
  1259         16 CF-CREDIT-CALC-CODES.
  1260             20  CF-CR-REM-TERM-CALC PIC X.
  1261               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1262               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1263               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1264               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1265               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1266               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1267               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1268             20  CF-CR-R78-METHOD           PIC X.
  1269               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1270               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1271
  1272         16  CF-CLAIM-CONTROL-COUNTS.
  1273             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1274                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1275
  1276             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1277                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1278
  1279             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1280                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1281
  1282             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1283                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1284
  1285         16  CF-CURRENT-MONTH-END           PIC XX.
  1286
  1287         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1288             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1289             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  24
* SOCK03.cbl
  1290             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1291             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1292                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1293                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1294             20  CF-CO-PREM-REJECT-SW       PIC X.
  1295                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1296                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1297             20  CF-CO-REF-REJECT-SW        PIC X.
  1298                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1299                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1300
  1301         16  CF-CO-REPORTING-DT             PIC XX.
  1302         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1303         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1304           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1305           88  CF-CO-MONTH-END                  VALUE '1'.
  1306
  1307         16  CF-LGX-CLAIM-USER              PIC X.
  1308             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1309             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1310
  1311         16  CF-CREDIT-EDIT-CONTROLS.
  1312             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1313             20  CF-MIN-AGE                 PIC 99.
  1314             20  CF-DEFAULT-AGE             PIC 99.
  1315             20  CF-MIN-TERM                PIC S999      COMP-3.
  1316             20  CF-MAX-TERM                PIC S999      COMP-3.
  1317             20  CF-DEFAULT-SEX             PIC X.
  1318             20  CF-JOINT-AGE-INPUT         PIC X.
  1319                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1320             20  CF-BIRTH-DATE-INPUT        PIC X.
  1321                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1322             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1323                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1324                 88  CF-ZERO-CARRIER            VALUE '1'.
  1325                 88  CF-ZERO-GROUPING           VALUE '2'.
  1326                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1327             20  CF-EDIT-SW                 PIC X.
  1328                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1329             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1330             20  CF-CR-PR-METHOD            PIC X.
  1331               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1332               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1333             20  FILLER                     PIC X.
  1334
  1335         16  CF-CREDIT-MISC-CONTROLS.
  1336             20  CF-REIN-TABLE-SW           PIC X.
  1337                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1338             20  CF-COMP-TABLE-SW           PIC X.
  1339                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1340             20  CF-EXPERIENCE-RETENTION-AGE
  1341                                            PIC S9        COMP-3.
  1342             20  CF-CONVERSION-DT           PIC XX.
  1343             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1344             20  CF-RUN-FREQUENCY-SW        PIC X.
  1345                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1346                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1347
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  25
* SOCK03.cbl
  1348             20  CF-CR-CHECK-NO-CONTROL.
  1349                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1350                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1351                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1352                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1353                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1354                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1355
  1356                 24  CF-CR-CHECK-COUNT       REDEFINES
  1357                     CF-CR-CHECK-COUNTER      PIC X(4).
  1358
  1359                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1360                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1361
  1362                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1363                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1364                 24  CF-MAIL-PROCESSING       PIC X.
  1365                     88  MAIL-PROCESSING          VALUE 'Y'.
  1366
  1367         16  CF-MISC-SYSTEM-CONTROL.
  1368             20  CF-SYSTEM-C                 PIC X.
  1369                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1370             20  CF-SYSTEM-D                 PIC X.
  1371                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1372             20  CF-SOC-SEC-NO-SW            PIC X.
  1373                 88  SOC-SEC-NO-USED             VALUE '1'.
  1374             20  CF-MEMBER-NO-SW             PIC X.
  1375                 88  MEMBER-NO-USED              VALUE '1'.
  1376             20  CF-TAX-ID-NUMBER            PIC X(11).
  1377             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1378             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1379                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1380                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1381                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1382                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1383             20  CF-SYSTEM-E                 PIC X.
  1384                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1385
  1386         16  CF-LGX-LIFE-USER               PIC X.
  1387             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1388             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1389
  1390         16  CF-CR-MONTH-END-DT             PIC XX.
  1391
  1392         16  CF-FILE-MAINT-DATES.
  1393             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1394                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1395             20  CF-LAST-BATCH       REDEFINES
  1396                 CF-LAST-BATCH-NO               PIC X(4).
  1397             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1398             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1399             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1400             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1401             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1402             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1403             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1404             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1405             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  26
* SOCK03.cbl
  1406             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1407
  1408         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1409         16  FILLER                         PIC X.
  1410
  1411         16  CF-ALT-MORT-CODE               PIC X(4).
  1412         16  CF-MEMBER-CAPTION              PIC X(10).
  1413
  1414         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1415             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1416             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1417             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1418             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1419             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1420
  1421         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1422
  1423         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1424         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1425         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1426         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1427
  1428         16  CF-AH-OVERRIDE-L1              PIC X.
  1429         16  CF-AH-OVERRIDE-L2              PIC XX.
  1430         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1431         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1432
  1433         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1434         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1435
  1436         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1437         16  CF-AR-LAST-EL860-DT            PIC XX.
  1438         16  CF-MP-MONTH-END-DT             PIC XX.
  1439
  1440         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1441         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1442             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1443
  1444         16  CF-AR-MONTH-END-DT             PIC XX.
  1445
  1446         16  CF-CRDTCRD-USER                PIC X.
  1447             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1448             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1449
  1450         16  CF-CC-MONTH-END-DT             PIC XX.
  1451
  1452         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1453
  1454         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1455             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1456             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1457             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1458         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1459         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1460         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1461         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1462             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1463             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  27
* SOCK03.cbl
  1464         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1465         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1466         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1467             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1468         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1469
  1470         16  CF-CL-ZIP-CODE.
  1471             20  CF-CL-ZIP-PRIME.
  1472                 24  CF-CL-ZIP-1ST          PIC X.
  1473                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1474                 24  FILLER                 PIC X(4).
  1475             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1476         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1477             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1478             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1479             20  FILLER                     PIC XXX.
  1480
  1481         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1482         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1483         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1484         16  CF-CO-OPTION-START-DATE        PIC XX.
  1485         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1486           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1487                                                      '3' '4'.
  1488           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1489           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1490           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1491           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1492           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1493           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1494
  1495         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1496
  1497         16  CF-PAYMENT-APPROVAL-LEVELS.
  1498             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1499             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1500             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1501             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1502             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1503             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1504
  1505         16  CF-END-USER-REPORTING-USER     PIC X.
  1506             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1507             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1508
  1509         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1510             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1511             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1512
  1513         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1514
  1515         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1516         16  FILLER                         PIC X.
  1517
  1518         16  CF-CREDIT-ARCHIVE-CNTL.
  1519             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1520             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1521             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  28
* SOCK03.cbl
  1522
  1523         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1524
  1525         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1526             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1527             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1528
  1529         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1530             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1531             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1532
  1533         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1534
  1535         16  CF-CO-ACH-ID-CODE              PIC  X.
  1536             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1537             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1538             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1539         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1540         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1541         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1542         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1543         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1544         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1545         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1546         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1547         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1548                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1549         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1550                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1551
  1552         16  CF-CO-OVER-SHORT.
  1553             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1554             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1555
  1556*         16  FILLER                         PIC X(102).
  1557         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1558             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1559             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1560
  1561         16  CF-AH-APPROVAL-DAYS.
  1562             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1563             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1564             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1565             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1566
  1567         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1568
  1569         16  CF-APPROV-LEV-5.
  1570             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1571             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1572             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1573
  1574         16  FILLER                         PIC X(68).
  1575****************************************************************
  1576*             PROCESSOR/USER RECORD                            *
  1577****************************************************************
  1578
  1579     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  29
* SOCK03.cbl
  1580         16  CF-PROCESSOR-NAME              PIC X(30).
  1581         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1582         16  CF-PROCESSOR-TITLE             PIC X(26).
  1583         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1584                 88  MESSAGE-YES                VALUE 'Y'.
  1585                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1586
  1587*****************************************************
  1588****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1589****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1590****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1591****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1592*****************************************************
  1593
  1594         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1595             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1596             20  CF-APPLICATION-FORCE       PIC X.
  1597             20  CF-INDIVIDUAL-APP.
  1598                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1599                     28  CF-BROWSE-APP      PIC X.
  1600                     28  CF-UPDATE-APP      PIC X.
  1601
  1602         16  CF-CURRENT-TERM-ON             PIC X(4).
  1603         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1604             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1605             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1606             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1607             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1608             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1609             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1610             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1611         16  CF-PROCESSOR-CARRIER           PIC X.
  1612             88  NO-CARRIER-SECURITY            VALUE ' '.
  1613         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1614             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1615         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1616             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1617         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1618             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1619
  1620         16  CF-PROC-SYS-ACCESS-SW.
  1621             20  CF-PROC-CREDIT-CLAIMS-SW.
  1622                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1623                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1624                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1625                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1626             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1627                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1628                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1629             20  CF-PROC-LIFE-GNRLDGR-SW.
  1630                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1631                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1632                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1633                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1634             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1635                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1636                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1637         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  30
* SOCK03.cbl
  1638             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1639             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1640         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1641
  1642         16  CF-APPROVAL-LEVEL                  PIC X.
  1643             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1644             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1645             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1646             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1647             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1648
  1649         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1650
  1651         16  CF-LANGUAGE-TYPE                   PIC X.
  1652             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1653             88  CF-LANG-IS-FR                      VALUE 'F'.
  1654
  1655         16  CF-CSR-IND                         PIC X.
  1656         16  FILLER                             PIC X(239).
  1657
  1658****************************************************************
  1659*             PROCESSOR/REMINDERS RECORD                       *
  1660****************************************************************
  1661
  1662     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1663         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1664             20  CF-START-REMIND-DT         PIC XX.
  1665             20  CF-END-REMIND-DT           PIC XX.
  1666             20  CF-REMINDER-TEXT           PIC X(50).
  1667         16  FILLER                         PIC X(296).
  1668
  1669
  1670****************************************************************
  1671*             STATE MASTER RECORD                              *
  1672****************************************************************
  1673
  1674     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1675         16  CF-STATE-ABBREVIATION          PIC XX.
  1676         16  CF-STATE-NAME                  PIC X(25).
  1677         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1678         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1679             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1680             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1681             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1682             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1683                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1684                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1685             20  CF-ST-PREM-REJECT-SW       PIC X.
  1686                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1687                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1688             20  CF-ST-REF-REJECT-SW        PIC X.
  1689                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1690                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1691         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1692         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1693         16  CF-ST-REFUND-RULES.
  1694             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1695             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  31
* SOCK03.cbl
  1696             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1697         16  CF-ST-FST-PMT-EXTENSION.
  1698             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1699             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1700                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1701                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1702                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1703                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1704         16  CF-ST-STATE-CALL.
  1705             20  CF-ST-CALL-UNEARNED        PIC X.
  1706             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1707             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1708         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1709             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1710             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1711         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1712         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1713         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1714         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1715         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1716         16  FILLER                         PIC X.
  1717         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1718             20  CF-ST-BENEFIT-CD           PIC XX.
  1719             20  CF-ST-BENEFIT-KIND         PIC X.
  1720                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1721                 88  CF-ST-AH-KIND              VALUE 'A'.
  1722             20  CF-ST-REM-TERM-CALC        PIC X.
  1723                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1724                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1725                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1726                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1727                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1728                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1729                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1730                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1731
  1732             20  CF-ST-REFUND-CALC          PIC X.
  1733                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1734                 88  ST-REFD-BY-R78             VALUE '1'.
  1735                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1736                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1737                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1738                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1739                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1740                 88  ST-REFD-UTAH               VALUE '7'.
  1741                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1742                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1743                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1744
  1745             20  CF-ST-EARNING-CALC         PIC X.
  1746                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1747                 88  ST-EARN-BY-R78             VALUE '1'.
  1748                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1749                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1750                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1751                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1752                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1753                 88  ST-EARN-MEAN               VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  32
* SOCK03.cbl
  1754                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1755
  1756             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1757                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1758                 88  ST-OVRD-BY-R78             VALUE '1'.
  1759                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1760                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1761                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1762                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1763                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1764                 88  ST-OVRD-MEAN               VALUE '8'.
  1765                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1766             20  cf-st-extra-periods        pic 9.
  1767*            20  FILLER                     PIC X.
  1768
  1769         16  CF-ST-COMMISSION-CAPS.
  1770             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1771             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1772             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1773             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1774         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1775                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1776                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  1777                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  1778
  1779         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1780
  1781         16  CF-ST-STATUTORY-INTEREST.
  1782             20  CF-ST-STAT-DATE-FROM       PIC X.
  1783                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1784                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1785             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1786             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1787             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1788             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1789             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1790
  1791         16  CF-ST-OVER-SHORT.
  1792             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1793             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1794
  1795         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1796
  1797         16  CF-ST-RT-CALC                  PIC X.
  1798
  1799         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1800         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1801         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1802         16  CF-ST-RF-LR-CALC               PIC X.
  1803         16  CF-ST-RF-LL-CALC               PIC X.
  1804         16  CF-ST-RF-LN-CALC               PIC X.
  1805         16  CF-ST-RF-AH-CALC               PIC X.
  1806         16  CF-ST-RF-CP-CALC               PIC X.
  1807*        16  FILLER                         PIC X(206).
  1808*CIDMOD         16  FILLER                         PIC X(192).
  1809         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1810             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1811         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  33
* SOCK03.cbl
  1812         16  CF-ST-VFY-2ND-BENE             PIC X.
  1813         16  CF-ST-CAUSAL-STATE             PIC X.
  1814         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1815         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1816         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1817             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1818         16  CF-ST-NET-ONLY-STATE           PIC X.
  1819             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1820         16  cf-commission-cap-required     pic x.
  1821         16  CF-ST-GA-COMMISSION-CAPS.
  1822             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  1823             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  1824             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  1825             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  1826         16  CF-ST-TOT-COMMISSION-CAPS.
  1827             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  1828             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  1829             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  1830             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  1831         16  FILLER                         PIC X(156).
  1832
  1833****************************************************************
  1834*             BENEFIT MASTER RECORD                            *
  1835****************************************************************
  1836
  1837     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1838         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1839             20  CF-BENEFIT-CODE            PIC XX.
  1840             20  CF-BENEFIT-NUMERIC  REDEFINES
  1841                 CF-BENEFIT-CODE            PIC XX.
  1842             20  CF-BENEFIT-ALPHA           PIC XXX.
  1843             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1844             20  CF-BENEFIT-COMMENT         PIC X(10).
  1845
  1846             20  CF-LF-COVERAGE-TYPE        PIC X.
  1847                 88  CF-REDUCING                VALUE 'R'.
  1848                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1849
  1850             20  CF-SPECIAL-CALC-CD         PIC X.
  1851                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1852                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1853                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1854                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1855                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1856                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1857                 88  CF-FARM-PLAN               VALUE 'F'.
  1858                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1859                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1860                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1861                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1862                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1863                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1864                 88  CF-PRUDENTIAL              VALUE 'P'.
  1865                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1866                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1867                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1868                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1869                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  34
* SOCK03.cbl
  1870                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1871
  1872             20  CF-JOINT-INDICATOR         PIC X.
  1873                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1874
  1875*            20  FILLER                     PIC X(12).
  1876             20  cf-maximum-benefits        pic s999 comp-3.
  1877             20  FILLER                     PIC X(09).
  1878             20  CF-BENEFIT-CATEGORY        PIC X.
  1879             20  CF-LOAN-TYPE               PIC X(8).
  1880
  1881             20  CF-CO-REM-TERM-CALC        PIC X.
  1882                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1883                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1884                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1885                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1886                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1887
  1888             20  CF-CO-EARNINGS-CALC        PIC X.
  1889                 88  CO-EARN-BY-R78             VALUE '1'.
  1890                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1891                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1892                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1893                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1894                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1895                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1896                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1897
  1898             20  CF-CO-REFUND-CALC          PIC X.
  1899                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1900                 88  CO-REFD-BY-R78             VALUE '1'.
  1901                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1902                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1903                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1904                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1905                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1906                 88  CO-REFD-MEAN               VALUE '8'.
  1907                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1908                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1909                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1910
  1911             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1912                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1913                 88  CO-OVRD-BY-R78             VALUE '1'.
  1914                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1915                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1916                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1917                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1918                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1919                 88  CO-OVRD-MEAN               VALUE '8'.
  1920                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1921
  1922             20  CF-CO-BEN-I-G-CD           PIC X.
  1923                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1924                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1925                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1926
  1927         16  FILLER                         PIC X(304).
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  35
* SOCK03.cbl
  1928
  1929
  1930****************************************************************
  1931*             CARRIER MASTER RECORD                            *
  1932****************************************************************
  1933
  1934     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1935         16  CF-ADDRESS-DATA.
  1936             20  CF-MAIL-TO-NAME            PIC X(30).
  1937             20  CF-IN-CARE-OF              PIC X(30).
  1938             20  CF-ADDRESS-LINE-1          PIC X(30).
  1939             20  CF-ADDRESS-LINE-2          PIC X(30).
  1940             20  CF-CITY-STATE              PIC X(30).
  1941             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1942             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1943
  1944         16  CF-CLAIM-NO-CONTROL.
  1945             20  CF-CLAIM-NO-METHOD         PIC X.
  1946                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1947                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1948                 88  CLAIM-NO-SEQ               VALUE '3'.
  1949                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1950             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1951                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1952                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1953                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1954
  1955         16  CF-CHECK-NO-CONTROL.
  1956             20  CF-CHECK-NO-METHOD         PIC X.
  1957                 88  CHECK-NO-MANUAL            VALUE '1'.
  1958                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1959                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1960                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1961             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1962                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1963
  1964         16  CF-DOMICILE-STATE              PIC XX.
  1965
  1966         16  CF-EXPENSE-CONTROLS.
  1967             20  CF-EXPENSE-METHOD          PIC X.
  1968                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1969                 88  DOLLARS-PER-PMT            VALUE '2'.
  1970                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1971                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1972             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1973             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1974
  1975         16  CF-CORRESPONDENCE-CONTROL.
  1976             20  CF-LETTER-RESEND-OPT       PIC X.
  1977                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1978                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1979             20  FILLER                     PIC X(4).
  1980
  1981         16  CF-RESERVE-CONTROLS.
  1982             20  CF-MANUAL-SW               PIC X.
  1983                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1984             20  CF-FUTURE-SW               PIC X.
  1985                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  36
* SOCK03.cbl
  1986             20  CF-PTC-SW                  PIC X.
  1987                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1988             20  CF-IBNR-SW                 PIC X.
  1989                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1990             20  CF-PTC-LF-SW               PIC X.
  1991                 88  CF-LF-PTC-USED             VALUE '1'.
  1992             20  CF-CDT-ACCESS-METHOD       PIC X.
  1993                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1994                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1995                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1996             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1997
  1998         16  CF-CLAIM-CALC-METHOD           PIC X.
  1999             88  360-PLUS-MONTHS                VALUE '1'.
  2000             88  365-PLUS-MONTHS                VALUE '2'.
  2001             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2002             88  360-DAILY                      VALUE '4'.
  2003             88  365-DAILY                      VALUE '5'.
  2004
  2005         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2006         16  FILLER                         PIC X(11).
  2007
  2008         16  CF-LIMIT-AMOUNTS.
  2009             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2010             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2011             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2012             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2013             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2014             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2015             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2016             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2017             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2018             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2019
  2020         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2021         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2022         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2023
  2024         16  CF-ZIP-CODE.
  2025             20  CF-ZIP-PRIME.
  2026                 24  CF-ZIP-1ST             PIC X.
  2027                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2028                 24  FILLER                 PIC X(4).
  2029             20  CF-ZIP-PLUS4               PIC X(4).
  2030         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2031             20  CF-CAN-POSTAL-1            PIC XXX.
  2032             20  CF-CAN-POSTAL-2            PIC XXX.
  2033             20  FILLER                     PIC XXX.
  2034
  2035         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2036         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2037         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2038
  2039         16  CF-RATING-SWITCH               PIC X.
  2040             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2041             88  CF-NO-RATING                   VALUE 'N'.
  2042
  2043         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  37
* SOCK03.cbl
  2044
  2045         16  CF-CARRIER-OVER-SHORT.
  2046             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2047             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2048
  2049         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2050         16  CF-SECPAY-SWITCH               PIC X.
  2051             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2052             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2053         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2054         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2055         16  FILLER                         PIC X(444).
  2056*        16  FILLER                         PIC X(452).
  2057
  2058
  2059****************************************************************
  2060*             MORTALITY MASTER RECORD                          *
  2061****************************************************************
  2062
  2063     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2064         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2065                                INDEXED BY CF-MORT-NDX.
  2066             20  CF-MORT-TABLE              PIC X(5).
  2067             20  CF-MORT-TABLE-TYPE         PIC X.
  2068                 88  CF-MORT-JOINT              VALUE 'J'.
  2069                 88  CF-MORT-SINGLE             VALUE 'S'.
  2070                 88  CF-MORT-COMBINED           VALUE 'C'.
  2071                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2072                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2073             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2074             20  CF-MORT-AGE-METHOD         PIC XX.
  2075                 88  CF-AGE-LAST                VALUE 'AL'.
  2076                 88  CF-AGE-NEAR                VALUE 'AN'.
  2077             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2078             20  CF-MORT-ADJUSTMENT-DIRECTION
  2079                                            PIC X.
  2080                 88  CF-MINUS                   VALUE '-'.
  2081                 88  CF-PLUS                    VALUE '+'.
  2082             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2083             20  CF-MORT-JOINT-CODE         PIC X.
  2084                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2085             20  CF-MORT-PC-Q               PIC X.
  2086                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2087             20  CF-MORT-TABLE-CODE         PIC X(4).
  2088             20  CF-MORT-COMMENTS           PIC X(15).
  2089             20  FILLER                     PIC X(14).
  2090
  2091         16  FILLER                         PIC X(251).
  2092
  2093
  2094****************************************************************
  2095*             BUSSINESS TYPE MASTER RECORD                     *
  2096****************************************************************
  2097
  2098     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2099* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2100* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2101* AND RECORD 05 IS TYPES 81-99
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  38
* SOCK03.cbl
  2102         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2103             20  CF-BUSINESS-TITLE          PIC  X(19).
  2104             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2105                                            PIC S9V9(4) COMP-3.
  2106             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2107             20  FILLER                     PIC  X.
  2108         16  FILLER                         PIC  X(248).
  2109
  2110
  2111****************************************************************
  2112*             TERMINAL MASTER RECORD                           *
  2113****************************************************************
  2114
  2115     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2116
  2117         16  CF-COMPANY-TERMINALS.
  2118             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2119                                  PIC X(4).
  2120         16  FILLER               PIC X(248).
  2121
  2122
  2123****************************************************************
  2124*             LIFE EDIT MASTER RECORD                          *
  2125****************************************************************
  2126
  2127     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2128         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2129             20  CF-LIFE-CODE-IN            PIC XX.
  2130             20  CF-LIFE-CODE-OUT           PIC XX.
  2131         16  FILLER                         PIC X(248).
  2132
  2133
  2134****************************************************************
  2135*             AH EDIT MASTER RECORD                            *
  2136****************************************************************
  2137
  2138     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2139         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2140             20  CF-AH-CODE-IN              PIC XXX.
  2141             20  CF-AH-CODE-OUT             PIC XX.
  2142         16  FILLER                         PIC X(248).
  2143
  2144
  2145****************************************************************
  2146*             CREDIBILITY TABLES                               *
  2147****************************************************************
  2148
  2149     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2150         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2151                             INDEXED BY CF-CRDB-NDX.
  2152             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2153             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2154             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2155         16  FILLER                         PIC  X(332).
  2156
  2157
  2158****************************************************************
  2159*             REPORT CUSTOMIZATION RECORD                      *
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  39
* SOCK03.cbl
  2160****************************************************************
  2161
  2162     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2163         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2164             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2165             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2166             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2167**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2168****       A T-TRANSFER.                                   ****
  2169             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2170
  2171         16  FILLER                         PIC XX.
  2172
  2173         16  CF-CARRIER-CNTL-OPT.
  2174             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2175                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2176                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2177             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2178                                            PIC X.
  2179         16  CF-GROUP-CNTL-OPT.
  2180             20  CF-GROUP-OPT-SEQ           PIC 9.
  2181                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2182                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2183             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2184                                            PIC X(6).
  2185         16  CF-STATE-CNTL-OPT.
  2186             20  CF-STATE-OPT-SEQ           PIC 9.
  2187                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2188                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2189             20  CF-STATE-SELECT OCCURS 3 TIMES
  2190                                            PIC XX.
  2191         16  CF-ACCOUNT-CNTL-OPT.
  2192             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2193                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2194                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2195             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2196                                            PIC X(10).
  2197         16  CF-BUS-TYP-CNTL-OPT.
  2198             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2199                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2200                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2201             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2202                                            PIC XX.
  2203         16  CF-LF-TYP-CNTL-OPT.
  2204             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2205                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2206                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2207             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2208                                            PIC XX.
  2209         16  CF-AH-TYP-CNTL-OPT.
  2210             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2211                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2212                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2213             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2214                                            PIC XX.
  2215         16  CF-REPTCD1-CNTL-OPT.
  2216             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2217                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  40
* SOCK03.cbl
  2218                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2219             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2220                                            PIC X(10).
  2221         16  CF-REPTCD2-CNTL-OPT.
  2222             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2223                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2224                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2225             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2226                                            PIC X(10).
  2227         16  CF-USER1-CNTL-OPT.
  2228             20  CF-USER1-OPT-SEQ           PIC 9.
  2229                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2230                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2231             20  CF-USER1-SELECT OCCURS 3 TIMES
  2232                                            PIC X(10).
  2233         16  CF-USER2-CNTL-OPT.
  2234             20  CF-USER2-OPT-SEQ           PIC 9.
  2235                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2236                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2237             20  CF-USER2-SELECT OCCURS 3 TIMES
  2238                                            PIC X(10).
  2239         16  CF-USER3-CNTL-OPT.
  2240             20  CF-USER3-OPT-SEQ           PIC 9.
  2241                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2242                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2243             20  CF-USER3-SELECT OCCURS 3 TIMES
  2244                                            PIC X(10).
  2245         16  CF-USER4-CNTL-OPT.
  2246             20  CF-USER4-OPT-SEQ           PIC 9.
  2247                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2248                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2249             20  CF-USER4-SELECT OCCURS 3 TIMES
  2250                                            PIC X(10).
  2251         16  CF-USER5-CNTL-OPT.
  2252             20  CF-USER5-OPT-SEQ           PIC 9.
  2253                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2254                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2255             20  CF-USER5-SELECT OCCURS 3 TIMES
  2256                                            PIC X(10).
  2257         16  CF-REINS-CNTL-OPT.
  2258             20  CF-REINS-OPT-SEQ           PIC 9.
  2259                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2260                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2261             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2262                 24  CF-REINS-PRIME         PIC XXX.
  2263                 24  CF-REINS-SUB           PIC XXX.
  2264
  2265         16  CF-AGENT-CNTL-OPT.
  2266             20  CF-AGENT-OPT-SEQ           PIC 9.
  2267                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2268                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2269             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2270                                            PIC X(10).
  2271
  2272         16  FILLER                         PIC X(43).
  2273
  2274         16  CF-LOSS-RATIO-SELECT.
  2275             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  41
* SOCK03.cbl
  2276             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2277         16  CF-ENTRY-DATE-SELECT.
  2278             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2279             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2280         16  CF-EFFECTIVE-DATE-SELECT.
  2281             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2282             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2283
  2284         16  CF-EXCEPTION-LIST-IND          PIC X.
  2285             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2286
  2287         16  FILLER                         PIC X(318).
  2288
  2289****************************************************************
  2290*                  EXCEPTION REPORTING RECORD                  *
  2291****************************************************************
  2292
  2293     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2294         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2295             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2296
  2297         16  CF-COMBINED-LIFE-AH-OPT.
  2298             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2299             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2300             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2301             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2302
  2303         16  CF-LIFE-OPT.
  2304             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2305             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2306             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2307             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2308             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2309             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2310             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2311             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2312             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2313             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2314
  2315         16  CF-AH-OPT.
  2316             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2317             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2318             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2319             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2320             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2321             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2322             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2323             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2324             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2325             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2326
  2327         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2328             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2329             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2330             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2331
  2332         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2333
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  42
* SOCK03.cbl
  2334         16  FILLER                         PIC X(673).
  2335
  2336
  2337****************************************************************
  2338*             MORTGAGE SYSTEM PLAN RECORD                      *
  2339****************************************************************
  2340
  2341     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2342         16  CF-PLAN-TYPE                   PIC X.
  2343             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2344             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2345             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2346         16  CF-PLAN-ABBREV                 PIC XXX.
  2347         16  CF-PLAN-DESCRIPT               PIC X(10).
  2348         16  CF-PLAN-NOTES                  PIC X(20).
  2349         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2350         16  CF-PLAN-UNDERWRITING.
  2351             20  CF-PLAN-TERM-DATA.
  2352                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2353                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2354             20  CF-PLAN-AGE-DATA.
  2355                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2356                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2357                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2358             20  CF-PLAN-BENEFIT-DATA.
  2359                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2360                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2361                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2362                                            PIC S9(7)V99  COMP-3.
  2363         16  CF-PLAN-POLICY-FORMS.
  2364             20  CF-POLICY-FORM             PIC X(12).
  2365             20  CF-MASTER-APPLICATION      PIC X(12).
  2366             20  CF-MASTER-POLICY           PIC X(12).
  2367         16  CF-PLAN-RATING.
  2368             20  CF-RATE-CODE               PIC X(5).
  2369             20  CF-SEX-RATING              PIC X.
  2370                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2371                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2372             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2373             20  CF-SUB-STD-TYPE            PIC X.
  2374                 88  CF-PCT-OF-PREM            VALUE '1'.
  2375                 88  CF-PCT-OF-BENE            VALUE '2'.
  2376         16  CF-PLAN-PREM-TOLERANCES.
  2377             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2378             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2379         16  CF-PLAN-PYMT-TOLERANCES.
  2380             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2381             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2382         16  CF-PLAN-MISC-DATA.
  2383             20  FILLER                     PIC X.
  2384             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2385             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2386         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2387         16  CF-PLAN-IND-GRP                PIC X.
  2388             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2389                                                     '1'.
  2390             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2391                                                     '2'.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  43
* SOCK03.cbl
  2392         16  CF-MIB-SEARCH-SW               PIC X.
  2393             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2394             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2395             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2396             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2397         16  CF-ALPHA-SEARCH-SW             PIC X.
  2398             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2399             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2400             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2401             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2402             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2403             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2404             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2405             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2406             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2407             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2408                                                     'A' 'B' 'C'
  2409                                                     'X' 'Y' 'Z'.
  2410         16  CF-EFF-DT-RULE-SW              PIC X.
  2411             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2412             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2413             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2414             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2415             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2416         16  FILLER                         PIC X(4).
  2417         16  CF-HEALTH-QUESTIONS            PIC X.
  2418             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2419         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2420         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2421         16  CF-PLAN-SNGL-JNT               PIC X.
  2422             88  CF-COMBINED-PLAN              VALUE 'C'.
  2423             88  CF-JNT-PLAN                   VALUE 'J'.
  2424             88  CF-SNGL-PLAN                  VALUE 'S'.
  2425         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2426         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2427         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2428         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2429         16  CF-RERATE-CNTL                 PIC  X.
  2430             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2431             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2432             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2433             88  CF-AUTO-RECALC                 VALUE '4'.
  2434         16  CF-BENEFIT-TYPE                PIC  X.
  2435             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2436             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2437         16  CF-POLICY-FEE                  PIC S999V99
  2438                                                    COMP-3.
  2439         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2440         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2441         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2442         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2443         16  FILLER                         PIC  X(32).
  2444         16  CF-TERMINATION-FORM            PIC  X(04).
  2445         16  FILLER                         PIC  X(08).
  2446         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2447                                                       COMP-3.
  2448         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2449         16  CF-ISSUE-LETTER                PIC  X(4).
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  44
* SOCK03.cbl
  2450         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2451         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2452             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2453             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2454         16  CF-MP-REFUND-CALC              PIC X.
  2455             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2456             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2457             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2458             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2459             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2460             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2461             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2462             88  CF-MP-REFD-MEAN                VALUE '8'.
  2463         16  CF-ALT-RATE-CODE               PIC  X(5).
  2464
  2465
  2466         16  FILLER                         PIC X(498).
  2467****************************************************************
  2468*             MORTGAGE COMPANY MASTER RECORD                   *
  2469****************************************************************
  2470
  2471     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2472         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2473         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2474             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2475             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2476             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2477             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2478             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2479
  2480         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2481         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2482         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2483         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2484         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2485
  2486         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2487             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2488         16  CF-MP-RECON-USE-IND            PIC X(1).
  2489             88  CF-MP-USE-RECON             VALUE 'Y'.
  2490         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2491             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2492         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2493             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2494             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2495         16  FILLER                         PIC X(1).
  2496         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2497             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2498         16  CF-MORTG-MIB-VERSION           PIC X.
  2499             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2500             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2501             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2502         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2503             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2504                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2505             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2506                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2507             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  45
* SOCK03.cbl
  2508                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2509             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2510                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2511             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2512                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2513             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2514                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2515         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2516         16  FILLER                         PIC X(7).
  2517         16  CF-MORTG-DESTINATION-SYMBOL.
  2518             20  CF-MORTG-MIB-COMM          PIC X(5).
  2519             20  CF-MORTG-MIB-TERM          PIC X(5).
  2520         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2521             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2522         16  FILLER                         PIC X(03).
  2523         16  CF-MP-CHECK-NO-CONTROL.
  2524             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2525                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2526                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2527                                                ' ' LOW-VALUES.
  2528                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2529                                               VALUE '3'.
  2530         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2531         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2532         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2533             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2534                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2535             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2536                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2537             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2538                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2539             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2540                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2541             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2542                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2543             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2544                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2545         16  CF-MORTG-BILLING-AREA.
  2546             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2547                                            PIC X.
  2548         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2549         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2550         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2551         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2552             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2553             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2554         16  FILLER                         PIC X.
  2555         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2556             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2557             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2558         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2559         16  FILLER                         PIC X(8).
  2560         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2561         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2562         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2563         16  CF-ACH-COMPANY-ID.
  2564             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2565                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  46
* SOCK03.cbl
  2566                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2567                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2568             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2569         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2570             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2571         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2572             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2573             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2574         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2575         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2576         16  FILLER                         PIC X(536).
  2577
  2578****************************************************************
  2579*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2580****************************************************************
  2581
  2582     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2583         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2584             20  CF-FEMALE-HEIGHT.
  2585                 24  CF-FEMALE-FT           PIC 99.
  2586                 24  CF-FEMALE-IN           PIC 99.
  2587             20  CF-FEMALE-MIN-WT           PIC 999.
  2588             20  CF-FEMALE-MAX-WT           PIC 999.
  2589         16  FILLER                         PIC X(428).
  2590
  2591     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2592         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2593             20  CF-MALE-HEIGHT.
  2594                 24  CF-MALE-FT             PIC 99.
  2595                 24  CF-MALE-IN             PIC 99.
  2596             20  CF-MALE-MIN-WT             PIC 999.
  2597             20  CF-MALE-MAX-WT             PIC 999.
  2598         16  FILLER                         PIC X(428).
  2599******************************************************************
  2600*             AUTOMATIC ACTIVITY RECORD                          *
  2601******************************************************************
  2602     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2603         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2604             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2605             20  CF-SYS-LETTER-ID           PIC X(04).
  2606             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2607             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2608             20  CF-SYS-RESET-SW            PIC X(01).
  2609             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2610             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2611
  2612         16  FILLER                         PIC X(50).
  2613
  2614         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2615             20  CF-USER-ACTIVE-SW          PIC X(01).
  2616             20  CF-USER-LETTER-ID          PIC X(04).
  2617             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2618             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2619             20  CF-USER-RESET-SW           PIC X(01).
  2620             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2621             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2622             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2623
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  47
* SOCK03.cbl
  2624         16  FILLER                         PIC X(246).
  2625*                                 COPY ERCACCT.
  2626******************************************************************
  2627*                                                                *
  2628*                                                                *
  2629*                            ERCACCT                             *
  2630*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2631*                            VMOD=2.031                          *
  2632*                                                                *
  2633*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2634*                                                                *
  2635*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2636*   VSAM ACCOUNT MASTER FILES.                                   *
  2637*                                                                *
  2638*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2639*                                                                *
  2640*   FILE TYPE = VSAM,KSDS                                        *
  2641*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2642*                                                                *
  2643*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2644*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2645*                                                                *
  2646*   LOG = NO                                                     *
  2647*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2648*                                                                *
  2649*                                                                *
  2650******************************************************************
  2651*                   C H A N G E   L O G
  2652*
  2653* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2654*-----------------------------------------------------------------
  2655*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2656* EFFECTIVE    NUMBER
  2657*-----------------------------------------------------------------
  2658* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2659* 092705    2005050300006  PEMA  ADD SPP LEASES
  2660* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2661* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2662* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2663* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2664* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2665* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2666******************************************************************
  2667
  2668 01  ACCOUNT-MASTER.
  2669     12  AM-RECORD-ID                      PIC XX.
  2670         88  VALID-AM-ID                      VALUE 'AM'.
  2671
  2672     12  AM-CONTROL-PRIMARY.
  2673         16  AM-COMPANY-CD                 PIC X.
  2674         16  AM-MSTR-CNTRL.
  2675             20  AM-CONTROL-A.
  2676                 24  AM-CARRIER            PIC X.
  2677                 24  AM-GROUPING.
  2678                     28 AM-GROUPING-PREFIX PIC XXX.
  2679                     28 AM-GROUPING-PRIME  PIC XXX.
  2680                 24  AM-STATE              PIC XX.
  2681                 24  AM-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  48
* SOCK03.cbl
  2682                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2683                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2684             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2685                                           PIC X(19).
  2686             20  AM-CNTRL-B.
  2687                 24  AM-EXPIRATION-DT      PIC XX.
  2688                 24  FILLER                PIC X(4).
  2689             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2690                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2691
  2692     12  AM-CONTROL-BY-VAR-GRP.
  2693         16  AM-COMPANY-CD-A1              PIC X.
  2694         16  AM-VG-CARRIER                 PIC X.
  2695         16  AM-VG-GROUPING                PIC X(6).
  2696         16  AM-VG-STATE                   PIC XX.
  2697         16  AM-VG-ACCOUNT                 PIC X(10).
  2698         16  AM-VG-DATE.
  2699             20  AM-VG-EXPIRATION-DT       PIC XX.
  2700             20  FILLER                    PIC X(4).
  2701         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2702                                           PIC 9(11)      COMP-3.
  2703     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2704         16  FILLER                        PIC X(10).
  2705         16  AM-VG-KEY3.
  2706             20  AM-VG3-ACCOUNT            PIC X(10).
  2707             20  AM-VG3-EXP-DT             PIC XX.
  2708         16  FILLER                        PIC X(4).
  2709     12  AM-MAINT-INFORMATION.
  2710         16  AM-LAST-MAINT-DT              PIC XX.
  2711         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2712         16  AM-LAST-MAINT-USER            PIC X(4).
  2713         16  FILLER                        PIC XX.
  2714
  2715     12  AM-EFFECTIVE-DT                   PIC XX.
  2716     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2717
  2718     12  AM-PREV-DATES  COMP-3.
  2719         16  AM-PREV-EXP-DT                PIC 9(11).
  2720         16  AM-PREV-EFF-DT                PIC 9(11).
  2721
  2722     12  AM-REPORT-CODE-1                  PIC X(10).
  2723     12  AM-REPORT-CODE-2                  PIC X(10).
  2724
  2725     12  AM-CITY-CODE                      PIC X(4).
  2726     12  AM-COUNTY-PARISH                  PIC X(6).
  2727
  2728     12  AM-NAME                           PIC X(30).
  2729     12  AM-PERSON                         PIC X(30).
  2730     12  AM-ADDRS                          PIC X(30).
  2731     12  AM-CITY.
  2732         16  AM-ADDR-CITY                  PIC X(28).
  2733         16  AM-ADDR-STATE                 PIC XX.
  2734     12  AM-ZIP.
  2735         16  AM-ZIP-PRIME.
  2736             20  AM-ZIP-PRI-1ST            PIC X.
  2737                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2738             20  FILLER                    PIC X(4).
  2739         16  AM-ZIP-PLUS4                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  49
* SOCK03.cbl
  2740     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2741         16  AM-CAN-POSTAL-1               PIC XXX.
  2742         16  AM-CAN-POSTAL-2               PIC XXX.
  2743         16  FILLER                        PIC XXX.
  2744     12  AM-TEL-NO.
  2745         16  AM-AREA-CODE                  PIC 999.
  2746         16  AM-TEL-PRE                    PIC 999.
  2747         16  AM-TEL-NBR                    PIC 9(4).
  2748     12  AM-TEL-LOC                        PIC X.
  2749         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2750         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2751
  2752     12  AM-COMM-STRUCTURE.
  2753         16  AM-DEFN-1.
  2754             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2755                 24  AM-AGT.
  2756                     28  AM-AGT-PREFIX     PIC X(4).
  2757                     28  AM-AGT-PRIME      PIC X(6).
  2758                 24  AM-COM-TYP            PIC X.
  2759                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2760                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2761                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2762                 24  AM-RECALC-LV-INDIC    PIC X.
  2763                 24  AM-RETRO-LV-INDIC     PIC X.
  2764                 24  AM-GL-CODES           PIC X.
  2765                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2766                 24  FILLER                PIC X(01).
  2767         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2768             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2769                 24  FILLER                PIC X(11).
  2770                 24  AM-L-COMA             PIC XXX.
  2771                 24  AM-J-COMA             PIC XXX.
  2772                 24  AM-A-COMA             PIC XXX.
  2773                 24  FILLER                PIC X(6).
  2774
  2775     12  AM-COMM-CHANGE-STATUS             PIC X.
  2776         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2777
  2778     12  AM-CSR-CODE                       PIC X(4).
  2779
  2780     12  AM-BILLING-STATUS                 PIC X.
  2781         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2782         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2783     12  AM-AUTO-REFUND-SW                 PIC X.
  2784         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2785         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2786     12  AM-GPCD                           PIC 99.
  2787     12  AM-IG                             PIC X.
  2788         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2789         88  AM-HAS-GROUP                     VALUE '2'.
  2790     12  AM-STATUS                         PIC X.
  2791         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2792         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2793         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2794         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2795         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2796         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2797         88  AM-ACCOUNT-DROPPED               VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  50
* SOCK03.cbl
  2798         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  2799         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2800         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2801     12  AM-REMIT-TO                       PIC 99.
  2802     12  AM-ID-NO                          PIC X(11).
  2803
  2804     12  AM-CAL-TABLE                      PIC XX.
  2805     12  AM-LF-DEVIATION                   PIC XXX.
  2806     12  AM-AH-DEVIATION                   PIC XXX.
  2807     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2808     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2809     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2810     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2811     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2812     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2813
  2814     12  AM-USER-FIELDS.
  2815         16  AM-FLD-1                      PIC XX.
  2816         16  AM-FLD-2                      PIC XX.
  2817         16  AM-FLD-3                      PIC XX.
  2818         16  AM-FLD-4                      PIC XX.
  2819         16  AM-FLD-5                      PIC XX.
  2820
  2821     12  AM-1ST-PROD-DATE.
  2822         16  AM-1ST-PROD-YR                PIC XX.
  2823         16  AM-1ST-PROD-MO                PIC XX.
  2824         16  AM-1ST-PROD-DA                PIC XX.
  2825     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2826     12  AM-CERTS-PURGED-DATE.
  2827         16  AM-PUR-YR                     PIC XX.
  2828         16  AM-PUR-MO                     PIC XX.
  2829         16  AM-PUR-DA                     PIC XX.
  2830     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2831     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2832     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2833     12  AM-INACTIVE-DATE.
  2834         16  AM-INA-MO                     PIC 99.
  2835         16  AM-INA-DA                     PIC 99.
  2836         16  AM-INA-YR                     PIC 99.
  2837     12  AM-AR-HI-CERT-DATE                PIC XX.
  2838
  2839     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2840     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2841
  2842     12  AM-OB-PAYMENT-MODE                PIC X.
  2843         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2844         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2845         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2846         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2847
  2848     12  AM-AH-ONLY-INDICATOR              PIC X.
  2849         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2850         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2851
  2852     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2853
  2854     12  AM-OVER-SHORT.
  2855         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  51
* SOCK03.cbl
  2856         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2857
  2858     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2859     12  AM-DCC-CLP-STATE                  PIC XX.
  2860
  2861     12  AM-RECALC-COMM                    PIC X.
  2862     12  AM-RECALC-REIN                    PIC X.
  2863
  2864     12  AM-REI-TABLE                      PIC XXX.
  2865     12  AM-REI-ET-LF                      PIC X.
  2866     12  AM-REI-ET-AH                      PIC X.
  2867     12  AM-REI-PE-LF                      PIC X.
  2868     12  AM-REI-PE-AH                      PIC X.
  2869     12  AM-REI-PRT-ST                     PIC X.
  2870     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2871     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2872     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2873     12  AM-REI-GROUP-A                    PIC X(6).
  2874     12  AM-REI-MORT                       PIC X(4).
  2875     12  AM-REI-PRT-OW                     PIC X.
  2876     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2877     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2878     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2879     12  AM-REI-GROUP-B                    PIC X(6).
  2880
  2881     12  AM-TRUST-TYPE                     PIC X(2).
  2882
  2883     12  AM-EMPLOYER-STMT-USED             PIC X.
  2884     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2885
  2886     12  AM-STD-AH-TYPE                    PIC XX.
  2887     12  AM-EARN-METHODS.
  2888         16  AM-EARN-METHOD-R              PIC X.
  2889             88 AM-REF-RL-R78                 VALUE 'R'.
  2890             88 AM-REF-RL-PR                  VALUE 'P'.
  2891             88 AM-REF-RL-MEAN                VALUE 'M'.
  2892             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2893         16  AM-EARN-METHOD-L              PIC X.
  2894             88 AM-REF-LL-R78                 VALUE 'R'.
  2895             88 AM-REF-LL-PR                  VALUE 'P'.
  2896             88 AM-REF-LL-MEAN                VALUE 'M'.
  2897             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2898         16  AM-EARN-METHOD-A              PIC X.
  2899             88 AM-REF-AH-R78                 VALUE 'R'.
  2900             88 AM-REF-AH-PR                  VALUE 'P'.
  2901             88 AM-REF-AH-MEAN                VALUE 'M'.
  2902             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2903             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2904             88 AM-REF-AH-NET                 VALUE 'N'.
  2905
  2906     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2907     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2908     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2909
  2910     12  AM-RET-Y-N                        PIC X.
  2911     12  AM-RET-P-E                        PIC X.
  2912     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2913     12  AM-AH-RET                         PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  52
* SOCK03.cbl
  2914     12  AM-RET-GRP                        PIC X(6).
  2915     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2916         16  AM-POOL-PRIME                 PIC XXX.
  2917         16  AM-POOL-SUB                   PIC XXX.
  2918     12  AM-RETRO-EARNINGS.
  2919         16  AM-RET-EARN-R                 PIC X.
  2920         16  AM-RET-EARN-L                 PIC X.
  2921         16  AM-RET-EARN-A                 PIC X.
  2922     12  AM-RET-ST-TAX-USE                 PIC X.
  2923         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2924         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2925     12  AM-RETRO-BEG-EARNINGS.
  2926         16  AM-RET-BEG-EARN-R             PIC X.
  2927         16  AM-RET-BEG-EARN-L             PIC X.
  2928         16  AM-RET-BEG-EARN-A             PIC X.
  2929     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2930     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2931
  2932     12  AM-USER-SELECT-OPTIONS.
  2933         16  AM-USER-SELECT-1              PIC X(10).
  2934         16  AM-USER-SELECT-2              PIC X(10).
  2935         16  AM-USER-SELECT-3              PIC X(10).
  2936         16  AM-USER-SELECT-4              PIC X(10).
  2937         16  AM-USER-SELECT-5              PIC X(10).
  2938
  2939     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2940
  2941     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2942
  2943     12  AM-RPT045A-SWITCH                 PIC X.
  2944         88  RPT045A-OFF                   VALUE 'N'.
  2945
  2946     12  AM-INSURANCE-LIMITS.
  2947         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2948         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2949
  2950     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2951         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2952
  2953     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2954         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2955         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2956
  2957     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2958
  2959     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2960     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2961     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2962     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2963     12  AM-DCC-UEF-STATE                  PIC XX.
  2964     12  FILLER                            PIC XXX.
  2965     12  AM-REPORT-CODE-3                  PIC X(10).
  2966*    12  FILLER                            PIC X(22).
  2967
  2968     12  AM-RESERVE-DATE.
  2969         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2970         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2971         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  53
* SOCK03.cbl
  2972
  2973     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2974     12  AM-NOTIFICATION-TYPES.
  2975         16  AM-NOTIF-OF-LETTERS           PIC X.
  2976         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2977         16  AM-NOTIF-OF-REPORTS           PIC X.
  2978         16  AM-NOTIF-OF-STATUS            PIC X.
  2979
  2980     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2981         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2982         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2983         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2984         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2985
  2986     12  AM-BENEFIT-CONTROLS.
  2987         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2988             20  AM-BENEFIT-CODE           PIC XX.
  2989             20  AM-BENEFIT-TYPE           PIC X.
  2990             20  AM-BENEFIT-REVISION       PIC XXX.
  2991             20  AM-BENEFIT-REM-TERM       PIC X.
  2992             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2993             20  FILLER                    PIC XX.
  2994         16  FILLER                        PIC X(80).
  2995
  2996     12  AM-TRANSFER-DATA.
  2997         16  AM-TRANSFERRED-FROM.
  2998             20  AM-TRNFROM-CARRIER        PIC X.
  2999             20  AM-TRNFROM-GROUPING.
  3000                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  3001                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  3002             20  AM-TRNFROM-STATE          PIC XX.
  3003             20  AM-TRNFROM-ACCOUNT.
  3004                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  3005                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  3006             20  AM-TRNFROM-DTE            PIC XX.
  3007         16  AM-TRANSFERRED-TO.
  3008             20  AM-TRNTO-CARRIER          PIC X.
  3009             20  AM-TRNTO-GROUPING.
  3010                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  3011                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  3012             20  AM-TRNTO-STATE            PIC XX.
  3013             20  AM-TRNTO-ACCOUNT.
  3014                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  3015                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  3016             20  AM-TRNTO-DTE              PIC XX.
  3017         16  FILLER                        PIC X(10).
  3018
  3019     12  AM-SAVED-REMIT-TO                 PIC 99.
  3020
  3021     12  AM-COMM-STRUCTURE-SAVED.
  3022         16  AM-DEFN-1-SAVED.
  3023             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  3024                 24  AM-AGT-SV             PIC X(10).
  3025                 24  AM-COM-TYP-SV         PIC X.
  3026                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  3027                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  3028                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  3029                 24  AM-RECALC-LV-INDIC-SV PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  54
* SOCK03.cbl
  3030                 24  FILLER                PIC X.
  3031                 24  AM-GL-CODES-SV        PIC X.
  3032                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  3033                 24  FILLER                PIC X.
  3034         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  3035             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  3036                 24  FILLER                PIC X(11).
  3037                 24  AM-L-COMA-SV          PIC XXX.
  3038                 24  AM-J-COMA-SV          PIC XXX.
  3039                 24  AM-A-COMA-SV          PIC XXX.
  3040                 24  FILLER                PIC X(6).
  3041
  3042     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  3043         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  3044            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  3045            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  3046            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  3047
  3048     12  AM-ORIG-DEALER-NO                 PIC X(10).
  3049     12  FILLER                            PIC X(120).
  3050
  3051     12  AM-ACCOUNT-EXECUTIVE-DATA.
  3052         16  AM-CONTROL-NAME               PIC X(30).
  3053         16  AM-EXECUTIVE-ONE.
  3054             20  AM-EXEC1-NAME             PIC X(15).
  3055             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  3056                                                          COMP-3.
  3057             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  3058                                                          COMP-3.
  3059         16  AM-EXECUTIVE-TWO.
  3060             20  AM-EXEC2-NAME             PIC X(15).
  3061             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3062                                                          COMP-3.
  3063             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3064                                                          COMP-3.
  3065
  3066     12  AM-RETRO-ADDITIONAL-DATA.
  3067         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3068         16  AM-RETRO-PREM-P-E             PIC X.
  3069         16  AM-RETRO-CLMS-P-I             PIC X.
  3070         16  AM-RETRO-RET-BRACKET-LF.
  3071             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3072                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3073                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3074             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3075                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  3076                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3077             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3078                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3079                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3080         16  AM-RETRO-RET-BRACKET-AH.
  3081             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3082                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3083                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3084                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3085             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3086                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3087                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  55
* SOCK03.cbl
  3088             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3089                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3090                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3091
  3092     12  AM-COMMENTS.
  3093         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3094
  3095     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3096         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3097         16  AM-FLI-BILLING-CODE           PIC X.
  3098         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3099         16  AM-FLI-UNITED-IDENT           PIC X.
  3100         16  AM-FLI-INTEREST-LOST-DATA.
  3101             20  AM-FLI-BANK-NO            PIC X(5).
  3102             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3103             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3104             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3105         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3106             20  AM-FLI-AGT                PIC X(9).
  3107             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3108             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3109         16  FILLER                        PIC X(102).
  3110
  3111     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3112         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3113             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3114             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3115             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3116             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3117             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3118         16  FILLER                          PIC X(10).
  3119******************************************************************
  3120*                                 COPY ERCMAIL.
  3121******************************************************************
  3122*                                                                *
  3123*                                                                *
  3124*                            ERCMAIL                             *
  3125*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3126*                            VMOD=2.003                          *
  3127*                                                                *
  3128*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  3129*                                                                *
  3130*   FILE TYPE = VSAM,KSDS                                        *
  3131*   RECORD SIZE = 374   RECFORM = FIX                            *
  3132*                                                                *
  3133*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  3134*   ALTERNATE PATH    = NOT USED                                 *
  3135*                                                                *
  3136*   LOG = YES                                                    *
  3137*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3138******************************************************************
  3139*                   C H A N G E   L O G
  3140*
  3141* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3142*-----------------------------------------------------------------
  3143*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3144* EFFECTIVE    NUMBER
  3145*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  56
* SOCK03.cbl
  3146* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3147* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3148* 111108                   PEMA  ADD CRED BENE ADDR2
  3149******************************************************************
  3150
  3151 01  MAILING-DATA.
  3152     12  MA-RECORD-ID                      PIC XX.
  3153         88  VALID-MA-ID                       VALUE 'MA'.
  3154
  3155     12  MA-CONTROL-PRIMARY.
  3156         16  MA-COMPANY-CD                 PIC X.
  3157         16  MA-CARRIER                    PIC X.
  3158         16  MA-GROUPING.
  3159             20  MA-GROUPING-PREFIX        PIC XXX.
  3160             20  MA-GROUPING-PRIME         PIC XXX.
  3161         16  MA-STATE                      PIC XX.
  3162         16  MA-ACCOUNT.
  3163             20  MA-ACCOUNT-PREFIX         PIC X(4).
  3164             20  MA-ACCOUNT-PRIME          PIC X(6).
  3165         16  MA-CERT-EFF-DT                PIC XX.
  3166         16  MA-CERT-NO.
  3167             20  MA-CERT-PRIME             PIC X(10).
  3168             20  MA-CERT-SFX               PIC X.
  3169
  3170     12  FILLER                            PIC XX.
  3171
  3172     12  MA-ACCESS-CONTROL.
  3173         16  MA-SOURCE-SYSTEM              PIC XX.
  3174             88  MA-FROM-CREDIT                VALUE 'CR'.
  3175             88  MA-FROM-VSI                   VALUE 'VS'.
  3176             88  MA-FROM-WARRANTY              VALUE 'WA'.
  3177             88  MA-FROM-OTHER                 VALUE 'OT'.
  3178         16  MA-RECORD-ADD-DT              PIC XX.
  3179         16  MA-RECORD-ADDED-BY            PIC XXXX.
  3180         16  MA-LAST-MAINT-DT              PIC XX.
  3181         16  MA-LAST-MAINT-BY              PIC XXXX.
  3182         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3183
  3184     12  MA-PROFILE-INFO.
  3185         16  MA-QUALIFY-CODE-1             PIC XX.
  3186         16  MA-QUALIFY-CODE-2             PIC XX.
  3187         16  MA-QUALIFY-CODE-3             PIC XX.
  3188         16  MA-QUALIFY-CODE-4             PIC XX.
  3189         16  MA-QUALIFY-CODE-5             PIC XX.
  3190
  3191         16  MA-INSURED-LAST-NAME          PIC X(15).
  3192         16  MA-INSURED-FIRST-NAME         PIC X(10).
  3193         16  MA-INSURED-MIDDLE-INIT        PIC X.
  3194         16  MA-INSURED-ISSUE-AGE          PIC 99.
  3195         16  MA-INSURED-BIRTH-DT           PIC XX.
  3196         16  MA-INSURED-SEX                PIC X.
  3197             88  MA-SEX-MALE                   VALUE 'M'.
  3198             88  MA-SEX-FEMALE                 VALUE 'F'.
  3199         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  3200
  3201         16  MA-ADDRESS-CORRECTED          PIC X.
  3202         16  MA-JOINT-BIRTH-DT             PIC XX.
  3203*        16  FILLER                        PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  57
* SOCK03.cbl
  3204
  3205         16  MA-ADDRESS-LINE-1             PIC X(30).
  3206         16  MA-ADDRESS-LINE-2             PIC X(30).
  3207         16  MA-CITY-STATE.
  3208             20  MA-CITY                   PIC X(28).
  3209             20  MA-ADDR-STATE             PIC XX.
  3210         16  MA-ZIP.
  3211             20  MA-ZIP-CODE.
  3212                 24  MA-ZIP-CODE-1ST       PIC X(1).
  3213                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3214                 24  FILLER                PIC X(4).
  3215             20  MA-ZIP-PLUS4              PIC X(4).
  3216         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  3217             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  3218             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  3219             20  FILLER                    PIC X(3).
  3220
  3221         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  3222
  3223         16  FILLER                        PIC XXX.
  3224*        16  FILLER                        PIC X(10).
  3225
  3226     12  MA-CRED-BENE-INFO.
  3227         16  MA-CRED-BENE-NAME                 PIC X(25).
  3228         16  MA-CRED-BENE-ADDR                 PIC X(30).
  3229         16  MA-CRED-BENE-ADDR2                PIC X(30).
  3230         16  MA-CRED-BENE-CTYST.
  3231             20  MA-CRED-BENE-CITY             PIC X(28).
  3232             20  MA-CRED-BENE-STATE            PIC XX.
  3233         16  MA-CRED-BENE-ZIP.
  3234             20  MA-CB-ZIP-CODE.
  3235                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  3236                     88  MA-CB-CANADIAN-POST-CODE
  3237                                           VALUE 'A' THRU 'Z'.
  3238                 24  FILLER                    PIC X(4).
  3239             20  MA-CB-ZIP-PLUS4               PIC X(4).
  3240         16  MA-CB-CANADIAN-POSTAL-CODE
  3241                            REDEFINES MA-CRED-BENE-ZIP.
  3242             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  3243             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  3244             20  FILLER                        PIC X(3).
  3245     12  MA-POST-CARD-MAIL-DATA.
  3246         16  MA-MAIL-DATA OCCURS 7.
  3247             20  MA-MAIL-TYPE              PIC X.
  3248                 88  MA-12MO-MAILING           VALUE '1'.
  3249                 88  MA-EXP-MAILING            VALUE '2'.
  3250             20  MA-MAIL-STATUS            PIC X.
  3251                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  3252                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  3253                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  3254             20  MA-MAIL-DATE              PIC XX.
  3255     12  FILLER                            PIC XX.
  3256     12  FILLER                            PIC XX.
  3257*    12  FILLER                            PIC X(30).
  3258******************************************************************
  3259*                                 COPY ELCCRTT.
  3260******************************************************************
  3261*                                                                *
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  58
* SOCK03.cbl
  3262*                            ELCCRTT.                            *
  3263*                                                                *
  3264*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3265*                                                                *
  3266*   FILE TYPE = VSAM,KSDS                                        *
  3267*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3268*                                                                *
  3269*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3270*                                                                *
  3271*   LOG = YES                                                    *
  3272*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3273******************************************************************
  3274*                   C H A N G E   L O G
  3275*
  3276* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3277*-----------------------------------------------------------------
  3278*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3279* EFFECTIVE    NUMBER
  3280*-----------------------------------------------------------------
  3281* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3282* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3283* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3284* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3285* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3286* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3287* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3288* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3289* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3290* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3291* 091318  CR2018073000001  PEMA  ADD Refund methods
  3292* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3293******************************************************************
  3294
  3295 01  CERTIFICATE-TRAILERS.
  3296     12  CS-RECORD-ID                      PIC XX.
  3297         88  VALID-CS-ID                      VALUE 'CS'.
  3298
  3299     12  CS-CONTROL-PRIMARY.
  3300         16  CS-COMPANY-CD                 PIC X.
  3301         16  CS-CARRIER                    PIC X.
  3302         16  CS-GROUPING                   PIC X(6).
  3303         16  CS-STATE                      PIC XX.
  3304         16  CS-ACCOUNT                    PIC X(10).
  3305         16  CS-CERT-EFF-DT                PIC XX.
  3306         16  CS-CERT-NO.
  3307             20  CS-CERT-PRIME             PIC X(10).
  3308             20  CS-CERT-SFX               PIC X.
  3309         16  CS-TRAILER-TYPE               PIC X.
  3310             88  COMM-TRLR           VALUE 'A'.
  3311             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3312             88  CERT-DATA-TRLR      VALUE 'C'.
  3313
  3314     12  CS-DATA-AREA                      PIC X(516).
  3315
  3316     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3317         16  CS-BANK-COMMISSION-AREA.
  3318             20  CS-BANK-COMMS       OCCURS 10.
  3319                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  59
* SOCK03.cbl
  3320                 24  CS-COM-TYP            PIC X.
  3321                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3322                 24  CS-RECALC-LV-INDIC    PIC X.
  3323                 24  FILLER                PIC X(10).
  3324         16  FILLER                        PIC X(256).
  3325
  3326     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3327****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3328         16  CS-MB-CLAIM-DATA OCCURS 24.
  3329             20  CS-CLAIM-NO               PIC X(7).
  3330             20  CS-CLAIM-TYPE             PIC X.
  3331                 88  CS-AH-CLM               VALUE 'A'.
  3332                 88  CS-IU-CLM               VALUE 'I'.
  3333                 88  CS-GP-CLM               VALUE 'G'.
  3334                 88  CS-LF-CLM               VALUE 'L'.
  3335                 88  CS-PR-CLM               VALUE 'P'.
  3336                 88  CS-FL-CLM               VALUE 'F'.
  3337                 88  CS-OT-CLM               VALUE 'O'.
  3338             20  CS-INSURED-TYPE           PIC X.
  3339                 88  CS-PRIM-INSURED          VALUE 'P'.
  3340                 88  CS-CO-BORROWER           VALUE 'C'.
  3341             20  CS-BENEFIT-PERIOD         PIC 99.
  3342             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3343             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3344             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3345         16  FILLER                        PIC X(12).
  3346     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3347         16  CS-VIN-NUMBER                 PIC X(17).
  3348         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3349         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3350         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3351         16  cs-agent-name.
  3352             20  cs-agent-fname            pic x(20).
  3353             20  cs-agent-mi               pic x.
  3354             20  cs-agent-lname            pic x(25).
  3355         16  cs-license-no                 pic x(15).
  3356         16  cs-npn-number                 pic x(10).
  3357         16  cs-agent-edit-status          pic x.
  3358             88  cs-ae-refer-to-manager      value 'M'.
  3359             88  cs-ae-cover-sheet           value 'C'.
  3360             88  cs-ae-sig-form              value 'S'.
  3361             88  cs-ae-verified              value 'V'.
  3362             88  cs-unidentified-signature   value 'U'.
  3363             88  cs-cert-returned            value 'R'.
  3364             88  cs-accept-no-commission     value 'N'.
  3365         16  cs-year                       pic 9999.
  3366         16  cs-make                       pic x(20).
  3367         16  cs-model                      pic x(20).
  3368         16  cs-future                     pic x(20).
  3369         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3370         16  cs-claim-verification-status  pic x.
  3371             88  cs-clm-ver-eligible         value 'A'.
  3372             88  cs-clm-ver-partial-elig     value 'B'.
  3373             88  cs-clm-ver-not-eligible     value 'C'.
  3374             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  3375             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3376             88  cs-clm-ver-ND-CERT          value 'F'.
  3377             88  cs-clm-ver-spec-other       value 'G'.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  60
* SOCK03.cbl
  3378             88  cs-clam-ver-pratial-corrected
  3379                                             value 'H'.
  3380             88  cs-clm-ver-no-matches       value 'I'.
  3381             88  cs-clm-ver-not-elig-corrected
  3382                                             value 'J'.
  3383             88  cs-clm-ver-needs-review     value 'R'.
  3384             88  cs-clm-ver-sent-to-claims   value 'W'.
  3385         16  CS-LF-REFUND-METHOD           PIC X.
  3386         16  CS-AH-REFUND-METHOD           PIC X.
  3387         16  FILLER                        PIC X(353). *> was 420
  3388*        16  FILLER                        PIC X(496).
  3389*                                 COPY ELCDATE.
  3390******************************************************************
  3391*                                                                *
  3392*                                                                *
  3393*                            ELCDATE.                            *
  3394*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3395*                            VMOD=2.003
  3396*                                                                *
  3397*                                                                *
  3398*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3399*                 LENGTH = 200                                   *
  3400******************************************************************
  3401
  3402 01  DATE-CONVERSION-DATA.
  3403     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3404     12  DC-OPTION-CODE                PIC X.
  3405         88  BIN-TO-GREG                VALUE ' '.
  3406         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3407         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3408         88  YMD-GREG-TO-BIN            VALUE '3'.
  3409         88  MDY-GREG-TO-BIN            VALUE '4'.
  3410         88  JULIAN-TO-BIN              VALUE '5'.
  3411         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3412         88  FIND-CENTURY               VALUE '7'.
  3413         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3414         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3415         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3416         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3417         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3418         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3419         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3420         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3421         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3422         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3423         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3424         88  BIN-3-TO-GREG              VALUE 'I'.
  3425         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3426         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3427         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3428         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3429         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3430         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3431         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3432         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3433         88  THREE-CHARACTER-BIN
  3434                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3435         88  GREGORIAN-TO-BIN
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  61
* SOCK03.cbl
  3436                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3437         88  BIN-TO-GREGORIAN
  3438                  VALUES ' ' '1' 'I' '8' 'G'.
  3439         88  JULIAN-TO-BINARY
  3440                  VALUES '5' 'C' 'E' 'F'.
  3441     12  DC-ERROR-CODE                 PIC X.
  3442         88  NO-CONVERSION-ERROR        VALUE ' '.
  3443         88  DATE-CONVERSION-ERROR
  3444                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3445         88  DATE-IS-ZERO               VALUE '1'.
  3446         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3447         88  DATE-IS-INVALID            VALUE '3'.
  3448         88  DATE1-GREATER-DATE2        VALUE '4'.
  3449         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3450         88  DATE-INVALID-OPTION        VALUE '9'.
  3451         88  INVALID-CENTURY            VALUE 'A'.
  3452         88  ONLY-CENTURY               VALUE 'B'.
  3453         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3454         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3455     12  DC-END-OF-MONTH               PIC X.
  3456         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3457     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3458         88  USE-NORMAL-PROCESS         VALUE ' '.
  3459         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3460         88  ADJUST-UP-100-YRS          VALUE '2'.
  3461     12  FILLER                        PIC X.
  3462     12  DC-CONVERSION-DATES.
  3463         16  DC-BIN-DATE-1             PIC XX.
  3464         16  DC-BIN-DATE-2             PIC XX.
  3465         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3466         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3467                       DC-GREG-DATE-1-EDIT.
  3468             20  DC-EDIT1-MONTH        PIC 99.
  3469             20  SLASH1-1              PIC X.
  3470             20  DC-EDIT1-DAY          PIC 99.
  3471             20  SLASH1-2              PIC X.
  3472             20  DC-EDIT1-YEAR         PIC 99.
  3473         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3474         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3475                     DC-GREG-DATE-2-EDIT.
  3476             20  DC-EDIT2-MONTH        PIC 99.
  3477             20  SLASH2-1              PIC X.
  3478             20  DC-EDIT2-DAY          PIC 99.
  3479             20  SLASH2-2              PIC X.
  3480             20  DC-EDIT2-YEAR         PIC 99.
  3481         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3482         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3483                     DC-GREG-DATE-1-YMD.
  3484             20  DC-YMD-YEAR           PIC 99.
  3485             20  DC-YMD-MONTH          PIC 99.
  3486             20  DC-YMD-DAY            PIC 99.
  3487         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3488         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3489                      DC-GREG-DATE-1-MDY.
  3490             20  DC-MDY-MONTH          PIC 99.
  3491             20  DC-MDY-DAY            PIC 99.
  3492             20  DC-MDY-YEAR           PIC 99.
  3493         16  DC-GREG-DATE-1-ALPHA.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  62
* SOCK03.cbl
  3494             20  DC-ALPHA-MONTH        PIC X(10).
  3495             20  DC-ALPHA-DAY          PIC 99.
  3496             20  FILLER                PIC XX.
  3497             20  DC-ALPHA-CENTURY.
  3498                 24 DC-ALPHA-CEN-N     PIC 99.
  3499             20  DC-ALPHA-YEAR         PIC 99.
  3500         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3501         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3502         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3503         16  DC-JULIAN-DATE            PIC 9(05).
  3504         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3505                                       PIC 9(05).
  3506         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3507             20  DC-JULIAN-YEAR        PIC 99.
  3508             20  DC-JULIAN-DAYS        PIC 999.
  3509         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3510         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3511         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3512     12  DATE-CONVERSION-VARIBLES.
  3513         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3514         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3515             20  FILLER                PIC 9(3).
  3516             20  HOLD-CEN-1-CCYY.
  3517                 24  HOLD-CEN-1-CC     PIC 99.
  3518                 24  HOLD-CEN-1-YY     PIC 99.
  3519             20  HOLD-CEN-1-MO         PIC 99.
  3520             20  HOLD-CEN-1-DA         PIC 99.
  3521         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3522             20  HOLD-CEN-1-R-MO       PIC 99.
  3523             20  HOLD-CEN-1-R-DA       PIC 99.
  3524             20  HOLD-CEN-1-R-CCYY.
  3525                 24  HOLD-CEN-1-R-CC   PIC 99.
  3526                 24  HOLD-CEN-1-R-YY   PIC 99.
  3527             20  FILLER                PIC 9(3).
  3528         16  HOLD-CENTURY-1-X.
  3529             20  FILLER                PIC X(3)  VALUE SPACES.
  3530             20  HOLD-CEN-1-X-CCYY.
  3531                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3532                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3533             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3534             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3535         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3536             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3537             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3538             20  HOLD-CEN-1-R-X-CCYY.
  3539                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3540                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3541             20  FILLER                PIC XXX.
  3542         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3543         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3544         16  DC-JULIAN-DATE-1          PIC 9(07).
  3545         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3546             20  DC-JULIAN-1-CCYY.
  3547                 24  DC-JULIAN-1-CC    PIC 99.
  3548                 24  DC-JULIAN-1-YR    PIC 99.
  3549             20  DC-JULIAN-DA-1        PIC 999.
  3550         16  DC-JULIAN-DATE-2          PIC 9(07).
  3551         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  63
* SOCK03.cbl
  3552             20  DC-JULIAN-2-CCYY.
  3553                 24  DC-JULIAN-2-CC    PIC 99.
  3554                 24  DC-JULIAN-2-YR    PIC 99.
  3555             20  DC-JULIAN-DA-2        PIC 999.
  3556         16  DC-GREG-DATE-A-EDIT.
  3557             20  DC-EDITA-MONTH        PIC 99.
  3558             20  SLASHA-1              PIC X VALUE '/'.
  3559             20  DC-EDITA-DAY          PIC 99.
  3560             20  SLASHA-2              PIC X VALUE '/'.
  3561             20  DC-EDITA-CCYY.
  3562                 24  DC-EDITA-CENT     PIC 99.
  3563                 24  DC-EDITA-YEAR     PIC 99.
  3564         16  DC-GREG-DATE-B-EDIT.
  3565             20  DC-EDITB-MONTH        PIC 99.
  3566             20  SLASHB-1              PIC X VALUE '/'.
  3567             20  DC-EDITB-DAY          PIC 99.
  3568             20  SLASHB-2              PIC X VALUE '/'.
  3569             20  DC-EDITB-CCYY.
  3570                 24  DC-EDITB-CENT     PIC 99.
  3571                 24  DC-EDITB-YEAR     PIC 99.
  3572         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3573         16  DC-GREG-DATE-CYMD-R REDEFINES
  3574                              DC-GREG-DATE-CYMD.
  3575             20  DC-CYMD-CEN           PIC 99.
  3576             20  DC-CYMD-YEAR          PIC 99.
  3577             20  DC-CYMD-MONTH         PIC 99.
  3578             20  DC-CYMD-DAY           PIC 99.
  3579         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3580         16  DC-GREG-DATE-MDCY-R REDEFINES
  3581                              DC-GREG-DATE-MDCY.
  3582             20  DC-MDCY-MONTH         PIC 99.
  3583             20  DC-MDCY-DAY           PIC 99.
  3584             20  DC-MDCY-CEN           PIC 99.
  3585             20  DC-MDCY-YEAR          PIC 99.
  3586    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3587        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3588    12  DC-EL310-DATE                  PIC X(21).
  3589    12  FILLER                         PIC X(28).
  3590*                                 COPY ELCCALC.
  3591******************************************************************
  3592*                                                                *
  3593*                           ELCCALC.                            *
  3594*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3595*                            VMOD=2.025                          *
  3596*                                                                *
  3597*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3598*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3599*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3600*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3601*                                                                *
  3602*  PASSED TO ELRTRM                                              *
  3603*  -----------------                                             *
  3604*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3605*  ORIGINAL TERM                                                 *
  3606*  BEGINNING DATE                                                *
  3607*  ENDING DATE                                                   *
  3608*  COMPANY I.D.                                                  *
  3609*  ACCOUNT MASTER USER FIELD                                     *
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  64
* SOCK03.cbl
  3610*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3611*  FREE LOOK DAYS                                                *
  3612*                                                                *
  3613*  RETURNED FROM ELRTRM                                          *
  3614*  ---------------------                                         *
  3615*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3616*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3617*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3618*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3619*----------------------------------------------------------------*
  3620*  PASSED TO ELRAMT                                              *
  3621*  ----------------                                              *
  3622*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3623*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3624*  ORIGINAL AMOUNT                                               *
  3625*  ALTERNATE BENEFIT (BALLON)                                    *
  3626*  A.P.R. - NET PAY ONLY                                         *
  3627*  METHOD
  3628*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3629*  COMPANY I.D.                                                  *
  3630*  BENEFIT TYPE                                                  *
  3631*                                                                *
  3632*  RETURNED FROM ELRAMT                                          *
  3633*  --------------------                                          *
  3634*  REMAINING AMOUNT 1 - CURRENT                                  *
  3635*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3636*  REMAINING AMOUNT FACTOR
  3637*----------------------------------------------------------------*
  3638*  PASSED TO ELRESV                                              *
  3639*  -----------------                                             *
  3640*  CERTIFICATE EFFECTIVE DATE                                    *
  3641*  VALUATION DATE                                                *
  3642*  PAID THRU DATE                                                *
  3643*  BENEFIT                                                       *
  3644*  INCURRED DATE                                                 *
  3645*  REPORTED DATE                                                 *
  3646*  ISSUE AGE                                                     *
  3647*  TERM                                                          *
  3648*  CDT PERCENT                                                   *
  3649*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3650* *CLAIM TYPE (LIFE, A/H)                                        *
  3651* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3652* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3653*                                                                *
  3654*  RETURNED FROM ELRESV                                          *
  3655*  --------------------                                          *
  3656*  CDT TABLE USED                                                *
  3657*  CDT FACTOR USED                                               *
  3658*  PAY TO CURRENT RESERVE                                        *
  3659*  I.B.N.R. - A/H ONLY                                           *
  3660*  FUTURE (ACCRUED) AH ONLY                                      *
  3661*----------------------------------------------------------------*
  3662*  PASSED TO ELRATE                                              *
  3663*  ----------------                                              *
  3664*  CERT ISSUE DATE                                               *
  3665*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3666*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3667*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  65
* SOCK03.cbl
  3668*  STATE CODE (CLIENT DEFINED)                                   *
  3669*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3670*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3671*  DEVIATION CODE                                                *
  3672*  ISSUE AGE                                                     *
  3673*  ORIGINAL BENEFIT AMOUNT                                       *
  3674*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3675*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3676*  BENEFIT KIND (LIFE OR A/H)                                    *
  3677*  A.P.R.                                                        *
  3678*  METHOD
  3679*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3680*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3681*  COMPANY I.D. (3 CHARACTER)                                    *
  3682*  BENEFIT CODE                                                  *
  3683*  BENEFIT OVERRIDE CODE                                         *
  3684*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3685*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3686*  JOINT INDICATOR (CSL ONLY)                                    *
  3687*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3688*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3689*                                                                *
  3690*  RETURNED FROM ELRATE                                          *
  3691*  --------------------                                          *
  3692*  CALCULATED PREMIUM                                            *
  3693*  PREMIUM RATE                                                  *
  3694*  MORTALITY CODE                                                *
  3695*  MAX ATTAINED AGE                                              *
  3696*  MAX AGE                                                       *
  3697*  MAX TERM                                                      *
  3698*  MAX MONTHLY BENEFIT                                           *
  3699*  MAX TOTAL BENIFIT                                             *
  3700*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3701*----------------------------------------------------------------*
  3702*  PASSED TO ELRFND                                              *
  3703*  ----------------                                              *
  3704*  CERT ISSUE DATE                                               *
  3705*  REFUND DATE                                                   *
  3706*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3707*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3708*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3709*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3710*  STATE CODE (CLIENT DEFINED)                                   *
  3711*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3712*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3713*  DEVIATION CODE                                                *
  3714*  ISSUE AGE                                                     *
  3715*  ORIGINAL BENEFIT AMOUNT                                       *
  3716*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3717*  PROCESS TYPE (CANCEL)                                         *
  3718*  BENEFIT KIND (LIFE OR A/H)                                    *
  3719*  A.P.R.                                                        *
  3720*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3721*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3722*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3723*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3724*  COMPANY I.D. (3 CHARACTER)                                    *
  3725*  BENEFIT CODE                                                  *
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  66
* SOCK03.cbl
  3726*  BENEFIT OVERRIDE CODE                                         *
  3727*                                                                *
  3728*  RETURNED FROM ELRFND                                          *
  3729*  --------------------                                          *
  3730*  CALCULATED REFUND                                             *
  3731*----------------------------------------------------------------*
  3732*  PASSED TO ELEARN                                              *
  3733*  ----------------                                              *
  3734*  CERT ISSUE DATE                                               *
  3735*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3736*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3737*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3738*  STATE CODE (CLIENT DEFINED)                                   *
  3739*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3740*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3741*  DEVIATION CODE                                                *
  3742*  ISSUE AGE                                                     *
  3743*  ORIGINAL BENEFIT AMOUNT                                       *
  3744*  BENEFIT KIND (LIFE OR A/H)                                    *
  3745*  A.P.R.                                                        *
  3746*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3747*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3748*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3749*  COMPANY I.D. (3 CHARACTER)                                    *
  3750*  BENEFIT CODE                                                  *
  3751*  BENEFIT OVERRIDE CODE                                         *
  3752*                                                                *
  3753*  RETURNED FROM ELEARN                                          *
  3754*  --------------------                                          *
  3755*  INDICATED  EARNINGS                                           *
  3756*----------------------------------------------------------------*
  3757*                 LENGTH = 450                                   *
  3758*                                                                *
  3759******************************************************************
  3760******************************************************************
  3761*                   C H A N G E   L O G
  3762*
  3763* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3764*-----------------------------------------------------------------
  3765*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3766* EFFECTIVE    NUMBER
  3767*-----------------------------------------------------------------
  3768* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3769* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3770* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3771* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3772* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3773* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3774* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3775* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3776* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3777* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3778* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3779******************************************************************
  3780
  3781 01  CALCULATION-PASS-AREA.
  3782     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3783                                     COMP.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  67
* SOCK03.cbl
  3784
  3785     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3786       88  NO-CP-ERROR                             VALUE ZERO.
  3787       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3788                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3789       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3790       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3791       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3792       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3793       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3794       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3795       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3796       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3797       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3798       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3799       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3800       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3801       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3802       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3803       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3804       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3805       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3806
  3807     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3808       88  NO-CP-ERROR-2                           VALUE ZERO.
  3809***********************  INPUT AREAS ****************************
  3810
  3811     12  CP-CALCULATION-AREA.
  3812         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3813         16  CP-CERT-EFF-DT        PIC XX.
  3814         16  CP-VALUATION-DT       PIC XX.
  3815         16  CP-PAID-THRU-DT       PIC XX.
  3816         16  CP-BENEFIT-TYPE       PIC X.
  3817           88  CP-AH                               VALUE 'A' 'D'
  3818                                                   'I' 'U'.
  3819           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3820           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3821         16  CP-INCURRED-DT        PIC XX.
  3822         16  CP-REPORTED-DT        PIC XX.
  3823         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3824         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3825         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3826                                     COMP-3.
  3827         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3828                                     COMP-3.
  3829         16  CP-CDT-METHOD         PIC X.
  3830           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3831           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3832           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3833         16  CP-CLAIM-TYPE         PIC X.
  3834           88  CP-AH-CLAIM                         VALUE 'A'.
  3835           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3836         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3837                                     COMP-3.
  3838         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3839                                     COMP-3.
  3840         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3841                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  68
* SOCK03.cbl
  3842         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3843                                     COMP-3.
  3844         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3845                                     COMP-3.
  3846         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3847                                     COMP-3.
  3848         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3849                                     COMP-3.
  3850         16  CP-REM-TERM-METHOD    PIC X.
  3851           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3852           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3853           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3854           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3855           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3856           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3857           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3858         16  CP-EARNING-METHOD     PIC X.
  3859           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3860           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3861           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3862           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3863           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3864           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3865           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3866           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3867           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3868           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3869           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3870           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3871           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3872           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3873         16  CP-PROCESS-TYPE       PIC X.
  3874           88  CP-CLAIM                            VALUE '1'.
  3875           88  CP-CANCEL                           VALUE '2'.
  3876           88  CP-ISSUE                            VALUE '3'.
  3877         16  CP-SPECIAL-CALC-CD    PIC X.
  3878           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3879           88  CP-1-MTH-INTEREST               VALUE ' '.
  3880           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3881           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3882           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3883           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3884           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3885           88  CP-FARM-PLAN                    VALUE 'F'.
  3886           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3887           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3888           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3889           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3890           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3891           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3892           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3893           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3894           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3895           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3896                                                     'W' 'X'.
  3897           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3898           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3899           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  69
* SOCK03.cbl
  3900           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3901           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3902           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3903           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3904           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3905           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3906           88  CP-CSL-METH-1                   VALUE '5'.
  3907           88  CP-CSL-METH-2                   VALUE '6'.
  3908           88  CP-CSL-METH-3                   VALUE '7'.
  3909           88  CP-CSL-METH-4                   VALUE '8'.
  3910
  3911         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3912                                     COMP-3.
  3913         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3914         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3915         16  CP-STATE              PIC XX          VALUE SPACE.
  3916         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3917         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3918           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3919               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3920         16  CP-R78-OPTION         PIC X.
  3921           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3922           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3923
  3924         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3925         16  CP-IBNR-RESERVE-SW    PIC X.
  3926         16  CP-CLAIM-STATUS       PIC X.
  3927         16  CP-RATE-FILE          PIC X.
  3928         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3929                                     COMP-3.
  3930
  3931         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3932         16  CP-AH-OVERRIDE-CODE   PIC X.
  3933
  3934         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3935                                     COMP-3.
  3936         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3937                                   PIC S9(5)V99 COMP-3.
  3938         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3939                                     COMP-3.
  3940         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3941                                     COMP-3.
  3942         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3943                                     COMP-3.
  3944         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3945                                  PIC S9(7)V99 COMP-3.
  3946
  3947         16  CP-PAID-FROM-DATE     PIC X(02).
  3948         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3949         16  CP-EXT-DAYS-CALC      PIC X.
  3950           88  CP-EXT-NO-CHG                   VALUE ' '.
  3951           88  CP-EXT-CHG-LF                   VALUE '1'.
  3952           88  CP-EXT-CHG-AH                   VALUE '2'.
  3953           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3954         16  CP-DOMICILE-STATE     PIC XX.
  3955         16  CP-CARRIER            PIC X.
  3956         16  CP-REIN-FLAG          PIC X.
  3957         16  CP-REM-TRM-CALC-OPTION PIC X.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  70
* SOCK03.cbl
  3958           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3959                      '2' '3' '4' '5'.
  3960           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3961           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3962           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3963           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3964           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3965           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3966           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3967           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3968         16  CP-SIG-SWITCH         PIC X.
  3969         16  CP-RATING-METHOD      PIC X.
  3970           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3971           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3972           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3973           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3974           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3975           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3976           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3977           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3978           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3979         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3980                                     COMP-3.
  3981         16  CP-BEN-CATEGORY       PIC X.
  3982         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3983         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3984                                   PIC S99V9(5) COMP-3.
  3985         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3986         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3987                                   PIC S99V9(5) COMP-3.
  3988         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3989         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3990         16  CP-EXPIRE-DT          PIC XX.
  3991         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3992         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3993         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3994         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3995         16  CP-DDF-SPEC-CALC      PIC X.
  3996             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3997             88  CP-CALC-CLP              VALUE 'C'.
  3998         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3999         16  CP-CANCEL-REASON      PIC X.
  4000         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  4001         16  CP-PMT-MODE           PIC X.
  4002         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  4003         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  4004         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  4005         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  4006         16  FILLER                PIC X.
  4007
  4008***************    OUTPUT FROM ELRESV   ************************
  4009
  4010         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  4011
  4012         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  4013                                     COMP-3.
  4014         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  4015                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  71
* SOCK03.cbl
  4016         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  4017                                     COMP-3.
  4018         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  4019                                     COMP-3.
  4020         16  FILLER                PIC X(09).
  4021***************    OUTPUT FROM ELRTRM   *************************
  4022
  4023         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  4024                                     COMP-3.
  4025         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  4026                                     COMP-3.
  4027         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  4028                                     COMP-3.
  4029         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  4030                                     COMP-3.
  4031         16  FILLER                PIC X(12).
  4032
  4033***************    OUTPUT FROM ELRAMT   *************************
  4034
  4035         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  4036                                     COMP-3.
  4037         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  4038                                     COMP-3.
  4039         16  FILLER                PIC X(12).
  4040
  4041***************    OUTPUT FROM ELRATE   *************************
  4042
  4043         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  4044                                     COMP-3.
  4045         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  4046                                     COMP-3.
  4047         16  CP-MORTALITY-CODE     PIC X(4).
  4048         16  CP-RATE-EDIT-FLAG     PIC X.
  4049             88  CP-RATES-NEED-APR                  VALUE '1'.
  4050         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  4051                                     COMP-3.
  4052         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  4053         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  4054         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  4055                                   PIC S9(7)V99 COMP-3.
  4056         16  FILLER                PIC X(07).
  4057
  4058***************    OUTPUT FROM ELRFND   *************************
  4059
  4060         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  4061                                     COMP-3.
  4062         16  CP-REFUND-TYPE-USED   PIC X.
  4063           88  CP-R-AS-R78                         VALUE '1'.
  4064           88  CP-R-AS-PRORATA                     VALUE '2'.
  4065           88  CP-R-AS-CALIF                       VALUE '3'.
  4066           88  CP-R-AS-TEXAS                       VALUE '4'.
  4067           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  4068           88  CP-R-AS-NET-PAY                     VALUE '5'.
  4069           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  4070           88  CP-R-AS-MEAN                        VALUE '8'.
  4071           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  4072           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  4073           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  72
* SOCK03.cbl
  4074           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  4075           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  4076           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  4077         16  FILLER                PIC X(12).
  4078
  4079***************    OUTPUT FROM ELEARN   *************************
  4080
  4081         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  4082                                     COMP-3.
  4083         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  4084                                     COMP-3.
  4085         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  4086                                     COMP-3.
  4087         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  4088                                     COMP-3.
  4089         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  4090                                     COMP-3.
  4091         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  4092                                     COMP-3.
  4093         16  CP-EARNING-TYPE-USED  PIC X.
  4094           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  4095           88  CP-E-AS-R78                         VALUE '1'.
  4096           88  CP-E-AS-PRORATA                     VALUE '2'.
  4097           88  CP-E-AS-TEXAS                       VALUE '4'.
  4098           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  4099           88  CP-E-AS-NET-PAY                     VALUE '5'.
  4100           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  4101           88  CP-E-AS-MEAN                        VALUE '8'.
  4102           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  4103         16  FILLER                PIC X(12).
  4104
  4105***************    OUTPUT FROM ELPMNT   *************************
  4106
  4107         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  4108                                     COMP-3.
  4109         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  4110                                     COMP-3.
  4111         16  FILLER                PIC X(12).
  4112
  4113***************   MISC WORK AREAS    *****************************
  4114         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  4115                                     COMP-3.
  4116         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  4117                                     COMP-3.
  4118         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  4119                                     COMP-3.
  4120         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  4121                                     COMP-3.
  4122         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  4123                                     COMP-3.
  4124         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  4125                                     COMP-3.
  4126         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  4127             88  OPEN-RATE-FILE                   VALUE 'O'.
  4128             88  CLOSE-RATE-FILE                  VALUE 'C'.
  4129             88  IO-ERROR                         VALUE 'E'.
  4130
  4131         16  CP-FIRST-PAY-DATE     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  73
* SOCK03.cbl
  4132
  4133         16  CP-JOINT-INDICATOR    PIC X.
  4134
  4135         16  CP-RESERVE-REMAINING-TERM
  4136                                   PIC S9(4)V9    VALUE ZERO
  4137                                     COMP-3.
  4138
  4139         16  CP-INSURED-BIRTH-DT   PIC XX.
  4140
  4141         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  4142                                     COMP-3.
  4143
  4144         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  4145                                     COMP-3.
  4146
  4147         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  4148                                     COMP-3.
  4149
  4150         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  4151                                     COMP-3.
  4152
  4153         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  4154                                     COMP-3.
  4155
  4156         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  4157                                     COMP-3.
  4158
  4159         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  4160                                     COMP-3.
  4161
  4162         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  4163             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  4164
  4165         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  4166                                     COMP-3.
  4167         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  4168                                     COMP-3.
  4169         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  4170         16  cp-extra-periods      pic 9 value zeros.
  4171         16  cp-net-only-state     pic x value spaces.
  4172         16  FILLER                PIC X(13).
  4173******************************************************************
  4174****************************************************************
  4175*
  4176* Copyright (c) 2007-2013 Dell Inc.
  4177* All rights reserved.
  4178*
  4179****************************************************************
  4180 01  DFHEIV.
  4181   02  DFHEIV0               PIC X(35).
  4182   02  DFHEIV1               PIC X(08).
  4183   02  DFHEIV2               PIC X(08).
  4184   02  DFHEIV3               PIC X(08).
  4185   02  DFHEIV4               PIC X(06).
  4186   02  DFHEIV5               PIC X(04).
  4187   02  DFHEIV6               PIC X(04).
  4188   02  DFHEIV7               PIC X(02).
  4189   02  DFHEIV8               PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  74
* SOCK03.cbl
  4190   02  DFHEIV9               PIC X(01).
  4191   02  DFHEIV10              PIC S9(7) COMP-3.
  4192   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4193   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4194   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4195   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4196   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4197   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4198   02  DFHEIV17              PIC X(04).
  4199   02  DFHEIV18              PIC X(04).
  4200   02  DFHEIV19              PIC X(04).
  4201   02  DFHEIV20              USAGE IS POINTER.
  4202   02  DFHEIV21              USAGE IS POINTER.
  4203   02  DFHEIV22              USAGE IS POINTER.
  4204   02  DFHEIV23              USAGE IS POINTER.
  4205   02  DFHEIV24              USAGE IS POINTER.
  4206   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4207   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4208   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4209   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4210   02  DFHEIV29              PIC S9(9) COMP SYNC.
  4211   02  DFHEIV30              PIC S9(9) COMP SYNC.
  4212   02  DFHEIV31              PIC S9(9) COMP SYNC.
  4213   02  DFHEIV32              PIC S9(4) COMP SYNC.
  4214   02  DFHEIV33              PIC S9(4) COMP SYNC.
  4215   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4216   02  DFHEIV35              PIC S9(4) COMP SYNC.
  4217   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4218   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4219   02  FILLER                PIC X(02).
  4220   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4221   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4222   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4223   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4224   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4225   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4226   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4227 LINKAGE  SECTION.
  4228*****************************************************************
  4229*                                                               *
  4230* Copyright (c) 2007-2013 Dell Inc.                             *
  4231* All rights reserved.                                          *
  4232*                                                               *
  4233*****************************************************************
  4234 01  dfheiblk.
  4235     02  eibtime          pic s9(7) comp-3.
  4236     02  eibdate          pic s9(7) comp-3.
  4237     02  eibtrnid         pic x(4).
  4238     02  eibtaskn         pic s9(7) comp-3.
  4239     02  eibtrmid         pic x(4).
  4240     02  dfheigdi         pic s9(4) comp.
  4241     02  eibcposn         pic s9(4) comp.
  4242     02  eibcalen         pic s9(4) comp.
  4243     02  eibaid           pic x(1).
  4244     02  eibfiller1       pic x(1).
  4245     02  eibfn            pic x(2).
  4246     02  eibfiller2       pic x(2).
  4247     02  eibrcode         pic x(6).
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  75
* SOCK03.cbl
  4248     02  eibfiller3       pic x(2).
  4249     02  eibds            pic x(8).
  4250     02  eibreqid         pic x(8).
  4251     02  eibrsrce         pic x(8).
  4252     02  eibsync          pic x(1).
  4253     02  eibfree          pic x(1).
  4254     02  eibrecv          pic x(1).
  4255     02  eibsend          pic x(1).
  4256     02  eibatt           pic x(1).
  4257     02  eibeoc           pic x(1).
  4258     02  eibfmh           pic x(1).
  4259     02  eibcompl         pic x(1).
  4260     02  eibsig           pic x(1).
  4261     02  eibconf          pic x(1).
  4262     02  eiberr           pic x(1).
  4263     02  eibrldbk         pic x(1).
  4264     02  eiberrcd         pic x(4).
  4265     02  eibsynrb         pic x(1).
  4266     02  eibnodat         pic x(1).
  4267     02  eibfiller5       pic x(2).
  4268     02  eibresp          pic s9(8) comp.
  4269     02  eibresp2         pic s9(8) comp.
  4270     02  dfheigdj         pic s9(4) comp.
  4271     02  dfheigdk         pic s9(4) comp.
  4272 01  DFHCOMMAREA.
  4273   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  4274   05 LSTN-NAME                PIC X(8).
  4275   05 LSTN-SUBNAME             PIC X(8).
  4276**** client-in-data cannot be more than 36 characters ***
  4277   05 CLIENT-IN-DATA           pic x(36).
  4278   05 SOCKADDR-IN-PARM.
  4279     15 SIN-FAMILY             PIC 9(4) COMP.
  4280     15 SIN-PORT               PIC 9(4) COMP.
  4281     15 SIN-ADDRESS            PIC 9(8) COMP.
  4282     15 SIN-ZERO               PIC X(8).
  4283 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  4284 0000-DFHEXIT SECTION.
  4285     MOVE '9#                    $   ' TO DFHEIV0.
  4286     MOVE 'SOCK03' TO DFHEIV1.
  4287     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4288     display '  BEGIN SOCK03 '
  4289     display 'SOCK03:transaction data =', CLIENT-IN-DATA (1:10)
  4290     display 'SOCK03:socket number    =', GIVE-TAKE-SOCKET.
  4291     IF CLIENT-IN-DATA (1:6) = 'REFUND' OR 'NEWBUS'
  4292        MOVE CLIENT-IN-DATA (1:6) TO WS-CALL-TYPE
  4293        evaluate true
  4294           when client-in-data (8:3) = 'AHL'
  4295              MOVE X'06'         TO WS-COMP-CD
  4296              MOVE 'AHL'         TO WS-SEND-BUF (5:3)
  4297                                    WS-COMP-ID
  4298           when CLIENT-IN-DATA (8:3) = 'DCC'
  4299              MOVE X'05'         TO WS-COMP-CD
  4300              MOVE 'DCC'         TO WS-SEND-BUF (5:3)
  4301                                    WS-COMP-ID
  4302           when CLIENT-IN-DATA (8:3) = 'VPP'
  4303              MOVE X'07'         TO WS-COMP-CD
  4304              MOVE 'VPP'         TO WS-SEND-BUF (5:3)
  4305                                    WS-COMP-ID
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  76
* SOCK03.cbl
  4306           when other
  4307              MOVE X'04'         TO WS-COMP-CD
  4308              MOVE 'CID'         TO WS-SEND-BUF (5:3)
  4309                                    WS-COMP-ID
  4310        end-evaluate
  4311        move 'CSO'               to ws-send-buf (1:3)
  4312        move +25                 to ws-send-msg-size
  4313     END-IF
  4314     display 'SOCK03:sequence number  =', ws-seq-num.
  4315     display 'SOCK03:send buffer      =', ws-send-buf(1:25).
  4316     call "send" using by value GIVE-TAKE-SOCKET,
  4317         by reference ws-send-buf,
  4318         by value ws-send-msg-size,
  4319         by value ws-flags.
  4320     if return-code <= zero
  4321         display 'SOCK03:send error ',
  4322         go to socket-error.
  4323     move low-values to ws-recv-buf.
  4324     set ws-recv-total to zero.
  4325     compute ws-recv-left = ws-recv-msg-size.
  4326     display 'SOCK03:About to recv '
  4327     call "recv" using by value GIVE-TAKE-SOCKET,
  4328         by reference ws-recv-buf
  4329         by value ws-recv-msg-size,
  4330         by value ws-flags.
  4331     if return-code < zero
  4332        display 'SOCK03:recv error ',
  4333        go to socket-error.
  4334     if return-code = zero
  4335        display 'SOCK03:client disconnected',
  4336        go to socket-error.
  4337*
  4338     display 'SOCK03:Good recv  '
  4339     display 'SOCK03:return code      = ', return-code
  4340     display 'SOCK03:receive buffer   = ', ws-recv-buf(1:89)
  4341     move +4096                  to ws-send-msg-size
  4342*    move +750                   to ws-send-msg-size
  4343     move ws-recv-buf (1:89)     to soc-client-in-data
  4344     MOVE SPACES                 TO WS-ELCERT-SW
  4345     MOVE X'0A'                  TO WS-HEX-0A
  4346     if client-account = 'EPIQ000001'
  4347        set ws-epiq-request to true
  4348        move spaces              to client-account
  4349     end-if
  4350     move +0 to ws-epiq-max
  4351     if client-car = spaces
  4352        if client-state = 'KY'
  4353           move '8'              to client-car
  4354        else
  4355           move '9'              to client-car
  4356        end-if
  4357     end-if
  4358     if client-grp = spaces
  4359        move '000000'            to client-grp
  4360     end-if
  4361     EVALUATE TRUE
  4362        WHEN (CLIENT-CAR NOT = SPACES)
  4363           AND (CLIENT-STATE NOT = SPACES)
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  77
* SOCK03.cbl
  4364           AND (CLIENT-ACCOUNT NOT = SPACES)
  4365           AND (CLIENT-EFF-DT NOT = SPACES)
  4366           AND (CLIENT-CERT-NO NOT = SPACES)
  4367           SET WS-ELCERT-FULL    TO TRUE
  4368           DISPLAY ' SETTING FULL '
  4369        WHEN (CLIENT-CERT-NO NOT = SPACES)
  4370           SET WS-ELCERT-CERT-NO TO TRUE
  4371           DISPLAY ' SETTING CERT NO '
  4372*       WHEN (CLIENT-EFF-DT NOT = SPACES)
  4373*          AND (CLIENT-LAST-NAME NOT = SPACES)
  4374        WHEN (CLIENT-ACCOUNT NOT = SPACES)
  4375           AND (CLIENT-LAST-NAME NOT = SPACES)
  4376           SET WS-ELCERT-ACT-NAME TO TRUE
  4377        WHEN CLIENT-LAST-NAME NOT = SPACES
  4378           SET WS-ELCERT-NAME    TO TRUE
  4379           DISPLAY ' SETTING NAME '
  4380        when (client-vin not = spaces)
  4381           and (client-state not = spaces)
  4382           and (client-account not = spaces)
  4383           set ws-elcert-vin to true
  4384           display ' SETTING VIN '
  4385        WHEN OTHER
  4386           MOVE ' BAD SELECTION OPTION ' TO WS-COMMENT
  4387           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4388           MOVE ZEROS            TO WS-RESP
  4389           PERFORM 0030-BUILD-BUFFER
  4390                                 THRU 0030-EXIT
  4391           PERFORM 0020-SEND-BUFFER
  4392                                 THRU 0020-EXIT
  4393           PERFORM 0025-CLOSE-SOCKET
  4394                                 THRU 0025-EXIT
  4395           GO TO 0010-RETURN
  4396     END-EVALUATE
  4397     IF CLIENT-CAN-REASON = 'R'
  4398        MOVE 'R'                 TO WS-CANCEL-REASON
  4399     ELSE
  4400        MOVE ' '                 TO WS-CANCEL-REASON
  4401     END-IF
  4402     IF WS-ELCERT-KEY-SW NOT = SPACES
  4403        PERFORM 0050-BEGIN-REFUND-PROCESS
  4404                                 THRU 0050-EXIT
  4405     END-IF
  4406     PERFORM 0025-CLOSE-SOCKET   THRU 0025-EXIT
  4407     .
  4408 0010-RETURN.
  4409
  4410* exec cics return end-exec.
  4411*    MOVE '.(                    ''   #00004405' TO DFHEIV0
  4412     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4413     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4414     MOVE X'2020233030303034343035' TO DFHEIV0(25:11)
  4415     CALL 'kxdfhei1' USING DFHEIV0,
  4416           DFHEIV99,
  4417           DFHEIV99,
  4418           DFHEIV99,
  4419           DFHEIV99,
  4420           DFHEIV99,
  4421           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  78
* SOCK03.cbl
  4422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4423
  4424
  4425* goback.
  4426     MOVE '9%                    "   ' TO DFHEIV0
  4427     MOVE 'SOCK03' TO DFHEIV1
  4428     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4429     goback.
  4430*    PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4431     .
  4432 0020-SEND-BUFFER.
  4433     display 'SOCK03:About to send      '
  4434     display 'SOCK03:sequence number  =', ws-seq-num.
  4435     display 'SOCK03:send buffer      =', ws-send-buf(1:500).
  4436     call "send" using by value GIVE-TAKE-SOCKET,
  4437         by reference ws-send-buf,
  4438         by value ws-send-msg-size,
  4439         by value ws-flags.
  4440     if return-code <= zero
  4441         display 'SOCK03:send error ' return-code,
  4442         go to socket-error.
  4443 0020-EXIT.
  4444     EXIT.
  4445 0025-CLOSE-SOCKET.
  4446*    display 'SOCK03:closing socket'.
  4447*    call "close" using by value GIVE-TAKE-SOCKET .
  4448     display 'SOCK03:done'.
  4449     .
  4450 0025-EXIT.
  4451     EXIT.
  4452*
  4453* set up the receive buffer
  4454*
  4455     move low-values to ws-recv-buf.
  4456     set ws-recv-total to zero.
  4457     compute ws-recv-left = ws-recv-msg-size.
  4458*
  4459* receive data
  4460*
  4461 recv-1.
  4462     call "recv" using by value GIVE-TAKE-SOCKET,
  4463         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4464         by value ws-recv-left,
  4465         by value ws-flags.
  4466*
  4467* test what was received and decide what we should do
  4468*
  4469     if return-code < zero
  4470        display 'SOCK03:recv error ',
  4471        go to socket-error.
  4472     if return-code = zero
  4473        display 'SOCK03:client disconnected',
  4474        go to socket-error.
  4475*
  4476* have we received all the data yet?
  4477*
  4478     compute ws-recv-total = ws-recv-total + return-code.
  4479     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  79
* SOCK03.cbl
  4480*
  4481* not yet
  4482*
  4483     if ws-recv-left > 0 go to recv-1.
  4484*
  4485* received all the data
  4486*
  4487     display 'SOCK03:receive buffer   =', ws-recv-buf(1:50).
  4488*
  4489* make sure what we received was what we sent
  4490*
  4491*    if ws-recv-buf <> ws-send-buf
  4492*        display "SOCK03:data doesn't match",
  4493*        go to socket-error.
  4494*
  4495* end of pass
  4496*
  4497*loop-end.
  4498*    if ws-seq-num = 5 go to socket-error.
  4499*    go to loop-1.
  4500*
  4501* program end
  4502*
  4503 socket-error.
  4504     if ws-seq-num <> 0
  4505         display "SOCK03:did not complete".
  4506*
  4507* flush the send buffer and deallocate
  4508*
  4509*    display 'SOCK03:closing socket'.
  4510*    call "close" using by value GIVE-TAKE-SOCKET .
  4511*
  4512* finised return to cics
  4513*
  4514 socket-fin.
  4515*    display 'SOCK03:closing socket'.
  4516*    call "close" using by value GIVE-TAKE-SOCKET .
  4517     display 'SOCK03:done'.
  4518
  4519* exec cics return end-exec.
  4520*    MOVE '.(                    ''   #00004495' TO DFHEIV0
  4521     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4522     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4523     MOVE X'2020233030303034343935' TO DFHEIV0(25:11)
  4524     CALL 'kxdfhei1' USING DFHEIV0,
  4525           DFHEIV99,
  4526           DFHEIV99,
  4527           DFHEIV99,
  4528           DFHEIV99,
  4529           DFHEIV99,
  4530           DFHEIV99
  4531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4532
  4533
  4534* goback.
  4535     MOVE '9%                    "   ' TO DFHEIV0
  4536     MOVE 'SOCK03' TO DFHEIV1
  4537     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  80
* SOCK03.cbl
  4538     goback.
  4539 0030-BUILD-BUFFER.
  4540     MOVE SPACES                 TO WS-SEND-BUF
  4541     IF WS-CALL-TYPE = 'NEWBUS'
  4542        STRING
  4543           WS-COMMENT            ';'
  4544           WS-RESP               ';'
  4545           WS-CARRIER            ';'
  4546           WS-GROUPING           ';'
  4547           WS-STATE              ';'
  4548           WS-ACCOUNT            ';'
  4549           WS-CERT-EFF-DATE      ';'
  4550           WS-CERT-NO            ';'
  4551           WS-LAST-NAME          ';'
  4552           WS-FIRST-NAME         ';'
  4553           WS-MID-INIT           ';'
  4554           WS-LAST-JNAME         ';'
  4555           WS-FIRST-JNAME        ';'
  4556           WS-MID-JINIT          ';'
  4557           WS-POST-CARD-SW       ';'
  4558           ws-lf-coverage-type   ';'
  4559           WS-LF-STATUS          ';'
  4560           WS-LF-BEN-CODE        ';'
  4561           WS-LF-BEN-CODE-DESC   ';'
  4562           WS-LF-TERM            ';'
  4563           WS-LF-REM-TERM        ';'
  4564           WS-LF-PREM            ';'
  4565           WS-LF-REFUND          ';'
  4566           WS-LF-METHOD          ';'
  4567           WS-LF-ORIG-BENEFIT    ';'
  4568           WS-LF-REM-BEN         ';'
  4569           WS-LF-EXPIRE-DATE     ';'
  4570           WS-LF-COMM            ';'
  4571           WS-LF-UEC             ';'
  4572           WS-AH-COVERAGE-TYPE   ';'
  4573           WS-AH-STATUS          ';'
  4574           WS-AH-BEN-CODE        ';'
  4575           WS-AH-BEN-CODE-DESC   ';'
  4576           WS-AH-TERM            ';'
  4577           WS-AH-REM-TERM        ';'
  4578           WS-AH-PREM            ';'
  4579           WS-AH-REFUND          ';'
  4580           WS-AH-METHOD          ';'
  4581           WS-AH-ORIG-BENEFIT    ';'
  4582           WS-AH-REM-BEN         ';'
  4583           WS-AH-EXPIRE-DATE     ';'
  4584           WS-AH-COMM            ';'
  4585           WS-AH-UEC             ';'
  4586           WS-ACCOUNT-NAME       ';'
  4587           WS-REPORT-CODE-1      ';'
  4588           WS-REPORT-CODE-2      ';'
  4589           WS-REPORT-CODE-3      ';'
  4590           WS-CLM-PAID-THRU-DT   ';'
  4591           WS-LF-CANCEL-DATE     ';'
  4592           WS-AH-CANCEL-DATE     ';'
  4593           WS-VIN                ';'
  4594           WS-CRED-BENE-NAME     ';'
  4595           WS-HEX-0A
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  81
* SOCK03.cbl
  4596            DELIMITED BY '  ' INTO WS-SEND-BUF
  4597        END-STRING
  4598     ELSE
  4599        STRING
  4600           WS-COMMENT            ';'  *> 0
  4601           WS-RESP               ';'
  4602           WS-CARRIER            ';'
  4603           WS-GROUPING           ';'
  4604           WS-STATE              ';'
  4605           WS-ACCOUNT            ';'
  4606           WS-CERT-EFF-DATE      ';'
  4607           WS-CERT-NO            ';'
  4608           WS-LAST-NAME          ';'
  4609           WS-FIRST-NAME         ';'
  4610           WS-MID-INIT           ';'
  4611           WS-LAST-JNAME         ';'
  4612           WS-FIRST-JNAME        ';'
  4613           WS-MID-JINIT          ';'
  4614           WS-POST-CARD-SW       ';'
  4615           WS-LF-STATUS          ';'
  4616           WS-LF-BEN-CODE        ';'  *> 16
  4617           WS-LF-BEN-CODE-DESC   ';'
  4618           WS-LF-TERM            ';'
  4619           WS-LF-REM-TERM        ';'
  4620           WS-LF-PREM            ';'
  4621           WS-LF-REFUND          ';'
  4622           WS-LF-METHOD          ';'
  4623           WS-LF-ORIG-BENEFIT    ';'
  4624           WS-LF-REM-BEN         ';'
  4625           WS-LF-EXPIRE-DATE     ';'
  4626           WS-LF-COMM            ';'
  4627           WS-LF-UEC             ';'
  4628           WS-AH-STATUS          ';'
  4629           WS-AH-BEN-CODE        ';'   *> 29
  4630           WS-AH-BEN-CODE-DESC   ';'
  4631           WS-AH-TERM            ';'
  4632           WS-AH-REM-TERM        ';'
  4633           WS-AH-PREM            ';'   *> 32
  4634           WS-AH-REFUND          ';'   *> 33
  4635           WS-AH-METHOD          ';'
  4636           WS-AH-ORIG-BENEFIT    ';'   *> 36
  4637           WS-AH-REM-BEN         ';'
  4638           WS-AH-EXPIRE-DATE     ';'
  4639           WS-AH-COMM            ';'
  4640           WS-AH-UEC             ';'
  4641           WS-ACCOUNT-NAME       ';'
  4642           WS-REPORT-CODE-1      ';'
  4643           WS-REPORT-CODE-2      ';'
  4644           WS-REPORT-CODE-3      ';'
  4645           WS-CLM-PAID-THRU-DT   ';'
  4646           WS-LF-CANCEL-DATE     ';'
  4647           WS-AH-CANCEL-DATE     ';'
  4648           WS-VIN                ';'
  4649           WS-CRED-BENE-NAME     ';'
  4650           'E'                   ';'
  4651            DELIMITED BY '  ' INTO WS-SEND-BUF
  4652        END-STRING
  4653     END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  82
* SOCK03.cbl
  4654     .
  4655 0030-EXIT.
  4656     EXIT.
  4657 0050-BEGIN-REFUND-PROCESS.
  4658     IF WS-ELCERT-ACT-NAME
  4659        PERFORM 0060-FIND-FULL-KEY
  4660                                 THRU 0060-EXIT
  4661        MOVE AM-CARRIER          TO CLIENT-CAR
  4662        MOVE AM-GROUPING         TO CLIENT-GRP
  4663        MOVE AM-STATE            TO CLIENT-STATE
  4664     END-IF
  4665     PERFORM 0100-START-ELCERT   THRU 0100-EXIT
  4666     IF NOT RESP-NORMAL
  4667        MOVE ' CERT NOT FOUND - START ' TO WS-COMMENT
  4668        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4669        MOVE WS-RESPONSE         TO WS-RESP
  4670        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4671        PERFORM 0020-SEND-BUFFER
  4672                                 THRU 0020-EXIT
  4673        PERFORM 0025-CLOSE-SOCKET
  4674                                 THRU 0025-EXIT
  4675        GO TO 0010-RETURN
  4676     END-IF
  4677     PERFORM 0150-READ-NEXT-ELCERT
  4678                                 THRU 0150-EXIT
  4679*    display ' came back from 0150 ' ws-response
  4680     IF (NOT RESP-NORMAL AND NOT RESP-DUPKEY)
  4681        DISPLAY ' CERT NOT FOUND '
  4682        MOVE ' CERT NOT FOUND - READ ' TO WS-COMMENT
  4683        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4684        MOVE WS-RESPONSE         TO WS-RESP
  4685        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4686        PERFORM 0020-SEND-BUFFER
  4687                                 THRU 0020-EXIT
  4688        PERFORM 0025-CLOSE-SOCKET
  4689                                 THRU 0025-EXIT
  4690        GO TO 0010-RETURN
  4691     END-IF
  4692     PERFORM 0200-BEGIN-REFUND-PROCESS
  4693                                 THRU 0200-EXIT UNTIL
  4694        ELCERT-FINISHED
  4695     .
  4696 0050-EXIT.
  4697     EXIT.
  4698 0060-FIND-FULL-KEY.
  4699     MOVE ' ' TO WS-STOP-SW
  4700     MOVE CLIENT-ACCOUNT         TO WS-AM3-ACCOUNT
  4701     MOVE LOW-VALUES             TO WS-AM3-EXP-DT
  4702
  4703* EXEC CICS STARTBR
  4704*       DATASET  ('ERACCT3')
  4705*       RIDFLD   (WS-AM3-KEY)
  4706*       GTEQ
  4707*       RESP (WS-RESPONSE)
  4708*    END-EXEC
  4709     MOVE 'ERACCT3' TO DFHEIV1
  4710     MOVE 0
  4711       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  83
* SOCK03.cbl
  4712*    MOVE '&,         G          &  N#00004660' TO DFHEIV0
  4713     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4714     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4715     MOVE X'204E233030303034363630' TO DFHEIV0(25:11)
  4716     CALL 'kxdfhei1' USING DFHEIV0,
  4717           DFHEIV1,
  4718           WS-AM3-KEY,
  4719           DFHEIV99,
  4720           DFHEIV11,
  4721           DFHEIV99
  4722     MOVE EIBRESP  TO WS-RESPONSE
  4723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4724     IF RESP-NORMAL
  4725        PERFORM UNTIL TOLD-TO-STOP
  4726
  4727* EXEC CICS READNEXT
  4728*             DATASET  ('ERACCT3')
  4729*             INTO     (ACCOUNT-MASTER)
  4730*             RIDFLD   (WS-AM3-KEY)
  4731*          END-EXEC
  4732     MOVE LENGTH OF
  4733      ACCOUNT-MASTER
  4734       TO DFHEIV12
  4735     MOVE 'ERACCT3' TO DFHEIV1
  4736     MOVE 0
  4737       TO DFHEIV11
  4738*    MOVE '&.IL                  )   #00004668' TO DFHEIV0
  4739     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4740     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4741     MOVE X'2020233030303034363638' TO DFHEIV0(25:11)
  4742     CALL 'kxdfhei1' USING DFHEIV0,
  4743           DFHEIV1,
  4744           ACCOUNT-MASTER,
  4745           DFHEIV12,
  4746           WS-AM3-KEY,
  4747           DFHEIV99,
  4748           DFHEIV11,
  4749           DFHEIV99,
  4750           DFHEIV99
  4751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4752           EVALUATE TRUE
  4753              WHEN (RESP-NORMAL)
  4754                 AND (AM-ACCOUNT = CLIENT-ACCOUNT)
  4755                 AND (AM-COMPANY-CD = WS-COMP-CD)
  4756                 SET TOLD-TO-STOP TO TRUE
  4757              WHEN (AM-ACCOUNT = CLIENT-ACCOUNT)
  4758                 AND (AM-COMPANY-CD NOT = WS-COMP-CD)
  4759                 CONTINUE
  4760              WHEN AM-ACCOUNT NOT = CLIENT-ACCOUNT
  4761                 MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4762                 MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4763                 MOVE ZEROS      TO WS-RESP
  4764                 PERFORM 0030-BUILD-BUFFER
  4765                                 THRU 0030-EXIT
  4766                 PERFORM 0020-SEND-BUFFER
  4767                                 THRU 0020-EXIT
  4768                 PERFORM 0025-CLOSE-SOCKET
  4769                                 THRU 0025-EXIT
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  84
* SOCK03.cbl
  4770                 GO TO 0010-RETURN
  4771           END-EVALUATE
  4772        END-PERFORM
  4773
  4774* EXEC CICS ENDBR
  4775*          DATASET   ('ERACCT3')
  4776*       END-EXEC
  4777     MOVE 'ERACCT3' TO DFHEIV1
  4778     MOVE 0
  4779       TO DFHEIV11
  4780*    MOVE '&2                    $   #00004694' TO DFHEIV0
  4781     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4782     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4783     MOVE X'2020233030303034363934' TO DFHEIV0(25:11)
  4784     CALL 'kxdfhei1' USING DFHEIV0,
  4785           DFHEIV1,
  4786           DFHEIV11,
  4787           DFHEIV99
  4788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4789     ELSE
  4790        MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4791        MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4792        MOVE ZEROS      TO WS-RESP
  4793        PERFORM 0030-BUILD-BUFFER
  4794                                 THRU 0030-EXIT
  4795        PERFORM 0020-SEND-BUFFER
  4796                                 THRU 0020-EXIT
  4797        PERFORM 0025-CLOSE-SOCKET
  4798                                 THRU 0025-EXIT
  4799        GO TO 0010-RETURN
  4800     END-IF
  4801     .
  4802 0060-EXIT.
  4803     EXIT.
  4804 0100-START-ELCERT.
  4805     MOVE SPACES                 TO WS-SEND-BUF
  4806     INITIALIZE WS-STRING-DATA
  4807     MOVE LOW-VALUES             TO WS-CM-KEY
  4808                                    WS-CM-KEY-A1
  4809                                    WS-CM-KEY-A4
  4810     MOVE WS-COMP-CD             TO WS-CM-COMPANY-CD
  4811                                    WS-CM-COMPANY-CD-A1
  4812                                    WS-CM-COMPANY-CD-A4
  4813     MOVE CLIENT-VAL-DT          TO DC-GREG-DATE-CYMD
  4814     MOVE 'L'                    TO DC-OPTION-CODE
  4815     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4816     IF NO-CONVERSION-ERROR
  4817        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DT
  4818     ELSE
  4819        MOVE 'BAD VAL DT CONVERT ' TO WS-COMMENT
  4820        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4821        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4822        PERFORM 0020-SEND-BUFFER
  4823                                 THRU 0020-EXIT
  4824        PERFORM 0025-CLOSE-SOCKET
  4825                                 THRU 0025-EXIT
  4826        GO TO 0010-RETURN
  4827     END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  85
* SOCK03.cbl
  4828     IF CLIENT-EFF-DT NOT = SPACES AND ZEROS
  4829        MOVE CLIENT-EFF-DT       TO DC-GREG-DATE-CYMD
  4830        MOVE 'L'                 TO DC-OPTION-CODE
  4831        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4832        IF NO-CONVERSION-ERROR
  4833           MOVE DC-BIN-DATE-1    TO WS-BIN-EFF-DT
  4834        ELSE
  4835           MOVE 'BAD EFF DT CONVERT '
  4836                                 TO WS-COMMENT
  4837           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4838           PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4839           PERFORM 0020-SEND-BUFFER
  4840                                 THRU 0020-EXIT
  4841           PERFORM 0025-CLOSE-SOCKET
  4842                                 THRU 0025-EXIT
  4843           GO TO 0010-RETURN
  4844        END-IF
  4845     END-IF
  4846     PERFORM VARYING F1 FROM +1 BY +1 UNTIL
  4847        (F1 > +10)
  4848        OR (CLIENT-FIRST-NAME (F1:1) = SPACES OR LOW-VALUES)
  4849     END-PERFORM
  4850     IF F1 > +1
  4851        SUBTRACT +1 FROM F1
  4852     END-IF
  4853     PERFORM VARYING L1 FROM +1 BY +1 UNTIL
  4854        (L1 > +15)
  4855        OR (CLIENT-LAST-NAME (L1:1) = SPACES OR LOW-VALUES)
  4856     END-PERFORM
  4857     IF L1 > +1
  4858        SUBTRACT +1 FROM L1
  4859     END-IF
  4860     EVALUATE TRUE
  4861        WHEN WS-ELCERT-FULL
  4862           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4863           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4864           MOVE CLIENT-STATE        TO WS-CM-STATE
  4865           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4866           MOVE WS-BIN-EFF-DT       TO WS-CM-EFF-DT
  4867           MOVE CLIENT-CERT-NO (1:10)
  4868                                    TO WS-CM-CERT-NO
  4869
  4870* EXEC CICS READ
  4871*             INTO    (CERTIFICATE-MASTER)
  4872*             DATASET ('ELCERT')
  4873*             RIDFLD  (WS-CM-KEY)
  4874*             RESP    (WS-RESPONSE)
  4875*          END-EXEC
  4876     MOVE LENGTH OF
  4877      CERTIFICATE-MASTER
  4878       TO DFHEIV11
  4879     MOVE 'ELCERT' TO DFHEIV1
  4880*    MOVE '&"IL       E          (  N#00004777' TO DFHEIV0
  4881     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4882     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4883     MOVE X'204E233030303034373737' TO DFHEIV0(25:11)
  4884     CALL 'kxdfhei1' USING DFHEIV0,
  4885           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  86
* SOCK03.cbl
  4886           CERTIFICATE-MASTER,
  4887           DFHEIV11,
  4888           WS-CM-KEY,
  4889           DFHEIV99,
  4890           DFHEIV99,
  4891           DFHEIV99
  4892     MOVE EIBRESP  TO WS-RESPONSE
  4893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4894        WHEN WS-ELCERT-ACT-NAME
  4895           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4896           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4897           MOVE CLIENT-STATE        TO WS-CM-STATE
  4898           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4899           MOVE LOW-VALUES          TO WS-CM-EFF-DT
  4900           MOVE ZEROS               TO WS-CM-CERT-NO
  4901
  4902* EXEC CICS STARTBR
  4903*             DATASET ('ELCERT')
  4904*             RIDFLD  (WS-CM-KEY)
  4905*             RESP    (WS-RESPONSE)
  4906*          END-EXEC
  4907     MOVE 'ELCERT' TO DFHEIV1
  4908     MOVE 0
  4909       TO DFHEIV11
  4910*    MOVE '&,         G          &  N#00004790' TO DFHEIV0
  4911     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4912     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4913     MOVE X'204E233030303034373930' TO DFHEIV0(25:11)
  4914     CALL 'kxdfhei1' USING DFHEIV0,
  4915           DFHEIV1,
  4916           WS-CM-KEY,
  4917           DFHEIV99,
  4918           DFHEIV11,
  4919           DFHEIV99
  4920     MOVE EIBRESP  TO WS-RESPONSE
  4921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4922        WHEN WS-ELCERT-NAME
  4923           MOVE CLIENT-LAST-NAME TO WS-CM-LAST-NAME
  4924           MOVE SPACES           TO WS-CM-INITIALS
  4925           COMPUTE WS-LENGTH = L1 + +1
  4926
  4927* EXEC CICS STARTBR
  4928*             DATASET   ('ELCERT2')
  4929*             RIDFLD    (WS-CM-KEY-A1)
  4930*             GENERIC
  4931*             KEYLENGTH (WS-LENGTH)
  4932*             GTEQ
  4933*             RESP      (WS-RESPONSE)
  4934*          END-EXEC
  4935     MOVE 'ELCERT2' TO DFHEIV1
  4936     MOVE 0
  4937       TO DFHEIV11
  4938*    MOVE '&,   KG    G          &  N#00004799' TO DFHEIV0
  4939     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4940     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4941     MOVE X'204E233030303034373939' TO DFHEIV0(25:11)
  4942     CALL 'kxdfhei1' USING DFHEIV0,
  4943           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  87
* SOCK03.cbl
  4944           WS-CM-KEY-A1,
  4945           WS-LENGTH,
  4946           DFHEIV11,
  4947           DFHEIV99
  4948     MOVE EIBRESP  TO WS-RESPONSE
  4949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4950*          DISPLAY ' STARTBR RESP ' WS-RESPONSE
  4951*          DISPLAY ' KEY ' WS-CM-KEY-A1
  4952        WHEN WS-ELCERT-CERT-NO
  4953* DO NOT INCLUDE THE SUFFIX AS PART OF THE KEY
  4954           MOVE +11 TO WS-LENGTH
  4955           MOVE CLIENT-CERT-NO    TO WS-CM-CERT-NO-A4
  4956
  4957* EXEC CICS STARTBR
  4958*             DATASET   ('ELCERT5')
  4959*             RIDFLD    (WS-CM-KEY-A4)
  4960*             GENERIC
  4961*             KEYLENGTH (WS-LENGTH)
  4962*             GTEQ
  4963*             RESP      (WS-RESPONSE)
  4964*          END-EXEC
  4965     MOVE 'ELCERT5' TO DFHEIV1
  4966     MOVE 0
  4967       TO DFHEIV11
  4968*    MOVE '&,   KG    G          &  N#00004813' TO DFHEIV0
  4969     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4970     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4971     MOVE X'204E233030303034383133' TO DFHEIV0(25:11)
  4972     CALL 'kxdfhei1' USING DFHEIV0,
  4973           DFHEIV1,
  4974           WS-CM-KEY-A4,
  4975           WS-LENGTH,
  4976           DFHEIV11,
  4977           DFHEIV99
  4978     MOVE EIBRESP  TO WS-RESPONSE
  4979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4980        when ws-elcert-vin
  4981           move low-values       to ws-cs-key
  4982           move ws-comp-cd       to ws-cs-company-cd
  4983           move client-car       to ws-cs-carrier
  4984           move client-grp       to ws-cs-group
  4985           move client-state     to ws-cs-state
  4986           move client-account   to ws-cs-account
  4987
  4988* exec cics startbr
  4989*             dataset   ('ELCRTT')
  4990*             RIDFLD    (WS-CS-KEY)
  4991*             GTEQ
  4992*             RESP      (WS-RESPONSE)
  4993*          END-EXEC
  4994     MOVE 'ELCRTT' TO DFHEIV1
  4995     MOVE 0
  4996       TO DFHEIV11
  4997*    MOVE '&,         G          &  N#00004828' TO DFHEIV0
  4998     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4999     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5000     MOVE X'204E233030303034383238' TO DFHEIV0(25:11)
  5001     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  88
* SOCK03.cbl
  5002           DFHEIV1,
  5003           WS-CS-KEY,
  5004           DFHEIV99,
  5005           DFHEIV11,
  5006           DFHEIV99
  5007     MOVE EIBRESP  TO WS-RESPONSE
  5008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5009     END-EVALUATE
  5010     .
  5011 0100-EXIT.
  5012     EXIT.
  5013 0150-READ-NEXT-ELCERT.
  5014     EVALUATE TRUE
  5015        WHEN WS-ELCERT-ACT-NAME
  5016*          DISPLAY ' ABOUT TO READ NEXT - ACT NAME'
  5017
  5018* EXEC CICS READNEXT
  5019*             DATASET   ('ELCERT')
  5020*             RIDFLD    (WS-CM-KEY)
  5021*             INTO      (CERTIFICATE-MASTER)
  5022*             RESP      (WS-RESPONSE)
  5023*          END-EXEC
  5024     MOVE LENGTH OF
  5025      CERTIFICATE-MASTER
  5026       TO DFHEIV12
  5027     MOVE 'ELCERT' TO DFHEIV1
  5028     MOVE 0
  5029       TO DFHEIV11
  5030*    MOVE '&.IL                  )  N#00004842' TO DFHEIV0
  5031     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5032     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5033     MOVE X'204E233030303034383432' TO DFHEIV0(25:11)
  5034     CALL 'kxdfhei1' USING DFHEIV0,
  5035           DFHEIV1,
  5036           CERTIFICATE-MASTER,
  5037           DFHEIV12,
  5038           WS-CM-KEY,
  5039           DFHEIV99,
  5040           DFHEIV11,
  5041           DFHEIV99,
  5042           DFHEIV99
  5043     MOVE EIBRESP  TO WS-RESPONSE
  5044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5045        WHEN WS-ELCERT-NAME
  5046*          DISPLAY ' ABOUT TO READ NEXT - NAME'
  5047
  5048* EXEC CICS READNEXT
  5049*             DATASET   ('ELCERT2')
  5050*             RIDFLD    (WS-CM-KEY-A1)
  5051*             INTO      (CERTIFICATE-MASTER)
  5052*             RESP      (WS-RESPONSE)
  5053*          END-EXEC
  5054     MOVE LENGTH OF
  5055      CERTIFICATE-MASTER
  5056       TO DFHEIV12
  5057     MOVE 'ELCERT2' TO DFHEIV1
  5058     MOVE 0
  5059       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  89
* SOCK03.cbl
  5060*    MOVE '&.IL                  )  N#00004850' TO DFHEIV0
  5061     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5062     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5063     MOVE X'204E233030303034383530' TO DFHEIV0(25:11)
  5064     CALL 'kxdfhei1' USING DFHEIV0,
  5065           DFHEIV1,
  5066           CERTIFICATE-MASTER,
  5067           DFHEIV12,
  5068           WS-CM-KEY-A1,
  5069           DFHEIV99,
  5070           DFHEIV11,
  5071           DFHEIV99,
  5072           DFHEIV99
  5073     MOVE EIBRESP  TO WS-RESPONSE
  5074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5075        WHEN WS-ELCERT-CERT-NO
  5076
  5077* EXEC CICS READNEXT
  5078*             DATASET   ('ELCERT5')
  5079*             RIDFLD    (WS-CM-KEY-A4)
  5080*             INTO      (CERTIFICATE-MASTER)
  5081*             RESP      (WS-RESPONSE)
  5082*          END-EXEC
  5083     MOVE LENGTH OF
  5084      CERTIFICATE-MASTER
  5085       TO DFHEIV12
  5086     MOVE 'ELCERT5' TO DFHEIV1
  5087     MOVE 0
  5088       TO DFHEIV11
  5089*    MOVE '&.IL                  )  N#00004857' TO DFHEIV0
  5090     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5091     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5092     MOVE X'204E233030303034383537' TO DFHEIV0(25:11)
  5093     CALL 'kxdfhei1' USING DFHEIV0,
  5094           DFHEIV1,
  5095           CERTIFICATE-MASTER,
  5096           DFHEIV12,
  5097           WS-CM-KEY-A4,
  5098           DFHEIV99,
  5099           DFHEIV11,
  5100           DFHEIV99,
  5101           DFHEIV99
  5102     MOVE EIBRESP  TO WS-RESPONSE
  5103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5104        WHEN WS-ELCERT-VIN
  5105
  5106* EXEC CICS READNEXT
  5107*             DATASET   ('ELCRTT')
  5108*             RIDFLD    (WS-CS-KEY)
  5109*             INTO      (CERTIFICATE-TRAILERS)
  5110*             RESP      (WS-RESPONSE)
  5111*          END-EXEC
  5112     MOVE LENGTH OF
  5113      CERTIFICATE-TRAILERS
  5114       TO DFHEIV12
  5115     MOVE 'ELCRTT' TO DFHEIV1
  5116     MOVE 0
  5117       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  90
* SOCK03.cbl
  5118*    MOVE '&.IL                  )  N#00004864' TO DFHEIV0
  5119     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5120     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5121     MOVE X'204E233030303034383634' TO DFHEIV0(25:11)
  5122     CALL 'kxdfhei1' USING DFHEIV0,
  5123           DFHEIV1,
  5124           CERTIFICATE-TRAILERS,
  5125           DFHEIV12,
  5126           WS-CS-KEY,
  5127           DFHEIV99,
  5128           DFHEIV11,
  5129           DFHEIV99,
  5130           DFHEIV99
  5131     MOVE EIBRESP  TO WS-RESPONSE
  5132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5133     END-EVALUATE
  5134     .
  5135 0150-EXIT.
  5136     EXIT.
  5137 0200-BEGIN-REFUND-PROCESS.
  5138     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5139                                    WS-ERACCT-SW
  5140     MOVE ZEROS                  TO WS-NCB-DIFF-MONTHS
  5141                                    WS-NCB-DIFF-ODD-DAYS
  5142     INITIALIZE WS-STRING-DATA
  5143     IF RESP-NORMAL OR RESP-DUPKEY
  5144        EVALUATE TRUE
  5145           WHEN WS-ELCERT-ACT-NAME
  5146              EVALUATE TRUE
  5147                 WHEN (CM-COMPANY-CD NOT = WS-COMP-CD)
  5148                    OR (CM-CARRIER NOT = CLIENT-CAR)
  5149                    OR (CM-GROUPING NOT = CLIENT-GRP)
  5150                    OR (CM-STATE NOT = CLIENT-STATE)
  5151                    OR (CM-ACCOUNT NOT = CLIENT-ACCOUNT)
  5152                    SET ELCERT-FINISHED TO TRUE
  5153                 WHEN (CM-INSURED-LAST-NAME (1:L1) NOT =
  5154                    CLIENT-LAST-NAME (1:L1))
  5155                    GO TO 0200-CONTINUE
  5156                 WHEN ((CLIENT-EFF-DT NOT = SPACES)
  5157                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5158                    GO TO 0200-CONTINUE
  5159                 WHEN ((CLIENT-FIRST-NAME NOT = SPACES)
  5160                    AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5161                     CLIENT-FIRST-NAME (1:F1)))
  5162                    GO TO 0200-CONTINUE
  5163                 WHEN ((CLIENT-ACCOUNT NOT = SPACES)
  5164                    AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5165                    GO TO 0200-CONTINUE
  5166              END-EVALUATE
  5167           WHEN WS-ELCERT-CERT-NO
  5168              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5169                 OR (CM-CERT-PRIME NOT = CLIENT-CERT-NO (1:10))
  5170                 SET ELCERT-FINISHED TO TRUE
  5171              ELSE
  5172                 IF ((CLIENT-EFF-DT NOT = SPACES)
  5173                     AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5174                              OR
  5175                    ((CLIENT-LAST-NAME NOT = SPACES)
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  91
* SOCK03.cbl
  5176                     AND (CM-INSURED-LAST-NAME (1:L1) NOT =
  5177                        CLIENT-LAST-NAME (1:L1)))
  5178                              OR
  5179                    ((CLIENT-FIRST-NAME NOT = SPACES)
  5180                     AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5181                        CLIENT-FIRST-NAME (1:F1)))
  5182                              OR
  5183                    ((CLIENT-ACCOUNT NOT = SPACES)
  5184                     AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5185                     GO TO 0200-CONTINUE
  5186                 END-IF
  5187              END-IF
  5188           WHEN WS-ELCERT-NAME
  5189              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5190                 OR (CM-INSURED-LAST-NAME (1:L1) NOT =
  5191                    CLIENT-LAST-NAME (1:L1))
  5192                  SET ELCERT-FINISHED TO TRUE
  5193              ELSE
  5194                 IF ((CLIENT-EFF-DT NOT = SPACES)
  5195                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5196                           OR
  5197                 ((CLIENT-FIRST-NAME NOT = SPACES)
  5198                  AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5199                     CLIENT-FIRST-NAME (1:F1)))
  5200                           OR
  5201                 ((CLIENT-ACCOUNT NOT = SPACES)
  5202                  AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5203                  GO TO 0200-CONTINUE
  5204                 END-IF
  5205              END-IF
  5206           WHEN WS-ELCERT-VIN
  5207              evaluate true
  5208                 when (CS-COMPANY-CD NOT = WS-COMP-CD)
  5209                    OR (CS-STATE NOT = CLIENT-STATE)
  5210                    OR (CS-ACCOUNT NOT = CLIENT-ACCOUNT)
  5211                    SET ELCERT-FINISHED TO TRUE
  5212                 when (cs-trailer-type  = 'C')
  5213                    and (cs-vin-number = client-vin)
  5214                    continue
  5215                 when (cs-trailer-type  = 'C')
  5216                    and (cs-vin-number(10:8) = client-vin(1:8))
  5217                    continue
  5218                 when other
  5219                    go to 0200-continue
  5220              end-evaluate
  5221           WHEN OTHER
  5222              SET ELCERT-FINISHED   TO TRUE
  5223        END-EVALUATE
  5224     ELSE
  5225        SET ELCERT-FINISHED TO TRUE
  5226     END-IF
  5227     if ws-elcert-vin
  5228        move cs-control-primary(1:33)
  5229                                 to ws-cm-key
  5230
  5231* EXEC CICS READ
  5232*          INTO    (CERTIFICATE-MASTER)
  5233*          DATASET ('ELCERT')
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  92
* SOCK03.cbl
  5234*          RIDFLD  (WS-CM-KEY)
  5235*          RESP    (WS-RESPONSE)
  5236*       END-EXEC
  5237     MOVE LENGTH OF
  5238      CERTIFICATE-MASTER
  5239       TO DFHEIV11
  5240     MOVE 'ELCERT' TO DFHEIV1
  5241*    MOVE '&"IL       E          (  N#00004967' TO DFHEIV0
  5242     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5243     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5244     MOVE X'204E233030303034393637' TO DFHEIV0(25:11)
  5245     CALL 'kxdfhei1' USING DFHEIV0,
  5246           DFHEIV1,
  5247           CERTIFICATE-MASTER,
  5248           DFHEIV11,
  5249           WS-CM-KEY,
  5250           DFHEIV99,
  5251           DFHEIV99,
  5252           DFHEIV99
  5253     MOVE EIBRESP  TO WS-RESPONSE
  5254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5255        if not resp-normal
  5256           set elcert-finished to true
  5257        end-if
  5258     end-if
  5259*       IF WS-ELCERT-CERT-NO
  5260*          IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5261*             OR (CM-CERT-NO NOT = CLIENT-CERT-NO)
  5262*                          OR
  5263*                ((CLIENT-EFF-DT NOT = SPACES)
  5264*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5265*                          OR
  5266*                ((CLIENT-LAST-NAME NOT = SPACES)
  5267*                 AND (CM-INSURED-LAST-NAME NOT =
  5268*                    CLIENT-LAST-NAME))
  5269*                 SET ELCERT-FINISHED TO TRUE
  5270*          END-IF
  5271*          IF WS-ELCERT-NAME
  5272*             IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5273*                OR (CM-INSURED-LAST-NAME NOT =
  5274*                   CLIENT-LAST-NAME)
  5275*                            OR
  5276*                ((CLIENT-EFF-DT NOT = SPACES)
  5277*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5278*                 SET ELCERT-FINISHED TO TRUE
  5279*             END-IF
  5280*          ELSE
  5281*             SET ELCERT-FINISHED   TO TRUE
  5282*          END-IF
  5283     IF NOT WS-ELCERT-FULL
  5284        IF ELCERT-FINISHED
  5285           GO TO 0200-EXIT
  5286        END-IF
  5287     END-IF
  5288     IF CM-ENTRY-STATUS = 'M' OR '9' OR 'D' OR 'V' OR 'U'
  5289        MOVE 'CERT NOT ACTIVE '  TO WS-COMMENT
  5290        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5291        PERFORM 0030-BUILD-BUFFER
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  93
* SOCK03.cbl
  5292                                 THRU 0030-EXIT
  5293        PERFORM 0020-SEND-BUFFER
  5294                                 THRU 0020-EXIT
  5295        GO TO 0200-CONTINUE
  5296     END-IF
  5297     if (ws-epiq-request)
  5298        and (not EPIQ-CLASS)
  5299        go to 0200-continue
  5300     end-if
  5301
  5302     if ws-epiq-request
  5303        add +1 to ws-epiq-max
  5304        if ws-epiq-max > +100
  5305           go to 0200-continue
  5306        end-if
  5307     end-if
  5308     PERFORM 0300-GET-ELCNTL-RECORDS
  5309                                 THRU 0300-EXIT
  5310     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  5311     MOVE WS-BIN-VAL-DT          TO DC-BIN-DATE-2
  5312     MOVE +0                     TO DC-ELAPSED-MONTHS
  5313                                    DC-ELAPSED-DAYS
  5314     MOVE '1'                    TO DC-OPTION-CODE
  5315     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5316     IF NO-CONVERSION-ERROR
  5317        MOVE DC-ELAPSED-MONTHS   TO WS-NCB-DIFF-MONTHS
  5318        MOVE DC-ODD-DAYS-OVER    TO WS-NCB-DIFF-ODD-DAYS
  5319     END-IF
  5320     PERFORM 0400-PROCESS-LIFE   THRU 0400-EXIT
  5321     PERFORM 0500-PROCESS-AH     THRU 0500-EXIT
  5322     perform 0610-get-ermail     thru 0610-exit
  5323     perform 0620-get-elcrtt     thru 0620-exit
  5324     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  5325     IF NOT ALREADY-SENT
  5326        PERFORM 0020-SEND-BUFFER THRU 0020-EXIT
  5327     END-IF
  5328     .
  5329 0200-CONTINUE.
  5330     PERFORM 0150-READ-NEXT-ELCERT
  5331                                 THRU 0150-EXIT
  5332     .
  5333 0200-EXIT.
  5334     EXIT.
  5335 0300-GET-ELCNTL-RECORDS.
  5336     PERFORM 0310-GET-COMPANY    THRU 0310-EXIT
  5337     IF NOT RESP-NORMAL
  5338        MOVE ' COMPANY RECORD NOT FOUND '
  5339                                 TO WS-COMMENT
  5340        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5341        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5342        PERFORM 0020-SEND-BUFFER
  5343                                 THRU 0020-EXIT
  5344        PERFORM 0025-CLOSE-SOCKET
  5345                                 THRU 0025-EXIT
  5346        GO TO 0010-RETURN
  5347     END-IF
  5348     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  5349        PERFORM 0320-GET-LIFE-RECORD
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  94
* SOCK03.cbl
  5350                                 THRU 0320-EXIT
  5351        IF NOT RESP-NORMAL
  5352           MOVE ' LIFE BENEFIT RECORD NOT FOUND '
  5353                                 TO WS-COMMENT
  5354           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  5355           PERFORM 0030-BUILD-BUFFER
  5356                                 THRU 0030-EXIT
  5357           PERFORM 0020-SEND-BUFFER
  5358                                 THRU 0020-EXIT
  5359           PERFORM 0025-CLOSE-SOCKET
  5360                                 THRU 0025-EXIT
  5361           GO TO 0010-RETURN
  5362        END-IF
  5363     END-IF
  5364     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5365        PERFORM 0330-GET-AH-RECORD
  5366                                 THRU 0330-EXIT
  5367        IF NOT RESP-NORMAL
  5368           MOVE ' AH BENEFIT RECORD NOT FOUND '
  5369                                 TO WS-COMMENT
  5370           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  5371           PERFORM 0030-BUILD-BUFFER
  5372                                 THRU 0030-EXIT
  5373           PERFORM 0020-SEND-BUFFER
  5374                                 THRU 0020-EXIT
  5375           PERFORM 0025-CLOSE-SOCKET
  5376                                 THRU 0025-EXIT
  5377           GO TO 0010-RETURN
  5378        END-IF
  5379     END-IF
  5380     PERFORM 0340-GET-STATE-RECORD
  5381                                 THRU 0340-EXIT
  5382     IF NOT RESP-NORMAL
  5383        MOVE ' STATE RECORD NOT FOUND '
  5384                                 TO WS-COMMENT
  5385        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5386        PERFORM 0030-BUILD-BUFFER
  5387                                 THRU 0030-EXIT
  5388        PERFORM 0020-SEND-BUFFER
  5389                                 THRU 0020-EXIT
  5390        PERFORM 0025-CLOSE-SOCKET
  5391                                 THRU 0025-EXIT
  5392        GO TO 0010-RETURN
  5393     END-IF
  5394     PERFORM 0350-GET-ERACCT     THRU 0350-EXIT
  5395     IF NOT ERACCT-FOUND
  5396        MOVE ' ACCOUNT NOT FOUND '
  5397                                 TO WS-COMMENT
  5398        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5399        PERFORM 0030-BUILD-BUFFER
  5400                                 THRU 0030-EXIT
  5401        PERFORM 0020-SEND-BUFFER
  5402                                 THRU 0020-EXIT
  5403        PERFORM 0025-CLOSE-SOCKET
  5404                                 THRU 0025-EXIT
  5405        GO TO 0010-RETURN
  5406     ELSE
  5407        MOVE AM-NAME             TO WS-ACCOUNT-NAME
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  95
* SOCK03.cbl
  5408        MOVE AM-REPORT-CODE-1    TO WS-REPORT-CODE-1
  5409        MOVE AM-REPORT-CODE-2    TO WS-REPORT-CODE-2
  5410        MOVE AM-REPORT-CODE-3    TO WS-REPORT-CODE-3
  5411     END-IF
  5412     .
  5413 0300-EXIT.
  5414     EXIT.
  5415 0310-GET-COMPANY.
  5416     MOVE WS-COMP-ID             TO  WS-CF-COMPANY-ID
  5417     MOVE '1'                    TO  WS-CF-RECORD-TYPE
  5418     MOVE SPACES                 TO  WS-CF-ACCESS
  5419     MOVE +0                     TO  WS-CF-SEQUENCE-NO
  5420
  5421* EXEC CICS READ
  5422*       INTO    (CONTROL-FILE)
  5423*       DATASET ('ELCNTL')
  5424*       RIDFLD  (WS-CF-KEY)
  5425*       RESP    (WS-RESPONSE)
  5426*    END-EXEC
  5427     MOVE LENGTH OF
  5428      CONTROL-FILE
  5429       TO DFHEIV11
  5430     MOVE 'ELCNTL' TO DFHEIV1
  5431*    MOVE '&"IL       E          (  N#00005138' TO DFHEIV0
  5432     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5433     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5434     MOVE X'204E233030303035313338' TO DFHEIV0(25:11)
  5435     CALL 'kxdfhei1' USING DFHEIV0,
  5436           DFHEIV1,
  5437           CONTROL-FILE,
  5438           DFHEIV11,
  5439           WS-CF-KEY,
  5440           DFHEIV99,
  5441           DFHEIV99,
  5442           DFHEIV99
  5443     MOVE EIBRESP  TO WS-RESPONSE
  5444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5445     IF (RESP-NORMAL)
  5446        AND (CF-COMPANY-ID = WS-COMP-ID)
  5447        AND (CF-RECORD-TYPE = '1')
  5448        MOVE CF-CR-REM-TERM-CALC TO WS-CF-CR-REM-TERM-CALC
  5449        MOVE CF-CR-R78-METHOD    TO WS-CF-CR-R78-METHOD
  5450        MOVE CF-LIFE-OVERRIDE-L1 TO WS-LF-OVERRIDE-L1
  5451        MOVE CF-AH-OVERRIDE-L1   TO WS-AH-OVERRIDE-L1
  5452        IF CF-DEFAULT-APR NUMERIC
  5453           MOVE CF-DEFAULT-APR   TO WS-CF-DEFAULT-APR
  5454        ELSE
  5455           MOVE ZEROS            TO WS-CF-DEFAULT-APR
  5456        END-IF
  5457        IF CF-VALID-REM-TRM-OPTION
  5458           MOVE CF-REM-TRM-CALC-OPTION
  5459                                 TO WS-CF-REM-TRM-CALC-OPTION
  5460        ELSE
  5461           MOVE SPACES           TO WS-CF-REM-TRM-CALC-OPTION
  5462        END-IF
  5463     END-IF
  5464     .
  5465 0310-EXIT.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  96
* SOCK03.cbl
  5466     EXIT.
  5467 0320-GET-LIFE-RECORD.
  5468     MOVE '4'                    TO WS-CF-RECORD-TYPE
  5469     MOVE CM-LF-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5470                                    WS-LF-BEN-CODE
  5471     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5472
  5473* EXEC CICS READ
  5474*       INTO    (CONTROL-FILE)
  5475*       DATASET ('ELCNTL')
  5476*       RIDFLD  (WS-CF-KEY)
  5477*       GTEQ
  5478*       RESP    (WS-RESPONSE)
  5479*    END-EXEC
  5480     MOVE LENGTH OF
  5481      CONTROL-FILE
  5482       TO DFHEIV11
  5483     MOVE 'ELCNTL' TO DFHEIV1
  5484*    MOVE '&"IL       G          (  N#00005171' TO DFHEIV0
  5485     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5486     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5487     MOVE X'204E233030303035313731' TO DFHEIV0(25:11)
  5488     CALL 'kxdfhei1' USING DFHEIV0,
  5489           DFHEIV1,
  5490           CONTROL-FILE,
  5491           DFHEIV11,
  5492           WS-CF-KEY,
  5493           DFHEIV99,
  5494           DFHEIV99,
  5495           DFHEIV99
  5496     MOVE EIBRESP  TO WS-RESPONSE
  5497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5498     IF RESP-NORMAL
  5499        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5500        AND (CF-RECORD-TYPE = '4')
  5501        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5502           (S1 > +8)
  5503           OR (CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5504        END-PERFORM
  5505        IF S1 > +8
  5506           CONTINUE
  5507        ELSE
  5508           MOVE CF-BENEFIT-DESCRIP (S1)
  5509                                 TO WS-LF-BEN-CODE-DESC
  5510           MOVE CF-LF-COVERAGE-TYPE (S1)
  5511                                 TO WS-CF-LF-COVERAGE-TYPE
  5512           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5513              MOVE 'S'           TO WS-LF-COVERAGE-TYPE
  5514           ELSE
  5515              MOVE 'J'           TO WS-LF-COVERAGE-TYPE
  5516           END-IF
  5517           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5518               MOVE CF-CO-REM-TERM-CALC (S1)
  5519                                 TO WS-LF-CO-REM-TERM-CALC
  5520           END-IF
  5521           IF CF-CO-EARNINGS-CALC (S1)  > ' '
  5522               MOVE CF-CO-EARNINGS-CALC (S1)
  5523                                 TO WS-LF-CO-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  97
* SOCK03.cbl
  5524                                    WS-LF-CO-REFUND-CALC
  5525           END-IF
  5526           IF CF-SPECIAL-CALC-CD (S1) > ' '
  5527               MOVE CF-SPECIAL-CALC-CD (S1)
  5528                                 TO WS-LF-SPECIAL-CALC-CD
  5529           END-IF
  5530           IF CF-CO-REFUND-CALC (S1) > '0'
  5531               MOVE CF-CO-REFUND-CALC (S1)
  5532                                 TO WS-LF-CO-REFUND-CALC
  5533        END-IF
  5534     END-IF
  5535     .
  5536 0320-EXIT.
  5537     EXIT.
  5538 0330-GET-AH-RECORD.
  5539     MOVE '5'                    TO WS-CF-RECORD-TYPE
  5540     MOVE CM-AH-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5541     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5542
  5543* EXEC CICS READ
  5544*       INTO    (CONTROL-FILE)
  5545*       DATASET ('ELCNTL')
  5546*       RIDFLD  (WS-CF-KEY)
  5547*       GTEQ
  5548*       RESP    (WS-RESPONSE)
  5549*    END-EXEC
  5550     MOVE LENGTH OF
  5551      CONTROL-FILE
  5552       TO DFHEIV11
  5553     MOVE 'ELCNTL' TO DFHEIV1
  5554*    MOVE '&"IL       G          (  N#00005222' TO DFHEIV0
  5555     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5556     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5557     MOVE X'204E233030303035323232' TO DFHEIV0(25:11)
  5558     CALL 'kxdfhei1' USING DFHEIV0,
  5559           DFHEIV1,
  5560           CONTROL-FILE,
  5561           DFHEIV11,
  5562           WS-CF-KEY,
  5563           DFHEIV99,
  5564           DFHEIV99,
  5565           DFHEIV99
  5566     MOVE EIBRESP  TO WS-RESPONSE
  5567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5568     IF RESP-NORMAL
  5569        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5570        AND (CF-RECORD-TYPE = '5')
  5571        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5572           (S1 > +8)
  5573           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5574        END-PERFORM
  5575        IF S1 > +8
  5576           CONTINUE
  5577        ELSE
  5578           MOVE CF-BENEFIT-DESCRIP (S1)
  5579                                 TO WS-AH-BEN-CODE-DESC
  5580           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5581              MOVE 'S'           TO WS-AH-COVERAGE-TYPE
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  98
* SOCK03.cbl
  5582           ELSE
  5583              MOVE 'J'           TO WS-AH-COVERAGE-TYPE
  5584           END-IF
  5585           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5586              MOVE CF-CO-REM-TERM-CALC (S1)
  5587                                 TO WS-AH-CO-REM-TERM-CALC
  5588           END-IF
  5589           IF CF-CO-EARNINGS-CALC (S1) > ' '
  5590              MOVE CF-CO-EARNINGS-CALC (S1)
  5591                                 TO WS-AH-CO-EARNINGS-CALC
  5592                                    WS-AH-CO-REFUND-CALC
  5593           END-IF
  5594           IF CF-SPECIAL-CALC-CD (S1) >  ' '
  5595              MOVE CF-SPECIAL-CALC-CD (S1)
  5596                                 TO WS-AH-SPECIAL-CALC-CD
  5597           END-IF
  5598           IF CF-CO-REFUND-CALC (S1) > '0'
  5599              MOVE CF-CO-REFUND-CALC (S1)
  5600                                 TO WS-AH-CO-REFUND-CALC
  5601           END-IF
  5602           IF CF-BENEFIT-CATEGORY (S1) > ' '
  5603              MOVE CF-BENEFIT-CATEGORY (S1)
  5604                                 TO WS-AH-BEN-CATEGORY
  5605           END-IF
  5606        END-IF
  5607     END-IF
  5608     .
  5609 0330-EXIT.
  5610     EXIT.
  5611 0340-GET-STATE-RECORD.
  5612     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  5613     MOVE '3'                    TO WS-CF-RECORD-TYPE
  5614     MOVE CM-STATE               TO WS-CF-ACCESS
  5615     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5616
  5617* EXEC CICS READ
  5618*       INTO    (CONTROL-FILE)
  5619*       DATASET ('ELCNTL')
  5620*       RIDFLD  (WS-CF-KEY)
  5621*       RESP    (WS-RESPONSE)
  5622*    END-EXEC
  5623     MOVE LENGTH OF
  5624      CONTROL-FILE
  5625       TO DFHEIV11
  5626     MOVE 'ELCNTL' TO DFHEIV1
  5627*    MOVE '&"IL       E          (  N#00005277' TO DFHEIV0
  5628     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5629     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5630     MOVE X'204E233030303035323737' TO DFHEIV0(25:11)
  5631     CALL 'kxdfhei1' USING DFHEIV0,
  5632           DFHEIV1,
  5633           CONTROL-FILE,
  5634           DFHEIV11,
  5635           WS-CF-KEY,
  5636           DFHEIV99,
  5637           DFHEIV99,
  5638           DFHEIV99
  5639     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page  99
* SOCK03.cbl
  5640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5641     IF (RESP-NORMAL)
  5642        AND (CF-COMPANY-ID = WS-COMP-ID)
  5643        AND (CF-RECORD-TYPE = '3')
  5644        AND (CF-STATE-CODE = CM-STATE)
  5645        MOVE CF-ST-FREE-LOOK-PERIOD
  5646                                 TO WS-FREE-LOOK
  5647        MOVE CF-STATE-ABBREVIATION
  5648                                 TO WS-STATE-ABBREVIATION
  5649        MOVE CF-ST-FST-PMT-DAYS-CHG
  5650                                 TO  WS-STATE-EXT-DAYS-CHG
  5651        IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  5652           MOVE '0'              TO WS-LF-ST-REM-TERM-CALC
  5653           IF CF-ST-RT-CALC NOT = SPACES
  5654              MOVE CF-ST-RT-CALC TO WS-LF-ST-REM-TERM-CALC
  5655           END-IF
  5656           IF WS-CF-LF-COVERAGE-TYPE = 'R'
  5657              IF CF-ST-RF-LR-CALC > '0'
  5658                 MOVE CF-ST-RF-LR-CALC
  5659                                 TO WS-LF-ST-REFUND-CALC
  5660              END-IF
  5661              IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  5662                 IF CF-ST-RF-LN-CALC > '0'
  5663                    MOVE CF-ST-RF-LN-CALC
  5664                                 TO WS-LF-ST-REFUND-CALC
  5665                 END-IF
  5666              END-IF
  5667           ELSE
  5668              IF CF-ST-RF-LL-CALC > '0'
  5669                 MOVE CF-ST-RF-LL-CALC
  5670                                 TO WS-LF-ST-REFUND-CALC
  5671              END-IF
  5672           END-IF
  5673           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5674              (S1 > 50)
  5675              OR ((WS-LF-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5676                 AND (CF-ST-BENEFIT-CD (S1) = CM-LF-BENEFIT-CD))
  5677           END-PERFORM
  5678           IF S1 < +51
  5679              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5680                 MOVE CF-ST-REM-TERM-CALC (S1)
  5681                                 TO WS-LF-ST-REM-TERM-CALC
  5682              END-IF
  5683              IF CF-ST-REFUND-CALC (S1) > '0'
  5684                 MOVE CF-ST-REFUND-CALC (S1)
  5685                                 TO WS-LF-ST-REFUND-CALC
  5686              END-IF
  5687           END-IF
  5688        END-IF
  5689        IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  5690           MOVE '0'              TO WS-AH-ST-REM-TERM-CALC
  5691           IF CF-ST-RT-CALC NOT = SPACES
  5692              MOVE CF-ST-RT-CALC TO WS-AH-ST-REM-TERM-CALC
  5693           END-IF
  5694           IF CF-ST-RF-AH-CALC > '0'
  5695              MOVE CF-ST-RF-AH-CALC
  5696                                 TO WS-AH-ST-REFUND-CALC
  5697           END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 100
* SOCK03.cbl
  5698           IF WS-AH-SPECIAL-CALC-CD = 'C'
  5699              IF CF-ST-RF-CP-CALC > '0'
  5700                 MOVE CF-ST-RF-CP-CALC
  5701                                 TO WS-AH-ST-REFUND-CALC
  5702              END-IF
  5703           END-IF
  5704           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5705              (S1 > 50)
  5706              OR ((WS-AH-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5707                 AND (CF-ST-BENEFIT-CD (S1) = CM-AH-BENEFIT-CD))
  5708           END-PERFORM
  5709           IF S1 < +51
  5710              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5711                 MOVE CF-ST-REM-TERM-CALC (S1)
  5712                                 TO WS-AH-ST-REM-TERM-CALC
  5713              END-IF
  5714              IF CF-ST-REFUND-CALC (S1) > '0'
  5715                 MOVE CF-ST-REFUND-CALC (S1)
  5716                                 TO WS-AH-ST-REFUND-CALC
  5717              END-IF
  5718           END-IF
  5719        END-IF
  5720     END-IF
  5721     .
  5722 0340-EXIT.
  5723     EXIT.
  5724 0350-GET-ERACCT.
  5725     MOVE '0'                    TO WS-AM-EARN-METHOD-L
  5726                                    WS-AM-EARN-METHOD-R
  5727                                    WS-AM-EARN-METHOD-A
  5728                                    WS-LF-AM-REM-TERM-CALC
  5729                                    WS-AH-AM-REM-TERM-CALC
  5730     MOVE CM-COMPANY-CD          TO WS-AM-COMPANY-CD
  5731     MOVE CM-CARRIER             TO WS-AM-CARRIER
  5732     MOVE CM-GROUPING            TO WS-AM-GROUPING
  5733     MOVE CM-STATE               TO WS-AM-STATE
  5734     MOVE CM-ACCOUNT             TO WS-AM-ACCOUNT
  5735     MOVE CM-CERT-EFF-DT         TO WS-AM-EXPIRATION-DT
  5736     MOVE LOW-VALUES             TO WS-AM-FILLER
  5737     MOVE ' '                    TO WS-STOP-SW
  5738
  5739* EXEC CICS STARTBR
  5740*       DATASET  ('ERACCT')
  5741*       RIDFLD   (WS-AM-KEY)
  5742*       GTEQ
  5743*       RESP (WS-RESPONSE)
  5744*    END-EXEC
  5745     MOVE 'ERACCT' TO DFHEIV1
  5746     MOVE 0
  5747       TO DFHEIV11
  5748*    MOVE '&,         G          &  N#00005380' TO DFHEIV0
  5749     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5750     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5751     MOVE X'204E233030303035333830' TO DFHEIV0(25:11)
  5752     CALL 'kxdfhei1' USING DFHEIV0,
  5753           DFHEIV1,
  5754           WS-AM-KEY,
  5755           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 101
* SOCK03.cbl
  5756           DFHEIV11,
  5757           DFHEIV99
  5758     MOVE EIBRESP  TO WS-RESPONSE
  5759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5760     IF RESP-NORMAL
  5761        PERFORM UNTIL TOLD-TO-STOP
  5762
  5763* EXEC CICS READNEXT
  5764*             DATASET  ('ERACCT')
  5765*             INTO     (ACCOUNT-MASTER)
  5766*             RIDFLD   (WS-AM-KEY)
  5767*          END-EXEC
  5768     MOVE LENGTH OF
  5769      ACCOUNT-MASTER
  5770       TO DFHEIV12
  5771     MOVE 'ERACCT' TO DFHEIV1
  5772     MOVE 0
  5773       TO DFHEIV11
  5774*    MOVE '&.IL                  )   #00005388' TO DFHEIV0
  5775     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5776     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5777     MOVE X'2020233030303035333838' TO DFHEIV0(25:11)
  5778     CALL 'kxdfhei1' USING DFHEIV0,
  5779           DFHEIV1,
  5780           ACCOUNT-MASTER,
  5781           DFHEIV12,
  5782           WS-AM-KEY,
  5783           DFHEIV99,
  5784           DFHEIV11,
  5785           DFHEIV99,
  5786           DFHEIV99
  5787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5788           IF RESP-NORMAL
  5789              EVALUATE TRUE
  5790                 WHEN AM-CONTROL-PRIMARY (1:20) NOT =
  5791                    CM-CONTROL-PRIMARY (1:20)
  5792                    SET TOLD-TO-STOP TO TRUE
  5793                 WHEN (AM-CONTROL-PRIMARY (1:20) =
  5794                    CM-CONTROL-PRIMARY (1:20))
  5795                    AND (CM-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5796                    AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5797                    SET ERACCT-FOUND      TO TRUE
  5798                    SET TOLD-TO-STOP TO TRUE
  5799              END-EVALUATE
  5800           ELSE
  5801              SET TOLD-TO-STOP TO TRUE
  5802           END-IF
  5803        END-PERFORM
  5804
  5805* EXEC CICS ENDBR
  5806*          DATASET   ('ERACCT')
  5807*       END-EXEC
  5808     MOVE 'ERACCT' TO DFHEIV1
  5809     MOVE 0
  5810       TO DFHEIV11
  5811*    MOVE '&2                    $   #00005409' TO DFHEIV0
  5812     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5813     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 102
* SOCK03.cbl
  5814     MOVE X'2020233030303035343039' TO DFHEIV0(25:11)
  5815     CALL 'kxdfhei1' USING DFHEIV0,
  5816           DFHEIV1,
  5817           DFHEIV11,
  5818           DFHEIV99
  5819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5820     END-IF
  5821     .
  5822 0350-EXIT.
  5823     EXIT.
  5824 0400-PROCESS-LIFE.
  5825     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5826     MOVE CM-INSURED-LAST-NAME   TO WS-LAST-NAME
  5827     MOVE CM-INSURED-FIRST-NAME  TO WS-FIRST-NAME
  5828     MOVE CM-INSURED-INITIAL2    TO WS-MID-INIT
  5829     MOVE CM-JT-LAST-NAME        TO WS-LAST-JNAME
  5830     MOVE CM-JT-FIRST-NAME       TO WS-FIRST-JNAME
  5831     MOVE CM-JT-INITIAL          TO WS-MID-JINIT
  5832     MOVE CM-POST-CARD-IND       TO WS-POST-CARD-SW
  5833     MOVE CM-CARRIER             TO WS-CARRIER
  5834     MOVE CM-GROUPING            TO WS-GROUPING
  5835     MOVE CM-STATE               TO WS-STATE
  5836     MOVE CM-ACCOUNT             TO WS-ACCOUNT
  5837     MOVE CM-CERT-NO             TO WS-CERT-NO
  5838     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5839     MOVE ' '                    TO  DC-OPTION-CODE.
  5840     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5841     IF NO-CONVERSION-ERROR
  5842        MOVE DC-GREG-DATE-CYMD   TO WS-CERT-EFF-DATE
  5843     ELSE
  5844        MOVE 99999999            TO WS-CERT-EFF-DATE
  5845     END-IF
  5846     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  5847        GO TO 0400-EXIT
  5848     END-IF
  5849     MOVE ZEROS                  TO WS-TOT-LF-RFND
  5850                                    WS-TOT-LF-PREM
  5851                                    WS-TOT-LF-COMM
  5852                                    WS-LF-CANCEL-DATE
  5853     MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5854     MOVE ' '                    TO  DC-OPTION-CODE
  5855     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5856     IF NO-CONVERSION-ERROR
  5857        MOVE DC-GREG-DATE-CYMD   TO WS-LF-EXPIRE-DATE
  5858     ELSE
  5859        MOVE ZEROS               TO WS-LF-EXPIRE-DATE
  5860     END-IF
  5861     IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5862        MOVE CM-LF-DEATH-DT      TO DC-BIN-DATE-1
  5863        MOVE ' '                 TO DC-OPTION-CODE
  5864
  5865        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5866        IF NO-CONVERSION-ERROR
  5867           MOVE DC-GREG-DATE-CYMD
  5868                                 TO WS-LF-CANCEL-DATE
  5869        ELSE
  5870           MOVE ZEROS            TO WS-LF-CANCEL-DATE
  5871        END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 103
* SOCK03.cbl
  5872     END-IF
  5873     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  5874        MOVE CM-LF-CANCEL-DT     TO DC-BIN-DATE-1
  5875        MOVE ' '                 TO DC-OPTION-CODE
  5876
  5877        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5878        IF NO-CONVERSION-ERROR
  5879           MOVE DC-GREG-DATE-CYMD
  5880                                 TO WS-LF-CANCEL-DATE
  5881        ELSE
  5882           MOVE ZEROS            TO WS-LF-CANCEL-DATE
  5883        END-IF
  5884     END-IF
  5885     MOVE WS-LF-OVERRIDE-L1      TO CP-LIFE-OVERRIDE-CODE
  5886     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
  5887     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE
  5888     MOVE WS-BIN-VAL-DT          TO CP-VALUATION-DT
  5889     MOVE CM-STATE               TO CP-STATE
  5890     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV
  5891     MOVE WS-CF-LF-COVERAGE-TYPE TO CP-BENEFIT-TYPE
  5892     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD
  5893     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
  5894     MOVE CM-LOAN-APR            TO CP-LOAN-APR
  5895     MOVE '2'                    TO CP-PROCESS-TYPE
  5896     MOVE WS-COMP-ID             TO CP-COMPANY-ID
  5897     MOVE CM-COMPANY-CD          TO CP-COMPANY-CD
  5898     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5
  5899     MOVE WS-CF-REM-TRM-CALC-OPTION
  5900                                 TO CP-REM-TRM-CALC-OPTION
  5901     MOVE WS-CF-CR-REM-TERM-CALC TO CP-REM-TERM-METHOD
  5902     IF WS-LF-CO-REM-TERM-CALC > '0'
  5903        MOVE WS-LF-CO-REM-TERM-CALC
  5904                                 TO CP-REM-TERM-METHOD
  5905     END-IF
  5906     IF WS-LF-ST-REM-TERM-CALC > '0'
  5907         MOVE WS-LF-ST-REM-TERM-CALC
  5908                                 TO  CP-REM-TERM-METHOD.
  5909     IF WS-LF-AM-REM-TERM-CALC > '0'
  5910         MOVE WS-LF-AM-REM-TERM-CALC
  5911                                 TO  CP-REM-TERM-METHOD.
  5912     IF (WS-COMP-ID = 'CID')
  5913        AND (CP-STATE-STD-ABBRV = 'WI')
  5914        MOVE '7'                 TO CP-REM-TERM-METHOD
  5915        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5916     END-IF
  5917     IF (WS-COMP-ID = 'CID')
  5918        AND (CP-STATE-STD-ABBRV = 'MO')
  5919        AND (CM-CERT-EFF-DT >= X'9B41')
  5920        AND (CM-CERT-EFF-DT <= X'A2FB')
  5921        MOVE '7'                 TO CP-REM-TERM-METHOD
  5922        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5923     END-IF
  5924     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
  5925                                    CP-LOAN-TERM
  5926                                    WS-LF-TERM
  5927     IF CP-TRUNCATED-LIFE
  5928         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  5929     IF CP-TERM-IS-DAYS
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 104
* SOCK03.cbl
  5930        IF CM-LF-TERM-IN-DAYS NUMERIC
  5931           MOVE CM-LF-TERM-IN-DAYS
  5932                                 TO CP-TERM-OR-EXT-DAYS
  5933        ELSE
  5934           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5935        END-IF
  5936     ELSE
  5937        IF CM-PMT-EXTENSION-DAYS NUMERIC
  5938           MOVE CM-PMT-EXTENSION-DAYS
  5939                                 TO CP-TERM-OR-EXT-DAYS
  5940        ELSE
  5941           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5942        END-IF
  5943     END-IF
  5944     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5945     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5946        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5947        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  5948     END-IF
  5949     DISPLAY ' STARTING OPEN LIFE CLAIM TEST '
  5950     MOVE LOW-VALUES             TO WS-LF-BIN-PAID-THRU-DT
  5951     MOVE ' '                    TO WS-CLM-STOP-SW
  5952     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5953     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5954
  5955* EXEC CICS STARTBR
  5956*       DATASET     ('ELMSTR5')
  5957*       RIDFLD      (ELMSTR-KEY)
  5958*       RESP        (WS-RESPONSE)
  5959*    END-EXEC
  5960     MOVE 'ELMSTR5' TO DFHEIV1
  5961     MOVE 0
  5962       TO DFHEIV11
  5963*    MOVE '&,         G          &  N#00005546' TO DFHEIV0
  5964     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5965     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5966     MOVE X'204E233030303035353436' TO DFHEIV0(25:11)
  5967     CALL 'kxdfhei1' USING DFHEIV0,
  5968           DFHEIV1,
  5969           ELMSTR-KEY,
  5970           DFHEIV99,
  5971           DFHEIV11,
  5972           DFHEIV99
  5973     MOVE EIBRESP  TO WS-RESPONSE
  5974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5975     DISPLAY ' AFTER START ' WS-RESPONSE
  5976     IF RESP-NORMAL
  5977        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5978
  5979* EXEC CICS READNEXT
  5980*             DATASET   ('ELMSTR5')
  5981*             RIDFLD    (ELMSTR-KEY)
  5982*             INTO      (CLAIM-MASTER)
  5983*             RESP      (WS-RESPONSE)
  5984*          END-EXEC
  5985     MOVE LENGTH OF
  5986      CLAIM-MASTER
  5987       TO DFHEIV12
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 105
* SOCK03.cbl
  5988     MOVE 'ELMSTR5' TO DFHEIV1
  5989     MOVE 0
  5990       TO DFHEIV11
  5991*    MOVE '&.IL                  )  N#00005554' TO DFHEIV0
  5992     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5993     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5994     MOVE X'204E233030303035353534' TO DFHEIV0(25:11)
  5995     CALL 'kxdfhei1' USING DFHEIV0,
  5996           DFHEIV1,
  5997           CLAIM-MASTER,
  5998           DFHEIV12,
  5999           ELMSTR-KEY,
  6000           DFHEIV99,
  6001           DFHEIV11,
  6002           DFHEIV99,
  6003           DFHEIV99
  6004     MOVE EIBRESP  TO WS-RESPONSE
  6005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6006        IF (RESP-NORMAL OR RESP-DUPKEY)
  6007           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6008           AND (CM-CERT-NO = CL-CERT-NO)
  6009           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6010              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6011              IF CL-CLAIM-TYPE = 'L' OR 'O'
  6012                 IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  6013                    MOVE 'D'     TO WS-AH-STATUS
  6014                 END-IF
  6015                 IF CLAIM-IS-OPEN
  6016                    MOVE ' OPEN LIFE CLAIM '
  6017                                 TO WS-COMMENT
  6018                    MOVE 'L'     TO WS-LF-STATUS
  6019                    GO TO 0400-EXIT
  6020                 ELSE
  6021                    MOVE ' DEATH CLAIM APPLIED '
  6022                                 TO WS-COMMENT
  6023                    MOVE 'D'     TO WS-LF-STATUS
  6024*                   IF CL-PAID-THRU-DT > WS-LF-BIN-PAID-THRU-DT
  6025*                      MOVE CL-PAID-THRU-DT
  6026*                                TO WS-LF-BIN-PAID-THRU-DT
  6027*                   END-IF
  6028                 END-IF
  6029              END-IF
  6030           END-IF
  6031        ELSE
  6032           SET I-SAY-TO-STOP TO TRUE
  6033        END-IF
  6034        END-PERFORM
  6035
  6036* EXEC CICS ENDBR
  6037*          DATASET   ('ELMSTR5')
  6038*       END-EXEC
  6039     MOVE 'ELMSTR5' TO DFHEIV1
  6040     MOVE 0
  6041       TO DFHEIV11
  6042*    MOVE '&2                    $   #00005589' TO DFHEIV0
  6043     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6044     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6045     MOVE X'2020233030303035353839' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 106
* SOCK03.cbl
  6046     CALL 'kxdfhei1' USING DFHEIV0,
  6047           DFHEIV1,
  6048           DFHEIV11,
  6049           DFHEIV99
  6050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6051     END-IF
  6052     IF WS-LF-BIN-PAID-THRU-DT NOT = LOW-VALUES
  6053*       THIS WILL BE TRUE IF WE FOUND A CLOSED LIFE CLAIM
  6054        MOVE WS-LF-BIN-PAID-THRU-DT
  6055                                 TO DC-BIN-DATE-1
  6056        MOVE ' '                 TO DC-OPTION-CODE
  6057        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6058        IF NO-CONVERSION-ERROR
  6059           MOVE DC-GREG-DATE-CYMD
  6060                                 TO WS-CLM-PAID-THRU-DT
  6061        ELSE
  6062           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  6063        END-IF
  6064*       IF WS-BIN-VAL-DT <= WS-LF-BIN-PAID-THRU-DT
  6065*          MOVE 'CAN DT =< CLM PD THRU DT'
  6066*                                TO WS-COMMENT
  6067*          MOVE 'P'              TO WS-LF-STATUS
  6068*          GO TO 0400-EXIT
  6069*       END-IF
  6070        GO TO 0400-EXIT
  6071     END-IF
  6072     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  6073     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6074        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6075        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  6076        COMPUTE CP-REMAINING-TERM-1 =
  6077                CP-REMAINING-TERM-1 - +1
  6078        COMPUTE CP-REMAINING-TERM-2 =
  6079                CP-REMAINING-TERM-2 - +1
  6080     END-IF
  6081     IF CP-REMAINING-TERM-1 NEGATIVE
  6082        MOVE ZEROS               TO CP-REMAINING-TERM-1
  6083     END-IF
  6084     IF CP-REMAINING-TERM-2 NEGATIVE
  6085        MOVE ZEROS               TO CP-REMAINING-TERM-2
  6086     END-IF
  6087     IF CM-LIFE-COMM-PCT NOT NUMERIC
  6088        MOVE ZERO                TO CM-LIFE-COMM-PCT
  6089     END-IF
  6090     IF CM-LIFE-COMM-PCT > ZEROS
  6091        COMPUTE WS-TOT-LF-COMM = CM-LIFE-COMM-PCT *
  6092           (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT)
  6093     END-IF
  6094     MOVE WS-TOT-LF-COMM         TO WS-LF-COMM
  6095     MOVE CP-REMAINING-TERM-1    TO WS-LF-REM-TERM
  6096     IF CM-LF-CURRENT-STATUS = '8'
  6097        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  6098           MOVE ' LIFE COVERAGE PREVIOUSLY CANCELLED '
  6099                                 TO WS-COMMENT
  6100           MOVE 'C'              TO WS-LF-STATUS
  6101           move cm-lf-itd-cancel-amt
  6102                                 to ws-lf-refund
  6103*          PERFORM 0030-BUILD-BUFFER
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 107
* SOCK03.cbl
  6104*                                THRU 0030-EXIT
  6105*          PERFORM 0020-SEND-BUFFER
  6106*                                THRU 0020-EXIT
  6107*          SET ALREADY-SENT      TO TRUE
  6108*          MOVE SPACES           TO WS-COMMENT
  6109           GO TO 0400-EXIT
  6110*          PERFORM 0025-CLOSE-SOCKET
  6111*                                THRU 0025-EXIT
  6112*          GO TO 0010-RETURN
  6113        END-IF
  6114     END-IF
  6115     IF CM-LF-CURRENT-STATUS = '7'
  6116        IF CM-LF-DEATH-DT NOT = LOW-VALUES
  6117           MOVE ' DEATH CLAIM APPLIED '
  6118                                 TO WS-COMMENT
  6119           MOVE 'D'              TO WS-LF-STATUS
  6120*          PERFORM 0030-BUILD-BUFFER
  6121*                                THRU 0030-EXIT
  6122*          IF NOT ALREADY-SENT
  6123*             PERFORM 0020-SEND-BUFFER
  6124*                                THRU 0020-EXIT
  6125*             SET ALREADY-SENT   TO TRUE
  6126*          END-IF
  6127           GO TO 0400-EXIT
  6128*          PERFORM 0025-CLOSE-SOCKET
  6129*                                THRU 0025-EXIT
  6130*          GO TO 0010-RETURN
  6131        END-IF
  6132     END-IF
  6133     IF ((CM-LF-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6134        AND (CM-LF-LOAN-EXPIRE-DT > LOW-VALUES))
  6135        MOVE 'LF COVERAGE EXPIRED '
  6136                                 TO WS-COMMENT
  6137        MOVE 'E'                 TO WS-LF-STATUS
  6138        GO TO 0400-EXIT
  6139     END-IF
  6140     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6141        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6142        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  6143     ELSE
  6144        MOVE CP-REMAINING-TERM-2 TO CP-REMAINING-TERM
  6145     END-IF
  6146     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  6147     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  6148*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE
  6149     if ws-comp-id = 'AHL'
  6150        move cm-lf-class-cd      to cp-class-code
  6151        if cp-class-code = spaces
  6152           move zeros            to cp-class-code
  6153        end-if
  6154     else
  6155        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6156     end-if
  6157     IF (ws-comp-id = 'DCC' or 'VPP')
  6158        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6159        MOVE ' '                 TO WS-PDEF-RECORD-SW
  6160        PERFORM 0730-GET-DDF-FACTORS
  6161                                 THRU 0730-EXIT
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 108
* SOCK03.cbl
  6162        IF PDEF-FOUND
  6163           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  6164              (P1 > +8)
  6165              OR (PD-PROD-CODE (P1) = 'L')
  6166           END-PERFORM
  6167           IF P1 < +9
  6168              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  6169           END-IF
  6170        END-IF
  6171     END-IF
  6172     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT
  6173*    MOVE CM-LF-BENEFIT-AMT      TO WS-LF-ORIG-BENEFIT
  6174     COMPUTE WS-LF-ORIG-BENEFIT = CM-LF-BENEFIT-AMT +
  6175        CM-LF-ALT-BENEFIT-AMT
  6176*    ADD CM-LF-ALT-BENEFIT-AMT   TO WS-LF-ORIG-BENEFIT
  6177     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
  6178                                    WS-LF-REM-BEN
  6179     move cm-lf-premium-amt      to ws-tot-lf-prem
  6180     if ws-lf-co-earnings-calc = 'B'
  6181        COMPUTE WS-TOT-LF-PREM = ws-tot-lf-prem
  6182           + CM-LF-ALT-PREMIUM-AMT
  6183     end-if
  6184     MOVE WS-TOT-LF-PREM         TO WS-LF-PREM
  6185     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6186        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6187        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  6188     ELSE
  6189        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  6190     END-IF
  6191     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6192     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6193     IF WS-LF-ST-REFUND-CALC > ZERO
  6194         MOVE WS-LF-ST-REFUND-CALC
  6195                                 TO  CP-EARNING-METHOD.
  6196     IF WS-LF-FO-REFUND-CALC > ZERO
  6197         MOVE WS-LF-FO-REFUND-CALC
  6198                                 TO  CP-EARNING-METHOD.
  6199     IF CP-RATING-METHOD = '4'
  6200        MOVE '4'                 TO CP-EARNING-METHOD
  6201     END-IF
  6202*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6203     if ws-comp-id = 'AHL'
  6204        move cm-lf-class-cd      to cp-class-code
  6205        if cp-class-code = spaces
  6206           move zeros            to cp-class-code
  6207        end-if
  6208     else
  6209        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6210     end-if
  6211     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6212     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6213                                     CP-RATING-BENEFIT-AMT.
  6214     IF CP-STATE-STD-ABBRV = 'OR'
  6215         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  6216                                         CM-LF-ALT-BENEFIT-AMT.
  6217****   N O T E   ****
  6218*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  6219*      THE OH HARD CODING IN ELCRFNDP
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 109
* SOCK03.cbl
  6220     IF WS-COMP-ID = 'CID'
  6221        IF CP-STATE-STD-ABBRV = 'OH'
  6222           MOVE WS-LF-CO-EARNINGS-CALC
  6223                                 TO CP-EARNING-METHOD
  6224        END-IF
  6225     END-IF
  6226****   N O T E   ****
  6227     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6228     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6229     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  6230     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6231     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6232*    IF CP-EARN-AS-NET-PAY
  6233*       IF CP-LOAN-APR <= ZEROS
  6234*          IF WS-CF-DEFAULT-APR > ZEROS
  6235*             MOVE WS-CF-DEFAULT-APR
  6236*                                TO  CP-LOAN-APR
  6237*          END-IF
  6238*       END-IF
  6239*    END-IF
  6240*    DISPLAY ' SOCK REM AMT      ' CP-REMAINING-BENEFIT
  6241*    DISPLAY ' SOCK REM TRM      ' CP-REMAINING-TERM
  6242*    DISPLAY ' SOCK EARN METH    ' CP-EARNING-METHOD
  6243*    DISPLAY ' SOCK RATE METH    ' CP-RATING-METHOD
  6244*    DISPLAY ' SOCK CLASS        ' CP-CLASS-CODE
  6245*    DISPLAY ' SOCK BENE CODE    ' CP-BENEFIT-CD
  6246*    DISPLAY ' SOCK ORIG BENE    ' CP-ORIGINAL-BENEFIT
  6247*    DISPLAY ' SOCK RATE BENE    ' CP-RATING-BENEFIT-AMT
  6248*    DISPLAY ' SOCK ORIG PREM    ' CP-ORIGINAL-PREMIUM
  6249*    DISPLAY ' SOCK ISS AGE      ' CP-ISSUE-AGE
  6250*    DISPLAY ' SOCK DEV CODE     ' CP-DEVIATION-CODE
  6251*    DISPLAY ' SOCK DEV PCT      ' CP-RATE-DEV-PCT
  6252*    DISPLAY ' SOCK APR          ' CP-LOAN-APR
  6253*    DISPLAY ' SOCK EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  6254*    DISPLAY ' SOCK LOAN TERM    ' CP-LOAN-TERM
  6255*    DISPLAY ' SOCK SPEC CALC    ' CP-SPECIAL-CALC-CD
  6256*    DISPLAY ' SOCK ST STD ABB   ' CP-STATE-STD-ABBRV
  6257*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  6258     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6259     DISPLAY ' SOCK REF          ' CP-CALC-REFUND
  6260     DISPLAY ' MADE IT BACK FROM ELRFND '
  6261     IF (CP-ERROR-RATE-IS-ZERO)
  6262        OR (CP-ERROR-RATE-NOT-FOUND)
  6263        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6264        STRING ' ERROR WITH LIFE REFUND ' CP-RETURN-CODE
  6265          DELIMITED BY SIZE INTO WS-COMMENT
  6266        END-STRING
  6267        MOVE 'X'                 TO WS-LF-STATUS
  6268        GO TO 0400-EXIT
  6269*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6270*       IF NOT ALREADY-SENT
  6271*          PERFORM 0020-SEND-BUFFER
  6272*                                THRU 0020-EXIT
  6273*          SET ALREADY-SENT      TO TRUE
  6274*       END-IF
  6275*       PERFORM 0025-CLOSE-SOCKET
  6276*                                THRU 0025-EXIT
  6277*       GO TO 0010-RETURN
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 110
* SOCK03.cbl
  6278     END-IF
  6279     MOVE CP-CALC-REFUND         TO WS-LF-REFUND
  6280                                    WS-TOT-LF-RFND
  6281     IF (WS-LF-STATUS = SPACES)
  6282        OR (CP-CALC-REFUND > ZEROS)
  6283        MOVE 'A'                 TO WS-LF-STATUS
  6284     END-IF
  6285     EVALUATE TRUE
  6286        WHEN CP-R-AS-R78
  6287           MOVE 'RULE 78'          TO  WS-LF-METHOD
  6288        WHEN  CP-R-AS-PRORATA
  6289           MOVE 'PRORATA'          TO  WS-LF-METHOD
  6290        WHEN CP-R-AS-CALIF
  6291           MOVE 'CALIF'            TO  WS-LF-METHOD
  6292        WHEN CP-R-AS-TEXAS
  6293           MOVE 'IRREG/FARM PLAN'  TO  WS-LF-METHOD
  6294        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  6295           MOVE 'UTAH'             TO  WS-LF-METHOD
  6296        WHEN CP-R-AS-FARM-PLAN
  6297           MOVE 'IRREG/FARM PLAN'  TO  WS-LF-METHOD
  6298        WHEN CP-R-AS-NET-PAY
  6299           MOVE 'NET PAY'          TO  WS-LF-METHOD
  6300        WHEN CP-R-AS-ANTICIPATION
  6301           MOVE 'ANTICIPATION'     TO  WS-LF-METHOD
  6302        WHEN CP-R-AS-MEAN
  6303           MOVE 'MEAN'             TO  WS-LF-METHOD
  6304        WHEN CP-R-AS-SUM-OF-DIGITS
  6305           MOVE 'SUM OF DIGITS'    TO  WS-LF-METHOD
  6306        WHEN CP-R-AS-REPOSSESSION
  6307           MOVE 'REPOSSESSION'     TO  WS-LF-METHOD
  6308     END-EVALUATE
  6309     IF WS-TOT-LF-RFND > ZEROS
  6310        COMPUTE WS-WORK-FACTOR ROUNDED =
  6311           WS-TOT-LF-RFND / WS-TOT-LF-PREM
  6312        COMPUTE WS-LF-UEC ROUNDED = WS-WORK-FACTOR *
  6313           WS-TOT-LF-COMM
  6314     END-IF
  6315     IF ERACCT-FOUND
  6316        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6317           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6318        END-IF
  6319        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6320           IF (AM-COMM-CHARGEBACK (1) = 99)
  6321                     OR
  6322              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6323                     OR
  6324              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6325              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6326              MOVE ZEROS         TO WS-LF-UEC
  6327           END-IF
  6328        END-IF
  6329     END-IF
  6330     IF WS-LF-CO-EARNINGS-CALC NOT = 'B'
  6331        GO TO 0400-EXIT
  6332     END-IF
  6333     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  6334     MOVE '2'                    TO  CP-EARNING-METHOD
  6335                                     CP-RATING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 111
* SOCK03.cbl
  6336     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  6337                                     CP-REMAINING-BENEFIT
  6338                                     CP-RATING-BENEFIT-AMT.
  6339     IF CP-STATE-STD-ABBRV = 'OR'
  6340         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  6341                                         CM-LF-ALT-BENEFIT-AMT.
  6342     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  6343     IF ws-comp-id = 'CID'
  6344        IF (CP-STATE-STD-ABBRV = 'MN')
  6345           AND (CM-CERT-EFF-DT > X'A4FF')
  6346           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  6347           MOVE '5'              TO CP-EARNING-METHOD
  6348           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  6349        END-IF
  6350     END-IF
  6351     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  6352     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT.
  6353     IF (CP-ERROR-RATE-IS-ZERO)
  6354        OR (CP-ERROR-RATE-NOT-FOUND)
  6355        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6356        STRING ' ERROR WITH BALLOON REFUND ' CP-RETURN-CODE
  6357          DELIMITED BY SIZE INTO WS-COMMENT
  6358        END-STRING
  6359        MOVE 'X'              TO WS-LF-STATUS
  6360        GO TO 0400-EXIT
  6361*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6362*       IF NOT ALREADY-SENT
  6363*          PERFORM 0020-SEND-BUFFER
  6364*                                THRU 0020-EXIT
  6365*          SET ALREADY-SENT      TO TRUE
  6366*       END-IF
  6367*       PERFORM 0025-CLOSE-SOCKET
  6368*                                THRU 0025-EXIT
  6369*       GO TO 0010-RETURN
  6370     END-IF
  6371     ADD CP-CALC-REFUND          TO WS-TOT-LF-RFND
  6372     MOVE WS-TOT-LF-RFND         TO WS-LF-REFUND
  6373     IF WS-TOT-LF-RFND > ZEROS
  6374        COMPUTE WS-LF-UEC = (WS-TOT-LF-RFND / WS-TOT-LF-PREM) *
  6375           WS-TOT-LF-COMM
  6376     END-IF
  6377     IF ERACCT-FOUND
  6378        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6379           IF (AM-COMM-CHARGEBACK (1) = 99)
  6380                     OR
  6381              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6382                     OR
  6383              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6384              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6385              MOVE ZEROS         TO WS-LF-UEC
  6386           END-IF
  6387        END-IF
  6388     END-IF
  6389     .
  6390 0400-EXIT.
  6391     EXIT.
  6392 0500-PROCESS-AH.
  6393     IF CM-AH-BENEFIT-CD = '  ' OR '00'
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 112
* SOCK03.cbl
  6394        GO TO 0500-EXIT
  6395     END-IF
  6396     MOVE ZEROS                  TO WS-TOT-AH-RFND
  6397                                    WS-TOT-AH-PREM
  6398                                    WS-TOT-AH-COMM
  6399                                    WS-AH-CANCEL-DATE
  6400     MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  6401     MOVE ' '                    TO  DC-OPTION-CODE
  6402     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6403     IF NO-CONVERSION-ERROR
  6404        MOVE DC-GREG-DATE-CYMD   TO WS-AH-EXPIRE-DATE
  6405     ELSE
  6406        MOVE ZEROS               TO WS-AH-EXPIRE-DATE
  6407     END-IF
  6408     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6409        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
  6410        MOVE ' '                 TO DC-OPTION-CODE
  6411
  6412        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6413        IF NO-CONVERSION-ERROR
  6414           MOVE DC-GREG-DATE-CYMD TO WS-AH-CANCEL-DATE
  6415        ELSE
  6416           MOVE ZEROS            TO WS-AH-CANCEL-DATE
  6417        END-IF
  6418     END-IF
  6419     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BEN-CODE
  6420     MOVE CM-AH-ORIG-TERM        TO WS-AH-TERM
  6421     MOVE WS-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE
  6422     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  6423     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  6424     MOVE WS-BIN-VAL-DT          TO  CP-VALUATION-DT.
  6425     MOVE CM-STATE               TO  CP-STATE.
  6426     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  6427     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  6428     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  6429     MOVE '2'                    TO  CP-PROCESS-TYPE.
  6430     MOVE WS-COMP-ID             TO  CP-COMPANY-ID.
  6431     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  6432     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  6433     MOVE WS-CF-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION
  6434     MOVE WS-CF-CR-REM-TERM-CALC
  6435                                 TO  CP-REM-TERM-METHOD.
  6436     IF WS-AH-CO-REM-TERM-CALC > '0'
  6437         MOVE WS-AH-CO-REM-TERM-CALC
  6438                                 TO  CP-REM-TERM-METHOD.
  6439     IF WS-AH-ST-REM-TERM-CALC > '0'
  6440         MOVE WS-AH-ST-REM-TERM-CALC
  6441                                 TO  CP-REM-TERM-METHOD.
  6442     IF WS-AH-AM-REM-TERM-CALC > '0'
  6443         MOVE WS-AH-AM-REM-TERM-CALC
  6444                                 TO  CP-REM-TERM-METHOD.
  6445     IF (WS-COMP-ID = 'CID')
  6446        AND (CP-STATE-STD-ABBRV = 'WI')
  6447        MOVE '7'                 TO CP-REM-TERM-METHOD
  6448        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6449     END-IF
  6450     IF (WS-COMP-ID = 'CID')
  6451        AND (CP-STATE-STD-ABBRV = 'MO')
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 113
* SOCK03.cbl
  6452        AND (CM-CERT-EFF-DT >= X'9B41')
  6453        AND (CM-CERT-EFF-DT <= X'A2FB')
  6454        MOVE '7'                 TO CP-REM-TERM-METHOD
  6455        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6456     END-IF
  6457     MOVE CM-AH-ORIG-TERM        TO  CP-ORIGINAL-TERM
  6458                                     CP-LOAN-TERM.
  6459     IF  NOT  CP-TERM-IS-DAYS
  6460         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  6461             MOVE CM-PMT-EXTENSION-DAYS
  6462                                 TO  CP-TERM-OR-EXT-DAYS
  6463         ELSE
  6464             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  6465     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  6466     IF CM-AH-COMM-PCT > ZEROS
  6467        COMPUTE WS-TOT-AH-COMM = CM-AH-COMM-PCT *
  6468           CM-AH-PREMIUM-AMT
  6469     END-IF
  6470     IF (ws-comp-id = 'DCC' or 'VPP')
  6471        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6472        compute ws-tot-ah-comm = cm-ah-premium-amt -
  6473           (cm-ah-clp + cm-addl-clp)
  6474     end-if
  6475     MOVE WS-TOT-AH-COMM         TO WS-AH-COMM
  6476     IF WS-AH-STATUS = 'D'
  6477        GO TO 0500-EXIT
  6478     END-IF
  6479     DISPLAY ' BEGIN OPEN AH CLAIM TEST '
  6480     MOVE LOW-VALUES             TO WS-AH-BIN-PAID-THRU-DT
  6481     MOVE ' '                    TO WS-CLM-STOP-SW
  6482     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  6483     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  6484
  6485* EXEC CICS STARTBR
  6486*       DATASET     ('ELMSTR5')
  6487*       RIDFLD      (ELMSTR-KEY)
  6488*       RESP        (WS-RESPONSE)
  6489*    END-EXEC
  6490     MOVE 'ELMSTR5' TO DFHEIV1
  6491     MOVE 0
  6492       TO DFHEIV11
  6493*    MOVE '&,         G          &  N#00006025' TO DFHEIV0
  6494     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6495     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6496     MOVE X'204E233030303036303235' TO DFHEIV0(25:11)
  6497     CALL 'kxdfhei1' USING DFHEIV0,
  6498           DFHEIV1,
  6499           ELMSTR-KEY,
  6500           DFHEIV99,
  6501           DFHEIV11,
  6502           DFHEIV99
  6503     MOVE EIBRESP  TO WS-RESPONSE
  6504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6505     DISPLAY ' AFTER START ' WS-RESPONSE
  6506     IF RESP-NORMAL
  6507        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6508           DISPLAY ' AH READNEXT '
  6509
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 114
* SOCK03.cbl
  6510* EXEC CICS READNEXT
  6511*             DATASET   ('ELMSTR5')
  6512*             RIDFLD    (ELMSTR-KEY)
  6513*             INTO      (CLAIM-MASTER)
  6514*             RESP      (WS-RESPONSE)
  6515*          END-EXEC
  6516     MOVE LENGTH OF
  6517      CLAIM-MASTER
  6518       TO DFHEIV12
  6519     MOVE 'ELMSTR5' TO DFHEIV1
  6520     MOVE 0
  6521       TO DFHEIV11
  6522*    MOVE '&.IL                  )  N#00006034' TO DFHEIV0
  6523     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6524     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6525     MOVE X'204E233030303036303334' TO DFHEIV0(25:11)
  6526     CALL 'kxdfhei1' USING DFHEIV0,
  6527           DFHEIV1,
  6528           CLAIM-MASTER,
  6529           DFHEIV12,
  6530           ELMSTR-KEY,
  6531           DFHEIV99,
  6532           DFHEIV11,
  6533           DFHEIV99,
  6534           DFHEIV99
  6535     MOVE EIBRESP  TO WS-RESPONSE
  6536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6537        IF (RESP-NORMAL OR RESP-DUPKEY)
  6538           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6539           AND (CM-CERT-NO = CL-CERT-NO)
  6540           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6541              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6542              IF (CL-CLAIM-TYPE = 'A' OR 'I' OR 'G' OR 'F')
  6543                 IF CLAIM-IS-OPEN
  6544                    DISPLAY ' FOUND OPEN AH CLAIM '
  6545                    MOVE ' OPEN HEALTH CLAIM '
  6546                                 TO WS-COMMENT
  6547                    MOVE 'H'     TO WS-AH-STATUS
  6548                 ELSE
  6549                    DISPLAY ' FOUND CLOSED AH CLAIM '
  6550                    MOVE ' CLOSED HEALTH CLAIM '
  6551                                 TO WS-COMMENT
  6552                    IF CL-PAID-THRU-DT > WS-AH-BIN-PAID-THRU-DT
  6553                       MOVE CL-PAID-THRU-DT
  6554                                 TO WS-AH-BIN-PAID-THRU-DT
  6555                    END-IF
  6556                 END-IF
  6557              END-IF
  6558           END-IF
  6559        ELSE
  6560           SET I-SAY-TO-STOP TO TRUE
  6561        END-IF
  6562        END-PERFORM
  6563
  6564* EXEC CICS ENDBR
  6565*          DATASET   ('ELMSTR5')
  6566*       END-EXEC
  6567     MOVE 'ELMSTR5' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 115
* SOCK03.cbl
  6568     MOVE 0
  6569       TO DFHEIV11
  6570*    MOVE '&2                    $   #00006066' TO DFHEIV0
  6571     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6572     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6573     MOVE X'2020233030303036303636' TO DFHEIV0(25:11)
  6574     CALL 'kxdfhei1' USING DFHEIV0,
  6575           DFHEIV1,
  6576           DFHEIV11,
  6577           DFHEIV99
  6578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6579     END-IF
  6580     IF WS-AH-BIN-PAID-THRU-DT NOT = LOW-VALUES
  6581*       THIS WILL BE TRUE IF WE FOUND A CLOSED AH CLAIM
  6582        MOVE WS-AH-BIN-PAID-THRU-DT
  6583                                 TO DC-BIN-DATE-1
  6584        MOVE ' '                 TO DC-OPTION-CODE
  6585        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6586        IF NO-CONVERSION-ERROR
  6587           MOVE DC-GREG-DATE-CYMD
  6588                                 TO WS-CLM-PAID-THRU-DT
  6589        ELSE
  6590           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  6591        END-IF
  6592        IF WS-BIN-VAL-DT <= WS-AH-BIN-PAID-THRU-DT
  6593           MOVE 'CAN DT NOT > CLM CLOSE DT '
  6594                                 TO WS-COMMENT
  6595           MOVE 'P'              TO WS-AH-STATUS
  6596           GO TO 0500-EXIT
  6597        END-IF
  6598     END-IF
  6599     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  6600     IF CM-AH-CURRENT-STATUS = '8'
  6601        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6602           MOVE ' AH COVERAGE PREVIOUSLY CANCELLED '
  6603                                 TO WS-COMMENT
  6604           MOVE 'C'              TO WS-AH-STATUS
  6605           move cm-ah-itd-cancel-amt
  6606                                 to ws-ah-refund
  6607           GO TO 0500-EXIT
  6608        END-IF
  6609     END-IF
  6610     IF CM-AH-CURRENT-STATUS = '6'  OR  '7'
  6611        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  6612           MOVE ' SETTLEMENT CLAIM APPLIED '
  6613                                 TO WS-COMMENT
  6614           MOVE 'S'              TO WS-AH-STATUS
  6615*          PERFORM 0030-BUILD-BUFFER
  6616*                                THRU 0030-EXIT
  6617*          IF NOT ALREADY-SENT
  6618*             PERFORM 0020-SEND-BUFFER
  6619*                                THRU 0020-EXIT
  6620*             SET ALREADY-SENT   TO TRUE
  6621*          END-IF
  6622           GO TO 0500-EXIT
  6623*          PERFORM 0025-CLOSE-SOCKET
  6624*                                THRU 0025-EXIT
  6625*          GO TO 0010-RETURN
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 116
* SOCK03.cbl
  6626        END-IF
  6627     END-IF
  6628     IF ((CM-AH-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6629        AND (CM-AH-LOAN-EXPIRE-DT > LOW-VALUES))
  6630        MOVE 'AH COVERAGE EXPIRED '
  6631                                 TO WS-COMMENT
  6632        MOVE 'E'                 TO WS-AH-STATUS
  6633        GO TO 0500-EXIT
  6634     END-IF
  6635     MOVE CM-AH-PREMIUM-AMT      TO WS-TOT-AH-PREM
  6636                                    WS-AH-PREM
  6637     MOVE CM-AH-BENEFIT-AMT      TO WS-AH-ORIG-BENEFIT
  6638     COMPUTE WS-AH-REM-BEN = CM-AH-BENEFIT-AMT
  6639        * CP-REMAINING-TERM-1
  6640     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM
  6641                                     WS-AH-REM-TERM
  6642     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6643     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6644     IF WS-AH-ST-REFUND-CALC > ZERO
  6645         MOVE WS-AH-ST-REFUND-CALC
  6646                                 TO  CP-EARNING-METHOD.
  6647     IF WS-AH-FO-REFUND-CALC > ZERO
  6648         MOVE WS-AH-FO-REFUND-CALC
  6649                                 TO  CP-EARNING-METHOD.
  6650*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6651     if ws-comp-id = 'AHL'
  6652        move cm-ah-class-cd      to cp-class-code
  6653        if cp-class-code = spaces
  6654           move zeros            to cp-class-code
  6655        end-if
  6656     else
  6657        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6658     end-if
  6659     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6660     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6661                                     CP-RATING-BENEFIT-AMT.
  6662     IF CP-STATE-STD-ABBRV = 'OR'
  6663         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  6664                                         CM-AH-ORIG-TERM.
  6665     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6666     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6667     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6668     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  6669     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6670     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6671     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6672     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6673     MOVE ' '                    TO  DC-OPTION-CODE.
  6674     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6675     IF CP-STATE-STD-ABBRV = 'OH'
  6676        IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6677         IF (CP-ORIGINAL-TERM > 60)
  6678           AND (DC-GREG-DATE-1-YMD > '831101')
  6679           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  6680             MOVE '6'            TO  CP-EARNING-METHOD
  6681         END-IF
  6682        END-IF
  6683        IF WS-COMP-ID = 'CID'
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 117
* SOCK03.cbl
  6684           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  6685                           LOW-VALUES)
  6686              IF CP-CRITICAL-PERIOD
  6687                 MOVE '2'       TO CP-EARNING-METHOD
  6688              ELSE
  6689                 MOVE '6'       TO CP-EARNING-METHOD
  6690              END-IF
  6691           ELSE
  6692              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  6693                 MOVE '2'       TO CP-EARNING-METHOD
  6694              ELSE
  6695                 IF ((CM-LF-ORIG-TERM > 60) AND
  6696                    (CM-RATE-CLASS NOT = 'L '))
  6697                               OR
  6698                    (WS-LF-CO-EARNINGS-CALC = '5')
  6699                    IF CP-CRITICAL-PERIOD
  6700                       MOVE '2'  TO CP-EARNING-METHOD
  6701                    ELSE
  6702                       MOVE '6'  TO CP-EARNING-METHOD
  6703                    END-IF
  6704                 ELSE
  6705                    MOVE '1'     TO CP-EARNING-METHOD
  6706                 END-IF
  6707              END-IF
  6708           END-IF
  6709        END-IF
  6710     END-IF
  6711     IF CP-STATE-STD-ABBRV = 'VA'
  6712       IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6713         IF DC-GREG-DATE-1-YMD > '921231'
  6714            IF CP-ORIGINAL-TERM > 61
  6715                MOVE '6'            TO  CP-EARNING-METHOD
  6716            ELSE
  6717                MOVE '1'            TO  CP-EARNING-METHOD.
  6718*    IF CP-EARN-AS-NET-PAY
  6719*       IF CP-LOAN-APR <= ZEROS
  6720*          IF WS-CF-DEFAULT-APR > ZEROS
  6721*             MOVE WS-CF-DEFAULT-APR
  6722*                                TO  CP-LOAN-APR
  6723*          END-IF
  6724*       END-IF
  6725*    END-IF
  6726     IF WS-COMP-ID = 'DCC' or 'VPP'
  6727        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6728           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  6729           MOVE 'S'              TO CP-EARNING-METHOD
  6730        END-IF
  6731     END-IF
  6732     MOVE WS-CANCEL-REASON       TO CP-CANCEL-REASON
  6733     IF (WS-COMP-ID = 'DCC' or 'VPP')
  6734        AND (CP-EARNING-METHOD = 'D')
  6735        MOVE +0                  TO WS-DDF-ADMIN-FEES
  6736                                    WS-DDF-CSO-ADMIN-FEE
  6737                                    WS-DDF-1ST-YR-TOT-EXP
  6738                                    WS-DDF-COMM-AND-MFEE
  6739        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  6740           S1 > +10
  6741           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 118
* SOCK03.cbl
  6742              IF (AM-A-COM (S1) NUMERIC)
  6743                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  6744                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  6745              ELSE
  6746                 MOVE +0         TO WS-COMM-PCT C0
  6747                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  6748                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  6749              END-IF
  6750              IF AM-COM-TYP (S1) = 'L' OR 'N'
  6751                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  6752                    + WS-COMM-PCT
  6753              END-IF
  6754              IF AM-COM-TYP (S1) = 'N'
  6755                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  6756                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  6757              END-IF
  6758              IF AM-COM-TYP (S1) = 'J' OR 'L'
  6759                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  6760                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  6761              END-IF
  6762              IF AM-COM-TYP (S1) = 'I'
  6763                 COMPUTE WS-DDF-COMM-AND-MFEE
  6764                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  6765              END-IF
  6766           END-IF
  6767        END-PERFORM
  6768        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  6769        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  6770        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  6771           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  6772     END-IF
  6773     IF (WS-COMP-ID = 'DCC' or 'VPP')
  6774        AND (CP-EARNING-METHOD = 'D')
  6775        AND (ws-CANCEL-REASON NOT = 'R')
  6776        PERFORM 0730-GET-DDF-FACTORS
  6777                                 THRU 0730-EXIT
  6778        IF NOT PDEF-FOUND
  6779           MOVE ' DDF UE FACTORS  NOT FOUND '
  6780                                 TO WS-COMMENT
  6781           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  6782           PERFORM 0030-BUILD-BUFFER
  6783                                 THRU 0030-EXIT
  6784           PERFORM 0020-SEND-BUFFER
  6785                                 THRU 0020-EXIT
  6786           PERFORM 0025-CLOSE-SOCKET
  6787                                 THRU 0025-EXIT
  6788           GO TO 0010-RETURN
  6789        END-IF
  6790*       IF NOT PDEF-FOUND
  6791*          MOVE ER-9999          TO EMI-ERROR
  6792*          PERFORM 9700-ERROR-FORMAT
  6793*                                THRU 9799-EXIT
  6794*          GO TO 8200-SEND-DATAONLY
  6795*       END-IF
  6796        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  6797                                 TO CP-DDF-LO-FACT
  6798        MOVE PD-UEP-FACTOR (P1 P2)
  6799                                 TO CP-DDF-HI-FACT
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 119
* SOCK03.cbl
  6800        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  6801        MOVE CM-AH-CLP           TO CP-DDF-CLP
  6802        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  6803        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  6804           + PD-1ST-YR-ADMIN-ALLOW
  6805        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  6806*       IF PI-CLP-YN = 'Y'
  6807*          MOVE 'C'              TO CP-DDF-SPEC-CALC
  6808*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  6809*                                   CP-DDF-CLP
  6810*          MOVE ZEROS            TO CP-1ST-YR-ALLOW
  6811*       END-IF
  6812        IF DD-IU-PRESENT
  6813           MOVE 'I'              TO CP-EARNING-METHOD
  6814        END-IF
  6815        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6816                                    CP-CLP-RATE-UP
  6817        IF (CP-CALC-GROSS-FEE)
  6818           AND (CP-IU-RATE-UP NOT = ZEROS)
  6819           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  6820              / CP-ORIGINAL-PREMIUM)
  6821           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  6822              / (1 - TEX-FACT-8)
  6823        END-IF
  6824     END-IF
  6825     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6826     IF (CP-ERROR-RATE-IS-ZERO)
  6827        OR (CP-ERROR-RATE-NOT-FOUND)
  6828        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6829        STRING ' ERROR WITH AH REFUND ' CP-RETURN-CODE
  6830          DELIMITED BY SIZE INTO WS-COMMENT
  6831        END-STRING
  6832        IF WS-AH-STATUS NOT = 'H'
  6833           MOVE 'X'                 TO WS-AH-STATUS
  6834        END-IF
  6835        GO TO 0500-EXIT
  6836*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6837*       IF NOT ALREADY-SENT
  6838*          PERFORM 0020-SEND-BUFFER
  6839*                                THRU 0020-EXIT
  6840*          SET ALREADY-SENT      TO TRUE
  6841*       END-IF
  6842*       PERFORM 0025-CLOSE-SOCKET
  6843*                                THRU 0025-EXIT
  6844*       GO TO 0010-RETURN
  6845     END-IF
  6846     MOVE CP-CALC-REFUND         TO WS-AH-REFUND
  6847                                    WS-TOT-AH-RFND
  6848     MOVE CP-REFUND-TYPE-USED    TO WS-AH-METHOD
  6849     IF ((WS-AH-STATUS = SPACES)
  6850        OR (CP-CALC-REFUND > ZEROS))
  6851                  AND
  6852          (WS-AH-STATUS NOT = 'H')
  6853        MOVE 'A'                 TO WS-AH-STATUS
  6854     END-IF
  6855     IF WS-COMP-ID = 'DCC' or 'VPP'
  6856        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6857        AND (CP-EARNING-METHOD = 'D' OR 'I')
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 120
* SOCK03.cbl
  6858        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6859        MOVE 'C'                 TO CP-DDF-SPEC-CALC
  6860        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
  6861        MOVE ZEROS               TO CP-1ST-YR-ALLOW
  6862        PERFORM 0720-LINK-REFUND THRU  0720-EXIT
  6863        MOVE CP-CALC-REFUND      TO ws-ah-rfnd-clp
  6864        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
  6865     END-IF
  6866     EVALUATE TRUE
  6867        WHEN CP-R-AS-R78
  6868           MOVE 'RULE 78'          TO  WS-AH-METHOD
  6869        WHEN CP-R-AS-PRORATA
  6870           MOVE 'PRORATA'          TO  WS-AH-METHOD
  6871        WHEN CP-REFUND-TYPE-USED = '3'
  6872           MOVE 'CALIF'            TO  WS-AH-METHOD
  6873        WHEN CP-R-AS-TEXAS
  6874           MOVE 'IRREG/FARM PLAN'  TO  WS-AH-METHOD
  6875        WHEN CP-R-AS-FARM-PLAN
  6876           MOVE 'IRREG/FARM PLAN'  TO  WS-AH-METHOD
  6877        WHEN CP-R-AS-NET-PAY
  6878           MOVE 'NET PAY'          TO  WS-AH-METHOD
  6879        WHEN CP-R-AS-ANTICIPATION
  6880           MOVE 'ANTICIPATION'     TO  WS-AH-METHOD
  6881        WHEN CP-R-AS-MEAN
  6882           MOVE 'MEAN'             TO  WS-AH-METHOD
  6883        WHEN CP-R-AS-SUM-OF-DIGITS
  6884           MOVE 'SUM OF DIGITS'    TO  WS-AH-METHOD
  6885        WHEN CP-GAP-ACTUARIAL
  6886           MOVE 'SP ACTUARIAL'     TO WS-AH-METHOD
  6887        WHEN CP-R-AS-REPOSSESSION
  6888           MOVE 'REPOSSESSION'     TO WS-AH-METHOD
  6889     END-EVALUATE
  6890     IF WS-TOT-AH-RFND > ZEROS
  6891        IF (ws-comp-id = 'DCC' or 'VPP')
  6892           AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6893           compute ws-work-factor rounded =
  6894              ws-ah-rfnd-clp / cm-ah-clp
  6895        else
  6896           COMPUTE WS-WORK-FACTOR ROUNDED =
  6897              WS-TOT-AH-RFND / WS-TOT-AH-PREM
  6898        end-if
  6899        COMPUTE WS-AH-UEC ROUNDED = WS-WORK-FACTOR *
  6900           WS-TOT-AH-COMM
  6901     END-IF
  6902     IF ERACCT-FOUND
  6903        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6904           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6905        END-IF
  6906        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6907           IF (AM-COMM-CHARGEBACK (1) = 99)
  6908                     OR
  6909              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6910                     OR
  6911              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6912              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6913              MOVE ZEROS         TO WS-AH-UEC
  6914           END-IF
  6915        END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 121
* SOCK03.cbl
  6916     END-IF
  6917     .
  6918 0500-EXIT.
  6919     EXIT.
  6920 0610-GET-ERMAIL.
  6921
  6922     move cm-control-primary     to ws-ma-key
  6923*    MOVE WS-CM-KEY              TO WS-MA-KEY
  6924
  6925* EXEC CICS READ
  6926*       INTO    (MAILING-DATA)
  6927*       DATASET ('ERMAIL')
  6928*       RIDFLD  (WS-MA-KEY)
  6929*       RESP    (WS-RESPONSE)
  6930*    END-EXEC
  6931     MOVE LENGTH OF
  6932      MAILING-DATA
  6933       TO DFHEIV11
  6934     MOVE 'ERMAIL' TO DFHEIV1
  6935*    MOVE '&"IL       E          (  N#00006414' TO DFHEIV0
  6936     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6937     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6938     MOVE X'204E233030303036343134' TO DFHEIV0(25:11)
  6939     CALL 'kxdfhei1' USING DFHEIV0,
  6940           DFHEIV1,
  6941           MAILING-DATA,
  6942           DFHEIV11,
  6943           WS-MA-KEY,
  6944           DFHEIV99,
  6945           DFHEIV99,
  6946           DFHEIV99
  6947     MOVE EIBRESP  TO WS-RESPONSE
  6948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6949
  6950     IF RESP-NORMAL
  6951        MOVE MA-CRED-BENE-NAME   to ws-cred-bene-name
  6952     else
  6953        move spaces              to ws-cred-bene-name
  6954     end-if
  6955
  6956     .
  6957 0610-EXIT.
  6958     EXIT.
  6959 0620-GET-ELCRTT.
  6960
  6961     move cm-control-primary     to ws-cs-key
  6962*    MOVE WS-CM-KEY              TO WS-CS-KEY
  6963     move 'C'                    to WS-CS-TRLR-TYPE
  6964
  6965
  6966* EXEC CICS READ
  6967*       INTO    (CERTIFICATE-TRAILERS)
  6968*       DATASET ('ELCRTT')
  6969*       RIDFLD  (WS-CS-KEY)
  6970*       RESP    (WS-RESPONSE)
  6971*    END-EXEC
  6972     MOVE LENGTH OF
  6973      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 122
* SOCK03.cbl
  6974       TO DFHEIV11
  6975     MOVE 'ELCRTT' TO DFHEIV1
  6976*    MOVE '&"IL       E          (  N#00006436' TO DFHEIV0
  6977     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6978     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6979     MOVE X'204E233030303036343336' TO DFHEIV0(25:11)
  6980     CALL 'kxdfhei1' USING DFHEIV0,
  6981           DFHEIV1,
  6982           CERTIFICATE-TRAILERS,
  6983           DFHEIV11,
  6984           WS-CS-KEY,
  6985           DFHEIV99,
  6986           DFHEIV99,
  6987           DFHEIV99
  6988     MOVE EIBRESP  TO WS-RESPONSE
  6989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6990
  6991     IF RESP-NORMAL
  6992        MOVE cs-vin-number       to ws-vin
  6993     else
  6994        move spaces              to ws-vin
  6995     end-if
  6996
  6997     .
  6998 0620-EXIT.
  6999     EXIT.
  7000 0700-LINK-REM-TERM.
  7001
  7002* EXEC CICS LINK
  7003*        PROGRAM   ('ELRTRM')
  7004*        COMMAREA  (CALCULATION-PASS-AREA)
  7005*        LENGTH    (CP-COMM-LENGTH)
  7006*    END-EXEC.
  7007     MOVE 'ELRTRM' TO DFHEIV1
  7008*    MOVE '."C                   (   #00006453' TO DFHEIV0
  7009     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7010     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7011     MOVE X'2020233030303036343533' TO DFHEIV0(25:11)
  7012     CALL 'kxdfhei1' USING DFHEIV0,
  7013           DFHEIV1,
  7014           CALCULATION-PASS-AREA,
  7015           CP-COMM-LENGTH,
  7016           DFHEIV99,
  7017           DFHEIV99,
  7018           DFHEIV99,
  7019           DFHEIV99
  7020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7021
  7022 0700-EXIT.
  7023     EXIT.
  7024 0710-LINK-REM-AMOUNT.
  7025
  7026* EXEC CICS LINK
  7027*        PROGRAM   ('ELRAMT')
  7028*        COMMAREA  (CALCULATION-PASS-AREA)
  7029*        LENGTH    (CP-COMM-LENGTH)
  7030*    END-EXEC
  7031     MOVE 'ELRAMT' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 123
* SOCK03.cbl
  7032*    MOVE '."C                   (   #00006461' TO DFHEIV0
  7033     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7034     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7035     MOVE X'2020233030303036343631' TO DFHEIV0(25:11)
  7036     CALL 'kxdfhei1' USING DFHEIV0,
  7037           DFHEIV1,
  7038           CALCULATION-PASS-AREA,
  7039           CP-COMM-LENGTH,
  7040           DFHEIV99,
  7041           DFHEIV99,
  7042           DFHEIV99,
  7043           DFHEIV99
  7044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7045     .
  7046 0710-EXIT.
  7047     EXIT.
  7048 0720-LINK-REFUND.
  7049
  7050* EXEC CICS LINK
  7051*        PROGRAM   ('ELRFND')
  7052*        COMMAREA  (CALCULATION-PASS-AREA)
  7053*        LENGTH    (CP-COMM-LENGTH)
  7054*    END-EXEC
  7055     MOVE 'ELRFND' TO DFHEIV1
  7056*    MOVE '."C                   (   #00006470' TO DFHEIV0
  7057     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7058     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7059     MOVE X'2020233030303036343730' TO DFHEIV0(25:11)
  7060     CALL 'kxdfhei1' USING DFHEIV0,
  7061           DFHEIV1,
  7062           CALCULATION-PASS-AREA,
  7063           CP-COMM-LENGTH,
  7064           DFHEIV99,
  7065           DFHEIV99,
  7066           DFHEIV99,
  7067           DFHEIV99
  7068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7069     .
  7070 0720-EXIT.
  7071     EXIT.
  7072 0730-GET-DDF-FACTORS.
  7073     MOVE ' '                    TO WS-PDEF-RECORD-SW
  7074     MOVE WS-COMP-CD             TO ERPDEF-KEY
  7075     MOVE CM-STATE               TO ERPDEF-STATE
  7076     if cm-clp-state not = cm-state and spaces and zeros
  7077        move cm-clp-state        to erpdef-state
  7078     end-if
  7079     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  7080     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  7081     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  7082     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  7083     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  7084
  7085* EXEC CICS STARTBR
  7086*        DATASET  ('ERPDEF')
  7087*        RIDFLD   (ERPDEF-KEY)
  7088*        GTEQ
  7089*        RESP     (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 124
* SOCK03.cbl
  7090*    END-EXEC
  7091     MOVE 'ERPDEF' TO DFHEIV1
  7092     MOVE 0
  7093       TO DFHEIV11
  7094*    MOVE '&,         G          &  N#00006490' TO DFHEIV0
  7095     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7096     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7097     MOVE X'204E233030303036343930' TO DFHEIV0(25:11)
  7098     CALL 'kxdfhei1' USING DFHEIV0,
  7099           DFHEIV1,
  7100           ERPDEF-KEY,
  7101           DFHEIV99,
  7102           DFHEIV11,
  7103           DFHEIV99
  7104     MOVE EIBRESP  TO WS-RESPONSE
  7105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7106     IF NOT RESP-NORMAL
  7107        GO TO 0730-EXIT
  7108     END-IF
  7109     .
  7110 0730-READNEXT.
  7111
  7112* EXEC CICS READNEXT
  7113*       DATASET  ('ERPDEF')
  7114*       INTO     (PRODUCT-MASTER)
  7115*       RIDFLD   (ERPDEF-KEY)
  7116*       RESP     (WS-RESPONSE)
  7117*    END-EXEC
  7118     MOVE LENGTH OF
  7119      PRODUCT-MASTER
  7120       TO DFHEIV12
  7121     MOVE 'ERPDEF' TO DFHEIV1
  7122     MOVE 0
  7123       TO DFHEIV11
  7124*    MOVE '&.IL                  )  N#00006501' TO DFHEIV0
  7125     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7126     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7127     MOVE X'204E233030303036353031' TO DFHEIV0(25:11)
  7128     CALL 'kxdfhei1' USING DFHEIV0,
  7129           DFHEIV1,
  7130           PRODUCT-MASTER,
  7131           DFHEIV12,
  7132           ERPDEF-KEY,
  7133           DFHEIV99,
  7134           DFHEIV11,
  7135           DFHEIV99,
  7136           DFHEIV99
  7137     MOVE EIBRESP  TO WS-RESPONSE
  7138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7139     IF NOT RESP-NORMAL
  7140        GO TO 0730-ENDBR
  7141     END-IF
  7142     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  7143        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  7144           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  7145        ELSE
  7146           GO TO 0730-READNEXT
  7147        END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 125
* SOCK03.cbl
  7148     ELSE
  7149        GO TO 0730-ENDBR
  7150     END-IF
  7151     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7152        (P1 > +8)
  7153        OR (PD-PROD-CODE (P1) = 'I')
  7154     END-PERFORM
  7155     IF P1 < +9
  7156        SET DD-IU-PRESENT        TO TRUE
  7157     END-IF
  7158     IF CM-LOAN-TERM = ZEROS
  7159        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  7160     END-IF
  7161     IF PD-TRUNCATED = 'Y'
  7162        MOVE CM-LOAN-TERM        TO WS-TERM
  7163     ELSE
  7164        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  7165     END-IF
  7166     EVALUATE TRUE
  7167        WHEN WS-TERM > +168
  7168           MOVE 15               TO P1
  7169        WHEN WS-TERM > +156
  7170           MOVE 14               TO P1
  7171        WHEN WS-TERM > +144
  7172           MOVE 13               TO P1
  7173        WHEN WS-TERM > +132
  7174           MOVE 12               TO P1
  7175        WHEN WS-TERM > +120
  7176           MOVE 11               TO P1
  7177        WHEN WS-TERM > +108
  7178           MOVE 10               TO P1
  7179        WHEN WS-TERM > +96
  7180           MOVE 9                TO P1
  7181        WHEN WS-TERM > +84
  7182           MOVE 8                TO P1
  7183        WHEN WS-TERM > +72
  7184           MOVE 7                TO P1
  7185        WHEN WS-TERM > +60
  7186           MOVE 6                TO P1
  7187        WHEN WS-TERM > +48
  7188           MOVE 5                TO P1
  7189        WHEN WS-TERM > +36
  7190           MOVE 4                TO P1
  7191        WHEN WS-TERM > +24
  7192           MOVE 3                TO P1
  7193        WHEN WS-TERM > +12
  7194           MOVE 2                TO P1
  7195        WHEN OTHER
  7196           MOVE 1                TO P1
  7197     END-EVALUATE
  7198     EVALUATE TRUE
  7199*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  7200*          AND (DD-IU-PRESENT)
  7201*          MOVE 2                TO P2
  7202*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  7203*          MOVE 1                TO P2
  7204        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  7205           MOVE 2                TO P2
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 126
* SOCK03.cbl
  7206        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  7207           MOVE 3                TO P2
  7208        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  7209           MOVE 4                TO P2
  7210        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  7211           MOVE 5                TO P2
  7212        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  7213           MOVE 6                TO P2
  7214        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  7215           MOVE 7                TO P2
  7216        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  7217           MOVE 8                TO P2
  7218        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  7219           MOVE 9                TO P2
  7220        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  7221           MOVE 10               TO P2
  7222        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  7223           MOVE 11               TO P2
  7224        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  7225           MOVE 12               TO P2
  7226        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  7227           MOVE 13               TO P2
  7228        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  7229           MOVE 14               TO P2
  7230        WHEN OTHER
  7231           MOVE 15               TO P2
  7232     END-EVALUATE
  7233     .
  7234 0730-ENDBR.
  7235
  7236* EXEC CICS ENDBR
  7237*       DATASET  ('ERPDEF')
  7238*    END-EXEC
  7239     MOVE 'ERPDEF' TO DFHEIV1
  7240     MOVE 0
  7241       TO DFHEIV11
  7242*    MOVE '&2                    $   #00006603' TO DFHEIV0
  7243     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7244     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7245     MOVE X'2020233030303036363033' TO DFHEIV0(25:11)
  7246     CALL 'kxdfhei1' USING DFHEIV0,
  7247           DFHEIV1,
  7248           DFHEIV11,
  7249           DFHEIV99
  7250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7251     .
  7252 0730-EXIT.
  7253     EXIT.
  7254 0740-GET-ERCTBL.
  7255     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7256     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7257     MOVE 'A'                    TO CTBL-BEN-TYPE
  7258     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  7259     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7260     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7261     IF RESP-NORMAL
  7262        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7263     ELSE
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 127
* SOCK03.cbl
  7264        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7265        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7266        MOVE 'A'                    TO CTBL-BEN-TYPE
  7267        MOVE 'AA'                   TO CTBL-BEN-CODE
  7268        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7269        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7270        IF RESP-NORMAL
  7271           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7272        END-IF
  7273     END-IF
  7274     .
  7275 0740-EXIT.
  7276     EXIT.
  7277 0750-READ-ERCTBL.
  7278
  7279* EXEC CICS READ
  7280*         INTO    (COMM-TABLE-RECORD)
  7281*         DATASET ('ERCTBL')
  7282*         RIDFLD  (CTBL-KEY)
  7283*         RESP    (WS-RESPONSE)
  7284*    END-EXEC
  7285     MOVE LENGTH OF
  7286      COMM-TABLE-RECORD
  7287       TO DFHEIV11
  7288     MOVE 'ERCTBL' TO DFHEIV1
  7289*    MOVE '&"IL       E          (  N#00006633' TO DFHEIV0
  7290     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7291     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7292     MOVE X'204E233030303036363333' TO DFHEIV0(25:11)
  7293     CALL 'kxdfhei1' USING DFHEIV0,
  7294           DFHEIV1,
  7295           COMM-TABLE-RECORD,
  7296           DFHEIV11,
  7297           CTBL-KEY,
  7298           DFHEIV99,
  7299           DFHEIV99,
  7300           DFHEIV99
  7301     MOVE EIBRESP  TO WS-RESPONSE
  7302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7303     .
  7304 0750-EXIT.
  7305     EXIT.
  7306 0760-FIND-COMM.
  7307     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  7308        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  7309        OR (C1 > +3)
  7310     END-PERFORM
  7311     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  7312        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  7313        OR (C2 > +3)
  7314     END-PERFORM
  7315     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  7316        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  7317        OR (C3 > +3)
  7318     END-PERFORM
  7319     IF C1 > +3
  7320        MOVE +1                  TO C1
  7321     END-IF
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 128
* SOCK03.cbl
  7322     IF C2 > +3
  7323        MOVE +1                  TO C2
  7324     END-IF
  7325     IF C3 > +3
  7326        MOVE +1                  TO C3
  7327     END-IF
  7328     IF C1 = +3
  7329        MOVE +18                 TO C0
  7330     ELSE
  7331        IF C1 = +2
  7332           MOVE +9               TO C0
  7333        END-IF
  7334     END-IF
  7335     IF C2 = +3
  7336        ADD +6                   TO C0
  7337     ELSE
  7338        IF C2 = +2
  7339           ADD +3                TO C0
  7340        END-IF
  7341     END-IF
  7342     ADD C3                      TO C0
  7343     MOVE CT-RT (C0)             TO WS-COMM-PCT
  7344     .
  7345 0760-EXIT.
  7346     EXIT.
  7347 9700-DATE-LINK.
  7348
  7349* EXEC CICS LINK
  7350*         PROGRAM  ('ELDATCV')
  7351*         COMMAREA (DATE-CONVERSION-DATA)
  7352*         LENGTH   (DC-COMM-LENGTH)
  7353*    END-EXEC.
  7354     MOVE 'ELDATCV' TO DFHEIV1
  7355*    MOVE '."C                   (   #00006684' TO DFHEIV0
  7356     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7357     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7358     MOVE X'2020233030303036363834' TO DFHEIV0(25:11)
  7359     CALL 'kxdfhei1' USING DFHEIV0,
  7360           DFHEIV1,
  7361           DATE-CONVERSION-DATA,
  7362           DC-COMM-LENGTH,
  7363           DFHEIV99,
  7364           DFHEIV99,
  7365           DFHEIV99,
  7366           DFHEIV99
  7367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7368
  7369 9700-EXIT.
  7370      EXIT.
  7371
  7372 9999-DFHBACK SECTION.
  7373     MOVE '9%                    "   ' TO DFHEIV0
  7374     MOVE 'SOCK03' TO DFHEIV1
  7375     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7376     GOBACK.
  7377 9999-DFHEXIT.
  7378     IF DFHEIGDJ EQUAL 0001
  7379         NEXT SENTENCE.
* Micro Focus Server Express         V5.1 revision 000 09-Aug-19 14:45 Page 129
* SOCK03.cbl
  7380     MOVE '9%                    "   ' TO DFHEIV0
  7381     MOVE 'SOCK03' TO DFHEIV1
  7382     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7383     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       20144     Code:       30826
