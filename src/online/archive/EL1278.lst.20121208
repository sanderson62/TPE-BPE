* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page   1
* EL1278.cbl
* Options: int("EL1278.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1278.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1278.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1278.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1278.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/21/94 14:09:26.
     7*                            VMOD=2.030.
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page   2
* EL1278.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXXA - CANCELLATION QUOTE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101201    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37* 070105    2005063000003  PEMA  COMMENT OUT CODE THAT ADDS 1
    38*         TO THE TERM AND REMAINING TERM
    39* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    40* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    41* 111907  CR2004020600011  PEMA  FORCE FP TO REFUND AS FP
    42* 022608  CR2008010200006  PEMA  CHANGE MO RTERM MTHOD
    43* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
    44* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
    45* 021710  IR2010021000002  PEMA  ADD CANCEL DATE EDIT
    46* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
    47* 042011  CR2010030900001  PEMA ADD CLM PROCESSING ON QUOTES
    48* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    49* 010412  CR2011022800001  AJRA  NAPERSOFT CANCEL PROCESSING
    50* 032912  CR2011110200001  PEMA  AHL CHANGES
    51* 062712  CR2011022800001  AJRA NAPERSOFT
    52* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    53* 102212  CR2012013100001  PEMA  ALLOW MN OVERRIDE RF
    54******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page   3
* EL1278.cbl
    56 ENVIRONMENT DIVISION.
    57 DATA DIVISION.
    58 WORKING-STORAGE SECTION.
    59 01  DFH-START PIC X(04).
    60 77  FILLER  PIC  X(32) VALUE '********************************'.
    61 77  FILLER  PIC  X(32) VALUE '*    EL1278 WORKING STORAGE    *'.
    62 77  FILLER  PIC  X(32) VALUE '*********** VMOD=2.030 *********'.
    63 77  S1                          PIC S999 COMP-3 VALUE +0.
    64 77  P1                          PIC S999 COMP-3 VALUE +0.
    65 77  P2                          PIC S999 COMP-3 VALUE +0.
    66 77  C0                          PIC S999 COMP-3 VALUE +0.
    67 77  C1                          PIC S999 COMP-3 VALUE +0.
    68 77  C2                          PIC S999 COMP-3 VALUE +0.
    69 77  C3                          PIC S999 COMP-3 VALUE +0.
    70 77  WS-STOP-SW                  PIC X  VALUE ' '.
    71     88  I-SAY-TO-STOP      VALUE 'Y'.
    72 77  WS-OPEN-LF-CLAIM            PIC X  VALUE ' '.
    73     88  OPEN-LF-CLAIM              VALUE 'Y'.
    74 77  WS-CLOSED-LF-CLAIM          PIC X  VALUE ' '.
    75     88  CLOSED-LF-CLAIM            VALUE 'Y'.
    76 77  WS-OPEN-AH-CLAIM            PIC X  VALUE ' '.
    77     88  OPEN-AH-CLAIM              VALUE 'Y'.
    78 77  WS-CLOSED-AH-CLAIM          PIC X  VALUE ' '.
    79     88  CLOSED-AH-CLAIM            VALUE 'Y'.
    80 77  WS-FOUND-A-CLAIM            PIC X  VALUE ' '.
    81     88  FOUND-A-CLAIM              VALUE 'Y'.
    82 77  WS-ST-REF-IND               PIC X.
    83 77  WS-LF-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    84 77  WS-AH-INCUR-DT              PIC XX  VALUE LOW-VALUES.
    85 77  WS-AH-PAID-THRU-DT          PIC XX  VALUE LOW-VALUES.
    86 77  WS-LF-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    87 77  WS-AH-LAST-CLOSE-DT         PIC XX  VALUE LOW-VALUES.
    88 77  DD-IU-SW                    PIC X   VALUE ' '.
    89     88  DD-IU-PRESENT                 VALUE 'Y'.
    90 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    91 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    92 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    93 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    94 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    95 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    96 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    97 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    98 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    99     88  NO-CERT-RW                 VALUE 'N'.
   100     88  CERT-RW                    VALUE 'Y'.
   101 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   102     88  ERMAIL-FOUND                 VALUE 'Y'.
   103
   104*                            COPY ELCSCTM.
   105******************************************************************
   106*                                                                *
   107*                                                                *
   108*                            ELCSCTM                             *
   109*                            VMOD=2.001                          *
   110*                                                                *
   111*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   112*                                                                *
   113******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page   4
* EL1278.cbl
   114 01  SECURITY-MESSAGE.
   115     12  FILLER                          PIC X(30)
   116            VALUE '** LOGIC SECURITY VIOLATION -'.
   117     12  SM-READ                         PIC X(6).
   118     12  FILLER                          PIC X(5)
   119            VALUE ' PGM='.
   120     12  SM-PGM                          PIC X(6).
   121     12  FILLER                          PIC X(5)
   122            VALUE ' OPR='.
   123     12  SM-PROCESSOR-ID                 PIC X(4).
   124     12  FILLER                          PIC X(6)
   125            VALUE ' TERM='.
   126     12  SM-TERMID                       PIC X(4).
   127     12  FILLER                          PIC XX   VALUE SPACE.
   128     12  SM-JUL-DATE                     PIC 9(5).
   129     12  FILLER                          PIC X    VALUE SPACE.
   130     12  SM-TIME                         PIC 99.99.
   131
   132
   133*                            COPY ELCSCRTY.
   134******************************************************************
   135*                                                                *
   136*                                                                *
   137*                            ELCSCRTY                            *
   138*                            VMOD=2.001                          *
   139*                                                                *
   140*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   141*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   142*        SAVED IN PI-SECURITY-ADDRESS.                           *
   143*                                                                *
   144******************************************************************
   145 01  SECURITY-CONTROL.
   146     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   147     12  FILLER                       PIC XX    VALUE 'SC'.
   148     12  SC-CREDIT-CODES.
   149         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   150             20  SC-CREDIT-DISPLAY    PIC X.
   151             20  SC-CREDIT-UPDATE     PIC X.
   152     12  SC-CLAIMS-CODES.
   153         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   154             20  SC-CLAIMS-DISPLAY    PIC X.
   155             20  SC-CLAIMS-UPDATE     PIC X.
   156
   157 01  FILLER          COMP-3.
   158     12  WS-BALLOON-RTRM         PIC S9(03)      VALUE ZERO.
   159     12  WS-ELAPSED-MONTHS       PIC S9(03)      VALUE ZERO.
   160     12  WS-TOT-AH-PREM          PIC S9(9)V99    VALUE ZERO.
   161     12  WS-TOT-LF-PREM          PIC S9(9)V99    VALUE ZERO.
   162     12  WS-TOT-AH-RFND          PIC S9(9)V99    VALUE ZERO.
   163     12  WS-TOT-LF-RFND          PIC S9(9)V99    VALUE ZERO.
   164     12  WS-TOT-PREM             PIC S9(9)V99    VALUE ZERO.
   165     12  WS-TOT-RFND             PIC S9(9)V99    VALUE ZERO.
   166     12  WS-TOT-ITDR             PIC S9(9)V99    VALUE ZERO.
   167
   168 01  WS-DATE-AREA.
   169     12  SAVE-DATE               PIC  X(08)      VALUE SPACES.
   170     12  SAVE-BIN-DATE           PIC  X(02)      VALUE SPACES.
   171     12  WS-LF-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page   5
* EL1278.cbl
   172     12  WS-AH-CANCEL-DATE       PIC  X(02)      VALUE SPACES.
   173     12  WS-LF-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   174     12  WS-AH-CANCEL-DATE-ED    PIC  X(08)      VALUE SPACES.
   175
   176 01  ERPDEF-KEY-SAVE             PIC X(18).
   177 01  ERPDEF-KEY.
   178     12  ERPDEF-COMPANY-CD       PIC X.
   179     12  ERPDEF-STATE            PIC XX.
   180     12  ERPDEF-PROD-CD          PIC XXX.
   181     12  F                       PIC X(7).
   182     12  ERPDEF-BEN-TYPE         PIC X.
   183     12  ERPDEF-BEN-CODE         PIC XX.
   184     12  ERPDEF-EXP-DT           PIC XX.
   185 01  ELMSTR-KEY.
   186     12  ELMSTR-COMP-CD          PIC X.
   187     12  ELMSTR-CERT-NO          PIC X(11).
   188 01  ELCRTO-KEY.
   189     05  ELCRTO-COMPANY-CD       PIC X.
   190     05  ELCRTO-CARRIER          PIC X.
   191     05  ELCRTO-GROUPING         PIC X(6).
   192     05  ELCRTO-STATE            PIC XX.
   193     05  ELCRTO-ACCOUNT          PIC X(10).
   194     05  ELCRTO-CERT-EFF-DT      PIC XX.
   195     05  ELCRTO-CERT-NO.
   196         10  ELCRTO-CERT-PRIME   PIC X(10).
   197         10  ELCRTO-CERT-SFX     PIC X.
   198     05  ELCRTO-RECORD-TYPE      PIC X.
   199     05  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   200
   201 01  STANDARD-AREAS.
   202     12  SC-ITEM                 PIC S9(04) COMP VALUE +0001.
   203     12  SUB3                    PIC S9(04) COMP VALUE +0.
   204     12  SUB4                    PIC S9(04) COMP VALUE +0.
   205     12  GETMAIN-SPACE           PIC  X(01)      VALUE SPACE.
   206     12  MAP-NAME                PIC  X(08)      VALUE 'EL127H'.
   207     12  MAPSET-NAME             PIC  X(08)      VALUE 'EL1278S'.
   208     12  SCREEN-NUMBER           PIC  X(04)      VALUE '127H'.
   209     12  TRANS-ID                PIC  X(04)      VALUE 'EXXA'.
   210     12  THIS-PGM                PIC  X(08)      VALUE 'EL1278'.
   211     12  PGM-NAME                PIC  X(08).
   212     12  TIME-IN                 PIC S9(07).
   213     12  TIME-OUT-R  REDEFINES  TIME-IN.
   214         16  FILLER              PIC  X(01).
   215         16  TIME-OUT            PIC  9(02)V99.
   216         16  FILLER              PIC  X(02).
   217     12  XCTL-005                PIC  X(08)      VALUE 'EL005'.
   218     12  XCTL-010                PIC  X(08)      VALUE 'EL010'.
   219     12  XCTL-126                PIC  X(08)      VALUE 'EL126'.
   220     12  LINK-001                PIC  X(08)      VALUE 'EL001'.
   221     12  LINK-004                PIC  X(08)      VALUE 'EL004'.
   222     12  LINK-ELDATCV            PIC  X(08)      VALUE 'ELDATCV'.
   223     12  ELRTRM-ID               PIC  X(08)      VALUE 'ELRTRM'.
   224     12  ELRAMT-ID               PIC  X(08)      VALUE 'ELRAMT'.
   225     12  ELRFND-ID               PIC  X(08)      VALUE 'ELRFND'.
   226     12  ELCNTL-ID               PIC  X(08)      VALUE 'ELCNTL'.
   227     12  ERACCT-ID               PIC  X(08)      VALUE 'ERACCT'.
   228     12  ELCERT-ID               PIC  X(08)      VALUE 'ELCERT'.
   229     12  ERMAIL-ID               PIC  X(08)      VALUE 'ERMAIL'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page   6
* EL1278.cbl
   230     12  ERFORM-ID               PIC  X(08)      VALUE 'ERFORM'.
   231     12  ERNOTE-ID               PIC  X(08)      VALUE 'ERCNOT'.
   232     12  DATE-RANGE-SW           PIC  X(01)      VALUE SPACE.
   233     12  WS-REFUND-SEARCH-SW     PIC  X(01)      VALUE ' '.
   234         88  LIFE-REFUND-SEARCH                  VALUE 'L'.
   235     12  WS-BROWSE-STARTED-SW    PIC  X(01)      VALUE SPACE.
   236         88  BROWSE-STARTED                      VALUE 'Y'.
   237     12  WS-FORM-RECORD-SW       PIC  X(01)      VALUE SPACE.
   238         88  FORM-FOUND                          VALUE 'Y'.
   239     12  BEN-SEARCH-SW           PIC  X(01)      VALUE SPACE.
   240         88  NO-BENEFIT-FOUND                    VALUE 'N'.
   241     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   242         88  WS-REDUCING                         VALUE 'R'.
   243         88  WS-LEVEL                            VALUE 'L'  'P'.
   244     12  WS-NEW-LF-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   245         88  WS-NEW-LF-CANCEL                    VALUE 'Y'.
   246     12  WS-NEW-AH-CANCEL-SW     PIC  X(01)      VALUE 'N'.
   247         88  WS-NEW-AH-CANCEL                    VALUE 'Y'.
   248     12  WS-BENEFIT-DESCRIP      PIC  X(10)      VALUE SPACES.
   249     12  WS-PMT-DESCRIP          PIC  X(10)      VALUE
   250         'CLAIM PMTS'.
   251     12  WS-REFUND-DESCRIP       PIC  X(10)      VALUE
   252         'ITD REFUND'.
   253     12  WS-ACCESS.
   254         16  FILLER              PIC  X(02).
   255         16  WS-BEN-CD           PIC  X(02).
   256     12  WS-KIND                 PIC  X(03)      VALUE SPACES.
   257     12  WS-LF-KIND              PIC  X(03)      VALUE SPACES.
   258     12  WS-AH-KIND              PIC  X(03)      VALUE SPACES.
   259     12  WS-LOOKUP-TYPE          PIC  X(01).
   260     12  WS-BENEFIT-NO           PIC  X(02)      VALUE ZERO.
   261     12  WS-STATE-ABBREVIATION   PIC  X(02)      VALUE SPACES.
   262     12  WS-CALC-CD              PIC  X(01).
   263     12  DEEDIT-FIELD            PIC  X(15).
   264     12  DEEDIT-FIELD-V0  REDEFINES
   265         DEEDIT-FIELD            PIC S9(15).
   266     12  WS-CURRENT-DATE         PIC  X(02)  VALUE LOW-VALUES.
   267     12  RETURN-FROM             PIC  X(08).
   268     12  QID.
   269         16  QID-TERM            PIC  X(04).
   270         16  FILLER              PIC  X(04)      VALUE '127H'.
   271     12  WS-FIRST-ENTRY-SW       PIC  X(01)      VALUE SPACE.
   272         88  FIRST-ENTRY                         VALUE 'Y'.
   273     12  WS-PDEF-RECORD-SW       PIC X           VALUE ' '.
   274         88  PDEF-FOUND                          VALUE 'Y'.
   275     12  WS-CERT-RECORD-SW       PIC  X(01)      VALUE SPACE.
   276         88  CERT-FOUND                          VALUE 'Y'.
   277         88  CERT-NOT-FOUND                      VALUE 'N'.
   278     12  WS-CNTL-RECORD-SW       PIC  X(01)      VALUE SPACE.
   279         88  CNTL-FOUND                          VALUE 'Y'.
   280         88  CNTL-NOT-FOUND                      VALUE 'N'.
   281     12  WS-BEN-RECORD-SW        PIC  X(01)      VALUE SPACE.
   282         88  BEN-FOUND                           VALUE 'Y'.
   283     12  WS-STATE-RECORD-SW      PIC  X(01)      VALUE SPACE.
   284         88  STATE-FOUND                         VALUE 'Y'.
   285     12  WS-ST-BEN-RECORD-SW     PIC  X(01)      VALUE SPACE.
   286         88  ST-BEN-FOUND                        VALUE 'Y'.
   287     12  WS-ACCT-RECORD-SW       PIC  X(01)      VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page   7
* EL1278.cbl
   288         88  ACCT-FOUND                          VALUE 'Y'.
   289     12  WS-DUPREC-SW            PIC  X(01)      VALUE SPACE.
   290         88  DUPLICATE-RECORD-FOUND              VALUE 'Y'.
   291     12  WS-NOT-FOUND            PIC S9(01) COMP-3
   292                                                 VALUE ZERO.
   293         88  BENEFIT-FOUND                       VALUE +1.
   294     12  WS-CALC-REFUND          PIC S9(07)V99 COMP-3
   295                                                 VALUE ZERO.
   296     12  WS-LIFE-PREMIUM         PIC S9(07)V99 COMP-3
   297                                                 VALUE ZERO.
   298     12  WS-INDEX                PIC S9(04) COMP VALUE ZERO.
   299     12  WS-SUB1                 PIC S99    COMP.
   300     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   301     12  WS-CF-DEFAULT-APR       PIC  S9(03)V9(04) COMP-3.
   302     12  WS-CF-CR-R78-METHOD     PIC  X(01)      VALUE SPACE.
   303     12  WS-CF-CR-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   304     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   305     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   306     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   307     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   308     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   309     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   310     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   311     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   312     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   313     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   314     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   315     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   316     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   317     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   318     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   319     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   320     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   321     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   322     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   323     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   324     12  ERROR-MESSAGES.
   325         16  ER-0000             PIC  X(04)      VALUE '0000'.
   326         16  ER-0004             PIC  X(04)      VALUE '0004'.
   327         16  ER-0008             PIC  X(04)      VALUE '0008'.
   328         16  ER-0028             PIC  X(04)      VALUE '0028'.
   329         16  ER-0029             PIC  X(04)      VALUE '0029'.
   330         16  ER-0070             PIC  X(04)      VALUE '0070'.
   331         16  ER-0142             PIC  X(04)      VALUE '0142'.
   332         16  ER-0214             PIC  X(04)      VALUE '0214'.
   333         16  ER-0681             PIC  X(04)      VALUE '0681'.
   334         16  ER-0682             PIC  X(04)      VALUE '0682'.
   335         16  ER-0683             PIC  X(04)      VALUE '0683'.
   336         16  ER-0684             PIC  X(04)      VALUE '0684'.
   337         16  ER-2227             PIC  X(04)      VALUE '2227'.
   338         16  ER-2601             PIC  X(04)      VALUE '2601'.
   339         16  ER-2616             PIC  X(04)      VALUE '2616'.
   340         16  ER-2617             PIC  X(04)      VALUE '2617'.
   341         16  ER-2619             PIC  X(04)      VALUE '2619'.
   342         16  ER-2740             PIC  X(04)      VALUE '2740'.
   343         16  ER-2756             PIC  X(04)      VALUE '2756'.
   344         16  ER-2768             PIC  X(04)      VALUE '2768'.
   345         16  ER-2774             PIC  X(04)      VALUE '2774'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page   8
* EL1278.cbl
   346         16  ER-2775             PIC  X(04)      VALUE '2775'.
   347         16  ER-2965             PIC  X(04)      VALUE '2965'.
   348         16  ER-2966             PIC  X(04)      VALUE '2966'.
   349         16  ER-2967             PIC  X(04)      VALUE '2967'.
   350         16  ER-2968             PIC  X(04)      VALUE '2968'.
   351         16  ER-2969             PIC  X(04)      VALUE '2969'.
   352         16  ER-3037             PIC  X(04)      VALUE '3037'.
   353         16  ER-3038             PIC  X(04)      VALUE '3038'.
   354         16  ER-3039             PIC  X(04)      VALUE '3039'.
   355         16  ER-3780             PIC  X(04)      VALUE '3780'.
   356         16  ER-3781             PIC  X(04)      VALUE '3781'.
   357         16  ER-3830             PIC  X(04)      VALUE '3830'.
   358         16  ER-8160             PIC  X(04)      VALUE '8160'.
   359         16  ER-8161             PIC  X(04)      VALUE '8161'.
   360         16  ER-9999             PIC  X(04)      VALUE '9999'.
   361     12  WS-CF-LIFE-OVERRIDE-L1  PIC  X(01).
   362     12  WS-CF-LIFE-OVERRIDE-L2  PIC  X(02).
   363     12  WS-CF-AH-OVERRIDE-L1    PIC  X(01).
   364     12  WS-CF-AH-OVERRIDE-L2    PIC  X(02).
   365
   366     12  WS-RESPONSE             PIC S9(8)       COMP.
   367         88  WS-RESP-NORMAL                      VALUE +00.
   368         88  WS-RESP-NOTFND                      VALUE +13.
   369         88  WS-RESP-DUPREC                      VALUE +14.
   370         88  WS-RESP-DUPKEY                      VALUE +15.
   371         88  WS-RESP-NOTOPEN                     VALUE +19.
   372         88  WS-RESP-ENDFILE                     VALUE +20.
   373
   374     12  WS-01-CANCEL-ERR        PIC X(25)
   375         VALUE 'CANCEL DATE ERROR'.
   376     12  WS-02-CANCEL-ERR        PIC X(25)
   377         VALUE 'CERT NOT FOUND'.
   378     12  WS-04-CANCEL-ERR        PIC X(25)
   379         VALUE 'CANCEL AMOUNT ERROR'.
   380     12  WS-05-CANCEL-ERR        PIC X(25)
   381         VALUE 'CANCEL OPTION ERROR'.
   382     12  WS-06-CANCEL-ERR        PIC X(25)
   383         VALUE 'PREVIOUSLY CANCELLED'.
   384     12  WS-07-CANCEL-ERR        PIC X(25)
   385         VALUE 'INVALID DATA'.
   386     12  WS-08-CANCEL-ERR        PIC X(25)
   387         VALUE 'NO ACCOUNT MASTER'.
   388     12  WS-09-CANCEL-ERR        PIC X(25)
   389         VALUE 'SUFFIX ALREADY EXISTS'.
   390     12  WS-99-CANCEL-ERR        PIC X(25)
   391         VALUE 'MISC CANCEL ERROR'.
   392
   393 01  WS-SAVE-ALLOWABLE-BENEFIT.
   394     16  WS-SAVE-BENEFIT-CODE      PIC XX.
   395     16  WS-SAVE-BENEFIT-TYPE      PIC X.
   396     16  WS-SAVE-BENEFIT-REVISION  PIC XXX.
   397     16  WS-SAVE-BENEFIT-REM-TERM  PIC X.
   398     16  WS-SAVE-BENEFIT-RETRO-Y-N PIC X.
   399     16  FILLER                    PIC XX.
   400 01  CTBL-KEY-SAVE               PIC X(5).
   401 01  CTBL-KEY.
   402     05  CTBL-COMPANY-CD         PIC X.
   403     05  CTBL-TABLE              PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page   9
* EL1278.cbl
   404     05  CTBL-BEN-TYPE           PIC X.
   405     05  CTBL-BEN-CODE           PIC XX.
   406 01  CANCEL-GEN-PASS-AREA.
   407     05  CG-OPTION-CODE          PIC X.
   408         88  CG-VALID-OPTION       VALUE '1' '2' '3'.
   409         88  CG-FLAT-CANCEL        VALUE '1'.
   410         88  CG-CANCEL             VALUE '2'.
   411         88  CG-CANCEL-REISSUE     VALUE '3'.
   412     05  CG-ERROR-CODE           PIC 99.
   413         88  CG-SUCCESS            VALUE 00.
   414         88  CG-DATE-ERROR         VALUE 01.
   415         88  CG-CERT-NOT-FOUND     VALUE 02.
   416         88  CG-AMOUNT-ERROR       VALUE 04.
   417         88  CG-OPTION-ERROR       VALUE 05.
   418         88  CG-PREV-CAN           VALUE 06.
   419         88  CG-INVALID-DATA       VALUE 07.
   420         88  CG-NO-ACCT-MSTR       VALUE 08.
   421         88  CG-SFX-A-EXIST        VALUE 09.
   422         88  CG-MISC-ERROR         VALUE 99.
   423     05  CG-COMPANY-ID           PIC XXX.
   424     05  CG-PROC-ID              PIC XXXX.
   425     05  CG-CURRENT-DT           PIC XX.
   426     05  CG-MONTH-END-DT         PIC XX.
   427     05  CG-CERT-KEY.
   428         10  CG-CERT-COMPANY-CD  PIC X.
   429         10  CG-CERT-CARRIER     PIC X.
   430         10  CG-CERT-GROUP       PIC X(6).
   431         10  CG-CERT-STATE       PIC XX.
   432         10  CG-CERT-ACCOUNT     PIC X(10).
   433         10  CG-CERT-EFF-DT      PIC XX.
   434         10  CG-CERT-CERT-NO     PIC X(11).
   435     05  CG-LF-CAN-DATA.
   436         10  CG-LF-CAN-DT        PIC XX.
   437         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   438     05  CG-AH-CAN-DATA.
   439         10  CG-AH-CAN-DT        PIC XX.
   440         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   441     05  CG-CERT-PROFILE-DATA.
   442         10  CG-INS-LNAME        PIC X(15).
   443         10  CG-INS-FNAME        PIC X(10).
   444         10  CG-INS-MID-INIT     PIC X.
   445         10  CG-INS-AGE          PIC 99.
   446         10  CG-JNT-LNAME        PIC X(15).
   447         10  CG-JNT-FNAME        PIC X(10).
   448         10  CG-JNT-MID-INIT     PIC X.
   449         10  CG-JNT-AGE          PIC 99.
   450     05  CG-LF-ISS-DATA.
   451         10  CG-LF-BENCD         PIC XX.
   452         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   453         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   454     05  CG-AH-ISS-DATA.
   455         10  CG-AH-BENCD         PIC XX.
   456         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   457     05  CG-BATCH-NO             PIC X(6).
   458     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   459     05  FILLER                  PIC X(306).
   460 01  WS-CAN-QUOTE-NOTE.
   461     12  WS-CN-DT-QUOTED         PIC  X(09).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  10
* EL1278.cbl
   462     12  FILLER                  PIC  X(10)      VALUE
   463         'RF QUOTE: '.
   464     12  WS-CN-LIFE-AMT-RF       PIC  Z,ZZ9.99.
   465     12  FILLER                  PIC  X(4)       VALUE
   466         ' LF '.
   467     12  WS-CN-LF-REF-METH       PIC  X.
   468     12  FILLER                  PIC  X          VALUE ','.
   469     12  WS-CN-AH-AMT-RF         PIC  Z,ZZ9.99.
   470     12  FILLER                  PIC  X(5)       VALUE
   471         ' AH '.
   472     12  WS-CN-AH-REF-METH       PIC  X.
   473     12  FILLER                  PIC  XX         VALUE ','.
   474     12  FILLER                  PIC  X(6)       VALUE
   475         'TOTAL '.
   476     12  WS-CN-TOTAL-RF          PIC  Z,ZZ9.99.
   477     12  FILLER                  PIC  X(01)      VALUE ' '.
   478     12  WS-CN-CANCEL-DT         PIC  X(08).
   479     12  FILLER                  PIC  X(01)      VALUE ';'.
   480     12  WS-CN-PROCESSOR-ID      PIC  X(04).
   481
   482 01  WS-CM-CONTROL-PRIMARY.
   483     12  WS-CM-COMPANY-CD        PIC  X(01).
   484     12  WS-CM-CARRIER           PIC  X(01).
   485     12  WS-CM-GROUPING          PIC  X(06).
   486     12  WS-CM-STATE             PIC  X(02).
   487     12  WS-CM-ACCOUNT           PIC  X(10).
   488     12  WS-CM-CERT-EFF-DT       PIC  X(02).
   489     12  WS-CM-CERT-NO.
   490         16  WS-CM-CERT-PRIME    PIC  X(10).
   491         16  WS-CM-CERT-SFX      PIC  X(01).
   492
   493 01  WS-MA-CONTROL-PRIMARY.
   494     12  WS-MA-COMPANY-CD        PIC  X(01).
   495     12  WS-MA-CARRIER           PIC  X(01).
   496     12  WS-MA-GROUPING          PIC  X(06).
   497     12  WS-MA-STATE             PIC  X(02).
   498     12  WS-MA-ACCOUNT           PIC  X(10).
   499     12  WS-MA-CERT-EFF-DT       PIC  X(02).
   500     12  WS-MA-CERT-NO.
   501         16  WS-MA-CERT-PRIME    PIC  X(10).
   502         16  WS-MA-CERT-SFX      PIC  X(01).
   503 01  WS-CF-CONTROL-PRIMARY.
   504     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   505     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   506*        88  COMPANY-MASTER                      VALUE '1'.
   507*        88  STATE-MASTER                        VALUE '3'.
   508*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   509*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   510     12  WS-CF-ACCESS.
   511         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   512         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   513             20  FILLER          PIC  X(01).
   514             20  WS-CF-CARRIER   PIC  X(01).
   515     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   516
   517 01  WS-AM-CONTROL-PRIMARY.
   518     12  WS-AM-COMPANY-CD        PIC  X(01).
   519     12  WS-AM-CARRIER           PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  11
* EL1278.cbl
   520     12  WS-AM-GROUPING          PIC  X(06).
   521     12  WS-AM-STATE             PIC  X(02).
   522     12  WS-AM-ACCOUNT           PIC  X(10).
   523     12  WS-AM-EXPIRATION-DT     PIC  X(02).
   524     12  WS-AM-FILLER            PIC  X(04).
   525
   526 01  WS-CN-CONTROL-PRIMARY.
   527     12  WS-CN-COMPANY-CD        PIC  X(01).
   528     12  WS-CN-CARRIER           PIC  X(01).
   529     12  WS-CN-GROUPING          PIC  X(06).
   530     12  WS-CN-STATE             PIC  X(02).
   531     12  WS-CN-ACCOUNT           PIC  X(10).
   532     12  WS-CN-CERT-EFF-DT       PIC  X(02).
   533     12  WS-CN-CERT-NO.
   534         16  WS-CN-CERT-PRIME    PIC  X(10).
   535         16  WS-CN-CERT-SFX      PIC  X.
   536     12  WS-CN-REC-TYPE          PIC X.
   537     12  WS-CN-SEQ-NO            PIC 9(4) BINARY.
   538
   539 01  WS-FO-CONTROL-PRIMARY.
   540     12  WS-FO-COMPANY-CD        PIC  X(01).
   541     12  WS-FO-STATE             PIC  X(02).
   542     12  WS-FO-FORM-ID           PIC  X(12).
   543     12  WS-FO-EXP-DT            PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  12
* EL1278.cbl
   545*                            COPY ERCCNOT.
   546******************************************************************
   547*                                                                *
   548*                            ERCCNOT                             *
   549*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   550*                            VMOD=2.003                          *
   551*                                                                *
   552*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
   553*                                                                *
   554*        FILE TYPE= VSAM,KSDS                                    *
   555*        RECORD SIZE = 150    RECFORM = FIXED                    *
   556*                                                                *
   557*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
   558*                                                                *
   559*        LOG = YES                                               *
   560*        SERVREQ = DELETE,UPDATE,NEWREC                          *
   561*                                                                *
   562******************************************************************
   563*                   C H A N G E   L O G
   564*
   565* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   566*-----------------------------------------------------------------
   567*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   568* EFFECTIVE    NUMBER
   569*-----------------------------------------------------------------
   570* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
   571******************************************************************
   572
   573 01  CERT-NOTE-FILE.
   574     12  CZ-RECORD-ID                PIC  XX.
   575         88  VALID-CZ-ID                  VALUE 'CZ'.
   576
   577     12  CZ-CONTROL-PRIMARY.
   578         16  CZ-COMPANY-CD           PIC X.
   579         16  CZ-CARRIER              PIC X.
   580         16  CZ-GROUPING.
   581             20 CZ-GROUPING-PREFIX   PIC XXX.
   582             20 CZ-GROUPING-PRIME    PIC XXX.
   583         16  CZ-STATE                PIC XX.
   584         16  CZ-ACCOUNT.
   585             20 CZ-ACCOUNT-PREFIX    PIC X(4).
   586             20 CZ-ACCOUNT-PRIME     PIC X(6).
   587         16  CZ-CERT-EFF-DT          PIC XX.
   588         16  CZ-CERT-NO.
   589             20  CZ-CERT-PRIME       PIC X(10).
   590             20  CZ-CERT-SFX         PIC X.
   591         16  CZ-RECORD-TYPE          PIC X.
   592             88  CERT-NOTE           VALUE '1'.
   593             88  CLAIM-CERT-NOTE     VALUE '2'.
   594         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
   595
   596     12  CZ-LAST-MAINT-DT            PIC XX.
   597     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
   598     12  CZ-LAST-MAINT-USER          PIC X(4).
   599
   600     12  CZ-NOTE-INFORMATION.
   601         16  CZ-NOTE                 PIC X(63).
   602         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  13
* EL1278.cbl
   603******************************************************************
   604*                            COPY ELCDATE.
   605******************************************************************
   606*                                                                *
   607*                                                                *
   608*                            ELCDATE.                            *
   609*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   610*                            VMOD=2.003
   611*                                                                *
   612*                                                                *
   613*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   614*                 LENGTH = 200                                   *
   615******************************************************************
   616
   617 01  DATE-CONVERSION-DATA.
   618     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   619     12  DC-OPTION-CODE                PIC X.
   620         88  BIN-TO-GREG                VALUE ' '.
   621         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   622         88  EDIT-GREG-TO-BIN           VALUE '2'.
   623         88  YMD-GREG-TO-BIN            VALUE '3'.
   624         88  MDY-GREG-TO-BIN            VALUE '4'.
   625         88  JULIAN-TO-BIN              VALUE '5'.
   626         88  BIN-PLUS-ELAPSED           VALUE '6'.
   627         88  FIND-CENTURY               VALUE '7'.
   628         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   629         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   630         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   631         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   632         88  JULIAN-TO-BIN-3            VALUE 'C'.
   633         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   634         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   635         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   636         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   637         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   638         88  CHECK-LEAP-YEAR            VALUE 'H'.
   639         88  BIN-3-TO-GREG              VALUE 'I'.
   640         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   641         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   642         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   643         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   644         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   645         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   646         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   647         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   648         88  THREE-CHARACTER-BIN
   649                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   650         88  GREGORIAN-TO-BIN
   651                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   652         88  BIN-TO-GREGORIAN
   653                  VALUES ' ' '1' 'I' '8' 'G'.
   654         88  JULIAN-TO-BINARY
   655                  VALUES '5' 'C' 'E' 'F'.
   656     12  DC-ERROR-CODE                 PIC X.
   657         88  NO-CONVERSION-ERROR        VALUE ' '.
   658         88  DATE-CONVERSION-ERROR
   659                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   660         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  14
* EL1278.cbl
   661         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   662         88  DATE-IS-INVALID            VALUE '3'.
   663         88  DATE1-GREATER-DATE2        VALUE '4'.
   664         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   665         88  DATE-INVALID-OPTION        VALUE '9'.
   666         88  INVALID-CENTURY            VALUE 'A'.
   667         88  ONLY-CENTURY               VALUE 'B'.
   668         88  ONLY-LEAP-YEAR             VALUE 'C'.
   669         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   670     12  DC-END-OF-MONTH               PIC X.
   671         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   672     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   673         88  USE-NORMAL-PROCESS         VALUE ' '.
   674         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   675         88  ADJUST-UP-100-YRS          VALUE '2'.
   676     12  FILLER                        PIC X.
   677     12  DC-CONVERSION-DATES.
   678         16  DC-BIN-DATE-1             PIC XX.
   679         16  DC-BIN-DATE-2             PIC XX.
   680         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   681         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   682                       DC-GREG-DATE-1-EDIT.
   683             20  DC-EDIT1-MONTH        PIC 99.
   684             20  SLASH1-1              PIC X.
   685             20  DC-EDIT1-DAY          PIC 99.
   686             20  SLASH1-2              PIC X.
   687             20  DC-EDIT1-YEAR         PIC 99.
   688         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   689         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   690                     DC-GREG-DATE-2-EDIT.
   691             20  DC-EDIT2-MONTH        PIC 99.
   692             20  SLASH2-1              PIC X.
   693             20  DC-EDIT2-DAY          PIC 99.
   694             20  SLASH2-2              PIC X.
   695             20  DC-EDIT2-YEAR         PIC 99.
   696         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   697         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   698                     DC-GREG-DATE-1-YMD.
   699             20  DC-YMD-YEAR           PIC 99.
   700             20  DC-YMD-MONTH          PIC 99.
   701             20  DC-YMD-DAY            PIC 99.
   702         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   703         16  DC-GREG-DATE-1-MDY-R REDEFINES
   704                      DC-GREG-DATE-1-MDY.
   705             20  DC-MDY-MONTH          PIC 99.
   706             20  DC-MDY-DAY            PIC 99.
   707             20  DC-MDY-YEAR           PIC 99.
   708         16  DC-GREG-DATE-1-ALPHA.
   709             20  DC-ALPHA-MONTH        PIC X(10).
   710             20  DC-ALPHA-DAY          PIC 99.
   711             20  FILLER                PIC XX.
   712             20  DC-ALPHA-CENTURY.
   713                 24 DC-ALPHA-CEN-N     PIC 99.
   714             20  DC-ALPHA-YEAR         PIC 99.
   715         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   716         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   717         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   718         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  15
* EL1278.cbl
   719         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   720                                       PIC 9(05).
   721         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   722             20  DC-JULIAN-YEAR        PIC 99.
   723             20  DC-JULIAN-DAYS        PIC 999.
   724         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   725         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   726         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   727     12  DATE-CONVERSION-VARIBLES.
   728         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   729         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   730             20  FILLER                PIC 9(3).
   731             20  HOLD-CEN-1-CCYY.
   732                 24  HOLD-CEN-1-CC     PIC 99.
   733                 24  HOLD-CEN-1-YY     PIC 99.
   734             20  HOLD-CEN-1-MO         PIC 99.
   735             20  HOLD-CEN-1-DA         PIC 99.
   736         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   737             20  HOLD-CEN-1-R-MO       PIC 99.
   738             20  HOLD-CEN-1-R-DA       PIC 99.
   739             20  HOLD-CEN-1-R-CCYY.
   740                 24  HOLD-CEN-1-R-CC   PIC 99.
   741                 24  HOLD-CEN-1-R-YY   PIC 99.
   742             20  FILLER                PIC 9(3).
   743         16  HOLD-CENTURY-1-X.
   744             20  FILLER                PIC X(3)  VALUE SPACES.
   745             20  HOLD-CEN-1-X-CCYY.
   746                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   747                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   748             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   749             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   750         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   751             20  HOLD-CEN-1-R-X-MO     PIC XX.
   752             20  HOLD-CEN-1-R-X-DA     PIC XX.
   753             20  HOLD-CEN-1-R-X-CCYY.
   754                 24  HOLD-CEN-1-R-X-CC PIC XX.
   755                 24  HOLD-CEN-1-R-X-YY PIC XX.
   756             20  FILLER                PIC XXX.
   757         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   758         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   759         16  DC-JULIAN-DATE-1          PIC 9(07).
   760         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   761             20  DC-JULIAN-1-CCYY.
   762                 24  DC-JULIAN-1-CC    PIC 99.
   763                 24  DC-JULIAN-1-YR    PIC 99.
   764             20  DC-JULIAN-DA-1        PIC 999.
   765         16  DC-JULIAN-DATE-2          PIC 9(07).
   766         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   767             20  DC-JULIAN-2-CCYY.
   768                 24  DC-JULIAN-2-CC    PIC 99.
   769                 24  DC-JULIAN-2-YR    PIC 99.
   770             20  DC-JULIAN-DA-2        PIC 999.
   771         16  DC-GREG-DATE-A-EDIT.
   772             20  DC-EDITA-MONTH        PIC 99.
   773             20  SLASHA-1              PIC X VALUE '/'.
   774             20  DC-EDITA-DAY          PIC 99.
   775             20  SLASHA-2              PIC X VALUE '/'.
   776             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  16
* EL1278.cbl
   777                 24  DC-EDITA-CENT     PIC 99.
   778                 24  DC-EDITA-YEAR     PIC 99.
   779         16  DC-GREG-DATE-B-EDIT.
   780             20  DC-EDITB-MONTH        PIC 99.
   781             20  SLASHB-1              PIC X VALUE '/'.
   782             20  DC-EDITB-DAY          PIC 99.
   783             20  SLASHB-2              PIC X VALUE '/'.
   784             20  DC-EDITB-CCYY.
   785                 24  DC-EDITB-CENT     PIC 99.
   786                 24  DC-EDITB-YEAR     PIC 99.
   787         16  DC-GREG-DATE-CYMD         PIC 9(08).
   788         16  DC-GREG-DATE-CYMD-R REDEFINES
   789                              DC-GREG-DATE-CYMD.
   790             20  DC-CYMD-CEN           PIC 99.
   791             20  DC-CYMD-YEAR          PIC 99.
   792             20  DC-CYMD-MONTH         PIC 99.
   793             20  DC-CYMD-DAY           PIC 99.
   794         16  DC-GREG-DATE-MDCY         PIC 9(08).
   795         16  DC-GREG-DATE-MDCY-R REDEFINES
   796                              DC-GREG-DATE-MDCY.
   797             20  DC-MDCY-MONTH         PIC 99.
   798             20  DC-MDCY-DAY           PIC 99.
   799             20  DC-MDCY-CEN           PIC 99.
   800             20  DC-MDCY-YEAR          PIC 99.
   801    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   802        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   803    12  DC-EL310-DATE                  PIC X(21).
   804    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  17
* EL1278.cbl
   806*                            COPY ELCLOGOF.
   807******************************************************************
   808*                                                                *
   809*                                                                *
   810*                            ELCLOGOF.                           *
   811*                            VMOD=2.001                          *
   812*                                                                *
   813*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   814*                                                                *
   815******************************************************************
   816 01  CLASIC-LOGOFF.
   817     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   818     12  LOGOFF-TEXT.
   819         16  FILLER          PIC X(5)    VALUE SPACES.
   820         16  LOGOFF-MSG.
   821             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   822             20  FILLER      PIC X       VALUE SPACES.
   823             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   824         16  FILLER          PIC X(80)
   825           VALUE '* YOU ARE NOW LOGGED OFF'.
   826         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   827         16  FILLER          PIC X       VALUE QUOTE.
   828         16  LOGOFF-SYS-MSG  PIC X(17)
   829           VALUE 'S CLAS-IC SYSTEM '.
   830     12  TEXT-MESSAGES.
   831         16  UNACCESS-MSG    PIC X(29)
   832             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   833         16  PGMIDERR-MSG    PIC X(17)
   834             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  18
* EL1278.cbl
   836*                            COPY ELCATTR.
   837******************************************************************
   838*                                                                *
   839*                            ELCATTR.                            *
   840*                            VMOD=2.001                          *
   841*                                                                *
   842*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   843*                                                                *
   844*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   845*                                                                *
   846*                   POS 1   P=PROTECTED                          *
   847*                           U=UNPROTECTED                        *
   848*                           S=ASKIP                              *
   849*                   POS 2   A=ALPHA/NUMERIC                      *
   850*                           N=NUMERIC                            *
   851*                   POS 3   N=NORMAL                             *
   852*                           B=BRIGHT                             *
   853*                           D=DARK                               *
   854*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   855*                           OF=MODIFIED DATA TAG OFF             *
   856*                                                                *
   857*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   858******************************************************************
   859 01  ATTRIBUTE-LIST.
   860     12  AL-PABOF            PIC X       VALUE 'Y'.
   861     12  AL-PABON            PIC X       VALUE 'Z'.
   862     12  AL-PADOF            PIC X       VALUE '%'.
   863     12  AL-PADON            PIC X       VALUE '_'.
   864     12  AL-PANOF            PIC X       VALUE '-'.
   865     12  AL-PANON            PIC X       VALUE '/'.
   866     12  AL-SABOF            PIC X       VALUE '8'.
   867     12  AL-SABON            PIC X       VALUE '9'.
   868     12  AL-SADOF            PIC X       VALUE '@'.
   869     12  AL-SADON            PIC X       VALUE QUOTE.
   870     12  AL-SANOF            PIC X       VALUE '0'.
   871     12  AL-SANON            PIC X       VALUE '1'.
   872     12  AL-UABOF            PIC X       VALUE 'H'.
   873     12  AL-UABON            PIC X       VALUE 'I'.
   874     12  AL-UADOF            PIC X       VALUE '<'.
   875     12  AL-UADON            PIC X       VALUE '('.
   876     12  AL-UANOF            PIC X       VALUE ' '.
   877     12  AL-UANON            PIC X       VALUE 'A'.
   878     12  AL-UNBOF            PIC X       VALUE 'Q'.
   879     12  AL-UNBON            PIC X       VALUE 'R'.
   880     12  AL-UNDOF            PIC X       VALUE '*'.
   881     12  AL-UNDON            PIC X       VALUE ')'.
   882     12  AL-UNNOF            PIC X       VALUE '&'.
   883     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  19
* EL1278.cbl
   885*                            COPY ELCEMIB.
   886******************************************************************
   887*                                                                *
   888*                                                                *
   889*                            ELCEMIB.                            *
   890*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   891*                            VMOD=2.005                          *
   892*                                                                *
   893*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   894*                                                                *
   895******************************************************************
   896 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   897     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   898     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   899     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   900     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   901     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   902     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   903     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   904     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   905     12  EMI-SWITCH1             PIC X        VALUE '1'.
   906         88  EMI-NO-ERRORS                    VALUE '1'.
   907         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   908         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   909     12  EMI-SWITCH2             PIC X        VALUE '1'.
   910         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   911     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   912         88  EMI-AREA1-EMPTY                  VALUE '1'.
   913         88  EMI-AREA1-FULL                   VALUE '2'.
   914     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   915         88  EMI-AREA2-EMPTY                  VALUE '1'.
   916         88  EMI-AREA2-FULL                   VALUE '2'.
   917     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   918         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   919         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   920         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   921         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   922         88  EMI-BYPASS-FATALS                VALUE 'X'.
   923     12  EMI-ERROR-LINES.
   924         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   925         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   926         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   927         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   928             20  EMI-ERR-CODES OCCURS 10 TIMES.
   929                 24  EMI-ERR-NUM         PIC X(4).
   930                 24  EMI-FILLER          PIC X.
   931                 24  EMI-SEV             PIC X.
   932                 24  FILLER              PIC X.
   933             20  FILLER                  PIC X(02).
   934     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   935         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   936             20  EMI-ERROR-NUMBER    PIC X(4).
   937             20  EMI-FILL            PIC X.
   938             20  EMI-SEVERITY        PIC X.
   939             20  FILLER              PIC X.
   940             20  EMI-ERROR-TEXT.
   941                 24  EMI-TEXT-VARIABLE   PIC X(10).
   942                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  20
* EL1278.cbl
   943     12  EMI-SEVERITY-SAVE           PIC X.
   944         88  EMI-NOTE                    VALUE 'N'.
   945         88  EMI-WARNING                 VALUE 'W'.
   946         88  EMI-FORCABLE                VALUE 'F'.
   947         88  EMI-FATAL                   VALUE 'X'.
   948     12  EMI-MESSAGE-FLAG            PIC X.
   949         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   950         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   951     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   952     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   953         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   954         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   955         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   956     12  FILLER                      PIC X(137)  VALUE SPACES.
   957     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   958     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   959     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   960     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  21
* EL1278.cbl
   962 01  WS-PASS-631.
   963     12  WS-PASS-WORK-AREA         PIC X(384).
   964     12  WS-PASS-PROGRAM-WORK-AREA PIC X(640).
   965     12  FILLER REDEFINES WS-PASS-PROGRAM-WORK-AREA.
   966*        COPY ELC631PI.
   967******************************************************************
   968*                                                                *
   969*                                                                *
   970*                            ELC631PI                            *
   971*                            VMOD=2.012                          *
   972*                                                                *
   973*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   974*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
   975*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   976*                                                                *
   977*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   978*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   979*    BETWEEN PROGRAMS.                                           *
   980*                                                                *
   981*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   982*                                                                *
   983*               EL631 - EL6311 - EL6312 - EL6313                 *
   984*                                                                *
   985******************************************************************
   986
   987         16  PI-631-DATA.
   988             20  PI-ERPNDB-KEY.
   989                 24  PI-PB-COMPANY-CD     PIC X.
   990                 24  PI-PB-ENTRY-BATCH    PIC X(6).
   991                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
   992                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
   993
   994             20  PI-ERPNDB-ALT-KEY.
   995                 24  PI-PB-COMPANY-CD-A1  PIC X.
   996                 24  PI-PB-CARRIER        PIC X.
   997                 24  PI-PB-GROUPING       PIC X(6).
   998                 24  PI-PB-STATE          PIC XX.
   999                 24  PI-PB-ACCOUNT        PIC X(10).
  1000                 24  PI-PB-CERT-EFF-DT    PIC XX.
  1001                 24  PI-PB-CERT-NO.
  1002                     28  PI-PB-CERT-PRIME PIC X(10).
  1003                     28  PI-PB-CERT-SFX   PIC X.
  1004                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  1005                 24  PI-PB-RECORD-TYPE    PIC X.
  1006
  1007             20  PI-ERPNDB-CSR-KEY.
  1008                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  1009                 24  PI-PB-CSR-ID             PIC X(4).
  1010                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  1011                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  1012                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  1013
  1014             20  PI-BROWSE-TYPE               PIC X.
  1015                 88  PI-FILE-BROWSE             VALUE ' '.
  1016                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  1017                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  1018                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  1019                 88  PI-CSR-BROWSE              VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  22
* EL1278.cbl
  1020
  1021             20  PI-MAINT-FUNCTION            PIC X.
  1022                 88  PI-ADD-FUNCTION            VALUE 'A'.
  1023                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  1024                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  1025                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  1026                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  1027                 88  PI-PF5-FUNCTION            VALUE '5'.
  1028                 88  PI-PF6-FUNCTION            VALUE '6'.
  1029
  1030             20  PI-FILE-SWITCHES.
  1031                 24  PI-ALL-ISSUES-SW         PIC X.
  1032                     88  ALL-ISSUES             VALUE 'Y'.
  1033                 24  PI-ALL-CANCELS-SW        PIC X.
  1034                     88  ALL-CANCELS            VALUE 'Y'.
  1035                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  1036                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  1037                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  1038                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  1039                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  1040                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  1041                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  1042                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  1043                 24  PI-HOLD-REC-SW           PIC X.
  1044                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  1045                 24  PI-CHANGE-REC-SW         PIC X.
  1046                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  1047                 24  PI-CHK-REQ-REC-SW        PIC X.
  1048                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  1049                 24  PI-ISSUE-WARNING-SW      PIC X.
  1050                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  1051                 24  PI-CANCEL-WARNING-SW     PIC X.
  1052                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  1053             20  PI-DISPLAY-SCREEN-SW         PIC X.
  1054                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  1055             20  PI-ORIGINAL-BATCH-SW         PIC X.
  1056                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  1057
  1058             20  PI-MAP-NAME                  PIC X(8).
  1059
  1060             20  PI-CURSOR                    PIC S9(4) COMP.
  1061
  1062             20  PI-PREV-ALT-KEY              PIC X(36).
  1063             20  PI-PREV-CSR-KEY              PIC X(15).
  1064             20  PI-PREV-KEY.
  1065                 24  PI-PREV-COMPANY-CD       PIC X.
  1066                 24  PI-PREV-BATCH            PIC X(6).
  1067                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  1068                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  1069             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  1070             20  PI-BROWSE-SW                 PIC X.
  1071                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  1072                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  1073             20  PI-SV-CARRIER                PIC X.
  1074             20  PI-SV-GROUPING               PIC X(6).
  1075             20  PI-SV-STATE                  PIC XX.
  1076             20  PI-EDIT-SW                   PIC X.
  1077             20  PI-DISPLAY-SW                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  23
* EL1278.cbl
  1078                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  1079                 88 PI-DISPLAY-AH          VALUE 'AH'.
  1080             20  PI-CRITERIA-DATA             PIC X(350).
  1081             20  PI-BMODE                     PIC X.
  1082             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  1083             20  PI-BPMTS                     PIC S999     COMP-3.
  1084             20  PI-BTYPE                     PIC XXX OCCURS 2.
  1085             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  1086             20  PI-CSR-SESSION-SW            PIC X.
  1087                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  1088             20  PI-ERRORS-SW                 PIC X.
  1089                 88  FATAL-ERRORS               VALUE 'X'.
  1090*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  1091             20  FILLER                       PIC X(5).
  1092
  1093         16  FILLER                PIC X(94).
  1094
  1095
  1096*                            COPY ELCINTF.
  1097******************************************************************
  1098*                                                                *
  1099*                                                                *
  1100*                            ELCINTF.                            *
  1101*                            VMOD=2.017                          *
  1102*                                                                *
  1103*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1104*                                                                *
  1105*       LENGTH = 1024                                            *
  1106*                                                                *
  1107******************************************************************
  1108*                   C H A N G E   L O G
  1109*
  1110* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1111*-----------------------------------------------------------------
  1112*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1113* EFFECTIVE    NUMBER
  1114*-----------------------------------------------------------------
  1115* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1116******************************************************************
  1117 01  PROGRAM-INTERFACE-BLOCK.
  1118     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1119     12  PI-CALLING-PROGRAM              PIC X(8).
  1120     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1121     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1122     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1123     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1124     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1125     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1126     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1127     12  PI-COMPANY-ID                   PIC XXX.
  1128     12  PI-COMPANY-CD                   PIC X.
  1129
  1130     12  PI-COMPANY-PASSWORD             PIC X(8).
  1131
  1132     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1133
  1134     12  PI-CONTROL-IN-PROGRESS.
  1135         16  PI-CARRIER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  24
* EL1278.cbl
  1136         16  PI-GROUPING                 PIC X(6).
  1137         16  PI-STATE                    PIC XX.
  1138         16  PI-ACCOUNT                  PIC X(10).
  1139         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1140                                         PIC X(10).
  1141         16  PI-CLAIM-CERT-GRP.
  1142             20  PI-CLAIM-NO             PIC X(7).
  1143             20  PI-CERT-NO.
  1144                 25  PI-CERT-PRIME       PIC X(10).
  1145                 25  PI-CERT-SFX         PIC X.
  1146             20  PI-CERT-EFF-DT          PIC XX.
  1147         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1148             20  PI-PLAN-CODE            PIC X(2).
  1149             20  PI-REVISION-NUMBER      PIC X(3).
  1150             20  PI-PLAN-EFF-DT          PIC X(2).
  1151             20  PI-PLAN-EXP-DT          PIC X(2).
  1152             20  FILLER                  PIC X(11).
  1153         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1154             20  PI-OE-REFERENCE-1.
  1155                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1156                 25  PI-OE-REF-1-SUFF    PIC XX.
  1157
  1158     12  PI-SESSION-IN-PROGRESS          PIC X.
  1159         88  CLAIM-SESSION                   VALUE '1'.
  1160         88  CREDIT-SESSION                  VALUE '2'.
  1161         88  WARRANTY-SESSION                VALUE '3'.
  1162         88  MORTGAGE-SESSION                VALUE '4'.
  1163         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1164
  1165
  1166*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1167
  1168     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1169     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1170
  1171     12  PI-CREDIT-USER                  PIC X.
  1172         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1173         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1174
  1175     12  PI-CLAIM-USER                   PIC X.
  1176         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1177         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1178
  1179     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1180         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1181         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1182         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1183         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1184         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1185
  1186     12  PI-PROCESSOR-ID                 PIC X(4).
  1187
  1188     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1189
  1190     12  PI-MEMBER-CAPTION               PIC X(10).
  1191
  1192     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1193         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  25
* EL1278.cbl
  1194
  1195     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1196     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1197     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1198     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1199
  1200     12  PI-AH-OVERRIDE-L1               PIC X.
  1201     12  PI-AH-OVERRIDE-L2               PIC XX.
  1202     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1203     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1204
  1205     12  PI-NEW-SYSTEM                   PIC X(2).
  1206
  1207     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1208     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1209         88  PI-USES-PAID-TO                 VALUE '1'.
  1210     12  PI-CRDTCRD-SYSTEM.
  1211         16  PI-CRDTCRD-USER             PIC X.
  1212             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1213             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1214         16  PI-CC-MONTH-END-DT          PIC XX.
  1215     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1216
  1217     12  PI-OE-REFERENCE-2.
  1218         16  PI-OE-REF-2-PRIME           PIC X(10).
  1219         16  PI-OE-REF-2-SUFF            PIC X.
  1220
  1221     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1222
  1223     12  PI-LANGUAGE-TYPE                PIC X.
  1224             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1225             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1226             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1227
  1228     12  PI-POLICY-LINKAGE-IND           PIC X.
  1229         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1230         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1231                                                   LOW-VALUES.
  1232
  1233     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1234     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1235         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1236         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1237
  1238     12  PI-PROCESSOR-CSR-IND            PIC X.
  1239         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1240         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1241
  1242     12  FILLER                          PIC X(3).
  1243
  1244     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1245
  1246     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1247         PI-SYSTEM-LEVEL.
  1248
  1249         16  PI-ENTRY-CODES.
  1250             20  PI-ENTRY-CD-1           PIC X.
  1251             20  PI-ENTRY-CD-2           PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  26
* EL1278.cbl
  1252
  1253         16  PI-RETURN-CODES.
  1254             20  PI-RETURN-CD-1          PIC X.
  1255             20  PI-RETURN-CD-2          PIC X.
  1256
  1257         16  PI-UPDATE-STATUS-SAVE.
  1258             20  PI-UPDATE-BY            PIC X(4).
  1259             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1260
  1261         16  PI-LOWER-CASE-LETTERS       PIC X.
  1262             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1263
  1264*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1265*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1266*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1267
  1268         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1269             88  ST-ACCNT-CNTL               VALUE ' '.
  1270             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1271             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1272             88  ACCNT-CNTL                  VALUE '3'.
  1273             88  CARR-ACCNT-CNTL             VALUE '4'.
  1274
  1275         16  PI-PROCESSOR-CAP-LIST.
  1276             20  PI-SYSTEM-CONTROLS.
  1277                24 PI-SYSTEM-DISPLAY     PIC X.
  1278                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1279                24 PI-SYSTEM-MODIFY      PIC X.
  1280                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1281             20  FILLER                  PIC XX.
  1282             20  PI-DISPLAY-CAP          PIC X.
  1283                 88  DISPLAY-CAP             VALUE 'Y'.
  1284             20  PI-MODIFY-CAP           PIC X.
  1285                 88  MODIFY-CAP              VALUE 'Y'.
  1286             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1287                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1288             20  PI-FORCE-CAP            PIC X.
  1289                 88  FORCE-CAP               VALUE 'Y'.
  1290
  1291         16  PI-PROGRAM-CONTROLS.
  1292             20  PI-PGM-PRINT-OPT        PIC X.
  1293             20  PI-PGM-FORMAT-OPT       PIC X.
  1294             20  PI-PGM-PROCESS-OPT      PIC X.
  1295             20  PI-PGM-TOTALS-OPT       PIC X.
  1296
  1297         16  PI-HELP-INTERFACE.
  1298             20  PI-LAST-ERROR-NO        PIC X(4).
  1299             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1300
  1301         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1302             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1303
  1304         16  PI-CR-CONTROL-IN-PROGRESS.
  1305             20  PI-CR-CARRIER           PIC X.
  1306             20  PI-CR-GROUPING          PIC X(6).
  1307             20  PI-CR-STATE             PIC XX.
  1308             20  PI-CR-ACCOUNT           PIC X(10).
  1309             20  PI-CR-FIN-RESP          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  27
* EL1278.cbl
  1310             20  PI-CR-TYPE              PIC X.
  1311
  1312         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1313
  1314         16  PI-CR-MONTH-END-DT          PIC XX.
  1315
  1316         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1317             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1318             88  PI-ZERO-CARRIER             VALUE '1'.
  1319             88  PI-ZERO-GROUPING            VALUE '2'.
  1320             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1321
  1322         16  PI-CARRIER-SECURITY         PIC X.
  1323             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1324
  1325         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1326             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1327             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1328
  1329         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1330             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1331                                         INDEXED BY PI-ACCESS-NDX
  1332                                         PIC X.
  1333
  1334         16  PI-GA-BILLING-CONTROL       PIC X.
  1335             88  PI-GA-BILLING               VALUE '1'.
  1336
  1337         16  PI-MAIL-PROCESSING          PIC X.
  1338             88  PI-MAIL-YES                 VALUE 'Y'.
  1339
  1340         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1341
  1342         16  PI-AR-SYSTEM.
  1343             20  PI-AR-PROCESSING-CNTL   PIC X.
  1344                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1345             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1346             20  PI-AR-MONTH-END-DT      PIC XX.
  1347
  1348         16  PI-MP-SYSTEM.
  1349             20  PI-MORTGAGE-USER            PIC X.
  1350                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1351                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1352             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1353                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1354                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1355                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1356                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1357                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1358             20  PI-MP-MONTH-END-DT          PIC XX.
  1359             20  PI-MP-REFERENCE-NO.
  1360                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1361                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1362
  1363         16  PI-LABEL-CONTROL            PIC X(01).
  1364             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1365             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1366
  1367         16  PI-BILL-GROUPING-CODE       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  28
* EL1278.cbl
  1368             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1369
  1370         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1371             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1372             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1373
  1374         16  FILLER                      PIC X(14).
  1375
  1376     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1377******************************************************************
  1378     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
  1379         16  FILLER                PIC  X(500).
  1380         16  PI-PEND-SW            PIC  X(01).
  1381         16  PI-LF-CANCEL-DATE     PIC  X(02).
  1382         16  PI-AH-CANCEL-DATE     PIC  X(02).
  1383         16  PI-LF-CANCEL-DATE-ED  PIC  X(08).
  1384         16  PI-AH-CANCEL-DATE-ED  PIC  X(08).
  1385         16  PI-EARNING-METHOD-LF  PIC  X.
  1386         16  PI-EARNING-METHOD-AH  PIC  X.
  1387         16  PI-LF-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1388         16  PI-LF-REFUND-METH     PIC  X.
  1389         16  PI-AH-REFUND-AMT      PIC  S9(7)V99 COMP-3.
  1390         16  PI-AH-REFUND-METH     PIC  X.
  1391         16  PI-TOTAL-REFUND-AMT   PIC  S9(7)V99 COMP-3.
  1392         16  PI-MODIFY-CERT-CAP    PIC  X.
  1393             88 MODIFY-CERT-CAP    VALUE 'Y'.
  1394         16  PI-CLP-YN             PIC X.
  1395         16  PI-CANCEL-REASON      PIC X.
  1396         16  FILLER                PIC  X(97).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  29
* EL1278.cbl
  1398*                            COPY ELCAID.
  1399******************************************************************
  1400*                                                                *
  1401*                            ELCAID.                             *
  1402*                            VMOD=2.001                          *
  1403*                                                                *
  1404*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1405*                                                                *
  1406*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1407*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1408******************************************************************
  1409
  1410 01  DFHAID.
  1411   02  DFHNULL   PIC  X  VALUE  ' '.
  1412   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1413   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1414   02  DFHPEN    PIC  X  VALUE  '='.
  1415   02  DFHOPID   PIC  X  VALUE  'W'.
  1416   02  DFHPA1    PIC  X  VALUE  '%'.
  1417   02  DFHPA2    PIC  X  VALUE  '>'.
  1418   02  DFHPA3    PIC  X  VALUE  ','.
  1419   02  DFHPF1    PIC  X  VALUE  '1'.
  1420   02  DFHPF2    PIC  X  VALUE  '2'.
  1421   02  DFHPF3    PIC  X  VALUE  '3'.
  1422   02  DFHPF4    PIC  X  VALUE  '4'.
  1423   02  DFHPF5    PIC  X  VALUE  '5'.
  1424   02  DFHPF6    PIC  X  VALUE  '6'.
  1425   02  DFHPF7    PIC  X  VALUE  '7'.
  1426   02  DFHPF8    PIC  X  VALUE  '8'.
  1427   02  DFHPF9    PIC  X  VALUE  '9'.
  1428   02  DFHPF10   PIC  X  VALUE  ':'.
  1429   02  DFHPF11   PIC  X  VALUE  '#'.
  1430   02  DFHPF12   PIC  X  VALUE  '@'.
  1431   02  DFHPF13   PIC  X  VALUE  'A'.
  1432   02  DFHPF14   PIC  X  VALUE  'B'.
  1433   02  DFHPF15   PIC  X  VALUE  'C'.
  1434   02  DFHPF16   PIC  X  VALUE  'D'.
  1435   02  DFHPF17   PIC  X  VALUE  'E'.
  1436   02  DFHPF18   PIC  X  VALUE  'F'.
  1437   02  DFHPF19   PIC  X  VALUE  'G'.
  1438   02  DFHPF20   PIC  X  VALUE  'H'.
  1439   02  DFHPF21   PIC  X  VALUE  'I'.
  1440*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1441   02  DFHPF22   PIC  X  VALUE  '['.
  1442   02  DFHPF23   PIC  X  VALUE  '.'.
  1443   02  DFHPF24   PIC  X  VALUE  '<'.
  1444   02  DFHMSRE   PIC  X  VALUE  'X'.
  1445   02  DFHSTRF   PIC  X  VALUE  'h'.
  1446   02  DFHTRIG   PIC  X  VALUE  '"'.
  1447
  1448 01  FILLER  REDEFINES  DFHAID.
  1449     12  FILLER                  PIC  X(08).
  1450     12  PF-VALUES               PIC  X(01)      OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  30
* EL1278.cbl
  1452*                            COPY EL1278S.
  1453 01  EL127HI.
  1454     05  FILLER            PIC  X(0012).
  1455*    -------------------------------
  1456     05  HDATEL PIC S9(0004) COMP.
  1457     05  HDATEF PIC  X(0001).
  1458     05  FILLER REDEFINES HDATEF.
  1459         10  HDATEA PIC  X(0001).
  1460     05  HDATEI PIC  X(0008).
  1461*    -------------------------------
  1462     05  HTIMEL PIC S9(0004) COMP.
  1463     05  HTIMEF PIC  X(0001).
  1464     05  FILLER REDEFINES HTIMEF.
  1465         10  HTIMEA PIC  X(0001).
  1466     05  HTIMEI PIC  999V99.
  1467*    -------------------------------
  1468     05  CMPNYIDL PIC S9(0004) COMP.
  1469     05  CMPNYIDF PIC  X(0001).
  1470     05  FILLER REDEFINES CMPNYIDF.
  1471         10  CMPNYIDA PIC  X(0001).
  1472     05  CMPNYIDI PIC  X(0003).
  1473*    -------------------------------
  1474     05  USERIDL PIC S9(0004) COMP.
  1475     05  USERIDF PIC  X(0001).
  1476     05  FILLER REDEFINES USERIDF.
  1477         10  USERIDA PIC  X(0001).
  1478     05  USERIDI PIC  X(0004).
  1479*    -------------------------------
  1480     05  HCARIERL PIC S9(0004) COMP.
  1481     05  HCARIERF PIC  X(0001).
  1482     05  FILLER REDEFINES HCARIERF.
  1483         10  HCARIERA PIC  X(0001).
  1484     05  HCARIERI PIC  X(0001).
  1485*    -------------------------------
  1486     05  HGROUPL PIC S9(0004) COMP.
  1487     05  HGROUPF PIC  X(0001).
  1488     05  FILLER REDEFINES HGROUPF.
  1489         10  HGROUPA PIC  X(0001).
  1490     05  HGROUPI PIC  X(0006).
  1491*    -------------------------------
  1492     05  HSTATEL PIC S9(0004) COMP.
  1493     05  HSTATEF PIC  X(0001).
  1494     05  FILLER REDEFINES HSTATEF.
  1495         10  HSTATEA PIC  X(0001).
  1496     05  HSTATEI PIC  X(0002).
  1497*    -------------------------------
  1498     05  HACCTNOL PIC S9(0004) COMP.
  1499     05  HACCTNOF PIC  X(0001).
  1500     05  FILLER REDEFINES HACCTNOF.
  1501         10  HACCTNOA PIC  X(0001).
  1502     05  HACCTNOI PIC  X(0010).
  1503*    -------------------------------
  1504     05  HEFFDTL PIC S9(0004) COMP.
  1505     05  HEFFDTF PIC  X(0001).
  1506     05  FILLER REDEFINES HEFFDTF.
  1507         10  HEFFDTA PIC  X(0001).
  1508     05  HEFFDTI PIC  X(0008).
  1509*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  31
* EL1278.cbl
  1510     05  HCERTNOL PIC S9(0004) COMP.
  1511     05  HCERTNOF PIC  X(0001).
  1512     05  FILLER REDEFINES HCERTNOF.
  1513         10  HCERTNOA PIC  X(0001).
  1514     05  HCERTNOI PIC  X(0010).
  1515*    -------------------------------
  1516     05  HCRTSFXL PIC S9(0004) COMP.
  1517     05  HCRTSFXF PIC  X(0001).
  1518     05  FILLER REDEFINES HCRTSFXF.
  1519         10  HCRTSFXA PIC  X(0001).
  1520     05  HCRTSFXI PIC  X(0001).
  1521*    -------------------------------
  1522     05  HLNAMEL PIC S9(0004) COMP.
  1523     05  HLNAMEF PIC  X(0001).
  1524     05  FILLER REDEFINES HLNAMEF.
  1525         10  HLNAMEA PIC  X(0001).
  1526     05  HLNAMEI PIC  X(0015).
  1527*    -------------------------------
  1528     05  HFNAMEL PIC S9(0004) COMP.
  1529     05  HFNAMEF PIC  X(0001).
  1530     05  FILLER REDEFINES HFNAMEF.
  1531         10  HFNAMEA PIC  X(0001).
  1532     05  HFNAMEI PIC  X(0010).
  1533*    -------------------------------
  1534     05  HINITL PIC S9(0004) COMP.
  1535     05  HINITF PIC  X(0001).
  1536     05  FILLER REDEFINES HINITF.
  1537         10  HINITA PIC  X(0001).
  1538     05  HINITI PIC  X(0001).
  1539*    -------------------------------
  1540     05  LCLMDTHL PIC S9(0004) COMP.
  1541     05  LCLMDTHF PIC  X(0001).
  1542     05  FILLER REDEFINES LCLMDTHF.
  1543         10  LCLMDTHA PIC  X(0001).
  1544     05  LCLMDTHI PIC  X(0022).
  1545*    -------------------------------
  1546     05  LCLMDTL PIC S9(0004) COMP.
  1547     05  LCLMDTF PIC  X(0001).
  1548     05  FILLER REDEFINES LCLMDTF.
  1549         10  LCLMDTA PIC  X(0001).
  1550     05  LCLMDTI PIC  X(0008).
  1551*    -------------------------------
  1552     05  HPCYNL PIC S9(0004) COMP.
  1553     05  HPCYNF PIC  X(0001).
  1554     05  FILLER REDEFINES HPCYNF.
  1555         10  HPCYNA PIC  X(0001).
  1556     05  HPCYNI PIC  X(0001).
  1557*    -------------------------------
  1558     05  ACLMDTHL PIC S9(0004) COMP.
  1559     05  ACLMDTHF PIC  X(0001).
  1560     05  FILLER REDEFINES ACLMDTHF.
  1561         10  ACLMDTHA PIC  X(0001).
  1562     05  ACLMDTHI PIC  X(0023).
  1563*    -------------------------------
  1564     05  ACLMDTL PIC S9(0004) COMP.
  1565     05  ACLMDTF PIC  X(0001).
  1566     05  FILLER REDEFINES ACLMDTF.
  1567         10  ACLMDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  32
* EL1278.cbl
  1568     05  ACLMDTI PIC  X(0008).
  1569*    -------------------------------
  1570     05  PMTHDL PIC S9(0004) COMP.
  1571     05  PMTHDF PIC  X(0001).
  1572     05  FILLER REDEFINES PMTHDF.
  1573         10  PMTHDA PIC  X(0001).
  1574     05  PMTHDI PIC  X(0010).
  1575*    -------------------------------
  1576     05  CNCDTHDL PIC S9(0004) COMP.
  1577     05  CNCDTHDF PIC  X(0001).
  1578     05  FILLER REDEFINES CNCDTHDF.
  1579         10  CNCDTHDA PIC  X(0001).
  1580     05  CNCDTHDI PIC  X(0007).
  1581*    -------------------------------
  1582     05  HLKINDL PIC S9(0004) COMP.
  1583     05  HLKINDF PIC  X(0001).
  1584     05  FILLER REDEFINES HLKINDF.
  1585         10  HLKINDA PIC  X(0001).
  1586     05  HLKINDI PIC  X(0002).
  1587*    -------------------------------
  1588     05  HLCDL PIC S9(0004) COMP.
  1589     05  HLCDF PIC  X(0001).
  1590     05  FILLER REDEFINES HLCDF.
  1591         10  HLCDA PIC  X(0001).
  1592     05  HLCDI PIC  X(0002).
  1593*    -------------------------------
  1594     05  HLEDESCL PIC S9(0004) COMP.
  1595     05  HLEDESCF PIC  X(0001).
  1596     05  FILLER REDEFINES HLEDESCF.
  1597         10  HLEDESCA PIC  X(0001).
  1598     05  HLEDESCI PIC  X(0003).
  1599*    -------------------------------
  1600     05  HLTERML PIC S9(0004) COMP.
  1601     05  HLTERMF PIC  X(0001).
  1602     05  FILLER REDEFINES HLTERMF.
  1603         10  HLTERMA PIC  X(0001).
  1604     05  HLTERMI PIC  9(3).
  1605*    -------------------------------
  1606     05  HLREML PIC S9(0004) COMP.
  1607     05  HLREMF PIC  X(0001).
  1608     05  FILLER REDEFINES HLREMF.
  1609         10  HLREMA PIC  X(0001).
  1610     05  HLREMI PIC  X(0003).
  1611*    -------------------------------
  1612     05  HLPREML PIC S9(0004) COMP.
  1613     05  HLPREMF PIC  X(0001).
  1614     05  FILLER REDEFINES HLPREMF.
  1615         10  HLPREMA PIC  X(0001).
  1616     05  HLPREMI PIC  X(0011).
  1617*    -------------------------------
  1618     05  HLITDRL PIC S9(0004) COMP.
  1619     05  HLITDRF PIC  X(0001).
  1620     05  FILLER REDEFINES HLITDRF.
  1621         10  HLITDRA PIC  X(0001).
  1622     05  HLITDRI PIC  X(0011).
  1623*    -------------------------------
  1624     05  HLREFNDL PIC S9(0004) COMP.
  1625     05  HLREFNDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  33
* EL1278.cbl
  1626     05  FILLER REDEFINES HLREFNDF.
  1627         10  HLREFNDA PIC  X(0001).
  1628     05  HLREFNDI PIC  X(0011).
  1629*    -------------------------------
  1630     05  HLCANCL PIC S9(0004) COMP.
  1631     05  HLCANCF PIC  X(0001).
  1632     05  FILLER REDEFINES HLCANCF.
  1633         10  HLCANCA PIC  X(0001).
  1634     05  HLCANCI PIC  X(0008).
  1635*    -------------------------------
  1636     05  HLCAL1L PIC S9(0004) COMP.
  1637     05  HLCAL1F PIC  X(0001).
  1638     05  FILLER REDEFINES HLCAL1F.
  1639         10  HLCAL1A PIC  X(0001).
  1640     05  HLCAL1I PIC  X(0001).
  1641*    -------------------------------
  1642     05  HLCALCL PIC S9(0004) COMP.
  1643     05  HLCALCF PIC  X(0001).
  1644     05  FILLER REDEFINES HLCALCF.
  1645         10  HLCALCA PIC  X(0001).
  1646     05  HLCALCI PIC  X(0012).
  1647*    -------------------------------
  1648     05  HAKINDL PIC S9(0004) COMP.
  1649     05  HAKINDF PIC  X(0001).
  1650     05  FILLER REDEFINES HAKINDF.
  1651         10  HAKINDA PIC  X(0001).
  1652     05  HAKINDI PIC  X(0002).
  1653*    -------------------------------
  1654     05  HACDL PIC S9(0004) COMP.
  1655     05  HACDF PIC  X(0001).
  1656     05  FILLER REDEFINES HACDF.
  1657         10  HACDA PIC  X(0001).
  1658     05  HACDI PIC  X(0002).
  1659*    -------------------------------
  1660     05  HAEDESCL PIC S9(0004) COMP.
  1661     05  HAEDESCF PIC  X(0001).
  1662     05  FILLER REDEFINES HAEDESCF.
  1663         10  HAEDESCA PIC  X(0001).
  1664     05  HAEDESCI PIC  X(0003).
  1665*    -------------------------------
  1666     05  HATERML PIC S9(0004) COMP.
  1667     05  HATERMF PIC  X(0001).
  1668     05  FILLER REDEFINES HATERMF.
  1669         10  HATERMA PIC  X(0001).
  1670     05  HATERMI PIC  9(3).
  1671*    -------------------------------
  1672     05  HAREML PIC S9(0004) COMP.
  1673     05  HAREMF PIC  X(0001).
  1674     05  FILLER REDEFINES HAREMF.
  1675         10  HAREMA PIC  X(0001).
  1676     05  HAREMI PIC  X(0003).
  1677*    -------------------------------
  1678     05  HAPREML PIC S9(0004) COMP.
  1679     05  HAPREMF PIC  X(0001).
  1680     05  FILLER REDEFINES HAPREMF.
  1681         10  HAPREMA PIC  X(0001).
  1682     05  HAPREMI PIC  X(0011).
  1683*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  34
* EL1278.cbl
  1684     05  HAITDRL PIC S9(0004) COMP.
  1685     05  HAITDRF PIC  X(0001).
  1686     05  FILLER REDEFINES HAITDRF.
  1687         10  HAITDRA PIC  X(0001).
  1688     05  HAITDRI PIC  X(0011).
  1689*    -------------------------------
  1690     05  HAREFNDL PIC S9(0004) COMP.
  1691     05  HAREFNDF PIC  X(0001).
  1692     05  FILLER REDEFINES HAREFNDF.
  1693         10  HAREFNDA PIC  X(0001).
  1694     05  HAREFNDI PIC  X(0011).
  1695*    -------------------------------
  1696     05  HACANCL PIC S9(0004) COMP.
  1697     05  HACANCF PIC  X(0001).
  1698     05  FILLER REDEFINES HACANCF.
  1699         10  HACANCA PIC  X(0001).
  1700     05  HACANCI PIC  X(0008).
  1701*    -------------------------------
  1702     05  HACAL1L PIC S9(0004) COMP.
  1703     05  HACAL1F PIC  X(0001).
  1704     05  FILLER REDEFINES HACAL1F.
  1705         10  HACAL1A PIC  X(0001).
  1706     05  HACAL1I PIC  X(0001).
  1707*    -------------------------------
  1708     05  HACALCL PIC S9(0004) COMP.
  1709     05  HACALCF PIC  X(0001).
  1710     05  FILLER REDEFINES HACALCF.
  1711         10  HACALCA PIC  X(0001).
  1712     05  HACALCI PIC  X(0012).
  1713*    -------------------------------
  1714     05  TOPREML PIC S9(0004) COMP.
  1715     05  TOPREMF PIC  X(0001).
  1716     05  FILLER REDEFINES TOPREMF.
  1717         10  TOPREMA PIC  X(0001).
  1718     05  TOPREMI PIC  X(0011).
  1719*    -------------------------------
  1720     05  TOITDRL PIC S9(0004) COMP.
  1721     05  TOITDRF PIC  X(0001).
  1722     05  FILLER REDEFINES TOITDRF.
  1723         10  TOITDRA PIC  X(0001).
  1724     05  TOITDRI PIC  X(0011).
  1725*    -------------------------------
  1726     05  TORFNDL PIC S9(0004) COMP.
  1727     05  TORFNDF PIC  X(0001).
  1728     05  FILLER REDEFINES TORFNDF.
  1729         10  TORFNDA PIC  X(0001).
  1730     05  TORFNDI PIC  X(0011).
  1731*    -------------------------------
  1732     05  CANREAHL PIC S9(0004) COMP.
  1733     05  CANREAHF PIC  X(0001).
  1734     05  FILLER REDEFINES CANREAHF.
  1735         10  CANREAHA PIC  X(0001).
  1736     05  CANREAHI PIC  X(0015).
  1737*    -------------------------------
  1738     05  CANREAL PIC S9(0004) COMP.
  1739     05  CANREAF PIC  X(0001).
  1740     05  FILLER REDEFINES CANREAF.
  1741         10  CANREAA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  35
* EL1278.cbl
  1742     05  CANREAI PIC  X(0001).
  1743*    -------------------------------
  1744     05  CLPYNHL PIC S9(0004) COMP.
  1745     05  CLPYNHF PIC  X(0001).
  1746     05  FILLER REDEFINES CLPYNHF.
  1747         10  CLPYNHA PIC  X(0001).
  1748     05  CLPYNHI PIC  X(0005).
  1749*    -------------------------------
  1750     05  CLPYNL PIC S9(0004) COMP.
  1751     05  CLPYNF PIC  X(0001).
  1752     05  FILLER REDEFINES CLPYNF.
  1753         10  CLPYNA PIC  X(0001).
  1754     05  CLPYNI PIC  X(0001).
  1755*    -------------------------------
  1756     05  HLREDL PIC S9(0004) COMP.
  1757     05  HLREDF PIC  X(0001).
  1758     05  FILLER REDEFINES HLREDF.
  1759         10  HLREDA PIC  X(0001).
  1760     05  HLREDI PIC  X(0014).
  1761*    -------------------------------
  1762     05  FREMTRML PIC S9(0004) COMP.
  1763     05  FREMTRMF PIC  X(0001).
  1764     05  FILLER REDEFINES FREMTRMF.
  1765         10  FREMTRMA PIC  X(0001).
  1766     05  FREMTRMI PIC  X(0003).
  1767*    -------------------------------
  1768     05  HERMSG1L PIC S9(0004) COMP.
  1769     05  HERMSG1F PIC  X(0001).
  1770     05  FILLER REDEFINES HERMSG1F.
  1771         10  HERMSG1A PIC  X(0001).
  1772     05  HERMSG1I PIC  X(0079).
  1773*    -------------------------------
  1774     05  HERMSG2L PIC S9(0004) COMP.
  1775     05  HERMSG2F PIC  X(0001).
  1776     05  FILLER REDEFINES HERMSG2F.
  1777         10  HERMSG2A PIC  X(0001).
  1778     05  HERMSG2I PIC  X(0079).
  1779*    -------------------------------
  1780     05  HPFKEYL PIC S9(0004) COMP.
  1781     05  HPFKEYF PIC  X(0001).
  1782     05  FILLER REDEFINES HPFKEYF.
  1783         10  HPFKEYA PIC  X(0001).
  1784     05  HPFKEYI PIC  99.
  1785*    -------------------------------
  1786     05  PFKEY11L PIC S9(0004) COMP.
  1787     05  PFKEY11F PIC  X(0001).
  1788     05  FILLER REDEFINES PFKEY11F.
  1789         10  PFKEY11A PIC  X(0001).
  1790     05  PFKEY11I PIC  X(0034).
  1791 01  EL127HO REDEFINES EL127HI.
  1792     05  FILLER            PIC  X(0012).
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  HDATEO PIC  X(0008).
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  HTIMEO PIC  99.99.
  1799*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  36
* EL1278.cbl
  1800     05  FILLER            PIC  X(0003).
  1801     05  CMPNYIDO PIC  X(0003).
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  USERIDO PIC  X(0004).
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  HCARIERO PIC  X(0001).
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  HGROUPO PIC  X(0006).
  1811*    -------------------------------
  1812     05  FILLER            PIC  X(0003).
  1813     05  HSTATEO PIC  X(0002).
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  HACCTNOO PIC  X(0010).
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  HEFFDTO PIC  X(0008).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  HCERTNOO PIC  X(0010).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  HCRTSFXO PIC  X(0001).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  HLNAMEO PIC  X(0015).
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  HFNAMEO PIC  X(0010).
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  HINITO PIC  X(0001).
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  LCLMDTHO PIC  X(0022).
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  LCLMDTO PIC  X(0008).
  1841*    -------------------------------
  1842     05  FILLER            PIC  X(0003).
  1843     05  HPCYNO PIC  X(0001).
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  ACLMDTHO PIC  X(0023).
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  ACLMDTO PIC  X(0008).
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  PMTHDO PIC  X(0010).
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  CNCDTHDO PIC  X(0007).
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  37
* EL1278.cbl
  1858     05  HLKINDO PIC  X(0002).
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  HLCDO PIC  X(0002).
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  HLEDESCO PIC  X(0003).
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
  1867     05  HLTERMO PIC  ZZ9.
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
  1870     05  HLREMO PIC  ZZ9.
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  HLPREMO PIC  ZZZZ,ZZ9.99.
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  HLITDRO PIC  ZZZZ,ZZ9.99.
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  HLREFNDO PIC  ZZZZ,ZZ9.99.
  1880*    -------------------------------
  1881     05  FILLER            PIC  X(0003).
  1882     05  HLCANCO PIC  X(0008).
  1883*    -------------------------------
  1884     05  FILLER            PIC  X(0003).
  1885     05  HLCAL1O PIC  X(0001).
  1886*    -------------------------------
  1887     05  FILLER            PIC  X(0003).
  1888     05  HLCALCO PIC  X(0012).
  1889*    -------------------------------
  1890     05  FILLER            PIC  X(0003).
  1891     05  HAKINDO PIC  X(0002).
  1892*    -------------------------------
  1893     05  FILLER            PIC  X(0003).
  1894     05  HACDO PIC  X(0002).
  1895*    -------------------------------
  1896     05  FILLER            PIC  X(0003).
  1897     05  HAEDESCO PIC  X(0003).
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  HATERMO PIC  ZZ9.
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  HAREMO PIC  ZZ9.
  1904*    -------------------------------
  1905     05  FILLER            PIC  X(0003).
  1906     05  HAPREMO PIC  ZZZZ,ZZ9.99.
  1907*    -------------------------------
  1908     05  FILLER            PIC  X(0003).
  1909     05  HAITDRO PIC  ZZZZ,ZZ9.99.
  1910*    -------------------------------
  1911     05  FILLER            PIC  X(0003).
  1912     05  HAREFNDO PIC  ZZZZ,ZZ9.99.
  1913*    -------------------------------
  1914     05  FILLER            PIC  X(0003).
  1915     05  HACANCO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  38
* EL1278.cbl
  1916*    -------------------------------
  1917     05  FILLER            PIC  X(0003).
  1918     05  HACAL1O PIC  X(0001).
  1919*    -------------------------------
  1920     05  FILLER            PIC  X(0003).
  1921     05  HACALCO PIC  X(0012).
  1922*    -------------------------------
  1923     05  FILLER            PIC  X(0003).
  1924     05  TOPREMO PIC  ZZZZ,ZZ9.99.
  1925*    -------------------------------
  1926     05  FILLER            PIC  X(0003).
  1927     05  TOITDRO PIC  ZZZZ,ZZ9.99.
  1928*    -------------------------------
  1929     05  FILLER            PIC  X(0003).
  1930     05  TORFNDO PIC  ZZZZ,ZZ9.99.
  1931*    -------------------------------
  1932     05  FILLER            PIC  X(0003).
  1933     05  CANREAHO PIC  X(0015).
  1934*    -------------------------------
  1935     05  FILLER            PIC  X(0003).
  1936     05  CANREAO PIC  X(0001).
  1937*    -------------------------------
  1938     05  FILLER            PIC  X(0003).
  1939     05  CLPYNHO PIC  X(0005).
  1940*    -------------------------------
  1941     05  FILLER            PIC  X(0003).
  1942     05  CLPYNO PIC  X(0001).
  1943*    -------------------------------
  1944     05  FILLER            PIC  X(0003).
  1945     05  HLREDO PIC  ZZZ,ZZZ,ZZ9.99.
  1946*    -------------------------------
  1947     05  FILLER            PIC  X(0003).
  1948     05  FREMTRMO PIC  ZZ9.
  1949*    -------------------------------
  1950     05  FILLER            PIC  X(0003).
  1951     05  HERMSG1O PIC  X(0079).
  1952*    -------------------------------
  1953     05  FILLER            PIC  X(0003).
  1954     05  HERMSG2O PIC  X(0079).
  1955*    -------------------------------
  1956     05  FILLER            PIC  X(0003).
  1957     05  HPFKEYO PIC  99.
  1958*    -------------------------------
  1959     05  FILLER            PIC  X(0003).
  1960     05  PFKEY11O PIC  X(0034).
  1961*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  39
* EL1278.cbl
  1963*                            COPY ELCCALC.
  1964******************************************************************
  1965*                                                                *
  1966*                           ELCCALC.                            *
  1967*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1968*                            VMOD=2.025                          *
  1969*                                                                *
  1970*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1971*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1972*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1973*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1974*                                                                *
  1975*  PASSED TO ELRTRM                                              *
  1976*  -----------------                                             *
  1977*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1978*  ORIGINAL TERM                                                 *
  1979*  BEGINNING DATE                                                *
  1980*  ENDING DATE                                                   *
  1981*  COMPANY I.D.                                                  *
  1982*  ACCOUNT MASTER USER FIELD                                     *
  1983*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1984*  FREE LOOK DAYS                                                *
  1985*                                                                *
  1986*  RETURNED FROM ELRTRM                                          *
  1987*  ---------------------                                         *
  1988*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1989*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1990*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1991*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1992*----------------------------------------------------------------*
  1993*  PASSED TO ELRAMT                                              *
  1994*  ----------------                                              *
  1995*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1996*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1997*  ORIGINAL AMOUNT                                               *
  1998*  ALTERNATE BENEFIT (BALLON)                                    *
  1999*  A.P.R. - NET PAY ONLY                                         *
  2000*  METHOD
  2001*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2002*  COMPANY I.D.                                                  *
  2003*  BENEFIT TYPE                                                  *
  2004*                                                                *
  2005*  RETURNED FROM ELRAMT                                          *
  2006*  --------------------                                          *
  2007*  REMAINING AMOUNT 1 - CURRENT                                  *
  2008*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2009*  REMAINING AMOUNT FACTOR
  2010*----------------------------------------------------------------*
  2011*  PASSED TO ELRESV                                              *
  2012*  -----------------                                             *
  2013*  CERTIFICATE EFFECTIVE DATE                                    *
  2014*  VALUATION DATE                                                *
  2015*  PAID THRU DATE                                                *
  2016*  BENEFIT                                                       *
  2017*  INCURRED DATE                                                 *
  2018*  REPORTED DATE                                                 *
  2019*  ISSUE AGE                                                     *
  2020*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  40
* EL1278.cbl
  2021*  CDT PERCENT                                                   *
  2022*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2023* *CLAIM TYPE (LIFE, A/H)                                        *
  2024* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2025* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2026*                                                                *
  2027*  RETURNED FROM ELRESV                                          *
  2028*  --------------------                                          *
  2029*  CDT TABLE USED                                                *
  2030*  CDT FACTOR USED                                               *
  2031*  PAY TO CURRENT RESERVE                                        *
  2032*  I.B.N.R. - A/H ONLY                                           *
  2033*  FUTURE (ACCRUED) AH ONLY                                      *
  2034*----------------------------------------------------------------*
  2035*  PASSED TO ELRATE                                              *
  2036*  ----------------                                              *
  2037*  CERT ISSUE DATE                                               *
  2038*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2039*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2040*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2041*  STATE CODE (CLIENT DEFINED)                                   *
  2042*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2043*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2044*  DEVIATION CODE                                                *
  2045*  ISSUE AGE                                                     *
  2046*  ORIGINAL BENEFIT AMOUNT                                       *
  2047*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2048*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2049*  BENEFIT KIND (LIFE OR A/H)                                    *
  2050*  A.P.R.                                                        *
  2051*  METHOD
  2052*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2053*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2054*  COMPANY I.D. (3 CHARACTER)                                    *
  2055*  BENEFIT CODE                                                  *
  2056*  BENEFIT OVERRIDE CODE                                         *
  2057*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2058*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2059*  JOINT INDICATOR (CSL ONLY)                                    *
  2060*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2061*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2062*                                                                *
  2063*  RETURNED FROM ELRATE                                          *
  2064*  --------------------                                          *
  2065*  CALCULATED PREMIUM                                            *
  2066*  PREMIUM RATE                                                  *
  2067*  MORTALITY CODE                                                *
  2068*  MAX ATTAINED AGE                                              *
  2069*  MAX AGE                                                       *
  2070*  MAX TERM                                                      *
  2071*  MAX MONTHLY BENEFIT                                           *
  2072*  MAX TOTAL BENIFIT                                             *
  2073*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2074*----------------------------------------------------------------*
  2075*  PASSED TO ELRFND                                              *
  2076*  ----------------                                              *
  2077*  CERT ISSUE DATE                                               *
  2078*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  41
* EL1278.cbl
  2079*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2080*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2081*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2082*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2083*  STATE CODE (CLIENT DEFINED)                                   *
  2084*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2085*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2086*  DEVIATION CODE                                                *
  2087*  ISSUE AGE                                                     *
  2088*  ORIGINAL BENEFIT AMOUNT                                       *
  2089*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2090*  PROCESS TYPE (CANCEL)                                         *
  2091*  BENEFIT KIND (LIFE OR A/H)                                    *
  2092*  A.P.R.                                                        *
  2093*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2094*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2095*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2096*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2097*  COMPANY I.D. (3 CHARACTER)                                    *
  2098*  BENEFIT CODE                                                  *
  2099*  BENEFIT OVERRIDE CODE                                         *
  2100*                                                                *
  2101*  RETURNED FROM ELRFND                                          *
  2102*  --------------------                                          *
  2103*  CALCULATED REFUND                                             *
  2104*----------------------------------------------------------------*
  2105*  PASSED TO ELEARN                                              *
  2106*  ----------------                                              *
  2107*  CERT ISSUE DATE                                               *
  2108*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2109*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2110*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2111*  STATE CODE (CLIENT DEFINED)                                   *
  2112*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2113*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2114*  DEVIATION CODE                                                *
  2115*  ISSUE AGE                                                     *
  2116*  ORIGINAL BENEFIT AMOUNT                                       *
  2117*  BENEFIT KIND (LIFE OR A/H)                                    *
  2118*  A.P.R.                                                        *
  2119*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2120*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2121*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2122*  COMPANY I.D. (3 CHARACTER)                                    *
  2123*  BENEFIT CODE                                                  *
  2124*  BENEFIT OVERRIDE CODE                                         *
  2125*                                                                *
  2126*  RETURNED FROM ELEARN                                          *
  2127*  --------------------                                          *
  2128*  INDICATED  EARNINGS                                           *
  2129*----------------------------------------------------------------*
  2130*                 LENGTH = 450                                   *
  2131*                                                                *
  2132******************************************************************
  2133******************************************************************
  2134*                   C H A N G E   L O G
  2135*
  2136* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  42
* EL1278.cbl
  2137*-----------------------------------------------------------------
  2138*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2139* EFFECTIVE    NUMBER
  2140*-----------------------------------------------------------------
  2141* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2142* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2143* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2144* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2145* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2146* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2147* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2148* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2149* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2150******************************************************************
  2151
  2152 01  CALCULATION-PASS-AREA.
  2153     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2154                                     COMP.
  2155
  2156     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2157       88  NO-CP-ERROR                             VALUE ZERO.
  2158       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2159                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2160       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2161       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2162       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2163       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2164       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2165       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2166       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2167       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2168       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2169       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2170       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2171       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2172       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2173       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2174       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2175       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2176       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2177
  2178     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2179       88  NO-CP-ERROR-2                           VALUE ZERO.
  2180***********************  INPUT AREAS ****************************
  2181
  2182     12  CP-CALCULATION-AREA.
  2183         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2184         16  CP-CERT-EFF-DT        PIC XX.
  2185         16  CP-VALUATION-DT       PIC XX.
  2186         16  CP-PAID-THRU-DT       PIC XX.
  2187         16  CP-BENEFIT-TYPE       PIC X.
  2188           88  CP-AH                               VALUE 'A' 'D'
  2189                                                   'I' 'U'.
  2190           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2191           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2192         16  CP-INCURRED-DT        PIC XX.
  2193         16  CP-REPORTED-DT        PIC XX.
  2194         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  43
* EL1278.cbl
  2195         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2196         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2197                                     COMP-3.
  2198         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2199                                     COMP-3.
  2200         16  CP-CDT-METHOD         PIC X.
  2201           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2202           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2203           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2204         16  CP-CLAIM-TYPE         PIC X.
  2205           88  CP-AH-CLAIM                         VALUE 'A'.
  2206           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2207         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2208                                     COMP-3.
  2209         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2210                                     COMP-3.
  2211         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2212                                     COMP-3.
  2213         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2214                                     COMP-3.
  2215         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2216                                     COMP-3.
  2217         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2218                                     COMP-3.
  2219         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2220                                     COMP-3.
  2221         16  CP-REM-TERM-METHOD    PIC X.
  2222           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2223           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2224           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2225           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2226           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2227           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2228           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2229         16  CP-EARNING-METHOD     PIC X.
  2230           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2231           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2232           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2233           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2234           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2235           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2236           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2237           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2238           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2239           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2240           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2241           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2242           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2243           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2244         16  CP-PROCESS-TYPE       PIC X.
  2245           88  CP-CLAIM                            VALUE '1'.
  2246           88  CP-CANCEL                           VALUE '2'.
  2247           88  CP-ISSUE                            VALUE '3'.
  2248         16  CP-SPECIAL-CALC-CD    PIC X.
  2249           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2250           88  CP-1-MTH-INTEREST               VALUE ' '.
  2251           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2252           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  44
* EL1278.cbl
  2253           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2254           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2255           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2256           88  CP-FARM-PLAN                    VALUE 'F'.
  2257           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2258           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2259           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2260           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2261           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2262           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2263           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2264           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2265           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2266           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2267                                                     'W' 'X'.
  2268           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2269           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2270           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2271           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2272           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2273           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2274           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2275           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2276           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2277           88  CP-CSL-METH-1                   VALUE '5'.
  2278           88  CP-CSL-METH-2                   VALUE '6'.
  2279           88  CP-CSL-METH-3                   VALUE '7'.
  2280           88  CP-CSL-METH-4                   VALUE '8'.
  2281
  2282         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2283                                     COMP-3.
  2284         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2285         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2286         16  CP-STATE              PIC XX          VALUE SPACE.
  2287         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2288         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2289           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2290               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2291         16  CP-R78-OPTION         PIC X.
  2292           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2293           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2294
  2295         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2296         16  CP-IBNR-RESERVE-SW    PIC X.
  2297         16  CP-CLAIM-STATUS       PIC X.
  2298         16  CP-RATE-FILE          PIC X.
  2299         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2300                                     COMP-3.
  2301
  2302         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2303         16  CP-AH-OVERRIDE-CODE   PIC X.
  2304
  2305         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2306                                     COMP-3.
  2307         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2308                                   PIC S9(5)V99 COMP-3.
  2309         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2310                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  45
* EL1278.cbl
  2311         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2312                                     COMP-3.
  2313         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2314                                     COMP-3.
  2315         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2316                                  PIC S9(7)V99 COMP-3.
  2317
  2318         16  CP-PAID-FROM-DATE     PIC X(02).
  2319         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2320         16  CP-EXT-DAYS-CALC      PIC X.
  2321           88  CP-EXT-NO-CHG                   VALUE ' '.
  2322           88  CP-EXT-CHG-LF                   VALUE '1'.
  2323           88  CP-EXT-CHG-AH                   VALUE '2'.
  2324           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2325         16  CP-DOMICILE-STATE     PIC XX.
  2326         16  CP-CARRIER            PIC X.
  2327         16  CP-REIN-FLAG          PIC X.
  2328         16  CP-REM-TRM-CALC-OPTION PIC X.
  2329           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2330                      '2' '3' '4' '5'.
  2331           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2332           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2333           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2334           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2335           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2336           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2337           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2338           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2339         16  CP-SIG-SWITCH         PIC X.
  2340         16  CP-RATING-METHOD      PIC X.
  2341           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2342           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2343           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2344           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2345           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2346           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2347           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2348           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2349           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2350         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2351                                     COMP-3.
  2352         16  CP-BEN-CATEGORY       PIC X.
  2353         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2354         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2355                                   PIC S99V9(5) COMP-3.
  2356         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2357         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2358                                   PIC S99V9(5) COMP-3.
  2359         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2360         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2361         16  CP-EXPIRE-DT          PIC XX.
  2362         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2363         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2364         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2365         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2366         16  CP-DDF-SPEC-CALC      PIC X.
  2367             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2368             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  46
* EL1278.cbl
  2369         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2370         16  CP-CANCEL-REASON      PIC X.
  2371         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2372         16  CP-PMT-MODE           PIC X.
  2373         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2374         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2375         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2376         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2377         16  FILLER                PIC X.
  2378
  2379***************    OUTPUT FROM ELRESV   ************************
  2380
  2381         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2382
  2383         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2384                                     COMP-3.
  2385         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2386                                     COMP-3.
  2387         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2388                                     COMP-3.
  2389         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2390                                     COMP-3.
  2391         16  FILLER                PIC X(09).
  2392***************    OUTPUT FROM ELRTRM   *************************
  2393
  2394         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2395                                     COMP-3.
  2396         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2397                                     COMP-3.
  2398         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2399                                     COMP-3.
  2400         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2401                                     COMP-3.
  2402         16  FILLER                PIC X(12).
  2403
  2404***************    OUTPUT FROM ELRAMT   *************************
  2405
  2406         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2407                                     COMP-3.
  2408         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2409                                     COMP-3.
  2410         16  FILLER                PIC X(12).
  2411
  2412***************    OUTPUT FROM ELRATE   *************************
  2413
  2414         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2415                                     COMP-3.
  2416         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2417                                     COMP-3.
  2418         16  CP-MORTALITY-CODE     PIC X(4).
  2419         16  CP-RATE-EDIT-FLAG     PIC X.
  2420             88  CP-RATES-NEED-APR                  VALUE '1'.
  2421         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2422                                     COMP-3.
  2423         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2424         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2425         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2426                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  47
* EL1278.cbl
  2427         16  FILLER                PIC X(07).
  2428
  2429***************    OUTPUT FROM ELRFND   *************************
  2430
  2431         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2432                                     COMP-3.
  2433         16  CP-REFUND-TYPE-USED   PIC X.
  2434           88  CP-R-AS-R78                         VALUE '1'.
  2435           88  CP-R-AS-PRORATA                     VALUE '2'.
  2436           88  CP-R-AS-CALIF                       VALUE '3'.
  2437           88  CP-R-AS-TEXAS                       VALUE '4'.
  2438           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2439           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2440           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2441           88  CP-R-AS-MEAN                        VALUE '8'.
  2442           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2443           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2444           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2445           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2446           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2447           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2448         16  FILLER                PIC X(12).
  2449
  2450***************    OUTPUT FROM ELEARN   *************************
  2451
  2452         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2453                                     COMP-3.
  2454         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2455                                     COMP-3.
  2456         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2457                                     COMP-3.
  2458         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2459                                     COMP-3.
  2460         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2461                                     COMP-3.
  2462         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2463                                     COMP-3.
  2464         16  CP-EARNING-TYPE-USED  PIC X.
  2465           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2466           88  CP-E-AS-R78                         VALUE '1'.
  2467           88  CP-E-AS-PRORATA                     VALUE '2'.
  2468           88  CP-E-AS-TEXAS                       VALUE '4'.
  2469           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2470           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2471           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2472           88  CP-E-AS-MEAN                        VALUE '8'.
  2473           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2474         16  FILLER                PIC X(12).
  2475
  2476***************    OUTPUT FROM ELPMNT   *************************
  2477
  2478         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2479                                     COMP-3.
  2480         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2481                                     COMP-3.
  2482         16  FILLER                PIC X(12).
  2483
  2484***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  48
* EL1278.cbl
  2485         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2486                                     COMP-3.
  2487         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2488                                     COMP-3.
  2489         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2490                                     COMP-3.
  2491         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2492                                     COMP-3.
  2493         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2494                                     COMP-3.
  2495         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2496                                     COMP-3.
  2497         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2498             88  OPEN-RATE-FILE                   VALUE 'O'.
  2499             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2500             88  IO-ERROR                         VALUE 'E'.
  2501
  2502         16  CP-FIRST-PAY-DATE     PIC XX.
  2503
  2504         16  CP-JOINT-INDICATOR    PIC X.
  2505
  2506         16  CP-RESERVE-REMAINING-TERM
  2507                                   PIC S9(4)V9    VALUE ZERO
  2508                                     COMP-3.
  2509
  2510         16  CP-INSURED-BIRTH-DT   PIC XX.
  2511
  2512         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2513                                     COMP-3.
  2514
  2515         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2516                                     COMP-3.
  2517
  2518         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2519                                     COMP-3.
  2520
  2521         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2522                                     COMP-3.
  2523
  2524         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2525                                     COMP-3.
  2526
  2527         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2528                                     COMP-3.
  2529
  2530         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2531                                     COMP-3.
  2532
  2533         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2534             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2535
  2536         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2537                                     COMP-3.
  2538         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2539                                     COMP-3.
  2540         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2541         16  FILLER                PIC X(15).
  2542******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  49
* EL1278.cbl
  2544*                            COPY ERCNOTE.
  2545******************************************************************
  2546*                                                                *
  2547*                                                                *
  2548*                            ERCNOTE                             *
  2549*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2550*                            VMOD=2.003                          *
  2551*                                                                *
  2552*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  2553*                                                                *
  2554*        FILE TYPE= VSAM,KSDS                                    *
  2555*        RECORD SIZE = 825    RECFORM = FIXED                    *
  2556*                                                                *
  2557*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  2558*                                                                *
  2559*        LOG = YES                                               *
  2560*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  2561*                                                                *
  2562******************************************************************
  2563*                   C H A N G E   L O G
  2564*
  2565* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2566*-----------------------------------------------------------------
  2567*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2568* EFFECTIVE    NUMBER
  2569*-----------------------------------------------------------------
  2570* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  2571*                                FILE WILL CONTAIN BILLING NOTES O
  2572******************************************************************
  2573
  2574 01  CERTIFICATE-NOTE.
  2575     12  CN-RECORD-ID                PIC  XX.
  2576         88  VALID-CN-ID                  VALUE 'CN'.
  2577
  2578     12  CN-CONTROL-PRIMARY.
  2579         16  CN-COMPANY-CD           PIC X.
  2580         16  CN-CARRIER              PIC X.
  2581         16  CN-GROUPING.
  2582             20 CN-GROUPING-PREFIX   PIC XXX.
  2583             20 CN-GROUPING-PRIME    PIC XXX.
  2584         16  CN-STATE                PIC XX.
  2585         16  CN-ACCOUNT.
  2586             20 CN-ACCOUNT-PREFIX    PIC X(4).
  2587             20 CN-ACCOUNT-PRIME     PIC X(6).
  2588         16  CN-CERT-EFF-DT          PIC XX.
  2589         16  CN-CERT-NO.
  2590             20  CN-CERT-PRIME       PIC X(10).
  2591             20  CN-CERT-SFX         PIC X.
  2592
  2593     12  CN-BILLING-START-LINE-NO    PIC 99.
  2594     12  CN-BILLING-END-LINE-NO      PIC 99.
  2595
  2596     12  CN-LINES.
  2597         16  CN-LINE OCCURS 10       PIC X(77).
  2598
  2599     12  CN-LAST-MAINT-DT            PIC XX.
  2600     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  2601     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  50
* EL1278.cbl
  2602     12  FILLER                      PIC X(6).
  2603******************************************************************
  2604*                            COPY ERCCTBL.
  2605******************************************************************
  2606*                                                                *
  2607*                                                                *
  2608*                            ERCCTBL                             *
  2609*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2610*                            VMOD=2.003
  2611*                                                                *
  2612*   ONLINE CREDIT SYSTEM                                         *
  2613*                                                                *
  2614*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  2615*                                                                *
  2616*   FILE TYPE = VSAM,KSDS                                        *
  2617*   RECORD SIZE = 200   RECFORM = FIXED                          *
  2618*                                                                *
  2619*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  2620*       ALTERNATE PATH = NONE                                    *
  2621*                                                                *
  2622*   LOG = NO                                                     *
  2623*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2624*                                                                *
  2625*                                                                *
  2626******************************************************************
  2627
  2628 01  COMM-TABLE-RECORD.
  2629     12  CT-RECORD-ID                      PIC XX.
  2630         88  VALID-CT-ID                      VALUE 'CT'.
  2631
  2632     12  CT-CONTROL-PRIMARY.
  2633         16  CT-COMPANY-CD                 PIC X.
  2634         16  CT-TABLE                      PIC XXX.
  2635         16  CT-CNTRL-2.
  2636             20  CT-BEN-TYPE               PIC X.
  2637             20  CT-BEN-CODE               PIC XX.
  2638
  2639     12  CT-MAINT-INFORMATION.
  2640         16  CT-LAST-MAINT-DT              PIC XX.
  2641         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2642         16  CT-LAST-MAINT-USER            PIC X(4).
  2643         16  FILLER                        PIC X(31).
  2644
  2645     12  CT-LIMITS.
  2646         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  2647
  2648         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  2649
  2650         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  2651
  2652     12  CT-RATES.
  2653         16  CT-RTX          OCCURS 27 TIMES.
  2654             20  CT-RT                     PIC SV9(5)     COMP-3.
  2655             20  CT-RT-R   REDEFINES
  2656                 CT-RT                     PIC XXX.
  2657
  2658     12  FILLER                            PIC  X(42).
  2659
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  51
* EL1278.cbl
  2660******************************************************************
  2661
  2662****************************************************************
  2663*
  2664* Copyright (c) 2007 by Clerity Solutions, Inc.
  2665* All rights reserved.
  2666*
  2667****************************************************************
  2668 01  DFHEIV.
  2669   02  DFHEIV0               PIC X(35).
  2670   02  DFHEIV1               PIC X(08).
  2671   02  DFHEIV2               PIC X(08).
  2672   02  DFHEIV3               PIC X(08).
  2673   02  DFHEIV4               PIC X(06).
  2674   02  DFHEIV5               PIC X(04).
  2675   02  DFHEIV6               PIC X(04).
  2676   02  DFHEIV7               PIC X(02).
  2677   02  DFHEIV8               PIC X(02).
  2678   02  DFHEIV9               PIC X(01).
  2679   02  DFHEIV10              PIC S9(7) COMP-3.
  2680   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2681   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2682   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2683   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2684   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2685   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2686   02  DFHEIV17              PIC X(04).
  2687   02  DFHEIV18              PIC X(04).
  2688   02  DFHEIV19              PIC X(04).
  2689   02  DFHEIV20              USAGE IS POINTER.
  2690   02  DFHEIV21              USAGE IS POINTER.
  2691   02  DFHEIV22              USAGE IS POINTER.
  2692   02  DFHEIV23              USAGE IS POINTER.
  2693   02  DFHEIV24              USAGE IS POINTER.
  2694   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2695   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2696   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2697   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2698   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2699   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2700   02  FILLER                PIC X(02).
  2701   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2702   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2703   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2704   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2705   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2706 LINKAGE  SECTION.
  2707*****************************************************************
  2708*                                                               *
  2709* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2710* All rights reserved.                                          *
  2711*                                                               *
  2712*****************************************************************
  2713 01  dfheiblk.
  2714     02  eibtime          pic s9(7) comp-3.
  2715     02  eibdate          pic s9(7) comp-3.
  2716     02  eibtrnid         pic x(4).
  2717     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  52
* EL1278.cbl
  2718     02  eibtrmid         pic x(4).
  2719     02  dfheigdi         pic s9(4) comp.
  2720     02  eibcposn         pic s9(4) comp.
  2721     02  eibcalen         pic s9(4) comp.
  2722     02  eibaid           pic x(1).
  2723     02  eibfiller1       pic x(1).
  2724     02  eibfn            pic x(2).
  2725     02  eibfiller2       pic x(2).
  2726     02  eibrcode         pic x(6).
  2727     02  eibfiller3       pic x(2).
  2728     02  eibds            pic x(8).
  2729     02  eibreqid         pic x(8).
  2730     02  eibrsrce         pic x(8).
  2731     02  eibsync          pic x(1).
  2732     02  eibfree          pic x(1).
  2733     02  eibrecv          pic x(1).
  2734     02  eibsend          pic x(1).
  2735     02  eibatt           pic x(1).
  2736     02  eibeoc           pic x(1).
  2737     02  eibfmh           pic x(1).
  2738     02  eibcompl         pic x(1).
  2739     02  eibsig           pic x(1).
  2740     02  eibconf          pic x(1).
  2741     02  eiberr           pic x(1).
  2742     02  eibrldbk         pic x(1).
  2743     02  eiberrcd         pic x(4).
  2744     02  eibsynrb         pic x(1).
  2745     02  eibnodat         pic x(1).
  2746     02  eibfiller5       pic x(2).
  2747     02  eibresp          pic 9(09) comp.
  2748     02  eibresp2         pic 9(09) comp.
  2749     02  dfheigdj         pic s9(4) comp.
  2750     02  dfheigdk         pic s9(4) comp.
  2751
  2752 01  DFHCOMMAREA                 PIC  X(1024).
  2753
  2754*01 PARMLIST .
  2755*    12  FILLER                  PIC S9(08)      COMP.
  2756*    12  ELCNTL-POINTER          PIC S9(08)      COMP.
  2757*    12  ELACCT-POINTER          PIC S9(08)      COMP.
  2758*    12  ELCERT-POINTER          PIC S9(08)      COMP.
  2759*                            COPY ELCCNTL.
  2760******************************************************************
  2761*                                                                *
  2762*                                                                *
  2763*                            ELCCNTL.                            *
  2764*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2765*                            VMOD=2.059                          *
  2766*                                                                *
  2767*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2768*                                                                *
  2769*   FILE TYPE = VSAM,KSDS                                        *
  2770*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2771*                                                                *
  2772*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2773*       ALTERNATE INDEX = NONE                                   *
  2774*                                                                *
  2775*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  53
* EL1278.cbl
  2776*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2777******************************************************************
  2778*                   C H A N G E   L O G
  2779*
  2780* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2781*-----------------------------------------------------------------
  2782*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2783* EFFECTIVE    NUMBER
  2784*-----------------------------------------------------------------
  2785* 082503                   PEMA  ADD BENEFIT GROUP
  2786* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2787* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2788* 092705    2005050300006  PEMA  ADD SPP LEASES
  2789* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2790* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2791* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2792* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2793* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2794* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2795******************************************************************
  2796*
  2797 01  CONTROL-FILE.
  2798     12  CF-RECORD-ID                       PIC XX.
  2799         88  VALID-CF-ID                        VALUE 'CF'.
  2800
  2801     12  CF-CONTROL-PRIMARY.
  2802         16  CF-COMPANY-ID                  PIC XXX.
  2803         16  CF-RECORD-TYPE                 PIC X.
  2804             88  CF-COMPANY-MASTER              VALUE '1'.
  2805             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2806             88  CF-STATE-MASTER                VALUE '3'.
  2807             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2808             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2809             88  CF-CARRIER-MASTER              VALUE '6'.
  2810             88  CF-MORTALITY-MASTER            VALUE '7'.
  2811             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2812             88  CF-TERMINAL-MASTER             VALUE '9'.
  2813             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2814             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2815             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2816             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2817             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2818             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2819             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2820             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2821             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2822         16  CF-ACCESS-CD-GENL              PIC X(4).
  2823         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2824             20  CF-PROCESSOR               PIC X(4).
  2825         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2826             20  CF-STATE-CODE              PIC XX.
  2827             20  FILLER                     PIC XX.
  2828         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2829             20  FILLER                     PIC XX.
  2830             20  CF-HI-BEN-IN-REC           PIC XX.
  2831         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2832             20  FILLER                     PIC XXX.
  2833             20  CF-CARRIER-CNTL            PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  54
* EL1278.cbl
  2834         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2835             20  FILLER                     PIC XX.
  2836             20  CF-HI-TYPE-IN-REC          PIC 99.
  2837         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2838             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2839                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2840             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2841             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2842         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2843             20  FILLER                     PIC X.
  2844             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2845         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2846             20  FILLER                     PIC XX.
  2847             20  CF-MORTGAGE-PLAN           PIC XX.
  2848         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2849
  2850     12  CF-LAST-MAINT-DT                   PIC XX.
  2851     12  CF-LAST-MAINT-BY                   PIC X(4).
  2852     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2853
  2854     12  CF-RECORD-BODY                     PIC X(728).
  2855
  2856
  2857****************************************************************
  2858*             COMPANY MASTER RECORD                            *
  2859****************************************************************
  2860
  2861     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2862         16  CF-COMPANY-ADDRESS.
  2863             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2864             20  CF-CL-IN-CARE-OF           PIC X(30).
  2865             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2866             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2867             20  CF-CL-CITY-STATE           PIC X(30).
  2868             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2869             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2870         16  CF-COMPANY-CD                  PIC X.
  2871         16  CF-COMPANY-PASSWORD            PIC X(8).
  2872         16  CF-SECURITY-OPTION             PIC X.
  2873             88  ALL-SECURITY                   VALUE '1'.
  2874             88  COMPANY-VERIFY                 VALUE '2'.
  2875             88  PROCESSOR-VERIFY               VALUE '3'.
  2876             88  NO-SECURITY                    VALUE '4'.
  2877             88  ALL-BUT-TERM                   VALUE '5'.
  2878         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2879             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2880         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2881             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2882         16  CF-INFORCE-LOCATION            PIC X.
  2883             88  CERTS-ARE-ONLINE               VALUE '1'.
  2884             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2885             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2886         16  CF-LOWER-CASE-LETTERS          PIC X.
  2887         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2888             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2889             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2890             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2891             88  CF-ACCNT-CNTL                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  55
* EL1278.cbl
  2892             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2893
  2894         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2895         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2896
  2897         16  CF-LGX-CREDIT-USER             PIC X.
  2898             88  CO-IS-NOT-USER                 VALUE 'N'.
  2899             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2900
  2901         16 CF-CREDIT-CALC-CODES.
  2902             20  CF-CR-REM-TERM-CALC PIC X.
  2903               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2904               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2905               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2906               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2907               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2908               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2909               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2910             20  CF-CR-R78-METHOD           PIC X.
  2911               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2912               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2913
  2914         16  CF-CLAIM-CONTROL-COUNTS.
  2915             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2916                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2917
  2918             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2919                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2920
  2921             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2922                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2923
  2924             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2925                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2926
  2927         16  CF-CURRENT-MONTH-END           PIC XX.
  2928
  2929         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2930             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2931             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2932             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2933             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2934                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2935                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2936             20  CF-CO-PREM-REJECT-SW       PIC X.
  2937                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2938                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2939             20  CF-CO-REF-REJECT-SW        PIC X.
  2940                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2941                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2942
  2943         16  CF-CO-REPORTING-DT             PIC XX.
  2944         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2945         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2946           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2947           88  CF-CO-MONTH-END                  VALUE '1'.
  2948
  2949         16  CF-LGX-CLAIM-USER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  56
* EL1278.cbl
  2950             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2951             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2952
  2953         16  CF-CREDIT-EDIT-CONTROLS.
  2954             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2955             20  CF-MIN-AGE                 PIC 99.
  2956             20  CF-DEFAULT-AGE             PIC 99.
  2957             20  CF-MIN-TERM                PIC S999      COMP-3.
  2958             20  CF-MAX-TERM                PIC S999      COMP-3.
  2959             20  CF-DEFAULT-SEX             PIC X.
  2960             20  CF-JOINT-AGE-INPUT         PIC X.
  2961                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2962             20  CF-BIRTH-DATE-INPUT        PIC X.
  2963                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2964             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2965                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2966                 88  CF-ZERO-CARRIER            VALUE '1'.
  2967                 88  CF-ZERO-GROUPING           VALUE '2'.
  2968                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2969             20  CF-EDIT-SW                 PIC X.
  2970                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2971             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2972             20  CF-CR-PR-METHOD            PIC X.
  2973               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2974               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2975             20  FILLER                     PIC X.
  2976
  2977         16  CF-CREDIT-MISC-CONTROLS.
  2978             20  CF-REIN-TABLE-SW           PIC X.
  2979                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2980             20  CF-COMP-TABLE-SW           PIC X.
  2981                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2982             20  CF-EXPERIENCE-RETENTION-AGE
  2983                                            PIC S9        COMP-3.
  2984             20  CF-CONVERSION-DT           PIC XX.
  2985             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2986             20  CF-RUN-FREQUENCY-SW        PIC X.
  2987                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2988                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2989
  2990             20  CF-CR-CHECK-NO-CONTROL.
  2991                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2992                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2993                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2994                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2995                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2996                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2997
  2998                 24  CF-CR-CHECK-COUNT       REDEFINES
  2999                     CF-CR-CHECK-COUNTER      PIC X(4).
  3000
  3001                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3002                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3003
  3004                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3005                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3006                 24  CF-MAIL-PROCESSING       PIC X.
  3007                     88  MAIL-PROCESSING          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  57
* EL1278.cbl
  3008
  3009         16  CF-MISC-SYSTEM-CONTROL.
  3010             20  CF-SYSTEM-C                 PIC X.
  3011                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3012             20  CF-SYSTEM-D                 PIC X.
  3013                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3014             20  CF-SOC-SEC-NO-SW            PIC X.
  3015                 88  SOC-SEC-NO-USED             VALUE '1'.
  3016             20  CF-MEMBER-NO-SW             PIC X.
  3017                 88  MEMBER-NO-USED              VALUE '1'.
  3018             20  CF-TAX-ID-NUMBER            PIC X(11).
  3019             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3020             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3021                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3022                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3023                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3024                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3025             20  CF-SYSTEM-E                 PIC X.
  3026                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3027
  3028         16  CF-LGX-LIFE-USER               PIC X.
  3029             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3030             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3031
  3032         16  CF-CR-MONTH-END-DT             PIC XX.
  3033
  3034         16  CF-FILE-MAINT-DATES.
  3035             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3036                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3037             20  CF-LAST-BATCH       REDEFINES
  3038                 CF-LAST-BATCH-NO               PIC X(4).
  3039             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3040             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3041             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3042             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3043             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3044             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3045             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3046             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3047             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3048             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3049
  3050         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3051         16  FILLER                         PIC X.
  3052
  3053         16  CF-ALT-MORT-CODE               PIC X(4).
  3054         16  CF-MEMBER-CAPTION              PIC X(10).
  3055
  3056         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3057             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3058             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3059             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3060             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3061             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3062
  3063         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3064
  3065         16  CF-LIFE-OVERRIDE-L1            PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  58
* EL1278.cbl
  3066         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3067         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3068         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3069
  3070         16  CF-AH-OVERRIDE-L1              PIC X.
  3071         16  CF-AH-OVERRIDE-L2              PIC XX.
  3072         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3073         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3074
  3075         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3076         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3077
  3078         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3079         16  CF-AR-LAST-EL860-DT            PIC XX.
  3080         16  CF-MP-MONTH-END-DT             PIC XX.
  3081
  3082         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3083         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3084             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3085
  3086         16  CF-AR-MONTH-END-DT             PIC XX.
  3087
  3088         16  CF-CRDTCRD-USER                PIC X.
  3089             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3090             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3091
  3092         16  CF-CC-MONTH-END-DT             PIC XX.
  3093
  3094         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3095
  3096         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3097             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3098             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3099             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3100         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3101         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3102         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3103         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3104             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3105             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3106         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3107         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3108         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3109             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3110         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3111
  3112         16  CF-CL-ZIP-CODE.
  3113             20  CF-CL-ZIP-PRIME.
  3114                 24  CF-CL-ZIP-1ST          PIC X.
  3115                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3116                 24  FILLER                 PIC X(4).
  3117             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3118         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3119             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3120             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3121             20  FILLER                     PIC XXX.
  3122
  3123         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  59
* EL1278.cbl
  3124         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3125         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3126         16  CF-CO-OPTION-START-DATE        PIC XX.
  3127         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3128           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3129                                                      '3' '4'.
  3130           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3131           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3132           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3133           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3134           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3135           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3136
  3137         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3138
  3139         16  CF-PAYMENT-APPROVAL-LEVELS.
  3140             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3141             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3142             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3143             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3144             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3145             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3146
  3147         16  CF-END-USER-REPORTING-USER     PIC X.
  3148             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3149             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3150
  3151         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3152             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3153             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3154
  3155         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3156
  3157         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3158         16  FILLER                         PIC X.
  3159
  3160         16  CF-CREDIT-ARCHIVE-CNTL.
  3161             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3162             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3163             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3164
  3165         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3166
  3167         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3168             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3169             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3170
  3171         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3172             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3173             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3174
  3175         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3176
  3177         16  CF-CO-ACH-ID-CODE              PIC  X.
  3178             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3179             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3180             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3181         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  60
* EL1278.cbl
  3182         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3183         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3184         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3185         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3186         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3187         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3188         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3189         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3190                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3191         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3192                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3193
  3194         16  CF-CO-OVER-SHORT.
  3195             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3196             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3197
  3198*         16  FILLER                         PIC X(102).
  3199         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3200             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3201             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3202
  3203         16  CF-AH-APPROVAL-DAYS.
  3204             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3205             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3206             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3207             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3208
  3209         16  FILLER                         PIC X(82).
  3210****************************************************************
  3211*             PROCESSOR/USER RECORD                            *
  3212****************************************************************
  3213
  3214     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3215         16  CF-PROCESSOR-NAME              PIC X(30).
  3216         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3217         16  CF-PROCESSOR-TITLE             PIC X(26).
  3218         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3219                 88  MESSAGE-YES                VALUE 'Y'.
  3220                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3221
  3222*****************************************************
  3223****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3224****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3225****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3226****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3227*****************************************************
  3228
  3229         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3230             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3231             20  CF-APPLICATION-FORCE       PIC X.
  3232             20  CF-INDIVIDUAL-APP.
  3233                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3234                     28  CF-BROWSE-APP      PIC X.
  3235                     28  CF-UPDATE-APP      PIC X.
  3236
  3237         16  CF-CURRENT-TERM-ON             PIC X(4).
  3238         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3239             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  61
* EL1278.cbl
  3240             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3241             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3242             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3243             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3244             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3245             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3246         16  CF-PROCESSOR-CARRIER           PIC X.
  3247             88  NO-CARRIER-SECURITY            VALUE ' '.
  3248         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3249             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3250         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3251             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3252         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3253             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3254
  3255         16  CF-PROC-SYS-ACCESS-SW.
  3256             20  CF-PROC-CREDIT-CLAIMS-SW.
  3257                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3258                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3259                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3260                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3261             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3262                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3263                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3264             20  CF-PROC-LIFE-GNRLDGR-SW.
  3265                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3266                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3267                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3268                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3269             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3270                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3271                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3272         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3273             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3274             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3275         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3276
  3277         16  CF-APPROVAL-LEVEL                  PIC X.
  3278             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3279             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3280             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3281             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3282
  3283         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3284
  3285         16  CF-LANGUAGE-TYPE                   PIC X.
  3286             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3287             88  CF-LANG-IS-FR                      VALUE 'F'.
  3288
  3289         16  CF-CSR-IND                         PIC X.
  3290         16  FILLER                             PIC X(239).
  3291
  3292****************************************************************
  3293*             PROCESSOR/REMINDERS RECORD                       *
  3294****************************************************************
  3295
  3296     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3297         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  62
* EL1278.cbl
  3298             20  CF-START-REMIND-DT         PIC XX.
  3299             20  CF-END-REMIND-DT           PIC XX.
  3300             20  CF-REMINDER-TEXT           PIC X(50).
  3301         16  FILLER                         PIC X(296).
  3302
  3303
  3304****************************************************************
  3305*             STATE MASTER RECORD                              *
  3306****************************************************************
  3307
  3308     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3309         16  CF-STATE-ABBREVIATION          PIC XX.
  3310         16  CF-STATE-NAME                  PIC X(25).
  3311         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3312         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3313             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3314             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3315             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3316             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3317                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3318                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3319             20  CF-ST-PREM-REJECT-SW       PIC X.
  3320                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3321                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3322             20  CF-ST-REF-REJECT-SW        PIC X.
  3323                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3324                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3325         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3326         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3327         16  CF-ST-REFUND-RULES.
  3328             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3329             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3330             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3331         16  CF-ST-FST-PMT-EXTENSION.
  3332             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3333             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3334                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3335                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3336                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3337                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3338         16  CF-ST-STATE-CALL.
  3339             20  CF-ST-CALL-UNEARNED        PIC X.
  3340             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3341             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3342         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3343             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3344             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3345         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3346         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3347         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3348         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3349         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3350         16  FILLER                         PIC X.
  3351         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3352             20  CF-ST-BENEFIT-CD           PIC XX.
  3353             20  CF-ST-BENEFIT-KIND         PIC X.
  3354                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3355                 88  CF-ST-AH-KIND              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  63
* EL1278.cbl
  3356             20  CF-ST-REM-TERM-CALC        PIC X.
  3357                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3358                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3359                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3360                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3361                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3362                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3363                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3364                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3365
  3366             20  CF-ST-REFUND-CALC          PIC X.
  3367                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3368                 88  ST-REFD-BY-R78             VALUE '1'.
  3369                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3370                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3371                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3372                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3373                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3374                 88  ST-REFD-UTAH               VALUE '7'.
  3375                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3376                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3377                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3378
  3379             20  CF-ST-EARNING-CALC         PIC X.
  3380                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3381                 88  ST-EARN-BY-R78             VALUE '1'.
  3382                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3383                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3384                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3385                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3386                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3387                 88  ST-EARN-MEAN               VALUE '8'.
  3388                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3389
  3390             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3391                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3392                 88  ST-OVRD-BY-R78             VALUE '1'.
  3393                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3394                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3395                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3396                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3397                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3398                 88  ST-OVRD-MEAN               VALUE '8'.
  3399                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3400             20  FILLER                     PIC X.
  3401
  3402         16  CF-ST-COMMISSION-CAPS.
  3403             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3404             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3405             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3406             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3407         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3408                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3409
  3410         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3411
  3412         16  CF-ST-STATUTORY-INTEREST.
  3413             20  CF-ST-STAT-DATE-FROM       PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  64
* EL1278.cbl
  3414                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3415                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3416             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3417             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3418             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3419             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3420             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3421
  3422         16  CF-ST-OVER-SHORT.
  3423             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3424             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3425
  3426         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3427
  3428         16  CF-ST-RT-CALC                  PIC X.
  3429
  3430         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3431         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3432         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3433         16  CF-ST-RF-LR-CALC               PIC X.
  3434         16  CF-ST-RF-LL-CALC               PIC X.
  3435         16  CF-ST-RF-LN-CALC               PIC X.
  3436         16  CF-ST-RF-AH-CALC               PIC X.
  3437         16  CF-ST-RF-CP-CALC               PIC X.
  3438*        16  FILLER                         PIC X(206).
  3439*CIDMOD         16  FILLER                         PIC X(192).
  3440         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3441             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3442         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3443         16  CF-ST-VFY-2ND-BENE             PIC X.
  3444         16  FILLER                         PIC X(186).
  3445
  3446****************************************************************
  3447*             BENEFIT MASTER RECORD                            *
  3448****************************************************************
  3449
  3450     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3451         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3452             20  CF-BENEFIT-CODE            PIC XX.
  3453             20  CF-BENEFIT-NUMERIC  REDEFINES
  3454                 CF-BENEFIT-CODE            PIC XX.
  3455             20  CF-BENEFIT-ALPHA           PIC XXX.
  3456             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3457             20  CF-BENEFIT-COMMENT         PIC X(10).
  3458
  3459             20  CF-LF-COVERAGE-TYPE        PIC X.
  3460                 88  CF-REDUCING                VALUE 'R'.
  3461                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3462
  3463             20  CF-SPECIAL-CALC-CD         PIC X.
  3464                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3465                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3466                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3467                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3468                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3469                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3470                 88  CF-FARM-PLAN               VALUE 'F'.
  3471                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  65
* EL1278.cbl
  3472                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3473                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3474                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3475                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3476                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3477                 88  CF-PRUDENTIAL              VALUE 'P'.
  3478                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3479                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3480                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3481                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3482                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3483                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3484
  3485             20  CF-JOINT-INDICATOR         PIC X.
  3486                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3487
  3488*            20  FILLER                     PIC X(12).
  3489             20  FILLER                     PIC X(11).
  3490             20  CF-BENEFIT-CATEGORY        PIC X.
  3491             20  CF-LOAN-TYPE               PIC X(8).
  3492
  3493             20  CF-CO-REM-TERM-CALC        PIC X.
  3494                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3495                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3496                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3497                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3498                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3499
  3500             20  CF-CO-EARNINGS-CALC        PIC X.
  3501                 88  CO-EARN-BY-R78             VALUE '1'.
  3502                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3503                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3504                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3505                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3506                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3507                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3508                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3509
  3510             20  CF-CO-REFUND-CALC          PIC X.
  3511                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3512                 88  CO-REFD-BY-R78             VALUE '1'.
  3513                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3514                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3515                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3516                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3517                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3518                 88  CO-REFD-MEAN               VALUE '8'.
  3519                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3520                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3521                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3522
  3523             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3524                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3525                 88  CO-OVRD-BY-R78             VALUE '1'.
  3526                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3527                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3528                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3529                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  66
* EL1278.cbl
  3530                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3531                 88  CO-OVRD-MEAN               VALUE '8'.
  3532                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3533
  3534             20  CF-CO-BEN-I-G-CD           PIC X.
  3535                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3536                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3537                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3538
  3539         16  FILLER                         PIC X(304).
  3540
  3541
  3542****************************************************************
  3543*             CARRIER MASTER RECORD                            *
  3544****************************************************************
  3545
  3546     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3547         16  CF-ADDRESS-DATA.
  3548             20  CF-MAIL-TO-NAME            PIC X(30).
  3549             20  CF-IN-CARE-OF              PIC X(30).
  3550             20  CF-ADDRESS-LINE-1          PIC X(30).
  3551             20  CF-ADDRESS-LINE-2          PIC X(30).
  3552             20  CF-CITY-STATE              PIC X(30).
  3553             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3554             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3555
  3556         16  CF-CLAIM-NO-CONTROL.
  3557             20  CF-CLAIM-NO-METHOD         PIC X.
  3558                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3559                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3560                 88  CLAIM-NO-SEQ               VALUE '3'.
  3561                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3562             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3563                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3564                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3565                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3566
  3567         16  CF-CHECK-NO-CONTROL.
  3568             20  CF-CHECK-NO-METHOD         PIC X.
  3569                 88  CHECK-NO-MANUAL            VALUE '1'.
  3570                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3571                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3572                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3573             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3574                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3575
  3576         16  CF-DOMICILE-STATE              PIC XX.
  3577
  3578         16  CF-EXPENSE-CONTROLS.
  3579             20  CF-EXPENSE-METHOD          PIC X.
  3580                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3581                 88  DOLLARS-PER-PMT            VALUE '2'.
  3582                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3583                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3584             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3585             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3586
  3587         16  CF-CORRESPONDENCE-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  67
* EL1278.cbl
  3588             20  CF-LETTER-RESEND-OPT       PIC X.
  3589                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3590                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3591             20  FILLER                     PIC X(4).
  3592
  3593         16  CF-RESERVE-CONTROLS.
  3594             20  CF-MANUAL-SW               PIC X.
  3595                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3596             20  CF-FUTURE-SW               PIC X.
  3597                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3598             20  CF-PTC-SW                  PIC X.
  3599                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3600             20  CF-IBNR-SW                 PIC X.
  3601                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3602             20  CF-PTC-LF-SW               PIC X.
  3603                 88  CF-LF-PTC-USED             VALUE '1'.
  3604             20  CF-CDT-ACCESS-METHOD       PIC X.
  3605                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3606                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3607                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3608             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3609
  3610         16  CF-CLAIM-CALC-METHOD           PIC X.
  3611             88  360-PLUS-MONTHS                VALUE '1'.
  3612             88  365-PLUS-MONTHS                VALUE '2'.
  3613             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3614             88  360-DAILY                      VALUE '4'.
  3615             88  365-DAILY                      VALUE '5'.
  3616
  3617         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3618         16  FILLER                         PIC X(11).
  3619
  3620         16  CF-LIMIT-AMOUNTS.
  3621             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3622             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3623             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3624             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3625             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3626             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3627             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3628             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3629             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3630             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3631
  3632         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3633         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3634         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3635
  3636         16  CF-ZIP-CODE.
  3637             20  CF-ZIP-PRIME.
  3638                 24  CF-ZIP-1ST             PIC X.
  3639                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3640                 24  FILLER                 PIC X(4).
  3641             20  CF-ZIP-PLUS4               PIC X(4).
  3642         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3643             20  CF-CAN-POSTAL-1            PIC XXX.
  3644             20  CF-CAN-POSTAL-2            PIC XXX.
  3645             20  FILLER                     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  68
* EL1278.cbl
  3646
  3647         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3648         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3649         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3650
  3651         16  CF-RATING-SWITCH               PIC X.
  3652             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3653             88  CF-NO-RATING                   VALUE 'N'.
  3654
  3655         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3656
  3657         16  CF-CARRIER-OVER-SHORT.
  3658             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3659             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3660
  3661         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3662         16  CF-SECPAY-SWITCH               PIC X.
  3663             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3664             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3665         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3666         16  FILLER                         PIC X(448).
  3667*        16  FILLER                         PIC X(452).
  3668
  3669
  3670****************************************************************
  3671*             MORTALITY MASTER RECORD                          *
  3672****************************************************************
  3673
  3674     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3675         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3676                                INDEXED BY CF-MORT-NDX.
  3677             20  CF-MORT-TABLE              PIC X(5).
  3678             20  CF-MORT-TABLE-TYPE         PIC X.
  3679                 88  CF-MORT-JOINT              VALUE 'J'.
  3680                 88  CF-MORT-SINGLE             VALUE 'S'.
  3681                 88  CF-MORT-COMBINED           VALUE 'C'.
  3682                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3683                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3684             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3685             20  CF-MORT-AGE-METHOD         PIC XX.
  3686                 88  CF-AGE-LAST                VALUE 'AL'.
  3687                 88  CF-AGE-NEAR                VALUE 'AN'.
  3688             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3689             20  CF-MORT-ADJUSTMENT-DIRECTION
  3690                                            PIC X.
  3691                 88  CF-MINUS                   VALUE '-'.
  3692                 88  CF-PLUS                    VALUE '+'.
  3693             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3694             20  CF-MORT-JOINT-CODE         PIC X.
  3695                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3696             20  CF-MORT-PC-Q               PIC X.
  3697                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3698             20  CF-MORT-TABLE-CODE         PIC X(4).
  3699             20  CF-MORT-COMMENTS           PIC X(15).
  3700             20  FILLER                     PIC X(14).
  3701
  3702         16  FILLER                         PIC X(251).
  3703
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  69
* EL1278.cbl
  3704
  3705****************************************************************
  3706*             BUSSINESS TYPE MASTER RECORD                     *
  3707****************************************************************
  3708
  3709     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3710* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3711* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3712* AND RECORD 05 IS TYPES 81-99
  3713         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3714             20  CF-BUSINESS-TITLE          PIC  X(19).
  3715             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3716                                            PIC S9V9(4) COMP-3.
  3717             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3718             20  FILLER                     PIC  X.
  3719         16  FILLER                         PIC  X(248).
  3720
  3721
  3722****************************************************************
  3723*             TERMINAL MASTER RECORD                           *
  3724****************************************************************
  3725
  3726     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3727
  3728         16  CF-COMPANY-TERMINALS.
  3729             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3730                                  PIC X(4).
  3731         16  FILLER               PIC X(248).
  3732
  3733
  3734****************************************************************
  3735*             LIFE EDIT MASTER RECORD                          *
  3736****************************************************************
  3737
  3738     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3739         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3740             20  CF-LIFE-CODE-IN            PIC XX.
  3741             20  CF-LIFE-CODE-OUT           PIC XX.
  3742         16  FILLER                         PIC X(248).
  3743
  3744
  3745****************************************************************
  3746*             AH EDIT MASTER RECORD                            *
  3747****************************************************************
  3748
  3749     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3750         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3751             20  CF-AH-CODE-IN              PIC XXX.
  3752             20  CF-AH-CODE-OUT             PIC XX.
  3753         16  FILLER                         PIC X(248).
  3754
  3755
  3756****************************************************************
  3757*             CREDIBILITY TABLES                               *
  3758****************************************************************
  3759
  3760     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3761         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  70
* EL1278.cbl
  3762                             INDEXED BY CF-CRDB-NDX.
  3763             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3764             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3765             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3766         16  FILLER                         PIC  X(332).
  3767
  3768
  3769****************************************************************
  3770*             REPORT CUSTOMIZATION RECORD                      *
  3771****************************************************************
  3772
  3773     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3774         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3775             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3776             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3777             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3778**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3779****       A T-TRANSFER.                                   ****
  3780             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3781
  3782         16  FILLER                         PIC XX.
  3783
  3784         16  CF-CARRIER-CNTL-OPT.
  3785             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3786                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3787                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3788             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3789                                            PIC X.
  3790         16  CF-GROUP-CNTL-OPT.
  3791             20  CF-GROUP-OPT-SEQ           PIC 9.
  3792                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3793                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3794             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3795                                            PIC X(6).
  3796         16  CF-STATE-CNTL-OPT.
  3797             20  CF-STATE-OPT-SEQ           PIC 9.
  3798                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3799                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3800             20  CF-STATE-SELECT OCCURS 3 TIMES
  3801                                            PIC XX.
  3802         16  CF-ACCOUNT-CNTL-OPT.
  3803             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3804                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3805                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3806             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3807                                            PIC X(10).
  3808         16  CF-BUS-TYP-CNTL-OPT.
  3809             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3810                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3811                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3812             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3813                                            PIC XX.
  3814         16  CF-LF-TYP-CNTL-OPT.
  3815             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3816                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3817                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3818             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3819                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  71
* EL1278.cbl
  3820         16  CF-AH-TYP-CNTL-OPT.
  3821             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3822                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3823                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3824             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3825                                            PIC XX.
  3826         16  CF-REPTCD1-CNTL-OPT.
  3827             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3828                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3829                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3830             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3831                                            PIC X(10).
  3832         16  CF-REPTCD2-CNTL-OPT.
  3833             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3834                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3835                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3836             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3837                                            PIC X(10).
  3838         16  CF-USER1-CNTL-OPT.
  3839             20  CF-USER1-OPT-SEQ           PIC 9.
  3840                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3841                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3842             20  CF-USER1-SELECT OCCURS 3 TIMES
  3843                                            PIC X(10).
  3844         16  CF-USER2-CNTL-OPT.
  3845             20  CF-USER2-OPT-SEQ           PIC 9.
  3846                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3847                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3848             20  CF-USER2-SELECT OCCURS 3 TIMES
  3849                                            PIC X(10).
  3850         16  CF-USER3-CNTL-OPT.
  3851             20  CF-USER3-OPT-SEQ           PIC 9.
  3852                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3853                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3854             20  CF-USER3-SELECT OCCURS 3 TIMES
  3855                                            PIC X(10).
  3856         16  CF-USER4-CNTL-OPT.
  3857             20  CF-USER4-OPT-SEQ           PIC 9.
  3858                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3859                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3860             20  CF-USER4-SELECT OCCURS 3 TIMES
  3861                                            PIC X(10).
  3862         16  CF-USER5-CNTL-OPT.
  3863             20  CF-USER5-OPT-SEQ           PIC 9.
  3864                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3865                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3866             20  CF-USER5-SELECT OCCURS 3 TIMES
  3867                                            PIC X(10).
  3868         16  CF-REINS-CNTL-OPT.
  3869             20  CF-REINS-OPT-SEQ           PIC 9.
  3870                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3871                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3872             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3873                 24  CF-REINS-PRIME         PIC XXX.
  3874                 24  CF-REINS-SUB           PIC XXX.
  3875
  3876         16  CF-AGENT-CNTL-OPT.
  3877             20  CF-AGENT-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  72
* EL1278.cbl
  3878                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3879                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3880             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3881                                            PIC X(10).
  3882
  3883         16  FILLER                         PIC X(43).
  3884
  3885         16  CF-LOSS-RATIO-SELECT.
  3886             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3887             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3888         16  CF-ENTRY-DATE-SELECT.
  3889             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3890             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3891         16  CF-EFFECTIVE-DATE-SELECT.
  3892             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3893             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3894
  3895         16  CF-EXCEPTION-LIST-IND          PIC X.
  3896             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3897
  3898         16  FILLER                         PIC X(318).
  3899
  3900****************************************************************
  3901*                  EXCEPTION REPORTING RECORD                  *
  3902****************************************************************
  3903
  3904     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3905         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3906             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3907
  3908         16  CF-COMBINED-LIFE-AH-OPT.
  3909             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3910             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3911             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3912             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3913
  3914         16  CF-LIFE-OPT.
  3915             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3916             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3917             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3918             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3919             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3920             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3921             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3922             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3923             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3924             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3925
  3926         16  CF-AH-OPT.
  3927             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3928             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3929             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3930             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3931             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3932             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3933             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3934             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3935             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  73
* EL1278.cbl
  3936             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3937
  3938         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3939             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3940             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3941             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3942
  3943         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3944
  3945         16  FILLER                         PIC X(673).
  3946
  3947
  3948****************************************************************
  3949*             MORTGAGE SYSTEM PLAN RECORD                      *
  3950****************************************************************
  3951
  3952     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3953         16  CF-PLAN-TYPE                   PIC X.
  3954             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3955             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3956             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3957         16  CF-PLAN-ABBREV                 PIC XXX.
  3958         16  CF-PLAN-DESCRIPT               PIC X(10).
  3959         16  CF-PLAN-NOTES                  PIC X(20).
  3960         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3961         16  CF-PLAN-UNDERWRITING.
  3962             20  CF-PLAN-TERM-DATA.
  3963                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3964                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3965             20  CF-PLAN-AGE-DATA.
  3966                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3967                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3968                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3969             20  CF-PLAN-BENEFIT-DATA.
  3970                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3971                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3972                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3973                                            PIC S9(7)V99  COMP-3.
  3974         16  CF-PLAN-POLICY-FORMS.
  3975             20  CF-POLICY-FORM             PIC X(12).
  3976             20  CF-MASTER-APPLICATION      PIC X(12).
  3977             20  CF-MASTER-POLICY           PIC X(12).
  3978         16  CF-PLAN-RATING.
  3979             20  CF-RATE-CODE               PIC X(5).
  3980             20  CF-SEX-RATING              PIC X.
  3981                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3982                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3983             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3984             20  CF-SUB-STD-TYPE            PIC X.
  3985                 88  CF-PCT-OF-PREM            VALUE '1'.
  3986                 88  CF-PCT-OF-BENE            VALUE '2'.
  3987         16  CF-PLAN-PREM-TOLERANCES.
  3988             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3989             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3990         16  CF-PLAN-PYMT-TOLERANCES.
  3991             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3992             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3993         16  CF-PLAN-MISC-DATA.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  74
* EL1278.cbl
  3994             20  FILLER                     PIC X.
  3995             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3996             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3997         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3998         16  CF-PLAN-IND-GRP                PIC X.
  3999             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4000                                                     '1'.
  4001             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4002                                                     '2'.
  4003         16  CF-MIB-SEARCH-SW               PIC X.
  4004             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4005             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4006             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4007             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4008         16  CF-ALPHA-SEARCH-SW             PIC X.
  4009             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4010             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4011             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4012             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4013             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4014             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4015             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4016             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4017             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4018             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4019                                                     'A' 'B' 'C'
  4020                                                     'X' 'Y' 'Z'.
  4021         16  CF-EFF-DT-RULE-SW              PIC X.
  4022             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4023             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4024             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4025             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4026             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4027         16  FILLER                         PIC X(4).
  4028         16  CF-HEALTH-QUESTIONS            PIC X.
  4029             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4030         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4031         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4032         16  CF-PLAN-SNGL-JNT               PIC X.
  4033             88  CF-COMBINED-PLAN              VALUE 'C'.
  4034             88  CF-JNT-PLAN                   VALUE 'J'.
  4035             88  CF-SNGL-PLAN                  VALUE 'S'.
  4036         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4037         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4038         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4039         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4040         16  CF-RERATE-CNTL                 PIC  X.
  4041             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4042             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4043             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4044             88  CF-AUTO-RECALC                 VALUE '4'.
  4045         16  CF-BENEFIT-TYPE                PIC  X.
  4046             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4047             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4048         16  CF-POLICY-FEE                  PIC S999V99
  4049                                                    COMP-3.
  4050         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4051         16  CF-2ND-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  75
* EL1278.cbl
  4052         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4053         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4054         16  FILLER                         PIC  X(32).
  4055         16  CF-TERMINATION-FORM            PIC  X(04).
  4056         16  FILLER                         PIC  X(08).
  4057         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4058                                                       COMP-3.
  4059         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4060         16  CF-ISSUE-LETTER                PIC  X(4).
  4061         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4062         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4063             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4064             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4065         16  CF-MP-REFUND-CALC              PIC X.
  4066             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4067             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4068             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4069             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4070             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4071             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4072             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4073             88  CF-MP-REFD-MEAN                VALUE '8'.
  4074         16  CF-ALT-RATE-CODE               PIC  X(5).
  4075
  4076
  4077         16  FILLER                         PIC X(498).
  4078****************************************************************
  4079*             MORTGAGE COMPANY MASTER RECORD                   *
  4080****************************************************************
  4081
  4082     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4083         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4084         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4085             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4086             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4087             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4088             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4089             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4090
  4091         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4092         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4093         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4094         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4095         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4096
  4097         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4098             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4099         16  CF-MP-RECON-USE-IND            PIC X(1).
  4100             88  CF-MP-USE-RECON             VALUE 'Y'.
  4101         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4102             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4103         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4104             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4105             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4106         16  FILLER                         PIC X(1).
  4107         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4108             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4109         16  CF-MORTG-MIB-VERSION           PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  76
* EL1278.cbl
  4110             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4111             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4112             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4113         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4114             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4115                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4116             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4117                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4118             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4119                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4120             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4121                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4122             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4123                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4124             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4125                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4126         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4127         16  FILLER                         PIC X(7).
  4128         16  CF-MORTG-DESTINATION-SYMBOL.
  4129             20  CF-MORTG-MIB-COMM          PIC X(5).
  4130             20  CF-MORTG-MIB-TERM          PIC X(5).
  4131         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4132             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4133         16  FILLER                         PIC X(03).
  4134         16  CF-MP-CHECK-NO-CONTROL.
  4135             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4136                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4137                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4138                                                ' ' LOW-VALUES.
  4139                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4140                                               VALUE '3'.
  4141         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4142         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4143         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4144             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4145                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4146             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4147                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4148             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4149                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4150             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4151                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4152             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4153                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4154             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4155                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4156         16  CF-MORTG-BILLING-AREA.
  4157             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4158                                            PIC X.
  4159         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4160         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4161         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4162         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4163             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4164             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4165         16  FILLER                         PIC X.
  4166         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4167             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  77
* EL1278.cbl
  4168             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4169         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4170         16  FILLER                         PIC X(8).
  4171         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4172         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4173         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4174         16  CF-ACH-COMPANY-ID.
  4175             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4176                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4177                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4178                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4179             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4180         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4181             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4182         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4183             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4184             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4185         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4186         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4187         16  FILLER                         PIC X(536).
  4188
  4189****************************************************************
  4190*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4191****************************************************************
  4192
  4193     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4194         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4195             20  CF-FEMALE-HEIGHT.
  4196                 24  CF-FEMALE-FT           PIC 99.
  4197                 24  CF-FEMALE-IN           PIC 99.
  4198             20  CF-FEMALE-MIN-WT           PIC 999.
  4199             20  CF-FEMALE-MAX-WT           PIC 999.
  4200         16  FILLER                         PIC X(428).
  4201
  4202     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4203         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4204             20  CF-MALE-HEIGHT.
  4205                 24  CF-MALE-FT             PIC 99.
  4206                 24  CF-MALE-IN             PIC 99.
  4207             20  CF-MALE-MIN-WT             PIC 999.
  4208             20  CF-MALE-MAX-WT             PIC 999.
  4209         16  FILLER                         PIC X(428).
  4210******************************************************************
  4211*             AUTOMATIC ACTIVITY RECORD                          *
  4212******************************************************************
  4213     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4214         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4215             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4216             20  CF-SYS-LETTER-ID           PIC X(04).
  4217             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4218             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4219             20  CF-SYS-RESET-SW            PIC X(01).
  4220             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4221             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4222
  4223         16  FILLER                         PIC X(50).
  4224
  4225         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  78
* EL1278.cbl
  4226             20  CF-USER-ACTIVE-SW          PIC X(01).
  4227             20  CF-USER-LETTER-ID          PIC X(04).
  4228             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4229             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4230             20  CF-USER-RESET-SW           PIC X(01).
  4231             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4232             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4233             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4234
  4235         16  FILLER                         PIC X(246).
  4236*                            COPY ERCACCT.
  4237******************************************************************
  4238*                                                                *
  4239*                                                                *
  4240*                            ERCACCT                             *
  4241*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4242*                            VMOD=2.031                          *
  4243*                                                                *
  4244*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4245*                                                                *
  4246*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4247*   VSAM ACCOUNT MASTER FILES.                                   *
  4248*                                                                *
  4249*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4250*                                                                *
  4251*   FILE TYPE = VSAM,KSDS                                        *
  4252*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4253*                                                                *
  4254*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4255*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4256*                                                                *
  4257*   LOG = NO                                                     *
  4258*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4259*                                                                *
  4260*                                                                *
  4261******************************************************************
  4262*                   C H A N G E   L O G
  4263*
  4264* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4265*-----------------------------------------------------------------
  4266*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4267* EFFECTIVE    NUMBER
  4268*-----------------------------------------------------------------
  4269* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4270* 092705    2005050300006  PEMA  ADD SPP LEASES
  4271* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4272* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4273* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4274* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4275* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4276******************************************************************
  4277
  4278 01  ACCOUNT-MASTER.
  4279     12  AM-RECORD-ID                      PIC XX.
  4280         88  VALID-AM-ID                      VALUE 'AM'.
  4281
  4282     12  AM-CONTROL-PRIMARY.
  4283         16  AM-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  79
* EL1278.cbl
  4284         16  AM-MSTR-CNTRL.
  4285             20  AM-CONTROL-A.
  4286                 24  AM-CARRIER            PIC X.
  4287                 24  AM-GROUPING.
  4288                     28 AM-GROUPING-PREFIX PIC XXX.
  4289                     28 AM-GROUPING-PRIME  PIC XXX.
  4290                 24  AM-STATE              PIC XX.
  4291                 24  AM-ACCOUNT.
  4292                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4293                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4294             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4295                                           PIC X(19).
  4296             20  AM-CNTRL-B.
  4297                 24  AM-EXPIRATION-DT      PIC XX.
  4298                 24  FILLER                PIC X(4).
  4299             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4300                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4301
  4302     12  AM-CONTROL-BY-VAR-GRP.
  4303         16  AM-COMPANY-CD-A1              PIC X.
  4304         16  AM-VG-CARRIER                 PIC X.
  4305         16  AM-VG-GROUPING                PIC X(6).
  4306         16  AM-VG-STATE                   PIC XX.
  4307         16  AM-VG-ACCOUNT                 PIC X(10).
  4308         16  AM-VG-DATE.
  4309             20  AM-VG-EXPIRATION-DT       PIC XX.
  4310             20  FILLER                    PIC X(4).
  4311         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4312                                           PIC 9(11)      COMP-3.
  4313     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4314         16  FILLER                        PIC X(10).
  4315         16  AM-VG-KEY3.
  4316             20  AM-VG3-ACCOUNT            PIC X(10).
  4317             20  AM-VG3-EXP-DT             PIC XX.
  4318         16  FILLER                        PIC X(4).
  4319     12  AM-MAINT-INFORMATION.
  4320         16  AM-LAST-MAINT-DT              PIC XX.
  4321         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4322         16  AM-LAST-MAINT-USER            PIC X(4).
  4323         16  FILLER                        PIC XX.
  4324
  4325     12  AM-EFFECTIVE-DT                   PIC XX.
  4326     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4327
  4328     12  AM-PREV-DATES  COMP-3.
  4329         16  AM-PREV-EXP-DT                PIC 9(11).
  4330         16  AM-PREV-EFF-DT                PIC 9(11).
  4331
  4332     12  AM-REPORT-CODE-1                  PIC X(10).
  4333     12  AM-REPORT-CODE-2                  PIC X(10).
  4334
  4335     12  AM-CITY-CODE                      PIC X(4).
  4336     12  AM-COUNTY-PARISH                  PIC X(6).
  4337
  4338     12  AM-NAME                           PIC X(30).
  4339     12  AM-PERSON                         PIC X(30).
  4340     12  AM-ADDRS                          PIC X(30).
  4341     12  AM-CITY.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  80
* EL1278.cbl
  4342         16  AM-ADDR-CITY                  PIC X(28).
  4343         16  AM-ADDR-STATE                 PIC XX.
  4344     12  AM-ZIP.
  4345         16  AM-ZIP-PRIME.
  4346             20  AM-ZIP-PRI-1ST            PIC X.
  4347                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4348             20  FILLER                    PIC X(4).
  4349         16  AM-ZIP-PLUS4                  PIC X(4).
  4350     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4351         16  AM-CAN-POSTAL-1               PIC XXX.
  4352         16  AM-CAN-POSTAL-2               PIC XXX.
  4353         16  FILLER                        PIC XXX.
  4354     12  AM-TEL-NO.
  4355         16  AM-AREA-CODE                  PIC 999.
  4356         16  AM-TEL-PRE                    PIC 999.
  4357         16  AM-TEL-NBR                    PIC 9(4).
  4358     12  AM-TEL-LOC                        PIC X.
  4359         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4360         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4361
  4362     12  AM-COMM-STRUCTURE.
  4363         16  AM-DEFN-1.
  4364             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4365                 24  AM-AGT.
  4366                     28  AM-AGT-PREFIX     PIC X(4).
  4367                     28  AM-AGT-PRIME      PIC X(6).
  4368                 24  AM-COM-TYP            PIC X.
  4369                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4370                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4371                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4372                 24  AM-RECALC-LV-INDIC    PIC X.
  4373                 24  AM-RETRO-LV-INDIC     PIC X.
  4374                 24  AM-GL-CODES           PIC X.
  4375                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4376                 24  FILLER                PIC X(01).
  4377         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4378             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4379                 24  FILLER                PIC X(11).
  4380                 24  AM-L-COMA             PIC XXX.
  4381                 24  AM-J-COMA             PIC XXX.
  4382                 24  AM-A-COMA             PIC XXX.
  4383                 24  FILLER                PIC X(6).
  4384
  4385     12  AM-COMM-CHANGE-STATUS             PIC X.
  4386         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4387
  4388     12  AM-CSR-CODE                       PIC X(4).
  4389
  4390     12  AM-BILLING-STATUS                 PIC X.
  4391         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4392         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4393     12  AM-AUTO-REFUND-SW                 PIC X.
  4394         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4395         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4396     12  AM-GPCD                           PIC 99.
  4397     12  AM-IG                             PIC X.
  4398         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4399         88  AM-HAS-GROUP                     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  81
* EL1278.cbl
  4400     12  AM-STATUS                         PIC X.
  4401         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4402         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4403         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4404         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4405         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4406         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4407     12  AM-REMIT-TO                       PIC 99.
  4408     12  AM-ID-NO                          PIC X(11).
  4409
  4410     12  AM-CAL-TABLE                      PIC XX.
  4411     12  AM-LF-DEVIATION                   PIC XXX.
  4412     12  AM-AH-DEVIATION                   PIC XXX.
  4413     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4414     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4415     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4416     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4417     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4418     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4419
  4420     12  AM-USER-FIELDS.
  4421         16  AM-FLD-1                      PIC XX.
  4422         16  AM-FLD-2                      PIC XX.
  4423         16  AM-FLD-3                      PIC XX.
  4424         16  AM-FLD-4                      PIC XX.
  4425         16  AM-FLD-5                      PIC XX.
  4426
  4427     12  AM-1ST-PROD-DATE.
  4428         16  AM-1ST-PROD-YR                PIC XX.
  4429         16  AM-1ST-PROD-MO                PIC XX.
  4430         16  AM-1ST-PROD-DA                PIC XX.
  4431     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4432     12  AM-CERTS-PURGED-DATE.
  4433         16  AM-PUR-YR                     PIC XX.
  4434         16  AM-PUR-MO                     PIC XX.
  4435         16  AM-PUR-DA                     PIC XX.
  4436     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4437     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4438     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4439     12  AM-INACTIVE-DATE.
  4440         16  AM-INA-MO                     PIC 99.
  4441         16  AM-INA-DA                     PIC 99.
  4442         16  AM-INA-YR                     PIC 99.
  4443     12  AM-AR-HI-CERT-DATE                PIC XX.
  4444
  4445     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4446     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4447
  4448     12  AM-OB-PAYMENT-MODE                PIC X.
  4449         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4450         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4451         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4452         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4453
  4454     12  AM-AH-ONLY-INDICATOR              PIC X.
  4455         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4456         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4457
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  82
* EL1278.cbl
  4458     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4459
  4460     12  AM-OVER-SHORT.
  4461         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4462         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4463
  4464     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4465     12  AM-DCC-CLP-STATE                  PIC XX.
  4466
  4467     12  AM-RECALC-COMM                    PIC X.
  4468     12  AM-RECALC-REIN                    PIC X.
  4469
  4470     12  AM-REI-TABLE                      PIC XXX.
  4471     12  AM-REI-ET-LF                      PIC X.
  4472     12  AM-REI-ET-AH                      PIC X.
  4473     12  AM-REI-PE-LF                      PIC X.
  4474     12  AM-REI-PE-AH                      PIC X.
  4475     12  AM-REI-PRT-ST                     PIC X.
  4476     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4477     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4478     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4479     12  AM-REI-GROUP-A                    PIC X(6).
  4480     12  AM-REI-MORT                       PIC X(4).
  4481     12  AM-REI-PRT-OW                     PIC X.
  4482     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4483     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4484     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4485     12  AM-REI-GROUP-B                    PIC X(6).
  4486
  4487     12  AM-TRUST-TYPE                     PIC X(2).
  4488
  4489     12  AM-EMPLOYER-STMT-USED             PIC X.
  4490     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4491
  4492     12  AM-STD-AH-TYPE                    PIC XX.
  4493     12  AM-EARN-METHODS.
  4494         16  AM-EARN-METHOD-R              PIC X.
  4495             88 AM-REF-RL-R78                 VALUE 'R'.
  4496             88 AM-REF-RL-PR                  VALUE 'P'.
  4497             88 AM-REF-RL-MEAN                VALUE 'M'.
  4498             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4499         16  AM-EARN-METHOD-L              PIC X.
  4500             88 AM-REF-LL-R78                 VALUE 'R'.
  4501             88 AM-REF-LL-PR                  VALUE 'P'.
  4502             88 AM-REF-LL-MEAN                VALUE 'M'.
  4503             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4504         16  AM-EARN-METHOD-A              PIC X.
  4505             88 AM-REF-AH-R78                 VALUE 'R'.
  4506             88 AM-REF-AH-PR                  VALUE 'P'.
  4507             88 AM-REF-AH-MEAN                VALUE 'M'.
  4508             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4509             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4510             88 AM-REF-AH-NET                 VALUE 'N'.
  4511
  4512     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4513     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4514     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4515
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  83
* EL1278.cbl
  4516     12  AM-RET-Y-N                        PIC X.
  4517     12  AM-RET-P-E                        PIC X.
  4518     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4519     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4520     12  AM-RET-GRP                        PIC X(6).
  4521     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4522         16  AM-POOL-PRIME                 PIC XXX.
  4523         16  AM-POOL-SUB                   PIC XXX.
  4524     12  AM-RETRO-EARNINGS.
  4525         16  AM-RET-EARN-R                 PIC X.
  4526         16  AM-RET-EARN-L                 PIC X.
  4527         16  AM-RET-EARN-A                 PIC X.
  4528     12  AM-RET-ST-TAX-USE                 PIC X.
  4529         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4530         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4531     12  AM-RETRO-BEG-EARNINGS.
  4532         16  AM-RET-BEG-EARN-R             PIC X.
  4533         16  AM-RET-BEG-EARN-L             PIC X.
  4534         16  AM-RET-BEG-EARN-A             PIC X.
  4535     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4536     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4537
  4538     12  AM-USER-SELECT-OPTIONS.
  4539         16  AM-USER-SELECT-1              PIC X(10).
  4540         16  AM-USER-SELECT-2              PIC X(10).
  4541         16  AM-USER-SELECT-3              PIC X(10).
  4542         16  AM-USER-SELECT-4              PIC X(10).
  4543         16  AM-USER-SELECT-5              PIC X(10).
  4544
  4545     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4546
  4547     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4548
  4549     12  AM-RPT045A-SWITCH                 PIC X.
  4550         88  RPT045A-OFF                   VALUE 'N'.
  4551
  4552     12  AM-INSURANCE-LIMITS.
  4553         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4554         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4555
  4556     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4557         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4558
  4559     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4560         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4561         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4562
  4563     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4564
  4565     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4566     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4567     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4568     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4569     12  AM-DCC-UEF-STATE                  PIC XX.
  4570     12  FILLER                            PIC XXX.
  4571     12  AM-REPORT-CODE-3                  PIC X(10).
  4572*    12  FILLER                            PIC X(22).
  4573
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  84
* EL1278.cbl
  4574     12  AM-RESERVE-DATE.
  4575         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4576         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4577         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4578
  4579     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4580     12  AM-NOTIFICATION-TYPES.
  4581         16  AM-NOTIF-OF-LETTERS           PIC X.
  4582         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4583         16  AM-NOTIF-OF-REPORTS           PIC X.
  4584         16  AM-NOTIF-OF-STATUS            PIC X.
  4585
  4586     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4587         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4588         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4589         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4590         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4591
  4592     12  AM-BENEFIT-CONTROLS.
  4593         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4594             20  AM-BENEFIT-CODE           PIC XX.
  4595             20  AM-BENEFIT-TYPE           PIC X.
  4596             20  AM-BENEFIT-REVISION       PIC XXX.
  4597             20  AM-BENEFIT-REM-TERM       PIC X.
  4598             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4599             20  FILLER                    PIC XX.
  4600         16  FILLER                        PIC X(80).
  4601
  4602     12  AM-TRANSFER-DATA.
  4603         16  AM-TRANSFERRED-FROM.
  4604             20  AM-TRNFROM-CARRIER        PIC X.
  4605             20  AM-TRNFROM-GROUPING.
  4606                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4607                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4608             20  AM-TRNFROM-STATE          PIC XX.
  4609             20  AM-TRNFROM-ACCOUNT.
  4610                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4611                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4612             20  AM-TRNFROM-DTE            PIC XX.
  4613         16  AM-TRANSFERRED-TO.
  4614             20  AM-TRNTO-CARRIER          PIC X.
  4615             20  AM-TRNTO-GROUPING.
  4616                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4617                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4618             20  AM-TRNTO-STATE            PIC XX.
  4619             20  AM-TRNTO-ACCOUNT.
  4620                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4621                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4622             20  AM-TRNTO-DTE              PIC XX.
  4623         16  FILLER                        PIC X(10).
  4624
  4625     12  AM-SAVED-REMIT-TO                 PIC 99.
  4626
  4627     12  AM-COMM-STRUCTURE-SAVED.
  4628         16  AM-DEFN-1-SAVED.
  4629             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4630                 24  AM-AGT-SV             PIC X(10).
  4631                 24  AM-COM-TYP-SV         PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  85
* EL1278.cbl
  4632                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4633                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4634                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4635                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4636                 24  FILLER                PIC X.
  4637                 24  AM-GL-CODES-SV        PIC X.
  4638                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4639                 24  FILLER                PIC X.
  4640         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4641             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4642                 24  FILLER                PIC X(11).
  4643                 24  AM-L-COMA-SV          PIC XXX.
  4644                 24  AM-J-COMA-SV          PIC XXX.
  4645                 24  AM-A-COMA-SV          PIC XXX.
  4646                 24  FILLER                PIC X(6).
  4647
  4648     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4649         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4650            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4651            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4652            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4653
  4654     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4655     12  FILLER                            PIC X(120).
  4656
  4657     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4658         16  AM-CONTROL-NAME               PIC X(30).
  4659         16  AM-EXECUTIVE-ONE.
  4660             20  AM-EXEC1-NAME             PIC X(15).
  4661             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4662                                                          COMP-3.
  4663             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4664                                                          COMP-3.
  4665         16  AM-EXECUTIVE-TWO.
  4666             20  AM-EXEC2-NAME             PIC X(15).
  4667             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4668                                                          COMP-3.
  4669             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4670                                                          COMP-3.
  4671
  4672     12  AM-RETRO-ADDITIONAL-DATA.
  4673         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4674         16  AM-RETRO-PREM-P-E             PIC X.
  4675         16  AM-RETRO-CLMS-P-I             PIC X.
  4676         16  AM-RETRO-RET-BRACKET-LF.
  4677             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4678                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4679                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4680             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4681                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4682                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4683             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4684                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4685                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4686         16  AM-RETRO-RET-BRACKET-AH.
  4687             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4688                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4689                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  86
* EL1278.cbl
  4690                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4691             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4692                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4693                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4694             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4695                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4696                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4697
  4698     12  AM-COMMENTS.
  4699         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4700
  4701     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4702         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4703         16  AM-FLI-BILLING-CODE           PIC X.
  4704         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4705         16  AM-FLI-UNITED-IDENT           PIC X.
  4706         16  AM-FLI-INTEREST-LOST-DATA.
  4707             20  AM-FLI-BANK-NO            PIC X(5).
  4708             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4709             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4710             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4711         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4712             20  AM-FLI-AGT                PIC X(9).
  4713             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4714             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4715         16  FILLER                        PIC X(102).
  4716
  4717     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4718         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4719             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4720             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4721             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4722             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4723             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4724         16  FILLER                          PIC X(10).
  4725******************************************************************
  4726*                            COPY ELCCERT.
  4727******************************************************************
  4728*                                                                *
  4729*                            ELCCERT.                            *
  4730*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4731*                            VMOD=2.013                          *
  4732*                                                                *
  4733*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4734*                                                                *
  4735*   FILE TYPE = VSAM,KSDS                                        *
  4736*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4737*                                                                *
  4738*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4739*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4740*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4741*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4742*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4743*                                                                *
  4744*   LOG = YES                                                    *
  4745*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4746******************************************************************
  4747*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  87
* EL1278.cbl
  4748*
  4749* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4750*-----------------------------------------------------------------
  4751*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4752* EFFECTIVE    NUMBER
  4753*-----------------------------------------------------------------
  4754* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4755* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4756* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4757* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4758* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4759* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4760* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4761* 032612  CR2011110200001  PEMA  AHL CHANGES
  4762******************************************************************
  4763
  4764 01  CERTIFICATE-MASTER.
  4765     12  CM-RECORD-ID                      PIC XX.
  4766         88  VALID-CM-ID                      VALUE 'CM'.
  4767
  4768     12  CM-CONTROL-PRIMARY.
  4769         16  CM-COMPANY-CD                 PIC X.
  4770         16  CM-CARRIER                    PIC X.
  4771         16  CM-GROUPING.
  4772             20  CM-GROUPING-PREFIX        PIC X(3).
  4773             20  CM-GROUPING-PRIME         PIC X(3).
  4774         16  CM-STATE                      PIC XX.
  4775         16  CM-ACCOUNT.
  4776             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4777             20  CM-ACCOUNT-PRIME          PIC X(6).
  4778         16  CM-CERT-EFF-DT                PIC XX.
  4779         16  CM-CERT-NO.
  4780             20  CM-CERT-PRIME             PIC X(10).
  4781             20  CM-CERT-SFX               PIC X.
  4782
  4783     12  CM-CONTROL-BY-NAME.
  4784         16  CM-COMPANY-CD-A1              PIC X.
  4785         16  CM-INSURED-LAST-NAME          PIC X(15).
  4786         16  CM-INSURED-INITIALS.
  4787             20  CM-INSURED-INITIAL1       PIC X.
  4788             20  CM-INSURED-INITIAL2       PIC X.
  4789
  4790     12  CM-CONTROL-BY-SSN.
  4791         16  CM-COMPANY-CD-A2              PIC X.
  4792         16  CM-SOC-SEC-NO.
  4793             20  CM-SSN-STATE              PIC XX.
  4794             20  CM-SSN-ACCOUNT            PIC X(6).
  4795             20  CM-SSN-LN3.
  4796                 25  CM-INSURED-INITIALS-A2.
  4797                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4798                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4799                 25 CM-PART-LAST-NAME-A2         PIC X.
  4800
  4801     12  CM-CONTROL-BY-CERT-NO.
  4802         16  CM-COMPANY-CD-A4              PIC X.
  4803         16  CM-CERT-NO-A4                 PIC X(11).
  4804
  4805     12  CM-CONTROL-BY-MEMB.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  88
* EL1278.cbl
  4806         16  CM-COMPANY-CD-A5              PIC X.
  4807         16  CM-MEMBER-NO.
  4808             20  CM-MEMB-STATE             PIC XX.
  4809             20  CM-MEMB-ACCOUNT           PIC X(6).
  4810             20  CM-MEMB-LN4.
  4811                 25  CM-INSURED-INITIALS-A5.
  4812                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4813                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4814                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4815
  4816     12  CM-INSURED-PROFILE-DATA.
  4817         16  CM-INSURED-FIRST-NAME.
  4818             20  CM-INSURED-1ST-INIT       PIC X.
  4819             20  FILLER                    PIC X(9).
  4820         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4821         16  CM-INSURED-SEX                PIC X.
  4822             88  CM-SEX-MALE                  VALUE 'M'.
  4823             88  CM-SEX-FEMAL                 VALUE 'F'.
  4824         16  CM-INSURED-JOINT-AGE          PIC 99.
  4825         16  CM-JOINT-INSURED-NAME.
  4826             20  CM-JT-LAST-NAME           PIC X(15).
  4827             20  CM-JT-FIRST-NAME.
  4828                 24  CM-JT-1ST-INIT        PIC X.
  4829                 24  FILLER                PIC X(9).
  4830             20  CM-JT-INITIAL             PIC X.
  4831
  4832     12  CM-LIFE-DATA.
  4833         16  CM-LF-BENEFIT-CD              PIC XX.
  4834         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4835         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4836         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4837         16  CM-LF-DEV-CODE                PIC XXX.
  4838         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4839         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4840         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4841         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4842         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4843         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4844         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4845         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4846         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4847         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4848         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4849         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4850         16  FILLER                        PIC XX.
  4851
  4852     12  CM-AH-DATA.
  4853         16  CM-AH-BENEFIT-CD              PIC XX.
  4854         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4855         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4856         16  CM-AH-DEV-CODE                PIC XXX.
  4857         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4858         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4859         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4860         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4861         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4862         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4863         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  89
* EL1278.cbl
  4864         16  CM-AH-PAID-THRU-DT            PIC XX.
  4865             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4866         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4867         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4868         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4869         16  FILLER                        PIC X.
  4870
  4871     12  CM-LOAN-INFORMATION.
  4872         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4873         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4874                                           PIC S9(5)V99  COMP-3.
  4875         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4876         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4877         16  CM-PAY-FREQUENCY              PIC S99.
  4878         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4879         16  CM-RATE-CLASS                 PIC XX.
  4880         16  CM-BENEFICIARY                PIC X(25).
  4881         16  CM-POLICY-FORM-NO             PIC X(12).
  4882         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4883         16  CM-LAST-ADD-ON-DT             PIC XX.
  4884         16  CM-DEDUCTIBLE-AMOUNTS.
  4885             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4886             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4887         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4888             20  CM-RESIDENT-STATE         PIC XX.
  4889             20  CM-RATE-CODE              PIC X(4).
  4890             20  FILLER                    PIC XX.
  4891         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4892             20  CM-LOAN-OFFICER           PIC X(5).
  4893             20  FILLER                    PIC XXX.
  4894         16  CM-CSR-CODE                   PIC XXX.
  4895         16  CM-UNDERWRITING-CODE          PIC X.
  4896             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4897         16  CM-POST-CARD-IND              PIC X.
  4898         16  CM-NH-INTERFACE-SW            PIC X.
  4899         16  CM-PREMIUM-TYPE               PIC X.
  4900             88  CM-SING-PRM                  VALUE '1'.
  4901             88  CM-O-B-COVERAGE              VALUE '2'.
  4902             88  CM-OPEN-END                  VALUE '3'.
  4903         16  CM-IND-GRP-TYPE               PIC X.
  4904             88  CM-INDIVIDUAL                VALUE 'I'.
  4905             88  CM-GROUP                     VALUE 'G'.
  4906         16  CM-SKIP-CODE                  PIC X.
  4907             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4908             88  SKIP-JULY                    VALUE '1'.
  4909             88  SKIP-AUGUST                  VALUE '2'.
  4910             88  SKIP-SEPTEMBER               VALUE '3'.
  4911             88  SKIP-JULY-AUG                VALUE '4'.
  4912             88  SKIP-AUG-SEPT                VALUE '5'.
  4913             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4914             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4915             88  SKIP-JUNE                    VALUE '8'.
  4916             88  SKIP-JUNE-JULY               VALUE '9'.
  4917             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4918             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4919         16  CM-PAYMENT-MODE               PIC X.
  4920             88  PAY-MONTHLY                  VALUE SPACE.
  4921             88  PAY-WEEKLY                   VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  90
* EL1278.cbl
  4922             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4923             88  PAY-BI-WEEKLY                VALUE '3'.
  4924             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4925         16  CM-LOAN-NUMBER                PIC X(8).
  4926         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4927         16  CM-OLD-LOF                    PIC XXX.
  4928*        16  CM-LOAN-OFFICER               PIC XXX.
  4929         16  CM-REIN-TABLE                 PIC XXX.
  4930         16  CM-SPECIAL-REIN-CODE          PIC X.
  4931         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4932         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4933         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4934
  4935     12  CM-STATUS-DATA.
  4936         16  CM-ENTRY-STATUS               PIC X.
  4937         16  CM-ENTRY-DT                   PIC XX.
  4938
  4939         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4940         16  CM-LF-CANCEL-DT               PIC XX.
  4941         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4942
  4943         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4944         16  CM-LF-DEATH-DT                PIC XX.
  4945         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4946
  4947         16  CM-LF-CURRENT-STATUS          PIC X.
  4948             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4949                                                'M' '4' '5' '9'.
  4950             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4951             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4952             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4953             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4954             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4955             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4956             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4957             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4958             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4959             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4960             88  CM-LF-DECLINED               VALUE 'D'.
  4961             88  CM-LF-VOIDED                 VALUE 'V'.
  4962
  4963         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4964         16  CM-AH-CANCEL-DT               PIC XX.
  4965         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4966
  4967         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4968         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4969         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4970
  4971         16  CM-AH-CURRENT-STATUS          PIC X.
  4972             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4973                                                'M' '4' '5' '9'.
  4974             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4975             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4976             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4977             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4978             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4979             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  91
* EL1278.cbl
  4980             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4981             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4982             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4983             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4984             88  CM-AH-DECLINED               VALUE 'D'.
  4985             88  CM-AH-VOIDED                 VALUE 'V'.
  4986
  4987         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4988             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4989             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4990             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4991         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4992
  4993         16  CM-ENTRY-BATCH                PIC X(6).
  4994         16  CM-LF-EXIT-BATCH              PIC X(6).
  4995         16  CM-AH-EXIT-BATCH              PIC X(6).
  4996         16  CM-LAST-MONTH-END             PIC XX.
  4997
  4998     12  CM-NOTE-SW                        PIC X.
  4999         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5000         88  CERT-NOTES-PRESENT               VALUE '1'.
  5001         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5002         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5003         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5004         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5005         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5006         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5007     12  CM-COMP-EXCP-SW                   PIC X.
  5008         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5009         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5010     12  CM-INSURED-ADDRESS-SW             PIC X.
  5011         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5012         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5013
  5014*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5015     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5016     12  FILLER                            PIC X.
  5017
  5018*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5019     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5020     12  FILLER                            PIC X.
  5021*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5022     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5023
  5024     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5025         88  CERT-ADDED-BATCH                 VALUE ' '.
  5026         88  CERT-ADDED-ONLINE                VALUE '1'.
  5027         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5028         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5029         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5030     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5031         88  CERT-AS-LOADED                   VALUE ' '.
  5032         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5033         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5034         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5035         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5036         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5037         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  92
* EL1278.cbl
  5038         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5039
  5040     12  CM-ACCOUNT-COMM-PCTS.
  5041         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5042         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5043
  5044     12  CM-USER-FIELD                     PIC X.
  5045     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5046     12  CM-CLP-STATE                      PIC XX.
  5047     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5048     12  CM-USER-RESERVED                  PIC XXX.
  5049     12  FILLER REDEFINES CM-USER-RESERVED.
  5050         16  CM-AH-CLASS-CD                PIC XX.
  5051         16  F                             PIC X.
  5052******************************************************************
  5053*                            COPY ERCMAIL.
  5054******************************************************************
  5055*                                                                *
  5056*                                                                *
  5057*                            ERCMAIL                             *
  5058*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5059*                            VMOD=2.003                          *
  5060*                                                                *
  5061*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5062*                                                                *
  5063*   FILE TYPE = VSAM,KSDS                                        *
  5064*   RECORD SIZE = 374   RECFORM = FIX                            *
  5065*                                                                *
  5066*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5067*   ALTERNATE PATH    = NOT USED                                 *
  5068*                                                                *
  5069*   LOG = YES                                                    *
  5070*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5071******************************************************************
  5072*                   C H A N G E   L O G
  5073*
  5074* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5075*-----------------------------------------------------------------
  5076*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5077* EFFECTIVE    NUMBER
  5078*-----------------------------------------------------------------
  5079* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5080* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5081* 111108                   PEMA  ADD CRED BENE ADDR2
  5082******************************************************************
  5083
  5084 01  MAILING-DATA.
  5085     12  MA-RECORD-ID                      PIC XX.
  5086         88  VALID-MA-ID                       VALUE 'MA'.
  5087
  5088     12  MA-CONTROL-PRIMARY.
  5089         16  MA-COMPANY-CD                 PIC X.
  5090         16  MA-CARRIER                    PIC X.
  5091         16  MA-GROUPING.
  5092             20  MA-GROUPING-PREFIX        PIC XXX.
  5093             20  MA-GROUPING-PRIME         PIC XXX.
  5094         16  MA-STATE                      PIC XX.
  5095         16  MA-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  93
* EL1278.cbl
  5096             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5097             20  MA-ACCOUNT-PRIME          PIC X(6).
  5098         16  MA-CERT-EFF-DT                PIC XX.
  5099         16  MA-CERT-NO.
  5100             20  MA-CERT-PRIME             PIC X(10).
  5101             20  MA-CERT-SFX               PIC X.
  5102
  5103     12  FILLER                            PIC XX.
  5104
  5105     12  MA-ACCESS-CONTROL.
  5106         16  MA-SOURCE-SYSTEM              PIC XX.
  5107             88  MA-FROM-CREDIT                VALUE 'CR'.
  5108             88  MA-FROM-VSI                   VALUE 'VS'.
  5109             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5110             88  MA-FROM-OTHER                 VALUE 'OT'.
  5111         16  MA-RECORD-ADD-DT              PIC XX.
  5112         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5113         16  MA-LAST-MAINT-DT              PIC XX.
  5114         16  MA-LAST-MAINT-BY              PIC XXXX.
  5115         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5116
  5117     12  MA-PROFILE-INFO.
  5118         16  MA-QUALIFY-CODE-1             PIC XX.
  5119         16  MA-QUALIFY-CODE-2             PIC XX.
  5120         16  MA-QUALIFY-CODE-3             PIC XX.
  5121         16  MA-QUALIFY-CODE-4             PIC XX.
  5122         16  MA-QUALIFY-CODE-5             PIC XX.
  5123
  5124         16  MA-INSURED-LAST-NAME          PIC X(15).
  5125         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5126         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5127         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5128         16  MA-INSURED-BIRTH-DT           PIC XX.
  5129         16  MA-INSURED-SEX                PIC X.
  5130             88  MA-SEX-MALE                   VALUE 'M'.
  5131             88  MA-SEX-FEMALE                 VALUE 'F'.
  5132         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5133
  5134         16  MA-ADDRESS-CORRECTED          PIC X.
  5135         16  MA-JOINT-BIRTH-DT             PIC XX.
  5136*        16  FILLER                        PIC X(12).
  5137
  5138         16  MA-ADDRESS-LINE-1             PIC X(30).
  5139         16  MA-ADDRESS-LINE-2             PIC X(30).
  5140         16  MA-CITY-STATE.
  5141             20  MA-CITY                   PIC X(28).
  5142             20  MA-ADDR-STATE             PIC XX.
  5143         16  MA-ZIP.
  5144             20  MA-ZIP-CODE.
  5145                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5146                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5147                 24  FILLER                PIC X(4).
  5148             20  MA-ZIP-PLUS4              PIC X(4).
  5149         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5150             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5151             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5152             20  FILLER                    PIC X(3).
  5153
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  94
* EL1278.cbl
  5154         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5155
  5156         16  FILLER                        PIC XXX.
  5157*        16  FILLER                        PIC X(10).
  5158
  5159     12  MA-CRED-BENE-INFO.
  5160         16  MA-CRED-BENE-NAME                 PIC X(25).
  5161         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5162         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5163         16  MA-CRED-BENE-CTYST.
  5164             20  MA-CRED-BENE-CITY             PIC X(28).
  5165             20  MA-CRED-BENE-STATE            PIC XX.
  5166         16  MA-CRED-BENE-ZIP.
  5167             20  MA-CB-ZIP-CODE.
  5168                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5169                     88  MA-CB-CANADIAN-POST-CODE
  5170                                           VALUE 'A' THRU 'Z'.
  5171                 24  FILLER                    PIC X(4).
  5172             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5173         16  MA-CB-CANADIAN-POSTAL-CODE
  5174                            REDEFINES MA-CRED-BENE-ZIP.
  5175             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5176             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5177             20  FILLER                        PIC X(3).
  5178     12  MA-POST-CARD-MAIL-DATA.
  5179         16  MA-MAIL-DATA OCCURS 7.
  5180             20  MA-MAIL-TYPE              PIC X.
  5181                 88  MA-12MO-MAILING           VALUE '1'.
  5182                 88  MA-EXP-MAILING            VALUE '2'.
  5183             20  MA-MAIL-STATUS            PIC X.
  5184                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5185                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5186                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5187             20  MA-MAIL-DATE              PIC XX.
  5188     12  FILLER                            PIC XX.
  5189     12  FILLER                            PIC XX.
  5190*    12  FILLER                            PIC X(30).
  5191******************************************************************
  5192*                            COPY ELCCRTO.
  5193******************************************************************
  5194*                                                                *
  5195*                            ELCCRTO.                            *
  5196*                                                                *
  5197*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  5198*                                                                *
  5199*   FILE TYPE = VSAM,KSDS                                        *
  5200*   RECORD SIZE = 524  RECFORM = FIXED                           *
  5201*                                                                *
  5202*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  5203*                                                                *
  5204*   LOG = YES                                                    *
  5205*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5206******************************************************************
  5207*                   C H A N G E   L O G
  5208*
  5209* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5210*-----------------------------------------------------------------
  5211*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  95
* EL1278.cbl
  5212* EFFECTIVE    NUMBER
  5213*-----------------------------------------------------------------
  5214* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  5215* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  5216* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  5217******************************************************************
  5218 01  ORIGINAL-CERTIFICATE.
  5219     12  OC-RECORD-ID                      PIC XX.
  5220         88  VALID-OC-ID                      VALUE 'OC'.
  5221     12  OC-CONTROL-PRIMARY.
  5222         16  OC-COMPANY-CD                 PIC X.
  5223         16  OC-CARRIER                    PIC X.
  5224         16  OC-GROUPING                   PIC X(6).
  5225         16  OC-STATE                      PIC XX.
  5226         16  OC-ACCOUNT                    PIC X(10).
  5227         16  OC-CERT-EFF-DT                PIC XX.
  5228         16  OC-CERT-NO.
  5229             20  OC-CERT-PRIME             PIC X(10).
  5230             20  OC-CERT-SFX               PIC X.
  5231         16  OC-RECORD-TYPE                PIC X.
  5232         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5233     12  OC-LAST-MAINT-DT                  PIC XX.
  5234     12  OC-LAST-MAINT-BY                  PIC X(4).
  5235     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5236     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5237     12  FILLER                            PIC X(49).
  5238     12  OC-ORIG-REC.
  5239         16  OC-INS-LAST-NAME              PIC X(15).
  5240         16  OC-INS-FIRST-NAME             PIC X(10).
  5241         16  OC-INS-MIDDLE-INIT            PIC X.
  5242         16  OC-INS-AGE                    PIC S999     COMP-3.
  5243         16  OC-JNT-LAST-NAME              PIC X(15).
  5244         16  OC-JNT-FIRST-NAME             PIC X(10).
  5245         16  OC-JNT-MIDDLE-INIT            PIC X.
  5246         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5247         16  OC-LF-BENCD                   PIC XX.
  5248         16  OC-LF-TERM                    PIC S999      COMP-3.
  5249         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5250         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5251         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5252         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5253         16  OC-LF-EXP-DT                  PIC XX.
  5254         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5255         16  OC-LF-CANCEL-DT               PIC XX.
  5256         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5257         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5258         16  OC-AH-BENCD                   PIC XX.
  5259         16  OC-AH-TERM                    PIC S999      COMP-3.
  5260         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5261         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5262         16  OC-AH-EXP-DT                  PIC XX.
  5263         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5264         16  OC-AH-CP                      PIC 99.
  5265         16  OC-AH-CANCEL-DT               PIC XX.
  5266         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5267         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5268         16  OC-CRED-BENE-NAME             PIC X(25).
  5269         16  OC-1ST-PMT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  96
* EL1278.cbl
  5270         16  FILLER                        PIC X(215).
  5271
  5272     12  FILLER                            PIC X(50).
  5273******************************************************************
  5274*                            COPY ERCFORM.
  5275******************************************************************
  5276*                                                                *
  5277*                                                                *
  5278*                            ERCFORM.                            *
  5279*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5280*                            VMOD=2.003                          *
  5281*                                                                *
  5282*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  5283*                                                                *
  5284*    FILE TYPE = VSAM,KSDS                                       *
  5285*    RECORD SIZE = 500  RECFORM = FIXED                          *
  5286*                                                                *
  5287*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  5288*                                                                *
  5289*    LOG = YES                                                   *
  5290*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5291******************************************************************
  5292 01  FORM-MASTER.
  5293    12  FO-RECORD-ID                 PIC X(02).
  5294        88  VALID-FO-ID                  VALUE 'FO'.
  5295
  5296    12  FO-CONTROL-PRIMARY.
  5297        16  FO-COMPANY-CD            PIC X(01).
  5298        16  FO-STATE                 PIC X(02).
  5299        16  FO-FORM-ID               PIC X(12).
  5300        16  FO-FORM-EXP-DT           PIC X(02).
  5301
  5302    12  FO-POLICY-FORM-DATA.
  5303        16  FO-IND-GRP-CD            PIC X(01).
  5304        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  5305        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5306        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  5307        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5308        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  5309        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  5310        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  5311        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  5312        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  5313        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  5314        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5315        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  5316        16  FO-DIS-DEF-TYPE          PIC 9(02).
  5317        16  FO-DISMEMBERMENT-CD      PIC X(01).
  5318        16  FO-APP-CERT-USE-CD       PIC X(01).
  5319
  5320    12  FILLER                       PIC X(29).
  5321
  5322    12  FO-FORM-PLAN-TABLE.
  5323        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  5324            20  FO-PLAN-TYPE         PIC X(01).
  5325            20  FO-PLAN-ID           PIC X(02).
  5326            20  FO-PLAN-TERM         PIC 9(03).
  5327            20  FO-PLAN-REFUND-METHOD
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  97
* EL1278.cbl
  5328                                     PIC X.
  5329
  5330    12  FILLER                       PIC X(30).
  5331
  5332    12  FO-COMMENTS-AREA.
  5333        16  FO-COMMENT-LINE-1        PIC X(78).
  5334
  5335    12  FILLER                       PIC X(20).
  5336
  5337    12  FO-MAINT-INFORMATION.
  5338        16  FO-LAST-MAINT-DT         PIC X(02).
  5339        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5340        16  FO-LAST-MAINT-BY         PIC X(04).
  5341*                            COPY ELCMSTR.
  5342******************************************************************
  5343*                                                                *
  5344*                            ELCMSTR.                            *
  5345*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5346*                            VMOD=2.012                          *
  5347*                                                                *
  5348*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  5349*                                                                *
  5350*   FILE TYPE = VSAM,KSDS                                        *
  5351*   RECORD SIZE = 350  RECFORM = FIXED                           *
  5352*                                                                *
  5353*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  5354*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  5355*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  5356*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  5357*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  5358*                                                 RKP=75,LEN=21  *
  5359*                                                                *
  5360*   **** NOTE ****                                               *
  5361*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  5362*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  5363*                                                                *
  5364*   LOG = YES                                                    *
  5365*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5366******************************************************************
  5367*                   C H A N G E   L O G
  5368*
  5369* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5370*-----------------------------------------------------------------
  5371*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5372* EFFECTIVE    NUMBER
  5373*-----------------------------------------------------------------
  5374* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5375* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  5376******************************************************************
  5377 01  CLAIM-MASTER.
  5378     12  CL-RECORD-ID                PIC XX.
  5379         88  VALID-CL-ID         VALUE 'CL'.
  5380
  5381     12  CL-CONTROL-PRIMARY.
  5382         16  CL-COMPANY-CD           PIC X.
  5383         16  CL-CARRIER              PIC X.
  5384         16  CL-CLAIM-NO             PIC X(7).
  5385         16  CL-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  98
* EL1278.cbl
  5386             20  CL-CERT-PRIME       PIC X(10).
  5387             20  CL-CERT-SFX         PIC X.
  5388
  5389     12  CL-CONTROL-BY-NAME.
  5390         16  CL-COMPANY-CD-A1        PIC X.
  5391         16  CL-INSURED-LAST-NAME    PIC X(15).
  5392         16  CL-INSURED-NAME.
  5393             20  CL-INSURED-1ST-NAME PIC X(12).
  5394             20  CL-INSURED-MID-INIT PIC X.
  5395
  5396     12  CL-CONTROL-BY-SSN.
  5397         16  CL-COMPANY-CD-A2        PIC X.
  5398         16  CL-SOC-SEC-NO.
  5399             20  CL-SSN-STATE        PIC XX.
  5400             20  CL-SSN-ACCOUNT      PIC X(6).
  5401             20  CL-SSN-LN3          PIC X(3).
  5402
  5403     12  CL-CONTROL-BY-CERT-NO.
  5404         16  CL-COMPANY-CD-A4        PIC X.
  5405         16  CL-CERT-NO-A4.
  5406             20  CL-CERT-A4-PRIME    PIC X(10).
  5407             20  CL-CERT-A4-SFX      PIC X.
  5408
  5409     12  CL-CONTROL-BY-CCN.
  5410         16  CL-COMPANY-CD-A5        PIC X.
  5411         16  CL-CCN-A5.
  5412             20  CL-CCN.
  5413                 24  CL-CCN-PREFIX-A5 PIC X(4).
  5414                 24  CL-CCN-PRIME-A5 PIC X(12).
  5415             20  CL-CCN-FILLER-A5    PIC X(4).
  5416
  5417     12  CL-INSURED-PROFILE-DATA.
  5418         16  CL-INSURED-BIRTH-DT     PIC XX.
  5419         16  CL-INSURED-SEX-CD       PIC X.
  5420             88  INSURED-IS-MALE        VALUE 'M'.
  5421             88  INSURED-IS-FEMALE      VALUE 'F'.
  5422             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  5423         16  CL-INSURED-OCC-CD       PIC X(6).
  5424         16  FILLER                  PIC X(5).
  5425
  5426     12  CL-PROCESSING-INFO.
  5427         16  CL-PROCESSOR-ID         PIC X(4).
  5428         16  CL-CLAIM-STATUS         PIC X.
  5429             88  CLAIM-IS-OPEN          VALUE 'O'.
  5430             88  CLAIM-IS-CLOSED        VALUE 'C'.
  5431         16  CL-CLAIM-TYPE           PIC X.
  5432*            88  AH-CLAIM               VALUE 'A'.
  5433*            88  LIFE-CLAIM             VALUE 'L'.
  5434*            88  PROPERTY-CLAIM         VALUE 'P'.
  5435*            88  IUI-CLAIM              VALUE 'I'.
  5436*            88  GAP-CLAIM              VALUE 'G'.
  5437         16  CL-CLAIM-PREM-TYPE      PIC X.
  5438             88  SINGLE-PREMIUM         VALUE '1'.
  5439             88  O-B-COVERAGE           VALUE '2'.
  5440             88  OPEN-END-COVERAGE      VALUE '3'.
  5441         16  CL-INCURRED-DT          PIC XX.
  5442         16  CL-REPORTED-DT          PIC XX.
  5443         16  CL-FILE-ESTABLISH-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page  99
* EL1278.cbl
  5444         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  5445         16  CL-LAST-PMT-DT          PIC XX.
  5446         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  5447         16  CL-PAID-THRU-DT         PIC XX.
  5448         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  5449         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  5450         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  5451         16  CL-PMT-CALC-METHOD      PIC X.
  5452             88  CL-360-DAY-YR          VALUE '1'.
  5453             88  CL-365-DAY-YR          VALUE '2'.
  5454             88  CL-FULL-MONTHS         VALUE '3'.
  5455         16  CL-CAUSE-CD             PIC X(6).
  5456
  5457         16  CL-PRIME-CERT-NO.
  5458             20  CL-PRIME-CERT-PRIME PIC X(10).
  5459             20  CL-PRIME-CERT-SFX   PIC X.
  5460
  5461         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  5462             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  5463             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  5464
  5465         16  CL-MICROFILM-NO         PIC X(10).
  5466         16  CL-PROG-FORM-TYPE       PIC X.
  5467         16  CL-LAST-ADD-ON-DT       PIC XX.
  5468
  5469         16  CL-LAST-REOPEN-DT       PIC XX.
  5470         16  CL-LAST-CLOSE-DT        PIC XX.
  5471         16  CL-LAST-CLOSE-REASON    PIC X(01).
  5472             88  FINAL-PAID             VALUE '1'.
  5473             88  CLAIM-DENIED           VALUE '2'.
  5474             88  AUTO-CLOSE             VALUE '3'.
  5475             88  MANUAL-CLOSE           VALUE '4'.
  5476             88  BENEFITS-CHANGED       VALUE 'C'.
  5477             88  SETUP-ERRORS           VALUE 'E'.
  5478         16  CL-ASSOC-CERT-SEQU      PIC S99.
  5479         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  5480         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  5481             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  5482         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  5483         16  FILLER                  PIC X.
  5484
  5485     12  CL-CERTIFICATE-DATA.
  5486         16  CL-CERT-ORIGIN          PIC X.
  5487             88  CERT-WAS-ONLINE        VALUE '1'.
  5488             88  CERT-WAS-CREATED       VALUE '2'.
  5489             88  COVERAGE-WAS-ADDED     VALUE '3'.
  5490         16  CL-CERT-KEY-DATA.
  5491             20  CL-CERT-CARRIER     PIC X.
  5492             20  CL-CERT-GROUPING    PIC X(6).
  5493             20  CL-CERT-STATE       PIC XX.
  5494             20  CL-CERT-ACCOUNT.
  5495                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  5496                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  5497             20  CL-CERT-EFF-DT      PIC XX.
  5498
  5499     12  CL-STATUS-CONTROLS.
  5500         16  CL-PRIORITY-CD          PIC X.
  5501             88  CONFIDENTIAL-DATA      VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 100
* EL1278.cbl
  5502             88  HIGHEST-PRIORITY       VALUE '9'.
  5503         16  CL-SUPV-ATTN-CD         PIC X.
  5504             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  5505             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  5506         16  CL-PURGED-DT            PIC XX.
  5507         16  CL-RESTORED-DT          PIC XX.
  5508         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  5509         16  CL-NEXT-RESEND-DT       PIC XX.
  5510         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  5511         16  FILLER                  PIC XX.
  5512         16  CL-LAST-MAINT-DT        PIC XX.
  5513         16  CL-LAST-MAINT-USER      PIC X(4).
  5514         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  5515         16  CL-LAST-MAINT-TYPE      PIC X.
  5516             88  CLAIM-SET-UP           VALUE ' '.
  5517             88  PAYMENT-MADE           VALUE '1'.
  5518             88  LETTER-SENT            VALUE '2'.
  5519             88  MASTER-WAS-ALTERED     VALUE '3'.
  5520             88  MASTER-WAS-RESTORED    VALUE '4'.
  5521             88  INCURRED-DATE-CHANGED  VALUE '5'.
  5522             88  FILE-CONVERTED         VALUE '6'.
  5523             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  5524             88  ERROR-CORRECTION       VALUE 'E'.
  5525         16  CL-RELATED-CLAIM-NO     PIC X(7).
  5526         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  5527         16  CL-BENEFICIARY          PIC X(10).
  5528         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  5529         16  CL-DENIAL-TYPE          PIC X.
  5530             88  CL-TYPE-DENIAL          VALUE '1'.
  5531             88  CL-TYPE-RESCISSION      VALUE '2'.
  5532             88  CL-TYPE-REFORMATION     VALUE '3'.
  5533             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  5534             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  5535         16  FILLER                  PIC X(5).
  5536
  5537     12  CL-TRAILER-CONTROLS.
  5538         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  5539             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  5540             88  CL-LAST-TRL-AVAIL      VALUE +100.
  5541             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  5542         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  5543         16  FILLER                  PIC XX.
  5544         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  5545         16  CL-ADDRESS-TRAILER-CNT.
  5546             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  5547                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  5548             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  5549                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  5550             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  5551                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  5552             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  5553                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  5554             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  5555                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  5556             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  5557                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  5558             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  5559                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 101
* EL1278.cbl
  5560
  5561     12  CL-CV-REFERENCE-NO.
  5562         16  CL-CV-REFNO-PRIME       PIC X(18).
  5563         16  CL-CV-REFNO-SFX         PIC XX.
  5564
  5565     12  CL-FILE-LOCATION            PIC X(4).
  5566
  5567     12  CL-PROCESS-ERRORS.
  5568         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  5569             88  NO-FATAL-ERRORS        VALUE ZERO.
  5570         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  5571             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  5572
  5573     12  CL-PRODUCT-CD               PIC X.
  5574
  5575     12  CL-CURRENT-KEY-DATA.
  5576         16  CL-CURRENT-CARRIER      PIC X.
  5577         16  CL-CURRENT-GROUPING     PIC X(6).
  5578         16  CL-CURRENT-STATE        PIC XX.
  5579         16  CL-CURRENT-ACCOUNT      PIC X(10).
  5580
  5581     12  CL-ASSOCIATES               PIC X.
  5582         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  5583         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  5584         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  5585         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  5586
  5587     12  CL-ACTIVITY-CODE            PIC 99.
  5588     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  5589     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  5590
  5591     12  CL-LAPSE-REPORT-CODE        PIC 9.
  5592     12  CL-LAG-REPORT-CODE          PIC 9.
  5593     12  CL-LOAN-TYPE                PIC XX.
  5594     12  CL-LEGAL-STATE              PIC XX.
  5595
  5596*    12  FILLER                      PIC X(5).
  5597     12  CL-YESNOSW                  PIC X.
  5598     12  FILLER                      PIC X(4).
  5599*                            COPY ERCPDEF.
  5600******************************************************************
  5601*                                                                *
  5602*                                                                *
  5603*                            ERCPDEF.                            *
  5604*                                                                *
  5605*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5606*                                                                *
  5607*    FILE TYPE = VSAM,KSDS                                       *
  5608*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5609*                                                                *
  5610*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5611*                                                                *
  5612*    LOG = YES                                                   *
  5613*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5614******************************************************************
  5615 01  PRODUCT-MASTER.
  5616    12  PD-RECORD-ID                 PIC X(02).
  5617        88  VALID-PD-ID                  VALUE 'PD'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 102
* EL1278.cbl
  5618    12  PD-CONTROL-PRIMARY.
  5619        16  PD-COMPANY-CD            PIC X.
  5620        16  PD-STATE                 PIC XX.
  5621        16  PD-PRODUCT-CD            PIC XXX.
  5622        16  PD-FILLER                PIC X(7).
  5623        16  PD-BEN-TYPE              PIC X.
  5624        16  PD-BEN-CODE              PIC XX.
  5625        16  PD-PROD-EXP-DT           PIC XX.
  5626    12  FILLER                       PIC X(50).
  5627    12  PD-PRODUCT-DATA OCCURS 8.
  5628        16  PD-PROD-CODE             PIC X.
  5629            88  PD-PROD-LIFE           VALUE 'L'.
  5630            88  PD-PROD-PROP           VALUE 'P'.
  5631            88  PD-PROD-AH             VALUE 'A'.
  5632            88  PD-PROD-IU             VALUE 'I'.
  5633            88  PD-PROD-GAP            VALUE 'G'.
  5634        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5635        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5636        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5637        16  PD-MAX-TERM              PIC S999        COMP-3.
  5638        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5639        16  FILLER                   PIC X.
  5640        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5641        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5642        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5643        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  5644        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5645        16  PD-REC-CRIT-PERIOD       PIC X.
  5646        16  PD-RTW-MOS               PIC 99.
  5647        16  FILLER                   PIC X(5).
  5648    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5649    12  PD-TERM-LIMITS OCCURS 15.
  5650        16  PD-LOW-TERM              PIC S999        COMP-3.
  5651        16  PD-HI-TERM               PIC S999        COMP-3.
  5652*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5653    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5654        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5655        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5656    12  PD-EARN-FACTORS.
  5657        16  FILLER OCCURS 15.
  5658            20  FILLER OCCURS 15.
  5659                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5660    12  PD-PRODUCT-DESC              PIC X(80).
  5661    12  PD-TRUNCATED                 PIC X.
  5662    12  FILLER                       PIC X(59).
  5663    12  PD-MAINT-INFORMATION.
  5664        16  PD-LAST-MAINT-DT         PIC X(02).
  5665        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5666        16  PD-LAST-MAINT-BY         PIC X(04).
  5667 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  5668                          ACCOUNT-MASTER CERTIFICATE-MASTER
  5669                          MAILING-DATA ORIGINAL-CERTIFICATE
  5670                          FORM-MASTER CLAIM-MASTER
  5671                          PRODUCT-MASTER.
  5672 0000-DFHEXIT SECTION.
  5673     MOVE '9#                    $   ' TO DFHEIV0.
  5674     MOVE 'EL1278' TO DFHEIV1.
  5675     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 103
* EL1278.cbl
  5676*    SERVICE RELOAD PARMLIST.
  5677
  5678     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5679     MOVE '5'                    TO  DC-OPTION-CODE.
  5680
  5681     PERFORM 9600-DATE-LINK.
  5682
  5683     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5684     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5685     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5686     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5687     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  5688     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  5689     MOVE EIBTRMID               TO  QID-TERM.
  5690
  5691     IF EIBCALEN  IS EQUAL TO  ZERO
  5692         GO TO 8700-UNAUTHORIZED-ACCESS.
  5693
  5694     IF PI-CALLING-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5695         IF PI-RETURN-TO-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  5696             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  5697             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  5698             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  5699             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  5700             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  5701             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  5702             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  5703             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  5704         ELSE
  5705             MOVE PI-CALLING-PROGRAM    TO  RETURN-FROM
  5706             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  5707             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  5708             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  5709             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  5710             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  5711             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  5712             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  5713             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  5714
  5715     IF EIBAID  IS EQUAL TO  DFHCLEAR
  5716         GO TO 9300-CLEAR.
  5717
  5718     IF PI-PROCESSOR-ID  IS EQUAL TO  'LGXX'
  5719         NEXT SENTENCE
  5720     ELSE
  5721
  5722* EXEC CICS READQ TS
  5723*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  5724*            INTO    (SECURITY-CONTROL)
  5725*            LENGTH  (SC-COMM-LENGTH)
  5726*            ITEM    (SC-ITEM)
  5727*        END-EXEC
  5728*    MOVE '*$II   L              ''   #00005717' TO DFHEIV0
  5729     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5730     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5731     MOVE X'2020233030303035373137' TO DFHEIV0(25:11)
  5732     CALL 'kxdfhei1' USING DFHEIV0,
  5733           PI-SECURITY-TEMP-STORE-ID,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 104
* EL1278.cbl
  5734           SECURITY-CONTROL,
  5735           SC-COMM-LENGTH,
  5736           SC-ITEM,
  5737           DFHEIV99,
  5738           DFHEIV99
  5739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5740         MOVE SC-CREDIT-DISPLAY (33)
  5741                                 TO  PI-DISPLAY-CAP
  5742         MOVE SC-CREDIT-UPDATE  (33)
  5743                                 TO  PI-MODIFY-CAP
  5744         MOVE SC-CREDIT-UPDATE  (32)
  5745                                 TO  PI-MODIFY-CERT-CAP
  5746         IF NOT  DISPLAY-CAP
  5747             MOVE 'READ'         TO  SM-READ
  5748             PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5749             MOVE ER-0070        TO  EMI-ERROR
  5750             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5751             GO TO 8100-SEND-INITIAL-MAP.
  5752
  5753     IF EIBTRNID  IS NOT EQUAL TO  TRANS-ID
  5754         MOVE 'Y' TO WS-FIRST-ENTRY-SW
  5755         MOVE LOW-VALUES         TO  EL127HI
  5756         MOVE SAVE-BIN-DATE      TO  WS-LF-CANCEL-DATE
  5757                                     PI-LF-CANCEL-DATE
  5758                                     WS-AH-CANCEL-DATE
  5759                                     PI-AH-CANCEL-DATE
  5760         MOVE SAVE-DATE          TO  WS-LF-CANCEL-DATE-ED
  5761                                     PI-LF-CANCEL-DATE-ED
  5762                                     WS-AH-CANCEL-DATE-ED
  5763                                     PI-AH-CANCEL-DATE-ED
  5764         MOVE SPACES             TO  PI-EARNING-METHOD-LF
  5765                                     PI-EARNING-METHOD-AH
  5766         PERFORM 0500-FORMAT-SCREEN
  5767         GO TO 8100-SEND-INITIAL-MAP.
  5768
  5769     IF NOT  MODIFY-CAP
  5770         MOVE 'UPDATE'           TO  SM-READ
  5771         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  5772         MOVE ER-0070            TO  EMI-ERROR
  5773         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5774         GO TO 8100-SEND-INITIAL-MAP.
  5775
  5776
  5777* EXEC CICS HANDLE CONDITION
  5778*        PGMIDERR  (9500-PGMID-ERROR)
  5779*        ERROR     (9900-ABEND)
  5780*    END-EXEC.
  5781*    MOVE '"$L.                  ! " #00005759' TO DFHEIV0
  5782     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5783     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5784     MOVE X'2220233030303035373539' TO DFHEIV0(25:11)
  5785     CALL 'kxdfhei1' USING DFHEIV0
  5786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5787
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 105
* EL1278.cbl
  5789 0200-RECEIVE.
  5790     IF EIBAID  IS EQUAL TO  DFHPA1  OR  DFHPA2  OR  DFHPA3
  5791         MOVE ER-0008            TO  EMI-ERROR
  5792         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5793         MOVE -1                 TO  HLCANCL
  5794         GO TO 8200-SEND-DATAONLY.
  5795
  5796
  5797* EXEC CICS RECEIVE
  5798*        MAP     (MAP-NAME)
  5799*        MAPSET  (MAPSET-NAME)
  5800*        INTO    (EL127HI)
  5801*    END-EXEC.
  5802     MOVE LENGTH OF
  5803      EL127HI
  5804       TO DFHEIV11
  5805*    MOVE '8"T I  L              ''   #00005771' TO DFHEIV0
  5806     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5807     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5808     MOVE X'2020233030303035373731' TO DFHEIV0(25:11)
  5809     CALL 'kxdfhei1' USING DFHEIV0,
  5810           MAP-NAME,
  5811           EL127HI,
  5812           DFHEIV11,
  5813           MAPSET-NAME,
  5814           DFHEIV99,
  5815           DFHEIV99
  5816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5817
  5818
  5819     IF HPFKEYL  IS EQUAL TO  ZERO
  5820         GO TO 0300-CHECK-PFKEYS.
  5821
  5822     IF EIBAID  IS NOT EQUAL TO  DFHENTER
  5823         MOVE ER-0004            TO  EMI-ERROR
  5824         GO TO 0320-INPUT-ERROR.
  5825
  5826     IF HPFKEYI NUMERIC
  5827         IF HPFKEYI  IS EQUAL TO  '12'  OR  '23'  OR  '24' OR '11'
  5828             MOVE PF-VALUES (HPFKEYI)
  5829                                 TO  EIBAID
  5830         ELSE
  5831             MOVE ER-0029        TO  EMI-ERROR
  5832             GO TO 0320-INPUT-ERROR.
  5833
  5834 0300-CHECK-PFKEYS.
  5835     IF EIBAID  IS EQUAL TO  DFHPF23
  5836         GO TO 8800-PF23.
  5837
  5838     IF EIBAID  IS EQUAL TO  DFHPF24
  5839         GO TO 9100-RETURN-MAIN-MENU.
  5840
  5841     IF EIBAID = DFHPF11
  5842        GO TO 1700-WRITE-CERT-NOTE
  5843     END-IF
  5844
  5845     IF EIBAID  IS EQUAL TO  DFHPF12
  5846         GO TO 9400-PF12.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 106
* EL1278.cbl
  5847
  5848     IF EIBAID = DFHENTER OR DFHPF10
  5849        GO TO 0400-EDIT-INPUT-DATA
  5850     END-IF
  5851
  5852     MOVE ER-0029                TO  EMI-ERROR.
  5853
  5854 0320-INPUT-ERROR.
  5855     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  5856
  5857     MOVE AL-UNBON               TO  HPFKEYA.
  5858
  5859     IF HPFKEYL  IS EQUAL TO  ZERO
  5860         MOVE -1                 TO  HLCANCL
  5861     ELSE
  5862         MOVE -1                 TO  HPFKEYL.
  5863
  5864     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 107
* EL1278.cbl
  5866 0400-EDIT-INPUT-DATA.
  5867     MOVE 'N'                    TO  WS-NEW-AH-CANCEL-SW
  5868                                     WS-NEW-LF-CANCEL-SW.
  5869
  5870     IF (HPCYNL > 0)
  5871        AND (HPCYNI = 'Y' OR 'N')
  5872        PERFORM 1800-READ-ELCERT-UPDATE
  5873                                 THRU 1800-EXIT
  5874        IF WS-RESP-NORMAL
  5875           MOVE HPCYNI           TO CM-POST-CARD-IND
  5876           PERFORM 1810-REWRITE-ELCERT
  5877                                 THRU 1810-EXIT
  5878        END-IF
  5879     END-IF
  5880     IF HLCAL1L GREATER ZERO
  5881         MOVE HLCAL1I              TO  PI-EARNING-METHOD-LF.
  5882     IF CLPYNI = 'Y'
  5883        MOVE 'Y'                   TO PI-CLP-YN
  5884        MOVE AL-UANON              TO CLPYNA
  5885     ELSE
  5886        MOVE ' '                   TO PI-CLP-YN
  5887        MOVE AL-UANON              TO CLPYNA
  5888     END-IF
  5889     IF CANREAI = 'R'
  5890        MOVE 'R'                 TO PI-CANCEL-REASON
  5891        MOVE AL-UANON            TO CANREAA
  5892     ELSE
  5893        MOVE ' '                 TO PI-CANCEL-REASON
  5894        MOVE AL-UANON            TO CANREAA
  5895     END-IF
  5896
  5897     IF HLCANCL  IS EQUAL TO  ZERO
  5898       AND HACANCL  IS EQUAL TO  ZERO
  5899         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  5900         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  5901         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  5902         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  5903         GO TO 0420-CHECK-ERRORS.
  5904
  5905     IF HLCANCL  IS EQUAL TO  ZERO
  5906         MOVE PI-LF-CANCEL-DATE    TO  WS-LF-CANCEL-DATE
  5907         MOVE PI-LF-CANCEL-DATE-ED TO  WS-LF-CANCEL-DATE-ED
  5908         GO TO 0410-CHECK-AH-DATE.
  5909
  5910     IF HLCANCI = SPACES
  5911        MOVE LOW-VALUES            TO PI-LF-CANCEL-DATE
  5912                                      WS-LF-CANCEL-DATE
  5913        MOVE SPACES                TO PI-LF-CANCEL-DATE-ED
  5914                                      WS-LF-CANCEL-DATE-ED
  5915                                      PI-LF-REFUND-METH
  5916        MOVE +0                    TO PI-LF-REFUND-AMT
  5917        GO TO 0410-CHECK-AH-DATE
  5918     END-IF
  5919
  5920     MOVE AL-UNNON               TO  HLCANCA.
  5921     MOVE HLCANCI                TO  DEEDIT-FIELD.
  5922     MOVE 'Y'                    TO  WS-NEW-LF-CANCEL-SW.
  5923
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 108
* EL1278.cbl
  5924     PERFORM 8600-DEEDIT.
  5925
  5926     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  5927     MOVE '4'                    TO  DC-OPTION-CODE.
  5928
  5929     PERFORM 9600-DATE-LINK.
  5930
  5931     IF DATE-CONVERSION-ERROR
  5932         MOVE -1                 TO  HLCANCL
  5933         MOVE AL-UABON           TO  HLCANCA
  5934         MOVE ER-2227            TO  EMI-ERROR
  5935         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5936     ELSE
  5937        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  5938           MOVE -1               TO  HACANCL
  5939           MOVE AL-UABON         TO  HACANCA
  5940           MOVE ER-2774          TO  EMI-ERROR
  5941           PERFORM 9700-ERROR-FORMAT
  5942                                 THRU  9799-EXIT
  5943        ELSE
  5944           MOVE DC-BIN-DATE-1    TO WS-LF-CANCEL-DATE
  5945                                    PI-LF-CANCEL-DATE
  5946           MOVE DC-GREG-DATE-1-EDIT
  5947                                 TO HLCANCO
  5948                                    WS-LF-CANCEL-DATE-ED
  5949                                    PI-LF-CANCEL-DATE-ED
  5950        END-IF
  5951     END-IF
  5952     .
  5953 0410-CHECK-AH-DATE.
  5954     IF HACAL1L GREATER ZERO
  5955         MOVE HACAL1I              TO  PI-EARNING-METHOD-AH.
  5956
  5957     IF HACANCL  IS EQUAL TO  ZERO
  5958         MOVE PI-AH-CANCEL-DATE    TO  WS-AH-CANCEL-DATE
  5959         MOVE PI-AH-CANCEL-DATE-ED TO  WS-AH-CANCEL-DATE-ED
  5960         GO TO 0420-CHECK-ERRORS.
  5961     IF HACANCI = SPACES
  5962        MOVE LOW-VALUES            TO PI-AH-CANCEL-DATE
  5963                                      WS-AH-CANCEL-DATE
  5964        MOVE SPACES                TO PI-AH-CANCEL-DATE-ED
  5965                                      WS-AH-CANCEL-DATE-ED
  5966                                      PI-AH-REFUND-METH
  5967        MOVE +0                    TO PI-AH-REFUND-AMT
  5968        GO TO 0420-CHECK-ERRORS
  5969     END-IF
  5970
  5971     MOVE AL-UNNON               TO  HACANCA.
  5972     MOVE HACANCI                TO  DEEDIT-FIELD.
  5973     MOVE 'Y'                    TO  WS-NEW-AH-CANCEL-SW.
  5974
  5975     PERFORM 8600-DEEDIT.
  5976
  5977     MOVE DEEDIT-FIELD           TO  DC-GREG-DATE-1-MDY.
  5978     MOVE '4'                    TO  DC-OPTION-CODE.
  5979
  5980     PERFORM 9600-DATE-LINK.
  5981
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 109
* EL1278.cbl
  5982     IF DATE-CONVERSION-ERROR
  5983         MOVE -1                 TO  HACANCL
  5984         MOVE AL-UABON           TO  HACANCA
  5985         MOVE ER-2227            TO  EMI-ERROR
  5986         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  5987     ELSE
  5988        IF PI-CERT-EFF-DT > DC-BIN-DATE-1
  5989           MOVE -1               TO  HACANCL
  5990           MOVE AL-UABON         TO  HACANCA
  5991           MOVE ER-2775          TO  EMI-ERROR
  5992           PERFORM 9700-ERROR-FORMAT
  5993                                 THRU  9799-EXIT
  5994        ELSE
  5995           MOVE DC-BIN-DATE-1    TO WS-AH-CANCEL-DATE
  5996                                    PI-AH-CANCEL-DATE
  5997           MOVE DC-GREG-DATE-1-EDIT
  5998                                 TO HACANCO
  5999                                    WS-AH-CANCEL-DATE-ED
  6000                                    PI-AH-CANCEL-DATE-ED
  6001        END-IF
  6002     END-IF
  6003     .
  6004 0420-CHECK-ERRORS.
  6005     IF EMI-ERROR  IS EQUAL TO  ZEROS
  6006         NEXT SENTENCE
  6007     ELSE
  6008         GO TO 8200-SEND-DATAONLY.
  6009
  6010     PERFORM 0500-FORMAT-SCREEN.
  6011     IF EIBAID = DFHPF10
  6012        perform 4000-GEN-CANCEL-TRANS
  6013                                 thru 4000-exit
  6014        MOVE PROGRAM-INTERFACE-BLOCK TO WS-PASS-631
  6015        MOVE LOW-VALUES     TO WS-PASS-PROGRAM-WORK-AREA
  6016        MOVE PI-COMPANY-CD  TO PI-PB-COMPANY-CD
  6017        MOVE CG-BATCH-NO    TO PI-PB-ENTRY-BATCH
  6018        MOVE 1              TO PI-PB-BATCH-SEQ-NO
  6019        MOVE 'Y'            TO PI-ALL-ISSUES-SW
  6020                               PI-ALL-CANCELS-SW
  6021        IF PI-PROCESSOR-IS-CSR
  6022            MOVE 'Y'        TO PI-CSR-SESSION-SW
  6023        ELSE
  6024            MOVE ' '        TO PI-CSR-SESSION-SW
  6025        END-IF
  6026        MOVE 'N'            TO PI-ISSUES-IN-ERROR-SW
  6027                               PI-CANCELS-IN-ERROR-SW
  6028                               PI-ONLY-BATCH-HEADERS-SW
  6029                               PI-ALL-OUT-OF-BAL-SW
  6030                               PI-HOLD-REC-SW
  6031                               PI-CHANGE-REC-SW
  6032                               PI-CHK-REQ-REC-SW
  6033                               PI-ISSUE-WARNING-SW
  6034                               PI-CANCEL-WARNING-SW
  6035        MOVE '1'            TO PI-BROWSE-TYPE
  6036        MOVE DFHENTER       TO  EIBAID
  6037
  6038
  6039* EXEC CICS XCTL
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 110
* EL1278.cbl
  6040*           PROGRAM    ('EL6311')
  6041*           COMMAREA   (WS-PASS-631)
  6042*           LENGTH     (1300)
  6043*       END-EXEC
  6044     MOVE 'EL6311' TO DFHEIV1
  6045     MOVE 1300
  6046       TO DFHEIV11
  6047*    MOVE '.$C                   %   #00005996' TO DFHEIV0
  6048     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6049     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6050     MOVE X'2020233030303035393936' TO DFHEIV0(25:11)
  6051     CALL 'kxdfhei1' USING DFHEIV0,
  6052           DFHEIV1,
  6053           WS-PASS-631,
  6054           DFHEIV11,
  6055           DFHEIV99
  6056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6057
  6058*        PERFORM 0500-FORMAT-SCREEN
  6059     END-IF
  6060     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 111
* EL1278.cbl
  6062 0500-FORMAT-SCREEN  SECTION.
  6063     MOVE LOW-VALUES             TO  EL127HO.
  6064     MOVE PI-CARRIER             TO  HCARIERO.
  6065     MOVE PI-GROUPING            TO  HGROUPO.
  6066     MOVE PI-STATE               TO  HSTATEO.
  6067     MOVE PI-ACCOUNT             TO  HACCTNOO.
  6068     MOVE ' '                    TO  DC-OPTION-CODE.
  6069     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6070
  6071     PERFORM 9600-DATE-LINK.
  6072
  6073     MOVE DC-GREG-DATE-1-EDIT    TO  HEFFDTO.
  6074     MOVE PI-CERT-PRIME          TO  HCERTNOO.
  6075     MOVE PI-CERT-SFX            TO  HCRTSFXO.
  6076     MOVE PI-CLP-YN              TO  CLPYNO
  6077     MOVE PI-CANCEL-REASON       TO  CANREAO
  6078     .
  6079 0510-GET-CERT.
  6080     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  6081     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  6082     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  6083     MOVE PI-STATE               TO  WS-CM-STATE.
  6084     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  6085     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  6086     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  6087     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  6088
  6089     PERFORM 0900-READ-CERT-FILE.
  6090
  6091     IF CERT-NOT-FOUND
  6092         MOVE -1                 TO  HLCANCL
  6093         MOVE AL-SANON           TO  HLCANCA
  6094         MOVE ER-0214            TO  EMI-ERROR
  6095         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6096         GO TO 8100-SEND-INITIAL-MAP.
  6097
  6098     IF CM-CLAIM-ATTACHED-COUNT = +0
  6099        GO TO 0510-SKIP-CLAIM-CHECK
  6100     END-IF
  6101*    DISPLAY ' STARTING CLAIM TEST '
  6102     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  6103     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  6104
  6105* EXEC CICS STARTBR
  6106*       DATASET     ('ELMSTR5')
  6107*       RIDFLD      (ELMSTR-KEY)
  6108*       RESP        (WS-RESPONSE)
  6109*    END-EXEC
  6110     MOVE 'ELMSTR5' TO DFHEIV1
  6111     MOVE 0
  6112       TO DFHEIV11
  6113*    MOVE '&,         G          &  N#00006048' TO DFHEIV0
  6114     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6115     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6116     MOVE X'204E233030303036303438' TO DFHEIV0(25:11)
  6117     CALL 'kxdfhei1' USING DFHEIV0,
  6118           DFHEIV1,
  6119           ELMSTR-KEY,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 112
* EL1278.cbl
  6120           DFHEIV99,
  6121           DFHEIV11,
  6122           DFHEIV99
  6123     MOVE EIBRESP  TO WS-RESPONSE
  6124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6125     IF WS-RESP-NORMAL
  6126     PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6127
  6128* EXEC CICS READNEXT
  6129*          DATASET   ('ELMSTR5')
  6130*          RIDFLD    (ELMSTR-KEY)
  6131*          SET       (ADDRESS OF CLAIM-MASTER)
  6132*          RESP      (WS-RESPONSE)
  6133*       END-EXEC
  6134     MOVE 'ELMSTR5' TO DFHEIV1
  6135     MOVE 0
  6136       TO DFHEIV11
  6137*    MOVE '&.S                   )  N#00006055' TO DFHEIV0
  6138     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6139     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6140     MOVE X'204E233030303036303535' TO DFHEIV0(25:11)
  6141     CALL 'kxdfhei1' USING DFHEIV0,
  6142           DFHEIV1,
  6143           DFHEIV20,
  6144           DFHEIV99,
  6145           ELMSTR-KEY,
  6146           DFHEIV99,
  6147           DFHEIV11,
  6148           DFHEIV99,
  6149           DFHEIV99
  6150     SET ADDRESS OF CLAIM-MASTER TO
  6151         DFHEIV20
  6152     MOVE EIBRESP  TO WS-RESPONSE
  6153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6154        IF (WS-RESP-NORMAL OR WS-RESP-DUPKEY)
  6155           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6156           AND (CM-CERT-NO = CL-CERT-NO)
  6157           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6158              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6159              SET FOUND-A-CLAIM  TO TRUE
  6160              IF CL-CLAIM-TYPE = 'L'
  6161                 IF CL-INCURRED-DT > WS-LF-INCUR-DT
  6162                    MOVE CL-INCURRED-DT TO WS-LF-INCUR-DT
  6163                 END-IF
  6164                 IF CLAIM-IS-OPEN
  6165                    SET OPEN-LF-CLAIM TO TRUE
  6166                 ELSE
  6167                    IF CL-LAST-CLOSE-DT > WS-LF-LAST-CLOSE-DT
  6168                       MOVE CL-LAST-CLOSE-DT
  6169                                 TO WS-LF-LAST-CLOSE-DT
  6170                    END-IF
  6171                    SET CLOSED-LF-CLAIM TO TRUE
  6172                 END-IF
  6173              ELSE
  6174                 IF CLAIM-IS-OPEN
  6175                    MOVE CL-PAID-THRU-DT
  6176                                 TO WS-AH-PAID-THRU-DT
  6177                    SET OPEN-AH-CLAIM TO TRUE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 113
* EL1278.cbl
  6178                 ELSE
  6179                    IF CL-PAID-THRU-DT > WS-AH-PAID-THRU-DT
  6180                       MOVE CL-PAID-THRU-DT
  6181                                 TO WS-AH-PAID-THRU-DT
  6182                    END-IF
  6183                    IF CL-LAST-CLOSE-DT > WS-AH-LAST-CLOSE-DT
  6184                       MOVE CL-LAST-CLOSE-DT
  6185                                 TO WS-AH-LAST-CLOSE-DT
  6186                    END-IF
  6187                    SET CLOSED-AH-CLAIM TO TRUE
  6188                 END-IF
  6189              END-IF
  6190           END-IF
  6191        ELSE
  6192           SET I-SAY-TO-STOP TO TRUE
  6193        END-IF
  6194     END-PERFORM
  6195     END-IF
  6196     IF FOUND-A-CLAIM
  6197        IF WS-LF-INCUR-DT NOT = LOW-VALUES
  6198           MOVE WS-LF-INCUR-DT   TO DC-BIN-DATE-1
  6199           MOVE ' '              TO DC-OPTION-CODE
  6200           PERFORM 9600-DATE-LINK
  6201           IF NO-CONVERSION-ERROR
  6202              MOVE DC-GREG-DATE-1-EDIT TO LCLMDTO
  6203              MOVE AL-SANOF      TO LCLMDTHA
  6204           END-IF
  6205        END-IF
  6206        IF WS-AH-PAID-THRU-DT NOT = LOW-VALUES
  6207           MOVE WS-AH-PAID-THRU-DT TO DC-BIN-DATE-1
  6208           MOVE ' '              TO DC-OPTION-CODE
  6209           PERFORM 9600-DATE-LINK
  6210           IF NO-CONVERSION-ERROR
  6211              MOVE DC-GREG-DATE-1-EDIT TO ACLMDTO
  6212              MOVE AL-SANOF      TO ACLMDTHA
  6213           END-IF
  6214        END-IF
  6215        MOVE PI-COMPANY-ID       TO WS-CF-COMPANY-ID
  6216        MOVE '3'                 TO WS-CF-RECORD-TYPE
  6217        MOVE CM-STATE            TO WS-CF-ACCESS
  6218        MOVE +0                  TO WS-CF-SEQUENCE-NO
  6219
  6220* EXEC CICS READ
  6221*          DATASET  (ELCNTL-ID)
  6222*          SET      (ADDRESS OF CONTROL-FILE)
  6223*          RIDFLD   (WS-CF-CONTROL-PRIMARY)
  6224*          RESP     (WS-RESPONSE)
  6225*       END-EXEC
  6226*    MOVE '&"S        E          (  N#00006126' TO DFHEIV0
  6227     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6228     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6229     MOVE X'204E233030303036313236' TO DFHEIV0(25:11)
  6230     CALL 'kxdfhei1' USING DFHEIV0,
  6231           ELCNTL-ID,
  6232           DFHEIV20,
  6233           DFHEIV99,
  6234           WS-CF-CONTROL-PRIMARY,
  6235           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 114
* EL1278.cbl
  6236           DFHEIV99,
  6237           DFHEIV99
  6238     SET ADDRESS OF CONTROL-FILE TO
  6239         DFHEIV20
  6240     MOVE EIBRESP  TO WS-RESPONSE
  6241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6242        IF WS-RESP-NORMAL
  6243           MOVE CF-ST-REF-AH-DEATH-IND
  6244                                 TO WS-ST-REF-IND
  6245        END-IF
  6246     END-IF
  6247     .
  6248 0510-SKIP-CLAIM-CHECK.
  6249     MOVE CM-INSURED-LAST-NAME   TO  HLNAMEO.
  6250     MOVE CM-INSURED-FIRST-NAME  TO  HFNAMEO.
  6251     MOVE CM-INSURED-INITIAL2    TO  HINITO.
  6252     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  6253
  6254* EXEC CICS READ
  6255*        DATASET  (ERMAIL-ID)
  6256*        RIDFLD   (WS-MA-CONTROL-PRIMARY)
  6257*        SET      (ADDRESS OF MAILING-DATA)
  6258*        RESP     (WS-RESPONSE)
  6259*    END-EXEC.
  6260*    MOVE '&"S        E          (  N#00006143' TO DFHEIV0
  6261     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6262     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6263     MOVE X'204E233030303036313433' TO DFHEIV0(25:11)
  6264     CALL 'kxdfhei1' USING DFHEIV0,
  6265           ERMAIL-ID,
  6266           DFHEIV20,
  6267           DFHEIV99,
  6268           WS-MA-CONTROL-PRIMARY,
  6269           DFHEIV99,
  6270           DFHEIV99,
  6271           DFHEIV99
  6272     SET ADDRESS OF MAILING-DATA TO
  6273         DFHEIV20
  6274     MOVE EIBRESP  TO WS-RESPONSE
  6275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6276
  6277     IF WS-RESP-NORMAL
  6278        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  6279           (S1 > +7)
  6280           OR (MA-MAIL-STATUS (S1) = '1')
  6281        END-PERFORM
  6282        IF S1 > +7
  6283           MOVE AL-SANOF         TO HPCYNA
  6284        END-IF
  6285     END-IF
  6286     IF CM-POST-CARD-IND = 'Y'
  6287        MOVE 'Y'                 TO HPCYNO
  6288     ELSE
  6289        MOVE 'N'                 TO HPCYNO
  6290     END-IF
  6291     IF ('8' NOT = CM-LF-CURRENT-STATUS AND CM-AH-CURRENT-STATUS)
  6292        OR (NOT CERT-AS-LOADED)
  6293        MOVE AL-SANOF            TO HPCYNA
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 115
* EL1278.cbl
  6294     END-IF
  6295*    IF (CERT-ADDED-BATCH)
  6296*       CONTINUE
  6297*    ELSE
  6298*       MOVE AL-SANOF            TO HPCYNA
  6299*    END-IF
  6300     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  6301     MOVE '5'                    TO  DC-OPTION-CODE.
  6302
  6303     PERFORM 9600-DATE-LINK.
  6304
  6305     MOVE DC-BIN-DATE-1          TO  DC-BIN-DATE-2.
  6306     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6307     MOVE '1'                    TO  DC-OPTION-CODE.
  6308
  6309     PERFORM 9600-DATE-LINK.
  6310
  6311     MOVE DC-ELAPSED-MONTHS      TO  WS-ELAPSED-MONTHS.
  6312
  6313     MOVE ZEROS TO WS-TOT-ITDR.
  6314     MOVE WS-REFUND-DESCRIP TO PMTHDO.
  6315
  6316 0510-CHECK-LF-STATUS.
  6317
  6318     IF (CM-LF-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6319         MOVE LOW-VALUES         TO WS-LF-CANCEL-DATE
  6320                                    PI-LF-CANCEL-DATE
  6321         MOVE SPACES             TO WS-LF-CANCEL-DATE-ED
  6322                                    PI-LF-CANCEL-DATE-ED
  6323                                    PI-LF-REFUND-METH
  6324         MOVE ZEROS              TO PI-LF-REFUND-AMT
  6325         GO TO 0510-CHECK-AH-STATUS.
  6326
  6327     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '8') AND
  6328        (CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6329          MOVE CM-LF-ITD-CANCEL-AMT TO HLITDRO
  6330          ADD  CM-LF-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6331          IF FIRST-ENTRY
  6332              MOVE CM-LF-CANCEL-DT      TO DC-BIN-DATE-1
  6333              MOVE SPACES               TO DC-OPTION-CODE
  6334              PERFORM 9600-DATE-LINK
  6335              IF NOT DATE-CONVERSION-ERROR
  6336                   MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6337                                            PI-LF-CANCEL-DATE-ED
  6338                                            WS-LF-CANCEL-DATE-ED
  6339                   MOVE CM-LF-CANCEL-DT TO  PI-LF-CANCEL-DATE
  6340                                            WS-LF-CANCEL-DATE.
  6341
  6342     IF (CM-LF-CURRENT-STATUS  IS EQUAL TO  '7')  AND
  6343        (CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES)
  6344          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6345          MOVE CM-LF-ITD-DEATH-AMT  TO HLITDRO
  6346          ADD  CM-LF-ITD-DEATH-AMT TO WS-TOT-ITDR
  6347        IF FIRST-ENTRY
  6348            MOVE CM-LF-DEATH-DT       TO DC-BIN-DATE-1
  6349            MOVE SPACES               TO DC-OPTION-CODE
  6350            PERFORM 9600-DATE-LINK
  6351            IF NOT DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 116
* EL1278.cbl
  6352                 MOVE DC-GREG-DATE-1-EDIT TO HLCANCO
  6353                                          PI-LF-CANCEL-DATE-ED
  6354                                          WS-LF-CANCEL-DATE-ED
  6355                 MOVE CM-LF-DEATH-DT  TO  PI-LF-CANCEL-DATE
  6356                                          WS-LF-CANCEL-DATE.
  6357
  6358 0510-CHECK-AH-STATUS.
  6359
  6360     IF (CM-AH-BENEFIT-CD IS EQUAL TO '00' OR '  ')
  6361         MOVE LOW-VALUES         TO WS-AH-CANCEL-DATE
  6362                                    PI-AH-CANCEL-DATE
  6363         MOVE SPACES             TO WS-AH-CANCEL-DATE-ED
  6364                                    PI-AH-CANCEL-DATE-ED
  6365                                    PI-AH-REFUND-METH
  6366         MOVE ZEROS              TO PI-AH-REFUND-AMT
  6367         GO TO 0510-CONT.
  6368
  6369     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '8')  AND
  6370        (CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES)
  6371          MOVE CM-AH-ITD-CANCEL-AMT TO HAITDRO
  6372          ADD  CM-AH-ITD-CANCEL-AMT TO WS-TOT-ITDR
  6373        IF FIRST-ENTRY
  6374            MOVE CM-AH-CANCEL-DT      TO DC-BIN-DATE-1
  6375            MOVE SPACES               TO DC-OPTION-CODE
  6376            PERFORM 9600-DATE-LINK
  6377            IF NOT DATE-CONVERSION-ERROR
  6378                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6379                                            PI-AH-CANCEL-DATE-ED
  6380                                            WS-AH-CANCEL-DATE-ED
  6381                 MOVE CM-AH-CANCEL-DT  TO   PI-AH-CANCEL-DATE
  6382                                            WS-AH-CANCEL-DATE.
  6383
  6384     IF (CM-AH-CURRENT-STATUS  IS EQUAL TO  '6' OR '7')   AND
  6385        (CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES)
  6386          MOVE WS-PMT-DESCRIP       TO PMTHDO
  6387          MOVE CM-AH-ITD-LUMP-PMT   TO HAITDRO
  6388          ADD  CM-AH-ITD-LUMP-PMT   TO WS-TOT-ITDR
  6389         IF FIRST-ENTRY
  6390             MOVE CM-AH-SETTLEMENT-DT  TO DC-BIN-DATE-1
  6391             MOVE SPACES               TO DC-OPTION-CODE
  6392             PERFORM 9600-DATE-LINK
  6393             IF NOT DATE-CONVERSION-ERROR
  6394                MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6395                                            PI-AH-CANCEL-DATE-ED
  6396                                            WS-AH-CANCEL-DATE-ED
  6397                MOVE CM-AH-SETTLEMENT-DT TO PI-AH-CANCEL-DATE
  6398                                            WS-AH-CANCEL-DATE.
  6399
  6400     IF CM-AH-CURRENT-STATUS IS EQUAL TO '8'
  6401         MOVE 'CANC DT'              TO  CNCDTHDO
  6402         GO TO 0510-CONT.
  6403
  6404     IF CM-LF-CURRENT-STATUS IS EQUAL TO '7'
  6405         MOVE 'DTH DT '              TO  CNCDTHDO
  6406         IF FIRST-ENTRY
  6407             MOVE CM-LF-DEATH-DT     TO  DC-BIN-DATE-1
  6408             MOVE ' '                TO  DC-OPTION-CODE
  6409             PERFORM 9600-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 117
* EL1278.cbl
  6410             IF NOT DATE-CONVERSION-ERROR
  6411                 MOVE DC-GREG-DATE-1-EDIT TO HACANCO
  6412                                             PI-AH-CANCEL-DATE-ED
  6413                                             WS-AH-CANCEL-DATE-ED
  6414                 MOVE CM-LF-DEATH-DT      TO PI-AH-CANCEL-DATE
  6415                                             WS-AH-CANCEL-DATE.
  6416
  6417 0510-CONT.
  6418
  6419     IF WS-TOT-ITDR GREATER THAN ZEROS
  6420         MOVE WS-TOT-ITDR TO TOITDRO.
  6421
  6422 0520-GET-COMPANY-RECORD.
  6423     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6424     MOVE '1'                    TO  WS-CF-RECORD-TYPE.
  6425     MOVE SPACES                 TO  WS-CF-ACCESS.
  6426     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6427
  6428     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6429
  6430     IF CNTL-NOT-FOUND
  6431         MOVE -1                 TO  HLCANCL
  6432         MOVE AL-SANON           TO  HLCANCA
  6433         MOVE ER-2616            TO  EMI-ERROR
  6434         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6435         GO TO 8100-SEND-INITIAL-MAP.
  6436
  6437     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6438       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6439         MOVE CF-LIFE-OVERRIDE-L1
  6440                                 TO  WS-CF-LIFE-OVERRIDE-L1
  6441         MOVE CF-LIFE-OVERRIDE-L2
  6442                                 TO  WS-CF-LIFE-OVERRIDE-L2
  6443         MOVE CF-AH-OVERRIDE-L1  TO  WS-CF-AH-OVERRIDE-L1
  6444         MOVE CF-AH-OVERRIDE-L2  TO  WS-CF-AH-OVERRIDE-L2
  6445         MOVE CF-CR-REM-TERM-CALC
  6446                                 TO  WS-CF-CR-REM-TERM-CALC
  6447         MOVE CF-CR-R78-METHOD   TO  WS-CF-CR-R78-METHOD
  6448         IF CF-DEFAULT-APR NUMERIC
  6449             MOVE CF-DEFAULT-APR     TO  WS-CF-DEFAULT-APR
  6450             GO TO 0525-GET-LF-BENEFIT
  6451         ELSE
  6452             MOVE ZEROS              TO  WS-CF-DEFAULT-APR
  6453             GO TO 0525-GET-LF-BENEFIT.
  6454
  6455     MOVE -1                     TO  HLCANCL.
  6456     MOVE AL-SANON               TO  HLCANCA.
  6457     MOVE ER-2616                TO  EMI-ERROR.
  6458
  6459     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6460
  6461     GO TO 8100-SEND-INITIAL-MAP.
  6462
  6463 0525-GET-LF-BENEFIT.
  6464
  6465     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  6466        GO TO 0527-GET-AH-BENEFIT
  6467     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 118
* EL1278.cbl
  6468
  6469     MOVE '4'                    TO  WS-CF-RECORD-TYPE.
  6470     MOVE CM-LF-BENEFIT-CD       TO  WS-BENEFIT-NO
  6471                                     HLCDO.
  6472     MOVE WS-CF-LIFE-OVERRIDE-L2
  6473                                 TO  HLKINDO.
  6474
  6475     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6476
  6477     IF BENEFIT-FOUND
  6478         NEXT SENTENCE
  6479     ELSE
  6480         MOVE -1                 TO  HLCDL
  6481         MOVE AL-SANON           TO  HLCDA
  6482         MOVE ER-0028            TO  EMI-ERROR
  6483         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6484         GO TO 8100-SEND-INITIAL-MAP.
  6485
  6486     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6487         MOVE AL-UNNOF           TO  HLTERMA.
  6488
  6489*****MOVE WS-BENEFIT-DESCRIP     TO  HLDESCO.
  6490     MOVE WS-KIND                TO WS-LF-KIND
  6491     MOVE CF-LF-COVERAGE-TYPE (WS-INDEX)
  6492                                 TO  WS-CF-LF-COVERAGE-TYPE.
  6493
  6494     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6495         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6496                                 TO  WS-LF-CO-REM-TERM-CALC.
  6497
  6498     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6499         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6500                                 TO  WS-LF-CO-EARNINGS-CALC
  6501                                     WS-LF-CO-REFUND-CALC.
  6502
  6503     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6504         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6505                                 TO  WS-LF-SPECIAL-CALC-CD.
  6506
  6507     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6508         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6509                                 TO  WS-LF-CO-REFUND-CALC.
  6510
  6511 0527-GET-AH-BENEFIT.
  6512
  6513     IF CM-AH-BENEFIT-CD = '00' OR '  '
  6514        GO TO 0530-GET-STATE-RECORD
  6515     END-IF
  6516
  6517     MOVE '5'                    TO  WS-CF-RECORD-TYPE.
  6518     MOVE CM-AH-BENEFIT-CD       TO  WS-BENEFIT-NO
  6519                                     HACDO.
  6520     MOVE WS-CF-AH-OVERRIDE-L2   TO  HAKINDO.
  6521
  6522     PERFORM 1600-LOCATE-BENEFIT THRU 1699-EXIT.
  6523
  6524     IF BENEFIT-FOUND
  6525         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 119
* EL1278.cbl
  6526     ELSE
  6527         MOVE -1                 TO  HACDL
  6528         MOVE AL-SANON           TO  HACDA
  6529         MOVE ER-0028            TO  EMI-ERROR
  6530         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  6531         GO TO 8100-SEND-INITIAL-MAP.
  6532
  6533     IF CF-SUMMARY-PROCESSING (WS-INDEX)
  6534         MOVE AL-UNNOF           TO  HATERMA.
  6535
  6536*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  6537     MOVE WS-KIND                TO  WS-AH-KIND
  6538
  6539     IF CF-CO-REM-TERM-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6540         MOVE CF-CO-REM-TERM-CALC (WS-INDEX)
  6541                                 TO  WS-AH-CO-REM-TERM-CALC.
  6542
  6543     IF CF-CO-EARNINGS-CALC (WS-INDEX)  IS GREATER THAN  ' '
  6544         MOVE CF-CO-EARNINGS-CALC (WS-INDEX)
  6545                                 TO  WS-AH-CO-EARNINGS-CALC
  6546                                     WS-AH-CO-REFUND-CALC.
  6547
  6548     IF CF-SPECIAL-CALC-CD (WS-INDEX)  IS GREATER THAN  ' '
  6549         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  6550                                 TO  WS-AH-SPECIAL-CALC-CD.
  6551
  6552     IF CF-CO-REFUND-CALC (WS-INDEX)  IS GREATER THAN  '0'
  6553         MOVE CF-CO-REFUND-CALC (WS-INDEX)
  6554                                 TO  WS-AH-CO-REFUND-CALC.
  6555     IF CF-BENEFIT-CATEGORY (WS-INDEX) > ' '
  6556        MOVE CF-BENEFIT-CATEGORY (WS-INDEX)
  6557                                 TO WS-AH-BEN-CATEGORY
  6558     END-IF
  6559     .
  6560 0530-GET-STATE-RECORD.
  6561     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6562     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  6563     MOVE CM-STATE               TO  WS-CF-ACCESS.
  6564     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6565
  6566     PERFORM 1000-READ-CONTROL  THRU  1099-EXIT.
  6567
  6568     IF CNTL-NOT-FOUND
  6569         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6570                                     WS-LF-ST-REM-TERM-CALC
  6571         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6572         GO TO 0560-FIND-ACCOUNT.
  6573
  6574     IF WS-CF-COMPANY-ID  IS EQUAL TO  CF-COMPANY-ID
  6575       AND WS-CF-RECORD-TYPE  IS EQUAL TO  CF-RECORD-TYPE
  6576       AND CM-STATE  IS EQUAL TO  CF-STATE-CODE
  6577         MOVE 'Y'                TO  WS-STATE-RECORD-SW
  6578     ELSE
  6579         MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6580                                     WS-LF-ST-REM-TERM-CALC
  6581         MOVE 'N'                TO  WS-STATE-RECORD-SW
  6582         GO TO 0560-FIND-ACCOUNT.
  6583
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 120
* EL1278.cbl
  6584     MOVE CF-STATE-ABBREVIATION  TO  WS-STATE-ABBREVIATION.
  6585     MOVE CF-ST-FST-PMT-DAYS-CHG TO  WS-STATE-EXT-DAYS-CHG
  6586
  6587     IF CM-LF-BENEFIT-CD  = '00'
  6588         GO TO 0550-GET-AH-BEN-IN-STATE.
  6589
  6590 0540-GET-LF-BEN-IN-STATE.
  6591     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  6592     MOVE PI-LIFE-OVERRIDE-L1    TO  WS-LOOKUP-TYPE.
  6593
  6594     MOVE '0'                    TO WS-LF-ST-REM-TERM-CALC
  6595     IF CF-ST-RT-CALC NOT = SPACES
  6596        MOVE CF-ST-RT-CALC       TO WS-LF-ST-REM-TERM-CALC
  6597     END-IF
  6598
  6599     IF WS-CF-LF-COVERAGE-TYPE = 'R'
  6600        IF CF-ST-RF-LR-CALC > '0'
  6601           MOVE CF-ST-RF-LR-CALC TO WS-LF-ST-REFUND-CALC
  6602        END-IF
  6603        IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  6604           IF CF-ST-RF-LN-CALC > '0'
  6605              MOVE CF-ST-RF-LN-CALC
  6606                                 TO WS-LF-ST-REFUND-CALC
  6607           END-IF
  6608        END-IF
  6609     ELSE
  6610        IF CF-ST-RF-LL-CALC > '0'
  6611           MOVE CF-ST-RF-LL-CALC TO WS-LF-ST-REFUND-CALC
  6612        END-IF
  6613     END-IF
  6614
  6615     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6616
  6617     IF NO-BENEFIT-FOUND
  6618*        MOVE '0'                TO  WS-LF-ST-REFUND-CALC
  6619         GO TO 0550-GET-AH-BEN-IN-STATE.
  6620
  6621     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6622         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6623                                 TO  WS-LF-ST-REM-TERM-CALC.
  6624
  6625     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6626         MOVE CF-ST-REFUND-CALC (SUB3)
  6627                                 TO  WS-LF-ST-REFUND-CALC.
  6628
  6629 0550-GET-AH-BEN-IN-STATE.
  6630     IF CM-AH-BENEFIT-CD  = '00'
  6631         GO TO 0560-FIND-ACCOUNT.
  6632
  6633     MOVE '0'                    TO WS-AH-ST-REM-TERM-CALC
  6634     IF CF-ST-RT-CALC NOT = SPACES
  6635        MOVE CF-ST-RT-CALC       TO WS-AH-ST-REM-TERM-CALC
  6636     END-IF
  6637
  6638     IF CF-ST-RF-AH-CALC > '0'
  6639        MOVE CF-ST-RF-AH-CALC    TO WS-AH-ST-REFUND-CALC
  6640     END-IF
  6641     IF WS-AH-SPECIAL-CALC-CD = 'C'
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 121
* EL1278.cbl
  6642        IF CF-ST-RF-CP-CALC > '0'
  6643           MOVE CF-ST-RF-CP-CALC TO WS-AH-ST-REFUND-CALC
  6644        END-IF
  6645     END-IF
  6646
  6647     MOVE CM-AH-BENEFIT-CD       TO  WS-BEN-CD.
  6648     MOVE PI-AH-OVERRIDE-L1      TO  WS-LOOKUP-TYPE.
  6649
  6650     PERFORM 1100-FIND-BENEFIT-IN-STATE  THRU  1199-EXIT.
  6651
  6652     IF NO-BENEFIT-FOUND
  6653*        MOVE '0'                TO  WS-AH-ST-REFUND-CALC
  6654         GO TO 0560-FIND-ACCOUNT.
  6655
  6656     IF CF-ST-REM-TERM-CALC (SUB3)  IS GREATER THAN  '0'
  6657         MOVE CF-ST-REM-TERM-CALC (SUB3)
  6658                                 TO  WS-AH-ST-REM-TERM-CALC.
  6659
  6660     IF CF-ST-REFUND-CALC (SUB3)  IS GREATER THAN  '0'
  6661         MOVE CF-ST-REFUND-CALC (SUB3)
  6662                                 TO  WS-AH-ST-REFUND-CALC.
  6663
  6664 0560-FIND-ACCOUNT.
  6665     MOVE CM-COMPANY-CD          TO  WS-AM-COMPANY-CD.
  6666     MOVE CM-CARRIER             TO  WS-AM-CARRIER.
  6667     MOVE CM-GROUPING            TO  WS-AM-GROUPING.
  6668     MOVE CM-STATE               TO  WS-AM-STATE.
  6669     MOVE CM-ACCOUNT             TO  WS-AM-ACCOUNT.
  6670     MOVE CM-CERT-EFF-DT         TO  WS-AM-EXPIRATION-DT.
  6671     MOVE LOW-VALUES             TO  WS-AM-FILLER.
  6672
  6673     PERFORM 1200-START-ACCOUNT-MASTER  THRU  1299-EXIT.
  6674
  6675     IF ACCT-FOUND
  6676         NEXT SENTENCE
  6677     ELSE
  6678         GO TO 0585-NO-ACCT.
  6679
  6680 0570-READ-NEXT-RANGE.
  6681     PERFORM 1300-READ-ACCOUNT-MASTER  THRU  1399-EXIT.
  6682
  6683     IF ACCT-FOUND
  6684         NEXT SENTENCE
  6685     ELSE
  6686         GO TO 0580-ACCT-NOT-FOUND.
  6687
  6688     IF CM-COMPANY-CD  IS EQUAL TO  AM-COMPANY-CD
  6689       AND CM-CARRIER  IS EQUAL TO  AM-CARRIER
  6690       AND CM-GROUPING  IS EQUAL TO  AM-GROUPING
  6691       AND CM-STATE  IS EQUAL TO  AM-STATE
  6692       AND CM-ACCOUNT  IS EQUAL TO  AM-ACCOUNT
  6693         NEXT SENTENCE
  6694     ELSE
  6695         GO TO 0580-ACCT-NOT-FOUND.
  6696
  6697     MOVE 'X'                    TO  DATE-RANGE-SW.
  6698
  6699     IF CM-CERT-EFF-DT  IS LESS THAN  AM-EFFECTIVE-DT
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 122
* EL1278.cbl
  6700         MOVE 'X'                TO  DATE-RANGE-SW
  6701         GO TO 0580-ACCT-NOT-FOUND.
  6702
  6703     IF CM-CERT-EFF-DT  IS NOT LESS THAN  AM-EXPIRATION-DT
  6704         GO TO 0570-READ-NEXT-RANGE.
  6705
  6706     IF WS-BROWSE-STARTED-SW = 'Y'
  6707
  6708* EXEC CICS ENDBR
  6709*          DATASET    ('ERACCT')
  6710*       END-EXEC
  6711     MOVE 'ERACCT' TO DFHEIV1
  6712     MOVE 0
  6713       TO DFHEIV11
  6714*    MOVE '&2                    $   #00006579' TO DFHEIV0
  6715     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6716     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6717     MOVE X'2020233030303036353739' TO DFHEIV0(25:11)
  6718     CALL 'kxdfhei1' USING DFHEIV0,
  6719           DFHEIV1,
  6720           DFHEIV11,
  6721           DFHEIV99
  6722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6723        MOVE SPACES             TO  WS-BROWSE-STARTED-SW
  6724     END-IF
  6725     MOVE ' '                    TO  DATE-RANGE-SW.
  6726     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  6727
  6728     GO TO 0590-SET-ACCOUNT.
  6729
  6730 0580-ACCT-NOT-FOUND.
  6731     IF DATE-RANGE-SW  IS NOT EQUAL TO  SPACES
  6732         MOVE ER-2601            TO  EMI-ERROR
  6733     ELSE
  6734         MOVE ER-2619            TO  EMI-ERROR.
  6735
  6736     MOVE 'N'                    TO  WS-ACCT-RECORD-SW.
  6737
  6738     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  6739
  6740 0585-NO-ACCT.
  6741     MOVE SPACES                 TO  WS-ACCT-USER-FLD-5.
  6742     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  6743                                     WS-AM-EARN-METHOD-R
  6744                                     WS-AM-EARN-METHOD-A
  6745                                     WS-LF-AM-REM-TERM-CALC
  6746                                     WS-AH-AM-REM-TERM-CALC.
  6747
  6748     GO TO 0600-CHECK-FOR-LIFE.
  6749
  6750 0590-SET-ACCOUNT.
  6751******************************************************************
  6752******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  6753******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  6754******* METHODS.
  6755******************************************************************
  6756     MOVE SPACES              TO WS-LF-FO-REFUND-CALC.
  6757     MOVE SPACES              TO WS-AH-FO-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 123
* EL1278.cbl
  6758     IF PI-COMPANY-ID EQUAL TO 'NCL'
  6759          IF ((CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  6760                 OR (CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  6761                  PERFORM 7000-GET-ERFORM THRU 7000-EXIT
  6762                  IF FORM-FOUND
  6763                      PERFORM 7100-BENEFIT-SEARCH THRU 7100-EXIT.
  6764******************************************************************
  6765
  6766     MOVE AM-FLD-5               TO  WS-ACCT-USER-FLD-5.
  6767     MOVE '0'                    TO  WS-AM-EARN-METHOD-L
  6768                                     WS-AM-EARN-METHOD-R
  6769                                     WS-AM-EARN-METHOD-A.
  6770
  6771*    EVALUATE AM-EARN-METHOD-R
  6772*       WHEN 'R'
  6773*           MOVE '1'                TO  WS-AM-EARN-METHOD-R
  6774*       WHEN 'P'
  6775*           MOVE '2'                TO  WS-AM-EARN-METHOD-R
  6776*       WHEN 'C'
  6777*           MOVE '3'                TO  WS-AM-EARN-METHOD-R
  6778*       WHEN 'A'
  6779*           MOVE '6'                TO  WS-AM-EARN-METHOD-R
  6780*       WHEN 'M'
  6781*           MOVE '8'                TO  WS-AM-EARN-METHOD-R
  6782*       WHEN 'S'
  6783*           MOVE '9'                TO  WS-AM-EARN-METHOD-R
  6784*    END-EVALUATE.
  6785
  6786*    EVALUATE AM-EARN-METHOD-L
  6787*       WHEN 'R'
  6788*           MOVE '1'                TO  WS-AM-EARN-METHOD-L
  6789*       WHEN 'P'
  6790*           MOVE '2'                TO  WS-AM-EARN-METHOD-L
  6791*       WHEN 'C'
  6792*           MOVE '3'                TO  WS-AM-EARN-METHOD-L
  6793*       WHEN 'A'
  6794*           MOVE '6'                TO  WS-AM-EARN-METHOD-L
  6795*       WHEN 'M'
  6796*           MOVE '8'                 TO  WS-AM-EARN-METHOD-L
  6797*       WHEN 'S'
  6798*           MOVE '9'                 TO  WS-AM-EARN-METHOD-L
  6799*    END-EVALUATE.
  6800
  6801*    EVALUATE AM-EARN-METHOD-A
  6802*       WHEN 'R'
  6803*           MOVE '1'                TO  WS-AM-EARN-METHOD-A
  6804*       WHEN 'P'
  6805*           MOVE '2'                TO  WS-AM-EARN-METHOD-A
  6806*       WHEN 'C'
  6807*           MOVE '3'                TO  WS-AM-EARN-METHOD-A
  6808*       WHEN 'A'
  6809*           MOVE '6'                TO  WS-AM-EARN-METHOD-A
  6810*       WHEN 'M'
  6811*           MOVE '8'                TO  WS-AM-EARN-METHOD-A
  6812*       WHEN 'N'
  6813*           MOVE '5'                TO  WS-AM-EARN-METHOD-A
  6814*       WHEN 'S'
  6815*           MOVE '9'                TO  WS-AM-EARN-METHOD-A
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 124
* EL1278.cbl
  6816*    END-EVALUATE.
  6817
  6818     MOVE ZEROS                  TO  WS-TOT-AH-PREM
  6819                                     WS-TOT-LF-PREM
  6820                                     WS-TOT-AH-RFND
  6821                                     WS-TOT-LF-RFND.
  6822
  6823 0600-CHECK-FOR-LIFE.
  6824     IF CM-LF-BENEFIT-CD  = '00'
  6825         GO TO 0640-AH-BENEFIT.
  6826
  6827 0610-GET-LIFE-BENEFIT.
  6828
  6829     IF ACCT-FOUND
  6830         MOVE +1                 TO SUB3
  6831         PERFORM 5000-GET-LF-AM-REM-TERM THRU 5900-EXIT.
  6832     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  6833     MOVE WS-LF-KIND             TO  HLEDESCO.
  6834     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  6835     IF WS-LF-CO-EARNINGS-CALC = 'B'
  6836        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  6837                             + CM-LF-ALT-PREMIUM-AMT
  6838     ELSE
  6839        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  6840     END-IF
  6841
  6842     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  6843     EVALUATE TRUE
  6844        WHEN ((OPEN-LF-CLAIM)
  6845           OR (CLOSED-LF-CLAIM))
  6846           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  6847           MOVE ZEROS            TO HLREFNDO  WS-CALC-REFUND
  6848                                    WS-TOT-LF-RFND
  6849                                    PI-LF-REFUND-AMT
  6850           IF CM-AH-BENEFIT-CD NOT = '00'
  6851              MOVE ZEROS         TO HAREFNDO
  6852                                    WS-TOT-AH-RFND
  6853                                    PI-AH-REFUND-AMT
  6854              MOVE SPACES        TO PI-AH-REFUND-METH
  6855           END-IF
  6856           MOVE ER-2965          TO EMI-ERROR
  6857           PERFORM 9700-ERROR-FORMAT
  6858                                 THRU  9799-EXIT
  6859           GO TO 0640-AH-BENEFIT
  6860        WHEN OPEN-LF-CLAIM
  6861           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6862           AND WS-ST-REF-IND = '4'
  6863           MOVE ER-2966          TO EMI-ERROR
  6864           PERFORM 9700-ERROR-FORMAT
  6865                                 THRU  9799-EXIT
  6866        WHEN OPEN-LF-CLAIM
  6867           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6868           AND WS-ST-REF-IND NOT = '4'
  6869           MOVE ER-2967          TO EMI-ERROR
  6870           PERFORM 9700-ERROR-FORMAT
  6871                                 THRU  9799-EXIT
  6872           GO TO 0640-AH-BENEFIT
  6873        WHEN CLOSED-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 125
* EL1278.cbl
  6874           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6875           AND WS-ST-REF-IND = '4'
  6876           MOVE ER-2968          TO EMI-ERROR
  6877           PERFORM 9700-ERROR-FORMAT
  6878                                 THRU  9799-EXIT
  6879        WHEN CLOSED-LF-CLAIM
  6880           AND WS-LF-CANCEL-DATE = WS-LF-INCUR-DT
  6881           AND WS-ST-REF-IND NOT = '4'
  6882           MOVE ER-2969          TO EMI-ERROR
  6883           PERFORM 9700-ERROR-FORMAT
  6884                                 THRU  9799-EXIT
  6885           GO TO 0640-AH-BENEFIT
  6886        WHEN OTHER
  6887           CONTINUE
  6888     END-EVALUATE
  6889     .
  6890 0620-GET-REM-TERM.
  6891     MOVE WS-CF-LIFE-OVERRIDE-L1
  6892                                 TO  CP-LIFE-OVERRIDE-CODE.
  6893     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  6894     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  6895     MOVE WS-LF-CANCEL-DATE      TO  CP-VALUATION-DT.
  6896     MOVE WS-LF-CANCEL-DATE-ED   TO  HLCANCO.
  6897     MOVE CM-STATE               TO  CP-STATE.
  6898     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  6899     MOVE WS-CF-LF-COVERAGE-TYPE
  6900                                 TO  CP-BENEFIT-TYPE.
  6901     MOVE WS-LF-KIND             TO  HLEDESCO.
  6902     MOVE WS-LF-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  6903     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6904     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6905     MOVE '2'                    TO  CP-PROCESS-TYPE.
  6906     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  6907     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  6908     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  6909     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  6910     MOVE WS-CF-CR-REM-TERM-CALC
  6911                                 TO  CP-REM-TERM-METHOD.
  6912
  6913     IF WS-LF-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  6914         MOVE WS-LF-CO-REM-TERM-CALC
  6915                                 TO  CP-REM-TERM-METHOD.
  6916
  6917     IF WS-LF-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  6918         MOVE WS-LF-ST-REM-TERM-CALC
  6919                                 TO  CP-REM-TERM-METHOD.
  6920
  6921     IF WS-LF-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  6922         MOVE WS-LF-AM-REM-TERM-CALC
  6923                                 TO  CP-REM-TERM-METHOD.
  6924
  6925     IF (PI-COMPANY-ID = 'CID')
  6926        AND (CP-STATE-STD-ABBRV = 'WI')
  6927        MOVE '7'                 TO CP-REM-TERM-METHOD
  6928        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6929     END-IF
  6930     IF (PI-COMPANY-ID = 'CID')
  6931        AND (CP-STATE-STD-ABBRV = 'MO')
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 126
* EL1278.cbl
  6932        AND (CM-CERT-EFF-DT >= X'9B41')
  6933        AND (CM-CERT-EFF-DT <= X'A2FB')
  6934        MOVE '7'                 TO CP-REM-TERM-METHOD
  6935        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6936     END-IF
  6937     MOVE CM-LF-ORIG-TERM        TO  HLTERMO
  6938                                     CP-ORIGINAL-TERM
  6939                                     CP-LOAN-TERM.
  6940
  6941     IF CP-TRUNCATED-LIFE
  6942         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  6943
  6944     IF CP-TERM-IS-DAYS
  6945         IF CM-LF-TERM-IN-DAYS  IS NUMERIC
  6946             MOVE CM-LF-TERM-IN-DAYS
  6947                                 TO  CP-TERM-OR-EXT-DAYS
  6948         ELSE
  6949             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS
  6950     ELSE
  6951         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  6952             MOVE CM-PMT-EXTENSION-DAYS
  6953                                 TO  CP-TERM-OR-EXT-DAYS
  6954         ELSE
  6955             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  6956
  6957*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  6958     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  6959     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  6960     MOVE CM-STATE               TO  WS-CF-ACCESS.
  6961     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  6962
  6963
  6964* EXEC CICS READ
  6965*        DATASET  (ELCNTL-ID)
  6966*        SET      (ADDRESS OF CONTROL-FILE)
  6967*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  6968*        RESP     (WS-RESPONSE)
  6969*    END-EXEC.
  6970*    MOVE '&"S        E          (  N#00006822' TO DFHEIV0
  6971     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6972     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6973     MOVE X'204E233030303036383232' TO DFHEIV0(25:11)
  6974     CALL 'kxdfhei1' USING DFHEIV0,
  6975           ELCNTL-ID,
  6976           DFHEIV20,
  6977           DFHEIV99,
  6978           WS-CF-CONTROL-PRIMARY,
  6979           DFHEIV99,
  6980           DFHEIV99,
  6981           DFHEIV99
  6982     SET ADDRESS OF CONTROL-FILE TO
  6983         DFHEIV20
  6984     MOVE EIBRESP  TO WS-RESPONSE
  6985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6986
  6987
  6988     IF WS-RESP-NOTOPEN
  6989         MOVE ER-2617            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 127
* EL1278.cbl
  6990         GO TO 0320-INPUT-ERROR.
  6991
  6992     IF WS-RESP-NOTFND
  6993         MOVE ZERO               TO  CP-FREE-LOOK
  6994     ELSE
  6995         MOVE CF-ST-FREE-LOOK-PERIOD
  6996                                 TO CP-FREE-LOOK.
  6997
  6998     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6999        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7000        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  7001     END-IF
  7002
  7003     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7004
  7005     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7006        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7007        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  7008        COMPUTE CP-REMAINING-TERM-1 =
  7009                CP-REMAINING-TERM-1 - +1
  7010        COMPUTE CP-REMAINING-TERM-2 =
  7011                CP-REMAINING-TERM-2 - +1
  7012     END-IF
  7013
  7014     IF CP-REMAINING-TERM-1 NEGATIVE
  7015        MOVE ZEROS               TO CP-REMAINING-TERM-1
  7016     END-IF
  7017     IF CP-REMAINING-TERM-2 NEGATIVE
  7018        MOVE ZEROS               TO CP-REMAINING-TERM-2
  7019     END-IF
  7020     MOVE CP-REMAINING-TERM-1    TO  HLREMO.
  7021
  7022     IF PI-LF-CANCEL-DATE = LOW-VALUES
  7023         GO TO 0640-AH-BENEFIT.
  7024*    IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-LF-ORIG-TERM
  7025*        MOVE CM-LF-ORIG-TERM    TO  HLREMO.
  7026
  7027     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '8'
  7028         IF CM-LF-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7029             MOVE ER-0681        TO  EMI-ERROR
  7030             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7031
  7032     IF CM-LF-CURRENT-STATUS  IS EQUAL TO  '7'
  7033         IF CM-LF-DEATH-DT  IS NOT EQUAL TO  LOW-VALUES
  7034             MOVE ER-0682        TO  EMI-ERROR
  7035             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7036
  7037 0630-CONTINUE-LIFE.
  7038
  7039     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7040        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7041        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7042                                    FREMTRMO
  7043     ELSE
  7044        MOVE CP-REMAINING-TERM-2 TO  CP-REMAINING-TERM
  7045                                     FREMTRMO
  7046     END-IF
  7047     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 128
* EL1278.cbl
  7048     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  7049     if pi-company-id = 'AHL'
  7050        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7051        if cp-class-code = spaces
  7052           move zeros            to cp-class-code
  7053        end-if
  7054     ELSE
  7055        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7056     END-IF
  7057     IF (PI-COMPANY-ID = 'DCC')
  7058        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  7059        MOVE ' '                 TO WS-PDEF-RECORD-SW
  7060        PERFORM 0730-GET-DDF-FACTORS
  7061                                 THRU 0730-EXIT
  7062        IF PDEF-FOUND
  7063           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7064              (P1 > +8)
  7065              OR (PD-PROD-CODE (P1) = 'L')
  7066           END-PERFORM
  7067           IF P1 < +9
  7068              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  7069           END-IF
  7070        END-IF
  7071     END-IF
  7072     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT.
  7073
  7074     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
  7075
  7076     IF WS-LF-CO-EARNINGS-CALC = 'B'
  7077        COMPUTE WS-LIFE-PREMIUM = CM-LF-PREMIUM-AMT
  7078                             + CM-LF-ALT-PREMIUM-AMT
  7079     ELSE
  7080        MOVE CM-LF-PREMIUM-AMT TO WS-LIFE-PREMIUM
  7081     END-IF
  7082
  7083     MOVE WS-LIFE-PREMIUM        TO  HLPREMO
  7084                                     WS-TOT-LF-PREM.
  7085
  7086     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  7087        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  7088        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  7089     ELSE
  7090        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  7091     END-IF
  7092
  7093     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7094     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7095
  7096     IF WS-LF-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7097         MOVE WS-LF-ST-REFUND-CALC
  7098                                 TO  CP-EARNING-METHOD.
  7099
  7100     IF WS-LF-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7101         MOVE WS-LF-FO-REFUND-CALC
  7102                                 TO  CP-EARNING-METHOD.
  7103
  7104     if (pi-company-id = 'CID')
  7105        and (cp-state-std-abbrv = 'MN' OR 'WA')
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 129
* EL1278.cbl
  7106        continue
  7107     else
  7108        IF CP-RATING-METHOD = '4'
  7109           MOVE '4'              TO CP-EARNING-METHOD
  7110        END-IF
  7111     end-if
  7112*    IF WS-CF-LF-COVERAGE-TYPE = 'R'
  7113*        IF WS-AM-EARN-METHOD-R  IS GREATER THAN  ZERO
  7114*            MOVE WS-AM-EARN-METHOD-R
  7115*                                TO  CP-EARNING-METHOD
  7116*        END-IF
  7117*    ELSE
  7118*        IF WS-AM-EARN-METHOD-L  IS GREATER THAN  ZERO
  7119*            MOVE WS-AM-EARN-METHOD-L
  7120*                                TO  CP-EARNING-METHOD.
  7121
  7122     if pi-company-id = 'AHL'
  7123        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
  7124        if cp-class-code = spaces
  7125           move zeros            to cp-class-code
  7126        end-if
  7127     ELSE
  7128        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7129     END-IF
  7130     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7131     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7132                                     CP-RATING-BENEFIT-AMT.
  7133     IF CP-STATE-STD-ABBRV = 'OR'
  7134         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7135                                         CM-LF-ALT-BENEFIT-AMT.
  7136****   N O T E   ****
  7137*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  7138*      THE OH HARD CODING IN ELCRFNDP
  7139
  7140     IF PI-COMPANY-ID = 'CID'
  7141        IF CP-STATE-STD-ABBRV = 'OH'
  7142           MOVE WS-LF-CO-EARNINGS-CALC
  7143                                 TO CP-EARNING-METHOD
  7144        END-IF
  7145     END-IF
  7146
  7147****   N O T E   ****
  7148
  7149****   MN   NOTE  ****  CID HAS THE STATE REFUND METHOD SET AS
  7150****      R78 BUT THEY WANT THE BALLOONS REFUNDED WITH A
  7151****      CUSTOM FORMULA THAT IS IN ELRFND SO I AM SETTING
  7152****     THE APPROPRIATE OPTIONS HERE
  7153*    IF PI-COMPANY-ID = 'CID'
  7154*       IF (CP-STATE-STD-ABBRV = 'MN')
  7155*          AND (CM-CERT-EFF-DT > X'A4FF')
  7156*          AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7157*          MOVE '5'              TO CP-EARNING-METHOD
  7158*       END-IF
  7159*    END-IF
  7160     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7161     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7162     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  7163     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 130
* EL1278.cbl
  7164     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7165     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7166
  7167*    IF CP-EARN-AS-NET-PAY
  7168*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7169*           IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7170*               MOVE WS-CF-DEFAULT-APR
  7171*                                TO  CP-LOAN-APR
  7172*               MOVE ER-3780     TO  EMI-ERROR
  7173*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7174*           ELSE
  7175*               MOVE ER-3781     TO  EMI-ERROR
  7176*               PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7177
  7178*    DISPLAY ' 1278 REM AMT      ' CP-REMAINING-BENEFIT
  7179*    DISPLAY ' 1278 REM TRM      ' CP-REMAINING-TERM
  7180*    DISPLAY ' 1278 EARN METH    ' CP-EARNING-METHOD
  7181*    DISPLAY ' 1278 RATE METH    ' CP-RATING-METHOD
  7182*    DISPLAY ' 1278 CLASS        ' CP-CLASS-CODE
  7183*    DISPLAY ' 1278 BENE CODE    ' CP-BENEFIT-CD
  7184*    DISPLAY ' 1278 ORIG BENE    ' CP-ORIGINAL-BENEFIT
  7185*    DISPLAY ' 1278 RATE BENE    ' CP-RATING-BENEFIT-AMT
  7186*    DISPLAY ' 1278 ORIG PREM    ' CP-ORIGINAL-PREMIUM
  7187*    DISPLAY ' 1278 ISS AGE      ' CP-ISSUE-AGE
  7188*    DISPLAY ' 1278 DEV CODE     ' CP-DEVIATION-CODE
  7189*    DISPLAY ' 1278 DEV PCT      ' CP-RATE-DEV-PCT
  7190*    DISPLAY ' 1278 APR          ' CP-LOAN-APR
  7191*    DISPLAY ' 1278 EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  7192*    DISPLAY ' 1278 LOAN TERM    ' CP-LOAN-TERM
  7193*    DISPLAY ' 1278 SPEC CALC    ' CP-SPECIAL-CALC-CD
  7194*    DISPLAY ' 1278 ST STD ABB   ' CP-STATE-STD-ABBRV
  7195     MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  7196     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7197
  7198     MOVE 'L'                    TO  WS-REFUND-SEARCH-SW.
  7199
  7200     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7201
  7202     IF CP-ERROR-RATE-IS-ZERO
  7203       OR CP-ERROR-RATE-NOT-FOUND
  7204         MOVE ER-2740            TO  EMI-ERROR
  7205         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7206
  7207     IF CP-ERROR-RATE-FILE-NOTOPEN
  7208         MOVE ER-2617            TO  EMI-ERROR
  7209         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7210
  7211     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7212     MOVE CP-CALC-REFUND         TO  HLREFNDO  WS-CALC-REFUND
  7213                                     WS-TOT-LF-RFND
  7214                                     PI-LF-REFUND-AMT.
  7215     MOVE CP-REMAINING-AMT       TO  HLREDO.
  7216
  7217     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7218
  7219     IF WS-LF-CO-EARNINGS-CALC  IS NOT EQUAL TO  'B'
  7220         GO TO 0640-AH-BENEFIT.
  7221
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 131
* EL1278.cbl
  7222*    IF WS-LF-SPECIAL-CALC-CD = 'L'
  7223*        ADD +1                  TO  CP-REMAINING-TERM
  7224*                                    CP-ORIGINAL-TERM.
  7225
  7226     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  7227     MOVE '2'                    TO  CP-EARNING-METHOD
  7228                                     CP-RATING-METHOD.
  7229     IF PI-COMPANY-ID = 'CID'
  7230        IF (CP-STATE-STD-ABBRV = 'MN')
  7231           AND (CM-CERT-EFF-DT > X'A4FF')
  7232           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  7233           MOVE '5'              TO CP-EARNING-METHOD
  7234           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  7235        END-IF
  7236     END-IF
  7237     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  7238                                     CP-REMAINING-BENEFIT
  7239                                     CP-RATING-BENEFIT-AMT.
  7240     IF CP-STATE-STD-ABBRV = 'OR'
  7241         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  7242                                         CM-LF-ALT-BENEFIT-AMT.
  7243     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  7244     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  7245
  7246     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT.
  7247
  7248     IF CP-ERROR-RATE-IS-ZERO
  7249       OR CP-ERROR-RATE-NOT-FOUND
  7250         MOVE ER-2740            TO  EMI-ERROR
  7251         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7252
  7253     IF CP-ERROR-RATE-FILE-NOTOPEN
  7254         MOVE ER-2617            TO  EMI-ERROR
  7255         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7256
  7257     ADD CP-CALC-REFUND          TO  WS-CALC-REFUND.
  7258
  7259     MOVE WS-CALC-REFUND         TO  HLREFNDO
  7260                                     WS-TOT-LF-RFND
  7261                                     PI-LF-REFUND-AMT.
  7262
  7263     MOVE CP-REFUND-TYPE-USED    TO  PI-LF-REFUND-METH.
  7264
  7265 0640-AH-BENEFIT.
  7266     IF CM-AH-BENEFIT-CD = '00'
  7267         GO TO 0680-CONTINUE.
  7268
  7269 0650-GET-AH-BENEFIT.
  7270     IF ACCT-FOUND
  7271         MOVE +1                 TO SUB3
  7272         PERFORM 6000-GET-AH-AM-REM-TERM THRU 6900-EXIT.
  7273     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7274     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7275     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7276     MOVE WS-AH-KIND             TO  HAEDESCO.
  7277     EVALUATE TRUE
  7278        WHEN ((OPEN-LF-CLAIM)
  7279           OR (CLOSED-LF-CLAIM))
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 132
* EL1278.cbl
  7280           AND (WS-AH-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7281           MOVE ZEROS            TO HAREFNDO  WS-CALC-REFUND
  7282                                    WS-TOT-AH-RFND
  7283                                    PI-AH-REFUND-AMT
  7284           MOVE SPACES           TO PI-AH-REFUND-METH
  7285           MOVE ER-2965          TO EMI-ERROR
  7286           PERFORM 9700-ERROR-FORMAT
  7287                                 THRU  9799-EXIT
  7288           GO TO 0680-CONTINUE
  7289        WHEN (CM-LF-BENEFIT-CD NOT = '00')
  7290           AND ((OPEN-LF-CLAIM) OR (CLOSED-LF-CLAIM))
  7291           AND (EMI-ERROR = ER-2965)
  7292           AND (WS-LF-CANCEL-DATE NOT = WS-LF-INCUR-DT)
  7293           MOVE ZEROS            TO HAREFNDO
  7294                                    WS-TOT-AH-RFND
  7295                                    PI-AH-REFUND-AMT
  7296           MOVE SPACES           TO PI-AH-REFUND-METH
  7297           GO TO 0680-CONTINUE
  7298        WHEN (OPEN-AH-CLAIM)
  7299           AND (WS-ST-REF-IND = '1')
  7300           MOVE ZEROS            TO HAREFNDO
  7301                                    WS-TOT-AH-RFND
  7302                                    PI-AH-REFUND-AMT
  7303           MOVE ER-3039          TO EMI-ERROR
  7304           PERFORM 9700-ERROR-FORMAT
  7305                                 THRU  9799-EXIT
  7306           GO TO 0680-CONTINUE
  7307        WHEN (OPEN-AH-CLAIM)
  7308           AND (WS-ST-REF-IND = '2' OR '3' OR '4')
  7309           MOVE ER-3037          TO EMI-ERROR
  7310           PERFORM 9700-ERROR-FORMAT
  7311                                 THRU  9799-EXIT
  7312*          CONTINUE
  7313        WHEN (OPEN-AH-CLAIM)
  7314           AND (WS-ST-REF-IND = '5')
  7315           MOVE ER-3038          TO EMI-ERROR
  7316           PERFORM 9700-ERROR-FORMAT
  7317                                 THRU  9799-EXIT
  7318*          CONTINUE
  7319        WHEN (OPEN-AH-CLAIM)
  7320           AND (WS-ST-REF-IND = ' ')
  7321           MOVE ER-2768          TO EMI-ERROR
  7322           PERFORM 9700-ERROR-FORMAT
  7323                                 THRU  9799-EXIT
  7324        WHEN (CLOSED-AH-CLAIM)
  7325           AND (WS-AH-CANCEL-DATE <= WS-AH-PAID-THRU-DT)
  7326           MOVE ZEROS            TO HAREFNDO
  7327                                    WS-TOT-AH-RFND
  7328                                    PI-AH-REFUND-AMT
  7329           MOVE ER-2756          TO EMI-ERROR
  7330           PERFORM 9700-ERROR-FORMAT
  7331                                 THRU  9799-EXIT
  7332           IF WS-TOT-LF-RFND > 0
  7333              MOVE ZEROS         TO HLREFNDO
  7334                                    WS-TOT-LF-RFND
  7335                                    PI-LF-REFUND-AMT
  7336              MOVE SPACES        TO PI-LF-REFUND-METH
  7337           END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 133
* EL1278.cbl
  7338           GO TO 0680-CONTINUE
  7339*       WHEN OTHER
  7340*          CONTINUE
  7341     END-EVALUATE
  7342     .
  7343 0660-GET-REM-TERM.
  7344     MOVE WS-CF-AH-OVERRIDE-L1   TO  CP-AH-OVERRIDE-CODE.
  7345     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  7346     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  7347     MOVE WS-AH-CANCEL-DATE      TO  CP-VALUATION-DT.
  7348     MOVE WS-AH-CANCEL-DATE-ED   TO  HACANCO.
  7349*****MOVE WS-BENEFIT-DESCRIP     TO  HADESCO.
  7350     MOVE WS-AH-KIND             TO  HAEDESCO.
  7351     MOVE CM-STATE               TO  CP-STATE.
  7352     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  7353     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  7354     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  7355     MOVE '2'                    TO  CP-PROCESS-TYPE.
  7356     MOVE PI-COMPANY-ID          TO  CP-COMPANY-ID.
  7357     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  7358     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  7359     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
  7360     MOVE WS-CF-CR-REM-TERM-CALC
  7361                                 TO  CP-REM-TERM-METHOD.
  7362
  7363     IF WS-AH-CO-REM-TERM-CALC  IS GREATER THAN  '0'
  7364         MOVE WS-AH-CO-REM-TERM-CALC
  7365                                 TO  CP-REM-TERM-METHOD.
  7366
  7367     IF WS-AH-ST-REM-TERM-CALC  IS GREATER THAN  '0'
  7368         MOVE WS-AH-ST-REM-TERM-CALC
  7369                                 TO  CP-REM-TERM-METHOD.
  7370
  7371     IF WS-AH-AM-REM-TERM-CALC  IS GREATER THAN  '0'
  7372         MOVE WS-AH-AM-REM-TERM-CALC
  7373                                 TO  CP-REM-TERM-METHOD.
  7374     IF (PI-COMPANY-ID = 'CID')
  7375        AND (CP-STATE-STD-ABBRV = 'WI')
  7376        MOVE '7'                 TO CP-REM-TERM-METHOD
  7377        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7378     END-IF
  7379     IF (PI-COMPANY-ID = 'CID')
  7380        AND (CP-STATE-STD-ABBRV = 'MO')
  7381        AND (CM-CERT-EFF-DT >= X'9B41')
  7382        AND (CM-CERT-EFF-DT <= X'A2FB')
  7383        MOVE '7'                 TO CP-REM-TERM-METHOD
  7384        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  7385     END-IF
  7386
  7387     MOVE CM-AH-ORIG-TERM        TO  HATERMO
  7388                                     CP-ORIGINAL-TERM
  7389                                     CP-LOAN-TERM.
  7390
  7391     IF  NOT  CP-TERM-IS-DAYS
  7392         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  7393             MOVE CM-PMT-EXTENSION-DAYS
  7394                                 TO  CP-TERM-OR-EXT-DAYS
  7395         ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 134
* EL1278.cbl
  7396             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  7397
  7398*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
  7399     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  7400     MOVE '3'                    TO  WS-CF-RECORD-TYPE.
  7401     MOVE CM-STATE               TO  WS-CF-ACCESS.
  7402     MOVE +0                     TO  WS-CF-SEQUENCE-NO.
  7403
  7404
  7405* EXEC CICS READ
  7406*        DATASET  (ELCNTL-ID)
  7407*        SET      (ADDRESS OF CONTROL-FILE)
  7408*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  7409*        RESP     (WS-RESPONSE)
  7410*    END-EXEC.
  7411*    MOVE '&"S        E          (  N#00007245' TO DFHEIV0
  7412     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7413     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7414     MOVE X'204E233030303037323435' TO DFHEIV0(25:11)
  7415     CALL 'kxdfhei1' USING DFHEIV0,
  7416           ELCNTL-ID,
  7417           DFHEIV20,
  7418           DFHEIV99,
  7419           WS-CF-CONTROL-PRIMARY,
  7420           DFHEIV99,
  7421           DFHEIV99,
  7422           DFHEIV99
  7423     SET ADDRESS OF CONTROL-FILE TO
  7424         DFHEIV20
  7425     MOVE EIBRESP  TO WS-RESPONSE
  7426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7427
  7428
  7429     IF WS-RESP-NOTOPEN
  7430         MOVE ER-2617            TO  EMI-ERROR
  7431         GO TO 0320-INPUT-ERROR.
  7432
  7433     IF WS-RESP-NOTFND
  7434         MOVE ZERO               TO CP-FREE-LOOK
  7435     ELSE
  7436         MOVE CF-ST-FREE-LOOK-PERIOD
  7437                                 TO CP-FREE-LOOK.
  7438
  7439     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT.
  7440
  7441     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7442
  7443     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '8'
  7444         IF CM-AH-CANCEL-DT  IS NOT EQUAL TO  LOW-VALUES
  7445             MOVE ER-0683        TO  EMI-ERROR
  7446             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7447
  7448     IF CM-AH-CURRENT-STATUS  IS EQUAL TO  '6'  OR  '7'
  7449         IF CM-AH-SETTLEMENT-DT  IS NOT EQUAL TO  LOW-VALUES
  7450             MOVE ER-0684        TO  EMI-ERROR
  7451             PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7452
  7453 0670-CONTINUE-AH.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 135
* EL1278.cbl
  7454     MOVE CM-AH-PREMIUM-AMT      TO  HAPREMO
  7455                                     WS-TOT-AH-PREM.
  7456     MOVE CP-REMAINING-TERM-1    TO  HAREMO.
  7457
  7458     IF CP-REMAINING-TERM-1  IS GREATER THAN  CM-AH-ORIG-TERM
  7459         MOVE CM-AH-ORIG-TERM    TO  HAREMO.
  7460
  7461     IF PI-AH-CANCEL-DATE = LOW-VALUES
  7462        GO TO 0680-CONTINUE.
  7463     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM.
  7464     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  7465     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  7466
  7467     IF WS-AH-ST-REFUND-CALC  IS GREATER THAN  ZERO
  7468         MOVE WS-AH-ST-REFUND-CALC
  7469                                 TO  CP-EARNING-METHOD.
  7470
  7471     IF WS-AH-FO-REFUND-CALC  IS GREATER THAN  ZERO
  7472         MOVE WS-AH-FO-REFUND-CALC
  7473                                 TO  CP-EARNING-METHOD.
  7474
  7475*    IF WS-AM-EARN-METHOD-A  IS GREATER THAN  ZERO
  7476*        MOVE WS-AM-EARN-METHOD-A
  7477*                                TO  CP-EARNING-METHOD.
  7478
  7479     if pi-company-id = 'AHL'
  7480        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
  7481        if cp-class-code = spaces
  7482           move zeros            to cp-class-code
  7483        end-if
  7484     ELSE
  7485        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  7486     END-IF
  7487     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  7488     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  7489                                     CP-RATING-BENEFIT-AMT.
  7490     IF CP-STATE-STD-ABBRV = 'OR'
  7491         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  7492                                         CM-AH-ORIG-TERM.
  7493     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  7494     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  7495     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  7496     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  7497     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  7498     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  7499
  7500     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  7501     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  7502     MOVE ' '                    TO  DC-OPTION-CODE.
  7503
  7504     PERFORM 9600-DATE-LINK.
  7505
  7506     IF CP-STATE-STD-ABBRV = 'OH'
  7507        IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7508         IF (CP-ORIGINAL-TERM  IS GREATER THAN  60)
  7509           AND (DC-GREG-DATE-1-YMD  IS GREATER THAN  '831101')
  7510           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  7511             MOVE '6'            TO  CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 136
* EL1278.cbl
  7512         END-IF
  7513        END-IF
  7514        IF PI-COMPANY-ID = 'CID'
  7515           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  7516                           LOW-VALUES)
  7517              IF CP-CRITICAL-PERIOD
  7518                 MOVE '2'       TO CP-EARNING-METHOD
  7519              ELSE
  7520                 MOVE '6'       TO CP-EARNING-METHOD
  7521              END-IF
  7522           ELSE
  7523              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  7524                 MOVE '2'       TO CP-EARNING-METHOD
  7525              ELSE
  7526                 IF ((CM-LF-ORIG-TERM > 60) AND
  7527                    (CM-RATE-CLASS NOT = 'L '))
  7528                               OR
  7529                    (WS-LF-CO-EARNINGS-CALC = '5')
  7530                    IF CP-CRITICAL-PERIOD
  7531                       MOVE '2'  TO CP-EARNING-METHOD
  7532                    ELSE
  7533                       MOVE '6'  TO CP-EARNING-METHOD
  7534                    END-IF
  7535                 ELSE
  7536                    MOVE '1'     TO CP-EARNING-METHOD
  7537                 END-IF
  7538              END-IF
  7539           END-IF
  7540        END-IF
  7541     END-IF
  7542
  7543     IF CP-STATE-STD-ABBRV = 'VA'
  7544       IF PI-COMPANY-ID NOT EQUAL 'NCL' AND 'CID'
  7545         IF DC-GREG-DATE-1-YMD  IS GREATER THAN  '921231'
  7546            IF CP-ORIGINAL-TERM  IS GREATER THAN  61
  7547                MOVE '6'            TO  CP-EARNING-METHOD
  7548            ELSE
  7549                MOVE '1'            TO  CP-EARNING-METHOD.
  7550
  7551     IF CP-EARN-AS-NET-PAY
  7552         IF CP-LOAN-APR NOT GREATER THAN ZEROS
  7553            IF WS-CF-DEFAULT-APR GREATER THAN ZEROS
  7554                MOVE WS-CF-DEFAULT-APR
  7555                                 TO  CP-LOAN-APR
  7556                MOVE ER-3780     TO  EMI-ERROR
  7557                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  7558            ELSE
  7559                MOVE ER-3781     TO  EMI-ERROR
  7560                PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7561     IF PI-COMPANY-ID = 'DCC'
  7562        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  7563           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  7564           MOVE 'S'              TO CP-EARNING-METHOD
  7565        END-IF
  7566     END-IF
  7567     MOVE PI-CANCEL-REASON       TO CP-CANCEL-REASON
  7568     IF (PI-COMPANY-ID = 'DCC')
  7569        AND (CP-EARNING-METHOD = 'D')
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 137
* EL1278.cbl
  7570        MOVE +0                  TO WS-DDF-ADMIN-FEES
  7571                                    WS-DDF-CSO-ADMIN-FEE
  7572                                    WS-DDF-1ST-YR-TOT-EXP
  7573                                    WS-DDF-COMM-AND-MFEE
  7574        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  7575           S1 > +10
  7576           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  7577              IF (AM-A-COM (S1) NUMERIC)
  7578                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  7579                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  7580              ELSE
  7581                 MOVE +0         TO WS-COMM-PCT C0
  7582                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  7583                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  7584              END-IF
  7585              IF AM-COM-TYP (S1) = 'L' OR 'N'
  7586                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  7587                    + WS-COMM-PCT
  7588              END-IF
  7589              IF AM-COM-TYP (S1) = 'N'
  7590                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
  7591                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  7592              END-IF
  7593              IF AM-COM-TYP (S1) = 'J' OR 'L'
  7594                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  7595                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  7596              END-IF
  7597              IF AM-COM-TYP (S1) = 'I'
  7598                 COMPUTE WS-DDF-COMM-AND-MFEE
  7599                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  7600              END-IF
  7601           END-IF
  7602        END-PERFORM
  7603        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  7604        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  7605        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  7606           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  7607     END-IF
  7608     IF (PI-COMPANY-ID = 'DCC')
  7609        AND (CP-EARNING-METHOD = 'D')
  7610        AND (PI-CANCEL-REASON NOT = 'R')
  7611        PERFORM 0730-GET-DDF-FACTORS
  7612                                 THRU 0730-EXIT
  7613        IF NOT PDEF-FOUND
  7614           MOVE ER-9999          TO EMI-ERROR
  7615           PERFORM 9700-ERROR-FORMAT
  7616                                 THRU 9799-EXIT
  7617           GO TO 8200-SEND-DATAONLY
  7618        END-IF
  7619        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  7620                                 TO CP-DDF-LO-FACT
  7621        MOVE PD-UEP-FACTOR (P1 P2)
  7622                                 TO CP-DDF-HI-FACT
  7623        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  7624        MOVE CM-AH-CLP           TO CP-DDF-CLP
  7625        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  7626        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  7627           + PD-1ST-YR-ADMIN-ALLOW
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 138
* EL1278.cbl
  7628        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  7629        IF PI-CLP-YN = 'Y'
  7630           MOVE 'C'              TO CP-DDF-SPEC-CALC
  7631           MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  7632                                    CP-DDF-CLP
  7633           MOVE ZEROS            TO CP-1ST-YR-ALLOW
  7634        END-IF
  7635        IF DD-IU-PRESENT
  7636           MOVE 'I'              TO CP-EARNING-METHOD
  7637        END-IF
  7638        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  7639                                    CP-CLP-RATE-UP
  7640        IF (CP-CALC-GROSS-FEE)
  7641           AND (CP-IU-RATE-UP NOT = ZEROS)
  7642           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  7643              / CP-ORIGINAL-PREMIUM)
  7644           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  7645              / (1 - TEX-FACT-8)
  7646        END-IF
  7647     END-IF
  7648     PERFORM 0800-LINK-REFUND  THRU  0899-EXIT
  7649
  7650     MOVE ' '                    TO  WS-REFUND-SEARCH-SW.
  7651
  7652     PERFORM 1400-GET-REFUND-TYPE  THRU  1499-EXIT.
  7653
  7654     IF CP-ERROR-RATE-IS-ZERO
  7655       OR CP-ERROR-RATE-NOT-FOUND
  7656         MOVE ER-2740            TO  EMI-ERROR
  7657         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7658
  7659     IF CP-ERROR-RATE-FILE-NOTOPEN
  7660         MOVE ER-2617            TO  EMI-ERROR
  7661         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  7662
  7663     MOVE ZEROS                  TO  WS-CALC-REFUND.
  7664     MOVE CP-CALC-REFUND         TO  HAREFNDO  WS-CALC-REFUND
  7665                                     WS-TOT-AH-RFND
  7666                                     PI-AH-REFUND-AMT.
  7667
  7668     MOVE CP-REFUND-TYPE-USED    TO  PI-AH-REFUND-METH.
  7669
  7670     MOVE AL-UANON               TO  HACANCA.
  7671
  7672 0680-CONTINUE.
  7673     IF BROWSE-STARTED
  7674         PERFORM 1500-END-BROWSE  THRU  1599-EXIT
  7675         MOVE SPACES             TO  WS-BROWSE-STARTED-SW.
  7676
  7677     IF CM-LF-BENEFIT-CD = '00'
  7678         MOVE -1                 TO  HACANCL
  7679     ELSE
  7680         MOVE -1                 TO  HLCANCL.
  7681
  7682     ADD WS-TOT-LF-PREM    WS-TOT-AH-PREM GIVING
  7683                           WS-TOT-PREM.
  7684     ADD WS-TOT-LF-RFND    WS-TOT-AH-RFND GIVING
  7685                           WS-TOT-RFND.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 139
* EL1278.cbl
  7686
  7687     MOVE WS-TOT-PREM            TO  TOPREMO.
  7688     MOVE WS-TOT-RFND            TO  TORFNDO.
  7689
  7690 0680-EXIT.
  7691     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 140
* EL1278.cbl
  7693 0700-LINK-REM-TERM SECTION.
  7694
  7695* EXEC CICS LINK
  7696*        PROGRAM   (ELRTRM-ID)
  7697*        COMMAREA  (CALCULATION-PASS-AREA)
  7698*        LENGTH    (CP-COMM-LENGTH)
  7699*    END-EXEC.
  7700*    MOVE '."C                   (   #00007517' TO DFHEIV0
  7701     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7702     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7703     MOVE X'2020233030303037353137' TO DFHEIV0(25:11)
  7704     CALL 'kxdfhei1' USING DFHEIV0,
  7705           ELRTRM-ID,
  7706           CALCULATION-PASS-AREA,
  7707           CP-COMM-LENGTH,
  7708           DFHEIV99,
  7709           DFHEIV99,
  7710           DFHEIV99,
  7711           DFHEIV99
  7712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7713
  7714
  7715 0700-EXIT.
  7716     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 141
* EL1278.cbl
  7718 0710-LINK-REM-AMOUNT SECTION.
  7719
  7720* EXEC CICS LINK
  7721*        PROGRAM   (ELRAMT-ID)
  7722*        COMMAREA  (CALCULATION-PASS-AREA)
  7723*        LENGTH    (CP-COMM-LENGTH)
  7724*    END-EXEC.
  7725*    MOVE '."C                   (   #00007527' TO DFHEIV0
  7726     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7727     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7728     MOVE X'2020233030303037353237' TO DFHEIV0(25:11)
  7729     CALL 'kxdfhei1' USING DFHEIV0,
  7730           ELRAMT-ID,
  7731           CALCULATION-PASS-AREA,
  7732           CP-COMM-LENGTH,
  7733           DFHEIV99,
  7734           DFHEIV99,
  7735           DFHEIV99,
  7736           DFHEIV99
  7737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7738
  7739
  7740 0710-EXIT.
  7741     EXIT.
  7742 0730-GET-DDF-FACTORS.
  7743     MOVE ' '                    TO WS-PDEF-RECORD-SW
  7744     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  7745     MOVE CM-STATE               TO ERPDEF-STATE
  7746     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  7747     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  7748     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  7749     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  7750     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  7751
  7752* EXEC CICS STARTBR
  7753*        DATASET  ('ERPDEF')
  7754*        RIDFLD   (ERPDEF-KEY)
  7755*        GTEQ
  7756*        RESP     (WS-RESPONSE)
  7757*    END-EXEC
  7758     MOVE 'ERPDEF' TO DFHEIV1
  7759     MOVE 0
  7760       TO DFHEIV11
  7761*    MOVE '&,         G          &  N#00007544' TO DFHEIV0
  7762     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7763     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7764     MOVE X'204E233030303037353434' TO DFHEIV0(25:11)
  7765     CALL 'kxdfhei1' USING DFHEIV0,
  7766           DFHEIV1,
  7767           ERPDEF-KEY,
  7768           DFHEIV99,
  7769           DFHEIV11,
  7770           DFHEIV99
  7771     MOVE EIBRESP  TO WS-RESPONSE
  7772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7773     IF NOT WS-RESP-NORMAL
  7774        GO TO 0730-EXIT
  7775     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 142
* EL1278.cbl
  7776     .
  7777 0730-READNEXT.
  7778
  7779* EXEC CICS READNEXT
  7780*       DATASET  ('ERPDEF')
  7781*       SET      (ADDRESS OF PRODUCT-MASTER)
  7782*       RIDFLD   (ERPDEF-KEY)
  7783*       RESP     (WS-RESPONSE)
  7784*    END-EXEC
  7785     MOVE 'ERPDEF' TO DFHEIV1
  7786     MOVE 0
  7787       TO DFHEIV11
  7788*    MOVE '&.S                   )  N#00007555' TO DFHEIV0
  7789     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7790     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7791     MOVE X'204E233030303037353535' TO DFHEIV0(25:11)
  7792     CALL 'kxdfhei1' USING DFHEIV0,
  7793           DFHEIV1,
  7794           DFHEIV20,
  7795           DFHEIV99,
  7796           ERPDEF-KEY,
  7797           DFHEIV99,
  7798           DFHEIV11,
  7799           DFHEIV99,
  7800           DFHEIV99
  7801     SET ADDRESS OF PRODUCT-MASTER TO
  7802         DFHEIV20
  7803     MOVE EIBRESP  TO WS-RESPONSE
  7804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7805     IF NOT WS-RESP-NORMAL
  7806        GO TO 0730-ENDBR
  7807     END-IF
  7808     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  7809        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  7810           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  7811        ELSE
  7812           GO TO 0730-READNEXT
  7813        END-IF
  7814     ELSE
  7815        GO TO 0730-ENDBR
  7816     END-IF
  7817     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7818        (P1 > +8)
  7819        OR (PD-PROD-CODE (P1) = 'I')
  7820     END-PERFORM
  7821     IF P1 < +9
  7822        SET DD-IU-PRESENT        TO TRUE
  7823     END-IF
  7824     IF CM-LOAN-TERM = ZEROS
  7825        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  7826     END-IF
  7827     IF PD-TRUNCATED = 'Y'
  7828        MOVE CM-LOAN-TERM        TO WS-TERM
  7829     ELSE
  7830        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  7831     END-IF
  7832     EVALUATE TRUE
  7833        WHEN WS-TERM > +168
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 143
* EL1278.cbl
  7834           MOVE 15               TO P1
  7835        WHEN WS-TERM > +156
  7836           MOVE 14               TO P1
  7837        WHEN WS-TERM > +144
  7838           MOVE 13               TO P1
  7839        WHEN WS-TERM > +132
  7840           MOVE 12               TO P1
  7841        WHEN WS-TERM > +120
  7842           MOVE 11               TO P1
  7843        WHEN WS-TERM > +108
  7844           MOVE 10               TO P1
  7845        WHEN WS-TERM > +96
  7846           MOVE 9                TO P1
  7847        WHEN WS-TERM > +84
  7848           MOVE 8                TO P1
  7849        WHEN WS-TERM > +72
  7850           MOVE 7                TO P1
  7851        WHEN WS-TERM > +60
  7852           MOVE 6                TO P1
  7853        WHEN WS-TERM > +48
  7854           MOVE 5                TO P1
  7855        WHEN WS-TERM > +36
  7856           MOVE 4                TO P1
  7857        WHEN WS-TERM > +24
  7858           MOVE 3                TO P1
  7859        WHEN WS-TERM > +12
  7860           MOVE 2                TO P1
  7861        WHEN OTHER
  7862           MOVE 1                TO P1
  7863     END-EVALUATE
  7864     EVALUATE TRUE
  7865*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  7866*          AND (DD-IU-PRESENT)
  7867*          MOVE 2                TO P2
  7868*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  7869*          MOVE 1                TO P2
  7870        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  7871           MOVE 2                TO P2
  7872        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  7873           MOVE 3                TO P2
  7874        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  7875           MOVE 4                TO P2
  7876        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  7877           MOVE 5                TO P2
  7878        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  7879           MOVE 6                TO P2
  7880        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  7881           MOVE 7                TO P2
  7882        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  7883           MOVE 8                TO P2
  7884        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  7885           MOVE 9                TO P2
  7886        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  7887           MOVE 10               TO P2
  7888        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  7889           MOVE 11               TO P2
  7890        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  7891           MOVE 12               TO P2
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 144
* EL1278.cbl
  7892        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  7893           MOVE 13               TO P2
  7894        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  7895           MOVE 14               TO P2
  7896        WHEN OTHER
  7897           MOVE 15               TO P2
  7898     END-EVALUATE
  7899     .
  7900 0730-ENDBR.
  7901
  7902* EXEC CICS ENDBR
  7903*       DATASET  ('ERPDEF')
  7904*    END-EXEC
  7905     MOVE 'ERPDEF' TO DFHEIV1
  7906     MOVE 0
  7907       TO DFHEIV11
  7908*    MOVE '&2                    $   #00007657' TO DFHEIV0
  7909     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7910     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7911     MOVE X'2020233030303037363537' TO DFHEIV0(25:11)
  7912     CALL 'kxdfhei1' USING DFHEIV0,
  7913           DFHEIV1,
  7914           DFHEIV11,
  7915           DFHEIV99
  7916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7917     .
  7918 0730-EXIT.
  7919     EXIT.
  7920 0740-GET-ERCTBL.
  7921     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7922     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7923     MOVE 'A'                    TO CTBL-BEN-TYPE
  7924     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  7925     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7926     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7927     IF WS-RESP-NORMAL
  7928        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7929     ELSE
  7930        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7931        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7932        MOVE 'A'                    TO CTBL-BEN-TYPE
  7933        MOVE 'AA'                   TO CTBL-BEN-CODE
  7934        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7935        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7936        IF WS-RESP-NORMAL
  7937           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7938        END-IF
  7939     END-IF
  7940     .
  7941 0740-EXIT.
  7942     EXIT.
  7943 0750-READ-ERCTBL.
  7944
  7945* EXEC CICS READ
  7946*         INTO    (COMM-TABLE-RECORD)
  7947*         DATASET ('ERCTBL')
  7948*         RIDFLD  (CTBL-KEY)
  7949*         RESP    (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 145
* EL1278.cbl
  7950*    END-EXEC
  7951     MOVE LENGTH OF
  7952      COMM-TABLE-RECORD
  7953       TO DFHEIV11
  7954     MOVE 'ERCTBL' TO DFHEIV1
  7955*    MOVE '&"IL       E          (  N#00007687' TO DFHEIV0
  7956     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7957     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7958     MOVE X'204E233030303037363837' TO DFHEIV0(25:11)
  7959     CALL 'kxdfhei1' USING DFHEIV0,
  7960           DFHEIV1,
  7961           COMM-TABLE-RECORD,
  7962           DFHEIV11,
  7963           CTBL-KEY,
  7964           DFHEIV99,
  7965           DFHEIV99,
  7966           DFHEIV99
  7967     MOVE EIBRESP  TO WS-RESPONSE
  7968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7969     .
  7970 0750-EXIT.
  7971     EXIT.
  7972 0760-FIND-COMM.
  7973     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  7974        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  7975        OR (C1 > +3)
  7976     END-PERFORM
  7977     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  7978        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  7979        OR (C2 > +3)
  7980     END-PERFORM
  7981     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  7982        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  7983        OR (C3 > +3)
  7984     END-PERFORM
  7985     IF C1 > +3
  7986        MOVE +1                  TO C1
  7987     END-IF
  7988     IF C2 > +3
  7989        MOVE +1                  TO C2
  7990     END-IF
  7991     IF C3 > +3
  7992        MOVE +1                  TO C3
  7993     END-IF
  7994     IF C1 = +3
  7995        MOVE +18                 TO C0
  7996     ELSE
  7997        IF C1 = +2
  7998           MOVE +9               TO C0
  7999        END-IF
  8000     END-IF
  8001     IF C2 = +3
  8002        ADD +6                   TO C0
  8003     ELSE
  8004        IF C2 = +2
  8005           ADD +3                TO C0
  8006        END-IF
  8007     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 146
* EL1278.cbl
  8008     ADD C3                      TO C0
  8009     MOVE CT-RT (C0)             TO WS-COMM-PCT
  8010     .
  8011 0760-EXIT.
  8012     EXIT.
  8013 0800-LINK-REFUND SECTION.
  8014     IF CP-AH
  8015       IF PI-EARNING-METHOD-AH NOT = SPACES
  8016         MOVE PI-EARNING-METHOD-AH   TO CP-EARNING-METHOD
  8017        ELSE
  8018         NEXT SENTENCE
  8019      ELSE
  8020       IF PI-EARNING-METHOD-LF NOT = SPACES
  8021         MOVE PI-EARNING-METHOD-LF   TO CP-EARNING-METHOD.
  8022
  8023
  8024* EXEC CICS LINK
  8025*        PROGRAM   (ELRFND-ID)
  8026*        COMMAREA  (CALCULATION-PASS-AREA)
  8027*        LENGTH    (CP-COMM-LENGTH)
  8028*    END-EXEC.
  8029*    MOVE '."C                   (   #00007747' TO DFHEIV0
  8030     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8031     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8032     MOVE X'2020233030303037373437' TO DFHEIV0(25:11)
  8033     CALL 'kxdfhei1' USING DFHEIV0,
  8034           ELRFND-ID,
  8035           CALCULATION-PASS-AREA,
  8036           CP-COMM-LENGTH,
  8037           DFHEIV99,
  8038           DFHEIV99,
  8039           DFHEIV99,
  8040           DFHEIV99
  8041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8042
  8043
  8044 0899-EXIT.
  8045     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 147
* EL1278.cbl
  8047 0900-READ-CERT-FILE  SECTION.
  8048
  8049* EXEC CICS HANDLE CONDITION
  8050*        NOTFND  (0910-NOT-FOUND)
  8051*    END-EXEC.
  8052*    MOVE '"$I                   ! # #00007757' TO DFHEIV0
  8053     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8054     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8055     MOVE X'2320233030303037373537' TO DFHEIV0(25:11)
  8056     CALL 'kxdfhei1' USING DFHEIV0
  8057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8058
  8059
  8060
  8061* EXEC CICS READ
  8062*        DATASET  (ELCERT-ID)
  8063*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8064*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8065*    END-EXEC.
  8066*    MOVE '&"S        E          (   #00007761' TO DFHEIV0
  8067     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8068     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8069     MOVE X'2020233030303037373631' TO DFHEIV0(25:11)
  8070     CALL 'kxdfhei1' USING DFHEIV0,
  8071           ELCERT-ID,
  8072           DFHEIV20,
  8073           DFHEIV99,
  8074           WS-CM-CONTROL-PRIMARY,
  8075           DFHEIV99,
  8076           DFHEIV99,
  8077           DFHEIV99
  8078     SET ADDRESS OF CERTIFICATE-MASTER TO
  8079         DFHEIV20
  8080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8081
  8082
  8083*    SERVICE RELOAD CERTIFICATE-MASTER.
  8084
  8085     GO TO 0999-EXIT.
  8086
  8087 0910-NOT-FOUND.
  8088     MOVE 'N'                    TO  WS-CERT-RECORD-SW.
  8089
  8090 0999-EXIT.
  8091     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 148
* EL1278.cbl
  8093 1000-READ-CONTROL  SECTION.
  8094
  8095* EXEC CICS HANDLE CONDITION
  8096*        NOTFND   (1010-NOTFND)
  8097*        NOTOPEN  (1020-NOTOPEN)
  8098*    END-EXEC.
  8099*    MOVE '"$IJ                  ! $ #00007778' TO DFHEIV0
  8100     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8101     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8102     MOVE X'2420233030303037373738' TO DFHEIV0(25:11)
  8103     CALL 'kxdfhei1' USING DFHEIV0
  8104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8105
  8106
  8107
  8108* EXEC CICS READ
  8109*        DATASET  (ELCNTL-ID)
  8110*        SET      (ADDRESS OF CONTROL-FILE)
  8111*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8112*        GTEQ
  8113*    END-EXEC.
  8114*    MOVE '&"S        G          (   #00007783' TO DFHEIV0
  8115     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8116     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8117     MOVE X'2020233030303037373833' TO DFHEIV0(25:11)
  8118     CALL 'kxdfhei1' USING DFHEIV0,
  8119           ELCNTL-ID,
  8120           DFHEIV20,
  8121           DFHEIV99,
  8122           WS-CF-CONTROL-PRIMARY,
  8123           DFHEIV99,
  8124           DFHEIV99,
  8125           DFHEIV99
  8126     SET ADDRESS OF CONTROL-FILE TO
  8127         DFHEIV20
  8128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8129
  8130
  8131*    SERVICE RELOAD CONTROL-FILE.
  8132
  8133     GO TO 1099-EXIT.
  8134
  8135 1010-NOTFND.
  8136     MOVE 'N'                    TO  WS-CNTL-RECORD-SW.
  8137
  8138     GO TO 1099-EXIT.
  8139
  8140 1020-NOTOPEN.
  8141     MOVE ER-2617                TO  EMI-ERROR.
  8142
  8143     GO TO 0320-INPUT-ERROR.
  8144
  8145 1099-EXIT.
  8146     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 149
* EL1278.cbl
  8148 1100-FIND-BENEFIT-IN-STATE  SECTION.
  8149     MOVE 'N'                    TO  BEN-SEARCH-SW.
  8150
  8151     PERFORM 1110-BENEFIT-DUMMY  THRU  1119-EXIT
  8152         VARYING  SUB3  FROM  1  BY  1
  8153             UNTIL  ((SUB3  IS GREATER THAN  50)
  8154               OR ((CF-ST-BENEFIT-CD (SUB3)
  8155                      IS EQUAL TO  WS-BEN-CD)
  8156               AND (WS-LOOKUP-TYPE
  8157                      IS EQUAL TO  CF-ST-BENEFIT-KIND (SUB3)))).
  8158
  8159     IF SUB3  IS NOT EQUAL TO  51
  8160         MOVE 'Y'                TO  BEN-SEARCH-SW.
  8161
  8162     GO TO 1199-EXIT.
  8163
  8164 1110-BENEFIT-DUMMY.
  8165
  8166 1119-EXIT.
  8167     EXIT.
  8168
  8169 1199-EXIT.
  8170     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 150
* EL1278.cbl
  8172 1200-START-ACCOUNT-MASTER  SECTION.
  8173
  8174* EXEC CICS HANDLE CONDITION
  8175*        NOTFND   (1290-ACCT-NOT-FOUND)
  8176*        ENDFILE  (1290-ACCT-NOT-FOUND)
  8177*    END-EXEC.
  8178*    MOVE '"$I''                  ! % #00007832' TO DFHEIV0
  8179     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8180     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8181     MOVE X'2520233030303037383332' TO DFHEIV0(25:11)
  8182     CALL 'kxdfhei1' USING DFHEIV0
  8183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8184
  8185
  8186     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8187
  8188
  8189* EXEC CICS STARTBR
  8190*        DATASET  (ERACCT-ID)
  8191*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8192*        GTEQ
  8193*    END-EXEC.
  8194     MOVE 0
  8195       TO DFHEIV11
  8196*    MOVE '&,         G          &   #00007839' TO DFHEIV0
  8197     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8198     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8199     MOVE X'2020233030303037383339' TO DFHEIV0(25:11)
  8200     CALL 'kxdfhei1' USING DFHEIV0,
  8201           ERACCT-ID,
  8202           WS-AM-CONTROL-PRIMARY,
  8203           DFHEIV99,
  8204           DFHEIV11,
  8205           DFHEIV99
  8206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8207
  8208
  8209     MOVE 'Y'                    TO  WS-BROWSE-STARTED-SW.
  8210     MOVE 'Y'                    TO  WS-ACCT-RECORD-SW.
  8211
  8212     GO TO 1299-EXIT.
  8213
  8214 1290-ACCT-NOT-FOUND.
  8215     MOVE ' '                    TO  WS-ACCT-RECORD-SW.
  8216
  8217 1299-EXIT.
  8218     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 151
* EL1278.cbl
  8220 1300-READ-ACCOUNT-MASTER  SECTION.
  8221
  8222* EXEC CICS HANDLE CONDITION
  8223*        NOTFND   (0580-ACCT-NOT-FOUND)
  8224*        ENDFILE  (0580-ACCT-NOT-FOUND)
  8225*    END-EXEC.
  8226*    MOVE '"$I''                  ! & #00007857' TO DFHEIV0
  8227     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8228     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8229     MOVE X'2620233030303037383537' TO DFHEIV0(25:11)
  8230     CALL 'kxdfhei1' USING DFHEIV0
  8231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8232
  8233
  8234
  8235* EXEC CICS READNEXT
  8236*        DATASET  (ERACCT-ID)
  8237*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8238*        RIDFLD   (WS-AM-CONTROL-PRIMARY)
  8239*    END-EXEC.
  8240     MOVE 0
  8241       TO DFHEIV11
  8242*    MOVE '&.S                   )   #00007862' TO DFHEIV0
  8243     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8244     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8245     MOVE X'2020233030303037383632' TO DFHEIV0(25:11)
  8246     CALL 'kxdfhei1' USING DFHEIV0,
  8247           ERACCT-ID,
  8248           DFHEIV20,
  8249           DFHEIV99,
  8250           WS-AM-CONTROL-PRIMARY,
  8251           DFHEIV99,
  8252           DFHEIV11,
  8253           DFHEIV99,
  8254           DFHEIV99
  8255     SET ADDRESS OF ACCOUNT-MASTER TO
  8256         DFHEIV20
  8257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8258
  8259
  8260*    SERVICE RELOAD ACCOUNT-MASTER.
  8261
  8262 1399-EXIT.
  8263     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 152
* EL1278.cbl
  8265 1400-GET-REFUND-TYPE  SECTION.
  8266     IF LIFE-REFUND-SEARCH
  8267         NEXT SENTENCE
  8268     ELSE
  8269         GO TO 1410-AH-REFUND-TYPE.
  8270
  8271     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8272         MOVE SPACES             TO  HLCALCO
  8273                                     HLCAL1O
  8274         GO TO 1499-EXIT.
  8275
  8276     MOVE CP-REFUND-TYPE-USED    TO  HLCAL1O.
  8277
  8278     EVALUATE TRUE
  8279        WHEN CP-R-AS-REPOSSESSION
  8280           MOVE 'REPOSSESSION'     TO  HLCALCO
  8281        WHEN CP-R-AS-R78
  8282           MOVE 'RULE 78'          TO  HLCALCO
  8283        WHEN  CP-R-AS-PRORATA
  8284           MOVE 'PRO RATA'         TO  HLCALCO
  8285        WHEN CP-R-AS-CALIF
  8286           MOVE 'CALIF'            TO  HLCALCO
  8287        WHEN CP-R-AS-TEXAS
  8288           MOVE 'IRREG'            TO  HLCALCO
  8289        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  8290           MOVE 'UTAH'             TO  HLCALCO
  8291        WHEN CP-R-AS-FARM-PLAN
  8292           MOVE 'FARM PLAN'        TO  HLCALCO
  8293        WHEN CP-R-AS-NET-PAY
  8294           MOVE 'NET PAY'          TO  HLCALCO
  8295        WHEN CP-R-AS-ANTICIPATION
  8296           MOVE 'ANTICIPATION'     TO  HLCALCO
  8297        WHEN CP-R-AS-MEAN
  8298           MOVE 'MEAN'             TO  HLCALCO
  8299        WHEN CP-R-AS-SUM-OF-DIGITS
  8300           MOVE 'SUM OF DIGIT'     TO  HLCALCO
  8301        WHEN OTHER
  8302           MOVE 'UNDEFINED'        TO  HLCALCO
  8303     END-EVALUATE.
  8304
  8305     GO TO 1499-EXIT.
  8306
  8307 1410-AH-REFUND-TYPE.
  8308     IF CP-REFUND-TYPE-USED  IS EQUAL TO  SPACE
  8309         MOVE SPACES             TO  HACALCO
  8310                                     HACAL1O
  8311         GO TO 1499-EXIT.
  8312
  8313     MOVE CP-REFUND-TYPE-USED    TO  HACAL1O.
  8314
  8315     EVALUATE TRUE
  8316        WHEN CP-R-AS-REPOSSESSION
  8317           MOVE 'REPOSSESSION'     TO HACALCO
  8318        WHEN CP-R-AS-R78
  8319           MOVE 'RULE 78'          TO HACALCO
  8320        WHEN CP-R-AS-PRORATA
  8321           MOVE 'PRO RATA'         TO HACALCO
  8322        WHEN CP-REFUND-TYPE-USED = '3'
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 153
* EL1278.cbl
  8323           MOVE 'CALIF'            TO HACALCO
  8324        WHEN CP-R-AS-TEXAS
  8325           MOVE 'IRREG'            TO HACALCO
  8326        WHEN CP-R-AS-FARM-PLAN
  8327           MOVE 'FARM PLAN'        TO HACALCO
  8328        WHEN CP-R-AS-NET-PAY
  8329           MOVE 'NET PAY'          TO HACALCO
  8330        WHEN CP-R-AS-ANTICIPATION
  8331           MOVE 'ANTICIPATION'     TO HACALCO
  8332        WHEN CP-R-AS-MEAN
  8333           MOVE 'MEAN'             TO HACALCO
  8334        WHEN CP-R-AS-SUM-OF-DIGITS
  8335           MOVE 'SUM OF DIGIT'     TO HACALCO
  8336        WHEN CP-GAP-ACTUARIAL
  8337           MOVE 'SP ACTUARIAL'     TO HACALCO
  8338        WHEN CP-R-AS-SPP-DDF
  8339           MOVE 'SPEC DDF'         TO HACALCO
  8340        WHEN CP-R-AS-SPP-DDF-IU
  8341           MOVE 'SPEC DDF IU'      TO HACALCO
  8342        WHEN OTHER
  8343           MOVE 'UNKNOWN'          TO HLCALCO
  8344     END-EVALUATE
  8345     .
  8346 1499-EXIT.
  8347     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 154
* EL1278.cbl
  8349 1500-END-BROWSE  SECTION.
  8350     IF BROWSE-STARTED
  8351
  8352* EXEC CICS ENDBR
  8353*            DATASET  (ERACCT-ID)
  8354*        END-EXEC.
  8355     MOVE 0
  8356       TO DFHEIV11
  8357*    MOVE '&2                    $   #00007959' TO DFHEIV0
  8358     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8359     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8360     MOVE X'2020233030303037393539' TO DFHEIV0(25:11)
  8361     CALL 'kxdfhei1' USING DFHEIV0,
  8362           ERACCT-ID,
  8363           DFHEIV11,
  8364           DFHEIV99
  8365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8366
  8367
  8368 1599-EXIT.
  8369     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 155
* EL1278.cbl
  8371 1600-LOCATE-BENEFIT  SECTION.
  8372
  8373* EXEC CICS HANDLE CONDITION
  8374*        NOTFND  (1699-EXIT)
  8375*    END-EXEC.
  8376*    MOVE '"$I                   ! '' #00007967' TO DFHEIV0
  8377     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8378     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8379     MOVE X'2720233030303037393637' TO DFHEIV0(25:11)
  8380     CALL 'kxdfhei1' USING DFHEIV0
  8381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8382
  8383
  8384     MOVE SPACES                 TO  WS-KIND.
  8385     MOVE ZERO                   TO  WS-NOT-FOUND.
  8386     MOVE PI-COMPANY-ID          TO  WS-CF-COMPANY-ID.
  8387     MOVE SPACES                 TO  WS-CF-STATE.
  8388     MOVE WS-BENEFIT-NO          TO  WS-CF-BENEFIT-NO.
  8389
  8390
  8391* EXEC CICS READ
  8392*        DATASET  (ELCNTL-ID)
  8393*        RIDFLD   (WS-CF-CONTROL-PRIMARY)
  8394*        SET      (ADDRESS OF CONTROL-FILE)
  8395*        GTEQ
  8396*    END-EXEC.
  8397*    MOVE '&"S        G          (   #00007977' TO DFHEIV0
  8398     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8399     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8400     MOVE X'2020233030303037393737' TO DFHEIV0(25:11)
  8401     CALL 'kxdfhei1' USING DFHEIV0,
  8402           ELCNTL-ID,
  8403           DFHEIV20,
  8404           DFHEIV99,
  8405           WS-CF-CONTROL-PRIMARY,
  8406           DFHEIV99,
  8407           DFHEIV99,
  8408           DFHEIV99
  8409     SET ADDRESS OF CONTROL-FILE TO
  8410         DFHEIV20
  8411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8412
  8413
  8414*    SERVICE RELOAD CONTROL-FILE.
  8415
  8416     IF WS-CF-COMPANY-ID  IS NOT EQUAL TO  CF-COMPANY-ID
  8417       OR WS-CF-RECORD-TYPE  IS NOT EQUAL TO  CF-RECORD-TYPE
  8418         GO TO 1699-EXIT.
  8419
  8420     MOVE +1                     TO  WS-INDEX.
  8421
  8422 1610-LOOKUP-BENEFIT.
  8423     IF WS-BENEFIT-NO  IS EQUAL TO  CF-BENEFIT-CODE (WS-INDEX)
  8424         MOVE CF-BENEFIT-ALPHA (WS-INDEX)
  8425                                 TO  WS-KIND
  8426         MOVE CF-SPECIAL-CALC-CD (WS-INDEX)
  8427                                 TO  WS-CALC-CD
  8428         MOVE CF-BENEFIT-DESCRIP (WS-INDEX)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 156
* EL1278.cbl
  8429                                 TO  WS-BENEFIT-DESCRIP
  8430         MOVE +1                 TO  WS-NOT-FOUND
  8431         GO TO 1699-EXIT.
  8432
  8433     IF CF-BENEFIT-CODE (WS-INDEX)
  8434             IS NOT LESS THAN  CF-HI-BEN-IN-REC
  8435         GO TO 1699-EXIT.
  8436
  8437     IF WS-INDEX  IS LESS THAN  +8
  8438         ADD +1                  TO  WS-INDEX
  8439         GO TO 1610-LOOKUP-BENEFIT.
  8440
  8441 1699-EXIT.
  8442     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 157
* EL1278.cbl
  8444 1700-WRITE-CERT-NOTE      SECTION.
  8445     IF NOT MODIFY-CERT-CAP
  8446         MOVE 'UPDATE'           TO  SM-READ
  8447         PERFORM 9800-SECURITY-VIOLATION  THRU  9899-EXIT
  8448         MOVE ER-0070            TO  EMI-ERROR
  8449         PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT
  8450         GO TO 8200-SEND-DATAONLY.
  8451
  8452**MOVE CANCEL QUOTE NOTE INFO
  8453     IF PI-LF-REFUND-AMT NUMERIC
  8454        MOVE PI-LF-REFUND-AMT    TO WS-CN-LIFE-AMT-RF
  8455        MOVE PI-LF-REFUND-METH   TO WS-CN-LF-REF-METH
  8456     ELSE
  8457        MOVE ZERO                TO WS-CN-LIFE-AMT-RF
  8458                                    PI-LF-REFUND-AMT
  8459        MOVE SPACE               TO WS-CN-LF-REF-METH
  8460                                    PI-LF-REFUND-METH.
  8461
  8462     IF PI-AH-REFUND-AMT NUMERIC
  8463        MOVE PI-AH-REFUND-AMT    TO WS-CN-AH-AMT-RF
  8464        MOVE PI-AH-REFUND-METH   TO WS-CN-AH-REF-METH
  8465     ELSE
  8466        MOVE ZERO                TO WS-CN-AH-AMT-RF
  8467                                    PI-AH-REFUND-AMT
  8468        MOVE SPACE               TO WS-CN-AH-REF-METH
  8469                                    PI-AH-REFUND-METH.
  8470
  8471     COMPUTE PI-TOTAL-REFUND-AMT = PI-LF-REFUND-AMT +
  8472                                   PI-AH-REFUND-AMT.
  8473
  8474     MOVE PI-TOTAL-REFUND-AMT    TO WS-CN-TOTAL-RF.
  8475
  8476     MOVE SAVE-DATE              TO WS-CN-DT-QUOTED.
  8477     MOVE PI-PROCESSOR-ID        TO WS-CN-PROCESSOR-ID.
  8478     IF PI-LF-CANCEL-DATE-ED NOT EQUAL SPACE
  8479        MOVE PI-LF-CANCEL-DATE-ED
  8480                                 TO WS-CN-CANCEL-DT
  8481     ELSE
  8482        MOVE PI-AH-CANCEL-DATE-ED
  8483                                 TO WS-CN-CANCEL-DT
  8484     END-IF
  8485     MOVE 'CZ'                   TO CERT-NOTE-FILE
  8486     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD
  8487     MOVE PI-CARRIER             TO CZ-CARRIER
  8488     MOVE PI-GROUPING            TO CZ-GROUPING
  8489     MOVE PI-STATE               TO CZ-STATE
  8490     MOVE PI-ACCOUNT             TO CZ-ACCOUNT
  8491     MOVE PI-CERT-EFF-DT         TO CZ-CERT-EFF-DT
  8492     MOVE PI-CERT-PRIME          TO CZ-CERT-PRIME
  8493     MOVE PI-CERT-SFX            TO CZ-CERT-SFX
  8494     MOVE '1'                    TO CZ-RECORD-TYPE
  8495     MOVE +1                     TO CZ-NOTE-SEQUENCE
  8496     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER
  8497     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS
  8498     MOVE SAVE-BIN-DATE          TO CZ-LAST-MAINT-DT
  8499     MOVE WS-CAN-QUOTE-NOTE      TO CZ-NOTE-INFORMATION
  8500     MOVE ' '                    TO WS-STOP-SW
  8501     PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 158
* EL1278.cbl
  8502
  8503* EXEC CICS WRITE
  8504*           FROM      (CERT-NOTE-FILE)
  8505*           DATASET   (ERNOTE-ID)
  8506*           RIDFLD    (CZ-CONTROL-PRIMARY)
  8507*           RESP      (WS-RESPONSE)
  8508*       END-EXEC
  8509     MOVE LENGTH OF
  8510      CERT-NOTE-FILE
  8511       TO DFHEIV11
  8512*    MOVE '&$ L                  ''  N#00008072' TO DFHEIV0
  8513     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8514     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8515     MOVE X'204E233030303038303732' TO DFHEIV0(25:11)
  8516     CALL 'kxdfhei1' USING DFHEIV0,
  8517           ERNOTE-ID,
  8518           CERT-NOTE-FILE,
  8519           DFHEIV11,
  8520           CZ-CONTROL-PRIMARY,
  8521           DFHEIV99,
  8522           DFHEIV99
  8523     MOVE EIBRESP  TO WS-RESPONSE
  8524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8525        IF WS-RESP-DUPREC
  8526           ADD +1                TO CZ-NOTE-SEQUENCE
  8527        ELSE
  8528           SET I-SAY-TO-STOP     TO TRUE
  8529        END-IF
  8530     END-PERFORM
  8531     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8532     IF WS-RESP-NORMAL
  8533        EVALUATE CM-NOTE-SW
  8534           WHEN '1'
  8535           WHEN '3'
  8536           WHEN '5'
  8537           WHEN '7'
  8538              SET NO-CERT-RW     TO TRUE
  8539           WHEN ' '
  8540              MOVE '1'           TO CM-NOTE-SW
  8541           WHEN '2'
  8542              MOVE '3'           TO CM-NOTE-SW
  8543           WHEN '4'
  8544              MOVE '5'           TO CM-NOTE-SW
  8545           WHEN '6'
  8546              MOVE '7'           TO CM-NOTE-SW
  8547        END-EVALUATE
  8548     END-IF
  8549     IF NOT NO-CERT-RW
  8550        PERFORM 1810-REWRITE-ELCERT
  8551                                 THRU 1810-EXIT
  8552     ELSE
  8553
  8554* EXEC CICS UNLOCK
  8555*          DATASET    (ELCERT-ID)
  8556*       END-EXEC
  8557*    MOVE '&*                    #   #00008106' TO DFHEIV0
  8558     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8559     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 159
* EL1278.cbl
  8560     MOVE X'2020233030303038313036' TO DFHEIV0(25:11)
  8561     CALL 'kxdfhei1' USING DFHEIV0,
  8562           ELCERT-ID,
  8563           DFHEIV99
  8564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8565     END-IF
  8566     MOVE ER-8160                TO EMI-ERROR.
  8567     PERFORM 9700-ERROR-FORMAT  THRU  9799-EXIT.
  8568     GO TO 8200-SEND-DATAONLY.
  8569
  8570 1799-EXIT.
  8571     EXIT.
  8572 1800-READ-ELCERT-UPDATE.
  8573     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8574     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8575     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8576     MOVE PI-STATE               TO  WS-CM-STATE.
  8577     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  8578     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8579     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8580     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8581
  8582* EXEC CICS READ
  8583*        UPDATE
  8584*        DATASET  (ELCERT-ID)
  8585*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8586*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8587*        RESP     (WS-RESPONSE)
  8588*    END-EXEC
  8589*    MOVE '&"S        EU         (  N#00008125' TO DFHEIV0
  8590     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8591     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8592     MOVE X'204E233030303038313235' TO DFHEIV0(25:11)
  8593     CALL 'kxdfhei1' USING DFHEIV0,
  8594           ELCERT-ID,
  8595           DFHEIV20,
  8596           DFHEIV99,
  8597           WS-CM-CONTROL-PRIMARY,
  8598           DFHEIV99,
  8599           DFHEIV99,
  8600           DFHEIV99
  8601     SET ADDRESS OF CERTIFICATE-MASTER TO
  8602         DFHEIV20
  8603     MOVE EIBRESP  TO WS-RESPONSE
  8604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8605     .
  8606 1800-EXIT.
  8607     EXIT.
  8608 1810-REWRITE-ELCERT.
  8609
  8610* EXEC CICS REWRITE
  8611*        FROM      (CERTIFICATE-MASTER)
  8612*        DATASET   (ELCERT-ID)
  8613*        RESP     (WS-RESPONSE)
  8614*    END-EXEC.
  8615     MOVE LENGTH OF
  8616      CERTIFICATE-MASTER
  8617       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 160
* EL1278.cbl
  8618*    MOVE '&& L                  %  N#00008136' TO DFHEIV0
  8619     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8620     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8621     MOVE X'204E233030303038313336' TO DFHEIV0(25:11)
  8622     CALL 'kxdfhei1' USING DFHEIV0,
  8623           ELCERT-ID,
  8624           CERTIFICATE-MASTER,
  8625           DFHEIV11,
  8626           DFHEIV99
  8627     MOVE EIBRESP  TO WS-RESPONSE
  8628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8629
  8630     .
  8631 1810-EXIT.
  8632     EXIT.
  8633 4000-GEN-CANCEL-TRANS.
  8634     PERFORM 4400-ADD-ORIG-REC THRU 4400-EXIT
  8635
  8636     MOVE '2'                    TO CG-OPTION-CODE
  8637     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
  8638     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
  8639     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
  8640     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
  8641     MOVE PI-CARRIER             TO CG-CERT-CARRIER
  8642     MOVE PI-GROUPING            TO CG-CERT-GROUP
  8643     MOVE PI-STATE               TO CG-CERT-STATE
  8644     MOVE PI-ACCOUNT             TO CG-CERT-ACCOUNT
  8645     MOVE PI-CERT-EFF-DT         TO CG-CERT-EFF-DT
  8646     MOVE PI-CERT-NO             TO CG-CERT-CERT-NO
  8647     MOVE SAVE-BIN-DATE          TO CG-CURRENT-DT
  8648     MOVE ZEROS                  TO CG-LF-BENCD
  8649                                    CG-AH-BENCD
  8650                                    CG-LF-CAN-AMT
  8651                                    CG-AH-CAN-AMT
  8652     MOVE LOW-VALUES             TO CG-LF-CAN-DT
  8653                                    CG-AH-CAN-DT
  8654     MOVE SPACES                 TO CG-BATCH-NO
  8655     IF CM-LF-BENEFIT-CD NOT = '00' AND '  ' AND 'DD'
  8656       AND (CM-LF-CANCEL-DT = LOW-VALUES OR SPACES)
  8657        IF (PI-LF-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8658           MOVE CM-LF-BENEFIT-CD  TO CG-LF-BENCD
  8659           MOVE PI-LF-REFUND-AMT  TO CG-LF-CAN-AMT
  8660           MOVE PI-LF-CANCEL-DATE TO CG-LF-CAN-DT
  8661        END-IF
  8662     END-IF
  8663     IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  8664       AND (CM-AH-CANCEL-DT = LOW-VALUES OR SPACES)
  8665        IF (PI-AH-CANCEL-DATE NOT = LOW-VALUES AND SPACES)
  8666           MOVE CM-AH-BENEFIT-CD  TO CG-AH-BENCD
  8667           MOVE PI-AH-REFUND-AMT  TO CG-AH-CAN-AMT
  8668           MOVE PI-AH-CANCEL-DATE TO CG-AH-CAN-DT
  8669        END-IF
  8670     END-IF
  8671
  8672* EXEC CICS LINK
  8673*        PROGRAM  ('ELCANC')
  8674*        COMMAREA (CANCEL-GEN-PASS-AREA)
  8675*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 161
* EL1278.cbl
  8676     MOVE LENGTH OF
  8677      CANCEL-GEN-PASS-AREA
  8678       TO DFHEIV11
  8679     MOVE 'ELCANC' TO DFHEIV1
  8680*    MOVE '."C                   (   #00008182' TO DFHEIV0
  8681     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8682     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8683     MOVE X'2020233030303038313832' TO DFHEIV0(25:11)
  8684     CALL 'kxdfhei1' USING DFHEIV0,
  8685           DFHEIV1,
  8686           CANCEL-GEN-PASS-AREA,
  8687           DFHEIV11,
  8688           DFHEIV99,
  8689           DFHEIV99,
  8690           DFHEIV99,
  8691           DFHEIV99
  8692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8693     IF CG-SUCCESS
  8694        CONTINUE
  8695     ELSE
  8696        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
  8697        move '3'                 to emi-switch1
  8698        MOVE CG-ERROR-CODE       TO EMI-TEXT-VARIABLE (1)
  8699        EVALUATE TRUE
  8700           WHEN CG-DATE-ERROR
  8701             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8702           WHEN CG-CERT-NOT-FOUND
  8703             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8704           WHEN CG-AMOUNT-ERROR
  8705             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8706           WHEN CG-OPTION-ERROR
  8707             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8708           WHEN CG-PREV-CAN
  8709             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8710           WHEN CG-INVALID-DATA
  8711             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8712           WHEN CG-NO-ACCT-MSTR
  8713             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8714           WHEN CG-SFX-A-EXIST
  8715             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8716           WHEN CG-MISC-ERROR
  8717             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
  8718           WHEN OTHER
  8719             move ' error - elcanc - return '
  8720                                 to emi-error-text (1) (12:25)
  8721        END-EVALUATE
  8722        go to 8200-send-dataonly
  8723     end-if
  8724     .
  8725 4000-exit.
  8726     exit.
  8727
  8728 4400-ADD-ORIG-REC.
  8729
  8730     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD.
  8731     MOVE PI-CARRIER             TO  WS-CM-CARRIER.
  8732     MOVE PI-GROUPING            TO  WS-CM-GROUPING.
  8733     MOVE PI-STATE               TO  WS-CM-STATE.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 162
* EL1278.cbl
  8734     MOVE PI-ACCOUNT             TO  WS-CM-ACCOUNT.
  8735     MOVE PI-CERT-EFF-DT         TO  WS-CM-CERT-EFF-DT.
  8736     MOVE PI-CERT-PRIME          TO  WS-CM-CERT-PRIME.
  8737     MOVE PI-CERT-SFX            TO  WS-CM-CERT-SFX.
  8738
  8739
  8740* EXEC CICS READ
  8741*        DATASET  (ELCERT-ID)
  8742*        RIDFLD   (WS-CM-CONTROL-PRIMARY)
  8743*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8744*        RESP     (WS-RESPONSE)
  8745*    END-EXEC
  8746*    MOVE '&"S        E          (  N#00008232' TO DFHEIV0
  8747     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8748     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8749     MOVE X'204E233030303038323332' TO DFHEIV0(25:11)
  8750     CALL 'kxdfhei1' USING DFHEIV0,
  8751           ELCERT-ID,
  8752           DFHEIV20,
  8753           DFHEIV99,
  8754           WS-CM-CONTROL-PRIMARY,
  8755           DFHEIV99,
  8756           DFHEIV99,
  8757           DFHEIV99
  8758     SET ADDRESS OF CERTIFICATE-MASTER TO
  8759         DFHEIV20
  8760     MOVE EIBRESP  TO WS-RESPONSE
  8761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8762     IF WS-RESP-NORMAL
  8763         CONTINUE
  8764     ELSE
  8765        MOVE ER-0142                TO EMI-ERROR
  8766        PERFORM 9700-ERROR-FORMAT THRU 9799-EXIT
  8767        GO TO 8100-SEND-INITIAL-MAP
  8768     END-IF
  8769
  8770******************************************************************
  8771*            A D D   O R I G   C E R T   I N F O                 *
  8772******************************************************************
  8773
  8774     display ' made it to add orig cert ' WS-CM-CONTROL-PRIMARY
  8775
  8776     MOVE WS-CM-CONTROL-PRIMARY  TO WS-MA-CONTROL-PRIMARY
  8777     MOVE ' '                    TO WS-ERMAIL-SW
  8778
  8779
  8780* EXEC CICS READ
  8781*       DATASET   ('ERMAIL')
  8782*       SET       (ADDRESS OF MAILING-DATA)
  8783*       RIDFLD    (WS-MA-CONTROL-PRIMARY)
  8784*       RESP      (WS-RESPONSE)
  8785*    END-EXEC
  8786     MOVE 'ERMAIL' TO DFHEIV1
  8787*    MOVE '&"S        E          (  N#00008255' TO DFHEIV0
  8788     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8789     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8790     MOVE X'204E233030303038323535' TO DFHEIV0(25:11)
  8791     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 163
* EL1278.cbl
  8792           DFHEIV1,
  8793           DFHEIV20,
  8794           DFHEIV99,
  8795           WS-MA-CONTROL-PRIMARY,
  8796           DFHEIV99,
  8797           DFHEIV99,
  8798           DFHEIV99
  8799     SET ADDRESS OF MAILING-DATA TO
  8800         DFHEIV20
  8801     MOVE EIBRESP  TO WS-RESPONSE
  8802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8803
  8804     IF WS-RESP-NORMAL
  8805        SET ERMAIL-FOUND TO TRUE
  8806     END-IF
  8807
  8808     MOVE WS-CM-CONTROL-PRIMARY TO ELCRTO-KEY (1:33)
  8809     MOVE 'I'                 TO ELCRTO-RECORD-TYPE
  8810     MOVE +0                  TO ELCRTO-SEQ-NO
  8811
  8812
  8813* EXEC CICS READ
  8814*       DATASET   ('ELCRTO')
  8815*       SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  8816*       RIDFLD    (ELCRTO-KEY)
  8817*       GTEQ
  8818*       RESP      (WS-RESPONSE)
  8819*    END-EXEC
  8820     MOVE 'ELCRTO' TO DFHEIV1
  8821*    MOVE '&"S        G          (  N#00008270' TO DFHEIV0
  8822     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8823     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8824     MOVE X'204E233030303038323730' TO DFHEIV0(25:11)
  8825     CALL 'kxdfhei1' USING DFHEIV0,
  8826           DFHEIV1,
  8827           DFHEIV20,
  8828           DFHEIV99,
  8829           ELCRTO-KEY,
  8830           DFHEIV99,
  8831           DFHEIV99,
  8832           DFHEIV99
  8833     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  8834         DFHEIV20
  8835     MOVE EIBRESP  TO WS-RESPONSE
  8836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8837
  8838     display ' just read gteq ' ws-response
  8839     IF WS-RESP-NORMAL
  8840        AND (OC-CONTROL-PRIMARY (1:33) =
  8841                 WS-CM-CONTROL-PRIMARY)
  8842        AND (OC-RECORD-TYPE = 'I')
  8843        display ' resp norm, key =, type i '
  8844        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
  8845
  8846* EXEC CICS READ
  8847*             DATASET   ('ELCRTO')
  8848*             SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  8849*             RIDFLD    (OC-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 164
* EL1278.cbl
  8850*             UPDATE
  8851*             RESP      (WS-RESPONSE)
  8852*          END-EXEC
  8853     MOVE 'ELCRTO' TO DFHEIV1
  8854*    MOVE '&"S        EU         (  N#00008285' TO DFHEIV0
  8855     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8856     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8857     MOVE X'204E233030303038323835' TO DFHEIV0(25:11)
  8858     CALL 'kxdfhei1' USING DFHEIV0,
  8859           DFHEIV1,
  8860           DFHEIV20,
  8861           DFHEIV99,
  8862           OC-CONTROL-PRIMARY,
  8863           DFHEIV99,
  8864           DFHEIV99,
  8865           DFHEIV99
  8866     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  8867         DFHEIV20
  8868     MOVE EIBRESP  TO WS-RESPONSE
  8869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8870           DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
  8871           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
  8872           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  8873           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  8874           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  8875           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  8876           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  8877           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  8878           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  8879           IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  8880            (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  8881               MOVE SPACES             TO OC-LF-BENCD
  8882               MOVE ZEROS              TO OC-LF-TERM
  8883                                          OC-LF-BEN-AMT
  8884                                          OC-LF-PRM-AMT
  8885                                          OC-LF-ALT-BEN-AMT
  8886                                          OC-LF-ALT-PRM-AMT
  8887                                          OC-LF-COMM-PCT
  8888                                          OC-LF-CANCEL-AMT
  8889               MOVE LOW-VALUES         TO OC-LF-EXP-DT
  8890               MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  8891           ELSE
  8892               MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
  8893               MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
  8894               MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
  8895               MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
  8896               MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
  8897               MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
  8898               MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
  8899               MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
  8900               MOVE PI-LF-REFUND-AMT       TO OC-LF-CANCEL-AMT
  8901               MOVE PI-LF-CANCEL-DATE      TO OC-LF-CANCEL-DT
  8902           END-IF
  8903           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  8904           IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  8905            (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  8906               MOVE SPACES             TO OC-AH-BENCD
  8907               MOVE ZEROS              TO OC-AH-TERM
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 165
* EL1278.cbl
  8908                                          OC-AH-BEN-AMT
  8909                                          OC-AH-PRM-AMT
  8910                                          OC-AH-COMM-PCT
  8911                                          OC-AH-CANCEL-AMT
  8912                                          OC-AH-CP
  8913               MOVE LOW-VALUES         TO OC-AH-EXP-DT
  8914               MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  8915           ELSE
  8916               MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  8917               MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  8918               MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  8919               MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  8920               MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  8921               MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  8922               MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  8923               MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  8924               MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  8925           END-IF
  8926           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  8927           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  8928           MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  8929           MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  8930           MOVE EIBDATE                TO DC-JULIAN-YYDDD
  8931           MOVE '5'                    TO DC-OPTION-CODE
  8932           PERFORM 9600-DATE-LINK
  8933           MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  8934           IF ERMAIL-FOUND
  8935               MOVE MA-CRED-BENE-NAME
  8936                           TO OC-CRED-BENE-NAME
  8937           END-IF
  8938
  8939* EXEC CICS REWRITE
  8940*             DATASET   ('ELCRTO')
  8941*             FROM      (ORIGINAL-CERTIFICATE)
  8942*             RESP      (WS-RESPONSE)
  8943*          END-EXEC
  8944     MOVE LENGTH OF
  8945      ORIGINAL-CERTIFICATE
  8946       TO DFHEIV11
  8947     MOVE 'ELCRTO' TO DFHEIV1
  8948*    MOVE '&& L                  %  N#00008360' TO DFHEIV0
  8949     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8950     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8951     MOVE X'204E233030303038333630' TO DFHEIV0(25:11)
  8952     CALL 'kxdfhei1' USING DFHEIV0,
  8953           DFHEIV1,
  8954           ORIGINAL-CERTIFICATE,
  8955           DFHEIV11,
  8956           DFHEIV99
  8957     MOVE EIBRESP  TO WS-RESPONSE
  8958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8959           display ' just rewrote ' ws-response
  8960           IF NOT WS-RESP-NORMAL
  8961              MOVE ER-3830          TO EMI-ERROR
  8962              PERFORM 9700-ERROR-FORMAT
  8963                                 THRU 9799-EXIT
  8964              GO TO 8200-SEND-DATAONLY
  8965           END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 166
* EL1278.cbl
  8966
  8967           GO TO 4400-EXIT
  8968
  8969        ELSE
  8970           SUBTRACT +1 FROM OC-KEY-SEQ-NO
  8971        END-IF
  8972     ELSE
  8973        MOVE SPACES              TO ORIGINAL-CERTIFICATE
  8974        MOVE 'OC'                TO OC-RECORD-ID
  8975        MOVE WS-CM-CONTROL-PRIMARY TO OC-CONTROL-PRIMARY (1:33)
  8976        MOVE 'I'                 TO OC-RECORD-TYPE
  8977        MOVE +4096               TO OC-KEY-SEQ-NO
  8978     END-IF
  8979
  8980     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
  8981     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  8982     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  8983     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  8984     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  8985     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  8986     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  8987     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  8988     IF ((PI-LF-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  8989      (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  8990         MOVE SPACES             TO OC-LF-BENCD
  8991         MOVE ZEROS              TO OC-LF-TERM
  8992                                    OC-LF-BEN-AMT
  8993                                    OC-LF-PRM-AMT
  8994                                    OC-LF-ALT-BEN-AMT
  8995                                    OC-LF-ALT-PRM-AMT
  8996                                    OC-LF-COMM-PCT
  8997                                    OC-LF-CANCEL-AMT
  8998         MOVE LOW-VALUES         TO OC-LF-EXP-DT
  8999         MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  9000     ELSE
  9001         MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
  9002         MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
  9003         MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
  9004         MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
  9005         MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
  9006         MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
  9007         MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
  9008         MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
  9009         MOVE PI-LF-REFUND-AMT   TO OC-LF-CANCEL-AMT
  9010         MOVE PI-LF-CANCEL-DATE  TO OC-LF-CANCEL-DT
  9011     END-IF
  9012     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
  9013     IF ((PI-AH-CANCEL-DATE = SPACES OR LOW-VALUES) AND
  9014      (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
  9015         MOVE SPACES             TO OC-AH-BENCD
  9016         MOVE ZEROS              TO OC-AH-TERM
  9017                                    OC-AH-BEN-AMT
  9018                                    OC-AH-PRM-AMT
  9019                                    OC-AH-COMM-PCT
  9020                                    OC-AH-CANCEL-AMT
  9021                                    OC-AH-CP
  9022         MOVE LOW-VALUES         TO OC-AH-EXP-DT
  9023         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 167
* EL1278.cbl
  9024     ELSE
  9025         MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
  9026         MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  9027         MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  9028         MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  9029         MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  9030         MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  9031         MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  9032         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  9033         MOVE PI-AH-REFUND-AMT   TO OC-AH-CANCEL-AMT
  9034         MOVE PI-AH-CANCEL-DATE  TO OC-AH-CANCEL-DT
  9035     END-IF
  9036     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
  9037     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  9038     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  9039     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  9040     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  9041     MOVE '5'                    TO DC-OPTION-CODE
  9042     PERFORM 9600-DATE-LINK
  9043     MOVE DC-BIN-DATE-1          TO OC-LAST-MAINT-DT
  9044     IF ERMAIL-FOUND
  9045         MOVE MA-CRED-BENE-NAME
  9046                     TO OC-CRED-BENE-NAME
  9047     END-IF
  9048     MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
  9049     .
  9050 4400-WRITE-ELCRTO.
  9051
  9052
  9053* EXEC CICS WRITE
  9054*       DATASET   ('ELCRTO')
  9055*       FROM      (ORIGINAL-CERTIFICATE)
  9056*       RIDFLD    (OC-CONTROL-PRIMARY)
  9057*       RESP      (WS-RESPONSE)
  9058*    END-EXEC
  9059     MOVE LENGTH OF
  9060      ORIGINAL-CERTIFICATE
  9061       TO DFHEIV11
  9062     MOVE 'ELCRTO' TO DFHEIV1
  9063*    MOVE '&$ L                  ''  N#00008458' TO DFHEIV0
  9064     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9065     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9066     MOVE X'204E233030303038343538' TO DFHEIV0(25:11)
  9067     CALL 'kxdfhei1' USING DFHEIV0,
  9068           DFHEIV1,
  9069           ORIGINAL-CERTIFICATE,
  9070           DFHEIV11,
  9071           OC-CONTROL-PRIMARY,
  9072           DFHEIV99,
  9073           DFHEIV99
  9074     MOVE EIBRESP  TO WS-RESPONSE
  9075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9076
  9077    IF WS-RESP-DUPKEY OR WS-RESP-DUPREC
  9078        SUBTRACT +1    FROM OC-KEY-SEQ-NO
  9079        GO TO 4400-WRITE-ELCRTO
  9080    ELSE
  9081        IF NOT WS-RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 168
* EL1278.cbl
  9082           MOVE ER-3830          TO EMI-ERROR
  9083           PERFORM 9700-ERROR-FORMAT
  9084                                 THRU 9799-EXIT
  9085           GO TO 8200-SEND-DATAONLY
  9086        END-IF
  9087    END-IF
  9088
  9089     .
  9090 4400-EXIT.
  9091    EXIT.
  9092
  9093
  9094 5000-GET-LF-AM-REM-TERM.
  9095     MOVE +1                     TO SUB3.
  9096
  9097 5100-GET-LF-AM-REM-TERM.
  9098     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9099        IF CM-LF-BENEFIT-CD = AM-BENEFIT-CODE (SUB3)
  9100           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9101                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9102           GO TO 5300-MOVE-LF-REM-TERM.
  9103
  9104     IF SUB3 LESS THAN +20
  9105        ADD +1                   TO SUB3
  9106        GO TO 5100-GET-LF-AM-REM-TERM.
  9107
  9108     MOVE +1                     TO SUB3.
  9109
  9110     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9111         GO TO 5200-EDIT-FOR-NINETY-LF.
  9112
  9113 5100-GET-LF-DMD-AM-REM-TERM.
  9114
  9115     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1
  9116        IF CM-LF-BENEFIT-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9117           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9118                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9119           GO TO 5300-MOVE-LF-REM-TERM.
  9120
  9121     IF SUB3 LESS THAN +30
  9122        ADD +1                   TO SUB3
  9123        GO TO 5100-GET-LF-DMD-AM-REM-TERM.
  9124
  9125     MOVE +1                     TO SUB3.
  9126
  9127 5200-EDIT-FOR-NINETY-LF.
  9128
  9129***************************************************************
  9130*                                                             *
  9131*    NINETY BENEFIT PLAN TYPES:                               *
  9132*                                                             *
  9133*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9134*      92 = ALL GROUP REDUCING BENEFITS                       *
  9135*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  9136*      94 = ALL GROUP LEVEL BENEFITS                          *
  9137*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9138*           BENEFIT CONTROLS.                                 *
  9139*      99 = ALL BENEFITS                                      *
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 169
* EL1278.cbl
  9140*                                                             *
  9141***************************************************************
  9142
  9143     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9144                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9145
  9146     IF (AM-BENEFIT-CODE (SUB3) = '99')
  9147       AND
  9148        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9149           GO TO 5300-MOVE-LF-REM-TERM.
  9150
  9151     IF (AM-BENEFIT-CODE (SUB3) = '91')
  9152       AND
  9153        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9154        IF CF-REDUCING (WS-INDEX)
  9155           IF CM-INDIVIDUAL
  9156               GO TO 5300-MOVE-LF-REM-TERM.
  9157
  9158     IF (AM-BENEFIT-CODE (SUB3) = '92')
  9159       AND
  9160        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9161        IF CF-REDUCING (WS-INDEX)
  9162           IF CM-GROUP
  9163               GO TO 5300-MOVE-LF-REM-TERM.
  9164
  9165     IF (AM-BENEFIT-CODE (SUB3) = '93')
  9166       AND
  9167        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9168        IF CF-LEVEL (WS-INDEX)
  9169           IF CM-INDIVIDUAL
  9170               GO TO 5300-MOVE-LF-REM-TERM.
  9171
  9172     IF (AM-BENEFIT-CODE (SUB3) = '94')
  9173       AND
  9174        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9175        IF CF-LEVEL (WS-INDEX)
  9176           IF CM-GROUP
  9177               GO TO 5300-MOVE-LF-REM-TERM.
  9178
  9179     IF (AM-BENEFIT-CODE (SUB3) = '98')
  9180       AND
  9181        (AM-BENEFIT-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9182            GO TO 5300-MOVE-LF-REM-TERM.
  9183
  9184     IF SUB3 LESS THAN +20
  9185        ADD +1           TO SUB3
  9186          GO TO 5200-EDIT-FOR-NINETY-LF.
  9187
  9188     MOVE SPACES         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9189
  9190     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9191         MOVE '0'                 TO WS-LF-AM-REM-TERM-CALC
  9192         GO TO 5900-EXIT.
  9193
  9194     MOVE 1                       TO SUB3.
  9195
  9196 5200-EDIT-FOR-DMD-NINETY-LF.
  9197
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 170
* EL1278.cbl
  9198     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9199                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9200
  9201     IF (AM-BENEFIT-DMD-CODE (SUB3) = '99')
  9202       AND
  9203        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9204           GO TO 5300-MOVE-LF-REM-TERM.
  9205
  9206     IF (AM-BENEFIT-DMD-CODE (SUB3) = '91')
  9207       AND
  9208        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9209        IF CF-REDUCING (WS-INDEX)
  9210           IF CM-INDIVIDUAL
  9211               GO TO 5300-MOVE-LF-REM-TERM.
  9212
  9213     IF (AM-BENEFIT-DMD-CODE (SUB3) = '92')
  9214       AND
  9215        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9216        IF CF-REDUCING (WS-INDEX)
  9217           IF CM-GROUP
  9218               GO TO 5300-MOVE-LF-REM-TERM.
  9219
  9220     IF (AM-BENEFIT-DMD-CODE (SUB3) = '93')
  9221       AND
  9222        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9223        IF CF-LEVEL (WS-INDEX)
  9224           IF CM-INDIVIDUAL
  9225               GO TO 5300-MOVE-LF-REM-TERM.
  9226
  9227     IF (AM-BENEFIT-DMD-CODE (SUB3) = '94')
  9228       AND
  9229        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9230        IF CF-LEVEL (WS-INDEX)
  9231           IF CM-GROUP
  9232               GO TO 5300-MOVE-LF-REM-TERM.
  9233
  9234     IF (AM-BENEFIT-DMD-CODE (SUB3) = '98')
  9235       AND
  9236        (AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-LIFE-OVERRIDE-L1)
  9237            GO TO 5300-MOVE-LF-REM-TERM.
  9238
  9239     IF SUB3 LESS THAN +30
  9240        ADD +1                   TO SUB3
  9241          GO TO 5200-EDIT-FOR-DMD-NINETY-LF.
  9242
  9243     MOVE '0'                    TO WS-LF-AM-REM-TERM-CALC.
  9244
  9245     GO TO 5900-EXIT.
  9246
  9247 5300-MOVE-LF-REM-TERM.
  9248     MOVE WS-SAVE-BENEFIT-REM-TERM
  9249                                 TO WS-LF-AM-REM-TERM-CALC.
  9250
  9251 5900-EXIT.
  9252      EXIT.
  9253
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 171
* EL1278.cbl
  9255
  9256 6000-GET-AH-AM-REM-TERM.
  9257     MOVE +1                     TO SUB3.
  9258
  9259 6100-GET-AH-AM-REM-TERM.
  9260
  9261     IF AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9262        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB3)
  9263           MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9264                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9265           GO TO 6300-MOVE-AH-REM-TERM.
  9266
  9267     IF SUB3 LESS THAN +20
  9268        ADD +1                   TO SUB3
  9269        GO TO 6100-GET-AH-AM-REM-TERM.
  9270
  9271     MOVE +1                     TO SUB3.
  9272
  9273     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9274         GO TO 6200-EDIT-FOR-NINETY-AH.
  9275
  9276 6100-GET-AH-AM-DMD-REM-TERM.
  9277     IF AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9278        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB3)
  9279           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9280                         TO WS-SAVE-ALLOWABLE-BENEFIT
  9281           GO TO 6300-MOVE-AH-REM-TERM.
  9282
  9283     IF SUB3 LESS THAN +30
  9284        ADD +1                   TO SUB3
  9285        GO TO 6100-GET-AH-AM-DMD-REM-TERM.
  9286
  9287     MOVE +1                     TO SUB3.
  9288
  9289 6200-EDIT-FOR-NINETY-AH.
  9290
  9291***************************************************************
  9292*                                                             *
  9293*    NINETY BENEFIT PLAN TYPES:                               *
  9294*                                                             *
  9295*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9296*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9297*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9298*           BENEFIT CONTROLS.                                 *
  9299*      99 = ALL BENEFITS.                                     *
  9300*                                                             *
  9301***************************************************************
  9302
  9303     MOVE AM-ALLOWABLE-BENEFITS (SUB3)
  9304                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9305
  9306     IF AM-BENEFIT-CODE (SUB3) = '99'
  9307       AND
  9308        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9309           GO TO 6300-MOVE-AH-REM-TERM.
  9310
  9311     IF AM-BENEFIT-CODE (SUB3) = '91'
  9312       AND
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 172
* EL1278.cbl
  9313        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9314           IF CM-INDIVIDUAL
  9315               GO TO 6300-MOVE-AH-REM-TERM.
  9316
  9317     IF AM-BENEFIT-CODE (SUB3) = '92'
  9318       AND
  9319        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9320           IF CM-GROUP
  9321               GO TO 6300-MOVE-AH-REM-TERM.
  9322
  9323     IF AM-BENEFIT-CODE (SUB3) = '98'
  9324       AND
  9325        AM-BENEFIT-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9326           GO TO 6300-MOVE-AH-REM-TERM.
  9327
  9328     IF SUB3 LESS THAN +20
  9329        ADD +1                    TO SUB3
  9330        GO TO 6200-EDIT-FOR-NINETY-AH.
  9331
  9332     MOVE +1                      TO SUB3.
  9333
  9334     IF PI-COMPANY-ID NOT EQUAL 'DMD'
  9335         MOVE '0'                 TO WS-AH-AM-REM-TERM-CALC
  9336         GO TO 6900-EXIT.
  9337
  9338 6200-EDIT-FOR-DMD-NINETY-AH.
  9339
  9340     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB3)
  9341                         TO WS-SAVE-ALLOWABLE-BENEFIT.
  9342
  9343     IF AM-BENEFIT-DMD-CODE (SUB3) = '99'
  9344       AND
  9345        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9346           GO TO 6300-MOVE-AH-REM-TERM.
  9347
  9348     IF AM-BENEFIT-DMD-CODE (SUB3) = '91'
  9349       AND
  9350        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9351           IF CM-INDIVIDUAL
  9352               GO TO 6300-MOVE-AH-REM-TERM.
  9353
  9354     IF AM-BENEFIT-DMD-CODE (SUB3) = '92'
  9355       AND
  9356        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9357           IF CM-GROUP
  9358               GO TO 6300-MOVE-AH-REM-TERM.
  9359
  9360     IF AM-BENEFIT-DMD-CODE (SUB3) = '98'
  9361       AND
  9362        AM-BENEFIT-DMD-TYPE (SUB3) = WS-CF-AH-OVERRIDE-L1
  9363           GO TO 6300-MOVE-AH-REM-TERM.
  9364
  9365     IF SUB3 LESS THAN +30
  9366        ADD +1                   TO SUB3
  9367        GO TO 6200-EDIT-FOR-DMD-NINETY-AH.
  9368
  9369     MOVE '0'                    TO WS-AH-AM-REM-TERM-CALC.
  9370
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 173
* EL1278.cbl
  9371     GO TO 6900-EXIT.
  9372
  9373 6300-MOVE-AH-REM-TERM.
  9374
  9375     MOVE WS-SAVE-BENEFIT-REM-TERM
  9376                                 TO WS-AH-AM-REM-TERM-CALC.
  9377
  9378 6900-EXIT.
  9379      EXIT.
  9380
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 174
* EL1278.cbl
  9382 7000-GET-ERFORM     SECTION.
  9383
  9384* EXEC CICS HANDLE CONDITION
  9385*        NOTFND  (7000-EXIT)
  9386*    END-EXEC.
  9387*    MOVE '"$I                   ! ( #00008771' TO DFHEIV0
  9388     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9389     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9390     MOVE X'2820233030303038373731' TO DFHEIV0(25:11)
  9391     CALL 'kxdfhei1' USING DFHEIV0
  9392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9393
  9394
  9395     MOVE ' '                    TO  WS-FORM-RECORD-SW.
  9396     MOVE PI-COMPANY-CD          TO  WS-FO-COMPANY-CD.
  9397     MOVE PI-STATE               TO  WS-FO-STATE.
  9398     MOVE CM-POLICY-FORM-NO      TO  WS-FO-FORM-ID.
  9399     MOVE CM-CERT-EFF-DT         TO  WS-FO-EXP-DT.
  9400
  9401
  9402* EXEC CICS READ
  9403*        DATASET  (ERFORM-ID)
  9404*        RIDFLD   (WS-FO-CONTROL-PRIMARY)
  9405*        SET      (ADDRESS OF FORM-MASTER)
  9406*        GTEQ
  9407*    END-EXEC.
  9408*    MOVE '&"S        G          (   #00008781' TO DFHEIV0
  9409     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9410     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9411     MOVE X'2020233030303038373831' TO DFHEIV0(25:11)
  9412     CALL 'kxdfhei1' USING DFHEIV0,
  9413           ERFORM-ID,
  9414           DFHEIV20,
  9415           DFHEIV99,
  9416           WS-FO-CONTROL-PRIMARY,
  9417           DFHEIV99,
  9418           DFHEIV99,
  9419           DFHEIV99
  9420     SET ADDRESS OF FORM-MASTER TO
  9421         DFHEIV20
  9422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9423
  9424
  9425     IF PI-COMPANY-CD     EQUAL FO-COMPANY-CD AND
  9426        PI-STATE          EQUAL FO-STATE      AND
  9427        CM-POLICY-FORM-NO EQUAL FO-FORM-ID
  9428         MOVE 'Y'  TO WS-FORM-RECORD-SW
  9429         GO TO 7000-EXIT.
  9430 7000-EXIT.
  9431     EXIT.
  9432 7100-BENEFIT-SEARCH SECTION.
  9433
  9434     IF CM-LF-BENEFIT-CD NOT = ZEROS AND SPACES
  9435        MOVE +1                  TO  SUB4
  9436        PERFORM 7150-BENEFIT-LIFE-SEARCH THRU 7150-EXIT.
  9437
  9438     IF CM-AH-BENEFIT-CD NOT = ZEROS AND SPACES
  9439        MOVE +1                  TO  SUB4
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 175
* EL1278.cbl
  9440        PERFORM 7250-BENEFIT-AH-SEARCH THRU 7250-EXIT.
  9441 7100-EXIT.
  9442     EXIT.
  9443 7150-BENEFIT-LIFE-SEARCH.
  9444     IF PI-LIFE-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9445       IF CM-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9446         IF (CM-LF-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9447          OR CM-LF-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9448            IF FO-PLAN-REFUND-METHOD (SUB4)
  9449                    IS GREATER THAN SPACES
  9450               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9451                                    WS-LF-FO-REFUND-CALC
  9452               GO TO 7150-EXIT.
  9453
  9454     IF SUB4 LESS THAN +40
  9455         ADD +1              TO SUB4
  9456         GO TO 7150-BENEFIT-LIFE-SEARCH.
  9457
  9458 7150-EXIT.
  9459     EXIT.
  9460 7250-BENEFIT-AH-SEARCH.
  9461     IF PI-AH-OVERRIDE-L1 EQUAL TO FO-PLAN-TYPE (SUB4)
  9462       IF CM-AH-BENEFIT-CD EQUAL TO FO-PLAN-ID (SUB4)
  9463         IF (CM-AH-ORIG-TERM IS LESS THAN FO-PLAN-TERM (SUB4)
  9464          OR CM-AH-ORIG-TERM IS EQUAL TO FO-PLAN-TERM (SUB4))
  9465            IF FO-PLAN-REFUND-METHOD (SUB4)
  9466                    IS GREATER THAN SPACES
  9467               MOVE FO-PLAN-REFUND-METHOD (SUB4) TO
  9468                                    WS-AH-FO-REFUND-CALC
  9469               GO TO 7250-EXIT.
  9470
  9471     IF SUB4 LESS THAN +40
  9472         ADD +1              TO SUB4
  9473         GO TO 7250-BENEFIT-AH-SEARCH.
  9474
  9475 7250-EXIT.
  9476     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 176
* EL1278.cbl
  9478
  9479 8100-SEND-INITIAL-MAP  SECTION.
  9480     MOVE SAVE-DATE              TO  HDATEO.
  9481     MOVE EIBTIME                TO  TIME-IN.
  9482     MOVE TIME-OUT               TO  HTIMEO.
  9483     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9484     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9485     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9486     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9487
  9488     IF CM-LF-BENEFIT-CD = '00'
  9489         MOVE -1                 TO  HACANCL
  9490     ELSE
  9491         MOVE -1                 TO  HLCANCL.
  9492
  9493     IF PI-COMPANY-ID NOT = 'DCC'
  9494        MOVE AL-SADOF            TO CANREAHA
  9495                                    CLPYNHA
  9496                                    CANREAA
  9497                                    CLPYNA
  9498     END-IF
  9499
  9500
  9501* EXEC CICS SEND
  9502*        FROM    (EL127HO)
  9503*        MAPSET  (MAPSET-NAME)
  9504*        MAP     (MAP-NAME)
  9505*        CURSOR
  9506*        ERASE
  9507*    END-EXEC.
  9508     MOVE LENGTH OF
  9509      EL127HO
  9510       TO DFHEIV12
  9511     MOVE -1
  9512       TO DFHEIV11
  9513*    MOVE '8$     CT  E    H L F ,   #00008863' TO DFHEIV0
  9514     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9515     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9516     MOVE X'2020233030303038383633' TO DFHEIV0(25:11)
  9517     CALL 'kxdfhei1' USING DFHEIV0,
  9518           MAP-NAME,
  9519           EL127HO,
  9520           DFHEIV12,
  9521           MAPSET-NAME,
  9522           DFHEIV99,
  9523           DFHEIV99,
  9524           DFHEIV99,
  9525           DFHEIV11,
  9526           DFHEIV99,
  9527           DFHEIV99,
  9528           DFHEIV99
  9529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9530
  9531
  9532     GO TO 9000-RETURN-TRAN.
  9533
  9534 8200-SEND-DATAONLY  SECTION.
  9535     IF FIRST-ENTRY
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 177
* EL1278.cbl
  9536         GO TO 8100-SEND-INITIAL-MAP.
  9537
  9538     MOVE SAVE-DATE              TO  HDATEO.
  9539     MOVE EIBTIME                TO  TIME-IN.
  9540     MOVE TIME-OUT               TO  HTIMEO.
  9541     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9542     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9543     MOVE EMI-MESSAGE-AREA (1)   TO  HERMSG1O.
  9544     MOVE EMI-MESSAGE-AREA (2)   TO  HERMSG2O.
  9545     MOVE -1                     TO  HLCANCL.
  9546
  9547
  9548* EXEC CICS SEND DATAONLY
  9549*        FROM    (EL127HO)
  9550*        MAPSET  (MAPSET-NAME)
  9551*        MAP     (MAP-NAME)
  9552*        CURSOR
  9553*    END-EXEC.
  9554     MOVE LENGTH OF
  9555      EL127HO
  9556       TO DFHEIV12
  9557     MOVE -1
  9558       TO DFHEIV11
  9559*    MOVE '8$D    CT       H L F ,   #00008886' TO DFHEIV0
  9560     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9561     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9562     MOVE X'2020233030303038383836' TO DFHEIV0(25:11)
  9563     CALL 'kxdfhei1' USING DFHEIV0,
  9564           MAP-NAME,
  9565           EL127HO,
  9566           DFHEIV12,
  9567           MAPSET-NAME,
  9568           DFHEIV99,
  9569           DFHEIV99,
  9570           DFHEIV99,
  9571           DFHEIV11,
  9572           DFHEIV99,
  9573           DFHEIV99,
  9574           DFHEIV99
  9575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9576
  9577
  9578     GO TO 9000-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 178
* EL1278.cbl
  9580 8300-SEND-TEXT  SECTION.
  9581
  9582* EXEC CICS SEND TEXT
  9583*        FROM    (LOGOFF-TEXT)
  9584*        LENGTH  (LOGOFF-LENGTH)
  9585*        ERASE
  9586*        FREEKB
  9587*    END-EXEC.
  9588*    MOVE '8&      T  E F  H   F -   #00008896' TO DFHEIV0
  9589     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9590     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9591     MOVE X'2020233030303038383936' TO DFHEIV0(25:11)
  9592     CALL 'kxdfhei1' USING DFHEIV0,
  9593           LOGOFF-TEXT,
  9594           LOGOFF-LENGTH,
  9595           DFHEIV99,
  9596           DFHEIV99,
  9597           DFHEIV99,
  9598           DFHEIV99,
  9599           DFHEIV99,
  9600           DFHEIV99,
  9601           DFHEIV99,
  9602           DFHEIV99,
  9603           DFHEIV99,
  9604           DFHEIV99
  9605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9606
  9607
  9608
  9609* EXEC CICS RETURN
  9610*    END-EXEC.
  9611*    MOVE '.(                    ''   #00008903' TO DFHEIV0
  9612     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9613     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9614     MOVE X'2020233030303038393033' TO DFHEIV0(25:11)
  9615     CALL 'kxdfhei1' USING DFHEIV0,
  9616           DFHEIV99,
  9617           DFHEIV99,
  9618           DFHEIV99,
  9619           DFHEIV99,
  9620           DFHEIV99,
  9621           DFHEIV99
  9622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9623
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 179
* EL1278.cbl
  9625 8600-DEEDIT  SECTION.
  9626
  9627* EXEC CICS BIF DEEDIT
  9628*        FIELD   (DEEDIT-FIELD)
  9629*        LENGTH  (15)
  9630*    END-EXEC.
  9631     MOVE 15
  9632       TO DFHEIV11
  9633*    MOVE '@"L                   #   #00008907' TO DFHEIV0
  9634     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9635     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9636     MOVE X'2020233030303038393037' TO DFHEIV0(25:11)
  9637     CALL 'kxdfhei1' USING DFHEIV0,
  9638           DEEDIT-FIELD,
  9639           DFHEIV11
  9640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9641
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 180
* EL1278.cbl
  9643 8700-UNAUTHORIZED-ACCESS  SECTION.
  9644     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  9645
  9646     GO TO 8300-SEND-TEXT.
  9647
  9648 8800-PF23  SECTION.
  9649     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  9650     MOVE XCTL-005               TO  PGM-NAME.
  9651
  9652     GO TO 9200-XCTL.
  9653
  9654 8900-RETURN-CICS  SECTION.
  9655
  9656* EXEC CICS RETURN
  9657*    END-EXEC.
  9658*    MOVE '.(                    ''   #00008924' TO DFHEIV0
  9659     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9660     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9661     MOVE X'2020233030303038393234' TO DFHEIV0(25:11)
  9662     CALL 'kxdfhei1' USING DFHEIV0,
  9663           DFHEIV99,
  9664           DFHEIV99,
  9665           DFHEIV99,
  9666           DFHEIV99,
  9667           DFHEIV99,
  9668           DFHEIV99
  9669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9670
  9671
  9672 9000-RETURN-TRAN  SECTION.
  9673     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  9674     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  9675
  9676
  9677* EXEC CICS RETURN
  9678*        TRANSID   (TRANS-ID)
  9679*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  9680*        LENGTH    (PI-COMM-LENGTH)
  9681*    END-EXEC.
  9682*    MOVE '.(CT                  ''   #00008931' TO DFHEIV0
  9683     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9684     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9685     MOVE X'2020233030303038393331' TO DFHEIV0(25:11)
  9686     CALL 'kxdfhei1' USING DFHEIV0,
  9687           TRANS-ID,
  9688           PROGRAM-INTERFACE-BLOCK,
  9689           PI-COMM-LENGTH,
  9690           DFHEIV99,
  9691           DFHEIV99,
  9692           DFHEIV99
  9693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9694
  9695
  9696 9100-RETURN-MAIN-MENU  SECTION.
  9697     MOVE XCTL-126               TO  PGM-NAME.
  9698
  9699     GO TO 9200-XCTL.
  9700
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 181
* EL1278.cbl
  9701 9200-XCTL  SECTION.
  9702
  9703* EXEC CICS XCTL
  9704*        PROGRAM   (PGM-NAME)
  9705*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  9706*        LENGTH    (PI-COMM-LENGTH)
  9707*    END-EXEC.
  9708*    MOVE '.$C                   %   #00008943' TO DFHEIV0
  9709     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9710     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9711     MOVE X'2020233030303038393433' TO DFHEIV0(25:11)
  9712     CALL 'kxdfhei1' USING DFHEIV0,
  9713           PGM-NAME,
  9714           PROGRAM-INTERFACE-BLOCK,
  9715           PI-COMM-LENGTH,
  9716           DFHEIV99
  9717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9718
  9719
  9720 9300-CLEAR  SECTION.
  9721     MOVE ' '                    TO  PI-PEND-SW.
  9722     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  9723
  9724     GO TO 9200-XCTL.
  9725
  9726 9400-PF12  SECTION.
  9727     MOVE XCTL-010               TO  PGM-NAME.
  9728
  9729     GO TO 9200-XCTL.
  9730
  9731 9500-PGMID-ERROR  SECTION.
  9732
  9733* EXEC CICS HANDLE CONDITION
  9734*        PGMIDERR  (8300-SEND-TEXT)
  9735*    END-EXEC.
  9736*    MOVE '"$L                   ! ) #00008961' TO DFHEIV0
  9737     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9738     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9739     MOVE X'2920233030303038393631' TO DFHEIV0(25:11)
  9740     CALL 'kxdfhei1' USING DFHEIV0
  9741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9742
  9743
  9744     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  9745     MOVE ' '                    TO  PI-ENTRY-CD-1.
  9746     MOVE XCTL-005               TO  PGM-NAME.
  9747     MOVE PGM-NAME               TO  LOGOFF-PGM.
  9748     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  9749
  9750     GO TO 9200-XCTL.
  9751
  9752 9600-DATE-LINK  SECTION.
  9753     MOVE LINK-ELDATCV           TO  PGM-NAME
  9754
  9755
  9756* EXEC CICS LINK
  9757*        PROGRAM   (PGM-NAME)
  9758*        COMMAREA  (DATE-CONVERSION-DATA)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 182
* EL1278.cbl
  9759*        LENGTH    (DC-COMM-LENGTH)
  9760*    END-EXEC.
  9761*    MOVE '."C                   (   #00008976' TO DFHEIV0
  9762     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9763     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9764     MOVE X'2020233030303038393736' TO DFHEIV0(25:11)
  9765     CALL 'kxdfhei1' USING DFHEIV0,
  9766           PGM-NAME,
  9767           DATE-CONVERSION-DATA,
  9768           DC-COMM-LENGTH,
  9769           DFHEIV99,
  9770           DFHEIV99,
  9771           DFHEIV99,
  9772           DFHEIV99
  9773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9774
  9775
  9776
  9777 9700-ERROR-FORMAT  SECTION.
  9778     IF NOT EMI-ERRORS-COMPLETE
  9779         MOVE LINK-001               TO  PGM-NAME
  9780
  9781* EXEC CICS LINK
  9782*            PROGRAM   (PGM-NAME)
  9783*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  9784*            LENGTH    (EMI-COMM-LENGTH)
  9785*        END-EXEC.
  9786*    MOVE '."C                   (   #00008986' TO DFHEIV0
  9787     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9788     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9789     MOVE X'2020233030303038393836' TO DFHEIV0(25:11)
  9790     CALL 'kxdfhei1' USING DFHEIV0,
  9791           PGM-NAME,
  9792           ERROR-MESSAGE-INTERFACE-BLOCK,
  9793           EMI-COMM-LENGTH,
  9794           DFHEIV99,
  9795           DFHEIV99,
  9796           DFHEIV99,
  9797           DFHEIV99
  9798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9799
  9800
  9801 9799-EXIT.
  9802     EXIT.
  9803
  9804 9800-SECURITY-VIOLATION  SECTION.
  9805*                            COPY ELCSCTP.
  9806******************************************************************
  9807*                                                                *
  9808*                            ELCSCTP                             *
  9809*                            VMOD=2.001                          *
  9810*                                                                *
  9811*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  9812******************************************************************
  9813
  9814
  9815     MOVE EIBDATE          TO SM-JUL-DATE.
  9816     MOVE EIBTRMID         TO SM-TERMID.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 183
* EL1278.cbl
  9817     MOVE THIS-PGM         TO SM-PGM.
  9818     MOVE EIBTIME          TO TIME-IN.
  9819     MOVE TIME-OUT         TO SM-TIME.
  9820     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  9821
  9822
  9823* EXEC CICS LINK
  9824*         PROGRAM  ('EL003')
  9825*         COMMAREA (SECURITY-MESSAGE)
  9826*         LENGTH   (80)
  9827*    END-EXEC.
  9828     MOVE 'EL003' TO DFHEIV1
  9829     MOVE 80
  9830       TO DFHEIV11
  9831*    MOVE '."C                   (   #00009013' TO DFHEIV0
  9832     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9833     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9834     MOVE X'2020233030303039303133' TO DFHEIV0(25:11)
  9835     CALL 'kxdfhei1' USING DFHEIV0,
  9836           DFHEIV1,
  9837           SECURITY-MESSAGE,
  9838           DFHEIV11,
  9839           DFHEIV99,
  9840           DFHEIV99,
  9841           DFHEIV99,
  9842           DFHEIV99
  9843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9844
  9845
  9846******************************************************************
  9847
  9848
  9849 9899-EXIT.
  9850     EXIT.
  9851
  9852 9900-ABEND  SECTION.
  9853     MOVE LINK-004               TO  PGM-NAME.
  9854     MOVE DFHEIBLK               TO  EMI-LINE1.
  9855
  9856
  9857* EXEC CICS LINK
  9858*        PROGRAM   (PGM-NAME)
  9859*        COMMAREA  (EMI-LINE1)
  9860*        LENGTH    (72)
  9861*    END-EXEC.
  9862     MOVE 72
  9863       TO DFHEIV11
  9864*    MOVE '."C                   (   #00009029' TO DFHEIV0
  9865     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9866     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9867     MOVE X'2020233030303039303239' TO DFHEIV0(25:11)
  9868     CALL 'kxdfhei1' USING DFHEIV0,
  9869           PGM-NAME,
  9870           EMI-LINE1,
  9871           DFHEIV11,
  9872           DFHEIV99,
  9873           DFHEIV99,
  9874           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 184
* EL1278.cbl
  9875           DFHEIV99
  9876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9877
  9878
  9879     MOVE -1                     TO  HLCANCL.
  9880
  9881     GO TO 8200-SEND-DATAONLY.
  9882
  9883 9999-LAST-PARAGRAPH.
  9884
  9885* GOBACK.
  9886     MOVE '9%                    "   ' TO DFHEIV0
  9887     MOVE 'EL1278' TO DFHEIV1
  9888     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9889     GOBACK.
  9890
  9891 9999-DFHBACK SECTION.
  9892     MOVE '9%                    "   ' TO DFHEIV0
  9893     MOVE 'EL1278' TO DFHEIV1
  9894     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9895     GOBACK.
  9896 9999-DFHEXIT.
  9897     IF DFHEIGDJ EQUAL 0001
  9898         NEXT SENTENCE
  9899     ELSE IF DFHEIGDJ EQUAL 2
  9900         GO TO 9500-PGMID-ERROR,
  9901               9900-ABEND
  9902         DEPENDING ON DFHEIGDI
  9903     ELSE IF DFHEIGDJ EQUAL 3
  9904         GO TO 0910-NOT-FOUND
  9905         DEPENDING ON DFHEIGDI
  9906     ELSE IF DFHEIGDJ EQUAL 4
  9907         GO TO 1010-NOTFND,
  9908               1020-NOTOPEN
  9909         DEPENDING ON DFHEIGDI
  9910     ELSE IF DFHEIGDJ EQUAL 5
  9911         GO TO 1290-ACCT-NOT-FOUND,
  9912               1290-ACCT-NOT-FOUND
  9913         DEPENDING ON DFHEIGDI
  9914     ELSE IF DFHEIGDJ EQUAL 6
  9915         GO TO 0580-ACCT-NOT-FOUND,
  9916               0580-ACCT-NOT-FOUND
  9917         DEPENDING ON DFHEIGDI
  9918     ELSE IF DFHEIGDJ EQUAL 7
  9919         GO TO 1699-EXIT
  9920         DEPENDING ON DFHEIGDI
  9921     ELSE IF DFHEIGDJ EQUAL 8
  9922         GO TO 7000-EXIT
  9923         DEPENDING ON DFHEIGDI
  9924     ELSE IF DFHEIGDJ EQUAL 9
  9925         GO TO 8300-SEND-TEXT
  9926         DEPENDING ON DFHEIGDI.
  9927     MOVE '9%                    "   ' TO DFHEIV0
  9928     MOVE 'EL1278' TO DFHEIV1
  9929     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9930     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 13:17 Page 185
* EL1278.cbl
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8548     Code:       26172
