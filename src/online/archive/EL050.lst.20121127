* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43******************************************************************
    44 ENVIRONMENT DIVISION.
    45
    46 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page   3
* EL050.cbl
    48 WORKING-STORAGE SECTION.
    49 01  DFH-START PIC X(04).
    50
    51 77  FILLER   PIC X(32) VALUE '********************************'.
    52 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    53 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    54
    55 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    56 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    57                                   USAGE POINTER.
    58 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    59 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    60 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    61                                   USAGE IS POINTER.
    62 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    63 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    64                                   USAGE IS POINTER.
    65 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    66 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    67                                   USAGE IS POINTER.
    68
    69 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    70 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    71                                   USAGE IS POINTER.
    72
    73*    COPY ELC50WS.
    74*****************************************************************
    75*                                                               *
    76*                            ELC50WS.                           *
    77*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    78*                            VMOD=2.061.                        *
    79*                                                               *
    80*   THIS IS THE WORKING STORAGE FOR EL050                       *
    81*                                   EL517                       *
    82*****************************************************************
    83******************************************************************
    84*                   C H A N G E   L O G
    85*
    86* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    87*-----------------------------------------------------------------
    88*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    89* EFFECTIVE    NUMBER
    90*-----------------------------------------------------------------
    91* 123102                   PEMA  ADD DCC PROCESSING
    92* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    93* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    94* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    95* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    96* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    97* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
    98* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
    99* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   100* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   101* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   102* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   103* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   104* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   105* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page   4
* EL050.cbl
   106* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   107* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   108* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   109* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   110* 030309  CR2009021700001  PEMA  ADD ER-2883
   111* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   112* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   113* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   114* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   115* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   116* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   117* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   118* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   119* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   120* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   121* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   122* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   123* 061412  CR2011022800001  AJRA  NAPERSOFT
   124*-----------------------------------------------------------------
   125
   126 01  WORK-AREAS.
   127
   128*****************************************************************
   129*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   130*****************************************************************
   131
   132     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   133     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   134     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   135     12  WS-NAME-EDIT-WORK-AREA.
   136         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   137         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   138             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   139         16  WS-WORK-NAME.
   140             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   141             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   142             20  FILLER           PIC X(10)     VALUE SPACES.
   143         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   144             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   145
   146*****************************************************************
   147*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   148*****************************************************************
   149
   150     12  WS-ERRESC-KEY.
   151         16 WS-ERRESC-SEARCH-KEY.
   152             20  WS-ERRESC-COMPANY-CD PIC  X.
   153             20  WS-ERRESC-CARRIER    PIC  X.
   154             20  WS-ERRESC-GROUP      PIC X(6).
   155             20  WS-ERRESC-STATE      PIC XX.
   156             20  WS-ERRESC-ACCOUNT    PIC X(10).
   157         16 WS-ERRESC-RESIDUAL-KEY.
   158             20  WS-ERRESC-AGENT      PIC X(10).
   159             20  WS-ERRESC-RES-STATE  PIC XX.
   160             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   161*                                          YYYYMMDD
   162     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   163     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page   5
* EL050.cbl
   164
   165*RESIDENT STATE TAX MASTER(ERRESS)
   166*
   167     12  WS-ERRESS-KEY.
   168         16  WS-ERRESS-COMPANY-CD      PIC  X.
   169         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   170         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   171         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   172*                                          YYYYMMDD
   173
   174     12  WS-CONTRACT-DATE              PIC 9(8).
   175*                                          YYYYMMDD
   176     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   177     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   178         16 WS-YEAR-YY                 PIC   9999.
   179         16 FILLER                     PIC 9(4).
   180*                                          YYYYMMDD
   181     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   182     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   183     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   184     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   185
   186     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   187         88  DPRB-1ST-TIME                      VALUE ' '.
   188
   189*****************************************************************
   190*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   191*****************************************************************
   192
   193     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   194     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   195     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   196     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   197     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   198     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   199     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   200     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   201     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   202     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   203         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   204         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   205     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   206         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   207         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   208     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   209
   210     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   211     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   212
   213     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   214     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   215     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   216     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   217     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   218     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   219     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   220     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   221     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page   6
* EL050.cbl
   222     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   223     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   224     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   225     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   226     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   227     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   228     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   229     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   230     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   231     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   232     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   233     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   239     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   240     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   241     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   244     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   245     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   246     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   247     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   248     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   249     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   250     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   251     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   252     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   253     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   254     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   255     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   256     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   257     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   258     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   259     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   260     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   261     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   262     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   263     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   264     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   265     12  WS-2671-SW               PIC X         VALUE SPACE.
   266     12  WS-2672-SW               PIC X         VALUE SPACE.
   267     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   268         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   269     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   270         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   271     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   272
   273     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   274         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   275         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   276         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   277         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   278
   279     12  WS-CREDIT-EDIT-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page   7
* EL050.cbl
   280         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   281         16  WS-MIN-AGE           PIC 99                VALUE  0.
   282         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   283         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   284         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   285         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   286
   287     12  WS-SAVE-ALLOWABLE-BENEFIT.
   288         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   289         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   290         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   291         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   292         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   293         16  FILLER                      PIC XX.
   294
   295     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   296     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   297     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   298     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   299     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   300     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   301     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   302     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   303     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   304     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   305
   306     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   307     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   308     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   309     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   310     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   311     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   312     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   313     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   314         88  WS-REDUCING              VALUE 'R'.
   315         88  WS-LEVEL                 VALUE 'L' 'P'.
   316     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   317
   318     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   319     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   320     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   321     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   322     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   323     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   324     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   325     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   326     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   327
   328     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   329     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   330     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   331     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   332     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   333     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   334     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   335     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   336     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   337     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page   8
* EL050.cbl
   338     12  WS-ACCT-SIG-SW.
   339         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   340         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   341     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   342     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   343     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   344     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   345     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   346     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   347     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   348     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   349     12  WS-INITIALS.
   350         16  WS-INIT-1            PIC X         VALUE SPACES.
   351         16  WS-INIT-2            PIC X         VALUE SPACES.
   352
   353     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   354     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   355     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   356     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   357     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   358*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   359     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   360     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   361     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   362     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   363     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   364     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   365     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   366     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   367     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   368     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   369     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   370     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   371     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   372     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   373     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   374     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   375     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   376     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   377     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   378     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   379     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   380     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   381******** FLA
   382     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   383     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   384     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   385     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   386     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   387********
   388     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   389     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   390     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   391     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   392     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   393     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   394     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   395     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page   9
* EL050.cbl
   396     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   397     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   398
   399     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   400         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   401                                         '0' THRU '9'.
   402
   403     12  NUMBER-OF-MONTHS.
   404         16  SK-MO OCCURS 12 TIMES PIC X.
   405
   406     12  WS-WORK-DATE.
   407         16  WS-YEAR            PIC 99    VALUE 00.
   408         16  WS-MONTH           PIC 99    VALUE 00.
   409         16  WS-DAY             PIC 99    VALUE 00.
   410
   411     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   412     12  WS-WORK-CRIT-DEV       REDEFINES
   413         WS-WORK-LF-CRIT-PER    PIC X(03).
   414
   415     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   416     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   417
   418     12  WS-WORK-DATE-FROM.
   419         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   420         16  FILLER             PIC X  VALUE SPACE.
   421         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   422         16  FILLER             PIC X         VALUE SPACE.
   423         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   424
   425     12  WS-WORK-DATE-THRU.
   426         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   427         16  FILLER             PIC X         VALUE SPACE.
   428         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   429         16  FILLER             PIC X         VALUE SPACE.
   430         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   431
   432     12  WS-LF-INPUT-CD.
   433         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   434         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   435
   436     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   437     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   438         16  WS-AH-INPUT-CD-1   PIC X.
   439         16  WS-AH-INPUT-CD-2-3 PIC XX.
   440
   441     12  WS-SWITCHES.
   442         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   443         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   444             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   445         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   446             88  BANK-ACCT-FOUND          VALUE 'Y'.
   447         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   448             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   449         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   450             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   451         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   452             88  COMP-MASTER-FOUND        VALUE 'Y'.
   453         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  10
* EL050.cbl
   454             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   455         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   456             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   457         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   458             88  STAT-MASTER-FOUND        VALUE 'Y'.
   459         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   460             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   461         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   462             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   463         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   464             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   465         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   466             88  FORM-MASTER-FOUND        VALUE 'Y'.
   467         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   468             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   469         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   470             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   471         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   472             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   473         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   474             88  NO-BENEFIT-FOUND         VALUE 'N'.
   475         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   476             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   477         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   478             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   479         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   480             88  AH-BENEFIT-FOUND         VALUE ' '.
   481             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   482         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   483             88  LF-BENEFIT-FOUND         VALUE ' '.
   484             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   485         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   486             88  NO-STATE-RECORD          VALUE '1'.
   487         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   488             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   489         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   490             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   491         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   492             88  CERT-WAS-FOUND           VALUE ' '.
   493             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   494         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   495             88  BROWSE-STARTED           VALUE 'Y'.
   496         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   497             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   498         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   499             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   500         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   501             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   502         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   503             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   504         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   505             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   506         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   507             88  APP-CERT-USED            VALUE 'Y' 'A'.
   508         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   509             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   510             88  FIRST-TIME-THROUGH       VALUE '1'.
   511             88  CTBL-NOT-FOUND           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  11
* EL050.cbl
   512
   513         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   514             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   515
   516         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   517             88  DLO-ERROR-FOUND          VALUE 'Y'.
   518
   519********FLA
   520     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   521     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   522********
   523     12  RC-SW-1                  PIC X           VALUE '0'.
   524     12  RC-SW-2                  PIC X           VALUE '0'.
   525     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   526     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   527     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   528     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   529     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   530     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   531     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   532     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   533     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   534     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   535     12  LIT-SPACES               PIC X           VALUE SPACES.
   536     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   537     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   538     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   539     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   540     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   541     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   542     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   543         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   544         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   545     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   546         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   547
   548 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   549     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   550     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   551 01  WS-CRI-SSN-WORK-AREA.
   552     05  WS-CRI-SOC-SEC-NO.
   553         10  WS-SS-REPT-CD       PIC X(5).
   554         10  WS-SS-LAST-NAME     PIC X(5).
   555         10  WS-SS-INITIAL       PIC X.
   556
   557     05  WS-CRI-REPORT-CODE.
   558         10  FILLER              PIC X(5).
   559         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   560
   561     05  WS-CRI-LAST-NAME.
   562         10  WS-CRI-NAME-MOVE    PIC X(5).
   563         10  FILLER              PIC X(10).
   564
   565 01  WS-NUM-TABLE                PIC X(26)  VALUE
   566     '12345678012345070923456789'.
   567 01  FILLER REDEFINES WS-NUM-TABLE.
   568     05  WS-NUM OCCURS 26        PIC 9.
   569 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  12
* EL050.cbl
   570 01  V1                          PIC S999 COMP-3.
   571 01  V2                          PIC S999 COMP-3.
   572 01  V3                          PIC S999 COMP-3.
   573 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   574 01  FILLER REDEFINES WS-WORK-VIN.
   575     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   576 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   577 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   578 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   579 01  WS-HEX-WORK.
   580     05  FILLER                  PIC X  VALUE LOW-VALUES.
   581     05  WS-HEX-BYTE             PIC X.
   582 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   583 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   584 01  WS-WORK-HIN-ROW-B.
   585     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   586
   587 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   588 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   589     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   590 01  WS-ROW-D-TABLE.
   591     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   592
   593 01  WS-HIN-TABLE-B.
   594     05  F                       PIC XX VALUE 'A2'.
   595     05  F                       PIC XX VALUE 'B3'.
   596     05  F                       PIC XX VALUE 'C4'.
   597     05  F                       PIC XX VALUE 'D5'.
   598     05  F                       PIC XX VALUE 'E6'.
   599     05  F                       PIC XX VALUE 'F7'.
   600     05  F                       PIC XX VALUE 'G8'.
   601     05  F                       PIC XX VALUE 'H9'.
   602     05  F                       PIC XX VALUE 'I1'.
   603     05  F                       PIC XX VALUE 'J2'.
   604     05  F                       PIC XX VALUE 'K3'.
   605     05  F                       PIC XX VALUE 'L4'.
   606     05  F                       PIC XX VALUE 'M5'.
   607     05  F                       PIC XX VALUE 'N6'.
   608     05  F                       PIC XX VALUE 'O0'.
   609     05  F                       PIC XX VALUE 'P7'.
   610     05  F                       PIC XX VALUE 'Q0'.
   611     05  F                       PIC XX VALUE 'R8'.
   612     05  F                       PIC XX VALUE 'S9'.
   613     05  F                       PIC XX VALUE 'T2'.
   614     05  F                       PIC XX VALUE 'U3'.
   615     05  F                       PIC XX VALUE 'V4'.
   616     05  F                       PIC XX VALUE 'W5'.
   617     05  F                       PIC XX VALUE 'X6'.
   618     05  F                       PIC XX VALUE 'Y7'.
   619     05  F                       PIC XX VALUE 'Z8'.
   620 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   621     05  WS-VAL-IN               PIC X.
   622     05  WS-VAL-OUT              PIC 9.
   623 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   624 01  WS-COMPARE-BINARY-DATES.
   625     05  WS-971231                PIC XX VALUE X'92FF'.
   626     05  WS-931231                PIC XX VALUE X'8CFF'.
   627     05  WS-791231                PIC XX VALUE X'77FF'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  13
* EL050.cbl
   628     05  WS-771001                PIC XX VALUE X'74A1'.
   629     05  WS-820301                PIC XX VALUE X'7B41'.
   630     05  WS-831031                PIC XX VALUE X'7DBF'.
   631     05  WS-831231                PIC XX VALUE X'7DFF'.
   632     05  WS-810831                PIC XX VALUE X'7A7F'.
   633     05  WS-830901                PIC XX VALUE X'7D81'.
   634
   635 01  FILE-ACCESS-IDS.
   636     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   637     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   638     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   639     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   640     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   641     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   642     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   643     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   644     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   645     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   646     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   647     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   648     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   649     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   650     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   651     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   652     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   653 01  DD-IU-SW                    PIC X   VALUE ' '.
   654     88  DD-IU-PRESENT                 VALUE 'Y'.
   655
   656 01  ACCESS-KEYS.
   657     12  ELMSTR-KEY.
   658         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   659         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   660     12  W-CLAIM-KEY.
   661         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   662         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   663
   664     12  ELCNTL-KEY.
   665         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   666         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   667         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   668         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   669
   670     12  ELCERT-KEY.
   671         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   672         16  CERT-CARRIER         PIC X       VALUE SPACE.
   673         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   674         16  CERT-STATE           PIC XX      VALUE SPACES.
   675         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   676         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   677         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   678
   679     12  ELCERT2-KEY.
   680         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   681         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   682
   683     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   684
   685     12  ELCERT-SAVE.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  14
* EL050.cbl
   686         16  FILLER                      PIC XX    VALUE SPACES.
   687
   688         16  WCS-CONTROL-PRIMARY.
   689             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   690             20  WCS-CARRIER             PIC X     VALUE SPACE.
   691             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   692             20  WCS-STATE               PIC XX    VALUE SPACES.
   693             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   694             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   695             20  WCS-CERT-NO.
   696                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   697                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   698
   699         16  CS-CONTROL-BY-NAME.
   700             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   701             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   702             20  CS-INSURED-INITIALS.
   703                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   704                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   705
   706         16  CS-CONTROL-BY-SSN.
   707             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   708             20  CS-SOC-SEC-NO.
   709                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   710                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   711                 24  CS-SSN-LN3.
   712                     28 CS-INSURED-INITIALS-A2   PIC XX
   713                                     VALUE SPACES.
   714                     28 CS-PART-LAST-NAME-A2     PIC X
   715                                     VALUE SPACE.
   716
   717         16  CS-CONTROL-BY-CERT-NO.
   718             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   719             20  CS-CERT-NO-A4           PIC X(11)
   720                                     VALUE SPACES.
   721
   722         16  CS-CONTROL-BY-MEMB.
   723             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   724             20  CS-MEMBER-NO.
   725                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   726                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   727                 24  CS-MEMB-LN4.
   728                     28 CS-INSURED-INITIALS-A5   PIC XX
   729                                      VALUE SPACES.
   730                     28 CS-PART-LAST-NAME-A5     PIC XX
   731                                      VALUE SPACES.
   732
   733         16  FILLER              PIC X(360) VALUE SPACES.
   734
   735     12  ERACCT-KEY.
   736         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   737         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   738         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   739         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   740         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   741         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   742
   743     12  ERCOMP-KEY.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  15
* EL050.cbl
   744         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   745         16  COMP-CARRIER         PIC X     VALUE SPACES.
   746         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   747         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   748         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   749         16  COMP-TYPE            PIC X     VALUE SPACES.
   750
   751     12  ERLOFC-KEY.
   752         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   753         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   754         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   755         16  LOFC-STATE           PIC XX    VALUE SPACES.
   756         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   757         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   758
   759     12  WS-ELCRTT-KEY.
   760         16  WS-ELCRTT-PRIMARY       PIC X(33).
   761         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   762
   763     12  ERBXRF-KEY.
   764         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   765         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   766         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   767         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   768
   769     12  ERAGTC-KEY.
   770         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   771         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   772         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   773         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   774         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   775         16  AGTC-TYPE            PIC X     VALUE SPACES.
   776
   777     12  ERPLAN-KEY.
   778         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   779         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   780         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   781         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   782         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   783         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   784         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   785         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   786
   787     12  ERFORM-KEY.
   788         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   789         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   790         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   791         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   792
   793     12  ERREIN-KEY.
   794         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   795         16  REIN-TYPE            PIC X     VALUE SPACES.
   796         16  REIN-TABLE-CO.
   797             20  REIN-CODE-1      PIC X     VALUE SPACE.
   798             20  REIN-CODE-2      PIC X     VALUE SPACE.
   799             20  REIN-CODE-3      PIC X     VALUE SPACE.
   800         16  FILLER               PIC X(3)  VALUE SPACES.
   801
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  16
* EL050.cbl
   802     12  ERCTBL-KEY.
   803         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   804         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   805         16  CTBL-CNTRL-2.
   806             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   807             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   808
   809     12  ELCRTO-KEY.
   810         16  ELCRTO-COMPANY-CD       PIC X.
   811         16  ELCRTO-CARRIER          PIC X.
   812         16  ELCRTO-GROUPING         PIC X(6).
   813         16  ELCRTO-STATE            PIC XX.
   814         16  ELCRTO-ACCOUNT          PIC X(10).
   815         16  ELCRTO-CERT-EFF-DT      PIC XX.
   816         16  ELCRTO-CERT-NO.
   817             20  ELCRTO-CERT-PRIME   PIC X(10).
   818             20  ELCRTO-CERT-SFX     PIC X.
   819         16  ELCRTO-RECORD-TYPE      PIC X.
   820         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   821
   822
   823     12  WS-ACCESS.
   824         16  FILLER               PIC XX    VALUE SPACES.
   825         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   826
   827     12  WS-CARR-ACCESS.
   828         16  FILLER               PIC X(3)  VALUE SPACES.
   829         16  WS-CARR              PIC X     VALUE SPACE.
   830*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   831*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   832     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   833         88  WS-DMD-LF-RATING   VALUE 'Y'.
   834         88  WS-DMD-AH-RATING   VALUE 'Y'.
   835         88  WS-DMD-NO-RATING   VALUE 'N'.
   836
   837     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   838         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   839                                         'NJ' 'NL'
   840                                         'PJ' 'PL'
   841                                         'SJ' 'SL'.
   842     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   843         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   844                                         'NI' 'NJ' 'NL' 'NU'
   845                                         'PJ' 'PL' 'PI' 'PU'
   846                                         'SI' 'SJ' 'SL' 'SU'
   847                                         'MX' 'MY' 'MZ'.
   848 01  ERPDEF-KEY-SAVE             PIC X(18).
   849 01  ERPDEF-KEY.
   850     12  ERPDEF-COMPANY-CD       PIC X.
   851     12  ERPDEF-STATE            PIC XX.
   852     12  ERPDEF-PROD-CD          PIC XXX.
   853     12  F                       PIC X(7).
   854     12  ERPDEF-BEN-TYPE         PIC X.
   855     12  ERPDEF-BEN-CODE         PIC XX.
   856     12  ERPDEF-EXP-DT           PIC XX.
   857
   858 01  ELSTAT-KEY-SAVE             PIC X(20).
   859 01  ELSTAT-KEY.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  17
* EL050.cbl
   860     12  ELSTAT-COMPANY-ID       PIC XXX.
   861     12  ELSTAT-CARRIER          PIC X.
   862     12  ELSTAT-GROUP            PIC X(6).
   863     12  ELSTAT-STATE            PIC XX.
   864     12  ELSTAT-EXP-DT           PIC 9(8).
   865 01  WS-ERROR-VALUES.
   866     12  ER-1570                     PIC S9(4)   VALUE +1570.
   867     12  ER-1571                     PIC S9(4)   VALUE +1571.
   868     12  ER-1575                     PIC S9(4)   VALUE +1575.
   869     12  ER-1891                     PIC S9(4)   VALUE +1891.
   870     12  ER-1892                     PIC S9(4)   VALUE +1892.
   871     12  ER-1893                     PIC S9(4)   VALUE +1893.
   872     12  ER-1894                     PIC S9(4)   VALUE +1894.
   873     12  ER-1895                     PIC S9(4)   VALUE +1895.
   874     12  ER-1896                     PIC S9(4)   VALUE +1896.
   875     12  ER-1897                     PIC S9(4)   VALUE +1897.
   876     12  ER-1898                     PIC S9(4)   VALUE +1898.
   877     12  ER-1899                     PIC S9(4)   VALUE +1899.
   878     12  ER-1900                     PIC S9(4)   VALUE +1900.
   879     12  ER-1901                     PIC S9(4)   VALUE +1901.
   880     12  ER-1902                     PIC S9(4)   VALUE +1902.
   881     12  ER-1903                     PIC S9(4)   VALUE +1903.
   882     12  ER-1904                     PIC S9(4)   VALUE +1904.
   883     12  ER-1905                     PIC S9(4)   VALUE +1905.
   884     12  ER-1906                     PIC S9(4)   VALUE +1906.
   885     12  ER-1907                     PIC S9(4)   VALUE +1907.
   886     12  ER-1909                     PIC S9(4)   VALUE +1909.
   887     12  ER-1910                     PIC S9(4)   VALUE +1910.
   888     12  ER-1911                     PIC S9(4)   VALUE +1911.
   889     12  ER-1912                     PIC S9(4)   VALUE +1912.
   890     12  ER-1913                     PIC S9(4)   VALUE +1913.
   891     12  ER-1914                     PIC S9(4)   VALUE +1914.
   892     12  ER-1915                     PIC S9(4)   VALUE +1915.
   893     12  ER-1916                     PIC S9(4)   VALUE +1916.
   894     12  ER-1917                     PIC S9(4)   VALUE +1917.
   895     12  ER-1918                     PIC S9(4)   VALUE +1918.
   896     12  ER-1919                     PIC S9(4)   VALUE +1919.
   897     12  ER-1920                     PIC S9(4)   VALUE +1920.
   898     12  ER-1921                     PIC S9(4)   VALUE +1921.
   899     12  ER-1922                     PIC S9(4)   VALUE +1922.
   900     12  ER-1923                     PIC S9(4)   VALUE +1923.
   901     12  ER-1924                     PIC S9(4)   VALUE +1924.
   902     12  ER-1925                     PIC S9(4)   VALUE +1925.
   903     12  ER-1926                     PIC S9(4)   VALUE +1926.
   904     12  ER-1927                     PIC S9(4)   VALUE +1927.
   905     12  ER-2393                     PIC S9(4)   VALUE +2393.
   906     12  ER-2600                     PIC S9(4)   VALUE +2600.
   907     12  ER-2601                     PIC S9(4)   VALUE +2601.
   908     12  ER-2602                     PIC S9(4)   VALUE +2602.
   909     12  ER-2603                     PIC S9(4)   VALUE +2603.
   910     12  ER-2604                     PIC S9(4)   VALUE +2604.
   911     12  ER-2605                     PIC S9(4)   VALUE +2605.
   912     12  ER-2606                     PIC S9(4)   VALUE +2606.
   913     12  ER-2607                     PIC S9(4)   VALUE +2607.
   914     12  ER-2608                     PIC S9(4)   VALUE +2608.
   915     12  ER-2609                     PIC S9(4)   VALUE +2609.
   916     12  ER-2610                     PIC S9(4)   VALUE +2610.
   917     12  ER-2611                     PIC S9(4)   VALUE +2611.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  18
* EL050.cbl
   918     12  ER-2612                     PIC S9(4)   VALUE +2612.
   919     12  ER-2613                     PIC S9(4)   VALUE +2613.
   920     12  ER-2614                     PIC S9(4)   VALUE +2614.
   921     12  ER-2615                     PIC S9(4)   VALUE +2615.
   922     12  ER-2616                     PIC S9(4)   VALUE +2616.
   923     12  ER-2617                     PIC S9(4)   VALUE +2617.
   924     12  ER-2618                     PIC S9(4)   VALUE +2618.
   925     12  ER-2619                     PIC S9(4)   VALUE +2619.
   926     12  ER-2620                     PIC S9(4)   VALUE +2620.
   927     12  ER-2621                     PIC S9(4)   VALUE +2621.
   928     12  ER-2622                     PIC S9(4)   VALUE +2622.
   929     12  ER-2623                     PIC S9(4)   VALUE +2623.
   930     12  ER-2624                     PIC S9(4)   VALUE +2624.
   931     12  ER-2625                     PIC S9(4)   VALUE +2625.
   932     12  ER-2626                     PIC S9(4)   VALUE +2626.
   933     12  ER-2627                     PIC S9(4)   VALUE +2627.
   934     12  ER-2628                     PIC S9(4)   VALUE +2628.
   935     12  ER-2629                     PIC S9(4)   VALUE +2629.
   936     12  ER-2630                     PIC S9(4)   VALUE +2630.
   937     12  ER-2631                     PIC S9(4)   VALUE +2631.
   938     12  ER-2632                     PIC S9(4)   VALUE +2632.
   939     12  ER-2633                     PIC S9(4)   VALUE +2633.
   940     12  ER-2634                     PIC S9(4)   VALUE +2634.
   941     12  ER-2635                     PIC S9(4)   VALUE +2635.
   942     12  ER-2636                     PIC S9(4)   VALUE +2636.
   943     12  ER-2637                     PIC S9(4)   VALUE +2637.
   944     12  ER-2638                     PIC S9(4)   VALUE +2638.
   945     12  ER-2639                     PIC S9(4)   VALUE +2639.
   946     12  ER-2640                     PIC S9(4)   VALUE +2640.
   947     12  ER-2641                     PIC S9(4)   VALUE +2641.
   948     12  ER-2642                     PIC S9(4)   VALUE +2642.
   949     12  ER-2643                     PIC S9(4)   VALUE +2643.
   950     12  ER-2644                     PIC S9(4)   VALUE +2644.
   951     12  ER-2645                     PIC S9(4)   VALUE +2645.
   952     12  ER-2646                     PIC S9(4)   VALUE +2646.
   953     12  ER-2647                     PIC S9(4)   VALUE +2647.
   954     12  ER-2648                     PIC S9(4)   VALUE +2648.
   955     12  ER-2649                     PIC S9(4)   VALUE +2649.
   956     12  ER-2650                     PIC S9(4)   VALUE +2650.
   957     12  ER-2651                     PIC S9(4)   VALUE +2651.
   958     12  ER-2652                     PIC S9(4)   VALUE +2652.
   959     12  ER-2653                     PIC S9(4)   VALUE +2653.
   960     12  ER-2654                     PIC S9(4)   VALUE +2654.
   961     12  ER-2655                     PIC S9(4)   VALUE +2655.
   962     12  ER-2656                     PIC S9(4)   VALUE +2656.
   963     12  ER-2657                     PIC S9(4)   VALUE +2657.
   964     12  ER-2658                     PIC S9(4)   VALUE +2658.
   965     12  ER-2659                     PIC S9(4)   VALUE +2659.
   966     12  ER-2660                     PIC S9(4)   VALUE +2660.
   967     12  ER-2661                     PIC S9(4)   VALUE +2661.
   968     12  ER-2662                     PIC S9(4)   VALUE +2662.
   969     12  ER-2663                     PIC S9(4)   VALUE +2663.
   970     12  ER-2664                     PIC S9(4)   VALUE +2664.
   971     12  ER-2665                     PIC S9(4)   VALUE +2665.
   972     12  ER-2666                     PIC S9(4)   VALUE +2666.
   973     12  ER-2667                     PIC S9(4)   VALUE +2667.
   974     12  ER-2668                     PIC S9(4)   VALUE +2668.
   975     12  ER-2669                     PIC S9(4)   VALUE +2669.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  19
* EL050.cbl
   976     12  ER-2670                     PIC S9(4)   VALUE +2670.
   977     12  ER-2671                     PIC S9(4)   VALUE +2671.
   978     12  ER-2672                     PIC S9(4)   VALUE +2672.
   979     12  ER-2673                     PIC S9(4)   VALUE +2673.
   980     12  ER-2674                     PIC S9(4)   VALUE +2674.
   981     12  ER-2675                     PIC S9(4)   VALUE +2675.
   982     12  ER-2676                     PIC S9(4)   VALUE +2676.
   983     12  ER-2677                     PIC S9(4)   VALUE +2677.
   984     12  ER-2678                     PIC S9(4)   VALUE +2678.
   985     12  ER-2679                     PIC S9(4)   VALUE +2679.
   986     12  ER-2680                     PIC S9(4)   VALUE +2680.
   987     12  ER-2681                     PIC S9(4)   VALUE +2681.
   988     12  ER-2682                     PIC S9(4)   VALUE +2682.
   989     12  ER-2683                     PIC S9(4)   VALUE +2683.
   990     12  ER-2684                     PIC S9(4)   VALUE +2684.
   991     12  ER-2685                     PIC S9(4)   VALUE +2685.
   992     12  ER-2686                     PIC S9(4)   VALUE +2686.
   993     12  ER-2687                     PIC S9(4)   VALUE +2687.
   994     12  ER-2688                     PIC S9(4)   VALUE +2688.
   995     12  ER-2689                     PIC S9(4)   VALUE +2689.
   996     12  ER-2690                     PIC S9(4)   VALUE +2690.
   997     12  ER-2691                     PIC S9(4)   VALUE +2691.
   998     12  ER-2692                     PIC S9(4)   VALUE +2692.
   999     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1000     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1001     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1002     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1003     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1004     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1005     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1006     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1007     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1008     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1009     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1010     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1011     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1012     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1013     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1014     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1015     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1016     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1017     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1018     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1019     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1020     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1021     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1022     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1023     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1024     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1025     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1026     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1027     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1028     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1029     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1030     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1031     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1032     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1033     12  ER-2737                     PIC S9(4)   VALUE +2737.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  20
* EL050.cbl
  1034     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1035     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1036     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1037     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1038     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1039     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1040     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1041     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1042     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1043     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1044     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1045     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1046     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1047     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1048     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1049     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1050     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1051     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1052     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1053     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1054     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1055     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1056     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1057     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1058     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1059     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1060     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1061     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1062     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1063     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1064     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1065     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1066     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1067     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1068     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1069     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1070     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1071     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1072     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1073     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1074     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1075     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1076     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1077     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1078     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1079     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1080     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1081     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1082     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1083     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1084     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1085     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1086     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1087     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1088     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1089     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1090     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1091     12  ER-2869                     PIC S9(4)   VALUE +2869.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  21
* EL050.cbl
  1092     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1093     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1094     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1095     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1096     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1097     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1098     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1099     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1100     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1101     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1102     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1103     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1104     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1105     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1106     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1107     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1108     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1109     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1110     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1111     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1112     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1113     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1114     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1115     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1116     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1117     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1118     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1119     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1120     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1121     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1122     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1123     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1124     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1125     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1126     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1127     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1128     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1129     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1130     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1131     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1132     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1133     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1134     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1135     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1136     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1137     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1138     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1139     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1140     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1141     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1142     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1143     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1144     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1145     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1146     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1147     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1148     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1149     12  ER-8069                     PIC S9(4)   VALUE +8069.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  22
* EL050.cbl
  1150     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1151     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1152     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1153     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1154     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1155     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1156     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1157     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1158     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1159     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1160     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1161     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1162     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1163     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1164     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1165     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1166     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1167     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1168     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1169     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1170     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1171     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1172     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1173     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1174     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1175     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1176     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1177     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1178     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1179     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1180     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1181     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1182     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1183     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1184     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1185     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1186     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1187     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1188     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1189     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1190     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1191     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1192     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1193     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1194     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1195     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1196     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1197     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1198     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1199     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1200     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1201     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1202     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1203     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1204     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1205     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1206******************************************************************
  1207***************   END OF ELC50WS     ****************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  23
* EL050.cbl
  1208******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  24
* EL050.cbl
  1211 01  WORKING-STORAGE-WORK-AREAS.
  1212     12  WS-RESPONSE             PIC S9(8)  COMP.
  1213         88  WS-RESP-NORMAL           VALUE +00.
  1214         88  WS-RESP-ERROR            VALUE +01.
  1215         88  WS-RESP-NOTFND           VALUE +13.
  1216         88  WS-RESP-DUPREC           VALUE +14.
  1217         88  WS-RESP-ENDFILE          VALUE +20.
  1218     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1219     12  WORK-AREAS.
  1220         16  WK-CONV-GREG.
  1221             24  WCG-CENT             PIC XX.
  1222             24  WCG-REST             PIC X(4).
  1223         16  WORK-GREGORIAN-DATE.
  1224             24  WK-GREG-CENT         PIC XX.
  1225             24  WK-GREG-DATE-YYMMDD.
  1226                 28  WK-GREG-YYMM     PIC X(4).
  1227                 28  WK-GREG-DD       PIC XX.
  1228
  1229         16  WORK-SELECT-DATE.
  1230             24  WK-SELECT-CENT            PIC XX.
  1231             24  WK-SELECT-DATE-YYMMDD.
  1232                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1233                 28  FILLER                PIC XX.
  1234
  1235         16  WK-FORM-NO.
  1236             24  WK-FORM-BANK-ID       PIC X(5).
  1237             24  WK-FORM-UNDRWRTR      PIC X(1).
  1238             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1239
  1240         16  WK-MEMBER-NO.
  1241             24  WK-MEMBER-1-6        PIC X(6).
  1242             24  WK-MEMBER-7-12       PIC X(6).
  1243
  1244         16  WK-FULL-CERT-NO.
  1245             24  WK-CERT-POS-1-2      PIC X(2).
  1246             24  WK-CERT-POS-3        PIC X(1).
  1247             24  WK-CERT-POS-4        PIC X(1).
  1248             24  WK-CERT-POS-5-6      PIC X(2).
  1249             24  WK-CERT-POS-7        PIC X(1).
  1250             24  WK-CERT-POS-8-11     PIC X(4).
  1251
  1252         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1253             88  VALID-RATE-CODE        VALUE 'Y'.
  1254             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1255
  1256         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1257         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1258         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1259         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1260         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1261         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1262         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1263         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1264         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1265         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1266
  1267* DLO001
  1268 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  25
* EL050.cbl
  1269     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1270     12  DMPF-RETURN-CODE          PIC XX.
  1271         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1272         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1273         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1274         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1275         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1276         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1277
  1278* DLO002
  1279 01  WS-DLO-INTERNAL-POLICY-FORM.
  1280     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1281     12  DIPF-RETURN-CODE          PIC XX.
  1282         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1283         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1284         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1285         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1286         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1287         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1288
  1289* DLO003
  1290 01  WS-DLO-VALID-BANK-ID.
  1291     12  DVBI-BANK-ID              PIC X(5).
  1292     12  DVBI-BANK-ID-TYPE         PIC X.
  1293         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1294         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1295         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1296         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1297         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1298     12  DVBI-RETURN-CODE          PIC XX.
  1299         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1300         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1301         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1302         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1303         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1304         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1305         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1306         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1307         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1308
  1309* DLO007
  1310 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1311     12  DCUA-RES-STATE            PIC XX.
  1312     12  DCUA-BEN-TYPE             PIC XX.
  1313     12  DCUA-SYS-IDENT            PIC X.
  1314         88  DCUA-CLAIM                        VALUE 'C'.
  1315         88  DCUA-PREMIUM                      VALUE 'P'.
  1316     12  DCUA-COVERAGE-RULE        PIC X.
  1317     12  DCUA-CLIENT-ID            PIC X(10).
  1318     12  DCUA-EFF-DATE             PIC X(8).
  1319     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1320     12  DCUA-RETURN-CODE          PIC XX.
  1321         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1322     12  DCUA-CERT-NUMBER          PIC X(11).
  1323     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1324     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1325
  1326* DLO011
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  26
* EL050.cbl
  1327 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1328     12  DPRB-RATE-CODE            PIC X(4).
  1329     12  DPRB-COVERAGE-CATEG       PIC X.
  1330     12  DPRB-RETURN-CODE          PIC XX.
  1331         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1332         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1333         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1334         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1335         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1336         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1337         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1338         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1339         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1340     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1341     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1342     12  DPRB-BEN-TYPE             PIC XX.
  1343
  1344* DLO017
  1345 01  WS-DLO-VALID-RATE-CODE.
  1346     12  DVRC-RATE-CODE            PIC X(4).
  1347     12  DVRC-RETURN-CODE          PIC XX.
  1348         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1349         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1350         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1351         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1352         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1353         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1354
  1355* DLO019
  1356 01  WS-DLO-ORIG-COV-CAT.
  1357     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1358     12  DOCC-RETURN-CODE          PIC XX.
  1359     12  DOCC-ORIG-COV-CAT         PIC X.
  1360     12  DOCC-UNDERWITER           PIC XX.
  1361     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1362     12  DOCC-FILLER               PIC X(6).
  1363
  1364* DLO021
  1365 01  WS-DLO-VALID-LOAN-OFFICER.
  1366     12  DVLO-LOAN-OFFICER.
  1367         16  DVLO-BILL-TYPE        PIC X.
  1368         16  DVLO-BILL-SOURCE      PIC X.
  1369         16  DVLO-BATCH-TYPE       PIC X.
  1370     12  DVLO-RETURN-CODE          PIC XX.
  1371         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1372         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1373         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1374         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1375         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1376         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1377
  1378* DLO022
  1379 01  WS-DLO-VALID-STATE-CODE.
  1380     12  DVSC-STATE-CODE           PIC XX.
  1381     12  DVSC-RETURN-CODE          PIC XX.
  1382         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1383
  1384* DLO023
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  27
* EL050.cbl
  1385 01  WS-DLO-VALID-CODE-VALUES.
  1386     12  DVCV-SYSTEM-ID            PIC XX.
  1387         88  DVCV-CLAIMS                       VALUE 'CL'.
  1388         88  DVCV-CREDIT                       VALUE 'CR'.
  1389     12  DVCV-RECORD-TYPE          PIC XX.
  1390         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1391         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1392         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1393         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1394         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1395         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1396         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1397         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1398     12  DVCV-RECORD-KEY           PIC X(6).
  1399     12  DVCV-RETURN-CODE          PIC XX.
  1400         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1401         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1402         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1403         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1404         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1405         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1406         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1407     12  DVCV-CODE-DESC            PIC X(60).
  1408     12  DVCV-GEN-DESC-1           PIC X(20).
  1409     12  DVCV-GEN-DESC-2           PIC X(20).
  1410     12  DVCV-GEN-DESC-3           PIC X(20).
  1411
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  28
* EL050.cbl
  1413*    COPY ERCBXRF.
  1414******************************************************************
  1415*                                                                *
  1416*                                                                *
  1417*                            ERCBXRF                             *
  1418*                                                                *
  1419*   ONLINE CREDIT SYSTEM                                         *
  1420*                                                                *
  1421*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1422*                                                                *
  1423*   FILE TYPE = VSAM,KSDS                                        *
  1424*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1425*                                                                *
  1426*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1427*       ALTERNATE PATH = NONE                                    *
  1428*                                                                *
  1429*   LOG = NO                                                     *
  1430*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1431*                                                                *
  1432******************************************************************
  1433
  1434 01  BANK-CROSS-REFERENCE.
  1435     12  BK-RECORD-ID                PIC XX.
  1436         88  VALID-BK-ID             VALUE 'BK'.
  1437
  1438     12  BK-CONTROL-PRIMARY.
  1439         16  BK-COMPANY-CD           PIC X.
  1440         16  BK-CARRIER              PIC X.
  1441         16  BK-GROUPING             PIC X(6).
  1442         16  BK-BANK-NO              PIC X(10).
  1443
  1444     12  BK-MAINT-INFORMATION.
  1445         16  BK-LAST-MAINT-DT        PIC XX.
  1446         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1447         16  BK-LAST-MAINT-USER      PIC X(4).
  1448         16  FILLER                  PIC X(9).
  1449
  1450     12  FILLER                      PIC X(37).
  1451
  1452     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1453
  1454     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1455                            DEPENDING ON BK-BANK-POINTER-CNT.
  1456         16  BK-AM-ACCOUNT           PIC X(10).
  1457         16  BK-AM-EXP-DT            PIC XX.
  1458         16  BK-AM-EFF-DT            PIC XX.
  1459         16  BK-AM-STATE             PIC XX.
  1460         16  FILLER                  PIC X(20).
  1461
  1462******************************************************************
  1463
  1464*    COPY ERCCOMP.
  1465******************************************************************
  1466*                                                                *
  1467*                                                                *
  1468*                            ERCCOMP                             *
  1469*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1470*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  29
* EL050.cbl
  1471*                                                                *
  1472*   ONLINE CREDIT SYSTEM                                         *
  1473*                                                                *
  1474*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1475*                                                                *
  1476*   FILE TYPE = VSAM,KSDS                                        *
  1477*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1478*                                                                *
  1479*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1480*       ALTERNATE PATH = NONE                                    *
  1481*                                                                *
  1482*   LOG = NO                                                     *
  1483*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1484*                                                                *
  1485******************************************************************
  1486*                   C H A N G E   L O G
  1487*
  1488* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1489*-----------------------------------------------------------------
  1490*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1491* EFFECTIVE    NUMBER
  1492*-----------------------------------------------------------------
  1493* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1494* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1495* 092205    2005050300006  PEMA  ADD LEASE FEE
  1496* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1497* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1498* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1499* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1500* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1501* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1502******************************************************************
  1503
  1504 01  COMPENSATION-MASTER.
  1505     12  CO-RECORD-ID                          PIC XX.
  1506         88  VALID-CO-ID                          VALUE 'CO'.
  1507
  1508     12  CO-CONTROL-PRIMARY.
  1509         16  CO-COMPANY-CD                     PIC X.
  1510         16  CO-CONTROL.
  1511             20  CO-CTL-1.
  1512                 24  CO-CARR-GROUP.
  1513                     28  CO-CARRIER            PIC X.
  1514                     28  CO-GROUPING.
  1515                         32  CO-GROUP-PREFIX   PIC XXX.
  1516                         32  CO-GROUP-PRIME    PIC XXX.
  1517                 24  CO-RESP-NO.
  1518                     28  CO-RESP-PREFIX        PIC X(4).
  1519                     28  CO-RESP-PRIME         PIC X(6).
  1520             20  CO-CTL-2.
  1521                 24  CO-ACCOUNT.
  1522                     28  CO-ACCT-PREFIX        PIC X(4).
  1523                     28  CO-ACCT-PRIME         PIC X(6).
  1524         16  CO-TYPE                           PIC X.
  1525             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1526             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1527             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1528
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  30
* EL050.cbl
  1529     12  CO-MAINT-INFORMATION.
  1530         16  CO-LAST-MAINT-DT                  PIC XX.
  1531         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1532         16  CO-LAST-MAINT-USER                PIC X(4).
  1533     12  FILLER                                PIC XX.
  1534     12  CO-STMT-TYPE                          PIC XXX.
  1535     12  CO-COMP-TYPE                          PIC X.
  1536         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1537     12  CO-STMT-OWNER                         PIC X(4).
  1538     12  CO-BALANCE-CONTROL                    PIC X.
  1539         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1540         88  CO-NO-BALANCE                        VALUE 'N'.
  1541
  1542     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1543         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1544         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1545         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1546
  1547     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1548         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1549         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1550
  1551     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1552     12  CO-GA-DIRECT-DEP                      PIC X.
  1553     12  CO-FUTURE-SPACE                       PIC X.
  1554         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1555
  1556     12  CO-ACCT-NAME                          PIC X(30).
  1557     12  CO-MAIL-NAME                          PIC X(30).
  1558     12  CO-ADDR-1                             PIC X(30).
  1559     12  CO-ADDR-2                             PIC X(30).
  1560     12  CO-ADDR-3.
  1561         16  CO-ADDR-CITY                      PIC X(27).
  1562         16  CO-ADDR-STATE                     PIC XX.
  1563     12  CO-CSO-1099                           PIC X.
  1564     12  CO-ZIP.
  1565         16  CO-ZIP-PRIME.
  1566             20  CO-ZIP-PRI-1ST                PIC X.
  1567                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1568             20  FILLER                        PIC X(4).
  1569         16  CO-ZIP-PLUS4                      PIC X(4).
  1570     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1571         16  CO-CAN-POSTAL-1                   PIC XXX.
  1572         16  CO-CAN-POSTAL-2                   PIC XXX.
  1573         16  FILLER                            PIC XXX.
  1574     12  CO-SOC-SEC                            PIC X(13).
  1575     12  CO-TELEPHONE.
  1576         16  CO-AREA-CODE                      PIC XXX.
  1577         16  CO-PREFIX                         PIC XXX.
  1578         16  CO-PHONE                          PIC X(4).
  1579
  1580     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1581
  1582     12  CO-AR-BAL-LEVEL                       PIC X.
  1583         88  CO-AR-REF-LVL                        VALUE '1'.
  1584         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1585         88  CO-AR-BILL-LVL                       VALUE '2'.
  1586         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  31
* EL050.cbl
  1587         88  CO-AR-FR-LVL                         VALUE '4'.
  1588
  1589     12  CO-AR-NORMAL-PRINT                    PIC X.
  1590         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1591         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1592
  1593     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1594
  1595     12  CO-AR-REPORTING                       PIC X.
  1596         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1597         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1598
  1599     12  CO-AR-PULL-CHECK                      PIC X.
  1600         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1601         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1602
  1603     12  CO-AR-BALANCE-PRINT                   PIC X.
  1604         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1605
  1606     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1607         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1608         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1609         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1610
  1611     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1612
  1613     12  CO-USER-CODE                          PIC X.
  1614     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1615
  1616******************************************************************
  1617*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1618*    THE LAST MONTH END RUN.
  1619******************************************************************
  1620
  1621     12  CO-LAST-ACTIVITY-DATE.
  1622         16  CO-ACT-YEAR                       PIC 99.
  1623         16  CO-ACT-MONTH                      PIC 99.
  1624         16  CO-ACT-DAY                        PIC 99.
  1625
  1626     12  CO-LAST-STMT-DT.
  1627         16  CO-LAST-STMT-YEAR                 PIC 99.
  1628         16  CO-LAST-STMT-MONTH                PIC 99.
  1629         16  CO-LAST-STMT-DAY                  PIC 99.
  1630
  1631     12  CO-MO-END-TOTALS.
  1632         16  CO-MONTHLY-TOTALS.
  1633             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1634             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1635             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1636             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1637             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1638
  1639         16  CO-AGING-TOTALS.
  1640             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1641             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1642             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1643             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1644
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  32
* EL050.cbl
  1645         16  CO-YTD-TOTALS.
  1646             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1647             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1648
  1649         16  CO-OVER-UNDER-TOTALS.
  1650             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1651             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1652
  1653     12  CO-MISCELLANEOUS-TOTALS.
  1654         16  CO-FICA-TOTALS.
  1655             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1656             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1657
  1658         16  CO-CLAIM-TOTALS.
  1659             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1660             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1661
  1662******************************************************************
  1663*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1664*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1665******************************************************************
  1666
  1667     12  CO-CURRENT-TOTALS.
  1668         16  CO-CURRENT-LAST-STMT-DT.
  1669             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1670             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1671             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1672
  1673         16  CO-CURRENT-MONTHLY-TOTALS.
  1674             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1675             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1676             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1677             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1678             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1679
  1680         16  CO-CURRENT-AGING-TOTALS.
  1681             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1682             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1683             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1684             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1685
  1686         16  CO-CURRENT-YTD-TOTALS.
  1687             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1688             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1689
  1690     12  CO-PAID-COMM-TOTALS.
  1691         16  CO-YTD-PAID-COMMS.
  1692             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1693             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1694
  1695     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1696         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1697         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1698
  1699     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1700         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1701         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1702         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  33
* EL050.cbl
  1703         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1704         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1705         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1706         88  CO-FINAL-LETTER                  VALUE 'F'.
  1707         88  CO-RECONCILING                   VALUE 'R'.
  1708         88  CO-PHONE-CALL                    VALUE 'P'.
  1709         88  CO-LEGAL                         VALUE 'L'.
  1710         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1711         88  CO-WRITE-OFF                     VALUE 'W'.
  1712         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1713
  1714     12  CO-CSR-CODE                       PIC X(4).
  1715
  1716     12  CO-GA-STATUS-INFO.
  1717         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1718         16  CO-GA-TERMINATION-DT          PIC XX.
  1719         16  CO-GA-STATUS-CODE             PIC X.
  1720             88  CO-GA-ACTIVE                 VALUE 'A'.
  1721             88  CO-GA-INACTIVE               VALUE 'I'.
  1722             88  CO-GA-PENDING                VALUE 'P'.
  1723         16  CO-GA-COMMENTS.
  1724             20  CO-GA-COMMENT-1           PIC X(40).
  1725             20  CO-GA-COMMENT-2           PIC X(40).
  1726             20  CO-GA-COMMENT-3           PIC X(40).
  1727             20  CO-GA-COMMENT-4           PIC X(40).
  1728
  1729     12  CO-RPTCD2                         PIC X(10).
  1730     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1731         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1732         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1733
  1734     12  CO-TYPE-AGENT                     PIC X(01).
  1735         88  CO-CORPORATION                   VALUE 'C'.
  1736         88  CO-PARTNERSHIP                   VALUE 'P'.
  1737         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1738         88  CO-TRUST                         VALUE 'T'.
  1739         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1740
  1741     12  CO-FAXNO.
  1742         16  CO-FAX-AREA-CODE                  PIC XXX.
  1743         16  CO-FAX-PREFIX                     PIC XXX.
  1744         16  CO-FAX-PHONE                      PIC X(4).
  1745
  1746     12  CO-BANK-INFORMATION.
  1747         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1748         16  CO-BANK-TRANSIT-NON REDEFINES
  1749             CO-BANK-TRANSIT-NO                PIC 9(8).
  1750
  1751         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1752     12  CO-MISC-DEDUCT-INFO REDEFINES
  1753                  CO-BANK-INFORMATION.
  1754         16  CO-MD-GL-ACCT                     PIC X(10).
  1755         16  CO-MD-DIV                         PIC XX.
  1756         16  CO-MD-CENTER                      PIC X(4).
  1757         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1758         16  CO-CREATE-AP-CHECK                PIC X.
  1759         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1760         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  34
* EL050.cbl
  1761     12  CO-ACH-STATUS                         PIC X.
  1762         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1763         88  CO-ACH-PENDING                        VALUE 'P'.
  1764
  1765     12  CO-BILL-SW                            PIC X.
  1766     12  CO-CONTROL-NAME                       PIC X(30).
  1767     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1768     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1769     12  CO-CLP-STATE                          PIC XX.
  1770     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1771     12  CO-SPP-REFUND-EDIT                    PIC X.
  1772
  1773******************************************************************
  1774
  1775*    COPY ERCAGTC.
  1776******************************************************************
  1777*                                                                *
  1778*                                                                *
  1779*                            ERCAGTC                             *
  1780*                            VMOD=2.001                          *
  1781*                                                                *
  1782*   ONLINE CREDIT SYSTEM                                         *
  1783*                                                                *
  1784*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1785*                                                                *
  1786*   FILE TYPE = VSAM,KSDS                                        *
  1787*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1788*                                                                *
  1789*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1790*       ALTERNATE PATH = NONE                                    *
  1791*                                                                *
  1792*   LOG = NO                                                     *
  1793*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1794*                                                                *
  1795******************************************************************
  1796*                   C H A N G E   L O G
  1797*
  1798* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1799*-----------------------------------------------------------------
  1800*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1801* EFFECTIVE    NUMBER
  1802*-----------------------------------------------------------------
  1803* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1804* 111004                         NEW FILE AND COPYBOOK
  1805* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1806******************************************************************
  1807 01  AGENT-COMMISSIONS.
  1808     12  AG-RECORD-ID                          PIC XX.
  1809         88  VALID-CO-ID                          VALUE 'AG'.
  1810     12  AG-CONTROL-PRIMARY.
  1811         16  AG-COMPANY-CD                     PIC X.
  1812         16  AG-CONTROL.
  1813             20  AG-CTL-1.
  1814                 24  AG-CARR-GROUP.
  1815                     28  AG-CARRIER            PIC X.
  1816                     28  AG-GROUPING           PIC X(6).
  1817                 24  AG-BANK                   PIC X(10).
  1818             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  35
* EL050.cbl
  1819                 24  AG-EXP-DT                 PIC XX.
  1820         16  AG-TYPE                           PIC X.
  1821             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1822             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1823     12  AG-MAINT-INFORMATION.
  1824         16  AG-LAST-MAINT-DT                  PIC XX.
  1825         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1826         16  AG-LAST-MAINT-USER                PIC X(4).
  1827         16  FILLER                            PIC X(10).
  1828     12  AG-EFF-DT                             PIC XX.
  1829     12  AG-COMM-STRUCTURE.
  1830         16  AG-AGT-COMMS OCCURS 10.
  1831             20  AG-AGT                PIC X(10).
  1832             20  AG-COM-TYP            PIC X.
  1833             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1834             20  AG-RECALC-LV-INDIC    PIC X.
  1835             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1836             20  AG-LRCALC-LV-INDIC    PIC X.
  1837             20  FILLER                PIC X(05).
  1838     12  FILLER                  PIC X(145).
  1839******************************************************************
  1840*    COPY ERCRESS.
  1841******************************************************************
  1842*                                                                *
  1843*                            ERCRESS                             *
  1844*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1845*                            VMOD=2.002                          *
  1846*                                                                *
  1847*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1848*                                                                *
  1849*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1850*   VSAM RESIDENT STATE TAX MASTER                              *
  1851*                                                                *
  1852*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1853*                                                                *
  1854*   FILE TYPE = VSAM,KSDS                                        *
  1855*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1856*                                                                *
  1857*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1858*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1859*                                                                *
  1860*   LOG = NO                                                     *
  1861*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1862*                                                                *
  1863*                                                                *
  1864******************************************************************
  1865
  1866 01  RESIDENT-STATE-TAX-MASTER.
  1867
  1868     10  ERRESS-PRIMARY-KEY.
  1869         15  RES-COMPANY-CD        PIC X.
  1870         15  RES-RESIDENT-STATE    PIC XX.
  1871         15  RES-COVERAGE-CATEGORY PIC X.
  1872         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1873*                                      YYYYMMDD
  1874*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1875
  1876     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  36
* EL050.cbl
  1877
  1878         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1879         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1880         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1881         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1882
  1883     10 RES-RECALC-SW              PIC   X.
  1884         88 RECALC                VALUE 'Y'.
  1885         88 NO-RECALC             VALUE 'N'.
  1886     10  RES-MAINT-BY              PIC X(4).
  1887     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1888     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1889*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  37
* EL050.cbl
  1891*    COPY ERCRESC.
  1892******************************************************************
  1893*                                                                *
  1894*                            ERCRESC                             *
  1895*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1896*                            VMOD=2.003                          *
  1897*                                                                *
  1898*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1899*                                                                *
  1900*   FILE TYPE = VSAM,KSDS                                        *
  1901*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1902*                                                                *
  1903*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1904*       ALTERNATE PATH1 = NONE                                   *
  1905*                                                                *
  1906*   LOG = NO                                                     *
  1907*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1908*                                                                *
  1909******************************************************************
  1910
  1911 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1912
  1913     10  ERRESC-RECORD-KEY.
  1914         15  RESC-COMPANY-CD           PIC   X.
  1915         15  RESC-CARRIER              PIC   X.
  1916         15  RESC-GROUP                PIC   X(6).
  1917         15  RESC-STATE                PIC   XX.
  1918         15  RESC-ACCOUNT              PIC   X(10).
  1919         15  RESC-AGENT                PIC   X(10).
  1920         15  RESC-RESIDENT-STATE       PIC   XX.
  1921         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1922*                                           YYYYMMDD
  1923     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1924
  1925     10  RESC-COMM-RECORD-DATA.
  1926         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1927             20 RESC-COVERAGE-CAT      PIC    X.
  1928             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1929             20 RESC-COMMISSION-TAB REDEFINES
  1930                RESC-COMMISSION-PER    PIC  XXX.
  1931
  1932     10  RESC-MAINT-BY                 PIC X(4).
  1933     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1934     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1935*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  38
* EL050.cbl
  1937*    COPY ERCPLAN.
  1938******************************************************************
  1939*                                                                *
  1940*                                                                *
  1941*                            ERCPLAN                             *
  1942*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1943*                            VMOD=2.003                          *
  1944*                                                                *
  1945*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1946*                                                                *
  1947*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1948*   PLAN MASTER                                                  *
  1949*                                                                *
  1950*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1951*                                                                *
  1952*   FILE TYPE = VSAM,KSDS                                        *
  1953*   RECORD SIZE = 420   RECFORM = FIX                            *
  1954*                                                                *
  1955*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1956*       ALTERNATE PATH1 = N/A                                    *
  1957*                                                                *
  1958*   LOG = NO                                                     *
  1959*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1960*                                                                *
  1961*                                                                *
  1962******************************************************************
  1963
  1964 01  PLAN-MASTER.
  1965     12  PL-RECORD-ID                      PIC XX.
  1966         88  VALID-PL-ID                      VALUE 'PL'.
  1967
  1968     12  PL-CONTROL-PRIMARY.
  1969         16  PL-COMPANY-CD                 PIC X.
  1970         16  PL-MSTR-CNTRL.
  1971             20  PL-CONTROL-A.
  1972                 24  PL-CARRIER            PIC X.
  1973                 24  PL-GROUPING           PIC X(6).
  1974                 24  PL-STATE              PIC XX.
  1975                 24  PL-ACCOUNT            PIC X(10).
  1976             20  PL-BENEFIT-TYPE           PIC X.
  1977             20  PL-BENEFIT-CODE           PIC XX.
  1978             20  PL-REVISION-NO            PIC X(3).
  1979
  1980     12  PL-CONTROL-BY-VAR-GRP.
  1981         16  PL-COMPANY-CD-A1              PIC X.
  1982         16  PL-VG-CARRIER                 PIC X.
  1983         16  PL-VG-GROUPING                PIC X(6).
  1984         16  PL-VG-STATE                   PIC XX.
  1985         16  PL-VG-ACCOUNT                 PIC X(10).
  1986         16  PL-BENEFIT-TYPE-A1            PIC X.
  1987         16  PL-BENEFIT-CODE-A1            PIC XX.
  1988         16  PL-REVISION-NO-A1             PIC 999.
  1989
  1990     12  PL-MAINT-INFORMATION.
  1991         16  PL-LAST-MAINT-DT              PIC XX.
  1992         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1993         16  PL-LAST-MAINT-USER            PIC X(4).
  1994         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  39
* EL050.cbl
  1995
  1996     12  PL-LIABILITY-LIMITS.
  1997         16  PL-ATT-AGE                    PIC S99        COMP-3.
  1998         16  PL-L-LIMITS        OCCURS 8 TIMES.
  1999             20  PL-LM-AGE                 PIC S99        COMP-3.
  2000             20  PL-LM-DUR                 PIC S999       COMP-3.
  2001             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2002             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2003
  2004     12  FILLER                            PIC X(30).
  2005
  2006     12  PL-GL-ACCOUNT-NOS.
  2007         16  PL-PREMIUM-GL                 PIC X(8).
  2008         16  PL-COMM-GL                    PIC X(8).
  2009         16  PL-CLAIM-GL                   PIC X(8).
  2010     12  FILLER                            PIC X(24).
  2011     12  PL-TOLERANCES.
  2012         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2013         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2014         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2015         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2016         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2017         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2018     12  PL-OVER-SHORT.
  2019         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2020         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2021     12  FILLER                            PIC X(24).
  2022     12  PLAN-MISC.
  2023         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2024         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2025         16  PL-IG                         PIC X.
  2026         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2027         16  PL-POLICY-FORM                PIC X(12).
  2028         16  PL-EDIT-FOR-FORM              PIC X(01).
  2029         16  PL-DEV-CODE                   PIC XXX.
  2030         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2031         16  PL-CALC-METHOD                PIC X.
  2032         16  PL-BENEFIT-GROUP              PIC X(05).
  2033         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2034
  2035         16  FILLER                        PIC X(99).
  2036******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  40
* EL050.cbl
  2038*    COPY ELCCERT.
  2039******************************************************************
  2040*                                                                *
  2041*                            ELCCERT.                            *
  2042*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2043*                            VMOD=2.013                          *
  2044*                                                                *
  2045*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2046*                                                                *
  2047*   FILE TYPE = VSAM,KSDS                                        *
  2048*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2049*                                                                *
  2050*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2051*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2052*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2053*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2054*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2055*                                                                *
  2056*   LOG = YES                                                    *
  2057*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2058******************************************************************
  2059*                   C H A N G E   L O G
  2060*
  2061* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2062*-----------------------------------------------------------------
  2063*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2064* EFFECTIVE    NUMBER
  2065*-----------------------------------------------------------------
  2066* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2067* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2068* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2069* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2070* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2071* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2072* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2073* 032612  CR2011110200001  PEMA  AHL CHANGES
  2074******************************************************************
  2075
  2076 01  CERTIFICATE-MASTER.
  2077     12  CM-RECORD-ID                      PIC XX.
  2078         88  VALID-CM-ID                      VALUE 'CM'.
  2079
  2080     12  CM-CONTROL-PRIMARY.
  2081         16  CM-COMPANY-CD                 PIC X.
  2082         16  CM-CARRIER                    PIC X.
  2083         16  CM-GROUPING.
  2084             20  CM-GROUPING-PREFIX        PIC X(3).
  2085             20  CM-GROUPING-PRIME         PIC X(3).
  2086         16  CM-STATE                      PIC XX.
  2087         16  CM-ACCOUNT.
  2088             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2089             20  CM-ACCOUNT-PRIME          PIC X(6).
  2090         16  CM-CERT-EFF-DT                PIC XX.
  2091         16  CM-CERT-NO.
  2092             20  CM-CERT-PRIME             PIC X(10).
  2093             20  CM-CERT-SFX               PIC X.
  2094
  2095     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  41
* EL050.cbl
  2096         16  CM-COMPANY-CD-A1              PIC X.
  2097         16  CM-INSURED-LAST-NAME          PIC X(15).
  2098         16  CM-INSURED-INITIALS.
  2099             20  CM-INSURED-INITIAL1       PIC X.
  2100             20  CM-INSURED-INITIAL2       PIC X.
  2101
  2102     12  CM-CONTROL-BY-SSN.
  2103         16  CM-COMPANY-CD-A2              PIC X.
  2104         16  CM-SOC-SEC-NO.
  2105             20  CM-SSN-STATE              PIC XX.
  2106             20  CM-SSN-ACCOUNT            PIC X(6).
  2107             20  CM-SSN-LN3.
  2108                 25  CM-INSURED-INITIALS-A2.
  2109                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2110                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2111                 25 CM-PART-LAST-NAME-A2         PIC X.
  2112
  2113     12  CM-CONTROL-BY-CERT-NO.
  2114         16  CM-COMPANY-CD-A4              PIC X.
  2115         16  CM-CERT-NO-A4                 PIC X(11).
  2116
  2117     12  CM-CONTROL-BY-MEMB.
  2118         16  CM-COMPANY-CD-A5              PIC X.
  2119         16  CM-MEMBER-NO.
  2120             20  CM-MEMB-STATE             PIC XX.
  2121             20  CM-MEMB-ACCOUNT           PIC X(6).
  2122             20  CM-MEMB-LN4.
  2123                 25  CM-INSURED-INITIALS-A5.
  2124                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2125                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2126                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2127
  2128     12  CM-INSURED-PROFILE-DATA.
  2129         16  CM-INSURED-FIRST-NAME.
  2130             20  CM-INSURED-1ST-INIT       PIC X.
  2131             20  FILLER                    PIC X(9).
  2132         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2133         16  CM-INSURED-SEX                PIC X.
  2134             88  CM-SEX-MALE                  VALUE 'M'.
  2135             88  CM-SEX-FEMAL                 VALUE 'F'.
  2136         16  CM-INSURED-JOINT-AGE          PIC 99.
  2137         16  CM-JOINT-INSURED-NAME.
  2138             20  CM-JT-LAST-NAME           PIC X(15).
  2139             20  CM-JT-FIRST-NAME.
  2140                 24  CM-JT-1ST-INIT        PIC X.
  2141                 24  FILLER                PIC X(9).
  2142             20  CM-JT-INITIAL             PIC X.
  2143
  2144     12  CM-LIFE-DATA.
  2145         16  CM-LF-BENEFIT-CD              PIC XX.
  2146         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2147         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2148         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2149         16  CM-LF-DEV-CODE                PIC XXX.
  2150         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2151         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2152         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2153         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  42
* EL050.cbl
  2154         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2155         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2156         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2157         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2158         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2159         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2160         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2161         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2162         16  FILLER                        PIC XX.
  2163
  2164     12  CM-AH-DATA.
  2165         16  CM-AH-BENEFIT-CD              PIC XX.
  2166         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2167         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2168         16  CM-AH-DEV-CODE                PIC XXX.
  2169         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2170         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2171         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2172         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2173         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2174         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2175         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2176         16  CM-AH-PAID-THRU-DT            PIC XX.
  2177             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2178         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2179         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2180         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2181         16  FILLER                        PIC X.
  2182
  2183     12  CM-LOAN-INFORMATION.
  2184         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2185         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2186                                           PIC S9(5)V99  COMP-3.
  2187         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2188         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2189         16  CM-PAY-FREQUENCY              PIC S99.
  2190         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2191         16  CM-RATE-CLASS                 PIC XX.
  2192         16  CM-BENEFICIARY                PIC X(25).
  2193         16  CM-POLICY-FORM-NO             PIC X(12).
  2194         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2195         16  CM-LAST-ADD-ON-DT             PIC XX.
  2196         16  CM-DEDUCTIBLE-AMOUNTS.
  2197             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2198             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2199         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2200             20  CM-RESIDENT-STATE         PIC XX.
  2201             20  CM-RATE-CODE              PIC X(4).
  2202             20  FILLER                    PIC XX.
  2203         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2204             20  CM-LOAN-OFFICER           PIC X(5).
  2205             20  FILLER                    PIC XXX.
  2206         16  CM-CSR-CODE                   PIC XXX.
  2207         16  CM-UNDERWRITING-CODE          PIC X.
  2208             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2209         16  CM-POST-CARD-IND              PIC X.
  2210         16  CM-NH-INTERFACE-SW            PIC X.
  2211         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  43
* EL050.cbl
  2212             88  CM-SING-PRM                  VALUE '1'.
  2213             88  CM-O-B-COVERAGE              VALUE '2'.
  2214             88  CM-OPEN-END                  VALUE '3'.
  2215         16  CM-IND-GRP-TYPE               PIC X.
  2216             88  CM-INDIVIDUAL                VALUE 'I'.
  2217             88  CM-GROUP                     VALUE 'G'.
  2218         16  CM-SKIP-CODE                  PIC X.
  2219             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2220             88  SKIP-JULY                    VALUE '1'.
  2221             88  SKIP-AUGUST                  VALUE '2'.
  2222             88  SKIP-SEPTEMBER               VALUE '3'.
  2223             88  SKIP-JULY-AUG                VALUE '4'.
  2224             88  SKIP-AUG-SEPT                VALUE '5'.
  2225             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2226             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2227             88  SKIP-JUNE                    VALUE '8'.
  2228             88  SKIP-JUNE-JULY               VALUE '9'.
  2229             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2230             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2231         16  CM-PAYMENT-MODE               PIC X.
  2232             88  PAY-MONTHLY                  VALUE SPACE.
  2233             88  PAY-WEEKLY                   VALUE '1'.
  2234             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2235             88  PAY-BI-WEEKLY                VALUE '3'.
  2236             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2237         16  CM-LOAN-NUMBER                PIC X(8).
  2238         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2239         16  CM-OLD-LOF                    PIC XXX.
  2240*        16  CM-LOAN-OFFICER               PIC XXX.
  2241         16  CM-REIN-TABLE                 PIC XXX.
  2242         16  CM-SPECIAL-REIN-CODE          PIC X.
  2243         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2244         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2245         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2246
  2247     12  CM-STATUS-DATA.
  2248         16  CM-ENTRY-STATUS               PIC X.
  2249         16  CM-ENTRY-DT                   PIC XX.
  2250
  2251         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2252         16  CM-LF-CANCEL-DT               PIC XX.
  2253         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2254
  2255         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2256         16  CM-LF-DEATH-DT                PIC XX.
  2257         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2258
  2259         16  CM-LF-CURRENT-STATUS          PIC X.
  2260             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2261                                                'M' '4' '5' '9'.
  2262             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2263             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2264             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2265             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2266             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2267             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2268             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2269             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  44
* EL050.cbl
  2270             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2271             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2272             88  CM-LF-DECLINED               VALUE 'D'.
  2273             88  CM-LF-VOIDED                 VALUE 'V'.
  2274
  2275         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2276         16  CM-AH-CANCEL-DT               PIC XX.
  2277         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2278
  2279         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2280         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2281         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2282
  2283         16  CM-AH-CURRENT-STATUS          PIC X.
  2284             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2285                                                'M' '4' '5' '9'.
  2286             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2287             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2288             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2289             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2290             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2291             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2292             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2293             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2294             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2295             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2296             88  CM-AH-DECLINED               VALUE 'D'.
  2297             88  CM-AH-VOIDED                 VALUE 'V'.
  2298
  2299         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2300             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2301             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2302             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2303         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2304
  2305         16  CM-ENTRY-BATCH                PIC X(6).
  2306         16  CM-LF-EXIT-BATCH              PIC X(6).
  2307         16  CM-AH-EXIT-BATCH              PIC X(6).
  2308         16  CM-LAST-MONTH-END             PIC XX.
  2309
  2310     12  CM-NOTE-SW                        PIC X.
  2311         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2312         88  CERT-NOTES-PRESENT               VALUE '1'.
  2313         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2314         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2315         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2316         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2317         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2318         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2319     12  CM-COMP-EXCP-SW                   PIC X.
  2320         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2321         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2322     12  CM-INSURED-ADDRESS-SW             PIC X.
  2323         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2324         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2325
  2326*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2327     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  45
* EL050.cbl
  2328     12  FILLER                            PIC X.
  2329
  2330*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2331     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2332     12  FILLER                            PIC X.
  2333*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2334     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2335
  2336     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2337         88  CERT-ADDED-BATCH                 VALUE ' '.
  2338         88  CERT-ADDED-ONLINE                VALUE '1'.
  2339         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2340         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2341         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2342     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2343         88  CERT-AS-LOADED                   VALUE ' '.
  2344         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2345         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2346         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2347         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2348         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2349         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2350         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2351
  2352     12  CM-ACCOUNT-COMM-PCTS.
  2353         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2354         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2355
  2356     12  CM-USER-FIELD                     PIC X.
  2357     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2358     12  CM-CLP-STATE                      PIC XX.
  2359     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2360     12  CM-USER-RESERVED                  PIC XXX.
  2361     12  FILLER REDEFINES CM-USER-RESERVED.
  2362         16  CM-AH-CLASS-CD                PIC XX.
  2363         16  F                             PIC X.
  2364******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  46
* EL050.cbl
  2366*    COPY ERCMAIL.
  2367******************************************************************
  2368*                                                                *
  2369*                                                                *
  2370*                            ERCMAIL                             *
  2371*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2372*                            VMOD=2.003                          *
  2373*                                                                *
  2374*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2375*                                                                *
  2376*   FILE TYPE = VSAM,KSDS                                        *
  2377*   RECORD SIZE = 374   RECFORM = FIX                            *
  2378*                                                                *
  2379*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2380*   ALTERNATE PATH    = NOT USED                                 *
  2381*                                                                *
  2382*   LOG = YES                                                    *
  2383*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2384******************************************************************
  2385*                   C H A N G E   L O G
  2386*
  2387* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2388*-----------------------------------------------------------------
  2389*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2390* EFFECTIVE    NUMBER
  2391*-----------------------------------------------------------------
  2392* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2393* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2394* 111108                   PEMA  ADD CRED BENE ADDR2
  2395******************************************************************
  2396
  2397 01  MAILING-DATA.
  2398     12  MA-RECORD-ID                      PIC XX.
  2399         88  VALID-MA-ID                       VALUE 'MA'.
  2400
  2401     12  MA-CONTROL-PRIMARY.
  2402         16  MA-COMPANY-CD                 PIC X.
  2403         16  MA-CARRIER                    PIC X.
  2404         16  MA-GROUPING.
  2405             20  MA-GROUPING-PREFIX        PIC XXX.
  2406             20  MA-GROUPING-PRIME         PIC XXX.
  2407         16  MA-STATE                      PIC XX.
  2408         16  MA-ACCOUNT.
  2409             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2410             20  MA-ACCOUNT-PRIME          PIC X(6).
  2411         16  MA-CERT-EFF-DT                PIC XX.
  2412         16  MA-CERT-NO.
  2413             20  MA-CERT-PRIME             PIC X(10).
  2414             20  MA-CERT-SFX               PIC X.
  2415
  2416     12  FILLER                            PIC XX.
  2417
  2418     12  MA-ACCESS-CONTROL.
  2419         16  MA-SOURCE-SYSTEM              PIC XX.
  2420             88  MA-FROM-CREDIT                VALUE 'CR'.
  2421             88  MA-FROM-VSI                   VALUE 'VS'.
  2422             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2423             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  47
* EL050.cbl
  2424         16  MA-RECORD-ADD-DT              PIC XX.
  2425         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2426         16  MA-LAST-MAINT-DT              PIC XX.
  2427         16  MA-LAST-MAINT-BY              PIC XXXX.
  2428         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2429
  2430     12  MA-PROFILE-INFO.
  2431         16  MA-QUALIFY-CODE-1             PIC XX.
  2432         16  MA-QUALIFY-CODE-2             PIC XX.
  2433         16  MA-QUALIFY-CODE-3             PIC XX.
  2434         16  MA-QUALIFY-CODE-4             PIC XX.
  2435         16  MA-QUALIFY-CODE-5             PIC XX.
  2436
  2437         16  MA-INSURED-LAST-NAME          PIC X(15).
  2438         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2439         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2440         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2441         16  MA-INSURED-BIRTH-DT           PIC XX.
  2442         16  MA-INSURED-SEX                PIC X.
  2443             88  MA-SEX-MALE                   VALUE 'M'.
  2444             88  MA-SEX-FEMALE                 VALUE 'F'.
  2445         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2446
  2447         16  MA-ADDRESS-CORRECTED          PIC X.
  2448         16  MA-JOINT-BIRTH-DT             PIC XX.
  2449*        16  FILLER                        PIC X(12).
  2450
  2451         16  MA-ADDRESS-LINE-1             PIC X(30).
  2452         16  MA-ADDRESS-LINE-2             PIC X(30).
  2453         16  MA-CITY-STATE.
  2454             20  MA-CITY                   PIC X(28).
  2455             20  MA-ADDR-STATE             PIC XX.
  2456         16  MA-ZIP.
  2457             20  MA-ZIP-CODE.
  2458                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2459                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2460                 24  FILLER                PIC X(4).
  2461             20  MA-ZIP-PLUS4              PIC X(4).
  2462         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2463             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2464             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2465             20  FILLER                    PIC X(3).
  2466
  2467         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2468
  2469         16  FILLER                        PIC XXX.
  2470*        16  FILLER                        PIC X(10).
  2471
  2472     12  MA-CRED-BENE-INFO.
  2473         16  MA-CRED-BENE-NAME                 PIC X(25).
  2474         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2475         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2476         16  MA-CRED-BENE-CTYST.
  2477             20  MA-CRED-BENE-CITY             PIC X(28).
  2478             20  MA-CRED-BENE-STATE            PIC XX.
  2479         16  MA-CRED-BENE-ZIP.
  2480             20  MA-CB-ZIP-CODE.
  2481                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  48
* EL050.cbl
  2482                     88  MA-CB-CANADIAN-POST-CODE
  2483                                           VALUE 'A' THRU 'Z'.
  2484                 24  FILLER                    PIC X(4).
  2485             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2486         16  MA-CB-CANADIAN-POSTAL-CODE
  2487                            REDEFINES MA-CRED-BENE-ZIP.
  2488             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2489             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2490             20  FILLER                        PIC X(3).
  2491     12  MA-POST-CARD-MAIL-DATA.
  2492         16  MA-MAIL-DATA OCCURS 7.
  2493             20  MA-MAIL-TYPE              PIC X.
  2494                 88  MA-12MO-MAILING           VALUE '1'.
  2495                 88  MA-EXP-MAILING            VALUE '2'.
  2496             20  MA-MAIL-STATUS            PIC X.
  2497                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2498                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2499                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2500             20  MA-MAIL-DATE              PIC XX.
  2501     12  FILLER                            PIC XX.
  2502     12  FILLER                            PIC XX.
  2503*    12  FILLER                            PIC X(30).
  2504******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  49
* EL050.cbl
  2506*    COPY ERCPNDM.
  2507******************************************************************
  2508*                                                                *
  2509*                                                                *
  2510*                            ERCPNDM                             *
  2511*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2512*                            VMOD=2.003                          *
  2513*                                                                *
  2514*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2515*                                                                *
  2516*   FILE TYPE = VSAM,KSDS                                        *
  2517*   RECORD SIZE = 374   RECFORM = FIX                            *
  2518*                                                                *
  2519*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2520*   ALTERNATE PATH    = NOT USED                                 *
  2521*                                                                *
  2522*   LOG = YES                                                    *
  2523*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2524******************************************************************
  2525*                   C H A N G E   L O G
  2526*
  2527* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2528*-----------------------------------------------------------------
  2529*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2530* EFFECTIVE    NUMBER
  2531*-----------------------------------------------------------------
  2532* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2533* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2534* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2535******************************************************************
  2536
  2537 01  PENDING-MAILING-DATA.
  2538     12  PM-RECORD-ID                      PIC XX.
  2539         88  VALID-MA-ID                       VALUE 'PM'.
  2540
  2541     12  PM-CONTROL-PRIMARY.
  2542         16  PM-COMPANY-CD                 PIC X.
  2543         16  PM-ENTRY-BATCH                PIC X(6).
  2544         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2545         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2546
  2547     12  FILLER                            PIC X(14).
  2548
  2549     12  PM-ACCESS-CONTROL.
  2550         16  PM-SOURCE-SYSTEM              PIC XX.
  2551             88  PM-FROM-CREDIT                VALUE 'CR'.
  2552             88  PM-FROM-VSI                   VALUE 'VS'.
  2553             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2554             88  PM-FROM-OTHER                 VALUE 'OT'.
  2555         16  PM-RECORD-ADD-DT              PIC XX.
  2556         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2557         16  PM-LAST-MAINT-DT              PIC XX.
  2558         16  PM-LAST-MAINT-BY              PIC XXXX.
  2559         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2560
  2561     12  PM-PROFILE-INFO.
  2562         16  PM-QUALIFY-CODE-1             PIC XX.
  2563         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  50
* EL050.cbl
  2564         16  PM-QUALIFY-CODE-3             PIC XX.
  2565         16  PM-QUALIFY-CODE-4             PIC XX.
  2566         16  PM-QUALIFY-CODE-5             PIC XX.
  2567
  2568         16  PM-INSURED-LAST-NAME          PIC X(15).
  2569         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2570         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2571         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2572         16  PM-INSURED-BIRTH-DT           PIC XX.
  2573         16  PM-INSURED-SEX                PIC X.
  2574             88  PM-SEX-MALE                   VALUE 'M'.
  2575             88  PM-SEX-FEMALE                 VALUE 'F'.
  2576         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2577
  2578         16  PM-ADDRESS-CORRECTED          PIC X.
  2579         16  PM-JOINT-BIRTH-DT             PIC XX.
  2580*        16  FILLER                        PIC X(12).
  2581
  2582         16  PM-ADDRESS-LINE-1             PIC X(30).
  2583         16  PM-ADDRESS-LINE-2             PIC X(30).
  2584         16  PM-CITY-STATE.
  2585             20  PM-CITY                   PIC X(28).
  2586             20  PM-STATE                  PIC XX.
  2587         16  PM-ZIP.
  2588             20  PM-ZIP-CODE.
  2589                 24  PM-ZIP-1              PIC X.
  2590                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2591                 24  FILLER                PIC X(4).
  2592             20  PM-ZIP-PLUS4              PIC X(4).
  2593         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2594             20  PM-CAN-POST1              PIC XXX.
  2595             20  PM-CAN-POST2              PIC XXX.
  2596             20  FILLER                    PIC XXX.
  2597
  2598         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2599
  2600         16  FILLER                        PIC X(03).
  2601
  2602     12  PM-CRED-BENE-INFO.
  2603         16  PM-CRED-BENE-NAME             PIC X(25).
  2604         16  PM-CRED-BENE-ADDR             PIC X(30).
  2605         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2606         16  PM-CRED-BENE-CTYST.
  2607             20  PM-CRED-BENE-CITY         PIC X(28).
  2608             20  PM-CRED-BENE-STATE        PIC XX.
  2609         16  PM-CRED-BENE-ZIP.
  2610             20  PM-CB-ZIP-CODE.
  2611                 24  PM-CB-ZIP-1           PIC X.
  2612                     88  PM-CB-CANADIAN-POST-CODE
  2613                                  VALUE 'A' THRU 'Z'.
  2614                 24  FILLER                PIC X(4).
  2615             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2616         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2617             20  PM-CB-CAN-POST1           PIC XXX.
  2618             20  PM-CB-CAN-POST2           PIC XXX.
  2619             20  FILLER                    PIC XXX.
  2620     12  PM-POST-CARD-MAIL-DATA.
  2621         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  51
* EL050.cbl
  2622             20  PM-MAIL-TYPE              PIC X.
  2623                 88  PM-12MO-MAILING           VALUE '1'.
  2624                 88  PM-EXP-MAILING            VALUE '2'.
  2625             20  PM-MAIL-STATUS            PIC X.
  2626                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2627                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2628                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2629             20  PM-MAIL-DATE              PIC XX.
  2630     12  FILLER                            PIC XX.
  2631     12  FILLER                            PIC X(12).
  2632*    12  FILLER                            PIC X(30).
  2633
  2634******************************************************************
  2635*                                COPY ERCLOFC.
  2636******************************************************************
  2637*                                                                *
  2638*                                                                *
  2639*                            ERCLOFC                             *
  2640*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2641*                            VMOD=2.003                          *
  2642*                                                                *
  2643*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2644*                                                                *
  2645*   FILE TYPE = VSAM,KSDS                                        *
  2646*   RECORD SIZE = 670   RECFORM = FIX                            *
  2647*                                                                *
  2648*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2649*                                                                *
  2650*   LOG = YES                                                    *
  2651*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2652*                                                                *
  2653******************************************************************
  2654
  2655 01  LOAN-OFFICER-MASTER.
  2656     12  LO-RECORD-ID                PIC XX.
  2657         88  VALID-LO-ID                VALUE 'LO'.
  2658
  2659     12  LO-CONTROL-PRIMARY.
  2660         16  LO-COMPANY-CD           PIC X.
  2661         16  LO-CARRIER              PIC X.
  2662         16  LO-GROUPING.
  2663             20  LO-GROUPING-PREFIX  PIC XXX.
  2664             20  LO-GROUPING-PRIME   PIC XXX.
  2665         16  LO-STATE                PIC XX.
  2666         16  LO-ACCOUNT.
  2667             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2668             20  LO-ACCOUNT-PRIME    PIC X(6).
  2669         16  LO-OFFICER-CODE         PIC X(5).
  2670
  2671     12  LO-OFFICER-NAME             PIC X(30).
  2672
  2673     12  LO-LAST-MAINT-DT            PIC XX.
  2674     12  LO-LAST-USER                PIC X(4).
  2675     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2676
  2677     12  LO-COMP-CONTROL             PIC X.
  2678             88  LO-SHOW-COMP           VALUE 'Y'.
  2679             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  52
* EL050.cbl
  2680     12  LO-DETAIL-CONTROL           PIC X.
  2681             88  LO-PRINT-DETAIL        VALUE 'D'.
  2682             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2683
  2684     12  LO-SV-CARRIER               PIC X.
  2685     12  LO-SV-GROUPING              PIC X(6).
  2686     12  LO-SV-STATE                 PIC XX.
  2687
  2688     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2689     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2690
  2691     12  LO-OFFICER-INFO.
  2692         16  FILLER OCCURS 12 TIMES.
  2693             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2694             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2695             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2696             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2697             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2698             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2699             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2700             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2701     12  FILLER                      PIC X(198).
  2702******************************************************************
  2703*                                COPY ERCPDEF.
  2704******************************************************************
  2705*                                                                *
  2706*                                                                *
  2707*                            ERCPDEF.                            *
  2708*                                                                *
  2709*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2710*                                                                *
  2711*    FILE TYPE = VSAM,KSDS                                       *
  2712*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2713*                                                                *
  2714*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2715*                                                                *
  2716*    LOG = YES                                                   *
  2717*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2718******************************************************************
  2719 01  PRODUCT-MASTER.
  2720    12  PD-RECORD-ID                 PIC X(02).
  2721        88  VALID-PD-ID                  VALUE 'PD'.
  2722    12  PD-CONTROL-PRIMARY.
  2723        16  PD-COMPANY-CD            PIC X.
  2724        16  PD-STATE                 PIC XX.
  2725        16  PD-PRODUCT-CD            PIC XXX.
  2726        16  PD-FILLER                PIC X(7).
  2727        16  PD-BEN-TYPE              PIC X.
  2728        16  PD-BEN-CODE              PIC XX.
  2729        16  PD-PROD-EXP-DT           PIC XX.
  2730    12  FILLER                       PIC X(50).
  2731    12  PD-PRODUCT-DATA OCCURS 8.
  2732        16  PD-PROD-CODE             PIC X.
  2733            88  PD-PROD-LIFE           VALUE 'L'.
  2734            88  PD-PROD-PROP           VALUE 'P'.
  2735            88  PD-PROD-AH             VALUE 'A'.
  2736            88  PD-PROD-IU             VALUE 'I'.
  2737            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  53
* EL050.cbl
  2738        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2739        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2740        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2741        16  PD-MAX-TERM              PIC S999        COMP-3.
  2742        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2743        16  FILLER                   PIC X.
  2744        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2745        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2746        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2747        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2748        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2749        16  PD-REC-CRIT-PERIOD       PIC X.
  2750        16  PD-RTW-MOS               PIC 99.
  2751        16  FILLER                   PIC X(5).
  2752    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2753    12  PD-TERM-LIMITS OCCURS 15.
  2754        16  PD-LOW-TERM              PIC S999        COMP-3.
  2755        16  PD-HI-TERM               PIC S999        COMP-3.
  2756*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2757    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2758        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2759        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2760    12  PD-EARN-FACTORS.
  2761        16  FILLER OCCURS 15.
  2762            20  FILLER OCCURS 15.
  2763                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2764    12  PD-PRODUCT-DESC              PIC X(80).
  2765    12  PD-TRUNCATED                 PIC X.
  2766    12  FILLER                       PIC X(59).
  2767    12  PD-MAINT-INFORMATION.
  2768        16  PD-LAST-MAINT-DT         PIC X(02).
  2769        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2770        16  PD-LAST-MAINT-BY         PIC X(04).
  2771*                                COPY ELCSTATE.
  2772******************************************************************
  2773*                                                                *
  2774*                                                                *
  2775*                            ELCSTATE.                           *
  2776*                                                                *
  2777*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2778*                                                                *
  2779*   FILE TYPE = VSAM,KSDS                                        *
  2780*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2781*                                                                *
  2782*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2783*       ALTERNATE INDEX = NONE                                   *
  2784*                                                                *
  2785*   LOG = YES                                                    *
  2786*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2787******************************************************************
  2788*                   C H A N G E   L O G
  2789*
  2790* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2791*-----------------------------------------------------------------
  2792*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2793* EFFECTIVE    NUMBER
  2794*-----------------------------------------------------------------
  2795* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  54
* EL050.cbl
  2796******************************************************************
  2797*
  2798 01  STATE-FILE.
  2799     12  SF-RECORD-ID                       PIC XX.
  2800         88  VALID-CF-ID                        VALUE 'SF'.
  2801     12  SF-CONTROL-PRIMARY.
  2802         16  SF-COMPANY-ID                  PIC XXX.
  2803         16  SF-CARRIER-CODE                PIC X.
  2804         16  SF-GROUPING                    PIC X(6).
  2805         16  SF-STATE-CODE                  PIC XX.
  2806         16  SF-EXPIRE-DATE                 PIC 9(8).
  2807****************************************************************
  2808*             STATE CONTROLS
  2809****************************************************************
  2810     12  SF-LAST-MAINT-DT                   PIC XX.
  2811     12  SF-LAST-MAINT-BY                   PIC X(4).
  2812     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2813     12  SF-STATE-RT-CONTROLS.
  2814         16  SF-ST-RT-CALC                  PIC X.
  2815     12  SF-ST-TAX-CONTROLS.
  2816         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2817         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2818         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2819     12  SF-ST-REFUND-OPTIONS.
  2820         16  SF-ST-RF-LR-CALC               PIC X.
  2821         16  SF-ST-RF-LL-CALC               PIC X.
  2822         16  SF-ST-RF-LN-CALC               PIC X.
  2823         16  SF-ST-RF-AH-CALC               PIC X.
  2824         16  SF-ST-RF-CP-CALC               PIC X.
  2825     12  SF-ST-UNEARN-PREM-OPTIONS.
  2826         16  SF-ST-LUEP-R78                 PIC X.
  2827         16  SF-ST-LUEP-PRO                 PIC X.
  2828         16  SF-ST-LUEP-ST                  PIC X.
  2829         16  SF-ST-LUEP-DOM                 PIC X.
  2830         16  SF-ST-AUEP-R78                 PIC X.
  2831         16  SF-ST-AUEP-PRO                 PIC X.
  2832         16  SF-ST-AUEP-ST                  PIC X.
  2833         16  SF-ST-AUEP-DOM                 PIC X.
  2834         16  SF-ST-CUEP-R78                 PIC X.
  2835         16  SF-ST-CUEP-PRO                 PIC X.
  2836         16  SF-ST-CUEP-ST                  PIC X.
  2837         16  SF-ST-CUEP-DOM                 PIC X.
  2838     12  SF-ST-EARN-PREM-OPTIONS.
  2839         16  SF-ST-LEP-R78                  PIC X.
  2840         16  SF-ST-LEP-PRO                  PIC X.
  2841         16  SF-ST-LEP-ST                   PIC X.
  2842         16  SF-ST-LEP-DOM                  PIC X.
  2843         16  SF-ST-AEP-R78                  PIC X.
  2844         16  SF-ST-AEP-PRO                  PIC X.
  2845         16  SF-ST-AEP-ST                   PIC X.
  2846         16  SF-ST-AEP-DOM                  PIC X.
  2847         16  SF-ST-CEP-R78                  PIC X.
  2848         16  SF-ST-CEP-PRO                  PIC X.
  2849         16  SF-ST-CEP-ST                   PIC X.
  2850         16  SF-ST-CEP-DOM                  PIC X.
  2851     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  55
* EL050.cbl
  2853*    COPY ELCCRTT.
  2854******************************************************************
  2855*                                                                *
  2856*                            ELCCRTT.                            *
  2857*                                                                *
  2858*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2859*                                                                *
  2860*   FILE TYPE = VSAM,KSDS                                        *
  2861*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2862*                                                                *
  2863*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2864*                                                                *
  2865*   LOG = YES                                                    *
  2866*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2867******************************************************************
  2868*                   C H A N G E   L O G
  2869*
  2870* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2871*-----------------------------------------------------------------
  2872*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2873* EFFECTIVE    NUMBER
  2874*-----------------------------------------------------------------
  2875* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2876* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2877* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2878******************************************************************
  2879
  2880 01  CERTIFICATE-TRAILERS.
  2881     12  CS-RECORD-ID                      PIC XX.
  2882         88  VALID-CS-ID                      VALUE 'CS'.
  2883
  2884     12  CS-CONTROL-PRIMARY.
  2885         16  CS-COMPANY-CD                 PIC X.
  2886         16  CS-CARRIER                    PIC X.
  2887         16  CS-GROUPING                   PIC X(6).
  2888         16  CS-STATE                      PIC XX.
  2889         16  CS-ACCOUNT                    PIC X(10).
  2890         16  CS-CERT-EFF-DT                PIC XX.
  2891         16  CS-CERT-NO.
  2892             20  CS-CERT-PRIME             PIC X(10).
  2893             20  CS-CERT-SFX               PIC X.
  2894         16  CS-TRAILER-TYPE               PIC X.
  2895             88  COMM-TRLR           VALUE 'A'.
  2896             88  FUTURE-TRLR         VALUE 'B'.
  2897             88  CERT-DATA-TRLR      VALUE 'C'.
  2898
  2899     12  CS-DATA-AREA                      PIC X(516).
  2900
  2901     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2902         16  CS-BANK-COMMISSION-AREA.
  2903             20  CS-BANK-COMMS       OCCURS 10.
  2904                 24  CS-AGT                PIC X(10).
  2905                 24  CS-COM-TYP            PIC X.
  2906                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2907                 24  CS-RECALC-LV-INDIC    PIC X.
  2908                 24  FILLER                PIC X(10).
  2909         16  FILLER                        PIC X(256).
  2910
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  56
* EL050.cbl
  2911     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2912         16  CS-VIN-NUMBER                 PIC X(17).
  2913         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2914         16  FILLER                        PIC X(498).
  2915******************************************************************
  2916*    COPY ELCCRTO.
  2917******************************************************************
  2918*                                                                *
  2919*                            ELCCRTO.                            *
  2920*                                                                *
  2921*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2922*                                                                *
  2923*   FILE TYPE = VSAM,KSDS                                        *
  2924*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2925*                                                                *
  2926*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2927*                                                                *
  2928*   LOG = YES                                                    *
  2929*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2930******************************************************************
  2931*                   C H A N G E   L O G
  2932*
  2933* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2934*-----------------------------------------------------------------
  2935*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2936* EFFECTIVE    NUMBER
  2937*-----------------------------------------------------------------
  2938* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2939* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2940* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2941******************************************************************
  2942 01  ORIGINAL-CERTIFICATE.
  2943     12  OC-RECORD-ID                      PIC XX.
  2944         88  VALID-OC-ID                      VALUE 'OC'.
  2945     12  OC-CONTROL-PRIMARY.
  2946         16  OC-COMPANY-CD                 PIC X.
  2947         16  OC-CARRIER                    PIC X.
  2948         16  OC-GROUPING                   PIC X(6).
  2949         16  OC-STATE                      PIC XX.
  2950         16  OC-ACCOUNT                    PIC X(10).
  2951         16  OC-CERT-EFF-DT                PIC XX.
  2952         16  OC-CERT-NO.
  2953             20  OC-CERT-PRIME             PIC X(10).
  2954             20  OC-CERT-SFX               PIC X.
  2955         16  OC-RECORD-TYPE                PIC X.
  2956         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2957     12  OC-LAST-MAINT-DT                  PIC XX.
  2958     12  OC-LAST-MAINT-BY                  PIC X(4).
  2959     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2960     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2961     12  FILLER                            PIC X(49).
  2962     12  OC-ORIG-REC.
  2963         16  OC-INS-LAST-NAME              PIC X(15).
  2964         16  OC-INS-FIRST-NAME             PIC X(10).
  2965         16  OC-INS-MIDDLE-INIT            PIC X.
  2966         16  OC-INS-AGE                    PIC S999     COMP-3.
  2967         16  OC-JNT-LAST-NAME              PIC X(15).
  2968         16  OC-JNT-FIRST-NAME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  57
* EL050.cbl
  2969         16  OC-JNT-MIDDLE-INIT            PIC X.
  2970         16  OC-JNT-AGE                    PIC S999     COMP-3.
  2971         16  OC-LF-BENCD                   PIC XX.
  2972         16  OC-LF-TERM                    PIC S999      COMP-3.
  2973         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2974         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2975         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  2976         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  2977         16  OC-LF-EXP-DT                  PIC XX.
  2978         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  2979         16  OC-LF-CANCEL-DT               PIC XX.
  2980         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2981         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2982         16  OC-AH-BENCD                   PIC XX.
  2983         16  OC-AH-TERM                    PIC S999      COMP-3.
  2984         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  2985         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  2986         16  OC-AH-EXP-DT                  PIC XX.
  2987         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2988         16  OC-AH-CP                      PIC 99.
  2989         16  OC-AH-CANCEL-DT               PIC XX.
  2990         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  2991         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2992         16  OC-CRED-BENE-NAME             PIC X(25).
  2993         16  OC-1ST-PMT-DT                 PIC XX.
  2994         16  FILLER                        PIC X(215).
  2995
  2996     12  FILLER                            PIC X(50).
  2997******************************************************************
  2998
  2999*    COPY ELCDATE.
  3000******************************************************************
  3001*                                                                *
  3002*                                                                *
  3003*                            ELCDATE.                            *
  3004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3005*                            VMOD=2.003
  3006*                                                                *
  3007*                                                                *
  3008*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3009*                 LENGTH = 200                                   *
  3010******************************************************************
  3011
  3012 01  DATE-CONVERSION-DATA.
  3013     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3014     12  DC-OPTION-CODE                PIC X.
  3015         88  BIN-TO-GREG                VALUE ' '.
  3016         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3017         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3018         88  YMD-GREG-TO-BIN            VALUE '3'.
  3019         88  MDY-GREG-TO-BIN            VALUE '4'.
  3020         88  JULIAN-TO-BIN              VALUE '5'.
  3021         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3022         88  FIND-CENTURY               VALUE '7'.
  3023         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3024         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3025         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3026         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  58
* EL050.cbl
  3027         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3028         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3029         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3030         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3031         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3032         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3033         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3034         88  BIN-3-TO-GREG              VALUE 'I'.
  3035         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3036         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3037         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3038         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3039         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3040         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3041         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3042         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3043         88  THREE-CHARACTER-BIN
  3044                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3045         88  GREGORIAN-TO-BIN
  3046                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3047         88  BIN-TO-GREGORIAN
  3048                  VALUES ' ' '1' 'I' '8' 'G'.
  3049         88  JULIAN-TO-BINARY
  3050                  VALUES '5' 'C' 'E' 'F'.
  3051     12  DC-ERROR-CODE                 PIC X.
  3052         88  NO-CONVERSION-ERROR        VALUE ' '.
  3053         88  DATE-CONVERSION-ERROR
  3054                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3055         88  DATE-IS-ZERO               VALUE '1'.
  3056         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3057         88  DATE-IS-INVALID            VALUE '3'.
  3058         88  DATE1-GREATER-DATE2        VALUE '4'.
  3059         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3060         88  DATE-INVALID-OPTION        VALUE '9'.
  3061         88  INVALID-CENTURY            VALUE 'A'.
  3062         88  ONLY-CENTURY               VALUE 'B'.
  3063         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3064         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3065     12  DC-END-OF-MONTH               PIC X.
  3066         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3067     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3068         88  USE-NORMAL-PROCESS         VALUE ' '.
  3069         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3070         88  ADJUST-UP-100-YRS          VALUE '2'.
  3071     12  FILLER                        PIC X.
  3072     12  DC-CONVERSION-DATES.
  3073         16  DC-BIN-DATE-1             PIC XX.
  3074         16  DC-BIN-DATE-2             PIC XX.
  3075         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3076         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3077                       DC-GREG-DATE-1-EDIT.
  3078             20  DC-EDIT1-MONTH        PIC 99.
  3079             20  SLASH1-1              PIC X.
  3080             20  DC-EDIT1-DAY          PIC 99.
  3081             20  SLASH1-2              PIC X.
  3082             20  DC-EDIT1-YEAR         PIC 99.
  3083         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3084         16  DC-GREG-DATE-2-EDIT-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  59
* EL050.cbl
  3085                     DC-GREG-DATE-2-EDIT.
  3086             20  DC-EDIT2-MONTH        PIC 99.
  3087             20  SLASH2-1              PIC X.
  3088             20  DC-EDIT2-DAY          PIC 99.
  3089             20  SLASH2-2              PIC X.
  3090             20  DC-EDIT2-YEAR         PIC 99.
  3091         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3092         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3093                     DC-GREG-DATE-1-YMD.
  3094             20  DC-YMD-YEAR           PIC 99.
  3095             20  DC-YMD-MONTH          PIC 99.
  3096             20  DC-YMD-DAY            PIC 99.
  3097         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3098         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3099                      DC-GREG-DATE-1-MDY.
  3100             20  DC-MDY-MONTH          PIC 99.
  3101             20  DC-MDY-DAY            PIC 99.
  3102             20  DC-MDY-YEAR           PIC 99.
  3103         16  DC-GREG-DATE-1-ALPHA.
  3104             20  DC-ALPHA-MONTH        PIC X(10).
  3105             20  DC-ALPHA-DAY          PIC 99.
  3106             20  FILLER                PIC XX.
  3107             20  DC-ALPHA-CENTURY.
  3108                 24 DC-ALPHA-CEN-N     PIC 99.
  3109             20  DC-ALPHA-YEAR         PIC 99.
  3110         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3111         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3112         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3113         16  DC-JULIAN-DATE            PIC 9(05).
  3114         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3115                                       PIC 9(05).
  3116         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3117             20  DC-JULIAN-YEAR        PIC 99.
  3118             20  DC-JULIAN-DAYS        PIC 999.
  3119         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3120         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3121         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3122     12  DATE-CONVERSION-VARIBLES.
  3123         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3124         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3125             20  FILLER                PIC 9(3).
  3126             20  HOLD-CEN-1-CCYY.
  3127                 24  HOLD-CEN-1-CC     PIC 99.
  3128                 24  HOLD-CEN-1-YY     PIC 99.
  3129             20  HOLD-CEN-1-MO         PIC 99.
  3130             20  HOLD-CEN-1-DA         PIC 99.
  3131         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3132             20  HOLD-CEN-1-R-MO       PIC 99.
  3133             20  HOLD-CEN-1-R-DA       PIC 99.
  3134             20  HOLD-CEN-1-R-CCYY.
  3135                 24  HOLD-CEN-1-R-CC   PIC 99.
  3136                 24  HOLD-CEN-1-R-YY   PIC 99.
  3137             20  FILLER                PIC 9(3).
  3138         16  HOLD-CENTURY-1-X.
  3139             20  FILLER                PIC X(3)  VALUE SPACES.
  3140             20  HOLD-CEN-1-X-CCYY.
  3141                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3142                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  60
* EL050.cbl
  3143             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3144             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3145         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3146             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3147             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3148             20  HOLD-CEN-1-R-X-CCYY.
  3149                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3150                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3151             20  FILLER                PIC XXX.
  3152         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3153         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3154         16  DC-JULIAN-DATE-1          PIC 9(07).
  3155         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3156             20  DC-JULIAN-1-CCYY.
  3157                 24  DC-JULIAN-1-CC    PIC 99.
  3158                 24  DC-JULIAN-1-YR    PIC 99.
  3159             20  DC-JULIAN-DA-1        PIC 999.
  3160         16  DC-JULIAN-DATE-2          PIC 9(07).
  3161         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3162             20  DC-JULIAN-2-CCYY.
  3163                 24  DC-JULIAN-2-CC    PIC 99.
  3164                 24  DC-JULIAN-2-YR    PIC 99.
  3165             20  DC-JULIAN-DA-2        PIC 999.
  3166         16  DC-GREG-DATE-A-EDIT.
  3167             20  DC-EDITA-MONTH        PIC 99.
  3168             20  SLASHA-1              PIC X VALUE '/'.
  3169             20  DC-EDITA-DAY          PIC 99.
  3170             20  SLASHA-2              PIC X VALUE '/'.
  3171             20  DC-EDITA-CCYY.
  3172                 24  DC-EDITA-CENT     PIC 99.
  3173                 24  DC-EDITA-YEAR     PIC 99.
  3174         16  DC-GREG-DATE-B-EDIT.
  3175             20  DC-EDITB-MONTH        PIC 99.
  3176             20  SLASHB-1              PIC X VALUE '/'.
  3177             20  DC-EDITB-DAY          PIC 99.
  3178             20  SLASHB-2              PIC X VALUE '/'.
  3179             20  DC-EDITB-CCYY.
  3180                 24  DC-EDITB-CENT     PIC 99.
  3181                 24  DC-EDITB-YEAR     PIC 99.
  3182         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3183         16  DC-GREG-DATE-CYMD-R REDEFINES
  3184                              DC-GREG-DATE-CYMD.
  3185             20  DC-CYMD-CEN           PIC 99.
  3186             20  DC-CYMD-YEAR          PIC 99.
  3187             20  DC-CYMD-MONTH         PIC 99.
  3188             20  DC-CYMD-DAY           PIC 99.
  3189         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3190         16  DC-GREG-DATE-MDCY-R REDEFINES
  3191                              DC-GREG-DATE-MDCY.
  3192             20  DC-MDCY-MONTH         PIC 99.
  3193             20  DC-MDCY-DAY           PIC 99.
  3194             20  DC-MDCY-CEN           PIC 99.
  3195             20  DC-MDCY-YEAR          PIC 99.
  3196    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3197        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3198    12  DC-EL310-DATE                  PIC X(21).
  3199    12  FILLER                         PIC X(28).
  3200
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  61
* EL050.cbl
  3202*    COPY ELCCALC.
  3203******************************************************************
  3204*                                                                *
  3205*                           ELCCALC.                            *
  3206*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3207*                            VMOD=2.025                          *
  3208*                                                                *
  3209*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3210*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3211*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3212*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3213*                                                                *
  3214*  PASSED TO ELRTRM                                              *
  3215*  -----------------                                             *
  3216*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3217*  ORIGINAL TERM                                                 *
  3218*  BEGINNING DATE                                                *
  3219*  ENDING DATE                                                   *
  3220*  COMPANY I.D.                                                  *
  3221*  ACCOUNT MASTER USER FIELD                                     *
  3222*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3223*  FREE LOOK DAYS                                                *
  3224*                                                                *
  3225*  RETURNED FROM ELRTRM                                          *
  3226*  ---------------------                                         *
  3227*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3228*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3229*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3230*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3231*----------------------------------------------------------------*
  3232*  PASSED TO ELRAMT                                              *
  3233*  ----------------                                              *
  3234*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3235*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3236*  ORIGINAL AMOUNT                                               *
  3237*  ALTERNATE BENEFIT (BALLON)                                    *
  3238*  A.P.R. - NET PAY ONLY                                         *
  3239*  METHOD
  3240*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3241*  COMPANY I.D.                                                  *
  3242*  BENEFIT TYPE                                                  *
  3243*                                                                *
  3244*  RETURNED FROM ELRAMT                                          *
  3245*  --------------------                                          *
  3246*  REMAINING AMOUNT 1 - CURRENT                                  *
  3247*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3248*  REMAINING AMOUNT FACTOR
  3249*----------------------------------------------------------------*
  3250*  PASSED TO ELRESV                                              *
  3251*  -----------------                                             *
  3252*  CERTIFICATE EFFECTIVE DATE                                    *
  3253*  VALUATION DATE                                                *
  3254*  PAID THRU DATE                                                *
  3255*  BENEFIT                                                       *
  3256*  INCURRED DATE                                                 *
  3257*  REPORTED DATE                                                 *
  3258*  ISSUE AGE                                                     *
  3259*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  62
* EL050.cbl
  3260*  CDT PERCENT                                                   *
  3261*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3262* *CLAIM TYPE (LIFE, A/H)                                        *
  3263* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3264* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3265*                                                                *
  3266*  RETURNED FROM ELRESV                                          *
  3267*  --------------------                                          *
  3268*  CDT TABLE USED                                                *
  3269*  CDT FACTOR USED                                               *
  3270*  PAY TO CURRENT RESERVE                                        *
  3271*  I.B.N.R. - A/H ONLY                                           *
  3272*  FUTURE (ACCRUED) AH ONLY                                      *
  3273*----------------------------------------------------------------*
  3274*  PASSED TO ELRATE                                              *
  3275*  ----------------                                              *
  3276*  CERT ISSUE DATE                                               *
  3277*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3278*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3279*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3280*  STATE CODE (CLIENT DEFINED)                                   *
  3281*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3282*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3283*  DEVIATION CODE                                                *
  3284*  ISSUE AGE                                                     *
  3285*  ORIGINAL BENEFIT AMOUNT                                       *
  3286*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3287*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3288*  BENEFIT KIND (LIFE OR A/H)                                    *
  3289*  A.P.R.                                                        *
  3290*  METHOD
  3291*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3292*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3293*  COMPANY I.D. (3 CHARACTER)                                    *
  3294*  BENEFIT CODE                                                  *
  3295*  BENEFIT OVERRIDE CODE                                         *
  3296*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3297*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3298*  JOINT INDICATOR (CSL ONLY)                                    *
  3299*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3300*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3301*                                                                *
  3302*  RETURNED FROM ELRATE                                          *
  3303*  --------------------                                          *
  3304*  CALCULATED PREMIUM                                            *
  3305*  PREMIUM RATE                                                  *
  3306*  MORTALITY CODE                                                *
  3307*  MAX ATTAINED AGE                                              *
  3308*  MAX AGE                                                       *
  3309*  MAX TERM                                                      *
  3310*  MAX MONTHLY BENEFIT                                           *
  3311*  MAX TOTAL BENIFIT                                             *
  3312*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3313*----------------------------------------------------------------*
  3314*  PASSED TO ELRFND                                              *
  3315*  ----------------                                              *
  3316*  CERT ISSUE DATE                                               *
  3317*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  63
* EL050.cbl
  3318*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3319*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3320*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3321*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3322*  STATE CODE (CLIENT DEFINED)                                   *
  3323*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3324*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3325*  DEVIATION CODE                                                *
  3326*  ISSUE AGE                                                     *
  3327*  ORIGINAL BENEFIT AMOUNT                                       *
  3328*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3329*  PROCESS TYPE (CANCEL)                                         *
  3330*  BENEFIT KIND (LIFE OR A/H)                                    *
  3331*  A.P.R.                                                        *
  3332*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3333*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3334*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3335*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3336*  COMPANY I.D. (3 CHARACTER)                                    *
  3337*  BENEFIT CODE                                                  *
  3338*  BENEFIT OVERRIDE CODE                                         *
  3339*                                                                *
  3340*  RETURNED FROM ELRFND                                          *
  3341*  --------------------                                          *
  3342*  CALCULATED REFUND                                             *
  3343*----------------------------------------------------------------*
  3344*  PASSED TO ELEARN                                              *
  3345*  ----------------                                              *
  3346*  CERT ISSUE DATE                                               *
  3347*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3348*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3349*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3350*  STATE CODE (CLIENT DEFINED)                                   *
  3351*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3352*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3353*  DEVIATION CODE                                                *
  3354*  ISSUE AGE                                                     *
  3355*  ORIGINAL BENEFIT AMOUNT                                       *
  3356*  BENEFIT KIND (LIFE OR A/H)                                    *
  3357*  A.P.R.                                                        *
  3358*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3359*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3360*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3361*  COMPANY I.D. (3 CHARACTER)                                    *
  3362*  BENEFIT CODE                                                  *
  3363*  BENEFIT OVERRIDE CODE                                         *
  3364*                                                                *
  3365*  RETURNED FROM ELEARN                                          *
  3366*  --------------------                                          *
  3367*  INDICATED  EARNINGS                                           *
  3368*----------------------------------------------------------------*
  3369*                 LENGTH = 450                                   *
  3370*                                                                *
  3371******************************************************************
  3372******************************************************************
  3373*                   C H A N G E   L O G
  3374*
  3375* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  64
* EL050.cbl
  3376*-----------------------------------------------------------------
  3377*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3378* EFFECTIVE    NUMBER
  3379*-----------------------------------------------------------------
  3380* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3381* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3382* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3383* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3384* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3385* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3386* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3387* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3388* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3389******************************************************************
  3390
  3391 01  CALCULATION-PASS-AREA.
  3392     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3393                                     COMP.
  3394
  3395     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3396       88  NO-CP-ERROR                             VALUE ZERO.
  3397       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3398                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3399       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3400       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3401       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3402       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3403       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3404       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3405       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3406       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3407       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3408       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3409       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3410       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3411       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3412       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3413       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3414       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3415       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3416
  3417     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3418       88  NO-CP-ERROR-2                           VALUE ZERO.
  3419***********************  INPUT AREAS ****************************
  3420
  3421     12  CP-CALCULATION-AREA.
  3422         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3423         16  CP-CERT-EFF-DT        PIC XX.
  3424         16  CP-VALUATION-DT       PIC XX.
  3425         16  CP-PAID-THRU-DT       PIC XX.
  3426         16  CP-BENEFIT-TYPE       PIC X.
  3427           88  CP-AH                               VALUE 'A' 'D'
  3428                                                   'I' 'U'.
  3429           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3430           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3431         16  CP-INCURRED-DT        PIC XX.
  3432         16  CP-REPORTED-DT        PIC XX.
  3433         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  65
* EL050.cbl
  3434         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3435         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3436                                     COMP-3.
  3437         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3438                                     COMP-3.
  3439         16  CP-CDT-METHOD         PIC X.
  3440           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3441           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3442           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3443         16  CP-CLAIM-TYPE         PIC X.
  3444           88  CP-AH-CLAIM                         VALUE 'A'.
  3445           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3446         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3447                                     COMP-3.
  3448         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3449                                     COMP-3.
  3450         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3451                                     COMP-3.
  3452         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3453                                     COMP-3.
  3454         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3455                                     COMP-3.
  3456         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3457                                     COMP-3.
  3458         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3459                                     COMP-3.
  3460         16  CP-REM-TERM-METHOD    PIC X.
  3461           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3462           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3463           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3464           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3465           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3466           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3467           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3468         16  CP-EARNING-METHOD     PIC X.
  3469           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3470           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3471           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3472           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3473           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3474           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3475           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3476           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3477           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3478           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3479           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3480           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3481           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3482           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3483         16  CP-PROCESS-TYPE       PIC X.
  3484           88  CP-CLAIM                            VALUE '1'.
  3485           88  CP-CANCEL                           VALUE '2'.
  3486           88  CP-ISSUE                            VALUE '3'.
  3487         16  CP-SPECIAL-CALC-CD    PIC X.
  3488           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3489           88  CP-1-MTH-INTEREST               VALUE ' '.
  3490           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3491           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  66
* EL050.cbl
  3492           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3493           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3494           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3495           88  CP-FARM-PLAN                    VALUE 'F'.
  3496           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3497           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3498           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3499           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3500           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3501           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3502           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3503           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3504           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3505           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3506                                                     'W' 'X'.
  3507           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3508           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3509           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3510           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3511           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3512           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3513           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3514           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3515           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3516           88  CP-CSL-METH-1                   VALUE '5'.
  3517           88  CP-CSL-METH-2                   VALUE '6'.
  3518           88  CP-CSL-METH-3                   VALUE '7'.
  3519           88  CP-CSL-METH-4                   VALUE '8'.
  3520
  3521         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3522                                     COMP-3.
  3523         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3524         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3525         16  CP-STATE              PIC XX          VALUE SPACE.
  3526         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3527         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3528           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3529               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3530         16  CP-R78-OPTION         PIC X.
  3531           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3532           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3533
  3534         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3535         16  CP-IBNR-RESERVE-SW    PIC X.
  3536         16  CP-CLAIM-STATUS       PIC X.
  3537         16  CP-RATE-FILE          PIC X.
  3538         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3539                                     COMP-3.
  3540
  3541         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3542         16  CP-AH-OVERRIDE-CODE   PIC X.
  3543
  3544         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3545                                     COMP-3.
  3546         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3547                                   PIC S9(5)V99 COMP-3.
  3548         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3549                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  67
* EL050.cbl
  3550         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3551                                     COMP-3.
  3552         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3553                                     COMP-3.
  3554         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3555                                  PIC S9(7)V99 COMP-3.
  3556
  3557         16  CP-PAID-FROM-DATE     PIC X(02).
  3558         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3559         16  CP-EXT-DAYS-CALC      PIC X.
  3560           88  CP-EXT-NO-CHG                   VALUE ' '.
  3561           88  CP-EXT-CHG-LF                   VALUE '1'.
  3562           88  CP-EXT-CHG-AH                   VALUE '2'.
  3563           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3564         16  CP-DOMICILE-STATE     PIC XX.
  3565         16  CP-CARRIER            PIC X.
  3566         16  CP-REIN-FLAG          PIC X.
  3567         16  CP-REM-TRM-CALC-OPTION PIC X.
  3568           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3569                      '2' '3' '4' '5'.
  3570           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3571           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3572           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3573           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3574           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3575           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3576           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3577           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3578         16  CP-SIG-SWITCH         PIC X.
  3579         16  CP-RATING-METHOD      PIC X.
  3580           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3581           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3582           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3583           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3584           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3585           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3586           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3587           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3588           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3589         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3590                                     COMP-3.
  3591         16  CP-BEN-CATEGORY       PIC X.
  3592         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3593         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3594                                   PIC S99V9(5) COMP-3.
  3595         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3596         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3597                                   PIC S99V9(5) COMP-3.
  3598         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3599         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3600         16  CP-EXPIRE-DT          PIC XX.
  3601         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3602         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3603         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3604         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3605         16  CP-DDF-SPEC-CALC      PIC X.
  3606             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3607             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  68
* EL050.cbl
  3608         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3609         16  CP-CANCEL-REASON      PIC X.
  3610         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3611         16  CP-PMT-MODE           PIC X.
  3612         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3613         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3614         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3615         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3616         16  FILLER                PIC X.
  3617
  3618***************    OUTPUT FROM ELRESV   ************************
  3619
  3620         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3621
  3622         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3623                                     COMP-3.
  3624         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3625                                     COMP-3.
  3626         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3627                                     COMP-3.
  3628         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3629                                     COMP-3.
  3630         16  FILLER                PIC X(09).
  3631***************    OUTPUT FROM ELRTRM   *************************
  3632
  3633         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3634                                     COMP-3.
  3635         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3636                                     COMP-3.
  3637         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3638                                     COMP-3.
  3639         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3640                                     COMP-3.
  3641         16  FILLER                PIC X(12).
  3642
  3643***************    OUTPUT FROM ELRAMT   *************************
  3644
  3645         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3646                                     COMP-3.
  3647         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3648                                     COMP-3.
  3649         16  FILLER                PIC X(12).
  3650
  3651***************    OUTPUT FROM ELRATE   *************************
  3652
  3653         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3654                                     COMP-3.
  3655         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3656                                     COMP-3.
  3657         16  CP-MORTALITY-CODE     PIC X(4).
  3658         16  CP-RATE-EDIT-FLAG     PIC X.
  3659             88  CP-RATES-NEED-APR                  VALUE '1'.
  3660         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3661                                     COMP-3.
  3662         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3663         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3664         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3665                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  69
* EL050.cbl
  3666         16  FILLER                PIC X(07).
  3667
  3668***************    OUTPUT FROM ELRFND   *************************
  3669
  3670         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3671                                     COMP-3.
  3672         16  CP-REFUND-TYPE-USED   PIC X.
  3673           88  CP-R-AS-R78                         VALUE '1'.
  3674           88  CP-R-AS-PRORATA                     VALUE '2'.
  3675           88  CP-R-AS-CALIF                       VALUE '3'.
  3676           88  CP-R-AS-TEXAS                       VALUE '4'.
  3677           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3678           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3679           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3680           88  CP-R-AS-MEAN                        VALUE '8'.
  3681           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3682           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3683           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3684           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3685           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3686           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3687         16  FILLER                PIC X(12).
  3688
  3689***************    OUTPUT FROM ELEARN   *************************
  3690
  3691         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3692                                     COMP-3.
  3693         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3694                                     COMP-3.
  3695         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3696                                     COMP-3.
  3697         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3698                                     COMP-3.
  3699         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3700                                     COMP-3.
  3701         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3702                                     COMP-3.
  3703         16  CP-EARNING-TYPE-USED  PIC X.
  3704           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3705           88  CP-E-AS-R78                         VALUE '1'.
  3706           88  CP-E-AS-PRORATA                     VALUE '2'.
  3707           88  CP-E-AS-TEXAS                       VALUE '4'.
  3708           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3709           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3710           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3711           88  CP-E-AS-MEAN                        VALUE '8'.
  3712           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3713         16  FILLER                PIC X(12).
  3714
  3715***************    OUTPUT FROM ELPMNT   *************************
  3716
  3717         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3718                                     COMP-3.
  3719         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3720                                     COMP-3.
  3721         16  FILLER                PIC X(12).
  3722
  3723***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  70
* EL050.cbl
  3724         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3725                                     COMP-3.
  3726         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3727                                     COMP-3.
  3728         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3729                                     COMP-3.
  3730         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3731                                     COMP-3.
  3732         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3733                                     COMP-3.
  3734         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3735                                     COMP-3.
  3736         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3737             88  OPEN-RATE-FILE                   VALUE 'O'.
  3738             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3739             88  IO-ERROR                         VALUE 'E'.
  3740
  3741         16  CP-FIRST-PAY-DATE     PIC XX.
  3742
  3743         16  CP-JOINT-INDICATOR    PIC X.
  3744
  3745         16  CP-RESERVE-REMAINING-TERM
  3746                                   PIC S9(4)V9    VALUE ZERO
  3747                                     COMP-3.
  3748
  3749         16  CP-INSURED-BIRTH-DT   PIC XX.
  3750
  3751         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3752                                     COMP-3.
  3753
  3754         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3755                                     COMP-3.
  3756
  3757         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3758                                     COMP-3.
  3759
  3760         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3761                                     COMP-3.
  3762
  3763         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3764                                     COMP-3.
  3765
  3766         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3767                                     COMP-3.
  3768
  3769         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3770                                     COMP-3.
  3771
  3772         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3773             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3774
  3775         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3776                                     COMP-3.
  3777         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3778                                     COMP-3.
  3779         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3780         16  FILLER                PIC X(15).
  3781******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  71
* EL050.cbl
  3783******************************************************************
  3784*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3785*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3786*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3787*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3788*** MODIFICATION.                                              ***
  3789*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3790*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3791******************************************************************
  3792*    COPY ERCPNDB.
  3793******************************************************************
  3794*                                                                *
  3795*                                                                *
  3796*                            ERCPNDB.                            *
  3797*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3798*                            VMOD=2.025                          *
  3799*                                                                *
  3800*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3801*                                                                *
  3802******************************************************************
  3803*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3804*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3805******************************************************************
  3806*                                                                *
  3807*                                                                *
  3808*   FILE TYPE = VSAM,KSDS                                        *
  3809*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3810*                                                                *
  3811*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3812*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3813*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3814*                                                 RKP=13,LEN=36  *
  3815*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3816*                                      AND CHG-SEQ.)             *
  3817*                                                RKP=49,LEN=11   *
  3818*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3819*                                      AND CHG-SEQ.)             *
  3820*                                                RKP=60,LEN=15   *
  3821*                                                                *
  3822*   LOG = NO                                                     *
  3823*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3824******************************************************************
  3825******************************************************************
  3826*                   C H A N G E   L O G
  3827*
  3828* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3829*-----------------------------------------------------------------
  3830*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3831* EFFECTIVE    NUMBER
  3832*-----------------------------------------------------------------
  3833* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3834* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3835* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3836* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3837* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3838* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3839* 032306                   PEMA  ADD BOW LOAN NUMBER
  3840* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  72
* EL050.cbl
  3841* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3842* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3843* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3844* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3845* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3846* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3847* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3848******************************************************************
  3849
  3850 01  PENDING-BUSINESS.
  3851     12  PB-RECORD-ID                     PIC XX.
  3852         88  VALID-PB-ID                        VALUE 'PB'.
  3853
  3854     12  PB-CONTROL-PRIMARY.
  3855         16  PB-COMPANY-CD                PIC X.
  3856         16  PB-ENTRY-BATCH               PIC X(6).
  3857         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3858         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3859
  3860     12  PB-CONTROL-BY-ACCOUNT.
  3861         16  PB-COMPANY-CD-A1             PIC X.
  3862         16  PB-CARRIER                   PIC X.
  3863         16  PB-GROUPING.
  3864             20  PB-GROUPING-PREFIX       PIC XXX.
  3865             20  PB-GROUPING-PRIME        PIC XXX.
  3866         16  PB-STATE                     PIC XX.
  3867         16  PB-ACCOUNT.
  3868             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3869             20  PB-ACCOUNT-PRIME         PIC X(6).
  3870         16  PB-CERT-EFF-DT               PIC XX.
  3871         16  PB-CERT-NO.
  3872             20  PB-CERT-PRIME            PIC X(10).
  3873             20  PB-CERT-SFX              PIC X.
  3874         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3875
  3876         16  PB-RECORD-TYPE               PIC X.
  3877             88  PB-MAILING-DATA                VALUE '0'.
  3878             88  PB-ISSUE                       VALUE '1'.
  3879             88  PB-CANCELLATION                VALUE '2'.
  3880             88  PB-BATCH-TRAILER               VALUE '9'.
  3881
  3882     12  PB-CONTROL-BY-ORIG-BATCH.
  3883         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3884         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3885         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3886         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3887
  3888     12  PB-CONTROL-BY-CSR.
  3889         16  PB-CSR-COMPANY-CD            PIC X.
  3890         16  PB-CSR-ID                    PIC X(4).
  3891         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3892         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3893         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3894******************************************************************
  3895*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3896******************************************************************
  3897
  3898     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  73
* EL050.cbl
  3899     12  PB-LAST-MAINT-BY                 PIC X(4).
  3900     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3901
  3902     12  PB-RECORD-BODY                   PIC X(375).
  3903
  3904     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3905         16  PB-CERT-ORIGIN               PIC X.
  3906             88  CLASIC-CREATED-CERT         VALUE '1'.
  3907         16  PB-I-NAME.
  3908             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3909             20  PB-I-INSURED-FIRST-NAME.
  3910                 24  PB-I-INSURED-1ST-INIT PIC X.
  3911                 24  FILLER                PIC X(9).
  3912             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3913         16  PB-I-AGE                     PIC S99   COMP-3.
  3914         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3915         16  PB-I-BIRTHDAY                PIC XX.
  3916         16  PB-I-INSURED-SEX             PIC X.
  3917             88  PB-SEX-MALE     VALUE 'M'.
  3918             88  PB-SEX-FEMALE   VALUE 'F'.
  3919
  3920         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3921         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3922         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3923         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3924         16  PB-I-SKIP-CODE               PIC X.
  3925             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3926             88  PB-SKIP-JULY              VALUE '1'.
  3927             88  PB-SKIP-AUGUST            VALUE '2'.
  3928             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3929             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3930             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3931             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3932             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3933             88  PB-SKIP-JUNE              VALUE '8'.
  3934             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3935             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3936             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3937         16  PB-I-TERM-TYPE               PIC X.
  3938             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3939             88  PB-PAID-WEEKLY            VALUE 'W'.
  3940             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3941             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3942             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3943         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3944         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3945         16  PB-I-DATA-ENTRY-SW           PIC X.
  3946             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3947             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3948             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3949             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3950         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3951         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3952*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3953         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3954         16  FILLER                       PIC X.
  3955
  3956         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  74
* EL050.cbl
  3957             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3958             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3959                                                   '90' THRU '99'.
  3960         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3961                                          PIC XX.
  3962         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3963         16  PB-I-AMOUNT-FINANCED REDEFINES
  3964                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3965         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3966         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3967                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3968         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3969         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3970         16  PB-I-CLP-AMOUNT REDEFINES
  3971                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3972         16  PB-I-LF-CALC-FLAG            PIC X.
  3973             88 PB-COMP-LF-PREM               VALUE '?'.
  3974         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3975         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3976         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3977         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3978         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3979         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3980         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3981         16  PB-I-LF-ABBR                 PIC XXX.
  3982         16  PB-I-LF-INPUT-CD             PIC XX.
  3983
  3984         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3985             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  3986             88  PB-INVALID-AH               VALUE '  ' '00'
  3987                                                   '90' THRU '99'.
  3988         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  3989         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3990         16  PB-I-AH-CALC-FLAG            PIC X.
  3991             88 PB-COMP-AH-PREM                  VALUE '?'.
  3992         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  3993         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  3994         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3995         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  3996         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  3997         16  PB-I-AH-ABBR                 PIC XXX.
  3998         16  PB-I-AH-INPUT-CD             PIC XXX.
  3999
  4000         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4001         16  PB-I-REIN-TABLE              PIC XXX.
  4002         16  PB-I-BUSINESS-TYPE           PIC 99.
  4003         16  PB-I-INDV-GRP-CD             PIC X.
  4004         16  PB-I-MORT-CODE.
  4005             20  PB-I-TABLE               PIC X.
  4006             20  PB-I-INTEREST            PIC XX.
  4007             20  PB-I-MORT-TYP            PIC X.
  4008         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4009         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4010         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4011         16  PB-I-INDV-GRP-OVRD           PIC X.
  4012         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4013         16  PB-I-SIG-SW                  PIC X.
  4014             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  75
* EL050.cbl
  4015         16  PB-I-RATE-CLASS              PIC XX.
  4016         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4017         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4018         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4019         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4020         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4021         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4022         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4023         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4024         16  PB-I-OB-FLAG                 PIC X.
  4025             88  PB-I-OB                      VALUE 'B'.
  4026             88  PB-I-SUMMARY                 VALUE 'Z'.
  4027         16  PB-I-ENTRY-STATUS            PIC X.
  4028             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4029                                              'M' '5' '9' '2'.
  4030             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4031             88  PB-I-POLICY-PENDING          VALUE '2'.
  4032             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4033             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4034             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4035             88  PB-I-REIN-ONLY               VALUE '9'.
  4036             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4037             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4038             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4039             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4040         16  PB-I-INT-CODE                PIC X.
  4041             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4042             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4043         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4044         16  PB-I-SOC-SEC-NO              PIC X(11).
  4045         16  PB-I-MEMBER-NO               PIC X(12).
  4046         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4047*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4048         16  PB-I-OLD-LOF                 PIC XXX.
  4049         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4050         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4051         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4052         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4053         16  PB-I-LIFE-INDICATOR          PIC X.
  4054             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4055         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4056         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4057                                          PIC S9(5)V99    COMP-3.
  4058         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4059             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4060             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4061         16  PB-I-1ST-PMT-DT              PIC XX.
  4062         16  PB-I-JOINT-INSURED.
  4063             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4064             20 PB-I-JOINT-FIRST-NAME.
  4065                24  PB-I-JOINT-FIRST-INIT PIC X.
  4066                24  FILLER                PIC X(9).
  4067             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4068*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4069         16  PB-I-BENEFICIARY-NAME.
  4070             20  PB-I-BANK-NUMBER         PIC X(10).
  4071             20  FILLER                   PIC X(15).
  4072         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  76
* EL050.cbl
  4073         16  PB-I-REFERENCE               PIC X(12).
  4074         16  FILLER REDEFINES PB-I-REFERENCE.
  4075             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4076             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4077             20  PB-I-CLP-STATE           PIC XX.
  4078         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4079             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4080             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4081             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4082         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4083         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4084         16  PB-I-RESIDENT-STATE          PIC XX.
  4085         16  PB-I-RATE-CODE               PIC X(4).
  4086         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4087         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4088         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4089         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4090         16  PB-I-BANK-NOCHRGB            PIC 99.
  4091         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4092         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4093
  4094     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4095         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4096             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4097         16  PB-C-CANCEL-ORIGIN           PIC X.
  4098             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4099         16  PB-C-LF-CANCEL-DT            PIC XX.
  4100         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4101         16  PB-C-LF-CALC-REQ             PIC X.
  4102             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4103         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4104         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4105         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4106             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4107         16  PB-C-AH-CANCEL-DT            PIC XX.
  4108         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4109         16  PB-C-AH-CALC-REQ             PIC X.
  4110             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4111         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4112         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4113         16  PB-C-LAST-NAME               PIC X(15).
  4114         16  PB-C-REFUND-SW               PIC X.
  4115             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4116             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4117         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4118         16  PB-C-PAYEE-CODE              PIC X(6).
  4119         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4120         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4121         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4122         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4123         16  PB-C-REFERENCE               PIC X(12).
  4124         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4125         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4126         16  PB-C-POST-CARD-IND           PIC X.
  4127         16  PB-C-CANCEL-REASON           PIC X.
  4128         16  PB-C-REF-INTERFACE-SW        PIC X.
  4129         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4130         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  77
* EL050.cbl
  4131         16  FILLER                       PIC X(01).
  4132*        16  FILLER                       PIC X(18).
  4133         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4134*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4135         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4136         16  PB-CANCELED-CERT-DATA.
  4137             20  PB-CI-INSURED-NAME.
  4138                 24  PB-CI-LAST-NAME      PIC X(15).
  4139                 24  PB-CI-INITIALS       PIC XX.
  4140             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4141             20  PB-CI-INSURED-SEX        PIC X.
  4142             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4143             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4144             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4145             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4146             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4147             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4148             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4149             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4150             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4151             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4152             20  PB-CI-RATE-CLASS         PIC XX.
  4153             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4154             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4155             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4156             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4157             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4158             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4159             20  PB-CI-LF-ABBR            PIC X(3).
  4160             20  PB-CI-AH-ABBR            PIC X(3).
  4161             20  PB-CI-OB-FLAG            PIC X.
  4162                 88  PB-CI-OB                VALUE 'B'.
  4163             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4164                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4165                                           'M' '4' '5' '9' '2'.
  4166                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4167                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4168                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4169                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4170                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4171                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4172                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4173                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4174                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4175                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4176                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4177                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4178             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4179                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4180                                           'M' '4' '5' '9' '2'.
  4181                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4182                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4183                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4184                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4185                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4186                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4187                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4188                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  78
* EL050.cbl
  4189                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4190                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4191                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4192                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4193             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4194             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4195             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4196             20  PB-CI-MEMBER-NO          PIC X(12).
  4197             20  PB-CI-INT-CODE           PIC X.
  4198                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4199                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4200             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4201             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4202             20  PB-CI-COMP-EXCP-SW       PIC X.
  4203                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4204                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4205             20  PB-CI-ENTRY-STATUS       PIC X.
  4206             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4207             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4208             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4209             20  PB-CI-DEATH-DT           PIC XX.
  4210             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4211             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4212             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4213             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4214             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4215             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4216             20  PB-CI-ENTRY-DT              PIC XX.
  4217             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4218             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4219             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4220             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4221             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4222             20  PB-CI-OLD-LOF               PIC XXX.
  4223*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4224             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4225             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4226             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4227             20  PB-CI-INDV-GRP-CD           PIC X.
  4228             20  PB-CI-BENEFICIARY-NAME.
  4229                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4230                 24  FILLER                  PIC X(15).
  4231             20  PB-CI-NOTE-SW               PIC X.
  4232             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4233             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4234             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4235             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4236             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4237             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4238             20  PB-CI-FIRST-NAME            PIC X(10).
  4239             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4240
  4241         16  FILLER                       PIC X(13).
  4242*032306  16  FILLER                       PIC X(27).
  4243*        16  FILLER                       PIC X(46).
  4244
  4245     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4246         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  79
* EL050.cbl
  4247         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4248         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4249         16  PB-M-INSURED-MID-INIT        PIC X.
  4250         16  PB-M-INSURED-AGE             PIC 99.
  4251         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4252         16  PB-M-INSURED-SEX             PIC X.
  4253         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4254         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4255         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4256         16  PB-M-INSURED-CITY-STATE.
  4257             20  PB-M-INSURED-CITY        PIC X(28).
  4258             20  PB-M-INSURED-STATE       PIC XX.
  4259         16  PB-M-INSURED-ZIP-CODE.
  4260             20  PB-M-INSURED-ZIP-PRIME.
  4261                 24  PB-M-INSURED-ZIP-1   PIC X.
  4262                     88  PB-M-CANADIAN-POST-CODE
  4263                                             VALUE 'A' THRU 'Z'.
  4264                 24  FILLER               PIC X(4).
  4265             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4266         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4267                                        PB-M-INSURED-ZIP-CODE.
  4268             20  PM-M-INS-CAN-POST1       PIC XXX.
  4269             20  PM-M-INS-CAN-POST2       PIC XXX.
  4270             20  FILLER                   PIC XXX.
  4271         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4272         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4273         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4274         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4275         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4276         16  PB-M-CRED-BENE-CITYST.
  4277             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4278             20  PB-M-CRED-BENE-STATE     PIC XX.
  4279         16  FILLER                       PIC X(92).
  4280
  4281     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4282         16  FILLER                       PIC X(10).
  4283         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4284         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4285         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4286         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4287         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4288         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4289         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4290         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4291         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4292         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4293         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4294         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4295         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4296         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4297         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4298         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4299         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4300         16  PB-ACCOUNT-NAME              PIC X(30).
  4301         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4302         16  PB-REFERENCE                 PIC X(12).
  4303         16  PB-B-RECEIVED-DT             PIC XX.
  4304         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  80
* EL050.cbl
  4305
  4306     12  PB-RECORD-STATUS.
  4307         16  PB-CREDIT-SELECT-DT          PIC XX.
  4308         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4309         16  PB-BILLED-DT                 PIC XX.
  4310         16  PB-BILLING-STATUS            PIC X.
  4311             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4312             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4313             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4314         16  PB-RECORD-BILL               PIC X.
  4315             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4316             88  PB-RECORD-RETURNED           VALUE 'R'.
  4317             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4318             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4319             88  PB-OVERRIDE-AH               VALUE 'A'.
  4320             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4321         16  PB-BATCH-ENTRY               PIC X.
  4322             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4323             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4324             88  PB-REISSUED-CERT             VALUE 'E'.
  4325             88  PB-MONTHLY-CERT              VALUE 'M'.
  4326             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4327             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4328             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4329         16  PB-FORCE-CODE                PIC X.
  4330             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4331             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4332             88  PB-CANCEL-FORCE              VALUE '8'.
  4333             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4334             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4335             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4336             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4337             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4338             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4339             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4340         16  PB-FATAL-FLAG                PIC X.
  4341             88  PB-FATAL-ERRORS              VALUE 'X'.
  4342         16  PB-FORCE-ER-CD               PIC X.
  4343             88  PB-FORCE-ERRORS              VALUE 'F'.
  4344             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4345         16  PB-WARN-ER-CD                PIC X.
  4346             88  PB-WARNING-ERRORS            VALUE 'W'.
  4347         16  FILLER                       PIC X.
  4348         16  PB-OUT-BAL-CD                PIC X.
  4349             88  PB-OUT-OF-BAL                VALUE 'O'.
  4350         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4351         16  PB-AH-OVERRIDE-L1            PIC X.
  4352         16  PB-INPUT-DT                  PIC XX.
  4353         16  PB-INPUT-BY                  PIC X(4).
  4354         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4355         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4356         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4357         16  PB-LF-EARNING-METHOD         PIC X.
  4358         16  PB-AH-EARNING-METHOD         PIC X.
  4359         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4360         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4361         16  PB-REIN-CD                   PIC XXX.
  4362         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  81
* EL050.cbl
  4363         16  PB-AH-REFUND-TYPE            PIC X.
  4364         16  PB-ACCT-EFF-DT               PIC XX.
  4365         16  PB-ACCT-EXP-DT               PIC XX.
  4366         16  PB-COMPANY-ID                PIC X(3).
  4367         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4368         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4369         16  PB-SV-CARRIER                PIC X.
  4370         16  PB-SV-GROUPING               PIC X(6).
  4371         16  PB-SV-STATE                  PIC XX.
  4372         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4373         16  PB-GA-BILLING-INFO.
  4374             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4375                                          PIC XX.
  4376         16  PB-SV-REMIT-TO  REDEFINES
  4377             PB-GA-BILLING-INFO           PIC X(10).
  4378         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4379         16  PB-I-LOAN-OFFICER            PIC X(5).
  4380         16  PB-I-VIN                     PIC X(17).
  4381
  4382         16  FILLER                       PIC X(04).
  4383         16  IMNET-BYPASS-SW              PIC X.
  4384
  4385******************************************************************
  4386*                COMMON EDIT ERRORS                              *
  4387******************************************************************
  4388
  4389     12  PB-COMMON-ERRORS.
  4390         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4391                                           PIC S9(4)     COMP.
  4392
  4393******************************************************************
  4394
  4395* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4396*    COPY ELC50W1.
  4397******************************************************************
  4398*                                                                *
  4399*                                                                *
  4400*                             ELC50W1                            *
  4401*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4402*                            VMOD=2.004                          *
  4403*                                                                *
  4404*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4405*                                                                *
  4406*                                                                *
  4407******************************************************************
  4408
  4409     12  WK-WORK-AREA.
  4410         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4411         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4412         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4413         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4414         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4415         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4416         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4417         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4418         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4419         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4420         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  82
* EL050.cbl
  4421         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4422         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4423         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4424         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4425         16  WK-CREDIT-EDIT-CONTROLS.
  4426             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4427             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4428             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4429             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4430             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4431             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4432         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4433         16  WK-SAVE-REIN-DATA.
  4434             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4435             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4436             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4437         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4438             88  ENTRY-FROM-EL6311       VALUE '6'.
  4439         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4440         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4441     12  WK-RECORD-ADDRESSES.
  4442         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4443         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4444         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4445         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4446         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4447         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4448         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4449         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4450     12  WK-OVER-SHORT-AREA.
  4451         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4452         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4453         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4454             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4455         16  FILLER                   PIC X(5) VALUE SPACES.
  4456
  4457*    COPY ELCEDITC.
  4458******************************************************************
  4459*                                                                *
  4460*                                                                *
  4461*                            ELCEDITC                            *
  4462*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4463*                            VMOD=2.012                          *
  4464*                                                                *
  4465*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4466*                     EL6313, EL050 AND EL517.                   *
  4467*                                                                *
  4468******************************************************************
  4469******************************************************************
  4470*                   C H A N G E   L O G
  4471*
  4472* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4473*-----------------------------------------------------------------
  4474*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4475* EFFECTIVE    NUMBER
  4476*-----------------------------------------------------------------
  4477* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4478******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  83
* EL050.cbl
  4479
  4480     12  EDIT-CRITERIA-DATA.
  4481         16  EC-CO-MONTH-END-DT       PIC XX.
  4482         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4483         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4484         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4485         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4486         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4487         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4488         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4489         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4490         16  EC-CO-REM-TERM-CALC      PIC X.
  4491               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4492               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4493               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4494               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4495
  4496         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4497               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4498               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4499               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4500               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4501               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4502               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4503               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4504               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4505               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4506               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4507
  4508         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4509               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4510               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4511               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4512               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4513               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4514               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4515               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4516               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4517
  4518         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4519                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4520                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4521
  4522         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4523                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4524                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4525                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4526                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4527                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4528                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4529                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4530                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4531
  4532         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4533               88  EC-BR-REDUCING                   VALUE 'R'.
  4534               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4535
  4536         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  84
* EL050.cbl
  4537         16  EC-BR-LF-DESC             PIC X(10).
  4538         16  EC-BR-AH-DESC             PIC X(10).
  4539         16  EC-BR-LF-COMMENT          PIC X(10).
  4540         16  EC-BR-AH-COMMENT          PIC X(10).
  4541
  4542         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4543               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4544               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4545               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4546               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4547
  4548         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4549               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4550               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4551               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4552               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4553
  4554         16  EC-BR-LF-REFUND-CALC      PIC X.
  4555                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4556                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4557                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4558                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4559                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4560                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4561                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4562
  4563         16  EC-BR-AH-REFUND-CALC      PIC X.
  4564                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4565                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4566                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4567                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4568                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4569                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4570                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4571                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4572
  4573         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4574                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4575                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4576                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4577
  4578         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4579                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4580                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4581                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4582
  4583         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4584         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4585         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4586         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4587
  4588         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4589         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4590                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4591                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4592                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4593                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4594
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  85
* EL050.cbl
  4595         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4596               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4597               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4598               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4599               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4600               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4601
  4602         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4603               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4604               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4605               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4606               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4607               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4608
  4609         16  EC-ST-LF-REFUND-CALC      PIC X.
  4610                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4611                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4612                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4613                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4614                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4615                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4616                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4617                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4618
  4619         16  EC-ST-AH-REFUND-CALC      PIC X.
  4620                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4621                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4622                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4623                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4624                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4625                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4626                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4627                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4628
  4629         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4630         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4631         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4632         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4633         16  EC-AM-EXPIRATION-DT       PIC XX.
  4634         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4635         16  EC-AM-CLASS-CD            PIC XX.
  4636         16  EC-AM-LF-DEVIATION        PIC XXX.
  4637         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4638         16  EC-AM-AH-DEVIATION        PIC XXX.
  4639         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4640         16  EC-AM-PHONE-NO            PIC X(10).
  4641
  4642         16  EC-AM-LF-REFUND-CALC      PIC X.
  4643                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4644                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4645                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4646                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4647                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4648                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4649                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4650
  4651         16  EC-AM-AH-REFUND-CALC      PIC X.
  4652                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  86
* EL050.cbl
  4653                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4654                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4655                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4656                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4657                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4658                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4659
  4660         16  EC-AM-BEN-I-G-CD          PIC X.
  4661                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4662                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4663                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4664
  4665         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4666         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4667         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4668         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4669         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4670         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4671         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4672         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4673         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4674
  4675         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4676         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4677         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4678         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4679         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4680         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4681         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4682         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4683         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4684         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4685         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4686         16  EC-RT-LF-NSP-ST           PIC XX.
  4687         16  EC-RT-AH-NSP-ST           PIC XX.
  4688         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4689         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4690
  4691         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4692             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4693                                             'M' '5' '9' '2'.
  4694             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4695             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4696             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4697             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4698             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4699             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4700             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4701             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4702             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4703             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4704
  4705         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4706             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4707                                             'M' '5' '9' '2'.
  4708             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4709             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4710             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  87
* EL050.cbl
  4711             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4712             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4713             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4714             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4715             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4716             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4717             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4718
  4719         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4720         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4721         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4722         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4723         16  EC-CM-DEATH-DT            PIC XX.
  4724
  4725*DMD CUSTOM CODING FIELDS BELOW
  4726*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4727         16  EC-BR-DMD-RATING-SW       PIC X.
  4728                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4729                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4730                 88  NO-DMD-RATING               VALUE 'N'.
  4731
  4732         16  EC-NEW-CERT               PIC X(11).
  4733         16  EC-NEW-STATE              PIC XX.
  4734         16  FILLER                    PIC X.
  4735*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4736         16  OVER-SHORT-EDIT-FIELDS.
  4737             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4738             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4739             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4740             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4741             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4742             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4743             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4744             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4745             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4746         16  FILLER                    PIC X(71).
  4747******************************************************************
  4748
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  88
* EL050.cbl
  4750*    COPY ELCDIFRD.
  4751******************************************************************
  4752*                                                                *
  4753*                                                                *
  4754*                            ELCDIFRD.                           *
  4755*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4756*                            VMOD=2.004                          *
  4757*                                                                *
  4758*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4759*                                                                *
  4760******************************************************************
  4761*
  4762  01  WS-DIFFERENCE-CALCULATION.
  4763        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4764        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4765        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4766        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4767        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4768        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4769        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4770        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4771        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4772        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4773        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4774
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  89
* EL050.cbl
  4776****************************************************************
  4777*
  4778* Copyright (c) 2007 by Clerity Solutions, Inc.
  4779* All rights reserved.
  4780*
  4781****************************************************************
  4782 01  DFHEIV.
  4783   02  DFHEIV0               PIC X(35).
  4784   02  DFHEIV1               PIC X(08).
  4785   02  DFHEIV2               PIC X(08).
  4786   02  DFHEIV3               PIC X(08).
  4787   02  DFHEIV4               PIC X(06).
  4788   02  DFHEIV5               PIC X(04).
  4789   02  DFHEIV6               PIC X(04).
  4790   02  DFHEIV7               PIC X(02).
  4791   02  DFHEIV8               PIC X(02).
  4792   02  DFHEIV9               PIC X(01).
  4793   02  DFHEIV10              PIC S9(7) COMP-3.
  4794   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4795   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4796   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4797   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4798   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4799   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4800   02  DFHEIV17              PIC X(04).
  4801   02  DFHEIV18              PIC X(04).
  4802   02  DFHEIV19              PIC X(04).
  4803   02  DFHEIV20              USAGE IS POINTER.
  4804   02  DFHEIV21              USAGE IS POINTER.
  4805   02  DFHEIV22              USAGE IS POINTER.
  4806   02  DFHEIV23              USAGE IS POINTER.
  4807   02  DFHEIV24              USAGE IS POINTER.
  4808   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4809   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4810   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4811   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4812   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4813   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4814   02  FILLER                PIC X(02).
  4815   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4816   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4817   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4818   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4819   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4820 LINKAGE  SECTION.
  4821*****************************************************************
  4822*                                                               *
  4823* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4824* All rights reserved.                                          *
  4825*                                                               *
  4826*****************************************************************
  4827 01  dfheiblk.
  4828     02  eibtime          pic s9(7) comp-3.
  4829     02  eibdate          pic s9(7) comp-3.
  4830     02  eibtrnid         pic x(4).
  4831     02  eibtaskn         pic s9(7) comp-3.
  4832     02  eibtrmid         pic x(4).
  4833     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  90
* EL050.cbl
  4834     02  eibcposn         pic s9(4) comp.
  4835     02  eibcalen         pic s9(4) comp.
  4836     02  eibaid           pic x(1).
  4837     02  eibfiller1       pic x(1).
  4838     02  eibfn            pic x(2).
  4839     02  eibfiller2       pic x(2).
  4840     02  eibrcode         pic x(6).
  4841     02  eibfiller3       pic x(2).
  4842     02  eibds            pic x(8).
  4843     02  eibreqid         pic x(8).
  4844     02  eibrsrce         pic x(8).
  4845     02  eibsync          pic x(1).
  4846     02  eibfree          pic x(1).
  4847     02  eibrecv          pic x(1).
  4848     02  eibsend          pic x(1).
  4849     02  eibatt           pic x(1).
  4850     02  eibeoc           pic x(1).
  4851     02  eibfmh           pic x(1).
  4852     02  eibcompl         pic x(1).
  4853     02  eibsig           pic x(1).
  4854     02  eibconf          pic x(1).
  4855     02  eiberr           pic x(1).
  4856     02  eibrldbk         pic x(1).
  4857     02  eiberrcd         pic x(4).
  4858     02  eibsynrb         pic x(1).
  4859     02  eibnodat         pic x(1).
  4860     02  eibfiller5       pic x(2).
  4861     02  eibresp          pic 9(09) comp.
  4862     02  eibresp2         pic 9(09) comp.
  4863     02  dfheigdj         pic s9(4) comp.
  4864     02  dfheigdk         pic s9(4) comp.
  4865
  4866 01  DFHCOMMAREA                   PIC X(1036).
  4867
  4868*01 PARMLIST .
  4869*    02  FILLER                    PIC S9(8)   COMP.
  4870*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4871*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4872*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4873*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4874*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4875*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4876*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4877
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  91
* EL050.cbl
  4879*    COPY ELCCNTL.
  4880******************************************************************
  4881*                                                                *
  4882*                                                                *
  4883*                            ELCCNTL.                            *
  4884*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4885*                            VMOD=2.059                          *
  4886*                                                                *
  4887*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4888*                                                                *
  4889*   FILE TYPE = VSAM,KSDS                                        *
  4890*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4891*                                                                *
  4892*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4893*       ALTERNATE INDEX = NONE                                   *
  4894*                                                                *
  4895*   LOG = YES                                                    *
  4896*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4897******************************************************************
  4898*                   C H A N G E   L O G
  4899*
  4900* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4901*-----------------------------------------------------------------
  4902*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4903* EFFECTIVE    NUMBER
  4904*-----------------------------------------------------------------
  4905* 082503                   PEMA  ADD BENEFIT GROUP
  4906* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4907* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4908* 092705    2005050300006  PEMA  ADD SPP LEASES
  4909* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4910* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4911* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4912* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4913* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4914* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4915******************************************************************
  4916*
  4917 01  CONTROL-FILE.
  4918     12  CF-RECORD-ID                       PIC XX.
  4919         88  VALID-CF-ID                        VALUE 'CF'.
  4920
  4921     12  CF-CONTROL-PRIMARY.
  4922         16  CF-COMPANY-ID                  PIC XXX.
  4923         16  CF-RECORD-TYPE                 PIC X.
  4924             88  CF-COMPANY-MASTER              VALUE '1'.
  4925             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4926             88  CF-STATE-MASTER                VALUE '3'.
  4927             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4928             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4929             88  CF-CARRIER-MASTER              VALUE '6'.
  4930             88  CF-MORTALITY-MASTER            VALUE '7'.
  4931             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4932             88  CF-TERMINAL-MASTER             VALUE '9'.
  4933             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4934             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4935             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4936             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  92
* EL050.cbl
  4937             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4938             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4939             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4940             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4941             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4942         16  CF-ACCESS-CD-GENL              PIC X(4).
  4943         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4944             20  CF-PROCESSOR               PIC X(4).
  4945         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4946             20  CF-STATE-CODE              PIC XX.
  4947             20  FILLER                     PIC XX.
  4948         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4949             20  FILLER                     PIC XX.
  4950             20  CF-HI-BEN-IN-REC           PIC XX.
  4951         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4952             20  FILLER                     PIC XXX.
  4953             20  CF-CARRIER-CNTL            PIC X.
  4954         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4955             20  FILLER                     PIC XX.
  4956             20  CF-HI-TYPE-IN-REC          PIC 99.
  4957         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4958             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4959                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4960             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4961             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4962         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4963             20  FILLER                     PIC X.
  4964             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4965         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4966             20  FILLER                     PIC XX.
  4967             20  CF-MORTGAGE-PLAN           PIC XX.
  4968         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4969
  4970     12  CF-LAST-MAINT-DT                   PIC XX.
  4971     12  CF-LAST-MAINT-BY                   PIC X(4).
  4972     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4973
  4974     12  CF-RECORD-BODY                     PIC X(728).
  4975
  4976
  4977****************************************************************
  4978*             COMPANY MASTER RECORD                            *
  4979****************************************************************
  4980
  4981     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4982         16  CF-COMPANY-ADDRESS.
  4983             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4984             20  CF-CL-IN-CARE-OF           PIC X(30).
  4985             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4986             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4987             20  CF-CL-CITY-STATE           PIC X(30).
  4988             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4989             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4990         16  CF-COMPANY-CD                  PIC X.
  4991         16  CF-COMPANY-PASSWORD            PIC X(8).
  4992         16  CF-SECURITY-OPTION             PIC X.
  4993             88  ALL-SECURITY                   VALUE '1'.
  4994             88  COMPANY-VERIFY                 VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  93
* EL050.cbl
  4995             88  PROCESSOR-VERIFY               VALUE '3'.
  4996             88  NO-SECURITY                    VALUE '4'.
  4997             88  ALL-BUT-TERM                   VALUE '5'.
  4998         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4999             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5000         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5001             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5002         16  CF-INFORCE-LOCATION            PIC X.
  5003             88  CERTS-ARE-ONLINE               VALUE '1'.
  5004             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5005             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5006         16  CF-LOWER-CASE-LETTERS          PIC X.
  5007         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5008             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5009             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5010             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5011             88  CF-ACCNT-CNTL                  VALUE '3'.
  5012             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5013
  5014         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5015         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5016
  5017         16  CF-LGX-CREDIT-USER             PIC X.
  5018             88  CO-IS-NOT-USER                 VALUE 'N'.
  5019             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5020
  5021         16 CF-CREDIT-CALC-CODES.
  5022             20  CF-CR-REM-TERM-CALC PIC X.
  5023               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5024               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5025               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5026               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5027               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5028               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5029               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5030             20  CF-CR-R78-METHOD           PIC X.
  5031               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5032               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5033
  5034         16  CF-CLAIM-CONTROL-COUNTS.
  5035             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5036                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5037
  5038             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5039                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5040
  5041             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5042                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5043
  5044             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5045                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5046
  5047         16  CF-CURRENT-MONTH-END           PIC XX.
  5048
  5049         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5050             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5051             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5052             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  94
* EL050.cbl
  5053             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5054                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5055                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5056             20  CF-CO-PREM-REJECT-SW       PIC X.
  5057                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5058                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5059             20  CF-CO-REF-REJECT-SW        PIC X.
  5060                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5061                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5062
  5063         16  CF-CO-REPORTING-DT             PIC XX.
  5064         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5065         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5066           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5067           88  CF-CO-MONTH-END                  VALUE '1'.
  5068
  5069         16  CF-LGX-CLAIM-USER              PIC X.
  5070             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5071             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5072
  5073         16  CF-CREDIT-EDIT-CONTROLS.
  5074             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5075             20  CF-MIN-AGE                 PIC 99.
  5076             20  CF-DEFAULT-AGE             PIC 99.
  5077             20  CF-MIN-TERM                PIC S999      COMP-3.
  5078             20  CF-MAX-TERM                PIC S999      COMP-3.
  5079             20  CF-DEFAULT-SEX             PIC X.
  5080             20  CF-JOINT-AGE-INPUT         PIC X.
  5081                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5082             20  CF-BIRTH-DATE-INPUT        PIC X.
  5083                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5084             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5085                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5086                 88  CF-ZERO-CARRIER            VALUE '1'.
  5087                 88  CF-ZERO-GROUPING           VALUE '2'.
  5088                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5089             20  CF-EDIT-SW                 PIC X.
  5090                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5091             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5092             20  CF-CR-PR-METHOD            PIC X.
  5093               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5094               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5095             20  FILLER                     PIC X.
  5096
  5097         16  CF-CREDIT-MISC-CONTROLS.
  5098             20  CF-REIN-TABLE-SW           PIC X.
  5099                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5100             20  CF-COMP-TABLE-SW           PIC X.
  5101                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5102             20  CF-EXPERIENCE-RETENTION-AGE
  5103                                            PIC S9        COMP-3.
  5104             20  CF-CONVERSION-DT           PIC XX.
  5105             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5106             20  CF-RUN-FREQUENCY-SW        PIC X.
  5107                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5108                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5109
  5110             20  CF-CR-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  95
* EL050.cbl
  5111                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5112                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5113                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5114                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5115                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5116                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5117
  5118                 24  CF-CR-CHECK-COUNT       REDEFINES
  5119                     CF-CR-CHECK-COUNTER      PIC X(4).
  5120
  5121                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5122                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5123
  5124                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5125                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5126                 24  CF-MAIL-PROCESSING       PIC X.
  5127                     88  MAIL-PROCESSING          VALUE 'Y'.
  5128
  5129         16  CF-MISC-SYSTEM-CONTROL.
  5130             20  CF-SYSTEM-C                 PIC X.
  5131                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5132             20  CF-SYSTEM-D                 PIC X.
  5133                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5134             20  CF-SOC-SEC-NO-SW            PIC X.
  5135                 88  SOC-SEC-NO-USED             VALUE '1'.
  5136             20  CF-MEMBER-NO-SW             PIC X.
  5137                 88  MEMBER-NO-USED              VALUE '1'.
  5138             20  CF-TAX-ID-NUMBER            PIC X(11).
  5139             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5140             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5141                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5142                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5143                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5144                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5145             20  CF-SYSTEM-E                 PIC X.
  5146                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5147
  5148         16  CF-LGX-LIFE-USER               PIC X.
  5149             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5150             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5151
  5152         16  CF-CR-MONTH-END-DT             PIC XX.
  5153
  5154         16  CF-FILE-MAINT-DATES.
  5155             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5156                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5157             20  CF-LAST-BATCH       REDEFINES
  5158                 CF-LAST-BATCH-NO               PIC X(4).
  5159             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5160             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5161             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5162             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5163             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5164             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5165             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5166             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5167             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5168             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  96
* EL050.cbl
  5169
  5170         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5171         16  FILLER                         PIC X.
  5172
  5173         16  CF-ALT-MORT-CODE               PIC X(4).
  5174         16  CF-MEMBER-CAPTION              PIC X(10).
  5175
  5176         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5177             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5178             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5179             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5180             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5181             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5182
  5183         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5184
  5185         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5186         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5187         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5188         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5189
  5190         16  CF-AH-OVERRIDE-L1              PIC X.
  5191         16  CF-AH-OVERRIDE-L2              PIC XX.
  5192         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5193         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5194
  5195         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5196         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5197
  5198         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5199         16  CF-AR-LAST-EL860-DT            PIC XX.
  5200         16  CF-MP-MONTH-END-DT             PIC XX.
  5201
  5202         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5203         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5204             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5205
  5206         16  CF-AR-MONTH-END-DT             PIC XX.
  5207
  5208         16  CF-CRDTCRD-USER                PIC X.
  5209             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5210             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5211
  5212         16  CF-CC-MONTH-END-DT             PIC XX.
  5213
  5214         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5215
  5216         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5217             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5218             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5219             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5220         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5221         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5222         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5223         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5224             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5225             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5226         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  97
* EL050.cbl
  5227         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5228         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5229             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5230         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5231
  5232         16  CF-CL-ZIP-CODE.
  5233             20  CF-CL-ZIP-PRIME.
  5234                 24  CF-CL-ZIP-1ST          PIC X.
  5235                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5236                 24  FILLER                 PIC X(4).
  5237             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5238         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5239             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5240             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5241             20  FILLER                     PIC XXX.
  5242
  5243         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5244         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5245         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5246         16  CF-CO-OPTION-START-DATE        PIC XX.
  5247         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5248           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5249                                                      '3' '4'.
  5250           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5251           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5252           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5253           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5254           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5255           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5256
  5257         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5258
  5259         16  CF-PAYMENT-APPROVAL-LEVELS.
  5260             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5261             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5262             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5263             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5264             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5265             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5266
  5267         16  CF-END-USER-REPORTING-USER     PIC X.
  5268             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5269             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5270
  5271         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5272             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5273             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5274
  5275         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5276
  5277         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5278         16  FILLER                         PIC X.
  5279
  5280         16  CF-CREDIT-ARCHIVE-CNTL.
  5281             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5282             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5283             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5284
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  98
* EL050.cbl
  5285         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5286
  5287         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5288             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5289             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5290
  5291         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5292             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5293             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5294
  5295         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5296
  5297         16  CF-CO-ACH-ID-CODE              PIC  X.
  5298             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5299             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5300             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5301         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5302         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5303         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5304         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5305         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5306         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5307         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5308         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5309         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5310                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5311         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5312                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5313
  5314         16  CF-CO-OVER-SHORT.
  5315             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5316             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5317
  5318*         16  FILLER                         PIC X(102).
  5319         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5320             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5321             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5322
  5323         16  CF-AH-APPROVAL-DAYS.
  5324             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5325             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5326             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5327             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5328
  5329         16  FILLER                         PIC X(82).
  5330****************************************************************
  5331*             PROCESSOR/USER RECORD                            *
  5332****************************************************************
  5333
  5334     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5335         16  CF-PROCESSOR-NAME              PIC X(30).
  5336         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5337         16  CF-PROCESSOR-TITLE             PIC X(26).
  5338         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5339                 88  MESSAGE-YES                VALUE 'Y'.
  5340                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5341
  5342*****************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page  99
* EL050.cbl
  5343****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5344****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5345****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5346****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5347*****************************************************
  5348
  5349         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5350             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5351             20  CF-APPLICATION-FORCE       PIC X.
  5352             20  CF-INDIVIDUAL-APP.
  5353                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5354                     28  CF-BROWSE-APP      PIC X.
  5355                     28  CF-UPDATE-APP      PIC X.
  5356
  5357         16  CF-CURRENT-TERM-ON             PIC X(4).
  5358         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5359             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5360             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5361             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5362             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5363             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5364             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5365             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5366         16  CF-PROCESSOR-CARRIER           PIC X.
  5367             88  NO-CARRIER-SECURITY            VALUE ' '.
  5368         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5369             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5370         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5371             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5372         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5373             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5374
  5375         16  CF-PROC-SYS-ACCESS-SW.
  5376             20  CF-PROC-CREDIT-CLAIMS-SW.
  5377                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5378                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5379                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5380                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5381             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5382                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5383                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5384             20  CF-PROC-LIFE-GNRLDGR-SW.
  5385                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5386                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5387                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5388                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5389             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5390                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5391                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5392         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5393             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5394             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5395         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5396
  5397         16  CF-APPROVAL-LEVEL                  PIC X.
  5398             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5399             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5400             88  APPROVAL-LEVEL-3                   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 100
* EL050.cbl
  5401             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5402
  5403         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5404
  5405         16  CF-LANGUAGE-TYPE                   PIC X.
  5406             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5407             88  CF-LANG-IS-FR                      VALUE 'F'.
  5408
  5409         16  CF-CSR-IND                         PIC X.
  5410         16  FILLER                             PIC X(239).
  5411
  5412****************************************************************
  5413*             PROCESSOR/REMINDERS RECORD                       *
  5414****************************************************************
  5415
  5416     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5417         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5418             20  CF-START-REMIND-DT         PIC XX.
  5419             20  CF-END-REMIND-DT           PIC XX.
  5420             20  CF-REMINDER-TEXT           PIC X(50).
  5421         16  FILLER                         PIC X(296).
  5422
  5423
  5424****************************************************************
  5425*             STATE MASTER RECORD                              *
  5426****************************************************************
  5427
  5428     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5429         16  CF-STATE-ABBREVIATION          PIC XX.
  5430         16  CF-STATE-NAME                  PIC X(25).
  5431         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5432         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5433             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5434             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5435             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5436             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5437                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5438                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5439             20  CF-ST-PREM-REJECT-SW       PIC X.
  5440                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5441                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5442             20  CF-ST-REF-REJECT-SW        PIC X.
  5443                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5444                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5445         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5446         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5447         16  CF-ST-REFUND-RULES.
  5448             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5449             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5450             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5451         16  CF-ST-FST-PMT-EXTENSION.
  5452             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5453             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5454                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5455                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5456                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5457                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5458         16  CF-ST-STATE-CALL.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 101
* EL050.cbl
  5459             20  CF-ST-CALL-UNEARNED        PIC X.
  5460             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5461             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5462         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5463             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5464             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5465         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5466         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5467         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5468         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5469         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5470         16  FILLER                         PIC X.
  5471         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5472             20  CF-ST-BENEFIT-CD           PIC XX.
  5473             20  CF-ST-BENEFIT-KIND         PIC X.
  5474                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5475                 88  CF-ST-AH-KIND              VALUE 'A'.
  5476             20  CF-ST-REM-TERM-CALC        PIC X.
  5477                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5478                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5479                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5480                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5481                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5482                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5483                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5484                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5485
  5486             20  CF-ST-REFUND-CALC          PIC X.
  5487                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5488                 88  ST-REFD-BY-R78             VALUE '1'.
  5489                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5490                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5491                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5492                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5493                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5494                 88  ST-REFD-UTAH               VALUE '7'.
  5495                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5496                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5497                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5498
  5499             20  CF-ST-EARNING-CALC         PIC X.
  5500                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5501                 88  ST-EARN-BY-R78             VALUE '1'.
  5502                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5503                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5504                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5505                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5506                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5507                 88  ST-EARN-MEAN               VALUE '8'.
  5508                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5509
  5510             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5511                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5512                 88  ST-OVRD-BY-R78             VALUE '1'.
  5513                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5514                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5515                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5516                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 102
* EL050.cbl
  5517                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5518                 88  ST-OVRD-MEAN               VALUE '8'.
  5519                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5520             20  FILLER                     PIC X.
  5521
  5522         16  CF-ST-COMMISSION-CAPS.
  5523             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5524             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5525             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5526             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5527         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5528                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5529
  5530         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5531
  5532         16  CF-ST-STATUTORY-INTEREST.
  5533             20  CF-ST-STAT-DATE-FROM       PIC X.
  5534                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5535                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5536             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5537             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5538             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5539             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5540             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5541
  5542         16  CF-ST-OVER-SHORT.
  5543             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5544             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5545
  5546         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5547
  5548         16  CF-ST-RT-CALC                  PIC X.
  5549
  5550         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5551         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5552         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5553         16  CF-ST-RF-LR-CALC               PIC X.
  5554         16  CF-ST-RF-LL-CALC               PIC X.
  5555         16  CF-ST-RF-LN-CALC               PIC X.
  5556         16  CF-ST-RF-AH-CALC               PIC X.
  5557         16  CF-ST-RF-CP-CALC               PIC X.
  5558*        16  FILLER                         PIC X(206).
  5559*CIDMOD         16  FILLER                         PIC X(192).
  5560         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5561             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5562         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5563         16  CF-ST-VFY-2ND-BENE             PIC X.
  5564         16  FILLER                         PIC X(186).
  5565
  5566****************************************************************
  5567*             BENEFIT MASTER RECORD                            *
  5568****************************************************************
  5569
  5570     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5571         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5572             20  CF-BENEFIT-CODE            PIC XX.
  5573             20  CF-BENEFIT-NUMERIC  REDEFINES
  5574                 CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 103
* EL050.cbl
  5575             20  CF-BENEFIT-ALPHA           PIC XXX.
  5576             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5577             20  CF-BENEFIT-COMMENT         PIC X(10).
  5578
  5579             20  CF-LF-COVERAGE-TYPE        PIC X.
  5580                 88  CF-REDUCING                VALUE 'R'.
  5581                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5582
  5583             20  CF-SPECIAL-CALC-CD         PIC X.
  5584                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5585                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5586                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5587                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5588                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5589                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5590                 88  CF-FARM-PLAN               VALUE 'F'.
  5591                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5592                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5593                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5594                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5595                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5596                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5597                 88  CF-PRUDENTIAL              VALUE 'P'.
  5598                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5599                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5600                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5601                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5602                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5603                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5604
  5605             20  CF-JOINT-INDICATOR         PIC X.
  5606                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5607
  5608*            20  FILLER                     PIC X(12).
  5609             20  FILLER                     PIC X(11).
  5610             20  CF-BENEFIT-CATEGORY        PIC X.
  5611             20  CF-LOAN-TYPE               PIC X(8).
  5612
  5613             20  CF-CO-REM-TERM-CALC        PIC X.
  5614                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5615                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5616                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5617                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5618                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5619
  5620             20  CF-CO-EARNINGS-CALC        PIC X.
  5621                 88  CO-EARN-BY-R78             VALUE '1'.
  5622                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5623                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5624                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5625                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5626                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5627                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5628                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5629
  5630             20  CF-CO-REFUND-CALC          PIC X.
  5631                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5632                 88  CO-REFD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 104
* EL050.cbl
  5633                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5634                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5635                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5636                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5637                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5638                 88  CO-REFD-MEAN               VALUE '8'.
  5639                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5640                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5641                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5642
  5643             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5644                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5645                 88  CO-OVRD-BY-R78             VALUE '1'.
  5646                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5647                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5648                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5649                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5650                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5651                 88  CO-OVRD-MEAN               VALUE '8'.
  5652                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5653
  5654             20  CF-CO-BEN-I-G-CD           PIC X.
  5655                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5656                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5657                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5658
  5659         16  FILLER                         PIC X(304).
  5660
  5661
  5662****************************************************************
  5663*             CARRIER MASTER RECORD                            *
  5664****************************************************************
  5665
  5666     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5667         16  CF-ADDRESS-DATA.
  5668             20  CF-MAIL-TO-NAME            PIC X(30).
  5669             20  CF-IN-CARE-OF              PIC X(30).
  5670             20  CF-ADDRESS-LINE-1          PIC X(30).
  5671             20  CF-ADDRESS-LINE-2          PIC X(30).
  5672             20  CF-CITY-STATE              PIC X(30).
  5673             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5674             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5675
  5676         16  CF-CLAIM-NO-CONTROL.
  5677             20  CF-CLAIM-NO-METHOD         PIC X.
  5678                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5679                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5680                 88  CLAIM-NO-SEQ               VALUE '3'.
  5681                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5682             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5683                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5684                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5685                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5686
  5687         16  CF-CHECK-NO-CONTROL.
  5688             20  CF-CHECK-NO-METHOD         PIC X.
  5689                 88  CHECK-NO-MANUAL            VALUE '1'.
  5690                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 105
* EL050.cbl
  5691                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5692                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5693             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5694                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5695
  5696         16  CF-DOMICILE-STATE              PIC XX.
  5697
  5698         16  CF-EXPENSE-CONTROLS.
  5699             20  CF-EXPENSE-METHOD          PIC X.
  5700                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5701                 88  DOLLARS-PER-PMT            VALUE '2'.
  5702                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5703                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5704             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5705             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5706
  5707         16  CF-CORRESPONDENCE-CONTROL.
  5708             20  CF-LETTER-RESEND-OPT       PIC X.
  5709                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5710                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5711             20  FILLER                     PIC X(4).
  5712
  5713         16  CF-RESERVE-CONTROLS.
  5714             20  CF-MANUAL-SW               PIC X.
  5715                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5716             20  CF-FUTURE-SW               PIC X.
  5717                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5718             20  CF-PTC-SW                  PIC X.
  5719                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5720             20  CF-IBNR-SW                 PIC X.
  5721                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5722             20  CF-PTC-LF-SW               PIC X.
  5723                 88  CF-LF-PTC-USED             VALUE '1'.
  5724             20  CF-CDT-ACCESS-METHOD       PIC X.
  5725                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5726                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5727                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5728             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5729
  5730         16  CF-CLAIM-CALC-METHOD           PIC X.
  5731             88  360-PLUS-MONTHS                VALUE '1'.
  5732             88  365-PLUS-MONTHS                VALUE '2'.
  5733             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5734             88  360-DAILY                      VALUE '4'.
  5735             88  365-DAILY                      VALUE '5'.
  5736
  5737         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5738         16  FILLER                         PIC X(11).
  5739
  5740         16  CF-LIMIT-AMOUNTS.
  5741             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5742             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5743             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5744             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5745             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5746             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5747             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5748             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 106
* EL050.cbl
  5749             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5750             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5751
  5752         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5753         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5754         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5755
  5756         16  CF-ZIP-CODE.
  5757             20  CF-ZIP-PRIME.
  5758                 24  CF-ZIP-1ST             PIC X.
  5759                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5760                 24  FILLER                 PIC X(4).
  5761             20  CF-ZIP-PLUS4               PIC X(4).
  5762         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5763             20  CF-CAN-POSTAL-1            PIC XXX.
  5764             20  CF-CAN-POSTAL-2            PIC XXX.
  5765             20  FILLER                     PIC XXX.
  5766
  5767         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5768         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5769         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5770
  5771         16  CF-RATING-SWITCH               PIC X.
  5772             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5773             88  CF-NO-RATING                   VALUE 'N'.
  5774
  5775         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5776
  5777         16  CF-CARRIER-OVER-SHORT.
  5778             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5779             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5780
  5781         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5782         16  CF-SECPAY-SWITCH               PIC X.
  5783             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5784             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5785         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5786         16  FILLER                         PIC X(448).
  5787*        16  FILLER                         PIC X(452).
  5788
  5789
  5790****************************************************************
  5791*             MORTALITY MASTER RECORD                          *
  5792****************************************************************
  5793
  5794     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5795         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5796                                INDEXED BY CF-MORT-NDX.
  5797             20  CF-MORT-TABLE              PIC X(5).
  5798             20  CF-MORT-TABLE-TYPE         PIC X.
  5799                 88  CF-MORT-JOINT              VALUE 'J'.
  5800                 88  CF-MORT-SINGLE             VALUE 'S'.
  5801                 88  CF-MORT-COMBINED           VALUE 'C'.
  5802                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5803                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5804             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5805             20  CF-MORT-AGE-METHOD         PIC XX.
  5806                 88  CF-AGE-LAST                VALUE 'AL'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 107
* EL050.cbl
  5807                 88  CF-AGE-NEAR                VALUE 'AN'.
  5808             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5809             20  CF-MORT-ADJUSTMENT-DIRECTION
  5810                                            PIC X.
  5811                 88  CF-MINUS                   VALUE '-'.
  5812                 88  CF-PLUS                    VALUE '+'.
  5813             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5814             20  CF-MORT-JOINT-CODE         PIC X.
  5815                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5816             20  CF-MORT-PC-Q               PIC X.
  5817                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5818             20  CF-MORT-TABLE-CODE         PIC X(4).
  5819             20  CF-MORT-COMMENTS           PIC X(15).
  5820             20  FILLER                     PIC X(14).
  5821
  5822         16  FILLER                         PIC X(251).
  5823
  5824
  5825****************************************************************
  5826*             BUSSINESS TYPE MASTER RECORD                     *
  5827****************************************************************
  5828
  5829     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5830* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5831* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5832* AND RECORD 05 IS TYPES 81-99
  5833         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5834             20  CF-BUSINESS-TITLE          PIC  X(19).
  5835             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5836                                            PIC S9V9(4) COMP-3.
  5837             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5838             20  FILLER                     PIC  X.
  5839         16  FILLER                         PIC  X(248).
  5840
  5841
  5842****************************************************************
  5843*             TERMINAL MASTER RECORD                           *
  5844****************************************************************
  5845
  5846     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5847
  5848         16  CF-COMPANY-TERMINALS.
  5849             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5850                                  PIC X(4).
  5851         16  FILLER               PIC X(248).
  5852
  5853
  5854****************************************************************
  5855*             LIFE EDIT MASTER RECORD                          *
  5856****************************************************************
  5857
  5858     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5859         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5860             20  CF-LIFE-CODE-IN            PIC XX.
  5861             20  CF-LIFE-CODE-OUT           PIC XX.
  5862         16  FILLER                         PIC X(248).
  5863
  5864
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 108
* EL050.cbl
  5865****************************************************************
  5866*             AH EDIT MASTER RECORD                            *
  5867****************************************************************
  5868
  5869     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5870         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5871             20  CF-AH-CODE-IN              PIC XXX.
  5872             20  CF-AH-CODE-OUT             PIC XX.
  5873         16  FILLER                         PIC X(248).
  5874
  5875
  5876****************************************************************
  5877*             CREDIBILITY TABLES                               *
  5878****************************************************************
  5879
  5880     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5881         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5882                             INDEXED BY CF-CRDB-NDX.
  5883             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5884             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5885             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5886         16  FILLER                         PIC  X(332).
  5887
  5888
  5889****************************************************************
  5890*             REPORT CUSTOMIZATION RECORD                      *
  5891****************************************************************
  5892
  5893     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5894         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5895             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5896             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5897             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5898**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5899****       A T-TRANSFER.                                   ****
  5900             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5901
  5902         16  FILLER                         PIC XX.
  5903
  5904         16  CF-CARRIER-CNTL-OPT.
  5905             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5906                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5907                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5908             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5909                                            PIC X.
  5910         16  CF-GROUP-CNTL-OPT.
  5911             20  CF-GROUP-OPT-SEQ           PIC 9.
  5912                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5913                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5914             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5915                                            PIC X(6).
  5916         16  CF-STATE-CNTL-OPT.
  5917             20  CF-STATE-OPT-SEQ           PIC 9.
  5918                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5919                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5920             20  CF-STATE-SELECT OCCURS 3 TIMES
  5921                                            PIC XX.
  5922         16  CF-ACCOUNT-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 109
* EL050.cbl
  5923             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5924                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5925                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5926             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5927                                            PIC X(10).
  5928         16  CF-BUS-TYP-CNTL-OPT.
  5929             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5930                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5931                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5932             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5933                                            PIC XX.
  5934         16  CF-LF-TYP-CNTL-OPT.
  5935             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5936                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5937                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5938             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5939                                            PIC XX.
  5940         16  CF-AH-TYP-CNTL-OPT.
  5941             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5942                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5943                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5944             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5945                                            PIC XX.
  5946         16  CF-REPTCD1-CNTL-OPT.
  5947             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5948                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5949                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5950             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5951                                            PIC X(10).
  5952         16  CF-REPTCD2-CNTL-OPT.
  5953             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5954                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5955                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5956             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5957                                            PIC X(10).
  5958         16  CF-USER1-CNTL-OPT.
  5959             20  CF-USER1-OPT-SEQ           PIC 9.
  5960                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5961                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5962             20  CF-USER1-SELECT OCCURS 3 TIMES
  5963                                            PIC X(10).
  5964         16  CF-USER2-CNTL-OPT.
  5965             20  CF-USER2-OPT-SEQ           PIC 9.
  5966                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5967                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5968             20  CF-USER2-SELECT OCCURS 3 TIMES
  5969                                            PIC X(10).
  5970         16  CF-USER3-CNTL-OPT.
  5971             20  CF-USER3-OPT-SEQ           PIC 9.
  5972                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5973                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5974             20  CF-USER3-SELECT OCCURS 3 TIMES
  5975                                            PIC X(10).
  5976         16  CF-USER4-CNTL-OPT.
  5977             20  CF-USER4-OPT-SEQ           PIC 9.
  5978                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5979                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5980             20  CF-USER4-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 110
* EL050.cbl
  5981                                            PIC X(10).
  5982         16  CF-USER5-CNTL-OPT.
  5983             20  CF-USER5-OPT-SEQ           PIC 9.
  5984                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5985                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5986             20  CF-USER5-SELECT OCCURS 3 TIMES
  5987                                            PIC X(10).
  5988         16  CF-REINS-CNTL-OPT.
  5989             20  CF-REINS-OPT-SEQ           PIC 9.
  5990                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5991                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5992             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5993                 24  CF-REINS-PRIME         PIC XXX.
  5994                 24  CF-REINS-SUB           PIC XXX.
  5995
  5996         16  CF-AGENT-CNTL-OPT.
  5997             20  CF-AGENT-OPT-SEQ           PIC 9.
  5998                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5999                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6000             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6001                                            PIC X(10).
  6002
  6003         16  FILLER                         PIC X(43).
  6004
  6005         16  CF-LOSS-RATIO-SELECT.
  6006             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6007             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6008         16  CF-ENTRY-DATE-SELECT.
  6009             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6010             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6011         16  CF-EFFECTIVE-DATE-SELECT.
  6012             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6013             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6014
  6015         16  CF-EXCEPTION-LIST-IND          PIC X.
  6016             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6017
  6018         16  FILLER                         PIC X(318).
  6019
  6020****************************************************************
  6021*                  EXCEPTION REPORTING RECORD                  *
  6022****************************************************************
  6023
  6024     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6025         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6026             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6027
  6028         16  CF-COMBINED-LIFE-AH-OPT.
  6029             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6030             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6031             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6032             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6033
  6034         16  CF-LIFE-OPT.
  6035             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6036             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6037             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6038             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 111
* EL050.cbl
  6039             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6040             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6041             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6042             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6043             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6044             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6045
  6046         16  CF-AH-OPT.
  6047             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6048             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6049             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6050             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6051             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6052             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6053             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6054             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6055             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6056             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6057
  6058         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6059             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6060             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6061             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6062
  6063         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6064
  6065         16  FILLER                         PIC X(673).
  6066
  6067
  6068****************************************************************
  6069*             MORTGAGE SYSTEM PLAN RECORD                      *
  6070****************************************************************
  6071
  6072     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6073         16  CF-PLAN-TYPE                   PIC X.
  6074             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6075             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6076             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6077         16  CF-PLAN-ABBREV                 PIC XXX.
  6078         16  CF-PLAN-DESCRIPT               PIC X(10).
  6079         16  CF-PLAN-NOTES                  PIC X(20).
  6080         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6081         16  CF-PLAN-UNDERWRITING.
  6082             20  CF-PLAN-TERM-DATA.
  6083                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6084                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6085             20  CF-PLAN-AGE-DATA.
  6086                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6087                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6088                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6089             20  CF-PLAN-BENEFIT-DATA.
  6090                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6091                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6092                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6093                                            PIC S9(7)V99  COMP-3.
  6094         16  CF-PLAN-POLICY-FORMS.
  6095             20  CF-POLICY-FORM             PIC X(12).
  6096             20  CF-MASTER-APPLICATION      PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 112
* EL050.cbl
  6097             20  CF-MASTER-POLICY           PIC X(12).
  6098         16  CF-PLAN-RATING.
  6099             20  CF-RATE-CODE               PIC X(5).
  6100             20  CF-SEX-RATING              PIC X.
  6101                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6102                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6103             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6104             20  CF-SUB-STD-TYPE            PIC X.
  6105                 88  CF-PCT-OF-PREM            VALUE '1'.
  6106                 88  CF-PCT-OF-BENE            VALUE '2'.
  6107         16  CF-PLAN-PREM-TOLERANCES.
  6108             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6109             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6110         16  CF-PLAN-PYMT-TOLERANCES.
  6111             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6112             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6113         16  CF-PLAN-MISC-DATA.
  6114             20  FILLER                     PIC X.
  6115             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6116             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6117         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6118         16  CF-PLAN-IND-GRP                PIC X.
  6119             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6120                                                     '1'.
  6121             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6122                                                     '2'.
  6123         16  CF-MIB-SEARCH-SW               PIC X.
  6124             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6125             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6126             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6127             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6128         16  CF-ALPHA-SEARCH-SW             PIC X.
  6129             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6130             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6131             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6132             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6133             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6134             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6135             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6136             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6137             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6138             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6139                                                     'A' 'B' 'C'
  6140                                                     'X' 'Y' 'Z'.
  6141         16  CF-EFF-DT-RULE-SW              PIC X.
  6142             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6143             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6144             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6145             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6146             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6147         16  FILLER                         PIC X(4).
  6148         16  CF-HEALTH-QUESTIONS            PIC X.
  6149             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6150         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6151         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6152         16  CF-PLAN-SNGL-JNT               PIC X.
  6153             88  CF-COMBINED-PLAN              VALUE 'C'.
  6154             88  CF-JNT-PLAN                   VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 113
* EL050.cbl
  6155             88  CF-SNGL-PLAN                  VALUE 'S'.
  6156         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6157         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6158         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6159         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6160         16  CF-RERATE-CNTL                 PIC  X.
  6161             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6162             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6163             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6164             88  CF-AUTO-RECALC                 VALUE '4'.
  6165         16  CF-BENEFIT-TYPE                PIC  X.
  6166             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6167             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6168         16  CF-POLICY-FEE                  PIC S999V99
  6169                                                    COMP-3.
  6170         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6171         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6172         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6173         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6174         16  FILLER                         PIC  X(32).
  6175         16  CF-TERMINATION-FORM            PIC  X(04).
  6176         16  FILLER                         PIC  X(08).
  6177         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6178                                                       COMP-3.
  6179         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6180         16  CF-ISSUE-LETTER                PIC  X(4).
  6181         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6182         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6183             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6184             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6185         16  CF-MP-REFUND-CALC              PIC X.
  6186             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6187             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6188             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6189             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6190             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6191             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6192             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6193             88  CF-MP-REFD-MEAN                VALUE '8'.
  6194         16  CF-ALT-RATE-CODE               PIC  X(5).
  6195
  6196
  6197         16  FILLER                         PIC X(498).
  6198****************************************************************
  6199*             MORTGAGE COMPANY MASTER RECORD                   *
  6200****************************************************************
  6201
  6202     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6203         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6204         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6205             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6206             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6207             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6208             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6209             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6210
  6211         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6212         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 114
* EL050.cbl
  6213         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6214         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6215         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6216
  6217         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6218             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6219         16  CF-MP-RECON-USE-IND            PIC X(1).
  6220             88  CF-MP-USE-RECON             VALUE 'Y'.
  6221         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6222             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6223         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6224             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6225             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6226         16  FILLER                         PIC X(1).
  6227         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6228             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6229         16  CF-MORTG-MIB-VERSION           PIC X.
  6230             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6231             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6232             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6233         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6234             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6235                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6236             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6237                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6238             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6239                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6240             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6241                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6242             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6243                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6244             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6245                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6246         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6247         16  FILLER                         PIC X(7).
  6248         16  CF-MORTG-DESTINATION-SYMBOL.
  6249             20  CF-MORTG-MIB-COMM          PIC X(5).
  6250             20  CF-MORTG-MIB-TERM          PIC X(5).
  6251         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6252             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6253         16  FILLER                         PIC X(03).
  6254         16  CF-MP-CHECK-NO-CONTROL.
  6255             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6256                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6257                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6258                                                ' ' LOW-VALUES.
  6259                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6260                                               VALUE '3'.
  6261         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6262         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6263         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6264             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6265                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6266             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6267                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6268             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6269                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6270             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 115
* EL050.cbl
  6271                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6272             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6273                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6274             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6275                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6276         16  CF-MORTG-BILLING-AREA.
  6277             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6278                                            PIC X.
  6279         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6280         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6281         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6282         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6283             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6284             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6285         16  FILLER                         PIC X.
  6286         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6287             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6288             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6289         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6290         16  FILLER                         PIC X(8).
  6291         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6292         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6293         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6294         16  CF-ACH-COMPANY-ID.
  6295             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6296                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6297                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6298                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6299             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6300         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6301             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6302         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6303             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6304             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6305         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6306         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6307         16  FILLER                         PIC X(536).
  6308
  6309****************************************************************
  6310*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6311****************************************************************
  6312
  6313     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6314         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6315             20  CF-FEMALE-HEIGHT.
  6316                 24  CF-FEMALE-FT           PIC 99.
  6317                 24  CF-FEMALE-IN           PIC 99.
  6318             20  CF-FEMALE-MIN-WT           PIC 999.
  6319             20  CF-FEMALE-MAX-WT           PIC 999.
  6320         16  FILLER                         PIC X(428).
  6321
  6322     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6323         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6324             20  CF-MALE-HEIGHT.
  6325                 24  CF-MALE-FT             PIC 99.
  6326                 24  CF-MALE-IN             PIC 99.
  6327             20  CF-MALE-MIN-WT             PIC 999.
  6328             20  CF-MALE-MAX-WT             PIC 999.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 116
* EL050.cbl
  6329         16  FILLER                         PIC X(428).
  6330******************************************************************
  6331*             AUTOMATIC ACTIVITY RECORD                          *
  6332******************************************************************
  6333     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6334         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6335             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6336             20  CF-SYS-LETTER-ID           PIC X(04).
  6337             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6338             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6339             20  CF-SYS-RESET-SW            PIC X(01).
  6340             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6341             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6342
  6343         16  FILLER                         PIC X(50).
  6344
  6345         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6346             20  CF-USER-ACTIVE-SW          PIC X(01).
  6347             20  CF-USER-LETTER-ID          PIC X(04).
  6348             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6349             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6350             20  CF-USER-RESET-SW           PIC X(01).
  6351             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6352             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6353             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6354
  6355         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 117
* EL050.cbl
  6357*    COPY ERCACCT.
  6358******************************************************************
  6359*                                                                *
  6360*                                                                *
  6361*                            ERCACCT                             *
  6362*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6363*                            VMOD=2.031                          *
  6364*                                                                *
  6365*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6366*                                                                *
  6367*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6368*   VSAM ACCOUNT MASTER FILES.                                   *
  6369*                                                                *
  6370*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6371*                                                                *
  6372*   FILE TYPE = VSAM,KSDS                                        *
  6373*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6374*                                                                *
  6375*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6376*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6377*                                                                *
  6378*   LOG = NO                                                     *
  6379*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6380*                                                                *
  6381*                                                                *
  6382******************************************************************
  6383*                   C H A N G E   L O G
  6384*
  6385* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6386*-----------------------------------------------------------------
  6387*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6388* EFFECTIVE    NUMBER
  6389*-----------------------------------------------------------------
  6390* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6391* 092705    2005050300006  PEMA  ADD SPP LEASES
  6392* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6393* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6394* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6395* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6396* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6397******************************************************************
  6398
  6399 01  ACCOUNT-MASTER.
  6400     12  AM-RECORD-ID                      PIC XX.
  6401         88  VALID-AM-ID                      VALUE 'AM'.
  6402
  6403     12  AM-CONTROL-PRIMARY.
  6404         16  AM-COMPANY-CD                 PIC X.
  6405         16  AM-MSTR-CNTRL.
  6406             20  AM-CONTROL-A.
  6407                 24  AM-CARRIER            PIC X.
  6408                 24  AM-GROUPING.
  6409                     28 AM-GROUPING-PREFIX PIC XXX.
  6410                     28 AM-GROUPING-PRIME  PIC XXX.
  6411                 24  AM-STATE              PIC XX.
  6412                 24  AM-ACCOUNT.
  6413                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6414                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 118
* EL050.cbl
  6415             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6416                                           PIC X(19).
  6417             20  AM-CNTRL-B.
  6418                 24  AM-EXPIRATION-DT      PIC XX.
  6419                 24  FILLER                PIC X(4).
  6420             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6421                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6422
  6423     12  AM-CONTROL-BY-VAR-GRP.
  6424         16  AM-COMPANY-CD-A1              PIC X.
  6425         16  AM-VG-CARRIER                 PIC X.
  6426         16  AM-VG-GROUPING                PIC X(6).
  6427         16  AM-VG-STATE                   PIC XX.
  6428         16  AM-VG-ACCOUNT                 PIC X(10).
  6429         16  AM-VG-DATE.
  6430             20  AM-VG-EXPIRATION-DT       PIC XX.
  6431             20  FILLER                    PIC X(4).
  6432         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6433                                           PIC 9(11)      COMP-3.
  6434     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6435         16  FILLER                        PIC X(10).
  6436         16  AM-VG-KEY3.
  6437             20  AM-VG3-ACCOUNT            PIC X(10).
  6438             20  AM-VG3-EXP-DT             PIC XX.
  6439         16  FILLER                        PIC X(4).
  6440     12  AM-MAINT-INFORMATION.
  6441         16  AM-LAST-MAINT-DT              PIC XX.
  6442         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6443         16  AM-LAST-MAINT-USER            PIC X(4).
  6444         16  FILLER                        PIC XX.
  6445
  6446     12  AM-EFFECTIVE-DT                   PIC XX.
  6447     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6448
  6449     12  AM-PREV-DATES  COMP-3.
  6450         16  AM-PREV-EXP-DT                PIC 9(11).
  6451         16  AM-PREV-EFF-DT                PIC 9(11).
  6452
  6453     12  AM-REPORT-CODE-1                  PIC X(10).
  6454     12  AM-REPORT-CODE-2                  PIC X(10).
  6455
  6456     12  AM-CITY-CODE                      PIC X(4).
  6457     12  AM-COUNTY-PARISH                  PIC X(6).
  6458
  6459     12  AM-NAME                           PIC X(30).
  6460     12  AM-PERSON                         PIC X(30).
  6461     12  AM-ADDRS                          PIC X(30).
  6462     12  AM-CITY.
  6463         16  AM-ADDR-CITY                  PIC X(28).
  6464         16  AM-ADDR-STATE                 PIC XX.
  6465     12  AM-ZIP.
  6466         16  AM-ZIP-PRIME.
  6467             20  AM-ZIP-PRI-1ST            PIC X.
  6468                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6469             20  FILLER                    PIC X(4).
  6470         16  AM-ZIP-PLUS4                  PIC X(4).
  6471     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6472         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 119
* EL050.cbl
  6473         16  AM-CAN-POSTAL-2               PIC XXX.
  6474         16  FILLER                        PIC XXX.
  6475     12  AM-TEL-NO.
  6476         16  AM-AREA-CODE                  PIC 999.
  6477         16  AM-TEL-PRE                    PIC 999.
  6478         16  AM-TEL-NBR                    PIC 9(4).
  6479     12  AM-TEL-LOC                        PIC X.
  6480         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6481         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6482
  6483     12  AM-COMM-STRUCTURE.
  6484         16  AM-DEFN-1.
  6485             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6486                 24  AM-AGT.
  6487                     28  AM-AGT-PREFIX     PIC X(4).
  6488                     28  AM-AGT-PRIME      PIC X(6).
  6489                 24  AM-COM-TYP            PIC X.
  6490                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6491                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6492                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6493                 24  AM-RECALC-LV-INDIC    PIC X.
  6494                 24  AM-RETRO-LV-INDIC     PIC X.
  6495                 24  AM-GL-CODES           PIC X.
  6496                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6497                 24  FILLER                PIC X(01).
  6498         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6499             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6500                 24  FILLER                PIC X(11).
  6501                 24  AM-L-COMA             PIC XXX.
  6502                 24  AM-J-COMA             PIC XXX.
  6503                 24  AM-A-COMA             PIC XXX.
  6504                 24  FILLER                PIC X(6).
  6505
  6506     12  AM-COMM-CHANGE-STATUS             PIC X.
  6507         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6508
  6509     12  AM-CSR-CODE                       PIC X(4).
  6510
  6511     12  AM-BILLING-STATUS                 PIC X.
  6512         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6513         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6514     12  AM-AUTO-REFUND-SW                 PIC X.
  6515         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6516         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6517     12  AM-GPCD                           PIC 99.
  6518     12  AM-IG                             PIC X.
  6519         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6520         88  AM-HAS-GROUP                     VALUE '2'.
  6521     12  AM-STATUS                         PIC X.
  6522         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6523         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6524         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6525         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6526         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6527         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6528     12  AM-REMIT-TO                       PIC 99.
  6529     12  AM-ID-NO                          PIC X(11).
  6530
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 120
* EL050.cbl
  6531     12  AM-CAL-TABLE                      PIC XX.
  6532     12  AM-LF-DEVIATION                   PIC XXX.
  6533     12  AM-AH-DEVIATION                   PIC XXX.
  6534     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6535     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6536     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6537     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6538     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6539     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6540
  6541     12  AM-USER-FIELDS.
  6542         16  AM-FLD-1                      PIC XX.
  6543         16  AM-FLD-2                      PIC XX.
  6544         16  AM-FLD-3                      PIC XX.
  6545         16  AM-FLD-4                      PIC XX.
  6546         16  AM-FLD-5                      PIC XX.
  6547
  6548     12  AM-1ST-PROD-DATE.
  6549         16  AM-1ST-PROD-YR                PIC XX.
  6550         16  AM-1ST-PROD-MO                PIC XX.
  6551         16  AM-1ST-PROD-DA                PIC XX.
  6552     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6553     12  AM-CERTS-PURGED-DATE.
  6554         16  AM-PUR-YR                     PIC XX.
  6555         16  AM-PUR-MO                     PIC XX.
  6556         16  AM-PUR-DA                     PIC XX.
  6557     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6558     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6559     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6560     12  AM-INACTIVE-DATE.
  6561         16  AM-INA-MO                     PIC 99.
  6562         16  AM-INA-DA                     PIC 99.
  6563         16  AM-INA-YR                     PIC 99.
  6564     12  AM-AR-HI-CERT-DATE                PIC XX.
  6565
  6566     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6567     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6568
  6569     12  AM-OB-PAYMENT-MODE                PIC X.
  6570         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6571         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6572         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6573         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6574
  6575     12  AM-AH-ONLY-INDICATOR              PIC X.
  6576         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6577         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6578
  6579     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6580
  6581     12  AM-OVER-SHORT.
  6582         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6583         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6584
  6585     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6586     12  AM-DCC-CLP-STATE                  PIC XX.
  6587
  6588     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 121
* EL050.cbl
  6589     12  AM-RECALC-REIN                    PIC X.
  6590
  6591     12  AM-REI-TABLE                      PIC XXX.
  6592     12  AM-REI-ET-LF                      PIC X.
  6593     12  AM-REI-ET-AH                      PIC X.
  6594     12  AM-REI-PE-LF                      PIC X.
  6595     12  AM-REI-PE-AH                      PIC X.
  6596     12  AM-REI-PRT-ST                     PIC X.
  6597     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6598     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6599     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6600     12  AM-REI-GROUP-A                    PIC X(6).
  6601     12  AM-REI-MORT                       PIC X(4).
  6602     12  AM-REI-PRT-OW                     PIC X.
  6603     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6604     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6605     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6606     12  AM-REI-GROUP-B                    PIC X(6).
  6607
  6608     12  AM-TRUST-TYPE                     PIC X(2).
  6609
  6610     12  AM-EMPLOYER-STMT-USED             PIC X.
  6611     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6612
  6613     12  AM-STD-AH-TYPE                    PIC XX.
  6614     12  AM-EARN-METHODS.
  6615         16  AM-EARN-METHOD-R              PIC X.
  6616             88 AM-REF-RL-R78                 VALUE 'R'.
  6617             88 AM-REF-RL-PR                  VALUE 'P'.
  6618             88 AM-REF-RL-MEAN                VALUE 'M'.
  6619             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6620         16  AM-EARN-METHOD-L              PIC X.
  6621             88 AM-REF-LL-R78                 VALUE 'R'.
  6622             88 AM-REF-LL-PR                  VALUE 'P'.
  6623             88 AM-REF-LL-MEAN                VALUE 'M'.
  6624             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6625         16  AM-EARN-METHOD-A              PIC X.
  6626             88 AM-REF-AH-R78                 VALUE 'R'.
  6627             88 AM-REF-AH-PR                  VALUE 'P'.
  6628             88 AM-REF-AH-MEAN                VALUE 'M'.
  6629             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6630             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6631             88 AM-REF-AH-NET                 VALUE 'N'.
  6632
  6633     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6634     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6635     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6636
  6637     12  AM-RET-Y-N                        PIC X.
  6638     12  AM-RET-P-E                        PIC X.
  6639     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6640     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6641     12  AM-RET-GRP                        PIC X(6).
  6642     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6643         16  AM-POOL-PRIME                 PIC XXX.
  6644         16  AM-POOL-SUB                   PIC XXX.
  6645     12  AM-RETRO-EARNINGS.
  6646         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 122
* EL050.cbl
  6647         16  AM-RET-EARN-L                 PIC X.
  6648         16  AM-RET-EARN-A                 PIC X.
  6649     12  AM-RET-ST-TAX-USE                 PIC X.
  6650         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6651         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6652     12  AM-RETRO-BEG-EARNINGS.
  6653         16  AM-RET-BEG-EARN-R             PIC X.
  6654         16  AM-RET-BEG-EARN-L             PIC X.
  6655         16  AM-RET-BEG-EARN-A             PIC X.
  6656     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6657     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6658
  6659     12  AM-USER-SELECT-OPTIONS.
  6660         16  AM-USER-SELECT-1              PIC X(10).
  6661         16  AM-USER-SELECT-2              PIC X(10).
  6662         16  AM-USER-SELECT-3              PIC X(10).
  6663         16  AM-USER-SELECT-4              PIC X(10).
  6664         16  AM-USER-SELECT-5              PIC X(10).
  6665
  6666     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6667
  6668     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6669
  6670     12  AM-RPT045A-SWITCH                 PIC X.
  6671         88  RPT045A-OFF                   VALUE 'N'.
  6672
  6673     12  AM-INSURANCE-LIMITS.
  6674         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6675         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6676
  6677     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6678         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6679
  6680     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6681         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6682         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6683
  6684     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6685
  6686     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6687     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6688     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6689     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6690     12  AM-DCC-UEF-STATE                  PIC XX.
  6691     12  FILLER                            PIC XXX.
  6692     12  AM-REPORT-CODE-3                  PIC X(10).
  6693*    12  FILLER                            PIC X(22).
  6694
  6695     12  AM-RESERVE-DATE.
  6696         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6697         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6698         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6699
  6700     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6701     12  AM-NOTIFICATION-TYPES.
  6702         16  AM-NOTIF-OF-LETTERS           PIC X.
  6703         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6704         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 123
* EL050.cbl
  6705         16  AM-NOTIF-OF-STATUS            PIC X.
  6706
  6707     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6708         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6709         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6710         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6711         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6712
  6713     12  AM-BENEFIT-CONTROLS.
  6714         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6715             20  AM-BENEFIT-CODE           PIC XX.
  6716             20  AM-BENEFIT-TYPE           PIC X.
  6717             20  AM-BENEFIT-REVISION       PIC XXX.
  6718             20  AM-BENEFIT-REM-TERM       PIC X.
  6719             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6720             20  FILLER                    PIC XX.
  6721         16  FILLER                        PIC X(80).
  6722
  6723     12  AM-TRANSFER-DATA.
  6724         16  AM-TRANSFERRED-FROM.
  6725             20  AM-TRNFROM-CARRIER        PIC X.
  6726             20  AM-TRNFROM-GROUPING.
  6727                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6728                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6729             20  AM-TRNFROM-STATE          PIC XX.
  6730             20  AM-TRNFROM-ACCOUNT.
  6731                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6732                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6733             20  AM-TRNFROM-DTE            PIC XX.
  6734         16  AM-TRANSFERRED-TO.
  6735             20  AM-TRNTO-CARRIER          PIC X.
  6736             20  AM-TRNTO-GROUPING.
  6737                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6738                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6739             20  AM-TRNTO-STATE            PIC XX.
  6740             20  AM-TRNTO-ACCOUNT.
  6741                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6742                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6743             20  AM-TRNTO-DTE              PIC XX.
  6744         16  FILLER                        PIC X(10).
  6745
  6746     12  AM-SAVED-REMIT-TO                 PIC 99.
  6747
  6748     12  AM-COMM-STRUCTURE-SAVED.
  6749         16  AM-DEFN-1-SAVED.
  6750             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6751                 24  AM-AGT-SV             PIC X(10).
  6752                 24  AM-COM-TYP-SV         PIC X.
  6753                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6754                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6755                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6756                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6757                 24  FILLER                PIC X.
  6758                 24  AM-GL-CODES-SV        PIC X.
  6759                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6760                 24  FILLER                PIC X.
  6761         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6762             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 124
* EL050.cbl
  6763                 24  FILLER                PIC X(11).
  6764                 24  AM-L-COMA-SV          PIC XXX.
  6765                 24  AM-J-COMA-SV          PIC XXX.
  6766                 24  AM-A-COMA-SV          PIC XXX.
  6767                 24  FILLER                PIC X(6).
  6768
  6769     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6770         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6771            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6772            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6773            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6774
  6775     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6776     12  FILLER                            PIC X(120).
  6777
  6778     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6779         16  AM-CONTROL-NAME               PIC X(30).
  6780         16  AM-EXECUTIVE-ONE.
  6781             20  AM-EXEC1-NAME             PIC X(15).
  6782             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6783                                                          COMP-3.
  6784             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6785                                                          COMP-3.
  6786         16  AM-EXECUTIVE-TWO.
  6787             20  AM-EXEC2-NAME             PIC X(15).
  6788             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6789                                                          COMP-3.
  6790             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6791                                                          COMP-3.
  6792
  6793     12  AM-RETRO-ADDITIONAL-DATA.
  6794         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6795         16  AM-RETRO-PREM-P-E             PIC X.
  6796         16  AM-RETRO-CLMS-P-I             PIC X.
  6797         16  AM-RETRO-RET-BRACKET-LF.
  6798             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6799                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6800                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6801             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6802                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6803                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6804             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6805                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6806                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6807         16  AM-RETRO-RET-BRACKET-AH.
  6808             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6809                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6810                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6811                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6812             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6813                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6814                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6815             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6816                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6817                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6818
  6819     12  AM-COMMENTS.
  6820         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 125
* EL050.cbl
  6821
  6822     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6823         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6824         16  AM-FLI-BILLING-CODE           PIC X.
  6825         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6826         16  AM-FLI-UNITED-IDENT           PIC X.
  6827         16  AM-FLI-INTEREST-LOST-DATA.
  6828             20  AM-FLI-BANK-NO            PIC X(5).
  6829             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6830             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6831             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6832         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6833             20  AM-FLI-AGT                PIC X(9).
  6834             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6835             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6836         16  FILLER                        PIC X(102).
  6837
  6838     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6839         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6840             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6841             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6842             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6843             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6844             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6845         16  FILLER                          PIC X(10).
  6846******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 126
* EL050.cbl
  6848*    COPY ERCREIN.
  6849******************************************************************
  6850*                                                                *
  6851*                            ERCREIN                             *
  6852*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6853*                            VMOD=2.010                          *
  6854*                                                                *
  6855*   ONLINE CREDIT SYSTEM                                         *
  6856*                                                                *
  6857*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6858*                                                                *
  6859*   FILE TYPE = VSAM,KSDS                                        *
  6860*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6861*                                                                *
  6862*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6863*       ALTERNATE PATH = NONE                                    *
  6864*                                                                *
  6865*   LOG = NO                                                     *
  6866*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6867*                                                                *
  6868******************************************************************
  6869*                   C H A N G E   L O G
  6870*
  6871* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6872*-----------------------------------------------------------------
  6873*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6874* EFFECTIVE    NUMBER
  6875*-----------------------------------------------------------------
  6876* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6877* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6878******************************************************************
  6879 01  REINSURANCE-RECORD.
  6880     12  RE-RECORD-ID                      PIC XX.
  6881         88  VALID-RE-ID                      VALUE 'RE'.
  6882
  6883     12  RE-CONTROL-PRIMARY.
  6884         16  RE-COMPANY-CD                 PIC X.
  6885         16  RE-KEY.
  6886             20  RE-CODE                   PIC X.
  6887                 88  RE-TABLE-RECORD          VALUE 'A'.
  6888                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6889             20  RE-TABLE                  PIC XXX.
  6890             20  FILLER                    PIC XXX.
  6891         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6892             20  FILLER                    PIC X.
  6893             20  RE-COMPANY.
  6894                 24  RE-COMP-PRIME         PIC XXX.
  6895                 24  RE-COMP-SUB           PIC XXX.
  6896
  6897     12  RE-MAINT-INFORMATION.
  6898         16  RE-LAST-MAINT-DT              PIC XX.
  6899         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6900         16  RE-LAST-MAINT-USER            PIC X(4).
  6901         16  FILLER                        PIC X(10).
  6902
  6903     12  RE-TABLE-DATA.
  6904         16  RE-100-COMP                   PIC 99.
  6905
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 127
* EL050.cbl
  6906         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6907             20  RE-REI-COMP-NO.
  6908                 24  RE-REI-COMP           PIC XXX.
  6909                 24  RE-REI-COMP-SUB       PIC XXX.
  6910             20  RE-LF-QC                  PIC X.
  6911             20  RE-AH-QC                  PIC X.
  6912             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6913             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6914             20  RE-LFAGE-LO               PIC 99.
  6915             20  RE-LFAGE-HI               PIC 99.
  6916             20  RE-AHAGE-LO               PIC 99.
  6917             20  RE-AHAGE-HI               PIC 99.
  6918             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6919             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6920             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6921             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6922             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6923             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6924             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6925             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6926             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6927             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6928             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6929             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6930             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6931             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6932             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6933             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6934             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6935             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6936             20  RE-LF-BEN-CODE            PIC X.
  6937             20  RE-AH-BEN-CODE            PIC X.
  6938             20  RE-INTERACTIVE            PIC X.
  6939             20  RE-REMAINING              PIC X.
  6940             20  RE-LF-RUNOFF-SW           PIC X.
  6941             20  RE-AH-RUNOFF-SW           PIC X.
  6942             20  FILLER                    PIC X(19).
  6943
  6944         16  RE-COMP-INFO-END              PIC X(6).
  6945         16  RE-NSP-ST-CD-LF               PIC XX.
  6946         16  RE-NSP-ST-CD-AH               PIC XX.
  6947         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6948             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6949
  6950         16  FILLER                        PIC X(27).
  6951
  6952     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6953         16  RE-NAME                       PIC X(30).
  6954         16  RE-LF-PE                      PIC X.
  6955         16  RE-AH-PE                      PIC X.
  6956         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6957         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6958         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6959         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6960         16  RE-PRT-ST                     PIC X.
  6961         16  RE-PRT-OW                     PIC X.
  6962         16  RE-MORT-CODE                  PIC X(4).
  6963         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 128
* EL050.cbl
  6964         16  RE-ZERO-LF-FEE                PIC X.
  6965         16  RE-ZERO-AH-FEE                PIC X.
  6966         16  RE-CEDE-NAME                  PIC X(30).
  6967         16  RE-LF-COMM                    PIC X.
  6968         16  RE-AH-COMM                    PIC X.
  6969         16  RE-LF-TAX                     PIC X.
  6970         16  RE-AH-TAX                     PIC X.
  6971         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6972         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6973         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6974
  6975         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6976             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6977
  6978         16  RE-LF-CEDING-FEE-BRACKETS.
  6979             20  RE-LF-FEE-METHOD          PIC X.
  6980                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6981                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6982                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6983                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6984             20  RE-LF-FEE-BASIS           PIC X.
  6985                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6986                 88  RE-LF-NET-CEDED               VALUE '2'.
  6987                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6988                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6989                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6990                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6991                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6992                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6993             20  FILLER                    PIC XXX.
  6994             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6995                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6996                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6997
  6998         16  RE-AH-CEDING-FEE-BRACKETS.
  6999             20  RE-AH-FEE-METHOD          PIC X.
  7000                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7001                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7002                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7003                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7004             20  RE-AH-FEE-BASIS           PIC X.
  7005                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7006                 88  RE-AH-NET-CEDED               VALUE '2'.
  7007                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7008                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7009                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7010                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7011                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7012                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7013             20  FILLER                    PIC XXX.
  7014             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7015                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7016                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7017
  7018         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7019
  7020         16  RE-OLD-CEDING-STMT            PIC X.
  7021
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 129
* EL050.cbl
  7022         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7023         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7024         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7025         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7026         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7027         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7028         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7029         16  RE-MORT-SW                    PIC X.
  7030         16  RE-CEDING-TYPE-FLAG           PIC X.
  7031             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7032             88  RE-CEDED                          VALUE 'C'.
  7033             88  RE-ASSUMED                        VALUE 'A'.
  7034             88  RE-PHANTOM                        VALUE 'P'.
  7035
  7036         16  RE-CEDING-STMT-OPT-A          PIC X.
  7037             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7038         16  RE-CEDING-STMT-OPT-B          PIC X.
  7039             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7040         16  RE-CEDING-STMT-OPT-C          PIC X.
  7041             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7042         16  RE-CEDING-STMT-OPT-D          PIC X.
  7043             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7044         16  RE-CEDING-STMT-OPT-E          PIC X.
  7045             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7046
  7047         16  RE-PRT-CRSV                   PIC X.
  7048
  7049         16  RE-GL-CENTER                  PIC X(4).
  7050
  7051         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7052
  7053         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7054
  7055         16  RE-EARN-STOP-CODE             PIC X.
  7056             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7057             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7058
  7059         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7060             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7061
  7062         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7063         16  FILLER                        PIC X(2281).
  7064
  7065         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7066
  7067******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 130
* EL050.cbl
  7069*    COPY ERCCTBL.
  7070******************************************************************
  7071*                                                                *
  7072*                                                                *
  7073*                            ERCCTBL                             *
  7074*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7075*                            VMOD=2.003
  7076*                                                                *
  7077*   ONLINE CREDIT SYSTEM                                         *
  7078*                                                                *
  7079*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7080*                                                                *
  7081*   FILE TYPE = VSAM,KSDS                                        *
  7082*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7083*                                                                *
  7084*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7085*       ALTERNATE PATH = NONE                                    *
  7086*                                                                *
  7087*   LOG = NO                                                     *
  7088*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7089*                                                                *
  7090*                                                                *
  7091******************************************************************
  7092
  7093 01  COMM-TABLE-RECORD.
  7094     12  CT-RECORD-ID                      PIC XX.
  7095         88  VALID-CT-ID                      VALUE 'CT'.
  7096
  7097     12  CT-CONTROL-PRIMARY.
  7098         16  CT-COMPANY-CD                 PIC X.
  7099         16  CT-TABLE                      PIC XXX.
  7100         16  CT-CNTRL-2.
  7101             20  CT-BEN-TYPE               PIC X.
  7102             20  CT-BEN-CODE               PIC XX.
  7103
  7104     12  CT-MAINT-INFORMATION.
  7105         16  CT-LAST-MAINT-DT              PIC XX.
  7106         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7107         16  CT-LAST-MAINT-USER            PIC X(4).
  7108         16  FILLER                        PIC X(31).
  7109
  7110     12  CT-LIMITS.
  7111         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7112
  7113         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7114
  7115         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7116
  7117     12  CT-RATES.
  7118         16  CT-RTX          OCCURS 27 TIMES.
  7119             20  CT-RT                     PIC SV9(5)     COMP-3.
  7120             20  CT-RT-R   REDEFINES
  7121                 CT-RT                     PIC XXX.
  7122
  7123     12  FILLER                            PIC  X(42).
  7124
  7125******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 131
* EL050.cbl
  7127*    COPY ERCFORM.
  7128******************************************************************
  7129*                                                                *
  7130*                                                                *
  7131*                            ERCFORM.                            *
  7132*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7133*                            VMOD=2.003                          *
  7134*                                                                *
  7135*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7136*                                                                *
  7137*    FILE TYPE = VSAM,KSDS                                       *
  7138*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7139*                                                                *
  7140*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7141*                                                                *
  7142*    LOG = YES                                                   *
  7143*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7144******************************************************************
  7145 01  FORM-MASTER.
  7146    12  FO-RECORD-ID                 PIC X(02).
  7147        88  VALID-FO-ID                  VALUE 'FO'.
  7148
  7149    12  FO-CONTROL-PRIMARY.
  7150        16  FO-COMPANY-CD            PIC X(01).
  7151        16  FO-STATE                 PIC X(02).
  7152        16  FO-FORM-ID               PIC X(12).
  7153        16  FO-FORM-EXP-DT           PIC X(02).
  7154
  7155    12  FO-POLICY-FORM-DATA.
  7156        16  FO-IND-GRP-CD            PIC X(01).
  7157        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7158        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7159        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7160        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7161        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7162        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7163        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7164        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7165        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7166        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7167        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7168        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7169        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7170        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7171        16  FO-APP-CERT-USE-CD       PIC X(01).
  7172
  7173    12  FILLER                       PIC X(29).
  7174
  7175    12  FO-FORM-PLAN-TABLE.
  7176        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7177            20  FO-PLAN-TYPE         PIC X(01).
  7178            20  FO-PLAN-ID           PIC X(02).
  7179            20  FO-PLAN-TERM         PIC 9(03).
  7180            20  FO-PLAN-REFUND-METHOD
  7181                                     PIC X.
  7182
  7183    12  FILLER                       PIC X(30).
  7184
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 132
* EL050.cbl
  7185    12  FO-COMMENTS-AREA.
  7186        16  FO-COMMENT-LINE-1        PIC X(78).
  7187
  7188    12  FILLER                       PIC X(20).
  7189
  7190    12  FO-MAINT-INFORMATION.
  7191        16  FO-LAST-MAINT-DT         PIC X(02).
  7192        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7193        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 133
* EL050.cbl
  7195*    COPY ELCMSTR.
  7196******************************************************************
  7197*                                                                *
  7198*                            ELCMSTR.                            *
  7199*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7200*                            VMOD=2.012                          *
  7201*                                                                *
  7202*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7203*                                                                *
  7204*   FILE TYPE = VSAM,KSDS                                        *
  7205*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7206*                                                                *
  7207*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7208*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7209*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7210*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7211*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7212*                                                 RKP=75,LEN=21  *
  7213*                                                                *
  7214*   **** NOTE ****                                               *
  7215*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7216*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7217*                                                                *
  7218*   LOG = YES                                                    *
  7219*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7220******************************************************************
  7221*                   C H A N G E   L O G
  7222*
  7223* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7224*-----------------------------------------------------------------
  7225*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7226* EFFECTIVE    NUMBER
  7227*-----------------------------------------------------------------
  7228* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7229* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7230******************************************************************
  7231 01  CLAIM-MASTER.
  7232     12  CL-RECORD-ID                PIC XX.
  7233         88  VALID-CL-ID         VALUE 'CL'.
  7234
  7235     12  CL-CONTROL-PRIMARY.
  7236         16  CL-COMPANY-CD           PIC X.
  7237         16  CL-CARRIER              PIC X.
  7238         16  CL-CLAIM-NO             PIC X(7).
  7239         16  CL-CERT-NO.
  7240             20  CL-CERT-PRIME       PIC X(10).
  7241             20  CL-CERT-SFX         PIC X.
  7242
  7243     12  CL-CONTROL-BY-NAME.
  7244         16  CL-COMPANY-CD-A1        PIC X.
  7245         16  CL-INSURED-LAST-NAME    PIC X(15).
  7246         16  CL-INSURED-NAME.
  7247             20  CL-INSURED-1ST-NAME PIC X(12).
  7248             20  CL-INSURED-MID-INIT PIC X.
  7249
  7250     12  CL-CONTROL-BY-SSN.
  7251         16  CL-COMPANY-CD-A2        PIC X.
  7252         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 134
* EL050.cbl
  7253             20  CL-SSN-STATE        PIC XX.
  7254             20  CL-SSN-ACCOUNT      PIC X(6).
  7255             20  CL-SSN-LN3          PIC X(3).
  7256
  7257     12  CL-CONTROL-BY-CERT-NO.
  7258         16  CL-COMPANY-CD-A4        PIC X.
  7259         16  CL-CERT-NO-A4.
  7260             20  CL-CERT-A4-PRIME    PIC X(10).
  7261             20  CL-CERT-A4-SFX      PIC X.
  7262
  7263     12  CL-CONTROL-BY-CCN.
  7264         16  CL-COMPANY-CD-A5        PIC X.
  7265         16  CL-CCN-A5.
  7266             20  CL-CCN.
  7267                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7268                 24  CL-CCN-PRIME-A5 PIC X(12).
  7269             20  CL-CCN-FILLER-A5    PIC X(4).
  7270
  7271     12  CL-INSURED-PROFILE-DATA.
  7272         16  CL-INSURED-BIRTH-DT     PIC XX.
  7273         16  CL-INSURED-SEX-CD       PIC X.
  7274             88  INSURED-IS-MALE        VALUE 'M'.
  7275             88  INSURED-IS-FEMALE      VALUE 'F'.
  7276             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7277         16  CL-INSURED-OCC-CD       PIC X(6).
  7278         16  FILLER                  PIC X(5).
  7279
  7280     12  CL-PROCESSING-INFO.
  7281         16  CL-PROCESSOR-ID         PIC X(4).
  7282         16  CL-CLAIM-STATUS         PIC X.
  7283             88  CLAIM-IS-OPEN          VALUE 'O'.
  7284             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7285         16  CL-CLAIM-TYPE           PIC X.
  7286*            88  AH-CLAIM               VALUE 'A'.
  7287*            88  LIFE-CLAIM             VALUE 'L'.
  7288*            88  PROPERTY-CLAIM         VALUE 'P'.
  7289*            88  IUI-CLAIM              VALUE 'I'.
  7290*            88  GAP-CLAIM              VALUE 'G'.
  7291         16  CL-CLAIM-PREM-TYPE      PIC X.
  7292             88  SINGLE-PREMIUM         VALUE '1'.
  7293             88  O-B-COVERAGE           VALUE '2'.
  7294             88  OPEN-END-COVERAGE      VALUE '3'.
  7295         16  CL-INCURRED-DT          PIC XX.
  7296         16  CL-REPORTED-DT          PIC XX.
  7297         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7298         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7299         16  CL-LAST-PMT-DT          PIC XX.
  7300         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7301         16  CL-PAID-THRU-DT         PIC XX.
  7302         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7303         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7304         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7305         16  CL-PMT-CALC-METHOD      PIC X.
  7306             88  CL-360-DAY-YR          VALUE '1'.
  7307             88  CL-365-DAY-YR          VALUE '2'.
  7308             88  CL-FULL-MONTHS         VALUE '3'.
  7309         16  CL-CAUSE-CD             PIC X(6).
  7310
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 135
* EL050.cbl
  7311         16  CL-PRIME-CERT-NO.
  7312             20  CL-PRIME-CERT-PRIME PIC X(10).
  7313             20  CL-PRIME-CERT-SFX   PIC X.
  7314
  7315         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7316             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7317             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7318
  7319         16  CL-MICROFILM-NO         PIC X(10).
  7320         16  CL-PROG-FORM-TYPE       PIC X.
  7321         16  CL-LAST-ADD-ON-DT       PIC XX.
  7322
  7323         16  CL-LAST-REOPEN-DT       PIC XX.
  7324         16  CL-LAST-CLOSE-DT        PIC XX.
  7325         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7326             88  FINAL-PAID             VALUE '1'.
  7327             88  CLAIM-DENIED           VALUE '2'.
  7328             88  AUTO-CLOSE             VALUE '3'.
  7329             88  MANUAL-CLOSE           VALUE '4'.
  7330             88  BENEFITS-CHANGED       VALUE 'C'.
  7331             88  SETUP-ERRORS           VALUE 'E'.
  7332         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7333         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7334         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7335             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7336         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7337         16  FILLER                  PIC X.
  7338
  7339     12  CL-CERTIFICATE-DATA.
  7340         16  CL-CERT-ORIGIN          PIC X.
  7341             88  CERT-WAS-ONLINE        VALUE '1'.
  7342             88  CERT-WAS-CREATED       VALUE '2'.
  7343             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7344         16  CL-CERT-KEY-DATA.
  7345             20  CL-CERT-CARRIER     PIC X.
  7346             20  CL-CERT-GROUPING    PIC X(6).
  7347             20  CL-CERT-STATE       PIC XX.
  7348             20  CL-CERT-ACCOUNT.
  7349                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7350                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7351             20  CL-CERT-EFF-DT      PIC XX.
  7352
  7353     12  CL-STATUS-CONTROLS.
  7354         16  CL-PRIORITY-CD          PIC X.
  7355             88  CONFIDENTIAL-DATA      VALUE '8'.
  7356             88  HIGHEST-PRIORITY       VALUE '9'.
  7357         16  CL-SUPV-ATTN-CD         PIC X.
  7358             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7359             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7360         16  CL-PURGED-DT            PIC XX.
  7361         16  CL-RESTORED-DT          PIC XX.
  7362         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7363         16  CL-NEXT-RESEND-DT       PIC XX.
  7364         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7365         16  FILLER                  PIC XX.
  7366         16  CL-LAST-MAINT-DT        PIC XX.
  7367         16  CL-LAST-MAINT-USER      PIC X(4).
  7368         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 136
* EL050.cbl
  7369         16  CL-LAST-MAINT-TYPE      PIC X.
  7370             88  CLAIM-SET-UP           VALUE ' '.
  7371             88  PAYMENT-MADE           VALUE '1'.
  7372             88  LETTER-SENT            VALUE '2'.
  7373             88  MASTER-WAS-ALTERED     VALUE '3'.
  7374             88  MASTER-WAS-RESTORED    VALUE '4'.
  7375             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7376             88  FILE-CONVERTED         VALUE '6'.
  7377             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7378             88  ERROR-CORRECTION       VALUE 'E'.
  7379         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7380         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7381         16  CL-BENEFICIARY          PIC X(10).
  7382         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7383         16  CL-DENIAL-TYPE          PIC X.
  7384             88  CL-TYPE-DENIAL          VALUE '1'.
  7385             88  CL-TYPE-RESCISSION      VALUE '2'.
  7386             88  CL-TYPE-REFORMATION     VALUE '3'.
  7387             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7388             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7389         16  FILLER                  PIC X(5).
  7390
  7391     12  CL-TRAILER-CONTROLS.
  7392         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7393             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7394             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7395             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7396         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7397         16  FILLER                  PIC XX.
  7398         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7399         16  CL-ADDRESS-TRAILER-CNT.
  7400             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7401                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7402             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7403                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7404             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7405                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7406             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7407                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7408             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7409                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7410             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7411                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7412             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7413                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7414
  7415     12  CL-CV-REFERENCE-NO.
  7416         16  CL-CV-REFNO-PRIME       PIC X(18).
  7417         16  CL-CV-REFNO-SFX         PIC XX.
  7418
  7419     12  CL-FILE-LOCATION            PIC X(4).
  7420
  7421     12  CL-PROCESS-ERRORS.
  7422         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7423             88  NO-FATAL-ERRORS        VALUE ZERO.
  7424         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7425             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7426
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 137
* EL050.cbl
  7427     12  CL-PRODUCT-CD               PIC X.
  7428
  7429     12  CL-CURRENT-KEY-DATA.
  7430         16  CL-CURRENT-CARRIER      PIC X.
  7431         16  CL-CURRENT-GROUPING     PIC X(6).
  7432         16  CL-CURRENT-STATE        PIC XX.
  7433         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7434
  7435     12  CL-ASSOCIATES               PIC X.
  7436         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7437         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7438         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7439         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7440
  7441     12  CL-ACTIVITY-CODE            PIC 99.
  7442     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7443     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7444
  7445     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7446     12  CL-LAG-REPORT-CODE          PIC 9.
  7447     12  CL-LOAN-TYPE                PIC XX.
  7448     12  CL-LEGAL-STATE              PIC XX.
  7449
  7450*    12  FILLER                      PIC X(5).
  7451     12  CL-YESNOSW                  PIC X.
  7452     12  FILLER                      PIC X(4).
  7453
  7454 01  PLAN-RECORDS.
  7455     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7456     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7457
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 138
* EL050.cbl
  7459 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7460                          ACCOUNT-MASTER REINSURANCE-RECORD
  7461                          COMM-TABLE-RECORD FORM-MASTER
  7462                          CLAIM-MASTER PLAN-RECORDS.
  7463 0000-DFHEXIT SECTION.
  7464     MOVE '9#                    $   ' TO DFHEIV0.
  7465     MOVE 'EL050' TO DFHEIV1.
  7466     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7467
  7468     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7469
  7470
  7471* EXEC CICS  HANDLE CONDITION
  7472*           ERROR    (9300-ABEND)
  7473*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7474*    END-EXEC.
  7475*    MOVE '"$.J                  ! " #00007466' TO DFHEIV0
  7476     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7477     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7478     MOVE X'2220233030303037343636' TO DFHEIV0(25:11)
  7479     CALL 'kxdfhei1' USING DFHEIV0
  7480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7481
  7482
  7483 0000-COPY-PROCEDURE-DIV.
  7484*                          COPY ELC50PD.
  7485******************************************************************
  7486*                                                                *
  7487*                            ELC50PD                             *
  7488*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7489*                            VMOD=2.188                          *
  7490*                                                                *
  7491******************************************************************
  7492*                   C H A N G E   L O G
  7493*
  7494* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7495*-----------------------------------------------------------------
  7496*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7497* EFFECTIVE    NUMBER
  7498*-----------------------------------------------------------------
  7499* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7500* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7501* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7502*                             2709 AND 2718
  7503* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7504* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7505* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7506* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7507* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7508*                                IS OPEN OR CNC DT < PD THRU
  7509* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7510* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7511* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7512* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7513* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7514* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7515* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7516* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 139
* EL050.cbl
  7517* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7518* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7519* 020906                   PEMA  EXPAND LOAN OFFICER
  7520* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7521* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7522* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7523* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7524* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7525* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7526* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7527* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7528* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7529* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7530* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7531* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7532* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7533* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7534* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7535* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7536* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7537* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7538* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7539* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7540* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7541* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7542* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7543* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7544* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7545*                                UPDATE VIN ON CERT TRAILER
  7546* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7547* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7548* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7549* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7550* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7551* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7552* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7553* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7554* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7555* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7556* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7557* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7558* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7559* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7560* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7561* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7562* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7563* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7564* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7565* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7566* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7567* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7568* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7569* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7570* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7571* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7572* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7573* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7574* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 140
* EL050.cbl
  7575* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7576* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7577* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7578* 032912  CR2011110200001  PEMA  AHL CHANGES
  7579* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7580* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7581* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7582* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7583* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7584* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7585******************************************************************
  7586************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7587******************************************************************
  7588
  7589     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7590
  7591     MOVE SPACES                 TO PB-FATAL-FLAG
  7592                                    PB-FORCE-ER-CD
  7593                                    PB-WARN-ER-CD
  7594                                    PB-OUT-BAL-CD.
  7595
  7596     MOVE SPACE                  TO WS-IG-OVRD-AH
  7597                                    WS-IG-OVRD-LF
  7598                                    WS-IG-OVRD-AM
  7599                                    WS-IG-OVRD
  7600                                    WS-IG-OVRD-AH-PL
  7601                                    WS-IG-OVRD-LF-PL
  7602                                    WS-IG-OVRD-AH-BEN
  7603                                    WS-IG-OVRD-LF-BEN.
  7604
  7605******************************************************************
  7606*************       INITIALIZE COMMON ERRORS       ***************
  7607******************************************************************
  7608
  7609     MOVE +0                     TO PB-NO-OF-ERRORS.
  7610     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7611
  7612******************************************************************
  7613
  7614     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7615     SET JULIAN-TO-BIN           TO TRUE.
  7616*    MOVE 5                      TO DC-OPTION-CODE.
  7617     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7618     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7619
  7620     MOVE ZERO                   TO  SUB4.
  7621
  7622 0040-INITIALIZE-GA-BILL-DT.
  7623
  7624     ADD +1                      TO  SUB4.
  7625
  7626     IF  SUB4 GREATER THAN +5
  7627         GO TO 0050-CHECK-CNTL-FOUND.
  7628
  7629     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7630         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7631
  7632     GO TO 0040-INITIALIZE-GA-BILL-DT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 141
* EL050.cbl
  7633
  7634 0050-CHECK-CNTL-FOUND.
  7635
  7636     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7637        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7638                                         WS-AH-REM-TERM-CALC
  7639                                         EC-CO-REM-TERM-CALC
  7640        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7641        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7642        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7643                                         WS-TOL-AH-CLAIM
  7644        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7645                                         WS-TOL-AH-PREM
  7646                                         EC-CO-TOL-PREM
  7647        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7648                                         WS-TOL-AH-REFUND
  7649                                         EC-CO-TOL-REFUND
  7650        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7651                                         WS-AH-REFUND-OVS-AMT
  7652                                         EC-CO-OVR-SHT-AMT
  7653        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7654                                         WS-TOL-AH-PREM-PCT
  7655                                         EC-CO-TOL-PREM-PCT
  7656        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7657                                         WS-TOL-AH-REFUND-PCT
  7658                                         EC-CO-TOL-REFUND-PCT
  7659        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7660                                         WS-AH-REFUND-OVS-PCT
  7661                                         EC-CO-OVR-SHT-PCT
  7662        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7663        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7664        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7665        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7666        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7667        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7668        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7669        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7670        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7671        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7672        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7673        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7674                                         EC-CO-MONTH-END-DT
  7675        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7676          GO TO 0100-READ-ACCT.
  7677
  7678     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7679     MOVE SPACES                 TO CNTL-ACCESS.
  7680     MOVE '1'                    TO CNTL-REC-TYPE.
  7681     MOVE +0                     TO CNTL-SEQ-NO.
  7682
  7683     MOVE '1' TO RC-SW-1.
  7684     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7685     IF NOT CF-COMPANY-MASTER
  7686         MOVE ZEROS             TO WK-CO-TOL-PREM
  7687                                   WK-CO-TOL-CLAIM
  7688                                   WK-CO-TOL-REFUND
  7689                                   WK-REFUND-OVS-AMT
  7690                                   WK-REFUND-OVS-PCT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 142
* EL050.cbl
  7691                                   WK-CO-TOL-PREM-PCT
  7692                                   WK-CO-TOL-REFUND-PCT
  7693                                   WK-DEFAULT-APR
  7694                                   WK-CO-MAX-CAP
  7695        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7696                                   WK-CR-R78-METHOD
  7697                                   WK-CO-REF-REJECT-SW
  7698                                   WK-CO-PREM-REJECT-SW
  7699                                   WK-REM-TRM-CALC-OPTION
  7700                                   WK-BIRTH-DATE-INPUT
  7701                                   WK-JOINT-AGE-INPUT
  7702        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7703        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7704        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7705        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7706          GO TO 0099-COMPANY-NOT-FOUND.
  7707
  7708     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7709        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7710     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7711        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7712     IF CF-CO-TOL-CAP NOT NUMERIC
  7713        MOVE +0                    TO CF-CO-TOL-CAP.
  7714     IF CF-DEFAULT-APR NOT NUMERIC
  7715        MOVE +0                    TO CF-DEFAULT-APR.
  7716
  7717     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7718     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7719     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7720     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7721     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7722     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7723     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7724     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7725     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7726     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7727     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7728     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7729
  7730     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7731          CF-CO-OVR-SHT-AMT > +0
  7732        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7733
  7734     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7735          CF-CO-OVR-SHT-PCT > +0
  7736        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7737
  7738     IF CF-VALID-REM-TRM-OPTION
  7739         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7740     ELSE
  7741         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7742
  7743     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7744     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7745     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7746     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7747
  7748     GO TO 0050-CHECK-CNTL-FOUND.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 143
* EL050.cbl
  7749
  7750 0099-COMPANY-NOT-FOUND.
  7751
  7752     MOVE ER-2616                TO WS-ERROR.
  7753     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7754
  7755 0100-READ-ACCT.
  7756
  7757     MOVE SPACES                 TO DATE-RANGE-SW.
  7758
  7759     IF WK-ACCT-ADDR = ZEROS
  7760        GO TO 0102-ACCT-GETMAIN.
  7761
  7762     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7763     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7764     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7765
  7766     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7767        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7768        GO TO 0105-READ-ACCT
  7769     END-IF
  7770
  7771     IF PB-CARRIER NOT = SPACES
  7772        IF PB-CARRIER NOT = AM-VG-CARRIER
  7773           GO TO 0105-READ-ACCT.
  7774
  7775     IF PB-STATE NOT = SPACES
  7776        IF PB-STATE NOT = AM-VG-STATE
  7777           GO TO 0105-READ-ACCT.
  7778
  7779     IF PB-GROUPING NOT = SPACES
  7780        IF PB-GROUPING NOT = AM-VG-GROUPING
  7781           GO TO 0105-READ-ACCT.
  7782
  7783     MOVE 'X'                 TO DATE-RANGE-SW.
  7784
  7785     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7786        MOVE 'X'                 TO DATE-RANGE-SW
  7787        GO TO 0105-READ-ACCT.
  7788
  7789     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7790        GO TO 0105-READ-ACCT.
  7791
  7792     GO TO 0180-ACCOUNT-FOUND.
  7793
  7794 0102-ACCT-GETMAIN.
  7795     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7796     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7797
  7798 0105-READ-ACCT.
  7799     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7800     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7801     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7802     MOVE PB-STATE               TO ACCT-STATE.
  7803     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7804     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7805
  7806     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 144
* EL050.cbl
  7807
  7808     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7809
  7810 0110-FIND-ACCT-TOLERANCES-LOOP.
  7811     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7812
  7813     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7814        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7815        GO TO 0199-ACCT-NOT-FOUND
  7816     END-IF
  7817     IF PB-CARRIER NOT = SPACES
  7818        IF PB-CARRIER NOT = AM-VG-CARRIER
  7819           GO TO 0199-ACCT-NOT-FOUND.
  7820
  7821     IF PB-STATE NOT = SPACES
  7822        IF PB-STATE NOT = AM-VG-STATE
  7823           GO TO 0199-ACCT-NOT-FOUND.
  7824
  7825     IF PB-GROUPING NOT = SPACES
  7826        IF PB-GROUPING NOT = AM-VG-GROUPING
  7827           GO TO 0199-ACCT-NOT-FOUND.
  7828
  7829     MOVE 'X'                    TO DATE-RANGE-SW.
  7830
  7831     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7832        MOVE 'X'                 TO DATE-RANGE-SW
  7833        GO TO 0199-ACCT-NOT-FOUND.
  7834
  7835     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7836        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7837
  7838 0180-ACCOUNT-FOUND.
  7839     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7840     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7841     MOVE AM-STATE               TO PB-SV-STATE.
  7842     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7843
  7844     IF AM-CANCEL-FEE  NOT NUMERIC
  7845        MOVE ZEROS TO AM-CANCEL-FEE.
  7846
  7847     IF AM-MAX-MON-BEN NOT NUMERIC
  7848        MOVE ZEROS TO AM-MAX-MON-BEN.
  7849
  7850     IF AM-MAX-TOT-BEN NOT NUMERIC
  7851        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7852
  7853     IF AM-CLP-TOL-PCT NOT NUMERIC
  7854        MOVE +0                  TO AM-CLP-TOL-PCT
  7855     END-IF
  7856     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7857        MOVE +0                  TO AM-SPP-LEASE-COMM
  7858     END-IF
  7859     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7860        MOVE ER-2611             TO   WS-ERROR
  7861        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7862
  7863     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7864        MOVE ER-2621             TO   WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 145
* EL050.cbl
  7865        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7866
  7867     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7868        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7869        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7870        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7871         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7872
  7873     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7874     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7875     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7876     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7877     IF AM-CLP-TOL-PCT NOT = ZEROS
  7878        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7879     END-IF
  7880     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7881        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7882     END-IF
  7883*    IF PB-COMPANY-ID = 'DCC'
  7884*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7885*                                   WS-ADMIN-FEES
  7886*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7887*          (SUB5 > +10)
  7888*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7889*             AND (AM-A-COM (SUB5) NUMERIC)
  7890*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7891*                + (AM-A-COM (SUB5) * 1000)
  7892*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7893*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7894*                + (AM-A-COM (SUB5) * 1000)
  7895*             END-IF
  7896*             IF AM-COM-TYP (SUB5) = 'N'
  7897*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7898*                + (AM-A-COM (SUB5) * 1000)
  7899*             END-IF
  7900*          END-IF
  7901*       END-PERFORM
  7902*    END-IF
  7903     IF (PB-COMPANY-ID = 'DCC')
  7904        AND (PB-ISSUE)
  7905        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7906        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7907           (SUB5 > +10)
  7908           MOVE +0 TO WS-WK-RATE
  7909           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7910              IF (AM-A-COM (SUB5) NUMERIC)
  7911                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7912                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7913              ELSE
  7914                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7915                 IF PB-ISSUE
  7916                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7917                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7918                 ELSE
  7919                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7920                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7921                 END-IF
  7922                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 146
* EL050.cbl
  7923                 MOVE ZEROS             TO WS-SUB1
  7924                                           WS-COMMISSION
  7925                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  7926                 MOVE '0530'               TO CTBL-SW
  7927                 MOVE ' '                  TO WS-CTBL-READ-SW
  7928                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7929                 IF FIRST-TIME-THROUGH
  7930                    MOVE 'AA'              TO CTBL-BEN-CODE
  7931                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7932                 END-IF
  7933                 IF CTBL-TABLE-FOUND
  7934                    IF PB-ISSUE
  7935                       COMPUTE WS-COMM-CK-AMT =
  7936                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  7937                    ELSE
  7938                       COMPUTE WS-COMM-CK-AMT =
  7939                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  7940                    END-IF
  7941                    PERFORM 8800-GET-COMP-RATE
  7942                              THRU 8800-EXIT
  7943                 END-IF
  7944              END-IF
  7945              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7946                + (WS-WK-RATE * 1000)
  7947           END-IF
  7948        END-PERFORM
  7949     END-IF
  7950     IF PB-COMPANY-ID EQUAL 'CRI'
  7951         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  7952
  7953     IF PB-COMPANY-ID EQUAL 'NCL'
  7954         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  7955     END-IF
  7956
  7957     GO TO 0200-READ-CERT.
  7958
  7959 0199-ACCT-NOT-FOUND.
  7960
  7961     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  7962
  7963     IF DATE-RANGE-SW NOT = SPACES
  7964        MOVE ER-2601             TO WS-ERROR
  7965        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7966     ELSE
  7967        MOVE ER-2619             TO WS-ERROR
  7968        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7969
  7970     GO TO 9990-RETURN.
  7971
  7972 0200-READ-CERT.
  7973
  7974     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  7975     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  7976     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  7977     MOVE PB-SV-STATE            TO CERT-STATE.
  7978     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  7979     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  7980     MOVE PB-CERT-NO             TO CERT-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 147
* EL050.cbl
  7981
  7982     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  7983
  7984     IF CERT-WAS-NOT-FOUND
  7985        GO TO 0299-CERT-NOT-FOUND.
  7986
  7987     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  7988        MOVE ER-2759             TO WS-ERROR
  7989        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7990        GO TO 0298-UNLOCK-RETURN.
  7991
  7992     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  7993         MOVE ER-2758            TO WS-ERROR
  7994         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7995         GO TO 0298-UNLOCK-RETURN.
  7996
  7997     IF PB-ISSUE
  7998        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  7999           IF CERT-WAS-CREATED-FOR-CLAIM
  8000              NEXT SENTENCE
  8001            ELSE
  8002              MOVE ER-2626       TO WS-ERROR
  8003              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8004              GO TO 0298-UNLOCK-RETURN.
  8005
  8006     IF NOT PB-CANCELLATION
  8007        GO TO 0300-CONTINUE-EDIT.
  8008
  8009     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8010     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8011     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8012     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8013     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8014     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8015
  8016     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8017     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8018     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8019     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8020     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8021     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8022     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8023     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8024     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8025
  8026     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8027     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8028     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8029     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8030     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8031     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8032     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8033
  8034     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8035     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8036
  8037     MOVE CM-CREDIT-INTERFACE-SW-1
  8038                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 148
* EL050.cbl
  8039     MOVE CM-CREDIT-INTERFACE-SW-2
  8040                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8041
  8042     IF CM-O-B-COVERAGE
  8043         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8044
  8045     IF CM-LIVES NOT NUMERIC
  8046         MOVE ZERO                TO CM-LIVES.
  8047
  8048     IF CM-BILLED NOT NUMERIC
  8049         MOVE ZERO                TO CM-BILLED.
  8050
  8051     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8052         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8053         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8054         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8055         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8056         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8057         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8058         MOVE CM-LIVES             TO PB-CI-LIVES
  8059*The next line causes a problem with my change  I dont think it is
  8060*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8061
  8062     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8063     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8064     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8065     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8066     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8067     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8068
  8069     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8070     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8071     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8072     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8073
  8074     IF CM-LIFE-COMM-PCT NUMERIC
  8075         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8076     ELSE
  8077         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8078
  8079     IF CM-AH-COMM-PCT NUMERIC
  8080         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8081     ELSE
  8082         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8083
  8084     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8085
  8086     IF CM-LOAN-APR       NOT NUMERIC
  8087           MOVE ZERO               TO CM-LOAN-APR.
  8088
  8089     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8090           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8091
  8092     IF CM-LOAN-TERM      NOT NUMERIC
  8093           MOVE ZERO               TO CM-LOAN-TERM.
  8094
  8095     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8096           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 149
* EL050.cbl
  8097
  8098     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8099           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8100
  8101     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8102     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8103     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8104     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8105     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8106     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8107     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8108     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8109     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8110     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8111     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8112     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8113
  8114     IF CM-STATE = CM-SSN-STATE
  8115         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8116
  8117     IF CM-STATE NOT = CM-MEMB-STATE
  8118         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8119
  8120     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8121
  8122     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8123        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8124        IF CM-ADDL-CLP NOT NUMERIC
  8125           MOVE +0               TO CM-ADDL-CLP
  8126        END-IF
  8127        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8128        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8129           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8130        END-IF
  8131     END-IF
  8132     IF PB-COMPANY-ID = 'DCC'
  8133        MOVE +0                  TO WS-ADMIN-FEES
  8134                                    WS-CSO-ADMIN-FEE
  8135                                    WS-COMM-AND-MFEE
  8136                                    WS-1ST-YR-ALLOW
  8137        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8138           (SUB5 > +10)
  8139           MOVE +0 TO WS-WK-RATE
  8140           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8141              IF (AM-A-COM (SUB5) NUMERIC)
  8142                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8143                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8144              ELSE
  8145                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8146                 IF PB-ISSUE
  8147                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8148                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8149                 ELSE
  8150                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8151                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8152                 END-IF
  8153                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8154                 MOVE ZEROS             TO WS-SUB1
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 150
* EL050.cbl
  8155                                           WS-COMMISSION
  8156                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8157                 MOVE '0530'               TO CTBL-SW
  8158                 MOVE ' '                  TO WS-CTBL-READ-SW
  8159                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8160                 IF FIRST-TIME-THROUGH
  8161                    MOVE 'AA'              TO CTBL-BEN-CODE
  8162                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8163                 END-IF
  8164                 IF CTBL-TABLE-FOUND
  8165                    IF PB-ISSUE
  8166                       COMPUTE WS-COMM-CK-AMT =
  8167                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8168                    ELSE
  8169                       COMPUTE WS-COMM-CK-AMT =
  8170                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8171                    END-IF
  8172                    PERFORM 8800-GET-COMP-RATE
  8173                              THRU 8800-EXIT
  8174                 END-IF
  8175              END-IF
  8176              IF AM-COM-TYP (SUB5) = 'I'
  8177                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8178                   + (WS-WK-RATE * 1000)
  8179              END-IF
  8180              IF AM-COM-TYP (SUB5) = 'N'
  8181                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8182                   + (WS-WK-RATE * 1000)
  8183              END-IF
  8184              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8185                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8186                   + (WS-WK-RATE * 1000)
  8187              END-IF
  8188              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8189                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8190                   + (WS-WK-RATE * 1000)
  8191              END-IF
  8192           END-IF
  8193        END-PERFORM
  8194     END-IF
  8195     GO TO 0300-CONTINUE-EDIT.
  8196
  8197 0298-UNLOCK-RETURN.
  8198      PERFORM 9250-UNLOCK-RETURN
  8199      GO TO 9990-RETURN.
  8200
  8201 0299-CERT-NOT-FOUND.
  8202
  8203     MOVE '1'                     TO CERT-STATUS-SW.
  8204
  8205     IF PB-COMPANY-ID = 'UCL'
  8206         IF WS-ERROR = ER-2799
  8207             GO TO 3000-CONTINUE-EDIT.
  8208
  8209     IF NOT PB-CANCELLATION
  8210         GO TO 0300-CONTINUE-EDIT.
  8211
  8212     MOVE ER-2726                  TO  WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 151
* EL050.cbl
  8213     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8214     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8215     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8216                                    PB-CI-LF-TERM
  8217                                    PB-C-LF-REM-TERM
  8218                                    PB-CI-AH-TERM
  8219                                    PB-C-AH-REM-TERM
  8220                                    PB-CI-LF-BENEFIT-CD
  8221                                    PB-CI-LF-BENEFIT-AMT
  8222                                    PB-CI-LF-ALT-BENEFIT-AMT
  8223                                    PB-CI-LF-PREMIUM-AMT
  8224                                    PB-CI-LF-ALT-PREMIUM-AMT
  8225                                    PB-CI-AH-BENEFIT-CD
  8226                                    PB-CI-AH-BENEFIT-AMT
  8227                                    PB-CI-AH-PREMIUM-AMT
  8228                                    PB-CI-PAY-FREQUENCY
  8229                                    PB-CI-LOAN-APR
  8230                                    PB-CI-LOAN-TERM
  8231                                    PB-CI-LIFE-COMMISSION
  8232                                    PB-CI-AH-COMMISSION
  8233                                    PB-CI-CURR-SEQ
  8234                                    PB-CI-AH-CANCEL-AMT
  8235                                    PB-CI-LF-CANCEL-AMT
  8236                                    PB-CI-RATE-DEV-PCT-LF
  8237                                    PB-CI-RATE-DEV-PCT-AH
  8238                                    PB-CI-EXTENTION-DAYS
  8239                                    PB-CI-TERM-IN-DAYS
  8240                                    PB-CI-LIVES
  8241                                    PB-CI-LF-CRIT-PER
  8242                                    PB-CI-AH-CRIT-PER
  8243                                    PB-CI-ADDL-CLP
  8244                                    PB-CI-DDF-IU-RATE-UP.
  8245
  8246     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8247                                    PB-CI-AH-SETTLEMENT-DT
  8248                                    PB-CI-DEATH-DT
  8249                                    PB-CI-LF-PRIOR-CANCEL-DT
  8250                                    PB-CI-AH-PRIOR-CANCEL-DT
  8251                                    PB-CI-ENTRY-DT
  8252                                    PB-CI-LF-EXPIRE-DT
  8253                                    PB-CI-AH-EXPIRE-DT
  8254                                    PB-CI-LOAN-1ST-PMT-DT.
  8255
  8256     IF ACCOUNT-MAST-FOUND
  8257        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8258        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8259
  8260     GO TO 3000-CONTINUE-EDIT.
  8261
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 152
* EL050.cbl
  8263
  8264 0300-CONTINUE-EDIT.
  8265
  8266     IF PB-ISSUE
  8267        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8268            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8269
  8270     IF PB-ISSUE
  8271        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8272            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8273
  8274     IF PB-ISSUE
  8275       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8276          (AM-NO-AH-ONLY)
  8277           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8278               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8279                   MOVE ER-2679 TO WS-ERROR
  8280                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8281
  8282     IF PB-ISSUE
  8283        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8284        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8285        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8286     ELSE
  8287        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8288        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8289        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8290
  8291     MOVE 'N'                    TO PLAN-MASTER-SW
  8292                                    PLAN-MASTER-LIFE-SW
  8293                                    FORM-MASTER-SW
  8294                                    WS-APP-CERT-SW.
  8295
  8296     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8297                                    WS-PL-TOL-LF-REFUND
  8298                                    WS-PL-REF-OVS-AMT
  8299                                    WS-PL-TOL-LF-PREM-PCT
  8300                                    WS-PL-TOL-LF-REFUND-PCT
  8301                                    WS-PL-REF-OVS-PCT
  8302                                    WS-PL-TOL-LF-CLAIM.
  8303
  8304     IF PB-COMPANY-ID = 'NCL'
  8305       IF PB-ISSUE
  8306         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8307             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8308             IF FORM-MASTER-FOUND
  8309                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8310
  8311     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8312        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8313
  8314********************** MON CODE **********************
  8315     IF PB-COMPANY-ID = 'MON'
  8316     IF PB-ISSUE
  8317     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8318        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8319             PB-I-LOAN-APR = ZERO)
  8320               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 153
* EL050.cbl
  8321******************************************************
  8322
  8323     IF PB-COMPANY-ID = 'NCL'
  8324       IF PB-ISSUE
  8325           IF FORM-MASTER-FOUND
  8326             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8327                AM-DISMBR-COVERAGE
  8328                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8329                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8330                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8331                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8332                                           PB-I-LIFE-BENEFIT-CD.
  8333
  8334     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8335
  8336     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8337         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8338         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8339         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8340         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8341         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8342           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8343             GO TO 0301-LIFE-BENEFIT-SEARCH
  8344         ELSE
  8345             NEXT SENTENCE
  8346     ELSE
  8347         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8348
  8349     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8350     MOVE '4'                    TO CNTL-REC-TYPE.
  8351     MOVE +0                     TO CNTL-SEQ-NO.
  8352     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8353
  8354     MOVE '1' TO RC-SW-2.
  8355     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8356
  8357     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8358        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8359         GO TO 0305-BENEFIT-NOT-FOUND.
  8360
  8361     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8362
  8363 0301-LIFE-BENEFIT-SEARCH.
  8364
  8365     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8366
  8367     IF NO-BENEFIT-FOUND
  8368        GO TO 0305-BENEFIT-NOT-FOUND.
  8369
  8370     IF WS-BEN-CD = '99'
  8371        GO TO 0305-BENEFIT-NOT-FOUND.
  8372
  8373     IF PB-COMPANY-ID = 'NCL'
  8374         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8375             GO TO 0304-LIFE-BENEFIT-FOUND.
  8376
  8377     MOVE +1                     TO SUB5.
  8378     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 154
* EL050.cbl
  8379
  8380* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8381* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8382     IF PB-COMPANY-ID = 'DMD'
  8383         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8384
  8385 0302-EDIT-ACCT-LF-BENEFITS.
  8386
  8387     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8388        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8389           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8390                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8391           GO TO 03XX-GET-LIFE-ERPLAN.
  8392
  8393     IF SUB5 LESS THAN +20
  8394        ADD +1                   TO SUB5
  8395        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8396
  8397     MOVE +1                     TO SUB5.
  8398
  8399     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8400        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8401
  8402 0303-EDIT-DMD-EXTRA-BENEFITS.
  8403
  8404     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8405        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8406           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8407                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8408           GO TO 03XX-GET-LIFE-ERPLAN.
  8409
  8410     IF SUB5 LESS THAN +30
  8411        ADD +1                   TO SUB5
  8412        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8413
  8414     MOVE +1                     TO SUB5.
  8415
  8416 03XX-EDIT-FOR-NINETY-LF.
  8417
  8418***************************************************************
  8419*                                                             *
  8420*    NINETY BENEFIT PLAN TYPES:                               *
  8421*                                                             *
  8422*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8423*      92 = ALL GROUP REDUCING BENEFITS                       *
  8424*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8425*      94 = ALL GROUP LEVEL BENEFITS                          *
  8426*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8427*           BENEFIT CONTROLS.                                 *
  8428*      99 = ALL BENEFITS                                      *
  8429*                                                             *
  8430***************************************************************
  8431
  8432     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8433                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8434
  8435     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8436       AND
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 155
* EL050.cbl
  8437        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8438        GO TO 03XX-GET-LIFE-ERPLAN.
  8439
  8440     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8441       AND
  8442        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8443        IF CF-REDUCING (SUB3)
  8444           IF (PB-I-INDV-GRP-OVRD = 'I')
  8445              OR
  8446           ((AM-IG = '1') AND
  8447           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8448              OR
  8449           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8450           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8451           (AM-IG NOT = '2'))
  8452              GO TO 03XX-GET-LIFE-ERPLAN.
  8453
  8454     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8455       AND
  8456        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8457        IF CF-REDUCING (SUB3)
  8458           IF (PB-I-INDV-GRP-OVRD = 'G')
  8459              OR
  8460           ((AM-IG = '2') AND
  8461           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8462              OR
  8463           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8464           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8465           (AM-IG NOT = '1'))
  8466              GO TO 03XX-GET-LIFE-ERPLAN.
  8467
  8468     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8469       AND
  8470        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8471        IF CF-LEVEL    (SUB3)
  8472           IF (PB-I-INDV-GRP-OVRD = 'I')
  8473              OR
  8474           ((AM-IG = '1') AND
  8475           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8476              OR
  8477           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8478           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8479            (AM-IG NOT = '2'))
  8480              GO TO 03XX-GET-LIFE-ERPLAN.
  8481
  8482     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8483       AND
  8484        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8485        IF CF-LEVEL    (SUB3)
  8486           IF (PB-I-INDV-GRP-OVRD = 'G')
  8487              OR
  8488           ((AM-IG = '2') AND
  8489           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8490              OR
  8491           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8492           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8493           (AM-IG NOT = '1'))
  8494              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 156
* EL050.cbl
  8495
  8496     IF SUB5 LESS THAN +20
  8497        ADD +1                   TO SUB5
  8498        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8499
  8500     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8501
  8502     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8503        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8504
  8505     MOVE +1                     TO SUB5.
  8506
  8507 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8508
  8509     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8510                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8511
  8512     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8513       AND
  8514        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8515        GO TO 03XX-GET-LIFE-ERPLAN.
  8516
  8517     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8518       AND
  8519        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8520        IF CF-REDUCING (SUB3)
  8521           IF (PB-I-INDV-GRP-OVRD = 'I')
  8522              OR
  8523           ((AM-IG = '1') AND
  8524           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8525              OR
  8526           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8527           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8528           (AM-IG NOT = '2'))
  8529              GO TO 03XX-GET-LIFE-ERPLAN.
  8530
  8531     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8532       AND
  8533        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8534        IF CF-REDUCING (SUB3)
  8535           IF (PB-I-INDV-GRP-OVRD = 'G')
  8536              OR
  8537           ((AM-IG = '2') AND
  8538           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8539              OR
  8540           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8541           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8542           (AM-IG NOT = '1'))
  8543              GO TO 03XX-GET-LIFE-ERPLAN.
  8544
  8545     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8546       AND
  8547        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8548        IF CF-LEVEL    (SUB3)
  8549           IF (PB-I-INDV-GRP-OVRD = 'I')
  8550              OR
  8551           ((AM-IG = '1') AND
  8552           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 157
* EL050.cbl
  8553              OR
  8554           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8555           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8556            (AM-IG NOT = '2'))
  8557              GO TO 03XX-GET-LIFE-ERPLAN.
  8558
  8559     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8560       AND
  8561        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8562        IF CF-LEVEL    (SUB3)
  8563           IF (PB-I-INDV-GRP-OVRD = 'G')
  8564              OR
  8565           ((AM-IG = '2') AND
  8566           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8567              OR
  8568           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8569           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8570           (AM-IG NOT = '1'))
  8571              GO TO 03XX-GET-LIFE-ERPLAN.
  8572
  8573     IF SUB5 LESS THAN +30
  8574        ADD +1                   TO SUB5
  8575        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8576
  8577     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8578
  8579 03XX-EDIT-FOR-NINETY-LF-CONT.
  8580
  8581     MOVE +99                    TO SUB5.
  8582
  8583     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8584        IF PB-ISSUE
  8585           MOVE ER-1924          TO  WS-ERROR
  8586           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8587
  8588     GO TO 0304-LIFE-BENEFIT-FOUND.
  8589
  8590 03XX-GET-LIFE-ERPLAN.
  8591
  8592     IF WK-PLAN-ADDR EQUAL +0
  8593        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8594
  8595     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8596     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8597     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8598     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8599     MOVE 'Y'                    TO PLAN-MASTER-SW
  8600                                    PLAN-MASTER-LIFE-SW.
  8601     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8602
  8603 03XX-ERPLAN-LIFE-GETMAIN.
  8604
  8605     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8606     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8607
  8608 03XX-ERPLAN-LIFE-READ.
  8609
  8610     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 158
* EL050.cbl
  8611     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8612     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8613     MOVE PB-SV-STATE            TO PLAN-STATE.
  8614     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8615     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8616     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8617     MOVE WS-SAVE-BENEFIT-REVISION
  8618                                 TO PLAN-REVISION-NO.
  8619
  8620     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8621     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8622
  8623     IF PB-COMPANY-ID = 'NCL'
  8624       IF NOT LF-PLAN-MASTER-FOUND
  8625         IF NOT PB-POLICY-IS-DECLINED  AND
  8626            NOT PB-POLICY-IS-VOIDED
  8627             MOVE  ER-1921         TO  WS-ERROR
  8628             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8629             GO TO 0304-LIFE-BENEFIT-FOUND.
  8630
  8631     IF NOT LF-PLAN-MASTER-FOUND
  8632        GO TO 0304-LIFE-BENEFIT-FOUND.
  8633
  8634 XXXX-CHECK-LF-PLAN-KEY.
  8635
  8636     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8637        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8638        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8639        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8640        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8641        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8642        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8643        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8644        MOVE 'N'                 TO PLAN-MASTER-SW
  8645          GO TO 03XX-ERPLAN-LIFE-READ.
  8646
  8647     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8648
  8649     IF  PB-CANCELLATION
  8650         GO TO  0303-LF-ACCT-BEN-FOUND.
  8651
  8652     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8653        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8654           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8655           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8656              MOVE ER-2644             TO WS-ERROR
  8657              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8658           ELSE
  8659              NEXT SENTENCE
  8660        ELSE
  8661           IF PB-COMPANY-ID NOT = 'NCL'
  8662              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8663                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8664
  8665 0303-LF-ACCT-BEN-FOUND.
  8666
  8667     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8668
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 159
* EL050.cbl
  8669     IF PL-DEV-CODE NOT = SPACES
  8670        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8671
  8672     IF PL-DEV-PCT NUMERIC AND
  8673        PL-DEV-PCT NOT = ZEROS
  8674        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8675
  8676     IF PL-TOL-PREM-AMT GREATER THAN +0
  8677        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8678
  8679     IF PL-TOL-REF-AMT GREATER THAN +0
  8680        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8681
  8682     IF PL-TOL-PREM-PCT GREATER THAN +0
  8683        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8684
  8685     IF PL-TOL-REF-PCT GREATER THAN +0
  8686        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8687
  8688     IF PL-TOL-CLM-AMT GREATER THAN +0
  8689        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8690
  8691     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8692                          PL-OVER-SHORT-AMT > +0
  8693        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8694
  8695     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8696                          PL-OVER-SHORT-PCT > +0
  8697        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8698
  8699     IF PL-SALES-TAX NUMERIC AND
  8700                          PL-SALES-TAX > +0
  8701         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8702
  8703     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8704        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8705                                    WS-IG-OVRD-AM.
  8706
  8707 0304-LIFE-BENEFIT-FOUND.
  8708
  8709     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8710
  8711     IF PB-ISSUE
  8712        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8713     ELSE
  8714        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8715
  8716     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8717     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8718     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8719     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8720     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8721                                         WS-LF-REFUND-CALC.
  8722
  8723     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8724        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8725
  8726     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 160
* EL050.cbl
  8727        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8728     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8729
  8730     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8731     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8732     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8733     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8734     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8735     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8736
  8737     IF PB-COMPANY-ID = 'NCL'  AND
  8738        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8739         NEXT SENTENCE
  8740     ELSE
  8741         IF SUB5 NOT GREATER THAN +20
  8742            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8743               MOVE WS-SAVE-BENEFIT-REM-TERM
  8744                                      TO WS-AM-LF-BENE-REM-TERM
  8745                                         EC-BR-LF-REM-TERM-CALC.
  8746
  8747     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8748     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8749
  8750     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8751
  8752 0305-BENEFIT-NOT-FOUND.
  8753
  8754     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8755     MOVE ER-2604                TO WS-ERROR.
  8756     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8757
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 161
* EL050.cbl
  8759
  8760 0310-FIND-AH-BENEFIT-RECORD.
  8761
  8762     MOVE 'N'                    TO PLAN-MASTER-SW
  8763                                    PLAN-MASTER-AH-SW.
  8764
  8765     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8766                                    WS-PL-TOL-AH-REFUND
  8767                                    WS-AH-PL-REF-OVS-AMT
  8768                                    WS-PL-TOL-AH-PREM-PCT
  8769                                    WS-PL-TOL-AH-REFUND-PCT
  8770                                    WS-AH-PL-REF-OVS-PCT
  8771                                    WS-PL-TOL-AH-CLAIM.
  8772     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8773
  8774
  8775     if pb-issue
  8776        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8777           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8778        end-if
  8779        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8780           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8781           GO TO 0399-BENEFIT-NOT-FOUND
  8782        end-if
  8783     end-if
  8784
  8785     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8786        GO TO 0400-FIND-CARRIER.
  8787
  8788     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8789
  8790     IF WK-AH-BEN-ADDR NOT = ZEROS
  8791         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8792         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8793         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8794         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8795           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8796             GO TO 0311-AH-BENEFIT-SEARCH
  8797         ELSE
  8798             NEXT SENTENCE
  8799     ELSE
  8800         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8801
  8802     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8803     MOVE '5'                    TO CNTL-REC-TYPE.
  8804     MOVE +0                     TO CNTL-SEQ-NO.
  8805     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8806
  8807     MOVE '2' TO RC-SW-2.
  8808     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8809
  8810     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8811        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8812          GO TO 0399-BENEFIT-NOT-FOUND.
  8813
  8814     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8815
  8816 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 162
* EL050.cbl
  8817
  8818     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8819
  8820     IF NO-BENEFIT-FOUND
  8821         GO TO 0399-BENEFIT-NOT-FOUND.
  8822
  8823     IF WS-BEN-CD = '99'
  8824        GO TO 0399-BENEFIT-NOT-FOUND.
  8825
  8826     IF PB-COMPANY-ID  =  'NCL'
  8827         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8828             GO TO 0314-A-H-BENEFIT-FOUND.
  8829
  8830     MOVE +1                     TO SUB5.
  8831     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8832
  8833* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8834* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8835     IF PB-COMPANY-ID = 'DMD'
  8836         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8837
  8838 0312-EDIT-ACCT-AH-BENEFITS.
  8839
  8840     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8841        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8842           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8843                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8844           GO TO 03XX-GET-AH-ERPLAN.
  8845
  8846     IF SUB5 LESS THAN +20
  8847        ADD +1                   TO SUB5
  8848        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8849
  8850     MOVE +1                     TO SUB5.
  8851
  8852     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8853        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8854
  8855 0313-EDIT-DMD-EXTRA-BENEFITS.
  8856
  8857     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8858        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8859           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8860                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8861           GO TO 03XX-GET-AH-ERPLAN.
  8862
  8863     IF SUB5 LESS THAN +30
  8864        ADD +1                   TO SUB5
  8865        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8866
  8867     MOVE +1                     TO SUB5.
  8868
  8869 03XX-EDIT-FOR-NINETY-AH.
  8870
  8871***************************************************************
  8872*                                                             *
  8873*    NINETY BENEFIT PLAN TYPES:                               *
  8874*                                                             *
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 163
* EL050.cbl
  8875*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8876*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8877*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8878*           BENEFIT CONTROLS.                                 *
  8879*      99 = ALL BENEFITS.                                     *
  8880*                                                             *
  8881***************************************************************
  8882
  8883     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8884                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8885
  8886     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8887       AND
  8888        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8889        GO TO 03XX-GET-AH-ERPLAN.
  8890
  8891     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8892       AND
  8893        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8894           IF (PB-I-INDV-GRP-OVRD = 'I')
  8895              OR
  8896           ((AM-IG = '1') AND
  8897           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8898              OR
  8899           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8900           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8901           (AM-IG NOT = '2'))
  8902              GO TO 03XX-GET-AH-ERPLAN.
  8903
  8904     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8905       AND
  8906        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8907           IF (PB-I-INDV-GRP-OVRD = 'G')
  8908              OR
  8909           ((AM-IG = '2') AND
  8910           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8911              OR
  8912           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8913           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8914           (AM-IG NOT = '1'))
  8915              GO TO 03XX-GET-AH-ERPLAN.
  8916
  8917     IF SUB5 LESS THAN +20
  8918        ADD +1                   TO SUB5
  8919        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8920
  8921     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8922        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8923
  8924     MOVE +1                    TO SUB5.
  8925
  8926 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8927
  8928     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8929                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8930
  8931     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8932       AND
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 164
* EL050.cbl
  8933        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8934        GO TO 03XX-GET-AH-ERPLAN.
  8935
  8936     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  8937       AND
  8938        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8939           IF (PB-I-INDV-GRP-OVRD = 'I')
  8940              OR
  8941           ((AM-IG = '1') AND
  8942           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8943              OR
  8944           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8945           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8946           (AM-IG NOT = '2'))
  8947              GO TO 03XX-GET-AH-ERPLAN.
  8948
  8949     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  8950       AND
  8951        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8952           IF (PB-I-INDV-GRP-OVRD = 'G')
  8953              OR
  8954           ((AM-IG = '2') AND
  8955           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8956              OR
  8957           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8958           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8959           (AM-IG NOT = '1'))
  8960              GO TO 03XX-GET-AH-ERPLAN.
  8961
  8962     IF SUB5 LESS THAN +30
  8963        ADD +1                   TO SUB5
  8964        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8965
  8966 03XX-EDIT-FOR-NINETY-AH-CONT.
  8967
  8968     MOVE +99                    TO SUB5.
  8969
  8970     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8971
  8972     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8973        IF PB-ISSUE
  8974           MOVE ER-1925          TO  WS-ERROR
  8975           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8976
  8977     GO TO 0314-A-H-BENEFIT-FOUND.
  8978
  8979 03XX-GET-AH-ERPLAN.
  8980
  8981     IF WK-PLAN-ADDR EQUAL +0
  8982         GO TO 03XX-ERPLAN-AH-GETMAIN.
  8983
  8984     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8985     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8986     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8987     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  8988     MOVE 'Y'                    TO PLAN-MASTER-SW
  8989                                    PLAN-MASTER-AH-SW.
  8990*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 165
* EL050.cbl
  8991     GO TO 03XX-ERPLAN-AH-READ.
  8992
  8993 03XX-ERPLAN-AH-GETMAIN.
  8994
  8995     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8996     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8997
  8998 03XX-ERPLAN-AH-READ.
  8999
  9000     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9001     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9002     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9003     MOVE PB-SV-STATE            TO PLAN-STATE.
  9004     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9005     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9006     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9007     MOVE WS-SAVE-BENEFIT-REVISION
  9008                                 TO PLAN-REVISION-NO.
  9009
  9010     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9011     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9012
  9013     IF PB-COMPANY-ID = 'NCL'
  9014       IF NOT AH-PLAN-MASTER-FOUND
  9015         IF NOT PB-POLICY-IS-DECLINED  AND
  9016            NOT PB-POLICY-IS-VOIDED
  9017             MOVE  ER-1922         TO  WS-ERROR
  9018             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9019             GO TO 0314-A-H-BENEFIT-FOUND.
  9020
  9021     IF NOT AH-PLAN-MASTER-FOUND
  9022        GO TO 0314-A-H-BENEFIT-FOUND.
  9023
  9024 XXXX-CHECK-AH-PLAN-KEY.
  9025
  9026     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9027        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9028        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9029        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9030        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9031        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9032        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9033        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9034        MOVE 'N'                 TO PLAN-MASTER-SW
  9035          GO TO 03XX-ERPLAN-AH-READ.
  9036
  9037     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9038
  9039     IF  PB-CANCELLATION
  9040         GO TO  0313-AH-ACCT-BEN-FOUND.
  9041
  9042     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9043       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9044          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9045          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9046             MOVE ER-2644             TO WS-ERROR
  9047             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9048          ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 166
* EL050.cbl
  9049             NEXT SENTENCE
  9050       ELSE
  9051          IF PB-COMPANY-ID NOT = 'NCL'
  9052             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9053                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9054
  9055 0313-AH-ACCT-BEN-FOUND.
  9056
  9057     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9058
  9059     IF PL-DEV-CODE NOT = SPACES
  9060        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9061
  9062     IF PL-DEV-PCT NUMERIC AND
  9063        PL-DEV-PCT NOT = ZEROS
  9064        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9065
  9066     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9067        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9068
  9069     IF PL-TOL-REF-AMT NOT EQUAL +0
  9070        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9071
  9072     IF PL-TOL-PREM-PCT GREATER THAN +0
  9073        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9074
  9075     IF PL-TOL-REF-PCT GREATER THAN +0
  9076        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9077
  9078     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9079        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9080
  9081     IF PL-OVER-SHORT-AMT NUMERIC AND
  9082                          PL-OVER-SHORT-AMT > +0
  9083        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9084
  9085     IF PL-OVER-SHORT-PCT NUMERIC AND
  9086                          PL-OVER-SHORT-PCT > +0
  9087        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9088
  9089     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9090        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9091        IF WS-IG-OVRD-AM EQUAL SPACES
  9092            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9093
  9094 0314-A-H-BENEFIT-FOUND.
  9095
  9096     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9097
  9098     IF PB-ISSUE
  9099        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9100       ELSE
  9101        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9102
  9103     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9104     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9105     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9106     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 167
* EL050.cbl
  9107                                         WS-AH-REFUND-CALC.
  9108
  9109     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9110        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9111
  9112     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9113        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9114     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9115
  9116     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9117     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9118     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9119     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9120     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9121     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9122
  9123     IF PB-COMPANY-ID = 'NCL'  AND
  9124        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9125         NEXT SENTENCE
  9126     ELSE
  9127         IF SUB5 NOT GREATER THAN +20
  9128            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9129                MOVE WS-SAVE-BENEFIT-REM-TERM
  9130                                      TO WS-AM-AH-BENE-REM-TERM
  9131                                         EC-BR-AH-REM-TERM-CALC.
  9132
  9133     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9134     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9135
  9136     GO TO 0400-FIND-CARRIER.
  9137
  9138 0399-BENEFIT-NOT-FOUND.
  9139
  9140     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9141     MOVE ER-2605                TO WS-ERROR.
  9142     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9143
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 168
* EL050.cbl
  9145
  9146 0400-FIND-CARRIER.
  9147
  9148     MOVE PB-SV-CARRIER          TO WS-CARR.
  9149
  9150     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9151     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9152     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9153     MOVE '6'                    TO CNTL-REC-TYPE.
  9154
  9155*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9156     MOVE SPACE                  TO WS-DMD-RATING-SW
  9157                                    EC-BR-DMD-RATING-SW.
  9158
  9159     MOVE '2'                    TO RC-SW-1.
  9160     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9161
  9162     IF NOT CF-CARRIER-MASTER
  9163        GO TO 0400-CARRIER-NOT-FOUND.
  9164
  9165 0400-BUILD-CARR-TOL.
  9166
  9167     IF CF-CR-TOL-PREM NUMERIC AND
  9168        CF-CR-TOL-PREM GREATER THAN +0
  9169        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9170                                    WS-TOL-AH-PREM.
  9171
  9172     IF CF-CR-TOL-REFUND NUMERIC AND
  9173        CF-CR-TOL-REFUND GREATER THAN +0
  9174        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9175                                    WS-TOL-AH-REFUND.
  9176
  9177     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9178        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9179        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9180                                    WS-AH-REFUND-OVS-AMT.
  9181
  9182     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9183        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9184        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9185                                    WS-AH-REFUND-OVS-PCT.
  9186
  9187     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9188        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9189        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9190                                    WS-TOL-AH-PREM-PCT.
  9191
  9192     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9193        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9194        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9195                                     WS-TOL-AH-REFUND-PCT.
  9196
  9197     IF CF-COMPANY-ID EQUAL 'DMD'
  9198         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9199                                    EC-BR-DMD-RATING-SW.
  9200
  9201     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9202     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 169
* EL050.cbl
  9203        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9204     END-IF
  9205     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9206        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9207     END-IF
  9208     IF WS-TOL-CLP-PCT = ZEROS
  9209        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9210     END-IF
  9211
  9212     IF WS-SPP-LEASE-COMM = ZEROS
  9213        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9214     END-IF
  9215     GO TO 0400-FIND-ERPDEF.
  9216
  9217 0400-CARRIER-NOT-FOUND.
  9218
  9219     MOVE ER-2602                TO WS-ERROR.
  9220     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9221
  9222 0400-FIND-ERPDEF.
  9223     IF PB-COMPANY-ID = 'DCC'
  9224        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9225        CONTINUE
  9226     ELSE
  9227        GO TO 0400-FIND-ERCOMP
  9228     END-IF
  9229     MOVE ' '                    TO PDEF-MASTER-SW
  9230     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9231     MOVE PB-STATE               TO ERPDEF-STATE
  9232     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9233     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9234     IF PB-ISSUE
  9235        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9236     ELSE
  9237        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9238     END-IF
  9239     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9240     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9241     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9242     IF PDEF-MASTER-FOUND
  9243        MOVE 'N'                 TO PDEF-MASTER-SW
  9244        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9245        IF PDEF-MASTER-FOUND
  9246           IF (ERPDEF-KEY-SAVE (1:16) =
  9247                        PD-CONTROL-PRIMARY (1:16))
  9248              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9249              CONTINUE
  9250           ELSE
  9251              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9252              IF (ERPDEF-KEY-SAVE (1:16) =
  9253                        PD-CONTROL-PRIMARY (1:16))
  9254                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9255                 CONTINUE
  9256              ELSE
  9257                 MOVE 'N'        TO PDEF-MASTER-SW
  9258              END-IF
  9259           END-IF
  9260        END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 170
* EL050.cbl
  9261        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9262     END-IF
  9263     IF PDEF-MASTER-FOUND
  9264        IF PD-TRUNCATED = 'Y'
  9265           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9266        END-IF
  9267     END-IF
  9268     .
  9269 0400-FIND-ERCOMP.
  9270     IF PB-COMPANY-ID = 'DCC'
  9271        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9272           (WS-SUB1 > +10)
  9273           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9274                 OR 'A' OR 'N'
  9275              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9276              MOVE PB-CARRIER    TO COMP-CARRIER
  9277              MOVE PB-GROUPING   TO COMP-GROUPING
  9278              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9279              MOVE AM-AGT (WS-SUB1)
  9280                                 TO COMP-FIN-RESP
  9281              MOVE 'G'           TO COMP-TYPE
  9282              PERFORM 8582-READ-COMPENSATION-MASTER
  9283                                 THRU 8582-EXIT
  9284              IF COMP-MASTER-FOUND
  9285                 IF CO-GA-INACTIVE
  9286                    MOVE ER-2763 TO WS-ERROR
  9287                    PERFORM 9900-ERROR-FORMAT
  9288                                 THRU 9900-EXIT
  9289                    MOVE +11     TO WS-SUB1
  9290                 END-IF
  9291                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9292                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9293                    MOVE ER-2788 TO WS-ERROR
  9294                    PERFORM 9900-ERROR-FORMAT
  9295                                 THRU 9900-EXIT
  9296                    MOVE +11     TO WS-SUB1
  9297                 END-IF
  9298              END-IF
  9299           END-IF
  9300        END-PERFORM
  9301     END-IF
  9302     IF PB-COMPANY-ID = 'DCC'
  9303        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9304           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9305                                    WS-CLP-STATE
  9306        ELSE
  9307           MOVE SPACES           TO PB-I-CLP-STATE
  9308                                    WS-CLP-STATE
  9309        END-IF
  9310     END-IF
  9311
  9312     IF (PB-COMPANY-ID = 'DCC')
  9313        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9314        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9315        CONTINUE
  9316     ELSE
  9317        GO TO 0400-FIND-STATE-RECORD
  9318     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 171
* EL050.cbl
  9319     MOVE SPACES                 TO WS-CLP-STATE
  9320     MOVE +0                     TO WS-BANK-FEE
  9321                                    WS-BANK-LFEE
  9322                                    WS-BANK-NOCHRGB
  9323
  9324     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9325     IF (PB-ISSUE)
  9326        AND (PB-I-BANK-NUMBER NOT =
  9327            SPACES AND ZEROS AND LOW-VALUES)
  9328        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9329     ELSE
  9330        IF (PB-CANCELLATION)
  9331           AND (PB-CI-BANK-NUMBER NOT =
  9332                SPACES AND ZEROS AND LOW-VALUES)
  9333           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9334        END-IF
  9335     END-IF
  9336     IF COMP-FIN-RESP NOT = LOW-VALUES
  9337        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9338        MOVE PB-CARRIER          TO COMP-CARRIER
  9339        MOVE PB-GROUPING         TO COMP-GROUPING
  9340        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9341        MOVE 'B'                 TO COMP-TYPE
  9342        PERFORM 8582-READ-COMPENSATION-MASTER
  9343                                 THRU 8582-EXIT
  9344        IF COMP-MASTER-FOUND
  9345           IF CO-MAX-BANK-FEE NOT NUMERIC
  9346              MOVE +0            TO CO-MAX-BANK-FEE
  9347           END-IF
  9348           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9349              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9350           END-IF
  9351           IF CO-GA-INACTIVE
  9352              MOVE ER-2763       TO WS-ERROR
  9353              PERFORM 9900-ERROR-FORMAT
  9354                                 THRU 9900-EXIT
  9355           END-IF
  9356           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9357              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9358              MOVE ER-2788 TO WS-ERROR
  9359              PERFORM 9900-ERROR-FORMAT
  9360                                 THRU 9900-EXIT
  9361              MOVE +11     TO WS-SUB1
  9362           END-IF
  9363           IF WS-AH-BEN-CATEGORY = 'G'
  9364              MOVE CO-MAX-BANK-FEE
  9365                                 TO WS-BANK-FEE
  9366                                    PB-I-BANK-FEE
  9367           ELSE
  9368              MOVE CO-MAX-BANK-FEE-LEASE
  9369                                 TO WS-BANK-LFEE
  9370                                    PB-I-BANK-FEE
  9371           END-IF
  9372           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9373              AND (WS-AH-REFUND-CALC = 'G'))
  9374                        OR
  9375              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9376              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 172
* EL050.cbl
  9377              CONTINUE
  9378           ELSE
  9379              MOVE ER-2789 TO WS-ERROR
  9380              PERFORM 9900-ERROR-FORMAT
  9381                                 THRU 9900-EXIT
  9382           END-IF
  9383           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9384                                    PB-I-CLP-STATE
  9385           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9386           MOVE CO-CARRIER       TO BXRF-CARRIER
  9387           MOVE CO-GROUPING      TO BXRF-GROUPING
  9388           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9389           MOVE BXRF-MAX-REC-LENGTH
  9390                                 TO BXRF-REC-LENGTH
  9391           PERFORM 8584-READ-BANK-CROSS-REF
  9392                                 THRU 8584-EXIT
  9393           IF BXRF-MASTER-FOUND
  9394              MOVE ' '           TO BANK-ACCT-SW
  9395              MOVE BK-BANK-POINTER-CNT
  9396                                 TO BK-BANK-POINTER-CNT
  9397              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9398                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9399                 OR (BANK-ACCT-FOUND)
  9400                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9401                    AND (BK-AM-EXP-DT (WS-SUB1)
  9402                                 > PB-CERT-EFF-DT)
  9403                    AND (BK-AM-EFF-DT (WS-SUB1)
  9404                                 NOT > PB-CERT-EFF-DT)
  9405                    SET BANK-ACCT-FOUND TO TRUE
  9406                 END-IF
  9407              END-PERFORM
  9408              IF NOT BANK-ACCT-FOUND
  9409                 MOVE ZEROS      TO WS-BANK-FEE
  9410                                    WS-BANK-LFEE
  9411                 MOVE ER-2869    TO WS-ERROR
  9412                 PERFORM 9900-ERROR-FORMAT
  9413                                 THRU 9900-EXIT
  9414              ELSE
  9415                 PERFORM 5000-PROCESS-REPS
  9416                                 THRU 5000-EXIT
  9417                 IF AGENT-MASTER-FOUND
  9418                    MOVE +0      TO WS-BANK-FEE
  9419                                    WS-BANK-LFEE
  9420*                   MOVE AG-SPP-FEES (1)
  9421*                                TO PB-I-BANK-FEE
  9422*                                   WS-BANK-FEE
  9423                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9424                       (WS-SUB1 > +10)
  9425                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9426                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9427                       END-IF
  9428                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9429                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9430                       END-IF
  9431                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9432                          AG-SPP-FEES (WS-SUB1)
  9433                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9434                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 173
* EL050.cbl
  9435                    END-PERFORM
  9436                    IF WS-AH-BEN-CATEGORY = 'G'
  9437                       MOVE WS-BANK-FEE
  9438                                 TO PB-I-BANK-FEE
  9439                    ELSE
  9440                       MOVE WS-BANK-LFEE
  9441                                 TO PB-I-BANK-FEE
  9442                    END-IF
  9443                 END-IF
  9444              END-IF
  9445           END-IF
  9446        ELSE
  9447           MOVE ER-2879          TO WS-ERROR
  9448           PERFORM 9900-ERROR-FORMAT
  9449                                 THRU 9900-EXIT
  9450        END-IF
  9451     ELSE
  9452        MOVE ER-2879             TO WS-ERROR
  9453        PERFORM 9900-ERROR-FORMAT
  9454                                 THRU 9900-EXIT
  9455     END-IF
  9456     IF WS-AH-BEN-CATEGORY = 'G'
  9457        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9458        + WS-BANK-FEE
  9459     ELSE
  9460        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9461        + WS-BANK-LFEE
  9462     END-IF
  9463     .
  9464 0400-FIND-STATE-RECORD.
  9465
  9466     IF WK-STATE-ADDR NOT = ZEROS
  9467         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9468         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9469         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9470         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9471         IF PB-SV-STATE = CF-STATE-CODE
  9472             GO TO 0405-CONTINUE-EDIT
  9473         ELSE
  9474             NEXT SENTENCE
  9475     ELSE
  9476         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9477
  9478     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9479     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9480     MOVE '3'                    TO CNTL-REC-TYPE.
  9481     MOVE +0                     TO CNTL-SEQ-NO.
  9482
  9483     MOVE '3'                    TO RC-SW-2.
  9484     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9485
  9486     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9487        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9488        PB-SV-STATE   NOT = CF-STATE-CODE)
  9489        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9490                                    WS-TOL-AH-CLAIM
  9491                                    WS-MINIMUM-REFUND
  9492                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 174
* EL050.cbl
  9493                                    WS-TOL-AH-PREM
  9494                                    WS-TOL-LF-REFUND
  9495                                    WS-TOL-AH-REFUND
  9496                                    EC-ST-TOL-PREM-PCT
  9497                                    WS-TOL-LF-PREM-PCT
  9498                                    WS-TOL-AH-PREM-PCT
  9499                                    EC-ST-TOL-REFUND-PCT
  9500                                    WS-TOL-LF-REFUND-PCT
  9501                                    WS-TOL-AH-REFUND-PCT
  9502                                    EC-ST-TOL-PREM
  9503                                    EC-ST-TOL-REFUND
  9504                                    EC-ST-FST-PMT-DAYS-MAX
  9505                                    WS-FREE-LOOK-PERIOD
  9506                                    WS-ST-LF-PREM-TAX
  9507                                    WS-ST-AH-PREM-TAX-I
  9508                                    WS-ST-AH-PREM-TAX-G
  9509                                    WS-BANK-FEE
  9510                                    WS-BANK-LFEE
  9511                                    WS-TOL-CLP-PCT
  9512                                    WS-SPP-LEASE-COMM
  9513        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9514                                    EC-ST-FST-PMT-DAYS-CHG
  9515                                    WS-LF-REM-TERM-CALC
  9516                                    WS-LF-REFUND-CALC
  9517                                    EC-ST-LF-REM-TERM-CALC
  9518                                    EC-ST-LF-REFUND-CALC
  9519                                    WS-AH-REM-TERM-CALC
  9520                                    WS-AH-REFUND-CALC
  9521                                    WS-LF-BEN-CATEGORY
  9522                                    WS-AH-BEN-CATEGORY
  9523                                    WS-CLP-STATE
  9524                                    WS-ST-REFUND-CLAIM-FLAG
  9525                                    EC-ST-AH-REM-TERM-CALC
  9526                                    EC-ST-AH-REFUND-CALC
  9527          GO TO 0499-STATE-NOT-FOUND.
  9528
  9529     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9530
  9531 0405-CONTINUE-EDIT.
  9532
  9533     if pb-company-id = 'AHL'
  9534        continue
  9535     else
  9536        IF PB-CERT-PRIME NOT NUMERIC
  9537           MOVE ER-2722          TO WS-ERROR
  9538           PERFORM 9900-ERROR-FORMAT
  9539                                 THRU 9900-EXIT
  9540        end-if
  9541     END-IF
  9542*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9543*       MOVE +0                  TO SUB3
  9544*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9545*       IF SUB3 > +0
  9546*          MOVE ER-2722          TO WS-ERROR
  9547*          PERFORM 9900-ERROR-FORMAT
  9548*                                THRU 9900-EXIT
  9549*       END-IF
  9550*    END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 175
* EL050.cbl
  9551*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9552*       IF PB-CERT-PRIME NOT NUMERIC
  9553*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9554*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9555*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9556*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9557*
  9558*          MOVE ER-2722          TO WS-ERROR
  9559*          PERFORM 9900-ERROR-FORMAT
  9560*                                THRU 9900-EXIT
  9561*       END-IF
  9562*    END-IF
  9563
  9564     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9565
  9566     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9567        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9568                                    WS-TOL-AH-CLAIM.
  9569
  9570     IF CF-ST-REFUND-MIN NOT NUMERIC
  9571        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9572
  9573     IF CF-ST-REFUND-MIN NOT = ZEROS
  9574        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9575
  9576     IF CF-ST-TOL-PREM  NOT = ZEROS
  9577        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9578                                    WS-TOL-AH-PREM
  9579        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9580
  9581     IF CF-ST-TOL-REFUND NOT = ZEROS
  9582        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9583                                    WS-TOL-AH-REFUND
  9584        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9585
  9586     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9587        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9588        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9589                                    WS-AH-REFUND-OVS-AMT
  9590                                    EC-ST-OVR-SHT-AMT.
  9591
  9592     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9593        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9594        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9595                                    WS-TOL-LF-PREM-PCT
  9596                                    WS-TOL-AH-PREM-PCT.
  9597
  9598     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9599        CF-ST-TOL-REF-PCT GREATER THAN +0
  9600        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9601                                    WS-TOL-LF-REFUND-PCT
  9602                                    WS-TOL-AH-REFUND-PCT.
  9603
  9604     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9605        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9606        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9607                                    WS-AH-REFUND-OVS-PCT
  9608                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 176
* EL050.cbl
  9609
  9610     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9611     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9612
  9613     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9614          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9615
  9616     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9617     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9618     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9619
  9620     IF CF-ST-LF-PREM-TAX NUMERIC
  9621        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9622     END-IF
  9623     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9624        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9625     END-IF
  9626     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9627        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9628     END-IF
  9629
  9630     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9631         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9632     END-IF.
  9633
  9634     IF WS-LF-BENEFIT-CD = ZEROS
  9635        GO TO 0410-CHECK-AH.
  9636
  9637     IF CF-ST-RT-CALC NOT = SPACES
  9638        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9639                                    EC-ST-LF-REM-TERM-CALC
  9640     END-IF
  9641
  9642     IF WS-LF-COVERAGE-TYPE = 'R'
  9643        IF WS-LF-EARNINGS-CALC = '5'
  9644           IF CF-ST-RF-LN-CALC > '0'
  9645              MOVE CF-ST-RF-LN-CALC
  9646                                 TO WS-LF-REFUND-CALC
  9647                                    EC-ST-LF-REFUND-CALC
  9648           END-IF
  9649        ELSE
  9650           IF CF-ST-RF-LR-CALC > '0'
  9651              MOVE CF-ST-RF-LR-CALC
  9652                                 TO WS-LF-REFUND-CALC
  9653                                    EC-ST-LF-REFUND-CALC
  9654           END-IF
  9655        END-IF
  9656     ELSE
  9657        IF CF-ST-RF-LL-CALC > '0'
  9658           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9659                                    EC-ST-LF-REFUND-CALC
  9660        END-IF
  9661     END-IF
  9662
  9663     IF CF-ST-RT-CALC NOT = SPACES
  9664        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9665                                    EC-ST-LF-REM-TERM-CALC
  9666     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 177
* EL050.cbl
  9667
  9668     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9669     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9670
  9671     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9672
  9673     IF NO-BENEFIT-FOUND
  9674        GO TO 0410-CHECK-AH.
  9675
  9676     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9677        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9678                                 TO EC-ST-LF-REM-TERM-CALC
  9679                                    WS-LF-REM-TERM-CALC
  9680     END-IF
  9681
  9682     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9683        MOVE CF-ST-REFUND-CALC (SUB3)
  9684                                 TO WS-LF-REFUND-CALC
  9685                                    EC-ST-LF-REFUND-CALC
  9686     END-IF
  9687*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9688
  9689     .
  9690 0410-CHECK-AH.
  9691
  9692     IF WS-AH-BENEFIT-CD = ZEROS
  9693        GO TO 0500-SET-ACCOUNT.
  9694
  9695     IF CF-ST-RT-CALC NOT = SPACES
  9696        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9697                                    EC-ST-AH-REM-TERM-CALC
  9698     END-IF
  9699
  9700     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9701        IF CF-ST-RF-CP-CALC > '0'
  9702           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9703                                    EC-ST-AH-REFUND-CALC
  9704        END-IF
  9705     ELSE
  9706        IF CF-ST-RF-AH-CALC > '0'
  9707           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9708                                    EC-ST-AH-REFUND-CALC
  9709        END-IF
  9710     END-IF
  9711     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9712     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9713
  9714     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9715
  9716     IF NO-BENEFIT-FOUND
  9717        GO TO 0500-SET-ACCOUNT.
  9718
  9719     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9720        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9721                                 TO WS-AH-REM-TERM-CALC
  9722                                    EC-ST-AH-REM-TERM-CALC
  9723     END-IF
  9724
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 178
* EL050.cbl
  9725     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9726        MOVE CF-ST-REFUND-CALC (SUB3)
  9727                                 TO WS-AH-REFUND-CALC
  9728                                    EC-ST-AH-REFUND-CALC
  9729     END-IF
  9730
  9731*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9732
  9733     GO TO 0500-SET-ACCOUNT.
  9734
  9735 0499-STATE-NOT-FOUND.
  9736
  9737     MOVE ER-2603                TO WS-ERROR.
  9738     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9739
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 179
* EL050.cbl
  9741
  9742 0500-SET-ACCOUNT.
  9743*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9744     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9745        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9746        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9747        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9748        MOVE '3'                 TO CNTL-REC-TYPE
  9749        MOVE +0                  TO CNTL-SEQ-NO
  9750
  9751        MOVE '3'                 TO RC-SW-2
  9752        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9753
  9754        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9755           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9756           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9757           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9758                                    WS-ST-AH-PREM-TAX-I
  9759                                    WS-ST-AH-PREM-TAX-G
  9760        ELSE
  9761           IF CF-ST-LF-PREM-TAX NUMERIC
  9762              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9763           END-IF
  9764           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9765              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9766           END-IF
  9767           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9768              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9769           END-IF
  9770        END-IF
  9771        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9772     END-IF
  9773*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9774*  FOR DCC ONLY
  9775     IF PB-COMPANY-ID = 'DCC'
  9776
  9777     MOVE ' '                    TO STAT-MASTER-SW
  9778     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9779     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9780     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9781     MOVE PB-STATE               TO ELSTAT-STATE
  9782     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9783        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9784     END-IF
  9785
  9786     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9787     SET BIN-TO-GREG             TO TRUE
  9788     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9789     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9790     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9791
  9792     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9793     IF STAT-MASTER-FOUND
  9794        MOVE 'N'                 TO STAT-MASTER-SW
  9795        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9796        IF STAT-MASTER-FOUND
  9797           IF (ELSTAT-KEY-SAVE (1:12) =
  9798                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 180
* EL050.cbl
  9799              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9800                 MOVE 'F'        TO STAT-MASTER-SW
  9801              ELSE
  9802                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9803                 IF (STAT-MASTER-FOUND)
  9804                    AND (ELSTAT-KEY-SAVE (1:12) =
  9805                        SF-CONTROL-PRIMARY (1:12))
  9806                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9807                    MOVE 'F'     TO STAT-MASTER-SW
  9808                 END-IF
  9809              END-IF
  9810           END-IF
  9811        END-IF
  9812     END-IF
  9813
  9814     IF STAT-MASTER-SW = 'F'
  9815        IF SF-ST-LF-PREM-TAX NUMERIC
  9816           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9817        END-IF
  9818        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9819           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9820        END-IF
  9821        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9822           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9823        END-IF
  9824     END-IF
  9825
  9826     END-IF
  9827     IF (PB-COMPANY-ID = 'DCC')
  9828        AND (PB-ISSUE)
  9829        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9830        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9831        AND (AM-GPCD = 06)
  9832        MOVE 'Y'                 TO WS-GOOD-HIN
  9833        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9834           MOVE PB-I-VIN         TO WS-WORK-VIN
  9835           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9836              (V1 > 16)
  9837              IF WS-WORK-VIN (V1:1) NUMERIC
  9838                 MOVE WS-WORK-VIN-N (V1)
  9839                                 TO WS-ROW-B-VAL (V1)
  9840              ELSE
  9841                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9842                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9843                    OR (V2 > 26)
  9844                 END-PERFORM
  9845                 IF V2 < 27
  9846                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9847                 ELSE
  9848                    MOVE 'N'     TO WS-GOOD-HIN
  9849                 END-IF
  9850              END-IF
  9851              COMPUTE WS-ROW-D-VAL (V1) =
  9852                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9853              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9854                 WS-ROW-D-VAL (V1)
  9855           END-PERFORM
  9856           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 181
* EL050.cbl
  9857           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9858             REMAINDER WS-VIN-REMAINDER
  9859           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9860              CONTINUE
  9861           ELSE
  9862              MOVE 'N'           TO WS-GOOD-HIN
  9863           END-IF
  9864        ELSE
  9865           MOVE 'N'              TO WS-GOOD-HIN
  9866        END-IF
  9867        IF WS-GOOD-HIN NOT = 'Y'
  9868           MOVE ER-3826           TO WS-ERROR
  9869           PERFORM 9900-ERROR-FORMAT
  9870                                 THRU 9900-EXIT
  9871        END-IF
  9872     END-IF
  9873     IF (PB-COMPANY-ID = 'DCC')
  9874        AND (PB-ISSUE)
  9875        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9876        AND (AM-GPCD NOT = 06)
  9877        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9878          MOVE PB-I-VIN          TO WS-WORK-VIN
  9879          MOVE +8                TO V2
  9880          MOVE ZEROS             TO WS-VIN-TOTAL
  9881          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9882           (V1 > 17)
  9883             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9884                MOVE ER-3825     TO WS-ERROR
  9885                PERFORM 9900-ERROR-FORMAT
  9886                                 THRU 9900-EXIT
  9887             ELSE
  9888                IF V1 = 8
  9889                   MOVE 10       TO V2
  9890                END-IF
  9891                IF V1 = 9
  9892                   MOVE 0        TO V2
  9893                END-IF
  9894                IF V1 = 10
  9895                   MOVE 9        TO V2
  9896                END-IF
  9897                IF WS-WORK-VIN (V1:1) NUMERIC
  9898                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9899                    + (WS-WORK-VIN-N (V1) * V2)
  9900                ELSE
  9901                   MOVE WS-WORK-VIN (V1:1)
  9902                                 TO WS-HEX-BYTE
  9903                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9904                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9905                    + (WS-NUM (V3) * V2)
  9906                END-IF
  9907                COMPUTE V2 = V2 - 1
  9908             END-IF
  9909          END-PERFORM
  9910          MOVE ZEROS TO WS-VIN-REMAINDER
  9911          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9912             REMAINDER WS-VIN-REMAINDER
  9913          IF ((WS-WORK-VIN (9:1) = 'X')
  9914             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 182
* EL050.cbl
  9915                     OR
  9916             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9917             CONTINUE
  9918          ELSE
  9919             MOVE ER-3826        TO WS-ERROR
  9920             PERFORM 9900-ERROR-FORMAT
  9921                                 THRU 9900-EXIT
  9922          END-IF
  9923        ELSE
  9924          MOVE ER-3826           TO WS-ERROR
  9925          PERFORM 9900-ERROR-FORMAT
  9926                                 THRU 9900-EXIT
  9927        END-IF
  9928     END-IF
  9929******************************************************************
  9930******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  9931******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  9932******* METHODS.
  9933******************************************************************
  9934     IF PB-COMPANY-ID EQUAL TO 'NCL'
  9935        IF PB-CANCELLATION
  9936           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  9937              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  9938                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
  9939                IF FORM-MASTER-FOUND
  9940                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
  9941******************************************************************
  9942
  9943     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
  9944     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
  9945
  9946     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
  9947     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
  9948     MOVE AM-STATUS              TO WS-ACCT-STATUS.
  9949     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
  9950
  9951
  9952     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
  9953     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
  9954     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
  9955
  9956     IF AM-LF-OB-RATE NOT NUMERIC
  9957         MOVE ZERO               TO AM-LF-OB-RATE.
  9958
  9959     IF AM-LF-OB-RATE-JNT NOT NUMERIC
  9960         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
  9961
  9962     IF AM-AH-OB-RATE NOT NUMERIC
  9963         MOVE ZERO               TO AM-AH-OB-RATE.
  9964
  9965     IF WS-LF-JOINT-INDICATOR = 'J'
  9966         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
  9967     ELSE
  9968         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
  9969
  9970     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
  9971
  9972     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 183
* EL050.cbl
  9973         MOVE AM-IG              TO WS-IG-OVRD-AM.
  9974
  9975     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
  9976         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
  9977                                       WS-IG-OVRD
  9978     ELSE
  9979         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
  9980             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
  9981                                       WS-IG-OVRD
  9982         ELSE
  9983             MOVE AM-IG             TO WS-IG-OVRD-AH
  9984                                       WS-IG-OVRD.
  9985
  9986     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
  9987         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
  9988                                       WS-IG-OVRD
  9989     ELSE
  9990         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
  9991             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
  9992                                       WS-IG-OVRD
  9993         ELSE
  9994             MOVE AM-IG             TO WS-IG-OVRD-LF
  9995                                       WS-IG-OVRD.
  9996
  9997     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
  9998     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
  9999     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10000     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10001     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10002
 10003     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10004     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10005     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10006     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10007
 10008     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10009     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10010     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10011     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10012     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10013     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10014     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10015
 10016     IF WS-ACCT-AH-DEV-PCT > +0
 10017        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10018     ELSE
 10019        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10020
 10021     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10022        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10023     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10024        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10025
 10026        IF AM-EARN-METHOD-L = 'S'
 10027            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10028                                        WS-LF-REFUND-CALC.
 10029
 10030        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 184
* EL050.cbl
 10031            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10032                                        WS-LF-REFUND-CALC.
 10033
 10034     IF WS-LF-COVERAGE-TYPE = 'R'
 10035         IF AM-EARN-METHOD-R = 'R'
 10036            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10037                                    WS-LF-REFUND-CALC.
 10038     IF WS-LF-COVERAGE-TYPE = 'R'
 10039         IF AM-EARN-METHOD-R = 'P'
 10040            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10041                                    WS-LF-REFUND-CALC.
 10042     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10043         IF AM-EARN-METHOD-L = 'R'
 10044            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10045                                    WS-LF-REFUND-CALC.
 10046     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10047         IF AM-EARN-METHOD-L = 'P'
 10048            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10049                                    WS-LF-REFUND-CALC.
 10050     IF WS-LF-COVERAGE-TYPE = 'R'
 10051         IF AM-EARN-METHOD-R = 'A'
 10052            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10053                                    WS-LF-REFUND-CALC.
 10054     IF WS-LF-COVERAGE-TYPE = 'R'
 10055         IF AM-EARN-METHOD-R = 'M'
 10056            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10057                                    WS-LF-REFUND-CALC.
 10058     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10059         IF AM-EARN-METHOD-L = 'A'
 10060            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10061                                    WS-LF-REFUND-CALC.
 10062     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10063         IF AM-EARN-METHOD-L = 'M'
 10064            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10065                                    WS-LF-REFUND-CALC.
 10066
 10067     IF AM-EARN-METHOD-A = 'R'
 10068        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10069                                    WS-AH-REFUND-CALC.
 10070     IF AM-EARN-METHOD-A = 'P'
 10071        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10072                                    WS-AH-REFUND-CALC.
 10073     IF AM-EARN-METHOD-A = 'C'
 10074        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10075                                    WS-AH-REFUND-CALC.
 10076     IF AM-EARN-METHOD-A = 'A'
 10077        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10078                                    WS-AH-REFUND-CALC.
 10079     IF AM-EARN-METHOD-A = 'M'
 10080        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10081                                    WS-AH-REFUND-CALC.
 10082     IF AM-EARN-METHOD-A = 'N'
 10083        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10084                                    WS-AH-REFUND-CALC.
 10085     IF AM-EARN-METHOD-A = 'S'
 10086        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10087                                    WS-AH-REFUND-CALC.
 10088
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 185
* EL050.cbl
 10089     IF AM-TOL-PREM NOT = ZEROS
 10090        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10091                                    WS-TOL-AH-PREM.
 10092
 10093     IF AM-OVR-SHT-AMT NUMERIC AND
 10094                  AM-OVR-SHT-AMT > 0
 10095        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10096                                    EC-AM-LF-OVR-SHT-AMT
 10097                                    WS-AH-REFUND-OVS-AMT
 10098                                    EC-AM-AH-OVR-SHT-AMT.
 10099
 10100     IF AM-OVR-SHT-PCT NUMERIC AND
 10101                    AM-OVR-SHT-PCT > 0
 10102        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10103                                    EC-AM-LF-OVR-SHT-PCT
 10104                                    WS-AH-REFUND-OVS-PCT
 10105                                    EC-AM-AH-OVR-SHT-PCT.
 10106
 10107     IF AM-TOL-REF-PCT NUMERIC AND
 10108                  AM-TOL-REF-PCT > 0
 10109        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10110                                    WS-TOL-AH-REFUND-PCT.
 10111
 10112     IF AM-TOL-REF  NOT = ZEROS  AND
 10113                  AM-TOL-REF NUMERIC
 10114        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10115                                    EC-AM-LF-TOL-REFUND
 10116                                    WS-TOL-AH-REFUND
 10117                                    EC-AM-AH-TOL-REFUND.
 10118
 10119     IF AM-TOL-CLM  NOT = ZEROS
 10120        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10121                                    WS-TOL-AH-CLAIM.
 10122
 10123     IF AM-CLP-TOL-PCT NOT NUMERIC
 10124        MOVE +0                  TO AM-CLP-TOL-PCT
 10125     END-IF
 10126
 10127     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10128        MOVE +0                  TO AM-SPP-LEASE-COMM
 10129     END-IF
 10130     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10131        MOVE WS-PL-TOL-LF-PREM-PCT
 10132                                 TO WS-TOL-LF-PREM-PCT.
 10133
 10134     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10135        MOVE WS-PL-TOL-AH-PREM-PCT
 10136                                 TO WS-TOL-AH-PREM-PCT.
 10137
 10138     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10139        MOVE WS-PL-TOL-LF-REFUND-PCT
 10140                                 TO WS-TOL-LF-REFUND-PCT.
 10141
 10142     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10143        MOVE WS-PL-TOL-AH-REFUND-PCT
 10144                                 TO WS-TOL-AH-REFUND-PCT.
 10145
 10146     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 186
* EL050.cbl
 10147        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10148
 10149     IF WS-PL-REF-OVS-PCT > +0
 10150        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10151
 10152     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10153        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10154     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10155        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10156     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10157        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10158     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10159        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10160     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10161        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10162     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10163        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10164
 10165     IF WS-AH-PL-REF-OVS-AMT > +0
 10166        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10167
 10168     IF WS-AH-PL-REF-OVS-PCT > +0
 10169        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10170
 10171     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10172     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10173
 10174     IF PB-CANCELLATION
 10175        GO TO 3000-CONTINUE-EDIT.
 10176
 10177     MOVE +1 TO SUB1.
 10178     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10179     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10180
 10181     IF CF-COMPANY-ID = 'DMD'
 10182       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10183         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10184        ELSE
 10185         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10186
 10187  0525-FIND-ACCT-COMM.
 10188     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10189        NEXT SENTENCE
 10190      ELSE
 10191         ADD +1 TO SUB1
 10192         IF SUB1 LESS +11
 10193            GO TO 0525-FIND-ACCT-COMM
 10194          ELSE
 10195             GO TO 0560-EDIT-CONTINUE.
 10196
 10197     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10198     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10199                                    PB-I-LIFE-COMMISSION.
 10200***  IF PB-COMPANY-ID = 'CRI'
 10201     IF PB-PREM-ACCTNG-ONLY
 10202         GO TO 0560-EDIT-CONTINUE.
 10203
 10204     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 187
* EL050.cbl
 10205     MOVE ' '    TO WS-CTBL-READ-SW.
 10206
 10207
 10208 0530-GET-AH-COMP.
 10209     IF NO-AH-COVERAGE  OR
 10210        NO-AH-BENEFIT-MATCH
 10211           GO TO 0540-NEXT-READ-STEP.
 10212
 10213     IF AM-A-COM (SUB1) NUMERIC
 10214        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10215         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10216         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10217         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10218         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10219     ELSE
 10220          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10221          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10222          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10223          MOVE ZEROS             TO WS-SUB1
 10224                                    WS-COMMISSION
 10225          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10226          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10227          IF WS-COMMISSION > ZEROS
 10228             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10229             GO TO 0540-NEXT-READ-STEP
 10230          END-IF
 10231          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10232          IF CTBL-TABLE-FOUND
 10233             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10234                                        PB-I-AH-TERM
 10235             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10236             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10237             GO TO 0540-NEXT-READ-STEP
 10238          ELSE
 10239             IF FIRST-TIME-THROUGH
 10240                 GO TO 0530-GET-AH-COMP
 10241             ELSE
 10242                 MOVE ER-2609                TO WS-ERROR
 10243                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10244
 10245 0540-NEXT-READ-STEP.
 10246     MOVE '0540' TO CTBL-SW.
 10247     MOVE ' '    TO WS-CTBL-READ-SW.
 10248
 10249 0540-GET-LF-COMP.
 10250     IF NO-LIFE-COVERAGE  OR
 10251        NO-LF-BENEFIT-MATCH
 10252           GO TO 0560-EDIT-CONTINUE.
 10253
 10254     IF WS-LF-JOINT-INDICATOR = 'J'
 10255        IF AM-J-COM (SUB1) NUMERIC
 10256           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10257           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10258           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10259           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10260           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10261        ELSE
 10262           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 188
* EL050.cbl
 10263           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10264           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10265           MOVE ZEROS                TO WS-SUB1
 10266                                        WS-COMMISSION
 10267           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10268           IF WS-COMMISSION > ZEROS
 10269              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10270              GO TO 0560-EDIT-CONTINUE
 10271           END-IF
 10272           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10273           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10274           IF CTBL-TABLE-FOUND
 10275              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10276              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10277              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10278              GO TO 0560-EDIT-CONTINUE
 10279           ELSE
 10280              IF FIRST-TIME-THROUGH
 10281                  GO TO 0540-GET-LF-COMP
 10282              ELSE
 10283                  MOVE ER-2609                TO WS-ERROR
 10284                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10285                  GO TO 0560-EDIT-CONTINUE.
 10286
 10287     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10288        IF AM-L-COM (SUB1) NUMERIC
 10289           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10290           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10291           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10292           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10293           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10294        ELSE
 10295           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10296           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10297           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10298           MOVE ZEROS                TO WS-SUB1
 10299                                        WS-COMMISSION
 10300           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10301           IF WS-COMMISSION IS GREATER THAN ZEROS
 10302              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10303              GO TO 0560-EDIT-CONTINUE
 10304           END-IF
 10305           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10306           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10307           IF CTBL-TABLE-FOUND
 10308              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10309              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10310              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10311              GO TO 0560-EDIT-CONTINUE
 10312           ELSE
 10313              IF FIRST-TIME-THROUGH
 10314                  GO TO 0540-GET-LF-COMP
 10315              ELSE
 10316                  MOVE ER-2609                TO WS-ERROR
 10317                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10318
 10319*    GO TO 0560-EDIT-CONTINUE.
 10320
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 189
* EL050.cbl
 10321 0560-EDIT-CONTINUE.
 10322     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10323                                    WS-AH-PMF-COMM
 10324*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10325*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10326     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10327        (SUB1 > +10)
 10328        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10329           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10330           MOVE '0530'           TO CTBL-SW
 10331           MOVE ' '              TO WS-CTBL-READ-SW
 10332           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10333           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10334           MOVE '0540'           TO CTBL-SW
 10335           MOVE ' '              TO WS-CTBL-READ-SW
 10336           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10337        END-IF
 10338     END-PERFORM
 10339     GO TO 0564-EDIT-CONTINUE
 10340     .
 10341 0561-CHECK-AH.
 10342     IF (NO-AH-COVERAGE)
 10343        OR (NO-AH-BENEFIT-MATCH)
 10344        CONTINUE
 10345     ELSE
 10346        IF (AM-A-COM (SUB1) NUMERIC)
 10347           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10348           IF (AM-COM-TYP (SUB1) = 'A')
 10349              AND (WS-AH-PMF-COMM = ZEROS)
 10350              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10351           END-IF
 10352           CONTINUE
 10353        ELSE
 10354           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10355           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10356           MOVE PB-AH-OVERRIDE-L1
 10357                                 TO CTBL-BEN-TYPE
 10358           MOVE ZEROS            TO WS-SUB1
 10359                                    WS-COMMISSION
 10360           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10361           PERFORM 8300-READ-CTBL-TABLE
 10362                                 THRU 8300-EXIT
 10363           IF CTBL-TABLE-FOUND
 10364              IF (AM-COM-TYP (SUB1) = 'A')
 10365                 AND (WS-AH-PMF-COMM = ZEROS)
 10366                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10367                                        PB-I-AH-TERM
 10368                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10369                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10370              END-IF
 10371              CONTINUE
 10372           ELSE
 10373              IF FIRST-TIME-THROUGH
 10374                 GO TO 0561-CHECK-AH
 10375              ELSE
 10376                 MOVE ER-2609    TO WS-ERROR
 10377                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10378              END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 190
* EL050.cbl
 10379           END-IF
 10380        END-IF
 10381     END-IF
 10382     .
 10383 0561-EXIT.
 10384     EXIT.
 10385 0563-CHECK-LF.
 10386     IF (NO-LIFE-COVERAGE)
 10387        OR (NO-LF-BENEFIT-MATCH)
 10388        CONTINUE
 10389     ELSE
 10390        IF WS-LF-JOINT-INDICATOR = 'J'
 10391           IF AM-J-COM (SUB1) NUMERIC
 10392              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10393              IF (AM-COM-TYP (SUB1) = 'A')
 10394                 AND (WS-LF-PMF-COMM = ZEROS)
 10395                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10396              END-IF
 10397              CONTINUE
 10398           ELSE
 10399              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10400              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10401              MOVE PB-LIFE-OVERRIDE-L1
 10402                                 TO CTBL-BEN-TYPE
 10403              MOVE ZEROS         TO WS-SUB1
 10404                                    WS-COMMISSION
 10405              MOVE AM-J-COMA (SUB1)
 10406                                 TO CTBL-TABLE
 10407              PERFORM 8300-READ-CTBL-TABLE
 10408                                 THRU 8300-EXIT
 10409              IF CTBL-TABLE-FOUND
 10410                 IF (AM-COM-TYP (SUB1) = 'A')
 10411                    AND (WS-LF-PMF-COMM = ZEROS)
 10412                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10413                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10414                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10415                 END-IF
 10416                 CONTINUE
 10417              ELSE
 10418                 IF FIRST-TIME-THROUGH
 10419                    GO TO 0563-CHECK-LF
 10420                 ELSE
 10421                    MOVE ER-2609 TO WS-ERROR
 10422                    PERFORM 9900-ERROR-FORMAT
 10423                                 THRU 9900-EXIT
 10424*                   GO TO 0560-EDIT-CONTINUE
 10425                 END-IF
 10426              END-IF
 10427           END-IF
 10428        ELSE
 10429           IF AM-L-COM (SUB1) NUMERIC
 10430              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10431              IF (AM-COM-TYP (SUB1) = 'A')
 10432                 AND (WS-LF-PMF-COMM = ZEROS)
 10433                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10434              END-IF
 10435              CONTINUE
 10436           ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 191
* EL050.cbl
 10437              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10438              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10439              MOVE PB-LIFE-OVERRIDE-L1
 10440                                 TO CTBL-BEN-TYPE
 10441              MOVE ZEROS         TO WS-SUB1
 10442                                    WS-COMMISSION
 10443              MOVE AM-L-COMA (SUB1)
 10444                                 TO CTBL-TABLE
 10445              PERFORM 8300-READ-CTBL-TABLE
 10446                                 THRU 8300-EXIT
 10447              IF CTBL-TABLE-FOUND
 10448                 CONTINUE
 10449              ELSE
 10450                 IF FIRST-TIME-THROUGH
 10451                    GO TO 0563-CHECK-LF
 10452                 ELSE
 10453                    MOVE ER-2609 TO WS-ERROR
 10454                    PERFORM 9900-ERROR-FORMAT
 10455                                 THRU 9900-EXIT
 10456                 END-IF
 10457              END-IF
 10458           END-IF
 10459        END-IF
 10460     END-IF
 10461     .
 10462 0563-EXIT.
 10463     EXIT.
 10464 0564-EDIT-CONTINUE.
 10465
 10466     IF  PB-COMPANY-ID EQUAL 'DMD'
 10467         IF PB-I-NUM-BILLED EQUAL ZEROS
 10468            MOVE ER-8148       TO WS-ERROR
 10469            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10470
 10471*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10472*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10473*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10474*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10475*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10476*         IF NO-CONVERSION-ERROR
 10477*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10478*         ELSE
 10479*             IF PB-COMPANY-ID EQUAL 'HAN'
 10480*                 MOVE ZEROS     TO PB-I-AGE.
 10481     IF PB-I-BIRTHDAY > LOW-VALUES
 10482        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10483        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10484        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10485        PERFORM 8500-DATE-CONVERT
 10486                                 THRU 8500-EXIT
 10487        IF NO-CONVERSION-ERROR
 10488           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10489           IF PB-I-AGE > ZEROS
 10490              IF WS-WORK-AGE NOT = PB-I-AGE
 10491                 MOVE ER-9501    TO WS-ERROR
 10492                 PERFORM 9900-ERROR-FORMAT
 10493                                 THRU 9900-EXIT
 10494              END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 192
* EL050.cbl
 10495           ELSE
 10496              MOVE WS-WORK-AGE   TO PB-I-AGE
 10497           END-IF
 10498        END-IF
 10499     END-IF
 10500     IF PB-I-AGE = ZEROS
 10501        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10502           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10503
 10504     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10505                                   WS-AH-EDIT-AGE.
 10506
 10507     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10508        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10509        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10510        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10511        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10512        IF NO-CONVERSION-ERROR
 10513           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10514           IF PB-I-JOINT-AGE > 0
 10515              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10516                 MOVE ER-9503    TO WS-ERROR
 10517                 PERFORM 9900-ERROR-FORMAT
 10518                                 THRU 9900-EXIT
 10519              END-IF
 10520           ELSE
 10521              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10522           END-IF
 10523        ELSE
 10524           MOVE ZEROS            TO PB-I-JOINT-AGE
 10525        END-IF
 10526     END-IF
 10527     IF PB-I-JOINT-AGE NOT NUMERIC
 10528        MOVE ZERO               TO PB-I-JOINT-AGE.
 10529
 10530     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10531        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10532           (WS-AH-JOINT-INDICATOR = 'J')
 10533           IF PB-I-JOINT-AGE = ZEROS
 10534               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10535           END-IF
 10536        END-IF
 10537     END-IF
 10538
 10539     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10540     IF WS-LF-JOINT-INDICATOR = 'J'
 10541        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10542        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10543            IF  PB-I-JOINT-AGE = ZERO
 10544                MOVE ER-2686       TO WS-ERROR
 10545                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10546            ELSE
 10547                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10548                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10549                    IF PB-COMPANY-ID NOT = 'LBL'
 10550                        MOVE ER-2685    TO WS-ERROR
 10551                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10552
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 193
* EL050.cbl
 10553     IF WS-AH-JOINT-INDICATOR = 'J'
 10554        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10555            IF  PB-I-JOINT-AGE = ZERO
 10556                MOVE ER-2686       TO WS-ERROR
 10557                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10558            ELSE
 10559                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10560                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10561                                           WS-EDIT-AGE
 10562                    IF PB-COMPANY-ID NOT = 'LBL'
 10563                        MOVE ER-2685    TO WS-ERROR
 10564                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10565
 10566******************************************************************
 10567*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10568******************************************************************
 10569
 10570     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10571        (WS-AH-SPECIAL-CALC-CD = 'O')
 10572        NEXT SENTENCE
 10573     ELSE
 10574        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10575          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10576           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10577            WS-AH-JOINT-INDICATOR = 'J')  AND
 10578           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10579            MOVE ER-2627             TO WS-ERROR
 10580            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10581
 10582     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10583        (WS-AH-SPECIAL-CALC-CD = 'O')
 10584         NEXT SENTENCE
 10585     ELSE
 10586         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10587            WS-AH-JOINT-INDICATOR = 'J'
 10588             IF PB-I-JOINT-INSURED = SPACES
 10589                 IF PB-COMPANY-ID NOT = 'JAL'
 10590                     MOVE ER-2696    TO WS-ERROR
 10591                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10592
 10593     IF PB-COMPANY-ID NOT = 'BOA'
 10594        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10595           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10596           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10597               PB-I-JOINT-INSURED NOT = SPACES)
 10598                MOVE ER-2691         TO WS-ERROR
 10599                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10600
 10601     IF PB-COMPANY-ID = 'BOA'
 10602        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10603           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10604            IF PB-I-JOINT-AGE NOT = ZEROS
 10605                MOVE ER-2691         TO WS-ERROR
 10606                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10607
 10608     IF PB-COMPANY-ID = 'CRI'
 10609        IF PB-I-SIG-SW = 'J'
 10610           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 194
* EL050.cbl
 10611              WS-AH-JOINT-INDICATOR NOT = 'J'
 10612              MOVE ER-2675       TO WS-ERROR
 10613              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10614
 10615     IF PB-COMPANY-ID = 'CRI'
 10616        IF PB-I-SIG-SW = 'S'
 10617           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10618              WS-AH-JOINT-INDICATOR = 'J'
 10619              MOVE ER-2676       TO WS-ERROR
 10620              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10621
 10622     IF PB-COMPANY-ID = 'CVL'
 10623         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10624            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10625              MOVE ER-2783           TO WS-ERROR
 10626              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10627     IF (WS-LF-JOINT-INDICATOR = 'J')
 10628        AND (WS-AH-JOINT-INDICATOR = 'J')
 10629        AND (PB-I-LF-TERM > 120)
 10630        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10631        MOVE ER-2783             TO WS-ERROR
 10632        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10633     END-IF
 10634     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10635
 10636     IF PB-I-INDV-GRP-OVRD = 'I'
 10637        MOVE ER-2666             TO WS-ERROR
 10638        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10639        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10640
 10641     IF PB-I-INDV-GRP-OVRD = 'G'
 10642        MOVE ER-2666             TO WS-ERROR
 10643        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10644        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10645
 10646     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10647        NEXT SENTENCE
 10648     ELSE
 10649        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10650
 10651     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10652        IF WS-ERROR = ER-2666
 10653           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10654           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10655
 10656     IF PB-COMPANY-ID = 'CID'
 10657        IF PB-STATE = 'UT' OR 'MO'
 10658           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10659                 OR '76' OR '77')
 10660                      OR
 10661               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10662                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10663                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10664                   OR '2K' OR '2L'))
 10665              AND PB-I-INDV-GRP-CD = 'I'
 10666              MOVE ER-2721             TO WS-ERROR
 10667              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10668           END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 195
* EL050.cbl
 10669        END-IF
 10670     END-IF
 10671
 10672     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10673     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10674        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10675     ELSE
 10676        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10677     END-IF
 10678
 10679*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10680*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10681     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10682                                    ACCOUNT-AH-CK-SW.
 10683
 10684     IF PB-REISSUED-CERT       OR
 10685        PB-REIN-ONLY-CERT      OR
 10686        PB-POLICY-IS-DECLINED  OR
 10687        PB-POLICY-IS-VOIDED
 10688*       OR PB-MONTHLY-CERT
 10689         GO TO 3000-CONTINUE-EDIT.
 10690
 10691     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10692        IF WS-EDIT-AGE           > +65
 10693           MOVE ER-2709          TO WS-ERROR
 10694           PERFORM 9900-ERROR-FORMAT
 10695                                 THRU 9900-EXIT
 10696        ELSE
 10697           IF WS-EDIT-AGE        > +55
 10698              MOVE ER-2718       TO WS-ERROR
 10699              PERFORM 9900-ERROR-FORMAT
 10700                                 THRU 9900-EXIT
 10701           END-IF
 10702        END-IF
 10703     IF PB-COMPANY-ID = 'DCC'
 10704        IF WS-EDIT-AGE           > +65
 10705           MOVE ER-2709          TO WS-ERROR
 10706           PERFORM 9900-ERROR-FORMAT
 10707                                 THRU 9900-EXIT
 10708        END-IF
 10709     END-IF
 10710     .
 10711
 10712 0565-LIFE-PLAN-LIMIT-EDITS.
 10713
 10714     IF NOT LF-PLAN-MASTER-FOUND
 10715        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10716                                    EC-AM-LF-MAX-TOT-BEN
 10717        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10718
 10719     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10720
 10721     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10722         IF PL-LM-AGE (1) = ZEROS
 10723             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10724
 10725     IF NO-LF-BENEFIT-MATCH          OR
 10726        WS-LF-BENEFIT-CD = ZEROS     OR
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 196
* EL050.cbl
 10727        WS-LF-SPECIAL-CALC-CD = 'M'
 10728        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10729
 10730     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10731     MOVE +1                     TO SUB2.
 10732
 10733     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10734        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10735           MOVE +5   TO SUB2
 10736           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10737              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10738              (PL-LM-AGE (SUB2) EQUAL +0)
 10739              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10740              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10741
 10742     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10743
 10744     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10745                               + PB-I-LF-ALT-BENEFIT-AMT.
 10746
 10747 0568-CHECK-LIFE-ATT-AGE.
 10748
 10749     IF PL-ATT-AGE NUMERIC AND
 10750        PL-ATT-AGE > +0
 10751        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10752     END-IF
 10753*    IF PL-ATT-AGE NUMERIC AND
 10754*       PL-ATT-AGE > +0
 10755*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10756*       IF PB-I-BIRTHDAY > LOW-VALUES
 10757*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10758*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10759*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10760*          SET BIN-PLUS-ELAPSED  TO TRUE
 10761*          PERFORM 8500-DATE-CONVERT
 10762*                                THRU 8500-EXIT
 10763*          IF NO-CONVERSION-ERROR
 10764*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10765*             MOVE ER-2669       TO WS-ERROR
 10766*             PERFORM 9900-ERROR-FORMAT
 10767*                                THRU 9900-EXIT
 10768*          END-IF
 10769*       ELSE
 10770*          IF WS-ATT-AGE >= PL-ATT-AGE
 10771*             MOVE ER-2669       TO WS-ERROR
 10772*             PERFORM 9900-ERROR-FORMAT
 10773*                                THRU 9900-EXIT
 10774*          END-IF
 10775*       END-IF
 10776*    END-IF
 10777     .
 10778 0570-CHECK-LIFE-LIMITS.
 10779
 10780     IF PB-COMPANY-ID EQUAL 'CRI'
 10781        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10782           IF SUB2 GREATER THAN +4
 10783              MOVE ER-2637 TO WS-ERROR
 10784              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 197
* EL050.cbl
 10785              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10786
 10787     IF PB-COMPANY-ID  =  'NCL'
 10788        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10789            SUB2 GREATER THAN +8
 10790             MOVE 'U'         TO PB-BATCH-ENTRY
 10791             MOVE ER-2637     TO WS-ERROR
 10792             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10793             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10794
 10795     IF SUB2 > +8
 10796        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10797           AND (PB-I-SIG-SW = 'Y')
 10798           CONTINUE
 10799        ELSE
 10800           MOVE ER-2637          TO WS-ERROR
 10801           PERFORM 9900-ERROR-FORMAT
 10802                                 THRU 9900-EXIT
 10803        END-IF
 10804        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10805     END-IF
 10806     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10807     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10808     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10809
 10810     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10811        ADD +1  TO SUB2
 10812        GO TO 0570-CHECK-LIFE-LIMITS.
 10813
 10814     IF PB-COMPANY-ID = 'NCL'
 10815         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10816
 10817     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10818        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10819        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10820           AND (PB-I-SIG-SW = 'Y')
 10821           CONTINUE
 10822        ELSE
 10823           MOVE ER-2637          TO WS-ERROR
 10824           PERFORM 9900-ERROR-FORMAT
 10825                                 THRU 9900-EXIT
 10826        END-IF
 10827     END-IF
 10828     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10829
 10830
 10831 0570-CHECK-NCL-LIFE-LIMITS.
 10832
 10833     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10834        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 10835         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10836
 10837     IF APP-CERT-USED
 10838         IF SUB2  LESS THAN  +5
 10839             MOVE +5          TO SUB2
 10840             GO TO 0570-CHECK-LIFE-LIMITS.
 10841
 10842     MOVE ER-2637             TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 198
* EL050.cbl
 10843     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10844
 10845     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10846
 10847 0575-CHECK-NCL-SIG-SWITCH.
 10848
 10849     IF NOT APP-CERT-USED
 10850         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10851
 10852     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10853        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10854        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10855        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10856         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10857
 10858     IF SUB2 GREATER THAN +4
 10859         IF PL-LM-AGE (5) = ZEROS  AND
 10860            PL-LM-AGE (6) = ZEROS  AND
 10861            PL-LM-AGE (7) = ZEROS  AND
 10862            PL-LM-AGE (8) = ZEROS
 10863             MOVE  ER-1927        TO WS-ERROR
 10864             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10865             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10866         ELSE
 10867             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10868                 MOVE  ER-1920    TO WS-ERROR
 10869                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10870
 10871     IF PB-I-SIG-SW  = 'Y'
 10872       IF NOT PB-I-POLICY-ACCEPTED  AND
 10873          NOT PB-I-POLICY-DECLINED
 10874           MOVE 'U'               TO PB-BATCH-ENTRY
 10875           MOVE  ER-1926          TO WS-ERROR
 10876           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10877
 10878
 10879 0580-AH-PLAN-LIMIT-EDITS.
 10880
 10881     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10882        IF PB-I-AH-BENEFIT-AMT > +1250
 10883           MOVE ER-2702          TO WS-ERROR
 10884           PERFORM 9900-ERROR-FORMAT
 10885                                 THRU 9900-EXIT
 10886        END-IF
 10887     END-IF
 10888
 10889     IF (PB-COMPANY-ID = 'DCC')
 10890        AND (PB-MONTHLY-CERT)
 10891        IF PB-I-AH-BENEFIT-AMT > +3000
 10892           MOVE ER-2881          TO WS-ERROR
 10893           PERFORM 9900-ERROR-FORMAT
 10894                                 THRU 9900-EXIT
 10895        END-IF
 10896     END-IF
 10897     IF NOT AH-PLAN-MASTER-FOUND
 10898        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10899        GO TO 3000-CONTINUE-EDIT.
 10900
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 199
* EL050.cbl
 10901     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10902
 10903     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10904         IF PL-LM-AGE (1) = ZEROS
 10905             GO TO 3000-CONTINUE-EDIT.
 10906
 10907     IF NO-AH-BENEFIT-MATCH          OR
 10908        WS-AH-BENEFIT-CD = ZEROS     OR
 10909        WS-AH-SPECIAL-CALC-CD = 'M'
 10910        GO TO 3000-CONTINUE-EDIT.
 10911
 10912     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10913     MOVE +1                     TO SUB2.
 10914
 10915     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10916        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10917           MOVE +5 TO SUB2
 10918           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10919              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10920              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10921              (PL-LM-AGE (SUB2) EQUAL +0)
 10922              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 10923              GO TO 3000-CONTINUE-EDIT.
 10924
 10925     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 10926
 10927 0590-CHECK-AH-ATT-AGE.
 10928
 10929     IF PL-ATT-AGE NUMERIC AND
 10930        PL-ATT-AGE GREATER THAN +0
 10931        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 10932     END-IF
 10933*       IF WS-ATT-AGE >= PL-ATT-AGE
 10934*          MOVE ER-3054          TO WS-ERROR
 10935*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10936     .
 10937 0597-CHECK-AH-LIMITS.
 10938
 10939     IF PB-COMPANY-ID EQUAL 'CRI'
 10940        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10941           IF SUB2 GREATER THAN +4
 10942              MOVE ER-2638       TO WS-ERROR
 10943              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10944              GO TO 3000-CONTINUE-EDIT.
 10945
 10946     IF PB-COMPANY-ID  =  'NCL'
 10947        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10948            SUB2 GREATER THAN +8
 10949             MOVE 'U'            TO PB-BATCH-ENTRY
 10950             MOVE ER-2638        TO WS-ERROR
 10951             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10952             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10953
 10954     IF SUB2 > +8
 10955        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10956           AND (PB-I-SIG-SW = 'Y')
 10957           CONTINUE
 10958        ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 200
* EL050.cbl
 10959           MOVE ER-2638          TO WS-ERROR
 10960           PERFORM 9900-ERROR-FORMAT
 10961                                 THRU 9900-EXIT
 10962        END-IF
 10963        GO TO 3000-CONTINUE-EDIT
 10964     END-IF
 10965
 10966     IF PB-COMPANY-ID = 'CRI'
 10967        IF WS-ERROR = ER-2638
 10968           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 10969
 10970     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 10971     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 10972     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 10973     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 10974
 10975     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10976        ADD +1                   TO SUB2
 10977        GO TO 0597-CHECK-AH-LIMITS.
 10978
 10979     IF PB-COMPANY-ID = 'NCL'
 10980         GO TO 0597-CHECK-NCL-AH-LIMITS.
 10981
 10982     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 10983        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 10984        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10985                                 > PL-LM-AMT (SUB2))
 10986        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10987           AND (PB-I-SIG-SW = 'Y')
 10988           CONTINUE
 10989        ELSE
 10990           MOVE ER-2638          TO WS-ERROR
 10991           PERFORM 9900-ERROR-FORMAT
 10992                                 THRU 9900-EXIT
 10993        END-IF
 10994     END-IF
 10995
 10996     IF  PB-COMPANY-ID   EQUAL    'CRI'
 10997         IF  WS-ERROR    EQUAL    ER-2638
 10998             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 10999                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11000                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11001                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11002                MOVE  ER-1910    TO  WS-ERROR
 11003                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11004
 11005     IF PB-COMPANY-ID = 'CRI'
 11006        IF WS-ERROR = ER-2638
 11007            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11008            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11009            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11010
 11011     GO TO 3000-CONTINUE-EDIT.
 11012
 11013 0597-CHECK-NCL-AH-LIMITS.
 11014
 11015     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11016        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 201
* EL050.cbl
 11017        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11018                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11019         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11020
 11021     IF APP-CERT-USED
 11022         IF SUB2  LESS THAN  +5
 11023             MOVE +5             TO SUB2
 11024             GO TO 0597-CHECK-AH-LIMITS.
 11025
 11026     MOVE ER-2638                TO WS-ERROR.
 11027     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11028
 11029     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11030
 11031 0599-CHECK-NCL-SIG-SWITCH.
 11032
 11033     IF NOT APP-CERT-USED
 11034         GO TO 3000-CONTINUE-EDIT.
 11035
 11036     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11037        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11038        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11039        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11040         GO TO 3000-CONTINUE-EDIT.
 11041
 11042     IF SUB2 GREATER THAN +4
 11043         IF PL-LM-AGE (5) = ZEROS  AND
 11044            PL-LM-AGE (6) = ZEROS  AND
 11045            PL-LM-AGE (7) = ZEROS  AND
 11046            PL-LM-AGE (8) = ZEROS
 11047             MOVE  ER-1927        TO WS-ERROR
 11048             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11049             GO TO 3000-CONTINUE-EDIT
 11050         ELSE
 11051             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11052                 MOVE  ER-1920    TO WS-ERROR
 11053                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11054
 11055     IF PB-I-SIG-SW  = 'Y'
 11056       IF NOT PB-I-POLICY-ACCEPTED  AND
 11057          NOT PB-I-POLICY-DECLINED
 11058           MOVE 'U'               TO PB-BATCH-ENTRY
 11059           MOVE  ER-1926          TO WS-ERROR
 11060           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11061
 11062******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 202
* EL050.cbl
 11064
 11065 3000-CONTINUE-EDIT.
 11066
 11067     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11068     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11069     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11070     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11071     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11072
 11073     IF BROWSE-STARTED
 11074        PERFORM 9990-RETURN THRU 9990-EXIT
 11075        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11076
 11077     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11078        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11079        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11080        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11081*       MOVE 1                   TO DC-OPTION-CODE
 11082        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11083        IF DATE-CONVERSION-ERROR
 11084           MOVE ER-2622          TO WS-ERROR
 11085           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11086        ELSE
 11087           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11088              MOVE ER-2623       TO WS-ERROR
 11089              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11090           ELSE
 11091              MOVE ER-2622       TO WS-ERROR
 11092              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11093
 11094     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11095     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11096     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11097*    MOVE 1                      TO DC-OPTION-CODE.
 11098     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11099     IF DATE-CONVERSION-ERROR
 11100        GO TO 3005-EDIT-CONTINUE
 11101     ELSE
 11102        IF DC-ELAPSED-DAYS GREATER +180
 11103           MOVE ER-2613          TO WS-ERROR
 11104           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11105        ELSE
 11106           IF DC-ELAPSED-DAYS GREATER +90
 11107              MOVE ER-2612       TO WS-ERROR
 11108              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11109           ELSE
 11110             IF DC-ELAPSED-DAYS GREATER +60
 11111                MOVE ER-2614     TO WS-ERROR
 11112                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11113
 11114 3005-EDIT-CONTINUE.
 11115
 11116     IF PB-CANCELLATION
 11117         GO TO 3700-EDIT-CANCEL.
 11118
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 203
* EL050.cbl
 11120******************************************************************
 11121*                  E D I T   I S S U E                           *
 11122******************************************************************
 11123
 11124 3020-EDIT-ISSUE.
 11125
 11126      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11127      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11128      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11129      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11130      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11131
 11132     IF PB-ISSUE-FORCE
 11133        OR PB-ISSUE-DATE-FORCED
 11134        OR PB-FORCE-OFF
 11135        OR PB-OVERCHARGE-FORCE
 11136        CONTINUE
 11137     ELSE
 11138        MOVE ER-2670             TO WS-ERROR
 11139        PERFORM 9900-ERROR-FORMAT
 11140                                 THRU 9900-EXIT
 11141     END-IF
 11142     .
 11143 3022-SET-POLICY-STATUS.
 11144
 11145     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11146
 11147     IF (PB-REISSUED-CERT)
 11148             OR
 11149        ((PB-COMPANY-ID NOT = 'DCC')
 11150         AND (PB-MONTHLY-CERT))
 11151         MOVE '5'                TO PB-I-ENTRY-STATUS
 11152         MOVE 'E'                TO PB-BATCH-ENTRY
 11153     END-IF
 11154
 11155     IF PB-COMPANY-ID = 'DCC'
 11156        IF PB-MONTHLY-CERT
 11157           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11158        END-IF
 11159     END-IF
 11160     IF PB-POLICY-IS-DECLINED
 11161         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11162     IF PB-POLICY-IS-VOIDED
 11163         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11164     IF PB-NEEDS-UNDERWRITING
 11165         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11166     IF PB-REIN-ONLY-CERT
 11167         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11168     IF PB-PREM-ACCTNG-ONLY
 11169         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11170
 11171     MOVE SPACE                  TO PB-I-OB-FLAG.
 11172
 11173     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11174         MOVE ER-2665            TO WS-ERROR
 11175         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11176         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11177
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 204
* EL050.cbl
 11178     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11179        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11180           MOVE 'Z'             TO PB-I-OB-FLAG.
 11181
 11182     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11183        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11184           MOVE 'Z'             TO PB-I-OB-FLAG.
 11185
 11186     IF ACCOUNT-MAST-FOUND
 11187         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11188         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11189         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11190         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11191         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11192         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11193         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11194     END-IF
 11195
 11196     IF ACCOUNT-MAST-FOUND
 11197        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11198         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11199
 11200     IF (ACCOUNT-MAST-FOUND)
 11201        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11202        IF PB-REISSUED-CERT
 11203           CONTINUE
 11204        ELSE
 11205           MOVE ER-2608          TO WS-ERROR
 11206           PERFORM 9900-ERROR-FORMAT
 11207                                 THRU 9900-EXIT
 11208         END-IF
 11209     END-IF
 11210
 11211     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11212        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11213        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11214
 11215**********   DMD CUSTOM CODE FOLLOWS  **********
 11216 3024-EDIT-DMD-FIELDS.
 11217     IF PB-COMPANY-ID NOT = 'DMD'
 11218        GO TO 3025-EDIT-REINSURANCE.
 11219
 11220*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11221*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11222*** ERROR IF THEY ARE NOT EQUAL.
 11223
 11224     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11225     SET BIN-TO-GREG               TO TRUE.
 11226     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11227     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11228**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11229
 11230     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11231     SET BIN-TO-GREG               TO TRUE.
 11232     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11233     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11234**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11235
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 205
* EL050.cbl
 11236     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11237        MOVE ER-8116               TO WS-ERROR
 11238        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11239
 11240     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11241
 11242     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11243                                      WK-FULL-CERT-NO.
 11244     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11245
 11246     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11247
 11248     IF PB-VALID-LIFE
 11249        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11250     ELSE
 11251        IF PB-VALID-AH
 11252          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11253
 11254
 11255     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11256     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11257     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11258                                      DCUA-UNDRWRTR-CODE
 11259                                      DCUA-UNDRWRTR-GROUP-CODE
 11260                                      DCUA-RETURN-CODE.
 11261
 11262****************************************************************
 11263*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11264***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11265***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11266***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11267***   TO THIS RECORD.                                        ***
 11268****************************************************************
 11269     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11270     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11271     IF DCUA-SUCCESSFUL-PROCESS
 11272        GO TO 3024-EDIT-DL7-CONT.
 11273
 11274     IF DCUA-RETURN-CODE EQUAL '01'
 11275        MOVE ER-8110               TO WS-ERROR
 11276        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11277        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11278        GO TO 3024-EDIT-DL7-CONT.
 11279
 11280     IF DCUA-RETURN-CODE EQUAL '02'
 11281        MOVE ER-8111               TO WS-ERROR
 11282        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11283        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11284        GO TO 3024-EDIT-DL7-CONT.
 11285
 11286     IF DCUA-RETURN-CODE EQUAL '03'
 11287        MOVE ER-8074               TO WS-ERROR
 11288        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11289        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11290        GO TO 3024-EDIT-DL7-CONT.
 11291
 11292     IF DCUA-RETURN-CODE EQUAL '04'
 11293        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 206
* EL050.cbl
 11294        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11295        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11296        GO TO 3024-EDIT-DL7-CONT.
 11297
 11298     IF DCUA-RETURN-CODE EQUAL '05'
 11299        MOVE ER-8076               TO WS-ERROR
 11300        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11301        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11302        GO TO 3024-EDIT-DL7-CONT.
 11303
 11304     IF DCUA-RETURN-CODE EQUAL '06'
 11305        MOVE ER-8077               TO WS-ERROR
 11306        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11307        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11308        GO TO 3024-EDIT-DL7-CONT.
 11309
 11310     IF DCUA-RETURN-CODE EQUAL '07'
 11311        MOVE ER-8078               TO WS-ERROR
 11312        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11313        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11314        GO TO 3024-EDIT-DL7-CONT.
 11315
 11316     IF DCUA-RETURN-CODE EQUAL 'E1'
 11317        MOVE ER-8079               TO WS-ERROR
 11318        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11319        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11320        GO TO 3024-EDIT-DL7-CONT.
 11321
 11322     IF DCUA-RETURN-CODE EQUAL 'E2'
 11323        MOVE ER-8080               TO WS-ERROR
 11324        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11325        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11326        GO TO 3024-EDIT-DL7-CONT.
 11327
 11328     IF DCUA-RETURN-CODE EQUAL 'E3'
 11329        MOVE ER-8098               TO WS-ERROR
 11330        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11331        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11332        GO TO 3024-EDIT-DL7-CONT.
 11333
 11334     IF DCUA-RETURN-CODE EQUAL 'C1'
 11335        MOVE ER-8099               TO WS-ERROR
 11336        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11337        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11338        GO TO 3024-EDIT-DL7-CONT.
 11339
 11340     IF DCUA-RETURN-CODE EQUAL 'U1'
 11341        MOVE ER-8109               TO WS-ERROR
 11342        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11343        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11344        GO TO 3024-EDIT-DL7-CONT.
 11345
 11346     IF DCUA-RETURN-CODE EQUAL 'N1'
 11347        MOVE ER-8112               TO WS-ERROR
 11348        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11349        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11350        GO TO 3024-EDIT-DL7-CONT.
 11351
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 207
* EL050.cbl
 11352     IF DCUA-RETURN-CODE EQUAL 'N2'
 11353        MOVE ER-8113               TO WS-ERROR
 11354        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11355        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11356        GO TO 3024-EDIT-DL7-CONT.
 11357
 11358     IF DCUA-RETURN-CODE EQUAL 'N3'
 11359        MOVE ER-8114               TO WS-ERROR
 11360        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11361        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11362        GO TO 3024-EDIT-DL7-CONT.
 11363
 11364     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11365     MOVE ER-8097                  TO WS-ERROR.
 11366     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11367     GO TO 3024-EDIT-DL7-CONT.
 11368
 11369 3024-EDIT-DL7-CONT.
 11370
 11371     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11372     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11373     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11374        NEXT SENTENCE
 11375     ELSE
 11376        MOVE ER-9263               TO WS-ERROR
 11377        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11378
 11379******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11380******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11381     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11382        NEXT SENTENCE
 11383     ELSE
 11384        MOVE ER-8039               TO WS-ERROR
 11385        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11386
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 208
* EL050.cbl
 11388****************************************************************
 11389*** VALIDATE STATE  : DLO022                                 ***
 11390****************************************************************
 11391     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11392     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11393
 11394     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11395     IF DVSC-SUCCESSFUL-EDIT
 11396        GO TO 3024-EDIT-DL22-CONT.
 11397
 11398     IF DVSC-RETURN-CODE EQUAL '01'
 11399        MOVE ER-8300               TO WS-ERROR
 11400        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11401        GO TO 3024-EDIT-DL22-CONT.
 11402
 11403     IF DVSC-RETURN-CODE EQUAL '02'
 11404        MOVE ER-8301               TO WS-ERROR
 11405        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11406        GO TO 3024-EDIT-DL22-CONT.
 11407
 11408     IF DVSC-RETURN-CODE EQUAL '03'
 11409        MOVE ER-8302               TO WS-ERROR
 11410        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11411        GO TO 3024-EDIT-DL22-CONT.
 11412
 11413     IF DVSC-RETURN-CODE EQUAL 'N1'
 11414        MOVE ER-8304               TO WS-ERROR
 11415        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11416        GO TO 3024-EDIT-DL22-CONT.
 11417
 11418     MOVE ER-8303                  TO WS-ERROR
 11419     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11420
 11421 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 209
* EL050.cbl
 11423****************************************************************
 11424*** VALIDATE LOAN OFFICER : DLO021                           ***
 11425****************************************************************
 11426
 11427     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11428     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11429     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11430     IF DVLO-SUCCESSFUL-EDIT
 11431        GO TO 3024-EDIT-DL21-CONT.
 11432
 11433     IF DVLO-RETURN-CODE EQUAL '01'
 11434        MOVE ER-8081               TO WS-ERROR
 11435        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11436        GO TO 3024-EDIT-DL21-CONT.
 11437
 11438     IF DVLO-RETURN-CODE EQUAL '02'
 11439        MOVE ER-8082               TO WS-ERROR
 11440        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11441        GO TO 3024-EDIT-DL21-CONT.
 11442
 11443     IF DVLO-RETURN-CODE EQUAL '03'
 11444        MOVE ER-8083               TO WS-ERROR
 11445        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11446        GO TO 3024-EDIT-DL21-CONT.
 11447
 11448     IF DVLO-RETURN-CODE EQUAL '04'
 11449        MOVE ER-8084               TO WS-ERROR
 11450        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11451        GO TO 3024-EDIT-DL21-CONT.
 11452
 11453     IF DVLO-RETURN-CODE EQUAL '05'
 11454        MOVE ER-8085               TO WS-ERROR
 11455        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11456        GO TO 3024-EDIT-DL21-CONT.
 11457
 11458     MOVE ER-7825                  TO WS-ERROR
 11459     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11460     GO TO 3024-EDIT-DL21-CONT.
 11461
 11462 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 210
* EL050.cbl
 11464
 11465****************************************************************
 11466*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11467****************************************************************
 11468
 11469     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11470     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11471     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11472     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11473     IF DIPF-SUCCESSFUL-EDIT
 11474        GO TO 3024-EDIT-DL02-CONT.
 11475
 11476     IF DIPF-RETURN-CODE EQUAL '01'
 11477        MOVE ER-8086               TO WS-ERROR
 11478        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11479        GO TO 3024-EDIT-DL02-CONT.
 11480
 11481     IF DIPF-RETURN-CODE EQUAL '02'
 11482        MOVE ER-8087               TO WS-ERROR
 11483        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11484        GO TO 3024-EDIT-DL02-CONT.
 11485
 11486     IF DIPF-RETURN-CODE EQUAL '03'
 11487        MOVE ER-8088               TO WS-ERROR
 11488        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11489        GO TO 3024-EDIT-DL02-CONT.
 11490
 11491     MOVE ER-8095                  TO WS-ERROR
 11492     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11493     GO TO 3024-EDIT-DL02-CONT.
 11494
 11495 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 211
* EL050.cbl
 11497
 11498****************************************************************
 11499*** VALIDATE BANK ID : DLO003                                ***
 11500****************************************************************
 11501
 11502     MOVE WK-GREG-CENT           TO WCG-CENT.
 11503     MOVE WK-GREG-YYMM           TO WCG-REST.
 11504     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11505        MOVE ER-8040               TO WS-ERROR
 11506        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11507
 11508     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11509     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11510     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11511     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11512     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11513     IF DVBI-SUCCESSFUL-EDIT
 11514        GO TO 3024-EDIT-DL03-CONT.
 11515
 11516     IF DVBI-RETURN-CODE EQUAL '01'
 11517        MOVE ER-8089               TO WS-ERROR
 11518        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11519        GO TO 3024-EDIT-DL03-CONT.
 11520
 11521     IF DVBI-RETURN-CODE EQUAL '02'
 11522        MOVE ER-8090               TO WS-ERROR
 11523        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11524        GO TO 3024-EDIT-DL03-CONT.
 11525
 11526     IF DVBI-RETURN-CODE EQUAL '03'
 11527        MOVE ER-8091               TO WS-ERROR
 11528        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11529        GO TO 3024-EDIT-DL03-CONT.
 11530
 11531     IF DVBI-RETURN-CODE EQUAL '04'
 11532        MOVE ER-8092               TO WS-ERROR
 11533        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11534        GO TO 3024-EDIT-DL03-CONT.
 11535
 11536     IF DVBI-RETURN-CODE EQUAL '05'
 11537        MOVE ER-8093               TO WS-ERROR
 11538        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11539        GO TO 3024-EDIT-DL03-CONT.
 11540
 11541     IF DVBI-RETURN-CODE EQUAL '06'
 11542        MOVE ER-8094               TO WS-ERROR
 11543        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11544        GO TO 3024-EDIT-DL03-CONT.
 11545
 11546     MOVE ER-8096                  TO WS-ERROR
 11547     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11548     GO TO 3024-EDIT-DL03-CONT.
 11549
 11550 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 212
* EL050.cbl
 11552
 11553     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11554        NEXT SENTENCE
 11555     ELSE
 11556        MOVE ER-8042               TO WS-ERROR
 11557        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11558
 11559     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11560     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11561     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11562
 11563     IF DMPF-RETURN-CODE = '01'
 11564        MOVE ER-8067               TO WS-ERROR
 11565        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11566        GO TO 3024-EDIT-DL01-CONT.
 11567
 11568     IF DMPF-RETURN-CODE = '02'
 11569        MOVE ER-8068               TO WS-ERROR
 11570        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11571        GO TO 3024-EDIT-DL01-CONT.
 11572
 11573     IF DMPF-RETURN-CODE = '03'
 11574        MOVE ER-8069               TO WS-ERROR
 11575        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11576        GO TO 3024-EDIT-DL01-CONT.
 11577
 11578     IF DMPF-RETURN-CODE = 'E1'
 11579        MOVE ER-8070               TO WS-ERROR
 11580        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11581        GO TO 3024-EDIT-DL01-CONT.
 11582
 11583     IF DMPF-RETURN-CODE = 'N1'
 11584        MOVE ER-8071               TO WS-ERROR
 11585        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11586        GO TO 3024-EDIT-DL01-CONT.
 11587
 11588     IF DMPF-RETURN-CODE NOT = 'OK'
 11589        MOVE ER-8072               TO WS-ERROR
 11590        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11591
 11592 3024-EDIT-DL01-CONT.
 11593******************************************************************
 11594***  VALIDATES RATE CODES : DLO017                             ***
 11595******************************************************************
 11596
 11597      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11598      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11599      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11600      IF DVRC-SUCCESSFUL-EDIT
 11601        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11602        GO TO 3024-CHECK-VALID-RATE.
 11603
 11604      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11605
 11606      IF DVRC-RETURN-CODE EQUAL '01'
 11607         MOVE ER-7817                   TO WS-ERROR
 11608         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11609         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 213
* EL050.cbl
 11610
 11611      IF DVRC-RETURN-CODE EQUAL '02'
 11612         MOVE ER-7818                   TO WS-ERROR
 11613         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11614         GO TO 3025-EDIT-REINSURANCE.
 11615
 11616      IF DVRC-RETURN-CODE EQUAL '03'
 11617         MOVE ER-7819                   TO WS-ERROR
 11618         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11619         GO TO 3025-EDIT-REINSURANCE.
 11620
 11621       MOVE ER-7820                     TO WS-ERROR.
 11622       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11623       GO TO 3025-EDIT-REINSURANCE.
 11624
 11625******************************************************************
 11626***  GET PREMIUM RATES : DLO011                                ***
 11627******************************************************************
 11628
 11629 3024-CHECK-VALID-RATE.
 11630
 11631     IF VALID-RATE-CODE
 11632        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11633        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11634        MOVE SPACES                TO DPRB-RETURN-CODE
 11635        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11636     ELSE
 11637         GO TO 3025-EDIT-REINSURANCE.
 11638
 11639      IF DPRB-SUCCESSFUL-PROCESS
 11640         IF PB-VALID-LIFE
 11641             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11642             GO TO 3025-EDIT-REINSURANCE
 11643         ELSE
 11644             IF PB-VALID-AH
 11645                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11646                 GO TO 3025-EDIT-REINSURANCE.
 11647
 11648      IF DPRB-RETURN-CODE EQUAL '01'
 11649         MOVE ER-7812                   TO WS-ERROR
 11650         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11651         GO TO 3025-EDIT-REINSURANCE.
 11652
 11653      IF DPRB-RETURN-CODE EQUAL '02'
 11654         MOVE ER-7813                   TO WS-ERROR
 11655         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11656         GO TO 3025-EDIT-REINSURANCE.
 11657
 11658      IF DPRB-RETURN-CODE EQUAL '03'
 11659         MOVE ER-7814                   TO WS-ERROR
 11660         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11661         GO TO 3025-EDIT-REINSURANCE.
 11662
 11663      IF DPRB-RETURN-CODE EQUAL '04'
 11664         IF NOT DPRB-1ST-TIME
 11665            MOVE ER-7815                   TO WS-ERROR
 11666            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11667            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 214
* EL050.cbl
 11668          ELSE
 11669         IF PB-VALID-LIFE
 11670            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11671          ELSE
 11672            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11673         END-IF
 11674         MOVE SPACES                TO DOCC-RETURN-CODE
 11675         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11676         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11677         IF DOCC-RETURN-CODE = 'OK'
 11678             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11679             GO TO 3024-CHECK-VALID-RATE
 11680           ELSE
 11681             MOVE ER-7823               TO WS-ERROR
 11682             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11683             GO TO 3025-EDIT-REINSURANCE.
 11684
 11685       MOVE ER-7816                     TO WS-ERROR.
 11686       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11687       GO TO 3025-EDIT-REINSURANCE.
 11688
 11689**********   DMD CUSTOM CODE ABOVE    **********
 11690
 11691 3025-EDIT-REINSURANCE.
 11692     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11693         GO TO 3027-EDIT-CONTINUE.
 11694
 11695     MOVE LOW-VALUES               TO ERREIN-KEY.
 11696     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11697     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11698                                      REIN-CODE-2
 11699                                      REIN-CODE-3.
 11700     MOVE 'A'                      TO REIN-TYPE.
 11701
 11702     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11703
 11704     MOVE '3026' TO REIN-SW.
 11705     MOVE ' '                   TO WS-REIN-READ-SW.
 11706
 11707     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11708     IF REIN-TABLE-NOT-FOUND
 11709         GO TO 3026-NO-SPEC-TABLE.
 11710
 11711     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11712     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11713                                   WS-NSP-ST-CD-LF.
 11714     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11715                                   WS-NSP-ST-CD-AH.
 11716
 11717     GO TO 3040-EDIT-CONTINUE.
 11718
 11719 3026-NO-SPEC-TABLE.
 11720
 11721     MOVE ER-2664                TO WS-ERROR.
 11722     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11723     GO TO 3040-EDIT-CONTINUE.
 11724
 11725 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 215
* EL050.cbl
 11726
 11727     IF PB-I-REIN-TABLE = SPACES
 11728       GO TO 3040-EDIT-CONTINUE.
 11729
 11730     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11731          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11732          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11733           GO TO 3040-EDIT-CONTINUE.
 11734
 11735     MOVE LOW-VALUES            TO ERREIN-KEY.
 11736     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11737     MOVE 'A'                   TO REIN-TYPE.
 11738     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11739
 11740     MOVE '3028'                TO REIN-SW.
 11741     MOVE ' '                   TO WS-REIN-READ-SW.
 11742
 11743     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11744     IF REIN-TABLE-NOT-FOUND
 11745         GO TO 3028-NO-REIN-TABLE.
 11746
 11747     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11748     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11749                                   WS-NSP-ST-CD-LF.
 11750     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11751                                   WS-NSP-ST-CD-AH.
 11752
 11753     GO TO 3040-EDIT-CONTINUE.
 11754
 11755 3028-NO-REIN-TABLE.
 11756
 11757     MOVE ER-2615                TO WS-ERROR.
 11758     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11759     GO TO 3040-EDIT-CONTINUE.
 11760
 11761 3040-EDIT-CONTINUE.
 11762
 11763     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11764         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11765
 11766     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11767         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11768
 11769     IF (NOT PB-REISSUED-CERT)
 11770        AND (NOT PB-MONTHLY-CERT)
 11771        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11772            MOVE '001'           TO PB-I-LF-TERM
 11773            MOVE 'M'             TO PB-I-INSURED-SEX.
 11774
 11775     IF (NOT PB-REISSUED-CERT)
 11776        AND (NOT PB-MONTHLY-CERT)
 11777        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11778            MOVE '001'           TO PB-I-AH-TERM
 11779            MOVE 'M'             TO PB-I-INSURED-SEX.
 11780
 11781 3040-EDIT-1ST-PMT-DT.
 11782     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11783     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 216
* EL050.cbl
 11784         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11785
 11786******************************************************************
 11787*                                                                *
 11788*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11789*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11790*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11791*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11792*                                                                *
 11793******************************************************************
 11794
 11795     IF PB-EFF-DT-PROCESSING
 11796        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11797                                    PB-I-LF-EXPIRE-DT
 11798                                    PB-I-AH-EXPIRE-DT
 11799        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11800        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11801        MOVE ZERO                TO DC-ELAPSED-DAYS
 11802        MOVE +1                  TO DC-ELAPSED-MONTHS
 11803        SET BIN-PLUS-ELAPSED     TO TRUE
 11804*       MOVE 6                   TO DC-OPTION-CODE
 11805        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11806        IF NO-CONVERSION-ERROR
 11807           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11808
 11809******************************************************************
 11810*                                                                *
 11811*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11812*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11813*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11814*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11815*                                                                *
 11816******************************************************************
 11817
 11818     IF PB-EXT-DAYS-PROCESSING
 11819          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11820                                         PB-I-LF-EXPIRE-DT
 11821                                         PB-I-AH-EXPIRE-DT
 11822          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11823          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11824          MOVE +1                     TO DC-ELAPSED-MONTHS
 11825          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11826          SET BIN-PLUS-ELAPSED        TO TRUE
 11827*         MOVE 6                      TO DC-OPTION-CODE
 11828          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11829          IF NO-CONVERSION-ERROR
 11830             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11831
 11832******************************************************************
 11833*                                                                *
 11834*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11835*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11836*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11837*        (EXPIRE DATE - (TERM -1))  *  -1.
 11838*                                                                *
 11839******************************************************************
 11840
 11841     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 217
* EL050.cbl
 11842        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11843           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11844              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11845              MOVE PB-I-AH-TERM      TO WS-TERM
 11846           ELSE
 11847              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11848              MOVE PB-I-LF-TERM      TO WS-TERM
 11849        ELSE
 11850           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11851              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11852              MOVE PB-I-LF-TERM      TO WS-TERM
 11853           ELSE
 11854              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11855              MOVE PB-I-AH-TERM      TO WS-TERM.
 11856
 11857     IF PB-EXPIRE-DT-PROCESSING
 11858        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11859        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11860        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11861        MOVE ZERO                TO DC-ELAPSED-DAYS
 11862                                    DC-ODD-DAYS-OVER
 11863          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11864          SET BIN-PLUS-ELAPSED    TO TRUE
 11865*         MOVE 6                  TO DC-OPTION-CODE
 11866          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11867          IF NO-CONVERSION-ERROR
 11868             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11869
 11870******************************************************************
 11871*                                                                *
 11872*            1ST PAYMENT DATE PROCESSING                         *
 11873*                                                                *
 11874******************************************************************
 11875
 11876     IF PB-1ST-PMT-DT-PROCESSING
 11877        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11878                                    PB-I-AH-EXPIRE-DT
 11879        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11880
 11881     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11882         NEXT SENTENCE
 11883     ELSE
 11884         MOVE ER-2680                 TO WS-ERROR
 11885         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11886         GO TO 3060-ORIG-TERM-CHECK.
 11887
 11888     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11889     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11890     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11891*    MOVE 1                      TO DC-OPTION-CODE.
 11892     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11893                                    DC-ELAPSED-DAYS
 11894                                    DC-ODD-DAYS-OVER.
 11895
 11896     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11897
 11898     IF DATE-CONVERSION-ERROR
 11899        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 218
* EL050.cbl
 11900
 11901     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11902     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 11903        AND (WS-LF-COVERAGE-TYPE = 'L')
 11904        IF (DC-ELAPSED-MONTHS > 1)
 11905                      OR
 11906           ((DC-ELAPSED-MONTHS = 1)
 11907           AND (DC-ODD-DAYS-OVER > 0))
 11908           MOVE ER-2882          TO WS-ERROR
 11909           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11910        END-IF
 11911     END-IF
 11912     IF PB-EXT-DAYS-PROCESSING
 11913        CONTINUE
 11914     ELSE
 11915        IF DC-ELAPSED-MONTHS = +0
 11916           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 11917        ELSE
 11918           IF (WS-LF-EARNINGS-CALC = '4')
 11919              AND (DC-ELAPSED-MONTHS > ZERO)
 11920              AND (DC-ELAPSED-DAYS > ZERO)
 11921              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 11922           ELSE
 11923              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 11924                                 THRU 6499-EXIT
 11925              MOVE WS-ODD-DAYS-OVER
 11926                                 TO PB-I-EXTENTION-DAYS
 11927           END-IF
 11928        END-IF
 11929     END-IF
 11930******************************************************************
 11931*                                                                *
 11932*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 11933*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 11934*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 11935*            AND ANY ODD DAYS.                                   *
 11936*                                                                *
 11937******************************************************************
 11938
 11939     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 11940                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 11941     IF WS-LF-EARNINGS-CALC NOT = '4'
 11942        IF DC-ELAPSED-DAYS > ZEROS
 11943           MOVE ER-2681          TO WS-ERROR
 11944           PERFORM 9900-ERROR-FORMAT
 11945                                 THRU 9900-EXIT
 11946        END-IF
 11947     END-IF
 11948
 11949     IF WS-LF-EARNINGS-CALC NOT = '4'
 11950        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 11951           MOVE ER-2681          TO WS-ERROR
 11952           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11953
 11954     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 11955        (PB-I-LF-TERM NOT = ZERO) AND
 11956         NOT NO-LIFE-COVERAGE
 11957          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 219
* EL050.cbl
 11958          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 11959          IF WS-LF-EARNINGS-CALC = '4'
 11960             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 11961             PB-I-PAY-FREQUENCY
 11962          END-IF
 11963          MOVE ZERO              TO DC-ELAPSED-DAYS
 11964                                    DC-ODD-DAYS-OVER
 11965          MOVE 1                 TO DC-END-OF-MONTH
 11966          SET BIN-PLUS-ELAPSED        TO TRUE
 11967*         MOVE 6                 TO DC-OPTION-CODE
 11968          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11969          IF NO-CONVERSION-ERROR
 11970             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 11971             IF (WS-LF-EARNINGS-CALC = 'B') AND
 11972                (WS-LF-SPECIAL-CALC-CD = 'L')
 11973                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 11974                  MOVE ZERO           TO DC-ELAPSED-DAYS
 11975                  MOVE +1             TO DC-ELAPSED-MONTHS
 11976                  SET BIN-PLUS-ELAPSED  TO TRUE
 11977*                 MOVE 6              TO DC-OPTION-CODE
 11978                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11979                  IF NO-CONVERSION-ERROR
 11980                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 11981
 11982* okay, i had to move the new att age edit down here because the
 11983* expiration date could get recalculated and i need the exp date
 11984     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 11985        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 11986        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 11987        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11988           AND ZEROS
 11989           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11990           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11991           SET ELAPSED-BETWEEN-BIN TO TRUE
 11992           PERFORM 8500-DATE-CONVERT
 11993                                 THRU 8500-EXIT
 11994           IF NO-CONVERSION-ERROR
 11995              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11996                 MOVE ER-2669       TO WS-ERROR
 11997*                PERFORM 9900-ERROR-FORMAT
 11998*                                THRU 9900-EXIT
 11999              END-IF
 12000           END-IF
 12001        ELSE
 12002           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12003           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12004              MOVE ER-2669       TO WS-ERROR
 12005*             PERFORM 9900-ERROR-FORMAT
 12006*                                THRU 9900-EXIT
 12007           ELSE
 12008              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12009                 MOVE ER-1570    TO WS-ERROR
 12010                 PERFORM 9900-ERROR-FORMAT
 12011                                 THRU 9900-EXIT
 12012              END-IF
 12013           END-IF
 12014        END-IF
 12015        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 220
* EL050.cbl
 12016           AND ZEROS
 12017           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12018           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12019           SET ELAPSED-BETWEEN-BIN TO TRUE
 12020           PERFORM 8500-DATE-CONVERT
 12021                                 THRU 8500-EXIT
 12022           IF NO-CONVERSION-ERROR
 12023              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12024                 MOVE ER-2669       TO WS-ERROR
 12025*                PERFORM 9900-ERROR-FORMAT
 12026*                                THRU 9900-EXIT
 12027              END-IF
 12028           END-IF
 12029        ELSE
 12030           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12031             (PB-I-LF-TERM / 12)
 12032           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12033              MOVE ER-2669       TO WS-ERROR
 12034*             PERFORM 9900-ERROR-FORMAT
 12035*                                THRU 9900-EXIT
 12036           ELSE
 12037              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12038                 MOVE ER-1571    TO WS-ERROR
 12039                 PERFORM 9900-ERROR-FORMAT
 12040                                 THRU 9900-EXIT
 12041              END-IF
 12042           END-IF
 12043        END-IF
 12044        IF WS-ERROR = ER-2669
 12045           PERFORM 9900-ERROR-FORMAT
 12046                                 THRU 9900-EXIT
 12047        END-IF
 12048     END-IF
 12049     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12050        (PB-I-AH-TERM NOT = ZERO) AND
 12051         NOT NO-AH-COVERAGE
 12052          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12053             AND (PB-COMPANY-ID = 'DCC')
 12054             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12055             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12056          ELSE
 12057             IF WS-LF-EARNINGS-CALC = '4'
 12058                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12059                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12060                PB-I-PAY-FREQUENCY
 12061             ELSE
 12062                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12063                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12064             END-IF
 12065          END-IF
 12066          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12067                                         DC-ODD-DAYS-OVER
 12068          MOVE 1                      TO DC-END-OF-MONTH
 12069          SET BIN-PLUS-ELAPSED        TO TRUE
 12070*         MOVE 6                      TO DC-OPTION-CODE
 12071          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12072          IF NO-CONVERSION-ERROR
 12073             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 221
* EL050.cbl
 12074     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12075        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12076        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12077        IF PB-I-BIRTHDAY > LOW-VALUES
 12078           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12079           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12080           SET ELAPSED-BETWEEN-BIN TO TRUE
 12081           PERFORM 8500-DATE-CONVERT
 12082                                 THRU 8500-EXIT
 12083           IF NO-CONVERSION-ERROR
 12084              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12085                 MOVE ER-3054       TO WS-ERROR
 12086*                PERFORM 9900-ERROR-FORMAT
 12087*                                THRU 9900-EXIT
 12088              END-IF
 12089           END-IF
 12090        ELSE
 12091           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12092           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12093              MOVE ER-3054       TO WS-ERROR
 12094*             PERFORM 9900-ERROR-FORMAT
 12095*                                THRU 9900-EXIT
 12096           END-IF
 12097        END-IF
 12098        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12099           AND ZEROS
 12100           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12101           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12102           SET ELAPSED-BETWEEN-BIN TO TRUE
 12103           PERFORM 8500-DATE-CONVERT
 12104                                 THRU 8500-EXIT
 12105           IF NO-CONVERSION-ERROR
 12106              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12107                 MOVE ER-3054       TO WS-ERROR
 12108*                PERFORM 9900-ERROR-FORMAT
 12109*                                THRU 9900-EXIT
 12110              END-IF
 12111           END-IF
 12112        ELSE
 12113           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12114             (PB-I-AH-TERM / 12)
 12115           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12116              MOVE ER-3054       TO WS-ERROR
 12117*             PERFORM 9900-ERROR-FORMAT
 12118*                                THRU 9900-EXIT
 12119           END-IF
 12120        END-IF
 12121        IF WS-ERROR = ER-3054
 12122           PERFORM 9900-ERROR-FORMAT
 12123                                 THRU 9900-EXIT
 12124        END-IF
 12125     END-IF
 12126     MOVE SPACE                       TO DC-END-OF-MONTH.
 12127
 12128     IF PB-COMPANY-ID = 'NCB'
 12129        GO TO 3040-EDIT-EXTENSION-DAYS.
 12130
 12131     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 222
* EL050.cbl
 12132       AND
 12133        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12134        NEXT SENTENCE
 12135     ELSE
 12136        GO TO 3040-EDIT-EXTENSION-DAYS.
 12137
 12138     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12139        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12140        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12141     ELSE
 12142        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12143        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12144
 12145     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12146*    MOVE '1'      TO DC-OPTION-CODE
 12147     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12148     IF (NO-CONVERSION-ERROR)
 12149        AND (DC-ELAPSED-MONTHS > +1)
 12150        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12151        MOVE ER-2668   TO WS-ERROR
 12152        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12153
 12154 3040-EDIT-EXTENSION-DAYS.
 12155
 12156     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12157        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12158         GO TO 3050-EDIT-TERM-IN-DAYS
 12159     ELSE
 12160         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12161
 12162     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12163         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12164     ELSE
 12165        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12166           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12167           MOVE ER-2681         TO WS-ERROR
 12168           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12169
 12170     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12171        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12172        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12173         GO TO 3060-ORIG-TERM-CHECK.
 12174
 12175     GO TO 3060-ORIG-TERM-CHECK.
 12176
 12177 3050-EDIT-TERM-IN-DAYS.
 12178
 12179     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12180
 12181     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12182         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12183     ELSE
 12184         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12185            MOVE ER-2682         TO WS-ERROR
 12186            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12187
 12188     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12189                                       REMAINDER WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 223
* EL050.cbl
 12190     IF WS-WORK-TERM GREATER THAN ZERO
 12191         ADD +1 TO PB-I-LF-TERM.
 12192
 12193     IF NOT NO-AH-COVERAGE
 12194         MOVE ER-2684            TO WS-ERROR
 12195         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12196
 12197
 12198 3060-ORIG-TERM-CHECK.
 12199
 12200******************************************************************
 12201*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12202******************************************************************
 12203
 12204     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12205        NEXT SENTENCE
 12206     ELSE
 12207        IF NOT NO-LIFE-COVERAGE
 12208           IF PB-I-LF-TERM NUMERIC
 12209              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12210              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12211              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12212                  NEXT SENTENCE
 12213           ELSE
 12214              MOVE ER-2647       TO WS-ERROR
 12215              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12216
 12217     IF NOT NO-AH-COVERAGE
 12218         IF PB-I-AH-TERM NUMERIC
 12219            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12220            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12221            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12222             NEXT SENTENCE
 12223          ELSE
 12224              MOVE ER-2658       TO WS-ERROR
 12225              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12226
 12227     IF PB-COMPANY-ID = 'NCB'
 12228        GO TO 3070-LOAN-TERM-CHECK.
 12229
 12230     IF POLICY-HAS-AH
 12231       AND
 12232        POLICY-HAS-LIFE
 12233       AND
 12234        PB-I-LF-TERM NUMERIC
 12235       AND
 12236        PB-I-AH-TERM NUMERIC
 12237        NEXT SENTENCE
 12238     ELSE
 12239        GO TO 3070-LOAN-TERM-CHECK.
 12240
 12241     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12242     IF WS-TEX-FACT-2 LESS THAN +0
 12243        MULTIPLY +1 BY WS-TEX-FACT-2.
 12244
 12245     IF WS-TEX-FACT-2 GREATER THAN +1
 12246        MOVE ER-2668             TO WS-ERROR
 12247        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 224
* EL050.cbl
 12248
 12249 3070-LOAN-TERM-CHECK.
 12250
 12251     IF (WS-LF-BENEFIT-CD = ZERO)
 12252         OR (NO-LF-BENEFIT-MATCH)
 12253            GO TO 3125-EDIT-PMT-FREQ.
 12254*    IF PB-COMPANY-ID NOT = 'DCC'
 12255*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12256*          AND 'V' AND 'W' AND 'X'
 12257*          GO TO 3125-EDIT-PMT-FREQ
 12258*       END-IF
 12259*    ELSE
 12260*       IF WS-AH-DCC-TRUNC = 'T'
 12261*          CONTINUE
 12262*       ELSE
 12263*          GO TO 3125-EDIT-PMT-FREQ
 12264*       END-IF
 12265*    END-IF
 12266     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12267                    OR
 12268        ((PB-COMPANY-ID = 'DCC')
 12269        AND (WS-AH-DCC-TRUNC = 'T'))
 12270        CONTINUE
 12271     ELSE
 12272        GO TO 3125-EDIT-PMT-FREQ
 12273     END-IF
 12274     IF PB-I-LOAN-TERM NOT NUMERIC
 12275         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12276
 12277     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12278        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12279        PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12280        PB-I-LOAN-TERM NOT GREATER THAN +360
 12281         NEXT SENTENCE
 12282     ELSE
 12283         MOVE ER-2648            TO WS-ERROR
 12284         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12285
 12286     IF WS-STATE-ABBREVIATION = 'NC'
 12287        IF PB-I-LOAN-TERM > +59
 12288           CONTINUE
 12289        ELSE
 12290           MOVE ER-2792          TO WS-ERROR
 12291           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12292        END-IF
 12293     END-IF
 12294
 12295     .
 12296 3125-EDIT-PMT-FREQ.
 12297     IF (WS-LF-BENEFIT-CD = ZERO)
 12298         OR (NO-LF-BENEFIT-MATCH)
 12299            GO TO 3127-EDIT-LOAN-OFFICER.
 12300     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12301                    OR
 12302        ((PB-COMPANY-ID = 'DCC')
 12303        AND (WS-AH-DCC-TRUNC = 'T'))
 12304                    OR
 12305         (PB-COMPANY-ID = 'AHL')
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 225
* EL050.cbl
 12306        CONTINUE
 12307     ELSE
 12308        IF (PB-I-LOAN-TERM > ZEROS)
 12309           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12310           MOVE ER-1575          TO WS-ERROR
 12311           PERFORM 9900-ERROR-FORMAT
 12312                                 THRU 9900-EXIT
 12313        END-IF
 12314     END-IF
 12315     IF WS-LF-EARNINGS-CALC NOT = '4'
 12316         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12317            MOVE ER-2653         TO WS-ERROR
 12318            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12319            GO TO 3127-EDIT-LOAN-OFFICER
 12320         ELSE
 12321            GO TO 3127-EDIT-LOAN-OFFICER.
 12322
 12323     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12324         MOVE ER-2655            TO WS-ERROR
 12325         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12326         GO TO 3127-EDIT-LOAN-OFFICER.
 12327
 12328     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12329         MOVE ER-2654            TO WS-ERROR
 12330         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12331         GO TO 3127-EDIT-LOAN-OFFICER.
 12332
 12333     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12334         GIVING WS-TEX-FACT-2
 12335             REMAINDER WS-TEX-FACT-3.
 12336
 12337*    IF WS-TEX-FACT-3 NOT = ZERO
 12338*       MOVE ER-2654             TO WS-ERROR
 12339*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12340
 12341
 12342 3127-EDIT-LOAN-OFFICER.
 12343
 12344     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12345        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12346           MOVE ER-2690          TO WS-ERROR
 12347           PERFORM 9900-ERROR-FORMAT
 12348                                 THRU 9900-EXIT
 12349        ELSE
 12350           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12351           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12352           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12353           MOVE PB-SV-STATE      TO LOFC-STATE
 12354           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 12355           MOVE PB-I-LOAN-OFFICER
 12356                                 TO LOFC-CODE
 12357           PERFORM 8586-READ-LOAN-OFFICER
 12358                                 THRU 8586-EXIT
 12359           IF (NOT LOFC-MASTER-FOUND)
 12360              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12361              MOVE ER-3006       TO WS-ERROR
 12362              PERFORM 9900-ERROR-FORMAT
 12363                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 226
* EL050.cbl
 12364           END-IF
 12365        END-IF
 12366     END-IF
 12367     .
 12368 3129-EDIT-APR.
 12369
 12370     IF (WS-LF-BENEFIT-CD = ZERO)
 12371        OR (NO-LF-BENEFIT-MATCH)
 12372        IF PB-COMPANY-ID NOT = 'DCC'
 12373           GO TO 3130-EDIT-AGE
 12374*       ELSE
 12375*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12376*             GO TO 3130-EDIT-AGE
 12377*          END-IF
 12378        END-IF
 12379     END-IF
 12380
 12381     IF (WS-STATE-ABBREVIATION = 'OH')
 12382         AND (PB-I-RATE-CLASS NOT = 'L ')
 12383         AND (PB-I-LF-TERM GREATER THAN 60)
 12384         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12385         GO TO 3129-APR-CONT.
 12386
 12387     IF (WS-STATE-ABBREVIATION = 'RI')
 12388         AND (PB-I-LF-TERM GREATER THAN 60)
 12389         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12390         GO TO 3129-APR-CONT.
 12391
 12392     IF (WS-STATE-ABBREVIATION = 'UT')
 12393         AND (PB-I-LF-TERM GREATER THAN 62)
 12394         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12395         AND (PB-CERT-EFF-DT LESS WS-830901)
 12396         GO TO 3129-APR-CONT.
 12397
 12398     IF PB-COMPANY-ID = 'LAP'
 12399        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12400           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12401              MOVE ER-2656         TO WS-ERROR
 12402              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12403              GO TO 3130-EDIT-AGE.
 12404
 12405     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12406        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12407        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12408        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12409         GO TO 3130-EDIT-AGE.
 12410
 12411 3129-APR-CONT.
 12412     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12413         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12414         GO TO 3130-EDIT-AGE.
 12415
 12416     IF (WS-LF-BENEFIT-CD (1:1) = 'S')
 12417        AND (PB-COMPANY-ID = 'DCC')
 12418        AND (PB-I-LOAN-APR = ZERO)
 12419        MOVE ER-2657             TO WS-ERROR
 12420        PERFORM 9900-ERROR-FORMAT
 12421                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 227
* EL050.cbl
 12422        GO TO 3130-EDIT-AGE
 12423     END-IF
 12424     IF PB-I-LOAN-APR = ZERO
 12425        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12426     END-IF
 12427
 12428     IF PB-I-LOAN-APR = ZERO
 12429        MOVE ER-2656             TO WS-ERROR
 12430        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12431        GO TO 3130-EDIT-AGE.
 12432
 12433*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12434     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12435        MOVE ER-2657             TO WS-ERROR
 12436        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12437
 12438 3130-EDIT-AGE.
 12439
 12440******************************************************************
 12441*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12442******************************************************************
 12443
 12444     IF NOT NO-LIFE-COVERAGE
 12445        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12446           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12447               MOVE ER-2628             TO WS-ERROR
 12448               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12449
 12450     IF NOT NO-AH-COVERAGE
 12451        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12452           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12453               MOVE ER-2628         TO WS-ERROR
 12454               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12455
 12456 3133-SEX-CODE.
 12457     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12458         IF WS-DEFAULT-SEX = 'M'
 12459             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12460          ELSE
 12461             IF WS-DEFAULT-SEX = 'F'
 12462             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12463
 12464     IF PB-I-INSURED-SEX = '1'
 12465         MOVE 'M' TO PB-I-INSURED-SEX.
 12466
 12467     IF PB-I-INSURED-SEX = '2'
 12468         MOVE 'F' TO PB-I-INSURED-SEX.
 12469
 12470 3134-SIG-SW-EDIT.
 12471     IF PB-I-SIG-SW = SPACE
 12472         MOVE 'N'                TO  PB-I-SIG-SW.
 12473
 12474     IF PB-COMPANY-ID = 'NCL'
 12475         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12476             NEXT SENTENCE
 12477         ELSE
 12478             MOVE ER-1923        TO  WS-ERROR
 12479             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 228
* EL050.cbl
 12480     ELSE
 12481     IF PB-COMPANY-ID = 'CRI'
 12482         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12483             NEXT SENTENCE
 12484         ELSE
 12485             MOVE ER-2606        TO  WS-ERROR
 12486             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12487     ELSE
 12488     IF PB-COMPANY-ID = 'TMS'
 12489         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12490             NEXT SENTENCE
 12491         ELSE
 12492             MOVE ER-2689        TO  WS-ERROR
 12493             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12494     ELSE
 12495         IF PB-I-SIG-SW = 'Y' OR 'N'
 12496             NEXT SENTENCE
 12497         ELSE
 12498             MOVE ER-2651        TO  WS-ERROR
 12499             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12500
 12501     IF PB-COMPANY-ID = 'FLA'
 12502         IF (WS-EDIT-AGE GREATER 54  OR
 12503             WS-AH-EDIT-AGE GREATER 54)  AND
 12504            PB-I-SIG-SW = 'N'
 12505            MOVE ER-2651         TO  WS-ERROR
 12506            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12507
 12508 3135-NAME-EDIT.
 12509
 12510     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12511        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12512        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12513           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12514                                 TO PB-I-JOINT-FIRST-NAME
 12515        END-PERFORM
 12516     END-IF
 12517     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12518        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12519        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12520           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12521                                 TO PB-I-JOINT-LAST-NAME
 12522        END-PERFORM
 12523     END-IF
 12524     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12525        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12526        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12527           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12528                                 TO PB-I-INSURED-FIRST-NAME
 12529        END-PERFORM
 12530     END-IF
 12531     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12532        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12533        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12534           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12535                                 TO PB-I-INSURED-LAST-NAME
 12536        END-PERFORM
 12537     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 229
* EL050.cbl
 12538     IF PB-I-INSURED-LAST-NAME = SPACES
 12539       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12540       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12541           MOVE ER-2660    TO WS-ERROR
 12542           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12543
 12544 3136-EDIT-SEX.
 12545
 12546******************************************************************
 12547*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12548******************************************************************
 12549
 12550     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12551        (WS-AH-SPECIAL-CALC-CD = 'O')
 12552        NEXT SENTENCE
 12553     ELSE
 12554        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12555           NEXT SENTENCE
 12556        ELSE
 12557           MOVE ER-2629            TO WS-ERROR
 12558           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12559
 12560 3137-EDIT-EFF-DATE.
 12561
 12562     IF PB-REISSUED-CERT       OR
 12563        PB-POLICY-IS-DECLINED  OR
 12564        PB-POLICY-IS-VOIDED
 12565         GO TO 3139-EDIT-COVERAGE-CODES.
 12566
 12567     MOVE SPACE                  TO WS-2671-SW
 12568                                    WS-2672-SW.
 12569
 12570     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12571         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12572             MOVE ER-2703        TO WS-ERROR
 12573             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12574             GO TO 3139-EDIT-COVERAGE-CODES.
 12575
 12576     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12577         GO TO 3139-EDIT-COVERAGE-CODES.
 12578
 12579     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12580     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12581*    MOVE '1'                    TO DC-OPTION-CODE.
 12582     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12583     MOVE +0                     TO DC-ELAPSED-MONTHS
 12584                                    DC-ELAPSED-DAYS.
 12585     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12586
 12587     IF DATE-CONVERSION-ERROR
 12588         GO TO 3139-EDIT-COVERAGE-CODES.
 12589
 12590     IF DC-ELAPSED-DAYS GREATER +180
 12591         MOVE ER-2672            TO WS-ERROR
 12592         MOVE 'Y'                TO WS-2672-SW
 12593         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12594     END-IF
 12595
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 230
* EL050.cbl
 12596     IF WS-ERROR = ER-2671  AND
 12597        PB-COMPANY-ID  = 'LBL'
 12598        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12599        MOVE SPACE               TO WS-2671-SW
 12600        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12601
 12602     IF PB-ISSUE-DATE-FORCED  AND
 12603      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12604         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12605         MOVE ER-2673            TO WS-ERROR
 12606         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12607         MOVE SPACE              TO WS-2671-SW
 12608                                    WS-2672-SW.
 12609
 12610     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12611         IF PB-ISSUE-DATE-FORCED
 12612             MOVE ER-2600          TO  WS-ERROR
 12613             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12614         ELSE
 12615             MOVE ER-2692          TO  WS-ERROR
 12616             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12617
 12618
 12619 3139-EDIT-COVERAGE-CODES.
 12620
 12621     if pb-company-id not = 'AHL'
 12622        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12623           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12624           MOVE ER-2787          TO WS-ERROR
 12625           PERFORM 9900-ERROR-FORMAT
 12626                                 THRU 9900-EXIT
 12627        END-IF
 12628     end-if
 12629     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12630        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12631                                 > 250000.00
 12632           MOVE ER-2719          TO WS-ERROR
 12633           PERFORM 9900-ERROR-FORMAT
 12634                                 THRU 9900-EXIT
 12635        END-IF
 12636     END-IF
 12637
 12638     IF PB-POLICY-IS-DECLINED  OR
 12639        PB-POLICY-IS-VOIDED
 12640         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12641
 12642     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12643        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12644         MOVE ER-2630                TO WS-ERROR
 12645         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12646
 12647     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12648        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12649        PB-I-LF-PREMIUM-AMT = ZERO
 12650         GO TO 3140-CHECK-AH-FOR-ZERO.
 12651
 12652     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12653        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 231
* EL050.cbl
 12654        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12655         GO TO 3140-CHECK-AH-FOR-ZERO.
 12656
 12657     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12658        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12659        MOVE ER-2631             TO WS-ERROR
 12660        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12661     END-IF
 12662
 12663
 12664******************************************************************
 12665*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12666******************************************************************
 12667
 12668     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12669        NEXT SENTENCE
 12670     ELSE
 12671        IF PB-I-LF-BENEFIT-AMT = ZERO
 12672           MOVE ER-2632             TO WS-ERROR
 12673           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12674
 12675
 12676******************************************************************
 12677*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12678******************************************************************
 12679
 12680     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12681        CONTINUE
 12682     ELSE
 12683        IF PB-I-LF-PREMIUM-AMT = ZERO
 12684           IF (NOT PB-COMP-LF-PREM)
 12685              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12686              MOVE ER-2633       TO WS-ERROR
 12687              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12688           END-IF
 12689        END-IF
 12690     END-IF
 12691     .
 12692 3140-CHECK-AH-FOR-ZERO.
 12693
 12694     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12695        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12696        PB-I-AH-PREMIUM-AMT = ZERO
 12697         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12698
 12699     IF PB-COMPANY-ID = 'CSL'  AND
 12700        PB-I-AH-BENEFIT-CD = ZERO  AND
 12701        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12702        PB-I-AH-PREMIUM-AMT = ZERO
 12703         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12704
 12705     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12706        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12707        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12708         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12709
 12710     IF PB-I-AH-BENEFIT-CD = ZERO
 12711         MOVE ER-2634            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 232
* EL050.cbl
 12712         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12713
 12714******************************************************************
 12715*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12716******************************************************************
 12717
 12718     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12719        NEXT SENTENCE
 12720     ELSE
 12721        IF PB-I-AH-BENEFIT-AMT = ZERO
 12722           MOVE ER-2635             TO WS-ERROR
 12723           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12724
 12725******************************************************************
 12726*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12727******************************************************************
 12728
 12729     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12730        NEXT SENTENCE
 12731     ELSE
 12732        IF PB-I-AH-PREMIUM-AMT = ZERO
 12733            IF NOT PB-COMP-AH-PREM
 12734                MOVE ER-2636    TO WS-ERROR
 12735                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12736
 12737
 12738 3140-EDIT-MAX-AMT-SIZES.
 12739* CUSTOM CODE FOR CLIENT    'DMD'
 12740     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12741                                     WS-RES-MUNI-TAX
 12742                                     PB-I-STATE-TAX
 12743                                     PB-I-MUNI-TAX.
 12744
 12745     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12746
 12747     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12748        GO TO 3150-RATE-OUTSTAND-BAL.
 12749
 12750     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12751        GO TO 3150-RATE-OUTSTAND-BAL.
 12752
 12753     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12754        GO TO 3150-RATE-OUTSTAND-BAL.
 12755
 12756     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12757                             OR 'RIC')
 12758        GO TO 3150-RATE-OUTSTAND-BAL.
 12759
 12760     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12761        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12762            GO TO 3150-RATE-OUTSTAND-BAL
 12763        ELSE
 12764           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12765               GO TO 3150-RATE-OUTSTAND-BAL.
 12766
 12767     IF NOT PB-NO-MONTHS-SKIPPED
 12768        GO TO 3150-RATE-OUTSTAND-BAL.
 12769
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 233
* EL050.cbl
 12770     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12771        GO TO 3150-RATE-OUTSTAND-BAL.
 12772
 12773     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12774        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12775           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12776             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12777           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12778           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12779              MOVE ER-2693     TO WS-ERROR
 12780              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12781              GO TO 3150-RATE-OUTSTAND-BAL
 12782           ELSE
 12783              GO TO 3150-RATE-OUTSTAND-BAL.
 12784
 12785 3150-RATE-OUTSTAND-BAL.
 12786
 12787* DMD RATING TEST
 12788     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12789         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12790         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12791         MOVE ER-2687                 TO WS-ERROR
 12792         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12793         MOVE 'B'                     TO PB-I-OB-FLAG
 12794         GO TO 3260-EDIT-CONTINUE.
 12795
 12796     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12797         IF  WS-ERROR    EQUAL    ER-2693
 12798             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12799                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12800                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12801                 MOVE  +0            TO  WS-ERROR.
 12802
 12803     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12804         IF  WS-ERROR    EQUAL    ER-2693
 12805             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12806                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12807                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12808                 MOVE  +0            TO  WS-ERROR.
 12809
 12810     IF PLAN-MASTER-AH-SW = 'Y'
 12811        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12812            IF  WS-ERROR    EQUAL    ER-2693
 12813              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12814                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12815                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12816                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12817                 MOVE  ER-1910           TO  WS-ERROR
 12818                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12819
 12820     IF PLAN-MASTER-AH-SW = 'Y'
 12821        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12822            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12823               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12824               MOVE  ER-1910           TO  WS-ERROR
 12825               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12826
 12827     IF PLAN-MASTER-AH-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 234
* EL050.cbl
 12828        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12829            IF  WS-ERROR    EQUAL    ER-2693
 12830                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12831                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12832                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12833                 MOVE  +0       TO  WS-ERROR.
 12834
 12835     IF WS-ERROR = ER-2693
 12836        IF PB-COMPANY-ID = 'JAL' AND
 12837           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12838           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12839           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12840
 12841     IF WS-ERROR = ER-2693
 12842        IF PB-COMPANY-ID = 'NCL'  AND
 12843           PB-I-AH-BENEFIT-CD = 'OA'
 12844           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12845           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12846
 12847     IF WS-ERROR = ER-2693
 12848        IF PB-COMPANY-ID = 'CNL' AND
 12849           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12850           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12851           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12852
 12853     IF WS-ERROR = ER-2693
 12854        IF PB-COMPANY-ID = 'HER'
 12855           IF WS-LEVEL
 12856              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12857              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12858
 12859     IF ((LF-BENEFIT-FOUND) AND
 12860         (NOT NO-LIFE-COVERAGE)  AND
 12861         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12862       OR   ((AH-BENEFIT-FOUND) AND
 12863             (NOT NO-AH-COVERAGE)    AND
 12864             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12865         NEXT SENTENCE
 12866     ELSE
 12867         GO TO 3215-EDIT-RATES.
 12868
 12869     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12870        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12871           MOVE ER-2674          TO WS-ERROR
 12872           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12873           GO TO 3215-EDIT-RATES.
 12874
 12875     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12876        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12877           MOVE ER-2674          TO WS-ERROR
 12878           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12879           GO TO 3215-EDIT-RATES.
 12880
 12881     MOVE 'B'                    TO PB-I-OB-FLAG.
 12882
 12883     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12884         NEXT SENTENCE
 12885     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 235
* EL050.cbl
 12886         IF NOT NO-LIFE-COVERAGE
 12887             IF WS-ACCT-LF-OB-RT = ZERO
 12888                MOVE ER-2641    TO WS-ERROR
 12889                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12890
 12891     IF PB-COMPANY-ID = 'CRI'
 12892       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12893         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12894         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12895         IF WS-ERROR = ER-2675
 12896            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12897            MOVE ER-2687              TO WS-ERROR
 12898            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12899         ELSE
 12900            MOVE ER-2687              TO WS-ERROR
 12901            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12902
 12903
 12904     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12905         NEXT SENTENCE
 12906     ELSE
 12907       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 12908            NEXT SENTENCE
 12909       ELSE
 12910         IF NOT NO-AH-COVERAGE
 12911             IF WS-ACCT-AH-OB-RT = ZERO
 12912                MOVE ER-2642    TO WS-ERROR
 12913                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12914
 12915     IF PB-COMPANY-ID = 'CRI'
 12916       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12917         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 12918         IF WS-ERROR = ER-2676
 12919            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12920            MOVE ER-2687              TO WS-ERROR
 12921            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12922         ELSE
 12923            MOVE ER-2687              TO WS-ERROR
 12924            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12925
 12926     IF PB-COMPANY-ID NOT = 'GIC'
 12927         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12928            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 12929     ELSE
 12930         IF PB-I-LF-PREM-CALC = ZEROS
 12931             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12932                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 12933
 12934     IF PB-COMPANY-ID NOT = 'GIC'
 12935         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12936            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 12937     ELSE
 12938         IF PB-I-AH-PREM-CALC = ZEROS
 12939             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12940                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 12941
 12942     MOVE ZEROS TO PB-I-MORT-CODE.
 12943
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 236
* EL050.cbl
 12944     GO TO 3260-EDIT-CONTINUE.
 12945
 12946
 12947 3215-EDIT-RATES.
 12948     IF ACCOUNT-MAST-FOUND
 12949         NEXT SENTENCE
 12950     ELSE
 12951         GO TO 3999-END-EDIT.
 12952
 12953 3220-CHECK-LF-RATES.
 12954
 12955     IF PB-COMPANY-ID = 'DCC'
 12956        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 12957        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 12958        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12959           AND (NOT WS-LF-CASH))
 12960                           OR
 12961           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12962           AND (NOT WS-AH-CASH)))
 12963                       AND
 12964           (PB-I-ENTRY-STATUS NOT = '5')
 12965           MOVE 'M'              TO PB-BATCH-ENTRY
 12966                                    PB-I-ENTRY-STATUS
 12967        END-IF
 12968     END-IF
 12969     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 12970                                    PB-I-AH-PREM-CALC
 12971                                    PB-I-LF-ALT-PREM-CALC
 12972                                    PB-I-LF-ALT-RATE
 12973                                    PB-I-LF-REI-RATE
 12974                                    PB-I-LF-ALT-REI-RATE
 12975                                    PB-I-AH-REI-RATE
 12976                                    PB-I-TOT-FEES-CALC.
 12977
 12978     IF PB-COMPANY-ID EQUAL 'DMD'
 12979        NEXT SENTENCE
 12980     ELSE
 12981        MOVE ZEROS               TO PB-I-LF-RATE
 12982                                    PB-I-AH-RATE.
 12983
 12984     IF PB-I-TOT-FEES NOT NUMERIC
 12985        MOVE ZEROS               TO PB-I-TOT-FEES
 12986     END-IF
 12987     IF PB-I-LIVES NOT NUMERIC
 12988         MOVE ZERO               TO PB-I-LIVES.
 12989
 12990     IF PB-I-NUM-BILLED NOT NUMERIC
 12991         MOVE ZERO               TO PB-I-NUM-BILLED.
 12992
 12993     IF PB-I-LF-PREM-TAX NOT NUMERIC
 12994        MOVE +0                  TO PB-I-LF-PREM-TAX
 12995     END-IF
 12996
 12997     IF PB-I-AH-PREM-TAX NOT NUMERIC
 12998        MOVE +0                  TO PB-I-AH-PREM-TAX
 12999     END-IF
 13000
 13001     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 237
* EL050.cbl
 13002        PB-I-PAY-FREQUENCY = ZEROS
 13003            MOVE 12 TO CP-PAY-FREQUENCY
 13004     ELSE
 13005            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13006
 13007     IF PB-I-STATE-TAX NOT NUMERIC
 13008         MOVE ZEROS               TO PB-I-STATE-TAX.
 13009
 13010     IF PB-I-MUNI-TAX NOT NUMERIC
 13011         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13012
 13013     MOVE SPACES                 TO CP-BEN-CATEGORY
 13014     IF PB-COMPANY-ID  = 'CSL'  AND
 13015        PB-I-LF-TERM NOT = ZERO
 13016        COMPUTE WS-PAYMENT-AMT =
 13017             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13018        COMPUTE WS-CSL-AMT1 =
 13019             PB-I-LF-TERM * AM-MAX-MON-BEN
 13020        COMPUTE WS-CSL-AMT2 =
 13021             WS-PAYMENT-AMT * PB-I-LF-TERM
 13022        IF CP-PAY-FREQUENCY NOT = 12
 13023           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13024           MOVE '8' TO WS-CSL-CALC-CD
 13025        ELSE
 13026           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13027              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13028               AM-MAX-TOT-BEN
 13029               MOVE '6' TO WS-CSL-CALC-CD
 13030           ELSE
 13031              IF (WS-CSL-AMT1  GREATER THAN
 13032                 AM-MAX-TOT-BEN) AND
 13033                 (WS-CSL-AMT2  GREATER THAN
 13034                 AM-MAX-TOT-BEN)
 13035                 MOVE '7' TO WS-CSL-CALC-CD
 13036              ELSE
 13037                 MOVE '5' TO WS-CSL-CALC-CD.
 13038
 13039     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13040         NEXT SENTENCE
 13041     ELSE
 13042         GO TO 3300-CHECK-AH-RATES.
 13043
 13044*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13045
 13046     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13047        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13048              OR
 13049           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13050           MOVE ER-2618          TO WS-ERROR
 13051           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13052           GO TO 3300-CHECK-AH-RATES.
 13053
 13054     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13055           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13056                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13057
 13058     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13059         MOVE ER-2687             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 238
* EL050.cbl
 13060         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13061         MOVE 'Z000'              TO PB-I-MORT-CODE
 13062         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13063         GO TO 3300-CHECK-AH-RATES.
 13064
 13065     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13066        IF PB-I-LIVES = ZERO
 13067           MOVE ER-2688          TO WS-ERROR
 13068           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13069
 13070     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13071
 13072     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13073     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13074     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13075     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13076     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13077     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13078     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13079     MOVE '3'                    TO CP-PROCESS-TYPE.
 13080     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13081     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13082
 13083******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13084     IF PB-COMPANY-ID EQUAL 'CDL'
 13085         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13086            CP-EARN-AS-NET-PAY)
 13087             IF PB-CERT-EFF-DT GREATER  WS-931231
 13088                 MOVE '1'        TO CP-EARNING-METHOD.
 13089*******
 13090
 13091     MOVE PB-SV-STATE            TO CP-STATE.
 13092     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13093     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13094     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13095     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13096     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13097                                    CP-RATING-BENEFIT-AMT.
 13098     IF CP-STATE-STD-ABBRV = 'OR'
 13099         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13100                                         PB-I-LF-ALT-BENEFIT-AMT.
 13101     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13102     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13103     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13104     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13105     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13106     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13107     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13108     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13109     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13110                                    CP-REMAINING-TERM
 13111                                    CP-LOAN-TERM.
 13112
 13113     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13114         NEXT SENTENCE
 13115     ELSE
 13116         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13117             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 239
* EL050.cbl
 13118                                           PB-I-LF-PREMIUM-AMT.
 13119
 13120     IF PB-COMPANY-ID EQUAL 'CSL'
 13121        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13122           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13123                                         PB-I-LF-PREMIUM-AMT.
 13124
 13125     IF PB-COMPANY-ID EQUAL 'NCB'
 13126         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13127            CP-EARN-AS-NET-PAY
 13128             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13129                 PB-I-LF-PREMIUM-AMT.
 13130
 13131     IF (CP-TRUNCATED-LIFE)
 13132        or ((pb-company-id = 'AHL')
 13133           and (pb-i-loan-term > pb-i-lf-term))
 13134        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13135
 13136     IF PB-COMPANY-ID EQUAL 'CRI'
 13137        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13138
 13139     IF CP-TERM-IS-DAYS
 13140         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13141     ELSE
 13142         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13143     IF PB-COMPANY-ID = 'DCC'
 13144        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13145        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13146        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13147        IF WS-LF-BEN-CATEGORY = 'D'
 13148           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13149           MOVE PB-I-LIFE-COMMISSION
 13150                                 TO CP-DCC-ACT-COMM
 13151           MOVE WS-LF-BEN-CATEGORY
 13152                                 TO CP-BEN-CATEGORY
 13153        END-IF
 13154        IF (CP-BENEFIT-CD (1:1) = 'P')
 13155           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13156           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13157        END-IF
 13158     END-IF
 13159     IF PB-COMPANY-ID = 'CSL'
 13160         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13161         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13162         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13163
 13164     IF PB-COMPANY-ID = 'CSL'
 13165        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13166
 13167     IF (CP-SPECIAL-CALC-CD = 'H')
 13168        OR (PB-COMPANY-ID = 'DCC')
 13169         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13170                                    TO CP-ALTERNATE-BENEFIT
 13171         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13172
 13173     IF (PB-COMPANY-ID = 'CID')
 13174        AND (WS-LF-EARNINGS-CALC = 'B')
 13175        AND (CP-STATE-STD-ABBRV = 'MN')
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 240
* EL050.cbl
 13176        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13177                                 TO CP-ALTERNATE-BENEFIT
 13178        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13179     END-IF
 13180     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13181     MOVE 'R'                   TO CP-RATE-FILE.
 13182     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13183
 13184     IF CP-ERROR-RATE-NOT-FOUND
 13185        MOVE ER-2641            TO WS-ERROR
 13186        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13187        GO TO 3300-CHECK-AH-RATES.
 13188
 13189     IF PB-COMPANY-ID EQUAL 'CRI'
 13190        IF CP-ERROR-NO-LIMITS-CRI
 13191           IF NOT ACCOUNT-LIFE-CHECKED
 13192              MOVE ER-2607      TO WS-ERROR
 13193              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13194
 13195******************************************************************
 13196*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13197*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13198******************************************************************
 13199
 13200* CALC LIFE AGE AT EXPIRATION.
 13201
 13202     COMPUTE WS-AGE-AT-EXPIRE =
 13203          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13204
 13205*    IF PB-STATE = 'CO' OR 'UT'
 13206*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13207*        MOVE 'F'            TO PB-FATAL-FLAG
 13208*        MOVE ER-2709        TO WS-ERROR
 13209*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13210*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13211
 13212*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13213*        MOVE 'X'            TO PB-FATAL-FLAG
 13214*        MOVE ER-2718        TO WS-ERROR
 13215*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13216*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13217
 13218* CALC A & H AGE AT EXPIRATION.
 13219
 13220     COMPUTE WS-AGE-AT-EXPIRE =
 13221          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13222
 13223*    IF PB-STATE = 'CO' OR 'UT'
 13224*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13225*        MOVE 'F'            TO PB-FATAL-FLAG
 13226*        MOVE ER-2709        TO WS-ERROR
 13227*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13228*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13229
 13230*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13231*        MOVE 'X'            TO PB-FATAL-FLAG
 13232*        MOVE ER-2718        TO WS-ERROR
 13233*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 241
* EL050.cbl
 13234*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13235
 13236     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13237        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13238
 13239     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13240        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13241
 13242     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13243        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13244
 13245     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13246         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13247         MOVE ER-2639        TO WS-ERROR
 13248         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13249
 13250
 13251******************************************************************
 13252*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13253******************************************************************
 13254
 13255 PREMIUM-EDITING-IS-BYPASSED.
 13256     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13257        AND (CP-R-MAX-ATT-AGE > +0)
 13258        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13259        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13260           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13261           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13262           MOVE '1'              TO DC-OPTION-CODE
 13263           PERFORM 8500-DATE-CONVERT
 13264                                 THRU 8500-EXIT
 13265           IF NO-CONVERSION-ERROR
 13266              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13267                 MOVE ER-2661       TO WS-ERROR
 13268*                PERFORM 9900-ERROR-FORMAT
 13269*                                THRU 9900-EXIT
 13270              END-IF
 13271           END-IF
 13272        ELSE
 13273           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13274           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13275              MOVE ER-2661       TO WS-ERROR
 13276*             PERFORM 9900-ERROR-FORMAT
 13277*                                THRU 9900-EXIT
 13278           ELSE
 13279              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13280                 MOVE ER-1570    TO WS-ERROR
 13281                 PERFORM 9900-ERROR-FORMAT
 13282                                 THRU 9900-EXIT
 13283              END-IF
 13284           END-IF
 13285        END-IF
 13286        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13287           MOVE PB-I-JOINT-BIRTHDAY
 13288                                 TO DC-BIN-DATE-1
 13289           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13290           MOVE '1'              TO DC-OPTION-CODE
 13291           PERFORM 8500-DATE-CONVERT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 242
* EL050.cbl
 13292                                 THRU 8500-EXIT
 13293           IF NO-CONVERSION-ERROR
 13294              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13295                 MOVE ER-2661       TO WS-ERROR
 13296*                PERFORM 9900-ERROR-FORMAT
 13297*                                THRU 9900-EXIT
 13298              END-IF
 13299           ELSE
 13300              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13301           END-IF
 13302        ELSE
 13303           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13304             (PB-I-LF-TERM / 12)
 13305           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13306              MOVE ER-2661       TO WS-ERROR
 13307*             PERFORM 9900-ERROR-FORMAT
 13308*                                THRU 9900-EXIT
 13309           ELSE
 13310              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13311                 MOVE ER-1571    TO WS-ERROR
 13312                 PERFORM 9900-ERROR-FORMAT
 13313                                 THRU 9900-EXIT
 13314              END-IF
 13315           END-IF
 13316        END-IF
 13317        IF WS-ERROR = ER-2661
 13318           PERFORM 9900-ERROR-FORMAT
 13319                                 THRU 9900-EXIT
 13320        END-IF
 13321     END-IF
 13322*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13323*       MOVE ER-2661             TO WS-ERROR
 13324*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13325
 13326     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13327        MOVE ER-2662             TO WS-ERROR
 13328        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13329
 13330     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13331        MOVE ER-2677             TO WS-ERROR
 13332        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13333
 13334     IF CP-ERROR-LOAN-TERM
 13335        MOVE ER-2648             TO WS-ERROR
 13336        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13337
 13338 3221-CHECK-ERROR-RATE-OPEN.
 13339
 13340     IF CP-ERROR-RATE-FILE-NOTOPEN
 13341         GO TO 3990-FILES-NOT-OPEN.
 13342
 13343     IF PB-COMPANY-ID NOT = 'DMD'
 13344        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13345     END-IF
 13346     .
 13347 3221-CONTINUE.
 13348     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13349                                    WS-DCC-AH-RATE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 243
* EL050.cbl
 13350     IF PB-COMPANY-ID = 'DCC'
 13351        IF WS-LF-BEN-CATEGORY = 'D'
 13352           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13353              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13354        END-IF
 13355     END-IF
 13356     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13357*   X'A4FF' = 12/31/2009
 13358     IF (PB-COMPANY-ID = 'CID')
 13359        AND (WS-LF-EARNINGS-CALC = 'B')
 13360        AND (CP-STATE-STD-ABBRV = 'MN')
 13361        AND (PB-CERT-EFF-DT > X'A4FF')
 13362        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13363     END-IF
 13364     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13365
 13366     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13367     IF (PB-COMPANY-ID = 'DCC')
 13368        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13369        AND (PB-I-POLICY-IS-MONTHLY)
 13370        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13371        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13372     END-IF
 13373     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13374     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13375     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13376     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13377     IF (PB-COMPANY-ID = 'DCC')
 13378        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13379        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13380        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13381        MOVE ER-2786             TO WS-ERROR
 13382        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13383     END-IF
 13384
 13385     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13386
 13387******************************************************************
 13388*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13389******************************************************************
 13390     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13391        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13392
 13393     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13394        GO TO 3225-CHECK-ALT-LIFE-RATE
 13395     ELSE
 13396       IF PB-I-LF-RATE = ZERO
 13397          MOVE ER-2641          TO WS-ERROR
 13398          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13399
 13400 3225-CHECK-ALT-LIFE-RATE.
 13401
 13402     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13403        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13404        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13405         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13406
 13407     IF (WS-LF-EARNINGS-CALC NOT = 'B')
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 244
* EL050.cbl
 13408         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13409             AND PB-COMPANY-ID NOT = 'DCC')
 13410                   OR
 13411              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13412              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13413              AND PB-COMPANY-ID NOT = 'DCC')
 13414             MOVE ER-2720        TO  WS-ERROR
 13415             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13416             GO TO 3225-RATING-CONT
 13417         ELSE
 13418             GO TO 3225-RATING-CONT.
 13419     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13420        AND (AM-GPCD = 01 OR 06 OR 15)
 13421        MOVE ER-2798             TO WS-ERROR
 13422        PERFORM 9900-ERROR-FORMAT
 13423                                 THRU 9900-EXIT
 13424*       GO TO 3225-RATING-CONT
 13425     END-IF
 13426     IF (PB-COMPANY-ID = 'CID')
 13427        AND (WS-LF-EARNINGS-CALC = 'B')
 13428        AND (CP-STATE-STD-ABBRV = 'MN')
 13429        AND (PB-CERT-EFF-DT > X'A4FF')
 13430        GO TO 3225-RATING-CONT
 13431     END-IF
 13432     IF PB-COMPANY-ID = 'DCC'
 13433        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13434           AND (PB-I-POLICY-IS-MONTHLY)
 13435           GO TO 3225-RATING-CONT
 13436        END-IF
 13437     END-IF
 13438
 13439     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13440        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13441        CP-EARN-AS-REG-BALLOON
 13442        NEXT SENTENCE
 13443     ELSE
 13444        MOVE '2'                 TO CP-EARNING-METHOD.
 13445
 13446 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13447
 13448     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13449
 13450     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13451        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13452        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13453         NEXT SENTENCE
 13454     ELSE
 13455         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13456
 13457     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13458     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13459     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13460                                     CP-RATING-BENEFIT-AMT.
 13461     IF CP-STATE-STD-ABBRV = 'OR'
 13462         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13463                                         PB-I-LF-ALT-BENEFIT-AMT.
 13464     IF PB-COMPANY-ID = 'DCC'
 13465        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 245
* EL050.cbl
 13466     END-IF
 13467     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13468     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13469     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13470                                    CP-REMAINING-TERM
 13471                                    CP-LOAN-TERM.
 13472     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13473        ADD +1                   TO CP-ORIGINAL-TERM
 13474                                    CP-REMAINING-TERM
 13475                                    CP-LOAN-TERM.
 13476
 13477     MOVE 'R'                   TO CP-RATE-FILE.
 13478     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13479
 13480     IF CP-ERROR-RATE-NOT-FOUND
 13481         MOVE ER-2641            TO WS-ERROR
 13482         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13483         GO TO 3300-CHECK-AH-RATES.
 13484
 13485     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13486     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13487
 13488     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13489         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13490
 13491     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13492                               + PB-I-LF-ALT-BENEFIT-AMT.
 13493
 13494     IF ACCOUNT-LIFE-CHECKED  OR
 13495        PB-POLICY-IS-VOIDED   OR
 13496        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13497        GO TO 3225-CONTINUE.
 13498
 13499     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13500        GO TO 3225-CONTINUE.
 13501
 13502     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13503                             EC-RT-LF-MAX-TOT-BEN
 13504        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13505        MOVE ER-2639       TO WS-ERROR
 13506        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13507
 13508 3225-CONTINUE.
 13509     IF PB-I-LF-ALT-RATE = ZERO
 13510         MOVE ER-2659            TO WS-ERROR
 13511         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13512
 13513     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13514        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13515        MOVE ER-2698             TO WS-ERROR
 13516        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13517
 13518 3225-RATING-CONT.
 13519
 13520     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13521         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13522         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13523         IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 246
* EL050.cbl
 13524            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13525            CONTINUE
 13526         ELSE
 13527            MOVE ER-2687         TO WS-ERROR
 13528            PERFORM 9900-ERROR-FORMAT
 13529                                 THRU 9900-EXIT
 13530         END-IF
 13531         GO TO 3290-EDIT-LF-REIN-RATE
 13532     END-IF
 13533
 13534* DMD RATING TEST
 13535     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13536         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13537         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13538         MOVE ER-2687                 TO WS-ERROR
 13539         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13540         GO TO 3290-EDIT-LF-REIN-RATE.
 13541
 13542 3230-CLIENT-MORT-CD-SPECIALS.
 13543
 13544     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13545     SET BIN-TO-GREG          TO TRUE.
 13546*    MOVE ' '                 TO DC-OPTION-CODE.
 13547     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13548     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13549
 13550 C-POS-3230-MORT-CD.
 13551     IF PB-COMPANY-ID = 'POS' AND
 13552        PB-SV-CARRIER = '2'
 13553         NEXT SENTENCE
 13554     ELSE
 13555         GO TO C-POS-3240-MORT-CD.
 13556
 13557     IF PB-SV-GROUPING = '030'
 13558        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13559         MOVE '2350' TO PB-I-MORT-CODE
 13560      ELSE
 13561         MOVE '3300' TO PB-I-MORT-CODE.
 13562
 13563
 13564 C-POS-3240-MORT-CD.
 13565     IF PB-COMPANY-ID = 'POS' AND
 13566        PB-SV-CARRIER = '1'
 13567         NEXT SENTENCE
 13568     ELSE
 13569         GO TO 3230-CONTINUE.
 13570
 13571     IF PB-SV-STATE = '45' OR '47'
 13572        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13573         MOVE '5200' TO PB-I-MORT-CODE
 13574     ELSE
 13575         MOVE '8300' TO PB-I-MORT-CODE.
 13576
 13577 3230-CONTINUE.
 13578
 13579     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13580        GO TO 3240-CONTINUE
 13581     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 247
* EL050.cbl
 13582
 13583     IF PB-CERT-EFF-DT > WS-971231
 13584        GO TO 3240-CONTINUE
 13585     END-IF
 13586
 13587     IF LF-BENEFIT-FOUND AND
 13588        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13589         MOVE 'F250'       TO PB-I-MORT-CODE
 13590     ELSE
 13591         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13592             MOVE '7250'   TO PB-I-MORT-CODE
 13593         ELSE
 13594             MOVE '4251'   TO PB-I-MORT-CODE
 13595         END-IF
 13596     END-IF
 13597
 13598     .
 13599 3240-CONTINUE.
 13600
 13601     IF PB-COMPANY-ID NOT = 'GNL'
 13602         GO TO 3256-CONTINUE.
 13603
 13604     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13605         MOVE 'A300' TO PB-I-MORT-CODE
 13606     ELSE
 13607         MOVE '8350' TO PB-I-MORT-CODE.
 13608
 13609 3256-CONTINUE.
 13610     IF PB-COMPANY-ID NOT = 'ABL'
 13611         GO TO 3260-EDIT-CONTINUE.
 13612
 13613     IF PB-I-LF-TERM GREATER THAN 59
 13614         MOVE 'F550' TO PB-I-MORT-CODE
 13615     ELSE
 13616         MOVE 'E550' TO PB-I-MORT-CODE.
 13617
 13618 3260-EDIT-CONTINUE.
 13619     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13620
 13621 3290-EDIT-LF-REIN-RATE.
 13622     IF LF-REIN-NSP-NOT-USED
 13623         GO TO 3290-RATING-CONT.
 13624
 13625     IF PB-COMPANY-ID = 'DCC'
 13626        GO TO 3290-RATING-CONT.
 13627     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13628     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13629     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13630     MOVE '3'                   TO CP-PROCESS-TYPE.
 13631     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13632
 13633******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13634     IF PB-COMPANY-ID EQUAL 'CDL'
 13635         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13636            CP-EARN-AS-NET-PAY)
 13637             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13638*            MOVE SPACE          TO DC-OPTION-CODE
 13639             SET BIN-TO-GREG     TO TRUE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 248
* EL050.cbl
 13640             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13641***  Y2K PROJ 7744
 13642             IF DC-GREG-DATE-CYMD GREATER 19931231
 13643                 MOVE '1'        TO CP-EARNING-METHOD.
 13644***  Y2K PROJ 7744
 13645*******
 13646
 13647     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13648     MOVE PB-SV-STATE           TO CP-STATE.
 13649     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13650     MOVE ZERO                  TO CP-DEVIATION-CODE
 13651                                   CP-RATE-DEV-PCT.
 13652     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13653     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13654                                   CP-RATING-BENEFIT-AMT.
 13655
 13656************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13657     IF PB-COMPANY-ID EQUAL 'NCB'
 13658         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13659            CP-EARN-AS-NET-PAY
 13660             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13661                 PB-I-LF-PREMIUM-AMT.
 13662************
 13663
 13664     IF CP-STATE-STD-ABBRV = 'OR'
 13665         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13666                                         PB-I-LF-ALT-BENEFIT-AMT.
 13667     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13668     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13669     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13670     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13671     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13672     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13673     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13674     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13675                                   CP-REMAINING-TERM
 13676                                   CP-LOAN-TERM.
 13677     IF CP-TRUNCATED-LIFE
 13678        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13679
 13680     IF CP-TERM-IS-DAYS
 13681         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13682     ELSE
 13683         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13684
 13685     IF PB-COMPANY-ID = 'DCC'
 13686        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13687     END-IF
 13688     IF PB-COMPANY-ID NOT = 'TIC'
 13689          MOVE ZERO          TO CP-CLASS-CODE.
 13690
 13691     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13692
 13693     MOVE 'R'                   TO CP-RATE-FILE.
 13694     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13695
 13696     IF CP-ERROR-RATE-NOT-FOUND
 13697        IF PB-I-OB
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 249
* EL050.cbl
 13698           MOVE ER-2625      TO WS-ERROR
 13699           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13700           GO TO 3299-EDIT-CONTINUE
 13701        ELSE
 13702           MOVE ER-2643      TO WS-ERROR
 13703           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13704           GO TO 3299-EDIT-CONTINUE.
 13705
 13706     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13707
 13708     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13709     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13710
 13711     IF PB-I-LF-REI-RATE = ZERO
 13712         MOVE ER-2643        TO WS-ERROR
 13713         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13714
 13715 3290-CHECK-ALT-REIN-RATE.
 13716
 13717     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13718        GO TO 3290-RATING-CONT.
 13719
 13720     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13721     MOVE '2'                    TO CP-EARNING-METHOD.
 13722     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13723     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13724     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13725     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13726                                     CP-RATING-BENEFIT-AMT.
 13727     IF CP-STATE-STD-ABBRV = 'OR'
 13728         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13729                                         PB-I-LF-ALT-BENEFIT-AMT.
 13730     IF PB-COMPANY-ID = 'DCC'
 13731        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13732     END-IF
 13733     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13734     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13735     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13736                                    CP-REMAINING-TERM
 13737                                    CP-LOAN-TERM.
 13738     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13739        ADD +1                   TO CP-ORIGINAL-TERM
 13740                                    CP-REMAINING-TERM
 13741                                    CP-LOAN-TERM.
 13742
 13743     MOVE 'R'                   TO CP-RATE-FILE.
 13744     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13745
 13746     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13747
 13748     IF PB-I-LF-ALT-REI-RATE = ZERO
 13749         MOVE ER-2643            TO WS-ERROR
 13750         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13751
 13752 3290-RATING-CONT.
 13753
 13754     IF PB-I-OB
 13755*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 250
* EL050.cbl
 13756        GO TO 3300-CHECK-AH-RATES.
 13757
 13758 3299-EDIT-CONTINUE.
 13759
 13760     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13761         NEXT SENTENCE
 13762     ELSE
 13763         MOVE ER-2620           TO WS-ERROR
 13764         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13765
 13766 3300-CHECK-AH-RATES.
 13767     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13768         NEXT SENTENCE
 13769     ELSE
 13770         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13771
 13772     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13773        ((CF-COMPANY-ID = 'DMD') AND
 13774                (NO-DMD-RATING))
 13775         IF (PB-COMPANY-ID = 'DCC')
 13776            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13777            CONTINUE
 13778         ELSE
 13779            MOVE ER-2687         TO WS-ERROR
 13780            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13781         END-IF
 13782         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13783         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13784     END-IF
 13785
 13786     IF PB-I-OB
 13787        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13788
 13789     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13790         MOVE ER-2687             TO WS-ERROR
 13791         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13792         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13793         GO TO 3999-END-EDIT.
 13794
 13795*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13796
 13797     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13798        IF PB-I-AH-CRIT-PER = ZERO
 13799           IF PB-COMPANY-ID = 'DCC'
 13800              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13801              CONTINUE
 13802           ELSE
 13803              MOVE ER-2618       TO WS-ERROR
 13804              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13805              GO TO 3999-END-EDIT
 13806           END-IF
 13807        END-IF
 13808     END-IF
 13809     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13810     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13811     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13812     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13813     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 251
* EL050.cbl
 13814     MOVE PB-SV-STATE            TO CP-STATE.
 13815     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13816     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13817     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13818*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13819     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13820     MOVE '3'                    TO CP-PROCESS-TYPE.
 13821     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13822     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13823                                    CP-RATING-BENEFIT-AMT.
 13824     IF PB-COMPANY-ID = 'CID'
 13825               OR
 13826        CP-STATE-STD-ABBRV = 'OR'
 13827         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13828                                         PB-I-AH-TERM.
 13829     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13830        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13831           AND (PB-I-POLICY-IS-MONTHLY)
 13832           MOVE PB-I-LF-BENEFIT-AMT
 13833                                 TO CP-NET-BENEFIT-AMT
 13834           move pb-i-ah-premium-amt to cp-original-premium
 13835        END-IF
 13836     END-IF
 13837     MOVE SPACES                 TO CP-BEN-CATEGORY
 13838     IF PB-COMPANY-ID = 'DCC'
 13839        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13840        EVALUATE TRUE
 13841           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13842              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13843              MOVE PB-I-LF-BENEFIT-AMT
 13844                                 TO CP-RATING-BENEFIT-AMT
 13845              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13846           WHEN WS-AH-BEN-CATEGORY = 'G'
 13847              MOVE PB-I-UNPAID-CASH-PRICE
 13848                                 TO CP-RATING-BENEFIT-AMT
 13849           WHEN WS-AH-BEN-CATEGORY = 'D'
 13850              MOVE WS-AH-PMF-COMM
 13851                                 TO CP-DCC-PMF-COMM
 13852              MOVE PB-I-AH-COMMISSION
 13853                                 TO CP-DCC-ACT-COMM
 13854        END-EVALUATE
 13855     END-IF
 13856     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13857     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13858     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13859     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13860     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13861     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13862     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13863                                    CP-REMAINING-TERM
 13864                                    WS-WORK-TERM.
 13865     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13866
 13867     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13868     SET BIN-TO-GREG             TO TRUE.
 13869*    MOVE ' '                    TO DC-OPTION-CODE.
 13870     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13871     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 252
* EL050.cbl
 13872
 13873     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13874     IF NOT VALID-SKIP-CODE
 13875         MOVE ER-2683            TO WS-ERROR
 13876         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13877         GO TO 3320-RATE-CONTINUE.
 13878
 13879     IF PB-NO-MONTHS-SKIPPED
 13880         GO TO 3320-RATE-CONTINUE.
 13881
 13882     MOVE SPACE TO NUMBER-OF-MONTHS.
 13883
 13884     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13885         MOVE 'S'                TO SK-MO (6).
 13886     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13887         MOVE 'S'                TO SK-MO (7).
 13888     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13889         MOVE 'S'                TO SK-MO (8).
 13890     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13891         MOVE 'S'                TO SK-MO (9).
 13892     IF PB-I-SKIP-CODE = 'A'
 13893         MOVE 'S'                TO SK-MO (10).
 13894
 13895     MOVE 1                      TO SUB2.
 13896     MOVE PB-I-AH-TERM           TO SUB3.
 13897     MOVE WS-MONTH               TO SUB1.
 13898     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13899     GO TO 3320-RATE-CONTINUE.
 13900
 13901 3310-GET-SKIP-MO.
 13902     IF SUB1 = 13
 13903         MOVE 1                  TO SUB1.
 13904
 13905     IF SK-MO (SUB1) = 'S'
 13906         SUBTRACT 1 FROM WS-WORK-TERM.
 13907
 13908     ADD 1 TO SUB2
 13909              SUB1.
 13910
 13911 3320-RATE-CONTINUE.
 13912
 13913     IF WS-WORK-TERM = ZERO
 13914         MOVE 1                  TO WS-WORK-TERM.
 13915
 13916     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 13917                                    CP-LOAN-TERM.
 13918
 13919     IF PB-COMPANY-ID EQUAL 'DMD'
 13920         NEXT SENTENCE
 13921     ELSE
 13922         MOVE ZERO               TO PB-I-AH-RATE
 13923                                    PB-I-AH-REI-RATE.
 13924
 13925
 13926     IF PB-COMPANY-ID EQUAL 'CRI'
 13927        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13928
 13929     IF PB-COMPANY-ID = 'CSL'
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 253
* EL050.cbl
 13930         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 13931         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 13932         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13933         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13934
 13935     IF PB-COMPANY-ID = 'DCC'
 13936        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 13937           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 13938              PB-I-RATE-DEV-PCT-LF
 13939        END-IF
 13940        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13941                                 TO CP-ALTERNATE-BENEFIT
 13942        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13943        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13944        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13945     END-IF
 13946     IF (PB-COMPANY-ID = 'CID')
 13947        AND (WS-LF-EARNINGS-CALC = 'B')
 13948        AND (CP-STATE-STD-ABBRV = 'MN')
 13949        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 13950     ELSE
 13951        MOVE ' '                 TO CP-AH-BALLOON-SW
 13952     END-IF
 13953     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 13954     MOVE 'R'                   TO CP-RATE-FILE.
 13955     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13956
 13957     IF CP-ERROR-RATE-NOT-FOUND
 13958        IF PB-I-OB
 13959           MOVE ER-2624          TO WS-ERROR
 13960           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13961           GO TO 3340-CALCULATE-PREMIUM-AMT
 13962        ELSE
 13963          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13964              NEXT SENTENCE
 13965          ELSE
 13966           MOVE ER-2642          TO WS-ERROR
 13967           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13968           GO TO 3340-CALCULATE-PREMIUM-AMT.
 13969
 13970     IF PB-COMPANY-ID EQUAL 'CSL' AND
 13971        CP-ERROR-DIV-BY-ZERO
 13972           MOVE ER-3782          TO WS-ERROR
 13973           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13974
 13975     IF PB-COMPANY-ID EQUAL 'CRI'
 13976        IF CP-ERROR-NO-LIMITS-CRI
 13977           IF NOT ACCOUNT-AH-CHECKED
 13978              MOVE ER-2607          TO WS-ERROR
 13979              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13980
 13981     IF ACCOUNT-AH-CHECKED
 13982        NEXT SENTENCE
 13983     ELSE
 13984       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13985          MOVE ER-2640           TO WS-ERROR
 13986          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13987
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 254
* EL050.cbl
 13988     IF PB-COMPANY-ID = 'CRI'
 13989         IF WS-ERROR = ER-2640
 13990             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13991     IF ACCOUNT-AH-CHECKED
 13992        CONTINUE
 13993     ELSE
 13994        IF (CP-R-MAX-ATT-AGE NUMERIC)
 13995           AND (CP-R-MAX-ATT-AGE > +0)
 13996           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 13997           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 13998              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 13999              MOVE PB-I-AH-EXPIRE-DT
 14000                                 TO DC-BIN-DATE-2
 14001              MOVE '1'           TO DC-OPTION-CODE
 14002              PERFORM 8500-DATE-CONVERT
 14003                                 THRU 8500-EXIT
 14004              IF NO-CONVERSION-ERROR
 14005                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14006                    MOVE ER-2661       TO WS-ERROR
 14007*                   PERFORM 9900-ERROR-FORMAT
 14008*                                THRU 9900-EXIT
 14009                 END-IF
 14010              END-IF
 14011           ELSE
 14012              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14013              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14014                 MOVE ER-2661    TO WS-ERROR
 14015*                PERFORM 9900-ERROR-FORMAT
 14016*                                THRU 9900-EXIT
 14017              ELSE
 14018                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14019                    MOVE ER-1570 TO WS-ERROR
 14020                    PERFORM 9900-ERROR-FORMAT
 14021                                 THRU 9900-EXIT
 14022                 END-IF
 14023              END-IF
 14024           END-IF
 14025           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14026              MOVE PB-I-JOINT-BIRTHDAY
 14027                                    TO DC-BIN-DATE-1
 14028              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14029              MOVE '1'              TO DC-OPTION-CODE
 14030              PERFORM 8500-DATE-CONVERT
 14031                                    THRU 8500-EXIT
 14032              IF NO-CONVERSION-ERROR
 14033                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14034                    MOVE ER-2661       TO WS-ERROR
 14035*                   PERFORM 9900-ERROR-FORMAT
 14036*                                   THRU 9900-EXIT
 14037                 END-IF
 14038              END-IF
 14039           ELSE
 14040              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14041                (PB-I-AH-TERM / 12)
 14042              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14043                 MOVE ER-2661       TO WS-ERROR
 14044*                PERFORM 9900-ERROR-FORMAT
 14045*                                   THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 255
* EL050.cbl
 14046              ELSE
 14047                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14048                    MOVE ER-1571 TO WS-ERROR
 14049                    PERFORM 9900-ERROR-FORMAT
 14050                                 THRU 9900-EXIT
 14051                 END-IF
 14052              END-IF
 14053           END-IF
 14054           IF WS-ERROR = ER-2661
 14055              PERFORM 9900-ERROR-FORMAT
 14056                                    THRU 9900-EXIT
 14057           END-IF
 14058        END-IF
 14059     END-IF
 14060*    IF ACCOUNT-AH-CHECKED
 14061*       NEXT SENTENCE
 14062*    ELSE
 14063*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14064*          MOVE ER-2661          TO WS-ERROR
 14065*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14066
 14067     IF ACCOUNT-AH-CHECKED
 14068        NEXT SENTENCE
 14069     ELSE
 14070        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14071           MOVE ER-2663          TO WS-ERROR
 14072           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14073
 14074     IF ACCOUNT-AH-CHECKED OR
 14075        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14076         PB-POLICY-IS-VOIDED
 14077        NEXT SENTENCE
 14078     ELSE
 14079        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14080           MOVE ER-2667            TO WS-ERROR
 14081           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14082
 14083     IF PB-COMPANY-ID = 'CRI'
 14084         IF WS-ERROR = ER-2667
 14085             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14086
 14087     IF ACCOUNT-AH-CHECKED
 14088        NEXT SENTENCE
 14089     ELSE
 14090        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14091           MOVE ER-2678            TO WS-ERROR
 14092           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14093
 14094     IF CP-ERROR-RATE-FILE-NOTOPEN
 14095         GO TO 3990-FILES-NOT-OPEN.
 14096
 14097 3321-CONTINUE.
 14098     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14099     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14100     IF (PB-COMPANY-ID = 'DCC')
 14101        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14102        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14103                                    PB-I-LF-ALT-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 256
* EL050.cbl
 14104        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14105        IF WS-AH-BEN-CATEGORY = 'G'
 14106           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14107           + PB-I-ADDL-CLP)
 14108           * (1 + WS-TOL-CLP-PCT)
 14109*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14110        ELSE
 14111           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14112           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14113*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14114        END-IF
 14115        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14116                                 TO PB-I-AH-PREM-CALC
 14117        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14118           MOVE ER-8152          TO WS-ERROR
 14119           PERFORM 9900-ERROR-FORMAT
 14120                                 THRU 9900-EXIT
 14121        ELSE
 14122           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14123                 PB-I-ADDL-CLP)
 14124              MOVE ER-8148       TO WS-ERROR
 14125              PERFORM 9900-ERROR-FORMAT
 14126                                 THRU 9900-EXIT
 14127           END-IF
 14128        END-IF
 14129     END-IF
 14130     IF (PB-COMPANY-ID = 'DCC')
 14131        AND (PB-I-POLICY-IS-MONTHLY)
 14132        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14133        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14134        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14135           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14136        END-IF
 14137     END-IF
 14138     IF (PB-COMPANY-ID = 'DCC')
 14139        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14140        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14141        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14142        MOVE ER-2786             TO WS-ERROR
 14143        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14144     END-IF
 14145     MOVE +0                     TO PB-I-AH-CLP
 14146     IF PB-COMPANY-ID = 'DCC'
 14147        IF WS-AH-BEN-CATEGORY = 'D'
 14148           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14149              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14150        ELSE
 14151           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14152              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14153           END-IF
 14154        END-IF
 14155     END-IF
 14156     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14157
 14158     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14159         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14160
 14161     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 257
* EL050.cbl
 14162         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14163
 14164     IF PB-COMPANY-ID = 'CRI'
 14165         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14166            PB-I-PAYMENT-AMOUNT = ZERO
 14167             NEXT SENTENCE
 14168         ELSE
 14169             COMPUTE PB-I-AH-PREM-CALC =
 14170                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14171                 (CP-PREMIUM-RATE / 100)
 14172             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14173                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14174                                             PB-I-RATE-DEV-PCT-AH.
 14175
 14176     IF PB-I-AH-RATE  = ZERO
 14177       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14178           NEXT SENTENCE
 14179       ELSE
 14180         MOVE ER-2642            TO WS-ERROR
 14181         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14182
 14183     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14184     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14185     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14186     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14187     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14188     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14189
 14190     IF (PB-COMPANY-ID = 'DCC')
 14191        AND (WS-AH-BEN-CATEGORY = 'G')
 14192        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14193        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14194        IF CP-DEVIATION-CODE NOT = '000'
 14195           MOVE '000'            TO CP-DEVIATION-CODE
 14196           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14197           IF NO-CP-ERROR
 14198              COMPUTE PB-I-DDF-IU-RATE-UP =
 14199              PB-I-AH-CLP - CP-CALC-PREMIUM
 14200           ELSE
 14201              MOVE ER-3057        TO WS-ERROR
 14202              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14203           END-IF
 14204        END-IF
 14205     END-IF
 14206     .
 14207 3335-EDIT-AH-REIN-NSP-RATE.
 14208     IF AH-REIN-NSP-NOT-USED
 14209         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14210
 14211     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14212     IF PB-COMPANY-ID = 'DCC'
 14213         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14214     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14215     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14216     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14217     MOVE PB-SV-STATE            TO CP-STATE.
 14218     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14219     MOVE ZERO                   TO CP-DEVIATION-CODE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 258
* EL050.cbl
 14220                                    CP-RATE-DEV-PCT.
 14221*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14222     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14223     MOVE '3'                    TO CP-PROCESS-TYPE.
 14224     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14225     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14226                                    CP-RATING-BENEFIT-AMT.
 14227     IF CP-STATE-STD-ABBRV = 'OR'
 14228         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14229                                         PB-I-AH-TERM.
 14230     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14231     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14232     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14233     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14234     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14235     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14236                                    CP-REMAINING-TERM
 14237                                    WS-WORK-TERM.
 14238     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14239     IF PB-COMPANY-ID = 'DCC'
 14240        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14241     END-IF
 14242     IF  PB-COMPANY-ID = 'TIC'
 14243         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14244            MOVE ZERO TO CP-CLASS-CODE.
 14245
 14246     IF PB-COMPANY-ID NOT = 'TIC'
 14247          MOVE ZERO          TO CP-CLASS-CODE.
 14248
 14249     MOVE ZERO               TO CP-DEVIATION-CODE.
 14250
 14251     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14252
 14253     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14254
 14255     MOVE 'R'                   TO CP-RATE-FILE.
 14256     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14257
 14258     IF CP-ERROR-RATE-NOT-FOUND
 14259         MOVE ER-2645        TO WS-ERROR
 14260         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14261         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14262
 14263     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14264
 14265     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14266     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14267
 14268     IF PB-I-AH-REI-RATE = ZERO
 14269         MOVE ER-2645        TO WS-ERROR
 14270         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14271
 14272
 14273 3340-CALCULATE-PREMIUM-AMT.
 14274
 14275     IF PB-COMPANY-ID = 'NCL'
 14276         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14277             WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 259
* EL050.cbl
 14278             GO TO 3999-END-EDIT.
 14279
 14280     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14281                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14282                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14283                         OR 'AHL'
 14284         NEXT SENTENCE
 14285     ELSE
 14286         IF WS-STATE-ABBREVIATION = 'CT'
 14287             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14288                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14289                 COMPUTE PB-I-LF-PREM-CALC =
 14290                                     PB-I-LF-PREM-CALC * .90
 14291                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14292                                     PB-I-LF-ALT-PREM-CALC * .90
 14293                 COMPUTE PB-I-AH-PREM-CALC =
 14294                                     PB-I-AH-PREM-CALC * .90.
 14295
 14296     IF PB-COMP-LF-PREM
 14297        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14298        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14299
 14300     IF PB-COMP-AH-PREM
 14301        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14302
 14303 3340-CHECK-DCC-TOT-FEES.
 14304     IF (PB-COMPANY-ID = 'DCC')
 14305        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14306        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14307        AND (PB-I-POLICY-IS-MONTHLY)
 14308        CONTINUE
 14309     ELSE
 14310        GO TO 3340-EDIT-LF-AH-TOL
 14311     END-IF
 14312     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14313     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14314     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14315        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14316           PB-I-RATE-DEV-PCT-LF
 14317     END-IF
 14318     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14319        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14320           PB-I-RATE-DEV-PCT-AH
 14321     END-IF
 14322     MOVE 'N'                    TO CP-BEN-CATEGORY
 14323     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14324
 14325     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14326     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14327     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14328     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14329     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14330     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14331     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14332     MOVE '3'                    TO CP-PROCESS-TYPE.
 14333     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14334     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14335
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 260
* EL050.cbl
 14336     MOVE PB-SV-STATE            TO CP-STATE.
 14337     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14338     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14339     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14340     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14341     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14342                                    CP-RATING-BENEFIT-AMT.
 14343     IF CP-STATE-STD-ABBRV = 'OR'
 14344         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14345                                         PB-I-LF-ALT-BENEFIT-AMT.
 14346     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14347     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14348     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14349     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14350     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14351     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14352     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14353     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14354     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14355                                    CP-REMAINING-TERM
 14356                                    CP-LOAN-TERM.
 14357
 14358     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14359         NEXT SENTENCE
 14360     ELSE
 14361         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14362             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14363                                           PB-I-LF-PREMIUM-AMT.
 14364
 14365     IF CP-TRUNCATED-LIFE
 14366        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14367
 14368     IF CP-TERM-IS-DAYS
 14369         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14370     ELSE
 14371         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14372
 14373     IF PB-COMPANY-ID = 'DCC'
 14374        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14375     END-IF
 14376     IF CP-SPECIAL-CALC-CD = 'H'
 14377         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14378                                    TO CP-ALTERNATE-BENEFIT
 14379         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14380     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14381     MOVE 'R'                    TO CP-RATE-FILE
 14382     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14383     IF NOT CP-ERROR-RATE-NOT-FOUND
 14384        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14385        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14386           AND (CP-BENEFIT-CD (1:1) = 'S')
 14387           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14388                                    PB-I-LF-PREMIUM-AMT
 14389        END-IF
 14390     ELSE
 14391        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14392     END-IF
 14393     .
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 261
* EL050.cbl
 14394 3340-EDIT-LF-AH-TOL.
 14395
 14396***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14397***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14398***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14399***
 14400     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14401         PB-I-AH-PREMIUM-AMT
 14402          GIVING WS-CALC-WORK.
 14403
 14404     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14405        AND WS-CALC-WORK NOT = ZERO
 14406         MOVE ER-2649            TO WS-ERROR
 14407         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14408
 14409     SUBTRACT PB-I-LF-PREM-CALC
 14410             FROM PB-I-LF-PREMIUM-AMT
 14411                 GIVING WS-UNSIGN-WRK1.
 14412
 14413     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14414             FROM PB-I-LF-ALT-PREMIUM-AMT
 14415                 GIVING WS-UNSIGN-WRK4.
 14416
 14417     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14418                                + WS-UNSIGN-WRK4.
 14419
 14420     SUBTRACT PB-I-AH-PREM-CALC
 14421             FROM PB-I-AH-PREMIUM-AMT
 14422                 GIVING WS-UNSIGN-WRK2.
 14423
 14424******************************************************************
 14425*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14426******************************************************************
 14427
 14428     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14429         MOVE ZERO TO WS-UNSIGN-WRK1.
 14430
 14431     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14432         MOVE ZERO TO WS-UNSIGN-WRK2.
 14433
 14434     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14435             GIVING WS-UNSIGN-WRK3.
 14436
 14437 3342-CONTINUE.
 14438
 14439     IF (PB-I-LF-RATE = ZERO  AND
 14440         PB-I-AH-RATE = ZERO)
 14441         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14442            WS-AH-SPECIAL-CALC-CD = 'O'
 14443              NEXT SENTENCE
 14444         ELSE
 14445             GO TO 3345-EDIT-CONTINUE.
 14446
 14447     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14448         NEXT SENTENCE
 14449     ELSE
 14450     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14451        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 262
* EL050.cbl
 14452           IF (PB-REISSUED-CERT         OR
 14453               PB-POLICY-IS-DECLINED    OR
 14454               PB-POLICY-IS-VOIDED)
 14455              NEXT SENTENCE
 14456           ELSE
 14457              IF WS-PREM-REJECT-SW = SPACE
 14458                 MOVE ER-2652    TO WS-ERROR
 14459                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14460                 GO TO 3344-CHECK-AH
 14461              ELSE
 14462                 MOVE ER-2650    TO WS-ERROR
 14463                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14464                 GO TO 3344-CHECK-AH.
 14465
 14466***
 14467***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14468***
 14469
 14470     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14471         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14472            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14473             (1 + WS-TOL-LF-PREM-PCT)
 14474         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14475            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14476             (1 - WS-TOL-LF-PREM-PCT)
 14477     ELSE
 14478         MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT
 14479         MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.
 14480
 14481***
 14482***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14483***
 14484
 14485     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14486         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14487          WS-TOL-LF-PREM.
 14488
 14489     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14490         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14491          WS-TOL-LF-PREM.
 14492
 14493     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14494        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14495
 14496     IF (PB-REISSUED-CERT        OR
 14497         PB-POLICY-IS-DECLINED   OR
 14498         PB-POLICY-IS-VOIDED)
 14499        NEXT SENTENCE
 14500     ELSE
 14501     IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14502           GREATER THAN  WS-TOL-LF-HIGH-PREM-AMT)
 14503       OR
 14504        ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14505           LESS THAN WS-TOL-LF-LOW-PREM-AMT))
 14506       AND
 14507        (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14508           GREATER WS-TOL-LF-HIGH-PREM-PCT)
 14509         OR
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 263
* EL050.cbl
 14510          ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14511           LESS WS-TOL-LF-LOW-PREM-PCT))
 14512              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE
 14513                  MOVE ER-2652   TO  WS-ERROR
 14514                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14515              ELSE
 14516                  MOVE ER-2650   TO  WS-ERROR
 14517                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14518
 14519*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14520*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14521*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14522*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14523
 14524     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14525        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14526                      OR
 14527           ((PB-COMPANY-ID = 'DCC')
 14528           AND (PB-I-LF-BENEFIT-CD = '00' OR '  '))
 14529           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14530           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14531        END-IF
 14532     END-IF
 14533
 14534     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14535        IF WS-COMP-MAX-CAP GREATER THAN +0
 14536           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14537              IF (PB-REISSUED-CERT         OR
 14538                  PB-POLICY-IS-DECLINED    OR
 14539                  PB-POLICY-IS-VOIDED)
 14540                 NEXT SENTENCE
 14541              ELSE
 14542                  MOVE ER-2646   TO  WS-ERROR
 14543                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14544
 14545 3344-CVL-TOLERANCE-CHECK.
 14546
 14547      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14548          GO TO 3344-CHECK-AH.
 14549
 14550      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14551          GO TO 3344-CHECK-AH.
 14552
 14553      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14554                                     WS-UNSIGN-WRK6.
 14555
 14556      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14557          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14558                                 + PB-I-LF-PREMIUM-AMT
 14559                                 - PB-I-LF-PREM-CALC.
 14560
 14561      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14562          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14563                                 + PB-I-LF-ALT-PREMIUM-AMT
 14564                                 - PB-I-LF-ALT-PREM-CALC.
 14565
 14566      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14567          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 264
* EL050.cbl
 14568              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14569                 MOVE ER-2652    TO  WS-ERROR
 14570                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14571              ELSE
 14572                 MOVE ER-2650    TO  WS-ERROR
 14573                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14574
 14575      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14576          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14577              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14578                 MOVE ER-2652    TO  WS-ERROR
 14579                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14580              ELSE
 14581                 MOVE ER-2650    TO  WS-ERROR
 14582                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14583
 14584 3344-CHECK-AH.
 14585
 14586****************************************************************
 14587***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14588***
 14589
 14590     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14591         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14592             (1 + WS-TOL-AH-PREM-PCT)
 14593         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14594             (1 - WS-TOL-AH-PREM-PCT)
 14595     ELSE
 14596         MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT
 14597         MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.
 14598
 14599***
 14600***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14601***
 14602
 14603     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14604         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14605
 14606     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14607         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14608
 14609     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14610        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14611
 14612     IF (PB-REISSUED-CERT)
 14613        OR (PB-POLICY-IS-DECLINED)
 14614        OR (PB-POLICY-IS-VOIDED)
 14615        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14616        CONTINUE
 14617     ELSE
 14618        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14619            OR
 14620           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14621           AND
 14622           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14623           OR
 14624           (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14625           IF WS-PREM-REJECT-SW = SPACE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 265
* EL050.cbl
 14626              MOVE ER-3052       TO WS-ERROR
 14627              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14628           ELSE
 14629              MOVE ER-3050       TO WS-ERROR
 14630              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14631           END-IF
 14632        END-IF
 14633     END-IF
 14634
 14635     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14636         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14637             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14638             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14639
 14640     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14641        IF WS-COMP-MAX-CAP GREATER THAN +0
 14642           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14643              IF (PB-REISSUED-CERT         OR
 14644                  PB-POLICY-IS-DECLINED    OR
 14645                  PB-POLICY-IS-VOIDED)
 14646                 NEXT SENTENCE
 14647              ELSE
 14648                  MOVE ER-2646   TO  WS-ERROR
 14649                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14650
 14651     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14652        (WS-COMP-MAX-CAP EQUAL +0)
 14653           GO TO 3345-EDIT-CONTINUE.
 14654
 14655     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14656        GREATER THAN WS-COMP-MAX-CAP
 14657           MOVE ER-2646          TO  WS-ERROR
 14658           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14659
 14660 3345-EDIT-CONTINUE.
 14661
 14662*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14663*       IF PB-ENTRY-BATCH   NUMERIC
 14664*          IF PB-ISSUE
 14665*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14666*          ELSE
 14667*              IF PB-CANCELLATION
 14668*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14669
 14670*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14671*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14672*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14673*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14674*        ELSE
 14675*            MOVE  ER-1909            TO  WS-ERROR
 14676*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14677
 14678     IF PB-I-POLICY-ACCEPTED
 14679        IF PB-POLICY-IS-DECLINED  OR
 14680           PB-REISSUED-CERT  OR
 14681           PB-REIN-ONLY-CERT  OR
 14682           PB-POLICY-IS-VOIDED
 14683            MOVE  ER-1891         TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 266
* EL050.cbl
 14684            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14685        ELSE
 14686            MOVE SPACE            TO  PB-BATCH-ENTRY
 14687            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14688
 14689     IF PB-I-POLICY-DECLINED
 14690        IF PB-REISSUED-CERT  OR
 14691           PB-REIN-ONLY-CERT  OR
 14692           PB-POLICY-IS-VOIDED
 14693            MOVE  ER-1906         TO  WS-ERROR
 14694            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14695        ELSE
 14696            MOVE  'D'             TO  PB-BATCH-ENTRY
 14697                                      PB-I-ENTRY-STATUS.
 14698
 14699     IF PB-I-NEEDS-UNDERWRITING
 14700        IF PB-POLICY-IS-DECLINED OR
 14701           PB-REISSUED-CERT  OR
 14702           PB-REIN-ONLY-CERT  OR
 14703           PB-POLICY-IS-VOIDED
 14704            MOVE  ER-1907         TO  WS-ERROR
 14705            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14706        ELSE
 14707            MOVE 'U'              TO  PB-BATCH-ENTRY
 14708                                      PB-I-ENTRY-STATUS.
 14709
 14710     IF PB-NEEDS-UNDERWRITING
 14711        MOVE  ER-1901             TO  WS-ERROR
 14712        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14713     IF PB-COMPANY-ID = 'DCC'
 14714        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14715        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14716        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14717           AND (NOT WS-LF-CASH))
 14718                           OR
 14719           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14720           AND (NOT WS-AH-CASH)))
 14721                       AND
 14722           (PB-I-ENTRY-STATUS NOT = '5')
 14723           MOVE 'M'              TO PB-BATCH-ENTRY
 14724                                    PB-I-ENTRY-STATUS
 14725        END-IF
 14726     END-IF
 14727     IF  PB-COMPANY-ID NOT = 'NCL'
 14728         GO TO 3999-END-EDIT.
 14729
 14730     IF PB-REISSUED-CERT  OR
 14731        PB-POLICY-IS-DECLINED  OR
 14732        PB-POLICY-IS-VOIDED  OR
 14733        PB-I-OB
 14734         GO TO 3999-END-EDIT.
 14735
 14736     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14737         MOVE  ER-2644            TO  WS-ERROR
 14738         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14739         GO TO 3999-END-EDIT.
 14740
 14741     MOVE 'N'                     TO  FORM-MASTER-SW.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 267
* EL050.cbl
 14742     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14743
 14744     IF NOT FORM-MASTER-FOUND
 14745         GO TO 3999-END-EDIT.
 14746
 14747     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14748                                      FORM-MASTER-AH-SW.
 14749
 14750     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14751         MOVE  +1                 TO SUB6
 14752         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14753
 14754     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14755         MOVE  +1                 TO SUB6
 14756         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14757
 14758     IF LF-FORM-MASTER-FOUND  OR
 14759        AH-FORM-MASTER-FOUND
 14760         GO TO 3360-CHECK-FORM-LIMITS
 14761     ELSE
 14762         GO TO 3999-END-EDIT.
 14763
 14764******************************************************************
 14765*                  3350-GET-ERFORM                               *
 14766*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14767*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14768******************************************************************
 14769
 14770 3350-GET-ERFORM.
 14771
 14772     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14773         GO TO  3350-ERFORM-GETMAIN.
 14774
 14775     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14776     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14777     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14778     MOVE 'Y'                     TO FORM-MASTER-SW.
 14779
 14780     IF PB-CANCELLATION
 14781         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14782            PB-SV-STATE          EQUAL   FO-STATE       AND
 14783            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14784              GO TO 3350-EXIT
 14785         ELSE
 14786             NEXT SENTENCE
 14787     ELSE
 14788         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14789            PB-SV-STATE          EQUAL   FO-STATE       AND
 14790            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14791              GO TO 3350-EXIT.
 14792
 14793 3350-ERFORM-GETMAIN.
 14794
 14795     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14796     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14797
 14798 3350-ERFORM-READ.
 14799
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 268
* EL050.cbl
 14800     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14801     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14802     IF PB-CANCELLATION
 14803         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14804     ELSE
 14805         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14806     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14807
 14808     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14809
 14810     IF FORM-MASTER-FOUND
 14811       IF PB-CANCELLATION
 14812          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14813             PB-SV-STATE          EQUAL   FO-STATE       AND
 14814             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14815              GO  TO 3350-EXIT
 14816          ELSE
 14817              NEXT SENTENCE
 14818       ELSE
 14819          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14820             PB-SV-STATE          EQUAL   FO-STATE       AND
 14821             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14822              GO  TO 3350-EXIT.
 14823
 14824     MOVE  'N'                    TO  FORM-MASTER-SW.
 14825     MOVE  ER-1895                TO  WS-ERROR.
 14826     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14827
 14828 3350-EXIT.
 14829      EXIT.
 14830
 14831******************************************************************
 14832*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14833*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14834*   VALID FOR THE POLICY FORM USED.                              *
 14835******************************************************************
 14836
 14837 3355-EDIT-FORM-LF-BENEFITS.
 14838
 14839     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14840        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14841         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14842         GO TO   3355-EXIT.
 14843
 14844     IF  SUB6    LESS THAN   +40
 14845         ADD  +1      TO  SUB6
 14846         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14847
 14848     MOVE  ER-1896         TO  WS-ERROR.
 14849     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14850
 14851 3355-EXIT.
 14852      EXIT.
 14853
 14854******************************************************************
 14855*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14856*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14857*   VALID FOR THE POLICY FORM USED.                              *
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 269
* EL050.cbl
 14858******************************************************************
 14859
 14860 3356-EDIT-FORM-AH-BENEFITS.
 14861
 14862     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14863        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14864         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14865         GO TO  3356-EXIT.
 14866
 14867      IF  SUB6    LESS THAN     +40
 14868          ADD  +1      TO  SUB6
 14869          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14870
 14871     MOVE  ER-1897         TO  WS-ERROR.
 14872     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14873
 14874 3356-EXIT.
 14875      EXIT.
 14876
 14877******************************************************************
 14878*                  3357-BENEFIT-SEARCH                           *
 14879*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 14880*   CANCELLATIONS ONLY.                                          *
 14881******************************************************************
 14882 3357-BENEFIT-SEARCH.
 14883     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 14884         MOVE +1                          TO SUB6
 14885         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 14886
 14887     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 14888         MOVE +1                          TO SUB6
 14889         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 14890
 14891 3357-EXIT.
 14892     EXIT.
 14893
 14894******************************************************************
 14895*                  3358-BENEFIT-LIFE-SEARCH                      *
 14896*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 14897*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14898*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14899******************************************************************
 14900 3358-BENEFIT-LIFE-SEARCH.
 14901     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 14902       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 14903         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14904           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14905              IF FO-PLAN-REFUND-METHOD (SUB6)
 14906                     IS GREATER THAN SPACES
 14907                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14908                                          WS-LF-REFUND-CALC
 14909                 GO TO 3358-EXIT.
 14910
 14911     IF SUB6 LESS THAN +40
 14912         ADD +1                 TO SUB6
 14913         GO TO 3358-BENEFIT-LIFE-SEARCH.
 14914
 14915 3358-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 270
* EL050.cbl
 14916     EXIT.
 14917******************************************************************
 14918*                  3359-BENEFIT-AH-SEARCH                        *
 14919*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 14920*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14921*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14922******************************************************************
 14923 3359-BENEFIT-AH-SEARCH.
 14924     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 14925       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 14926         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14927           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14928              IF FO-PLAN-REFUND-METHOD (SUB6)
 14929                      IS GREATER THAN SPACES
 14930                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14931                                          WS-AH-REFUND-CALC
 14932                 GO TO 3359-EXIT.
 14933
 14934     IF SUB6 LESS THAN +40
 14935         ADD +1                 TO SUB6
 14936         GO TO 3359-BENEFIT-AH-SEARCH.
 14937
 14938 3359-EXIT.
 14939     EXIT.
 14940
 14941******************************************************************
 14942*                  3360-CHECK-FORM-LIMITS                        *
 14943*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14944*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14945******************************************************************
 14946
 14947 3360-CHECK-FORM-LIMITS.
 14948
 14949     IF FO-IND-GRP-CD = 'I'  OR  'G'
 14950         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 14951
 14952     IF NOT LF-FORM-MASTER-FOUND
 14953         GO TO 3360-CHECK-FORM-AH-LIMITS.
 14954
 14955 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 14956
 14957     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 14958       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 14959        WS-LF-JOINT-INDICATOR = 'J'  AND
 14960        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14961         IF PB-COMPANY-ID = 'NCL'
 14962            MOVE  ER-1911          TO  WS-ERROR
 14963            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14964         ELSE
 14965            MOVE  ER-1892          TO  WS-ERROR
 14966            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14967
 14968 3360-CHECK-FORM-LF-ATT-AGE.
 14969
 14970     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 14971
 14972     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 14973         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 271
* EL050.cbl
 14974         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 14975            IF PB-COMPANY-ID = 'NCL'
 14976                MOVE  ER-1913      TO  WS-ERROR
 14977                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14978            ELSE
 14979                MOVE  ER-1894      TO  WS-ERROR
 14980                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14981
 14982 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 14983
 14984     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 14985         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 14986         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 14987            IF PB-COMPANY-ID = 'NCL'
 14988                MOVE  ER-1914      TO  WS-ERROR
 14989                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14990            ELSE
 14991                MOVE  ER-1899      TO  WS-ERROR
 14992                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14993
 14994 3360-CHECK-FORM-LF-TERM-BAMT.
 14995
 14996     IF  FO-LF-MAX-TERM   NUMERIC   AND
 14997         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 14998         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 14999           IF  PB-COMPANY-ID = 'NCL'
 15000               MOVE  ER-1916       TO  WS-ERROR
 15001               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15002           ELSE
 15003               MOVE  ER-1902       TO  WS-ERROR
 15004               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15005
 15006     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15007                                    PB-I-LF-ALT-BENEFIT-AMT.
 15008
 15009     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15010         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15011         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15012             IF  PB-COMPANY-ID = 'NCL'
 15013                 MOVE  ER-1918     TO  WS-ERROR
 15014                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15015             ELSE
 15016                 MOVE  ER-1904     TO  WS-ERROR
 15017                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15018
 15019******************************************************************
 15020*                  3360-CHECK-FORM-AH-LIMITS                     *
 15021*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15022*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15023******************************************************************
 15024
 15025 3360-CHECK-FORM-AH-LIMITS.
 15026
 15027     IF NOT AH-FORM-MASTER-FOUND
 15028         GO TO 3999-END-EDIT.
 15029
 15030 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15031
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 272
* EL050.cbl
 15032     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15033       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15034        WS-AH-JOINT-INDICATOR = 'J'  AND
 15035        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15036         IF PB-COMPANY-ID = 'NCL'
 15037            MOVE  ER-1912          TO  WS-ERROR
 15038            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15039         ELSE
 15040            MOVE  ER-1893          TO  WS-ERROR
 15041            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15042
 15043 3360-CHECK-FORM-AH-ATT-AGE.
 15044
 15045     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15046
 15047     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15048         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15049         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15050            IF PB-COMPANY-ID = 'NCL'
 15051                MOVE  ER-1913      TO  WS-ERROR
 15052                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15053            ELSE
 15054                MOVE  ER-1894      TO  WS-ERROR
 15055                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15056
 15057 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15058
 15059     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15060         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15061         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15062            IF PB-COMPANY-ID = 'NCL'
 15063                MOVE  ER-1915      TO  WS-ERROR
 15064                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15065            ELSE
 15066                MOVE  ER-1900      TO  WS-ERROR
 15067                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15068
 15069 3360-CHECK-FORM-AH-TERM-BAMT.
 15070
 15071     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15072         FO-AH-MAX-TERM    GREATER THAN  +0
 15073         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15074             IF  PB-COMPANY-ID = 'NCL'
 15075                 MOVE  ER-1917     TO  WS-ERROR
 15076                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15077             ELSE
 15078                  MOVE  ER-1903    TO  WS-ERROR
 15079                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15080
 15081     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15082         FO-MAX-AH-AMT    GREATER THAN  +0
 15083         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15084             IF  PB-COMPANY-ID = 'NCL'
 15085                 MOVE  ER-1919     TO  WS-ERROR
 15086                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15087             ELSE
 15088                 MOVE  ER-1905     TO  WS-ERROR
 15089                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 273
* EL050.cbl
 15090
 15091     GO TO 3999-END-EDIT.
 15092
 15093******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 274
* EL050.cbl
 15095******************************************************************
 15096*                  E D I T   C A N C E L                         *
 15097******************************************************************
 15098
 15099 3700-EDIT-CANCEL.
 15100     IF PB-COMPANY-ID = 'DMD'
 15101         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15102                                         WS-RES-MUNI-TAX
 15103                                         PB-CI-STATE-TAX
 15104                                         PB-CI-MUNI-TAX
 15105         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15106
 15107*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15108*       IF PB-ENTRY-BATCH  NUMERIC
 15109*          IF PB-CANCELLATION
 15110*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15111*          ELSE
 15112*             IF PB-ISSUE
 15113*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15114
 15115     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15116        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15117     END-IF
 15118*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15119*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15120
 15121     IF CM-ENTRY-STATUS = 'V'
 15122        MOVE ER-2780             TO WS-ERROR
 15123        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15124        GO TO 3999-END-EDIT.
 15125
 15126     IF CM-ENTRY-STATUS = 'D'
 15127        MOVE ER-2781             TO WS-ERROR
 15128        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15129        GO TO 3999-END-EDIT.
 15130
 15131     IF CM-ENTRY-STATUS = 'U'
 15132        MOVE ER-2782             TO WS-ERROR
 15133        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15134
 15135***************************************************************
 15136*                                                             *
 15137*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15138*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15139*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15140*   OF ANOTHER COVERAGE.                                      *
 15141*                                                             *
 15142***************************************************************
 15143
 15144     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15145                                    PB-C-AH-CANCEL-VOID-SW.
 15146
 15147     IF PB-C-LF-CANCEL-AMT = ZERO
 15148        NEXT SENTENCE
 15149     ELSE
 15150        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15151           AND
 15152           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 275
* EL050.cbl
 15153               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15154               MOVE ER-2745           TO WS-ERROR
 15155               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15156
 15157     IF PB-C-AH-CANCEL-AMT = ZERO
 15158        NEXT SENTENCE
 15159     ELSE
 15160        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15161           AND
 15162           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15163               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15164               MOVE ER-2745           TO WS-ERROR
 15165               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15166
 15167     IF WS-LF-EARNINGS-CALC = '4'
 15168        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15169
 15170     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15171     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15172     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15173     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15174     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15175     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15176
 15177     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15178                                      PB-C-AH-REF-CALC.
 15179     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15180
 15181******************************************************************
 15182*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15183*             TO VALIDATE COVERAGE.                              *
 15184******************************************************************
 15185
 15186     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15187        PB-C-LF-CANCEL-AMT = ZEROS
 15188          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15189      ELSE
 15190          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15191
 15192     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15193        PB-C-AH-CANCEL-AMT = ZEROS
 15194          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15195      ELSE
 15196          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15197
 15198     EVALUATE TRUE
 15199         WHEN PB-CANCEL-FORCE             OR
 15200              PB-CANCEL-DATE-FORCED       OR
 15201              PB-FORCE-OFF
 15202                  IF PB-COMPANY-ID = 'ACE'
 15203                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15204                  END-IF
 15205         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15206               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15207              (PB-COMPANY-ID = 'ACE' )
 15208                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15209         WHEN OTHER
 15210              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 276
* EL050.cbl
 15211                 MOVE ER-2794              TO WS-ERROR
 15212              ELSE
 15213                 MOVE ER-2749              TO WS-ERROR
 15214              END-IF
 15215              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15216     END-EVALUATE.
 15217
 15218
 15219*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15220*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15221*            MOVE  ER-1909            TO  WS-ERROR
 15222*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15223*        ELSE
 15224*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15225
 15226     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15227     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15228        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15229     ELSE
 15230        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15231     END-IF
 15232     .
 15233 3705-EDIT-CANCEL-DT.
 15234
 15235     IF LF-COVERAGE-CANCELLED
 15236        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15237         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15238         MOVE WS-CURRENT-MONTH-END
 15239                                 TO DC-BIN-DATE-2
 15240         SET ELAPSED-BETWEEN-BIN TO TRUE
 15241*        MOVE 1                  TO DC-OPTION-CODE
 15242         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15243         IF DATE-CONVERSION-ERROR
 15244            NEXT SENTENCE
 15245          ELSE
 15246             IF DC-ELAPSED-DAYS GREATER +180
 15247                IF PB-CANCEL-DATE-FORCED  OR
 15248                   PB-CANCEL-DATE-FORCED-NO-FEE
 15249                      MOVE ER-2751  TO WS-ERROR
 15250                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15251                 ELSE
 15252                   MOVE ER-2752  TO WS-ERROR
 15253                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15254
 15255     IF AH-COVERAGE-CANCELLED
 15256        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15257         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15258         MOVE WS-CURRENT-MONTH-END
 15259                                 TO DC-BIN-DATE-2
 15260         SET ELAPSED-BETWEEN-BIN TO TRUE
 15261*        MOVE 1                  TO DC-OPTION-CODE
 15262         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15263         IF DATE-CONVERSION-ERROR
 15264            NEXT SENTENCE
 15265          ELSE
 15266             IF DC-ELAPSED-DAYS GREATER +180
 15267                IF PB-CANCEL-DATE-FORCED OR
 15268                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 277
* EL050.cbl
 15269                      MOVE ER-2751  TO WS-ERROR
 15270                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15271                 ELSE
 15272                   MOVE ER-2752  TO WS-ERROR
 15273                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15274
 15275     IF WS-ERROR = ER-2752
 15276        AND (PB-COMPANY-ID = 'ABL'
 15277         OR  PB-COMPANY-ID = 'FGL'
 15278         OR  PB-COMPANY-ID = 'IST'
 15279         OR  PB-COMPANY-ID = 'JHL'
 15280         OR  PB-COMPANY-ID = 'LAP'
 15281         OR  PB-COMPANY-ID = 'LBL'
 15282         OR  PB-COMPANY-ID = 'NCB'
 15283         OR  PB-COMPANY-ID = 'NLI'
 15284         OR  PB-COMPANY-ID = 'OFI'
 15285         OR  PB-COMPANY-ID = 'PLI'
 15286         OR  PB-COMPANY-ID = 'TAO'
 15287         OR  PB-COMPANY-ID = 'TIC'
 15288         OR  PB-COMPANY-ID = 'HER'
 15289         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15290         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15291            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15292            MOVE ER-2762     TO WS-ERROR
 15293            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15294
 15295     IF LF-COVERAGE-CANCELLED
 15296        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15297        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15298             MOVE ER-2733         TO WS-ERROR
 15299             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15300
 15301     IF AH-COVERAGE-CANCELLED
 15302        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15303        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15304              MOVE ER-2733        TO WS-ERROR
 15305              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15306
 15307     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15308        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15309        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15310           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15311            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15312              IF PB-COMPANY-ID NOT = 'LAP'
 15313               MOVE ER-2704            TO WS-ERROR
 15314               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15315
 15316     IF CERT-WAS-NOT-FOUND
 15317         GO TO 3999-END-EDIT.
 15318
 15319     IF PB-COMPANY-ID EQUAL 'CDC'
 15320        IF LF-COVERAGE-CANCELLED
 15321           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15322            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15323            MOVE PB-C-LF-CANCEL-DT
 15324                                 TO DC-BIN-DATE-2
 15325            SET ELAPSED-BETWEEN-BIN TO TRUE
 15326*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 278
* EL050.cbl
 15327            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15328            IF DATE-CONVERSION-ERROR
 15329               NEXT SENTENCE
 15330             ELSE
 15331                IF DC-ELAPSED-DAYS GREATER +60
 15332                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15333
 15334     IF PB-COMPANY-ID EQUAL 'CDC'
 15335        IF AH-COVERAGE-CANCELLED
 15336           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15337            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15338            MOVE PB-C-AH-CANCEL-DT
 15339                                 TO DC-BIN-DATE-2
 15340            MOVE +0              TO DC-ELAPSED-DAYS
 15341                                    DC-ELAPSED-MONTHS
 15342            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15343*           MOVE 1               TO DC-OPTION-CODE
 15344            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15345            IF DATE-CONVERSION-ERROR
 15346               NEXT SENTENCE
 15347             ELSE
 15348                IF DC-ELAPSED-DAYS GREATER +60
 15349                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15350
 15351     MOVE +0                     TO DC-ELAPSED-DAYS
 15352                                    DC-ELAPSED-MONTHS.
 15353
 15354     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15355        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15356          MOVE 'Z'                TO PB-CI-OB-FLAG
 15357          MOVE ER-2767            TO WS-ERROR
 15358          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15359          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15360          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15361          GO TO 3775-OVER-REF-CHK
 15362        ELSE
 15363          MOVE ZEROS              TO PB-CI-LIVES
 15364                                     PB-C-LIVES
 15365          IF PB-CI-OB-FLAG NOT = 'B'
 15366             MOVE SPACE           TO PB-CI-OB-FLAG.
 15367
 15368     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15369         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15370     ELSE
 15371         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15372
 15373     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15374        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15375            MOVE ER-2760         TO WS-ERROR
 15376            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15377
 15378     IF LF-COVERAGE-CANCELLED
 15379        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15380         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15381            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15382               MOVE ER-2774       TO WS-ERROR
 15383               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15384
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 279
* EL050.cbl
 15385     IF AH-COVERAGE-CANCELLED
 15386        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15387         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15388            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15389               MOVE ER-2775       TO WS-ERROR
 15390               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15391
 15392     IF LF-COVERAGE-CANCELLED
 15393        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15394         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15395            MOVE ER-2776         TO WS-ERROR
 15396            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15397
 15398     IF AH-COVERAGE-CANCELLED
 15399        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15400         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15401            MOVE ER-2777         TO WS-ERROR
 15402            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15403
 15404     IF LF-COVERAGE-CANCELLED
 15405        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15406         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15407         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15408         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15409*        MOVE 6                    TO DC-OPTION-CODE
 15410         SET BIN-PLUS-ELAPSED      TO TRUE
 15411         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15412         IF DATE-CONVERSION-ERROR
 15413            NEXT SENTENCE
 15414          ELSE
 15415            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15416              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15417                             OR  'FIA'
 15418                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15419               ELSE
 15420                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15421                MOVE ER-2731       TO WS-ERROR
 15422                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15423
 15424 3705-EDIT-AH-CANCEL-DT.
 15425
 15426     IF AH-COVERAGE-CANCELLED
 15427        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15428         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15429         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15430         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15431*        MOVE 6                    TO DC-OPTION-CODE
 15432         SET BIN-PLUS-ELAPSED      TO TRUE
 15433         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15434         IF DATE-CONVERSION-ERROR
 15435            NEXT SENTENCE
 15436          ELSE
 15437            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15438              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15439                              OR 'FIA'
 15440                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15441              ELSE
 15442               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 280
* EL050.cbl
 15443               MOVE ER-2771       TO WS-ERROR
 15444               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15445
 15446 3705-EDIT-CONTINUED.
 15447
 15448*    IF LF-COVERAGE-CANCELLED
 15449*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15450*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15451*            MOVE ER-2727         TO WS-ERROR
 15452*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15453*
 15454*    IF AH-COVERAGE-CANCELLED
 15455*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15456*        IF PB-COMPANY-ID = 'ACE'
 15457*           MOVE ER-2727        TO WS-ERROR
 15458*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15459*        ELSE
 15460*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15461*              MOVE ER-2727     TO WS-ERROR
 15462*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15463
 15464     IF PB-COMPANY-ID = 'ACE'
 15465       IF AH-COVERAGE-CANCELLED
 15466         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15467           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15468              MOVE ER-2732      TO WS-ERROR
 15469              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15470
 15471     IF PB-COMPANY-ID      EQUAL   'HER'
 15472        IF WS-ERROR        EQUAL   ER-2727
 15473            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15474            MOVE  ER-2725          TO  WS-ERROR
 15475            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15476
 15477     IF PB-C-CLAIM-CREATED-CANCEL
 15478            MOVE ER-2748         TO WS-ERROR
 15479            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15480
 15481     IF PB-C-LAST-NAME NOT = SPACES
 15482         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15483            MOVE ER-2747         TO WS-ERROR
 15484            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15485
 15486 3710-EDIT-LUMP-SUM-PRIOR.
 15487
 15488     IF AH-COVERAGE-CANCELLED
 15489         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15490             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15491                MOVE ER-2735    TO WS-ERROR
 15492                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15493
 15494     IF LF-COVERAGE-CANCELLED
 15495         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15496             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15497                MOVE ER-2735    TO WS-ERROR
 15498                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15499
 15500 3710-EDIT-PRIOR-DEATH.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 281
* EL050.cbl
 15501
 15502*    IF LF-COVERAGE-CANCELLED
 15503*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15504*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15505*           (NOT PB-CI-OB)
 15506*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15507*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15508*                   MOVE ER-2732  TO WS-ERROR
 15509*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15510*
 15511*    IF AH-COVERAGE-CANCELLED
 15512*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15513*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15514*           (NOT PB-CI-OB)
 15515*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15516*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15517*                   MOVE ER-2732  TO WS-ERROR
 15518*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15519
 15520     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15521         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15522            (NOT PB-COMP-LF-CANCEL)
 15523             NEXT SENTENCE
 15524         ELSE
 15525           IF PB-C-LF-CANCEL-VOIDED
 15526              NEXT SENTENCE
 15527           ELSE
 15528              MOVE ER-2753      TO WS-ERROR
 15529              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15530
 15531     IF CANCEL-FUTURE-DT
 15532         GO TO 3999-END-EDIT.
 15533
 15534 3715-GET-REMAIN-TERM-LF.
 15535
 15536     IF NO-LF-BENEFIT-MATCH  OR
 15537        WS-LF-BENEFIT-CD = ZEROS
 15538        GO TO 3730-GET-AH-REMAIN-TERM.
 15539
 15540     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15541     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15542     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15543     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15544     MOVE PB-SV-STATE            TO CP-STATE.
 15545     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15546     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15547     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15548     MOVE '2'                    TO CP-PROCESS-TYPE.
 15549     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15550     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15551     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15552     IF (PB-COMPANY-ID = 'CID')
 15553        AND (CP-STATE-STD-ABBRV = 'WI')
 15554        MOVE '7'                 TO CP-REM-TERM-METHOD
 15555        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15556     ELSE
 15557        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15558        MOVE WS-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 282
* EL050.cbl
 15559                                 TO CP-REM-TRM-CALC-OPTION
 15560     END-IF
 15561**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15562     IF (PB-COMPANY-ID = 'CID')
 15563        AND (CP-STATE-STD-ABBRV = 'MO')
 15564        AND (PB-CERT-EFF-DT >= X'9B41')
 15565        AND (PB-CERT-EFF-DT <= X'A2FB')
 15566        MOVE '7'                 TO CP-REM-TERM-METHOD
 15567        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15568     END-IF
 15569     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15570                                    CP-LOAN-TERM.
 15571     IF CP-TRUNCATED-LIFE
 15572        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15573
 15574     IF CP-TERM-IS-DAYS
 15575         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15576     ELSE
 15577         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15578
 15579     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15580
 15581     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15582
 15583     IF LF-COVERAGE-CANCELLED
 15584        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15585        NEXT SENTENCE
 15586      ELSE
 15587          GO TO 3730-GET-AH-REMAIN-TERM.
 15588
 15589 3720-GET-LF-REFUND.
 15590
 15591     IF PB-C-LF-CANCEL-VOIDED OR
 15592        PB-C-AH-CANCEL-VOIDED
 15593        GO TO 3780-UPDATE-CANCEL-CERT.
 15594
 15595     IF PB-COMPANY-ID EQUAL 'BOA'
 15596         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15597         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15598         GO TO 3730-GET-AH-REMAIN-TERM.
 15599
 15600     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15601        (WS-AH-SPECIAL-CALC-CD = 'M')
 15602         MOVE ER-2767            TO WS-ERROR
 15603         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15604         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15605         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15606         GO TO 3780-UPDATE-CANCEL-CERT.
 15607
 15608     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15609
 15610     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15611     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15612     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15613     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15614     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15615     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15616     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 283
* EL050.cbl
 15617        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15618        IF PDEF-MASTER-FOUND
 15619           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15620              (V1 > +8)
 15621              OR (PD-PROD-CODE (V1) = 'L')
 15622           END-PERFORM
 15623           IF V1 < +9
 15624              MOVE PD-MAX-AMT (V1)
 15625                           TO CP-R-MAX-TOT-BEN
 15626                              EC-AM-LF-MAX-TOT-BEN
 15627           END-IF
 15628        ELSE
 15629        MOVE ' '                 TO PDEF-MASTER-SW
 15630        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15631        MOVE PB-STATE            TO ERPDEF-STATE
 15632        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15633        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15634        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15635        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15636        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15637        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15638        IF PDEF-MASTER-FOUND
 15639           MOVE 'N'              TO PDEF-MASTER-SW
 15640           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15641           IF PDEF-MASTER-FOUND
 15642              IF (ERPDEF-KEY-SAVE (1:16) =
 15643                           PD-CONTROL-PRIMARY (1:16))
 15644                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15645                 CONTINUE
 15646              ELSE
 15647                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15648                 IF (ERPDEF-KEY-SAVE (1:16) =
 15649                           PD-CONTROL-PRIMARY (1:16))
 15650                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15651                    CONTINUE
 15652                 ELSE
 15653                    MOVE 'N'     TO PDEF-MASTER-SW
 15654                 END-IF
 15655              END-IF
 15656              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15657
 15658              IF PDEF-MASTER-FOUND
 15659                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15660                    (V1 > +8)
 15661                    OR (PD-PROD-CODE (V1) = 'L')
 15662                 END-PERFORM
 15663                 IF V1 < +9
 15664                    MOVE PD-MAX-AMT (V1)
 15665                                 TO CP-R-MAX-TOT-BEN
 15666                                    EC-AM-LF-MAX-TOT-BEN
 15667                 END-IF
 15668              END-IF
 15669           END-IF
 15670           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15671        END-IF
 15672        END-IF
 15673     END-IF
 15674     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 284
* EL050.cbl
 15675
 15676     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15677
 15678     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15679                                    PB-C-LF-REM-TERM.
 15680
 15681     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15682     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15683
 15684     IF PB-COMPANY-ID EQUAL 'FLC'
 15685        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15686           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15687           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15688                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15689                    - CM-LF-ITD-DEATH-AMT
 15690           IF PB-C-LF-REF-CALC LESS THAN +0
 15691              MOVE +0            TO PB-C-LF-REF-CALC
 15692              GO TO 3730-GET-AH-REMAIN-TERM
 15693           ELSE
 15694              GO TO 3730-GET-AH-REMAIN-TERM.
 15695
 15696     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15697                            OR '4' OR '5' OR '6' OR '8'
 15698                            OR '9' OR 'G'
 15699        MOVE PB-C-LF-REFUND-OVERRIDE
 15700                                 TO CP-EARNING-METHOD.
 15701
 15702     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15703     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15704     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15705                                    CP-RATING-BENEFIT-AMT.
 15706     IF CP-STATE-STD-ABBRV = 'OR'
 15707         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15708                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15709     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15710     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15711     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15712     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15713     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15714     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15715     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15716     IF WS-DEFAULT-APR NOT NUMERIC
 15717         MOVE ZEROS TO WS-DEFAULT-APR.
 15718****   N O T E   ****
 15719*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15720*      THE OH HARD CODING IN ELCRFNDP
 15721
 15722     IF PB-COMPANY-ID = 'CID'
 15723        IF CP-STATE-STD-ABBRV = 'OH'
 15724           MOVE WS-LF-EARNINGS-CALC
 15725                                 TO CP-EARNING-METHOD
 15726        END-IF
 15727     END-IF
 15728
 15729****   N O T E   ****
 15730
 15731     IF CP-EARN-AS-NET-PAY
 15732         IF CP-LOAN-APR NOT GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 285
* EL050.cbl
 15733            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15734                MOVE WS-DEFAULT-APR
 15735                                 TO  CP-LOAN-APR
 15736                MOVE ER-3780     TO  WS-ERROR
 15737                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15738            ELSE
 15739                MOVE ER-3781     TO  WS-ERROR
 15740                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15741     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15742     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15743
 15744     IF CP-REFUND-TYPE-USED NOT = SPACE
 15745         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15746
 15747     IF CP-ERROR-RATE-IS-ZERO OR
 15748        CP-ERROR-RATE-NOT-FOUND
 15749        MOVE ER-2740             TO WS-ERROR
 15750        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15751
 15752     IF CP-ERROR-RATE-FILE-NOTOPEN
 15753        MOVE ER-2617             TO WS-ERROR
 15754        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15755
 15756     IF PB-COMPANY-ID = 'DCC'
 15757        AND PB-CI-ENTRY-STATUS = 'M'
 15758        MOVE +0                  TO PB-C-LF-REF-CALC
 15759     ELSE
 15760        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15761     END-IF
 15762
 15763     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15764         GO TO 3730-GET-AH-REMAIN-TERM.
 15765
 15766*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15767*       ADD +1                   TO PB-C-LF-REM-TERM
 15768*                                   CP-REMAINING-TERM
 15769*                                   CP-ORIGINAL-TERM.
 15770
 15771     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15772     MOVE '2'                    TO CP-EARNING-METHOD
 15773                                    CP-RATING-METHOD.
 15774     IF PB-COMPANY-ID = 'CID'
 15775        IF (CP-STATE-STD-ABBRV = 'MN')
 15776           AND (PB-CERT-EFF-DT > X'A4FF')
 15777           AND (WS-LF-EARNINGS-CALC = 'B')
 15778           MOVE '5'              TO CP-EARNING-METHOD
 15779           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15780        END-IF
 15781     END-IF
 15782     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15783                                        CP-REMAINING-BENEFIT
 15784                                        CP-RATING-BENEFIT-AMT.
 15785     IF CP-STATE-STD-ABBRV = 'OR'
 15786         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15787                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15788     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15789     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15790
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 286
* EL050.cbl
 15791     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15792
 15793     IF CP-ERROR-RATE-IS-ZERO OR
 15794        CP-ERROR-RATE-NOT-FOUND
 15795        MOVE ER-2740             TO WS-ERROR
 15796        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15797
 15798     IF CP-ERROR-RATE-FILE-NOTOPEN
 15799        MOVE ER-2617             TO WS-ERROR
 15800        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15801
 15802     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 15803
 15804******************************************************************
 15805
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 287
* EL050.cbl
 15807 3730-GET-AH-REMAIN-TERM.
 15808     IF NO-AH-BENEFIT-MATCH  OR
 15809        WS-AH-BENEFIT-CD = ZEROS
 15810         GO TO 3770-CHECK-REFUNDS.
 15811
 15812     IF PB-CI-AH-LUMP-SUM-DISAB
 15813         IF  PB-C-AH-CANCEL-AMT = ZERO
 15814            IF NOT PB-COMP-AH-CANCEL
 15815             GO TO 3770-CHECK-REFUNDS.
 15816
 15817     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15818     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15819     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15820     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 15821     MOVE PB-SV-STATE            TO CP-STATE.
 15822     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15823     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15824     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15825     MOVE '2'                    TO CP-PROCESS-TYPE.
 15826     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15827     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15828     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15829     IF (PB-COMPANY-ID = 'CID')
 15830        AND (CP-STATE-STD-ABBRV = 'WI')
 15831        MOVE '7'                 TO CP-REM-TERM-METHOD
 15832        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15833     ELSE
 15834        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15835        MOVE WS-REM-TRM-CALC-OPTION
 15836                                 TO CP-REM-TRM-CALC-OPTION
 15837     END-IF
 15838     IF (PB-COMPANY-ID = 'CID')
 15839        AND (CP-STATE-STD-ABBRV = 'MO')
 15840        AND (PB-CERT-EFF-DT >= X'9B41')
 15841        AND (PB-CERT-EFF-DT <= X'A2FB')
 15842        MOVE '7'                 TO CP-REM-TERM-METHOD
 15843        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15844     END-IF
 15845     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 15846                                    CP-LOAN-TERM.
 15847     IF NOT CP-TERM-IS-DAYS
 15848         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15849
 15850     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 15851
 15852     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15853
 15854     IF AH-COVERAGE-CANCELLED
 15855        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 15856        NEXT SENTENCE
 15857      ELSE
 15858         GO TO 3770-CHECK-REFUNDS.
 15859
 15860 3740-GET-AH-REFUND.
 15861
 15862     IF PB-C-LF-CANCEL-VOIDED OR
 15863        PB-C-AH-CANCEL-VOIDED
 15864        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 288
* EL050.cbl
 15865
 15866     IF PB-COMPANY-ID = 'BOA'
 15867         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15868         GO TO 3770-CHECK-REFUNDS.
 15869
 15870     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15871*    MOVE ' '                    TO DC-OPTION-CODE
 15872     SET BIN-TO-GREG             TO TRUE
 15873     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 15874     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15875                                    PB-C-AH-REM-TERM.
 15876     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 15877     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 15878
 15879     IF PB-COMPANY-ID EQUAL 'FLC'
 15880        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 15881           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 15882           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 15883                    - CM-AH-ITD-AH-PMT)
 15884           IF PB-C-AH-REF-CALC LESS THAN +0
 15885              MOVE +0            TO PB-C-AH-REF-CALC
 15886              GO TO 3770-CHECK-REFUNDS
 15887           ELSE
 15888              GO TO 3770-CHECK-REFUNDS.
 15889
 15890     IF PB-COMPANY-ID = 'DCC'
 15891        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15892            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 15893           MOVE 'S'              TO CP-EARNING-METHOD
 15894        END-IF
 15895     END-IF
 15896     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15897                            OR '4' OR '5' OR '6' OR '8'
 15898                            OR '9' OR 'G' OR 'S'
 15899        MOVE PB-C-AH-REFUND-OVERRIDE
 15900                                 TO CP-EARNING-METHOD.
 15901
 15902     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15903     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 15904     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15905                                    CP-RATING-BENEFIT-AMT.
 15906     IF CP-STATE-STD-ABBRV = 'OR'
 15907         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 15908                                         PB-CI-AH-TERM.
 15909     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15910     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15911     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15912     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 15913     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 15914     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15915
 15916     IF CP-STATE-STD-ABBRV = 'OH'
 15917        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 15918                                AND 'CID' AND 'DCC' AND 'AHL')
 15919           IF (CP-ORIGINAL-TERM GREATER 60) AND
 15920              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 15921              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15922              MOVE '6' TO CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 289
* EL050.cbl
 15923           END-IF
 15924        END-IF
 15925        IF PB-COMPANY-ID = 'CID'
 15926           IF NO-LIFE-COVERAGE
 15927              IF CP-CRITICAL-PERIOD
 15928                 MOVE '2'       TO CP-EARNING-METHOD
 15929              ELSE
 15930                 MOVE '6'       TO CP-EARNING-METHOD
 15931              END-IF
 15932           ELSE
 15933              IF WS-LF-COVERAGE-TYPE = 'L'
 15934                 MOVE '2'       TO CP-EARNING-METHOD
 15935              ELSE
 15936                 IF (PB-CI-LF-TERM > +60) OR
 15937                    (WS-LF-EARNINGS-CALC = '5')
 15938                    IF CP-CRITICAL-PERIOD
 15939                       MOVE '2'  TO CP-EARNING-METHOD
 15940                    ELSE
 15941                       MOVE '6'  TO CP-EARNING-METHOD
 15942                    END-IF
 15943                 ELSE
 15944                    MOVE '1'     TO CP-EARNING-METHOD
 15945                 END-IF
 15946              END-IF
 15947           END-IF
 15948        END-IF
 15949     END-IF
 15950
 15951*    IF CP-STATE-STD-ABBRV = 'VA'
 15952*       IF DC-GREG-DATE-CYMD GREATER 19921231
 15953*          IF CP-ORIGINAL-TERM GREATER 61
 15954*             MOVE '6' TO CP-EARNING-METHOD
 15955*          ELSE
 15956*             MOVE '1' TO CP-EARNING-METHOD.
 15957
 15958     IF WS-DEFAULT-APR NOT NUMERIC
 15959         MOVE ZEROS TO WS-DEFAULT-APR.
 15960     IF CP-EARN-AS-NET-PAY
 15961         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15962            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15963                MOVE WS-DEFAULT-APR
 15964                                 TO  CP-LOAN-APR
 15965                MOVE ER-3780     TO  WS-ERROR
 15966                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15967            ELSE
 15968                MOVE ER-3781     TO  WS-ERROR
 15969                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15970     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15971     IF PB-COMPANY-ID = 'DCC'
 15972        AND CP-CANCEL-REASON = 'R'
 15973        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 15974        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 15975     END-IF
 15976     IF PB-COMPANY-ID = 'DCC'
 15977        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15978        AND (CP-EARNING-METHOD = 'D')
 15979        AND (CP-CANCEL-REASON NOT = 'R')
 15980        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 290
* EL050.cbl
 15981     ELSE
 15982        GO TO 3750-CONTINUE
 15983     END-IF
 15984     MOVE ' '                    TO DD-IU-SW
 15985     IF NOT PDEF-MASTER-FOUND
 15986        MOVE ' '                 TO PDEF-MASTER-SW
 15987        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15988        MOVE PB-STATE            TO ERPDEF-STATE
 15989        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15990        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15991        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15992        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15993        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15994        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15995        IF PDEF-MASTER-FOUND
 15996           MOVE 'N'              TO PDEF-MASTER-SW
 15997           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15998           IF PDEF-MASTER-FOUND
 15999              IF (ERPDEF-KEY-SAVE (1:16) =
 16000                           PD-CONTROL-PRIMARY (1:16))
 16001                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16002                 CONTINUE
 16003              ELSE
 16004                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16005                 IF (ERPDEF-KEY-SAVE (1:16) =
 16006                           PD-CONTROL-PRIMARY (1:16))
 16007                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16008                    CONTINUE
 16009                 ELSE
 16010                    MOVE ER-2740 TO WS-ERROR
 16011                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16012                    GO TO 3770-CHECK-REFUNDS
 16013                 END-IF
 16014              END-IF
 16015           END-IF
 16016           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16017        END-IF
 16018     END-IF
 16019     IF PDEF-MASTER-FOUND
 16020        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16021           (V1 > +8)
 16022           OR (PD-PROD-CODE (V1) = 'I')
 16023        END-PERFORM
 16024        IF V1 < +9
 16025           SET DD-IU-PRESENT        TO TRUE
 16026        END-IF
 16027        IF WS-AH-DCC-TRUNC = 'T'
 16028           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16029        ELSE
 16030           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 16031        END-IF
 16032        EVALUATE TRUE
 16033           WHEN WS-TERM > +168
 16034              MOVE 15               TO V1
 16035           WHEN WS-TERM > +156
 16036              MOVE 14               TO V1
 16037           WHEN WS-TERM > +144
 16038              MOVE 13               TO V1
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 291
* EL050.cbl
 16039           WHEN WS-TERM > +132
 16040              MOVE 12               TO V1
 16041           WHEN WS-TERM > +120
 16042              MOVE 11               TO V1
 16043           WHEN WS-TERM > +108
 16044              MOVE 10               TO V1
 16045           WHEN WS-TERM > +96
 16046              MOVE 9                TO V1
 16047           WHEN WS-TERM > +84
 16048              MOVE 8                TO V1
 16049           WHEN WS-TERM > +72
 16050              MOVE 7                TO V1
 16051           WHEN WS-TERM > +60
 16052              MOVE 6                TO V1
 16053           WHEN WS-TERM > +48
 16054              MOVE 5                TO V1
 16055           WHEN WS-TERM > +36
 16056              MOVE 4                TO V1
 16057           WHEN WS-TERM > +24
 16058              MOVE 3                TO V1
 16059           WHEN WS-TERM > +12
 16060              MOVE 2                TO V1
 16061           WHEN OTHER
 16062              MOVE 1                TO V1
 16063        END-EVALUATE
 16064
 16065        EVALUATE TRUE
 16066*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16067*             < +13)
 16068*             AND (DD-IU-PRESENT)
 16069*             MOVE 2                TO V2
 16070*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16071*             MOVE 1                TO V2
 16072           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16073              MOVE 2                TO V2
 16074           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16075              MOVE 3                TO V2
 16076           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16077              MOVE 4                TO V2
 16078           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16079              MOVE 5                TO V2
 16080           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16081              MOVE 6                TO V2
 16082           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16083              MOVE 7                TO V2
 16084           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16085              MOVE 8                TO V2
 16086           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16087              MOVE 9                TO V2
 16088           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 16089              MOVE 10               TO V2
 16090           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16091              MOVE 11               TO V2
 16092           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16093              MOVE 12               TO V2
 16094           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16095              MOVE 13               TO V2
 16096           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 292
* EL050.cbl
 16097              MOVE 14               TO V2
 16098           WHEN OTHER
 16099              MOVE 15               TO V2
 16100        END-EVALUATE
 16101
 16102        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16103                                 TO CP-DDF-LO-FACT
 16104        MOVE PD-UEP-FACTOR (V1 V2)
 16105                                 TO CP-DDF-HI-FACT
 16106
 16107        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16108        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16109        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16110           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16111        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16112        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16113        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16114           + PD-1ST-YR-ADMIN-ALLOW
 16115
 16116        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16117*       IF PI-CLP-YN = 'Y'
 16118*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16119*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16120*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16121*       END-IF
 16122
 16123        IF DD-IU-PRESENT
 16124           MOVE 'I'              TO CP-EARNING-METHOD
 16125        END-IF
 16126        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16127                                     CP-CLP-RATE-UP
 16128        IF CP-IU-RATE-UP NOT = ZEROS
 16129           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16130              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16131           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16132              / (1 - WS-WORK-FACT)
 16133        END-IF
 16134     END-IF
 16135     .
 16136 3750-CONTINUE.
 16137     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16138
 16139     IF CP-REFUND-TYPE-USED NOT = SPACE
 16140         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16141
 16142     IF CP-ERROR-RATE-IS-ZERO OR
 16143        CP-ERROR-RATE-NOT-FOUND
 16144        MOVE ER-2740             TO WS-ERROR
 16145        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16146
 16147     IF CP-ERROR-RATE-FILE-NOTOPEN
 16148        MOVE ER-2617             TO WS-ERROR
 16149        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16150     IF PB-COMPANY-ID = 'DCC'
 16151        AND PB-CI-ENTRY-STATUS = 'M'
 16152        MOVE +0                  TO PB-C-AH-REF-CALC
 16153     ELSE
 16154        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 293
* EL050.cbl
 16155     END-IF
 16156     IF PB-COMPANY-ID = 'DCC'
 16157        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16158        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16159        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16160        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16161        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16162        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16163        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16164        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16165        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16166     END-IF
 16167     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 294
* EL050.cbl
 16169
 16170 3770-CHECK-REFUNDS.
 16171
 16172     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16173        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16174           MOVE ER-2766          TO WS-ERROR
 16175           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16176           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16177           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16178              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16179
 16180     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16181        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16182           MOVE ER-2766          TO WS-ERROR
 16183           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16184           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16185           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16186              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16187
 16188     IF PB-COMP-LF-CANCEL
 16189        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16190        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16191           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16192              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16193
 16194     IF PB-COMP-AH-CANCEL
 16195        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16196        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16197           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16198              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16199
 16200     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16201             GIVING WS-UNSIGN-WRK1
 16202     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16203             GIVING WS-UNSIGN-WRK2.
 16204
 16205     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16206         MOVE ZERO TO WS-UNSIGN-WRK1.
 16207
 16208     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16209         MOVE ZERO TO WS-UNSIGN-WRK2.
 16210
 16211     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16212
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 295
* EL050.cbl
 16214
 16215 3772-CONTINUE.
 16216
 16217**********************************
 16218*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16219*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16220*** DOUBLES THE TOLERANCE AMOUNT.
 16221***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16222**********************************
 16223     IF PB-COMPANY-ID = 'MON'
 16224     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16225         IF WS-REF-REJECT-SW = SPACE
 16226             MOVE ER-2754        TO WS-ERROR
 16227             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16228           ELSE
 16229             MOVE ER-2736        TO WS-ERROR
 16230             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16231**********************************
 16232
 16233 3773-CONTINUE.
 16234
 16235     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16236        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16237           MOVE ER-2723          TO WS-ERROR
 16238           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16239
 16240     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16241        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16242           MOVE ER-2724          TO WS-ERROR
 16243           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16244
 16245     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16246         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16247             (1 + WS-LF-REFUND-OVS-PCT)
 16248     ELSE
 16249         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16250
 16251     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16252         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16253             (1 - WS-TOL-LF-REFUND-PCT)
 16254     ELSE
 16255         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16256
 16257     IF (PB-COMPANY-ID = 'DCC')
 16258        AND (PB-CI-ENTRY-STATUS = 'M')
 16259        AND (PB-C-LF-CANCEL-AMT > +0)
 16260        MOVE ER-3843             TO WS-ERROR
 16261        PERFORM 9900-ERROR-FORMAT
 16262                                 THRU 9900-EXIT
 16263     END-IF
 16264     EVALUATE TRUE
 16265        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16266           CONTINUE
 16267        WHEN PB-C-LF-CANCEL-AMT = +0
 16268                 AND PB-C-LF-REF-CALC > +0
 16269           CONTINUE
 16270        WHEN WS-LF-REFUND-OVS-AMT = 0
 16271                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 296
* EL050.cbl
 16272           CONTINUE
 16273        WHEN OTHER
 16274           IF WS-TOL-LF-REFUND  = +0
 16275              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16276           END-IF
 16277           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16278                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16279                          (PB-C-LF-CANCEL-AMT))
 16280              CONTINUE
 16281           ELSE
 16282              IF WS-LF-REFUND-OVS-AMT = +0
 16283                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16284              END-IF
 16285              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16286                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16287                                       PB-C-LF-CANCEL-AMT)
 16288                 CONTINUE
 16289              ELSE
 16290                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16291                   MOVE ER-2754   TO  WS-ERROR
 16292                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16293                 ELSE
 16294                    MOVE ER-2736   TO  WS-ERROR
 16295                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16296                 END-IF
 16297              END-IF
 16298           END-IF
 16299     END-EVALUATE.
 16300
 16301     EVALUATE TRUE
 16302        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16303           CONTINUE
 16304        WHEN PB-C-LF-CANCEL-AMT = +0
 16305                 AND PB-C-LF-REF-CALC > +0
 16306           CONTINUE
 16307        WHEN OTHER
 16308           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16309               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16310              CONTINUE
 16311           ELSE
 16312              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16313               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16314                CONTINUE
 16315              ELSE
 16316                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16317                     MOVE ER-2754   TO  WS-ERROR
 16318                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16319                 ELSE
 16320                     MOVE ER-2736   TO  WS-ERROR
 16321                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16322                 END-IF
 16323              END-IF
 16324           END-IF
 16325     END-EVALUATE.
 16326
 16327     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16328         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16329             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 297
* EL050.cbl
 16330     ELSE
 16331         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16332
 16333     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16334         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16335             (1 - WS-TOL-AH-REFUND-PCT)
 16336     ELSE
 16337         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16338
 16339     IF (PB-COMPANY-ID = 'DCC')
 16340        AND (PB-CI-ENTRY-STATUS = 'M')
 16341        AND (PB-C-AH-CANCEL-AMT > +0)
 16342        MOVE ER-3843             TO WS-ERROR
 16343        PERFORM 9900-ERROR-FORMAT
 16344                                 THRU 9900-EXIT
 16345     END-IF
 16346     EVALUATE TRUE
 16347        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16348           CONTINUE
 16349*       WHEN PB-C-AH-REF-CALC = +0 AND
 16350*                  PB-C-AH-CANCEL-AMT > +0
 16351        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16352                   PB-C-AH-REF-CALC > +0
 16353           CONTINUE
 16354        WHEN WS-AH-REFUND-OVS-AMT = +0
 16355                AND WS-TOL-AH-REFUND = +0
 16356           CONTINUE
 16357        WHEN OTHER
 16358           IF WS-TOL-AH-REFUND = +0
 16359              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16360           END-IF
 16361           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16362               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16363                                         PB-C-AH-CANCEL-AMT)
 16364              CONTINUE
 16365           ELSE
 16366              IF WS-AH-REFUND-OVS-AMT = +0
 16367                 MOVE +9999999.99 TO
 16368                         WS-AH-REFUND-OVS-AMT
 16369              END-IF
 16370              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16371                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16372                                         PB-C-AH-CANCEL-AMT)
 16373                 CONTINUE
 16374              ELSE
 16375                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16376                    MOVE ER-2754   TO  WS-ERROR
 16377                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16378                 ELSE
 16379                    MOVE ER-2736   TO  WS-ERROR
 16380                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16381                 END-IF
 16382              END-IF
 16383           END-IF
 16384     END-EVALUATE.
 16385
 16386     EVALUATE TRUE
 16387        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 298
* EL050.cbl
 16388           CONTINUE
 16389*       WHEN PB-C-AH-REF-CALC > +0 AND
 16390*                  PB-C-AH-CANCEL-AMT = +0
 16391        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16392                   PB-C-AH-REF-CALC = +0
 16393           CONTINUE
 16394        WHEN OTHER
 16395           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16396               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16397              CONTINUE
 16398           ELSE
 16399              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16400                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16401                 CONTINUE
 16402              ELSE
 16403                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16404                     MOVE ER-2754   TO  WS-ERROR
 16405                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16406                 ELSE
 16407                     MOVE ER-2736   TO  WS-ERROR
 16408                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16409                 END-IF
 16410              END-IF
 16411           END-IF
 16412     END-EVALUATE.
 16413
 16414     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16415        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16416        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16417           AND  PB-C-LF-REF-CALC < +1.00
 16418           AND  PB-C-AH-REF-CALC < +1.00
 16419           CONTINUE
 16420        ELSE
 16421           IF (PB-COMPANY-ID = 'DCC')
 16422              AND (PB-CI-ENTRY-STATUS = 'M')
 16423              CONTINUE
 16424           ELSE
 16425              MOVE ER-2741       TO WS-ERROR
 16426              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16427           END-IF
 16428        END-IF
 16429     END-IF
 16430
 16431     IF (PB-C-LF-CANCEL-AMT = ZERO
 16432        AND WS-LF-BENEFIT-CD NOT = ZERO
 16433        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16434        AND PB-C-LF-REF-CALC NOT = ZERO)
 16435        OR
 16436        (PB-C-LF-CANCEL-AMT = ZERO
 16437        AND WS-LF-BENEFIT-CD NOT = ZERO
 16438        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16439             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16440                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16441                NEXT SENTENCE
 16442             ELSE
 16443                MOVE ER-2739        TO WS-ERROR
 16444                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16445
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 299
* EL050.cbl
 16446     IF (PB-C-AH-CANCEL-AMT = ZERO
 16447        AND WS-AH-BENEFIT-CD NOT = ZERO
 16448        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16449        AND PB-C-AH-REF-CALC NOT = ZERO)
 16450        OR
 16451        (PB-C-AH-CANCEL-AMT = ZERO
 16452        AND WS-AH-BENEFIT-CD NOT = ZERO
 16453        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16454             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16455                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16456                NEXT SENTENCE
 16457             ELSE
 16458                MOVE ER-2738        TO WS-ERROR
 16459                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16460
 16461 3775-OVER-REF-CHK.
 16462
 16463     IF PB-CI-ENTRY-STATUS = '5'
 16464        GO TO 3780-UPDATE-CANCEL-CERT.
 16465
 16466     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16467                              PB-CI-LF-ALT-PREMIUM-AMT.
 16468
 16469     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16470        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16471                                 PB-C-LF-REF-CALC
 16472      ELSE
 16473        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16474                                 PB-C-LF-CANCEL-AMT.
 16475
 16476     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16477        MOVE ER-2755             TO WS-ERROR
 16478        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16479
 16480     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16481
 16482     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16483        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16484                                 PB-C-AH-REF-CALC
 16485      ELSE
 16486        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16487                                 PB-C-AH-CANCEL-AMT.
 16488
 16489     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16490        MOVE ER-2778             TO WS-ERROR
 16491        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16492
 16493     IF PB-CI-OB-FLAG NOT = 'Z'
 16494        NEXT SENTENCE
 16495       ELSE
 16496         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16497            MOVE ER-2757           TO WS-ERROR
 16498            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16499
 16500 3780-UPDATE-CANCEL-CERT.
 16501
 16502     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16503        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 300
* EL050.cbl
 16504        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16505
 16506     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16507         MOVE ER-2729              TO WS-ERROR
 16508         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16509
 16510     IF PB-CI-LF-BENEFIT-CD = ZERO
 16511         GO TO 3780-UPDATE-CONT-1.
 16512
 16513     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16514         GO TO 3780-UPDATE-CONT-1.
 16515
 16516     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16517       AND
 16518        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16519       AND
 16520        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16521       AND
 16522        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16523            NEXT SENTENCE
 16524       ELSE
 16525        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16526          AND
 16527***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16528***       AND
 16529           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16530            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16531               MOVE ER-2730      TO WS-ERROR
 16532               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16533               GO TO 3999-END-EDIT
 16534            ELSE
 16535               GO TO 3999-END-EDIT
 16536        ELSE
 16537            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16538               MOVE ER-2765           TO WS-ERROR
 16539               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16540               GO TO 3785-CHECK-NH.
 16541*              GO TO 3999-END-EDIT.
 16542
 16543 3780-UPDATE-CONT-1.
 16544     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16545
 16546     IF PB-CI-AH-BENEFIT-CD = ZERO
 16547         GO TO 3780-UPDATE-CONT-2.
 16548
 16549     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16550         GO TO 3780-UPDATE-CONT-2.
 16551
 16552     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16553
 16554     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16555       AND
 16556        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16557       AND
 16558        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16559       AND
 16560        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16561            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 301
* EL050.cbl
 16562       ELSE
 16563        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16564          AND
 16565***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16566***       AND
 16567           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16568           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16569            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16570               MOVE ER-2773      TO WS-ERROR
 16571               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16572               GO TO 3999-END-EDIT
 16573            ELSE
 16574               GO TO 3999-END-EDIT
 16575            END-IF
 16576           ELSE
 16577             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16578                MOVE ER-2890 TO WS-ERROR
 16579                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16580                GO TO 3999-END-EDIT
 16581             ELSE
 16582                GO TO 3785-CHECK-NH
 16583             END-IF
 16584           END-IF
 16585          ELSE
 16586            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16587              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16588                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16589                   MOVE ER-2890 TO WS-ERROR
 16590                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16591                   GO TO 3999-END-EDIT
 16592                ELSE
 16593                   MOVE ER-2765 TO WS-ERROR
 16594                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16595                   GO TO 3785-CHECK-NH
 16596                END-IF
 16597              ELSE
 16598               MOVE ER-2765      TO WS-ERROR
 16599               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16600               GO TO 3785-CHECK-NH.
 16601*              GO TO 3999-END-EDIT.
 16602
 16603 3780-UPDATE-CONT-2.
 16604
 16605     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16606        AND WS-LF-BENEFIT-CD = ZERO
 16607           MOVE ER-2743           TO WS-ERROR
 16608           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16609
 16610     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16611        AND WS-AH-BENEFIT-CD = ZERO
 16612           MOVE ER-2744           TO WS-ERROR
 16613           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16614
 16615     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16616        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16617        AND
 16618        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16619         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 302
* EL050.cbl
 16620           MOVE ER-2746           TO WS-ERROR
 16621           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16622
 16623     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16624       AND
 16625        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16626             MOVE ER-2737        TO WS-ERROR
 16627             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16628
 16629     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16630       AND
 16631        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16632             MOVE ER-2737        TO WS-ERROR
 16633             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16634
 16635     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16636         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16637             OR 'CID' OR 'DCC' OR 'AHL'
 16638             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16639         ELSE
 16640             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16641                 MOVE ER-2768    TO WS-ERROR
 16642                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16643             ELSE
 16644                 MOVE ER-2756    TO WS-ERROR
 16645                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16646
 16647     IF CERT-PEND-ISSUE-RETURNED
 16648        MOVE ER-2772             TO WS-ERROR
 16649        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16650 3785-CHECK-NH.
 16651     IF PB-STATE NOT = 'NH'
 16652        GO TO 3999-END-EDIT
 16653     END-IF
 16654
 16655     MOVE ER-2796                TO WS-ERROR
 16656     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16657     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16658        OR (CM-NH-INTERFACE-SW = 'Y')
 16659        MOVE ER-2793             TO WS-ERROR
 16660        PERFORM 9900-ERROR-FORMAT
 16661                                 THRU 9900-EXIT
 16662     END-IF
 16663     MOVE +0                     TO WS-PAYMENT-AMT
 16664     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16665        GO TO 3999-END-EDIT
 16666     END-IF
 16667     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16668        GO TO 3999-END-EDIT
 16669     END-IF
 16670     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16671     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16672     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16673        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16674     END-IF
 16675     MOVE '1'                    TO DC-OPTION-CODE
 16676     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16677     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 303
* EL050.cbl
 16678        IF DC-ELAPSED-DAYS < +16
 16679           GO TO 3999-END-EDIT
 16680        END-IF
 16681     END-IF
 16682     MOVE +0                     TO DC-ELAPSED-DAYS
 16683     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16684     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16685     MOVE '1'                    TO DC-OPTION-CODE
 16686     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16687     IF NO-CONVERSION-ERROR
 16688        IF DC-ELAPSED-DAYS > +30
 16689           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16690        ELSE
 16691           GO TO 3999-END-EDIT
 16692        END-IF
 16693     ELSE
 16694        GO TO 3999-END-EDIT
 16695     END-IF
 16696     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16697        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16698           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16699     IF WS-PAYMENT-AMT < 600.00
 16700        GO TO 3999-END-EDIT
 16701     END-IF
 16702     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16703
 16704     IF (ERMAIL-FOUND = ' ')
 16705         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16706         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16707        GO TO 3999-END-EDIT
 16708     END-IF
 16709     MOVE ER-2795                TO WS-ERROR
 16710     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16711
 16712     GO TO 3999-END-EDIT.
 16713******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 304
* EL050.cbl
 16715 3990-FILES-NOT-OPEN.
 16716
 16717     MOVE ER-2617                TO WS-ERROR.
 16718     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16719     GO TO 9990-RETURN.
 16720
 16721 3999-END-EDIT.
 16722
 16723     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16724
 16725     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16726         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16727         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16728             PERFORM 9250-UNLOCK-RETURN
 16729             GO TO 9990-RETURN
 16730          ELSE
 16731             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16732             GO TO 9990-RETURN.
 16733
 16734     IF PB-CANCELLATION
 16735          GO TO 9990-RETURN.
 16736
 16737     IF CERT-WAS-NOT-FOUND
 16738        MOVE SPACES              TO CERTIFICATE-MASTER.
 16739
 16740     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16741
 16742     IF CERT-WAS-FOUND
 16743         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16744             PERFORM 9250-UNLOCK-RETURN
 16745          ELSE
 16746            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16747      ELSE
 16748         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16749
 16750     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16751        IF PB-COMPANY-ID = 'DCC' AND
 16752           (PB-CARRIER = '2' OR '4' OR '6')
 16753              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16754        END-IF
 16755     END-IF.
 16756
 16757     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16758     IF ((PB-COMPANY-ID = 'DCC')
 16759        AND (WS-NO-SECURE-PAY))
 16760                  OR
 16761        (WS-LF-SPECIAL-CALC-CD = 'O'
 16762        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16763        SET SKIP-ADDR-EDIT       TO TRUE
 16764     END-IF
 16765     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16766        AND (NOT SKIP-ADDR-EDIT)
 16767        MOVE ER-2963             TO WS-ERROR
 16768        PERFORM 9900-ERROR-FORMAT
 16769                                 THRU 9900-EXIT
 16770        GO TO 9990-RETURN
 16771     END-IF
 16772     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 305
* EL050.cbl
 16773     IF ERPNDM-FOUND NOT = 'X'
 16774        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16775           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16776           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16777           AND (NOT SKIP-ADDR-EDIT)
 16778           MOVE ER-2694          TO WS-ERROR
 16779           PERFORM 9900-ERROR-FORMAT
 16780                                 THRU 9900-EXIT
 16781        END-IF
 16782        MOVE ' '                 TO STATE-RECORD-ERROR
 16783        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16784        MOVE PM-STATE            TO CNTL-ACCESS
 16785        MOVE '3'                 TO CNTL-REC-TYPE
 16786        MOVE +0                  TO CNTL-SEQ-NO
 16787        MOVE '0'                 TO RC-SW-2
 16788        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16789        IF (NO-STATE-RECORD)
 16790           OR (CF-RECORD-TYPE NOT = '3')
 16791           OR (PM-STATE NOT = CF-STATE-CODE)
 16792           IF (PM-STATE = SPACES)
 16793              AND (SKIP-ADDR-EDIT)
 16794              CONTINUE
 16795           ELSE
 16796              MOVE ER-2963       TO WS-ERROR
 16797              PERFORM 9900-ERROR-FORMAT
 16798                                 THRU 9900-EXIT
 16799           END-IF
 16800        END-IF
 16801        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 16802           MOVE ER-2883          TO WS-ERROR
 16803           PERFORM 9900-ERROR-FORMAT
 16804                                 THRU 9900-EXIT
 16805        END-IF
 16806        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 16807           MOVE ' '                 TO STATE-RECORD-ERROR
 16808           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16809           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 16810           MOVE '3'                 TO CNTL-REC-TYPE
 16811           MOVE +0                  TO CNTL-SEQ-NO
 16812           MOVE '0'                 TO RC-SW-2
 16813           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16814           IF NO-STATE-RECORD
 16815              OR (CF-RECORD-TYPE NOT = '3')
 16816              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 16817              MOVE ER-2964          TO WS-ERROR
 16818              PERFORM 9900-ERROR-FORMAT
 16819                                    THRU 9900-EXIT
 16820           END-IF
 16821        END-IF
 16822     ELSE
 16823        IF NOT SKIP-ADDR-EDIT
 16824           MOVE ER-2393          TO WS-ERROR
 16825           PERFORM 9900-ERROR-FORMAT
 16826                                 THRU 9900-EXIT
 16827        END-IF
 16828     END-IF
 16829
 16830     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 306
* EL050.cbl
 16831
 16832     IF (ERMAIL-FOUND = ' ' AND
 16833        ERPNDM-FOUND = ' ')
 16834        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 16835           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 16836           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 16837          OR
 16838           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 16839          OR
 16840           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 16841           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 16842           GO TO 3999-UNLOCK-ERMAIL.
 16843
 16844     IF ERPNDM-FOUND = 'X'
 16845        GO TO 3999-UNLOCK-ERMAIL.
 16846
 16847     IF PM-INSURED-LAST-NAME      = SPACES
 16848        AND PM-INSURED-FIRST-NAME = SPACES
 16849        AND PM-ADDRESS-LINE-1     = SPACES
 16850        AND PM-ADDRESS-LINE-2     = SPACES
 16851        AND PM-CITY-STATE         = SPACES
 16852        AND PM-CRED-BENE-NAME     = SPACES
 16853        AND PM-CRED-BENE-ADDR     = SPACES
 16854        AND PM-CRED-BENE-CTYST    = SPACES
 16855        GO TO 3999-UNLOCK-ERMAIL
 16856     END-IF
 16857
 16858     MOVE SPACES                 TO MAILING-DATA.
 16859
 16860     MOVE 'MA'                   TO MA-RECORD-ID.
 16861     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 16862     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 16863     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 16864     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 16865     MOVE PB-SV-STATE            TO MA-STATE.
 16866     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 16867     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 16868
 16869     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 16870     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 16871
 16872     IF ERMAIL-FOUND = ' '
 16873        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 16874     ELSE
 16875        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 16876        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 16877        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 16878
 16879     GO TO 9990-RETURN.
 16880
 16881 3999-UNLOCK-ERMAIL.
 16882     IF ERMAIL-FOUND = ' '
 16883        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 16884
 16885     GO TO 9990-RETURN.
 16886******************************************************************
 16887
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 307
* EL050.cbl
 16889 4000-UPDATE-CANCELLED-CERT.
 16890     IF CERT-WAS-NOT-FOUND
 16891        GO TO 4299-EXIT.
 16892
 16893*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 16894     IF PB-C-NH-INT-ON-REFS > ZEROS
 16895        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 16896     END-IF
 16897     IF PB-C-REF-INTERFACE-SW = 'Y'
 16898        MOVE PB-C-REF-INTERFACE-SW
 16899                                 TO CM-NH-INTERFACE-SW
 16900     END-IF
 16901     IF PB-C-POST-CARD-IND = 'Y'
 16902        MOVE +8                  TO SUB
 16903        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 16904        IF ERMAIL-FOUND = ' '
 16905           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 16906              (SUB > +7)
 16907              OR (MA-MAIL-STATUS (SUB) = '1')
 16908           END-PERFORM
 16909        END-IF
 16910        IF (SUB > +7)
 16911           OR (ERMAIL-FOUND = 'X')
 16912           MOVE ER-3789          TO WS-ERROR
 16913           PERFORM 9900-ERROR-FORMAT
 16914                                 THRU 9900-EXIT
 16915        END-IF
 16916     ELSE
 16917        MOVE 'N'                 TO PB-C-POST-CARD-IND
 16918     END-IF
 16919     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 16920
 16921     IF PB-CI-OB-FLAG = 'Z'
 16922        GO TO 4150-SUMMARY-CERT-CANCEL.
 16923
 16924     IF PB-C-LF-CANCEL-VOIDED
 16925         PERFORM 4200-REVERSE-LF-CANCEL.
 16926     IF PB-C-AH-CANCEL-VOIDED
 16927         PERFORM 4200-REVERSE-AH-CANCEL.
 16928
 16929 4100-APPLY-LF-CANCEL.
 16930
 16931     MOVE +0                     TO WS-SUB.
 16932
 16933 4100-CHECK-LF-ERRORS.
 16934
 16935     ADD +1                       TO WS-SUB.
 16936
 16937     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16938        IF LF-COVERAGE-CANCELLED
 16939           GO TO 4100-LF-CANCEL-CONT
 16940        ELSE
 16941           GO TO 4100-UPDATE-LF-COVERAGE.
 16942
 16943     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16944                                   ER-2729 OR
 16945                                   ER-2730 OR
 16946                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 308
* EL050.cbl
 16947                                   ER-2732 OR
 16948                                   ER-2737 OR
 16949                                   ER-2740 OR
 16950                                   ER-2743 OR
 16951                                   ER-2749 OR
 16952                                   ER-2750 OR
 16953                                   ER-2755 OR
 16954                                   ER-2757 OR
 16955                                   ER-2760 OR
 16956                                   ER-2772 OR
 16957                                   ER-2774 OR
 16958                                   ER-2776 OR
 16959                                   ER-2794
 16960        GO TO 4100-UPDATE-LF-COVERAGE.
 16961
 16962     GO TO 4100-CHECK-LF-ERRORS.
 16963
 16964 4100-UPDATE-LF-COVERAGE.
 16965
 16966     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 16967     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 16968     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 16969        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 16970     END-IF
 16971     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16972                                      TO CM-CREDIT-INTERFACE-SW-2.
 16973     IF CM-LF-CANCEL-DT = LOW-VALUE
 16974         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 16975
 16976     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 16977         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 16978                                         CM-LF-STATUS-AT-CANCEL.
 16979
 16980     GO TO 4100-APPLY-AH-CANCEL.
 16981
 16982 4100-LF-CANCEL-CONT.
 16983     IF PB-C-LF-CANCEL-VOIDED
 16984         GO TO 4100-APPLY-AH-CANCEL.
 16985
 16986     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16987         GO TO 4100-APPLY-AH-CANCEL.
 16988
 16989     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 16990        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16991           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 16992        ELSE
 16993           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 16994
 16995     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 16996     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 16997
 16998     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 16999         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17000
 17001     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17002        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17003         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17004         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 309
* EL050.cbl
 17005
 17006     IF PB-RECORD-RETURNED
 17007        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17008      ELSE
 17009        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17010
 17011 4100-APPLY-AH-CANCEL.
 17012
 17013     MOVE +0                      TO WS-SUB.
 17014
 17015 4100-CHECK-AH-ERRORS.
 17016
 17017     ADD +1                       TO WS-SUB.
 17018
 17019     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17020        IF AH-COVERAGE-CANCELLED
 17021           GO TO 4100-AH-CANCEL-CONT
 17022        ELSE
 17023           GO TO 4100-UPDATE-AH-COVERAGE.
 17024
 17025     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17026                                   ER-2729 OR
 17027                                   ER-2732 OR
 17028                                   ER-2737 OR
 17029                                   ER-2740 OR
 17030                                   ER-2744 OR
 17031                                   ER-2749 OR
 17032                                   ER-2750 OR
 17033                                   ER-2755 OR
 17034                                   ER-2757 OR
 17035                                   ER-2760 OR
 17036                                   ER-2771 OR
 17037                                   ER-2772 OR
 17038                                   ER-2773 OR
 17039                                   ER-2775 OR
 17040                                   ER-2777 OR
 17041                                   ER-2794
 17042        GO TO 4100-UPDATE-AH-COVERAGE.
 17043
 17044     GO TO 4100-CHECK-AH-ERRORS.
 17045
 17046 4100-UPDATE-AH-COVERAGE.
 17047
 17048     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17049     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17050     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17051     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17052                                      TO CM-CREDIT-INTERFACE-SW-2.
 17053     IF CM-AH-CANCEL-DT = LOW-VALUE
 17054         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17055
 17056     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17057         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17058                                         CM-AH-STATUS-AT-CANCEL.
 17059
 17060     IF LF-COVERAGE-CANCELLED
 17061         IF PB-RECORD-RETURNED
 17062              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 310
* EL050.cbl
 17063          ELSE
 17064              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17065
 17066     GO TO 4299-EXIT.
 17067
 17068 4100-AH-CANCEL-CONT.
 17069     IF PB-C-AH-CANCEL-VOIDED
 17070         GO TO 4299-EXIT.
 17071
 17072     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17073         GO TO 4299-EXIT.
 17074
 17075     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17076        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17077           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17078        ELSE
 17079           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17080
 17081     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17082     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17083
 17084     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17085         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17086
 17087     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17088         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17089         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17090
 17091     IF PB-RECORD-RETURNED
 17092        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17093      ELSE
 17094        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17095
 17096     GO TO 4299-EXIT.
 17097
 17098 4150-SUMMARY-CERT-CANCEL.
 17099     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17100
 17101     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17102        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17103                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17104     ELSE
 17105        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17106                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17107
 17108     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17109        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17110                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17111     ELSE
 17112        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17113                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17114
 17115     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17116        NEXT SENTENCE
 17117     ELSE
 17118        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17119
 17120     GO TO 4299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 311
* EL050.cbl
 17121
 17122 4200-REVERSE-LF-CANCEL.
 17123     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17124
 17125     IF CM-LF-CANCEL-APPLIED
 17126        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17127        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17128        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17129
 17130     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17131
 17132     IF PB-RECORD-RETURNED
 17133        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17134       ELSE
 17135        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17136
 17137 4200-REVERSE-LF-EXIT.
 17138       EXIT.
 17139
 17140 4200-REVERSE-AH-CANCEL.
 17141     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17142
 17143     IF CM-AH-CANCEL-APPLIED
 17144        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17145        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17146        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17147
 17148     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17149
 17150     IF PB-RECORD-RETURNED
 17151        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17152       ELSE
 17153        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17154
 17155 4200-REVERSE-AH-EXIT.
 17156       EXIT.
 17157
 17158 4299-EXIT.
 17159       EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 312
* EL050.cbl
 17161
 17162 4500-UPDATE-NEW-CERT.
 17163     IF CERT-WAS-FOUND
 17164         NEXT SENTENCE
 17165       ELSE
 17166         GO TO 4520-BUILD-NEW-KEY.
 17167
 17168     IF  CLASIC-CREATED-CERT
 17169         GO TO 4999-EXIT.
 17170
 17171     IF  CERT-WAS-CREATED-FOR-CLAIM
 17172         GO TO 4520-BUILD-NEW-KEY.
 17173
 17174     IF CERT-ADDED-BATCH
 17175        IF CM-RECORD-ID = 'CM'
 17176            GO TO 4999-EXIT.
 17177
 17178 4520-BUILD-NEW-KEY.
 17179* BUILD CONTROL PRIMARY
 17180
 17181     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17182                                       CM-COMPANY-CD-A1
 17183                                       CM-COMPANY-CD-A2
 17184                                       CM-COMPANY-CD-A4
 17185                                       CM-COMPANY-CD-A5.
 17186
 17187     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17188     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17189     MOVE PB-SV-STATE               TO CM-STATE.
 17190     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17191     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17192     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17193     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17194
 17195     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17196
 17197     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17198     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17199     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17200     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17201
 17202     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17203        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17204
 17205     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17206         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17207         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17208         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17209         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17210     ELSE
 17211         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17212
 17213     IF PB-COMPANY-ID   EQUAL  'CRI'
 17214         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17215         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17216         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17217         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17218         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 313
* EL050.cbl
 17219
 17220     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17221        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17222         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17223
 17224     IF PB-COMPANY-ID  = 'LBL'
 17225        IF PB-I-JOINT-COVERAGE
 17226            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17227                                           PB-I-MEMBER-NO
 17228            GO TO 4550-CONT-CERT-PROCESS.
 17229
 17230     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17231        NEXT SENTENCE
 17232     ELSE
 17233        GO TO 4540-BUILD-MEMBER-NO.
 17234
 17235******************************************************************
 17236*                                                                *
 17237*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17238*    FOR 'MON'.                                                  *
 17239*                                                                *
 17240******************************************************************
 17241
 17242     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17243     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17244     MOVE +1                     TO WS-SUB1
 17245                                    WS-SUB2.
 17246
 17247 4530-EDIT-MEMB-NAME.
 17248
 17249     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17250        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17251        ADD +1                       TO WS-SUB2.
 17252
 17253     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17254        ADD +1                       TO WS-SUB1
 17255        GO TO 4530-EDIT-MEMB-NAME.
 17256
 17257     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17258     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17259     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17260*    MOVE SPACE                      TO DC-OPTION-CODE.
 17261     SET  BIN-TO-GREG                TO TRUE.
 17262     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17263     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17264
 17265     GO TO 4550-CONT-CERT-PROCESS.
 17266
 17267******************************************************************
 17268*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17269******************************************************************
 17270
 17271 4540-BUILD-MEMBER-NO.
 17272
 17273     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17274         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17275         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17276         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 314
* EL050.cbl
 17277         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17278     ELSE
 17279         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17280
 17281     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17282        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17283         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17284
 17285 4550-CONT-CERT-PROCESS.
 17286
 17287*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17288*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17289*    ELSE
 17290*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17291
 17292     IF CERT-WAS-CREATED-FOR-CLAIM
 17293        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17294        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17295
 17296     IF CERT-AND-CLAIM-ONLINE
 17297        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17298        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17299
 17300     MOVE 'CM'                     TO CM-RECORD-ID.
 17301     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17302
 17303     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17304        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17305        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17306     ELSE
 17307        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17308        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17309
 17310     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17311     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17312     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17313     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17314     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17315     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17316     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17317                                      CM-LF-ITD-CANCEL-AMT
 17318                                      CM-LF-ITD-DEATH-AMT
 17319                                      CM-AH-ITD-AH-PMT
 17320                                      CM-AH-ITD-LUMP-PMT
 17321                                      CM-AH-ITD-CANCEL-AMT
 17322                                      CM-LF-NSP-PREMIUM-AMT
 17323                                      CM-AH-NSP-PREMIUM-AMT.
 17324*                                     CM-CLAIM-DEDUCT-WITHHELD
 17325*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17326     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17327     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17328     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17329     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17330     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17331     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17332     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17333     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17334     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 315
* EL050.cbl
 17335     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17336     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17337     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17338
 17339     IF PB-I-LIVES NOT NUMERIC
 17340         MOVE ZERO                 TO PB-I-LIVES.
 17341
 17342     IF PB-I-NUM-BILLED NOT NUMERIC
 17343         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17344
 17345     MOVE PB-I-LIVES               TO CM-LIVES.
 17346     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17347
 17348     IF PB-COMPANY-ID EQUAL  'DMD'
 17349         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17350         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17351
 17352     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17353     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17354     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17355     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17356     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17357     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17358
 17359     IF PB-I-LF-POLICY-FEE NUMERIC
 17360        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17361     ELSE
 17362        MOVE +0                    TO CM-LF-POLICY-FEE.
 17363
 17364     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17365        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17366        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17367     ELSE
 17368        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17369
 17370     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17371     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17372     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17373     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17374     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17375     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17376     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17377     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17378     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17379
 17380     IF PB-I-AH-POLICY-FEE NUMERIC
 17381        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17382     ELSE
 17383        MOVE +0                    TO CM-AH-POLICY-FEE.
 17384
 17385     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17386        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17387     ELSE
 17388        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17389
 17390     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17391     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17392
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 316
* EL050.cbl
 17393     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17394                                      CM-LF-DEATH-EXIT-DT
 17395                                      CM-AH-SETTLEMENT-EXIT-DT.
 17396
 17397*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17398*                       'TIH' OR 'OFL' OR 'FLA' OR
 17399*                       'TII' OR 'TMS' OR 'CRI' OR
 17400*                       'NCL'
 17401     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17402
 17403     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17404         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17405            MOVE '2'                TO CM-PREMIUM-TYPE.
 17406
 17407     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17408         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17409            MOVE '2'                TO CM-PREMIUM-TYPE.
 17410
 17411     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17412         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17413     ELSE
 17414         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17415         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17416
 17417     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17418     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17419     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17420     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17421     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17422     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17423     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17424     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17425
 17426     IF PB-NO-MONTHS-SKIPPED
 17427         MOVE SPACE                 TO CM-SKIP-CODE
 17428     ELSE
 17429         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17430
 17431     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17432     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17433                                       CM-LF-STATUS-AT-CANCEL.
 17434
 17435     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17436     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17437                                       CM-AH-STATUS-AT-CANCEL.
 17438
 17439     MOVE '1'                       TO CM-ENTRY-STATUS.
 17440
 17441     IF PB-REISSUED-CERT
 17442        MOVE '5'                    TO CM-ENTRY-STATUS.
 17443
 17444     IF PB-MONTHLY-CERT
 17445        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17446
 17447     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17448     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17449     IF PB-POLICY-IS-DECLINED
 17450        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 317
* EL050.cbl
 17451
 17452     IF PB-POLICY-IS-VOIDED
 17453        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17454
 17455     IF PB-NEEDS-UNDERWRITING
 17456        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17457
 17458     IF PB-REIN-ONLY-CERT
 17459        MOVE '9'                    TO CM-ENTRY-STATUS.
 17460
 17461     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17462         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17463     ELSE
 17464         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17465
 17466     IF PB-RECORD-RETURNED
 17467        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17468      ELSE
 17469        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17470
 17471     IF PB-I-MAIL-ADDRS-PRESENT
 17472        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17473
 17474     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17475                                       CM-ENTRY-DT.
 17476
 17477 4999-EXIT.
 17478     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 318
* EL050.cbl
 17480
 17481 5000-PROCESS-REPS.
 17482     MOVE ' '                    TO AGTC-MASTER-SW
 17483     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17484     MOVE CO-TYPE                TO AGTC-TYPE
 17485     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17486     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17487     IF (AGTC-MASTER-SW NOT = 'N')
 17488        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17489        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17490        PERFORM 8583-READ-ERAGTC-NEXT
 17491                                 THRU 8583-EXIT
 17492     END-IF
 17493     IF AGTC-MASTER-SW = 'N'
 17494        CONTINUE
 17495     ELSE
 17496        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17497           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17498              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17499              MOVE 'Y'           TO AGTC-MASTER-SW
 17500           END-IF
 17501        END-IF
 17502     END-IF
 17503     .
 17504 5000-EXIT.
 17505     EXIT.
 17506 6370-EDIT-INPUT-LF-CODE.
 17507     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17508        MOVE +1                  TO SUB
 17509        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17510        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17511        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17512        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17513        GO TO 6370-SEARCH-LOOP.
 17514
 17515     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17516
 17517     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17518     MOVE SPACES                 TO CNTL-ACCESS.
 17519*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17520     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17521     MOVE +0                     TO CNTL-SEQ-NO.
 17522     MOVE '4' TO RC-SW-2.
 17523     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17524
 17525     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17526        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17527        GO TO 6370-NO-LF-FOUND.
 17528
 17529     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17530     MOVE +1                     TO SUB.
 17531
 17532 6370-SEARCH-LOOP.
 17533     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17534         GO TO 6370-NO-LF-FOUND.
 17535
 17536     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17537         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 319
* EL050.cbl
 17538         GO TO 6370-HER-NET-PAY-CHECK.
 17539
 17540     ADD 1   TO SUB.
 17541*    IF SUB GREATER 120
 17542     IF SUB GREATER 200
 17543         GO TO 6370-NO-LF-FOUND.
 17544
 17545     GO TO 6370-SEARCH-LOOP.
 17546
 17547 6370-NO-LF-FOUND.
 17548
 17549     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17550
 17551 6370-HER-NET-PAY-CHECK.
 17552
 17553     IF PB-COMPANY-ID = 'CID'
 17554        IF PB-SV-STATE = 'CA' OR 'MN'
 17555           IF PB-I-LF-BENEFIT-CD = '02'
 17556              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17557           ELSE
 17558              IF PB-I-LF-BENEFIT-CD = '04'
 17559                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17560              END-IF
 17561           END-IF
 17562        END-IF
 17563     END-IF
 17564
 17565     IF PB-COMPANY-ID NOT = 'HER'
 17566         GO TO 6370-EXIT.
 17567
 17568     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17569         GO TO 6370-EXIT.
 17570
 17571     IF PB-I-LF-TERM NOT NUMERIC
 17572         MOVE ZEROS              TO PB-I-LF-TERM.
 17573
 17574     IF PB-I-LOAN-TERM NOT NUMERIC
 17575         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17576
 17577     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17578         GO TO 6370-EXIT.
 17579
 17580     IF PB-I-LF-BENEFIT-CD = '33'
 17581         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17582
 17583     IF PB-I-LF-BENEFIT-CD = '34'
 17584         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17585
 17586 6370-EXIT.
 17587     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 320
* EL050.cbl
 17589
 17590 6380-EDIT-INPUT-AH-CODE.
 17591     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17592        MOVE +1                  TO SUB
 17593        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17594        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17595        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17596        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17597        GO TO 6380-SEARCH-LOOP.
 17598
 17599     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17600
 17601     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17602     MOVE SPACES                 TO CNTL-ACCESS.
 17603     MOVE 'A'                    TO CNTL-REC-TYPE.
 17604*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17605     MOVE +0                     TO CNTL-SEQ-NO.
 17606     MOVE '5' TO RC-SW-2.
 17607     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17608
 17609     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17610        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17611        GO TO 6380-NO-AH-FOUND.
 17612
 17613     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17614     MOVE +1 TO SUB.
 17615
 17616 6380-SEARCH-LOOP.
 17617     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17618         GO TO 6380-NO-AH-FOUND.
 17619
 17620     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17621         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17622         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17623
 17624     ADD 1   TO SUB.
 17625     IF SUB GREATER THAN 96
 17626*    IF SUB GREATER THAN 300
 17627         GO TO 6380-NO-AH-FOUND.
 17628
 17629     GO TO 6380-SEARCH-LOOP.
 17630
 17631 6380-NO-AH-FOUND.
 17632
 17633     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17634
 17635     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17636         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17637     ELSE
 17638         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17639
 17640 6380-CSO-AH-ONLY-CHECKS.
 17641
 17642     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17643        NEXT SENTENCE
 17644      ELSE
 17645        GO TO 6380-EXIT.
 17646
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 321
* EL050.cbl
 17647     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17648         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17649
 17650
 17651     GO TO 6380-EXIT
 17652     .
 17653 6380-CSO-LIFE-WITH-AH-CHECKS.
 17654
 17655
 17656     .
 17657 6380-EXIT.
 17658     EXIT.
 17659
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 322
* EL050.cbl
 17661
 17662 6400-COMPUTE-EXTENSION-DAYS.
 17663
 17664******************************************************************
 17665*                                                                *
 17666*                   COMPUTE EXTENSION DAYS                       *
 17667*                                                                *
 17668*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17669*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17670*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17671*    THE EXTENSION DAYS.                                         *
 17672*                                                                *
 17673******************************************************************
 17674
 17675     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17676     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17677
 17678******************************************************************
 17679*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17680*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17681******************************************************************
 17682
 17683     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17684        COMPUTE WS-ODD-DAYS-OVER =
 17685               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17686     ELSE
 17687        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17688
 17689     IF WS-ODD-DAYS-OVER = ZEROS
 17690           GO TO 6499-EXIT
 17691     ELSE
 17692        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17693           IF WS-WDF-MONTH = 02
 17694              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17695              ADD 2       TO  WS-ODD-DAYS-OVER
 17696              GO TO 6499-EXIT
 17697           ELSE
 17698              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17699                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17700                 GO TO 6499-EXIT
 17701               ELSE
 17702                 GO TO 6499-EXIT
 17703        ELSE
 17704           GO TO 6499-EXIT.
 17705
 17706 6412-CHECK-TO-DAY.
 17707
 17708        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17709           IF WS-WDT-DAY = 28
 17710              ADD 2              TO WS-ODD-DAYS-OVER
 17711           ELSE
 17712              IF WS-WDT-DAY = 29
 17713                 ADD 1           TO WS-ODD-DAYS-OVER
 17714              ELSE
 17715                 NEXT SENTENCE
 17716        ELSE
 17717           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17718              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 323
* EL050.cbl
 17719
 17720     GO TO 6499-EXIT.
 17721
 17722
 17723 6415-CHECK-LEAP-YEAR.
 17724
 17725     IF DC-DAYS-IN-MONTH = 29
 17726        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17727
 17728 6415-EXIT.
 17729     EXIT.
 17730
 17731 6499-EXIT.
 17732      EXIT.
 17733
 17734 6500-END.
 17735     EXIT.
 17736
 17737
 17738******************************************************************
 17739************* PROCEDURE DIVISION FOR EL050 ***********************
 17740********************** ELC50PD END *******************************
 17741
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 324
* EL050.cbl
 17743
 17744**START***********************************************************
 17745*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17746*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17747******************************************************************
 17748*
 17749 6600-GET-STATE-MUNICIPAL-TAX.
 17750
 17751     IF PB-COMPANY-ID NOT = 'DMD'
 17752         GO TO 6640-EXIT.
 17753
 17754     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17755     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17756     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17757*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17758*
 17759***  Y2K PROJ 7744
 17760     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17761     SET BIN-TO-GREG          TO TRUE.
 17762     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17763
 17764     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17765
 17766     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17767     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17768
 17769
 17770* EXEC CICS HANDLE CONDITION
 17771*        INVREQ    (6610-START-BROWSE)
 17772*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17773*        NOTFND    (6630-END-OF-FILE)
 17774*    END-EXEC.
 17775*    MOVE '"$8JI                 ! # #00017757' TO DFHEIV0
 17776     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17777     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17778     MOVE X'2320233030303137373537' TO DFHEIV0(25:11)
 17779     CALL 'kxdfhei1' USING DFHEIV0
 17780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17781
 17782
 17783 6610-START-BROWSE.
 17784
 17785
 17786* EXEC CICS HANDLE CONDITION
 17787*        NOTFND    (6630-END-OF-FILE)
 17788*        DISABLED  (6630-ERRESS-PROBLEM)
 17789*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17790*        ENDFILE   (6630-END-OF-FILE)
 17791*    END-EXEC.
 17792*    MOVE '"$IcJ''                ! $ #00017765' TO DFHEIV0
 17793     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17794     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17795     MOVE X'2420233030303137373635' TO DFHEIV0(25:11)
 17796     CALL 'kxdfhei1' USING DFHEIV0
 17797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17798
 17799
 17800
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 325
* EL050.cbl
 17801* EXEC CICS STARTBR
 17802*        DATASET (FILE-ID-ERRESS)
 17803*        RIDFLD  (WS-ERRESS-KEY)
 17804*        GTEQ
 17805*    END-EXEC.
 17806     MOVE 0
 17807       TO DFHEIV11
 17808*    MOVE '&,         G          &   #00017772' TO DFHEIV0
 17809     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17810     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17811     MOVE X'2020233030303137373732' TO DFHEIV0(25:11)
 17812     CALL 'kxdfhei1' USING DFHEIV0,
 17813           FILE-ID-ERRESS,
 17814           WS-ERRESS-KEY,
 17815           DFHEIV99,
 17816           DFHEIV11,
 17817           DFHEIV99
 17818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17819
 17820
 17821 6620-READ-NEXT-ERRESS-MASTER.
 17822
 17823
 17824* EXEC CICS HANDLE CONDITION
 17825*        NOTFND    (6630-END-OF-FILE)
 17826*        ENDFILE   (6630-END-OF-FILE)
 17827*        DISABLED  (6630-ERRESS-PROBLEM)
 17828*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17829*    END-EXEC.
 17830*    MOVE '"$I''cJ                ! % #00017780' TO DFHEIV0
 17831     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 17832     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17833     MOVE X'2520233030303137373830' TO DFHEIV0(25:11)
 17834     CALL 'kxdfhei1' USING DFHEIV0
 17835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17836
 17837
 17838
 17839* EXEC CICS READNEXT
 17840*        DATASET (FILE-ID-ERRESS)
 17841*        INTO    (RESIDENT-STATE-TAX-MASTER)
 17842*        RIDFLD  (WS-ERRESS-KEY)
 17843*    END-EXEC.
 17844     MOVE LENGTH OF
 17845      RESIDENT-STATE-TAX-MASTER
 17846       TO DFHEIV12
 17847     MOVE 0
 17848       TO DFHEIV11
 17849*    MOVE '&.IL                  )   #00017787' TO DFHEIV0
 17850     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17851     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17852     MOVE X'2020233030303137373837' TO DFHEIV0(25:11)
 17853     CALL 'kxdfhei1' USING DFHEIV0,
 17854           FILE-ID-ERRESS,
 17855           RESIDENT-STATE-TAX-MASTER,
 17856           DFHEIV12,
 17857           WS-ERRESS-KEY,
 17858           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 326
* EL050.cbl
 17859           DFHEIV11,
 17860           DFHEIV99,
 17861           DFHEIV99
 17862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17863
 17864
 17865     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 17866
 17867* EXEC CICS ENDBR
 17868*            DATASET (FILE-ID-ERRESS)
 17869*       END-EXEC
 17870     MOVE 0
 17871       TO DFHEIV11
 17872*    MOVE '&2                    $   #00017794' TO DFHEIV0
 17873     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17874     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17875     MOVE X'2020233030303137373934' TO DFHEIV0(25:11)
 17876     CALL 'kxdfhei1' USING DFHEIV0,
 17877           FILE-ID-ERRESS,
 17878           DFHEIV11,
 17879           DFHEIV99
 17880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17881        GO TO 6630-END-OF-FILE.
 17882
 17883     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 17884        NEXT SENTENCE
 17885      ELSE
 17886        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 17887
 17888*IS IT LIFE(1) OR IS IT P&C(2) ?????
 17889*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 17890*
 17891     MOVE +2                     TO WS-SUB1.
 17892
 17893     IF PB-ISSUE
 17894     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 17895        MOVE +1                  TO WS-SUB1.
 17896
 17897     IF PB-CANCELLATION
 17898     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 17899        MOVE +1                  TO WS-SUB1.
 17900*
 17901*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 17902*
 17903***  Y2K PROJ 7744
 17904     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 17905***  Y2K PROJ 7744
 17906
 17907*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 17908* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 17909* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 17910
 17911     ADD 1                    TO WS-YEAR-YY.
 17912
 17913     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 17914         MOVE RES-REN-STATE-TAX (WS-SUB1)
 17915                              TO WS-RES-STATE-TAX
 17916         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 327
* EL050.cbl
 17917                              TO WS-RES-MUNI-TAX
 17918     ELSE
 17919         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 17920                              TO WS-RES-STATE-TAX
 17921         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 17922                              TO WS-RES-MUNI-TAX.
 17923
 17924*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 17925
 17926     IF PB-CANCELLATION
 17927         GO TO 6640-CANCEL-TAX.
 17928
 17929     IF PB-I-LF-PREMIUM-AMT > ZEROS
 17930         COMPUTE PB-I-STATE-TAX ROUNDED =
 17931                                   PB-I-LF-PREMIUM-AMT
 17932                                 * WS-RES-STATE-TAX
 17933         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17934                                   PB-I-LF-PREMIUM-AMT
 17935                                 * WS-RES-MUNI-TAX
 17936     ELSE
 17937     IF PB-I-AH-PREMIUM-AMT > ZEROS
 17938         COMPUTE PB-I-STATE-TAX ROUNDED =
 17939                                   PB-I-AH-PREMIUM-AMT
 17940                                 * WS-RES-STATE-TAX
 17941         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17942                                   PB-I-AH-PREMIUM-AMT
 17943                                 * WS-RES-MUNI-TAX.
 17944
 17945
 17946* EXEC CICS ENDBR
 17947*         DATASET (FILE-ID-ERRESS)
 17948*    END-EXEC.
 17949     MOVE 0
 17950       TO DFHEIV11
 17951*    MOVE '&2                    $   #00017861' TO DFHEIV0
 17952     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17953     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17954     MOVE X'2020233030303137383631' TO DFHEIV0(25:11)
 17955     CALL 'kxdfhei1' USING DFHEIV0,
 17956           FILE-ID-ERRESS,
 17957           DFHEIV11,
 17958           DFHEIV99
 17959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17960
 17961
 17962     GO TO 6640-EXIT.
 17963
 17964 6640-CANCEL-TAX.
 17965     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 17966
 17967     IF PB-C-LF-CANCEL-AMT > ZEROS
 17968         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17969                                   PB-C-LF-CANCEL-AMT
 17970                                 * WS-RES-STATE-TAX
 17971         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17972                                   PB-C-LF-CANCEL-AMT
 17973                                *  WS-RES-MUNI-TAX
 17974     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 328
* EL050.cbl
 17975     IF PB-C-AH-CANCEL-AMT > ZEROS
 17976         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17977                                   PB-C-AH-CANCEL-AMT
 17978                                 * WS-RES-STATE-TAX
 17979         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17980                                   PB-C-AH-CANCEL-AMT
 17981                                *  WS-RES-MUNI-TAX.
 17982
 17983
 17984* EXEC CICS ENDBR
 17985*         DATASET (FILE-ID-ERRESS)
 17986*    END-EXEC.
 17987     MOVE 0
 17988       TO DFHEIV11
 17989*    MOVE '&2                    $   #00017886' TO DFHEIV0
 17990     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17991     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17992     MOVE X'2020233030303137383836' TO DFHEIV0(25:11)
 17993     CALL 'kxdfhei1' USING DFHEIV0,
 17994           FILE-ID-ERRESS,
 17995           DFHEIV11,
 17996           DFHEIV99
 17997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17998
 17999
 18000     GO TO 6640-EXIT.
 18001
 18002 6630-END-OF-FILE.
 18003     MOVE ER-8002              TO WS-ERROR.
 18004     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18005
 18006     GO TO 6640-EXIT.
 18007
 18008 6630-ERRESS-PROBLEM.
 18009     MOVE ER-8044              TO WS-ERROR.
 18010     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18011
 18012 6640-EXIT.
 18013     EXIT.
 18014
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 329
* EL050.cbl
 18016 6650-GET-RES-STATE-COMM.
 18017
 18018     IF PB-COMPANY-ID NOT = 'DMD'
 18019         GO TO 6700-COMM-EXIT.
 18020
 18021     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18022     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18023     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18024     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18025     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18026     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18027     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18028
 18029*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18030*
 18031***  Y2K PROJ 7744
 18032     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18033     SET BIN-TO-GREG          TO TRUE.
 18034     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18035
 18036     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18037***  Y2K PROJ 7744
 18038
 18039     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18040
 18041
 18042* EXEC CICS HANDLE CONDITION
 18043*        INVREQ    (6660-START-BROWSE)
 18044*        DISABLED  (6690-ERRESC-PROBLEM)
 18045*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18046*        NOTFND    (6690-END-OF-FILE)
 18047*    END-EXEC.
 18048*    MOVE '"$8cJI                ! & #00017931' TO DFHEIV0
 18049     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18050     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18051     MOVE X'2620233030303137393331' TO DFHEIV0(25:11)
 18052     CALL 'kxdfhei1' USING DFHEIV0
 18053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18054
 18055
 18056
 18057* EXEC CICS RESETBR
 18058*        DATASET (FILE-ID-ERRESC)
 18059*        RIDFLD  (WS-ERRESC-KEY)
 18060*    END-EXEC.
 18061     MOVE 0
 18062       TO DFHEIV11
 18063*    MOVE '&4         G          &   #00017938' TO DFHEIV0
 18064     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18065     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18066     MOVE X'2020233030303137393338' TO DFHEIV0(25:11)
 18067     CALL 'kxdfhei1' USING DFHEIV0,
 18068           FILE-ID-ERRESC,
 18069           WS-ERRESC-KEY,
 18070           DFHEIV99,
 18071           DFHEIV11,
 18072           DFHEIV99
 18073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 330
* EL050.cbl
 18074
 18075
 18076 6660-START-BROWSE.
 18077
 18078
 18079* EXEC CICS HANDLE CONDITION
 18080*        NOTFND    (6690-END-OF-FILE)
 18081*        DISABLED  (6690-ERRESC-PROBLEM)
 18082*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18083*        ENDFILE   (6690-END-OF-FILE)
 18084*    END-EXEC.
 18085*    MOVE '"$IcJ''                ! '' #00017945' TO DFHEIV0
 18086     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18087     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18088     MOVE X'2720233030303137393435' TO DFHEIV0(25:11)
 18089     CALL 'kxdfhei1' USING DFHEIV0
 18090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18091
 18092
 18093
 18094* EXEC CICS STARTBR
 18095*        DATASET (FILE-ID-ERRESC)
 18096*        RIDFLD  (WS-ERRESC-KEY)
 18097*        GTEQ
 18098*    END-EXEC.
 18099     MOVE 0
 18100       TO DFHEIV11
 18101*    MOVE '&,         G          &   #00017952' TO DFHEIV0
 18102     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18103     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18104     MOVE X'2020233030303137393532' TO DFHEIV0(25:11)
 18105     CALL 'kxdfhei1' USING DFHEIV0,
 18106           FILE-ID-ERRESC,
 18107           WS-ERRESC-KEY,
 18108           DFHEIV99,
 18109           DFHEIV11,
 18110           DFHEIV99
 18111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18112
 18113
 18114     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18115
 18116 6670-READ-NEXT-ERRESC-MASTER.
 18117
 18118
 18119* EXEC CICS HANDLE CONDITION
 18120*        NOTFND    (6690-END-OF-FILE)
 18121*        DISABLED  (6690-ERRESC-PROBLEM)
 18122*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18123*        ENDFILE   (6690-END-OF-FILE)
 18124*    END-EXEC.
 18125*    MOVE '"$IcJ''                ! ( #00017962' TO DFHEIV0
 18126     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18127     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18128     MOVE X'2820233030303137393632' TO DFHEIV0(25:11)
 18129     CALL 'kxdfhei1' USING DFHEIV0
 18130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18131
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 331
* EL050.cbl
 18132
 18133
 18134* EXEC CICS READNEXT
 18135*        DATASET (FILE-ID-ERRESC)
 18136*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18137*        RIDFLD  (ERRESC-RECORD-KEY)
 18138*    END-EXEC.
 18139     MOVE LENGTH OF
 18140      ACCOUNT-RESIDENT-ST-COMMISSION
 18141       TO DFHEIV12
 18142     MOVE 0
 18143       TO DFHEIV11
 18144*    MOVE '&.IL                  )   #00017969' TO DFHEIV0
 18145     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18146     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18147     MOVE X'2020233030303137393639' TO DFHEIV0(25:11)
 18148     CALL 'kxdfhei1' USING DFHEIV0,
 18149           FILE-ID-ERRESC,
 18150           ACCOUNT-RESIDENT-ST-COMMISSION,
 18151           DFHEIV12,
 18152           ERRESC-RECORD-KEY,
 18153           DFHEIV99,
 18154           DFHEIV11,
 18155           DFHEIV99,
 18156           DFHEIV99
 18157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18158
 18159
 18160     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18161        NEXT SENTENCE
 18162     ELSE
 18163
 18164* EXEC CICS ENDBR
 18165*            DATASET (FILE-ID-ERRESC)
 18166*       END-EXEC
 18167     MOVE 0
 18168       TO DFHEIV11
 18169*    MOVE '&2                    $   #00017978' TO DFHEIV0
 18170     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18171     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18172     MOVE X'2020233030303137393738' TO DFHEIV0(25:11)
 18173     CALL 'kxdfhei1' USING DFHEIV0,
 18174           FILE-ID-ERRESC,
 18175           DFHEIV11,
 18176           DFHEIV99
 18177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18178        GO TO 6690-END-OF-FILE.
 18179
 18180     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18181
 18182* EXEC CICS ENDBR
 18183*            DATASET (FILE-ID-ERRESC)
 18184*       END-EXEC
 18185     MOVE 0
 18186       TO DFHEIV11
 18187*    MOVE '&2                    $   #00017984' TO DFHEIV0
 18188     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18189     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 332
* EL050.cbl
 18190     MOVE X'2020233030303137393834' TO DFHEIV0(25:11)
 18191     CALL 'kxdfhei1' USING DFHEIV0,
 18192           FILE-ID-ERRESC,
 18193           DFHEIV11,
 18194           DFHEIV99
 18195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18196        GO TO 6690-END-OF-FILE.
 18197
 18198     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18199        NEXT SENTENCE
 18200      ELSE
 18201        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18202
 18203* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18204*
 18205     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18206
 18207     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18208
 18209     IF WS-SUB1 > ZERO
 18210         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18211             PERFORM 6680-SET-COMMISSION
 18212         ELSE
 18213             PERFORM 6680-SET-TABLE-CODE.
 18214
 18215
 18216* EXEC CICS ENDBR
 18217*         DATASET (FILE-ID-ERRESC)
 18218*    END-EXEC.
 18219     MOVE 0
 18220       TO DFHEIV11
 18221*    MOVE '&2                    $   #00018006' TO DFHEIV0
 18222     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18223     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18224     MOVE X'2020233030303138303036' TO DFHEIV0(25:11)
 18225     CALL 'kxdfhei1' USING DFHEIV0,
 18226           FILE-ID-ERRESC,
 18227           DFHEIV11,
 18228           DFHEIV99
 18229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18230
 18231
 18232     GO TO 6700-COMM-EXIT.
 18233
 18234 6680-SET-TABLE-CODE.
 18235     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18236        MOVE ZEROS             TO WS-SUB1
 18237     ELSE
 18238* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18239* TO COMPUTE AH COMMISSION.
 18240        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18241        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18242        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18243        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18244        PERFORM 6680-READ-CTBL-TABLE
 18245        IF WS-CTBL-READ-SW NOT = 'Y'
 18246           MOVE ZEROS          TO WS-SUB1.
 18247
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 333
* EL050.cbl
 18248 6680-READ-CTBL-TABLE.
 18249*
 18250* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18251* TO COMPUTE LIFE COMMISSION
 18252
 18253     IF CTBL-SW = '0540'
 18254        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18255        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18256        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18257
 18258     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18259
 18260     IF CTBL-TABLE-FOUND
 18261        IF CTBL-SW = '0530'
 18262             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18263                                    * PB-I-AH-TERM
 18264             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18265             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18266        ELSE
 18267             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18268             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18269             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18270     ELSE
 18271        IF FIRST-TIME-THROUGH
 18272            GO TO 6680-READ-CTBL-TABLE
 18273        ELSE
 18274            MOVE ZEROS         TO WS-SUB1.
 18275
 18276 6680-SET-COMMISSION.
 18277     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18278           MOVE ZEROS          TO WS-SUB1
 18279       ELSE
 18280           MOVE RESC-COMMISSION-PER (WS-SUB)
 18281                               TO WS-COMMISSION
 18282           IF CTBL-SW = '0530'
 18283               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18284           ELSE
 18285               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18286
 18287 6680-SEARCH-CATEGORY.
 18288     ADD +1                   TO WS-SUB.
 18289     IF WS-SUB > +12
 18290         GO TO 6680-EXIT.
 18291
 18292     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18293          MOVE WS-SUB         TO WS-SUB1
 18294          GO TO 6680-EXIT.
 18295
 18296     GO TO 6680-SEARCH-CATEGORY.
 18297
 18298 6680-EXIT.
 18299     EXIT.
 18300
 18301 6690-END-OF-FILE.
 18302     GO TO 6700-COMM-EXIT.
 18303
 18304 6690-ERRESC-PROBLEM.
 18305      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 334
* EL050.cbl
 18306      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18307
 18308      GO TO 6700-COMM-EXIT.
 18309
 18310 6700-COMM-EXIT.
 18311     EXIT.
 18312
 18313 7000-GET-RATE.
 18314
 18315* EXEC CICS LINK
 18316*        PROGRAM    ('ELRATE')
 18317*        COMMAREA   (CALCULATION-PASS-AREA)
 18318*        LENGTH     (CP-COMM-LENGTH)
 18319*    END-EXEC.
 18320     MOVE 'ELRATE' TO DFHEIV1
 18321*    MOVE '."C                   (   #00018092' TO DFHEIV0
 18322     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18323     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18324     MOVE X'2020233030303138303932' TO DFHEIV0(25:11)
 18325     CALL 'kxdfhei1' USING DFHEIV0,
 18326           DFHEIV1,
 18327           CALCULATION-PASS-AREA,
 18328           CP-COMM-LENGTH,
 18329           DFHEIV99,
 18330           DFHEIV99,
 18331           DFHEIV99,
 18332           DFHEIV99
 18333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18334
 18335
 18336 7000-EXIT.
 18337     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 335
* EL050.cbl
 18339 7100-FIND-BENEFIT-IN-STATE.
 18340     MOVE 'N'                    TO BEN-SEARCH-SW.
 18341
 18342     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18343         VARYING SUB3 FROM 1 BY 1 UNTIL
 18344            ((SUB3 GREATER 50) OR
 18345              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18346               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18347
 18348     IF SUB3 NOT = 51
 18349         MOVE 'Y'                TO BEN-SEARCH-SW.
 18350
 18351     GO TO 7199-EXIT.
 18352
 18353 7100-BENEFIT-DUMMY.
 18354
 18355 7100-DUMMY-EXIT.
 18356     EXIT.
 18357
 18358 7199-EXIT.
 18359     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 336
* EL050.cbl
 18361 7200-FIND-BENEFIT.
 18362     MOVE 'N'                    TO BEN-SEARCH-SW.
 18363
 18364     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18365         VARYING SUB3 FROM 1 BY 1 UNTIL
 18366            ((SUB3 GREATER 8) OR
 18367            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18368
 18369     IF SUB3 NOT = 9
 18370         MOVE 'Y'                TO BEN-SEARCH-SW.
 18371
 18372     GO TO 7200-EXIT.
 18373
 18374 7200-BENEFIT-DUMMY.
 18375
 18376 7200-DUMMY-EXIT.
 18377     EXIT.
 18378
 18379 7200-EXIT.
 18380     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 337
* EL050.cbl
 18382 7250-LOOK-FOR-RESCINDED-CLAIM.
 18383     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18384                                    W-CL-COMP-CD.
 18385     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18386                                    W-CL-CERT-NO.
 18387
 18388
 18389* EXEC CICS HANDLE CONDITION
 18390*        NOTFND  (7250-CONTINUE)
 18391*        ENDFILE (7250-CONTINUE)
 18392*    END-EXEC.
 18393*    MOVE '"$I''                  ! ) #00018150' TO DFHEIV0
 18394     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18395     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18396     MOVE X'2920233030303138313530' TO DFHEIV0(25:11)
 18397     CALL 'kxdfhei1' USING DFHEIV0
 18398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18399
 18400
 18401
 18402* EXEC CICS IGNORE CONDITION
 18403*        DUPKEY
 18404*    END-EXEC.
 18405*    MOVE '"*$                   !   #00018155' TO DFHEIV0
 18406     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18407     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18408     MOVE X'2020233030303138313535' TO DFHEIV0(25:11)
 18409     CALL 'kxdfhei1' USING DFHEIV0
 18410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18411
 18412
 18413
 18414* EXEC CICS STARTBR
 18415*        DATASET   (CLMS-ID)
 18416*        RIDFLD    (ELMSTR-KEY)
 18417*        GENERIC   EQUAL
 18418*        KEYLENGTH (ELMSTR-LENGTH)
 18419*    END-EXEC.
 18420     MOVE 0
 18421       TO DFHEIV11
 18422*    MOVE '&,   KG    E          &   #00018159' TO DFHEIV0
 18423     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18424     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18425     MOVE X'2020233030303138313539' TO DFHEIV0(25:11)
 18426     CALL 'kxdfhei1' USING DFHEIV0,
 18427           CLMS-ID,
 18428           ELMSTR-KEY,
 18429           ELMSTR-LENGTH,
 18430           DFHEIV11,
 18431           DFHEIV99
 18432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18433
 18434
 18435     MOVE 'Y'                    TO W-BROWSE-SW.
 18436
 18437 7250-NEXT-CLAIM.
 18438
 18439
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 338
* EL050.cbl
 18440* EXEC CICS READNEXT
 18441*        DATASET   (CLMS-ID)
 18442*        RIDFLD    (ELMSTR-KEY)
 18443*        SET       (ADDRESS OF CLAIM-MASTER)
 18444*    END-EXEC.
 18445     MOVE 0
 18446       TO DFHEIV11
 18447*    MOVE '&.S                   )   #00018170' TO DFHEIV0
 18448     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18449     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18450     MOVE X'2020233030303138313730' TO DFHEIV0(25:11)
 18451     CALL 'kxdfhei1' USING DFHEIV0,
 18452           CLMS-ID,
 18453           DFHEIV20,
 18454           DFHEIV99,
 18455           ELMSTR-KEY,
 18456           DFHEIV99,
 18457           DFHEIV11,
 18458           DFHEIV99,
 18459           DFHEIV99
 18460     SET ADDRESS OF CLAIM-MASTER TO
 18461         DFHEIV20
 18462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18463
 18464
 18465     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18466        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18467         GO TO 7250-CONTINUE
 18468     END-IF.
 18469
 18470     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18471        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18472        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18473        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18474        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18475         GO TO 7250-NEXT-CLAIM
 18476     END-IF.
 18477
 18478     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18479        OR (CL-CLAIM-TYPE = 'I')
 18480        OR (CL-CLAIM-TYPE = 'G')
 18481          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18482              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18483              GO TO 7250-CONTINUE
 18484          END-IF
 18485     END-IF.
 18486
 18487     GO TO 7250-NEXT-CLAIM.
 18488
 18489 7250-CONTINUE.
 18490
 18491     IF W-BROWSE-SW = 'Y'
 18492
 18493* EXEC CICS ENDBR
 18494*            DATASET   (CLMS-ID)
 18495*        END-EXEC
 18496     MOVE 0
 18497       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 339
* EL050.cbl
 18498*    MOVE '&2                    $   #00018203' TO DFHEIV0
 18499     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18500     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18501     MOVE X'2020233030303138323033' TO DFHEIV0(25:11)
 18502     CALL 'kxdfhei1' USING DFHEIV0,
 18503           CLMS-ID,
 18504           DFHEIV11,
 18505           DFHEIV99
 18506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18507         MOVE 'N' TO W-BROWSE-SW
 18508     END-IF.
 18509
 18510 7250-EXIT.
 18511     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 340
* EL050.cbl
 18513 7300-CHECK-FOR-OPEN-CLMS.
 18514
 18515*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18516*    MOVE SPACES                 TO CNTL-ACCESS.
 18517*    MOVE '1'                    TO CNTL-REC-TYPE.
 18518*    MOVE +0                     TO CNTL-SEQ-NO.
 18519
 18520*    MOVE '3'                    TO RC-SW-1.
 18521*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18522
 18523*    IF NOT CF-COMPANY-MASTER
 18524*         PERFORM 0099-COMPANY-NOT-FOUND
 18525*         GO TO 7300-EXIT.
 18526
 18527     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18528                                    W-CL-COMP-CD.
 18529     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18530                                    W-CL-CERT-NO.
 18531
 18532
 18533* EXEC CICS HANDLE CONDITION
 18534*        NOTFND  (7300-CONTINUE)
 18535*        ENDFILE (7300-CONTINUE)
 18536*    END-EXEC.
 18537*    MOVE '"$I''                  ! * #00018231' TO DFHEIV0
 18538     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18539     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18540     MOVE X'2A20233030303138323331' TO DFHEIV0(25:11)
 18541     CALL 'kxdfhei1' USING DFHEIV0
 18542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18543
 18544
 18545
 18546* EXEC CICS IGNORE CONDITION
 18547*        DUPKEY
 18548*    END-EXEC.
 18549*    MOVE '"*$                   !   #00018236' TO DFHEIV0
 18550     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18551     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18552     MOVE X'2020233030303138323336' TO DFHEIV0(25:11)
 18553     CALL 'kxdfhei1' USING DFHEIV0
 18554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18555
 18556
 18557
 18558* EXEC CICS STARTBR
 18559*        DATASET   (CLMS-ID)
 18560*        RIDFLD    (ELMSTR-KEY)
 18561*        GENERIC   EQUAL
 18562*        KEYLENGTH (ELMSTR-LENGTH)
 18563*    END-EXEC.
 18564     MOVE 0
 18565       TO DFHEIV11
 18566*    MOVE '&,   KG    E          &   #00018240' TO DFHEIV0
 18567     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18568     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18569     MOVE X'2020233030303138323430' TO DFHEIV0(25:11)
 18570     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 341
* EL050.cbl
 18571           CLMS-ID,
 18572           ELMSTR-KEY,
 18573           ELMSTR-LENGTH,
 18574           DFHEIV11,
 18575           DFHEIV99
 18576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18577
 18578
 18579     MOVE 'Y'                    TO W-BROWSE-SW.
 18580
 18581 7300-NEXT-CLAIM.
 18582
 18583
 18584* EXEC CICS READNEXT
 18585*        DATASET   (CLMS-ID)
 18586*        RIDFLD    (ELMSTR-KEY)
 18587*        SET       (ADDRESS OF CLAIM-MASTER)
 18588*    END-EXEC.
 18589     MOVE 0
 18590       TO DFHEIV11
 18591*    MOVE '&.S                   )   #00018251' TO DFHEIV0
 18592     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18593     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18594     MOVE X'2020233030303138323531' TO DFHEIV0(25:11)
 18595     CALL 'kxdfhei1' USING DFHEIV0,
 18596           CLMS-ID,
 18597           DFHEIV20,
 18598           DFHEIV99,
 18599           ELMSTR-KEY,
 18600           DFHEIV99,
 18601           DFHEIV11,
 18602           DFHEIV99,
 18603           DFHEIV99
 18604     SET ADDRESS OF CLAIM-MASTER TO
 18605         DFHEIV20
 18606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18607
 18608
 18609     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18610        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18611         GO TO 7300-CONTINUE.
 18612
 18613     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18614        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18615        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18616        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18617        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18618         GO TO 7300-NEXT-CLAIM.
 18619
 18620*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18621     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18622        OR (CL-CLAIM-TYPE = 'I')
 18623        OR (CL-CLAIM-TYPE = 'G')
 18624        IF CLAIM-IS-OPEN
 18625           EVALUATE TRUE
 18626             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18627                 MOVE ER-2884      TO WS-ERROR
 18628             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 342
* EL050.cbl
 18629                 MOVE ER-2887      TO WS-ERROR
 18630             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18631                 MOVE ER-2886      TO WS-ERROR
 18632             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18633                 MOVE ER-2888      TO WS-ERROR
 18634             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18635                 MOVE ER-2885      TO WS-ERROR
 18636             WHEN OTHER
 18637                 MOVE ER-2768      TO WS-ERROR
 18638           END-EVALUATE
 18639           IF PB-C-AH-CANCEL-VOIDED OR
 18640              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18641                NOT AH-COVERAGE-CANCELLED)
 18642               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18643               MOVE ER-2768      TO WS-ERROR
 18644           END-IF
 18645           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18646           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18647              PB-FORCE-CODE NOT EQUAL '8'
 18648               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18649           END-IF
 18650           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18651           GO TO 7300-CONTINUE
 18652        ELSE
 18653           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18654*****THIS IS A RESCISSION OR REFORMATION
 18655              IF (AH-COVERAGE-CANCELLED AND
 18656                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18657                    MOVE ER-2890 TO WS-ERROR
 18658                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18659                    GO TO 7300-CONTINUE
 18660              END-IF
 18661           ELSE
 18662              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18663               AND PB-C-AH-CANCEL-DT > SPACES
 18664                 MOVE ER-2756        TO WS-ERROR
 18665                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18666                 GO TO 7300-CONTINUE
 18667              END-IF
 18668           END-IF
 18669        END-IF
 18670     ELSE
 18671*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18672        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18673           IF CLAIM-IS-OPEN
 18674              MOVE ER-2889      TO WS-ERROR
 18675              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18676              GO TO 7300-CONTINUE
 18677           ELSE
 18678              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18679*****THIS IS A RESCISSION OR REFORMATION
 18680                 IF (LF-COVERAGE-CANCELLED AND
 18681                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18682                       MOVE ER-2890 TO WS-ERROR
 18683                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18684                       GO TO 7300-CONTINUE
 18685                 END-IF
 18686              ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 343
* EL050.cbl
 18687                 IF (AH-COVERAGE-CANCELLED AND
 18688                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18689                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18690                    (LF-COVERAGE-CANCELLED AND
 18691                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18692                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18693                       MOVE ER-2965 TO WS-ERROR
 18694                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18695                       GO TO 7300-CONTINUE
 18696                 END-IF
 18697                 IF LF-COVERAGE-CANCELLED
 18698                  IF CL-TOTAL-PAID-AMT > 0
 18699                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18700                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18701                        MOVE ER-2891 TO WS-ERROR
 18702                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18703                        GO TO 7300-CONTINUE
 18704                      END-IF
 18705                    ELSE
 18706                      MOVE ER-2892 TO WS-ERROR
 18707                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18708                      GO TO 7300-CONTINUE
 18709                    END-IF
 18710                  END-IF
 18711                 END-IF
 18712              END-IF
 18713           END-IF
 18714        END-IF
 18715     END-IF
 18716
 18717     GO TO 7300-NEXT-CLAIM.
 18718
 18719 7300-CONTINUE.
 18720
 18721     IF W-BROWSE-SW = 'Y'
 18722
 18723* EXEC CICS ENDBR
 18724*            DATASET   (CLMS-ID)
 18725*        END-EXEC.
 18726     MOVE 0
 18727       TO DFHEIV11
 18728*    MOVE '&2                    $   #00018370' TO DFHEIV0
 18729     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18730     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18731     MOVE X'2020233030303138333730' TO DFHEIV0(25:11)
 18732     CALL 'kxdfhei1' USING DFHEIV0,
 18733           CLMS-ID,
 18734           DFHEIV11,
 18735           DFHEIV99
 18736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18737
 18738
 18739 7300-EXIT.
 18740     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 344
* EL050.cbl
 18742
 18743 7400-GET-REMAIN-TERM.
 18744
 18745* EXEC CICS LINK
 18746*        PROGRAM    ('ELRTRM')
 18747*        COMMAREA   (CALCULATION-PASS-AREA)
 18748*        LENGTH     (CP-COMM-LENGTH)
 18749*    END-EXEC.
 18750     MOVE 'ELRTRM' TO DFHEIV1
 18751*    MOVE '."C                   (   #00018379' TO DFHEIV0
 18752     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18753     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18754     MOVE X'2020233030303138333739' TO DFHEIV0(25:11)
 18755     CALL 'kxdfhei1' USING DFHEIV0,
 18756           DFHEIV1,
 18757           CALCULATION-PASS-AREA,
 18758           CP-COMM-LENGTH,
 18759           DFHEIV99,
 18760           DFHEIV99,
 18761           DFHEIV99,
 18762           DFHEIV99
 18763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18764
 18765
 18766 7400-EXIT.
 18767     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 345
* EL050.cbl
 18769
 18770 7500-GET-REMAIN-AMOUNT.
 18771
 18772* EXEC CICS LINK
 18773*        PROGRAM    ('ELRAMT')
 18774*        COMMAREA   (CALCULATION-PASS-AREA)
 18775*        LENGTH     (CP-COMM-LENGTH)
 18776*    END-EXEC.
 18777     MOVE 'ELRAMT' TO DFHEIV1
 18778*    MOVE '."C                   (   #00018390' TO DFHEIV0
 18779     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18780     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18781     MOVE X'2020233030303138333930' TO DFHEIV0(25:11)
 18782     CALL 'kxdfhei1' USING DFHEIV0,
 18783           DFHEIV1,
 18784           CALCULATION-PASS-AREA,
 18785           CP-COMM-LENGTH,
 18786           DFHEIV99,
 18787           DFHEIV99,
 18788           DFHEIV99,
 18789           DFHEIV99
 18790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18791
 18792
 18793 7500-EXIT.
 18794     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 346
* EL050.cbl
 18796
 18797 7600-GET-REFUND.
 18798
 18799* EXEC CICS LINK
 18800*        PROGRAM    ('ELRFND')
 18801*        COMMAREA   (CALCULATION-PASS-AREA)
 18802*        LENGTH     (CP-COMM-LENGTH)
 18803*    END-EXEC.
 18804     MOVE 'ELRFND' TO DFHEIV1
 18805*    MOVE '."C                   (   #00018401' TO DFHEIV0
 18806     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18807     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18808     MOVE X'2020233030303138343031' TO DFHEIV0(25:11)
 18809     CALL 'kxdfhei1' USING DFHEIV0,
 18810           DFHEIV1,
 18811           CALCULATION-PASS-AREA,
 18812           CP-COMM-LENGTH,
 18813           DFHEIV99,
 18814           DFHEIV99,
 18815           DFHEIV99,
 18816           DFHEIV99
 18817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18818
 18819
 18820 7600-EXIT.
 18821     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 347
* EL050.cbl
 18823 7700-CALL-DL1.
 18824
 18825* EXEC CICS LINK
 18826*        PROGRAM    ('DLO001')
 18827*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 18828*        LENGTH     (DLO001-COMM-LENGTH)
 18829*    END-EXEC.
 18830     MOVE 'DLO001' TO DFHEIV1
 18831*    MOVE '."C                   (   #00018411' TO DFHEIV0
 18832     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18833     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18834     MOVE X'2020233030303138343131' TO DFHEIV0(25:11)
 18835     CALL 'kxdfhei1' USING DFHEIV0,
 18836           DFHEIV1,
 18837           WS-DLO-MASTER-POLICY-FORM,
 18838           DLO001-COMM-LENGTH,
 18839           DFHEIV99,
 18840           DFHEIV99,
 18841           DFHEIV99,
 18842           DFHEIV99
 18843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18844
 18845
 18846 7700-EXIT.
 18847     EXIT.
 18848
 18849 7710-CALL-DL2.
 18850
 18851* EXEC CICS LINK
 18852*        PROGRAM    ('DLO002')
 18853*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 18854*        LENGTH     (DLO002-COMM-LENGTH)
 18855*    END-EXEC.
 18856     MOVE 'DLO002' TO DFHEIV1
 18857*    MOVE '."C                   (   #00018421' TO DFHEIV0
 18858     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18859     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18860     MOVE X'2020233030303138343231' TO DFHEIV0(25:11)
 18861     CALL 'kxdfhei1' USING DFHEIV0,
 18862           DFHEIV1,
 18863           WS-DLO-INTERNAL-POLICY-FORM,
 18864           DLO002-COMM-LENGTH,
 18865           DFHEIV99,
 18866           DFHEIV99,
 18867           DFHEIV99,
 18868           DFHEIV99
 18869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18870
 18871
 18872 7710-EXIT.
 18873     EXIT.
 18874
 18875 7720-CALL-DL3.
 18876
 18877* EXEC CICS LINK
 18878*        PROGRAM    ('DLO003')
 18879*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 18880*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 348
* EL050.cbl
 18881*    END-EXEC.
 18882     MOVE 'DLO003' TO DFHEIV1
 18883*    MOVE '."C                   (   #00018431' TO DFHEIV0
 18884     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18885     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18886     MOVE X'2020233030303138343331' TO DFHEIV0(25:11)
 18887     CALL 'kxdfhei1' USING DFHEIV0,
 18888           DFHEIV1,
 18889           WS-DLO-VALID-BANK-ID,
 18890           DLO003-COMM-LENGTH,
 18891           DFHEIV99,
 18892           DFHEIV99,
 18893           DFHEIV99,
 18894           DFHEIV99
 18895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18896
 18897
 18898 7720-EXIT.
 18899     EXIT.
 18900
 18901 7730-CALL-DL7.
 18902
 18903* EXEC CICS LINK
 18904*        PROGRAM    ('DLO007')
 18905*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 18906*        LENGTH     (DLO007-COMM-LENGTH)
 18907*    END-EXEC.
 18908     MOVE 'DLO007' TO DFHEIV1
 18909*    MOVE '."C                   (   #00018441' TO DFHEIV0
 18910     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18911     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18912     MOVE X'2020233030303138343431' TO DFHEIV0(25:11)
 18913     CALL 'kxdfhei1' USING DFHEIV0,
 18914           DFHEIV1,
 18915           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 18916           DLO007-COMM-LENGTH,
 18917           DFHEIV99,
 18918           DFHEIV99,
 18919           DFHEIV99,
 18920           DFHEIV99
 18921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18922
 18923
 18924 7730-EXIT.
 18925     EXIT.
 18926
 18927 7740-CALL-DL11.
 18928
 18929* EXEC CICS LINK
 18930*        PROGRAM    ('DLO011')
 18931*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 18932*        LENGTH     (DLO011-COMM-LENGTH)
 18933*    END-EXEC.
 18934     MOVE 'DLO011' TO DFHEIV1
 18935*    MOVE '."C                   (   #00018451' TO DFHEIV0
 18936     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18937     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18938     MOVE X'2020233030303138343531' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 349
* EL050.cbl
 18939     CALL 'kxdfhei1' USING DFHEIV0,
 18940           DFHEIV1,
 18941           WS-DLO-PREM-RATES-BEN-TYPE,
 18942           DLO011-COMM-LENGTH,
 18943           DFHEIV99,
 18944           DFHEIV99,
 18945           DFHEIV99,
 18946           DFHEIV99
 18947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18948
 18949
 18950 7740-EXIT.
 18951     EXIT.
 18952
 18953 7750-CALL-DL17.
 18954
 18955* EXEC CICS LINK
 18956*        PROGRAM    ('DLO017')
 18957*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 18958*        LENGTH     (DLO017-COMM-LENGTH)
 18959*    END-EXEC.
 18960     MOVE 'DLO017' TO DFHEIV1
 18961*    MOVE '."C                   (   #00018461' TO DFHEIV0
 18962     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18963     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18964     MOVE X'2020233030303138343631' TO DFHEIV0(25:11)
 18965     CALL 'kxdfhei1' USING DFHEIV0,
 18966           DFHEIV1,
 18967           WS-DLO-VALID-RATE-CODE,
 18968           DLO017-COMM-LENGTH,
 18969           DFHEIV99,
 18970           DFHEIV99,
 18971           DFHEIV99,
 18972           DFHEIV99
 18973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18974
 18975
 18976 7750-EXIT.
 18977     EXIT.
 18978
 18979 7755-CALL-DL19.
 18980
 18981* EXEC CICS LINK
 18982*        PROGRAM    ('DLO019')
 18983*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 18984*        LENGTH     (DLO019-COMM-LENGTH)
 18985*    END-EXEC.
 18986     MOVE 'DLO019' TO DFHEIV1
 18987*    MOVE '."C                   (   #00018471' TO DFHEIV0
 18988     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18989     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18990     MOVE X'2020233030303138343731' TO DFHEIV0(25:11)
 18991     CALL 'kxdfhei1' USING DFHEIV0,
 18992           DFHEIV1,
 18993           WS-DLO-ORIG-COV-CAT,
 18994           DLO019-COMM-LENGTH,
 18995           DFHEIV99,
 18996           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 350
* EL050.cbl
 18997           DFHEIV99,
 18998           DFHEIV99
 18999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19000
 19001
 19002 7755-EXIT.
 19003     EXIT.
 19004
 19005 7760-CALL-DL21.
 19006
 19007* EXEC CICS LINK
 19008*        PROGRAM    ('DLO021')
 19009*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19010*        LENGTH     (DLO021-COMM-LENGTH)
 19011*    END-EXEC.
 19012     MOVE 'DLO021' TO DFHEIV1
 19013*    MOVE '."C                   (   #00018481' TO DFHEIV0
 19014     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19015     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19016     MOVE X'2020233030303138343831' TO DFHEIV0(25:11)
 19017     CALL 'kxdfhei1' USING DFHEIV0,
 19018           DFHEIV1,
 19019           WS-DLO-VALID-LOAN-OFFICER,
 19020           DLO021-COMM-LENGTH,
 19021           DFHEIV99,
 19022           DFHEIV99,
 19023           DFHEIV99,
 19024           DFHEIV99
 19025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19026
 19027
 19028 7760-EXIT.
 19029     EXIT.
 19030
 19031 7770-CALL-DL22.
 19032
 19033* EXEC CICS LINK
 19034*        PROGRAM    ('DLO022')
 19035*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19036*        LENGTH     (DLO022-COMM-LENGTH)
 19037*    END-EXEC.
 19038     MOVE 'DLO022' TO DFHEIV1
 19039*    MOVE '."C                   (   #00018491' TO DFHEIV0
 19040     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19041     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19042     MOVE X'2020233030303138343931' TO DFHEIV0(25:11)
 19043     CALL 'kxdfhei1' USING DFHEIV0,
 19044           DFHEIV1,
 19045           WS-DLO-VALID-STATE-CODE,
 19046           DLO022-COMM-LENGTH,
 19047           DFHEIV99,
 19048           DFHEIV99,
 19049           DFHEIV99,
 19050           DFHEIV99
 19051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19052
 19053
 19054 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 351
* EL050.cbl
 19055     EXIT.
 19056
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 352
* EL050.cbl
 19058
 19059 7800-REWRITE-CERT.
 19060******************************************************************
 19061*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19062*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19063******************************************************************
 19064
 19065     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19066        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19067        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19068        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19069
 19070* EXEC CICS REWRITE
 19071*                  DATASET (CERT-ID)
 19072*                  FROM    (CERTIFICATE-MASTER)
 19073*              END-EXEC
 19074     MOVE LENGTH OF
 19075      CERTIFICATE-MASTER
 19076       TO DFHEIV11
 19077*    MOVE '&& L                  %   #00018512' TO DFHEIV0
 19078     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19079     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19080     MOVE X'2020233030303138353132' TO DFHEIV0(25:11)
 19081     CALL 'kxdfhei1' USING DFHEIV0,
 19082           CERT-ID,
 19083           CERTIFICATE-MASTER,
 19084           DFHEIV11,
 19085           DFHEIV99
 19086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19087        GO TO 7800-EXIT.
 19088
 19089       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19090       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19091
 19092 7800-EXIT.
 19093      EXIT.
 19094
 19095 7900-DELETE-CERT.
 19096
 19097* EXEC CICS DELETE
 19098*        DATASET (CERT-ID)
 19099*    END-EXEC.
 19100*    MOVE '&(                    &   #00018525' TO DFHEIV0
 19101     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19102     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19103     MOVE X'2020233030303138353235' TO DFHEIV0(25:11)
 19104     CALL 'kxdfhei1' USING DFHEIV0,
 19105           CERT-ID,
 19106           DFHEIV99,
 19107           DFHEIV99,
 19108           DFHEIV99,
 19109           DFHEIV99
 19110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19111
 19112
 19113 7900-EXIT.
 19114     EXIT.
 19115
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 353
* EL050.cbl
 19116 8000-WRITE-CERT.
 19117
 19118* EXEC CICS HANDLE CONDITION
 19119*        DUPKEY    (8000-FREE-MAIN)
 19120*    END-EXEC.
 19121*    MOVE '"$$                   ! + #00018533' TO DFHEIV0
 19122     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19123     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19124     MOVE X'2B20233030303138353333' TO DFHEIV0(25:11)
 19125     CALL 'kxdfhei1' USING DFHEIV0
 19126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19127
 19128
 19129
 19130* EXEC CICS WRITE
 19131*        DATASET     (CERT-ID)
 19132*        FROM        (CERTIFICATE-MASTER)
 19133*        RIDFLD      (ELCERT-KEY)
 19134*    END-EXEC.
 19135     MOVE LENGTH OF
 19136      CERTIFICATE-MASTER
 19137       TO DFHEIV11
 19138*    MOVE '&$ L                  ''   #00018537' TO DFHEIV0
 19139     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19140     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19141     MOVE X'2020233030303138353337' TO DFHEIV0(25:11)
 19142     CALL 'kxdfhei1' USING DFHEIV0,
 19143           CERT-ID,
 19144           CERTIFICATE-MASTER,
 19145           DFHEIV11,
 19146           ELCERT-KEY,
 19147           DFHEIV99,
 19148           DFHEIV99
 19149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19150
 19151
 19152 8000-FREE-MAIN.
 19153
 19154 8000-EXIT.
 19155      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 354
* EL050.cbl
 19157
 19158 8100-READ-ERPNDM.
 19159
 19160* EXEC CICS HANDLE CONDITION
 19161*         NOTFND     (8100-NOTFND)
 19162*         ENDFILE    (8100-NOTFND)
 19163*    END-EXEC.
 19164*    MOVE '"$I''                  ! , #00018550' TO DFHEIV0
 19165     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19166     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19167     MOVE X'2C20233030303138353530' TO DFHEIV0(25:11)
 19168     CALL 'kxdfhei1' USING DFHEIV0
 19169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19170
 19171
 19172     MOVE SPACES                 TO ERPNDM-FOUND.
 19173     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19174
 19175
 19176* EXEC CICS READ
 19177*         DATASET   (FILE-ERPNDM)
 19178*         RIDFLD    (PM-CONTROL-PRIMARY)
 19179*         INTO      (PENDING-MAILING-DATA)
 19180*    END-EXEC.
 19181     MOVE LENGTH OF
 19182      PENDING-MAILING-DATA
 19183       TO DFHEIV11
 19184*    MOVE '&"IL       E          (   #00018558' TO DFHEIV0
 19185     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19186     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19187     MOVE X'2020233030303138353538' TO DFHEIV0(25:11)
 19188     CALL 'kxdfhei1' USING DFHEIV0,
 19189           FILE-ERPNDM,
 19190           PENDING-MAILING-DATA,
 19191           DFHEIV11,
 19192           PM-CONTROL-PRIMARY,
 19193           DFHEIV99,
 19194           DFHEIV99,
 19195           DFHEIV99
 19196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19197
 19198
 19199     GO TO 8100-EXIT.
 19200
 19201 8100-NOTFND.
 19202
 19203     MOVE 'X'                    TO ERPNDM-FOUND.
 19204     MOVE ER-2694                TO WS-ERROR.
 19205     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19206     MOVE ER-2883                TO WS-ERROR
 19207     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19208     .
 19209 8100-EXIT.
 19210     EXIT.
 19211
 19212 8110-READ-ERMAIL.
 19213
 19214* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 355
* EL050.cbl
 19215*         NOTFND     (8110-NOTFND)
 19216*         ENDFILE    (8110-NOTFND)
 19217*    END-EXEC.
 19218*    MOVE '"$I''                  ! - #00018578' TO DFHEIV0
 19219     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19220     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19221     MOVE X'2D20233030303138353738' TO DFHEIV0(25:11)
 19222     CALL 'kxdfhei1' USING DFHEIV0
 19223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19224
 19225
 19226     MOVE SPACES                 TO ERMAIL-FOUND.
 19227     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19228     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19229     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19230     MOVE PB-SV-STATE            TO MA-STATE.
 19231
 19232
 19233* EXEC CICS READ
 19234*         UPDATE
 19235*         DATASET   (FILE-ERMAIL)
 19236*         RIDFLD    (MA-CONTROL-PRIMARY)
 19237*         INTO      (MAILING-DATA)
 19238*    END-EXEC.
 19239     MOVE LENGTH OF
 19240      MAILING-DATA
 19241       TO DFHEIV11
 19242*    MOVE '&"IL       EU         (   #00018589' TO DFHEIV0
 19243     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19244     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19245     MOVE X'2020233030303138353839' TO DFHEIV0(25:11)
 19246     CALL 'kxdfhei1' USING DFHEIV0,
 19247           FILE-ERMAIL,
 19248           MAILING-DATA,
 19249           DFHEIV11,
 19250           MA-CONTROL-PRIMARY,
 19251           DFHEIV99,
 19252           DFHEIV99,
 19253           DFHEIV99
 19254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19255
 19256
 19257     GO TO 8110-EXIT.
 19258
 19259 8110-NOTFND.
 19260     MOVE 'X'                    TO ERMAIL-FOUND.
 19261
 19262 8110-EXIT.
 19263     EXIT.
 19264
 19265 8120-REWRITE-ERMAIL.
 19266
 19267* EXEC CICS REWRITE
 19268*         DATASET    (FILE-ERMAIL)
 19269*         FROM       (MAILING-DATA)
 19270*    END-EXEC.
 19271     MOVE LENGTH OF
 19272      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 356
* EL050.cbl
 19273       TO DFHEIV11
 19274*    MOVE '&& L                  %   #00018605' TO DFHEIV0
 19275     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19276     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19277     MOVE X'2020233030303138363035' TO DFHEIV0(25:11)
 19278     CALL 'kxdfhei1' USING DFHEIV0,
 19279           FILE-ERMAIL,
 19280           MAILING-DATA,
 19281           DFHEIV11,
 19282           DFHEIV99
 19283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19284
 19285
 19286 8120-EXIT.
 19287     EXIT.
 19288
 19289 8130-WRITE-ERMAIL.
 19290
 19291* EXEC CICS HANDLE CONDITION
 19292*         DUPKEY   (8130-EXIT)
 19293*    END-EXEC.
 19294*    MOVE '"$$                   ! . #00018614' TO DFHEIV0
 19295     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19296     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19297     MOVE X'2E20233030303138363134' TO DFHEIV0(25:11)
 19298     CALL 'kxdfhei1' USING DFHEIV0
 19299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19300
 19301
 19302
 19303* EXEC CICS WRITE
 19304*         DATASET     (FILE-ERMAIL)
 19305*         RIDFLD      (MA-CONTROL-PRIMARY)
 19306*         FROM        (MAILING-DATA)
 19307*    END-EXEC.
 19308     MOVE LENGTH OF
 19309      MAILING-DATA
 19310       TO DFHEIV11
 19311*    MOVE '&$ L                  ''   #00018618' TO DFHEIV0
 19312     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19313     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19314     MOVE X'2020233030303138363138' TO DFHEIV0(25:11)
 19315     CALL 'kxdfhei1' USING DFHEIV0,
 19316           FILE-ERMAIL,
 19317           MAILING-DATA,
 19318           DFHEIV11,
 19319           MA-CONTROL-PRIMARY,
 19320           DFHEIV99,
 19321           DFHEIV99
 19322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19323
 19324
 19325 8130-EXIT.
 19326     EXIT.
 19327
 19328 8140-UNLOCK-ERMAIL.
 19329
 19330* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 357
* EL050.cbl
 19331*         DATASET   (FILE-ERMAIL)
 19332*    END-EXEC.
 19333*    MOVE '&*                    #   #00018628' TO DFHEIV0
 19334     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19335     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19336     MOVE X'2020233030303138363238' TO DFHEIV0(25:11)
 19337     CALL 'kxdfhei1' USING DFHEIV0,
 19338           FILE-ERMAIL,
 19339           DFHEIV99
 19340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19341
 19342
 19343 8140-EXIT.
 19344     EXIT.
 19345
 19346 8180-UPDATE-VIN-NUMBER.
 19347
 19348* EXEC CICS HANDLE CONDITION
 19349*        NOTFND   (8180-NOTFND)
 19350*    END-EXEC.
 19351*    MOVE '"$I                   ! / #00018636' TO DFHEIV0
 19352     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19353     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19354     MOVE X'2F20233030303138363336' TO DFHEIV0(25:11)
 19355     CALL 'kxdfhei1' USING DFHEIV0
 19356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19357
 19358
 19359     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19360     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19361
 19362
 19363* EXEC CICS READ
 19364*        UPDATE
 19365*        DATASET  (CRTT-ID)
 19366*        RIDFLD   (WS-ELCRTT-KEY)
 19367*        INTO     (CERTIFICATE-TRAILERS)
 19368*    END-EXEC.
 19369     MOVE LENGTH OF
 19370      CERTIFICATE-TRAILERS
 19371       TO DFHEIV11
 19372*    MOVE '&"IL       EU         (   #00018643' TO DFHEIV0
 19373     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19374     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19375     MOVE X'2020233030303138363433' TO DFHEIV0(25:11)
 19376     CALL 'kxdfhei1' USING DFHEIV0,
 19377           CRTT-ID,
 19378           CERTIFICATE-TRAILERS,
 19379           DFHEIV11,
 19380           WS-ELCRTT-KEY,
 19381           DFHEIV99,
 19382           DFHEIV99,
 19383           DFHEIV99
 19384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19385
 19386
 19387     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19388         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 358
* EL050.cbl
 19389
 19390* EXEC CICS REWRITE
 19391*           DATASET  (CRTT-ID)
 19392*           FROM     (CERTIFICATE-TRAILERS)
 19393*        END-EXEC
 19394     MOVE LENGTH OF
 19395      CERTIFICATE-TRAILERS
 19396       TO DFHEIV11
 19397*    MOVE '&& L                  %   #00018652' TO DFHEIV0
 19398     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19399     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19400     MOVE X'2020233030303138363532' TO DFHEIV0(25:11)
 19401     CALL 'kxdfhei1' USING DFHEIV0,
 19402           CRTT-ID,
 19403           CERTIFICATE-TRAILERS,
 19404           DFHEIV11,
 19405           DFHEIV99
 19406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19407     ELSE
 19408
 19409* EXEC CICS UNLOCK
 19410*          DATASET  (CRTT-ID)
 19411*       END-EXEC
 19412*    MOVE '&*                    #   #00018657' TO DFHEIV0
 19413     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19414     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19415     MOVE X'2020233030303138363537' TO DFHEIV0(25:11)
 19416     CALL 'kxdfhei1' USING DFHEIV0,
 19417           CRTT-ID,
 19418           DFHEIV99
 19419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19420     END-IF.
 19421
 19422     GO TO 8180-EXIT.
 19423
 19424 8180-NOTFND.
 19425
 19426     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19427     MOVE 'CS'         TO CS-RECORD-ID.
 19428     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19429     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19430     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19431     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19432
 19433* EXEC CICS WRITE
 19434*       DATASET  (CRTT-ID)
 19435*       RIDFLD   (WS-ELCRTT-KEY)
 19436*       FROM     (CERTIFICATE-TRAILERS)
 19437*    END-EXEC.
 19438     MOVE LENGTH OF
 19439      CERTIFICATE-TRAILERS
 19440       TO DFHEIV11
 19441*    MOVE '&$ L                  ''   #00018672' TO DFHEIV0
 19442     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19443     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19444     MOVE X'2020233030303138363732' TO DFHEIV0(25:11)
 19445     CALL 'kxdfhei1' USING DFHEIV0,
 19446           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 359
* EL050.cbl
 19447           CERTIFICATE-TRAILERS,
 19448           DFHEIV11,
 19449           WS-ELCRTT-KEY,
 19450           DFHEIV99,
 19451           DFHEIV99
 19452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19453
 19454
 19455 8180-EXIT.
 19456     EXIT.
 19457
 19458 8190-UPDATE-REFUND-CLAIM-FLAG.
 19459
 19460* EXEC CICS HANDLE CONDITION
 19461*        NOTFND   (8190-NOTFND)
 19462*    END-EXEC.
 19463*    MOVE '"$I                   ! 0 #00018682' TO DFHEIV0
 19464     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19465     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19466     MOVE X'3020233030303138363832' TO DFHEIV0(25:11)
 19467     CALL 'kxdfhei1' USING DFHEIV0
 19468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19469
 19470
 19471     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19472     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19473
 19474
 19475* EXEC CICS READ
 19476*        UPDATE
 19477*        DATASET  (CRTT-ID)
 19478*        RIDFLD   (WS-ELCRTT-KEY)
 19479*        INTO     (CERTIFICATE-TRAILERS)
 19480*    END-EXEC.
 19481     MOVE LENGTH OF
 19482      CERTIFICATE-TRAILERS
 19483       TO DFHEIV11
 19484*    MOVE '&"IL       EU         (   #00018689' TO DFHEIV0
 19485     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19486     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19487     MOVE X'2020233030303138363839' TO DFHEIV0(25:11)
 19488     CALL 'kxdfhei1' USING DFHEIV0,
 19489           CRTT-ID,
 19490           CERTIFICATE-TRAILERS,
 19491           DFHEIV11,
 19492           WS-ELCRTT-KEY,
 19493           DFHEIV99,
 19494           DFHEIV99,
 19495           DFHEIV99
 19496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19497
 19498
 19499     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19500
 19501* EXEC CICS REWRITE
 19502*       DATASET  (CRTT-ID)
 19503*       FROM     (CERTIFICATE-TRAILERS)
 19504*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 360
* EL050.cbl
 19505     MOVE LENGTH OF
 19506      CERTIFICATE-TRAILERS
 19507       TO DFHEIV11
 19508*    MOVE '&& L                  %   #00018697' TO DFHEIV0
 19509     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19510     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19511     MOVE X'2020233030303138363937' TO DFHEIV0(25:11)
 19512     CALL 'kxdfhei1' USING DFHEIV0,
 19513           CRTT-ID,
 19514           CERTIFICATE-TRAILERS,
 19515           DFHEIV11,
 19516           DFHEIV99
 19517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19518
 19519
 19520     GO TO 8190-EXIT.
 19521
 19522 8190-NOTFND.
 19523
 19524     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19525     MOVE 'CS'         TO CS-RECORD-ID.
 19526     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19527     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19528     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19529     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19530
 19531* EXEC CICS WRITE
 19532*       DATASET  (CRTT-ID)
 19533*       RIDFLD   (WS-ELCRTT-KEY)
 19534*       FROM     (CERTIFICATE-TRAILERS)
 19535*    END-EXEC.
 19536     MOVE LENGTH OF
 19537      CERTIFICATE-TRAILERS
 19538       TO DFHEIV11
 19539*    MOVE '&$ L                  ''   #00018712' TO DFHEIV0
 19540     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19541     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19542     MOVE X'2020233030303138373132' TO DFHEIV0(25:11)
 19543     CALL 'kxdfhei1' USING DFHEIV0,
 19544           CRTT-ID,
 19545           CERTIFICATE-TRAILERS,
 19546           DFHEIV11,
 19547           WS-ELCRTT-KEY,
 19548           DFHEIV99,
 19549           DFHEIV99
 19550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19551
 19552
 19553 8190-EXIT.
 19554     EXIT.
 19555
 19556 8200-READ-REIN-TABLE.
 19557
 19558* EXEC CICS HANDLE CONDITION
 19559*         NOTFND   (8200-NOTFND)
 19560*    END-EXEC.
 19561*    MOVE '"$I                   ! 1 #00018722' TO DFHEIV0
 19562     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 361
* EL050.cbl
 19563     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19564     MOVE X'3120233030303138373232' TO DFHEIV0(25:11)
 19565     CALL 'kxdfhei1' USING DFHEIV0
 19566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19567
 19568
 19569
 19570* EXEC CICS READ
 19571*        DATASET     (REIN-ID)
 19572*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19573*        RIDFLD      (ERREIN-KEY)
 19574*    END-EXEC.
 19575*    MOVE '&"S        E          (   #00018726' TO DFHEIV0
 19576     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19577     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19578     MOVE X'2020233030303138373236' TO DFHEIV0(25:11)
 19579     CALL 'kxdfhei1' USING DFHEIV0,
 19580           REIN-ID,
 19581           DFHEIV20,
 19582           DFHEIV99,
 19583           ERREIN-KEY,
 19584           DFHEIV99,
 19585           DFHEIV99,
 19586           DFHEIV99
 19587     SET ADDRESS OF REINSURANCE-RECORD TO
 19588         DFHEIV20
 19589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19590
 19591
 19592     GO TO 8200-EXIT.
 19593
 19594 8200-NOTFND.
 19595     MOVE 'N'             TO WS-REIN-READ-SW.
 19596
 19597 8200-EXIT.
 19598      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 362
* EL050.cbl
 19600
 19601 8300-READ-CTBL-TABLE.
 19602
 19603* EXEC CICS HANDLE CONDITION
 19604*        NOTFND    (8300-NOTFND)
 19605*        DISABLED  (8300-ERRESS-PROBLEM)
 19606*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19607*        ENDFILE   (8300-NOTFND)
 19608*    END-EXEC.
 19609*    MOVE '"$IcJ''                ! 2 #00018742' TO DFHEIV0
 19610     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19611     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19612     MOVE X'3220233030303138373432' TO DFHEIV0(25:11)
 19613     CALL 'kxdfhei1' USING DFHEIV0
 19614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19615
 19616
 19617
 19618* EXEC CICS READ
 19619*        DATASET     (CTBL-ID)
 19620*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19621*        RIDFLD      (ERCTBL-KEY)
 19622*    END-EXEC.
 19623*    MOVE '&"S        E          (   #00018749' TO DFHEIV0
 19624     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19625     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19626     MOVE X'2020233030303138373439' TO DFHEIV0(25:11)
 19627     CALL 'kxdfhei1' USING DFHEIV0,
 19628           CTBL-ID,
 19629           DFHEIV20,
 19630           DFHEIV99,
 19631           ERCTBL-KEY,
 19632           DFHEIV99,
 19633           DFHEIV99,
 19634           DFHEIV99
 19635     SET ADDRESS OF COMM-TABLE-RECORD TO
 19636         DFHEIV20
 19637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19638
 19639
 19640     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19641
 19642     GO TO 8300-EXIT.
 19643
 19644 8300-NOTFND.
 19645
 19646     IF CTBL-SW = '0530'
 19647         MOVE 'AA'                     TO WS-AH-COMP-CD
 19648         MOVE '0550'                   TO CTBL-SW
 19649         MOVE '1'                      TO WS-CTBL-READ-SW
 19650         GO TO 8300-EXIT.
 19651
 19652     IF CTBL-SW = '0540'
 19653         MOVE 'AA'                     TO WS-LF-COMP-CD
 19654         MOVE '0550'                   TO CTBL-SW
 19655         MOVE '1'                      TO WS-CTBL-READ-SW
 19656         GO TO 8300-EXIT.
 19657
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 363
* EL050.cbl
 19658     IF CTBL-SW = '0550'
 19659         MOVE '2'                      TO WS-CTBL-READ-SW
 19660         GO TO 8300-EXIT.
 19661
 19662     GO TO 8300-EXIT.
 19663
 19664 8300-ERRESS-PROBLEM.
 19665
 19666      MOVE ER-8050              TO WS-ERROR.
 19667      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19668
 19669     GO TO 8300-EXIT.
 19670
 19671 8300-EXIT.
 19672      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 364
* EL050.cbl
 19674
 19675
 19676 8400-GETMAIN-ERFORM.
 19677
 19678
 19679* EXEC CICS   GETMAIN
 19680*        LENGTH  (500)
 19681*        SET     (ADDRESS OF FORM-MASTER)
 19682*    END-EXEC.
 19683     MOVE 500
 19684       TO DFHEIV11
 19685*    MOVE '," L                  $   #00018793' TO DFHEIV0
 19686     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19687     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19688     MOVE X'2020233030303138373933' TO DFHEIV0(25:11)
 19689     CALL 'kxdfhei1' USING DFHEIV0,
 19690           DFHEIV20,
 19691           DFHEIV11,
 19692           DFHEIV99
 19693     SET ADDRESS OF FORM-MASTER TO
 19694         DFHEIV20
 19695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19696
 19697
 19698     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 19699
 19700 8400-EXIT.
 19701      EXIT.
 19702
 19703 8450-READ-FORM-MASTER.
 19704
 19705
 19706* EXEC CICS  HANDLE CONDITION
 19707*        NOTFND   (8450-FORM-NOT-FOUND)
 19708*        ENDFILE  (8450-FORM-NOT-FOUND)
 19709*    END-EXEC.
 19710*    MOVE '"$I''                  ! 3 #00018805' TO DFHEIV0
 19711     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19712     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19713     MOVE X'3320233030303138383035' TO DFHEIV0(25:11)
 19714     CALL 'kxdfhei1' USING DFHEIV0
 19715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19716
 19717
 19718
 19719* EXEC CICS   READ
 19720*        DATASET   (FORM-ID)
 19721*        RIDFLD    (ERFORM-KEY)
 19722*        INTO      (FORM-MASTER)
 19723*        GTEQ
 19724*    END-EXEC.
 19725     MOVE LENGTH OF
 19726      FORM-MASTER
 19727       TO DFHEIV11
 19728*    MOVE '&"IL       G          (   #00018810' TO DFHEIV0
 19729     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 19730     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19731     MOVE X'2020233030303138383130' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 365
* EL050.cbl
 19732     CALL 'kxdfhei1' USING DFHEIV0,
 19733           FORM-ID,
 19734           FORM-MASTER,
 19735           DFHEIV11,
 19736           ERFORM-KEY,
 19737           DFHEIV99,
 19738           DFHEIV99,
 19739           DFHEIV99
 19740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19741
 19742
 19743     MOVE  'Y'           TO  FORM-MASTER-SW.
 19744
 19745     GO TO  8450-EXIT.
 19746
 19747 8450-FORM-NOT-FOUND.
 19748
 19749     MOVE  'N'           TO  FORM-MASTER-SW.
 19750
 19751 8450-EXIT.
 19752      EXIT.
 19753
 19754 8500-DATE-CONVERT.
 19755
 19756* EXEC CICS LINK
 19757*        PROGRAM    ('ELDATCV')
 19758*        COMMAREA   (DATE-CONVERSION-DATA)
 19759*        LENGTH     (DC-COMM-LENGTH)
 19760*    END-EXEC.
 19761     MOVE 'ELDATCV' TO DFHEIV1
 19762*    MOVE '."C                   (   #00018829' TO DFHEIV0
 19763     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19764     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19765     MOVE X'2020233030303138383239' TO DFHEIV0(25:11)
 19766     CALL 'kxdfhei1' USING DFHEIV0,
 19767           DFHEIV1,
 19768           DATE-CONVERSION-DATA,
 19769           DC-COMM-LENGTH,
 19770           DFHEIV99,
 19771           DFHEIV99,
 19772           DFHEIV99,
 19773           DFHEIV99
 19774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19775
 19776
 19777 8500-EXIT.
 19778     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 366
* EL050.cbl
 19780
 19781 8555-RELOAD-CONTROL-FILE.
 19782     CONTINUE.
 19783
 19784 8555-EXIT.
 19785     EXIT.
 19786
 19787 8557-GETMAIN-ERPLAN.
 19788
 19789
 19790* EXEC CICS GETMAIN
 19791*        LENGTH    (840)
 19792*        SET       (ADDRESS OF PLAN-RECORDS)
 19793*    END-EXEC.
 19794     MOVE 840
 19795       TO DFHEIV11
 19796*    MOVE '," L                  $   #00018847' TO DFHEIV0
 19797     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19798     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19799     MOVE X'2020233030303138383437' TO DFHEIV0(25:11)
 19800     CALL 'kxdfhei1' USING DFHEIV0,
 19801           DFHEIV20,
 19802           DFHEIV11,
 19803           DFHEIV99
 19804     SET ADDRESS OF PLAN-RECORDS TO
 19805         DFHEIV20
 19806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19807
 19808
 19809     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 19810
 19811 8557-EXIT.
 19812     EXIT.
 19813
 19814 8560-GETMAIN.
 19815
 19816* EXEC CICS GETMAIN
 19817*        LENGTH    (2000)
 19818*        SET       (ADDRESS OF ACCOUNT-MASTER)
 19819*    END-EXEC.
 19820     MOVE 2000
 19821       TO DFHEIV11
 19822*    MOVE '," L                  $   #00018858' TO DFHEIV0
 19823     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19824     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19825     MOVE X'2020233030303138383538' TO DFHEIV0(25:11)
 19826     CALL 'kxdfhei1' USING DFHEIV0,
 19827           DFHEIV20,
 19828           DFHEIV11,
 19829           DFHEIV99
 19830     SET ADDRESS OF ACCOUNT-MASTER TO
 19831         DFHEIV20
 19832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19833
 19834
 19835     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 19836
 19837 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 367
* EL050.cbl
 19838     EXIT.
 19839
 19840 8570-START-ACCOUNT-MASTER.
 19841
 19842* EXEC CICS HANDLE CONDITION
 19843*        NOTFND    (0199-ACCT-NOT-FOUND)
 19844*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19845*    END-EXEC.
 19846*    MOVE '"$I''                  ! 4 #00018869' TO DFHEIV0
 19847     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19848     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19849     MOVE X'3420233030303138383639' TO DFHEIV0(25:11)
 19850     CALL 'kxdfhei1' USING DFHEIV0
 19851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19852
 19853
 19854
 19855* EXEC CICS STARTBR
 19856*        DATASET    (ACCT-ID)
 19857*        RIDFLD     (ERACCT-KEY)
 19858*        GTEQ
 19859*    END-EXEC.
 19860     MOVE 0
 19861       TO DFHEIV11
 19862*    MOVE '&,         G          &   #00018874' TO DFHEIV0
 19863     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19864     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19865     MOVE X'2020233030303138383734' TO DFHEIV0(25:11)
 19866     CALL 'kxdfhei1' USING DFHEIV0,
 19867           ACCT-ID,
 19868           ERACCT-KEY,
 19869           DFHEIV99,
 19870           DFHEIV11,
 19871           DFHEIV99
 19872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19873
 19874
 19875 8570-EXIT.
 19876     EXIT.
 19877
 19878 8580-READ-ACCOUNT-MASTER.
 19879
 19880* EXEC CICS HANDLE CONDITION
 19881*        NOTFND    (0199-ACCT-NOT-FOUND)
 19882*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19883*    END-EXEC.
 19884*    MOVE '"$I''                  ! 5 #00018884' TO DFHEIV0
 19885     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19886     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19887     MOVE X'3520233030303138383834' TO DFHEIV0(25:11)
 19888     CALL 'kxdfhei1' USING DFHEIV0
 19889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19890
 19891
 19892
 19893* EXEC CICS READNEXT
 19894*        DATASET     (ACCT-ID)
 19895*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 368
* EL050.cbl
 19896*        RIDFLD      (ERACCT-KEY)
 19897*    END-EXEC.
 19898     MOVE LENGTH OF
 19899      ACCOUNT-MASTER
 19900       TO DFHEIV12
 19901     MOVE 0
 19902       TO DFHEIV11
 19903*    MOVE '&.IL                  )   #00018889' TO DFHEIV0
 19904     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19905     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19906     MOVE X'2020233030303138383839' TO DFHEIV0(25:11)
 19907     CALL 'kxdfhei1' USING DFHEIV0,
 19908           ACCT-ID,
 19909           ACCOUNT-MASTER,
 19910           DFHEIV12,
 19911           ERACCT-KEY,
 19912           DFHEIV99,
 19913           DFHEIV11,
 19914           DFHEIV99,
 19915           DFHEIV99
 19916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19917
 19918
 19919 8580-EXIT.
 19920     EXIT.
 19921
 19922 8582-READ-COMPENSATION-MASTER.
 19923
 19924* EXEC CICS HANDLE CONDITION
 19925*        NOTFND    (8582-COMP-NOT-FOUND)
 19926*        ENDFILE   (8582-COMP-NOT-FOUND)
 19927*    END-EXEC.
 19928*    MOVE '"$I''                  ! 6 #00018899' TO DFHEIV0
 19929     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19930     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19931     MOVE X'3620233030303138383939' TO DFHEIV0(25:11)
 19932     CALL 'kxdfhei1' USING DFHEIV0
 19933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19934
 19935
 19936
 19937* EXEC CICS READ
 19938*        DATASET     (COMP-ID)
 19939*        INTO        (COMPENSATION-MASTER)
 19940*        RIDFLD      (ERCOMP-KEY)
 19941*    END-EXEC.
 19942     MOVE LENGTH OF
 19943      COMPENSATION-MASTER
 19944       TO DFHEIV11
 19945*    MOVE '&"IL       E          (   #00018904' TO DFHEIV0
 19946     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19947     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19948     MOVE X'2020233030303138393034' TO DFHEIV0(25:11)
 19949     CALL 'kxdfhei1' USING DFHEIV0,
 19950           COMP-ID,
 19951           COMPENSATION-MASTER,
 19952           DFHEIV11,
 19953           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 369
* EL050.cbl
 19954           DFHEIV99,
 19955           DFHEIV99,
 19956           DFHEIV99
 19957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19958
 19959
 19960     MOVE 'Y'                    TO COMP-MASTER-SW
 19961
 19962     GO TO 8582-EXIT
 19963     .
 19964 8582-COMP-NOT-FOUND.
 19965
 19966     MOVE 'N'                    TO COMP-MASTER-SW.
 19967
 19968 8582-EXIT.
 19969     EXIT.
 19970
 19971 8583-READ-ERAGTC.
 19972
 19973* EXEC CICS HANDLE CONDITION
 19974*        NOTFND    (8583-AGTC-NOT-FOUND)
 19975*        ENDFILE   (8583-AGTC-NOT-FOUND)
 19976*    END-EXEC.
 19977*    MOVE '"$I''                  ! 7 #00018922' TO DFHEIV0
 19978     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19979     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19980     MOVE X'3720233030303138393232' TO DFHEIV0(25:11)
 19981     CALL 'kxdfhei1' USING DFHEIV0
 19982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19983
 19984
 19985
 19986* EXEC CICS STARTBR
 19987*        DATASET    (AGTC-ID)
 19988*        RIDFLD     (ERAGTC-KEY)
 19989*        GTEQ
 19990*    END-EXEC.
 19991     MOVE 0
 19992       TO DFHEIV11
 19993*    MOVE '&,         G          &   #00018927' TO DFHEIV0
 19994     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19995     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19996     MOVE X'2020233030303138393237' TO DFHEIV0(25:11)
 19997     CALL 'kxdfhei1' USING DFHEIV0,
 19998           AGTC-ID,
 19999           ERAGTC-KEY,
 20000           DFHEIV99,
 20001           DFHEIV11,
 20002           DFHEIV99
 20003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20004
 20005
 20006 8583-READ-ERAGTC-NEXT.
 20007
 20008* EXEC CICS READNEXT
 20009*        DATASET     (AGTC-ID)
 20010*        INTO        (AGENT-COMMISSIONS)
 20011*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 370
* EL050.cbl
 20012*    END-EXEC.
 20013     MOVE LENGTH OF
 20014      AGENT-COMMISSIONS
 20015       TO DFHEIV12
 20016     MOVE 0
 20017       TO DFHEIV11
 20018*    MOVE '&.IL                  )   #00018934' TO DFHEIV0
 20019     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20020     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20021     MOVE X'2020233030303138393334' TO DFHEIV0(25:11)
 20022     CALL 'kxdfhei1' USING DFHEIV0,
 20023           AGTC-ID,
 20024           AGENT-COMMISSIONS,
 20025           DFHEIV12,
 20026           ERAGTC-KEY,
 20027           DFHEIV99,
 20028           DFHEIV11,
 20029           DFHEIV99,
 20030           DFHEIV99
 20031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20032
 20033
 20034*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20035
 20036     GO TO 8583-EXIT
 20037     .
 20038 8583-AGTC-NOT-FOUND.
 20039
 20040     MOVE 'N'                    TO AGTC-MASTER-SW.
 20041
 20042 8583-EXIT.
 20043     EXIT.
 20044
 20045 8584-READ-BANK-CROSS-REF.
 20046
 20047* EXEC CICS HANDLE CONDITION
 20048*        NOTFND    (8584-BXRF-NOT-FOUND)
 20049*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20050*    END-EXEC.
 20051*    MOVE '"$I''                  ! 8 #00018952' TO DFHEIV0
 20052     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20053     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20054     MOVE X'3820233030303138393532' TO DFHEIV0(25:11)
 20055     CALL 'kxdfhei1' USING DFHEIV0
 20056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20057
 20058
 20059
 20060* EXEC CICS READ
 20061*        DATASET     (BXRF-ID)
 20062*        INTO        (BANK-CROSS-REFERENCE)
 20063*        RIDFLD      (ERBXRF-KEY)
 20064*        LENGTH      (BXRF-REC-LENGTH)
 20065*    END-EXEC.
 20066*    MOVE '&"IL       E          (   #00018957' TO DFHEIV0
 20067     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20068     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20069     MOVE X'2020233030303138393537' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 371
* EL050.cbl
 20070     CALL 'kxdfhei1' USING DFHEIV0,
 20071           BXRF-ID,
 20072           BANK-CROSS-REFERENCE,
 20073           BXRF-REC-LENGTH,
 20074           ERBXRF-KEY,
 20075           DFHEIV99,
 20076           DFHEIV99,
 20077           DFHEIV99
 20078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20079
 20080
 20081     MOVE 'Y'                    TO BXRF-MASTER-SW
 20082
 20083     GO TO 8584-EXIT
 20084     .
 20085 8584-BXRF-NOT-FOUND.
 20086
 20087     MOVE 'N'                    TO BXRF-MASTER-SW.
 20088
 20089 8584-EXIT.
 20090     EXIT.
 20091
 20092 8585-READ-PLAN-MASTER.
 20093
 20094
 20095* EXEC CICS HANDLE CONDITION
 20096*        NOTFND    (8585-PLAN-NOT-FOUND)
 20097*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20098*    END-EXEC.
 20099*    MOVE '"$I''                  ! 9 #00018977' TO DFHEIV0
 20100     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20101     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20102     MOVE X'3920233030303138393737' TO DFHEIV0(25:11)
 20103     CALL 'kxdfhei1' USING DFHEIV0
 20104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20105
 20106
 20107
 20108* EXEC CICS READ
 20109*        DATASET     (PLAN-ID)
 20110*        INTO        (PLAN-MASTER)
 20111*        RIDFLD      (ERPLAN-KEY)
 20112*    END-EXEC.
 20113     MOVE LENGTH OF
 20114      PLAN-MASTER
 20115       TO DFHEIV11
 20116*    MOVE '&"IL       E          (   #00018982' TO DFHEIV0
 20117     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20118     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20119     MOVE X'2020233030303138393832' TO DFHEIV0(25:11)
 20120     CALL 'kxdfhei1' USING DFHEIV0,
 20121           PLAN-ID,
 20122           PLAN-MASTER,
 20123           DFHEIV11,
 20124           ERPLAN-KEY,
 20125           DFHEIV99,
 20126           DFHEIV99,
 20127           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 372
* EL050.cbl
 20128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20129
 20130
 20131     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20132
 20133     GO TO 8585-EXIT.
 20134
 20135 8585-PLAN-NOT-FOUND.
 20136
 20137     MOVE 'N'                    TO PLAN-MASTER-SW.
 20138
 20139 8585-EXIT.
 20140     EXIT.
 20141
 20142 8586-READ-LOAN-OFFICER.
 20143
 20144* EXEC CICS READ
 20145*        DATASET     (LOFC-ID)
 20146*        INTO        (LOAN-OFFICER-MASTER)
 20147*        RIDFLD      (ERLOFC-KEY)
 20148*        RESP        (WS-RESPONSE)
 20149*    END-EXEC
 20150     MOVE LENGTH OF
 20151      LOAN-OFFICER-MASTER
 20152       TO DFHEIV11
 20153*    MOVE '&"IL       E          (  N#00019000' TO DFHEIV0
 20154     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20155     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20156     MOVE X'204E233030303139303030' TO DFHEIV0(25:11)
 20157     CALL 'kxdfhei1' USING DFHEIV0,
 20158           LOFC-ID,
 20159           LOAN-OFFICER-MASTER,
 20160           DFHEIV11,
 20161           ERLOFC-KEY,
 20162           DFHEIV99,
 20163           DFHEIV99,
 20164           DFHEIV99
 20165     MOVE EIBRESP  TO WS-RESPONSE
 20166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20167
 20168     IF WS-RESP-NORMAL
 20169        MOVE 'Y'                 TO LOFC-MASTER-SW
 20170     ELSE
 20171        MOVE 'N'                 TO LOFC-MASTER-SW
 20172     END-IF
 20173     .
 20174 8586-EXIT.
 20175     EXIT.
 20176 8587-START-ERPDEF.
 20177
 20178* EXEC CICS STARTBR
 20179*       DATASET   (PDEF-ID)
 20180*       RIDFLD    (ERPDEF-KEY)
 20181*       GTEQ
 20182*       RESP      (WS-RESPONSE)
 20183*    END-EXEC
 20184     MOVE 0
 20185       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 373
* EL050.cbl
 20186*    MOVE '&,         G          &  N#00019016' TO DFHEIV0
 20187     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20188     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20189     MOVE X'204E233030303139303136' TO DFHEIV0(25:11)
 20190     CALL 'kxdfhei1' USING DFHEIV0,
 20191           PDEF-ID,
 20192           ERPDEF-KEY,
 20193           DFHEIV99,
 20194           DFHEIV11,
 20195           DFHEIV99
 20196     MOVE EIBRESP  TO WS-RESPONSE
 20197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20198     IF WS-RESP-NORMAL
 20199        MOVE 'Y'                 TO PDEF-MASTER-SW
 20200     ELSE
 20201        MOVE 'N'                 TO PDEF-MASTER-SW
 20202     END-IF
 20203     .
 20204 8587-EXIT.
 20205     EXIT.
 20206 8588-READ-ERPDEF.
 20207
 20208* EXEC CICS READNEXT
 20209*       DATASET   (PDEF-ID)
 20210*       RIDFLD    (ERPDEF-KEY)
 20211*       INTO      (PRODUCT-MASTER)
 20212*       RESP      (WS-RESPONSE)
 20213*    END-EXEC
 20214     MOVE LENGTH OF
 20215      PRODUCT-MASTER
 20216       TO DFHEIV12
 20217     MOVE 0
 20218       TO DFHEIV11
 20219*    MOVE '&.IL                  )  N#00019031' TO DFHEIV0
 20220     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20221     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20222     MOVE X'204E233030303139303331' TO DFHEIV0(25:11)
 20223     CALL 'kxdfhei1' USING DFHEIV0,
 20224           PDEF-ID,
 20225           PRODUCT-MASTER,
 20226           DFHEIV12,
 20227           ERPDEF-KEY,
 20228           DFHEIV99,
 20229           DFHEIV11,
 20230           DFHEIV99,
 20231           DFHEIV99
 20232     MOVE EIBRESP  TO WS-RESPONSE
 20233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20234     IF WS-RESP-NORMAL
 20235        MOVE 'Y'                 TO PDEF-MASTER-SW
 20236     ELSE
 20237        MOVE 'N'                 TO PDEF-MASTER-SW
 20238     END-IF
 20239     .
 20240 8588-EXIT.
 20241     EXIT.
 20242 8589-ENDBR-ERPDEF.
 20243
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 374
* EL050.cbl
 20244* EXEC CICS ENDBR
 20245*       DATASET   (PDEF-ID)
 20246*    END-EXEC
 20247     MOVE 0
 20248       TO DFHEIV11
 20249*    MOVE '&2                    $   #00019046' TO DFHEIV0
 20250     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20251     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20252     MOVE X'2020233030303139303436' TO DFHEIV0(25:11)
 20253     CALL 'kxdfhei1' USING DFHEIV0,
 20254           PDEF-ID,
 20255           DFHEIV11,
 20256           DFHEIV99
 20257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20258     .
 20259 8589-EXIT.
 20260     EXIT.
 20261 8590-READ-CERT-MASTER.
 20262     IF PB-COMPANY-ID = 'UCL'
 20263         GO TO 8690-READ-CERT-MASTER-UCL.
 20264
 20265
 20266* EXEC CICS HANDLE CONDITION
 20267*         NOTFND    (0299-CERT-NOT-FOUND)
 20268*    END-EXEC.
 20269*    MOVE '"$I                   ! : #00019056' TO DFHEIV0
 20270     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20271     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20272     MOVE X'3A20233030303139303536' TO DFHEIV0(25:11)
 20273     CALL 'kxdfhei1' USING DFHEIV0
 20274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20275
 20276
 20277
 20278* EXEC CICS READ
 20279*        DATASET     (CERT-ID)
 20280*        INTO        (CERTIFICATE-MASTER)
 20281*        RIDFLD      (ELCERT-KEY)
 20282*        UPDATE
 20283*    END-EXEC.
 20284     MOVE LENGTH OF
 20285      CERTIFICATE-MASTER
 20286       TO DFHEIV11
 20287*    MOVE '&"IL       EU         (   #00019060' TO DFHEIV0
 20288     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20289     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20290     MOVE X'2020233030303139303630' TO DFHEIV0(25:11)
 20291     CALL 'kxdfhei1' USING DFHEIV0,
 20292           CERT-ID,
 20293           CERTIFICATE-MASTER,
 20294           DFHEIV11,
 20295           ELCERT-KEY,
 20296           DFHEIV99,
 20297           DFHEIV99,
 20298           DFHEIV99
 20299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20300
 20301
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 375
* EL050.cbl
 20302 8590-EXIT.
 20303     EXIT.
 20304
 20305 8690-READ-CERT-MASTER-UCL.
 20306
 20307* EXEC CICS HANDLE CONDITION
 20308*         NOTFND    (8700-READ-CERT-MASTER)
 20309*    END-EXEC.
 20310*    MOVE '"$I                   ! ; #00019071' TO DFHEIV0
 20311     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20312     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20313     MOVE X'3B20233030303139303731' TO DFHEIV0(25:11)
 20314     CALL 'kxdfhei1' USING DFHEIV0
 20315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20316
 20317
 20318 8690-READ-CERT-CONT.
 20319
 20320* EXEC CICS READ
 20321*        DATASET     (CERT-ID)
 20322*        INTO        (CERTIFICATE-MASTER)
 20323*        RIDFLD      (ELCERT-KEY)
 20324*        UPDATE
 20325*    END-EXEC.
 20326     MOVE LENGTH OF
 20327      CERTIFICATE-MASTER
 20328       TO DFHEIV11
 20329*    MOVE '&"IL       EU         (   #00019076' TO DFHEIV0
 20330     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20331     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20332     MOVE X'2020233030303139303736' TO DFHEIV0(25:11)
 20333     CALL 'kxdfhei1' USING DFHEIV0,
 20334           CERT-ID,
 20335           CERTIFICATE-MASTER,
 20336           DFHEIV11,
 20337           ELCERT-KEY,
 20338           DFHEIV99,
 20339           DFHEIV99,
 20340           DFHEIV99
 20341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20342
 20343
 20344     GO TO 8590-EXIT.
 20345
 20346 8700-READ-CERT-MASTER.
 20347     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20348     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20349
 20350* EXEC CICS HANDLE CONDITION
 20351*         DUPKEY    (8720-COMP-ACCOUNTS)
 20352*         ENDFILE   (8730-END-BROWSE)
 20353*         NOTFND    (8740-NOT-FOUND)
 20354*    END-EXEC.
 20355*    MOVE '"$$''I                 ! < #00019088' TO DFHEIV0
 20356     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20357     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20358     MOVE X'3C20233030303139303838' TO DFHEIV0(25:11)
 20359     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 376
* EL050.cbl
 20360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20361
 20362
 20363
 20364* EXEC CICS STARTBR
 20365*        DATASET     ('ELCERT5')
 20366*        RIDFLD      (ELCERT2-KEY)
 20367*        EQUAL
 20368*    END-EXEC.
 20369     MOVE 'ELCERT5' TO DFHEIV1
 20370     MOVE 0
 20371       TO DFHEIV11
 20372*    MOVE '&,         E          &   #00019094' TO DFHEIV0
 20373     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20374     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20375     MOVE X'2020233030303139303934' TO DFHEIV0(25:11)
 20376     CALL 'kxdfhei1' USING DFHEIV0,
 20377           DFHEIV1,
 20378           ELCERT2-KEY,
 20379           DFHEIV99,
 20380           DFHEIV11,
 20381           DFHEIV99
 20382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20383
 20384
 20385 8710-READ-NEXT.
 20386
 20387* EXEC CICS READNEXT
 20388*        DATASET     ('ELCERT5')
 20389*        INTO        (CERTIFICATE-MASTER)
 20390*        RIDFLD      (ELCERT2-KEY)
 20391*    END-EXEC.
 20392     MOVE LENGTH OF
 20393      CERTIFICATE-MASTER
 20394       TO DFHEIV12
 20395     MOVE 'ELCERT5' TO DFHEIV1
 20396     MOVE 0
 20397       TO DFHEIV11
 20398*    MOVE '&.IL                  )   #00019101' TO DFHEIV0
 20399     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20400     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20401     MOVE X'2020233030303139313031' TO DFHEIV0(25:11)
 20402     CALL 'kxdfhei1' USING DFHEIV0,
 20403           DFHEIV1,
 20404           CERTIFICATE-MASTER,
 20405           DFHEIV12,
 20406           ELCERT2-KEY,
 20407           DFHEIV99,
 20408           DFHEIV11,
 20409           DFHEIV99,
 20410           DFHEIV99
 20411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20412
 20413
 20414 8720-COMP-ACCOUNTS.
 20415
 20416* EXEC CICS ENTER
 20417*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 377
* EL050.cbl
 20418*         FROM (PB-C-LAST-NAME)
 20419*    END-EXEC.
 20420     MOVE 001
 20421       TO DFHEIV11
 20422*    MOVE ':$F                   %   #00019108' TO DFHEIV0
 20423     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20424     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20425     MOVE X'2020233030303139313038' TO DFHEIV0(25:11)
 20426     CALL 'kxdfhei1' USING DFHEIV0,
 20427           DFHEIV11,
 20428           PB-C-LAST-NAME,
 20429           DFHEIV99,
 20430           DFHEIV99
 20431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20432
 20433
 20434
 20435* EXEC CICS ENTER
 20436*         TRACEID (002)
 20437*         FROM (CM-INSURED-LAST-NAME)
 20438*    END-EXEC.
 20439     MOVE 002
 20440       TO DFHEIV11
 20441*    MOVE ':$F                   %   #00019113' TO DFHEIV0
 20442     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20443     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20444     MOVE X'2020233030303139313133' TO DFHEIV0(25:11)
 20445     CALL 'kxdfhei1' USING DFHEIV0,
 20446           DFHEIV11,
 20447           CM-INSURED-LAST-NAME,
 20448           DFHEIV99,
 20449           DFHEIV99
 20450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20451
 20452
 20453     IF PB-CERT-NO NOT = CM-CERT-NO
 20454         GO TO 8730-END-BROWSE.
 20455
 20456     IF PB-ACCOUNT = CM-ACCOUNT
 20457         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20458             MOVE ER-2799        TO WS-ERROR
 20459             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20460             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20461             GO TO 8730-END-BROWSE.
 20462
 20463     GO TO 8710-READ-NEXT.
 20464
 20465 8730-END-BROWSE.
 20466
 20467* EXEC CICS ENDBR
 20468*         DATASET    ('ELCERT5')
 20469*    END-EXEC.
 20470     MOVE 'ELCERT5' TO DFHEIV1
 20471     MOVE 0
 20472       TO DFHEIV11
 20473*    MOVE '&2                    $   #00019131' TO DFHEIV0
 20474     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20475     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 378
* EL050.cbl
 20476     MOVE X'2020233030303139313331' TO DFHEIV0(25:11)
 20477     CALL 'kxdfhei1' USING DFHEIV0,
 20478           DFHEIV1,
 20479           DFHEIV11,
 20480           DFHEIV99
 20481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20482
 20483
 20484 8740-NOT-FOUND.
 20485     GO TO 0299-CERT-NOT-FOUND.
 20486
 20487 8750-START-ELSTAT.
 20488
 20489* EXEC CICS STARTBR
 20490*       DATASET   (STAT-ID)
 20491*       RIDFLD    (ELSTAT-KEY)
 20492*       GTEQ
 20493*       RESP      (WS-RESPONSE)
 20494*    END-EXEC
 20495     MOVE 0
 20496       TO DFHEIV11
 20497*    MOVE '&,         G          &  N#00019139' TO DFHEIV0
 20498     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20499     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20500     MOVE X'204E233030303139313339' TO DFHEIV0(25:11)
 20501     CALL 'kxdfhei1' USING DFHEIV0,
 20502           STAT-ID,
 20503           ELSTAT-KEY,
 20504           DFHEIV99,
 20505           DFHEIV11,
 20506           DFHEIV99
 20507     MOVE EIBRESP  TO WS-RESPONSE
 20508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20509     IF WS-RESP-NORMAL
 20510        MOVE 'Y'                 TO STAT-MASTER-SW
 20511     ELSE
 20512        MOVE 'N'                 TO STAT-MASTER-SW
 20513     END-IF
 20514     .
 20515 8750-EXIT.
 20516     EXIT.
 20517 8752-READ-ELSTAT.
 20518
 20519* EXEC CICS READNEXT
 20520*       DATASET   (STAT-ID)
 20521*       RIDFLD    (ELSTAT-KEY)
 20522*       INTO      (STATE-FILE)
 20523*       RESP      (WS-RESPONSE)
 20524*    END-EXEC
 20525     MOVE LENGTH OF
 20526      STATE-FILE
 20527       TO DFHEIV12
 20528     MOVE 0
 20529       TO DFHEIV11
 20530*    MOVE '&.IL                  )  N#00019154' TO DFHEIV0
 20531     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20532     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20533     MOVE X'204E233030303139313534' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 379
* EL050.cbl
 20534     CALL 'kxdfhei1' USING DFHEIV0,
 20535           STAT-ID,
 20536           STATE-FILE,
 20537           DFHEIV12,
 20538           ELSTAT-KEY,
 20539           DFHEIV99,
 20540           DFHEIV11,
 20541           DFHEIV99,
 20542           DFHEIV99
 20543     MOVE EIBRESP  TO WS-RESPONSE
 20544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20545     IF WS-RESP-NORMAL
 20546        MOVE 'Y'                 TO STAT-MASTER-SW
 20547     ELSE
 20548        MOVE 'N'                 TO STAT-MASTER-SW
 20549     END-IF
 20550     .
 20551 8752-EXIT.
 20552     EXIT.
 20553 8800-GET-COMP-RATE.
 20554     MOVE +1 TO IB.
 20555     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20556         ADD +9 TO IB
 20557         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20558             ADD +9 TO IB
 20559             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20560                MOVE ZEROS       TO WS-WK-RATE
 20561                GO TO 8800-EXIT.
 20562
 20563     IF PB-I-AGE GREATER CT-AGE (1)
 20564         ADD +3 TO IB
 20565         IF PB-I-AGE GREATER CT-AGE (2)
 20566             ADD +3 TO IB
 20567             IF PB-I-AGE GREATER CT-AGE (3)
 20568                MOVE ZEROS       TO WS-WK-RATE
 20569                GO TO 8800-EXIT.
 20570
 20571     IF WS-WORK-TERM GREATER CT-TRM (1)
 20572         ADD +1 TO IB
 20573         IF WS-WORK-TERM GREATER CT-TRM (2)
 20574             ADD +1 TO IB
 20575             IF WS-WORK-TERM GREATER CT-TRM (3)
 20576                MOVE ZEROS       TO WS-WK-RATE
 20577                GO TO 8800-EXIT.
 20578
 20579     IF CT-RT (IB) NOT NUMERIC
 20580         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20581         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20582         GO TO 8800-GET-COMP-RATE.
 20583
 20584     MOVE CT-RT (IB) TO WS-WK-RATE.
 20585
 20586 8800-EXIT.
 20587     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 380
* EL050.cbl
 20589 8900-ADDRESS-FILE.
 20590     IF ERACCT-FILE-ADDRESSED
 20591         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20592         GO TO 8900-ADDRESS-EXIT.
 20593
 20594     IF ELCNTL-FILE-ADDRESSED
 20595         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20596         GO TO 8900-ADDRESS-EXIT.
 20597
 20598     IF ERPLAN-FILE-ADDRESSED
 20599         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20600         GO TO 8900-ADDRESS-EXIT.
 20601
 20602     IF ERFORM-FILE-ADDRESSED
 20603         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20604         GO TO 8900-ADDRESS-EXIT.
 20605
 20606 8900-ADDRESS-EXIT.
 20607     EXIT.
 20608
 20609 9000-READ-CONTROL.
 20610
 20611* EXEC CICS HANDLE CONDITION
 20612*        NOTFND    (9000-NOTFND)
 20613*    END-EXEC.
 20614*    MOVE '"$I                   ! = #00019225' TO DFHEIV0
 20615     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20616     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20617     MOVE X'3D20233030303139323235' TO DFHEIV0(25:11)
 20618     CALL 'kxdfhei1' USING DFHEIV0
 20619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20620
 20621
 20622
 20623* EXEC CICS READ
 20624*        DATASET     (CNTL-ID)
 20625*        SET         (ADDRESS OF CONTROL-FILE)
 20626*        RIDFLD      (ELCNTL-KEY)
 20627*        GTEQ
 20628*    END-EXEC.
 20629*    MOVE '&"S        G          (   #00019229' TO DFHEIV0
 20630     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20631     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20632     MOVE X'2020233030303139323239' TO DFHEIV0(25:11)
 20633     CALL 'kxdfhei1' USING DFHEIV0,
 20634           CNTL-ID,
 20635           DFHEIV20,
 20636           DFHEIV99,
 20637           ELCNTL-KEY,
 20638           DFHEIV99,
 20639           DFHEIV99,
 20640           DFHEIV99
 20641     SET ADDRESS OF CONTROL-FILE TO
 20642         DFHEIV20
 20643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20644
 20645
 20646     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 381
* EL050.cbl
 20647
 20648 9000-NOTFND.
 20649     IF RC-SW-1 = '1'
 20650        MOVE ER-2616              TO WS-ERROR
 20651        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20652        GO TO 9000-EXIT.
 20653
 20654     IF RC-SW-1 = '2'
 20655        MOVE ER-2602              TO WS-ERROR
 20656        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20657
 20658 9000-EXIT.
 20659      EXIT.
 20660
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 382
* EL050.cbl
 20662 9100-READ-CONTROL.
 20663
 20664* EXEC CICS HANDLE CONDITION
 20665*        NOTFND  (9100-NOTFND)
 20666*        ENDFILE (9100-NOTFND)
 20667*    END-EXEC.
 20668*    MOVE '"$I''                  ! > #00019253' TO DFHEIV0
 20669     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20670     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20671     MOVE X'3E20233030303139323533' TO DFHEIV0(25:11)
 20672     CALL 'kxdfhei1' USING DFHEIV0
 20673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20674
 20675
 20676
 20677* EXEC CICS READ
 20678*        DATASET     (CNTL-ID)
 20679*        INTO        (CONTROL-FILE)
 20680*        RIDFLD      (ELCNTL-KEY)
 20681*        GTEQ
 20682*    END-EXEC.
 20683     MOVE LENGTH OF
 20684      CONTROL-FILE
 20685       TO DFHEIV11
 20686*    MOVE '&"IL       G          (   #00019258' TO DFHEIV0
 20687     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20688     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20689     MOVE X'2020233030303139323538' TO DFHEIV0(25:11)
 20690     CALL 'kxdfhei1' USING DFHEIV0,
 20691           CNTL-ID,
 20692           CONTROL-FILE,
 20693           DFHEIV11,
 20694           ELCNTL-KEY,
 20695           DFHEIV99,
 20696           DFHEIV99,
 20697           DFHEIV99
 20698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20699
 20700
 20701     GO TO 9100-EXIT.
 20702
 20703 9100-NOTFND.
 20704     IF RC-SW-2 = '0'
 20705        MOVE '1'                  TO STATE-RECORD-ERROR
 20706        GO TO 9100-EXIT
 20707     END-IF
 20708     IF RC-SW-2 = '1'
 20709        MOVE '1'                  TO LF-BENEFIT-ERROR
 20710        MOVE ER-2604              TO WS-ERROR
 20711        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20712        GO TO 9100-EXIT.
 20713
 20714     IF RC-SW-2 = '2'
 20715        MOVE '1'                  TO AH-BENEFIT-ERROR
 20716        MOVE ER-2605              TO WS-ERROR
 20717        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20718        GO TO 9100-EXIT.
 20719
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 383
* EL050.cbl
 20720     IF RC-SW-2 = '3'
 20721         MOVE ER-2603           TO WS-ERROR
 20722         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20723         GO TO 9100-EXIT.
 20724
 20725     IF RC-SW-2 = '4'
 20726         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 20727         GO TO 9100-EXIT.
 20728
 20729     IF RC-SW-2 = '5'
 20730         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 20731         IF WS-AH-INPUT-CD-1 = SPACE
 20732             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 20733         ELSE
 20734             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 20735
 20736 9100-EXIT.
 20737      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 384
* EL050.cbl
 20739 9200-CONTROL-GETMAIN.
 20740
 20741* EXEC CICS GETMAIN
 20742*         LENGTH   (750)
 20743*         SET      (ADDRESS OF CONTROL-FILE)
 20744*    END-EXEC.
 20745     MOVE 750
 20746       TO DFHEIV11
 20747*    MOVE '," L                  $   #00019304' TO DFHEIV0
 20748     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20749     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20750     MOVE X'2020233030303139333034' TO DFHEIV0(25:11)
 20751     CALL 'kxdfhei1' USING DFHEIV0,
 20752           DFHEIV20,
 20753           DFHEIV11,
 20754           DFHEIV99
 20755     SET ADDRESS OF CONTROL-FILE TO
 20756         DFHEIV20
 20757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20758
 20759
 20760     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 20761
 20762 9200-EXIT.
 20763     EXIT.
 20764
 20765 9250-UNLOCK-RETURN.
 20766
 20767* EXEC CICS UNLOCK
 20768*        DATASET   (CERT-ID)
 20769*    END-EXEC.
 20770*    MOVE '&*                    #   #00019315' TO DFHEIV0
 20771     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20772     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20773     MOVE X'2020233030303139333135' TO DFHEIV0(25:11)
 20774     CALL 'kxdfhei1' USING DFHEIV0,
 20775           CERT-ID,
 20776           DFHEIV99
 20777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20778
 20779
 20780 9300-ABEND.
 20781     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 20782
 20783
 20784* EXEC CICS LINK
 20785*        PROGRAM   ('EL004')
 20786*        COMMAREA  (WS-ERROR-LINE)
 20787*        LENGTH    (72)
 20788*    END-EXEC.
 20789     MOVE 'EL004' TO DFHEIV1
 20790     MOVE 72
 20791       TO DFHEIV11
 20792*    MOVE '."C                   (   #00019322' TO DFHEIV0
 20793     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20794     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20795     MOVE X'2020233030303139333232' TO DFHEIV0(25:11)
 20796     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 385
* EL050.cbl
 20797           DFHEIV1,
 20798           WS-ERROR-LINE,
 20799           DFHEIV11,
 20800           DFHEIV99,
 20801           DFHEIV99,
 20802           DFHEIV99,
 20803           DFHEIV99
 20804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20805
 20806
 20807     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 20808
 20809
 20810* EXEC CICS ABEND
 20811*        ABCODE ('EL50')
 20812*    END-EXEC.
 20813     MOVE 'EL50' TO DFHEIV5
 20814*    MOVE '.,A                   "   #00019330' TO DFHEIV0
 20815     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 20816     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 20817     MOVE X'2020233030303139333330' TO DFHEIV0(25:11)
 20818     CALL 'kxdfhei1' USING DFHEIV0,
 20819           DFHEIV5
 20820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20821
 20822
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 386
* EL050.cbl
 20824
 20825******************************************************************
 20826*                                                                *
 20827*            E R R O R   F O R M A T   R O U T I N E             *
 20828*                                                                *
 20829******************************************************************
 20830
 20831 9900-ERROR-FORMAT.
 20832
 20833     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 20834                    PB-COMMON-ERROR (2) OR
 20835                    PB-COMMON-ERROR (3) OR
 20836                    PB-COMMON-ERROR (4) OR
 20837                    PB-COMMON-ERROR (5) OR
 20838                    PB-COMMON-ERROR (6) OR
 20839                    PB-COMMON-ERROR (7) OR
 20840                    PB-COMMON-ERROR (8) OR
 20841                    PB-COMMON-ERROR (9) OR
 20842                    PB-COMMON-ERROR (10)
 20843        GO TO 9900-EXIT.
 20844
 20845     IF PB-NO-OF-ERRORS = +10
 20846        GO TO 9900-EXIT.
 20847
 20848     ADD +1  TO PB-NO-OF-ERRORS.
 20849     MOVE WS-ERROR               TO PB-COMMON-ERROR
 20850                                       (PB-NO-OF-ERRORS).
 20851 9900-EXIT.
 20852     EXIT.
 20853
 20854 9990-RETURN.
 20855     IF BROWSE-STARTED
 20856
 20857* EXEC CICS ENDBR
 20858*            DATASET  (ACCT-ID)
 20859*       END-EXEC.
 20860     MOVE 0
 20861       TO DFHEIV11
 20862*    MOVE '&2                    $   #00019367' TO DFHEIV0
 20863     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20864     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20865     MOVE X'2020233030303139333637' TO DFHEIV0(25:11)
 20866     CALL 'kxdfhei1' USING DFHEIV0,
 20867           ACCT-ID,
 20868           DFHEIV11,
 20869           DFHEIV99
 20870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20871
 20872
 20873 9990-EXIT.
 20874     EXIT.
 20875
 20876
 20877****Check for CRTO record, add one if not found.
 20878 9991-CHECK-FOR-ELCRTO.
 20879
 20880* EXEC CICS HANDLE CONDITION
 20881*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 387
* EL050.cbl
 20882*         ENDFILE (9991-CRTO-NOT-FOUND)
 20883*     END-EXEC.
 20884*    MOVE '"$I''                  ! ? #00019377' TO DFHEIV0
 20885     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20886     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20887     MOVE X'3F20233030303139333737' TO DFHEIV0(25:11)
 20888     CALL 'kxdfhei1' USING DFHEIV0
 20889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20890
 20891     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 20892     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 20893     MOVE +0                     TO ELCRTO-SEQ-NO
 20894
 20895
 20896* EXEC CICS READ
 20897*       DATASET   ('ELCRTO')
 20898*       INTO      (ORIGINAL-CERTIFICATE)
 20899*       RIDFLD    (ELCRTO-KEY)
 20900*       GTEQ
 20901*       RESP      (WS-RESPONSE)
 20902*    END-EXEC
 20903     MOVE LENGTH OF
 20904      ORIGINAL-CERTIFICATE
 20905       TO DFHEIV11
 20906     MOVE 'ELCRTO' TO DFHEIV1
 20907*    MOVE '&"IL       G          (  N#00019385' TO DFHEIV0
 20908     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20909     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20910     MOVE X'204E233030303139333835' TO DFHEIV0(25:11)
 20911     CALL 'kxdfhei1' USING DFHEIV0,
 20912           DFHEIV1,
 20913           ORIGINAL-CERTIFICATE,
 20914           DFHEIV11,
 20915           ELCRTO-KEY,
 20916           DFHEIV99,
 20917           DFHEIV99,
 20918           DFHEIV99
 20919     MOVE EIBRESP  TO WS-RESPONSE
 20920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20921
 20922     IF WS-RESP-NORMAL
 20923        AND (OC-CONTROL-PRIMARY (1:33) =
 20924                 PB-CONTROL-BY-ACCOUNT (1:33))
 20925        AND (OC-RECORD-TYPE =  'I')
 20926           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 20927               GO TO 9991-EXIT
 20928           ELSE
 20929               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 20930               GO TO 9991-CRTO-ADD-REC
 20931           END-IF
 20932     END-IF.
 20933
 20934 9991-CRTO-NOT-FOUND.
 20935
 20936     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 20937     MOVE 'OC'                TO OC-RECORD-ID
 20938     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 20939                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 388
* EL050.cbl
 20940     MOVE +4096               TO OC-KEY-SEQ-NO.
 20941
 20942 9991-CRTO-ADD-REC.
 20943
 20944     MOVE 'E050'              TO OC-LAST-MAINT-BY
 20945     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 20946     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 20947     MOVE 'I'                 TO OC-RECORD-TYPE
 20948     IF PB-ISSUE
 20949         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 20950         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 20951         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 20952         MOVE PB-I-AGE               TO OC-INS-AGE
 20953         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 20954         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 20955         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 20956         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 20957         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 20958         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 20959         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 20960         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 20961         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 20962         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 20963         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 20964         IF PB-I-JOINT-COMMISSION > +0
 20965             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 20966         ELSE
 20967             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 20968         END-IF
 20969         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 20970         MOVE +0                     TO OC-LF-CANCEL-AMT
 20971                                        OC-LF-ITD-CANCEL-AMT
 20972         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 20973         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 20974         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 20975         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 20976         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 20977         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 20978         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 20979         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 20980         MOVE +0                     TO OC-AH-CANCEL-AMT
 20981                                        OC-AH-ITD-CANCEL-AMT
 20982         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 20983     ELSE
 20984         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 20985         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 20986         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 20987         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 20988         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 20989         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 20990         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 20991         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 20992         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 20993          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 20994             MOVE SPACES             TO OC-LF-BENCD
 20995             MOVE ZEROS              TO OC-LF-TERM
 20996                                        OC-LF-BEN-AMT
 20997                                        OC-LF-PRM-AMT
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 389
* EL050.cbl
 20998                                        OC-LF-ALT-BEN-AMT
 20999                                        OC-LF-ALT-PRM-AMT
 21000                                        OC-LF-COMM-PCT
 21001                                        OC-LF-CANCEL-AMT
 21002             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21003             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21004         ELSE
 21005             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21006             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21007             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21008             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21009             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21010             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21011             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21012             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21013             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21014             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21015         END-IF
 21016         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21017         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21018          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21019             MOVE SPACES             TO OC-AH-BENCD
 21020             MOVE ZEROS              TO OC-AH-TERM
 21021                                        OC-AH-BEN-AMT
 21022                                        OC-AH-PRM-AMT
 21023                                        OC-AH-COMM-PCT
 21024                                        OC-AH-CANCEL-AMT
 21025                                        OC-AH-CP
 21026             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21027             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21028         ELSE
 21029             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21030             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21031             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21032             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21033             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21034             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21035             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21036             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21037             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21038         END-IF
 21039         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21040         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21041     END-IF
 21042     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21043
 21044     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21045
 21046
 21047* EXEC CICS READ
 21048*         DATASET   (FILE-ERMAIL)
 21049*         RIDFLD    (MA-CONTROL-PRIMARY)
 21050*         INTO      (MAILING-DATA)
 21051*         RESP      (WS-RESPONSE)
 21052*    END-EXEC
 21053     MOVE LENGTH OF
 21054      MAILING-DATA
 21055       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 390
* EL050.cbl
 21056*    MOVE '&"IL       E          (  N#00019517' TO DFHEIV0
 21057     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21058     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21059     MOVE X'204E233030303139353137' TO DFHEIV0(25:11)
 21060     CALL 'kxdfhei1' USING DFHEIV0,
 21061           FILE-ERMAIL,
 21062           MAILING-DATA,
 21063           DFHEIV11,
 21064           MA-CONTROL-PRIMARY,
 21065           DFHEIV99,
 21066           DFHEIV99,
 21067           DFHEIV99
 21068     MOVE EIBRESP  TO WS-RESPONSE
 21069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21070
 21071     IF WS-RESP-NORMAL
 21072         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21073     END-IF.
 21074
 21075
 21076* EXEC CICS WRITE
 21077*       DATASET   ('ELCRTO')
 21078*       FROM      (ORIGINAL-CERTIFICATE)
 21079*       RIDFLD    (OC-CONTROL-PRIMARY)
 21080*       RESP      (WS-RESPONSE)
 21081*    END-EXEC.
 21082     MOVE LENGTH OF
 21083      ORIGINAL-CERTIFICATE
 21084       TO DFHEIV11
 21085     MOVE 'ELCRTO' TO DFHEIV1
 21086*    MOVE '&$ L                  ''  N#00019528' TO DFHEIV0
 21087     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21088     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21089     MOVE X'204E233030303139353238' TO DFHEIV0(25:11)
 21090     CALL 'kxdfhei1' USING DFHEIV0,
 21091           DFHEIV1,
 21092           ORIGINAL-CERTIFICATE,
 21093           DFHEIV11,
 21094           OC-CONTROL-PRIMARY,
 21095           DFHEIV99,
 21096           DFHEIV99
 21097     MOVE EIBRESP  TO WS-RESPONSE
 21098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21099
 21100
 21101 9991-EXIT.
 21102     EXIT.
 21103
 21104
 21105 9999-RETURN.
 21106     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21107
 21108
 21109* EXEC CICS RETURN
 21110*    END-EXEC.
 21111*    MOVE '.(                    ''   #00019542' TO DFHEIV0
 21112     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21113     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 391
* EL050.cbl
 21114     MOVE X'2020233030303139353432' TO DFHEIV0(25:11)
 21115     CALL 'kxdfhei1' USING DFHEIV0,
 21116           DFHEIV99,
 21117           DFHEIV99,
 21118           DFHEIV99,
 21119           DFHEIV99,
 21120           DFHEIV99,
 21121           DFHEIV99
 21122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21123
 21124
 21125
 21126* GOBACK.
 21127     MOVE '9%                    "   ' TO DFHEIV0
 21128     MOVE 'EL050' TO DFHEIV1
 21129     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21130     GOBACK.
 21131
 21132 9999-DFHBACK SECTION.
 21133     MOVE '9%                    "   ' TO DFHEIV0
 21134     MOVE 'EL050' TO DFHEIV1
 21135     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21136     GOBACK.
 21137 9999-DFHEXIT.
 21138     IF DFHEIGDJ EQUAL 0001
 21139         NEXT SENTENCE
 21140     ELSE IF DFHEIGDJ EQUAL 2
 21141         GO TO 9300-ABEND,
 21142               3990-FILES-NOT-OPEN
 21143         DEPENDING ON DFHEIGDI
 21144     ELSE IF DFHEIGDJ EQUAL 3
 21145         GO TO 6610-START-BROWSE,
 21146               6630-ERRESS-PROBLEM,
 21147               6630-END-OF-FILE
 21148         DEPENDING ON DFHEIGDI
 21149     ELSE IF DFHEIGDJ EQUAL 4
 21150         GO TO 6630-END-OF-FILE,
 21151               6630-ERRESS-PROBLEM,
 21152               6630-ERRESS-PROBLEM,
 21153               6630-END-OF-FILE
 21154         DEPENDING ON DFHEIGDI
 21155     ELSE IF DFHEIGDJ EQUAL 5
 21156         GO TO 6630-END-OF-FILE,
 21157               6630-END-OF-FILE,
 21158               6630-ERRESS-PROBLEM,
 21159               6630-ERRESS-PROBLEM
 21160         DEPENDING ON DFHEIGDI
 21161     ELSE IF DFHEIGDJ EQUAL 6
 21162         GO TO 6660-START-BROWSE,
 21163               6690-ERRESC-PROBLEM,
 21164               6690-ERRESC-PROBLEM,
 21165               6690-END-OF-FILE
 21166         DEPENDING ON DFHEIGDI
 21167     ELSE IF DFHEIGDJ EQUAL 7
 21168         GO TO 6690-END-OF-FILE,
 21169               6690-ERRESC-PROBLEM,
 21170               6690-ERRESC-PROBLEM,
 21171               6690-END-OF-FILE
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 392
* EL050.cbl
 21172         DEPENDING ON DFHEIGDI
 21173     ELSE IF DFHEIGDJ EQUAL 8
 21174         GO TO 6690-END-OF-FILE,
 21175               6690-ERRESC-PROBLEM,
 21176               6690-ERRESC-PROBLEM,
 21177               6690-END-OF-FILE
 21178         DEPENDING ON DFHEIGDI
 21179     ELSE IF DFHEIGDJ EQUAL 9
 21180         GO TO 7250-CONTINUE,
 21181               7250-CONTINUE
 21182         DEPENDING ON DFHEIGDI
 21183     ELSE IF DFHEIGDJ EQUAL 10
 21184         GO TO 7300-CONTINUE,
 21185               7300-CONTINUE
 21186         DEPENDING ON DFHEIGDI
 21187     ELSE IF DFHEIGDJ EQUAL 11
 21188         GO TO 8000-FREE-MAIN
 21189         DEPENDING ON DFHEIGDI
 21190     ELSE IF DFHEIGDJ EQUAL 12
 21191         GO TO 8100-NOTFND,
 21192               8100-NOTFND
 21193         DEPENDING ON DFHEIGDI
 21194     ELSE IF DFHEIGDJ EQUAL 13
 21195         GO TO 8110-NOTFND,
 21196               8110-NOTFND
 21197         DEPENDING ON DFHEIGDI
 21198     ELSE IF DFHEIGDJ EQUAL 14
 21199         GO TO 8130-EXIT
 21200         DEPENDING ON DFHEIGDI
 21201     ELSE IF DFHEIGDJ EQUAL 15
 21202         GO TO 8180-NOTFND
 21203         DEPENDING ON DFHEIGDI
 21204     ELSE IF DFHEIGDJ EQUAL 16
 21205         GO TO 8190-NOTFND
 21206         DEPENDING ON DFHEIGDI
 21207     ELSE IF DFHEIGDJ EQUAL 17
 21208         GO TO 8200-NOTFND
 21209         DEPENDING ON DFHEIGDI
 21210     ELSE IF DFHEIGDJ EQUAL 18
 21211         GO TO 8300-NOTFND,
 21212               8300-ERRESS-PROBLEM,
 21213               8300-ERRESS-PROBLEM,
 21214               8300-NOTFND
 21215         DEPENDING ON DFHEIGDI
 21216     ELSE IF DFHEIGDJ EQUAL 19
 21217         GO TO 8450-FORM-NOT-FOUND,
 21218               8450-FORM-NOT-FOUND
 21219         DEPENDING ON DFHEIGDI
 21220     ELSE IF DFHEIGDJ EQUAL 20
 21221         GO TO 0199-ACCT-NOT-FOUND,
 21222               0199-ACCT-NOT-FOUND
 21223         DEPENDING ON DFHEIGDI
 21224     ELSE IF DFHEIGDJ EQUAL 21
 21225         GO TO 0199-ACCT-NOT-FOUND,
 21226               0199-ACCT-NOT-FOUND
 21227         DEPENDING ON DFHEIGDI
 21228     ELSE IF DFHEIGDJ EQUAL 22
 21229         GO TO 8582-COMP-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 12-Nov-12 15:47 Page 393
* EL050.cbl
 21230               8582-COMP-NOT-FOUND
 21231         DEPENDING ON DFHEIGDI
 21232     ELSE IF DFHEIGDJ EQUAL 23
 21233         GO TO 8583-AGTC-NOT-FOUND,
 21234               8583-AGTC-NOT-FOUND
 21235         DEPENDING ON DFHEIGDI
 21236     ELSE IF DFHEIGDJ EQUAL 24
 21237         GO TO 8584-BXRF-NOT-FOUND,
 21238               8584-BXRF-NOT-FOUND
 21239         DEPENDING ON DFHEIGDI
 21240     ELSE IF DFHEIGDJ EQUAL 25
 21241         GO TO 8585-PLAN-NOT-FOUND,
 21242               8585-PLAN-NOT-FOUND
 21243         DEPENDING ON DFHEIGDI
 21244     ELSE IF DFHEIGDJ EQUAL 26
 21245         GO TO 0299-CERT-NOT-FOUND
 21246         DEPENDING ON DFHEIGDI
 21247     ELSE IF DFHEIGDJ EQUAL 27
 21248         GO TO 8700-READ-CERT-MASTER
 21249         DEPENDING ON DFHEIGDI
 21250     ELSE IF DFHEIGDJ EQUAL 28
 21251         GO TO 8720-COMP-ACCOUNTS,
 21252               8730-END-BROWSE,
 21253               8740-NOT-FOUND
 21254         DEPENDING ON DFHEIGDI
 21255     ELSE IF DFHEIGDJ EQUAL 29
 21256         GO TO 9000-NOTFND
 21257         DEPENDING ON DFHEIGDI
 21258     ELSE IF DFHEIGDJ EQUAL 30
 21259         GO TO 9100-NOTFND,
 21260               9100-NOTFND
 21261         DEPENDING ON DFHEIGDI
 21262     ELSE IF DFHEIGDJ EQUAL 31
 21263         GO TO 9991-CRTO-NOT-FOUND,
 21264               9991-CRTO-NOT-FOUND
 21265         DEPENDING ON DFHEIGDI.
 21266     MOVE '9%                    "   ' TO DFHEIV0
 21267     MOVE 'EL050' TO DFHEIV1
 21268     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21269     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39984     Code:       85403
