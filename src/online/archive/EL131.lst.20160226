* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34* 082013    2013040900001  AJRA  ADD PF15 BENEFICIARY MAINT
    35* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    36* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    37* 040814    2014030500002  AJRA  ADD ICD CODES
    38* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    39* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    40* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    41* 031715  CR2015022700002  PEMA  CHECK CHG IN DIAGNOSIS
    42* 031815    2015021700001  TANA  BENE EDIT IF A PAYMENT PENDING
    43******************************************************************
    44
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page   3
* EL131.cbl
    46 ENVIRONMENT DIVISION.
    47
    48 DATA DIVISION.
    49
    50 WORKING-STORAGE SECTION.
    51 01  DFH-START PIC X(04).
    52
    53 77  FILLER  PIC X(32)  VALUE '********************************'.
    54 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    55 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    56 77  s1                          pic s999 comp-3 value+0.
    57 77  s2                          pic s999 comp-3 value+0.
    58 77  a1                          pic s999 comp-3 value+0.
    59 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    60 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    61 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    62 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    63 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    64 77  ws-max-extension            pic s999 comp-3 value +0.
    65 77  ws-max-moben                pic s9(7)v99 comp-3 value +0.
    66 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    67 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    68     88  ERPDEF-FOUND                 VALUE 'Y'.
    69 77  WS-TRLR-FILE-EOF            PIC X     VALUE ' '.
    70     88  TRLR-FILE-EOF                VALUE 'Y'.
    71 77  WS-PAYMENT-PENDING          PIC X     VALUE ' '.
    72     88  PAYMENT-PENDING              VALUE 'Y'.
    73 77  ws-eracct-sw                pic x  value ' '.
    74     88  acct-found                value 'Y'.
    75 77  ws-benper-sw                pic x   value ' '.
    76     88  good-benper               value 'Y'.
    77 77  ws-claim-type               pic x value ' '.
    78 77  ws-ben-per                  pic 99 value 00.
    79 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    80 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    81 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    82 77  ws-max-bens                 pic s9(5) comp-3 value +0.
    83
    84 01  LCP-TIME-OF-DAY-XX.
    85     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    86     05  FILLER                    PIC 99.
    87 01  LCP-CICS-TIME                 PIC 9(15).
    88*                            COPY ELCSCTM.
    89******************************************************************
    90*                                                                *
    91*                                                                *
    92*                            ELCSCTM                             *
    93*                            VMOD=2.001                          *
    94*                                                                *
    95*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    96*                                                                *
    97******************************************************************
    98 01  SECURITY-MESSAGE.
    99     12  FILLER                          PIC X(30)
   100            VALUE '** LOGIC SECURITY VIOLATION -'.
   101     12  SM-READ                         PIC X(6).
   102     12  FILLER                          PIC X(5)
   103            VALUE ' PGM='.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page   4
* EL131.cbl
   104     12  SM-PGM                          PIC X(6).
   105     12  FILLER                          PIC X(5)
   106            VALUE ' OPR='.
   107     12  SM-PROCESSOR-ID                 PIC X(4).
   108     12  FILLER                          PIC X(6)
   109            VALUE ' TERM='.
   110     12  SM-TERMID                       PIC X(4).
   111     12  FILLER                          PIC XX   VALUE SPACE.
   112     12  SM-JUL-DATE                     PIC 9(5).
   113     12  FILLER                          PIC X    VALUE SPACE.
   114     12  SM-TIME                         PIC 99.99.
   115
   116
   117*                            COPY ELCSCRTY.
   118******************************************************************
   119*                                                                *
   120*                                                                *
   121*                            ELCSCRTY                            *
   122*                            VMOD=2.001                          *
   123*                                                                *
   124*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   125*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   126*        SAVED IN PI-SECURITY-ADDRESS.                           *
   127*                                                                *
   128******************************************************************
   129 01  SECURITY-CONTROL.
   130     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   131     12  FILLER                       PIC XX    VALUE 'SC'.
   132     12  SC-CREDIT-CODES.
   133         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   134             20  SC-CREDIT-DISPLAY    PIC X.
   135             20  SC-CREDIT-UPDATE     PIC X.
   136     12  SC-CLAIMS-CODES.
   137         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   138             20  SC-CLAIMS-DISPLAY    PIC X.
   139             20  SC-CLAIMS-UPDATE     PIC X.
   140
   141*                            COPY ELCNWA.
   142*****************************************************************
   143*                                                               *
   144*                                                               *
   145*                            ELCNWA.                            *
   146*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   147*                            VMOD=2.003                         *
   148*                                                               *
   149*            M O V E   N A M E   W O R K   A R E A.             *
   150*                                                               *
   151*****************************************************************.
   152
   153 01  WS-NAME-WORK-AREA.
   154     05  WS-INSURED-LAST-NAME        PIC X(15).
   155     05  WS-INSURED-1ST-NAME         PIC X(12).
   156     05  WS-INSURED-MID-INIT         PIC X.
   157
   158     05  WS-NAME-WORK.
   159         10  WS-NW                   PIC X
   160             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   161
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page   5
* EL131.cbl
   162     05  WS-NAME-WORK2.
   163         10  WS-NW2                  PIC X
   164             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   165                                        NWA-INDEX0.
   166
   167     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   168                                     COMP-3.
   169
   170
   171 01  ws-dcc-error-line.
   172     05  filler occurs 15.
   173         10  ws-error-no        pic x(4).
   174 01  WS-DATE-AREA.
   175     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   176     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   177     12  SAVE-DATE-CCYYMMDD.
   178         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   179         16  SAVE-DATE-YMD.
   180             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   181             20  FILLER         PIC X(4)    VALUE SPACES.
   182
   183 01  WS-BLANK                   PIC X       VALUE ' '.
   184
   185 01  CSO-WORK-FIELDS.
   186     05  WS-HOLD-CLAIM-STATUS    PIC X.
   187     05  WS-CRIT-PER-RECURRENT   PIC 99    VALUE 00.
   188     05  WS-CRIT-PER-ALPHA REDEFINES WS-CRIT-PER-RECURRENT.
   189         10  WS-RECURRENT-YN     PIC X.
   190         10  FILLER              PIC X.
   191
   192 01  LITERALS-NUMBERS.
   193     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   194     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   195     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   196     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   197     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   198     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   199     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   200     12  MAP-LENGTH              PIC S9(4)   VALUE +1060  COMP.
   201
   202     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   203     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   204     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   205     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   206     12  XCTL-EL114              PIC X(8)    VALUE 'EL114'.
   207     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   208     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   209     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   210     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   211     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   212
   213     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   214
   215     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   216
   217     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   218     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   219     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page   6
* EL131.cbl
   220     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   221     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   222     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   223     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   224     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   225     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   226     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   227     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   228
   229     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   230     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   231     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   232     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   233         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   234     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   235     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   236     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   237     12  WS-ICD-CODE-1           PIC X(8).
   238     12  WS-ICD-CODE-2           PIC X(8).
   239     12  WS-CLAIM-SEQU.
   240         16  FILLER              PIC X VALUE '('.
   241         16  WS-CURRENT-SEQU     PIC Z9.
   242         16  FILLER              PIC X(04) VALUE ' OF '.
   243         16  WS-OF-SEQU          PIC Z9.
   244         16  FILLER              PIC X VALUE ')'.
   245     12  WS-EDIT-BEN-CODE        PIC XX.
   246         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   247                                          '90' THRU '99'.
   248
   249     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   250     12  WS-EDIT-NUMBER          PIC ZZZ9.
   251
   252     12  WS-RESPONSE             PIC S9(8)   COMP.
   253         88  WS-RESP-NORMAL              VALUE +00.
   254         88  WS-RESP-ERROR               VALUE +01.
   255         88  WS-RESP-NOTFND              VALUE +13.
   256         88  WS-RESP-DUPKEY              VALUE +15.
   257         88  WS-RESP-NOTOPEN             VALUE +19.
   258         88  WS-RESP-ENDFILE             VALUE +20.
   259
   260     12  WS-MOS-PAID             PIC 999.
   261     12  WS-ODD-DAYS             PIC 99.
   262     12  WS-REM-MOS              PIC 999.
   263     12  WS-REM-DAYS             PIC 99.
   264     12  WS-TERM-IN-DAYS         PIC 9(4).
   265     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   266
   267     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   268     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   269     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   270     12  WS-RESET-SW             PIC X       VALUE 'N'.
   271     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   272     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   273     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   274
   275 01  DMD-DATE-YYYYMMDD.
   276     12  DMD-DECADE          PIC XX      VALUE SPACES.
   277     12  DMD-YYMMDD.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page   7
* EL131.cbl
   278         16  DMD-YY          PIC XX      VALUE SPACES.
   279         16  DMD-MM          PIC XX      VALUE SPACES.
   280         16  DMD-DD          PIC XX      VALUE SPACES.
   281
   282 01  DMD-DATE-MMDDYYYY.
   283     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   284     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   285     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   286     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   287     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   288     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   289
   290 01  WS-MAIL-CODE.
   291     12  FILLER              PIC X.
   292     12  DMD-MAIL-CODE.
   293         16  WS-MAIL-4       PIC X(4).
   294         16  WS-MAIL-5       PIC X.
   295     12  FILLER              PIC X(4).
   296
   297     12  W-NAME-LAST             PIC  X(15).
   298     12  W-NAME-FIRST            PIC  X(15).
   299     12  W-NAME-MIDDLE.
   300         16  FILLER              PIC  X.
   301         16  W-NAME-MIDDLE-2     PIC  X.
   302         16  FILLER              PIC  X(13).
   303
   304*    COPY ELCDCTB.
   305******************************************************************
   306*                                                                *
   307*                                                                *
   308*                            ELCDCTB.                            *
   309*                            VMOD=2.002                          *
   310*                                                                *
   311*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   312*       COMMUNICATIONS AREA                                      *
   313*                                                                *
   314******************************************************************
   315 01  DCT-COMMUNICATION-AREA.
   316     12  DCT-BILLING-BANK-ID      PIC  X(05).
   317     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   318     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   319     12  DCT-PRODUCT-CODE         PIC  X(02).
   320     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   321     12  DCT-RETURN-CODE          PIC  X(02).
   322     12  DCT-MAIL-CODE            PIC  X(05).
   323     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   324     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page   8
* EL131.cbl
   326 01  ERROR-SWITCHES.
   327     12  ERROR-SWITCH            PIC X.
   328         88  SCREEN-ERROR                    VALUE 'X'.
   329     12  MSTR-KEY-SWITCH         PIC X.
   330         88  MSTR-KEY-CHANGED                VALUE 'X'.
   331     12  CERT-KEY-SWITCH         PIC X.
   332*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   333         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   334*********SET TO Y IF PRIMARY KEY WILL CHANGE
   335         88  CERT-KEY-CHANGED                VALUE 'Y'.
   336     12  MSTR-SWITCH             PIC X.
   337         88  MSTR-UPDATES                    VALUE 'X'.
   338     12  crtt-switch             pic x value spaces.
   339         88  crtt-update             value 'X'.
   340     12  CERT-SWITCH             PIC X.
   341         88  CERT-UPDATES                    VALUE 'X'.
   342     12  UPDATE-SWITCH           PIC X.
   343         88  UPDATES-PRESENT                 VALUE 'X'.
   344     12  TRLR-SWITCH             PIC X.
   345         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   346         88  UPDATE-MADE                     VALUE 'Y'.
   347     12  NINETY-TRLR-SWITCH      PIC X.
   348         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   349     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   350         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   351     12  EARNINGS-CALC-SWITCH    PIC X.
   352         88  TEX-REG                         VALUE '4'.
   353         88  NET-PAY                         VALUE '5'.
   354     12  DLYACTV-SW              PIC X       VALUE 'N'.
   355         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page   9
* EL131.cbl
   357 01  EDIT-WORK-AREA.
   358     12  COUNT-2                 PIC 9.
   359     12  CALL-PGM                PIC X(8).
   360     12  TRANS-ID                PIC X(4).
   361     12  CHECK-PFKEYS            PIC 99.
   362     12  CHECK-MAINT             PIC X.
   363         88  ADD-ALPHA-RECORD                VALUE 'A'.
   364         88  CHANGE-CLAIM                    VALUE 'C'.
   365         88  DELETE-CLAIM                    VALUE 'D'.
   366         88  CHANGE-NAME                     VALUE 'N'.
   367         88  VALID-OPTIONS                   VALUE 'A' 'C'
   368                                                   'D' 'N'.
   369
   370     12  HOLD-BENEFIT            PIC XX.
   371     12  HOLD-FREQ               PIC XX.
   372     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   373     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   374     12  HOLD-PDTHRU             PIC XX.
   375     12  HOLD-ADDON              PIC XX.
   376     12  HOLD-NODAYS             PIC 9(4).
   377     12  HOLD-NOPMTS             PIC 9(3).
   378     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   379     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   380     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   381     12  HOLD-BIRTH              PIC XX.
   382     12  HOLD-END                PIC XX.
   383     12  HOLD-EFF                PIC XX.
   384     12  HOLD-ENTRY              PIC XX.
   385     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   386     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   387     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   388     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   389     12  HOLD-LF-CV-CAN          PIC XX.
   390     12  HOLD-AH-CV-CAN          PIC XX.
   391     12  DIVIDE-QUOT             PIC 9(3).
   392     12  DIVIDE-REM              PIC 9(3).
   393
   394     12  WS-ALPHA-DATE.
   395         16  WS-ALPHA-YEAR.
   396             20  WS-ALPHA-YY-1   PIC 99.
   397             20  WS-ALPHA-YY-2   PIC 99.
   398         16  WS-ALPHA-MM         PIC 99.
   399         16  WS-ALPHA-DD         PIC 99.
   400
   401     12  BUILD-VALID-DATE.
   402         16  BUILD-MONTH         PIC 99.
   403         16  BUILD-DAY           PIC 99.
   404         16  BUILD-YEAR          PIC 99.
   405     12  DEEDIT-MMYY-INPUT.
   406         16  FILLER              PIC X.
   407         16  DEEDIT-MONTH        PIC XX.
   408         16  DEEDIT-YEAR         PIC XX.
   409     12  DEEDIT-BEN              PIC 9(9)V99.
   410     12  DEEDIT-DATE-INPUT.
   411         16  FILLER              PIC XX.
   412         16  DEEDIT-DATE         PIC X(6).
   413     12  WORK-DATE-MDY.
   414         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  10
* EL131.cbl
   415         16  FILLER              PIC X(4).
   416         16  YEAR-WORK           PIC XX.
   417     12  WORK-DATE-MY.
   418         16  WORK-MONTH          PIC XX.
   419         16  WORK-SLASH          PIC X       VALUE '/'.
   420         16  WORK-YEAR           PIC XX.
   421     12  HOLD-DATE.
   422         16  HOLD-MONTH          PIC 99.
   423         16  FILLER              PIC X(4).
   424         16  HOLD-YEAR           PIC 99.
   425     12  SPLIT-INFO-LINE-1.
   426         16  SPLIT-INFO-DESC     PIC X(15).
   427         16  FILLER              PIC X(5)    VALUE ' OLD='.
   428         16  SPLIT-INFO-OLD      PIC X(40).
   429     12  EFF-TERM-MO             PIC 9(4).
   430     12  CURR-MO                 PIC 9(4).
   431     12  WS-BIN-CURRENT-DT       PIC XX.
   432     12  WS-CALC-METHOD          PIC X.
   433     12  WS-INITIALS.
   434         16  WS-INIT-1           PIC X.
   435         16  WS-INIT-2           PIC X.
   436     12  WS-REIN-TABLE.
   437         16  WS-REIN-1           PIC X.
   438         16  WS-REIN-2           PIC X.
   439         16  WS-REIN-3           PIC X.
   440     12  PI-KEY.
   441         16  PI-TERM             PIC X(4).
   442         16  PI-QUAL             PIC X(4).
   443     12  CHECK-KEY               PIC X(20).
   444     12  SAVE-ACCT-KEY           PIC X(20).
   445     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   446     12  WS-SOC-SEC-NUMBER.
   447         16  WS-SOC-SEC-NO       PIC 9(9).
   448         16  WS-SOC-SEC-BLANK    PIC X(2).
   449     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   450         16  WS-SSN-1-3          PIC 9(3).
   451         16  WS-SSN-DASH1        PIC X(1).
   452         16  WS-SSN-4-5          PIC 9(2).
   453         16  WS-SSN-DASH2        PIC X(1).
   454         16  WS-SSN-6-9          PIC 9(4).
   455     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   456     12  WS-RETURNED-FROM        PIC X(8)  VALUE SPACES.
   457
   458 01  WS-SAVE-FIELDS.
   459     12  WS-SAVE-BENEFICIARY     PIC X(10) VALUE LOW-VALUES.
   460     12  WS-SAVE-MAINTI          PIC X(1) VALUE LOW-VALUES.
   461     12  WS-SAVE-MAINTL          PIC S9(4) COMP VALUE +0.
   462     12  WS-SAVE-STATUSI         PIC X(6) VALUE LOW-VALUES.
   463     12  WS-SAVE-STATUSL         PIC S9(4) COMP VALUE +0.
   464     12  WS-SAVE-REPI            PIC X(8) VALUE LOW-VALUES.
   465     12  WS-SAVE-REPL            PIC S9(4) COMP VALUE +0.
   466     12  WS-SAVE-CAUSEI          PIC X(6) VALUE LOW-VALUES.
   467     12  WS-SAVE-CAUSEL          PIC S9(4) COMP VALUE +0.
   468     12  WS-SAVE-ENDI            PIC X(8) VALUE LOW-VALUES.
   469     12  WS-SAVE-ENDL            PIC S9(4) COMP VALUE +0.
   470     12  WS-SAVE-DIAGI           PIC X(60) VALUE LOW-VALUES.
   471     12  WS-SAVE-DIAGL           PIC S9(4) COMP VALUE +0.
   472     12  WS-SAVE-ICD1I           PIC X(8)  VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  11
* EL131.cbl
   473     12  WS-SAVE-ICD1L           PIC S9(4) COMP VALUE +0.
   474     12  WS-SAVE-ICD2I           PIC X(8)  VALUE LOW-VALUES.
   475     12  WS-SAVE-ICD2L           PIC S9(4) COMP VALUE +0.
   476     12  WS-SAVE-BENEI           PIC X(10) VALUE LOW-VALUES.
   477     12  WS-SAVE-BENEL           PIC S9(4) COMP VALUE +0.
   478     12  WS-SAVE-BIRTHI          PIC X(8) VALUE LOW-VALUES.
   479     12  WS-SAVE-BIRTHL          PIC S9(4) COMP VALUE +0.
   480     12  WS-SAVE-SOCIALI         PIC X(11) VALUE LOW-VALUES.
   481     12  WS-SAVE-SOCIALL         PIC S9(4) COMP VALUE +0.
   482     12  WS-SAVE-SEXI            PIC X(1) VALUE LOW-VALUES.
   483     12  WS-SAVE-SEXL            PIC S9(4) COMP VALUE +0.
   484     12  WS-SAVE-MLNAMEI         PIC X(15) VALUE LOW-VALUES.
   485     12  WS-SAVE-MLNAMEL         PIC S9(4) COMP VALUE +0.
   486     12  WS-SAVE-MFNAMEI         PIC X(12) VALUE LOW-VALUES.
   487     12  WS-SAVE-MFNAMEL         PIC S9(4) COMP VALUE +0.
   488     12  WS-SAVE-MMINITI         PIC X(1) VALUE LOW-VALUES.
   489     12  WS-SAVE-MMINITL         PIC S9(4) COMP VALUE +0.
   490     12  WS-SAVE-LOANNOI         PIC X(8) VALUE LOW-VALUES.
   491     12  WS-SAVE-LOANNOL         PIC S9(4) COMP VALUE +0.
   492     12  WS-SAVE-LOANBALI        PIC 9(7)V99 VALUE ZEROS.
   493     12  WS-SAVE-LOANBALL        PIC S9(4) COMP VALUE +0.
   494     12  WS-SAVE-PROCI           PIC X(4) VALUE LOW-VALUES.
   495     12  WS-SAVE-PROCL           PIC S9(4) COMP VALUE +0.
   496     12  WS-SAVE-SUPVI           PIC X(1) VALUE LOW-VALUES.
   497     12  WS-SAVE-SUPVL           PIC S9(4) COMP VALUE +0.
   498     12  WS-SAVE-PRICDI          PIC X(1) VALUE LOW-VALUES.
   499     12  WS-SAVE-PRICDL          PIC S9(4) COMP VALUE +0.
   500     12  WS-SAVE-FILETOI         PIC X(4) VALUE LOW-VALUES.
   501     12  WS-SAVE-FILETOL         PIC S9(4) COMP VALUE +0.
   502     12  WS-SAVE-PDTHRUI         PIC X(8) VALUE LOW-VALUES.
   503     12  WS-SAVE-PDTHRUL         PIC S9(4) COMP VALUE +0.
   504     12  WS-SAVE-PDAMTI          PIC 9(7)V99 VALUE ZEROS.
   505     12  WS-SAVE-PDAMTL          PIC S9(4) COMP VALUE +0.
   506     12  WS-SAVE-NODAYSI         PIC 9(5) VALUE ZEROS.
   507     12  WS-SAVE-NODAYSL         PIC S9(4) COMP VALUE +0.
   508     12  WS-SAVE-NOPMTSI         PIC 9(4) VALUE ZEROS.
   509     12  WS-SAVE-NOPMTSL         PIC S9(4) COMP VALUE +0.
   510     12  WS-SAVE-FORMTYPI        PIC X(1) VALUE LOW-VALUES.
   511     12  WS-SAVE-FORMTYPL        PIC S9(4) COMP VALUE +0.
   512     12  WS-SAVE-OCCI            PIC X(6) VALUE LOW-VALUES.
   513     12  WS-SAVE-OCCL            PIC S9(4) COMP VALUE +0.
   514
   515 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   516     12  M                   PIC S9(7)V99           VALUE ZEROS.
   517     12  L                   PIC S9(7)V99           VALUE ZEROS.
   518     12  N                   PIC S9(3)              VALUE ZEROS.
   519     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   520     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   521     12  I                   PIC S99V9(5)           VALUE ZEROS.
   522     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   523     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   524     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   525     12  R                   PIC S9(3)              VALUE ZEROS.
   526     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   527     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   528     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   529     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   530     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  12
* EL131.cbl
   531     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   532     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   533     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   534     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   535
   536 01  TERM-CALC-WORK-AREA.
   537     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   538     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   539     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   540     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   541     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   542     12  V-EXPONENTS.
   543        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   544     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   545
   546 01  TIME-IN.
   547     12  UN-HOURS                PIC XX.
   548     12  UN-MINUTES              PIC XX.
   549     12  FILLER                  PIC XX.
   550
   551 01  TIME-OUT.
   552     12  FOR-HOURS               PIC XX.
   553     12  FILLER                  PIC X       VALUE '.'.
   554     12  FOR-MINUTES             PIC XX.
   555
   556 01  ERROR-NUMBERS.
   557     12  ER-0000                 PIC X(4)    VALUE '0000'.
   558     12  ER-0004                 PIC X(4)    VALUE '0004'.
   559     12  ER-0008                 PIC X(4)    VALUE '0008'.
   560     12  ER-0023                 PIC X(4)    VALUE '0023'.
   561     12  ER-0029                 PIC X(4)    VALUE '0029'.
   562     12  ER-0068                 PIC X(4)    VALUE '0068'.
   563     12  ER-0070                 PIC X(4)    VALUE '0070'.
   564     12  ER-0149                 PIC X(4)    VALUE '0149'.
   565     12  ER-0154                 PIC X(4)    VALUE '0154'.
   566     12  ER-0169                 PIC X(4)    VALUE '0169'.
   567     12  ER-0192                 PIC X(4)    VALUE '0192'.
   568     12  ER-0199                 PIC X(4)    VALUE '0199'.
   569     12  ER-0203                 PIC X(4)    VALUE '0203'.
   570     12  ER-0204                 PIC X(4)    VALUE '0204'.
   571     12  ER-0205                 PIC X(4)    VALUE '0205'.
   572     12  ER-0206                 PIC X(4)    VALUE '0206'.
   573     12  ER-0208                 PIC X(4)    VALUE '0208'.
   574     12  ER-0210                 PIC X(4)    VALUE '0210'.
   575     12  ER-0215                 PIC X(4)    VALUE '0215'.
   576     12  ER-0219                 PIC X(4)    VALUE '0219'.
   577     12  ER-0220                 PIC X(4)    VALUE '0220'.
   578     12  ER-0222                 PIC X(4)    VALUE '0222'.
   579     12  ER-0223                 PIC X(4)    VALUE '0223'.
   580     12  ER-0224                 PIC X(4)    VALUE '0224'.
   581     12  ER-0227                 PIC X(4)    VALUE '0227'.
   582     12  ER-0230                 PIC X(4)    VALUE '0230'.
   583     12  ER-0232                 PIC X(4)    VALUE '0232'.
   584     12  ER-0233                 PIC X(4)    VALUE '0233'.
   585     12  ER-0236                 PIC X(4)    VALUE '0236'.
   586     12  ER-0237                 PIC X(4)    VALUE '0237'.
   587     12  ER-0238                 PIC X(4)    VALUE '0238'.
   588     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  13
* EL131.cbl
   589     12  ER-0241                 PIC X(4)    VALUE '0241'.
   590     12  ER-0243                 PIC X(4)    VALUE '0243'.
   591     12  ER-0244                 PIC X(4)    VALUE '0244'.
   592     12  ER-0246                 PIC X(4)    VALUE '0246'.
   593     12  ER-0247                 PIC X(4)    VALUE '0247'.
   594     12  ER-0248                 PIC X(4)    VALUE '0248'.
   595     12  ER-0250                 PIC X(4)    VALUE '0250'.
   596     12  ER-0251                 PIC X(4)    VALUE '0251'.
   597     12  ER-0253                 PIC X(4)    VALUE '0253'.
   598     12  ER-0256                 PIC X(4)    VALUE '0256'.
   599     12  ER-0257                 PIC X(4)    VALUE '0257'.
   600     12  ER-0258                 PIC X(4)    VALUE '0258'.
   601     12  ER-0259                 PIC X(4)    VALUE '0259'.
   602     12  ER-0260                 PIC X(4)    VALUE '0260'.
   603     12  ER-0261                 PIC X(4)    VALUE '0261'.
   604     12  ER-0262                 PIC X(4)    VALUE '0262'.
   605     12  ER-0263                 PIC X(4)    VALUE '0263'.
   606     12  ER-0273                 PIC X(4)    VALUE '0273'.
   607     12  ER-0274                 PIC X(4)    VALUE '0274'.
   608     12  ER-0276                 PIC X(4)    VALUE '0276'.
   609     12  ER-0282                 PIC X(4)    VALUE '0282'.
   610     12  ER-0283                 PIC X(4)    VALUE '0283'.
   611     12  ER-0309                 PIC X(4)    VALUE '0309'.
   612     12  ER-0310                 PIC X(4)    VALUE '0310'.
   613     12  ER-0311                 PIC X(4)    VALUE '0311'.
   614     12  ER-0333                 PIC X(4)    VALUE '0333'.
   615     12  ER-0360                 PIC X(4)    VALUE '0360'.
   616     12  ER-0377                 PIC X(4)    VALUE '0377'.
   617     12  ER-0402                 PIC X(4)    VALUE '0402'.
   618     12  ER-0416                 PIC X(4)    VALUE '0416'.
   619     12  ER-0426                 PIC X(4)    VALUE '0426'.
   620     12  ER-0427                 PIC X(4)    VALUE '0427'.
   621     12  ER-0428                 PIC X(4)    VALUE '0428'.
   622     12  ER-0429                 PIC X(4)    VALUE '0429'.
   623     12  ER-0430                 PIC X(4)    VALUE '0430'.
   624     12  ER-0458                 PIC X(4)    VALUE '0458'.
   625     12  ER-0475                 PIC X(4)    VALUE '0475'.
   626     12  ER-0491                 PIC X(4)    VALUE '0491'.
   627     12  ER-0509                 PIC X(4)    VALUE '0509'.
   628     12  ER-0510                 PIC X(4)    VALUE '0510'.
   629     12  ER-0511                 PIC X(4)    VALUE '0511'.
   630     12  ER-0512                 PIC X(4)    VALUE '0512'.
   631     12  ER-0519                 PIC X(4)    VALUE '0519'.
   632     12  ER-0520                 PIC X(4)    VALUE '0520'.
   633     12  ER-0521                 PIC X(4)    VALUE '0521'.
   634     12  ER-0547                 PIC X(4)    VALUE '0547'.
   635     12  ER-0548                 PIC X(4)    VALUE '0548'.
   636     12  ER-0549                 PIC X(4)    VALUE '0549'.
   637     12  ER-0565                 PIC X(4)    VALUE '0565'.
   638     12  ER-0598                 PIC X(4)    VALUE '0598'.
   639     12  ER-0639                 PIC X(4)    VALUE '0639'.
   640     12  ER-0797                 PIC X(4)    VALUE '0797'.
   641     12  ER-0802                 PIC X(4)    VALUE '0802'.
   642     12  ER-0803                 PIC X(4)    VALUE '0803'.
   643     12  ER-0849                 PIC X(4)    VALUE '0849'.
   644     12  ER-0885                 PIC X(4)    VALUE '0885'.
   645     12  ER-0887                 PIC X(4)    VALUE '0887'.
   646     12  ER-0919                 PIC X(4)    VALUE '0919'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  14
* EL131.cbl
   647     12  ER-0921                 PIC X(4)    VALUE '0921'.
   648     12  ER-0938                 PIC X(4)    VALUE '0938'.
   649     12  ER-0946                 PIC X(4)    VALUE '0946'.
   650     12  ER-0947                 PIC X(4)    VALUE '0947'.
   651     12  ER-0948                 PIC X(4)    VALUE '0948'.
   652     12  ER-0949                 PIC X(4)    VALUE '0949'.
   653     12  ER-0950                 PIC X(4)    VALUE '0950'.
   654     12  ER-0951                 PIC X(4)    VALUE '0951'.
   655     12  ER-0954                 PIC X(4)    VALUE '0954'.
   656     12  ER-0974                 PIC X(4)    VALUE '0974'.
   657     12  ER-0975                 PIC X(4)    VALUE '0975'.
   658     12  ER-0992                 PIC X(4)    VALUE '0992'.
   659     12  er-1581                 pic x(4)    value '1581'.
   660     12  ER-1651                 PIC X(4)    VALUE '1651'.
   661     12  ER-1652                 PIC X(4)    VALUE '1652'.
   662     12  ER-1653                 PIC X(4)    VALUE '1653'.
   663     12  ER-1654                 PIC X(4)    VALUE '1654'.
   664     12  ER-1655                 PIC X(4)    VALUE '1655'.
   665     12  er-1656                 pic x(4)    value '1656'.
   666     12  ER-1661                 PIC X(4)    VALUE '1661'.
   667     12  ER-1662                 PIC X(4)    VALUE '1662'.
   668     12  ER-1663                 PIC X(4)    VALUE '1663'.
   669     12  er-1664                 pic x(4)    value '1664'.
   670     12  er-1665                 pic x(4)    value '1665'.
   671     12  er-1666                 pic x(4)    value '1666'.
   672     12  er-1668                 pic x(4)    value '1668'.
   673     12  er-1669                 pic x(4)    value '1669'.
   674     12  er-1676                 pic x(4)    value '1676'.
   675     12  ER-1772                 PIC X(4)    VALUE '1772'.
   676     12  ER-1773                 PIC X(4)    VALUE '1773'.
   677     12  ER-2280                 PIC X(4)    VALUE '2280'.
   678     12  ER-2878                 PIC X(4)    VALUE '2878'.
   679     12  ER-7641                 PIC X(4)    VALUE '7641'.
   680     12  ER-7642                 PIC X(4)    VALUE '7642'.
   681     12  ER-7650                 PIC X(4)    VALUE '7650'.
   682     12  ER-7651                 PIC X(4)    VALUE '7651'.
   683     12  ER-7687                 PIC X(4)    VALUE '7687'.
   684     12  ER-7689                 PIC X(4)    VALUE '7689'.
   685     12  ER-7690                 PIC X(4)    VALUE '7690'.
   686     12  ER-7691                 PIC X(4)    VALUE '7691'.
   687     12  ER-8003                 PIC X(4)    VALUE '8003'.
   688     12  ER-8051                 PIC X(4)    VALUE '8051'.
   689     12  ER-8052                 PIC X(4)    VALUE '8052'.
   690     12  ER-8053                 PIC X(4)    VALUE '8053'.
   691     12  ER-8054                 PIC X(4)    VALUE '8054'.
   692     12  ER-8055                 PIC X(4)    VALUE '8055'.
   693     12  ER-8056                 PIC X(4)    VALUE '8056'.
   694     12  ER-8057                 PIC X(4)    VALUE '8057'.
   695     12  ER-8058                 PIC X(4)    VALUE '8058'.
   696     12  ER-8059                 PIC X(4)    VALUE '8059'.
   697     12  ER-8060                 PIC X(4)    VALUE '8060'.
   698     12  ER-8061                 PIC X(4)    VALUE '8061'.
   699     12  ER-8062                 PIC X(4)    VALUE '8062'.
   700     12  ER-8063                 PIC X(4)    VALUE '8063'.
   701     12  ER-8064                 PIC X(4)    VALUE '8064'.
   702     12  ER-8065                 PIC X(4)    VALUE '8065'.
   703     12  ER-8066                 PIC X(4)    VALUE '8066'.
   704     12  ER-8152                 PIC X(4)    VALUE '8152'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  15
* EL131.cbl
   705     12  ER-8153                 PIC X(4)    VALUE '8153'.
   706     12  ER-8154                 PIC X(4)    VALUE '8154'.
   707     12  ER-8155                 PIC X(4)    VALUE '8155'.
   708 01  ERPDEF-KEY-SAVE             PIC X(18).
   709 01  ERPDEF-KEY.
   710     12  ERPDEF-COMPANY-CD       PIC X.
   711     12  ERPDEF-STATE            PIC XX.
   712     12  ERPDEF-PROD-CD          PIC XXX.
   713     12  F                       PIC X(7).
   714     12  ERPDEF-BEN-TYPE         PIC X.
   715     12  ERPDEF-BEN-CODE         PIC XX.
   716     12  ERPDEF-EXP-DT           PIC XX.
   717 01  MSTR-KEY.
   718     12  COMPANY-CODE            PIC X.
   719     12  CARRIER-CODE            PIC X.
   720     12  CLAIM-NO                PIC X(7).
   721     12  CERT-NO.
   722         16  CERT-NO-PRIME       PIC X(10).
   723         16  CERT-NO-SUFX        PIC X.
   724
   725 01  WS-SAVE-CLAIM-KEY.
   726     12  WS-SAVE-COMPANY-CD      PIC X.
   727     12  WS-SAVE-CARRIER         PIC X.
   728     12  WS-SAVE-CLAIM-NO        PIC X(7).
   729     12  WS-SAVE-CERT-NO.
   730         16  WS-CERT-NO-PRIME    PIC X(10).
   731         16  WS-CERT-NO-SUFX     PIC X.
   732
   733 01  CERT-KEY.
   734     12  CERT-COMPANY-CODE       PIC X.
   735     12  CERT-CARRIER            PIC X.
   736     12  CERT-GROUP              PIC X(6).
   737     12  CERT-STATE              PIC XX.
   738     12  CERT-ACCOUNT            PIC X(10).
   739     12  CERT-DATE               PIC XX.
   740     12  CERT-CERT.
   741         16  CERT-CERT-PRIME     PIC X(10).
   742         16  CERT-CERT-SUFX      PIC X.
   743
   744 01  ELCRTT-KEY.
   745     05  CTRLR-COMP-CD       PIC X.
   746     05  CTRLR-CARRIER       PIC X.
   747     05  CTRLR-GROUPING      PIC X(6).
   748     05  CTRLR-STATE         PIC X(2).
   749     05  CTRLR-ACCOUNT       PIC X(10).
   750     05  CTRLR-EFF-DT        PIC XX.
   751     05  CTRLR-CERT-NO       PIC X(11).
   752     05  CTRLR-REC-TYPE      PIC X.
   753 01  NOTE-KEY.
   754     12  NOTE-COMP-CD            PIC X.
   755     12  NOTE-CERT-KEY.
   756         16  NOTE-CARRIER        PIC X.
   757         16  NOTE-GROUP          PIC X(6).
   758         16  NOTE-STATE          PIC XX.
   759         16  NOTE-ACCOUNT        PIC X(10).
   760         16  NOTE-DATE           PIC XX.
   761         16  NOTE-CERT-NO        PIC X(11).
   762
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  16
* EL131.cbl
   763 01  TRLR-KEY.
   764     12  TRLR-MAIN-KEY.
   765         16  TRLR-COMPANY-CD     PIC X.
   766         16  TRLR-CARRIER        PIC X.
   767         16  TRLR-CLAIM-NO       PIC X(07).
   768         16  TRLR-CERT-NO        PIC X(11).
   769     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   770
   771 01  BENEFIT-KEY.
   772     12  BEN-CO-ID               PIC X(3).
   773     12  BEN-REC-TYPE            PIC X.
   774     12  FILLER                  PIC XX.
   775     12  BEN-ACC-CD              PIC XX.
   776     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   777
   778 01  CNTL-KEY.
   779     12  CNTL-CO-ID              PIC X(3).
   780     12  CNTL-REC-TYPE           PIC X.
   781     12  CNTL-PROC-ID            PIC X(4).
   782     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   783         16  CNTL-STATE-NUMBER   PIC XX.
   784         16  FILLER              PIC XX.
   785     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   786         16  FILLER              PIC X(3).
   787         16  CNTL-CARRIER        PIC X.
   788     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   789
   790 01  ACTQ-KEY                    PIC X(20).
   791
   792 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   793
   794 01  CHKQ-KEY.
   795     12  CHKQ-COMPANY-CODE       PIC X.
   796     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   797     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   798
   799 01  ARCH-KEY.
   800     12  ARCH-COMPANY-CODE       PIC X.
   801     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   802     12  ARCH-RECORD-TYPE        PIC X.
   803     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   804
   805 01  ACCT-KEY.
   806     05  ACCT-PARTIAL-KEY.
   807         12  ACCT-COMPANY-CODE   PIC X.
   808         12  ACCT-CARRIER        PIC X.
   809         12  ACCT-GROUP          PIC X(6).
   810         12  ACCT-STATE          PIC XX.
   811         12  ACCT-ACCOUNT        PIC X(10).
   812     05  ACCT-DATE               PIC XX.
   813
   814 01  WS-ELBENE-KEY.
   815     12  WS-ELBENE-COMPANY-CD    PIC X.
   816     12  WS-ELBENE-RECORD-TYPE   PIC X.
   817     12  WS-ELBENE-ID            PIC X(10).
   818
   819 01  ELALPH-KEY.
   820     12  ELALPH-COMPANY-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  17
* EL131.cbl
   821     12  ELALPH-SOURCE           PIC X.
   822     12  ELALPH-NAME.
   823         16  ELALPH-LAST-NAME    PIC X(15).
   824         16  ELALPH-FIRST-NAME.
   825             20  ELALPH-FIRST-INIT   PIC X.
   826             20  FILLER              PIC X(11).
   827         16  ELALPH-MIDDLE-INIT  PIC X.
   828     12  ELALPH-DATE             PIC X(08).
   829     12  ELALPH-TIME             PIC S9(04)    COMP.
   830
   831 01  COMP-LENGTHS.
   832     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   833     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   834     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   835     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   836     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   837     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   838     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   839     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   840     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   841     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   842     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   843     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   844     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   845     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  18
* EL131.cbl
   847*                                COPY ELCLNKLT.
   848******************************************************************
   849*                                                                *
   850*                                                                *
   851*                           ELCLNKLT                             *
   852*                            VMOD=2.003                          *
   853*                                                                *
   854*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   855*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   856*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   857*                                                                *
   858*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   859*   COMPLETING THE REQUIRED FIELDS.                              *
   860*                                                                *
   861*   THE CALLING PROGRAM SHOULD CHECK:                            *
   862*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   863*                              9999 INDICATES AN UNKNOWN ABEND   *
   864*                                   WAS DETECTED.                *
   865*                              ALL OTHER VALUES ARE NORMAL ERROR *
   866*                              CODES FOUND IN THE ERROR FILE.    *
   867******************************************************************
   868 01  W-1523-LINKDATA.
   869     12  W-1523-COMMON-PI-DATA.
   870         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   871         16  FILLER              PIC  X(67).
   872         16  W-1523-COMPANY-CD   PIC  X(01).
   873         16  FILLER              PIC  X(10).
   874         16  W-1523-CONTROL-IN-PROGRESS.
   875             20  W-1523-CARRIER  PIC  X(01).
   876             20  W-1523-GROUPING PIC  X(06).
   877             20  W-1523-STATE    PIC  X(02).
   878             20  W-1523-ACCOUNT  PIC  X(10).
   879             20  W-1523-CLAIM-CERT-GRP.
   880                 24  W-1523-CLAIM-NO
   881                                 PIC  X(07).
   882                 24  W-1523-CERT-NO.
   883                     28  W-1523-CERT-PRIME
   884                                 PIC  X(10).
   885                     28  W-1523-CERT-SFX
   886                                 PIC  X(01).
   887                 24  W-1523-CERT-EFF-DT
   888                                 PIC  X(02).
   889         16  FILLER              PIC X(265).
   890
   891     12  W-1523-WORK-AREA.
   892         16  W-1523-FORM-NUMBER  PIC  X(04).
   893         16  W-1523-NUMBER-COPIES
   894                                 PIC  9(01).
   895         16  W-1523-ADDR-TYPE    PIC  X(02).
   896         16  W-1523-FOLLOW-UP-DATE
   897                                 PIC  X(02).
   898         16  W-1523-RESEND-DATE  PIC  X(02).
   899         16  W-1523-ERROR-CODE   PIC  9(04).
   900             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   901             88  W-1523-FATAL-ERROR
   902                                    VALUES  0006 0013 0042
   903                                            0154 0168 0169
   904                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  19
* EL131.cbl
   905                                            0179 0186 0281
   906                                            0332 2055 3697
   907                                            3698 3699 3770
   908                                            3771 3772 7675
   909                                            9106 9808 9883
   910                                            9887.
   911             88  W-1523-STOP-ERRORS
   912                                    VALUES  0013 0042 0154
   913                                            0168 0169 0172
   914                                            0281 0332 2055
   915                                            3698 3699 7675
   916                                            9106 9808 9883
   917                                            9999.
   918         16  W-1523-REASON       PIC  X(70).
   919         16  W-1523-ARCHIVE-NUMBER
   920                                 PIC  9(08).
   921     12  W-1523-POINTER-AREA.
   922         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   923         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   924         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   925         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   926         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  20
* EL131.cbl
   928*                                COPY ELCINTF.
   929******************************************************************
   930*                                                                *
   931*                                                                *
   932*                            ELCINTF.                            *
   933*                            VMOD=2.017                          *
   934*                                                                *
   935*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   936*                                                                *
   937*       LENGTH = 1024                                            *
   938*                                                                *
   939******************************************************************
   940*                   C H A N G E   L O G
   941*
   942* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   943*-----------------------------------------------------------------
   944*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   945* EFFECTIVE    NUMBER
   946*-----------------------------------------------------------------
   947* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   948******************************************************************
   949 01  PROGRAM-INTERFACE-BLOCK.
   950     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   951     12  PI-CALLING-PROGRAM              PIC X(8).
   952     12  PI-SAVED-PROGRAM-1              PIC X(8).
   953     12  PI-SAVED-PROGRAM-2              PIC X(8).
   954     12  PI-SAVED-PROGRAM-3              PIC X(8).
   955     12  PI-SAVED-PROGRAM-4              PIC X(8).
   956     12  PI-SAVED-PROGRAM-5              PIC X(8).
   957     12  PI-SAVED-PROGRAM-6              PIC X(8).
   958     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   959     12  PI-COMPANY-ID                   PIC XXX.
   960     12  PI-COMPANY-CD                   PIC X.
   961
   962     12  PI-COMPANY-PASSWORD             PIC X(8).
   963
   964     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   965
   966     12  PI-CONTROL-IN-PROGRESS.
   967         16  PI-CARRIER                  PIC X.
   968         16  PI-GROUPING                 PIC X(6).
   969         16  PI-STATE                    PIC XX.
   970         16  PI-ACCOUNT                  PIC X(10).
   971         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   972                                         PIC X(10).
   973         16  PI-CLAIM-CERT-GRP.
   974             20  PI-CLAIM-NO             PIC X(7).
   975             20  PI-CERT-NO.
   976                 25  PI-CERT-PRIME       PIC X(10).
   977                 25  PI-CERT-SFX         PIC X.
   978             20  PI-CERT-EFF-DT          PIC XX.
   979         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   980             20  PI-PLAN-CODE            PIC X(2).
   981             20  PI-REVISION-NUMBER      PIC X(3).
   982             20  PI-PLAN-EFF-DT          PIC X(2).
   983             20  PI-PLAN-EXP-DT          PIC X(2).
   984             20  FILLER                  PIC X(11).
   985         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  21
* EL131.cbl
   986             20  PI-OE-REFERENCE-1.
   987                 25  PI-OE-REF-1-PRIME   PIC X(18).
   988                 25  PI-OE-REF-1-SUFF    PIC XX.
   989
   990     12  PI-SESSION-IN-PROGRESS          PIC X.
   991         88  CLAIM-SESSION                   VALUE '1'.
   992         88  CREDIT-SESSION                  VALUE '2'.
   993         88  WARRANTY-SESSION                VALUE '3'.
   994         88  MORTGAGE-SESSION                VALUE '4'.
   995         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   996
   997
   998*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   999
  1000     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1001     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1002
  1003     12  PI-CREDIT-USER                  PIC X.
  1004         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1005         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1006
  1007     12  PI-CLAIM-USER                   PIC X.
  1008         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1009         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1010
  1011     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1012         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1013         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1014         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1015         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1016         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1017
  1018     12  PI-PROCESSOR-ID                 PIC X(4).
  1019
  1020     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1021
  1022     12  PI-MEMBER-CAPTION               PIC X(10).
  1023
  1024     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1025         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1026
  1027     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1028     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1029     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1030     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1031
  1032     12  PI-AH-OVERRIDE-L1               PIC X.
  1033     12  PI-AH-OVERRIDE-L2               PIC XX.
  1034     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1035     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1036
  1037     12  PI-NEW-SYSTEM                   PIC X(2).
  1038
  1039     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1040     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1041         88  PI-USES-PAID-TO                 VALUE '1'.
  1042     12  PI-CRDTCRD-SYSTEM.
  1043         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  22
* EL131.cbl
  1044             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1045             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1046         16  PI-CC-MONTH-END-DT          PIC XX.
  1047     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1048
  1049     12  PI-OE-REFERENCE-2.
  1050         16  PI-OE-REF-2-PRIME           PIC X(10).
  1051         16  PI-OE-REF-2-SUFF            PIC X.
  1052
  1053     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1054
  1055     12  PI-LANGUAGE-TYPE                PIC X.
  1056             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1057             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1058             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1059
  1060     12  PI-POLICY-LINKAGE-IND           PIC X.
  1061         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1062         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1063                                                   LOW-VALUES.
  1064
  1065     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1066     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1067         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1068         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1069
  1070     12  PI-PROCESSOR-CSR-IND            PIC X.
  1071         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1072         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1073
  1074     12  FILLER                          PIC X(3).
  1075
  1076     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1077
  1078     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1079         PI-SYSTEM-LEVEL.
  1080
  1081         16  PI-ENTRY-CODES.
  1082             20  PI-ENTRY-CD-1           PIC X.
  1083             20  PI-ENTRY-CD-2           PIC X.
  1084
  1085         16  PI-RETURN-CODES.
  1086             20  PI-RETURN-CD-1          PIC X.
  1087             20  PI-RETURN-CD-2          PIC X.
  1088
  1089         16  PI-UPDATE-STATUS-SAVE.
  1090             20  PI-UPDATE-BY            PIC X(4).
  1091             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1092
  1093         16  PI-LOWER-CASE-LETTERS       PIC X.
  1094             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1095
  1096*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1097*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1098*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1099
  1100         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1101             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  23
* EL131.cbl
  1102             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1103             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1104             88  ACCNT-CNTL                  VALUE '3'.
  1105             88  CARR-ACCNT-CNTL             VALUE '4'.
  1106
  1107         16  PI-PROCESSOR-CAP-LIST.
  1108             20  PI-SYSTEM-CONTROLS.
  1109                24 PI-SYSTEM-DISPLAY     PIC X.
  1110                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1111                24 PI-SYSTEM-MODIFY      PIC X.
  1112                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1113             20  FILLER                  PIC XX.
  1114             20  PI-DISPLAY-CAP          PIC X.
  1115                 88  DISPLAY-CAP             VALUE 'Y'.
  1116             20  PI-MODIFY-CAP           PIC X.
  1117                 88  MODIFY-CAP              VALUE 'Y'.
  1118             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1119                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1120             20  PI-FORCE-CAP            PIC X.
  1121                 88  FORCE-CAP               VALUE 'Y'.
  1122
  1123         16  PI-PROGRAM-CONTROLS.
  1124             20  PI-PGM-PRINT-OPT        PIC X.
  1125             20  PI-PGM-FORMAT-OPT       PIC X.
  1126             20  PI-PGM-PROCESS-OPT      PIC X.
  1127             20  PI-PGM-TOTALS-OPT       PIC X.
  1128
  1129         16  PI-HELP-INTERFACE.
  1130             20  PI-LAST-ERROR-NO        PIC X(4).
  1131             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1132
  1133         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1134             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1135
  1136         16  PI-CR-CONTROL-IN-PROGRESS.
  1137             20  PI-CR-CARRIER           PIC X.
  1138             20  PI-CR-GROUPING          PIC X(6).
  1139             20  PI-CR-STATE             PIC XX.
  1140             20  PI-CR-ACCOUNT           PIC X(10).
  1141             20  PI-CR-FIN-RESP          PIC X(10).
  1142             20  PI-CR-TYPE              PIC X.
  1143
  1144         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1145
  1146         16  PI-CR-MONTH-END-DT          PIC XX.
  1147
  1148         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1149             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1150             88  PI-ZERO-CARRIER             VALUE '1'.
  1151             88  PI-ZERO-GROUPING            VALUE '2'.
  1152             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1153
  1154         16  PI-CARRIER-SECURITY         PIC X.
  1155             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1156
  1157         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1158             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1159             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  24
* EL131.cbl
  1160
  1161         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1162             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1163                                         INDEXED BY PI-ACCESS-NDX
  1164                                         PIC X.
  1165
  1166         16  PI-GA-BILLING-CONTROL       PIC X.
  1167             88  PI-GA-BILLING               VALUE '1'.
  1168
  1169         16  PI-MAIL-PROCESSING          PIC X.
  1170             88  PI-MAIL-YES                 VALUE 'Y'.
  1171
  1172         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1173
  1174         16  PI-AR-SYSTEM.
  1175             20  PI-AR-PROCESSING-CNTL   PIC X.
  1176                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1177             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1178             20  PI-AR-MONTH-END-DT      PIC XX.
  1179
  1180         16  PI-MP-SYSTEM.
  1181             20  PI-MORTGAGE-USER            PIC X.
  1182                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1183                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1184             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1185                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1186                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1187                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1188                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1189                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1190             20  PI-MP-MONTH-END-DT          PIC XX.
  1191             20  PI-MP-REFERENCE-NO.
  1192                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1193                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1194
  1195         16  PI-LABEL-CONTROL            PIC X(01).
  1196             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1197             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1198
  1199         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1200             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1201
  1202         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1203             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1204             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1205
  1206         16  FILLER                      PIC X(14).
  1207
  1208     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1209******************************************************************
  1210     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1211         16  PI-NO-PMTS                    PIC 9(4).
  1212         16  PI-CERT-SWITCH                PIC X.
  1213             88  CREATED-CERT              VALUE '2'.
  1214         16  PI-PREM-TYPE                  PIC X.
  1215         16  PI-SAVE-CERT-NO.
  1216             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1217             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  25
* EL131.cbl
  1218         16  FILLER                        PIC X(46).
  1219         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1220         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1221         16  PI-REC-FOUND-SW               PIC X.
  1222         16  PI-LETTER-SW                  PIC X.
  1223         16  PI-PREV-TRLR-KEY              PIC X(22).
  1224         16  pi-claim-type                 pic x.
  1225         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1226         16  pi-approval-level             pic x.
  1227         16  FILLER                        PIC X(543).
  1228
  1229 01  SAVE-RECORD                 PIC X(450).
  1230
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  26
* EL131.cbl
  1232*                                COPY ELCLOGOF SUPPRESS.
  1233******************************************************************
  1234*                                                                *
  1235*                                                                *
  1236*                            ELCLOGOF.                           *
  1237*                            VMOD=2.001                          *
  1238*                                                                *
  1239*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1240*                                                                *
  1241******************************************************************
  1242 01  CLASIC-LOGOFF.
  1243     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1244     12  LOGOFF-TEXT.
  1245         16  FILLER          PIC X(5)    VALUE SPACES.
  1246         16  LOGOFF-MSG.
  1247             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1248             20  FILLER      PIC X       VALUE SPACES.
  1249             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1250         16  FILLER          PIC X(80)
  1251           VALUE '* YOU ARE NOW LOGGED OFF'.
  1252         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1253         16  FILLER          PIC X       VALUE QUOTE.
  1254         16  LOGOFF-SYS-MSG  PIC X(17)
  1255           VALUE 'S CLAS-IC SYSTEM '.
  1256     12  TEXT-MESSAGES.
  1257         16  UNACCESS-MSG    PIC X(29)
  1258             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1259         16  PGMIDERR-MSG    PIC X(17)
  1260             VALUE 'PROGRAM NOT FOUND'.
  1261
  1262*                                COPY ELCATTR SUPPRESS.
  1263******************************************************************
  1264*                                                                *
  1265*                            ELCATTR.                            *
  1266*                            VMOD=2.001                          *
  1267*                                                                *
  1268*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1269*                                                                *
  1270*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1271*                                                                *
  1272*                   POS 1   P=PROTECTED                          *
  1273*                           U=UNPROTECTED                        *
  1274*                           S=ASKIP                              *
  1275*                   POS 2   A=ALPHA/NUMERIC                      *
  1276*                           N=NUMERIC                            *
  1277*                   POS 3   N=NORMAL                             *
  1278*                           B=BRIGHT                             *
  1279*                           D=DARK                               *
  1280*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1281*                           OF=MODIFIED DATA TAG OFF             *
  1282*                                                                *
  1283*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1284******************************************************************
  1285 01  ATTRIBUTE-LIST.
  1286     12  AL-PABOF            PIC X       VALUE 'Y'.
  1287     12  AL-PABON            PIC X       VALUE 'Z'.
  1288     12  AL-PADOF            PIC X       VALUE '%'.
  1289     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  27
* EL131.cbl
  1290     12  AL-PANOF            PIC X       VALUE '-'.
  1291     12  AL-PANON            PIC X       VALUE '/'.
  1292     12  AL-SABOF            PIC X       VALUE '8'.
  1293     12  AL-SABON            PIC X       VALUE '9'.
  1294     12  AL-SADOF            PIC X       VALUE '@'.
  1295     12  AL-SADON            PIC X       VALUE QUOTE.
  1296     12  AL-SANOF            PIC X       VALUE '0'.
  1297     12  AL-SANON            PIC X       VALUE '1'.
  1298     12  AL-UABOF            PIC X       VALUE 'H'.
  1299     12  AL-UABON            PIC X       VALUE 'I'.
  1300     12  AL-UADOF            PIC X       VALUE '<'.
  1301     12  AL-UADON            PIC X       VALUE '('.
  1302     12  AL-UANOF            PIC X       VALUE ' '.
  1303     12  AL-UANON            PIC X       VALUE 'A'.
  1304     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1305     12  AL-UNBON            PIC X       VALUE 'R'.
  1306     12  AL-UNDOF            PIC X       VALUE '*'.
  1307     12  AL-UNDON            PIC X       VALUE ')'.
  1308     12  AL-UNNOF            PIC X       VALUE '&'.
  1309     12  AL-UNNON            PIC X       VALUE 'J'.
  1310
  1311*                                COPY ELCAID SUPPRESS.
  1312******************************************************************
  1313*                                                                *
  1314*                            ELCAID.                             *
  1315*                            VMOD=2.001                          *
  1316*                                                                *
  1317*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1318*                                                                *
  1319*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1320*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1321******************************************************************
  1322
  1323 01  DFHAID.
  1324   02  DFHNULL   PIC  X  VALUE  ' '.
  1325   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1326   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1327   02  DFHPEN    PIC  X  VALUE  '='.
  1328   02  DFHOPID   PIC  X  VALUE  'W'.
  1329   02  DFHPA1    PIC  X  VALUE  '%'.
  1330   02  DFHPA2    PIC  X  VALUE  '>'.
  1331   02  DFHPA3    PIC  X  VALUE  ','.
  1332   02  DFHPF1    PIC  X  VALUE  '1'.
  1333   02  DFHPF2    PIC  X  VALUE  '2'.
  1334   02  DFHPF3    PIC  X  VALUE  '3'.
  1335   02  DFHPF4    PIC  X  VALUE  '4'.
  1336   02  DFHPF5    PIC  X  VALUE  '5'.
  1337   02  DFHPF6    PIC  X  VALUE  '6'.
  1338   02  DFHPF7    PIC  X  VALUE  '7'.
  1339   02  DFHPF8    PIC  X  VALUE  '8'.
  1340   02  DFHPF9    PIC  X  VALUE  '9'.
  1341   02  DFHPF10   PIC  X  VALUE  ':'.
  1342   02  DFHPF11   PIC  X  VALUE  '#'.
  1343   02  DFHPF12   PIC  X  VALUE  '@'.
  1344   02  DFHPF13   PIC  X  VALUE  'A'.
  1345   02  DFHPF14   PIC  X  VALUE  'B'.
  1346   02  DFHPF15   PIC  X  VALUE  'C'.
  1347   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  28
* EL131.cbl
  1348   02  DFHPF17   PIC  X  VALUE  'E'.
  1349   02  DFHPF18   PIC  X  VALUE  'F'.
  1350   02  DFHPF19   PIC  X  VALUE  'G'.
  1351   02  DFHPF20   PIC  X  VALUE  'H'.
  1352   02  DFHPF21   PIC  X  VALUE  'I'.
  1353*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1354   02  DFHPF22   PIC  X  VALUE  '['.
  1355   02  DFHPF23   PIC  X  VALUE  '.'.
  1356   02  DFHPF24   PIC  X  VALUE  '<'.
  1357   02  DFHMSRE   PIC  X  VALUE  'X'.
  1358   02  DFHSTRF   PIC  X  VALUE  'h'.
  1359   02  DFHTRIG   PIC  X  VALUE  '"'.
  1360 01  FILLER REDEFINES DFHAID.
  1361     12  FILLER                  PIC X(8).
  1362     12  AID-KEYS OCCURS 24 TIMES.
  1363         16  FILLER              PIC X.
  1364
  1365*                                COPY EL131S.
  1366 01  EL131AI.
  1367     05  FILLER            PIC  X(0012).
  1368*    -------------------------------
  1369     05  DATEL PIC S9(0004) COMP.
  1370     05  DATEF PIC  X(0001).
  1371     05  FILLER REDEFINES DATEF.
  1372         10  DATEA PIC  X(0001).
  1373     05  DATEI PIC  X(0008).
  1374*    -------------------------------
  1375     05  TIMEL PIC S9(0004) COMP.
  1376     05  TIMEF PIC  X(0001).
  1377     05  FILLER REDEFINES TIMEF.
  1378         10  TIMEA PIC  X(0001).
  1379     05  TIMEI PIC  X(0005).
  1380*    -------------------------------
  1381     05  SEQUL PIC S9(0004) COMP.
  1382     05  SEQUF PIC  X(0001).
  1383     05  FILLER REDEFINES SEQUF.
  1384         10  SEQUA PIC  X(0001).
  1385     05  SEQUI PIC  X(0010).
  1386*    -------------------------------
  1387     05  COMPL PIC S9(0004) COMP.
  1388     05  COMPF PIC  X(0001).
  1389     05  FILLER REDEFINES COMPF.
  1390         10  COMPA PIC  X(0001).
  1391     05  COMPI PIC  X(0003).
  1392*    -------------------------------
  1393     05  USERIDL PIC S9(0004) COMP.
  1394     05  USERIDF PIC  X(0001).
  1395     05  FILLER REDEFINES USERIDF.
  1396         10  USERIDA PIC  X(0001).
  1397     05  USERIDI PIC  X(0004).
  1398*    -------------------------------
  1399     05  LABEL1L PIC S9(0004) COMP.
  1400     05  LABEL1F PIC  X(0001).
  1401     05  FILLER REDEFINES LABEL1F.
  1402         10  LABEL1A PIC  X(0001).
  1403     05  LABEL1I PIC  X(0011).
  1404*    -------------------------------
  1405     05  PCERTNOL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  29
* EL131.cbl
  1406     05  PCERTNOF PIC  X(0001).
  1407     05  FILLER REDEFINES PCERTNOF.
  1408         10  PCERTNOA PIC  X(0001).
  1409     05  PCERTNOI PIC  X(0010).
  1410*    -------------------------------
  1411     05  PSUFXL PIC S9(0004) COMP.
  1412     05  PSUFXF PIC  X(0001).
  1413     05  FILLER REDEFINES PSUFXF.
  1414         10  PSUFXA PIC  X(0001).
  1415     05  PSUFXI PIC  X(0001).
  1416*    -------------------------------
  1417     05  CCNOL PIC S9(0004) COMP.
  1418     05  CCNOF PIC  X(0001).
  1419     05  FILLER REDEFINES CCNOF.
  1420         10  CCNOA PIC  X(0001).
  1421     05  CCNOI PIC  X(0016).
  1422*    -------------------------------
  1423     05  MAINTL PIC S9(0004) COMP.
  1424     05  MAINTF PIC  X(0001).
  1425     05  FILLER REDEFINES MAINTF.
  1426         10  MAINTA PIC  X(0001).
  1427     05  MAINTI PIC  X(0001).
  1428*    -------------------------------
  1429     05  CLAIML PIC S9(0004) COMP.
  1430     05  CLAIMF PIC  X(0001).
  1431     05  FILLER REDEFINES CLAIMF.
  1432         10  CLAIMA PIC  X(0001).
  1433     05  CLAIMI PIC  X(0007).
  1434*    -------------------------------
  1435     05  CARRL PIC S9(0004) COMP.
  1436     05  CARRF PIC  X(0001).
  1437     05  FILLER REDEFINES CARRF.
  1438         10  CARRA PIC  X(0001).
  1439     05  CARRI PIC  X(0001).
  1440*    -------------------------------
  1441     05  CERTL PIC S9(0004) COMP.
  1442     05  CERTF PIC  X(0001).
  1443     05  FILLER REDEFINES CERTF.
  1444         10  CERTA PIC  X(0001).
  1445     05  CERTI PIC  X(0010).
  1446*    -------------------------------
  1447     05  SUFXL PIC S9(0004) COMP.
  1448     05  SUFXF PIC  X(0001).
  1449     05  FILLER REDEFINES SUFXF.
  1450         10  SUFXA PIC  X(0001).
  1451     05  SUFXI PIC  X(0001).
  1452*    -------------------------------
  1453     05  TYPEL PIC S9(0004) COMP.
  1454     05  TYPEF PIC  X(0001).
  1455     05  FILLER REDEFINES TYPEF.
  1456         10  TYPEA PIC  X(0001).
  1457     05  TYPEI PIC  X(0001).
  1458*    -------------------------------
  1459     05  BENPERL PIC S9(0004) COMP.
  1460     05  BENPERF PIC  X(0001).
  1461     05  FILLER REDEFINES BENPERF.
  1462         10  BENPERA PIC  X(0001).
  1463     05  BENPERI PIC  99.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  30
* EL131.cbl
  1464*    -------------------------------
  1465     05  INSTYPEL PIC S9(0004) COMP.
  1466     05  INSTYPEF PIC  X(0001).
  1467     05  FILLER REDEFINES INSTYPEF.
  1468         10  INSTYPEA PIC  X(0001).
  1469     05  INSTYPEI PIC  X(0001).
  1470*    -------------------------------
  1471     05  STATUSL PIC S9(0004) COMP.
  1472     05  STATUSF PIC  X(0001).
  1473     05  FILLER REDEFINES STATUSF.
  1474         10  STATUSA PIC  X(0001).
  1475     05  STATUSI PIC  X(0006).
  1476*    -------------------------------
  1477     05  INCL PIC S9(0004) COMP.
  1478     05  INCF PIC  X(0001).
  1479     05  FILLER REDEFINES INCF.
  1480         10  INCA PIC  X(0001).
  1481     05  INCI PIC  X(0008).
  1482*    -------------------------------
  1483     05  REPL PIC S9(0004) COMP.
  1484     05  REPF PIC  X(0001).
  1485     05  FILLER REDEFINES REPF.
  1486         10  REPA PIC  X(0001).
  1487     05  REPI PIC  X(0008).
  1488*    -------------------------------
  1489     05  ICD1L PIC S9(0004) COMP.
  1490     05  ICD1F PIC  X(0001).
  1491     05  FILLER REDEFINES ICD1F.
  1492         10  ICD1A PIC  X(0001).
  1493     05  ICD1I PIC  X(0008).
  1494*    -------------------------------
  1495     05  ICD2L PIC S9(0004) COMP.
  1496     05  ICD2F PIC  X(0001).
  1497     05  FILLER REDEFINES ICD2F.
  1498         10  ICD2A PIC  X(0001).
  1499     05  ICD2I PIC  X(0008).
  1500*    -------------------------------
  1501     05  DIAGL PIC S9(0004) COMP.
  1502     05  DIAGF PIC  X(0001).
  1503     05  FILLER REDEFINES DIAGF.
  1504         10  DIAGA PIC  X(0001).
  1505     05  DIAGI PIC  X(0060).
  1506*    -------------------------------
  1507     05  ACCSWL PIC S9(0004) COMP.
  1508     05  ACCSWF PIC  X(0001).
  1509     05  FILLER REDEFINES ACCSWF.
  1510         10  ACCSWA PIC  X(0001).
  1511     05  ACCSWI PIC  X(0001).
  1512*    -------------------------------
  1513     05  BENEL PIC S9(0004) COMP.
  1514     05  BENEF PIC  X(0001).
  1515     05  FILLER REDEFINES BENEF.
  1516         10  BENEA PIC  X(0001).
  1517     05  BENEI PIC  X(0010).
  1518*    -------------------------------
  1519     05  BIRTHL PIC S9(0004) COMP.
  1520     05  BIRTHF PIC  X(0001).
  1521     05  FILLER REDEFINES BIRTHF.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  31
* EL131.cbl
  1522         10  BIRTHA PIC  X(0001).
  1523     05  BIRTHI PIC  X(0008).
  1524*    -------------------------------
  1525     05  SOCIALL PIC S9(0004) COMP.
  1526     05  SOCIALF PIC  X(0001).
  1527     05  FILLER REDEFINES SOCIALF.
  1528         10  SOCIALA PIC  X(0001).
  1529     05  SOCIALI PIC  X(0011).
  1530*    -------------------------------
  1531     05  SEXL PIC S9(0004) COMP.
  1532     05  SEXF PIC  X(0001).
  1533     05  FILLER REDEFINES SEXF.
  1534         10  SEXA PIC  X(0001).
  1535     05  SEXI PIC  X(0001).
  1536*    -------------------------------
  1537     05  MLNAMEL PIC S9(0004) COMP.
  1538     05  MLNAMEF PIC  X(0001).
  1539     05  FILLER REDEFINES MLNAMEF.
  1540         10  MLNAMEA PIC  X(0001).
  1541     05  MLNAMEI PIC  X(0015).
  1542*    -------------------------------
  1543     05  MFNAMEL PIC S9(0004) COMP.
  1544     05  MFNAMEF PIC  X(0001).
  1545     05  FILLER REDEFINES MFNAMEF.
  1546         10  MFNAMEA PIC  X(0001).
  1547     05  MFNAMEI PIC  X(0012).
  1548*    -------------------------------
  1549     05  MMINITL PIC S9(0004) COMP.
  1550     05  MMINITF PIC  X(0001).
  1551     05  FILLER REDEFINES MMINITF.
  1552         10  MMINITA PIC  X(0001).
  1553     05  MMINITI PIC  X(0001).
  1554*    -------------------------------
  1555     05  LOANNOL PIC S9(0004) COMP.
  1556     05  LOANNOF PIC  X(0001).
  1557     05  FILLER REDEFINES LOANNOF.
  1558         10  LOANNOA PIC  X(0001).
  1559     05  LOANNOI PIC  X(0008).
  1560*    -------------------------------
  1561     05  CRTLNMEL PIC S9(0004) COMP.
  1562     05  CRTLNMEF PIC  X(0001).
  1563     05  FILLER REDEFINES CRTLNMEF.
  1564         10  CRTLNMEA PIC  X(0001).
  1565     05  CRTLNMEI PIC  X(0015).
  1566*    -------------------------------
  1567     05  CRTFNMEL PIC S9(0004) COMP.
  1568     05  CRTFNMEF PIC  X(0001).
  1569     05  FILLER REDEFINES CRTFNMEF.
  1570         10  CRTFNMEA PIC  X(0001).
  1571     05  CRTFNMEI PIC  X(0012).
  1572*    -------------------------------
  1573     05  CRTINITL PIC S9(0004) COMP.
  1574     05  CRTINITF PIC  X(0001).
  1575     05  FILLER REDEFINES CRTINITF.
  1576         10  CRTINITA PIC  X(0001).
  1577     05  CRTINITI PIC  X(0001).
  1578*    -------------------------------
  1579     05  LOANBALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  32
* EL131.cbl
  1580     05  LOANBALF PIC  X(0001).
  1581     05  FILLER REDEFINES LOANBALF.
  1582         10  LOANBALA PIC  X(0001).
  1583     05  LOANBALI PIC  9(7)V99.
  1584*    -------------------------------
  1585     05  PROCL PIC S9(0004) COMP.
  1586     05  PROCF PIC  X(0001).
  1587     05  FILLER REDEFINES PROCF.
  1588         10  PROCA PIC  X(0001).
  1589     05  PROCI PIC  X(0004).
  1590*    -------------------------------
  1591     05  SUPVL PIC S9(0004) COMP.
  1592     05  SUPVF PIC  X(0001).
  1593     05  FILLER REDEFINES SUPVF.
  1594         10  SUPVA PIC  X(0001).
  1595     05  SUPVI PIC  X(0001).
  1596*    -------------------------------
  1597     05  PRICDL PIC S9(0004) COMP.
  1598     05  PRICDF PIC  X(0001).
  1599     05  FILLER REDEFINES PRICDF.
  1600         10  PRICDA PIC  X(0001).
  1601     05  PRICDI PIC  X(0001).
  1602*    -------------------------------
  1603     05  CRITPL PIC S9(0004) COMP.
  1604     05  CRITPF PIC  X(0001).
  1605     05  FILLER REDEFINES CRITPF.
  1606         10  CRITPA PIC  X(0001).
  1607     05  CRITPI PIC  X(0002).
  1608*    -------------------------------
  1609     05  CRITPTL PIC S9(0004) COMP.
  1610     05  CRITPTF PIC  X(0001).
  1611     05  FILLER REDEFINES CRITPTF.
  1612         10  CRITPTA PIC  X(0001).
  1613     05  CRITPTI PIC  X(0002).
  1614*    -------------------------------
  1615     05  RTWMOSL PIC S9(0004) COMP.
  1616     05  RTWMOSF PIC  X(0001).
  1617     05  FILLER REDEFINES RTWMOSF.
  1618         10  RTWMOSA PIC  X(0001).
  1619     05  RTWMOSI PIC  X(0002).
  1620*    -------------------------------
  1621     05  FILETOL PIC S9(0004) COMP.
  1622     05  FILETOF PIC  X(0001).
  1623     05  FILLER REDEFINES FILETOF.
  1624         10  FILETOA PIC  X(0001).
  1625     05  FILETOI PIC  X(0004).
  1626*    -------------------------------
  1627     05  PTHRHDGL PIC S9(0004) COMP.
  1628     05  PTHRHDGF PIC  X(0001).
  1629     05  FILLER REDEFINES PTHRHDGF.
  1630         10  PTHRHDGA PIC  X(0001).
  1631     05  PTHRHDGI PIC  X(0010).
  1632*    -------------------------------
  1633     05  PDTHRUL PIC S9(0004) COMP.
  1634     05  PDTHRUF PIC  X(0001).
  1635     05  FILLER REDEFINES PDTHRUF.
  1636         10  PDTHRUA PIC  X(0001).
  1637     05  PDTHRUI PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  33
* EL131.cbl
  1638*    -------------------------------
  1639     05  PDAMTL PIC S9(0004) COMP.
  1640     05  PDAMTF PIC  X(0001).
  1641     05  FILLER REDEFINES PDAMTF.
  1642         10  PDAMTA PIC  X(0001).
  1643     05  PDAMTI PIC  9(7)V99.
  1644*    -------------------------------
  1645     05  NODAYSL PIC S9(0004) COMP.
  1646     05  NODAYSF PIC  X(0001).
  1647     05  FILLER REDEFINES NODAYSF.
  1648         10  NODAYSA PIC  X(0001).
  1649     05  NODAYSI PIC  9(5).
  1650*    -------------------------------
  1651     05  NOPMTSL PIC S9(0004) COMP.
  1652     05  NOPMTSF PIC  X(0001).
  1653     05  FILLER REDEFINES NOPMTSF.
  1654         10  NOPMTSA PIC  X(0001).
  1655     05  NOPMTSI PIC  9(4).
  1656*    -------------------------------
  1657     05  FORMTYPL PIC S9(0004) COMP.
  1658     05  FORMTYPF PIC  X(0001).
  1659     05  FILLER REDEFINES FORMTYPF.
  1660         10  FORMTYPA PIC  X(0001).
  1661     05  FORMTYPI PIC  X(0001).
  1662*    -------------------------------
  1663     05  ESTL PIC S9(0004) COMP.
  1664     05  ESTF PIC  X(0001).
  1665     05  FILLER REDEFINES ESTF.
  1666         10  ESTA PIC  X(0001).
  1667     05  ESTI PIC  X(0008).
  1668*    -------------------------------
  1669     05  AUIDL PIC S9(0004) COMP.
  1670     05  AUIDF PIC  X(0001).
  1671     05  FILLER REDEFINES AUIDF.
  1672         10  AUIDA PIC  X(0001).
  1673     05  AUIDI PIC  X(0004).
  1674*    -------------------------------
  1675     05  OCCL PIC S9(0004) COMP.
  1676     05  OCCF PIC  X(0001).
  1677     05  FILLER REDEFINES OCCF.
  1678         10  OCCA PIC  X(0001).
  1679     05  OCCI PIC  X(0006).
  1680*    -------------------------------
  1681     05  MNTDTL PIC S9(0004) COMP.
  1682     05  MNTDTF PIC  X(0001).
  1683     05  FILLER REDEFINES MNTDTF.
  1684         10  MNTDTA PIC  X(0001).
  1685     05  MNTDTI PIC  X(0008).
  1686*    -------------------------------
  1687     05  MNTTYPEL PIC S9(0004) COMP.
  1688     05  MNTTYPEF PIC  X(0001).
  1689     05  FILLER REDEFINES MNTTYPEF.
  1690         10  MNTTYPEA PIC  X(0001).
  1691     05  MNTTYPEI PIC  X(0006).
  1692*    -------------------------------
  1693     05  CERTCARL PIC S9(0004) COMP.
  1694     05  CERTCARF PIC  X(0001).
  1695     05  FILLER REDEFINES CERTCARF.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  34
* EL131.cbl
  1696         10  CERTCARA PIC  X(0001).
  1697     05  CERTCARI PIC  X(0001).
  1698*    -------------------------------
  1699     05  CERTGRPL PIC S9(0004) COMP.
  1700     05  CERTGRPF PIC  X(0001).
  1701     05  FILLER REDEFINES CERTGRPF.
  1702         10  CERTGRPA PIC  X(0001).
  1703     05  CERTGRPI PIC  X(0006).
  1704*    -------------------------------
  1705     05  CERTSTL PIC S9(0004) COMP.
  1706     05  CERTSTF PIC  X(0001).
  1707     05  FILLER REDEFINES CERTSTF.
  1708         10  CERTSTA PIC  X(0001).
  1709     05  CERTSTI PIC  X(0002).
  1710*    -------------------------------
  1711     05  CERTACTL PIC S9(0004) COMP.
  1712     05  CERTACTF PIC  X(0001).
  1713     05  FILLER REDEFINES CERTACTF.
  1714         10  CERTACTA PIC  X(0001).
  1715     05  CERTACTI PIC  X(0010).
  1716*    -------------------------------
  1717     05  CERTEFFL PIC S9(0004) COMP.
  1718     05  CERTEFFF PIC  X(0001).
  1719     05  FILLER REDEFINES CERTEFFF.
  1720         10  CERTEFFA PIC  X(0001).
  1721     05  CERTEFFI PIC  X(0008).
  1722*    -------------------------------
  1723     05  ISSAGEL PIC S9(0004) COMP.
  1724     05  ISSAGEF PIC  X(0001).
  1725     05  FILLER REDEFINES ISSAGEF.
  1726         10  ISSAGEA PIC  X(0001).
  1727     05  ISSAGEI PIC  X(0002).
  1728*    -------------------------------
  1729     05  APRL PIC S9(0004) COMP.
  1730     05  APRF PIC  X(0001).
  1731     05  FILLER REDEFINES APRF.
  1732         10  APRA PIC  X(0001).
  1733     05  APRI PIC  9(4)V9(4).
  1734*    -------------------------------
  1735     05  PMTFREQL PIC S9(0004) COMP.
  1736     05  PMTFREQF PIC  X(0001).
  1737     05  FILLER REDEFINES PMTFREQF.
  1738         10  PMTFREQA PIC  X(0001).
  1739     05  PMTFREQI PIC  99.
  1740*    -------------------------------
  1741     05  INDGRPL PIC S9(0004) COMP.
  1742     05  INDGRPF PIC  X(0001).
  1743     05  FILLER REDEFINES INDGRPF.
  1744         10  INDGRPA PIC  X(0001).
  1745     05  INDGRPI PIC  X(0001).
  1746*    -------------------------------
  1747     05  PREMTYPL PIC S9(0004) COMP.
  1748     05  PREMTYPF PIC  X(0001).
  1749     05  FILLER REDEFINES PREMTYPF.
  1750         10  PREMTYPA PIC  X(0001).
  1751     05  PREMTYPI PIC  X(0001).
  1752*    -------------------------------
  1753     05  REINCDL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  35
* EL131.cbl
  1754     05  REINCDF PIC  X(0001).
  1755     05  FILLER REDEFINES REINCDF.
  1756         10  REINCDA PIC  X(0001).
  1757     05  REINCDI PIC  X(0001).
  1758*    -------------------------------
  1759     05  JNTLNMEL PIC S9(0004) COMP.
  1760     05  JNTLNMEF PIC  X(0001).
  1761     05  FILLER REDEFINES JNTLNMEF.
  1762         10  JNTLNMEA PIC  X(0001).
  1763     05  JNTLNMEI PIC  X(0015).
  1764*    -------------------------------
  1765     05  JNTFNMEL PIC S9(0004) COMP.
  1766     05  JNTFNMEF PIC  X(0001).
  1767     05  FILLER REDEFINES JNTFNMEF.
  1768         10  JNTFNMEA PIC  X(0001).
  1769     05  JNTFNMEI PIC  X(0012).
  1770*    -------------------------------
  1771     05  JNTINITL PIC S9(0004) COMP.
  1772     05  JNTINITF PIC  X(0001).
  1773     05  FILLER REDEFINES JNTINITF.
  1774         10  JNTINITA PIC  X(0001).
  1775     05  JNTINITI PIC  X(0001).
  1776*    -------------------------------
  1777     05  JNTAGEL PIC S9(0004) COMP.
  1778     05  JNTAGEF PIC  X(0001).
  1779     05  FILLER REDEFINES JNTAGEF.
  1780         10  JNTAGEA PIC  X(0001).
  1781     05  JNTAGEI PIC  X(0002).
  1782*    -------------------------------
  1783     05  ADDONDTL PIC S9(0004) COMP.
  1784     05  ADDONDTF PIC  X(0001).
  1785     05  FILLER REDEFINES ADDONDTF.
  1786         10  ADDONDTA PIC  X(0001).
  1787     05  ADDONDTI PIC  X(0008).
  1788*    -------------------------------
  1789     05  LCVDSCRL PIC S9(0004) COMP.
  1790     05  LCVDSCRF PIC  X(0001).
  1791     05  FILLER REDEFINES LCVDSCRF.
  1792         10  LCVDSCRA PIC  X(0001).
  1793     05  LCVDSCRI PIC  X(0006).
  1794*    -------------------------------
  1795     05  LCVKINDL PIC S9(0004) COMP.
  1796     05  LCVKINDF PIC  X(0001).
  1797     05  FILLER REDEFINES LCVKINDF.
  1798         10  LCVKINDA PIC  X(0001).
  1799     05  LCVKINDI PIC  X(0003).
  1800*    -------------------------------
  1801     05  LCVCDL PIC S9(0004) COMP.
  1802     05  LCVCDF PIC  X(0001).
  1803     05  FILLER REDEFINES LCVCDF.
  1804         10  LCVCDA PIC  X(0001).
  1805     05  LCVCDI PIC  X(0002).
  1806*    -------------------------------
  1807     05  LCVOTRML PIC S9(0004) COMP.
  1808     05  LCVOTRMF PIC  X(0001).
  1809     05  FILLER REDEFINES LCVOTRMF.
  1810         10  LCVOTRMA PIC  X(0001).
  1811     05  LCVOTRMI PIC  999.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  36
* EL131.cbl
  1812*    -------------------------------
  1813     05  LCVRTRML PIC S9(0004) COMP.
  1814     05  LCVRTRMF PIC  X(0001).
  1815     05  FILLER REDEFINES LCVRTRMF.
  1816         10  LCVRTRMA PIC  X(0001).
  1817     05  LCVRTRMI PIC  X(0003).
  1818*    -------------------------------
  1819     05  LCVRATEL PIC S9(0004) COMP.
  1820     05  LCVRATEF PIC  X(0001).
  1821     05  FILLER REDEFINES LCVRATEF.
  1822         10  LCVRATEA PIC  X(0001).
  1823     05  LCVRATEI PIC  9999V99.
  1824*    -------------------------------
  1825     05  LCVBENEL PIC S9(0004) COMP.
  1826     05  LCVBENEF PIC  X(0001).
  1827     05  FILLER REDEFINES LCVBENEF.
  1828         10  LCVBENEA PIC  X(0001).
  1829     05  LCVBENEI PIC  9(9)V99.
  1830*    -------------------------------
  1831     05  LCVFORML PIC S9(0004) COMP.
  1832     05  LCVFORMF PIC  X(0001).
  1833     05  FILLER REDEFINES LCVFORMF.
  1834         10  LCVFORMA PIC  X(0001).
  1835     05  LCVFORMI PIC  X(0012).
  1836*    -------------------------------
  1837     05  LCVCNDTL PIC S9(0004) COMP.
  1838     05  LCVCNDTF PIC  X(0001).
  1839     05  FILLER REDEFINES LCVCNDTF.
  1840         10  LCVCNDTA PIC  X(0001).
  1841     05  LCVCNDTI PIC  X(0008).
  1842*    -------------------------------
  1843     05  LCVEXITL PIC S9(0004) COMP.
  1844     05  LCVEXITF PIC  X(0001).
  1845     05  FILLER REDEFINES LCVEXITF.
  1846         10  LCVEXITA PIC  X(0001).
  1847     05  LCVEXITI PIC  X(0008).
  1848*    -------------------------------
  1849     05  LCVSTATL PIC S9(0004) COMP.
  1850     05  LCVSTATF PIC  X(0001).
  1851     05  FILLER REDEFINES LCVSTATF.
  1852         10  LCVSTATA PIC  X(0001).
  1853     05  LCVSTATI PIC  X(0006).
  1854*    -------------------------------
  1855     05  ACVDSCRL PIC S9(0004) COMP.
  1856     05  ACVDSCRF PIC  X(0001).
  1857     05  FILLER REDEFINES ACVDSCRF.
  1858         10  ACVDSCRA PIC  X(0001).
  1859     05  ACVDSCRI PIC  X(0006).
  1860*    -------------------------------
  1861     05  ACVKINDL PIC S9(0004) COMP.
  1862     05  ACVKINDF PIC  X(0001).
  1863     05  FILLER REDEFINES ACVKINDF.
  1864         10  ACVKINDA PIC  X(0001).
  1865     05  ACVKINDI PIC  X(0003).
  1866*    -------------------------------
  1867     05  ACVCDL PIC S9(0004) COMP.
  1868     05  ACVCDF PIC  X(0001).
  1869     05  FILLER REDEFINES ACVCDF.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  37
* EL131.cbl
  1870         10  ACVCDA PIC  X(0001).
  1871     05  ACVCDI PIC  X(0002).
  1872*    -------------------------------
  1873     05  ACVOTRML PIC S9(0004) COMP.
  1874     05  ACVOTRMF PIC  X(0001).
  1875     05  FILLER REDEFINES ACVOTRMF.
  1876         10  ACVOTRMA PIC  X(0001).
  1877     05  ACVOTRMI PIC  999.
  1878*    -------------------------------
  1879     05  ACVRTRML PIC S9(0004) COMP.
  1880     05  ACVRTRMF PIC  X(0001).
  1881     05  FILLER REDEFINES ACVRTRMF.
  1882         10  ACVRTRMA PIC  X(0001).
  1883     05  ACVRTRMI PIC  X(0003).
  1884*    -------------------------------
  1885     05  ACVRATEL PIC S9(0004) COMP.
  1886     05  ACVRATEF PIC  X(0001).
  1887     05  FILLER REDEFINES ACVRATEF.
  1888         10  ACVRATEA PIC  X(0001).
  1889     05  ACVRATEI PIC  9999V99.
  1890*    -------------------------------
  1891     05  ACVBENEL PIC S9(0004) COMP.
  1892     05  ACVBENEF PIC  X(0001).
  1893     05  FILLER REDEFINES ACVBENEF.
  1894         10  ACVBENEA PIC  X(0001).
  1895     05  ACVBENEI PIC  9(9)V99.
  1896*    -------------------------------
  1897     05  ACVFORML PIC S9(0004) COMP.
  1898     05  ACVFORMF PIC  X(0001).
  1899     05  FILLER REDEFINES ACVFORMF.
  1900         10  ACVFORMA PIC  X(0001).
  1901     05  ACVFORMI PIC  X(0012).
  1902*    -------------------------------
  1903     05  ACVCNDTL PIC S9(0004) COMP.
  1904     05  ACVCNDTF PIC  X(0001).
  1905     05  FILLER REDEFINES ACVCNDTF.
  1906         10  ACVCNDTA PIC  X(0001).
  1907     05  ACVCNDTI PIC  X(0008).
  1908*    -------------------------------
  1909     05  ACVEXITL PIC S9(0004) COMP.
  1910     05  ACVEXITF PIC  X(0001).
  1911     05  FILLER REDEFINES ACVEXITF.
  1912         10  ACVEXITA PIC  X(0001).
  1913     05  ACVEXITI PIC  X(0008).
  1914*    -------------------------------
  1915     05  ACVSTATL PIC S9(0004) COMP.
  1916     05  ACVSTATF PIC  X(0001).
  1917     05  FILLER REDEFINES ACVSTATF.
  1918         10  ACVSTATA PIC  X(0001).
  1919     05  ACVSTATI PIC  X(0006).
  1920*    -------------------------------
  1921     05  LABEL2L PIC S9(0004) COMP.
  1922     05  LABEL2F PIC  X(0001).
  1923     05  FILLER REDEFINES LABEL2F.
  1924         10  LABEL2A PIC  X(0001).
  1925     05  LABEL2I PIC  X(0014).
  1926*    -------------------------------
  1927     05  BCERT1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  38
* EL131.cbl
  1928     05  BCERT1F PIC  X(0001).
  1929     05  FILLER REDEFINES BCERT1F.
  1930         10  BCERT1A PIC  X(0001).
  1931     05  BCERT1I PIC  X(0010).
  1932*    -------------------------------
  1933     05  BSUFX1L PIC S9(0004) COMP.
  1934     05  BSUFX1F PIC  X(0001).
  1935     05  FILLER REDEFINES BSUFX1F.
  1936         10  BSUFX1A PIC  X(0001).
  1937     05  BSUFX1I PIC  X(0001).
  1938*    -------------------------------
  1939     05  BCERT2L PIC S9(0004) COMP.
  1940     05  BCERT2F PIC  X(0001).
  1941     05  FILLER REDEFINES BCERT2F.
  1942         10  BCERT2A PIC  X(0001).
  1943     05  BCERT2I PIC  X(0010).
  1944*    -------------------------------
  1945     05  BSUFX2L PIC S9(0004) COMP.
  1946     05  BSUFX2F PIC  X(0001).
  1947     05  FILLER REDEFINES BSUFX2F.
  1948         10  BSUFX2A PIC  X(0001).
  1949     05  BSUFX2I PIC  X(0001).
  1950*    -------------------------------
  1951     05  BCERT3L PIC S9(0004) COMP.
  1952     05  BCERT3F PIC  X(0001).
  1953     05  FILLER REDEFINES BCERT3F.
  1954         10  BCERT3A PIC  X(0001).
  1955     05  BCERT3I PIC  X(0010).
  1956*    -------------------------------
  1957     05  BSUFX3L PIC S9(0004) COMP.
  1958     05  BSUFX3F PIC  X(0001).
  1959     05  FILLER REDEFINES BSUFX3F.
  1960         10  BSUFX3A PIC  X(0001).
  1961     05  BSUFX3I PIC  X(0001).
  1962*    -------------------------------
  1963     05  BCERT4L PIC S9(0004) COMP.
  1964     05  BCERT4F PIC  X(0001).
  1965     05  FILLER REDEFINES BCERT4F.
  1966         10  BCERT4A PIC  X(0001).
  1967     05  BCERT4I PIC  X(0010).
  1968*    -------------------------------
  1969     05  BSUFX4L PIC S9(0004) COMP.
  1970     05  BSUFX4F PIC  X(0001).
  1971     05  FILLER REDEFINES BSUFX4F.
  1972         10  BSUFX4A PIC  X(0001).
  1973     05  BSUFX4I PIC  X(0001).
  1974*    -------------------------------
  1975     05  BCERT5L PIC S9(0004) COMP.
  1976     05  BCERT5F PIC  X(0001).
  1977     05  FILLER REDEFINES BCERT5F.
  1978         10  BCERT5A PIC  X(0001).
  1979     05  BCERT5I PIC  X(0010).
  1980*    -------------------------------
  1981     05  BSUFX5L PIC S9(0004) COMP.
  1982     05  BSUFX5F PIC  X(0001).
  1983     05  FILLER REDEFINES BSUFX5F.
  1984         10  BSUFX5A PIC  X(0001).
  1985     05  BSUFX5I PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  39
* EL131.cbl
  1986*    -------------------------------
  1987     05  MSG1L PIC S9(0004) COMP.
  1988     05  MSG1F PIC  X(0001).
  1989     05  FILLER REDEFINES MSG1F.
  1990         10  MSG1A PIC  X(0001).
  1991     05  MSG1I PIC  X(0072).
  1992*    -------------------------------
  1993     05  MSG2L PIC S9(0004) COMP.
  1994     05  MSG2F PIC  X(0001).
  1995     05  FILLER REDEFINES MSG2F.
  1996         10  MSG2A PIC  X(0001).
  1997     05  MSG2I PIC  X(0072).
  1998*    -------------------------------
  1999     05  PFKEYL PIC S9(0004) COMP.
  2000     05  PFKEYF PIC  X(0001).
  2001     05  FILLER REDEFINES PFKEYF.
  2002         10  PFKEYA PIC  X(0001).
  2003     05  PFKEYI PIC  99.
  2004*    -------------------------------
  2005     05  PFKEY6L PIC S9(0004) COMP.
  2006     05  PFKEY6F PIC  X(0001).
  2007     05  FILLER REDEFINES PFKEY6F.
  2008         10  PFKEY6A PIC  X(0001).
  2009     05  PFKEY6I PIC  X(0016).
  2010 01  EL131AO REDEFINES EL131AI.
  2011     05  FILLER            PIC  X(0012).
  2012*    -------------------------------
  2013     05  FILLER            PIC  X(0003).
  2014     05  DATEO PIC  X(0008).
  2015*    -------------------------------
  2016     05  FILLER            PIC  X(0003).
  2017     05  TIMEO PIC  99.99.
  2018*    -------------------------------
  2019     05  FILLER            PIC  X(0003).
  2020     05  SEQUO PIC  X(0010).
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  COMPO PIC  X(0003).
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  USERIDO PIC  X(0004).
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
  2029     05  LABEL1O PIC  X(0011).
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  PCERTNOO PIC  X(0010).
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  PSUFXO PIC  X(0001).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  CCNOO PIC  X(0016).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  MAINTO PIC  X(0001).
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  40
* EL131.cbl
  2044     05  CLAIMO PIC  X(0007).
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  CARRO PIC  X(0001).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  CERTO PIC  X(0010).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  SUFXO PIC  X(0001).
  2054*    -------------------------------
  2055     05  FILLER            PIC  X(0003).
  2056     05  TYPEO PIC  X(0001).
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  BENPERO PIC  X(0002).
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  INSTYPEO PIC  X(0001).
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
  2065     05  STATUSO PIC  X(0006).
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
  2068     05  INCO PIC  X(0008).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
  2071     05  REPO PIC  X(0008).
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  ICD1O PIC  X(0008).
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  ICD2O PIC  X(0008).
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  DIAGO PIC  X(0060).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  ACCSWO PIC  X(0001).
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  BENEO PIC  X(0010).
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  BIRTHO PIC  X(0008).
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  SOCIALO PIC  X(0011).
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  SEXO PIC  X(0001).
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  MLNAMEO PIC  X(0015).
  2099*    -------------------------------
  2100     05  FILLER            PIC  X(0003).
  2101     05  MFNAMEO PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  41
* EL131.cbl
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  MMINITO PIC  X(0001).
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  LOANNOO PIC  X(0008).
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  CRTLNMEO PIC  X(0015).
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
  2113     05  CRTFNMEO PIC  X(0012).
  2114*    -------------------------------
  2115     05  FILLER            PIC  X(0003).
  2116     05  CRTINITO PIC  X(0001).
  2117*    -------------------------------
  2118     05  FILLER            PIC  X(0003).
  2119     05  LOANBALO PIC  ZZZZZ9.99.
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  PROCO PIC  X(0004).
  2123*    -------------------------------
  2124     05  FILLER            PIC  X(0003).
  2125     05  SUPVO PIC  X(0001).
  2126*    -------------------------------
  2127     05  FILLER            PIC  X(0003).
  2128     05  PRICDO PIC  X(0001).
  2129*    -------------------------------
  2130     05  FILLER            PIC  X(0003).
  2131     05  CRITPO PIC  X(0002).
  2132*    -------------------------------
  2133     05  FILLER            PIC  X(0003).
  2134     05  CRITPTO PIC  X(0002).
  2135*    -------------------------------
  2136     05  FILLER            PIC  X(0003).
  2137     05  RTWMOSO PIC  X(0002).
  2138*    -------------------------------
  2139     05  FILLER            PIC  X(0003).
  2140     05  FILETOO PIC  X(0004).
  2141*    -------------------------------
  2142     05  FILLER            PIC  X(0003).
  2143     05  PTHRHDGO PIC  X(0010).
  2144*    -------------------------------
  2145     05  FILLER            PIC  X(0003).
  2146     05  PDTHRUO PIC  X(0008).
  2147*    -------------------------------
  2148     05  FILLER            PIC  X(0003).
  2149     05  PDAMTO PIC  Z(06).99.
  2150*    -------------------------------
  2151     05  FILLER            PIC  X(0003).
  2152     05  NODAYSO PIC  ZZZ99.
  2153*    -------------------------------
  2154     05  FILLER            PIC  X(0003).
  2155     05  NOPMTSO PIC  ZZ99.
  2156*    -------------------------------
  2157     05  FILLER            PIC  X(0003).
  2158     05  FORMTYPO PIC  X(0001).
  2159*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  42
* EL131.cbl
  2160     05  FILLER            PIC  X(0003).
  2161     05  ESTO PIC  X(0008).
  2162*    -------------------------------
  2163     05  FILLER            PIC  X(0003).
  2164     05  AUIDO PIC  X(0004).
  2165*    -------------------------------
  2166     05  FILLER            PIC  X(0003).
  2167     05  OCCO PIC  X(0006).
  2168*    -------------------------------
  2169     05  FILLER            PIC  X(0003).
  2170     05  MNTDTO PIC  X(0008).
  2171*    -------------------------------
  2172     05  FILLER            PIC  X(0003).
  2173     05  MNTTYPEO PIC  X(0006).
  2174*    -------------------------------
  2175     05  FILLER            PIC  X(0003).
  2176     05  CERTCARO PIC  X(0001).
  2177*    -------------------------------
  2178     05  FILLER            PIC  X(0003).
  2179     05  CERTGRPO PIC  X(0006).
  2180*    -------------------------------
  2181     05  FILLER            PIC  X(0003).
  2182     05  CERTSTO PIC  X(0002).
  2183*    -------------------------------
  2184     05  FILLER            PIC  X(0003).
  2185     05  CERTACTO PIC  X(0010).
  2186*    -------------------------------
  2187     05  FILLER            PIC  X(0003).
  2188     05  CERTEFFO PIC  X(0008).
  2189*    -------------------------------
  2190     05  FILLER            PIC  X(0003).
  2191     05  ISSAGEO PIC  X(0002).
  2192*    -------------------------------
  2193     05  FILLER            PIC  X(0003).
  2194     05  APRO PIC  9(3).9(4).
  2195*    -------------------------------
  2196     05  FILLER            PIC  X(0003).
  2197     05  PMTFREQO PIC  99.
  2198*    -------------------------------
  2199     05  FILLER            PIC  X(0003).
  2200     05  INDGRPO PIC  X(0001).
  2201*    -------------------------------
  2202     05  FILLER            PIC  X(0003).
  2203     05  PREMTYPO PIC  X(0001).
  2204*    -------------------------------
  2205     05  FILLER            PIC  X(0003).
  2206     05  REINCDO PIC  X(0001).
  2207*    -------------------------------
  2208     05  FILLER            PIC  X(0003).
  2209     05  JNTLNMEO PIC  X(0015).
  2210*    -------------------------------
  2211     05  FILLER            PIC  X(0003).
  2212     05  JNTFNMEO PIC  X(0012).
  2213*    -------------------------------
  2214     05  FILLER            PIC  X(0003).
  2215     05  JNTINITO PIC  X(0001).
  2216*    -------------------------------
  2217     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  43
* EL131.cbl
  2218     05  JNTAGEO PIC  X(0002).
  2219*    -------------------------------
  2220     05  FILLER            PIC  X(0003).
  2221     05  ADDONDTO PIC  X(0008).
  2222*    -------------------------------
  2223     05  FILLER            PIC  X(0003).
  2224     05  LCVDSCRO PIC  X(0006).
  2225*    -------------------------------
  2226     05  FILLER            PIC  X(0003).
  2227     05  LCVKINDO PIC  X(0003).
  2228*    -------------------------------
  2229     05  FILLER            PIC  X(0003).
  2230     05  LCVCDO PIC  X(0002).
  2231*    -------------------------------
  2232     05  FILLER            PIC  X(0003).
  2233     05  LCVOTRMO PIC  999.
  2234*    -------------------------------
  2235     05  FILLER            PIC  X(0003).
  2236     05  LCVRTRMO PIC  999.
  2237*    -------------------------------
  2238     05  FILLER            PIC  X(0003).
  2239     05  LCVRATEO PIC  ZZZ.ZZ.
  2240*    -------------------------------
  2241     05  FILLER            PIC  X(0003).
  2242     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2243*    -------------------------------
  2244     05  FILLER            PIC  X(0003).
  2245     05  LCVFORMO PIC  X(0012).
  2246*    -------------------------------
  2247     05  FILLER            PIC  X(0003).
  2248     05  LCVCNDTO PIC  X(0008).
  2249*    -------------------------------
  2250     05  FILLER            PIC  X(0003).
  2251     05  LCVEXITO PIC  X(0008).
  2252*    -------------------------------
  2253     05  FILLER            PIC  X(0003).
  2254     05  LCVSTATO PIC  X(0006).
  2255*    -------------------------------
  2256     05  FILLER            PIC  X(0003).
  2257     05  ACVDSCRO PIC  X(0006).
  2258*    -------------------------------
  2259     05  FILLER            PIC  X(0003).
  2260     05  ACVKINDO PIC  X(0003).
  2261*    -------------------------------
  2262     05  FILLER            PIC  X(0003).
  2263     05  ACVCDO PIC  X(0002).
  2264*    -------------------------------
  2265     05  FILLER            PIC  X(0003).
  2266     05  ACVOTRMO PIC  999.
  2267*    -------------------------------
  2268     05  FILLER            PIC  X(0003).
  2269     05  ACVRTRMO PIC  999.
  2270*    -------------------------------
  2271     05  FILLER            PIC  X(0003).
  2272     05  ACVRATEO PIC  ZZZ.ZZ.
  2273*    -------------------------------
  2274     05  FILLER            PIC  X(0003).
  2275     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  44
* EL131.cbl
  2276*    -------------------------------
  2277     05  FILLER            PIC  X(0003).
  2278     05  ACVFORMO PIC  X(0012).
  2279*    -------------------------------
  2280     05  FILLER            PIC  X(0003).
  2281     05  ACVCNDTO PIC  X(0008).
  2282*    -------------------------------
  2283     05  FILLER            PIC  X(0003).
  2284     05  ACVEXITO PIC  X(0008).
  2285*    -------------------------------
  2286     05  FILLER            PIC  X(0003).
  2287     05  ACVSTATO PIC  X(0006).
  2288*    -------------------------------
  2289     05  FILLER            PIC  X(0003).
  2290     05  LABEL2O PIC  X(0014).
  2291*    -------------------------------
  2292     05  FILLER            PIC  X(0003).
  2293     05  BCERT1O PIC  X(0010).
  2294*    -------------------------------
  2295     05  FILLER            PIC  X(0003).
  2296     05  BSUFX1O PIC  X(0001).
  2297*    -------------------------------
  2298     05  FILLER            PIC  X(0003).
  2299     05  BCERT2O PIC  X(0010).
  2300*    -------------------------------
  2301     05  FILLER            PIC  X(0003).
  2302     05  BSUFX2O PIC  X(0001).
  2303*    -------------------------------
  2304     05  FILLER            PIC  X(0003).
  2305     05  BCERT3O PIC  X(0010).
  2306*    -------------------------------
  2307     05  FILLER            PIC  X(0003).
  2308     05  BSUFX3O PIC  X(0001).
  2309*    -------------------------------
  2310     05  FILLER            PIC  X(0003).
  2311     05  BCERT4O PIC  X(0010).
  2312*    -------------------------------
  2313     05  FILLER            PIC  X(0003).
  2314     05  BSUFX4O PIC  X(0001).
  2315*    -------------------------------
  2316     05  FILLER            PIC  X(0003).
  2317     05  BCERT5O PIC  X(0010).
  2318*    -------------------------------
  2319     05  FILLER            PIC  X(0003).
  2320     05  BSUFX5O PIC  X(0001).
  2321*    -------------------------------
  2322     05  FILLER            PIC  X(0003).
  2323     05  MSG1O PIC  X(0072).
  2324*    -------------------------------
  2325     05  FILLER            PIC  X(0003).
  2326     05  MSG2O PIC  X(0072).
  2327*    -------------------------------
  2328     05  FILLER            PIC  X(0003).
  2329     05  PFKEYO PIC  X(0002).
  2330*    -------------------------------
  2331     05  FILLER            PIC  X(0003).
  2332     05  PFKEY6O PIC  X(0016).
  2333*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  45
* EL131.cbl
  2334
  2335*                                COPY ELCEMIB SUPPRESS.
  2336******************************************************************
  2337*                                                                *
  2338*                                                                *
  2339*                            ELCEMIB.                            *
  2340*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2341*                            VMOD=2.005                          *
  2342*                                                                *
  2343*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2344*                                                                *
  2345******************************************************************
  2346 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2347     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2348     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2349     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2350     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2351     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2352     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2353     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2354     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2355     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2356         88  EMI-NO-ERRORS                    VALUE '1'.
  2357         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2358         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2359     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2360         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2361     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2362         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2363         88  EMI-AREA1-FULL                   VALUE '2'.
  2364     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2365         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2366         88  EMI-AREA2-FULL                   VALUE '2'.
  2367     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2368         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2369         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2370         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2371         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2372         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2373     12  EMI-ERROR-LINES.
  2374         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2375         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2376         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2377         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2378             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2379                 24  EMI-ERR-NUM         PIC X(4).
  2380                 24  EMI-FILLER          PIC X.
  2381                 24  EMI-SEV             PIC X.
  2382                 24  FILLER              PIC X.
  2383             20  FILLER                  PIC X(02).
  2384     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2385         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2386             20  EMI-ERROR-NUMBER    PIC X(4).
  2387             20  EMI-FILL            PIC X.
  2388             20  EMI-SEVERITY        PIC X.
  2389             20  FILLER              PIC X.
  2390             20  EMI-ERROR-TEXT.
  2391                 24  EMI-TEXT-VARIABLE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  46
* EL131.cbl
  2392                 24  FILLER          PIC X(55).
  2393     12  EMI-SEVERITY-SAVE           PIC X.
  2394         88  EMI-NOTE                    VALUE 'N'.
  2395         88  EMI-WARNING                 VALUE 'W'.
  2396         88  EMI-FORCABLE                VALUE 'F'.
  2397         88  EMI-FATAL                   VALUE 'X'.
  2398     12  EMI-MESSAGE-FLAG            PIC X.
  2399         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2400         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2401     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2402     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2403         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2404         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2405         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2406     12  emi-claim-no                pic x(7).
  2407     12  emi-claim-type              pic x(6).
  2408     12  FILLER                      PIC X(124)  VALUE SPACES.
  2409     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2410     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2411     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2412     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2413
  2414*                                COPY ELCJPFX SUPPRESS.
  2415******************************************************************
  2416*                                                                *
  2417*                                                                *
  2418*                            ELCJPFX.                            *
  2419*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2420*                            VMOD=2.002                          *
  2421*                                                                *
  2422*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2423*                                                                *
  2424*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2425*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2426*        ELCNTL - CONTROL FILE                                   *
  2427*        ELMSTR - CLAIM MASTERS                                  *
  2428*        ELTRLR - ACTIVITY TRAILERS                              *
  2429*        ELCHKQ - CHECK QUE                                      *
  2430******************************************************************
  2431 01  JOURNAL-RECORD.
  2432     12  jp-date                     pic s9(5) comp-3.
  2433     12  jp-time                     pic s9(7) comp-3.
  2434     12  JP-USER-ID                  PIC X(4).
  2435     12  JP-FILE-ID                  PIC X(8).
  2436     12  JP-PROGRAM-ID               PIC X(8).
  2437     12  JP-RECORD-TYPE              PIC X.
  2438         88 JP-ADD              VALUE 'A'.
  2439         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2440         88 JP-AFTER-CHANGE     VALUE 'C'.
  2441         88 JP-DELETE           VALUE 'D'.
  2442         88 JP-GENERIC-DELETE   VALUE 'G'.
  2443         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2444         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2445     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2446     12  JP-RECORD-AREA
  2447
  2448
  2449                                 PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  47
* EL131.cbl
  2450
  2451*                                COPY ELCCALC.
  2452******************************************************************
  2453*                                                                *
  2454*                           ELCCALC.                            *
  2455*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2456*                            VMOD=2.025                          *
  2457*                                                                *
  2458*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2459*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2460*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2461*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2462*                                                                *
  2463*  PASSED TO ELRTRM                                              *
  2464*  -----------------                                             *
  2465*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2466*  ORIGINAL TERM                                                 *
  2467*  BEGINNING DATE                                                *
  2468*  ENDING DATE                                                   *
  2469*  COMPANY I.D.                                                  *
  2470*  ACCOUNT MASTER USER FIELD                                     *
  2471*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2472*  FREE LOOK DAYS                                                *
  2473*                                                                *
  2474*  RETURNED FROM ELRTRM                                          *
  2475*  ---------------------                                         *
  2476*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2477*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2478*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2479*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2480*----------------------------------------------------------------*
  2481*  PASSED TO ELRAMT                                              *
  2482*  ----------------                                              *
  2483*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2484*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2485*  ORIGINAL AMOUNT                                               *
  2486*  ALTERNATE BENEFIT (BALLON)                                    *
  2487*  A.P.R. - NET PAY ONLY                                         *
  2488*  METHOD
  2489*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2490*  COMPANY I.D.                                                  *
  2491*  BENEFIT TYPE                                                  *
  2492*                                                                *
  2493*  RETURNED FROM ELRAMT                                          *
  2494*  --------------------                                          *
  2495*  REMAINING AMOUNT 1 - CURRENT                                  *
  2496*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2497*  REMAINING AMOUNT FACTOR
  2498*----------------------------------------------------------------*
  2499*  PASSED TO ELRESV                                              *
  2500*  -----------------                                             *
  2501*  CERTIFICATE EFFECTIVE DATE                                    *
  2502*  VALUATION DATE                                                *
  2503*  PAID THRU DATE                                                *
  2504*  BENEFIT                                                       *
  2505*  INCURRED DATE                                                 *
  2506*  REPORTED DATE                                                 *
  2507*  ISSUE AGE                                                     *
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  48
* EL131.cbl
  2508*  TERM                                                          *
  2509*  CDT PERCENT                                                   *
  2510*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2511* *CLAIM TYPE (LIFE, A/H)                                        *
  2512* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2513* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2514*                                                                *
  2515*  RETURNED FROM ELRESV                                          *
  2516*  --------------------                                          *
  2517*  CDT TABLE USED                                                *
  2518*  CDT FACTOR USED                                               *
  2519*  PAY TO CURRENT RESERVE                                        *
  2520*  I.B.N.R. - A/H ONLY                                           *
  2521*  FUTURE (ACCRUED) AH ONLY                                      *
  2522*----------------------------------------------------------------*
  2523*  PASSED TO ELRATE                                              *
  2524*  ----------------                                              *
  2525*  CERT ISSUE DATE                                               *
  2526*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2527*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2528*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2529*  STATE CODE (CLIENT DEFINED)                                   *
  2530*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2531*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2532*  DEVIATION CODE                                                *
  2533*  ISSUE AGE                                                     *
  2534*  ORIGINAL BENEFIT AMOUNT                                       *
  2535*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2536*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2537*  BENEFIT KIND (LIFE OR A/H)                                    *
  2538*  A.P.R.                                                        *
  2539*  METHOD
  2540*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2541*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2542*  COMPANY I.D. (3 CHARACTER)                                    *
  2543*  BENEFIT CODE                                                  *
  2544*  BENEFIT OVERRIDE CODE                                         *
  2545*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2546*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2547*  JOINT INDICATOR (CSL ONLY)                                    *
  2548*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2549*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2550*                                                                *
  2551*  RETURNED FROM ELRATE                                          *
  2552*  --------------------                                          *
  2553*  CALCULATED PREMIUM                                            *
  2554*  PREMIUM RATE                                                  *
  2555*  MORTALITY CODE                                                *
  2556*  MAX ATTAINED AGE                                              *
  2557*  MAX AGE                                                       *
  2558*  MAX TERM                                                      *
  2559*  MAX MONTHLY BENEFIT                                           *
  2560*  MAX TOTAL BENIFIT                                             *
  2561*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2562*----------------------------------------------------------------*
  2563*  PASSED TO ELRFND                                              *
  2564*  ----------------                                              *
  2565*  CERT ISSUE DATE                                               *
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  49
* EL131.cbl
  2566*  REFUND DATE                                                   *
  2567*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2568*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2569*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2570*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2571*  STATE CODE (CLIENT DEFINED)                                   *
  2572*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2573*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2574*  DEVIATION CODE                                                *
  2575*  ISSUE AGE                                                     *
  2576*  ORIGINAL BENEFIT AMOUNT                                       *
  2577*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2578*  PROCESS TYPE (CANCEL)                                         *
  2579*  BENEFIT KIND (LIFE OR A/H)                                    *
  2580*  A.P.R.                                                        *
  2581*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2582*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2583*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2584*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2585*  COMPANY I.D. (3 CHARACTER)                                    *
  2586*  BENEFIT CODE                                                  *
  2587*  BENEFIT OVERRIDE CODE                                         *
  2588*                                                                *
  2589*  RETURNED FROM ELRFND                                          *
  2590*  --------------------                                          *
  2591*  CALCULATED REFUND                                             *
  2592*----------------------------------------------------------------*
  2593*  PASSED TO ELEARN                                              *
  2594*  ----------------                                              *
  2595*  CERT ISSUE DATE                                               *
  2596*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2597*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2598*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2599*  STATE CODE (CLIENT DEFINED)                                   *
  2600*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2601*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2602*  DEVIATION CODE                                                *
  2603*  ISSUE AGE                                                     *
  2604*  ORIGINAL BENEFIT AMOUNT                                       *
  2605*  BENEFIT KIND (LIFE OR A/H)                                    *
  2606*  A.P.R.                                                        *
  2607*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2608*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2609*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2610*  COMPANY I.D. (3 CHARACTER)                                    *
  2611*  BENEFIT CODE                                                  *
  2612*  BENEFIT OVERRIDE CODE                                         *
  2613*                                                                *
  2614*  RETURNED FROM ELEARN                                          *
  2615*  --------------------                                          *
  2616*  INDICATED  EARNINGS                                           *
  2617*----------------------------------------------------------------*
  2618*                 LENGTH = 450                                   *
  2619*                                                                *
  2620******************************************************************
  2621******************************************************************
  2622*                   C H A N G E   L O G
  2623*
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  50
* EL131.cbl
  2624* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2625*-----------------------------------------------------------------
  2626*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2627* EFFECTIVE    NUMBER
  2628*-----------------------------------------------------------------
  2629* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2630* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2631* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2632* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2633* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2634* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2635* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2636* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2637* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2638******************************************************************
  2639
  2640 01  CALCULATION-PASS-AREA.
  2641     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2642                                     COMP.
  2643
  2644     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2645       88  NO-CP-ERROR                             VALUE ZERO.
  2646       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2647                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2648       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2649       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2650       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2651       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2652       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2653       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2654       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2655       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2656       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2657       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2658       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2659       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2660       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2661       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2662       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2663       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2664       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2665
  2666     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2667       88  NO-CP-ERROR-2                           VALUE ZERO.
  2668***********************  INPUT AREAS ****************************
  2669
  2670     12  CP-CALCULATION-AREA.
  2671         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2672         16  CP-CERT-EFF-DT        PIC XX.
  2673         16  CP-VALUATION-DT       PIC XX.
  2674         16  CP-PAID-THRU-DT       PIC XX.
  2675         16  CP-BENEFIT-TYPE       PIC X.
  2676           88  CP-AH                               VALUE 'A' 'D'
  2677                                                   'I' 'U'.
  2678           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2679           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2680         16  CP-INCURRED-DT        PIC XX.
  2681         16  CP-REPORTED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  51
* EL131.cbl
  2682         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2683         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2684         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2685                                     COMP-3.
  2686         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2687                                     COMP-3.
  2688         16  CP-CDT-METHOD         PIC X.
  2689           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2690           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2691           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2692         16  CP-CLAIM-TYPE         PIC X.
  2693           88  CP-AH-CLAIM                         VALUE 'A'.
  2694           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2695         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2696                                     COMP-3.
  2697         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2698                                     COMP-3.
  2699         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2700                                     COMP-3.
  2701         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2702                                     COMP-3.
  2703         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2704                                     COMP-3.
  2705         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2706                                     COMP-3.
  2707         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2708                                     COMP-3.
  2709         16  CP-REM-TERM-METHOD    PIC X.
  2710           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2711           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2712           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2713           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2714           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2715           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2716           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2717         16  CP-EARNING-METHOD     PIC X.
  2718           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2719           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2720           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2721           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2722           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2723           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2724           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2725           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2726           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2727           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2728           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2729           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2730           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2731           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2732         16  CP-PROCESS-TYPE       PIC X.
  2733           88  CP-CLAIM                            VALUE '1'.
  2734           88  CP-CANCEL                           VALUE '2'.
  2735           88  CP-ISSUE                            VALUE '3'.
  2736         16  CP-SPECIAL-CALC-CD    PIC X.
  2737           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2738           88  CP-1-MTH-INTEREST               VALUE ' '.
  2739           88  CP-0-MTH-INTEREST               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  52
* EL131.cbl
  2740           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2741           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2742           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2743           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2744           88  CP-FARM-PLAN                    VALUE 'F'.
  2745           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2746           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2747           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2748           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2749           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2750           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2751           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2752           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2753           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2754           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2755                                                     'W' 'X'.
  2756           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2757           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2758           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2759           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2760           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2761           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2762           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2763           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2764           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2765           88  CP-CSL-METH-1                   VALUE '5'.
  2766           88  CP-CSL-METH-2                   VALUE '6'.
  2767           88  CP-CSL-METH-3                   VALUE '7'.
  2768           88  CP-CSL-METH-4                   VALUE '8'.
  2769
  2770         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2771                                     COMP-3.
  2772         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2773         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2774         16  CP-STATE              PIC XX          VALUE SPACE.
  2775         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2776         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2777           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2778               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2779         16  CP-R78-OPTION         PIC X.
  2780           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2781           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2782
  2783         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2784         16  CP-IBNR-RESERVE-SW    PIC X.
  2785         16  CP-CLAIM-STATUS       PIC X.
  2786         16  CP-RATE-FILE          PIC X.
  2787         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2788                                     COMP-3.
  2789
  2790         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2791         16  CP-AH-OVERRIDE-CODE   PIC X.
  2792
  2793         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2794                                     COMP-3.
  2795         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2796                                   PIC S9(5)V99 COMP-3.
  2797         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  53
* EL131.cbl
  2798                                     COMP-3.
  2799         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2800                                     COMP-3.
  2801         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2802                                     COMP-3.
  2803         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2804                                  PIC S9(7)V99 COMP-3.
  2805
  2806         16  CP-PAID-FROM-DATE     PIC X(02).
  2807         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2808         16  CP-EXT-DAYS-CALC      PIC X.
  2809           88  CP-EXT-NO-CHG                   VALUE ' '.
  2810           88  CP-EXT-CHG-LF                   VALUE '1'.
  2811           88  CP-EXT-CHG-AH                   VALUE '2'.
  2812           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2813         16  CP-DOMICILE-STATE     PIC XX.
  2814         16  CP-CARRIER            PIC X.
  2815         16  CP-REIN-FLAG          PIC X.
  2816         16  CP-REM-TRM-CALC-OPTION PIC X.
  2817           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2818                      '2' '3' '4' '5'.
  2819           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2820           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2821           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2822           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2823           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2824           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2825           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2826           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2827         16  CP-SIG-SWITCH         PIC X.
  2828         16  CP-RATING-METHOD      PIC X.
  2829           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2830           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2831           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2832           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2833           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2834           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2835           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2836           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2837           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2838         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2839                                     COMP-3.
  2840         16  CP-BEN-CATEGORY       PIC X.
  2841         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2842         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2843                                   PIC S99V9(5) COMP-3.
  2844         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2845         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2846                                   PIC S99V9(5) COMP-3.
  2847         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2848         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2849         16  CP-EXPIRE-DT          PIC XX.
  2850         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2851         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2852         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2853         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2854         16  CP-DDF-SPEC-CALC      PIC X.
  2855             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  54
* EL131.cbl
  2856             88  CP-CALC-CLP              VALUE 'C'.
  2857         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2858         16  CP-CANCEL-REASON      PIC X.
  2859         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2860         16  CP-PMT-MODE           PIC X.
  2861         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2862         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2863         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2864         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2865         16  FILLER                PIC X.
  2866
  2867***************    OUTPUT FROM ELRESV   ************************
  2868
  2869         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2870
  2871         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2872                                     COMP-3.
  2873         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2874                                     COMP-3.
  2875         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2876                                     COMP-3.
  2877         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2878                                     COMP-3.
  2879         16  FILLER                PIC X(09).
  2880***************    OUTPUT FROM ELRTRM   *************************
  2881
  2882         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2883                                     COMP-3.
  2884         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2885                                     COMP-3.
  2886         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2887                                     COMP-3.
  2888         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2889                                     COMP-3.
  2890         16  FILLER                PIC X(12).
  2891
  2892***************    OUTPUT FROM ELRAMT   *************************
  2893
  2894         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2895                                     COMP-3.
  2896         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2897                                     COMP-3.
  2898         16  FILLER                PIC X(12).
  2899
  2900***************    OUTPUT FROM ELRATE   *************************
  2901
  2902         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2903                                     COMP-3.
  2904         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2905                                     COMP-3.
  2906         16  CP-MORTALITY-CODE     PIC X(4).
  2907         16  CP-RATE-EDIT-FLAG     PIC X.
  2908             88  CP-RATES-NEED-APR                  VALUE '1'.
  2909         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2910                                     COMP-3.
  2911         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2912         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2913         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  55
* EL131.cbl
  2914                                   PIC S9(7)V99 COMP-3.
  2915         16  FILLER                PIC X(07).
  2916
  2917***************    OUTPUT FROM ELRFND   *************************
  2918
  2919         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2920                                     COMP-3.
  2921         16  CP-REFUND-TYPE-USED   PIC X.
  2922           88  CP-R-AS-R78                         VALUE '1'.
  2923           88  CP-R-AS-PRORATA                     VALUE '2'.
  2924           88  CP-R-AS-CALIF                       VALUE '3'.
  2925           88  CP-R-AS-TEXAS                       VALUE '4'.
  2926           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2927           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2928           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2929           88  CP-R-AS-MEAN                        VALUE '8'.
  2930           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2931           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2932           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2933           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2934           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2935           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2936         16  FILLER                PIC X(12).
  2937
  2938***************    OUTPUT FROM ELEARN   *************************
  2939
  2940         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2941                                     COMP-3.
  2942         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2943                                     COMP-3.
  2944         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2945                                     COMP-3.
  2946         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2947                                     COMP-3.
  2948         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2949                                     COMP-3.
  2950         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2951                                     COMP-3.
  2952         16  CP-EARNING-TYPE-USED  PIC X.
  2953           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2954           88  CP-E-AS-R78                         VALUE '1'.
  2955           88  CP-E-AS-PRORATA                     VALUE '2'.
  2956           88  CP-E-AS-TEXAS                       VALUE '4'.
  2957           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2958           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2959           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2960           88  CP-E-AS-MEAN                        VALUE '8'.
  2961           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2962         16  FILLER                PIC X(12).
  2963
  2964***************    OUTPUT FROM ELPMNT   *************************
  2965
  2966         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2967                                     COMP-3.
  2968         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2969                                     COMP-3.
  2970         16  FILLER                PIC X(12).
  2971
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  56
* EL131.cbl
  2972***************   MISC WORK AREAS    *****************************
  2973         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2974                                     COMP-3.
  2975         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2976                                     COMP-3.
  2977         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2978                                     COMP-3.
  2979         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2980                                     COMP-3.
  2981         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2982                                     COMP-3.
  2983         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2984                                     COMP-3.
  2985         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2986             88  OPEN-RATE-FILE                   VALUE 'O'.
  2987             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2988             88  IO-ERROR                         VALUE 'E'.
  2989
  2990         16  CP-FIRST-PAY-DATE     PIC XX.
  2991
  2992         16  CP-JOINT-INDICATOR    PIC X.
  2993
  2994         16  CP-RESERVE-REMAINING-TERM
  2995                                   PIC S9(4)V9    VALUE ZERO
  2996                                     COMP-3.
  2997
  2998         16  CP-INSURED-BIRTH-DT   PIC XX.
  2999
  3000         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3001                                     COMP-3.
  3002
  3003         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3004                                     COMP-3.
  3005
  3006         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3007                                     COMP-3.
  3008
  3009         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3010                                     COMP-3.
  3011
  3012         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3013                                     COMP-3.
  3014
  3015         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3016                                     COMP-3.
  3017
  3018         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3019                                     COMP-3.
  3020
  3021         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3022             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3023
  3024         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3025                                     COMP-3.
  3026         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3027                                     COMP-3.
  3028         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3029         16  FILLER                PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  57
* EL131.cbl
  3030******************************************************************
  3031
  3032*                                COPY ELCDATE.
  3033******************************************************************
  3034*                                                                *
  3035*                                                                *
  3036*                            ELCDATE.                            *
  3037*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3038*                            VMOD=2.003
  3039*                                                                *
  3040*                                                                *
  3041*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3042*                 LENGTH = 200                                   *
  3043******************************************************************
  3044
  3045 01  DATE-CONVERSION-DATA.
  3046     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3047     12  DC-OPTION-CODE                PIC X.
  3048         88  BIN-TO-GREG                VALUE ' '.
  3049         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3050         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3051         88  YMD-GREG-TO-BIN            VALUE '3'.
  3052         88  MDY-GREG-TO-BIN            VALUE '4'.
  3053         88  JULIAN-TO-BIN              VALUE '5'.
  3054         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3055         88  FIND-CENTURY               VALUE '7'.
  3056         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3057         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3058         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3059         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3060         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3061         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3062         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3063         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3064         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3065         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3066         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3067         88  BIN-3-TO-GREG              VALUE 'I'.
  3068         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3069         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3070         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3071         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3072         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3073         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3074         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3075         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3076         88  THREE-CHARACTER-BIN
  3077                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3078         88  GREGORIAN-TO-BIN
  3079                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3080         88  BIN-TO-GREGORIAN
  3081                  VALUES ' ' '1' 'I' '8' 'G'.
  3082         88  JULIAN-TO-BINARY
  3083                  VALUES '5' 'C' 'E' 'F'.
  3084     12  DC-ERROR-CODE                 PIC X.
  3085         88  NO-CONVERSION-ERROR        VALUE ' '.
  3086         88  DATE-CONVERSION-ERROR
  3087                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  58
* EL131.cbl
  3088         88  DATE-IS-ZERO               VALUE '1'.
  3089         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3090         88  DATE-IS-INVALID            VALUE '3'.
  3091         88  DATE1-GREATER-DATE2        VALUE '4'.
  3092         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3093         88  DATE-INVALID-OPTION        VALUE '9'.
  3094         88  INVALID-CENTURY            VALUE 'A'.
  3095         88  ONLY-CENTURY               VALUE 'B'.
  3096         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3097         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3098     12  DC-END-OF-MONTH               PIC X.
  3099         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3100     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3101         88  USE-NORMAL-PROCESS         VALUE ' '.
  3102         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3103         88  ADJUST-UP-100-YRS          VALUE '2'.
  3104     12  FILLER                        PIC X.
  3105     12  DC-CONVERSION-DATES.
  3106         16  DC-BIN-DATE-1             PIC XX.
  3107         16  DC-BIN-DATE-2             PIC XX.
  3108         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3109         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3110                       DC-GREG-DATE-1-EDIT.
  3111             20  DC-EDIT1-MONTH        PIC 99.
  3112             20  SLASH1-1              PIC X.
  3113             20  DC-EDIT1-DAY          PIC 99.
  3114             20  SLASH1-2              PIC X.
  3115             20  DC-EDIT1-YEAR         PIC 99.
  3116         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3117         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3118                     DC-GREG-DATE-2-EDIT.
  3119             20  DC-EDIT2-MONTH        PIC 99.
  3120             20  SLASH2-1              PIC X.
  3121             20  DC-EDIT2-DAY          PIC 99.
  3122             20  SLASH2-2              PIC X.
  3123             20  DC-EDIT2-YEAR         PIC 99.
  3124         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3125         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3126                     DC-GREG-DATE-1-YMD.
  3127             20  DC-YMD-YEAR           PIC 99.
  3128             20  DC-YMD-MONTH          PIC 99.
  3129             20  DC-YMD-DAY            PIC 99.
  3130         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3131         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3132                      DC-GREG-DATE-1-MDY.
  3133             20  DC-MDY-MONTH          PIC 99.
  3134             20  DC-MDY-DAY            PIC 99.
  3135             20  DC-MDY-YEAR           PIC 99.
  3136         16  DC-GREG-DATE-1-ALPHA.
  3137             20  DC-ALPHA-MONTH        PIC X(10).
  3138             20  DC-ALPHA-DAY          PIC 99.
  3139             20  FILLER                PIC XX.
  3140             20  DC-ALPHA-CENTURY.
  3141                 24 DC-ALPHA-CEN-N     PIC 99.
  3142             20  DC-ALPHA-YEAR         PIC 99.
  3143         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3144         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3145         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  59
* EL131.cbl
  3146         16  DC-JULIAN-DATE            PIC 9(05).
  3147         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3148                                       PIC 9(05).
  3149         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3150             20  DC-JULIAN-YEAR        PIC 99.
  3151             20  DC-JULIAN-DAYS        PIC 999.
  3152         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3153         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3154         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3155     12  DATE-CONVERSION-VARIBLES.
  3156         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3157         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3158             20  FILLER                PIC 9(3).
  3159             20  HOLD-CEN-1-CCYY.
  3160                 24  HOLD-CEN-1-CC     PIC 99.
  3161                 24  HOLD-CEN-1-YY     PIC 99.
  3162             20  HOLD-CEN-1-MO         PIC 99.
  3163             20  HOLD-CEN-1-DA         PIC 99.
  3164         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3165             20  HOLD-CEN-1-R-MO       PIC 99.
  3166             20  HOLD-CEN-1-R-DA       PIC 99.
  3167             20  HOLD-CEN-1-R-CCYY.
  3168                 24  HOLD-CEN-1-R-CC   PIC 99.
  3169                 24  HOLD-CEN-1-R-YY   PIC 99.
  3170             20  FILLER                PIC 9(3).
  3171         16  HOLD-CENTURY-1-X.
  3172             20  FILLER                PIC X(3)  VALUE SPACES.
  3173             20  HOLD-CEN-1-X-CCYY.
  3174                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3175                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3176             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3177             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3178         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3179             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3180             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3181             20  HOLD-CEN-1-R-X-CCYY.
  3182                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3183                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3184             20  FILLER                PIC XXX.
  3185         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3186         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3187         16  DC-JULIAN-DATE-1          PIC 9(07).
  3188         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3189             20  DC-JULIAN-1-CCYY.
  3190                 24  DC-JULIAN-1-CC    PIC 99.
  3191                 24  DC-JULIAN-1-YR    PIC 99.
  3192             20  DC-JULIAN-DA-1        PIC 999.
  3193         16  DC-JULIAN-DATE-2          PIC 9(07).
  3194         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3195             20  DC-JULIAN-2-CCYY.
  3196                 24  DC-JULIAN-2-CC    PIC 99.
  3197                 24  DC-JULIAN-2-YR    PIC 99.
  3198             20  DC-JULIAN-DA-2        PIC 999.
  3199         16  DC-GREG-DATE-A-EDIT.
  3200             20  DC-EDITA-MONTH        PIC 99.
  3201             20  SLASHA-1              PIC X VALUE '/'.
  3202             20  DC-EDITA-DAY          PIC 99.
  3203             20  SLASHA-2              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  60
* EL131.cbl
  3204             20  DC-EDITA-CCYY.
  3205                 24  DC-EDITA-CENT     PIC 99.
  3206                 24  DC-EDITA-YEAR     PIC 99.
  3207         16  DC-GREG-DATE-B-EDIT.
  3208             20  DC-EDITB-MONTH        PIC 99.
  3209             20  SLASHB-1              PIC X VALUE '/'.
  3210             20  DC-EDITB-DAY          PIC 99.
  3211             20  SLASHB-2              PIC X VALUE '/'.
  3212             20  DC-EDITB-CCYY.
  3213                 24  DC-EDITB-CENT     PIC 99.
  3214                 24  DC-EDITB-YEAR     PIC 99.
  3215         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3216         16  DC-GREG-DATE-CYMD-R REDEFINES
  3217                              DC-GREG-DATE-CYMD.
  3218             20  DC-CYMD-CEN           PIC 99.
  3219             20  DC-CYMD-YEAR          PIC 99.
  3220             20  DC-CYMD-MONTH         PIC 99.
  3221             20  DC-CYMD-DAY           PIC 99.
  3222         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3223         16  DC-GREG-DATE-MDCY-R REDEFINES
  3224                              DC-GREG-DATE-MDCY.
  3225             20  DC-MDCY-MONTH         PIC 99.
  3226             20  DC-MDCY-DAY           PIC 99.
  3227             20  DC-MDCY-CEN           PIC 99.
  3228             20  DC-MDCY-YEAR          PIC 99.
  3229    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3230        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3231    12  DC-EL310-DATE                  PIC X(21).
  3232    12  FILLER                         PIC X(28).
  3233
  3234*                                COPY ELCDMO.
  3235******************************************************************
  3236*                                                                *
  3237*                                                                *
  3238*                            ELCDMO.                             *
  3239*                            VMOD=2.004                          *
  3240*                                                                *
  3241*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3242*        COMMUNICATION AREA                                      *
  3243*   FILE TYPE = NA                                               *
  3244*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3245*                                                                *
  3246******************************************************************
  3247 01  DMO-COMMUNICATION-AREA.
  3248     12  DM-RECORD-TYPE                  PIC  X(02).
  3249             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3250             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3251             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3252     12  DM-DIST-CODE                    PIC  X(04).
  3253     12  DM-MAIL-CODE                    PIC  X(05).
  3254     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3255     12  DM-INSURED-NAME                 PIC  X(30).
  3256     12  DM-CLAIM-NO                     PIC  X(07).
  3257     12  DM-CLAIM-TYPE                   PIC  X.
  3258
  3259     12  DM-STATUS-DATA-AREA.
  3260         16  DM-CLAIM-STATUS             PIC  X.
  3261             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  61
* EL131.cbl
  3262             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3263             88  DM-CLOSED                        VALUE '3'.
  3264             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3265             88  DM-DEFAULT                       VALUE '9'.
  3266         16  DM-STATUS-DATE              PIC  X(08).
  3267******YYYYMMDD
  3268         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3269             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3270             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3271             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3272             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3273             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3274             88  DM-RE-OPENED                     VALUE 'R'.
  3275             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3276             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3277             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3278         16  DM-STAT-CARRIER             PIC X.
  3279
  3280     12  DM-DRAFT-DATA-AREA.
  3281         16  DM-PAYMENT-TYPE             PIC  X.
  3282             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3283         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3284         16  DM-PAYMENT-DATE             PIC  X(08).
  3285******YYYYMMDD
  3286         16  DM-CERT-NO                  PIC  X(11).
  3287         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3288         16  DM-CARRIER                  PIC  X.
  3289
  3290     12  DM-RETURN-CODE                  PIC  XX.
  3291*                                COPY ERCPDEF.
  3292******************************************************************
  3293*                                                                *
  3294*                                                                *
  3295*                            ERCPDEF.                            *
  3296*                                                                *
  3297*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3298*                                                                *
  3299*    FILE TYPE = VSAM,KSDS                                       *
  3300*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3301*                                                                *
  3302*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3303*                                                                *
  3304*    LOG = YES                                                   *
  3305*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3306******************************************************************
  3307*                   C H A N G E   L O G
  3308*
  3309* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3310*-----------------------------------------------------------------
  3311*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3312* EFFECTIVE    NUMBER
  3313*-----------------------------------------------------------------
  3314* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3315* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3316* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  3317******************************************************************
  3318 01  PRODUCT-MASTER.
  3319    12  PD-RECORD-ID                 PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  62
* EL131.cbl
  3320        88  VALID-PD-ID                  VALUE 'PD'.
  3321    12  PD-CONTROL-PRIMARY.
  3322        16  PD-COMPANY-CD            PIC X.
  3323        16  PD-STATE                 PIC XX.
  3324        16  PD-PRODUCT-CD            PIC XXX.
  3325        16  PD-FILLER                PIC X(7).
  3326        16  PD-BEN-TYPE              PIC X.
  3327        16  PD-BEN-CODE              PIC XX.
  3328        16  PD-PROD-EXP-DT           PIC XX.
  3329    12  FILLER                       PIC X(50).
  3330    12  PD-PRODUCT-DATA OCCURS 8.
  3331        16  PD-PROD-CODE             PIC X.
  3332            88  PD-PROD-LIFE           VALUE 'L'.
  3333            88  PD-PROD-PROP           VALUE 'P'.
  3334            88  PD-PROD-AH             VALUE 'A'.
  3335            88  PD-PROD-IU             VALUE 'I'.
  3336            88  PD-PROD-GAP            VALUE 'G'.
  3337            88  PD-PROD-FAML           VALUE 'F'.
  3338        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3339        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3340        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3341        16  PD-MAX-TERM              PIC S999        COMP-3.
  3342        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3343        16  FILLER                   PIC X.
  3344        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3345        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3346        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3347        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3348        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3349        16  PD-REC-CRIT-PERIOD       PIC 99.
  3350        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3351            20  PD-RECURRING-YN      PIC X.
  3352            20  FILLER               PIC X.
  3353        16  PD-RTW-MOS               PIC 99.
  3354        16  PD-MAX-EXTENSION         PIC 99.
  3355        16  pd-ben-pct               pic sv999 comp-3.
  3356*       16  FILLER                   PIC XX.
  3357    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3358    12  PD-TERM-LIMITS OCCURS 15.
  3359        16  PD-LOW-TERM              PIC S999        COMP-3.
  3360        16  PD-HI-TERM               PIC S999        COMP-3.
  3361*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3362    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3363        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3364        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3365    12  PD-EARN-FACTORS.
  3366        16  FILLER OCCURS 15.
  3367            20  FILLER OCCURS 15.
  3368                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3369    12  PD-PRODUCT-DESC              PIC X(80).
  3370    12  PD-TRUNCATED                 PIC X.
  3371    12  FILLER                       PIC X(59).
  3372    12  PD-MAINT-INFORMATION.
  3373        16  PD-LAST-MAINT-DT         PIC X(02).
  3374        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3375        16  PD-LAST-MAINT-BY         PIC X(04).
  3376*                                COPY ELCCRTT.
  3377******************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  63
* EL131.cbl
  3378*                                                                *
  3379*                            ELCCRTT.                            *
  3380*                                                                *
  3381*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3382*                                                                *
  3383*   FILE TYPE = VSAM,KSDS                                        *
  3384*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3385*                                                                *
  3386*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3387*                                                                *
  3388*   LOG = YES                                                    *
  3389*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3390******************************************************************
  3391*                   C H A N G E   L O G
  3392*
  3393* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3394*-----------------------------------------------------------------
  3395*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3396* EFFECTIVE    NUMBER
  3397*-----------------------------------------------------------------
  3398* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3399* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3400* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3401* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3402* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3403* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3404* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3405******************************************************************
  3406
  3407 01  CERTIFICATE-TRAILERS.
  3408     12  CS-RECORD-ID                      PIC XX.
  3409         88  VALID-CS-ID                      VALUE 'CS'.
  3410
  3411     12  CS-CONTROL-PRIMARY.
  3412         16  CS-COMPANY-CD                 PIC X.
  3413         16  CS-CARRIER                    PIC X.
  3414         16  CS-GROUPING                   PIC X(6).
  3415         16  CS-STATE                      PIC XX.
  3416         16  CS-ACCOUNT                    PIC X(10).
  3417         16  CS-CERT-EFF-DT                PIC XX.
  3418         16  CS-CERT-NO.
  3419             20  CS-CERT-PRIME             PIC X(10).
  3420             20  CS-CERT-SFX               PIC X.
  3421         16  CS-TRAILER-TYPE               PIC X.
  3422             88  COMM-TRLR           VALUE 'A'.
  3423             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3424             88  CERT-DATA-TRLR      VALUE 'C'.
  3425
  3426     12  CS-DATA-AREA                      PIC X(516).
  3427
  3428     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3429         16  CS-BANK-COMMISSION-AREA.
  3430             20  CS-BANK-COMMS       OCCURS 10.
  3431                 24  CS-AGT                PIC X(10).
  3432                 24  CS-COM-TYP            PIC X.
  3433                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3434                 24  CS-RECALC-LV-INDIC    PIC X.
  3435                 24  FILLER                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  64
* EL131.cbl
  3436         16  FILLER                        PIC X(256).
  3437
  3438     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3439****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3440         16  CS-MB-CLAIM-DATA OCCURS 24.
  3441             20  CS-CLAIM-NO               PIC X(7).
  3442             20  CS-CLAIM-TYPE             PIC X.
  3443                 88  CS-AH-CLM               VALUE 'A'.
  3444                 88  CS-IU-CLM               VALUE 'I'.
  3445                 88  CS-GP-CLM               VALUE 'G'.
  3446                 88  CS-LF-CLM               VALUE 'L'.
  3447                 88  CS-PR-CLM               VALUE 'P'.
  3448                 88  CS-FL-CLM               VALUE 'F'.
  3449             20  CS-INSURED-TYPE           PIC X.
  3450                 88  CS-PRIM-INSURED          VALUE 'P'.
  3451                 88  CS-CO-BORROWER           VALUE 'C'.
  3452             20  CS-BENEFIT-PERIOD         PIC 99.
  3453             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3454             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3455             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3456         16  FILLER                        PIC X(12).
  3457     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3458         16  CS-VIN-NUMBER                 PIC X(17).
  3459         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3460         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3461         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3462         16  FILLER                        PIC X(496).
  3463
  3464****************************************************************
  3465*
  3466* Copyright (c) 2007 by Clerity Solutions, Inc.
  3467* All rights reserved.
  3468*
  3469****************************************************************
  3470 01  DFHEIV.
  3471   02  DFHEIV0               PIC X(35).
  3472   02  DFHEIV1               PIC X(08).
  3473   02  DFHEIV2               PIC X(08).
  3474   02  DFHEIV3               PIC X(08).
  3475   02  DFHEIV4               PIC X(06).
  3476   02  DFHEIV5               PIC X(04).
  3477   02  DFHEIV6               PIC X(04).
  3478   02  DFHEIV7               PIC X(02).
  3479   02  DFHEIV8               PIC X(02).
  3480   02  DFHEIV9               PIC X(01).
  3481   02  DFHEIV10              PIC S9(7) COMP-3.
  3482   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3483   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3484   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3485   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3486   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3487   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3488   02  DFHEIV17              PIC X(04).
  3489   02  DFHEIV18              PIC X(04).
  3490   02  DFHEIV19              PIC X(04).
  3491   02  DFHEIV20              USAGE IS POINTER.
  3492   02  DFHEIV21              USAGE IS POINTER.
  3493   02  DFHEIV22              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  65
* EL131.cbl
  3494   02  DFHEIV23              USAGE IS POINTER.
  3495   02  DFHEIV24              USAGE IS POINTER.
  3496   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3497   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3498   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3499   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3500   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3501   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3502   02  FILLER                PIC X(02).
  3503   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3504   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3505   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3506   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3507   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3508 LINKAGE  SECTION.
  3509*****************************************************************
  3510*                                                               *
  3511* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3512* All rights reserved.                                          *
  3513*                                                               *
  3514*****************************************************************
  3515 01  dfheiblk.
  3516     02  eibtime          pic s9(7) comp-3.
  3517     02  eibdate          pic s9(7) comp-3.
  3518     02  eibtrnid         pic x(4).
  3519     02  eibtaskn         pic s9(7) comp-3.
  3520     02  eibtrmid         pic x(4).
  3521     02  dfheigdi         pic s9(4) comp.
  3522     02  eibcposn         pic s9(4) comp.
  3523     02  eibcalen         pic s9(4) comp.
  3524     02  eibaid           pic x(1).
  3525     02  eibfiller1       pic x(1).
  3526     02  eibfn            pic x(2).
  3527     02  eibfiller2       pic x(2).
  3528     02  eibrcode         pic x(6).
  3529     02  eibfiller3       pic x(2).
  3530     02  eibds            pic x(8).
  3531     02  eibreqid         pic x(8).
  3532     02  eibrsrce         pic x(8).
  3533     02  eibsync          pic x(1).
  3534     02  eibfree          pic x(1).
  3535     02  eibrecv          pic x(1).
  3536     02  eibsend          pic x(1).
  3537     02  eibatt           pic x(1).
  3538     02  eibeoc           pic x(1).
  3539     02  eibfmh           pic x(1).
  3540     02  eibcompl         pic x(1).
  3541     02  eibsig           pic x(1).
  3542     02  eibconf          pic x(1).
  3543     02  eiberr           pic x(1).
  3544     02  eibrldbk         pic x(1).
  3545     02  eiberrcd         pic x(4).
  3546     02  eibsynrb         pic x(1).
  3547     02  eibnodat         pic x(1).
  3548     02  eibfiller5       pic x(2).
  3549     02  eibresp          pic 9(09) comp.
  3550     02  eibresp2         pic 9(09) comp.
  3551     02  dfheigdj         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  66
* EL131.cbl
  3552     02  dfheigdk         pic s9(4) comp.
  3553 01  DFHCOMMAREA                 PIC X(1024).
  3554
  3555*                                COPY ELCMSTR.
  3556******************************************************************
  3557*                                                                *
  3558*                            ELCMSTR.                            *
  3559*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3560*                            VMOD=2.012                          *
  3561*                                                                *
  3562*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3563*                                                                *
  3564*   FILE TYPE = VSAM,KSDS                                        *
  3565*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3566*                                                                *
  3567*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3568*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3569*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3570*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3571*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3572*                                                 RKP=75,LEN=21  *
  3573*                                                                *
  3574*   **** NOTE ****                                               *
  3575*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3576*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3577*                                                                *
  3578*   LOG = YES                                                    *
  3579*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3580******************************************************************
  3581*                   C H A N G E   L O G
  3582*
  3583* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3584*-----------------------------------------------------------------
  3585*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3586* EFFECTIVE    NUMBER
  3587*-----------------------------------------------------------------
  3588* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3589* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3590* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3591* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3592* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3593******************************************************************
  3594 01  CLAIM-MASTER.
  3595     12  CL-RECORD-ID                PIC XX.
  3596         88  VALID-CL-ID         VALUE 'CL'.
  3597
  3598     12  CL-CONTROL-PRIMARY.
  3599         16  CL-COMPANY-CD           PIC X.
  3600         16  CL-CARRIER              PIC X.
  3601         16  CL-CLAIM-NO             PIC X(7).
  3602         16  CL-CERT-NO.
  3603             20  CL-CERT-PRIME       PIC X(10).
  3604             20  CL-CERT-SFX         PIC X.
  3605
  3606     12  CL-CONTROL-BY-NAME.
  3607         16  CL-COMPANY-CD-A1        PIC X.
  3608         16  CL-INSURED-LAST-NAME    PIC X(15).
  3609         16  CL-INSURED-NAME.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  67
* EL131.cbl
  3610             20  CL-INSURED-1ST-NAME PIC X(12).
  3611             20  CL-INSURED-MID-INIT PIC X.
  3612
  3613     12  CL-CONTROL-BY-SSN.
  3614         16  CL-COMPANY-CD-A2        PIC X.
  3615         16  CL-SOC-SEC-NO.
  3616             20  CL-SSN-STATE        PIC XX.
  3617             20  CL-SSN-ACCOUNT      PIC X(6).
  3618             20  CL-SSN-LN3          PIC X(3).
  3619
  3620     12  CL-CONTROL-BY-CERT-NO.
  3621         16  CL-COMPANY-CD-A4        PIC X.
  3622         16  CL-CERT-NO-A4.
  3623             20  CL-CERT-A4-PRIME    PIC X(10).
  3624             20  CL-CERT-A4-SFX      PIC X.
  3625
  3626     12  CL-CONTROL-BY-CCN.
  3627         16  CL-COMPANY-CD-A5        PIC X.
  3628         16  CL-CCN-A5.
  3629             20  CL-CCN.
  3630                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3631                 24  CL-CCN-PRIME-A5 PIC X(12).
  3632             20  CL-CCN-FILLER-A5    PIC X(4).
  3633
  3634     12  CL-INSURED-PROFILE-DATA.
  3635         16  CL-INSURED-BIRTH-DT     PIC XX.
  3636         16  CL-INSURED-SEX-CD       PIC X.
  3637             88  INSURED-IS-MALE        VALUE 'M'.
  3638             88  INSURED-IS-FEMALE      VALUE 'F'.
  3639             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3640         16  CL-INSURED-OCC-CD       PIC X(6).
  3641         16  FILLER                  PIC X(5).
  3642
  3643     12  CL-PROCESSING-INFO.
  3644         16  CL-PROCESSOR-ID         PIC X(4).
  3645         16  CL-CLAIM-STATUS         PIC X.
  3646             88  CLAIM-IS-OPEN          VALUE 'O'.
  3647             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3648         16  CL-CLAIM-TYPE           PIC X.
  3649*            88  AH-CLAIM               VALUE 'A'.
  3650*            88  LIFE-CLAIM             VALUE 'L'.
  3651*            88  PROPERTY-CLAIM         VALUE 'P'.
  3652*            88  IUI-CLAIM              VALUE 'I'.
  3653*            88  GAP-CLAIM              VALUE 'G'.
  3654*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3655         16  CL-CLAIM-PREM-TYPE      PIC X.
  3656             88  SINGLE-PREMIUM         VALUE '1'.
  3657             88  O-B-COVERAGE           VALUE '2'.
  3658             88  OPEN-END-COVERAGE      VALUE '3'.
  3659         16  CL-INCURRED-DT          PIC XX.
  3660         16  CL-REPORTED-DT          PIC XX.
  3661         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3662         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3663         16  CL-LAST-PMT-DT          PIC XX.
  3664         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3665         16  CL-PAID-THRU-DT         PIC XX.
  3666         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3667         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  68
* EL131.cbl
  3668         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3669         16  CL-PMT-CALC-METHOD      PIC X.
  3670             88  CL-360-DAY-YR          VALUE '1'.
  3671             88  CL-365-DAY-YR          VALUE '2'.
  3672             88  CL-FULL-MONTHS         VALUE '3'.
  3673         16  CL-CAUSE-CD             PIC X(6).
  3674
  3675         16  CL-PRIME-CERT-NO.
  3676             20  CL-PRIME-CERT-PRIME PIC X(10).
  3677             20  CL-PRIME-CERT-SFX   PIC X.
  3678
  3679         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3680             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3681             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3682
  3683         16  CL-MICROFILM-NO         PIC X(10).
  3684         16  FILLER REDEFINES CL-MICROFILM-NO.
  3685             20  CL-BENEFIT-PERIOD   PIC 99.
  3686             20  FILLER              PIC X(8).
  3687         16  CL-PROG-FORM-TYPE       PIC X.
  3688         16  CL-LAST-ADD-ON-DT       PIC XX.
  3689
  3690         16  CL-LAST-REOPEN-DT       PIC XX.
  3691         16  CL-LAST-CLOSE-DT        PIC XX.
  3692         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3693             88  FINAL-PAID             VALUE '1'.
  3694             88  CLAIM-DENIED           VALUE '2'.
  3695             88  AUTO-CLOSE             VALUE '3'.
  3696             88  MANUAL-CLOSE           VALUE '4'.
  3697             88  BENEFITS-CHANGED       VALUE 'C'.
  3698             88  SETUP-ERRORS           VALUE 'E'.
  3699         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3700         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3701         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3702             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3703         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3704         16  FILLER                  PIC X.
  3705
  3706     12  CL-CERTIFICATE-DATA.
  3707         16  CL-CERT-ORIGIN          PIC X.
  3708             88  CERT-WAS-ONLINE        VALUE '1'.
  3709             88  CERT-WAS-CREATED       VALUE '2'.
  3710             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3711         16  CL-CERT-KEY-DATA.
  3712             20  CL-CERT-CARRIER     PIC X.
  3713             20  CL-CERT-GROUPING    PIC X(6).
  3714             20  CL-CERT-STATE       PIC XX.
  3715             20  CL-CERT-ACCOUNT.
  3716                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3717                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3718             20  CL-CERT-EFF-DT      PIC XX.
  3719
  3720     12  CL-STATUS-CONTROLS.
  3721         16  CL-PRIORITY-CD          PIC X.
  3722             88  CONFIDENTIAL-DATA      VALUE '8'.
  3723             88  HIGHEST-PRIORITY       VALUE '9'.
  3724         16  CL-SUPV-ATTN-CD         PIC X.
  3725             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  69
* EL131.cbl
  3726             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3727         16  CL-PURGED-DT            PIC XX.
  3728         16  CL-RESTORED-DT          PIC XX.
  3729         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3730         16  CL-NEXT-RESEND-DT       PIC XX.
  3731         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3732         16  CL-CRITICAL-PERIOD      PIC 99.
  3733*        16  FILLER                  PIC XX.
  3734         16  CL-LAST-MAINT-DT        PIC XX.
  3735         16  CL-LAST-MAINT-USER      PIC X(4).
  3736         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3737         16  CL-LAST-MAINT-TYPE      PIC X.
  3738             88  CLAIM-SET-UP           VALUE ' '.
  3739             88  PAYMENT-MADE           VALUE '1'.
  3740             88  LETTER-SENT            VALUE '2'.
  3741             88  MASTER-WAS-ALTERED     VALUE '3'.
  3742             88  MASTER-WAS-RESTORED    VALUE '4'.
  3743             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3744             88  FILE-CONVERTED         VALUE '6'.
  3745             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3746             88  ERROR-CORRECTION       VALUE 'E'.
  3747         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3748         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3749         16  CL-BENEFICIARY          PIC X(10).
  3750         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3751         16  CL-DENIAL-TYPE          PIC X.
  3752             88  CL-TYPE-DENIAL          VALUE '1'.
  3753             88  CL-TYPE-RESCISSION      VALUE '2'.
  3754             88  CL-TYPE-REFORMATION     VALUE '3'.
  3755             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3756             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3757         16  filler                  pic x(5).
  3758*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3759*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3760*        16  CL-RTW-DT               PIC XX.
  3761
  3762     12  CL-TRAILER-CONTROLS.
  3763         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3764             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3765             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3766             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3767         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3768         16  FILLER                  PIC XX.
  3769         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3770         16  CL-ADDRESS-TRAILER-CNT.
  3771             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3772                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3773             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3774                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3775             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3776                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3777             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3778                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3779             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3780                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3781             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3782                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3783             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  70
* EL131.cbl
  3784                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3785
  3786     12  CL-CV-REFERENCE-NO.
  3787         16  CL-CV-REFNO-PRIME       PIC X(18).
  3788         16  CL-CV-REFNO-SFX         PIC XX.
  3789
  3790     12  CL-FILE-LOCATION            PIC X(4).
  3791
  3792     12  CL-PROCESS-ERRORS.
  3793         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3794             88  NO-FATAL-ERRORS        VALUE ZERO.
  3795         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3796             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3797
  3798     12  CL-PRODUCT-CD               PIC X.
  3799
  3800     12  CL-CURRENT-KEY-DATA.
  3801         16  CL-CURRENT-CARRIER      PIC X.
  3802         16  CL-CURRENT-GROUPING     PIC X(6).
  3803         16  CL-CURRENT-STATE        PIC XX.
  3804         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3805
  3806     12  CL-ASSOCIATES               PIC X.
  3807         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3808         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3809         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3810         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3811
  3812     12  CL-ACTIVITY-CODE            PIC 99.
  3813     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3814     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3815
  3816     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3817     12  CL-LAG-REPORT-CODE          PIC 9.
  3818     12  CL-LOAN-TYPE                PIC XX.
  3819     12  CL-LEGAL-STATE              PIC XX.
  3820
  3821     12  CL-YESNOSW                  PIC X.
  3822     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3823         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3824         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3825         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3826     12  cl-insured-type             pic x.
  3827         88  cl-claim-on-primary         value 'P'.
  3828         88  cl-claim-on-co-borrower     value 'C'.
  3829     12  cl-benefit-expiration-dt    PIC XX.
  3830
  3831*                                COPY ELCCERT.
  3832******************************************************************
  3833*                                                                *
  3834*                            ELCCERT.                            *
  3835*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3836*                            VMOD=2.013                          *
  3837*                                                                *
  3838*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3839*                                                                *
  3840*   FILE TYPE = VSAM,KSDS                                        *
  3841*   RECORD SIZE = 450  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  71
* EL131.cbl
  3842*                                                                *
  3843*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3844*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3845*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3846*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3847*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3848*                                                                *
  3849*   LOG = YES                                                    *
  3850*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3851******************************************************************
  3852*                   C H A N G E   L O G
  3853*
  3854* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3855*-----------------------------------------------------------------
  3856*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3857* EFFECTIVE    NUMBER
  3858*-----------------------------------------------------------------
  3859* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3860* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3861* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3862* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3863* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3864* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3865* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3866* 032612  CR2011110200001  PEMA  AHL CHANGES
  3867* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  3868******************************************************************
  3869
  3870 01  CERTIFICATE-MASTER.
  3871     12  CM-RECORD-ID                      PIC XX.
  3872         88  VALID-CM-ID                      VALUE 'CM'.
  3873
  3874     12  CM-CONTROL-PRIMARY.
  3875         16  CM-COMPANY-CD                 PIC X.
  3876         16  CM-CARRIER                    PIC X.
  3877         16  CM-GROUPING.
  3878             20  CM-GROUPING-PREFIX        PIC X(3).
  3879             20  CM-GROUPING-PRIME         PIC X(3).
  3880         16  CM-STATE                      PIC XX.
  3881         16  CM-ACCOUNT.
  3882             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3883             20  CM-ACCOUNT-PRIME          PIC X(6).
  3884         16  CM-CERT-EFF-DT                PIC XX.
  3885         16  CM-CERT-NO.
  3886             20  CM-CERT-PRIME             PIC X(10).
  3887             20  CM-CERT-SFX               PIC X.
  3888
  3889     12  CM-CONTROL-BY-NAME.
  3890         16  CM-COMPANY-CD-A1              PIC X.
  3891         16  CM-INSURED-LAST-NAME          PIC X(15).
  3892         16  CM-INSURED-INITIALS.
  3893             20  CM-INSURED-INITIAL1       PIC X.
  3894             20  CM-INSURED-INITIAL2       PIC X.
  3895
  3896     12  CM-CONTROL-BY-SSN.
  3897         16  CM-COMPANY-CD-A2              PIC X.
  3898         16  CM-SOC-SEC-NO.
  3899             20  CM-SSN-STATE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  72
* EL131.cbl
  3900             20  CM-SSN-ACCOUNT            PIC X(6).
  3901             20  CM-SSN-LN3.
  3902                 25  CM-INSURED-INITIALS-A2.
  3903                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3904                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3905                 25 CM-PART-LAST-NAME-A2         PIC X.
  3906
  3907     12  CM-CONTROL-BY-CERT-NO.
  3908         16  CM-COMPANY-CD-A4              PIC X.
  3909         16  CM-CERT-NO-A4                 PIC X(11).
  3910
  3911     12  CM-CONTROL-BY-MEMB.
  3912         16  CM-COMPANY-CD-A5              PIC X.
  3913         16  CM-MEMBER-NO.
  3914             20  CM-MEMB-STATE             PIC XX.
  3915             20  CM-MEMB-ACCOUNT           PIC X(6).
  3916             20  CM-MEMB-LN4.
  3917                 25  CM-INSURED-INITIALS-A5.
  3918                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3919                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3920                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3921
  3922     12  CM-INSURED-PROFILE-DATA.
  3923         16  CM-INSURED-FIRST-NAME.
  3924             20  CM-INSURED-1ST-INIT       PIC X.
  3925             20  FILLER                    PIC X(9).
  3926         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3927         16  CM-INSURED-SEX                PIC X.
  3928             88  CM-SEX-MALE                  VALUE 'M'.
  3929             88  CM-SEX-FEMAL                 VALUE 'F'.
  3930         16  CM-INSURED-JOINT-AGE          PIC 99.
  3931         16  CM-JOINT-INSURED-NAME.
  3932             20  CM-JT-LAST-NAME           PIC X(15).
  3933             20  CM-JT-FIRST-NAME.
  3934                 24  CM-JT-1ST-INIT        PIC X.
  3935                 24  FILLER                PIC X(9).
  3936             20  CM-JT-INITIAL             PIC X.
  3937
  3938     12  CM-LIFE-DATA.
  3939         16  CM-LF-BENEFIT-CD              PIC XX.
  3940         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3941         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3942         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3943         16  CM-LF-DEV-CODE                PIC XXX.
  3944         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3945         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3946         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3947         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3948         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3949         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3950         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3951         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3952         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3953         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3954         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3955         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3956         16  cm-temp-epiq                  pic xx.
  3957             88  EPIQ-CLASS                  value 'EQ'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  73
* EL131.cbl
  3958*        16  FILLER                        PIC XX.
  3959
  3960     12  CM-AH-DATA.
  3961         16  CM-AH-BENEFIT-CD              PIC XX.
  3962         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3963         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3964         16  CM-AH-DEV-CODE                PIC XXX.
  3965         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3966         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3967         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3968         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3969         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3970         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3971         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  3972         16  CM-AH-PAID-THRU-DT            PIC XX.
  3973             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  3974         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3975         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3976         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  3977         16  FILLER                        PIC X.
  3978
  3979     12  CM-LOAN-INFORMATION.
  3980         16  CM-LIVES                      PIC S9(7)     COMP-3.
  3981         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  3982                                           PIC S9(5)V99  COMP-3.
  3983         16  CM-BILLED                     PIC S9(7)     COMP-3.
  3984         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  3985         16  CM-PAY-FREQUENCY              PIC S99.
  3986         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  3987         16  CM-RATE-CLASS                 PIC XX.
  3988         16  CM-BENEFICIARY                PIC X(25).
  3989         16  CM-POLICY-FORM-NO             PIC X(12).
  3990         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  3991         16  CM-LAST-ADD-ON-DT             PIC XX.
  3992         16  CM-DEDUCTIBLE-AMOUNTS.
  3993             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  3994             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  3995         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3996             20  CM-RESIDENT-STATE         PIC XX.
  3997             20  CM-RATE-CODE              PIC X(4).
  3998             20  FILLER                    PIC XX.
  3999         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4000             20  CM-LOAN-OFFICER           PIC X(5).
  4001             20  FILLER                    PIC XXX.
  4002         16  CM-CSR-CODE                   PIC XXX.
  4003         16  CM-UNDERWRITING-CODE          PIC X.
  4004             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4005         16  CM-POST-CARD-IND              PIC X.
  4006         16  CM-NH-INTERFACE-SW            PIC X.
  4007         16  CM-PREMIUM-TYPE               PIC X.
  4008             88  CM-SING-PRM                  VALUE '1'.
  4009             88  CM-O-B-COVERAGE              VALUE '2'.
  4010             88  CM-OPEN-END                  VALUE '3'.
  4011         16  CM-IND-GRP-TYPE               PIC X.
  4012             88  CM-INDIVIDUAL                VALUE 'I'.
  4013             88  CM-GROUP                     VALUE 'G'.
  4014         16  CM-SKIP-CODE                  PIC X.
  4015             88  NO-MONTHS-SKIPPED            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  74
* EL131.cbl
  4016             88  SKIP-JULY                    VALUE '1'.
  4017             88  SKIP-AUGUST                  VALUE '2'.
  4018             88  SKIP-SEPTEMBER               VALUE '3'.
  4019             88  SKIP-JULY-AUG                VALUE '4'.
  4020             88  SKIP-AUG-SEPT                VALUE '5'.
  4021             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4022             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4023             88  SKIP-JUNE                    VALUE '8'.
  4024             88  SKIP-JUNE-JULY               VALUE '9'.
  4025             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4026             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4027         16  CM-PAYMENT-MODE               PIC X.
  4028             88  PAY-MONTHLY                  VALUE SPACE.
  4029             88  PAY-WEEKLY                   VALUE '1'.
  4030             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4031             88  PAY-BI-WEEKLY                VALUE '3'.
  4032             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4033         16  CM-LOAN-NUMBER                PIC X(8).
  4034         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4035         16  CM-OLD-LOF                    PIC XXX.
  4036*        16  CM-LOAN-OFFICER               PIC XXX.
  4037         16  CM-REIN-TABLE                 PIC XXX.
  4038         16  CM-SPECIAL-REIN-CODE          PIC X.
  4039         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4040         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4041         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4042
  4043     12  CM-STATUS-DATA.
  4044         16  CM-ENTRY-STATUS               PIC X.
  4045         16  CM-ENTRY-DT                   PIC XX.
  4046
  4047         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4048         16  CM-LF-CANCEL-DT               PIC XX.
  4049         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4050
  4051         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4052         16  CM-LF-DEATH-DT                PIC XX.
  4053         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4054
  4055         16  CM-LF-CURRENT-STATUS          PIC X.
  4056             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4057                                                'M' '4' '5' '9'.
  4058             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4059             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4060             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4061             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4062             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4063             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4064             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4065             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4066             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4067             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4068             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4069             88  CM-LF-DECLINED               VALUE 'D'.
  4070             88  CM-LF-VOIDED                 VALUE 'V'.
  4071
  4072         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4073         16  CM-AH-CANCEL-DT               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  75
* EL131.cbl
  4074         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4075
  4076         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4077         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4078         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4079
  4080         16  CM-AH-CURRENT-STATUS          PIC X.
  4081             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4082                                                'M' '4' '5' '9'.
  4083             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4084             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4085             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4086             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4087             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4088             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4089             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4090             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4091             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4092             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4093             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4094             88  CM-AH-DECLINED               VALUE 'D'.
  4095             88  CM-AH-VOIDED                 VALUE 'V'.
  4096
  4097         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4098             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4099             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4100             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4101         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4102
  4103         16  CM-ENTRY-BATCH                PIC X(6).
  4104         16  CM-LF-EXIT-BATCH              PIC X(6).
  4105         16  CM-AH-EXIT-BATCH              PIC X(6).
  4106         16  CM-LAST-MONTH-END             PIC XX.
  4107
  4108     12  CM-NOTE-SW                        PIC X.
  4109         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4110         88  CERT-NOTES-PRESENT               VALUE '1'.
  4111         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4112         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4113         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4114         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4115         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4116         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4117     12  CM-COMP-EXCP-SW                   PIC X.
  4118         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4119         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4120     12  CM-INSURED-ADDRESS-SW             PIC X.
  4121         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4122         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4123
  4124*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4125     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4126     12  FILLER                            PIC X.
  4127
  4128*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4129     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4130     12  FILLER                            PIC X.
  4131*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  76
* EL131.cbl
  4132     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4133
  4134     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4135         88  CERT-ADDED-BATCH                 VALUE ' '.
  4136         88  CERT-ADDED-ONLINE                VALUE '1'.
  4137         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4138         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4139         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4140     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4141         88  CERT-AS-LOADED                   VALUE ' '.
  4142         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4143         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4144         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4145         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4146         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4147         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4148         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4149
  4150     12  CM-ACCOUNT-COMM-PCTS.
  4151         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4152         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4153
  4154     12  CM-USER-FIELD                     PIC X.
  4155     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4156     12  CM-CLP-STATE                      PIC XX.
  4157     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4158     12  CM-USER-RESERVED                  PIC XXX.
  4159     12  FILLER REDEFINES CM-USER-RESERVED.
  4160         16  CM-AH-CLASS-CD                PIC XX.
  4161         16  F                             PIC X.
  4162******************************************************************
  4163
  4164*                                COPY ELCTRLR.
  4165******************************************************************
  4166*                                                                *
  4167*                            ELCTRLR.                            *
  4168*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4169*                            VMOD=2.014                          *
  4170*                                                                *
  4171*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4172*                                                                *
  4173*   FILE TYPE = VSAM,KSDS                                        *
  4174*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4175*                                                                *
  4176*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4177*       ALTERNATE INDEX = NONE                                   *
  4178*                                                                *
  4179*   LOG = YES                                                    *
  4180*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4181******************************************************************
  4182*                   C H A N G E   L O G
  4183*
  4184* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4185*-----------------------------------------------------------------
  4186*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4187* EFFECTIVE    NUMBER
  4188*-----------------------------------------------------------------
  4189* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  77
* EL131.cbl
  4190* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4191* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4192* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4193* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4194* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4195* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4196* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4197* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4198* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4199* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4200* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4201* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4202* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4203* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4204* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4205* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4206* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4207* 040814    2014030500002  AJRA  ADD ICD CODES
  4208* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4209******************************************************************
  4210 01  ACTIVITY-TRAILERS.
  4211     12  AT-RECORD-ID                    PIC XX.
  4212         88  VALID-AT-ID                       VALUE 'AT'.
  4213
  4214     12  AT-CONTROL-PRIMARY.
  4215         16  AT-COMPANY-CD               PIC X.
  4216         16  AT-CARRIER                  PIC X.
  4217         16  AT-CLAIM-NO                 PIC X(7).
  4218         16  AT-CERT-NO.
  4219             20  AT-CERT-PRIME           PIC X(10).
  4220             20  AT-CERT-SFX             PIC X.
  4221         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4222             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4223             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4224             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4225             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4226             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4227             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4228             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4229             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4230             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4231             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4232             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4233             88  AT-BENEFICIARY-TRL           VALUE +91.
  4234             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4235             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4236             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4237             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4238
  4239     12  AT-TRAILER-TYPE                 PIC X.
  4240         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4241         88  PAYMENT-TR                       VALUE '2'.
  4242         88  AUTO-PAY-TR                      VALUE '3'.
  4243         88  CORRESPONDENCE-TR                VALUE '4'.
  4244         88  ADDRESS-TR                       VALUE '5'.
  4245         88  GENERAL-INFO-TR                  VALUE '6'.
  4246         88  AUTO-PROMPT-TR                   VALUE '7'.
  4247         88  DENIAL-TR                        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  78
* EL131.cbl
  4248         88  INCURRED-CHG-TR                  VALUE '9'.
  4249         88  FORM-CONTROL-TR                  VALUE 'A'.
  4250
  4251     12  AT-RECORDED-DT                  PIC XX.
  4252     12  AT-RECORDED-BY                  PIC X(4).
  4253     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4254
  4255     12  AT-TRAILER-BODY                 PIC X(165).
  4256
  4257     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4258         16  AT-RESERVE-CONTROLS.
  4259             20  AT-MANUAL-SW            PIC X.
  4260                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4261             20  AT-FUTURE-SW            PIC X.
  4262                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4263             20  AT-PTC-SW               PIC X.
  4264                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4265             20  AT-IBNR-SW              PIC X.
  4266                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4267             20  AT-PTC-LF-SW            PIC X.
  4268                 88  AT-LF-PTC-USED          VALUE '1'.
  4269             20  AT-CDT-ACCESS-METHOD    PIC X.
  4270                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4271                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4272                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4273             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4274         16  AT-LAST-COMPUTED-DT         PIC XX.
  4275         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4276         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4277         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4278         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4279         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4280         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4281         16  AT-EXPENSE-CONTROLS.
  4282             20  AT-EXPENSE-METHOD       PIC X.
  4283                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4284                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4285                 88  PERCENT-OF-PMT           VALUE '3'.
  4286                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4287             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4288             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4289         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4290         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4291
  4292         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4293         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4294
  4295*        16  FILLER                      PIC X(53).
  4296         16  FILLER                      PIC X(47).
  4297
  4298         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4299         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4300
  4301         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4302             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4303             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4304*                    C = CLOSED
  4305*                    O = OPEN
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  79
* EL131.cbl
  4306             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4307*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4308
  4309     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4310         16  AT-PAYMENT-TYPE             PIC X.
  4311             88  PARTIAL-PAYMENT                VALUE '1'.
  4312             88  FINAL-PAYMENT                  VALUE '2'.
  4313             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4314             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4315             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4316             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4317             88  VOIDED-PAYMENT                 VALUE '9'.
  4318             88  TRANSFER                       VALUE 'T'.
  4319             88  LIFE-INTEREST                  VALUE 'I'.
  4320
  4321         16  AT-CLAIM-TYPE               PIC X.
  4322             88  PAID-FOR-AH                    VALUE 'A'.
  4323             88  PAID-FOR-LIFE                  VALUE 'L'.
  4324             88  PAID-FOR-IUI                   VALUE 'I'.
  4325             88  PAID-FOR-GAP                   VALUE 'G'.
  4326             88  PAID-FOR-FAM                   VALUE 'F'.
  4327         16  AT-CLAIM-PREM-TYPE          PIC X.
  4328             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4329             88  AT-O-B-COVERAGE                VALUE '2'.
  4330             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4331         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4332         16  AT-CHECK-NO                 PIC X(7).
  4333         16  AT-PAID-FROM-DT             PIC XX.
  4334         16  AT-PAID-THRU-DT             PIC XX.
  4335         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4336         16  FILLER                      PIC X.
  4337         16  AT-PAYEES-NAME              PIC X(30).
  4338         16  AT-PAYMENT-ORIGIN           PIC X.
  4339             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4340             88  ONLINE-AUTO-PMT                VALUE '2'.
  4341             88  OFFLINE-PMT                    VALUE '3'.
  4342         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4343         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4344         16  AT-VOID-DATA.
  4345             20  AT-VOID-DT              PIC XX.
  4346*00144       20  AT-VOID-REASON          PIC X(30).
  4347             20  AT-VOID-REASON          PIC X(26).
  4348         16  AT-PMT-APPROVED-BY          PIC X(04).
  4349         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4350         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4351         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4352                                         PIC S99V9(5)  COMP-3.
  4353         16  AT-CREDIT-INTERFACE.
  4354             20  AT-PMT-SELECT-DT        PIC XX.
  4355                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4356             20  AT-PMT-ACCEPT-DT        PIC XX.
  4357                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4358             20  AT-VOID-SELECT-DT       PIC XX.
  4359                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4360             20  AT-VOID-ACCEPT-DT       PIC XX.
  4361                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4362
  4363         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  80
* EL131.cbl
  4364                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4365                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4366         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4367
  4368         16  AT-FORCE-CONTROL            PIC X.
  4369             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4370         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4371         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4372         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4373         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4374         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4375         16  AT-BENEFIT-TYPE             PIC X.
  4376
  4377         16  AT-EXPENSE-TYPE             PIC X.
  4378         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4379
  4380         16  AT-PAYEE-TYPE-CD.
  4381             20  AT-PAYEE-TYPE           PIC X.
  4382                 88  INSURED-PAID           VALUE 'I'.
  4383                 88  BENEFICIARY-PAID       VALUE 'B'.
  4384                 88  ACCOUNT-PAID           VALUE 'A'.
  4385                 88  OTHER-1-PAID           VALUE 'O'.
  4386                 88  OTHER-2-PAID           VALUE 'Q'.
  4387                 88  DOCTOR-PAID            VALUE 'P'.
  4388                 88  EMPLOYER-PAID          VALUE 'E'.
  4389             20  AT-PAYEE-SEQ            PIC X.
  4390
  4391         16  AT-CASH-PAYMENT             PIC X.
  4392         16  AT-GROUPED-PAYMENT          PIC X.
  4393         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4394         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4395         16  AT-APPROVED-LEVEL           PIC X.
  4396         16  AT-VOID-TYPE                PIC X.
  4397             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4398             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4399         16  AT-AIG-UNEMP-IND            PIC X.
  4400             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4401         16  AT-ASSOCIATES               PIC X.
  4402             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4403             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4404
  4405         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4406         16  AT-CV-PMT-CODE              PIC X.
  4407             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4408             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4409             88  FULL-ADD-PAYMENT           VALUE '3'.
  4410             88  HALF-ADD-PAYMENT           VALUE '4'.
  4411             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4412             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4413             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4414             88  ADDL-PAYMENT               VALUE '8'.
  4415
  4416         16  AT-EOB-CODE1                PIC XXX.
  4417         16  AT-EOB-CODE2                PIC XXX.
  4418         16  AT-EOB-CODE3                PIC XXX.
  4419         16  FILLER REDEFINES AT-EOB-CODE3.
  4420             20  AT-PRINT-CLM-FORM       PIC X.
  4421             20  AT-PRINT-SURVEY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  81
* EL131.cbl
  4422             20  AT-SPECIAL-RELEASE      PIC X.
  4423         16  AT-EOB-CODE4                PIC XXX.
  4424         16  FILLER REDEFINES AT-EOB-CODE4.
  4425             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4426             20  FILLER                  PIC X.
  4427         16  AT-EOB-CODE5                PIC XXX.
  4428         16  FILLER REDEFINES AT-EOB-CODE5.
  4429             20  AT-PMT-PROOF-DT         PIC XX.
  4430             20  FILLER                  PIC X.
  4431
  4432         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4433             88  AT-PRINT-EOB            VALUE 'Y'.
  4434
  4435         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4436         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4437
  4438     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4439         16  AT-SCHEDULE-START-DT        PIC XX.
  4440         16  AT-SCHEDULE-END-DT          PIC XX.
  4441         16  AT-TERMINATED-DT            PIC XX.
  4442         16  AT-LAST-PMT-TYPE            PIC X.
  4443             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4444             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4445         16  AT-FIRST-PMT-DATA.
  4446             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4447             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4448             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4449         16  AT-REGULAR-PMT-DATA.
  4450             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4451             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4452             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4453         16  AT-AUTO-PAYEE-CD.
  4454             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4455                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4456                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4457                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4458                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4459                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4460             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4461         16  AT-AUTO-PAY-DAY             PIC 99.
  4462         16  AT-AUTO-CASH                PIC X.
  4463             88  AT-CASH                      VALUE 'Y'.
  4464             88  AT-NON-CASH                  VALUE 'N'.
  4465*        16  FILLER                      PIC X(129).
  4466         16  AT-AUTO-END-LETTER          PIC X(4).
  4467         16  FILLER                      PIC X(125).
  4468
  4469         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4470         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4471
  4472     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4473         16  AT-LETTER-SENT-DT           PIC XX.
  4474         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4475         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4476         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4477         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4478         16  AT-LETTER-ORIGIN            PIC X.
  4479             88  ONLINE-CREATION              VALUE '1' '3'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  82
* EL131.cbl
  4480             88  OFFLINE-CREATION             VALUE '2' '4'.
  4481             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4482             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4483         16  AT-STD-LETTER-FORM          PIC X(4).
  4484         16  AT-REASON-TEXT              PIC X(70).
  4485         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4486         16  AT-ADDRESEE-TYPE            PIC X.
  4487              88  INSURED-ADDRESEE            VALUE 'I'.
  4488              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4489              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4490              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4491              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4492              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4493              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4494         16  AT-ADDRESSEE-NAME           PIC X(30).
  4495         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4496         16  AT-RESEND-PRINT-DATE        PIC XX.
  4497         16  AT-CORR-SOL-UNSOL           PIC X.
  4498         16  AT-LETTER-PURGED-DT         PIC XX.
  4499*
  4500*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4501*
  4502         16  AT-CSO-REDEFINITION.
  4503             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4504             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4505             20  AT-LETTER-TO-BENE       PIC X(1).
  4506             20  AT-STOP-LETTER-DT       PIC X(2).
  4507             20  FILLER                  PIC X(19).
  4508*             20  FILLER                  PIC X(27).
  4509             20  AT-CSO-LETTER-STATUS    PIC X.
  4510                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4511                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4512                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4513             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4514             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4515*
  4516*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4517*
  4518*        16  FILLER                      PIC X(26).
  4519*
  4520*        16  AT-DMD-BSR-CODE             PIC X.
  4521*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4522*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4523*
  4524*        16  AT-DMD-LETTER-STATUS        PIC X.
  4525*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4526*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4527*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4528*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4529*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4530
  4531         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4532         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4533
  4534     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4535         16  AT-ADDRESS-TYPE             PIC X.
  4536             88  INSURED-ADDRESS               VALUE 'I'.
  4537             88  BENEFICIARY-ADDRESS           VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  83
* EL131.cbl
  4538             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4539             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4540             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4541             88  OTHER-ADDRESS-1               VALUE 'O'.
  4542             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4543         16  AT-MAIL-TO-NAME             PIC X(30).
  4544         16  AT-ADDRESS-LINE-1           PIC X(30).
  4545         16  AT-ADDRESS-LINE-2           PIC X(30).
  4546         16  AT-CITY-STATE.
  4547             20  AT-CITY                 PIC X(28).
  4548             20  AT-STATE                PIC XX.
  4549         16  AT-ZIP.
  4550             20  AT-ZIP-CODE.
  4551                 24  AT-ZIP-1ST          PIC X.
  4552                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4553                 24  FILLER              PIC X(4).
  4554             20  AT-ZIP-PLUS4            PIC X(4).
  4555         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4556             20  AT-CAN-POSTAL-1         PIC XXX.
  4557             20  AT-CAN-POSTAL-2         PIC XXX.
  4558             20  FILLER                  PIC XXX.
  4559         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4560*         16  FILLER                      PIC X(23).
  4561         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4562         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4563         16  FILLER                      PIC X(13).
  4564         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4565         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4566
  4567     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4568         16  AT-INFO-LINE-1              PIC X(60).
  4569         16  FILLER REDEFINES AT-INFO-LINE-1.
  4570             20  AT-NOTE-ERROR-NO OCCURS 15
  4571                                         PIC X(4).
  4572         16  AT-INFO-LINE-2              PIC X(60).
  4573         16  FILLER REDEFINES AT-INFO-LINE-2.
  4574             20  AT-ICD-CODE-1           PIC X(8).
  4575             20  AT-ICD-CODE-2           PIC X(8).
  4576             20  FILLER                  PIC X(44).
  4577         16  AT-INFO-TRAILER-TYPE        PIC X.
  4578             88  AT-ERRORS-NOTE          VALUE 'E'.
  4579             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4580             88  AT-CALL-NOTE            VALUE 'C'.
  4581             88  AT-MAINT-NOTE           VALUE 'M'.
  4582             88  AT-CERT-CHANGE          VALUE 'X'.
  4583             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4584             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4585             88  AT-CERT-CANCELLED       VALUE 'T'.
  4586         16  AT-CALL-TYPE                PIC X.
  4587             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4588             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4589         16  AT-NOTE-CONTINUATION        PIC X.
  4590             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4591         16  AT-EOB-CODES-EXIST          PIC X.
  4592             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4593         16  FILLER                      PIC X(35).
  4594         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4595         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  84
* EL131.cbl
  4596
  4597     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4598         16  AT-PROMPT-LINE-1            PIC X(60).
  4599         16  AT-PROMPT-LINE-2            PIC X(60).
  4600         16  AT-PROMPT-START-DT          PIC XX.
  4601         16  AT-PROMPT-END-DT            PIC XX.
  4602         16  FILLER                      PIC X(35).
  4603         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4604         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4605
  4606     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4607         16  AT-DENIAL-INFO-1            PIC X(60).
  4608         16  AT-DENIAL-INFO-2            PIC X(60).
  4609         16  AT-DENIAL-DT                PIC XX.
  4610         16  AT-RETRACTION-DT            PIC XX.
  4611         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4612*         16  FILLER                      PIC X(31).
  4613         16  AT-DENIAL-PROOF-DT          PIC XX.
  4614         16  FILLER                      PIC X(29).
  4615         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4616         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4617
  4618     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4619         16  AT-OLD-INCURRED-DT          PIC XX.
  4620         16  AT-OLD-REPORTED-DT          PIC XX.
  4621         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4622         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4623         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4624         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4625         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4626         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4627         16  FILLER                      PIC X(26).
  4628         16  AT-OLD-DIAG-CODE            PIC X(6).
  4629         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4630         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4631         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4632         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4633         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4634         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4635         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4636         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4637         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4638         16  FILLER                      PIC X(9).
  4639         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4640
  4641     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4642         16  AT-FORM-SEND-ON-DT          PIC XX.
  4643         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4644         16  AT-FORM-RE-SEND-DT          PIC XX.
  4645         16  AT-FORM-ANSWERED-DT         PIC XX.
  4646         16  AT-FORM-PRINTED-DT          PIC XX.
  4647         16  AT-FORM-REPRINT-DT          PIC XX.
  4648         16  AT-FORM-TYPE                PIC X.
  4649             88  INITIAL-FORM                  VALUE '1'.
  4650             88  PROGRESS-FORM                 VALUE '2'.
  4651         16  AT-INSTRUCT-LN-1            PIC X(28).
  4652         16  AT-INSTRUCT-LN-2            PIC X(28).
  4653         16  AT-INSTRUCT-LN-3            PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  85
* EL131.cbl
  4654         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4655         16  AT-FORM-ADDRESS             PIC X.
  4656             88  FORM-TO-INSURED              VALUE 'I'.
  4657             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4658             88  FORM-TO-OTHER-1              VALUE 'O'.
  4659             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4660         16  AT-RELATED-1.
  4661             20 AT-REL-CARR-1            PIC X.
  4662             20 AT-REL-CLAIM-1           PIC X(7).
  4663             20 AT-REL-CERT-1            PIC X(11).
  4664         16  AT-RELATED-2.
  4665             20 AT-REL-CARR-2            PIC X.
  4666             20 AT-REL-CLAIM-2           PIC X(7).
  4667             20 AT-REL-CERT-2            PIC X(11).
  4668         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4669         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4670         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4671         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4672         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4673         16  AT-STOP-FORM-DT             PIC X(2).
  4674
  4675         16  FILLER                      PIC X(09).
  4676         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4677         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4678******************************************************************
  4679
  4680*                                COPY ELCCNTL.
  4681******************************************************************
  4682*                                                                *
  4683*                                                                *
  4684*                            ELCCNTL.                            *
  4685*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4686*                            VMOD=2.059                          *
  4687*                                                                *
  4688*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4689*                                                                *
  4690*   FILE TYPE = VSAM,KSDS                                        *
  4691*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4692*                                                                *
  4693*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4694*       ALTERNATE INDEX = NONE                                   *
  4695*                                                                *
  4696*   LOG = YES                                                    *
  4697*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4698******************************************************************
  4699*                   C H A N G E   L O G
  4700*
  4701* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4702*-----------------------------------------------------------------
  4703*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4704* EFFECTIVE    NUMBER
  4705*-----------------------------------------------------------------
  4706* 082503                   PEMA  ADD BENEFIT GROUP
  4707* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4708* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4709* 092705    2005050300006  PEMA  ADD SPP LEASES
  4710* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4711* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  86
* EL131.cbl
  4712* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4713* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4714* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4715* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4716* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4717* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4718* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4719* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4720******************************************************************
  4721*
  4722 01  CONTROL-FILE.
  4723     12  CF-RECORD-ID                       PIC XX.
  4724         88  VALID-CF-ID                        VALUE 'CF'.
  4725
  4726     12  CF-CONTROL-PRIMARY.
  4727         16  CF-COMPANY-ID                  PIC XXX.
  4728         16  CF-RECORD-TYPE                 PIC X.
  4729             88  CF-COMPANY-MASTER              VALUE '1'.
  4730             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4731             88  CF-STATE-MASTER                VALUE '3'.
  4732             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4733             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4734             88  CF-CARRIER-MASTER              VALUE '6'.
  4735             88  CF-MORTALITY-MASTER            VALUE '7'.
  4736             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4737             88  CF-TERMINAL-MASTER             VALUE '9'.
  4738             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4739             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4740             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4741             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4742             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4743             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4744             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4745             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4746             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4747         16  CF-ACCESS-CD-GENL              PIC X(4).
  4748         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4749             20  CF-PROCESSOR               PIC X(4).
  4750         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4751             20  CF-STATE-CODE              PIC XX.
  4752             20  FILLER                     PIC XX.
  4753         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4754             20  FILLER                     PIC XX.
  4755             20  CF-HI-BEN-IN-REC           PIC XX.
  4756         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4757             20  FILLER                     PIC XXX.
  4758             20  CF-CARRIER-CNTL            PIC X.
  4759         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4760             20  FILLER                     PIC XX.
  4761             20  CF-HI-TYPE-IN-REC          PIC 99.
  4762         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4763             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4764                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4765             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4766             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4767         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4768             20  FILLER                     PIC X.
  4769             20  CF-CUSTOM-REPORT-NO        PIC 999.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  87
* EL131.cbl
  4770         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4771             20  FILLER                     PIC XX.
  4772             20  CF-MORTGAGE-PLAN           PIC XX.
  4773         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4774
  4775     12  CF-LAST-MAINT-DT                   PIC XX.
  4776     12  CF-LAST-MAINT-BY                   PIC X(4).
  4777     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4778
  4779     12  CF-RECORD-BODY                     PIC X(728).
  4780
  4781
  4782****************************************************************
  4783*             COMPANY MASTER RECORD                            *
  4784****************************************************************
  4785
  4786     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4787         16  CF-COMPANY-ADDRESS.
  4788             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4789             20  CF-CL-IN-CARE-OF           PIC X(30).
  4790             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4791             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4792             20  CF-CL-CITY-STATE           PIC X(30).
  4793             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4794             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4795         16  CF-COMPANY-CD                  PIC X.
  4796         16  CF-COMPANY-PASSWORD            PIC X(8).
  4797         16  CF-SECURITY-OPTION             PIC X.
  4798             88  ALL-SECURITY                   VALUE '1'.
  4799             88  COMPANY-VERIFY                 VALUE '2'.
  4800             88  PROCESSOR-VERIFY               VALUE '3'.
  4801             88  NO-SECURITY                    VALUE '4'.
  4802             88  ALL-BUT-TERM                   VALUE '5'.
  4803         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4804             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4805         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4806             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4807         16  CF-INFORCE-LOCATION            PIC X.
  4808             88  CERTS-ARE-ONLINE               VALUE '1'.
  4809             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4810             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4811         16  CF-LOWER-CASE-LETTERS          PIC X.
  4812         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4813             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4814             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4815             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4816             88  CF-ACCNT-CNTL                  VALUE '3'.
  4817             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4818
  4819         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4820         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4821
  4822         16  CF-LGX-CREDIT-USER             PIC X.
  4823             88  CO-IS-NOT-USER                 VALUE 'N'.
  4824             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4825
  4826         16 CF-CREDIT-CALC-CODES.
  4827             20  CF-CR-REM-TERM-CALC PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  88
* EL131.cbl
  4828               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4829               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4830               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4831               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4832               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4833               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4834               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4835             20  CF-CR-R78-METHOD           PIC X.
  4836               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4837               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4838
  4839         16  CF-CLAIM-CONTROL-COUNTS.
  4840             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4841                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4842
  4843             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4844                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4845
  4846             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4847                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4848
  4849             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4850                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4851
  4852         16  CF-CURRENT-MONTH-END           PIC XX.
  4853
  4854         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4855             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4856             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4857             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4858             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4859                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4860                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4861             20  CF-CO-PREM-REJECT-SW       PIC X.
  4862                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4863                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4864             20  CF-CO-REF-REJECT-SW        PIC X.
  4865                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4866                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4867
  4868         16  CF-CO-REPORTING-DT             PIC XX.
  4869         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4870         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4871           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4872           88  CF-CO-MONTH-END                  VALUE '1'.
  4873
  4874         16  CF-LGX-CLAIM-USER              PIC X.
  4875             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4876             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4877
  4878         16  CF-CREDIT-EDIT-CONTROLS.
  4879             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4880             20  CF-MIN-AGE                 PIC 99.
  4881             20  CF-DEFAULT-AGE             PIC 99.
  4882             20  CF-MIN-TERM                PIC S999      COMP-3.
  4883             20  CF-MAX-TERM                PIC S999      COMP-3.
  4884             20  CF-DEFAULT-SEX             PIC X.
  4885             20  CF-JOINT-AGE-INPUT         PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  89
* EL131.cbl
  4886                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4887             20  CF-BIRTH-DATE-INPUT        PIC X.
  4888                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4889             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4890                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4891                 88  CF-ZERO-CARRIER            VALUE '1'.
  4892                 88  CF-ZERO-GROUPING           VALUE '2'.
  4893                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4894             20  CF-EDIT-SW                 PIC X.
  4895                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4896             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4897             20  CF-CR-PR-METHOD            PIC X.
  4898               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4899               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4900             20  FILLER                     PIC X.
  4901
  4902         16  CF-CREDIT-MISC-CONTROLS.
  4903             20  CF-REIN-TABLE-SW           PIC X.
  4904                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4905             20  CF-COMP-TABLE-SW           PIC X.
  4906                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4907             20  CF-EXPERIENCE-RETENTION-AGE
  4908                                            PIC S9        COMP-3.
  4909             20  CF-CONVERSION-DT           PIC XX.
  4910             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4911             20  CF-RUN-FREQUENCY-SW        PIC X.
  4912                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4913                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4914
  4915             20  CF-CR-CHECK-NO-CONTROL.
  4916                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4917                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4918                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4919                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4920                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4921                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4922
  4923                 24  CF-CR-CHECK-COUNT       REDEFINES
  4924                     CF-CR-CHECK-COUNTER      PIC X(4).
  4925
  4926                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4927                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4928
  4929                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4930                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4931                 24  CF-MAIL-PROCESSING       PIC X.
  4932                     88  MAIL-PROCESSING          VALUE 'Y'.
  4933
  4934         16  CF-MISC-SYSTEM-CONTROL.
  4935             20  CF-SYSTEM-C                 PIC X.
  4936                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4937             20  CF-SYSTEM-D                 PIC X.
  4938                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4939             20  CF-SOC-SEC-NO-SW            PIC X.
  4940                 88  SOC-SEC-NO-USED             VALUE '1'.
  4941             20  CF-MEMBER-NO-SW             PIC X.
  4942                 88  MEMBER-NO-USED              VALUE '1'.
  4943             20  CF-TAX-ID-NUMBER            PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  90
* EL131.cbl
  4944             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4945             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4946                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4947                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4948                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4949                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4950             20  CF-SYSTEM-E                 PIC X.
  4951                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4952
  4953         16  CF-LGX-LIFE-USER               PIC X.
  4954             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4955             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4956
  4957         16  CF-CR-MONTH-END-DT             PIC XX.
  4958
  4959         16  CF-FILE-MAINT-DATES.
  4960             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4961                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4962             20  CF-LAST-BATCH       REDEFINES
  4963                 CF-LAST-BATCH-NO               PIC X(4).
  4964             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4965             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4966             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4967             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4968             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4969             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4970             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4971             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4972             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4973             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4974
  4975         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4976         16  FILLER                         PIC X.
  4977
  4978         16  CF-ALT-MORT-CODE               PIC X(4).
  4979         16  CF-MEMBER-CAPTION              PIC X(10).
  4980
  4981         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4982             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4983             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4984             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4985             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4986             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4987
  4988         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4989
  4990         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4991         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4992         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4993         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4994
  4995         16  CF-AH-OVERRIDE-L1              PIC X.
  4996         16  CF-AH-OVERRIDE-L2              PIC XX.
  4997         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4998         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4999
  5000         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5001         16  CF-REPORT-CD2-CAPTION          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  91
* EL131.cbl
  5002
  5003         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5004         16  CF-AR-LAST-EL860-DT            PIC XX.
  5005         16  CF-MP-MONTH-END-DT             PIC XX.
  5006
  5007         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5008         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5009             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5010
  5011         16  CF-AR-MONTH-END-DT             PIC XX.
  5012
  5013         16  CF-CRDTCRD-USER                PIC X.
  5014             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5015             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5016
  5017         16  CF-CC-MONTH-END-DT             PIC XX.
  5018
  5019         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5020
  5021         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5022             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5023             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5024             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5025         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5026         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5027         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5028         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5029             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5030             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5031         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5032         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5033         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5034             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5035         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5036
  5037         16  CF-CL-ZIP-CODE.
  5038             20  CF-CL-ZIP-PRIME.
  5039                 24  CF-CL-ZIP-1ST          PIC X.
  5040                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5041                 24  FILLER                 PIC X(4).
  5042             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5043         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5044             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5045             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5046             20  FILLER                     PIC XXX.
  5047
  5048         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5049         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5050         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5051         16  CF-CO-OPTION-START-DATE        PIC XX.
  5052         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5053           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5054                                                      '3' '4'.
  5055           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5056           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5057           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5058           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5059           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  92
* EL131.cbl
  5060           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5061
  5062         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5063
  5064         16  CF-PAYMENT-APPROVAL-LEVELS.
  5065             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5066             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5067             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5068             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5069             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5070             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5071
  5072         16  CF-END-USER-REPORTING-USER     PIC X.
  5073             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5074             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5075
  5076         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5077             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5078             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5079
  5080         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5081
  5082         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5083         16  FILLER                         PIC X.
  5084
  5085         16  CF-CREDIT-ARCHIVE-CNTL.
  5086             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5087             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5088             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5089
  5090         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5091
  5092         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5093             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5094             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5095
  5096         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5097             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5098             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5099
  5100         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5101
  5102         16  CF-CO-ACH-ID-CODE              PIC  X.
  5103             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5104             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5105             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5106         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5107         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5108         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5109         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5110         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5111         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5112         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5113         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5114         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5115                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5116         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5117                 CF-CO-ACH-TRACE-NO         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  93
* EL131.cbl
  5118
  5119         16  CF-CO-OVER-SHORT.
  5120             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5121             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5122
  5123*         16  FILLER                         PIC X(102).
  5124         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5125             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5126             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5127
  5128         16  CF-AH-APPROVAL-DAYS.
  5129             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5130             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5131             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5132             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5133
  5134         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5135
  5136         16  CF-APPROV-LEV-5.
  5137             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5138             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5139             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5140
  5141         16  FILLER                         PIC X(68).
  5142****************************************************************
  5143*             PROCESSOR/USER RECORD                            *
  5144****************************************************************
  5145
  5146     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5147         16  CF-PROCESSOR-NAME              PIC X(30).
  5148         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5149         16  CF-PROCESSOR-TITLE             PIC X(26).
  5150         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5151                 88  MESSAGE-YES                VALUE 'Y'.
  5152                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5153
  5154*****************************************************
  5155****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5156****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5157****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5158****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5159*****************************************************
  5160
  5161         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5162             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5163             20  CF-APPLICATION-FORCE       PIC X.
  5164             20  CF-INDIVIDUAL-APP.
  5165                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5166                     28  CF-BROWSE-APP      PIC X.
  5167                     28  CF-UPDATE-APP      PIC X.
  5168
  5169         16  CF-CURRENT-TERM-ON             PIC X(4).
  5170         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5171             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5172             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5173             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5174             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5175             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  94
* EL131.cbl
  5176             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5177             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5178         16  CF-PROCESSOR-CARRIER           PIC X.
  5179             88  NO-CARRIER-SECURITY            VALUE ' '.
  5180         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5181             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5182         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5183             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5184         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5185             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5186
  5187         16  CF-PROC-SYS-ACCESS-SW.
  5188             20  CF-PROC-CREDIT-CLAIMS-SW.
  5189                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5190                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5191                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5192                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5193             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5194                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5195                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5196             20  CF-PROC-LIFE-GNRLDGR-SW.
  5197                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5198                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5199                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5200                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5201             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5202                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5203                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5204         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5205             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5206             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5207         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5208
  5209         16  CF-APPROVAL-LEVEL                  PIC X.
  5210             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5211             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5212             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5213             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5214             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5215
  5216         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5217
  5218         16  CF-LANGUAGE-TYPE                   PIC X.
  5219             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5220             88  CF-LANG-IS-FR                      VALUE 'F'.
  5221
  5222         16  CF-CSR-IND                         PIC X.
  5223         16  FILLER                             PIC X(239).
  5224
  5225****************************************************************
  5226*             PROCESSOR/REMINDERS RECORD                       *
  5227****************************************************************
  5228
  5229     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5230         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5231             20  CF-START-REMIND-DT         PIC XX.
  5232             20  CF-END-REMIND-DT           PIC XX.
  5233             20  CF-REMINDER-TEXT           PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  95
* EL131.cbl
  5234         16  FILLER                         PIC X(296).
  5235
  5236
  5237****************************************************************
  5238*             STATE MASTER RECORD                              *
  5239****************************************************************
  5240
  5241     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5242         16  CF-STATE-ABBREVIATION          PIC XX.
  5243         16  CF-STATE-NAME                  PIC X(25).
  5244         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5245         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5246             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5247             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5248             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5249             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5250                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5251                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5252             20  CF-ST-PREM-REJECT-SW       PIC X.
  5253                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5254                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5255             20  CF-ST-REF-REJECT-SW        PIC X.
  5256                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5257                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5258         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5259         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5260         16  CF-ST-REFUND-RULES.
  5261             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5262             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5263             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5264         16  CF-ST-FST-PMT-EXTENSION.
  5265             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5266             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5267                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5268                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5269                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5270                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5271         16  CF-ST-STATE-CALL.
  5272             20  CF-ST-CALL-UNEARNED        PIC X.
  5273             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5274             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5275         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5276             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5277             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5278         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5279         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5280         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5281         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5282         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5283         16  FILLER                         PIC X.
  5284         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5285             20  CF-ST-BENEFIT-CD           PIC XX.
  5286             20  CF-ST-BENEFIT-KIND         PIC X.
  5287                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5288                 88  CF-ST-AH-KIND              VALUE 'A'.
  5289             20  CF-ST-REM-TERM-CALC        PIC X.
  5290                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5291                 88  ST-EARN-AFTER-15TH         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  96
* EL131.cbl
  5292                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5293                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5294                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5295                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5296                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5297                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5298
  5299             20  CF-ST-REFUND-CALC          PIC X.
  5300                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5301                 88  ST-REFD-BY-R78             VALUE '1'.
  5302                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5303                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5304                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5305                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5306                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5307                 88  ST-REFD-UTAH               VALUE '7'.
  5308                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5309                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5310                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5311
  5312             20  CF-ST-EARNING-CALC         PIC X.
  5313                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5314                 88  ST-EARN-BY-R78             VALUE '1'.
  5315                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5316                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5317                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5318                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5319                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5320                 88  ST-EARN-MEAN               VALUE '8'.
  5321                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5322
  5323             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5324                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5325                 88  ST-OVRD-BY-R78             VALUE '1'.
  5326                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5327                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5328                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5329                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5330                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5331                 88  ST-OVRD-MEAN               VALUE '8'.
  5332                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5333             20  FILLER                     PIC X.
  5334
  5335         16  CF-ST-COMMISSION-CAPS.
  5336             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5337             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5338             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5339             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5340         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5341                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5342
  5343         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5344
  5345         16  CF-ST-STATUTORY-INTEREST.
  5346             20  CF-ST-STAT-DATE-FROM       PIC X.
  5347                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5348                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5349             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  97
* EL131.cbl
  5350             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5351             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5352             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5353             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5354
  5355         16  CF-ST-OVER-SHORT.
  5356             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5357             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5358
  5359         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5360
  5361         16  CF-ST-RT-CALC                  PIC X.
  5362
  5363         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5364         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5365         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5366         16  CF-ST-RF-LR-CALC               PIC X.
  5367         16  CF-ST-RF-LL-CALC               PIC X.
  5368         16  CF-ST-RF-LN-CALC               PIC X.
  5369         16  CF-ST-RF-AH-CALC               PIC X.
  5370         16  CF-ST-RF-CP-CALC               PIC X.
  5371*        16  FILLER                         PIC X(206).
  5372*CIDMOD         16  FILLER                         PIC X(192).
  5373         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5374             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5375         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5376         16  CF-ST-VFY-2ND-BENE             PIC X.
  5377         16  CF-ST-CAUSAL-STATE             PIC X.
  5378         16  FILLER                         PIC X(185).
  5379
  5380****************************************************************
  5381*             BENEFIT MASTER RECORD                            *
  5382****************************************************************
  5383
  5384     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5385         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5386             20  CF-BENEFIT-CODE            PIC XX.
  5387             20  CF-BENEFIT-NUMERIC  REDEFINES
  5388                 CF-BENEFIT-CODE            PIC XX.
  5389             20  CF-BENEFIT-ALPHA           PIC XXX.
  5390             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5391             20  CF-BENEFIT-COMMENT         PIC X(10).
  5392
  5393             20  CF-LF-COVERAGE-TYPE        PIC X.
  5394                 88  CF-REDUCING                VALUE 'R'.
  5395                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5396
  5397             20  CF-SPECIAL-CALC-CD         PIC X.
  5398                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5399                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5400                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5401                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5402                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5403                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5404                 88  CF-FARM-PLAN               VALUE 'F'.
  5405                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5406                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5407                 88  CF-3-MTH-INTEREST          VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  98
* EL131.cbl
  5408                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5409                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5410                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5411                 88  CF-PRUDENTIAL              VALUE 'P'.
  5412                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5413                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5414                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5415                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5416                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5417                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5418
  5419             20  CF-JOINT-INDICATOR         PIC X.
  5420                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5421
  5422*            20  FILLER                     PIC X(12).
  5423             20  cf-maximum-benefits        pic s999 comp-3.
  5424             20  FILLER                     PIC X(09).
  5425             20  CF-BENEFIT-CATEGORY        PIC X.
  5426             20  CF-LOAN-TYPE               PIC X(8).
  5427
  5428             20  CF-CO-REM-TERM-CALC        PIC X.
  5429                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5430                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5431                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5432                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5433                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5434
  5435             20  CF-CO-EARNINGS-CALC        PIC X.
  5436                 88  CO-EARN-BY-R78             VALUE '1'.
  5437                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5438                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5439                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5440                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5441                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5442                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5443                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5444
  5445             20  CF-CO-REFUND-CALC          PIC X.
  5446                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5447                 88  CO-REFD-BY-R78             VALUE '1'.
  5448                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5449                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5450                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5451                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5452                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5453                 88  CO-REFD-MEAN               VALUE '8'.
  5454                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5455                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5456                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5457
  5458             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5459                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5460                 88  CO-OVRD-BY-R78             VALUE '1'.
  5461                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5462                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5463                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5464                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5465                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page  99
* EL131.cbl
  5466                 88  CO-OVRD-MEAN               VALUE '8'.
  5467                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5468
  5469             20  CF-CO-BEN-I-G-CD           PIC X.
  5470                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5471                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5472                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5473
  5474         16  FILLER                         PIC X(304).
  5475
  5476
  5477****************************************************************
  5478*             CARRIER MASTER RECORD                            *
  5479****************************************************************
  5480
  5481     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5482         16  CF-ADDRESS-DATA.
  5483             20  CF-MAIL-TO-NAME            PIC X(30).
  5484             20  CF-IN-CARE-OF              PIC X(30).
  5485             20  CF-ADDRESS-LINE-1          PIC X(30).
  5486             20  CF-ADDRESS-LINE-2          PIC X(30).
  5487             20  CF-CITY-STATE              PIC X(30).
  5488             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5489             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5490
  5491         16  CF-CLAIM-NO-CONTROL.
  5492             20  CF-CLAIM-NO-METHOD         PIC X.
  5493                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5494                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5495                 88  CLAIM-NO-SEQ               VALUE '3'.
  5496                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5497             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5498                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5499                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5500                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5501
  5502         16  CF-CHECK-NO-CONTROL.
  5503             20  CF-CHECK-NO-METHOD         PIC X.
  5504                 88  CHECK-NO-MANUAL            VALUE '1'.
  5505                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5506                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5507                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5508             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5509                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5510
  5511         16  CF-DOMICILE-STATE              PIC XX.
  5512
  5513         16  CF-EXPENSE-CONTROLS.
  5514             20  CF-EXPENSE-METHOD          PIC X.
  5515                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5516                 88  DOLLARS-PER-PMT            VALUE '2'.
  5517                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5518                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5519             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5520             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5521
  5522         16  CF-CORRESPONDENCE-CONTROL.
  5523             20  CF-LETTER-RESEND-OPT       PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 100
* EL131.cbl
  5524                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5525                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5526             20  FILLER                     PIC X(4).
  5527
  5528         16  CF-RESERVE-CONTROLS.
  5529             20  CF-MANUAL-SW               PIC X.
  5530                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5531             20  CF-FUTURE-SW               PIC X.
  5532                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5533             20  CF-PTC-SW                  PIC X.
  5534                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5535             20  CF-IBNR-SW                 PIC X.
  5536                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5537             20  CF-PTC-LF-SW               PIC X.
  5538                 88  CF-LF-PTC-USED             VALUE '1'.
  5539             20  CF-CDT-ACCESS-METHOD       PIC X.
  5540                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5541                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5542                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5543             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5544
  5545         16  CF-CLAIM-CALC-METHOD           PIC X.
  5546             88  360-PLUS-MONTHS                VALUE '1'.
  5547             88  365-PLUS-MONTHS                VALUE '2'.
  5548             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5549             88  360-DAILY                      VALUE '4'.
  5550             88  365-DAILY                      VALUE '5'.
  5551
  5552         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5553         16  FILLER                         PIC X(11).
  5554
  5555         16  CF-LIMIT-AMOUNTS.
  5556             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5557             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5558             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5559             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5560             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5561             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5562             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5563             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5564             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5565             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5566
  5567         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5568         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5569         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5570
  5571         16  CF-ZIP-CODE.
  5572             20  CF-ZIP-PRIME.
  5573                 24  CF-ZIP-1ST             PIC X.
  5574                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5575                 24  FILLER                 PIC X(4).
  5576             20  CF-ZIP-PLUS4               PIC X(4).
  5577         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5578             20  CF-CAN-POSTAL-1            PIC XXX.
  5579             20  CF-CAN-POSTAL-2            PIC XXX.
  5580             20  FILLER                     PIC XXX.
  5581
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 101
* EL131.cbl
  5582         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5583         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5584         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5585
  5586         16  CF-RATING-SWITCH               PIC X.
  5587             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5588             88  CF-NO-RATING                   VALUE 'N'.
  5589
  5590         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5591
  5592         16  CF-CARRIER-OVER-SHORT.
  5593             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5594             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5595
  5596         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5597         16  CF-SECPAY-SWITCH               PIC X.
  5598             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5599             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5600         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5601         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5602         16  FILLER                         PIC X(444).
  5603*        16  FILLER                         PIC X(452).
  5604
  5605
  5606****************************************************************
  5607*             MORTALITY MASTER RECORD                          *
  5608****************************************************************
  5609
  5610     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5611         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5612                                INDEXED BY CF-MORT-NDX.
  5613             20  CF-MORT-TABLE              PIC X(5).
  5614             20  CF-MORT-TABLE-TYPE         PIC X.
  5615                 88  CF-MORT-JOINT              VALUE 'J'.
  5616                 88  CF-MORT-SINGLE             VALUE 'S'.
  5617                 88  CF-MORT-COMBINED           VALUE 'C'.
  5618                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5619                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5620             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5621             20  CF-MORT-AGE-METHOD         PIC XX.
  5622                 88  CF-AGE-LAST                VALUE 'AL'.
  5623                 88  CF-AGE-NEAR                VALUE 'AN'.
  5624             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5625             20  CF-MORT-ADJUSTMENT-DIRECTION
  5626                                            PIC X.
  5627                 88  CF-MINUS                   VALUE '-'.
  5628                 88  CF-PLUS                    VALUE '+'.
  5629             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5630             20  CF-MORT-JOINT-CODE         PIC X.
  5631                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5632             20  CF-MORT-PC-Q               PIC X.
  5633                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5634             20  CF-MORT-TABLE-CODE         PIC X(4).
  5635             20  CF-MORT-COMMENTS           PIC X(15).
  5636             20  FILLER                     PIC X(14).
  5637
  5638         16  FILLER                         PIC X(251).
  5639
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 102
* EL131.cbl
  5640
  5641****************************************************************
  5642*             BUSSINESS TYPE MASTER RECORD                     *
  5643****************************************************************
  5644
  5645     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5646* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5647* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5648* AND RECORD 05 IS TYPES 81-99
  5649         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5650             20  CF-BUSINESS-TITLE          PIC  X(19).
  5651             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5652                                            PIC S9V9(4) COMP-3.
  5653             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5654             20  FILLER                     PIC  X.
  5655         16  FILLER                         PIC  X(248).
  5656
  5657
  5658****************************************************************
  5659*             TERMINAL MASTER RECORD                           *
  5660****************************************************************
  5661
  5662     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5663
  5664         16  CF-COMPANY-TERMINALS.
  5665             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5666                                  PIC X(4).
  5667         16  FILLER               PIC X(248).
  5668
  5669
  5670****************************************************************
  5671*             LIFE EDIT MASTER RECORD                          *
  5672****************************************************************
  5673
  5674     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5675         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5676             20  CF-LIFE-CODE-IN            PIC XX.
  5677             20  CF-LIFE-CODE-OUT           PIC XX.
  5678         16  FILLER                         PIC X(248).
  5679
  5680
  5681****************************************************************
  5682*             AH EDIT MASTER RECORD                            *
  5683****************************************************************
  5684
  5685     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5686         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5687             20  CF-AH-CODE-IN              PIC XXX.
  5688             20  CF-AH-CODE-OUT             PIC XX.
  5689         16  FILLER                         PIC X(248).
  5690
  5691
  5692****************************************************************
  5693*             CREDIBILITY TABLES                               *
  5694****************************************************************
  5695
  5696     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5697         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 103
* EL131.cbl
  5698                             INDEXED BY CF-CRDB-NDX.
  5699             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5700             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5701             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5702         16  FILLER                         PIC  X(332).
  5703
  5704
  5705****************************************************************
  5706*             REPORT CUSTOMIZATION RECORD                      *
  5707****************************************************************
  5708
  5709     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5710         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5711             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5712             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5713             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5714**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5715****       A T-TRANSFER.                                   ****
  5716             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5717
  5718         16  FILLER                         PIC XX.
  5719
  5720         16  CF-CARRIER-CNTL-OPT.
  5721             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5722                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5723                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5724             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5725                                            PIC X.
  5726         16  CF-GROUP-CNTL-OPT.
  5727             20  CF-GROUP-OPT-SEQ           PIC 9.
  5728                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5729                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5730             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5731                                            PIC X(6).
  5732         16  CF-STATE-CNTL-OPT.
  5733             20  CF-STATE-OPT-SEQ           PIC 9.
  5734                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5735                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5736             20  CF-STATE-SELECT OCCURS 3 TIMES
  5737                                            PIC XX.
  5738         16  CF-ACCOUNT-CNTL-OPT.
  5739             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5740                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5741                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5742             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5743                                            PIC X(10).
  5744         16  CF-BUS-TYP-CNTL-OPT.
  5745             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5746                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5747                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5748             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5749                                            PIC XX.
  5750         16  CF-LF-TYP-CNTL-OPT.
  5751             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5752                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5753                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5754             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5755                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 104
* EL131.cbl
  5756         16  CF-AH-TYP-CNTL-OPT.
  5757             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5758                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5759                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5760             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5761                                            PIC XX.
  5762         16  CF-REPTCD1-CNTL-OPT.
  5763             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5764                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5765                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5766             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5767                                            PIC X(10).
  5768         16  CF-REPTCD2-CNTL-OPT.
  5769             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5770                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5771                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5772             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5773                                            PIC X(10).
  5774         16  CF-USER1-CNTL-OPT.
  5775             20  CF-USER1-OPT-SEQ           PIC 9.
  5776                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5777                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5778             20  CF-USER1-SELECT OCCURS 3 TIMES
  5779                                            PIC X(10).
  5780         16  CF-USER2-CNTL-OPT.
  5781             20  CF-USER2-OPT-SEQ           PIC 9.
  5782                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5783                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5784             20  CF-USER2-SELECT OCCURS 3 TIMES
  5785                                            PIC X(10).
  5786         16  CF-USER3-CNTL-OPT.
  5787             20  CF-USER3-OPT-SEQ           PIC 9.
  5788                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5789                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5790             20  CF-USER3-SELECT OCCURS 3 TIMES
  5791                                            PIC X(10).
  5792         16  CF-USER4-CNTL-OPT.
  5793             20  CF-USER4-OPT-SEQ           PIC 9.
  5794                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5795                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5796             20  CF-USER4-SELECT OCCURS 3 TIMES
  5797                                            PIC X(10).
  5798         16  CF-USER5-CNTL-OPT.
  5799             20  CF-USER5-OPT-SEQ           PIC 9.
  5800                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5801                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5802             20  CF-USER5-SELECT OCCURS 3 TIMES
  5803                                            PIC X(10).
  5804         16  CF-REINS-CNTL-OPT.
  5805             20  CF-REINS-OPT-SEQ           PIC 9.
  5806                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5807                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5808             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5809                 24  CF-REINS-PRIME         PIC XXX.
  5810                 24  CF-REINS-SUB           PIC XXX.
  5811
  5812         16  CF-AGENT-CNTL-OPT.
  5813             20  CF-AGENT-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 105
* EL131.cbl
  5814                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5815                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5816             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5817                                            PIC X(10).
  5818
  5819         16  FILLER                         PIC X(43).
  5820
  5821         16  CF-LOSS-RATIO-SELECT.
  5822             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5823             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5824         16  CF-ENTRY-DATE-SELECT.
  5825             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5826             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5827         16  CF-EFFECTIVE-DATE-SELECT.
  5828             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5829             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5830
  5831         16  CF-EXCEPTION-LIST-IND          PIC X.
  5832             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5833
  5834         16  FILLER                         PIC X(318).
  5835
  5836****************************************************************
  5837*                  EXCEPTION REPORTING RECORD                  *
  5838****************************************************************
  5839
  5840     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5841         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5842             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5843
  5844         16  CF-COMBINED-LIFE-AH-OPT.
  5845             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5846             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5847             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5848             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5849
  5850         16  CF-LIFE-OPT.
  5851             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5852             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5853             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5854             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5855             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5856             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5857             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5858             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5859             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5860             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5861
  5862         16  CF-AH-OPT.
  5863             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5864             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5865             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5866             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5867             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5868             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5869             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5870             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5871             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 106
* EL131.cbl
  5872             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5873
  5874         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5875             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5876             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5877             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5878
  5879         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5880
  5881         16  FILLER                         PIC X(673).
  5882
  5883
  5884****************************************************************
  5885*             MORTGAGE SYSTEM PLAN RECORD                      *
  5886****************************************************************
  5887
  5888     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5889         16  CF-PLAN-TYPE                   PIC X.
  5890             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5891             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5892             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5893         16  CF-PLAN-ABBREV                 PIC XXX.
  5894         16  CF-PLAN-DESCRIPT               PIC X(10).
  5895         16  CF-PLAN-NOTES                  PIC X(20).
  5896         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5897         16  CF-PLAN-UNDERWRITING.
  5898             20  CF-PLAN-TERM-DATA.
  5899                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5900                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5901             20  CF-PLAN-AGE-DATA.
  5902                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5903                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5904                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5905             20  CF-PLAN-BENEFIT-DATA.
  5906                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5907                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5908                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5909                                            PIC S9(7)V99  COMP-3.
  5910         16  CF-PLAN-POLICY-FORMS.
  5911             20  CF-POLICY-FORM             PIC X(12).
  5912             20  CF-MASTER-APPLICATION      PIC X(12).
  5913             20  CF-MASTER-POLICY           PIC X(12).
  5914         16  CF-PLAN-RATING.
  5915             20  CF-RATE-CODE               PIC X(5).
  5916             20  CF-SEX-RATING              PIC X.
  5917                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5918                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5919             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5920             20  CF-SUB-STD-TYPE            PIC X.
  5921                 88  CF-PCT-OF-PREM            VALUE '1'.
  5922                 88  CF-PCT-OF-BENE            VALUE '2'.
  5923         16  CF-PLAN-PREM-TOLERANCES.
  5924             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5925             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5926         16  CF-PLAN-PYMT-TOLERANCES.
  5927             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5928             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5929         16  CF-PLAN-MISC-DATA.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 107
* EL131.cbl
  5930             20  FILLER                     PIC X.
  5931             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5932             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5933         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5934         16  CF-PLAN-IND-GRP                PIC X.
  5935             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5936                                                     '1'.
  5937             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5938                                                     '2'.
  5939         16  CF-MIB-SEARCH-SW               PIC X.
  5940             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5941             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5942             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5943             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5944         16  CF-ALPHA-SEARCH-SW             PIC X.
  5945             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5946             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5947             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5948             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5949             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5950             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5951             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5952             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5953             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5954             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5955                                                     'A' 'B' 'C'
  5956                                                     'X' 'Y' 'Z'.
  5957         16  CF-EFF-DT-RULE-SW              PIC X.
  5958             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5959             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5960             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5961             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5962             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5963         16  FILLER                         PIC X(4).
  5964         16  CF-HEALTH-QUESTIONS            PIC X.
  5965             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5966         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5967         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5968         16  CF-PLAN-SNGL-JNT               PIC X.
  5969             88  CF-COMBINED-PLAN              VALUE 'C'.
  5970             88  CF-JNT-PLAN                   VALUE 'J'.
  5971             88  CF-SNGL-PLAN                  VALUE 'S'.
  5972         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5973         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5974         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5975         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5976         16  CF-RERATE-CNTL                 PIC  X.
  5977             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5978             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5979             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5980             88  CF-AUTO-RECALC                 VALUE '4'.
  5981         16  CF-BENEFIT-TYPE                PIC  X.
  5982             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5983             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5984         16  CF-POLICY-FEE                  PIC S999V99
  5985                                                    COMP-3.
  5986         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5987         16  CF-2ND-NOTICE-FORM             PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 108
* EL131.cbl
  5988         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5989         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5990         16  FILLER                         PIC  X(32).
  5991         16  CF-TERMINATION-FORM            PIC  X(04).
  5992         16  FILLER                         PIC  X(08).
  5993         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5994                                                       COMP-3.
  5995         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5996         16  CF-ISSUE-LETTER                PIC  X(4).
  5997         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5998         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5999             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6000             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6001         16  CF-MP-REFUND-CALC              PIC X.
  6002             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6003             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6004             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6005             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6006             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6007             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6008             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6009             88  CF-MP-REFD-MEAN                VALUE '8'.
  6010         16  CF-ALT-RATE-CODE               PIC  X(5).
  6011
  6012
  6013         16  FILLER                         PIC X(498).
  6014****************************************************************
  6015*             MORTGAGE COMPANY MASTER RECORD                   *
  6016****************************************************************
  6017
  6018     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6019         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6020         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6021             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6022             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6023             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6024             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6025             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6026
  6027         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6028         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6029         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6030         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6031         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6032
  6033         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6034             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6035         16  CF-MP-RECON-USE-IND            PIC X(1).
  6036             88  CF-MP-USE-RECON             VALUE 'Y'.
  6037         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6038             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6039         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6040             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6041             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6042         16  FILLER                         PIC X(1).
  6043         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6044             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6045         16  CF-MORTG-MIB-VERSION           PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 109
* EL131.cbl
  6046             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6047             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6048             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6049         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6050             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6051                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6052             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6053                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6054             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6055                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6056             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6057                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6058             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6059                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6060             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6061                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6062         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6063         16  FILLER                         PIC X(7).
  6064         16  CF-MORTG-DESTINATION-SYMBOL.
  6065             20  CF-MORTG-MIB-COMM          PIC X(5).
  6066             20  CF-MORTG-MIB-TERM          PIC X(5).
  6067         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6068             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6069         16  FILLER                         PIC X(03).
  6070         16  CF-MP-CHECK-NO-CONTROL.
  6071             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6072                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6073                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6074                                                ' ' LOW-VALUES.
  6075                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6076                                               VALUE '3'.
  6077         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6078         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6079         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6080             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6081                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6082             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6083                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6084             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6085                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6086             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6087                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6088             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6089                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6090             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6091                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6092         16  CF-MORTG-BILLING-AREA.
  6093             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6094                                            PIC X.
  6095         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6096         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6097         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6098         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6099             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6100             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6101         16  FILLER                         PIC X.
  6102         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6103             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 110
* EL131.cbl
  6104             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6105         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6106         16  FILLER                         PIC X(8).
  6107         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6108         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6109         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6110         16  CF-ACH-COMPANY-ID.
  6111             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6112                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6113                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6114                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6115             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6116         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6117             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6118         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6119             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6120             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6121         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6122         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6123         16  FILLER                         PIC X(536).
  6124
  6125****************************************************************
  6126*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6127****************************************************************
  6128
  6129     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6130         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6131             20  CF-FEMALE-HEIGHT.
  6132                 24  CF-FEMALE-FT           PIC 99.
  6133                 24  CF-FEMALE-IN           PIC 99.
  6134             20  CF-FEMALE-MIN-WT           PIC 999.
  6135             20  CF-FEMALE-MAX-WT           PIC 999.
  6136         16  FILLER                         PIC X(428).
  6137
  6138     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6139         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6140             20  CF-MALE-HEIGHT.
  6141                 24  CF-MALE-FT             PIC 99.
  6142                 24  CF-MALE-IN             PIC 99.
  6143             20  CF-MALE-MIN-WT             PIC 999.
  6144             20  CF-MALE-MAX-WT             PIC 999.
  6145         16  FILLER                         PIC X(428).
  6146******************************************************************
  6147*             AUTOMATIC ACTIVITY RECORD                          *
  6148******************************************************************
  6149     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6150         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6151             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6152             20  CF-SYS-LETTER-ID           PIC X(04).
  6153             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6154             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6155             20  CF-SYS-RESET-SW            PIC X(01).
  6156             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6157             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6158
  6159         16  FILLER                         PIC X(50).
  6160
  6161         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 111
* EL131.cbl
  6162             20  CF-USER-ACTIVE-SW          PIC X(01).
  6163             20  CF-USER-LETTER-ID          PIC X(04).
  6164             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6165             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6166             20  CF-USER-RESET-SW           PIC X(01).
  6167             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6168             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6169             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6170
  6171         16  FILLER                         PIC X(246).
  6172
  6173*                                COPY ELCACTQ.
  6174******************************************************************
  6175*                                                                *
  6176*                            ELCACTQ.                            *
  6177*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6178*                            VMOD=2.004                          *
  6179*                                                                *
  6180*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6181*                                                                *
  6182*   FILE TYPE = VSAM,KSDS                                        *
  6183*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6184*                                                                *
  6185*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6186*       ALTERNATE INDEX = NONE                                   *
  6187*                                                                *
  6188*   LOG = YES                                                    *
  6189*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6190*                                                                *
  6191*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6192******************************************************************
  6193
  6194 01  ACTIVITY-QUE.
  6195     12  AQ-RECORD-ID                PIC XX.
  6196         88  VALID-AQ-ID                VALUE 'AQ'.
  6197
  6198     12  AQ-CONTROL-PRIMARY.
  6199         16  AQ-COMPANY-CD           PIC X.
  6200         16  AQ-CARRIER              PIC X.
  6201         16  AQ-CLAIM-NO             PIC X(7).
  6202         16  AQ-CERT-NO.
  6203             20  AQ-CERT-PRIME       PIC X(10).
  6204             20  AQ-CERT-SFX         PIC X.
  6205
  6206     12  AQ-PENDING-ACTIVITY-FLAGS.
  6207         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6208         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6209             88  PENDING-PAYMENTS       VALUE '1'.
  6210         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6211             88  PENDING-FULL-PRINT     VALUE '1'.
  6212             88  PENDING-PART-PRINT     VALUE '2'.
  6213         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6214             88  PENDING-LETTERS        VALUE '1'.
  6215         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6216             88  PENDING-RESTORE        VALUE 'C'.
  6217             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6218
  6219     12  FILLER                      PIC X(20).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 112
* EL131.cbl
  6220
  6221     12  AQ-RESEND-DATE              PIC XX.
  6222     12  AQ-FOLLOWUP-DATE            PIC XX.
  6223     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6224     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6225     12  AQ-AUTO-LETTER              PIC X(4).
  6226     12  FILLER                      PIC XX.
  6227     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6228*****************************************************************
  6229
  6230*                                COPY ERCACCT.
  6231******************************************************************
  6232*                                                                *
  6233*                                                                *
  6234*                            ERCACCT                             *
  6235*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6236*                            VMOD=2.031                          *
  6237*                                                                *
  6238*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6239*                                                                *
  6240*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6241*   VSAM ACCOUNT MASTER FILES.                                   *
  6242*                                                                *
  6243*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6244*                                                                *
  6245*   FILE TYPE = VSAM,KSDS                                        *
  6246*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6247*                                                                *
  6248*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6249*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6250*                                                                *
  6251*   LOG = NO                                                     *
  6252*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6253*                                                                *
  6254*                                                                *
  6255******************************************************************
  6256*                   C H A N G E   L O G
  6257*
  6258* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6259*-----------------------------------------------------------------
  6260*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6261* EFFECTIVE    NUMBER
  6262*-----------------------------------------------------------------
  6263* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6264* 092705    2005050300006  PEMA  ADD SPP LEASES
  6265* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6266* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6267* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6268* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6269* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6270******************************************************************
  6271
  6272 01  ACCOUNT-MASTER.
  6273     12  AM-RECORD-ID                      PIC XX.
  6274         88  VALID-AM-ID                      VALUE 'AM'.
  6275
  6276     12  AM-CONTROL-PRIMARY.
  6277         16  AM-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 113
* EL131.cbl
  6278         16  AM-MSTR-CNTRL.
  6279             20  AM-CONTROL-A.
  6280                 24  AM-CARRIER            PIC X.
  6281                 24  AM-GROUPING.
  6282                     28 AM-GROUPING-PREFIX PIC XXX.
  6283                     28 AM-GROUPING-PRIME  PIC XXX.
  6284                 24  AM-STATE              PIC XX.
  6285                 24  AM-ACCOUNT.
  6286                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6287                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6288             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6289                                           PIC X(19).
  6290             20  AM-CNTRL-B.
  6291                 24  AM-EXPIRATION-DT      PIC XX.
  6292                 24  FILLER                PIC X(4).
  6293             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6294                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6295
  6296     12  AM-CONTROL-BY-VAR-GRP.
  6297         16  AM-COMPANY-CD-A1              PIC X.
  6298         16  AM-VG-CARRIER                 PIC X.
  6299         16  AM-VG-GROUPING                PIC X(6).
  6300         16  AM-VG-STATE                   PIC XX.
  6301         16  AM-VG-ACCOUNT                 PIC X(10).
  6302         16  AM-VG-DATE.
  6303             20  AM-VG-EXPIRATION-DT       PIC XX.
  6304             20  FILLER                    PIC X(4).
  6305         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6306                                           PIC 9(11)      COMP-3.
  6307     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6308         16  FILLER                        PIC X(10).
  6309         16  AM-VG-KEY3.
  6310             20  AM-VG3-ACCOUNT            PIC X(10).
  6311             20  AM-VG3-EXP-DT             PIC XX.
  6312         16  FILLER                        PIC X(4).
  6313     12  AM-MAINT-INFORMATION.
  6314         16  AM-LAST-MAINT-DT              PIC XX.
  6315         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6316         16  AM-LAST-MAINT-USER            PIC X(4).
  6317         16  FILLER                        PIC XX.
  6318
  6319     12  AM-EFFECTIVE-DT                   PIC XX.
  6320     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6321
  6322     12  AM-PREV-DATES  COMP-3.
  6323         16  AM-PREV-EXP-DT                PIC 9(11).
  6324         16  AM-PREV-EFF-DT                PIC 9(11).
  6325
  6326     12  AM-REPORT-CODE-1                  PIC X(10).
  6327     12  AM-REPORT-CODE-2                  PIC X(10).
  6328
  6329     12  AM-CITY-CODE                      PIC X(4).
  6330     12  AM-COUNTY-PARISH                  PIC X(6).
  6331
  6332     12  AM-NAME                           PIC X(30).
  6333     12  AM-PERSON                         PIC X(30).
  6334     12  AM-ADDRS                          PIC X(30).
  6335     12  AM-CITY.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 114
* EL131.cbl
  6336         16  AM-ADDR-CITY                  PIC X(28).
  6337         16  AM-ADDR-STATE                 PIC XX.
  6338     12  AM-ZIP.
  6339         16  AM-ZIP-PRIME.
  6340             20  AM-ZIP-PRI-1ST            PIC X.
  6341                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6342             20  FILLER                    PIC X(4).
  6343         16  AM-ZIP-PLUS4                  PIC X(4).
  6344     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6345         16  AM-CAN-POSTAL-1               PIC XXX.
  6346         16  AM-CAN-POSTAL-2               PIC XXX.
  6347         16  FILLER                        PIC XXX.
  6348     12  AM-TEL-NO.
  6349         16  AM-AREA-CODE                  PIC 999.
  6350         16  AM-TEL-PRE                    PIC 999.
  6351         16  AM-TEL-NBR                    PIC 9(4).
  6352     12  AM-TEL-LOC                        PIC X.
  6353         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6354         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6355
  6356     12  AM-COMM-STRUCTURE.
  6357         16  AM-DEFN-1.
  6358             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6359                 24  AM-AGT.
  6360                     28  AM-AGT-PREFIX     PIC X(4).
  6361                     28  AM-AGT-PRIME      PIC X(6).
  6362                 24  AM-COM-TYP            PIC X.
  6363                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6364                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6365                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6366                 24  AM-RECALC-LV-INDIC    PIC X.
  6367                 24  AM-RETRO-LV-INDIC     PIC X.
  6368                 24  AM-GL-CODES           PIC X.
  6369                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6370                 24  FILLER                PIC X(01).
  6371         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6372             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6373                 24  FILLER                PIC X(11).
  6374                 24  AM-L-COMA             PIC XXX.
  6375                 24  AM-J-COMA             PIC XXX.
  6376                 24  AM-A-COMA             PIC XXX.
  6377                 24  FILLER                PIC X(6).
  6378
  6379     12  AM-COMM-CHANGE-STATUS             PIC X.
  6380         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6381
  6382     12  AM-CSR-CODE                       PIC X(4).
  6383
  6384     12  AM-BILLING-STATUS                 PIC X.
  6385         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6386         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6387     12  AM-AUTO-REFUND-SW                 PIC X.
  6388         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6389         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6390     12  AM-GPCD                           PIC 99.
  6391     12  AM-IG                             PIC X.
  6392         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6393         88  AM-HAS-GROUP                     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 115
* EL131.cbl
  6394     12  AM-STATUS                         PIC X.
  6395         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6396         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6397         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6398         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6399         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6400         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6401     12  AM-REMIT-TO                       PIC 99.
  6402     12  AM-ID-NO                          PIC X(11).
  6403
  6404     12  AM-CAL-TABLE                      PIC XX.
  6405     12  AM-LF-DEVIATION                   PIC XXX.
  6406     12  AM-AH-DEVIATION                   PIC XXX.
  6407     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6408     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6409     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6410     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6411     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6412     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6413
  6414     12  AM-USER-FIELDS.
  6415         16  AM-FLD-1                      PIC XX.
  6416         16  AM-FLD-2                      PIC XX.
  6417         16  AM-FLD-3                      PIC XX.
  6418         16  AM-FLD-4                      PIC XX.
  6419         16  AM-FLD-5                      PIC XX.
  6420
  6421     12  AM-1ST-PROD-DATE.
  6422         16  AM-1ST-PROD-YR                PIC XX.
  6423         16  AM-1ST-PROD-MO                PIC XX.
  6424         16  AM-1ST-PROD-DA                PIC XX.
  6425     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6426     12  AM-CERTS-PURGED-DATE.
  6427         16  AM-PUR-YR                     PIC XX.
  6428         16  AM-PUR-MO                     PIC XX.
  6429         16  AM-PUR-DA                     PIC XX.
  6430     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6431     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6432     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6433     12  AM-INACTIVE-DATE.
  6434         16  AM-INA-MO                     PIC 99.
  6435         16  AM-INA-DA                     PIC 99.
  6436         16  AM-INA-YR                     PIC 99.
  6437     12  AM-AR-HI-CERT-DATE                PIC XX.
  6438
  6439     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6440     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6441
  6442     12  AM-OB-PAYMENT-MODE                PIC X.
  6443         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6444         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6445         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6446         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6447
  6448     12  AM-AH-ONLY-INDICATOR              PIC X.
  6449         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6450         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6451
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 116
* EL131.cbl
  6452     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6453
  6454     12  AM-OVER-SHORT.
  6455         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6456         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6457
  6458     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6459     12  AM-DCC-CLP-STATE                  PIC XX.
  6460
  6461     12  AM-RECALC-COMM                    PIC X.
  6462     12  AM-RECALC-REIN                    PIC X.
  6463
  6464     12  AM-REI-TABLE                      PIC XXX.
  6465     12  AM-REI-ET-LF                      PIC X.
  6466     12  AM-REI-ET-AH                      PIC X.
  6467     12  AM-REI-PE-LF                      PIC X.
  6468     12  AM-REI-PE-AH                      PIC X.
  6469     12  AM-REI-PRT-ST                     PIC X.
  6470     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6471     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6472     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6473     12  AM-REI-GROUP-A                    PIC X(6).
  6474     12  AM-REI-MORT                       PIC X(4).
  6475     12  AM-REI-PRT-OW                     PIC X.
  6476     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6477     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6478     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6479     12  AM-REI-GROUP-B                    PIC X(6).
  6480
  6481     12  AM-TRUST-TYPE                     PIC X(2).
  6482
  6483     12  AM-EMPLOYER-STMT-USED             PIC X.
  6484     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6485
  6486     12  AM-STD-AH-TYPE                    PIC XX.
  6487     12  AM-EARN-METHODS.
  6488         16  AM-EARN-METHOD-R              PIC X.
  6489             88 AM-REF-RL-R78                 VALUE 'R'.
  6490             88 AM-REF-RL-PR                  VALUE 'P'.
  6491             88 AM-REF-RL-MEAN                VALUE 'M'.
  6492             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6493         16  AM-EARN-METHOD-L              PIC X.
  6494             88 AM-REF-LL-R78                 VALUE 'R'.
  6495             88 AM-REF-LL-PR                  VALUE 'P'.
  6496             88 AM-REF-LL-MEAN                VALUE 'M'.
  6497             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6498         16  AM-EARN-METHOD-A              PIC X.
  6499             88 AM-REF-AH-R78                 VALUE 'R'.
  6500             88 AM-REF-AH-PR                  VALUE 'P'.
  6501             88 AM-REF-AH-MEAN                VALUE 'M'.
  6502             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6503             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6504             88 AM-REF-AH-NET                 VALUE 'N'.
  6505
  6506     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6507     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6508     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6509
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 117
* EL131.cbl
  6510     12  AM-RET-Y-N                        PIC X.
  6511     12  AM-RET-P-E                        PIC X.
  6512     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6513     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6514     12  AM-RET-GRP                        PIC X(6).
  6515     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6516         16  AM-POOL-PRIME                 PIC XXX.
  6517         16  AM-POOL-SUB                   PIC XXX.
  6518     12  AM-RETRO-EARNINGS.
  6519         16  AM-RET-EARN-R                 PIC X.
  6520         16  AM-RET-EARN-L                 PIC X.
  6521         16  AM-RET-EARN-A                 PIC X.
  6522     12  AM-RET-ST-TAX-USE                 PIC X.
  6523         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6524         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6525     12  AM-RETRO-BEG-EARNINGS.
  6526         16  AM-RET-BEG-EARN-R             PIC X.
  6527         16  AM-RET-BEG-EARN-L             PIC X.
  6528         16  AM-RET-BEG-EARN-A             PIC X.
  6529     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6530     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6531
  6532     12  AM-USER-SELECT-OPTIONS.
  6533         16  AM-USER-SELECT-1              PIC X(10).
  6534         16  AM-USER-SELECT-2              PIC X(10).
  6535         16  AM-USER-SELECT-3              PIC X(10).
  6536         16  AM-USER-SELECT-4              PIC X(10).
  6537         16  AM-USER-SELECT-5              PIC X(10).
  6538
  6539     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6540
  6541     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6542
  6543     12  AM-RPT045A-SWITCH                 PIC X.
  6544         88  RPT045A-OFF                   VALUE 'N'.
  6545
  6546     12  AM-INSURANCE-LIMITS.
  6547         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6548         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6549
  6550     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6551         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6552
  6553     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6554         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6555         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6556
  6557     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6558
  6559     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6560     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6561     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6562     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6563     12  AM-DCC-UEF-STATE                  PIC XX.
  6564     12  FILLER                            PIC XXX.
  6565     12  AM-REPORT-CODE-3                  PIC X(10).
  6566*    12  FILLER                            PIC X(22).
  6567
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 118
* EL131.cbl
  6568     12  AM-RESERVE-DATE.
  6569         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6570         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6571         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6572
  6573     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6574     12  AM-NOTIFICATION-TYPES.
  6575         16  AM-NOTIF-OF-LETTERS           PIC X.
  6576         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6577         16  AM-NOTIF-OF-REPORTS           PIC X.
  6578         16  AM-NOTIF-OF-STATUS            PIC X.
  6579
  6580     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6581         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6582         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6583         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6584         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6585
  6586     12  AM-BENEFIT-CONTROLS.
  6587         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6588             20  AM-BENEFIT-CODE           PIC XX.
  6589             20  AM-BENEFIT-TYPE           PIC X.
  6590             20  AM-BENEFIT-REVISION       PIC XXX.
  6591             20  AM-BENEFIT-REM-TERM       PIC X.
  6592             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6593             20  FILLER                    PIC XX.
  6594         16  FILLER                        PIC X(80).
  6595
  6596     12  AM-TRANSFER-DATA.
  6597         16  AM-TRANSFERRED-FROM.
  6598             20  AM-TRNFROM-CARRIER        PIC X.
  6599             20  AM-TRNFROM-GROUPING.
  6600                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6601                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6602             20  AM-TRNFROM-STATE          PIC XX.
  6603             20  AM-TRNFROM-ACCOUNT.
  6604                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6605                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6606             20  AM-TRNFROM-DTE            PIC XX.
  6607         16  AM-TRANSFERRED-TO.
  6608             20  AM-TRNTO-CARRIER          PIC X.
  6609             20  AM-TRNTO-GROUPING.
  6610                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6611                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6612             20  AM-TRNTO-STATE            PIC XX.
  6613             20  AM-TRNTO-ACCOUNT.
  6614                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6615                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6616             20  AM-TRNTO-DTE              PIC XX.
  6617         16  FILLER                        PIC X(10).
  6618
  6619     12  AM-SAVED-REMIT-TO                 PIC 99.
  6620
  6621     12  AM-COMM-STRUCTURE-SAVED.
  6622         16  AM-DEFN-1-SAVED.
  6623             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6624                 24  AM-AGT-SV             PIC X(10).
  6625                 24  AM-COM-TYP-SV         PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 119
* EL131.cbl
  6626                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6627                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6628                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6629                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6630                 24  FILLER                PIC X.
  6631                 24  AM-GL-CODES-SV        PIC X.
  6632                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6633                 24  FILLER                PIC X.
  6634         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6635             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6636                 24  FILLER                PIC X(11).
  6637                 24  AM-L-COMA-SV          PIC XXX.
  6638                 24  AM-J-COMA-SV          PIC XXX.
  6639                 24  AM-A-COMA-SV          PIC XXX.
  6640                 24  FILLER                PIC X(6).
  6641
  6642     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6643         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6644            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6645            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6646            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6647
  6648     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6649     12  FILLER                            PIC X(120).
  6650
  6651     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6652         16  AM-CONTROL-NAME               PIC X(30).
  6653         16  AM-EXECUTIVE-ONE.
  6654             20  AM-EXEC1-NAME             PIC X(15).
  6655             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6656                                                          COMP-3.
  6657             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6658                                                          COMP-3.
  6659         16  AM-EXECUTIVE-TWO.
  6660             20  AM-EXEC2-NAME             PIC X(15).
  6661             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6662                                                          COMP-3.
  6663             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6664                                                          COMP-3.
  6665
  6666     12  AM-RETRO-ADDITIONAL-DATA.
  6667         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6668         16  AM-RETRO-PREM-P-E             PIC X.
  6669         16  AM-RETRO-CLMS-P-I             PIC X.
  6670         16  AM-RETRO-RET-BRACKET-LF.
  6671             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6672                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6673                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6674             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6675                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6676                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6677             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6678                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6679                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6680         16  AM-RETRO-RET-BRACKET-AH.
  6681             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6682                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6683                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 120
* EL131.cbl
  6684                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6685             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6686                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6687                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6688             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6689                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6690                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6691
  6692     12  AM-COMMENTS.
  6693         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6694
  6695     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6696         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6697         16  AM-FLI-BILLING-CODE           PIC X.
  6698         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6699         16  AM-FLI-UNITED-IDENT           PIC X.
  6700         16  AM-FLI-INTEREST-LOST-DATA.
  6701             20  AM-FLI-BANK-NO            PIC X(5).
  6702             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6703             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6704             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6705         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6706             20  AM-FLI-AGT                PIC X(9).
  6707             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6708             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6709         16  FILLER                        PIC X(102).
  6710
  6711     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6712         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6713             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6714             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6715             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6716             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6717             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6718         16  FILLER                          PIC X(10).
  6719******************************************************************
  6720
  6721*                                COPY ELCCHKQ.
  6722******************************************************************
  6723*                                                                *
  6724*                                                                *
  6725*                            ELCCHKQ.                            *
  6726*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6727*                            VMOD=2.007                          *
  6728*                                                                *
  6729*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6730*                                                                *
  6731*   FILE TYPE = VSAM,KSDS                                        *
  6732*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6733*                                                                *
  6734*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6735*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6736*                                                                *
  6737*   LOG = YES                                                    *
  6738*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6739******************************************************************
  6740 01  CHECK-QUE.
  6741     12  CQ-RECORD-ID                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 121
* EL131.cbl
  6742         88  VALID-CQ-ID         VALUE 'CQ'.
  6743
  6744     12  CQ-CONTROL-PRIMARY.
  6745         16  CQ-COMPANY-CD           PIC X.
  6746         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6747         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6748
  6749     12  CQ-CONTROL-BY-PAYEE.
  6750         16  CQ-CONTROL-BY-NUMBER.
  6751             20  CQ-COMPANY-CD-A1     PIC X.
  6752             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6753         16  CQ-PAYEE-CARRIER        PIC X.
  6754         16  CQ-PAYEE-GROUPING       PIC X(6).
  6755         16  CQ-PAYEE-STATE          PIC XX.
  6756         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6757         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6758
  6759     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6760         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6761         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6762         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6763         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6764         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6765         16  FILLER                  PIC X(3).
  6766
  6767     12  CQ-ENTRY-TYPE               PIC X.
  6768             88  CHECK-ON-QUE           VALUE 'Q'.
  6769             88  ALIGNMENT-CHECK        VALUE 'A'.
  6770             88  SPOILED-CHECK          VALUE 'S'.
  6771             88  PAYMENT-ABORTED        VALUE 'X'.
  6772
  6773     12  CQ-CLAIM-MAST-CNTL.
  6774         16  CQ-CARRIER              PIC X.
  6775         16  CQ-CLAIM-NO             PIC X(7).
  6776         16  CQ-CERT-NO.
  6777             20  CQ-CERT-PRIME       PIC X(10).
  6778             20  CQ-CERT-SFX         PIC X.
  6779         16  CQ-CLAIM-TYPE           PIC X.
  6780             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6781             88  CQ-AH-CLAIM            VALUE 'A'.
  6782         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6783             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6784             88  CQ-O-B-COVERAGE        VALUE '2'.
  6785             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6786
  6787     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6788     12  CQ-CHECK-NUMBER             PIC X(7).
  6789     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6790     12  CQ-PAYMENT-TYPE             PIC X.
  6791             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6792             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6793             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6794             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6795             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6796             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6797             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6798             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6799     12  CQ-VOID-INDICATOR           PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 122
* EL131.cbl
  6800             88  CHECK-IS-STOPPED          VALUE 'S'.
  6801             88  CHECK-IS-VOID             VALUE 'V'.
  6802     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6803     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6804     12  CQ-CHECK-BY-USER            PIC X(4).
  6805     12  CQ-PRE-NUMBERING-SW         PIC X.
  6806       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6807       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6808
  6809     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6810     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6811     12  CQ-LEDGER-FLAG              PIC X(01).
  6812     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6813     12  CQ-LAST-UPDATED-DT          PIC XX.
  6814     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6815     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6816
  6817     12  FILLER                      PIC X(04).
  6818
  6819******************************************************************
  6820
  6821*                                COPY ELCARCH.
  6822******************************************************************
  6823*                                                                *
  6824*                            ELCARCH.                            *
  6825*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6826*                            VMOD=2.007                          *
  6827*                                                                *
  6828*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6829*                                                                *
  6830*   FILE TYPE = VSAM,KSDS                                        *
  6831*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6832*                                                                *
  6833*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6834*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6835*                                                                *
  6836*   LOG = NO                                                     *
  6837*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6838*                                                                *
  6839*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6840******************************************************************
  6841 01  LETTER-ARCHIVE.
  6842     12  LA-RECORD-ID                PIC XX.
  6843         88  VALID-LA-ID                VALUE 'LA'.
  6844
  6845     12  LA-CONTROL-PRIMARY.
  6846         16  LA-COMPANY-CD           PIC X.
  6847         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6848         16  LA-RECORD-TYPE          PIC X.
  6849             88  LA-HEADER-DATA         VALUE '1'.
  6850             88  LA-ADDRESS-DATA        VALUE '2'.
  6851             88  LA-TEXT-DATA           VALUE '3'.
  6852             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6853         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6854
  6855     12  LA-CONTROL-BY-TYPE.
  6856         16  LA-COMPANY-CD-A1        PIC X.
  6857         16  LA-RECORD-TYPE-A1       PIC X.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 123
* EL131.cbl
  6858         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6859         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6860
  6861     12  LA-TEXT-RECORD.
  6862         16  LA-SKIP-CONTROL         PIC XX.
  6863             88  NO-LINES-SKIPPED       VALUE SPACES.
  6864             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6865         16  LA-TEXT-LINE            PIC X(70).
  6866
  6867     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6868         16  FILLER                  PIC XX.
  6869         16  LA-ADDRESS-LINE         PIC X(30).
  6870         16  FILLER                  PIC X(40).
  6871
  6872     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6873         16  FILLER                  PIC XX.
  6874         16  LA-CARRIER              PIC X.
  6875         16  LA-CLAIM-NO             PIC X(7).
  6876         16  LA-CERT-NO.
  6877             20  LA-CERT-PRIME       PIC X(10).
  6878             20  LA-CERT-SFX         PIC X.
  6879         16  LA-NO-OF-COPIES         PIC S9.
  6880         16  LA-RESEND-DATE          PIC XX.
  6881         16  LA-PROCESSOR-CD         PIC X(4).
  6882         16  LA-CREATION-DT          PIC XX.
  6883         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6884         16  LA-RESEND-PRINT-DATE    PIC XX.
  6885         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6886         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6887*
  6888* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6889*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6890*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6891*   I        20  LA-DMD-RES-ST           PIC XX.
  6892*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6893*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6894*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6895*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6896*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6897*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6898*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6899*   I        20  LA-DMD-UND-CODE         PIC XX.
  6900*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6901*   V    16  FILLER                  PIC X(15).
  6902* -----
  6903*
  6904* REINSERTED  CSO  MODS
  6905*
  6906         16  FILLER.
  6907             20  FILLER                  PIC X(29).
  6908             20  LA-CSO-LETTER-STATUS    PIC X.
  6909                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6910                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6911                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6912             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6913             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6914*
  6915
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 124
* EL131.cbl
  6916     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6917         16  FILLER                  PIC XX.
  6918         16  LA4-CARRIER             PIC X.
  6919         16  LA4-CLAIM-NO            PIC X(7).
  6920         16  LA4-CERT-NO.
  6921             20  LA4-CERT-PRIME      PIC X(10).
  6922             20  LA4-CERT-SFX        PIC X.
  6923         16  LA4-NO-OF-COPIES        PIC S9.
  6924         16  LA4-RESEND-DATE         PIC XX.
  6925         16  LA4-PROCESSOR-CD        PIC X(4).
  6926         16  LA4-CREATION-DT         PIC XX.
  6927         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6928         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6929         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6930         16  LA4-FORM-TYPE           PIC X.
  6931             88  LA4-INITIAL-FORM    VALUE '1'.
  6932             88  LA4-PROGRESS-FORM   VALUE '2'.
  6933         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6934         16  LA4-STATE               PIC X(02).
  6935         16  FILLER                  PIC X(31).
  6936******************************************************************
  6937
  6938*                                COPY ELCBENE.
  6939******************************************************************
  6940*                                                                *
  6941*                            ELCBENE.                            *
  6942*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6943*                            VMOD=2.006                          *
  6944*                                                                *
  6945*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6946*                                                                *
  6947*   FILE TYPE = VSAM,KSDS                                        *
  6948*   RECORD SIZE = 500   RECFORM = FIX                            *
  6949*                                                                *
  6950*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6951*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6952*                                                                *
  6953*   LOG = YES                                                    *
  6954*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6955*                                                                *
  6956*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6957******************************************************************
  6958
  6959 01  BENEFICIARY-MASTER.
  6960     12  BE-RECORD-ID                PIC XX.
  6961         88  VALID-BE-ID                VALUE 'BE'.
  6962
  6963     12  BE-CONTROL-PRIMARY.
  6964         16  BE-COMPANY-CD           PIC X.
  6965         16  BE-RECORD-TYPE          PIC X.
  6966             88  BENEFICIARY-RECORD  VALUE 'B'.
  6967             88  ADJUSTOR-RECORD     VALUE 'A'.
  6968         16  BE-BENEFICIARY          PIC X(10).
  6969     12  BE-CONTROL-BY-NAME.
  6970         16  BE-COMPANY-CD-A1        PIC X.
  6971         16  BE-RECORD-TYPE-A1       PIC X.
  6972         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6973         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 125
* EL131.cbl
  6974
  6975     12  BE-LAST-MAINT-DT            PIC XX.
  6976     12  BE-LAST-MAINT-BY            PIC X(4).
  6977     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6978
  6979     12  BE-ADDRESS-DATA.
  6980         16  BE-MAIL-TO-NAME         PIC X(30).
  6981         16  BE-ADDRESS-LINE-1       PIC X(30).
  6982         16  BE-ADDRESS-LINE-2       PIC X(30).
  6983         16  BE-ADDRESS-LINE-3       PIC X(30).
  6984         16  BE-CITY-STATE.
  6985             20  BE-CITY             PIC X(28).
  6986             20  BE-STATE            PIC XX.
  6987         16  BE-ZIP-CODE.
  6988             20  BE-ZIP-PRIME.
  6989                 24  BE-ZIP-1ST      PIC X.
  6990                     88  BE-CANADIAN-POST-CODE
  6991                                         VALUE 'A' THRU 'Z'.
  6992                 24  FILLER          PIC X(4).
  6993             20  BE-ZIP-PLUS4        PIC X(4).
  6994         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6995             20  BE-CAN-POSTAL-1     PIC XXX.
  6996             20  BE-CAN-POSTAL-2     PIC XXX.
  6997             20  FILLER              PIC XXX.
  6998         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6999         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7000
  7001******************************************************************
  7002*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7003*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7004******************************************************************
  7005     12  BE-CARRIER                  PIC X.
  7006
  7007     12  BE-ADDRESS-DATA2.
  7008         16  BE-MAIL-TO-NAME2        PIC X(30).
  7009         16  BE-ADDRESS-LINE-12      PIC X(30).
  7010         16  BE-ADDRESS-LINE-22      PIC X(30).
  7011         16  BE-ADDRESS-LINE-32      PIC X(30).
  7012         16  BE-CITY-STATE2.
  7013             20  BE-CITY2            PIC X(28).
  7014             20  BE-STATE2           PIC XX.
  7015         16  BE-ZIP-CODE2.
  7016             20  BE-ZIP-PRIME2.
  7017                 24  BE-ZIP-1ST2     PIC X.
  7018                     88  BE-CANADIAN-POST-CODE2
  7019                                         VALUE 'A' THRU 'Z'.
  7020                 24  FILLER          PIC X(4).
  7021             20  BE-ZIP-PLUS42       PIC X(4).
  7022         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7023             20  BE-CAN-POSTAL-12    PIC XXX.
  7024             20  BE-CAN-POSTAL-22    PIC XXX.
  7025             20  FILLER              PIC XXX.
  7026         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7027         16  BE-BILLING-STMT-DATA.
  7028             20  BE-BSR              PIC X.
  7029                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7030                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7031             20  BE-BSR-FROM         PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 126
* EL131.cbl
  7032             20  BE-BSR-DEPT         PIC X(30).
  7033             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7034             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7035             20  BE-OUTPUT-TYPE      PIC X.
  7036                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7037                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7038
  7039     12  FILLER                      PIC X(28).
  7040******************************************************************
  7041
  7042*                                COPY ELCDAR.
  7043******************************************************************
  7044*                                                                *
  7045*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7046*   FILE TYPE = VSAM,KSDS                                        *
  7047*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7048*   BASE CLUSTER = DLYACTV                                       *
  7049*   LOG = YES                                                    *
  7050*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7051*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7052*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7053*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7054*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7055*               BY PROGRAM "LGINFCE".                            *
  7056*                                                                *
  7057******************************************************************
  7058 01  DAILY-ACTIVITY-RECORD.
  7059     05  DA-KEY.
  7060         10  DA-COMP-CD          PIC X.
  7061         10  DA-CARRIER          PIC X.
  7062         10  DA-CLAIM-NO         PIC X(7).
  7063         10  DA-CERT-NO.
  7064             15  DA-CERT-PRIME   PIC X(10).
  7065             15  DA-CERT-SFX     PIC X.
  7066     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7067     05  DA-RECORD-TYPE          PIC X.
  7068     05  FILLER                  PIC X(2).
  7069******************************************************************
  7070
  7071*                                COPY ELCALPH.
  7072******************************************************************
  7073*                                                                *
  7074*                            ELCALPH.                            *
  7075*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7076*                            VMOD=2.003                          *
  7077*                                                                *
  7078*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  7079*                                                                *
  7080*   FILE TYPE = VSAM,KSDS                                        *
  7081*   RECORD SIZE = 128  RECFORM = FIXED                           *
  7082*                                                                *
  7083*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  7084*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  7085*                                                                *
  7086*   LOG = YES                                                    *
  7087*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7088*                                                                *
  7089*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 127
* EL131.cbl
  7090******************************************************************
  7091
  7092 01  ALPHA-INDEX.
  7093     12  AI-RECORD-ID                         PIC XX.
  7094         88  VALID-AI-ID                  VALUE 'AI'.
  7095     12  AI-CONTROL-PRIMARY.
  7096         16  AI-COMPANY-CD                     PIC X.
  7097         16  AI-SOURCE                         PIC X.
  7098             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  7099             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  7100         16  AI-NAME.
  7101             20  AI-LAST-NAME                  PIC X(15).
  7102             20  AI-FIRST-NAME.
  7103                 24  AI-FIRST-INITIAL          PIC X.
  7104                 24  FILLER                    PIC X(11).
  7105             20  AI-MIDDLE-INIT                PIC X.
  7106         16  AI-DATE                           PIC X(8).
  7107         16  AI-TIME                           PIC S9(07) COMP-3.
  7108
  7109     12  AI-CONTROL-BY-ADMIN-KEY.
  7110         16  AI-CM-COMPANY-CD                  PIC X.
  7111         16  AI-CM-SOURCE                      PIC X.
  7112         16  AI-CM-CARRIER                     PIC X.
  7113         16  AI-CM-GROUPING.
  7114             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  7115             20  AI-CM-GROUPING-PRIME          PIC X(3).
  7116         16  AI-CM-STATE                       PIC XX.
  7117         16  AI-CM-PRODUCER.
  7118             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  7119             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  7120         16  AI-CM-CERT-EFF-DT                 PIC XX.
  7121         16  AI-CM-CERTIFICATE-NUMBER.
  7122             20  AI-CM-CERT-PRIME              PIC X(10).
  7123             20  AI-CM-CERT-SFX                PIC X.
  7124         16  AI-CM-DATE                        PIC X(8).
  7125         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  7126         16  FILLER                            PIC X(11).
  7127
  7128     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  7129         AI-CONTROL-BY-ADMIN-KEY.
  7130         16  AI-CL-COMPANY-CD                  PIC X.
  7131         16  AI-CL-SOURCE                      PIC X.
  7132         16  AI-CL-CARRIER                     PIC X.
  7133         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  7134         16  AI-CL-CERTIFICATE-NUMBER.
  7135             20  AI-CL-CERT-PRIME              PIC X(10).
  7136             20  AI-CL-CERT-SFX                PIC X.
  7137         16  AI-CL-DATE                        PIC X(8).
  7138         16  AI-CL-INCURRED-DATE               PIC XX.
  7139         16  AI-CL-CLOSE-DATE                  PIC XX.
  7140         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  7141         16  AI-CREDIT-CARD-NUMBER.
  7142             20  AI-CCN.
  7143                 24  AI-CCN-PREFIX             PIC X(4).
  7144                 24  AI-CCN-PRIME              PIC X(12).
  7145             20  AI-CCN-FILLER                 PIC X(4).
  7146
  7147     12  AI-MAINT-INFO.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 128
* EL131.cbl
  7148         16  AI-LAST-MAINT-BY                  PIC X(4).
  7149         16  AI-LAST-MAINT-DT                  PIC XX.
  7150         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7151
  7152     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  7153
  7154     12  FILLER                                PIC X(15).
  7155
  7156
  7157*                                COPY ERCDMDNT.
  7158******************************************************************
  7159*                                                                *
  7160*                            ERCDMDNT                            *
  7161*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7162*                            VMOD=2.005                          *
  7163*                                                                *
  7164*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7165*                                                                *
  7166*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7167*                                                                *
  7168*        FILE TYPE= VSAM,KSDS                                    *
  7169*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7170*                                                                *
  7171*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7172*                                                                *
  7173*        LOG = YES                                               *
  7174*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7175*                                                                *
  7176******************************************************************
  7177
  7178 01  CERTIFICATE-NOTE.
  7179     12  CN-RECORD-ID                     PIC  XX.
  7180         88  VALID-CN-ID                      VALUE 'CN'.
  7181
  7182     12  CN-CONTROL-PRIMARY.
  7183         16  CN-COMPANY-CD                PIC X.
  7184         16  CN-CERT-KEY.
  7185             20  CN-CARRIER               PIC X.
  7186             20  CN-GROUPING.
  7187                 24  CN-GROUPING-PREFIX   PIC XXX.
  7188                 24  CN-GROUPING-PRIME    PIC XXX.
  7189             20  CN-STATE                 PIC XX.
  7190             20  CN-ACCOUNT.
  7191                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7192                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7193             20  CN-CERT-EFF-DT           PIC XX.
  7194             20  CN-CERT-NO.
  7195                 24  CN-CERT-PRIME        PIC X(10).
  7196                 24  CN-CERT-SFX          PIC X.
  7197
  7198     12  CN-BILLING-START-LINE-NO         PIC 99.
  7199     12  CN-BILLING-END-LINE-NO           PIC 99.
  7200
  7201     12  CN-LINES.
  7202         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7203
  7204     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7205         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 129
* EL131.cbl
  7206         16  CN-CSI-GENERAL-DATA-AREA.
  7207             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7208
  7209         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7210             CN-CSI-GENERAL-DATA-AREA.
  7211             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7212             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7213             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7214             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7215             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7216             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7217             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7218             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7219             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7220             20  FILLER                       PIC XX.
  7221             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7222             20  FILLER                       PIC X(38).
  7223
  7224         16  CN-CSI-PRODUCT-DATA-AREA.
  7225             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7226
  7227         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7228             CN-CSI-PRODUCT-DATA-AREA.
  7229             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7230             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7231             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7232             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7233             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7234             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7235             20  FILLER                   PIC XX.
  7236             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7237             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7238             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7239             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7240             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7241             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7242             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7243             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7244             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7245             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7246             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7247             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7248             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7249             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7250             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7251             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7252             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7253             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7254             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7255             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7256             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7257             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7258             20  FILLER                   PIC X(25).
  7259
  7260         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7261             CN-CSI-CREDIT-CARD-DATA.
  7262             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7263             20  CN-CSI-FL-CANCEL-CD      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 130
* EL131.cbl
  7264             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7265             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7266             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7267             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7268             20  FILLER                   PIC XX.
  7269             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7270             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7271             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7272             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7273             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7274             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7275             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7276             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7277             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7278             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7279             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7280             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7281             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7282             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7283             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7284             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7285             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7286             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7287             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7288             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7289             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7290             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7291             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7292             20  FILLER                   PIC X(17).
  7293
  7294         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7295             CN-CSI-FAMILY-LEAVE-DATA.
  7296             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7297             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7298             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7299             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7300             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7301             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7302             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7303             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7304             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7305             20  CN-CSI-SL-INT-ON-PROCEEDS
  7306                                          PIC S9(5)V99  COMP-3.
  7307             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7308             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7309             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7310             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7311             20  CN-CSI-SL-POLICY-BENEFITS
  7312                                          PIC S9(5)V99  COMP-3.
  7313             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7314             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7315             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7316             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7317             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7318             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7319             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7320             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7321             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 131
* EL131.cbl
  7322             20  CN-CSI-SL-STATE-NOT      PIC X.
  7323             20  FILLER                   PIC XX.
  7324
  7325         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7326             CN-CSI-SENIOR-LIFE-DATA.
  7327             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7328             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7329             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7330                                          PIC S9(5)V99  COMP-3.
  7331             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7332             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7333             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7334             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7335             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7336             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7337             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7338             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7339             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7340             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7341             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7342             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7343             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7344             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7345             20  CN-CSI-PP-REPAIR         PIC X.
  7346             20  CN-CSI-PP-REPLACE        PIC X.
  7347             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7348             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7349             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7350             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7351             20  FILLER                   PIC X(5).
  7352
  7353         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7354             CN-CSI-PURCH-PROP-DATA.
  7355             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7356             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7357             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7358             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7359             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7360             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7361             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7362             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7363             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7364             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7365             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7366             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7367             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7368             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7369             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7370             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7371             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7372             20  CN-CSI-EW-REPLACE        PIC X.
  7373             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7374             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7375             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7376             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7377             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7378             20  FILLER                   PIC X(4).
  7379
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 132
* EL131.cbl
  7380     12  CN-LAST-MAINT-DT                 PIC XX.
  7381     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7382     12  CN-LAST-MAINT-USER               PIC X(4).
  7383     12  FILLER                           PIC X(6).
  7384
  7385******************************************************************
  7386
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 133
* EL131.cbl
  7388 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7389                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7390                          CONTROL-FILE ACTIVITY-QUE
  7391                          ACCOUNT-MASTER CHECK-QUE
  7392                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7393                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7394                          CERTIFICATE-NOTE.
  7395 0000-DFHEXIT SECTION.
  7396     MOVE '9#                    $   ' TO DFHEIV0.
  7397     MOVE 'EL131' TO DFHEIV1.
  7398     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7399
  7400     IF EIBCALEN = ZERO
  7401         GO TO 8800-UNAUTHORIZED-ACCESS.
  7402
  7403     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7404     MOVE '5'                    TO DC-OPTION-CODE.
  7405     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7406     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7407     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7408     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7409
  7410     IF SAVE-DATE-YY GREATER 70
  7411         MOVE 19                 TO SAVE-DATE-CC
  7412      ELSE
  7413         MOVE 20                 TO SAVE-DATE-CC.
  7414
  7415
  7416* EXEC CICS HANDLE CONDITION
  7417*        PGMIDERR (8820-XCTL-ERROR)
  7418*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7419*        ERROR    (9990-ABEND)
  7420*    END-EXEC.
  7421*    MOVE '"$LI.                 ! " #00007411' TO DFHEIV0
  7422     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7423     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7424     MOVE X'2220233030303037343131' TO DFHEIV0(25:11)
  7425     CALL 'kxdfhei1' USING DFHEIV0
  7426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7427
  7428
  7429     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7430     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7431     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7432
  7433     INITIALIZE    EDIT-WORK-AREA.
  7434     MOVE '/'                    TO WORK-SLASH.
  7435     MOVE SPACES                 TO ERROR-SWITCHES.
  7436
  7437     MOVE TRAN-ID                TO TRANS-ID.
  7438     MOVE EIBTRMID               TO PI-TERM.
  7439     MOVE MAP-ID                 TO PI-QUAL.
  7440
  7441     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7442
  7443     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7444         MOVE LOW-VALUES         TO EL131AO
  7445         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 134
* EL131.cbl
  7446         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7447         MOVE -1                 TO MAINTL
  7448         GO TO 8110-SEND-DATA.
  7449
  7450     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7451         MOVE LOW-VALUES         TO EL131AO
  7452         MOVE PI-CALLING-PROGRAM TO WS-RETURNED-FROM
  7453         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7454         MOVE 'X'                TO PI-RETURN-CD-1
  7455         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7456         MOVE -1                 TO MAINTL
  7457         IF WS-RETURNED-FROM = XCTL-EL114
  7458             PERFORM 4200-LOAD-CHANGES THRU 4200-EXIT
  7459         END-IF
  7460         GO TO 8100-SEND-MAP.
  7461
  7462     IF EIBAID = DFHCLEAR
  7463         GO TO 8200-RETURN-PRIOR.
  7464
  7465     IF PI-PROCESSOR-ID = 'LGXX'
  7466         NEXT SENTENCE
  7467     ELSE
  7468
  7469* EXEC CICS READQ TS
  7470*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7471*            INTO    (SECURITY-CONTROL)
  7472*            LENGTH  (SC-COMM-LENGTH)
  7473*            ITEM    (SC-ITEM)
  7474*        END-EXEC
  7475*    MOVE '*$II   L              ''   #00007456' TO DFHEIV0
  7476     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7477     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7478     MOVE X'2020233030303037343536' TO DFHEIV0(25:11)
  7479     CALL 'kxdfhei1' USING DFHEIV0,
  7480           PI-SECURITY-TEMP-STORE-ID,
  7481           SECURITY-CONTROL,
  7482           SC-COMM-LENGTH,
  7483           SC-ITEM,
  7484           DFHEIV99,
  7485           DFHEIV99
  7486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7487         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7488         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7489         IF NOT DISPLAY-CAP
  7490             MOVE 'READ'               TO  SM-READ
  7491             PERFORM 9995-SECURITY-VIOLATION
  7492             MOVE ER-0070              TO  EMI-ERROR
  7493             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7494             GO TO 8100-SEND-MAP.
  7495
  7496
  7497* EXEC CICS RECEIVE
  7498*        MAP    ('EL131A')
  7499*        MAPSET ('EL131S')
  7500*    END-EXEC.
  7501     MOVE 'EL131A' TO DFHEIV1
  7502     MOVE 'EL131S' TO DFHEIV2
  7503*    MOVE '8"T                   ''   #00007471' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 135
* EL131.cbl
  7504     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7505     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7506     MOVE X'2020233030303037343731' TO DFHEIV0(25:11)
  7507     CALL 'kxdfhei1' USING DFHEIV0,
  7508           DFHEIV1,
  7509           EL131AI,
  7510           DFHEIV99,
  7511           DFHEIV2,
  7512           DFHEIV99,
  7513           DFHEIV99
  7514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7515
  7516
  7517     IF PFKEYL GREATER THAN ZERO
  7518         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7519
  7520     IF SCREEN-ERROR
  7521         MOVE ER-0004 TO EMI-ERROR
  7522         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7523         MOVE -1 TO MAINTL
  7524         GO TO 8110-SEND-DATA.
  7525
  7526     IF EIBAID = DFHPF3
  7527         GO TO 8500-TRLR-MNT.
  7528
  7529     IF EIBAID = DFHPF4
  7530         GO TO 8600-ADDR-MNT.
  7531
  7532     IF EIBAID = DFHPF5
  7533         GO TO 8700-CERT-MNT.
  7534
  7535     IF PI-COMPANY-ID = 'DMD'
  7536       IF EIBAID = DFHPF6
  7537         GO TO 8750-DMD-CLM-FIX.
  7538
  7539     IF EIBAID = DFHPF7
  7540         GO TO 4000-FORCE-ERRORS.
  7541
  7542     IF EIBAID = DFHPF12
  7543         GO TO 8300-GET-HELP.
  7544
  7545     IF EIBAID = DFHPF15
  7546         GO TO 8725-BENEFICIARY-MNT
  7547     END-IF.
  7548
  7549     IF EIBAID = DFHPF23
  7550         GO TO 8810-PF23-ENTERED.
  7551
  7552     IF EIBAID = DFHPF24
  7553         GO TO 8400-RETURN-MASTER.
  7554
  7555     IF EIBAID NOT = DFHENTER
  7556         MOVE ER-0029            TO EMI-ERROR
  7557         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7558         MOVE -1                 TO MAINTL
  7559         GO TO 8110-SEND-DATA.
  7560
  7561     IF PI-RETURN-CD-1 =  'X'
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 136
* EL131.cbl
  7562         MOVE ER-0311            TO EMI-ERROR
  7563         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7564         MOVE -1                 TO MAINTL
  7565         GO TO 8110-SEND-DATA.
  7566
  7567     IF MAINTI = 'A'
  7568         GO TO 0500-ADD-ALPHA-ONLY.
  7569
  7570     IF MAINTI = 'N'
  7571         GO TO 0600-CHANGE-NAME.
  7572
  7573     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7574
  7575     IF SCREEN-ERROR
  7576         GO TO 8110-SEND-DATA.
  7577
  7578     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7579         MOVE ER-0276            TO EMI-ERROR
  7580         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7581         MOVE -1                 TO MAINTL
  7582         GO TO 8110-SEND-DATA.
  7583
  7584     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7585
  7586     IF SCREEN-ERROR
  7587         GO TO 8110-SEND-DATA.
  7588
  7589     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7590
  7591     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7592
  7593     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7594         GO TO 8110-SEND-DATA.
  7595
  7596     IF EMI-FATAL-CTR GREATER THAN ZERO
  7597         GO TO 8110-SEND-DATA.
  7598
  7599     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7600
  7601     IF WS-OPEN-CLOSE-SW = 'Y'
  7602         IF PI-LETTER-SW = 'Y'
  7603             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7604             MOVE 'T'            TO  CNTL-REC-TYPE
  7605             MOVE SPACES         TO  CNTL-PROC-ID
  7606             MOVE +0             TO  CNTL-SEQ-NO
  7607
  7608* EXEC CICS READ
  7609*                DATASET   (CNTL-FILE-ID)
  7610*                RIDFLD    (CNTL-KEY)
  7611*                SET       (ADDRESS OF CONTROL-FILE)
  7612*            END-EXEC
  7613*    MOVE '&"S        E          (   #00007566' TO DFHEIV0
  7614     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7615     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7616     MOVE X'2020233030303037353636' TO DFHEIV0(25:11)
  7617     CALL 'kxdfhei1' USING DFHEIV0,
  7618           CNTL-FILE-ID,
  7619           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 137
* EL131.cbl
  7620           DFHEIV99,
  7621           CNTL-KEY,
  7622           DFHEIV99,
  7623           DFHEIV99,
  7624           DFHEIV99
  7625     SET ADDRESS OF CONTROL-FILE TO
  7626         DFHEIV20
  7627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7628             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7629
  7630     MOVE ER-0000                TO EMI-ERROR.
  7631     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7632
  7633     MOVE SPACE                  TO MAINTO.
  7634     MOVE -1                     TO MAINTL.
  7635     GO TO 8100-SEND-MAP.
  7636
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 138
* EL131.cbl
  7638 0100-UPDATE-PI.
  7639
  7640     MOVE LOW-VALUES             TO WS-SAVE-BENEFICIARY.
  7641     IF WS-RETURNED-FROM = XCTL-EL114
  7642***sometimes there is crap in positions 7-10 when no code was sele
  7643        IF PI-PROGRAM-WORK-AREA (1:5) > SPACES
  7644          MOVE PI-PROGRAM-WORK-AREA (1:10) TO WS-SAVE-BENEFICIARY
  7645        END-IF
  7646     END-IF.
  7647
  7648     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7649         GO TO 0110-UPDATE-UP.
  7650
  7651     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7652     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7653     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7654     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7655     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7656     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7657     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7658     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7659     GO TO 0120-UPDATE-PI-EXIT.
  7660
  7661 0110-UPDATE-UP.
  7662     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7663     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7664     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7665     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7666     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7667     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7668     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7669     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7670
  7671
  7672* EXEC CICS HANDLE CONDITION
  7673*         QIDERR    (0130-TS-ERROR)
  7674*         ITEMERR   (0130-TS-ERROR)
  7675*    END-EXEC.
  7676*    MOVE '"$N<                  ! # #00007614' TO DFHEIV0
  7677     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7678     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7679     MOVE X'2320233030303037363134' TO DFHEIV0(25:11)
  7680     CALL 'kxdfhei1' USING DFHEIV0
  7681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7682
  7683
  7684     IF WS-RETURNED-FROM = XCTL-EL114
  7685
  7686* EXEC CICS READQ TS
  7687*            QUEUE    (PI-KEY)
  7688*            INTO     (EL131AI)
  7689*            LENGTH   (MAP-LENGTH)
  7690*       END-EXEC
  7691*    MOVE '*$I    L              ''   #00007620' TO DFHEIV0
  7692     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7693     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7694     MOVE X'2020233030303037363230' TO DFHEIV0(25:11)
  7695     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 139
* EL131.cbl
  7696           PI-KEY,
  7697           EL131AI,
  7698           MAP-LENGTH,
  7699           DFHEIV99,
  7700           DFHEIV99,
  7701           DFHEIV99
  7702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7703
  7704        IF WS-SAVE-BENEFICIARY > SPACES
  7705            MOVE WS-SAVE-BENEFICIARY TO BENEI
  7706            MOVE +10            TO BENEL
  7707            MOVE LOW-VALUES TO WS-SAVE-BENEFICIARY
  7708        END-IF
  7709        PERFORM 4100-SAVE-CHANGES THRU 4100-EXIT
  7710     END-IF.
  7711
  7712
  7713* EXEC CICS READQ TS
  7714*         QUEUE    (PI-KEY)
  7715*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7716*         LENGTH   (PI-COMM-LENGTH)
  7717*    END-EXEC.
  7718*    MOVE '*$I    L              ''   #00007634' TO DFHEIV0
  7719     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7720     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7721     MOVE X'2020233030303037363334' TO DFHEIV0(25:11)
  7722     CALL 'kxdfhei1' USING DFHEIV0,
  7723           PI-KEY,
  7724           PROGRAM-INTERFACE-BLOCK,
  7725           PI-COMM-LENGTH,
  7726           DFHEIV99,
  7727           DFHEIV99,
  7728           DFHEIV99
  7729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7730
  7731
  7732
  7733* EXEC CICS DELETEQ TS
  7734*         QUEUE    (PI-KEY)
  7735*    END-EXEC.
  7736*    MOVE '*&                    #   #00007640' TO DFHEIV0
  7737     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7738     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7739     MOVE X'2020233030303037363430' TO DFHEIV0(25:11)
  7740     CALL 'kxdfhei1' USING DFHEIV0,
  7741           PI-KEY,
  7742           DFHEIV99
  7743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7744
  7745
  7746 0120-UPDATE-PI-EXIT.
  7747     EXIT.
  7748
  7749 0130-TS-ERROR.
  7750     MOVE LOW-VALUES             TO EL131AO.
  7751     MOVE ER-0192                TO EMI-ERROR.
  7752
  7753     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 140
* EL131.cbl
  7754
  7755     GO TO 8100-SEND-MAP.
  7756
  7757 0200-TRANS-PF.
  7758     IF EIBAID NOT = DFHENTER
  7759         MOVE 'X'                TO ERROR-SWITCH
  7760         GO TO 0210-EXIT.
  7761
  7762     IF PFKEYI NOT NUMERIC
  7763         MOVE 'X'                TO ERROR-SWITCH
  7764         GO TO 0210-EXIT.
  7765
  7766     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7767
  7768     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7769         MOVE 'X' TO ERROR-SWITCH
  7770         GO TO 0210-EXIT.
  7771
  7772     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7773
  7774 0210-EXIT.
  7775     EXIT.
  7776
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 141
* EL131.cbl
  7778 0500-ADD-ALPHA-ONLY.
  7779******************************************************************
  7780*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7781*    RECORD.                                                     *
  7782******************************************************************
  7783
  7784     IF MLNAMEL = +0 AND
  7785        MFNAMEL = +0 AND
  7786        MMINITL = +0
  7787         MOVE ER-0797                TO  EMI-ERROR
  7788         MOVE -1                     TO  MAINTL
  7789         MOVE AL-UABON               TO  MAINTA
  7790         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7791         GO TO 8110-SEND-DATA.
  7792
  7793     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7794     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7795     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7796     MOVE PI-CERT-NO                 TO  CERT-NO.
  7797
  7798
  7799* EXEC CICS READ
  7800*        DATASET   (CLMS-FILE-ID)
  7801*        RIDFLD    (MSTR-KEY)
  7802*        SET       (ADDRESS OF CLAIM-MASTER)
  7803*    END-EXEC.
  7804*    MOVE '&"S        E          (   #00007696' TO DFHEIV0
  7805     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7806     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7807     MOVE X'2020233030303037363936' TO DFHEIV0(25:11)
  7808     CALL 'kxdfhei1' USING DFHEIV0,
  7809           CLMS-FILE-ID,
  7810           DFHEIV20,
  7811           DFHEIV99,
  7812           MSTR-KEY,
  7813           DFHEIV99,
  7814           DFHEIV99,
  7815           DFHEIV99
  7816     SET ADDRESS OF CLAIM-MASTER TO
  7817         DFHEIV20
  7818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7819
  7820
  7821
  7822* EXEC CICS GETMAIN
  7823*        SET       (ADDRESS OF ALPHA-INDEX)
  7824*        LENGTH    (ALPH-LENGTH)
  7825*        INITIMG   (GETMAIN-SPACE)
  7826*    END-EXEC.
  7827*    MOVE ',"IL                  $   #00007702' TO DFHEIV0
  7828     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7829     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7830     MOVE X'2020233030303037373032' TO DFHEIV0(25:11)
  7831     CALL 'kxdfhei1' USING DFHEIV0,
  7832           DFHEIV20,
  7833           ALPH-LENGTH,
  7834           GETMAIN-SPACE
  7835     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 142
* EL131.cbl
  7836         DFHEIV20
  7837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7838
  7839
  7840     MOVE 'AI'                       TO  AI-RECORD-ID.
  7841     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7842                                         AI-CL-COMPANY-CD.
  7843     MOVE 'C'                        TO  AI-SOURCE
  7844                                         AI-CL-SOURCE.
  7845
  7846     IF MLNAMEL IS GREATER THAN +0
  7847         MOVE MLNAMEI                TO  AI-LAST-NAME
  7848     ELSE
  7849         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7850
  7851     IF MFNAMEL IS GREATER THAN +0
  7852         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7853     ELSE
  7854         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7855
  7856     IF MMINITL IS GREATER THAN +0
  7857         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7858     ELSE
  7859         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7860
  7861     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7862     MOVE '5'                        TO  DC-OPTION-CODE.
  7863     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7864     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7865     IF BUILD-YEAR IS GREATER THAN 50
  7866         MOVE '19'                   TO  WS-ALPHA-YY-1
  7867         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7868         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7869         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7870     ELSE
  7871         MOVE '20'                   TO  WS-ALPHA-YY-1
  7872         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7873         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7874         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7875
  7876     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7877                                         AI-CL-DATE.
  7878
  7879     MOVE EIBTIME                    TO  AI-TIME
  7880                                         AI-CL-TIME.
  7881
  7882     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7883     MOVE 'C'                        TO  AI-CL-SOURCE.
  7884     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7885     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7886     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7887     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7888     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7889
  7890     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7891     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7892     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7893
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 143
* EL131.cbl
  7894
  7895* EXEC CICS WRITE
  7896*        DATASET   (ALPH-FILE-ID)
  7897*        RIDFLD    (AI-CONTROL-PRIMARY)
  7898*        FROM      (ALPHA-INDEX)
  7899*    END-EXEC.
  7900     MOVE LENGTH OF
  7901      ALPHA-INDEX
  7902       TO DFHEIV11
  7903*    MOVE '&$ L                  ''   #00007762' TO DFHEIV0
  7904     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7905     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7906     MOVE X'2020233030303037373632' TO DFHEIV0(25:11)
  7907     CALL 'kxdfhei1' USING DFHEIV0,
  7908           ALPH-FILE-ID,
  7909           ALPHA-INDEX,
  7910           DFHEIV11,
  7911           AI-CONTROL-PRIMARY,
  7912           DFHEIV99,
  7913           DFHEIV99
  7914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7915
  7916
  7917     MOVE LOW-VALUES                 TO  EL131AO.
  7918     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7919     MOVE ER-0000                    TO  EMI-ERROR.
  7920     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7921     MOVE -1                         TO  MAINTL.
  7922     GO TO 8100-SEND-MAP.
  7923
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 144
* EL131.cbl
  7925 0600-CHANGE-NAME.
  7926******************************************************************
  7927*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  7928*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  7929******************************************************************
  7930
  7931     IF MLNAMEL = +0 AND
  7932        MFNAMEL = +0 AND
  7933        MMINITL = +0
  7934         MOVE ER-0276                TO  EMI-ERROR
  7935         MOVE -1                     TO  MAINTL
  7936         MOVE AL-UABON               TO  MAINTA
  7937         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7938         GO TO 8110-SEND-DATA.
  7939
  7940     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7941     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7942     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7943     MOVE PI-CERT-NO                 TO  CERT-NO.
  7944
  7945
  7946* EXEC CICS READ
  7947*        DATASET   (CLMS-FILE-ID)
  7948*        RIDFLD    (MSTR-KEY)
  7949*        SET       (ADDRESS OF CLAIM-MASTER)
  7950*    END-EXEC.
  7951*    MOVE '&"S        E          (   #00007796' TO DFHEIV0
  7952     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7953     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7954     MOVE X'2020233030303037373936' TO DFHEIV0(25:11)
  7955     CALL 'kxdfhei1' USING DFHEIV0,
  7956           CLMS-FILE-ID,
  7957           DFHEIV20,
  7958           DFHEIV99,
  7959           MSTR-KEY,
  7960           DFHEIV99,
  7961           DFHEIV99,
  7962           DFHEIV99
  7963     SET ADDRESS OF CLAIM-MASTER TO
  7964         DFHEIV20
  7965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7966
  7967
  7968
  7969* EXEC CICS GETMAIN
  7970*        SET       (ADDRESS OF ALPHA-INDEX)
  7971*        LENGTH    (ALPH-LENGTH)
  7972*        INITIMG   (GETMAIN-SPACE)
  7973*    END-EXEC.
  7974*    MOVE ',"IL                  $   #00007802' TO DFHEIV0
  7975     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7976     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7977     MOVE X'2020233030303037383032' TO DFHEIV0(25:11)
  7978     CALL 'kxdfhei1' USING DFHEIV0,
  7979           DFHEIV20,
  7980           ALPH-LENGTH,
  7981           GETMAIN-SPACE
  7982     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 145
* EL131.cbl
  7983         DFHEIV20
  7984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7985
  7986
  7987     MOVE 'AI'                       TO  AI-RECORD-ID.
  7988     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7989                                         AI-CL-COMPANY-CD.
  7990     MOVE 'C'                        TO  AI-SOURCE
  7991                                         AI-CL-SOURCE.
  7992
  7993     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  7994     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  7995     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  7996
  7997     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7998     MOVE '5'                        TO  DC-OPTION-CODE.
  7999     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8000     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  8001     IF BUILD-YEAR IS GREATER THAN 50
  8002         MOVE '19'                   TO  WS-ALPHA-YY-1
  8003         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8004         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8005         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  8006     ELSE
  8007         MOVE '20'                   TO  WS-ALPHA-YY-1
  8008         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8009         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8010         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  8011
  8012     MOVE WS-ALPHA-DATE              TO  AI-DATE
  8013                                         AI-CL-DATE.
  8014
  8015     MOVE EIBTIME                    TO  AI-TIME
  8016                                         AI-CL-TIME.
  8017
  8018     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  8019     MOVE 'C'                        TO  AI-CL-SOURCE.
  8020     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  8021     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  8022     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  8023     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  8024     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  8025
  8026     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  8027     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  8028     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  8029
  8030     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8031         MOVE 'Y'                TO CL-YESNOSW
  8032     END-IF.
  8033
  8034
  8035* EXEC CICS WRITE
  8036*        DATASET   (ALPH-FILE-ID)
  8037*        RIDFLD    (AI-CONTROL-PRIMARY)
  8038*        FROM      (ALPHA-INDEX)
  8039*    END-EXEC.
  8040     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 146
* EL131.cbl
  8041      ALPHA-INDEX
  8042       TO DFHEIV11
  8043*    MOVE '&$ L                  ''   #00007855' TO DFHEIV0
  8044     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8045     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8046     MOVE X'2020233030303037383535' TO DFHEIV0(25:11)
  8047     CALL 'kxdfhei1' USING DFHEIV0,
  8048           ALPH-FILE-ID,
  8049           ALPHA-INDEX,
  8050           DFHEIV11,
  8051           AI-CONTROL-PRIMARY,
  8052           DFHEIV99,
  8053           DFHEIV99
  8054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8055
  8056
  8057
  8058* EXEC CICS READ
  8059*        DATASET   (CLMS-FILE-ID)
  8060*        RIDFLD    (MSTR-KEY)
  8061*        SET       (ADDRESS OF CLAIM-MASTER)
  8062*        UPDATE
  8063*    END-EXEC.
  8064*    MOVE '&"S        EU         (   #00007861' TO DFHEIV0
  8065     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8066     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8067     MOVE X'2020233030303037383631' TO DFHEIV0(25:11)
  8068     CALL 'kxdfhei1' USING DFHEIV0,
  8069           CLMS-FILE-ID,
  8070           DFHEIV20,
  8071           DFHEIV99,
  8072           MSTR-KEY,
  8073           DFHEIV99,
  8074           DFHEIV99,
  8075           DFHEIV99
  8076     SET ADDRESS OF CLAIM-MASTER TO
  8077         DFHEIV20
  8078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8079
  8080
  8081     if (cl-priority-cd = '8')
  8082        and (pi-processor-id not = 'PEMA'and 'JMS '
  8083             AND 'AMWA' AND 'KMSB')
  8084        MOVE ER-8003             TO EMI-ERROR
  8085        PERFORM 9900-ERROR-FORMAT
  8086                                 THRU 9900-EXIT
  8087        MOVE -1                  TO MAINTL
  8088        GO TO 8110-SEND-DATA
  8089     end-if
  8090
  8091     IF MLNAMEL IS GREATER THAN +0
  8092         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  8093
  8094     IF MFNAMEL IS GREATER THAN +0
  8095         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  8096
  8097     IF MMINITL IS GREATER THAN +0
  8098         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 147
* EL131.cbl
  8099
  8100     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  8101     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  8102     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  8103     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  8104
  8105     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8106         MOVE 'Y'                TO CL-YESNOSW
  8107     END-IF.
  8108
  8109
  8110* EXEC CICS HANDLE CONDITION
  8111*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  8112*    END-EXEC.
  8113*    MOVE '"$$                   ! $ #00007896' TO DFHEIV0
  8114     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8115     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8116     MOVE X'2420233030303037383936' TO DFHEIV0(25:11)
  8117     CALL 'kxdfhei1' USING DFHEIV0
  8118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8119
  8120
  8121
  8122* EXEC CICS REWRITE
  8123*        DATASET   (CLMS-FILE-ID)
  8124*        FROM      (CLAIM-MASTER)
  8125*    END-EXEC.
  8126     MOVE LENGTH OF
  8127      CLAIM-MASTER
  8128       TO DFHEIV11
  8129*    MOVE '&& L                  %   #00007900' TO DFHEIV0
  8130     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8131     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8132     MOVE X'2020233030303037393030' TO DFHEIV0(25:11)
  8133     CALL 'kxdfhei1' USING DFHEIV0,
  8134           CLMS-FILE-ID,
  8135           CLAIM-MASTER,
  8136           DFHEIV11,
  8137           DFHEIV99
  8138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8139
  8140
  8141 0600-CONTINUE-NAME-UPDATE.
  8142
  8143     MOVE LOW-VALUES                 TO  EL131AO.
  8144     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8145     MOVE ER-0000                    TO  EMI-ERROR.
  8146     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8147     MOVE -1                         TO  MAINTL.
  8148     GO TO 8100-SEND-MAP.
  8149
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 148
* EL131.cbl
  8151 1000-EDIT-SCREEN.
  8152
  8153     MOVE MAINTI                 TO CHECK-MAINT.
  8154
  8155     IF NOT VALID-OPTIONS
  8156         MOVE 'X'                TO ERROR-SWITCH
  8157         MOVE -1                 TO MAINTL
  8158         MOVE AL-UABON           TO MAINTA
  8159         MOVE ER-0023            TO EMI-ERROR
  8160         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8161         GO TO 1010-EXIT.
  8162
  8163     IF NOT MODIFY-CAP
  8164         MOVE 'UPDATE'           TO  SM-READ
  8165         PERFORM 9995-SECURITY-VIOLATION
  8166         MOVE ER-0070               TO  EMI-ERROR
  8167         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8168         GO TO 8100-SEND-MAP.
  8169
  8170     IF DELETE-CLAIM
  8171         MOVE AL-UANON TO MAINTA
  8172         GO TO 1010-EXIT.
  8173
  8174     MOVE AL-UANON               TO MAINTA.
  8175
  8176     IF CCNOI GREATER THAN LOW-VALUES
  8177         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8178
  8179     IF PI-COMPANY-ID = 'CSL'
  8180        CONTINUE
  8181     ELSE
  8182        IF TYPEL > ZERO
  8183           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  8184              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8185                    PI-LIFE-OVERRIDE-L1))
  8186                       OR
  8187              ((PI-COMPANY-ID = 'DCC')
  8188              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8189                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
  8190              MOVE AL-UANON      TO TYPEA
  8191              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  8192           ELSE
  8193              MOVE ER-0199       TO EMI-ERROR
  8194              PERFORM 9900-ERROR-FORMAT
  8195                                 THRU 9900-EXIT
  8196              MOVE AL-UABON      TO TYPEA
  8197              MOVE -1            TO TYPEL
  8198              MOVE 'X'           TO ERROR-SWITCH
  8199           END-IF
  8200        ELSE
  8201           MOVE AL-UANOF         TO TYPEA
  8202        END-IF
  8203     END-IF
  8204     IF STATUSI GREATER THAN LOW-VALUES
  8205         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  8206             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  8207             MOVE AL-UANON       TO STATUSA
  8208             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 149
* EL131.cbl
  8209             MOVE 'Y'            TO DLYACTV-SW
  8210         ELSE
  8211             MOVE ER-0333        TO EMI-ERROR
  8212             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8213             MOVE AL-UABON       TO STATUSA
  8214             MOVE -1             TO STATUSL
  8215             MOVE 'X'            TO ERROR-SWITCH
  8216         END-IF
  8217     ELSE
  8218         MOVE SPACE              TO TRLR-SWITCH
  8219         MOVE 'N'                TO DLYACTV-SW
  8220         MOVE AL-UANOF           TO STATUSA.
  8221
  8222     IF PROCI GREATER THAN LOW-VALUES
  8223         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8224     ELSE
  8225         MOVE AL-UANOF TO PROCA.
  8226
  8227     IF SEXI GREATER THAN LOW-VALUES
  8228         IF SEXI = 'F' OR 'M'
  8229             MOVE AL-UANON       TO SEXA
  8230             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8231           ELSE
  8232             MOVE ER-0219        TO EMI-ERROR
  8233             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8234             MOVE AL-UABON       TO SEXA
  8235             MOVE -1             TO SEXL
  8236             MOVE 'X'            TO ERROR-SWITCH
  8237       ELSE
  8238         MOVE AL-UANOF           TO SEXA.
  8239
  8240     IF BIRTHL = +0
  8241         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8242         MOVE AL-UANOF           TO  BIRTHA
  8243         GO TO 1000-CONTINUE-EDITS.
  8244
  8245     IF BIRTHI = SPACES
  8246         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8247         MOVE 'X'                TO  UPDATE-SWITCH
  8248                                     MSTR-SWITCH
  8249         GO TO 1000-CONTINUE-EDITS.
  8250
  8251     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8252     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8253     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8254     MOVE '4'                    TO  DC-OPTION-CODE.
  8255     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8256     IF DATE-CONVERSION-ERROR
  8257         MOVE ER-0220            TO  EMI-ERROR
  8258         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8259         MOVE AL-UABON           TO  BIRTHA
  8260         MOVE -1                 TO  BIRTHL
  8261         MOVE 'X'                TO  ERROR-SWITCH
  8262         GO TO 1000-CONTINUE-EDITS.
  8263
  8264******************************************************************
  8265**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8266**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 150
* EL131.cbl
  8267**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8268******************************************************************
  8269     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8270         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8271         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8272         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8273         MOVE '4'                TO  DC-OPTION-CODE
  8274         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8275         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8276                                     DC-ELAPSED-DAYS
  8277         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8278         IF DATE-CONVERSION-ERROR
  8279             MOVE ER-0220        TO  EMI-ERROR
  8280             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8281             MOVE AL-UABON       TO  BIRTHA
  8282             MOVE -1             TO  BIRTHL
  8283             MOVE 'X'            TO  ERROR-SWITCH
  8284             GO TO 1000-CONTINUE-EDITS.
  8285
  8286     MOVE AL-UANON               TO  BIRTHA.
  8287     MOVE 'X'                    TO  UPDATE-SWITCH
  8288                                     MSTR-SWITCH.
  8289     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8290     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8291     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8292
  8293 1000-CONTINUE-EDITS.
  8294
  8295     IF SOCIALI GREATER THAN LOW-VALUES
  8296         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8297         IF WS-SOC-SEC-NO NUMERIC AND
  8298           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8299             NEXT SENTENCE
  8300         ELSE
  8301            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8302               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8303               WS-SSN-DASH2 = '-'
  8304                 NEXT SENTENCE
  8305            ELSE
  8306                 MOVE ER-0887        TO  EMI-ERROR
  8307                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8308                 MOVE AL-UABON       TO  SOCIALA
  8309                 MOVE -1             TO  SOCIALL
  8310                 MOVE 'X'            TO  ERROR-SWITCH
  8311            END-IF
  8312        END-IF
  8313     END-IF.
  8314     if critpl > zeros
  8315        and critpi numeric
  8316        move al-uanon            to critpa
  8317        move 'X'                 to update-switch
  8318     end-if
  8319     IF SOCIALI GREATER THAN LOW-VALUES
  8320         MOVE AL-UANON           TO SOCIALA
  8321         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8322     ELSE
  8323         MOVE AL-UANOF           TO SOCIALA.
  8324
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 151
* EL131.cbl
  8325     IF OCCI GREATER THAN LOW-VALUES
  8326         MOVE AL-UANON           TO OCCA
  8327         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8328     ELSE
  8329         MOVE AL-UANOF           TO OCCA.
  8330
  8331     IF BENEL NOT GREATER THAN ZERO
  8332            GO TO 1005-CONTINUE-EDITS.
  8333
  8334     IF BENEI = SPACES
  8335        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8336           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8337           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8338           IF AUTO-PAY-TO-BENE = 'Y'
  8339               MOVE ER-1773      TO  EMI-ERROR
  8340               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8341               MOVE 'X'          TO ERROR-SWITCH
  8342               MOVE AL-UABON     TO BENEA
  8343               MOVE -1           TO BENEL
  8344           ELSE
  8345               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8346           END-IF
  8347        ELSE
  8348           PERFORM 1050-EDIT-BENE THRU 1050-EXIT
  8349           IF PAYMENT-PENDING
  8350               MOVE ER-1772      TO  EMI-ERROR
  8351               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8352               MOVE 'X'          TO ERROR-SWITCH
  8353               MOVE AL-UABON     TO BENEA
  8354               MOVE -1           TO BENEL
  8355           END-IF
  8356           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8357        END-IF
  8358        GO TO 1005-CONTINUE-EDITS.
  8359
  8360
  8361* EXEC CICS HANDLE CONDITION
  8362*        NOTFND (1004-BENE-NOT-FOUND)
  8363*    END-EXEC.
  8364*    MOVE '"$I                   ! % #00008124' TO DFHEIV0
  8365     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8366     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8367     MOVE X'2520233030303038313234' TO DFHEIV0(25:11)
  8368     CALL 'kxdfhei1' USING DFHEIV0
  8369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8370
  8371
  8372     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8373     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8374     MOVE BENEI                  TO  WS-ELBENE-ID.
  8375
  8376
  8377* EXEC CICS READ
  8378*        DATASET ('ELBENE')
  8379*        RIDFLD  (WS-ELBENE-KEY)
  8380*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8381*    END-EXEC.
  8382     MOVE 'ELBENE' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 152
* EL131.cbl
  8383*    MOVE '&"S        E          (   #00008132' TO DFHEIV0
  8384     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8385     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8386     MOVE X'2020233030303038313332' TO DFHEIV0(25:11)
  8387     CALL 'kxdfhei1' USING DFHEIV0,
  8388           DFHEIV1,
  8389           DFHEIV20,
  8390           DFHEIV99,
  8391           WS-ELBENE-KEY,
  8392           DFHEIV99,
  8393           DFHEIV99,
  8394           DFHEIV99
  8395     SET ADDRESS OF BENEFICIARY-MASTER TO
  8396         DFHEIV20
  8397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8398
  8399
  8400     MOVE AL-UANON               TO  BENEA.
  8401     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8402
  8403     GO TO 1005-CONTINUE-EDITS.
  8404
  8405 1004-BENE-NOT-FOUND.
  8406     MOVE ER-0565                TO  EMI-ERROR.
  8407
  8408     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8409     MOVE 'X'                    TO ERROR-SWITCH.
  8410     MOVE AL-UABON               TO BENEA.
  8411     MOVE -1                     TO BENEL.
  8412
  8413 1005-CONTINUE-EDITS.
  8414
  8415     IF DIAGI GREATER THAN LOW-VALUES
  8416         MOVE AL-UANON           TO DIAGA
  8417         MOVE 'X'                TO UPDATE-SWITCH
  8418                                    NINETY-TRLR-SWITCH
  8419     ELSE
  8420         MOVE AL-UANOF           TO DIAGA.
  8421
  8422     IF ICD1I GREATER THAN LOW-VALUES
  8423         IF (ICD1I GREATER THAN SPACES) AND
  8424            (ICD1I(4:1) NOT = '.')
  8425             IF ICD1I(4:1) = ' '
  8426                 MOVE '.' TO ICD1I(4:1)
  8427             ELSE
  8428                 IF ICD1I(8:1) = ' '
  8429                     MOVE ICD1I(7:1) TO ICD1I(8:1)
  8430                     MOVE ICD1I(6:1) TO ICD1I(7:1)
  8431                     MOVE ICD1I(5:1) TO ICD1I(6:1)
  8432                     MOVE ICD1I(4:1) TO ICD1I(5:1)
  8433                     MOVE '.'        TO ICD1I(4:1)
  8434                 END-IF
  8435             END-IF
  8436         END-IF
  8437         IF (ICD1I GREATER THAN SPACES) AND
  8438            (ICD1I(1:1) NOT > ' ' OR
  8439             ICD1I(2:1) NOT > ' ' OR
  8440             ICD1I(3:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 153
* EL131.cbl
  8441             ICD1I(4:1) NOT = '.')
  8442              MOVE ER-0992        TO  EMI-ERROR
  8443              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8444              MOVE 'X'            TO ERROR-SWITCH
  8445              MOVE AL-UABON       TO ICD1A
  8446              MOVE -1             TO ICD1L
  8447         ELSE
  8448             MOVE AL-UANON       TO ICD1A
  8449             MOVE 'X'            TO UPDATE-SWITCH
  8450                                    NINETY-TRLR-SWITCH
  8451         END-IF
  8452     ELSE
  8453         MOVE AL-UANOF           TO ICD1A
  8454     END-IF.
  8455
  8456     IF ICD2I GREATER THAN LOW-VALUES
  8457         IF (ICD2I GREATER THAN SPACES) AND
  8458            (ICD2I(4:1) NOT = '.')
  8459             IF ICD2I(4:1) = ' '
  8460                 MOVE '.' TO ICD2I(4:1)
  8461             ELSE
  8462                 IF ICD2I(8:1) = ' '
  8463                     MOVE ICD2I(7:1) TO ICD2I(8:1)
  8464                     MOVE ICD2I(6:1) TO ICD2I(7:1)
  8465                     MOVE ICD2I(5:1) TO ICD2I(6:1)
  8466                     MOVE ICD2I(4:1) TO ICD2I(5:1)
  8467                     MOVE '.'        TO ICD2I(4:1)
  8468                 END-IF
  8469             END-IF
  8470         END-IF
  8471         IF (ICD2I GREATER THAN SPACES) AND
  8472            (ICD2I(1:1) NOT > ' ' OR
  8473             ICD2I(2:1) NOT > ' ' OR
  8474             ICD2I(3:1) NOT > ' ' OR
  8475             ICD2I(4:1) NOT = '.')
  8476              MOVE ER-0992        TO EMI-ERROR
  8477              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8478              MOVE 'X'            TO ERROR-SWITCH
  8479              MOVE AL-UABON       TO ICD2A
  8480              MOVE -1             TO ICD2L
  8481         ELSE
  8482             MOVE AL-UANON       TO ICD2A
  8483             MOVE 'X'            TO UPDATE-SWITCH
  8484                                    NINETY-TRLR-SWITCH
  8485         END-IF
  8486     ELSE
  8487         MOVE AL-UANOF           TO ICD2A
  8488     END-IF.
  8489
  8490*    IF CAUSEI GREATER THAN LOW-VALUES
  8491*        MOVE AL-UANON           TO CAUSEA
  8492*        MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8493*    ELSE
  8494*        MOVE AL-UANOF           TO CAUSEA.
  8495
  8496*    IF ENDL GREATER THAN ZERO
  8497*        MOVE LOW-VALUES         TO HOLD-END
  8498*        IF ENDI = SPACES
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 154
* EL131.cbl
  8499*            MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8500*        ELSE
  8501*            MOVE ENDI           TO DEEDIT-DATE-INPUT
  8502*            EXEC CICS BIF DEEDIT
  8503*                FIELD    (DEEDIT-DATE-INPUT)
  8504*                LENGTH   (DATE-LENGTH)
  8505*            END-EXEC
  8506*            MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8507*            MOVE '4'            TO DC-OPTION-CODE
  8508*            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8509*            IF NOT DATE-CONVERSION-ERROR
  8510*                MOVE DC-BIN-DATE-1      TO HOLD-END
  8511*                MOVE AL-UANON   TO ENDA
  8512*                MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8513*                MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8514*            ELSE
  8515*                MOVE ER-0224    TO EMI-ERROR
  8516*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8517*                MOVE AL-UABON   TO ENDA
  8518*                MOVE -1         TO ENDL
  8519*                MOVE 'X'        TO ERROR-SWITCH
  8520*      ELSE
  8521*          MOVE AL-UANOF         TO ENDA.
  8522
  8523     IF INCL GREATER THAN ZERO
  8524         MOVE LOW-VALUES         TO HOLD-INCUR
  8525         IF INCI = SPACES
  8526             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8527         ELSE
  8528             MOVE INCI           TO DEEDIT-DATE-INPUT
  8529
  8530* EXEC CICS BIF DEEDIT
  8531*                FIELD    (DEEDIT-DATE-INPUT)
  8532*                LENGTH   (DATE-LENGTH)
  8533*            END-EXEC
  8534*    MOVE '@"L                   #   #00008267' TO DFHEIV0
  8535     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8536     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8537     MOVE X'2020233030303038323637' TO DFHEIV0(25:11)
  8538     CALL 'kxdfhei1' USING DFHEIV0,
  8539           DEEDIT-DATE-INPUT,
  8540           DATE-LENGTH
  8541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8542             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8543             MOVE '4'            TO DC-OPTION-CODE
  8544             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8545             IF NOT DATE-CONVERSION-ERROR
  8546                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8547                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8548                 MOVE AL-UANON           TO INCA
  8549                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8550             ELSE
  8551                 MOVE ER-0222    TO EMI-ERROR
  8552                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8553                 MOVE AL-UABON   TO INCA
  8554                 MOVE -1         TO INCL
  8555                 MOVE 'X'        TO ERROR-SWITCH
  8556       ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 155
* EL131.cbl
  8557           IF PI-NO-PMTS = ZEROS
  8558               MOVE AL-UANOF     TO INCA.
  8559
  8560     IF REPL GREATER THAN ZERO
  8561         MOVE LOW-VALUES         TO HOLD-REPORTED
  8562         IF REPI = SPACES
  8563             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8564         ELSE
  8565             MOVE REPI           TO DEEDIT-DATE-INPUT
  8566
  8567* EXEC CICS BIF DEEDIT
  8568*                FIELD    (DEEDIT-DATE-INPUT)
  8569*                LENGTH   (DATE-LENGTH)
  8570*            END-EXEC
  8571*    MOVE '@"L                   #   #00008295' TO DFHEIV0
  8572     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8573     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8574     MOVE X'2020233030303038323935' TO DFHEIV0(25:11)
  8575     CALL 'kxdfhei1' USING DFHEIV0,
  8576           DEEDIT-DATE-INPUT,
  8577           DATE-LENGTH
  8578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8579             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8580             MOVE '4'            TO DC-OPTION-CODE
  8581             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8582             IF NOT DATE-CONVERSION-ERROR
  8583                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8584                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8585                 MOVE AL-UANON   TO REPA
  8586                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8587             ELSE
  8588                 MOVE ER-0223    TO EMI-ERROR
  8589                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8590                 MOVE AL-UABON   TO REPA
  8591                 MOVE -1         TO REPL
  8592                 MOVE 'X'        TO ERROR-SWITCH
  8593       ELSE
  8594         MOVE AL-UANOF TO REPA.
  8595
  8596     IF PDTHRUI GREATER THAN LOW-VALUES
  8597        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8598        IF PDTHRUI = SPACES
  8599           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8600        ELSE
  8601           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8602
  8603* EXEC CICS BIF DEEDIT
  8604*               FIELD    (DEEDIT-DATE-INPUT)
  8605*               LENGTH   (DATE-LENGTH)
  8606*          END-EXEC
  8607*    MOVE '@"L                   #   #00008322' TO DFHEIV0
  8608     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8609     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8610     MOVE X'2020233030303038333232' TO DFHEIV0(25:11)
  8611     CALL 'kxdfhei1' USING DFHEIV0,
  8612           DEEDIT-DATE-INPUT,
  8613           DATE-LENGTH
  8614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 156
* EL131.cbl
  8615           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8616           MOVE '4'            TO DC-OPTION-CODE
  8617           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8618           IF NOT DATE-CONVERSION-ERROR
  8619              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8620              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8621              MOVE AL-UANON   TO PDTHRUA
  8622              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8623              IF PI-USES-PAID-TO
  8624                 MOVE '6'            TO DC-OPTION-CODE
  8625                 MOVE -1             TO DC-ELAPSED-DAYS
  8626                 MOVE +0             TO DC-ELAPSED-MONTHS
  8627                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8628                 IF NO-CONVERSION-ERROR
  8629                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8630                 ELSE
  8631                    NEXT SENTENCE
  8632              ELSE
  8633                 NEXT SENTENCE
  8634           ELSE
  8635              MOVE ER-0475    TO EMI-ERROR
  8636              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8637              MOVE AL-UABON   TO PDTHRUA
  8638              MOVE -1         TO PDTHRUL
  8639              MOVE 'X'        TO ERROR-SWITCH
  8640     ELSE
  8641        IF MODIFY-CAP
  8642           MOVE AL-UANOF        TO PDTHRUA.
  8643
  8644     IF PDAMTL GREATER THAN +0
  8645         MOVE ZEROS              TO HOLD-PDAMT
  8646
  8647* EXEC CICS BIF DEEDIT
  8648*            FIELD    (PDAMTI)
  8649*            LENGTH   (9)
  8650*        END-EXEC
  8651     MOVE 9
  8652       TO DFHEIV11
  8653*    MOVE '@"L                   #   #00008357' TO DFHEIV0
  8654     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8655     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8656     MOVE X'2020233030303038333537' TO DFHEIV0(25:11)
  8657     CALL 'kxdfhei1' USING DFHEIV0,
  8658           PDAMTI,
  8659           DFHEIV11
  8660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8661         IF PDAMTI NUMERIC
  8662             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8663             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8664             MOVE AL-UNNON       TO PDAMTA
  8665         ELSE
  8666             MOVE ER-0547        TO EMI-ERROR
  8667             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8668             MOVE AL-UNBON       TO PDAMTA
  8669             MOVE -1             TO PDAMTL
  8670             MOVE 'X'            TO ERROR-SWITCH
  8671     ELSE
  8672         IF MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 157
* EL131.cbl
  8673            MOVE AL-UNNOF        TO PDAMTA.
  8674
  8675     IF NODAYSI GREATER THAN LOW-VALUES
  8676         MOVE ZEROS              TO HOLD-NODAYS
  8677
  8678* EXEC CICS BIF DEEDIT
  8679*            FIELD (NODAYSI)
  8680*            LENGTH (5)
  8681*        END-EXEC
  8682     MOVE 5
  8683       TO DFHEIV11
  8684*    MOVE '@"L                   #   #00008377' TO DFHEIV0
  8685     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8686     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8687     MOVE X'2020233030303038333737' TO DFHEIV0(25:11)
  8688     CALL 'kxdfhei1' USING DFHEIV0,
  8689           NODAYSI,
  8690           DFHEIV11
  8691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8692         IF NODAYSI NUMERIC
  8693             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8694             MOVE AL-UNNON       TO NODAYSA
  8695             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8696         ELSE
  8697             MOVE ER-0491        TO EMI-ERROR
  8698             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8699             MOVE AL-UNBON       TO NODAYSA
  8700             MOVE -1             TO NODAYSL
  8701             MOVE 'X'            TO ERROR-SWITCH
  8702     ELSE
  8703         IF MODIFY-CAP
  8704            MOVE AL-UNNOF        TO NODAYSA.
  8705
  8706     IF NOPMTSI GREATER THAN LOW-VALUES
  8707         MOVE ZEROS              TO HOLD-NOPMTS
  8708
  8709* EXEC CICS BIF DEEDIT
  8710*            FIELD (NOPMTSI)
  8711*            LENGTH (4)
  8712*        END-EXEC
  8713     MOVE 4
  8714       TO DFHEIV11
  8715*    MOVE '@"L                   #   #00008397' TO DFHEIV0
  8716     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8717     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8718     MOVE X'2020233030303038333937' TO DFHEIV0(25:11)
  8719     CALL 'kxdfhei1' USING DFHEIV0,
  8720           NOPMTSI,
  8721           DFHEIV11
  8722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8723         IF NOPMTSI NUMERIC
  8724             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8725             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8726             MOVE AL-UNNON       TO NOPMTSA
  8727           ELSE
  8728             MOVE ER-0548        TO EMI-ERROR
  8729             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8730             MOVE AL-UNBON       TO NOPMTSA
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 158
* EL131.cbl
  8731             MOVE -1             TO NOPMTSL
  8732             MOVE 'X'            TO ERROR-SWITCH
  8733       ELSE
  8734         IF MODIFY-CAP
  8735            MOVE AL-UNNOF        TO NOPMTSA.
  8736
  8737     IF FORMTYPI GREATER THAN LOW-VALUES
  8738         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8739             MOVE AL-UANON       TO FORMTYPA
  8740             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8741           ELSE
  8742             MOVE ER-7650        TO EMI-ERROR
  8743             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8744             MOVE AL-UABON       TO FORMTYPA
  8745             MOVE -1             TO FORMTYPL
  8746             MOVE 'X'            TO ERROR-SWITCH
  8747       ELSE
  8748         MOVE AL-UANOF           TO FORMTYPA.
  8749
  8750     IF PRICDL GREATER THAN ZERO
  8751         IF (PRICDI = ' ') OR
  8752            (PRICDI GREATER THAN ZERO   AND
  8753             PRICDI NOT GREATER THAN '9')
  8754             MOVE AL-UANON       TO PRICDA
  8755             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8756         ELSE
  8757             MOVE ER-0274        TO EMI-ERROR
  8758             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8759             MOVE AL-UABON       TO PRICDA
  8760             MOVE -1             TO PRICDL
  8761             MOVE 'X'            TO ERROR-SWITCH
  8762     ELSE
  8763         MOVE AL-UANOF TO PRICDA.
  8764
  8765     IF PI-COMPANY-ID = 'DMD'
  8766     IF PRICDL GREATER THAN ZERO
  8767       IF SYSTEM-MODIFY-CAP  OR
  8768          PI-PROCESSOR-ID = 'LGXX'
  8769             NEXT SENTENCE
  8770           ELSE
  8771            IF CL-PRIORITY-CD = '9'  OR
  8772               PRICDI         = '9'
  8773                  MOVE ER-0938        TO EMI-ERROR
  8774                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8775                  MOVE AL-UABON       TO PRICDA
  8776                  MOVE -1             TO PRICDL
  8777                  MOVE 'X'            TO ERROR-SWITCH.
  8778
  8779     IF FILETOL GREATER THAN ZERO
  8780         MOVE AL-UANON           TO FILETOA
  8781         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8782     ELSE
  8783         MOVE AL-UANOF TO FILETOA.
  8784
  8785     IF SUPVL GREATER THAN ZERO
  8786         IF SUPVI = 'Y' OR 'N' OR SPACE
  8787             MOVE AL-UANON       TO SUPVA
  8788             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 159
* EL131.cbl
  8789         ELSE
  8790             MOVE ER-0230        TO EMI-ERROR
  8791             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8792             MOVE AL-UABON       TO SUPVA
  8793             MOVE -1             TO SUPVL
  8794             MOVE 'X'            TO ERROR-SWITCH
  8795     ELSE
  8796         MOVE AL-UANOF           TO SUPVA.
  8797
  8798     IF MLNAMEL GREATER THAN ZERO
  8799         IF MLNAMEI GREATER THAN SPACES
  8800            MOVE AL-UANON        TO MLNAMEA
  8801            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8802                                     MSTR-KEY-SWITCH
  8803         ELSE
  8804            MOVE ER-0236         TO EMI-ERROR
  8805            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8806            MOVE AL-UABON        TO MLNAMEA
  8807            MOVE -1              TO MLNAMEL
  8808            MOVE 'X'             TO ERROR-SWITCH
  8809     ELSE
  8810         MOVE AL-UANOF           TO MLNAMEA.
  8811
  8812     IF MFNAMEI GREATER THAN LOW-VALUES
  8813         MOVE AL-UANON           TO MFNAMEA
  8814         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8815     ELSE
  8816         MOVE AL-UANOF           TO MFNAMEA.
  8817
  8818     IF MMINITI GREATER THAN LOW-VALUES
  8819         MOVE AL-UANON           TO MMINITA
  8820         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8821     ELSE
  8822         MOVE AL-UANOF           TO MMINITA.
  8823
  8824     IF CRTLNMEI GREATER THAN LOW-VALUES
  8825         IF CRTLNMEI NOT = SPACES
  8826            MOVE AL-UANON        TO CRTLNMEA
  8827            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8828                                     CERT-KEY-SWITCH
  8829        ELSE
  8830            MOVE ER-0236         TO EMI-ERROR
  8831            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8832            MOVE AL-UABON        TO CRTLNMEA
  8833            MOVE -1              TO CRTLNMEL
  8834            MOVE 'X'             TO ERROR-SWITCH
  8835     ELSE
  8836         MOVE AL-UANOF           TO CRTLNMEA.
  8837
  8838     IF CRTFNMEI GREATER THAN LOW-VALUES
  8839         MOVE AL-UANON           TO CRTFNMEA
  8840         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8841     ELSE
  8842         MOVE AL-UANOF           TO CRTFNMEA.
  8843
  8844     IF CRTINITI GREATER THAN LOW-VALUES
  8845         MOVE AL-UANON           TO CRTINITA
  8846         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 160
* EL131.cbl
  8847     ELSE
  8848         MOVE AL-UANOF           TO CRTINITA.
  8849
  8850     IF ISSAGEL GREATER THAN ZERO
  8851         IF ISSAGEI NUMERIC
  8852            MOVE AL-UANON        TO ISSAGEA
  8853            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8854         ELSE
  8855            MOVE ER-0237         TO EMI-ERROR
  8856            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8857            MOVE AL-UABON        TO ISSAGEA
  8858            MOVE -1              TO ISSAGEL
  8859            MOVE 'X'             TO ERROR-SWITCH
  8860     ELSE
  8861         MOVE AL-UANOF           TO ISSAGEA.
  8862
  8863     IF JNTFNMEI GREATER THAN LOW-VALUES
  8864         MOVE AL-UANON           TO JNTFNMEA
  8865         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8866     ELSE
  8867         MOVE AL-UANOF           TO JNTFNMEA.
  8868
  8869     IF JNTLNMEI GREATER THAN LOW-VALUES
  8870         MOVE AL-UANON           TO JNTLNMEA
  8871         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8872     ELSE
  8873         MOVE AL-UANOF           TO JNTLNMEA.
  8874
  8875     IF JNTINITI GREATER THAN LOW-VALUES
  8876         MOVE AL-UANON           TO JNTINITA
  8877         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8878     ELSE
  8879         MOVE AL-UANOF           TO JNTINITA.
  8880
  8881     IF JNTAGEL GREATER THAN ZERO
  8882         IF JNTAGEI NUMERIC
  8883            MOVE AL-UANON        TO JNTAGEA
  8884            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8885         ELSE
  8886            MOVE ER-0238         TO EMI-ERROR
  8887            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8888            MOVE AL-UABON        TO JNTAGEA
  8889            MOVE -1              TO JNTAGEL
  8890            MOVE 'X'             TO ERROR-SWITCH
  8891     ELSE
  8892         MOVE AL-UANOF           TO JNTAGEA.
  8893
  8894     IF ADDONDTI GREATER THAN LOW-VALUES
  8895         MOVE LOW-VALUES         TO HOLD-ADDON
  8896         IF ADDONDTI = SPACES
  8897             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8898         ELSE
  8899             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8900
  8901* EXEC CICS BIF DEEDIT
  8902*                FIELD    (DEEDIT-DATE-INPUT)
  8903*                LENGTH   (DATE-LENGTH)
  8904*            END-EXEC
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 161
* EL131.cbl
  8905*    MOVE '@"L                   #   #00008578' TO DFHEIV0
  8906     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8907     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8908     MOVE X'2020233030303038353738' TO DFHEIV0(25:11)
  8909     CALL 'kxdfhei1' USING DFHEIV0,
  8910           DEEDIT-DATE-INPUT,
  8911           DATE-LENGTH
  8912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8913             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8914             MOVE '4'            TO DC-OPTION-CODE
  8915             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8916             IF NOT DATE-CONVERSION-ERROR
  8917                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  8918                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8919                                                  CERT-SWITCH
  8920                 MOVE AL-UANON   TO ADDONDTA
  8921                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  8922             ELSE
  8923                 MOVE ER-7651    TO EMI-ERROR
  8924                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8925                 MOVE AL-UABON   TO ADDONDTA
  8926                 MOVE -1         TO ADDONDTL
  8927                 MOVE 'X'        TO ERROR-SWITCH
  8928       ELSE
  8929         MOVE AL-UANOF TO ADDONDTA.
  8930
  8931     IF LCVCDI GREATER THAN LOW-VALUES
  8932         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  8933         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  8934     ELSE
  8935         MOVE AL-UANOF           TO LCVCDA.
  8936
  8937     IF ACVCDI GREATER THAN LOW-VALUES
  8938         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  8939         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  8940     ELSE
  8941         MOVE AL-UANOF           TO ACVCDA.
  8942
  8943     IF LCVOTRMI GREATER THAN LOW-VALUES
  8944
  8945* EXEC CICS BIF DEEDIT
  8946*            FIELD (LCVOTRMI)
  8947*            LENGTH(3)
  8948*        END-EXEC
  8949     MOVE 3
  8950       TO DFHEIV11
  8951*    MOVE '@"L                   #   #00008613' TO DFHEIV0
  8952     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8953     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8954     MOVE X'2020233030303038363133' TO DFHEIV0(25:11)
  8955     CALL 'kxdfhei1' USING DFHEIV0,
  8956           LCVOTRMI,
  8957           DFHEIV11
  8958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8959         IF LCVOTRMI IS NUMERIC
  8960             MOVE LCVOTRMI       TO LCVOTRMO
  8961             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8962             MOVE AL-UANON       TO LCVOTRMA
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 162
* EL131.cbl
  8963         ELSE
  8964             MOVE ER-0241        TO EMI-ERROR
  8965             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8966             MOVE AL-UNBON       TO LCVOTRMA
  8967             MOVE 'X'            TO ERROR-SWITCH
  8968             MOVE -1             TO LCVOTRML
  8969     ELSE
  8970         MOVE AL-UANOF           TO LCVOTRMA.
  8971
  8972     IF ACVOTRMI GREATER THAN LOW-VALUES
  8973
  8974* EXEC CICS BIF DEEDIT
  8975*            FIELD (ACVOTRMI)
  8976*            LENGTH(3)
  8977*        END-EXEC
  8978     MOVE 3
  8979       TO DFHEIV11
  8980*    MOVE '@"L                   #   #00008631' TO DFHEIV0
  8981     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8982     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8983     MOVE X'2020233030303038363331' TO DFHEIV0(25:11)
  8984     CALL 'kxdfhei1' USING DFHEIV0,
  8985           ACVOTRMI,
  8986           DFHEIV11
  8987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8988         IF ACVOTRMI IS NUMERIC
  8989             MOVE ACVOTRMI       TO ACVOTRMO
  8990             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8991             MOVE AL-UANON       TO ACVOTRMA
  8992         ELSE
  8993             MOVE ER-0241        TO EMI-ERROR
  8994             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8995             MOVE AL-UNBON       TO ACVOTRMA
  8996             MOVE 'X'            TO ERROR-SWITCH
  8997             MOVE -1             TO ACVOTRML
  8998     ELSE
  8999         MOVE AL-UANOF           TO ACVOTRMA.
  9000
  9001     IF LCVRATEL GREATER THAN +0
  9002
  9003* EXEC CICS BIF DEEDIT
  9004*            FIELD (LCVRATEI)
  9005*            LENGTH(6)
  9006*        END-EXEC
  9007     MOVE 6
  9008       TO DFHEIV11
  9009*    MOVE '@"L                   #   #00008649' TO DFHEIV0
  9010     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9011     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9012     MOVE X'2020233030303038363439' TO DFHEIV0(25:11)
  9013     CALL 'kxdfhei1' USING DFHEIV0,
  9014           LCVRATEI,
  9015           DFHEIV11
  9016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9017         IF LCVRATEI IS NUMERIC
  9018             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  9019             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9020             MOVE AL-UNNON       TO LCVRATEA
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 163
* EL131.cbl
  9021         ELSE
  9022             MOVE ER-2280        TO EMI-ERROR
  9023             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9024             MOVE AL-UNBON       TO LCVRATEA
  9025             MOVE 'X'            TO ERROR-SWITCH
  9026             MOVE -1             TO LCVRATEL
  9027     ELSE
  9028         MOVE AL-UNNOF           TO LCVRATEA.
  9029
  9030     IF ACVRATEL GREATER THAN +0
  9031
  9032* EXEC CICS BIF DEEDIT
  9033*            FIELD (ACVRATEI)
  9034*            LENGTH(6)
  9035*        END-EXEC
  9036     MOVE 6
  9037       TO DFHEIV11
  9038*    MOVE '@"L                   #   #00008667' TO DFHEIV0
  9039     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9040     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9041     MOVE X'2020233030303038363637' TO DFHEIV0(25:11)
  9042     CALL 'kxdfhei1' USING DFHEIV0,
  9043           ACVRATEI,
  9044           DFHEIV11
  9045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9046         IF ACVRATEI IS NUMERIC
  9047             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  9048             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9049             MOVE AL-UNNON       TO ACVRATEA
  9050         ELSE
  9051             MOVE ER-2280        TO EMI-ERROR
  9052             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9053             MOVE AL-UNBON       TO ACVRATEA
  9054             MOVE 'X'            TO ERROR-SWITCH
  9055             MOVE -1             TO ACVRATEL
  9056     ELSE
  9057         MOVE AL-UNNOF           TO ACVRATEA.
  9058
  9059     IF LCVBENEL GREATER THAN ZERO
  9060
  9061* EXEC CICS BIF DEEDIT
  9062*            FIELD (LCVBENEI)
  9063*            LENGTH (11)
  9064*        END-EXEC
  9065     MOVE 11
  9066       TO DFHEIV11
  9067*    MOVE '@"L                   #   #00008685' TO DFHEIV0
  9068     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9069     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9070     MOVE X'2020233030303038363835' TO DFHEIV0(25:11)
  9071     CALL 'kxdfhei1' USING DFHEIV0,
  9072           LCVBENEI,
  9073           DFHEIV11
  9074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9075         IF LCVBENEI IS NUMERIC
  9076            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  9077            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9078            MOVE AL-UNNON        TO LCVBENEA
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 164
* EL131.cbl
  9079         ELSE
  9080            MOVE ER-0243         TO EMI-ERROR
  9081            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9082            MOVE AL-UNBON        TO LCVBENEA
  9083            MOVE -1              TO LCVBENEL
  9084            MOVE 'X'             TO ERROR-SWITCH
  9085     ELSE
  9086         MOVE AL-UANOF           TO LCVBENEA.
  9087
  9088     IF ACVBENEL GREATER THAN ZERO
  9089
  9090* EXEC CICS BIF DEEDIT
  9091*            FIELD (ACVBENEI)
  9092*            LENGTH (11)
  9093*        END-EXEC
  9094     MOVE 11
  9095       TO DFHEIV11
  9096*    MOVE '@"L                   #   #00008703' TO DFHEIV0
  9097     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9098     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9099     MOVE X'2020233030303038373033' TO DFHEIV0(25:11)
  9100     CALL 'kxdfhei1' USING DFHEIV0,
  9101           ACVBENEI,
  9102           DFHEIV11
  9103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9104         IF ACVBENEI IS NUMERIC
  9105            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  9106            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9107            MOVE AL-UNNON        TO ACVBENEA
  9108         ELSE
  9109            MOVE ER-0243         TO EMI-ERROR
  9110            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9111            MOVE AL-UNBON        TO ACVBENEA
  9112            MOVE -1              TO ACVBENEL
  9113            MOVE 'X'             TO ERROR-SWITCH
  9114     ELSE
  9115         MOVE AL-UANOF           TO ACVBENEA.
  9116
  9117     IF LCVFORMI GREATER THAN LOW-VALUES
  9118        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9119        MOVE AL-UANON            TO LCVFORMA
  9120     ELSE
  9121        MOVE AL-UANOF            TO LCVFORMA.
  9122
  9123     IF ACVFORMI GREATER THAN LOW-VALUES
  9124        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9125        MOVE AL-UANON            TO ACVFORMA
  9126     ELSE
  9127        MOVE AL-UANOF            TO ACVFORMA.
  9128
  9129     IF LCVCNDTL GREATER THAN ZERO
  9130         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9131         IF LCVCNDTI = SPACES
  9132             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9133         ELSE
  9134             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  9135             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9136             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 165
* EL131.cbl
  9137             MOVE '4'            TO DC-OPTION-CODE
  9138             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9139             IF NOT DATE-CONVERSION-ERROR
  9140                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  9141                 MOVE AL-UANON   TO LCVCNDTA
  9142                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9143                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  9144             ELSE
  9145                 MOVE ER-0246    TO EMI-ERROR
  9146                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9147                 MOVE AL-UABON   TO LCVCNDTA
  9148                 MOVE -1         TO LCVCNDTL
  9149                 MOVE 'X'        TO ERROR-SWITCH
  9150     ELSE
  9151         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9152         MOVE AL-UANOF           TO LCVCNDTA.
  9153
  9154     IF ACVCNDTL GREATER THAN ZERO
  9155         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9156         IF ACVCNDTI = SPACES
  9157             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9158         ELSE
  9159             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  9160             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9161             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9162             MOVE '4'            TO DC-OPTION-CODE
  9163             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9164             IF NOT DATE-CONVERSION-ERROR
  9165                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  9166                 MOVE AL-UANON   TO ACVCNDTA
  9167                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9168                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  9169             ELSE
  9170                 MOVE ER-0246    TO EMI-ERROR
  9171                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9172                 MOVE AL-UABON   TO ACVCNDTA
  9173                 MOVE -1         TO ACVCNDTL
  9174                 MOVE 'X'        TO ERROR-SWITCH
  9175     ELSE
  9176         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9177         MOVE AL-UANOF           TO ACVCNDTA.
  9178
  9179     IF APRL GREATER THAN +0
  9180
  9181* EXEC CICS BIF DEEDIT
  9182*            FIELD    (APRI)
  9183*            LENGTH   (8)
  9184*        END-EXEC
  9185     MOVE 8
  9186       TO DFHEIV11
  9187*    MOVE '@"L                   #   #00008783' TO DFHEIV0
  9188     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9189     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9190     MOVE X'2020233030303038373833' TO DFHEIV0(25:11)
  9191     CALL 'kxdfhei1' USING DFHEIV0,
  9192           APRI,
  9193           DFHEIV11
  9194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 166
* EL131.cbl
  9195         IF APRI NUMERIC
  9196            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9197            MOVE APRI            TO HOLD-APR APRO
  9198            MOVE AL-UANON        TO APRA
  9199          ELSE
  9200            MOVE ER-0259         TO EMI-ERROR
  9201            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9202            MOVE AL-UABON        TO APRA
  9203            MOVE -1              TO APRL
  9204            MOVE 'X'             TO ERROR-SWITCH
  9205     ELSE
  9206         MOVE AL-UANOF           TO APRA.
  9207
  9208     IF PMTFREQL GREATER THAN ZERO
  9209
  9210* EXEC CICS BIF DEEDIT
  9211*            FIELD    (PMTFREQI)
  9212*            LENGTH   (2)
  9213*        END-EXEC
  9214     MOVE 2
  9215       TO DFHEIV11
  9216*    MOVE '@"L                   #   #00008801' TO DFHEIV0
  9217     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9218     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9219     MOVE X'2020233030303038383031' TO DFHEIV0(25:11)
  9220     CALL 'kxdfhei1' USING DFHEIV0,
  9221           PMTFREQI,
  9222           DFHEIV11
  9223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9224         IF PMTFREQI NUMERIC
  9225            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  9226            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9227            MOVE AL-UANON        TO PMTFREQA
  9228          ELSE
  9229            MOVE ER-0427         TO EMI-ERROR
  9230            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9231            MOVE AL-UABON        TO PMTFREQA
  9232            MOVE -1              TO PMTFREQL
  9233            MOVE 'X'             TO ERROR-SWITCH
  9234     ELSE
  9235         MOVE AL-UANOF           TO PMTFREQA.
  9236
  9237     IF INDGRPL GREATER THAN ZERO
  9238         IF INDGRPI = 'I' OR 'G' OR SPACE
  9239             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9240             MOVE AL-UANON       TO INDGRPA
  9241          ELSE
  9242             MOVE ER-0260        TO EMI-ERROR
  9243             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9244             MOVE AL-UABON       TO INDGRPA
  9245             MOVE -1             TO INDGRPL
  9246             MOVE 'X'            TO ERROR-SWITCH
  9247     ELSE
  9248         MOVE AL-UANOF           TO INDGRPA.
  9249
  9250     IF PREMTYPL GREATER THAN ZERO
  9251         IF PREMTYPI = '1' OR '2' OR '3'
  9252            MOVE PREMTYPI        TO PI-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 167
* EL131.cbl
  9253            MOVE AL-UNNON        TO PREMTYPA
  9254            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9255          ELSE
  9256            MOVE ER-0227         TO EMI-ERROR
  9257            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9258            MOVE AL-UNBON        TO PREMTYPA
  9259            MOVE -1              TO PREMTYPL
  9260            MOVE 'X'             TO ERROR-SWITCH
  9261     ELSE
  9262         MOVE AL-UANOF           TO PREMTYPA.
  9263
  9264     IF LOANBALL GREATER THAN ZERO
  9265
  9266* EXEC CICS BIF DEEDIT
  9267*             FIELD    (LOANBALI)
  9268*             LENGTH   (9)
  9269*        END-EXEC
  9270     MOVE 9
  9271       TO DFHEIV11
  9272*    MOVE '@"L                   #   #00008846' TO DFHEIV0
  9273     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9274     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9275     MOVE X'2020233030303038383436' TO DFHEIV0(25:11)
  9276     CALL 'kxdfhei1' USING DFHEIV0,
  9277           LOANBALI,
  9278           DFHEIV11
  9279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9280         IF LOANBALI NUMERIC
  9281             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9282             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9283             MOVE AL-UNNON TO LOANBALA
  9284         ELSE
  9285             MOVE ER-0639        TO EMI-ERROR
  9286             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9287             MOVE AL-UNBON       TO LOANBALA
  9288             MOVE -1             TO LOANBALL
  9289             MOVE 'X'            TO ERROR-SWITCH
  9290     ELSE
  9291         MOVE AL-UNNOF           TO LOANBALA.
  9292
  9293     IF LOANNOL GREATER THAN ZERO
  9294        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9295        MOVE AL-UANON            TO LOANNOA
  9296     ELSE
  9297        MOVE AL-UANOF            TO LOANNOA.
  9298
  9299     IF REINCDI GREATER THAN LOW-VALUES
  9300        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9301        MOVE AL-UANON            TO REINCDA
  9302     ELSE
  9303        MOVE AL-UANOF            TO REINCDA.
  9304
  9305     IF CERTI GREATER THAN LOW-VALUES
  9306         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9307     ELSE
  9308         MOVE AL-UANOF           TO CERTA.
  9309
  9310     IF CERTEFFI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 168
* EL131.cbl
  9311         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9312     ELSE
  9313         MOVE AL-UANOF           TO CERTEFFA.
  9314
  9315     IF CERTACTI GREATER THAN LOW-VALUES
  9316         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9317     ELSE
  9318         MOVE AL-UANOF           TO CERTACTA.
  9319
  9320     IF CERTSTI GREATER THAN LOW-VALUES
  9321         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9322     ELSE
  9323         MOVE AL-UANOF           TO CERTSTA.
  9324
  9325     IF CERTCARI GREATER THAN LOW-VALUES
  9326         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9327     ELSE
  9328         MOVE AL-UANOF           TO CERTCARA.
  9329
  9330     IF DLYACTV-RECORD-NEEDED
  9331         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9332                 1150-EXIT
  9333     END-IF.
  9334
  9335     IF CERTEFFI GREATER LOW-VALUES OR
  9336        CERTACTI GREATER LOW-VALUES OR
  9337        CERTSTI  GREATER LOW-VALUES OR
  9338        CERTCARI GREATER LOW-VALUES OR
  9339        CERTGRPI GREATER LOW-VALUES
  9340        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9341
  9342*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9343*      IF PI-PREM-TYPE NOT = '1'  AND
  9344*         PI-NO-PMTS = ZEROS
  9345*          IF LOANBALL GREATER +0 OR
  9346*             ACVBENEL GREATER +0
  9347*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9348     if not acct-found
  9349        perform 1620-VERIFY-ACCT THRU 1620-EXIT
  9350     end-if
  9351     MOVE PI-COMPANY-CD          TO COMPANY-CODE
  9352     MOVE PI-CARRIER             TO CARRIER-CODE
  9353     MOVE PI-CLAIM-NO            TO CLAIM-NO
  9354     MOVE PI-CERT-NO             TO CERT-NO
  9355
  9356* EXEC CICS READ
  9357*        DATASET   (CLMS-FILE-ID)
  9358*        RIDFLD    (MSTR-KEY)
  9359*        SET       (ADDRESS OF CLAIM-MASTER)
  9360*        RESP      (WS-RESPONSE)
  9361*    END-EXEC
  9362*    MOVE '&"S        E          (  N#00008925' TO DFHEIV0
  9363     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9364     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9365     MOVE X'204E233030303038393235' TO DFHEIV0(25:11)
  9366     CALL 'kxdfhei1' USING DFHEIV0,
  9367           CLMS-FILE-ID,
  9368           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 169
* EL131.cbl
  9369           DFHEIV99,
  9370           MSTR-KEY,
  9371           DFHEIV99,
  9372           DFHEIV99,
  9373           DFHEIV99
  9374     SET ADDRESS OF CLAIM-MASTER TO
  9375         DFHEIV20
  9376     MOVE EIBRESP  TO WS-RESPONSE
  9377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9378     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  9379     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  9380     MOVE CL-CERT-GROUPING       TO CERT-GROUP
  9381     MOVE CL-CERT-STATE          TO CERT-STATE
  9382     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9383     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  9384     MOVE CL-CERT-NO             TO CERT-CERT
  9385
  9386* EXEC CICS READ
  9387*       DATASET   (CERT-FILE-ID)
  9388*       RIDFLD    (CERT-KEY)
  9389*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  9390*       RESP      (WS-RESPONSE)
  9391*    END-EXEC
  9392*    MOVE '&"S        E          (  N#00008938' TO DFHEIV0
  9393     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9394     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9395     MOVE X'204E233030303038393338' TO DFHEIV0(25:11)
  9396     CALL 'kxdfhei1' USING DFHEIV0,
  9397           CERT-FILE-ID,
  9398           DFHEIV20,
  9399           DFHEIV99,
  9400           CERT-KEY,
  9401           DFHEIV99,
  9402           DFHEIV99,
  9403           DFHEIV99
  9404     SET ADDRESS OF CERTIFICATE-MASTER TO
  9405         DFHEIV20
  9406     MOVE EIBRESP  TO WS-RESPONSE
  9407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9408     if mfnamei > low-values
  9409        move mfnamei to w-name-first
  9410     else
  9411        move cl-insured-1st-name to w-name-first
  9412     end-if
  9413     if mlnamei > low-values
  9414        move mlnamei to w-name-last
  9415     else
  9416        move cl-insured-last-name to w-name-last
  9417     end-if
  9418     if instypel > zeros
  9419        evaluate true
  9420           when cl-no-of-days-paid > zeros
  9421              move er-1668       to emi-error
  9422              perform 9900-error-format
  9423                                 thru 9900-exit
  9424              move al-uabon      to instypea
  9425              move -1            to instypel
  9426              move 'X'           to error-switch
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 170
* EL131.cbl
  9427           when instypei = 'C'
  9428              if w-name-first (1:10) = cm-insured-first-name
  9429                 move er-1666    to emi-error
  9430                 PERFORM 9900-ERROR-FORMAT
  9431                                 THRU 9900-EXIT
  9432                 move al-uabon   to instypea
  9433                 move -1         to instypel
  9434                 move 'X'        to error-switch
  9435              end-if
  9436           when instypei = 'P'
  9437              if (w-name-first (1:10) <> cm-insured-first-name)
  9438                 or (w-name-last <> cm-insured-last-name)
  9439                 move er-1676    to emi-error
  9440                 PERFORM 9900-ERROR-FORMAT
  9441                                 THRU 9900-EXIT
  9442                 move al-uabon   to instypea
  9443                 move -1         to instypel
  9444                 move 'X'        to error-switch
  9445              end-if
  9446        end-evaluate
  9447     end-if
  9448*    if (instypel > zeros)
  9449*       and (cl-no-of-days-paid > zero)
  9450*       move er-1668             to emi-error
  9451*       perform 9900-error-format thru 9900-exit
  9452*       move al-uabon            to instypea
  9453*       move -1                  to instypel
  9454*       move 'X'                 to error-switch
  9455*    end-if
  9456*
  9457*    if instypel > zero
  9458*       if instypei = 'C'
  9459*          if w-name-first (1:10) = cm-insured-first-name
  9460*             move er-1666          to emi-error
  9461*             PERFORM 9900-ERROR-FORMAT
  9462*                                   THRU 9900-EXIT
  9463*             move al-uabon         to instypea
  9464*             move -1               to instypel
  9465*             move 'X'              to error-switch
  9466*          end-if
  9467*       end-if
  9468*    end-if
  9469
  9470     if (pi-company-id = 'DCC')
  9471        and (acct-found)
  9472        perform 2120-check-pdef  thru 2120-exit
  9473     end-if
  9474     if benperl > zeros
  9475        move al-uanon            to benpera
  9476     end-if
  9477     if benperl > zeros
  9478        if benperi numeric
  9479           perform 1015-edit-benefit-period
  9480                                 thru 1015-exit
  9481        else
  9482           move er-1669          to emi-error
  9483           PERFORM 9900-ERROR-FORMAT
  9484                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 171
* EL131.cbl
  9485           move al-uabon         to benpera
  9486           move -1               to benperl
  9487           move 'X'              to error-switch
  9488        end-if
  9489    end-if
  9490     if instypel > zeros
  9491        if instypei = 'P' OR 'C'
  9492           move 'X'              to update-switch
  9493                                    mstr-switch
  9494           move al-uanon         to instypea
  9495        else
  9496            move er-1654          to emi-error
  9497           PERFORM 9900-ERROR-FORMAT
  9498                                 THRU 9900-EXIT
  9499           move al-uabon         to instypea
  9500           move -1               to instypel
  9501           move 'X'              to error-switch
  9502        end-if
  9503    end-if
  9504     if accswl > zeros
  9505        if accswi = 'Y' OR 'N'
  9506           MOVE 'X'              TO UPDATE-SWITCH
  9507                                    MSTR-SWITCH
  9508           MOVE AL-UANON         TO accswa
  9509*       else
  9510*          move er-1656          to emi-error
  9511*          PERFORM 9900-ERROR-FORMAT
  9512*                                THRU 9900-EXIT
  9513*          move al-uabon         to accswa
  9514*          move -1               to accswl
  9515*          move 'X'              to error-switch
  9516*          move al-uanof         to accswa
  9517        end-if
  9518     end-if
  9519     IF CERTL = ZEROS AND
  9520        SUFXL = ZEROS
  9521          GO TO 1010-EXIT.
  9522
  9523     IF CERTL GREATER THAN ZEROS
  9524         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9525             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9526             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9527             MOVE 'X'            TO ERROR-SWITCH
  9528             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9529
  9530     IF SUFXL GREATER THAN ZEROS
  9531         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9532             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9533             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9534             MOVE 'X'            TO ERROR-SWITCH
  9535             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9536
  9537 1010-EXIT.
  9538     EXIT.
  9539
  9540 1015-edit-benefit-period.
  9541     move ' '                    to ws-benper-sw
  9542     evaluate true
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 172
* EL131.cbl
  9543        when not erpdef-found
  9544           set good-benper       to true
  9545        when pd-recurring-yn (a1) = 'Y'
  9546           set good-benper       to true
  9547        when pd-recurring-yn (a1) = 'N'
  9548           if benperi < 02
  9549              set good-benper    to true
  9550           end-if
  9551        when pd-rec-crit-period (a1) numeric
  9552           if benperi <= pd-rec-crit-period (a1)
  9553              set good-benper    to true
  9554           end-if
  9555     end-evaluate
  9556     MOVE CERT-KEY               TO ELCRTT-KEY
  9557     MOVE 'B'                    TO CTRLR-REC-TYPE
  9558
  9559* EXEC CICS READ
  9560*       DATASET   ('ELCRTT')
  9561*       RIDFLD    (ELCRTT-KEY)
  9562*       INTO      (CERTIFICATE-TRAILERS)
  9563*       RESP      (WS-RESPONSE)
  9564*    END-EXEC
  9565     MOVE LENGTH OF
  9566      CERTIFICATE-TRAILERS
  9567       TO DFHEIV11
  9568     MOVE 'ELCRTT' TO DFHEIV1
  9569*    MOVE '&"IL       E          (  N#00009094' TO DFHEIV0
  9570     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9571     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9572     MOVE X'204E233030303039303934' TO DFHEIV0(25:11)
  9573     CALL 'kxdfhei1' USING DFHEIV0,
  9574           DFHEIV1,
  9575           CERTIFICATE-TRAILERS,
  9576           DFHEIV11,
  9577           ELCRTT-KEY,
  9578           DFHEIV99,
  9579           DFHEIV99,
  9580           DFHEIV99
  9581     MOVE EIBRESP  TO WS-RESPONSE
  9582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9583     IF WS-RESP-NORMAL
  9584        perform varying s1 from +1 by +1 until
  9585           (s1 > +24)
  9586           or ((cs-claim-type (s1) = cl-claim-type)
  9587           and (cs-insured-type (s1) = cl-insured-type)
  9588           and (cs-benefit-period (s1) > benperi))
  9589        end-perform
  9590        if s1 < +25
  9591           move er-1665          to emi-error
  9592           PERFORM 9900-ERROR-FORMAT
  9593                                 THRU 9900-EXIT
  9594           move al-uabon         to benpera
  9595           move -1               to benperl
  9596           move 'X'              to error-switch
  9597           go to 1015-exit
  9598*       else
  9599*          set good-benper       to true
  9600        end-if
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 173
* EL131.cbl
  9601     end-if
  9602     if good-benper
  9603        move 'X'                 to update-switch
  9604                                    mstr-switch
  9605        move al-uanon            to benpera
  9606     else
  9607        move er-1669             to emi-error
  9608        PERFORM 9900-ERROR-FORMAT
  9609                                 THRU 9900-EXIT
  9610        move al-uabon            to benpera
  9611        move -1                  to benperl
  9612        move 'X'                 to error-switch
  9613     end-if
  9614     .
  9615 1015-exit.
  9616     exit.
  9617 1050-EDIT-BENE.
  9618     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
  9619     MOVE PI-CARRIER         TO TRLR-CARRIER.
  9620     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
  9621     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
  9622     MOVE 1000               TO TRLR-SEQ-NO.
  9623
  9624
  9625* EXEC CICS HANDLE CONDITION
  9626*         NOTFND    (1052-DONE)
  9627*         ENDFILE   (1052-DONE)
  9628*    END-EXEC.
  9629*    MOVE '"$I''                  ! & #00009141' TO DFHEIV0
  9630     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9631     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9632     MOVE X'2620233030303039313431' TO DFHEIV0(25:11)
  9633     CALL 'kxdfhei1' USING DFHEIV0
  9634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9635
  9636
  9637
  9638* EXEC CICS STARTBR
  9639*        DATASET (TRLR-FILE-ID)
  9640*        RIDFLD  (TRLR-KEY)
  9641*    END-EXEC
  9642     MOVE 0
  9643       TO DFHEIV11
  9644*    MOVE '&,         G          &   #00009146' TO DFHEIV0
  9645     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9646     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9647     MOVE X'2020233030303039313436' TO DFHEIV0(25:11)
  9648     CALL 'kxdfhei1' USING DFHEIV0,
  9649           TRLR-FILE-ID,
  9650           TRLR-KEY,
  9651           DFHEIV99,
  9652           DFHEIV11,
  9653           DFHEIV99
  9654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9655
  9656
  9657     MOVE SPACES TO WS-TRLR-FILE-EOF
  9658                    WS-PAYMENT-PENDING
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 174
* EL131.cbl
  9659     PERFORM 1052-READ-TRLR THRU 1052-EXIT
  9660       UNTIL  TRLR-FILE-EOF
  9661         OR PAYMENT-PENDING
  9662
  9663
  9664* EXEC CICS ENDBR
  9665*        DATASET (TRLR-FILE-ID)
  9666*    END-EXEC.
  9667     MOVE 0
  9668       TO DFHEIV11
  9669*    MOVE '&2                    $   #00009158' TO DFHEIV0
  9670     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9671     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9672     MOVE X'2020233030303039313538' TO DFHEIV0(25:11)
  9673     CALL 'kxdfhei1' USING DFHEIV0,
  9674           TRLR-FILE-ID,
  9675           DFHEIV11,
  9676           DFHEIV99
  9677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9678
  9679 1050-EXIT.
  9680     EXIT.
  9681
  9682 1052-READ-TRLR.
  9683
  9684* EXEC CICS READNEXT
  9685*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9686*         DATASET  (TRLR-FILE-ID)
  9687*         RIDFLD   (TRLR-KEY)
  9688*    END-EXEC.
  9689     MOVE 0
  9690       TO DFHEIV11
  9691*    MOVE '&.S                   )   #00009165' TO DFHEIV0
  9692     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9693     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9694     MOVE X'2020233030303039313635' TO DFHEIV0(25:11)
  9695     CALL 'kxdfhei1' USING DFHEIV0,
  9696           TRLR-FILE-ID,
  9697           DFHEIV20,
  9698           DFHEIV99,
  9699           TRLR-KEY,
  9700           DFHEIV99,
  9701           DFHEIV11,
  9702           DFHEIV99,
  9703           DFHEIV99
  9704     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9705         DFHEIV20
  9706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9707
  9708
  9709     IF PI-COMPANY-CD   = TRLR-COMPANY-CD
  9710       AND PI-CARRIER  = TRLR-CARRIER
  9711       AND PI-CLAIM-NO = TRLR-CLAIM-NO
  9712       AND PI-CERT-NO  = TRLR-CERT-NO
  9713        CONTINUE
  9714     ELSE
  9715        GO TO 1052-DONE
  9716     END-IF.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 175
* EL131.cbl
  9717
  9718     IF PAYMENT-TR
  9719       AND BENEFICIARY-PAID
  9720       AND AT-VOID-DT = LOW-VALUES
  9721       AND AT-CHECK-WRITTEN-DT NOT > SPACES
  9722         SET PAYMENT-PENDING TO TRUE
  9723     END-IF.
  9724
  9725     GO TO 1052-EXIT.
  9726
  9727 1052-DONE.
  9728     SET TRLR-FILE-EOF TO TRUE.
  9729 1052-EXIT.
  9730     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 176
* EL131.cbl
  9732 1120-EDIT-PROC.
  9733     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9734     MOVE '2'                    TO CNTL-REC-TYPE.
  9735     MOVE PROCI                  TO CNTL-PROC-ID.
  9736     MOVE ZERO                   TO CNTL-SEQ-NO.
  9737
  9738
  9739* EXEC CICS HANDLE CONDITION
  9740*         NOTFND    (1120-CNTL-NOTFND)
  9741*    END-EXEC.
  9742*    MOVE '"$I                   ! '' #00009200' TO DFHEIV0
  9743     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9744     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9745     MOVE X'2720233030303039323030' TO DFHEIV0(25:11)
  9746     CALL 'kxdfhei1' USING DFHEIV0
  9747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9748
  9749
  9750
  9751* EXEC CICS READ
  9752*         SET      (ADDRESS OF CONTROL-FILE)
  9753*         DATASET  (CNTL-FILE-ID)
  9754*         RIDFLD   (CNTL-KEY)
  9755*    END-EXEC.
  9756*    MOVE '&"S        E          (   #00009204' TO DFHEIV0
  9757     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9758     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9759     MOVE X'2020233030303039323034' TO DFHEIV0(25:11)
  9760     CALL 'kxdfhei1' USING DFHEIV0,
  9761           CNTL-FILE-ID,
  9762           DFHEIV20,
  9763           DFHEIV99,
  9764           CNTL-KEY,
  9765           DFHEIV99,
  9766           DFHEIV99,
  9767           DFHEIV99
  9768     SET ADDRESS OF CONTROL-FILE TO
  9769         DFHEIV20
  9770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9771
  9772
  9773     MOVE AL-UANON               TO PROCA.
  9774     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  9775     GO TO 1120-EXIT.
  9776
  9777 1120-CNTL-NOTFND.
  9778     MOVE ER-0273                TO EMI-ERROR.
  9779     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9780     MOVE AL-UABON               TO PROCA.
  9781     MOVE -1                     TO PROCL.
  9782     MOVE 'X'                    TO ERROR-SWITCH.
  9783
  9784 1120-EXIT.
  9785     EXIT.
  9786
  9787*************************************************************
  9788*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  9789*************************************************************
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 177
* EL131.cbl
  9790
  9791 1150-OUTPUT-ACTIVITY-RECORD.
  9792
  9793
  9794* EXEC CICS GETMAIN
  9795*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  9796*        LENGTH (25)
  9797*        INITIMG (WS-BLANK)
  9798*    END-EXEC.
  9799     MOVE 25
  9800       TO DFHEIV11
  9801*    MOVE ',"IL                  $   #00009230' TO DFHEIV0
  9802     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9803     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9804     MOVE X'2020233030303039323330' TO DFHEIV0(25:11)
  9805     CALL 'kxdfhei1' USING DFHEIV0,
  9806           DFHEIV20,
  9807           DFHEIV11,
  9808           WS-BLANK
  9809     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  9810         DFHEIV20
  9811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9812
  9813
  9814     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  9815     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  9816     MOVE PI-CARRIER             TO DA-CARRIER.
  9817     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  9818     MOVE PI-CERT-NO             TO DA-CERT-NO.
  9819     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  9820     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  9821
  9822
  9823* EXEC CICS HANDLE CONDITION
  9824*        NOTOPEN (1150-NOTOPEN-ERROR)
  9825*        DUPREC (1150-EXIT)
  9826*    END-EXEC.
  9827*    MOVE '"$J%                  ! ( #00009244' TO DFHEIV0
  9828     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  9829     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9830     MOVE X'2820233030303039323434' TO DFHEIV0(25:11)
  9831     CALL 'kxdfhei1' USING DFHEIV0
  9832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9833
  9834     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  9835     MOVE 'DLYACTV'              TO JP-FILE-ID.
  9836     MOVE 'A'                    TO JP-RECORD-TYPE.
  9837     MOVE +48                    TO JOURNAL-LENGTH.
  9838
  9839
  9840* EXEC CICS WRITE
  9841*        DATASET ('DLYACTV')
  9842*        RIDFLD (DA-KEY)
  9843*        FROM (DAILY-ACTIVITY-RECORD)
  9844*        LENGTH (25)
  9845*    END-EXEC.
  9846     MOVE 'DLYACTV' TO DFHEIV1
  9847     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 178
* EL131.cbl
  9848       TO DFHEIV11
  9849*    MOVE '&$ L                  ''   #00009253' TO DFHEIV0
  9850     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9851     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9852     MOVE X'2020233030303039323533' TO DFHEIV0(25:11)
  9853     CALL 'kxdfhei1' USING DFHEIV0,
  9854           DFHEIV1,
  9855           DAILY-ACTIVITY-RECORD,
  9856           DFHEIV11,
  9857           DA-KEY,
  9858           DFHEIV99,
  9859           DFHEIV99
  9860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9861
  9862
  9863     GO TO 1150-EXIT.
  9864
  9865 1150-NOTOPEN-ERROR.
  9866
  9867     MOVE '2955'                 TO EMI-ERROR.
  9868     MOVE -1                     TO MAINTL.
  9869     MOVE AL-UANON               TO MAINTA.
  9870     MOVE 'X'                    TO ERROR-SWITCH.
  9871     PERFORM 9900-ERROR-FORMAT THRU
  9872             9900-EXIT.
  9873
  9874 1150-EXIT.
  9875     EXIT.
  9876
  9877*************************************************************
  9878*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  9879*************************************************************
  9880
  9881 1240-EDIT-LIFE-CODE.
  9882
  9883     IF INVALID-BENEFIT-CODE
  9884         GO TO 1240-SET-ERROR.
  9885
  9886     MOVE SPACES                 TO BENEFIT-KEY.
  9887     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9888     MOVE '4'                    TO BEN-REC-TYPE.
  9889     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9890     MOVE ZERO                   TO BEN-SEQ-NO.
  9891
  9892
  9893* EXEC CICS READ GTEQ
  9894*         DATASET  (CNTL-FILE-ID)
  9895*         RIDFLD   (BENEFIT-KEY)
  9896*         SET      (ADDRESS OF CONTROL-FILE)
  9897*    END-EXEC.
  9898*    MOVE '&"S        G          (   #00009289' TO DFHEIV0
  9899     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9900     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9901     MOVE X'2020233030303039323839' TO DFHEIV0(25:11)
  9902     CALL 'kxdfhei1' USING DFHEIV0,
  9903           CNTL-FILE-ID,
  9904           DFHEIV20,
  9905           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 179
* EL131.cbl
  9906           BENEFIT-KEY,
  9907           DFHEIV99,
  9908           DFHEIV99,
  9909           DFHEIV99
  9910     SET ADDRESS OF CONTROL-FILE TO
  9911         DFHEIV20
  9912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9913
  9914
  9915     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9916        CF-RECORD-TYPE NOT = '4'
  9917         GO TO 1240-SET-ERROR.
  9918
  9919     MOVE ZERO                   TO COUNT-2.
  9920     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9921
  9922     IF SCREEN-ERROR
  9923         GO TO 1240-SET-ERROR.
  9924
  9925 1240-SET-CODE-SWITCHES.
  9926     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9927     MOVE AL-UANON               TO LCVCDA.
  9928     GO TO 1240-EXIT.
  9929
  9930 1240-SET-ERROR.
  9931     MOVE ER-0240                TO EMI-ERROR.
  9932     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9933     MOVE 'X'                    TO ERROR-SWITCH.
  9934     MOVE AL-UABON               TO LCVCDA.
  9935     MOVE -1                     TO LCVCDL.
  9936
  9937 1240-EXIT.
  9938     EXIT.
  9939
  9940 1310-EDIT-AH-CODE.
  9941     IF INVALID-BENEFIT-CODE
  9942         GO TO 1310-SET-ERROR.
  9943
  9944     MOVE SPACES                 TO BENEFIT-KEY.
  9945     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9946     MOVE '5'                    TO BEN-REC-TYPE.
  9947     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9948     MOVE ZERO                   TO BEN-SEQ-NO.
  9949
  9950
  9951* EXEC CICS READ GTEQ
  9952*         DATASET  (CNTL-FILE-ID)
  9953*         RIDFLD   (BENEFIT-KEY)
  9954*         SET      (ADDRESS OF CONTROL-FILE)
  9955*    END-EXEC.
  9956*    MOVE '&"S        G          (   #00009330' TO DFHEIV0
  9957     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9958     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9959     MOVE X'2020233030303039333330' TO DFHEIV0(25:11)
  9960     CALL 'kxdfhei1' USING DFHEIV0,
  9961           CNTL-FILE-ID,
  9962           DFHEIV20,
  9963           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 180
* EL131.cbl
  9964           BENEFIT-KEY,
  9965           DFHEIV99,
  9966           DFHEIV99,
  9967           DFHEIV99
  9968     SET ADDRESS OF CONTROL-FILE TO
  9969         DFHEIV20
  9970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9971
  9972
  9973     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9974        CF-RECORD-TYPE NOT = '5'
  9975         GO TO 1310-SET-ERROR.
  9976
  9977     MOVE ZERO                   TO COUNT-2.
  9978     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9979     IF SCREEN-ERROR
  9980         GO TO 1310-SET-ERROR.
  9981
  9982 1310-SET-CODE-SWITCHES.
  9983     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9984     MOVE AL-UANON               TO ACVCDA.
  9985     GO TO 1310-EXIT.
  9986
  9987 1310-SET-ERROR.
  9988     MOVE ER-0250                TO EMI-ERROR.
  9989     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9990     MOVE AL-UABON               TO ACVCDA.
  9991     MOVE 'X'                    TO ERROR-SWITCH.
  9992     MOVE -1                     TO ACVCDL.
  9993
  9994 1310-EXIT.
  9995     EXIT.
  9996
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 181
* EL131.cbl
  9998 1460-EDIT-CERT-NO.
  9999     MOVE CERTI                  TO WS-CERT-NO-PRIME.
 10000     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
 10001
 10002     IF WS-SAVE-CERT-NO = SPACES
 10003         MOVE ER-0203            TO EMI-ERROR
 10004         GO TO 1460-CERT-NO-ERROR.
 10005
 10006     IF WS-CERT-NO-PRIME = SPACES AND
 10007        WS-CERT-NO-SUFX GREATER THAN SPACE
 10008            MOVE ER-0210         TO EMI-ERROR
 10009            GO TO 1460-CERT-NO-ERROR.
 10010
 10011     MOVE 'X'                    TO UPDATE-SWITCH.
 10012     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10013     MOVE AL-UANON               TO CERTA.
 10014
 10015     IF SUFXL IS GREATER THAN 0
 10016         MOVE AL-UANON           TO SUFXA.
 10017
 10018     GO TO 1460-EXIT.
 10019
 10020 1460-CERT-NO-ERROR.
 10021     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10022     MOVE AL-UABON               TO SUFXA.
 10023     MOVE AL-UABON               TO CERTA.
 10024     MOVE -1                     TO CERTL.
 10025     MOVE 'X'                    TO ERROR-SWITCH.
 10026
 10027 1460-EXIT.
 10028     EXIT.
 10029
 10030 1470-EDIT-EFF.
 10031     IF CERTEFFI = SPACES
 10032         GO TO 1470-DATE-ERROR.
 10033
 10034     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
 10035     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
 10036     IF DEEDIT-DATE = ZERO
 10037         GO TO 1470-DATE-ERROR.
 10038
 10039     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
 10040     MOVE '4'                    TO DC-OPTION-CODE.
 10041     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 10042     IF NOT DATE-CONVERSION-ERROR
 10043         MOVE DC-BIN-DATE-1      TO HOLD-EFF
 10044         MOVE AL-UANON           TO CERTEFFA
 10045         MOVE 'X'                TO UPDATE-SWITCH
 10046         MOVE 'Y'                TO CERT-KEY-SWITCH
 10047         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
 10048         GO TO 1470-EXIT.
 10049
 10050 1470-DATE-ERROR.
 10051     MOVE ER-0215                TO EMI-ERROR.
 10052     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10053     MOVE AL-UABON               TO CERTEFFA.
 10054     MOVE -1                     TO CERTEFFL.
 10055     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 182
* EL131.cbl
 10056
 10057 1470-EXIT.
 10058     EXIT.
 10059
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 183
* EL131.cbl
 10061 1480-EDIT-ACCT.
 10062     IF CERTACTI = SPACES
 10063         MOVE ER-0232            TO EMI-ERROR
 10064         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10065         MOVE AL-UABON           TO CERTACTA
 10066         MOVE -1                 TO CERTACTL
 10067         MOVE 'X'                TO ERROR-SWITCH
 10068     ELSE
 10069         MOVE 'X'                TO UPDATE-SWITCH
 10070         MOVE 'Y'                TO CERT-KEY-SWITCH.
 10071
 10072 1480-EXIT.
 10073     EXIT.
 10074
 10075 1490-EDIT-STATE.
 10076     IF CERTSTI = SPACES
 10077         MOVE ER-0233            TO EMI-ERROR
 10078         GO TO 1490-STATE-ERROR.
 10079
 10080     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10081     MOVE '3'                    TO CNTL-REC-TYPE.
 10082     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 10083     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
 10084     MOVE ZERO                   TO CNTL-SEQ-NO.
 10085
 10086
 10087* EXEC CICS HANDLE CONDITION
 10088*         NOTFND (1490-STATE-NOTFND)
 10089*    END-EXEC.
 10090*    MOVE '"$I                   ! ) #00009449' TO DFHEIV0
 10091     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10092     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10093     MOVE X'2920233030303039343439' TO DFHEIV0(25:11)
 10094     CALL 'kxdfhei1' USING DFHEIV0
 10095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10096
 10097
 10098
 10099* EXEC CICS READ
 10100*         SET        (ADDRESS OF CONTROL-FILE)
 10101*         DATASET    ('ELCNTL')
 10102*         RIDFLD     (CNTL-KEY)
 10103*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10104*         GENERIC
 10105*    END-EXEC.
 10106     MOVE 'ELCNTL' TO DFHEIV1
 10107*    MOVE '&"S  KG    E          (   #00009453' TO DFHEIV0
 10108     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10109     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10110     MOVE X'2020233030303039343533' TO DFHEIV0(25:11)
 10111     CALL 'kxdfhei1' USING DFHEIV0,
 10112           DFHEIV1,
 10113           DFHEIV20,
 10114           DFHEIV99,
 10115           CNTL-KEY,
 10116           CNTL-GENERIC-LENGTH,
 10117           DFHEIV99,
 10118           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 184
* EL131.cbl
 10119     SET ADDRESS OF CONTROL-FILE TO
 10120         DFHEIV20
 10121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10122
 10123
 10124     MOVE AL-UANON               TO CERTSTA.
 10125     MOVE 'X'                    TO UPDATE-SWITCH.
 10126     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10127     GO TO 1490-EXIT.
 10128
 10129 1490-STATE-NOTFND.
 10130     MOVE ER-0149                TO EMI-ERROR.
 10131
 10132 1490-STATE-ERROR.
 10133     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10134     MOVE AL-UABON               TO CERTSTA.
 10135     MOVE -1                     TO CERTSTL.
 10136     MOVE 'X'                    TO ERROR-SWITCH.
 10137
 10138 1490-EXIT.
 10139     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 185
* EL131.cbl
 10141 1500-EDIT-CARR.
 10142     IF CERTCARI = SPACES
 10143         GO TO 1500-CARR-NOTFND.
 10144
 10145     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10146     MOVE '6'                    TO CNTL-REC-TYPE.
 10147     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
 10148     MOVE CERTCARI               TO CNTL-CARRIER.
 10149     MOVE ZERO                   TO CNTL-SEQ-NO.
 10150
 10151
 10152* EXEC CICS HANDLE CONDITION
 10153*         NOTFND   (1500-CARR-NOTFND)
 10154*    END-EXEC.
 10155*    MOVE '"$I                   ! * #00009488' TO DFHEIV0
 10156     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10157     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10158     MOVE X'2A20233030303039343838' TO DFHEIV0(25:11)
 10159     CALL 'kxdfhei1' USING DFHEIV0
 10160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10161
 10162
 10163
 10164* EXEC CICS READ
 10165*         SET        (ADDRESS OF CONTROL-FILE)
 10166*         DATASET    ('ELCNTL')
 10167*         RIDFLD     (CNTL-KEY)
 10168*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10169*         GENERIC
 10170*    END-EXEC.
 10171     MOVE 'ELCNTL' TO DFHEIV1
 10172*    MOVE '&"S  KG    E          (   #00009492' TO DFHEIV0
 10173     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10174     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10175     MOVE X'2020233030303039343932' TO DFHEIV0(25:11)
 10176     CALL 'kxdfhei1' USING DFHEIV0,
 10177           DFHEIV1,
 10178           DFHEIV20,
 10179           DFHEIV99,
 10180           CNTL-KEY,
 10181           CNTL-GENERIC-LENGTH,
 10182           DFHEIV99,
 10183           DFHEIV99
 10184     SET ADDRESS OF CONTROL-FILE TO
 10185         DFHEIV20
 10186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10187
 10188
 10189     MOVE AL-UANON               TO CERTCARA.
 10190     MOVE 'X'                    TO UPDATE-SWITCH.
 10191     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10192     GO TO 1500-EXIT.
 10193
 10194 1500-CARR-NOTFND.
 10195     MOVE ER-0360                TO EMI-ERROR.
 10196     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10197     MOVE AL-UABON               TO CERTCARA.
 10198     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 186
* EL131.cbl
 10199     MOVE 'X'                    TO ERROR-SWITCH.
 10200
 10201 1500-EXIT.
 10202     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 187
* EL131.cbl
 10204 1510-DEEDIT-DATE.
 10205
 10206* EXEC CICS BIF DEEDIT
 10207*         FIELD    (DEEDIT-DATE-INPUT)
 10208*         LENGTH   (DATE-LENGTH)
 10209*    END-EXEC.
 10210*    MOVE '@"L                   #   #00009516' TO DFHEIV0
 10211     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10212     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10213     MOVE X'2020233030303039353136' TO DFHEIV0(25:11)
 10214     CALL 'kxdfhei1' USING DFHEIV0,
 10215           DEEDIT-DATE-INPUT,
 10216           DATE-LENGTH
 10217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10218
 10219
 10220 1510-EXIT.
 10221     EXIT.
 10222
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 188
* EL131.cbl
 10224 1620-VERIFY-ACCT.
 10225
 10226     move ' '                    to ws-eracct-sw
 10227     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
 10228     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10229     MOVE PI-GROUPING            TO ACCT-GROUP.
 10230     MOVE PI-STATE               TO ACCT-STATE.
 10231     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10232
 10233     IF CERTEFFI GREATER THAN LOW-VALUES
 10234         MOVE HOLD-EFF           TO ACCT-DATE
 10235     ELSE
 10236         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
 10237
 10238     IF CERTACTI GREATER THAN LOW-VALUES
 10239         MOVE CERTACTI           TO  ACCT-ACCOUNT.
 10240     IF CERTSTI GREATER THAN LOW-VALUES
 10241         MOVE CERTSTI            TO  ACCT-STATE.
 10242     IF CERTCARI GREATER THAN LOW-VALUES
 10243         MOVE CERTCARI           TO  ACCT-CARRIER.
 10244     IF CERTGRPI GREATER THAN LOW-VALUES
 10245         MOVE CERTGRPI           TO ACCT-GROUP.
 10246
 10247     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
 10248
 10249
 10250* EXEC CICS HANDLE CONDITION
 10251*         NOTFND  (1620-ACCT-NOTFND)
 10252*    END-EXEC.
 10253*    MOVE '"$I                   ! + #00009550' TO DFHEIV0
 10254     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10255     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10256     MOVE X'2B20233030303039353530' TO DFHEIV0(25:11)
 10257     CALL 'kxdfhei1' USING DFHEIV0
 10258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10259
 10260
 10261
 10262* EXEC CICS STARTBR
 10263*         DATASET   (ACCT-FILE-ID)
 10264*         RIDFLD    (ACCT-KEY)
 10265*    END-EXEC.
 10266     MOVE 0
 10267       TO DFHEIV11
 10268*    MOVE '&,         G          &   #00009554' TO DFHEIV0
 10269     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10270     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10271     MOVE X'2020233030303039353534' TO DFHEIV0(25:11)
 10272     CALL 'kxdfhei1' USING DFHEIV0,
 10273           ACCT-FILE-ID,
 10274           ACCT-KEY,
 10275           DFHEIV99,
 10276           DFHEIV11,
 10277           DFHEIV99
 10278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10279
 10280
 10281 1620-ACCT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 189
* EL131.cbl
 10282
 10283
 10284* EXEC CICS READNEXT
 10285*         DATASET  (ACCT-FILE-ID)
 10286*         RIDFLD   (ACCT-KEY)
 10287*         SET      (ADDRESS OF ACCOUNT-MASTER)
 10288*    END-EXEC.
 10289     MOVE 0
 10290       TO DFHEIV11
 10291*    MOVE '&.S                   )   #00009561' TO DFHEIV0
 10292     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10293     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10294     MOVE X'2020233030303039353631' TO DFHEIV0(25:11)
 10295     CALL 'kxdfhei1' USING DFHEIV0,
 10296           ACCT-FILE-ID,
 10297           DFHEIV20,
 10298           DFHEIV99,
 10299           ACCT-KEY,
 10300           DFHEIV99,
 10301           DFHEIV11,
 10302           DFHEIV99,
 10303           DFHEIV99
 10304     SET ADDRESS OF ACCOUNT-MASTER TO
 10305         DFHEIV20
 10306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10307
 10308
 10309     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
 10310         GO TO 1620-ACCT-NOTFND.
 10311
 10312     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
 10313        HOLD-EFF     LESS AM-EXPIRATION-DT
 10314         NEXT SENTENCE
 10315     ELSE
 10316         GO TO 1620-ACCT-LOOP.
 10317
 10318     set acct-found to true
 10319     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 10320         GO TO 1620-ACCT-END-BROWSE.
 10321
 10322     IF LOANBALL GREATER THAN +0
 10323         IF AM-MAX-TOT-BEN NUMERIC  AND
 10324            AM-MAX-TOT-BEN GREATER THAN ZERO
 10325             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
 10326                 MOVE AL-UNBON     TO LOANBALA
 10327                 MOVE -1           TO LOANBALL
 10328                 MOVE 'X'          TO ERROR-SWITCH
 10329                 MOVE ER-7641      TO EMI-ERROR
 10330                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10331
 10332     IF ACVBENEL GREATER THAN +0
 10333         IF AM-MAX-MON-BEN NUMERIC  AND
 10334            AM-MAX-MON-BEN GREATER THAN ZERO
 10335             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
 10336                 MOVE AL-UNBON     TO ACVBENEA
 10337                 MOVE -1           TO ACVBENEL
 10338                 MOVE 'X'          TO ERROR-SWITCH
 10339                 MOVE ER-7642      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 190
* EL131.cbl
 10340                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10341
 10342 1620-ACCT-END-BROWSE.
 10343
 10344
 10345* EXEC CICS ENDBR
 10346*         DATASET (ACCT-FILE-ID)
 10347*    END-EXEC.
 10348     MOVE 0
 10349       TO DFHEIV11
 10350*    MOVE '&2                    $   #00009602' TO DFHEIV0
 10351     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10352     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10353     MOVE X'2020233030303039363032' TO DFHEIV0(25:11)
 10354     CALL 'kxdfhei1' USING DFHEIV0,
 10355           ACCT-FILE-ID,
 10356           DFHEIV11,
 10357           DFHEIV99
 10358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10359
 10360
 10361     GO TO 1620-EXIT.
 10362
 10363 1620-ACCT-NOTFND.
 10364
 10365     MOVE -1                     TO MAINTL.
 10366     MOVE 'X'                    TO ERROR-SWITCH.
 10367     MOVE ER-0426                TO EMI-ERROR.
 10368     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10369
 10370 1620-EXIT.
 10371     EXIT.
 10372
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 191
* EL131.cbl
 10374 2000-UPDATE-CLAIM.
 10375
 10376     MOVE SPACES                 TO ERROR-SWITCH.
 10377     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 10378     MOVE PI-CARRIER             TO CARRIER-CODE.
 10379     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 10380     MOVE PI-CERT-NO             TO CERT-NO.
 10381
 10382     IF DELETE-CLAIM
 10383         GO TO 3000-DELETE-CLAIM.
 10384
 10385     IF  NOT MODIFY-CAP
 10386         MOVE ER-0070            TO EMI-ERROR
 10387         MOVE 'X'                TO ERROR-SWITCH
 10388         MOVE -1                 TO MAINTL
 10389         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10390         GO TO 2000-EXIT.
 10391
 10392     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 10393     MOVE ZERO                   TO TRLR-SEQ-NO.
 10394
 10395
 10396* EXEC CICS READ UPDATE
 10397*         SET       (ADDRESS OF CLAIM-MASTER)
 10398*         DATASET   (CLMS-FILE-ID)
 10399*         RIDFLD    (MSTR-KEY)
 10400*    END-EXEC.
 10401*    MOVE '&"S        EU         (   #00009640' TO DFHEIV0
 10402     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10403     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10404     MOVE X'2020233030303039363430' TO DFHEIV0(25:11)
 10405     CALL 'kxdfhei1' USING DFHEIV0,
 10406           CLMS-FILE-ID,
 10407           DFHEIV20,
 10408           DFHEIV99,
 10409           MSTR-KEY,
 10410           DFHEIV99,
 10411           DFHEIV99,
 10412           DFHEIV99
 10413     SET ADDRESS OF CLAIM-MASTER TO
 10414         DFHEIV20
 10415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10416
 10417
 10418     if (incl > zeros)
 10419        and (cl-no-of-pmts-made > 0)
 10420        and (hold-incur > low-values)
 10421        and (hold-incur not = cl-incurred-dt)
 10422        if hold-incur > cl-incurred-dt
 10423           move cl-incurred-dt   to dc-bin-date-1
 10424           move hold-incur       to dc-bin-date-2
 10425        else
 10426           move hold-incur       to dc-bin-date-1
 10427           move cl-incurred-dt   to dc-bin-date-2
 10428        end-if
 10429        move '1'                 to dc-option-code
 10430        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10431        if dc-elapsed-days > +60
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 192
* EL131.cbl
 10432           MOVE ER-1663             TO EMI-ERROR
 10433           PERFORM 9900-ERROR-FORMAT
 10434                                 THRU 9900-EXIT
 10435           MOVE -1                  TO MAINTL
 10436           GO TO 8110-SEND-DATA
 10437        end-if
 10438     end-if
 10439     IF (CL-PRIORITY-CD = '8')
 10440        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
 10441             AND 'AMWA' AND 'KMSB')
 10442        MOVE ER-8003             TO EMI-ERROR
 10443        PERFORM 9900-ERROR-FORMAT
 10444                                 THRU 9900-EXIT
 10445        MOVE -1                  TO MAINTL
 10446        GO TO 8110-SEND-DATA
 10447     END-IF
 10448
 10449     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
 10450         MOVE ER-0068            TO EMI-ERROR
 10451         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10452         GO TO 2000-EXIT.
 10453
 10454     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
 10455         MOVE ER-0068            TO EMI-ERROR
 10456         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10457         GO TO 2000-EXIT.
 10458
 10459     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
 10460         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
 10461
 10462     IF CL-PURGED-DT NOT = LOW-VALUES
 10463         MOVE ER-7691            TO EMI-ERROR
 10464         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10465         GO TO 2000-EXIT.
 10466
 10467     IF CERT-KEY-CHANGED
 10468         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
 10469
 10470     IF SCREEN-ERROR
 10471         MOVE ER-0068            TO EMI-ERROR
 10472         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10473         GO TO 2000-EXIT.
 10474
 10475     IF NINETY-TRLR-UPDATED
 10476         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
 10477
 10478     IF MSTR-KEY-CHANGED
 10479         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
 10480        ELSE
 10481         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
 10482
 10483     IF TRLR-UPDATE-REQUIRED
 10484         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
 10485
 10486 2000-CHECK-CERT.
 10487     IF NOT CERT-UPDATES
 10488         GO TO 2000-EXIT.
 10489
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 193
* EL131.cbl
 10490     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10491     MOVE PI-CARRIER             TO CERT-CARRIER.
 10492     MOVE PI-GROUPING            TO CERT-GROUP.
 10493     MOVE PI-STATE               TO CERT-STATE.
 10494     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10495     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10496     MOVE PI-CERT-NO             TO CERT-CERT.
 10497
 10498     IF CERT-ALT-KEY-CHANGED
 10499         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
 10500     ELSE
 10501         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
 10502
 10503 2000-EXIT.
 10504     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 194
* EL131.cbl
 10506 2010-RELEASE-REC.
 10507
 10508* EXEC CICS UNLOCK
 10509*         DATASET  (CLMS-FILE-ID)
 10510*    END-EXEC
 10511*    MOVE '&*                    #   #00009735' TO DFHEIV0
 10512     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10513     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10514     MOVE X'2020233030303039373335' TO DFHEIV0(25:11)
 10515     CALL 'kxdfhei1' USING DFHEIV0,
 10516           CLMS-FILE-ID,
 10517           DFHEIV99
 10518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10519
 10520     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10521     MOVE 'X'                    TO ERROR-SWITCH.
 10522
 10523 2010-EXIT.
 10524     EXIT.
 10525
 10526 2020-NORMAL-UPDATE.
 10527     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10528
 10529     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10530
 10531     IF WS-OPEN-CLOSE-SW = 'Y'
 10532       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10533       IF PI-REC-FOUND-SW = 'Y'
 10534         IF CL-ACTIVITY-CODE = 09
 10535           NEXT SENTENCE
 10536         ELSE
 10537           IF WS-RESET-SW = 'Y'
 10538             IF CL-CLAIM-STATUS = 'C'
 10539               MOVE 07               TO  CL-ACTIVITY-CODE
 10540               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10541               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
 10542             ELSE
 10543               MOVE 08               TO  CL-ACTIVITY-CODE
 10544               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10545               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
 10546
 10547     IF PI-COMPANY-ID = 'CID' or 'AHL'
 10548         MOVE 'Y'                TO CL-YESNOSW
 10549     END-IF.
 10550
 10551     if pi-company-id = 'DCC'
 10552        perform 1620-VERIFY-ACCT THRU 1620-EXIT
 10553        perform 2120-check-pdef  thru 2120-exit
 10554     end-if
 10555     if ((benperl <> zeros)
 10556        and (benperi numeric))
 10557                  or
 10558            (instypel <> zeros)
 10559        perform 2140-update-elcrtt thru 2140-exit
 10560     end-if
 10561
 10562* EXEC CICS HANDLE CONDITION
 10563*         DUPKEY   (2020-EXIT)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 195
* EL131.cbl
 10564*    END-EXEC.
 10565*    MOVE '"$$                   ! , #00009780' TO DFHEIV0
 10566     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10567     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10568     MOVE X'2C20233030303039373830' TO DFHEIV0(25:11)
 10569     CALL 'kxdfhei1' USING DFHEIV0
 10570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10571
 10572
 10573
 10574* EXEC CICS REWRITE
 10575*         DATASET   (CLMS-FILE-ID)
 10576*         FROM      (CLAIM-MASTER)
 10577*    END-EXEC.
 10578     MOVE LENGTH OF
 10579      CLAIM-MASTER
 10580       TO DFHEIV11
 10581*    MOVE '&& L                  %   #00009784' TO DFHEIV0
 10582     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10583     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10584     MOVE X'2020233030303039373834' TO DFHEIV0(25:11)
 10585     CALL 'kxdfhei1' USING DFHEIV0,
 10586           CLMS-FILE-ID,
 10587           CLAIM-MASTER,
 10588           DFHEIV11,
 10589           DFHEIV99
 10590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10591
 10592
 10593 2020-EXIT.
 10594     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 196
* EL131.cbl
 10596 2030-KEY-UPDATE.
 10597     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
 10598
 10599
 10600* EXEC CICS DELETE
 10601*        DATASET  (CLMS-FILE-ID)
 10602*    END-EXEC.
 10603*    MOVE '&(                    &   #00009795' TO DFHEIV0
 10604     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10605     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10606     MOVE X'2020233030303039373935' TO DFHEIV0(25:11)
 10607     CALL 'kxdfhei1' USING DFHEIV0,
 10608           CLMS-FILE-ID,
 10609           DFHEIV99,
 10610           DFHEIV99,
 10611           DFHEIV99,
 10612           DFHEIV99
 10613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10614
 10615
 10616
 10617* EXEC CICS GETMAIN
 10618*         SET      (ADDRESS OF CLAIM-MASTER)
 10619*         LENGTH   (MSTR-LENGTH)
 10620*         INITIMG  (GETMAIN-SPACE)
 10621*    END-EXEC.
 10622*    MOVE ',"IL                  $   #00009799' TO DFHEIV0
 10623     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10624     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10625     MOVE X'2020233030303039373939' TO DFHEIV0(25:11)
 10626     CALL 'kxdfhei1' USING DFHEIV0,
 10627           DFHEIV20,
 10628           MSTR-LENGTH,
 10629           GETMAIN-SPACE
 10630     SET ADDRESS OF CLAIM-MASTER TO
 10631         DFHEIV20
 10632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10633
 10634
 10635     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10636
 10637     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10638
 10639     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10640
 10641     IF WS-OPEN-CLOSE-SW = 'Y'
 10642       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10643         IF PI-REC-FOUND-SW = 'Y'
 10644           IF CL-ACTIVITY-CODE = 09
 10645             NEXT SENTENCE
 10646           ELSE
 10647             IF WS-RESET-SW = 'Y'
 10648               IF CL-CLAIM-STATUS = 'C'
 10649                 MOVE 07             TO  CL-ACTIVITY-CODE
 10650                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10651                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10652               ELSE
 10653                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 197
* EL131.cbl
 10654                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10655                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10656
 10657
 10658* EXEC CICS HANDLE CONDITION
 10659*         DUPKEY    (2030-EXIT)
 10660*    END-EXEC.
 10661*    MOVE '"$$                   ! - #00009827' TO DFHEIV0
 10662     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10663     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10664     MOVE X'2D20233030303039383237' TO DFHEIV0(25:11)
 10665     CALL 'kxdfhei1' USING DFHEIV0
 10666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10667
 10668
 10669** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10670*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10671
 10672     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10673         MOVE 'Y'                TO CL-YESNOSW
 10674     END-IF.
 10675
 10676
 10677* EXEC CICS WRITE
 10678*         DATASET   (CLMS-FILE-ID)
 10679*         RIDFLD    (MSTR-KEY)
 10680*         FROM      (CLAIM-MASTER)
 10681*    END-EXEC.
 10682     MOVE LENGTH OF
 10683      CLAIM-MASTER
 10684       TO DFHEIV11
 10685*    MOVE '&$ L                  ''   #00009838' TO DFHEIV0
 10686     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10687     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10688     MOVE X'2020233030303039383338' TO DFHEIV0(25:11)
 10689     CALL 'kxdfhei1' USING DFHEIV0,
 10690           CLMS-FILE-ID,
 10691           CLAIM-MASTER,
 10692           DFHEIV11,
 10693           MSTR-KEY,
 10694           DFHEIV99,
 10695           DFHEIV99
 10696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10697
 10698
 10699 2030-EXIT.
 10700     EXIT.
 10701
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 198
* EL131.cbl
 10703 2040-NORMAL-UPDATE.
 10704
 10705* EXEC CICS READ UPDATE
 10706*         DATASET  (CERT-FILE-ID)
 10707*         RIDFLD   (CERT-KEY)
 10708*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10709*    END-EXEC.
 10710*    MOVE '&"S        EU         (   #00009849' TO DFHEIV0
 10711     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10712     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10713     MOVE X'2020233030303039383439' TO DFHEIV0(25:11)
 10714     CALL 'kxdfhei1' USING DFHEIV0,
 10715           CERT-FILE-ID,
 10716           DFHEIV20,
 10717           DFHEIV99,
 10718           CERT-KEY,
 10719           DFHEIV99,
 10720           DFHEIV99,
 10721           DFHEIV99
 10722     SET ADDRESS OF CERTIFICATE-MASTER TO
 10723         DFHEIV20
 10724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10725
 10726
 10727     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10728
 10729
 10730* EXEC CICS HANDLE CONDITION
 10731*         DUPKEY   (2040-EXIT)
 10732*    END-EXEC.
 10733*    MOVE '"$$                   ! . #00009857' TO DFHEIV0
 10734     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10735     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10736     MOVE X'2E20233030303039383537' TO DFHEIV0(25:11)
 10737     CALL 'kxdfhei1' USING DFHEIV0
 10738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10739
 10740
 10741
 10742* EXEC CICS REWRITE
 10743*         DATASET  (CERT-FILE-ID)
 10744*         FROM     (CERTIFICATE-MASTER)
 10745*    END-EXEC.
 10746     MOVE LENGTH OF
 10747      CERTIFICATE-MASTER
 10748       TO DFHEIV11
 10749*    MOVE '&& L                  %   #00009861' TO DFHEIV0
 10750     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10751     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10752     MOVE X'2020233030303039383631' TO DFHEIV0(25:11)
 10753     CALL 'kxdfhei1' USING DFHEIV0,
 10754           CERT-FILE-ID,
 10755           CERTIFICATE-MASTER,
 10756           DFHEIV11,
 10757           DFHEIV99
 10758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10759
 10760
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 199
* EL131.cbl
 10761 2040-EXIT.
 10762     EXIT.
 10763
 10764 2050-KEY-UPDATE.
 10765
 10766* EXEC CICS READ UPDATE
 10767*         DATASET  (CERT-FILE-ID)
 10768*         RIDFLD   (CERT-KEY)
 10769*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10770*    END-EXEC.
 10771*    MOVE '&"S        EU         (   #00009870' TO DFHEIV0
 10772     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10773     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10774     MOVE X'2020233030303039383730' TO DFHEIV0(25:11)
 10775     CALL 'kxdfhei1' USING DFHEIV0,
 10776           CERT-FILE-ID,
 10777           DFHEIV20,
 10778           DFHEIV99,
 10779           CERT-KEY,
 10780           DFHEIV99,
 10781           DFHEIV99,
 10782           DFHEIV99
 10783     SET ADDRESS OF CERTIFICATE-MASTER TO
 10784         DFHEIV20
 10785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10786
 10787
 10788     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 10789
 10790
 10791* EXEC CICS DELETE
 10792*         DATASET   (CERT-FILE-ID)
 10793*    END-EXEC.
 10794*    MOVE '&(                    &   #00009878' TO DFHEIV0
 10795     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10796     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10797     MOVE X'2020233030303039383738' TO DFHEIV0(25:11)
 10798     CALL 'kxdfhei1' USING DFHEIV0,
 10799           CERT-FILE-ID,
 10800           DFHEIV99,
 10801           DFHEIV99,
 10802           DFHEIV99,
 10803           DFHEIV99
 10804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10805
 10806
 10807
 10808* EXEC CICS GETMAIN
 10809*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10810*         LENGTH    (CERT-LENGTH)
 10811*         INITIMG   (GETMAIN-SPACE)
 10812*    END-EXEC.
 10813*    MOVE ',"IL                  $   #00009882' TO DFHEIV0
 10814     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10815     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10816     MOVE X'2020233030303039383832' TO DFHEIV0(25:11)
 10817     CALL 'kxdfhei1' USING DFHEIV0,
 10818           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 200
* EL131.cbl
 10819           CERT-LENGTH,
 10820           GETMAIN-SPACE
 10821     SET ADDRESS OF CERTIFICATE-MASTER TO
 10822         DFHEIV20
 10823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10824
 10825
 10826     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 10827
 10828     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10829
 10830
 10831* EXEC CICS HANDLE CONDITION
 10832*         DUPKEY (2050-EXIT)
 10833*    END-EXEC.
 10834*    MOVE '"$$                   ! / #00009892' TO DFHEIV0
 10835     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10836     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10837     MOVE X'2F20233030303039383932' TO DFHEIV0(25:11)
 10838     CALL 'kxdfhei1' USING DFHEIV0
 10839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10840
 10841
 10842
 10843* EXEC CICS WRITE
 10844*         DATASET  (CERT-FILE-ID)
 10845*         RIDFLD   (CERT-KEY)
 10846*         FROM     (CERTIFICATE-MASTER)
 10847*    END-EXEC.
 10848     MOVE LENGTH OF
 10849      CERTIFICATE-MASTER
 10850       TO DFHEIV11
 10851*    MOVE '&$ L                  ''   #00009896' TO DFHEIV0
 10852     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10853     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10854     MOVE X'2020233030303039383936' TO DFHEIV0(25:11)
 10855     CALL 'kxdfhei1' USING DFHEIV0,
 10856           CERT-FILE-ID,
 10857           CERTIFICATE-MASTER,
 10858           DFHEIV11,
 10859           CERT-KEY,
 10860           DFHEIV99,
 10861           DFHEIV99
 10862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10863
 10864
 10865 2050-EXIT.
 10866     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 201
* EL131.cbl
 10868 2060-CHANGE-CERT.
 10869     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10870     MOVE PI-CARRIER             TO CERT-CARRIER.
 10871     MOVE PI-GROUPING            TO CERT-GROUP.
 10872     MOVE PI-STATE               TO CERT-STATE.
 10873     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10874     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10875     MOVE PI-CERT-NO             TO CERT-CERT.
 10876     IF CERTEFFI GREATER THAN LOW-VALUES
 10877         MOVE HOLD-EFF           TO CERT-DATE.
 10878     IF CERTACTI GREATER THAN LOW-VALUES
 10879         MOVE CERTACTI           TO CERT-ACCOUNT.
 10880     IF CERTSTI GREATER THAN LOW-VALUES
 10881         MOVE CERTSTI            TO CERT-STATE.
 10882     IF CERTCARI GREATER THAN LOW-VALUES
 10883         MOVE CERTCARI           TO CERT-CARRIER.
 10884     IF CERTGRPI GREATER THAN LOW-VALUES
 10885         MOVE CERTGRPI           TO CERT-GROUP.
 10886     IF CERTI GREATER THAN LOW-VALUES
 10887         MOVE CERTI              TO CERT-CERT-PRIME.
 10888     IF SUFXI GREATER THAN LOW-VALUES
 10889         MOVE SUFXI              TO CERT-CERT-SUFX.
 10890
 10891
 10892* EXEC CICS HANDLE CONDITION
 10893*         NOTFND   (2060-CERT-NOTFND)
 10894*    END-EXEC.
 10895*    MOVE '"$I                   ! 0 #00009928' TO DFHEIV0
 10896     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10897     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10898     MOVE X'3020233030303039393238' TO DFHEIV0(25:11)
 10899     CALL 'kxdfhei1' USING DFHEIV0
 10900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10901
 10902
 10903
 10904* EXEC CICS READ UPDATE
 10905*         DATASET  (CERT-FILE-ID)
 10906*         RIDFLD   (CERT-KEY)
 10907*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10908*    END-EXEC.
 10909*    MOVE '&"S        EU         (   #00009932' TO DFHEIV0
 10910     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10911     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10912     MOVE X'2020233030303039393332' TO DFHEIV0(25:11)
 10913     CALL 'kxdfhei1' USING DFHEIV0,
 10914           CERT-FILE-ID,
 10915           DFHEIV20,
 10916           DFHEIV99,
 10917           CERT-KEY,
 10918           DFHEIV99,
 10919           DFHEIV99,
 10920           DFHEIV99
 10921     SET ADDRESS OF CERTIFICATE-MASTER TO
 10922         DFHEIV20
 10923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10924
 10925
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 202
* EL131.cbl
 10926     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 10927
 10928     IF CM-CLAIM-INTERFACE-SW = SPACES
 10929        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10930
 10931
 10932* EXEC CICS HANDLE CONDITION
 10933*         DUPKEY   (2060-DUPKEY)
 10934*    END-EXEC.
 10935*    MOVE '"$$                   ! 1 #00009943' TO DFHEIV0
 10936     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10937     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10938     MOVE X'3120233030303039393433' TO DFHEIV0(25:11)
 10939     CALL 'kxdfhei1' USING DFHEIV0
 10940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10941
 10942
 10943
 10944* EXEC CICS REWRITE
 10945*         DATASET  (CERT-FILE-ID)
 10946*         FROM     (CERTIFICATE-MASTER)
 10947*    END-EXEC.
 10948     MOVE LENGTH OF
 10949      CERTIFICATE-MASTER
 10950       TO DFHEIV11
 10951*    MOVE '&& L                  %   #00009947' TO DFHEIV0
 10952     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10953     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10954     MOVE X'2020233030303039393437' TO DFHEIV0(25:11)
 10955     CALL 'kxdfhei1' USING DFHEIV0,
 10956           CERT-FILE-ID,
 10957           CERTIFICATE-MASTER,
 10958           DFHEIV11,
 10959           DFHEIV99
 10960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10961
 10962
 10963 2060-DUPKEY.
 10964
 10965     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10966
 10967 2060-CHANGE-TRLR-ACTQ.
 10968     IF SCREEN-ERROR
 10969         GO TO 2060-EXIT.
 10970
 10971     IF CERTI    GREATER LOW-VALUES OR
 10972        SUFXI    GREATER LOW-VALUES OR
 10973        CERTCARI GREATER LOW-VALUES
 10974         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 10975         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 10976
 10977     MOVE SPACES                 TO CERT-KEY-SWITCH
 10978                                    CERT-SWITCH
 10979                                    TRLR-SWITCH
 10980                                    NINETY-TRLR-SWITCH.
 10981     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 10982     GO TO 2060-EXIT.
 10983
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 203
* EL131.cbl
 10984 2060-CERT-NOTFND.
 10985     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10986
 10987     IF WS-REC-FOUND-SW = 'N'
 10988         MOVE ER-0206            TO  EMI-ERROR
 10989         MOVE -1                 TO  MAINTL
 10990         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10991
 10992* EXEC CICS UNLOCK
 10993*            DATASET   (CLMS-FILE-ID)
 10994*        END-EXEC
 10995*    MOVE '&*                    #   #00009980' TO DFHEIV0
 10996     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10997     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10998     MOVE X'2020233030303039393830' TO DFHEIV0(25:11)
 10999     CALL 'kxdfhei1' USING DFHEIV0,
 11000           CLMS-FILE-ID,
 11001           DFHEIV99
 11002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11003         GO TO 8110-SEND-DATA.
 11004
 11005     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 11006
 11007     GO TO 2060-CHANGE-TRLR-ACTQ.
 11008
 11009 2060-EXIT.
 11010     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 204
* EL131.cbl
 11012 2070-CHECK-OLD.
 11013
 11014
 11015* EXEC CICS HANDLE CONDITION
 11016*        NOTFND   (2070-NOT-FOUND)
 11017*    END-EXEC.
 11018*    MOVE '"$I                   ! 2 #00009994' TO DFHEIV0
 11019     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11020     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11021     MOVE X'3220233030303039393934' TO DFHEIV0(25:11)
 11022     CALL 'kxdfhei1' USING DFHEIV0
 11023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11024
 11025
 11026     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 11027     MOVE PI-CARRIER             TO CERT-CARRIER.
 11028     MOVE PI-GROUPING            TO CERT-GROUP.
 11029     MOVE PI-STATE               TO CERT-STATE.
 11030     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 11031     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 11032     MOVE PI-CERT-NO             TO CERT-CERT.
 11033
 11034
 11035* EXEC CICS READ UPDATE
 11036*         DATASET  (CERT-FILE-ID)
 11037*         RIDFLD   (CERT-KEY)
 11038*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11039*    END-EXEC.
 11040*    MOVE '&"S        EU         (   #00010006' TO DFHEIV0
 11041     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11042     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11043     MOVE X'2020233030303130303036' TO DFHEIV0(25:11)
 11044     CALL 'kxdfhei1' USING DFHEIV0,
 11045           CERT-FILE-ID,
 11046           DFHEIV20,
 11047           DFHEIV99,
 11048           CERT-KEY,
 11049           DFHEIV99,
 11050           DFHEIV99,
 11051           DFHEIV99
 11052     SET ADDRESS OF CERTIFICATE-MASTER TO
 11053         DFHEIV20
 11054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11055
 11056
 11057     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 11058     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 11059     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 11060
 11061     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 11062         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 11063
 11064     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11065       AND
 11066        CERT-WAS-CREATED-FOR-CLAIM
 11067         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 11068
 11069* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 205
* EL131.cbl
 11070*             DATASET   (CERT-FILE-ID)
 11071*        END-EXEC
 11072*    MOVE '&(                    &   #00010023' TO DFHEIV0
 11073     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11074     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11075     MOVE X'2020233030303130303233' TO DFHEIV0(25:11)
 11076     CALL 'kxdfhei1' USING DFHEIV0,
 11077           CERT-FILE-ID,
 11078           DFHEIV99,
 11079           DFHEIV99,
 11080           DFHEIV99,
 11081           DFHEIV99
 11082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11083         GO TO 2070-EXIT.
 11084
 11085     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11086         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11087
 11088
 11089* EXEC CICS HANDLE CONDITION
 11090*         DUPKEY   (2070-EXIT)
 11091*    END-EXEC.
 11092*    MOVE '"$$                   ! 3 #00010031' TO DFHEIV0
 11093     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11094     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11095     MOVE X'3320233030303130303331' TO DFHEIV0(25:11)
 11096     CALL 'kxdfhei1' USING DFHEIV0
 11097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11098
 11099
 11100
 11101* EXEC CICS REWRITE
 11102*         DATASET  (CERT-FILE-ID)
 11103*         FROM     (CERTIFICATE-MASTER)
 11104*    END-EXEC.
 11105     MOVE LENGTH OF
 11106      CERTIFICATE-MASTER
 11107       TO DFHEIV11
 11108*    MOVE '&& L                  %   #00010035' TO DFHEIV0
 11109     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11110     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11111     MOVE X'2020233030303130303335' TO DFHEIV0(25:11)
 11112     CALL 'kxdfhei1' USING DFHEIV0,
 11113           CERT-FILE-ID,
 11114           CERTIFICATE-MASTER,
 11115           DFHEIV11,
 11116           DFHEIV99
 11117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11118
 11119
 11120     GO TO 2070-EXIT.
 11121
 11122 2070-NOT-FOUND.
 11123     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 11124
 11125 2070-EXIT.
 11126     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 206
* EL131.cbl
 11128 2080-CREATE-CERT.
 11129
 11130* EXEC CICS GETMAIN
 11131*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 11132*         LENGTH    (CERT-LENGTH)
 11133*         INITIMG   (GETMAIN-SPACE)
 11134*    END-EXEC.
 11135*    MOVE ',"IL                  $   #00010049' TO DFHEIV0
 11136     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11137     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11138     MOVE X'2020233030303130303439' TO DFHEIV0(25:11)
 11139     CALL 'kxdfhei1' USING DFHEIV0,
 11140           DFHEIV20,
 11141           CERT-LENGTH,
 11142           GETMAIN-SPACE
 11143     SET ADDRESS OF CERTIFICATE-MASTER TO
 11144         DFHEIV20
 11145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11146
 11147
 11148     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 11149
 11150     IF CERTEFFI GREATER THAN LOW-VALUES
 11151         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 11152                                    DC-BIN-DATE-1
 11153         MOVE '6'                TO DC-OPTION-CODE
 11154         MOVE +1                 TO DC-ELAPSED-MONTHS
 11155         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11156         IF NO-CONVERSION-ERROR
 11157             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 11158
 11159     IF CERTACTI GREATER THAN LOW-VALUES
 11160         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 11161     IF CERTSTI GREATER THAN LOW-VALUES
 11162         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 11163     IF CERTCARI GREATER THAN LOW-VALUES
 11164         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 11165     IF CERTGRPI GREATER THAN LOW-VALUES
 11166         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 11167     IF CERTI GREATER THAN LOW-VALUES
 11168         MOVE CERTI              TO CERT-CERT-PRIME
 11169                                    CM-CERT-PRIME
 11170         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11171
 11172     IF SUFXI GREATER THAN LOW-VALUES
 11173         MOVE SUFXI              TO CERT-CERT-SUFX
 11174                                    CM-CERT-SFX
 11175         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11176
 11177     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11178
 11179     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 11180
 11181     MOVE SPACES                 TO CM-ENTRY-BATCH
 11182                                    CM-LF-EXIT-BATCH
 11183                                    CM-AH-EXIT-BATCH
 11184                                    CM-CREDIT-INTERFACE-SW-1
 11185                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 207
* EL131.cbl
 11186
 11187     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11188                               '9' OR 'D' OR 'V'
 11189         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11190
 11191     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11192                               '9' OR 'D' OR 'V'
 11193         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11194
 11195     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 11196                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 11197     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 11198
 11199
 11200* EXEC CICS HANDLE CONDITION
 11201*         DUPKEY (2080-EXIT)
 11202*    END-EXEC.
 11203*    MOVE '"$$                   ! 4 #00010106' TO DFHEIV0
 11204     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11205     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11206     MOVE X'3420233030303130313036' TO DFHEIV0(25:11)
 11207     CALL 'kxdfhei1' USING DFHEIV0
 11208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11209
 11210
 11211
 11212* EXEC CICS WRITE
 11213*         DATASET  (CERT-FILE-ID)
 11214*         RIDFLD   (CERT-KEY)
 11215*         FROM     (CERTIFICATE-MASTER)
 11216*    END-EXEC.
 11217     MOVE LENGTH OF
 11218      CERTIFICATE-MASTER
 11219       TO DFHEIV11
 11220*    MOVE '&$ L                  ''   #00010110' TO DFHEIV0
 11221     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11222     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11223     MOVE X'2020233030303130313130' TO DFHEIV0(25:11)
 11224     CALL 'kxdfhei1' USING DFHEIV0,
 11225           CERT-FILE-ID,
 11226           CERTIFICATE-MASTER,
 11227           DFHEIV11,
 11228           CERT-KEY,
 11229           DFHEIV99,
 11230           DFHEIV99
 11231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11232
 11233
 11234 2080-EXIT.
 11235     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 208
* EL131.cbl
 11237 2100-MOVE-MSTR.
 11238     IF TYPEI GREATER THAN LOW-VALUES
 11239         MOVE TYPEI              TO CL-CLAIM-TYPE.
 11240
 11241     IF STATUSI = LOW-VALUES
 11242         GO TO 2100-NO-STATUS-CHANGE.
 11243
 11244     IF STATUSI = 'OPEN' OR 'O'
 11245         IF CL-CLAIM-STATUS = 'O'
 11246             MOVE SPACES         TO TRLR-SWITCH
 11247                 GO TO 2100-NO-STATUS-CHANGE.
 11248
 11249     IF STATUSI = 'CLOSED' OR 'C'
 11250         IF CL-CLAIM-STATUS = 'C'
 11251             MOVE SPACES         TO TRLR-SWITCH
 11252                 GO TO 2100-NO-STATUS-CHANGE.
 11253
 11254     IF PI-COMPANY-ID = 'DMD'
 11255        IF STATUSI = 'OPEN' OR 'O'
 11256           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 11257              MOVE ZERO       TO STATUSL
 11258              MOVE LOW-VALUES TO STATUSI
 11259              GO TO 2100-NO-STATUS-CHANGE.
 11260
 11261     IF PI-COMPANY-ID = 'DMD'
 11262         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 11263
 11264     MOVE STATUSI                TO CL-CLAIM-STATUS.
 11265
 11266 2100-NO-STATUS-CHANGE.
 11267
 11268     IF CCNOI GREATER THAN LOW-VALUES
 11269         MOVE CCNOI              TO CL-CCN.
 11270
 11271     IF PROCI GREATER THAN LOW-VALUES
 11272         MOVE PROCI              TO CL-PROCESSOR-ID.
 11273
 11274     if (accswi > low-values)
 11275        and (accswi = 'Y' OR 'N')
 11276        move accswi              to cl-accident-claim-sw
 11277     end-if
 11278     if benperi > low-values
 11279        and benperi numeric
 11280        move benperi             to cl-benefit-period
 11281     end-if
 11282     if instypei > low-values
 11283        move instypei            to cl-insured-type
 11284     end-if
 11285     IF SEXI GREATER THAN LOW-VALUES
 11286         MOVE SEXI               TO CL-INSURED-SEX-CD.
 11287
 11288     IF BIRTHI GREATER THAN LOW-VALUES
 11289         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 11290
 11291     IF SOCIALI GREATER THAN LOW-VALUES
 11292       AND
 11293        SOCIALI = SPACES
 11294         MOVE CL-CERT-STATE      TO CL-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 209
* EL131.cbl
 11295         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 11296         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 11297     ELSE
 11298         IF SOCIALI GREATER THAN LOW-VALUES
 11299             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 11300
 11301     IF OCCI GREATER THAN LOW-VALUES
 11302         MOVE OCCI               TO CL-INSURED-OCC-CD.
 11303
 11304     IF BENEL GREATER THAN ZERO
 11305         MOVE BENEI              TO CL-BENEFICIARY.
 11306
 11307     IF DIAGI GREATER THAN LOW-VALUES
 11308         MOVE DIAGI              TO WS-DIAGNOSIS.
 11309
 11310     IF ICD1I GREATER THAN LOW-VALUES
 11311         MOVE ICD1I              TO WS-ICD-CODE-1
 11312     END-IF.
 11313
 11314     IF ICD2I GREATER THAN LOW-VALUES
 11315         MOVE ICD2I              TO WS-ICD-CODE-2
 11316     END-IF.
 11317
 11318     IF PREMTYPI GREATER THAN LOW-VALUES
 11319         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 11320
 11321*    IF CAUSEI GREATER THAN LOW-VALUES
 11322*        MOVE CAUSEI             TO CL-CAUSE-CD.
 11323
 11324*    IF ENDI GREATER THAN LOW-VALUES
 11325*        MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 11326
 11327     IF PDTHRUI GREATER THAN LOW-VALUES
 11328        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 11329
 11330     IF PDAMTL GREATER THAN +0
 11331        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 11332
 11333     IF NODAYSI GREATER THAN LOW-VALUES
 11334        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 11335
 11336     IF NOPMTSI GREATER THAN LOW-VALUES
 11337        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 11338
 11339     IF FORMTYPI GREATER THAN LOW-VALUES
 11340        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 11341
 11342     IF INCI GREATER THAN LOW-VALUES
 11343        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 11344
 11345     IF REPI GREATER THAN LOW-VALUES
 11346        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 11347
 11348     IF ADDONDTI GREATER THAN LOW-VALUES
 11349        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 11350
 11351     IF PRICDI GREATER THAN LOW-VALUES
 11352         MOVE PRICDI             TO CL-PRIORITY-CD.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 210
* EL131.cbl
 11353
 11354     IF CRITPL  > ZEROS
 11355        MOVE CRITPI              TO CL-CRITICAL-PERIOD
 11356     END-IF
 11357
 11358*    IF CRITPTL > ZEROS
 11359*       MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 11360*    END-IF
 11361
 11362*    IF RTWMOSL > ZEROS
 11363*       MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 11364*    END-IF
 11365     IF FILETOI GREATER THAN LOW-VALUES
 11366         MOVE FILETOI            TO CL-FILE-LOCATION.
 11367
 11368     IF SUPVI GREATER THAN LOW-VALUES
 11369         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 11370
 11371     IF MLNAMEI GREATER THAN LOW-VALUES
 11372         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 11373
 11374     IF MFNAMEI GREATER THAN LOW-VALUES
 11375         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 11376
 11377     IF MMINITI GREATER THAN LOW-VALUES
 11378         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 11379
 11380     IF CERTEFFI GREATER THAN LOW-VALUES
 11381         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 11382
 11383     IF CERTACTI GREATER THAN LOW-VALUES
 11384         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 11385
 11386     IF CERTSTI GREATER THAN LOW-VALUES
 11387         MOVE CERTSTI            TO CL-CERT-STATE.
 11388
 11389     IF CERTCARI GREATER THAN LOW-VALUES
 11390         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 11391                                    CL-CARRIER.
 11392
 11393     IF CERTGRPI GREATER THAN LOW-VALUES
 11394         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 11395
 11396     IF CERTI GREATER THAN LOW-VALUES
 11397         MOVE CERTI              TO CERT-NO-PRIME.
 11398
 11399     IF SUFXI GREATER THAN LOW-VALUES
 11400         MOVE SUFXI              TO CERT-NO-SUFX.
 11401
 11402     MOVE CERT-NO                TO CL-CERT-NO
 11403                                    CL-CERT-NO-A4.
 11404
 11405     IF PI-COMPANY-ID = 'FLA'
 11406          NEXT SENTENCE
 11407     ELSE
 11408         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 11409         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 11410         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 211
* EL131.cbl
 11411         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 11412
 11413     IF TRLR-UPDATE-REQUIRED
 11414        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 11415        MOVE ZEROS              TO TRLR-SEQ-NO
 11416
 11417* EXEC CICS READ
 11418*            DATASET   (TRLR-FILE-ID)
 11419*            RIDFLD    (TRLR-KEY)
 11420*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11421*       END-EXEC
 11422*    MOVE '&"S        E          (   #00010298' TO DFHEIV0
 11423     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11424     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11425     MOVE X'2020233030303130323938' TO DFHEIV0(25:11)
 11426     CALL 'kxdfhei1' USING DFHEIV0,
 11427           TRLR-FILE-ID,
 11428           DFHEIV20,
 11429           DFHEIV99,
 11430           TRLR-KEY,
 11431           DFHEIV99,
 11432           DFHEIV99,
 11433           DFHEIV99
 11434     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11435         DFHEIV20
 11436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11437        IF AT-TRAILER-TYPE = '1'
 11438           MOVE +1 TO MISC-SUB
 11439           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 11440           MISC-SUB GREATER THAN +6 OR
 11441           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 11442           IF MISC-SUB GREATER THAN +1
 11443              SUBTRACT +1 FROM MISC-SUB
 11444              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11445                 GO TO 2100-BYPASS-LAST-UPDATE.
 11446
 11447     IF TRLR-UPDATE-REQUIRED AND
 11448        CLAIM-IS-OPEN
 11449         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 11450     ELSE
 11451         IF TRLR-UPDATE-REQUIRED AND
 11452            CLAIM-IS-CLOSED
 11453             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 11454             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 11455
 11456 2100-BYPASS-LAST-UPDATE.
 11457     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11458     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 11459
 11460     GO TO 2100-EXIT.
 11461
 11462 2100-BUMP-OPEN-CLOSE-HIST.
 11463     ADD +1                      TO MISC-SUB.
 11464
 11465 2100-EXIT.
 11466     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 212
* EL131.cbl
 11468 2120-check-pdef.
 11469     move +0                     to s1
 11470     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 11471     move spaces                 to ws-dcc-error-line
 11472     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 11473     IF ERPDEF-FOUND
 11474        perform 2130-check-trlr  thru 2130-exit
 11475        move +1                  to s1
 11476*       if cl-accident-claim-sw = ' '
 11477*          move er-1655             to ws-error-no (s1)
 11478*          add +1 to s1
 11479*       end-if
 11480        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 11481        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 11482        if (hold-incur > low-values)
 11483           and (incl > zeros)
 11484           and (hold-incur not = cl-incurred-dt)
 11485           move hold-incur       to dc-bin-date-2
 11486        end-if
 11487        MOVE '1'                 TO DC-OPTION-CODE
 11488        MOVE +0                  TO DC-ELAPSED-MONTHS
 11489                                    DC-ELAPSED-DAYS
 11490        PERFORM 9800-CONVERT-DATE
 11491                                 THRU 9800-EXIT
 11492        IF NO-CONVERSION-ERROR
 11493           MOVE DC-ELAPSED-MONTHS
 11494                                 TO WS-MONTHS-BETWEEN
 11495           IF DC-ELAPSED-DAYS > 1
 11496              ADD 1 TO WS-MONTHS-BETWEEN
 11497           END-IF
 11498        ELSE
 11499           display ' dte conv error ' dc-error-code
 11500           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 11501        END-IF
 11502        IF (WS-EXCL-PERIOD = ZEROS)
 11503           OR (WS-MONTHS-BETWEEN = ZEROS)
 11504           CONTINUE
 11505        ELSE
 11506           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 11507              MOVE ER-1651       TO ws-error-no (s1)
 11508              add +1             to s1
 11509           END-IF
 11510        END-IF
 11511        IF (WS-COV-ENDS = ZEROS)
 11512           OR (WS-MONTHS-BETWEEN = ZEROS)
 11513           CONTINUE
 11514        ELSE
 11515           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 11516              MOVE -1            TO MAINTL
 11517              MOVE ER-1653       TO ws-error-no (s1)
 11518              add +1 to s1
 11519           END-IF
 11520        END-IF
 11521        IF (WS-ACC-PERIOD = ZEROS)
 11522           OR (WS-MONTHS-BETWEEN = ZEROS)
 11523           CONTINUE
 11524        ELSE
 11525           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 213
* EL131.cbl
 11526              and (accswi = spaces or low-values)
 11527*             and (cl-accident-claim-sw = ' ')
 11528              move er-1655       to ws-error-no (s1)
 11529              add +1             to s1
 11530           end-if
 11531           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 11532*             if (cl-accident-claim-sw not = 'Y')
 11533              if (accswi not = 'Y')
 11534                 MOVE ER-1652    TO ws-error-no (s1)
 11535              else
 11536                 move er-1662    to ws-error-no (s1)
 11537              end-if
 11538              MOVE -1            TO MAINTL
 11539              add +1             to s1
 11540           END-IF
 11541        END-IF
 11542        if cl-claim-type  = 'I'
 11543           move er-1661          to ws-error-no (s1)
 11544           add +1                to s1
 11545        end-if
 11546        perform 2130-check-trlr  thru 2130-exit
 11547     END-IF
 11548
 11549     .
 11550 2120-exit.
 11551     exit.
 11552
 11553 2130-check-trlr.
 11554
 11555     evaluate true
 11556        when s1 = +0
 11557           move cl-control-primary
 11558                                 to trlr-key
 11559           MOVE +95              TO TRLR-SEQ-NO
 11560
 11561* EXEC CICS READ
 11562*             update
 11563*             DATASET  ('ELTRLR')
 11564*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11565*             RIDFLD   (TRLR-KEY)
 11566*             RESP     (WS-RESPONSE)
 11567*          END-EXEC
 11568     MOVE 'ELTRLR' TO DFHEIV1
 11569*    MOVE '&"S        EU         (  N#00010426' TO DFHEIV0
 11570     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11571     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11572     MOVE X'204E233030303130343236' TO DFHEIV0(25:11)
 11573     CALL 'kxdfhei1' USING DFHEIV0,
 11574           DFHEIV1,
 11575           DFHEIV20,
 11576           DFHEIV99,
 11577           TRLR-KEY,
 11578           DFHEIV99,
 11579           DFHEIV99,
 11580           DFHEIV99
 11581     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11582         DFHEIV20
 11583     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 214
* EL131.cbl
 11584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11585           if ws-resp-normal
 11586              move spaces        to at-info-line-1
 11587           end-if
 11588        when s1 = +1
 11589           if ws-resp-normal
 11590
 11591* exec cics rewrite
 11592*                dataset   ('ELTRLR')
 11593*                from      (activity-trailers)
 11594*             end-exec
 11595     MOVE LENGTH OF
 11596      activity-trailers
 11597       TO DFHEIV11
 11598     MOVE 'ELTRLR' TO DFHEIV1
 11599*    MOVE '&& L                  %   #00010438' TO DFHEIV0
 11600     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11601     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11602     MOVE X'2020233030303130343338' TO DFHEIV0(25:11)
 11603     CALL 'kxdfhei1' USING DFHEIV0,
 11604           DFHEIV1,
 11605           activity-trailers,
 11606           DFHEIV11,
 11607           DFHEIV99
 11608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11609           end-if
 11610        when s1 > +1
 11611           if ws-resp-normal
 11612              move ws-dcc-error-line
 11613                                 to at-info-line-1
 11614
 11615* exec cics rewrite
 11616*                dataset   ('ELTRLR')
 11617*                from      (activity-trailers)
 11618*             end-exec
 11619     MOVE LENGTH OF
 11620      activity-trailers
 11621       TO DFHEIV11
 11622     MOVE 'ELTRLR' TO DFHEIV1
 11623*    MOVE '&& L                  %   #00010447' TO DFHEIV0
 11624     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11625     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11626     MOVE X'2020233030303130343437' TO DFHEIV0(25:11)
 11627     CALL 'kxdfhei1' USING DFHEIV0,
 11628           DFHEIV1,
 11629           activity-trailers,
 11630           DFHEIV11,
 11631           DFHEIV99
 11632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11633           else
 11634
 11635* EXEC CICS GETMAIN
 11636*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11637*                LENGTH   (TRLR-LENGTH)
 11638*                INITIMG  (GETMAIN-SPACE)
 11639*             END-EXEC
 11640*    MOVE ',"IL                  $   #00010452' TO DFHEIV0
 11641     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 215
* EL131.cbl
 11642     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11643     MOVE X'2020233030303130343532' TO DFHEIV0(25:11)
 11644     CALL 'kxdfhei1' USING DFHEIV0,
 11645           DFHEIV20,
 11646           TRLR-LENGTH,
 11647           GETMAIN-SPACE
 11648     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11649         DFHEIV20
 11650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11651              move 'AT'          to at-record-id
 11652              move cl-control-primary
 11653                                 to at-control-primary
 11654              move +95           to at-sequence-no
 11655              move '6'           to at-trailer-type
 11656              move ws-dcc-error-line
 11657                                 to at-info-line-1
 11658              move 'E'           to at-info-trailer-type
 11659              move save-bin-date to at-recorded-dt
 11660                                    at-gen-info-last-maint-dt
 11661              move pi-processor-id
 11662                                 to at-recorded-by
 11663                                    at-gen-info-last-updated-by
 11664              move eibtime       to at-last-maint-hhmmss
 11665
 11666* exec cics write
 11667*                dataset   ('ELTRLR')
 11668*                from      (activity-trailers)
 11669*                ridfld    (trlr-key)
 11670*             end-exec
 11671     MOVE LENGTH OF
 11672      activity-trailers
 11673       TO DFHEIV11
 11674     MOVE 'ELTRLR' TO DFHEIV1
 11675*    MOVE '&$ L                  ''   #00010471' TO DFHEIV0
 11676     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11677     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11678     MOVE X'2020233030303130343731' TO DFHEIV0(25:11)
 11679     CALL 'kxdfhei1' USING DFHEIV0,
 11680           DFHEIV1,
 11681           activity-trailers,
 11682           DFHEIV11,
 11683           trlr-key,
 11684           DFHEIV99,
 11685           DFHEIV99
 11686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11687              perform varying s1 from +1 by +1 until
 11688                 ws-error-no (s1) = spaces
 11689                 move ws-error-no (s1)
 11690                                 to emi-error
 11691                 PERFORM 9900-ERROR-FORMAT
 11692                                 THRU 9900-EXIT
 11693              end-perform
 11694           end-if
 11695     end-evaluate
 11696
 11697     .
 11698 2130-exit.
 11699     exit.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 216
* EL131.cbl
 11700 2140-update-elcrtt.
 11701     move ' '                    to crtt-switch
 11702     MOVE CERT-KEY               TO ELCRTT-KEY
 11703     MOVE 'B'                    TO CTRLR-REC-TYPE
 11704
 11705* EXEC CICS READ
 11706*       UPDATE
 11707*       DATASET   ('ELCRTT')
 11708*       RIDFLD    (ELCRTT-KEY)
 11709*       INTO      (CERTIFICATE-TRAILERS)
 11710*       RESP      (WS-RESPONSE)
 11711*    END-EXEC
 11712     MOVE LENGTH OF
 11713      CERTIFICATE-TRAILERS
 11714       TO DFHEIV11
 11715     MOVE 'ELCRTT' TO DFHEIV1
 11716*    MOVE '&"IL       EU         (  N#00010493' TO DFHEIV0
 11717     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11718     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11719     MOVE X'204E233030303130343933' TO DFHEIV0(25:11)
 11720     CALL 'kxdfhei1' USING DFHEIV0,
 11721           DFHEIV1,
 11722           CERTIFICATE-TRAILERS,
 11723           DFHEIV11,
 11724           ELCRTT-KEY,
 11725           DFHEIV99,
 11726           DFHEIV99,
 11727           DFHEIV99
 11728     MOVE EIBRESP  TO WS-RESPONSE
 11729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11730     IF WS-RESP-NORMAL
 11731        perform varying s1 from +1 by +1 until
 11732           (s1 > +24)
 11733           or (cs-claim-no (s1) = cl-claim-no)
 11734        end-perform
 11735        if (s1 < +25)
 11736           if (benperl <> zeros)
 11737              and (cs-benefit-period (s1) not = benperi)
 11738              move benperi       to cs-benefit-period (s1)
 11739              set crtt-update    to true
 11740          end-if
 11741          if (instypel <> zeros)
 11742             and (instypei not = cs-insured-type (s1))
 11743             move instypei      to cs-insured-type (s1)
 11744             set crtt-update    to true
 11745          end-if
 11746          move cs-claim-type (s1) to ws-claim-type
 11747          move cs-benefit-period (s1) to ws-ben-per
 11748        end-if
 11749        if crtt-update
 11750           perform 2150-accum    thru 2150-exit
 11751
 11752* EXEC CICS REWRITE
 11753*             DATASET   ('ELCRTT')
 11754*             FROM      (CERTIFICATE-TRAILERS)
 11755*          END-EXEC
 11756     MOVE LENGTH OF
 11757      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 217
* EL131.cbl
 11758       TO DFHEIV11
 11759     MOVE 'ELCRTT' TO DFHEIV1
 11760*    MOVE '&& L                  %   #00010521' TO DFHEIV0
 11761     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11762     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11763     MOVE X'2020233030303130353231' TO DFHEIV0(25:11)
 11764     CALL 'kxdfhei1' USING DFHEIV0,
 11765           DFHEIV1,
 11766           CERTIFICATE-TRAILERS,
 11767           DFHEIV11,
 11768           DFHEIV99
 11769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11770        else
 11771
 11772* exec cics unlock
 11773*             dataset   ('ELCRTT')
 11774*          end-exec
 11775     MOVE 'ELCRTT' TO DFHEIV1
 11776*    MOVE '&*                    #   #00010526' TO DFHEIV0
 11777     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11778     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11779     MOVE X'2020233030303130353236' TO DFHEIV0(25:11)
 11780     CALL 'kxdfhei1' USING DFHEIV0,
 11781           DFHEIV1,
 11782           DFHEIV99
 11783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11784        end-if
 11785     end-if
 11786     .
 11787 2140-exit.
 11788     exit.
 11789 2150-accum.
 11790     if not erpdef-found
 11791        perform 3997-get-erpdef  thru 3997-exit
 11792     end-if
 11793     if (erpdef-found)
 11794        and (ws-max-moben not = zeros)
 11795        and (ws-max-moben < cm-ah-benefit-amt)
 11796        continue
 11797     else
 11798        move cm-ah-benefit-amt   to ws-max-moben
 11799     end-if
 11800     move cm-ah-orig-term        to ws-max-bens
 11801     if cl-critical-period not = zeros and spaces
 11802        move cl-critical-period  to ws-max-bens
 11803     end-if
 11804     move zeros to ws-tot-days-paid ws-tot-amt-paid
 11805     perform varying s2 from +1 by +1 until
 11806        (s2 > +24)
 11807        or (cs-claim-no (s2) = spaces)
 11808        if (cs-benefit-period (s2) = ws-ben-per)
 11809           and (cs-claim-type (s2) = ws-claim-type)
 11810           and (cs-insured-type (s2) = cl-insured-type)
 11811*          compute ws-tot-days-paid =
 11812*             ws-tot-days-paid + cs-days-paid (s2)
 11813           compute ws-tot-amt-paid =
 11814              ws-tot-amt-paid + cs-total-paid (s2)
 11815        end-if
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 218
* EL131.cbl
 11816     end-perform
 11817     if s2 < +25
 11818        compute ws-pd-bens rounded =
 11819           ws-tot-amt-paid / ws-max-moben
 11820        compute cs-remaining-bens (s1) =
 11821           ws-max-bens - ws-pd-bens
 11822        if cs-remaining-bens (s1) < zeros
 11823           move zeros            to cs-remaining-bens (s1)
 11824        end-if
 11825     end-if
 11826     .
 11827 2150-exit.
 11828     exit.
 11829 2200-MOVE-CERT.
 11830     IF CRTLNMEI GREATER THAN LOW-VALUES
 11831         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 11832
 11833     IF CRTFNMEI GREATER THAN LOW-VALUES
 11834         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 11835         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 11836
 11837     IF CRTINITI GREATER THAN LOW-VALUES
 11838         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 11839
 11840     IF CM-INSURED-INITIALS = SPACES
 11841         MOVE '**'               TO CM-INSURED-INITIALS.
 11842
 11843     IF ISSAGEI GREATER THAN LOW-VALUES
 11844         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 11845
 11846     IF JNTFNMEI GREATER THAN LOW-VALUES
 11847         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 11848
 11849     IF JNTLNMEI GREATER THAN LOW-VALUES
 11850         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 11851
 11852     IF JNTINITI GREATER THAN LOW-VALUES
 11853         MOVE JNTINITI           TO CM-JT-INITIAL.
 11854
 11855     IF JNTAGEI GREATER THAN LOW-VALUES
 11856         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 11857
 11858     IF ADDONDTI GREATER THAN LOW-VALUES
 11859        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 11860
 11861     IF LCVCDI GREATER THAN LOW-VALUES
 11862        IF LCVCDI = SPACES OR ZEROS
 11863           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 11864        ELSE
 11865           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 11866
 11867     IF LCVOTRMI GREATER THAN LOW-VALUES
 11868         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 11869
 11870     IF LCVRATEL GREATER THAN +0
 11871         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 11872
 11873     IF LCVBENEL GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 219
* EL131.cbl
 11874         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 11875
 11876     IF LCVFORMI GREATER THAN LOW-VALUES
 11877         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 11878
 11879     IF LCVCNDTI = LOW-VALUES
 11880        GO TO 2210-SET-STATUS.
 11881
 11882     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 11883        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 11884        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 11885        GO TO 2210-SET-STATUS.
 11886
 11887     IF CM-LF-CURRENT-STATUS = '7'
 11888        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 11889        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 11890        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11891                                    CM-LF-DEATH-DT
 11892        GO TO 2210-SET-STATUS.
 11893
 11894     IF CM-LF-CURRENT-STATUS = '8'
 11895        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 11896        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11897                                    CM-LF-CANCEL-DT.
 11898
 11899 2210-SET-STATUS.
 11900
 11901     IF CM-LF-CURRENT-STATUS = SPACES
 11902         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11903
 11904     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 11905         MOVE '6'                TO DC-OPTION-CODE
 11906         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11907         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11908         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11909         IF NO-CONVERSION-ERROR
 11910             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 11911         ELSE
 11912             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 11913     ELSE
 11914         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 11915
 11916 2215-PROCESS-AH-SIDE.
 11917
 11918     IF ACVCDI GREATER THAN LOW-VALUES
 11919        IF ACVCDI = SPACES OR ZEROS
 11920           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 11921        ELSE
 11922           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 11923
 11924     IF ACVOTRMI GREATER THAN LOW-VALUES
 11925         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 11926
 11927     IF ACVRATEL GREATER THAN +0
 11928         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 11929
 11930     IF ACVBENEL GREATER THAN +0
 11931         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 220
* EL131.cbl
 11932                                    PI-PAYMENT-AMT.
 11933
 11934     IF ACVFORMI GREATER THAN LOW-VALUES
 11935         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 11936
 11937     IF ACVCNDTI = LOW-VALUES
 11938        GO TO 2220-SET-STATUS.
 11939
 11940     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 11941        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 11942        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 11943        GO TO 2220-SET-STATUS.
 11944
 11945     IF CM-AH-CURRENT-STATUS = '6'
 11946        MOVE CM-AH-STATUS-AT-SETTLEMENT
 11947                                 TO CM-AH-CURRENT-STATUS
 11948        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 11949        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11950                                    CM-AH-SETTLEMENT-DT
 11951        GO TO 2220-SET-STATUS.
 11952
 11953     IF CM-AH-CURRENT-STATUS = '8'
 11954        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 11955        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11956                                    CM-AH-CANCEL-DT.
 11957
 11958 2220-SET-STATUS.
 11959     IF CM-AH-CURRENT-STATUS = SPACES
 11960         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11961
 11962     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 11963         MOVE '6'                TO DC-OPTION-CODE
 11964         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11965         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11966         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11967         IF NO-CONVERSION-ERROR
 11968             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 11969         ELSE
 11970             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 11971     ELSE
 11972         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 11973
 11974 2225-FINISH-CERT.
 11975     IF APRL GREATER THAN +0
 11976         MOVE HOLD-APR           TO CM-LOAN-APR.
 11977
 11978     IF PMTFREQI GREATER THAN LOW-VALUES
 11979         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 11980
 11981     IF INDGRPI GREATER THAN LOW-VALUES
 11982         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 11983
 11984     IF LOANNOI GREATER THAN LOW-VALUES
 11985        MOVE LOANNOI             TO CM-LOAN-NUMBER.
 11986
 11987     IF LOANBALL GREATER THAN +0
 11988        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 11989
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 221
* EL131.cbl
 11990     IF PREMTYPI GREATER THAN LOW-VALUES
 11991         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 11992
 11993     IF REINCDI GREATER THAN LOW-VALUES
 11994         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 11995                                    WS-REIN-1
 11996                                    WS-REIN-2
 11997                                    WS-REIN-3
 11998         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 11999
 12000     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 12001
 12002     MOVE ZEROS                  TO CM-LOAN-TERM
 12003                                    CM-LIFE-COMM-PCT
 12004                                    CM-AH-COMM-PCT.
 12005
 12006*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 12007*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 12008*         PI-NO-PMTS = ZEROS
 12009*          IF LOANBALL GREATER THAN +0          OR
 12010*             ACVBENEL GREATER THAN +0          OR
 12011*             APRL     GREATER THAN +0          OR
 12012*             LCVRATEL GREATER THAN +0          OR
 12013*             ACVRATEL GREATER THAN +0
 12014*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 12015
 12016 2200-EXIT.
 12017     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 222
* EL131.cbl
 12019 2300-UPDATE-TRLR.
 12020     MOVE ZERO                   TO TRLR-SEQ-NO.
 12021
 12022* EXEC CICS READ UPDATE
 12023*         DATASET  (TRLR-FILE-ID)
 12024*         RIDFLD   (TRLR-KEY)
 12025*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12026*    END-EXEC.
 12027*    MOVE '&"S        EU         (   #00010766' TO DFHEIV0
 12028     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12029     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12030     MOVE X'2020233030303130373636' TO DFHEIV0(25:11)
 12031     CALL 'kxdfhei1' USING DFHEIV0,
 12032           TRLR-FILE-ID,
 12033           DFHEIV20,
 12034           DFHEIV99,
 12035           TRLR-KEY,
 12036           DFHEIV99,
 12037           DFHEIV99,
 12038           DFHEIV99
 12039     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12040         DFHEIV20
 12041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12042
 12043
 12044     MOVE ZERO                   TO COUNT-2.
 12045
 12046     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12047         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12048
 12049     IF NOT UPDATE-MADE
 12050         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12051
 12052
 12053* EXEC CICS REWRITE
 12054*         DATASET  (TRLR-FILE-ID)
 12055*         FROM     (ACTIVITY-TRAILERS)
 12056*    END-EXEC.
 12057     MOVE LENGTH OF
 12058      ACTIVITY-TRAILERS
 12059       TO DFHEIV11
 12060*    MOVE '&& L                  %   #00010780' TO DFHEIV0
 12061     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12062     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12063     MOVE X'2020233030303130373830' TO DFHEIV0(25:11)
 12064     CALL 'kxdfhei1' USING DFHEIV0,
 12065           TRLR-FILE-ID,
 12066           ACTIVITY-TRAILERS,
 12067           DFHEIV11,
 12068           DFHEIV99
 12069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12070
 12071
 12072 2300-EXIT.
 12073     EXIT.
 12074
 12075 2310-INS-STATUS.
 12076     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 223
* EL131.cbl
 12077     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 12078         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 12079         MOVE 'Y'                TO TRLR-SWITCH.
 12080
 12081 2310-EXIT.
 12082     EXIT.
 12083
 12084 2320-SHIFT-STATUS.
 12085     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 12086        MOVE 6                   TO COUNT-2
 12087        GO TO 2320-EXIT.
 12088
 12089     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 12090     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 12091     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 12092     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 12093     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 12094     MOVE 6       TO COUNT-2.
 12095     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 12096
 12097 2320-EXIT.
 12098     EXIT.
 12099
 12100 2330-ADD-UPDATE.
 12101
 12102     IF COUNT-2 GREATER THAN 1
 12103        COMPUTE MISC-SUB = (COUNT-2 - 1)
 12104        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 12105           GO TO 2330-EXIT.
 12106
 12107     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 12108                                   AT-RESERVES-LAST-MAINT-DT
 12109
 12110     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 12111     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 12112     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 12113     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 12114
 12115 2330-EXIT.
 12116     EXIT.
 12117
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 224
* EL131.cbl
 12119 2400-UPDATE-TRLR.
 12120
 12121* EXEC CICS HANDLE CONDITION
 12122*         NOTFND    (2400-TRLR-NOTFND)
 12123*         ENDFILE   (2410-EXIT)
 12124*    END-EXEC.
 12125*    MOVE '"$I''                  ! 5 #00010833' TO DFHEIV0
 12126     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12127     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12128     MOVE X'3520233030303130383333' TO DFHEIV0(25:11)
 12129     CALL 'kxdfhei1' USING DFHEIV0
 12130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12131
 12132
 12133
 12134* EXEC CICS STARTBR
 12135*        DATASET (TRLR-FILE-ID)
 12136*        RIDFLD  (TRLR-KEY)
 12137*    END-EXEC.
 12138     MOVE 0
 12139       TO DFHEIV11
 12140*    MOVE '&,         G          &   #00010838' TO DFHEIV0
 12141     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12142     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12143     MOVE X'2020233030303130383338' TO DFHEIV0(25:11)
 12144     CALL 'kxdfhei1' USING DFHEIV0,
 12145           TRLR-FILE-ID,
 12146           TRLR-KEY,
 12147           DFHEIV99,
 12148           DFHEIV11,
 12149           DFHEIV99
 12150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12151
 12152
 12153
 12154* EXEC CICS GETMAIN
 12155*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12156*         LENGTH    (TRLR-LENGTH)
 12157*         INITIMG   (GETMAIN-SPACE)
 12158*    END-EXEC.
 12159*    MOVE ',"IL                  $   #00010843' TO DFHEIV0
 12160     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12161     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12162     MOVE X'2020233030303130383433' TO DFHEIV0(25:11)
 12163     CALL 'kxdfhei1' USING DFHEIV0,
 12164           DFHEIV20,
 12165           TRLR-LENGTH,
 12166           GETMAIN-SPACE
 12167     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12168         DFHEIV20
 12169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12170
 12171
 12172     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 12173
 12174
 12175* EXEC CICS ENDBR
 12176*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 225
* EL131.cbl
 12177*    END-EXEC.
 12178     MOVE 0
 12179       TO DFHEIV11
 12180*    MOVE '&2                    $   #00010851' TO DFHEIV0
 12181     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12182     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12183     MOVE X'2020233030303130383531' TO DFHEIV0(25:11)
 12184     CALL 'kxdfhei1' USING DFHEIV0,
 12185           TRLR-FILE-ID,
 12186           DFHEIV11,
 12187           DFHEIV99
 12188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12189
 12190
 12191     GO TO 2400-EXIT.
 12192
 12193 2400-TRLR-NOTFND.
 12194     MOVE ER-0205                TO EMI-ERROR.
 12195     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12196     MOVE 'X'                    TO ERROR-SWITCH.
 12197
 12198 2400-EXIT.
 12199     EXIT.
 12200
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 226
* EL131.cbl
 12202 2410-CHANGE-TRLR.
 12203
 12204* EXEC CICS READNEXT
 12205*        DATASET (TRLR-FILE-ID)
 12206*        RIDFLD  (TRLR-KEY)
 12207*        INTO    (ACTIVITY-TRAILERS)
 12208*    END-EXEC.
 12209     MOVE LENGTH OF
 12210      ACTIVITY-TRAILERS
 12211       TO DFHEIV12
 12212     MOVE 0
 12213       TO DFHEIV11
 12214*    MOVE '&.IL                  )   #00010867' TO DFHEIV0
 12215     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12216     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12217     MOVE X'2020233030303130383637' TO DFHEIV0(25:11)
 12218     CALL 'kxdfhei1' USING DFHEIV0,
 12219           TRLR-FILE-ID,
 12220           ACTIVITY-TRAILERS,
 12221           DFHEIV12,
 12222           TRLR-KEY,
 12223           DFHEIV99,
 12224           DFHEIV11,
 12225           DFHEIV99,
 12226           DFHEIV99
 12227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12228
 12229
 12230     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 12231        GO TO 2410-CHANGE-TRLR.
 12232
 12233     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 12234                                    CHECK-KEY.
 12235
 12236     IF CHECK-KEY NOT = MSTR-KEY
 12237         GO TO 2410-EXIT.
 12238
 12239
 12240* EXEC CICS ENDBR
 12241*        DATASET (TRLR-FILE-ID)
 12242*    END-EXEC.
 12243     MOVE 0
 12244       TO DFHEIV11
 12245*    MOVE '&2                    $   #00010882' TO DFHEIV0
 12246     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12247     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12248     MOVE X'2020233030303130383832' TO DFHEIV0(25:11)
 12249     CALL 'kxdfhei1' USING DFHEIV0,
 12250           TRLR-FILE-ID,
 12251           DFHEIV11,
 12252           DFHEIV99
 12253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12254
 12255
 12256
 12257* EXEC CICS READ UPDATE
 12258*        DATASET (TRLR-FILE-ID)
 12259*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 227
* EL131.cbl
 12260*        INTO    (ACTIVITY-TRAILERS)
 12261*    END-EXEC.
 12262     MOVE LENGTH OF
 12263      ACTIVITY-TRAILERS
 12264       TO DFHEIV11
 12265*    MOVE '&"IL       EU         (   #00010886' TO DFHEIV0
 12266     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12267     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12268     MOVE X'2020233030303130383836' TO DFHEIV0(25:11)
 12269     CALL 'kxdfhei1' USING DFHEIV0,
 12270           TRLR-FILE-ID,
 12271           ACTIVITY-TRAILERS,
 12272           DFHEIV11,
 12273           TRLR-KEY,
 12274           DFHEIV99,
 12275           DFHEIV99,
 12276           DFHEIV99
 12277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12278
 12279
 12280
 12281* EXEC CICS DELETE
 12282*        DATASET (TRLR-FILE-ID)
 12283*    END-EXEC.
 12284*    MOVE '&(                    &   #00010892' TO DFHEIV0
 12285     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12286     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12287     MOVE X'2020233030303130383932' TO DFHEIV0(25:11)
 12288     CALL 'kxdfhei1' USING DFHEIV0,
 12289           TRLR-FILE-ID,
 12290           DFHEIV99,
 12291           DFHEIV99,
 12292           DFHEIV99,
 12293           DFHEIV99
 12294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12295
 12296
 12297     IF AT-SEQUENCE-NO = ZERO AND
 12298        TRLR-UPDATE-REQUIRED
 12299         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 12300
 12301     IF CERTI GREATER THAN LOW-VALUES
 12302        MOVE CERTI               TO AT-CERT-PRIME.
 12303
 12304     IF SUFXI GREATER THAN LOW-VALUES
 12305        MOVE SUFXI               TO AT-CERT-SFX.
 12306
 12307     IF CERTCARI GREATER THAN LOW-VALUES
 12308        MOVE CERTCARI            TO AT-CARRIER.
 12309
 12310     IF PAYMENT-TR
 12311        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 12312           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 12313              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 12314
 12315     IF CORRESPONDENCE-TR
 12316        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 12317           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 228
* EL131.cbl
 12318
 12319
 12320* EXEC CICS WRITE
 12321*         DATASET  (TRLR-FILE-ID)
 12322*         RIDFLD   (AT-CONTROL-PRIMARY)
 12323*         FROM     (ACTIVITY-TRAILERS)
 12324*    END-EXEC.
 12325     MOVE LENGTH OF
 12326      ACTIVITY-TRAILERS
 12327       TO DFHEIV11
 12328*    MOVE '&$ L                  ''   #00010918' TO DFHEIV0
 12329     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12330     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12331     MOVE X'2020233030303130393138' TO DFHEIV0(25:11)
 12332     CALL 'kxdfhei1' USING DFHEIV0,
 12333           TRLR-FILE-ID,
 12334           ACTIVITY-TRAILERS,
 12335           DFHEIV11,
 12336           AT-CONTROL-PRIMARY,
 12337           DFHEIV99,
 12338           DFHEIV99
 12339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12340
 12341
 12342
 12343* EXEC CICS STARTBR
 12344*         DATASET  (TRLR-FILE-ID)
 12345*         RIDFLD   (TRLR-KEY)
 12346*    END-EXEC.
 12347     MOVE 0
 12348       TO DFHEIV11
 12349*    MOVE '&,         G          &   #00010924' TO DFHEIV0
 12350     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12351     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12352     MOVE X'2020233030303130393234' TO DFHEIV0(25:11)
 12353     CALL 'kxdfhei1' USING DFHEIV0,
 12354           TRLR-FILE-ID,
 12355           TRLR-KEY,
 12356           DFHEIV99,
 12357           DFHEIV11,
 12358           DFHEIV99
 12359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12360
 12361
 12362     GO TO 2410-CHANGE-TRLR.
 12363
 12364 2410-EXIT.
 12365     EXIT.
 12366
 12367 2420-UPDATE-TRLR.
 12368     MOVE ZERO TO COUNT-2.
 12369     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12370         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12371
 12372     IF NOT UPDATE-MADE
 12373         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12374
 12375 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 229
* EL131.cbl
 12376     EXIT.
 12377
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 230
* EL131.cbl
 12379 2425-UPDATE-NINETY-TRLR.
 12380
 12381     MOVE +90                    TO TRLR-SEQ-NO.
 12382
 12383
 12384* EXEC CICS HANDLE CONDITION
 12385*         NOTFND    (2425-NINETY-NOTFND)
 12386*         ENDFILE   (2425-NINETY-NOTFND)
 12387*    END-EXEC.
 12388*    MOVE '"$I''                  ! 6 #00010950' TO DFHEIV0
 12389     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12390     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12391     MOVE X'3620233030303130393530' TO DFHEIV0(25:11)
 12392     CALL 'kxdfhei1' USING DFHEIV0
 12393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12394
 12395
 12396
 12397* EXEC CICS READ UPDATE
 12398*        DATASET (TRLR-FILE-ID)
 12399*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12400*        RIDFLD  (TRLR-KEY)
 12401*    END-EXEC.
 12402*    MOVE '&"S        EU         (   #00010955' TO DFHEIV0
 12403     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12404     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12405     MOVE X'2020233030303130393535' TO DFHEIV0(25:11)
 12406     CALL 'kxdfhei1' USING DFHEIV0,
 12407           TRLR-FILE-ID,
 12408           DFHEIV20,
 12409           DFHEIV99,
 12410           TRLR-KEY,
 12411           DFHEIV99,
 12412           DFHEIV99,
 12413           DFHEIV99
 12414     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12415         DFHEIV20
 12416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12417
 12418     if (diagi > low-values)
 12419        and (diagi not = at-info-line-1)
 12420        and (cl-total-paid-amt > zeros)
 12421        move cl-cert-eff-dt      to dc-bin-date-1
 12422        move cl-paid-thru-dt     to dc-bin-date-2
 12423        move '1'                 to dc-option-code
 12424        perform 9800-convert-date
 12425                                 thru 9800-exit
 12426        if no-conversion-error
 12427           and dc-elapsed-months < +24
 12428           and (not emi-bypass-forcables)
 12429           move er-1581          to emi-error
 12430           perform 9900-error-format
 12431                                thru 9900-exit
 12432           move -1              to diagl
 12433           go to 8110-send-data
 12434        end-if
 12435     end-if
 12436     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 231
* EL131.cbl
 12437     MOVE AT-ICD-CODE-1         TO WS-ICD-CODE-1.
 12438     MOVE AT-ICD-CODE-2         TO WS-ICD-CODE-2.
 12439
 12440     IF DIAGI GREATER THAN LOW-VALUES
 12441         MOVE DIAGI             TO AT-INFO-LINE-1
 12442     END-IF.
 12443
 12444     IF ICD1I GREATER THAN LOW-VALUES
 12445         MOVE ICD1I             TO AT-ICD-CODE-1
 12446     END-IF.
 12447
 12448     IF ICD2I GREATER THAN LOW-VALUES
 12449         MOVE ICD2I             TO AT-ICD-CODE-2
 12450     END-IF.
 12451
 12452
 12453* EXEC CICS REWRITE
 12454*        DATASET (TRLR-FILE-ID)
 12455*        FROM    (ACTIVITY-TRAILERS)
 12456*    END-EXEC.
 12457     MOVE LENGTH OF
 12458      ACTIVITY-TRAILERS
 12459       TO DFHEIV11
 12460*    MOVE '&& L                  %   #00010994' TO DFHEIV0
 12461     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12462     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12463     MOVE X'2020233030303130393934' TO DFHEIV0(25:11)
 12464     CALL 'kxdfhei1' USING DFHEIV0,
 12465           TRLR-FILE-ID,
 12466           ACTIVITY-TRAILERS,
 12467           DFHEIV11,
 12468           DFHEIV99
 12469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12470
 12471
 12472     IF DIAGI GREATER THAN LOW-VALUES
 12473       AND DIAGI NOT = WS-DIAGNOSIS
 12474         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 12475         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 12476         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12477
 12478     IF ICD1I GREATER THAN LOW-VALUES
 12479       AND ICD1I NOT = WS-ICD-CODE-1
 12480         MOVE 'ICD CODE 1'         TO SPLIT-INFO-DESC
 12481         MOVE WS-ICD-CODE-1        TO SPLIT-INFO-OLD
 12482         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12483     END-IF.
 12484
 12485     IF ICD2I GREATER THAN LOW-VALUES
 12486       AND ICD2I NOT = WS-ICD-CODE-2
 12487         MOVE 'ICD CODE 2'         TO SPLIT-INFO-DESC
 12488         MOVE WS-ICD-CODE-2        TO SPLIT-INFO-OLD
 12489         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12490     END-IF.
 12491
 12492     GO TO 2425-EXIT.
 12493
 12494 2425-NINETY-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 232
* EL131.cbl
 12495
 12496
 12497* EXEC CICS GETMAIN
 12498*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12499*         LENGTH    (TRLR-LENGTH)
 12500*         INITIMG   (GETMAIN-SPACE)
 12501*    END-EXEC.
 12502*    MOVE ',"IL                  $   #00011023' TO DFHEIV0
 12503     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12504     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12505     MOVE X'2020233030303131303233' TO DFHEIV0(25:11)
 12506     CALL 'kxdfhei1' USING DFHEIV0,
 12507           DFHEIV20,
 12508           TRLR-LENGTH,
 12509           GETMAIN-SPACE
 12510     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12511         DFHEIV20
 12512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12513
 12514
 12515     MOVE +90                  TO TRLR-SEQ-NO.
 12516     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 12517
 12518     MOVE 'AT'                 TO AT-RECORD-ID
 12519     MOVE '6'                  TO AT-TRAILER-TYPE
 12520     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 12521                                  AT-GEN-INFO-LAST-MAINT-DT
 12522     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 12523                                  AT-GEN-INFO-LAST-UPDATED-BY
 12524     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 12525     MOVE DIAGI                TO AT-INFO-LINE-1.
 12526     MOVE ICD1I                TO AT-ICD-CODE-1.
 12527     MOVE ICD2I                TO AT-ICD-CODE-2.
 12528
 12529
 12530* EXEC CICS WRITE
 12531*        DATASET (TRLR-FILE-ID)
 12532*        FROM    (ACTIVITY-TRAILERS)
 12533*        RIDFLD  (TRLR-KEY)
 12534*    END-EXEC.
 12535     MOVE LENGTH OF
 12536      ACTIVITY-TRAILERS
 12537       TO DFHEIV11
 12538*    MOVE '&$ L                  ''   #00011043' TO DFHEIV0
 12539     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12540     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12541     MOVE X'2020233030303131303433' TO DFHEIV0(25:11)
 12542     CALL 'kxdfhei1' USING DFHEIV0,
 12543           TRLR-FILE-ID,
 12544           ACTIVITY-TRAILERS,
 12545           DFHEIV11,
 12546           TRLR-KEY,
 12547           DFHEIV99,
 12548           DFHEIV99
 12549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12550
 12551
 12552 2425-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 233
* EL131.cbl
 12553     EXIT.
 12554
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 234
* EL131.cbl
 12556 2430-UPDATE-ACTQ.
 12557
 12558* EXEC CICS HANDLE CONDITION
 12559*         NOTFND    (2430-EXIT)
 12560*         ENDFILE   (2440-EXIT)
 12561*    END-EXEC.
 12562*    MOVE '"$I''                  ! 7 #00011054' TO DFHEIV0
 12563     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12564     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12565     MOVE X'3720233030303131303534' TO DFHEIV0(25:11)
 12566     CALL 'kxdfhei1' USING DFHEIV0
 12567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12568
 12569
 12570
 12571* EXEC CICS STARTBR
 12572*         DATASET  (ACTQ-FILE-ID)
 12573*         RIDFLD   (ACTQ-KEY)
 12574*    END-EXEC.
 12575     MOVE 0
 12576       TO DFHEIV11
 12577*    MOVE '&,         G          &   #00011059' TO DFHEIV0
 12578     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12579     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12580     MOVE X'2020233030303131303539' TO DFHEIV0(25:11)
 12581     CALL 'kxdfhei1' USING DFHEIV0,
 12582           ACTQ-FILE-ID,
 12583           ACTQ-KEY,
 12584           DFHEIV99,
 12585           DFHEIV11,
 12586           DFHEIV99
 12587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12588
 12589
 12590
 12591* EXEC CICS GETMAIN
 12592*         SET      (ADDRESS OF ACTIVITY-QUE)
 12593*         LENGTH   (ACTQ-LENGTH)
 12594*         INITIMG  (GETMAIN-SPACE)
 12595*    END-EXEC.
 12596*    MOVE ',"IL                  $   #00011064' TO DFHEIV0
 12597     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12598     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12599     MOVE X'2020233030303131303634' TO DFHEIV0(25:11)
 12600     CALL 'kxdfhei1' USING DFHEIV0,
 12601           DFHEIV20,
 12602           ACTQ-LENGTH,
 12603           GETMAIN-SPACE
 12604     SET ADDRESS OF ACTIVITY-QUE TO
 12605         DFHEIV20
 12606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12607
 12608
 12609     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 12610
 12611 2430-EXIT.
 12612     EXIT.
 12613
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 235
* EL131.cbl
 12614 2440-CHANGE-ACTQ.
 12615
 12616
 12617* EXEC CICS READNEXT
 12618*         DATASET  (ACTQ-FILE-ID)
 12619*         RIDFLD   (ACTQ-KEY)
 12620*         INTO     (ACTIVITY-QUE)
 12621*    END-EXEC.
 12622     MOVE LENGTH OF
 12623      ACTIVITY-QUE
 12624       TO DFHEIV12
 12625     MOVE 0
 12626       TO DFHEIV11
 12627*    MOVE '&.IL                  )   #00011077' TO DFHEIV0
 12628     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12629     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12630     MOVE X'2020233030303131303737' TO DFHEIV0(25:11)
 12631     CALL 'kxdfhei1' USING DFHEIV0,
 12632           ACTQ-FILE-ID,
 12633           ACTIVITY-QUE,
 12634           DFHEIV12,
 12635           ACTQ-KEY,
 12636           DFHEIV99,
 12637           DFHEIV11,
 12638           DFHEIV99,
 12639           DFHEIV99
 12640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12641
 12642
 12643
 12644* EXEC CICS ENDBR
 12645*         DATASET (ACTQ-FILE-ID)
 12646*    END-EXEC.
 12647     MOVE 0
 12648       TO DFHEIV11
 12649*    MOVE '&2                    $   #00011083' TO DFHEIV0
 12650     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12651     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12652     MOVE X'2020233030303131303833' TO DFHEIV0(25:11)
 12653     CALL 'kxdfhei1' USING DFHEIV0,
 12654           ACTQ-FILE-ID,
 12655           DFHEIV11,
 12656           DFHEIV99
 12657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12658
 12659
 12660     IF ACTQ-KEY NOT = MSTR-KEY
 12661         GO TO 2440-EXIT.
 12662
 12663
 12664* EXEC CICS READ UPDATE
 12665*         DATASET  (ACTQ-FILE-ID)
 12666*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12667*         SET      (ADDRESS OF ACTIVITY-QUE)
 12668*    END-EXEC.
 12669*    MOVE '&"S        EU         (   #00011090' TO DFHEIV0
 12670     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12671     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 236
* EL131.cbl
 12672     MOVE X'2020233030303131303930' TO DFHEIV0(25:11)
 12673     CALL 'kxdfhei1' USING DFHEIV0,
 12674           ACTQ-FILE-ID,
 12675           DFHEIV20,
 12676           DFHEIV99,
 12677           AQ-CONTROL-PRIMARY,
 12678           DFHEIV99,
 12679           DFHEIV99,
 12680           DFHEIV99
 12681     SET ADDRESS OF ACTIVITY-QUE TO
 12682         DFHEIV20
 12683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12684
 12685
 12686     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 12687
 12688
 12689* EXEC CICS DELETE
 12690*         DATASET (ACTQ-FILE-ID)
 12691*    END-EXEC.
 12692*    MOVE '&(                    &   #00011098' TO DFHEIV0
 12693     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12694     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12695     MOVE X'2020233030303131303938' TO DFHEIV0(25:11)
 12696     CALL 'kxdfhei1' USING DFHEIV0,
 12697           ACTQ-FILE-ID,
 12698           DFHEIV99,
 12699           DFHEIV99,
 12700           DFHEIV99,
 12701           DFHEIV99
 12702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12703
 12704
 12705     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 12706     IF CERTI GREATER THAN LOW-VALUES
 12707        MOVE CERTI               TO AQ-CERT-PRIME.
 12708     IF SUFXI GREATER THAN LOW-VALUES
 12709        MOVE SUFXI               TO AQ-CERT-SFX.
 12710     IF CERTCARI GREATER THAN LOW-VALUES
 12711        MOVE CERTCARI            TO AQ-CARRIER.
 12712
 12713
 12714* EXEC CICS HANDLE CONDITION
 12715*         DUPREC   (2440-EXIT)
 12716*    END-EXEC.
 12717*    MOVE '"$%                   ! 8 #00011110' TO DFHEIV0
 12718     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12719     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12720     MOVE X'3820233030303131313130' TO DFHEIV0(25:11)
 12721     CALL 'kxdfhei1' USING DFHEIV0
 12722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12723
 12724
 12725
 12726* EXEC CICS WRITE
 12727*         DATASET  (ACTQ-FILE-ID)
 12728*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12729*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 237
* EL131.cbl
 12730*    END-EXEC.
 12731     MOVE LENGTH OF
 12732      ACTIVITY-QUE
 12733       TO DFHEIV11
 12734*    MOVE '&$ L                  ''   #00011114' TO DFHEIV0
 12735     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12736     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12737     MOVE X'2020233030303131313134' TO DFHEIV0(25:11)
 12738     CALL 'kxdfhei1' USING DFHEIV0,
 12739           ACTQ-FILE-ID,
 12740           ACTIVITY-QUE,
 12741           DFHEIV11,
 12742           AQ-CONTROL-PRIMARY,
 12743           DFHEIV99,
 12744           DFHEIV99
 12745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12746
 12747
 12748 2440-EXIT.
 12749     EXIT.
 12750
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 238
* EL131.cbl
 12752 2460-UPDATE-CHECKQ.
 12753
 12754* EXEC CICS HANDLE CONDITION
 12755*         NOTFND   (2460-EXIT)
 12756*    END-EXEC.
 12757*    MOVE '"$I                   ! 9 #00011125' TO DFHEIV0
 12758     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12759     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12760     MOVE X'3920233030303131313235' TO DFHEIV0(25:11)
 12761     CALL 'kxdfhei1' USING DFHEIV0
 12762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12763
 12764
 12765     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 12766     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 12767     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 12768
 12769
 12770* EXEC CICS READ UPDATE
 12771*         DATASET   (CHKQ-FILE-ID)
 12772*         RIDFLD    (CHKQ-KEY)
 12773*         SET       (ADDRESS OF CHECK-QUE)
 12774*    END-EXEC.
 12775*    MOVE '&"S        EU         (   #00011133' TO DFHEIV0
 12776     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12777     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12778     MOVE X'2020233030303131313333' TO DFHEIV0(25:11)
 12779     CALL 'kxdfhei1' USING DFHEIV0,
 12780           CHKQ-FILE-ID,
 12781           DFHEIV20,
 12782           DFHEIV99,
 12783           CHKQ-KEY,
 12784           DFHEIV99,
 12785           DFHEIV99,
 12786           DFHEIV99
 12787     SET ADDRESS OF CHECK-QUE TO
 12788         DFHEIV20
 12789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12790
 12791
 12792     IF CERTI GREATER THAN LOW-VALUES
 12793        MOVE CERTI               TO CQ-CERT-PRIME.
 12794     IF SUFXI GREATER THAN LOW-VALUES
 12795        MOVE SUFXI               TO CQ-CERT-SFX.
 12796     IF CERTCARI GREATER THAN LOW-VALUES
 12797        MOVE CERTCARI            TO CQ-CARRIER.
 12798
 12799
 12800* EXEC CICS REWRITE
 12801*         DATASET  (CHKQ-FILE-ID)
 12802*         FROM     (CHECK-QUE)
 12803*    END-EXEC.
 12804     MOVE LENGTH OF
 12805      CHECK-QUE
 12806       TO DFHEIV11
 12807*    MOVE '&& L                  %   #00011146' TO DFHEIV0
 12808     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12809     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 239
* EL131.cbl
 12810     MOVE X'2020233030303131313436' TO DFHEIV0(25:11)
 12811     CALL 'kxdfhei1' USING DFHEIV0,
 12812           CHKQ-FILE-ID,
 12813           CHECK-QUE,
 12814           DFHEIV11,
 12815           DFHEIV99
 12816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12817
 12818
 12819 2460-EXIT.
 12820     EXIT.
 12821
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 240
* EL131.cbl
 12823 2475-UPDATE-LETTER.
 12824
 12825* EXEC CICS HANDLE CONDITION
 12826*         NOTFND   (2475-EXIT)
 12827*    END-EXEC.
 12828*    MOVE '"$I                   ! : #00011156' TO DFHEIV0
 12829     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12830     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12831     MOVE X'3A20233030303131313536' TO DFHEIV0(25:11)
 12832     CALL 'kxdfhei1' USING DFHEIV0
 12833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12834
 12835
 12836     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 12837     MOVE '1'                    TO ARCH-RECORD-TYPE.
 12838     MOVE ZEROS                  TO ARCH-SEQ-NO.
 12839     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 12840
 12841
 12842* EXEC CICS READ UPDATE
 12843*         DATASET   (ARCH-FILE-ID)
 12844*         RIDFLD    (ARCH-KEY)
 12845*         SET       (ADDRESS OF LETTER-ARCHIVE)
 12846*    END-EXEC.
 12847*    MOVE '&"S        EU         (   #00011165' TO DFHEIV0
 12848     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12849     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12850     MOVE X'2020233030303131313635' TO DFHEIV0(25:11)
 12851     CALL 'kxdfhei1' USING DFHEIV0,
 12852           ARCH-FILE-ID,
 12853           DFHEIV20,
 12854           DFHEIV99,
 12855           ARCH-KEY,
 12856           DFHEIV99,
 12857           DFHEIV99,
 12858           DFHEIV99
 12859     SET ADDRESS OF LETTER-ARCHIVE TO
 12860         DFHEIV20
 12861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12862
 12863
 12864* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 12865* TO THIS MASTER-KEY INFORMATION.
 12866
 12867     IF LA-CARRIER  = CARRIER-CODE AND
 12868        LA-CLAIM-NO = CLAIM-NO     AND
 12869        LA-CERT-NO  = CERT-NO
 12870        NEXT SENTENCE
 12871     ELSE
 12872        GO TO 2475-UNLOCK.
 12873
 12874     IF CERTI GREATER THAN LOW-VALUES
 12875        MOVE CERTI               TO LA-CERT-PRIME.
 12876     IF SUFXI GREATER THAN LOW-VALUES
 12877        MOVE SUFXI               TO LA-CERT-SFX.
 12878     IF CERTCARI GREATER THAN LOW-VALUES
 12879        MOVE CERTCARI            TO LA-CARRIER.
 12880
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 241
* EL131.cbl
 12881
 12882* EXEC CICS REWRITE
 12883*         DATASET  (ARCH-FILE-ID)
 12884*         FROM     (LETTER-ARCHIVE)
 12885*    END-EXEC.
 12886     MOVE LENGTH OF
 12887      LETTER-ARCHIVE
 12888       TO DFHEIV11
 12889*    MOVE '&& L                  %   #00011188' TO DFHEIV0
 12890     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12891     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12892     MOVE X'2020233030303131313838' TO DFHEIV0(25:11)
 12893     CALL 'kxdfhei1' USING DFHEIV0,
 12894           ARCH-FILE-ID,
 12895           LETTER-ARCHIVE,
 12896           DFHEIV11,
 12897           DFHEIV99
 12898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12899
 12900
 12901     GO TO 2475-EXIT.
 12902
 12903 2475-UNLOCK.
 12904
 12905* EXEC CICS UNLOCK
 12906*         DATASET  (ARCH-FILE-ID)
 12907*    END-EXEC.
 12908*    MOVE '&*                    #   #00011196' TO DFHEIV0
 12909     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12910     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12911     MOVE X'2020233030303131313936' TO DFHEIV0(25:11)
 12912     CALL 'kxdfhei1' USING DFHEIV0,
 12913           ARCH-FILE-ID,
 12914           DFHEIV99
 12915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12916
 12917
 12918 2475-EXIT.
 12919     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 242
* EL131.cbl
 12921 2600-CREATE-MAINT-NOTE.
 12922     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 12923     MOVE '1'                    TO CNTL-REC-TYPE.
 12924     MOVE SPACES                 TO CNTL-PROC-ID.
 12925     MOVE ZERO                   TO CNTL-SEQ-NO.
 12926
 12927
 12928* EXEC CICS READ
 12929*         SET        (ADDRESS OF CONTROL-FILE)
 12930*         DATASET    ('ELCNTL')
 12931*         RIDFLD     (CNTL-KEY)
 12932*    END-EXEC.
 12933     MOVE 'ELCNTL' TO DFHEIV1
 12934*    MOVE '&"S        E          (   #00011209' TO DFHEIV0
 12935     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12936     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12937     MOVE X'2020233030303131323039' TO DFHEIV0(25:11)
 12938     CALL 'kxdfhei1' USING DFHEIV0,
 12939           DFHEIV1,
 12940           DFHEIV20,
 12941           DFHEIV99,
 12942           CNTL-KEY,
 12943           DFHEIV99,
 12944           DFHEIV99,
 12945           DFHEIV99
 12946     SET ADDRESS OF CONTROL-FILE TO
 12947         DFHEIV20
 12948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12949
 12950
 12951     IF CO-NO-USE-AUDIT-CHANGES
 12952         GO TO 2600-EXIT.
 12953
 12954     IF PROCL GREATER ZERO
 12955     IF PROCI NOT = LOW-VALUES
 12956     IF PROCI NOT = CL-PROCESSOR-ID
 12957         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 12958         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 12959         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12960
 12961     IF SEXL GREATER ZERO
 12962     IF SEXI NOT = LOW-VALUES
 12963     IF SEXI NOT = CL-INSURED-SEX-CD
 12964         MOVE 'SEX'                TO SPLIT-INFO-DESC
 12965         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 12966         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12967
 12968     IF BIRTHL GREATER ZERO
 12969     IF HOLD-BIRTH NOT = LOW-VALUES
 12970     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 12971         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 12972         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 12973         MOVE SPACES               TO DC-OPTION-CODE
 12974         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12975         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12976         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12977
 12978     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 243
* EL131.cbl
 12979     IF SOCIALI NOT = LOW-VALUES
 12980     IF SOCIALI NOT = CL-SOC-SEC-NO
 12981         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 12982         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 12983         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12984
 12985     IF OCCL GREATER ZERO
 12986     IF OCCI NOT = LOW-VALUES
 12987     IF OCCI NOT = CL-INSURED-OCC-CD
 12988         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 12989         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 12990         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12991
 12992     IF BENEL GREATER ZERO
 12993     IF BENEI NOT = LOW-VALUES
 12994     IF BENEI NOT = CL-BENEFICIARY
 12995         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 12996         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 12997         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12998
 12999     IF PREMTYPL GREATER ZERO
 13000     IF PREMTYPI NOT = LOW-VALUES
 13001     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 13002         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 13003         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 13004         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13005
 13006*    IF CAUSEL GREATER ZERO
 13007*    IF CAUSEI NOT = LOW-VALUES
 13008*    IF CAUSEI NOT = CL-CAUSE-CD
 13009*        MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 13010*        MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 13011*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13012
 13013*    IF ENDL GREATER ZERO
 13014*    IF HOLD-END NOT = LOW-VALUES
 13015*    IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 13016*        MOVE 'END DT'             TO SPLIT-INFO-DESC
 13017*        MOVE CL-EST-END-OF-DISAB-DT
 13018*                                  TO DC-BIN-DATE-1
 13019*        MOVE SPACES               TO DC-OPTION-CODE
 13020*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13021*        MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13022*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13023
 13024     IF PDTHRUL GREATER ZERO
 13025     IF HOLD-PDTHRU NOT = LOW-VALUES
 13026     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 13027         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 13028         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 13029         MOVE SPACES               TO DC-OPTION-CODE
 13030         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13031         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13032         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13033
 13034     IF PDAMTL GREATER ZERO
 13035     IF HOLD-PDAMT NOT = ZEROS
 13036     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 244
* EL131.cbl
 13037         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 13038         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 13039         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 13040         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13041
 13042     IF NODAYSL GREATER ZERO
 13043     IF HOLD-NODAYS NOT = ZEROS
 13044     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 13045         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 13046         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 13047         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13048         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13049
 13050     IF NOPMTSL GREATER ZERO
 13051     IF HOLD-NOPMTS NOT = ZEROS
 13052     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 13053         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 13054         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 13055         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13056         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13057
 13058     IF FORMTYPL GREATER ZERO
 13059     IF FORMTYPI NOT = LOW-VALUES
 13060     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 13061         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 13062         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 13063         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13064
 13065     IF REPL GREATER ZERO
 13066     IF HOLD-REPORTED NOT = LOW-VALUES
 13067     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 13068         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 13069         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 13070         MOVE SPACES               TO DC-OPTION-CODE
 13071         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13072         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13073         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13074
 13075     IF ADDONDTL GREATER ZERO
 13076     IF HOLD-ADDON NOT = LOW-VALUES
 13077     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 13078         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 13079         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 13080         MOVE SPACES               TO DC-OPTION-CODE
 13081         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13082         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13083         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13084
 13085     IF PRICDL GREATER ZERO
 13086     IF PRICDI NOT = LOW-VALUES
 13087     IF PRICDI NOT = CL-PRIORITY-CD
 13088         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 13089         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 13090         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13091
 13092     IF FILETOL GREATER ZERO
 13093     IF FILETOI NOT = LOW-VALUES
 13094     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 245
* EL131.cbl
 13095         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 13096         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 13097         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13098
 13099     IF SUPVL GREATER ZERO
 13100     IF SUPVI NOT = LOW-VALUES
 13101     IF SUPVI NOT = CL-SUPV-ATTN-CD
 13102         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 13103         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 13104         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13105*    IF (CRITPTL > ZERO)
 13106*       AND (CRITPTI NOT = LOW-VALUES)
 13107*       AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 13108*       MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 13109*       MOVE CL-CRIT-PER-RECURRENT
 13110*                                TO SPLIT-INFO-OLD
 13111*       PERFORM 2650-WRITE-MAINT-NOTE
 13112*                                THRU 2650-EXIT
 13113*    END-IF
 13114
 13115*    IF (RTWMOSL > ZERO)
 13116*       AND (RTWMOSI NOT = LOW-VALUES)
 13117*       AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 13118*       MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 13119*       MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 13120*       PERFORM 2650-WRITE-MAINT-NOTE
 13121*                                THRU 2650-EXIT
 13122*    END-IF
 13123     IF MLNAMEL GREATER ZERO
 13124     IF MLNAMEI NOT = LOW-VALUES
 13125     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 13126         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 13127         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 13128         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13129
 13130     IF MFNAMEL GREATER ZERO
 13131     IF MFNAMEI NOT = LOW-VALUES
 13132     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 13133         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 13134         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 13135         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13136
 13137     IF MMINITL GREATER ZERO
 13138     IF MMINITI NOT = LOW-VALUES
 13139     IF MMINITI NOT = CL-INSURED-MID-INIT
 13140         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 13141         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 13142         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13143
 13144     IF CERTEFFL GREATER ZERO
 13145     IF HOLD-EFF NOT = LOW-VALUES
 13146     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 13147         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 13148         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 13149         MOVE SPACES               TO DC-OPTION-CODE
 13150         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13151         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13152         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 246
* EL131.cbl
 13153
 13154     IF CERTACTL GREATER ZERO
 13155     IF CERTACTI NOT = LOW-VALUES
 13156     IF CERTACTI NOT = CL-CERT-ACCOUNT
 13157         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 13158         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 13159         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13160
 13161     IF CERTSTL GREATER ZERO
 13162     IF CERTSTI NOT = LOW-VALUES
 13163     IF CERTSTI NOT = CL-CERT-STATE
 13164         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 13165         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 13166         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13167
 13168     IF CERTCARL GREATER ZERO
 13169     IF CERTCARI NOT = LOW-VALUES
 13170     IF CERTCARI NOT = CL-CERT-CARRIER
 13171         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 13172         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 13173         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13174
 13175     IF CERTGRPL GREATER ZERO
 13176     IF CERTGRPI NOT = LOW-VALUES
 13177     IF CERTGRPI NOT = CL-CERT-GROUPING
 13178         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 13179         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 13180         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13181
 13182     IF CERTL GREATER ZERO OR
 13183        SUFXL GREATER ZERO
 13184     IF (CERTI NOT = LOW-VALUES AND
 13185                     CL-CERT-PRIME)
 13186                OR
 13187        (SUFXI NOT = LOW-VALUES AND
 13188                     CL-CERT-SFX)
 13189         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 13190         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 13191         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13192     IF incl > zeros
 13193        IF (HOLD-INCUR NOT = LOW-VALUES)
 13194           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13195           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 13196           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 13197           MOVE SPACES           TO DC-OPTION-CODE
 13198           PERFORM 9800-CONVERT-DATE
 13199                                 THRU 9800-EXIT
 13200           MOVE DC-GREG-DATE-1-EDIT
 13201                                 TO SPLIT-INFO-OLD
 13202           PERFORM 2650-WRITE-MAINT-NOTE
 13203                                 THRU 2650-EXIT
 13204        END-IF
 13205     END-IF
 13206     .
 13207 2600-EXIT.
 13208      EXIT.
 13209
 13210 2650-WRITE-MAINT-NOTE.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 247
* EL131.cbl
 13211
 13212* EXEC CICS GETMAIN
 13213*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13214*         LENGTH   (TRLR-LENGTH)
 13215*         INITIMG  (GETMAIN-SPACE)
 13216*    END-EXEC.
 13217*    MOVE ',"IL                  $   #00011475' TO DFHEIV0
 13218     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13219     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13220     MOVE X'2020233030303131343735' TO DFHEIV0(25:11)
 13221     CALL 'kxdfhei1' USING DFHEIV0,
 13222           DFHEIV20,
 13223           TRLR-LENGTH,
 13224           GETMAIN-SPACE
 13225     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13226         DFHEIV20
 13227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13228
 13229
 13230
 13231* EXEC CICS HANDLE CONDITION
 13232*         DUPREC   (2650-EXIT)
 13233*    END-EXEC.
 13234*    MOVE '"$%                   ! ; #00011481' TO DFHEIV0
 13235     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 13236     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13237     MOVE X'3B20233030303131343831' TO DFHEIV0(25:11)
 13238     CALL 'kxdfhei1' USING DFHEIV0
 13239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13240
 13241
 13242     MOVE SPACES             TO ACTIVITY-TRAILERS.
 13243
 13244     IF CERTL GREATER ZERO
 13245         MOVE CERTI          TO CL-CERT-PRIME.
 13246
 13247     IF SUFXL GREATER ZERO
 13248         MOVE SUFXI          TO CL-CERT-SFX.
 13249
 13250     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 13251
 13252     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 13253     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 13254
 13255     MOVE 'AT'               TO AT-RECORD-ID.
 13256
 13257     MOVE '6'                TO AT-TRAILER-TYPE.
 13258     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 13259                                AT-GEN-INFO-LAST-MAINT-DT.
 13260     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 13261                                AT-GEN-INFO-LAST-UPDATED-BY.
 13262     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 13263     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 13264     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 13265
 13266
 13267* EXEC CICS WRITE
 13268*         DATASET  (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 248
* EL131.cbl
 13269*         RIDFLD   (AT-CONTROL-PRIMARY)
 13270*         FROM     (ACTIVITY-TRAILERS)
 13271*    END-EXEC.
 13272     MOVE LENGTH OF
 13273      ACTIVITY-TRAILERS
 13274       TO DFHEIV11
 13275*    MOVE '&$ L                  ''   #00011509' TO DFHEIV0
 13276     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13277     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13278     MOVE X'2020233030303131353039' TO DFHEIV0(25:11)
 13279     CALL 'kxdfhei1' USING DFHEIV0,
 13280           TRLR-FILE-ID,
 13281           ACTIVITY-TRAILERS,
 13282           DFHEIV11,
 13283           AT-CONTROL-PRIMARY,
 13284           DFHEIV99,
 13285           DFHEIV99
 13286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13287
 13288
 13289 2650-EXIT.
 13290      EXIT.
 13291
 13292 2800-CHECK-AUTO-PAY.
 13293
 13294     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 13295     MOVE PI-CARRIER         TO TRLR-CARRIER.
 13296     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 13297     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 13298     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 13299
 13300
 13301* EXEC CICS HANDLE CONDITION
 13302*         NOTFND    (2800-EXIT)
 13303*         ENDFILE   (2800-EXIT)
 13304*    END-EXEC.
 13305*    MOVE '"$I''                  ! < #00011526' TO DFHEIV0
 13306     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13307     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13308     MOVE X'3C20233030303131353236' TO DFHEIV0(25:11)
 13309     CALL 'kxdfhei1' USING DFHEIV0
 13310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13311
 13312
 13313
 13314* EXEC CICS READ
 13315*        DATASET (TRLR-FILE-ID)
 13316*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 13317*        RIDFLD  (TRLR-KEY)
 13318*    END-EXEC.
 13319*    MOVE '&"S        E          (   #00011531' TO DFHEIV0
 13320     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13321     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13322     MOVE X'2020233030303131353331' TO DFHEIV0(25:11)
 13323     CALL 'kxdfhei1' USING DFHEIV0,
 13324           TRLR-FILE-ID,
 13325           DFHEIV20,
 13326           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 249
* EL131.cbl
 13327           TRLR-KEY,
 13328           DFHEIV99,
 13329           DFHEIV99,
 13330           DFHEIV99
 13331     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13332         DFHEIV20
 13333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13334
 13335
 13336     IF BENEFICIARY-PAID-AUTO
 13337         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 13338     END-IF.
 13339
 13340 2800-EXIT.
 13341      EXIT.
 13342
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 250
* EL131.cbl
 13344 3000-DELETE-CLAIM.
 13345     IF  NOT MODIFY-CAP
 13346         MOVE ER-0070            TO EMI-ERROR
 13347         MOVE -1                 TO MAINTL
 13348         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13349         GO TO 8110-SEND-DATA.
 13350
 13351
 13352* EXEC CICS READ
 13353*         SET      (ADDRESS OF CLAIM-MASTER)
 13354*         DATASET  (CLMS-FILE-ID)
 13355*         RIDFLD   (MSTR-KEY)
 13356*    END-EXEC.
 13357*    MOVE '&"S        E          (   #00011552' TO DFHEIV0
 13358     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13359     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13360     MOVE X'2020233030303131353532' TO DFHEIV0(25:11)
 13361     CALL 'kxdfhei1' USING DFHEIV0,
 13362           CLMS-FILE-ID,
 13363           DFHEIV20,
 13364           DFHEIV99,
 13365           MSTR-KEY,
 13366           DFHEIV99,
 13367           DFHEIV99,
 13368           DFHEIV99
 13369     SET ADDRESS OF CLAIM-MASTER TO
 13370         DFHEIV20
 13371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13372
 13373
 13374     IF CL-1ST-TRL-AVAIL
 13375         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 13376     ELSE
 13377        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 13378        MOVE 0                   TO TRLR-SEQ-NO
 13379
 13380* EXEC CICS STARTBR
 13381*            DATASET (TRLR-FILE-ID)
 13382*            RIDFLD  (TRLR-KEY)
 13383*        END-EXEC
 13384     MOVE 0
 13385       TO DFHEIV11
 13386*    MOVE '&,         G          &   #00011563' TO DFHEIV0
 13387     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13388     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13389     MOVE X'2020233030303131353633' TO DFHEIV0(25:11)
 13390     CALL 'kxdfhei1' USING DFHEIV0,
 13391           TRLR-FILE-ID,
 13392           TRLR-KEY,
 13393           DFHEIV99,
 13394           DFHEIV11,
 13395           DFHEIV99
 13396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13397         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 13398
 13399* EXEC CICS ENDBR
 13400*            DATASET (TRLR-FILE-ID)
 13401*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 251
* EL131.cbl
 13402     MOVE 0
 13403       TO DFHEIV11
 13404*    MOVE '&2                    $   #00011568' TO DFHEIV0
 13405     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13406     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13407     MOVE X'2020233030303131353638' TO DFHEIV0(25:11)
 13408     CALL 'kxdfhei1' USING DFHEIV0,
 13409           TRLR-FILE-ID,
 13410           DFHEIV11,
 13411           DFHEIV99
 13412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13413        IF SCREEN-ERROR
 13414            MOVE ER-0208         TO EMI-ERROR
 13415            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13416            MOVE -1              TO MAINTL
 13417            GO TO 8110-SEND-DATA
 13418        ELSE
 13419            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 13420
 13421     IF SCREEN-ERROR
 13422         MOVE -1                 TO MAINTL
 13423         GO TO 8110-SEND-DATA.
 13424
 13425     MOVE -1                     TO ONE-OR-MIN1.
 13426     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 13427
 13428     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 13429         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 13430                                    WS-SAVE-CLAIM-KEY
 13431         MOVE +1                 TO ONE-OR-MIN1
 13432         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 13433
 13434     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 13435
 13436     MOVE LOW-VALUES             TO EL131AO.
 13437     MOVE ER-0000                TO EMI-ERROR.
 13438     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13439     MOVE 'X'                    TO PI-RETURN-CD-1.
 13440     MOVE -1                     TO MAINTL.
 13441     GO TO 8100-SEND-MAP.
 13442
 13443 3010-DEL-MSTR-TRLR.
 13444
 13445* EXEC CICS READ UPDATE
 13446*         SET       (ADDRESS OF CLAIM-MASTER)
 13447*         DATASET   (CLMS-FILE-ID)
 13448*         RIDFLD    (MSTR-KEY)
 13449*    END-EXEC.
 13450*    MOVE '&"S        EU         (   #00011602' TO DFHEIV0
 13451     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13452     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13453     MOVE X'2020233030303131363032' TO DFHEIV0(25:11)
 13454     CALL 'kxdfhei1' USING DFHEIV0,
 13455           CLMS-FILE-ID,
 13456           DFHEIV20,
 13457           DFHEIV99,
 13458           MSTR-KEY,
 13459           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 252
* EL131.cbl
 13460           DFHEIV99,
 13461           DFHEIV99
 13462     SET ADDRESS OF CLAIM-MASTER TO
 13463         DFHEIV20
 13464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13465
 13466
 13467     if (cl-priority-cd = '8')
 13468        and (pi-processor-id not = 'PEMA' and 'JMS '
 13469             AND 'AMWA')
 13470        MOVE ER-8003             TO EMI-ERROR
 13471        PERFORM 9900-ERROR-FORMAT
 13472                                 THRU 9900-EXIT
 13473        MOVE -1                  TO MAINTL
 13474        GO TO 8110-SEND-DATA
 13475     end-if
 13476
 13477     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 13478     MOVE ZERO                   TO TRLR-SEQ-NO.
 13479
 13480
 13481* EXEC CICS HANDLE CONDITION
 13482*         NOTFND    (3010-DEL-ACTQ)
 13483*         ENDFILE   (3040-EXIT)
 13484*    END-EXEC.
 13485*    MOVE '"$I''                  ! = #00011621' TO DFHEIV0
 13486     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13487     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13488     MOVE X'3D20233030303131363231' TO DFHEIV0(25:11)
 13489     CALL 'kxdfhei1' USING DFHEIV0
 13490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13491
 13492
 13493     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 13494
 13495 3010-DEL-ACTQ.
 13496
 13497
 13498* EXEC CICS HANDLE CONDITION
 13499*         NOTFND    (3010-NO-ACTIVITY)
 13500*         ENDFILE   (3050-EXIT)
 13501*    END-EXEC.
 13502*    MOVE '"$I''                  ! > #00011630' TO DFHEIV0
 13503     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13504     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13505     MOVE X'3E20233030303131363330' TO DFHEIV0(25:11)
 13506     CALL 'kxdfhei1' USING DFHEIV0
 13507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13508
 13509
 13510
 13511* EXEC CICS STARTBR
 13512*         DATASET  (ACTQ-FILE-ID)
 13513*         RIDFLD   (ACTQ-KEY)
 13514*    END-EXEC.
 13515     MOVE 0
 13516       TO DFHEIV11
 13517*    MOVE '&,         G          &   #00011635' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 253
* EL131.cbl
 13518     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13519     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13520     MOVE X'2020233030303131363335' TO DFHEIV0(25:11)
 13521     CALL 'kxdfhei1' USING DFHEIV0,
 13522           ACTQ-FILE-ID,
 13523           ACTQ-KEY,
 13524           DFHEIV99,
 13525           DFHEIV11,
 13526           DFHEIV99
 13527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13528
 13529
 13530
 13531* EXEC CICS GETMAIN
 13532*         SET      (ADDRESS OF ACTIVITY-QUE)
 13533*         LENGTH   (ACTQ-LENGTH)
 13534*         INITIMG  (GETMAIN-SPACE)
 13535*    END-EXEC.
 13536*    MOVE ',"IL                  $   #00011640' TO DFHEIV0
 13537     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13538     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13539     MOVE X'2020233030303131363430' TO DFHEIV0(25:11)
 13540     CALL 'kxdfhei1' USING DFHEIV0,
 13541           DFHEIV20,
 13542           ACTQ-LENGTH,
 13543           GETMAIN-SPACE
 13544     SET ADDRESS OF ACTIVITY-QUE TO
 13545         DFHEIV20
 13546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13547
 13548
 13549     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 13550
 13551
 13552* EXEC CICS ENDBR
 13553*         DATASET (ACTQ-FILE-ID)
 13554*    END-EXEC.
 13555     MOVE 0
 13556       TO DFHEIV11
 13557*    MOVE '&2                    $   #00011648' TO DFHEIV0
 13558     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13559     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13560     MOVE X'2020233030303131363438' TO DFHEIV0(25:11)
 13561     CALL 'kxdfhei1' USING DFHEIV0,
 13562           ACTQ-FILE-ID,
 13563           DFHEIV11,
 13564           DFHEIV99
 13565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13566
 13567
 13568 3010-NO-ACTIVITY.
 13569
 13570
 13571* EXEC CICS HANDLE CONDITION
 13572*        NOTFND   (3010-CERT-NOT-FOUND)
 13573*    END-EXEC.
 13574*    MOVE '"$I                   ! ? #00011654' TO DFHEIV0
 13575     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 254
* EL131.cbl
 13576     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13577     MOVE X'3F20233030303131363534' TO DFHEIV0(25:11)
 13578     CALL 'kxdfhei1' USING DFHEIV0
 13579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13580
 13581
 13582     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 13583     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 13584     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 13585     MOVE CL-CERT-STATE          TO CERT-STATE.
 13586     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 13587     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 13588     MOVE CL-CERT-NO             TO CERT-CERT.
 13589
 13590
 13591* EXEC CICS READ
 13592*        DATASET   (CERT-FILE-ID)
 13593*        RIDFLD    (CERT-KEY)
 13594*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 13595*    END-EXEC.
 13596*    MOVE '&"S        E          (   #00011666' TO DFHEIV0
 13597     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13598     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13599     MOVE X'2020233030303131363636' TO DFHEIV0(25:11)
 13600     CALL 'kxdfhei1' USING DFHEIV0,
 13601           CERT-FILE-ID,
 13602           DFHEIV20,
 13603           DFHEIV99,
 13604           CERT-KEY,
 13605           DFHEIV99,
 13606           DFHEIV99,
 13607           DFHEIV99
 13608     SET ADDRESS OF CERTIFICATE-MASTER TO
 13609         DFHEIV20
 13610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13611
 13612
 13613     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 13614       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 13615         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 13616     ELSE
 13617         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 13618
 13619 3010-UPDATE-CERT-TRLR.
 13620
 13621     MOVE CERT-KEY               TO ELCRTT-KEY
 13622     MOVE 'B'                    TO CTRLR-REC-TYPE
 13623
 13624* EXEC CICS READ
 13625*       UPDATE
 13626*       DATASET   ('ELCRTT')
 13627*       RIDFLD    (ELCRTT-KEY)
 13628*       INTO      (CERTIFICATE-TRAILERS)
 13629*       RESP      (WS-RESPONSE)
 13630*    END-EXEC
 13631     MOVE LENGTH OF
 13632      CERTIFICATE-TRAILERS
 13633       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 255
* EL131.cbl
 13634     MOVE 'ELCRTT' TO DFHEIV1
 13635*    MOVE '&"IL       EU         (  N#00011682' TO DFHEIV0
 13636     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13637     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13638     MOVE X'204E233030303131363832' TO DFHEIV0(25:11)
 13639     CALL 'kxdfhei1' USING DFHEIV0,
 13640           DFHEIV1,
 13641           CERTIFICATE-TRAILERS,
 13642           DFHEIV11,
 13643           ELCRTT-KEY,
 13644           DFHEIV99,
 13645           DFHEIV99,
 13646           DFHEIV99
 13647     MOVE EIBRESP  TO WS-RESPONSE
 13648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13649     IF WS-RESP-NORMAL
 13650        perform varying s1 from +1 by +1 until
 13651           (s1 > +24)
 13652           or (cs-claim-no (s1) = cl-claim-no)
 13653        end-perform
 13654        if s1 < +25
 13655           move spaces           to cs-claim-no (s1)
 13656                                    cs-claim-type (s1)
 13657                                    cs-insured-type (s1)
 13658           move zeros            to cs-days-paid (s1)
 13659                                    cs-total-paid (s1)
 13660                                    cs-benefit-period (s1)
 13661           if s1 not = +24
 13662              compute s2 = s1 + +1
 13663              perform 3015-bump  thru 3015-exit
 13664           end-if
 13665
 13666* EXEC CICS REWRITE
 13667*             DATASET   ('ELCRTT')
 13668*             FROM      (CERTIFICATE-TRAILERS)
 13669*          END-EXEC
 13670     MOVE LENGTH OF
 13671      CERTIFICATE-TRAILERS
 13672       TO DFHEIV11
 13673     MOVE 'ELCRTT' TO DFHEIV1
 13674*    MOVE '&& L                  %   #00011705' TO DFHEIV0
 13675     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13676     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13677     MOVE X'2020233030303131373035' TO DFHEIV0(25:11)
 13678     CALL 'kxdfhei1' USING DFHEIV0,
 13679           DFHEIV1,
 13680           CERTIFICATE-TRAILERS,
 13681           DFHEIV11,
 13682           DFHEIV99
 13683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13684        end-if
 13685     end-if
 13686     .
 13687 3010-CERT-NOT-FOUND.
 13688
 13689
 13690* EXEC CICS DELETE
 13691*        DATASET  (CLMS-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 256
* EL131.cbl
 13692*    END-EXEC.
 13693*    MOVE '&(                    &   #00011714' TO DFHEIV0
 13694     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13695     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13696     MOVE X'2020233030303131373134' TO DFHEIV0(25:11)
 13697     CALL 'kxdfhei1' USING DFHEIV0,
 13698           CLMS-FILE-ID,
 13699           DFHEIV99,
 13700           DFHEIV99,
 13701           DFHEIV99,
 13702           DFHEIV99
 13703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13704
 13705
 13706 3010-EXIT.
 13707      EXIT.
 13708
 13709 3015-bump.
 13710     perform varying s2 from s2 by +1 until s2 > +24
 13711        move cs-mb-claim-data (s2)
 13712                                 to cs-mb-claim-data (s1)
 13713        move spaces              to cs-mb-claim-data (s2)
 13714        add +1 to s1
 13715     end-perform
 13716     .
 13717 3015-exit.
 13718     exit.
 13719 3020-UPDATE-CERT.
 13720
 13721* EXEC CICS READ UPDATE
 13722*         DATASET  (CERT-FILE-ID)
 13723*         RIDFLD   (CERT-KEY)
 13724*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13725*    END-EXEC.
 13726*    MOVE '&"S        EU         (   #00011732' TO DFHEIV0
 13727     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13728     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13729     MOVE X'2020233030303131373332' TO DFHEIV0(25:11)
 13730     CALL 'kxdfhei1' USING DFHEIV0,
 13731           CERT-FILE-ID,
 13732           DFHEIV20,
 13733           DFHEIV99,
 13734           CERT-KEY,
 13735           DFHEIV99,
 13736           DFHEIV99,
 13737           DFHEIV99
 13738     SET ADDRESS OF CERTIFICATE-MASTER TO
 13739         DFHEIV20
 13740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13741
 13742
 13743     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 13744
 13745
 13746* EXEC CICS HANDLE CONDITION
 13747*         DUPKEY   (3020-EXIT)
 13748*    END-EXEC.
 13749*    MOVE '"$$                   ! @ #00011740' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 257
* EL131.cbl
 13750     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 13751     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13752     MOVE X'4020233030303131373430' TO DFHEIV0(25:11)
 13753     CALL 'kxdfhei1' USING DFHEIV0
 13754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13755
 13756
 13757
 13758* EXEC CICS REWRITE
 13759*         DATASET  (CERT-FILE-ID)
 13760*         FROM     (CERTIFICATE-MASTER)
 13761*    END-EXEC.
 13762     MOVE LENGTH OF
 13763      CERTIFICATE-MASTER
 13764       TO DFHEIV11
 13765*    MOVE '&& L                  %   #00011744' TO DFHEIV0
 13766     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13767     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13768     MOVE X'2020233030303131373434' TO DFHEIV0(25:11)
 13769     CALL 'kxdfhei1' USING DFHEIV0,
 13770           CERT-FILE-ID,
 13771           CERTIFICATE-MASTER,
 13772           DFHEIV11,
 13773           DFHEIV99
 13774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13775
 13776
 13777 3020-EXIT.
 13778     EXIT.
 13779
 13780 3030-DELETE-CERT.
 13781
 13782* EXEC CICS READ UPDATE
 13783*         DATASET  (CERT-FILE-ID)
 13784*         RIDFLD   (CERT-KEY)
 13785*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13786*    END-EXEC.
 13787*    MOVE '&"S        EU         (   #00011753' TO DFHEIV0
 13788     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13789     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13790     MOVE X'2020233030303131373533' TO DFHEIV0(25:11)
 13791     CALL 'kxdfhei1' USING DFHEIV0,
 13792           CERT-FILE-ID,
 13793           DFHEIV20,
 13794           DFHEIV99,
 13795           CERT-KEY,
 13796           DFHEIV99,
 13797           DFHEIV99,
 13798           DFHEIV99
 13799     SET ADDRESS OF CERTIFICATE-MASTER TO
 13800         DFHEIV20
 13801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13802
 13803
 13804
 13805* EXEC CICS DELETE
 13806*         DATASET   (CERT-FILE-ID)
 13807*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 258
* EL131.cbl
 13808*    MOVE '&(                    &   #00011759' TO DFHEIV0
 13809     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13810     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13811     MOVE X'2020233030303131373539' TO DFHEIV0(25:11)
 13812     CALL 'kxdfhei1' USING DFHEIV0,
 13813           CERT-FILE-ID,
 13814           DFHEIV99,
 13815           DFHEIV99,
 13816           DFHEIV99,
 13817           DFHEIV99
 13818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13819
 13820
 13821 3030-EXIT.
 13822     EXIT.
 13823
 13824 3040-DELETE-TRLR.
 13825
 13826* EXEC CICS READ
 13827*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13828*         DATASET  (TRLR-FILE-ID)
 13829*         RIDFLD   (TRLR-KEY)
 13830*         GTEQ
 13831*    END-EXEC.
 13832*    MOVE '&"S        G          (   #00011767' TO DFHEIV0
 13833     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13834     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13835     MOVE X'2020233030303131373637' TO DFHEIV0(25:11)
 13836     CALL 'kxdfhei1' USING DFHEIV0,
 13837           TRLR-FILE-ID,
 13838           DFHEIV20,
 13839           DFHEIV99,
 13840           TRLR-KEY,
 13841           DFHEIV99,
 13842           DFHEIV99,
 13843           DFHEIV99
 13844     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13845         DFHEIV20
 13846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13847
 13848
 13849     IF PI-COMPANY-CD = AT-COMPANY-CD
 13850        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 13851        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13852           GO TO 3040-EXIT
 13853        ELSE
 13854           NEXT SENTENCE
 13855     ELSE
 13856        GO TO 3040-EXIT.
 13857
 13858
 13859* EXEC CICS DELETE
 13860*         DATASET  (TRLR-FILE-ID)
 13861*         RIDFLD   (TRLR-KEY)
 13862*    END-EXEC.
 13863*    MOVE '&(  R                 &   #00011783' TO DFHEIV0
 13864     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13865     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 259
* EL131.cbl
 13866     MOVE X'2020233030303131373833' TO DFHEIV0(25:11)
 13867     CALL 'kxdfhei1' USING DFHEIV0,
 13868           TRLR-FILE-ID,
 13869           TRLR-KEY,
 13870           DFHEIV99,
 13871           DFHEIV99,
 13872           DFHEIV99
 13873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13874
 13875
 13876     GO TO 3040-DELETE-TRLR.
 13877
 13878 3040-EXIT.
 13879     EXIT.
 13880
 13881 3050-DELETE-ACTQ.
 13882
 13883* EXEC CICS READNEXT
 13884*         DATASET  (ACTQ-FILE-ID)
 13885*         RIDFLD   (ACTQ-KEY)
 13886*         INTO     (ACTIVITY-QUE)
 13887*    END-EXEC.
 13888     MOVE LENGTH OF
 13889      ACTIVITY-QUE
 13890       TO DFHEIV12
 13891     MOVE 0
 13892       TO DFHEIV11
 13893*    MOVE '&.IL                  )   #00011794' TO DFHEIV0
 13894     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13895     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13896     MOVE X'2020233030303131373934' TO DFHEIV0(25:11)
 13897     CALL 'kxdfhei1' USING DFHEIV0,
 13898           ACTQ-FILE-ID,
 13899           ACTIVITY-QUE,
 13900           DFHEIV12,
 13901           ACTQ-KEY,
 13902           DFHEIV99,
 13903           DFHEIV11,
 13904           DFHEIV99,
 13905           DFHEIV99
 13906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13907
 13908
 13909     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 13910         GO TO 3050-EXIT.
 13911
 13912
 13913* EXEC CICS ENDBR
 13914*         DATASET  (ACTQ-FILE-ID)
 13915*    END-EXEC.
 13916     MOVE 0
 13917       TO DFHEIV11
 13918*    MOVE '&2                    $   #00011803' TO DFHEIV0
 13919     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13920     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13921     MOVE X'2020233030303131383033' TO DFHEIV0(25:11)
 13922     CALL 'kxdfhei1' USING DFHEIV0,
 13923           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 260
* EL131.cbl
 13924           DFHEIV11,
 13925           DFHEIV99
 13926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13927
 13928
 13929
 13930* EXEC CICS DELETE
 13931*         DATASET   (ACTQ-FILE-ID)
 13932*         RIDFLD    (ACTQ-KEY)
 13933*    END-EXEC.
 13934*    MOVE '&(  R                 &   #00011807' TO DFHEIV0
 13935     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13936     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13937     MOVE X'2020233030303131383037' TO DFHEIV0(25:11)
 13938     CALL 'kxdfhei1' USING DFHEIV0,
 13939           ACTQ-FILE-ID,
 13940           ACTQ-KEY,
 13941           DFHEIV99,
 13942           DFHEIV99,
 13943           DFHEIV99
 13944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13945
 13946
 13947
 13948* EXEC CICS STARTBR
 13949*         DATASET   (ACTQ-FILE-ID)
 13950*         RIDFLD    (ACTQ-KEY)
 13951*    END-EXEC.
 13952     MOVE 0
 13953       TO DFHEIV11
 13954*    MOVE '&,         G          &   #00011812' TO DFHEIV0
 13955     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13956     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13957     MOVE X'2020233030303131383132' TO DFHEIV0(25:11)
 13958     CALL 'kxdfhei1' USING DFHEIV0,
 13959           ACTQ-FILE-ID,
 13960           ACTQ-KEY,
 13961           DFHEIV99,
 13962           DFHEIV11,
 13963           DFHEIV99
 13964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13965
 13966
 13967     GO TO 3050-DELETE-ACTQ.
 13968
 13969 3050-EXIT.
 13970     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 261
* EL131.cbl
 13972 3060-READ-TRLR.
 13973
 13974* EXEC CICS HANDLE CONDITION
 13975*         NOTFND    (3060-EXIT)
 13976*         ENDFILE   (3060-EXIT)
 13977*    END-EXEC.
 13978*    MOVE '"$I''                  ! A #00011823' TO DFHEIV0
 13979     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13980     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13981     MOVE X'4120233030303131383233' TO DFHEIV0(25:11)
 13982     CALL 'kxdfhei1' USING DFHEIV0
 13983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13984
 13985
 13986 3060-LOOP.
 13987
 13988* EXEC CICS READNEXT
 13989*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13990*         DATASET  (TRLR-FILE-ID)
 13991*         RIDFLD   (TRLR-KEY)
 13992*    END-EXEC.
 13993     MOVE 0
 13994       TO DFHEIV11
 13995*    MOVE '&.S                   )   #00011829' TO DFHEIV0
 13996     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13997     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13998     MOVE X'2020233030303131383239' TO DFHEIV0(25:11)
 13999     CALL 'kxdfhei1' USING DFHEIV0,
 14000           TRLR-FILE-ID,
 14001           DFHEIV20,
 14002           DFHEIV99,
 14003           TRLR-KEY,
 14004           DFHEIV99,
 14005           DFHEIV11,
 14006           DFHEIV99,
 14007           DFHEIV99
 14008     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14009         DFHEIV20
 14010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14011
 14012
 14013     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14014         GO TO 3060-EXIT.
 14015
 14016     IF FORM-CONTROL-TR
 14017         IF AT-RECORDED-DT = SAVE-BIN-DATE
 14018             NEXT SENTENCE
 14019         ELSE
 14020             MOVE 'X'            TO ERROR-SWITCH
 14021             GO TO 3060-EXIT
 14022     ELSE
 14023         IF PAYMENT-TR OR CORRESPONDENCE-TR
 14024            MOVE 'X'                 TO ERROR-SWITCH
 14025            GO TO 3060-EXIT.
 14026
 14027     GO TO 3060-LOOP.
 14028
 14029 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 262
* EL131.cbl
 14030     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 263
* EL131.cbl
 14032 3997-GET-ERPDEF.
 14033
 14034     move cl-company-cd          to cert-company-code
 14035     move cl-cert-key-data       to cert-key (2:21)
 14036     move cl-cert-no             to cert-cert
 14037
 14038
 14039* EXEC CICS READ
 14040*        DATASET   (CERT-FILE-ID)
 14041*        RIDFLD    (CERT-KEY)
 14042*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 14043*        resp      (ws-response)
 14044*    END-EXEC
 14045*    MOVE '&"S        E          (  N#00011860' TO DFHEIV0
 14046     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14047     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14048     MOVE X'204E233030303131383630' TO DFHEIV0(25:11)
 14049     CALL 'kxdfhei1' USING DFHEIV0,
 14050           CERT-FILE-ID,
 14051           DFHEIV20,
 14052           DFHEIV99,
 14053           CERT-KEY,
 14054           DFHEIV99,
 14055           DFHEIV99,
 14056           DFHEIV99
 14057     SET ADDRESS OF CERTIFICATE-MASTER TO
 14058         DFHEIV20
 14059     MOVE EIBRESP  TO ws-response
 14060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14061
 14062     MOVE SPACES                 TO WS-CRIT-PER-ALPHA
 14063                                    WS-ERPDEF-SW
 14064     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 14065                                    WS-CRIT-PER-RTW-MOS
 14066
 14067     if cm-clp-state = spaces or low-values or zeros
 14068        move cm-state            to cm-clp-state
 14069     end-if
 14070     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 14071     MOVE CM-clp-state           TO ERPDEF-STATE
 14072     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 14073     evaluate true
 14074        when (cl-claim-type = 'L' or 'P')
 14075           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14076             and 'CU')
 14077           move 'L'              to erpdef-ben-type
 14078           move cm-lf-benefit-cd to erpdef-ben-code
 14079        when (cl-claim-type not = 'L' and 'P')
 14080           and (cm-ah-benefit-cd not = '00' and '  ')
 14081           move 'A'              to erpdef-ben-type
 14082           move cm-ah-benefit-cd to erpdef-ben-code
 14083        when (cl-claim-type not = 'L' and 'P')
 14084           and (cm-ah-benefit-cd = '00' or '  ')
 14085           move 'L'              to erpdef-ben-type
 14086           move cm-lf-benefit-cd to erpdef-ben-code
 14087        when (cl-claim-type = 'L' or 'P')
 14088           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 14089           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 264
* EL131.cbl
 14090           move cm-ah-benefit-cd to erpdef-ben-code
 14091        when other
 14092           move 'A'              to erpdef-ben-type
 14093           move cm-ah-benefit-cd to erpdef-ben-code
 14094     end-evaluate
 14095
 14096*    if (cl-claim-type = 'L' or 'P')
 14097*       and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14098*          and 'CU')
 14099*       move 'L'                 to erpdef-ben-type
 14100*       move cm-lf-benefit-cd    to erpdef-ben-code
 14101*    else
 14102*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
 14103*       MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 14104*    end-if
 14105     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 14106     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 14107
 14108
 14109* EXEC CICS STARTBR
 14110*        DATASET  ('ERPDEF')
 14111*        RIDFLD   (ERPDEF-KEY)
 14112*        GTEQ
 14113*        RESP     (WS-RESPONSE)
 14114*    END-EXEC
 14115     MOVE 'ERPDEF' TO DFHEIV1
 14116     MOVE 0
 14117       TO DFHEIV11
 14118*    MOVE '&,         G          &  N#00011913' TO DFHEIV0
 14119     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14120     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14121     MOVE X'204E233030303131393133' TO DFHEIV0(25:11)
 14122     CALL 'kxdfhei1' USING DFHEIV0,
 14123           DFHEIV1,
 14124           ERPDEF-KEY,
 14125           DFHEIV99,
 14126           DFHEIV11,
 14127           DFHEIV99
 14128     MOVE EIBRESP  TO WS-RESPONSE
 14129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14130
 14131     IF WS-RESP-NORMAL
 14132
 14133* EXEC CICS READNEXT
 14134*          DATASET  ('ERPDEF')
 14135*          INTO     (PRODUCT-MASTER)
 14136*          RIDFLD   (ERPDEF-KEY)
 14137*          RESP     (WS-RESPONSE)
 14138*       END-EXEC
 14139     MOVE LENGTH OF
 14140      PRODUCT-MASTER
 14141       TO DFHEIV12
 14142     MOVE 'ERPDEF' TO DFHEIV1
 14143     MOVE 0
 14144       TO DFHEIV11
 14145*    MOVE '&.IL                  )  N#00011921' TO DFHEIV0
 14146     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14147     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 265
* EL131.cbl
 14148     MOVE X'204E233030303131393231' TO DFHEIV0(25:11)
 14149     CALL 'kxdfhei1' USING DFHEIV0,
 14150           DFHEIV1,
 14151           PRODUCT-MASTER,
 14152           DFHEIV12,
 14153           ERPDEF-KEY,
 14154           DFHEIV99,
 14155           DFHEIV11,
 14156           DFHEIV99,
 14157           DFHEIV99
 14158     MOVE EIBRESP  TO WS-RESPONSE
 14159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14160        IF WS-RESP-NORMAL
 14161           IF (ERPDEF-KEY-SAVE (1:16) =
 14162              PD-CONTROL-PRIMARY (1:16))
 14163              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 14164              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 14165                 (A1 > +8)
 14166                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 14167              END-PERFORM
 14168              IF A1 < +9
 14169                 SET ERPDEF-FOUND TO TRUE
 14170                 MOVE PD-CRIT-PERIOD (A1)
 14171                              TO WS-CRITICAL-PERIOD
 14172                 MOVE PD-REC-CRIT-PERIOD (A1)
 14173                              TO WS-CRIT-PER-RECURRENT
 14174                 IF PD-RTW-MOS (A1) NUMERIC
 14175                    MOVE PD-RTW-MOS (A1)
 14176                              TO WS-CRIT-PER-RTW-MOS
 14177                 ELSE
 14178                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 14179                 END-IF
 14180                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 14181                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 14182                                 TO WS-EXCL-PERIOD
 14183                 END-IF
 14184                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 14185                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 14186                                 TO WS-COV-ENDS
 14187                 END-IF
 14188                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 14189                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 14190                                 TO WS-ACC-PERIOD
 14191                 END-IF
 14192                 if pd-max-extension (a1) numeric
 14193                    move pd-max-extension (a1)
 14194                                 to ws-max-extension
 14195                 end-if
 14196                 if pd-max-amt (a1) numeric
 14197                    move pd-max-amt (a1)
 14198                                 to ws-max-moben
 14199                 end-if
 14200              END-IF
 14201           END-IF
 14202        END-IF
 14203     END-IF
 14204
 14205     .
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 266
* EL131.cbl
 14206 3997-EXIT.
 14207     EXIT.
 14208 4000-FORCE-ERRORS.
 14209     IF PI-RETURN-CD-1 = 'X'
 14210         MOVE ER-0311            TO EMI-ERROR
 14211         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14212         MOVE -1                 TO MAINTL
 14213         GO TO 8110-SEND-DATA.
 14214
 14215     IF NOT FORCE-CAP
 14216         MOVE ER-0416            TO EMI-ERROR
 14217         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14218         MOVE -1                 TO MAINTL
 14219         GO TO 8110-SEND-DATA.
 14220
 14221     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 14222     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 14223     IF EMI-FATAL-CTR GREATER THAN ZERO
 14224         GO TO 4000-FATAL-ERRORS.
 14225
 14226     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 14227
 14228     IF EMI-FATAL-CTR GREATER THAN ZERO
 14229         GO TO 4000-FATAL-ERRORS.
 14230
 14231     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 14232
 14233     IF EMI-FATAL-CTR GREATER THAN ZERO
 14234         GO TO 4000-FATAL-ERRORS.
 14235
 14236     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 14237     MOVE AL-UANOF               TO CERTA.
 14238     MOVE ER-0000 TO EMI-ERROR.
 14239     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14240
 14241 4000-FATAL-ERRORS.
 14242     MOVE -1                     TO MAINTL.
 14243     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 267
* EL131.cbl
 14245
 14246 4100-SAVE-CHANGES.
 14247     IF MAINTL > 0
 14248         MOVE MAINTI  TO WS-SAVE-MAINTI
 14249         MOVE MAINTL  TO WS-SAVE-MAINTL
 14250     END-IF
 14251     IF STATUSL > 0
 14252         MOVE STATUSI  TO WS-SAVE-STATUSI
 14253         MOVE STATUSL  TO WS-SAVE-STATUSL
 14254     END-IF
 14255     IF REPL > 0
 14256         MOVE REPI  TO WS-SAVE-REPI
 14257         MOVE REPL  TO WS-SAVE-REPL
 14258     END-IF
 14259*    IF CAUSEL > 0
 14260*        MOVE CAUSEI  TO WS-SAVE-CAUSEI
 14261*        MOVE CAUSEL  TO WS-SAVE-CAUSEL
 14262*    END-IF
 14263*    IF ENDL > 0
 14264*        MOVE ENDI  TO WS-SAVE-ENDI
 14265*        MOVE ENDL  TO WS-SAVE-ENDL
 14266*    END-IF
 14267     IF DIAGL > 0
 14268         MOVE DIAGI  TO WS-SAVE-DIAGI
 14269         MOVE DIAGL  TO WS-SAVE-DIAGL
 14270     END-IF
 14271     IF ICD1L > 0
 14272         MOVE ICD1I  TO WS-SAVE-ICD1I
 14273         MOVE ICD1L  TO WS-SAVE-ICD1L
 14274     END-IF
 14275     IF ICD2L > 0
 14276         MOVE ICD2I  TO WS-SAVE-ICD2I
 14277         MOVE ICD2L  TO WS-SAVE-ICD2L
 14278     END-IF
 14279     IF BENEL > 0
 14280         MOVE BENEI  TO WS-SAVE-BENEI
 14281         MOVE BENEL  TO WS-SAVE-BENEL
 14282     END-IF
 14283     IF BIRTHL > 0
 14284         MOVE BIRTHI  TO WS-SAVE-BIRTHI
 14285         MOVE BIRTHL  TO WS-SAVE-BIRTHL
 14286     END-IF
 14287     IF SOCIALL > 0
 14288         MOVE SOCIALI  TO WS-SAVE-SOCIALI
 14289         MOVE SOCIALL  TO WS-SAVE-SOCIALL
 14290     END-IF
 14291     IF SEXL > 0
 14292         MOVE SEXI  TO WS-SAVE-SEXI
 14293         MOVE SEXL  TO WS-SAVE-SEXL
 14294     END-IF
 14295     IF MLNAMEL > 0
 14296         MOVE MLNAMEI  TO WS-SAVE-MLNAMEI
 14297         MOVE MLNAMEL  TO WS-SAVE-MLNAMEL
 14298     END-IF
 14299     IF MFNAMEL > 0
 14300         MOVE MFNAMEI  TO WS-SAVE-MFNAMEI
 14301         MOVE MFNAMEL  TO WS-SAVE-MFNAMEL
 14302     END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 268
* EL131.cbl
 14303     IF MMINITL > 0
 14304         MOVE MMINITI  TO WS-SAVE-MMINITI
 14305         MOVE MMINITL  TO WS-SAVE-MMINITL
 14306     END-IF
 14307     IF LOANNOL > 0
 14308         MOVE LOANNOI  TO WS-SAVE-LOANNOI
 14309         MOVE LOANNOL  TO WS-SAVE-LOANNOL
 14310     END-IF
 14311     IF LOANBALL > 0
 14312         MOVE LOANBALI  TO WS-SAVE-LOANBALI
 14313         MOVE LOANBALL  TO WS-SAVE-LOANBALL
 14314     END-IF
 14315     IF PROCL > 0
 14316         MOVE PROCI  TO WS-SAVE-PROCI
 14317         MOVE PROCL  TO WS-SAVE-PROCL
 14318     END-IF
 14319     IF SUPVL > 0
 14320         MOVE SUPVI  TO WS-SAVE-SUPVI
 14321         MOVE SUPVL  TO WS-SAVE-SUPVL
 14322     END-IF
 14323     IF PRICDL > 0
 14324         MOVE PRICDI  TO WS-SAVE-PRICDI
 14325         MOVE PRICDL  TO WS-SAVE-PRICDL
 14326     END-IF
 14327     IF FILETOL > 0
 14328         MOVE FILETOI  TO WS-SAVE-FILETOI
 14329         MOVE FILETOL  TO WS-SAVE-FILETOL
 14330     END-IF
 14331     IF PDTHRUL > 0
 14332         MOVE PDTHRUI  TO WS-SAVE-PDTHRUI
 14333         MOVE PDTHRUL  TO WS-SAVE-PDTHRUL
 14334     END-IF
 14335     IF PDAMTL > 0
 14336         MOVE PDAMTI  TO WS-SAVE-PDAMTI
 14337         MOVE PDAMTL  TO WS-SAVE-PDAMTL
 14338     END-IF
 14339     IF NODAYSL > 0
 14340         MOVE NODAYSI  TO WS-SAVE-NODAYSI
 14341         MOVE NODAYSL  TO WS-SAVE-NODAYSL
 14342     END-IF
 14343     IF NOPMTSL > 0
 14344         MOVE NOPMTSI  TO WS-SAVE-NOPMTSI
 14345         MOVE NOPMTSL  TO WS-SAVE-NOPMTSL
 14346     END-IF
 14347     IF FORMTYPL > 0
 14348         MOVE FORMTYPI  TO WS-SAVE-FORMTYPI
 14349         MOVE FORMTYPL  TO WS-SAVE-FORMTYPL
 14350     END-IF
 14351     IF OCCL > 0
 14352         MOVE OCCI  TO WS-SAVE-OCCI
 14353         MOVE OCCL  TO WS-SAVE-OCCL
 14354     END-IF.
 14355 4100-EXIT.
 14356      EXIT.
 14357
 14358 4200-LOAD-CHANGES.
 14359     IF WS-SAVE-MAINTL > 0
 14360         MOVE WS-SAVE-MAINTI  TO MAINTI
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 269
* EL131.cbl
 14361         MOVE WS-SAVE-MAINTL  TO MAINTL
 14362         MOVE AL-UANON        TO MAINTA
 14363     END-IF
 14364     IF WS-SAVE-STATUSL > 0
 14365         MOVE WS-SAVE-STATUSI  TO STATUSI
 14366         MOVE WS-SAVE-STATUSL  TO STATUSL
 14367         MOVE AL-UANON         TO STATUSA
 14368     END-IF
 14369     IF WS-SAVE-REPL > 0
 14370         MOVE WS-SAVE-REPI  TO REPI
 14371         MOVE WS-SAVE-REPL  TO REPL
 14372         MOVE AL-UANON      TO REPA
 14373     END-IF
 14374*    IF WS-SAVE-CAUSEL > 0
 14375*        MOVE WS-SAVE-CAUSEI  TO CAUSEI
 14376*        MOVE WS-SAVE-CAUSEL  TO CAUSEL
 14377*        MOVE AL-UANON        TO CAUSEA
 14378*    END-IF
 14379*    IF WS-SAVE-ENDL > 0
 14380*        MOVE WS-SAVE-ENDI  TO ENDI
 14381*        MOVE WS-SAVE-ENDL  TO ENDL
 14382*        MOVE AL-UANON      TO ENDA
 14383*    END-IF
 14384     IF WS-SAVE-DIAGL > 0
 14385         MOVE WS-SAVE-DIAGI  TO DIAGI
 14386         MOVE WS-SAVE-DIAGL  TO DIAGL
 14387         MOVE AL-UANON       TO DIAGA
 14388     END-IF
 14389     IF WS-SAVE-ICD1L > 0
 14390         MOVE WS-SAVE-ICD1I  TO ICD1I
 14391         MOVE WS-SAVE-ICD1L  TO ICD1L
 14392         MOVE AL-UANON       TO ICD1A
 14393     END-IF
 14394     IF WS-SAVE-ICD2L > 0
 14395         MOVE WS-SAVE-ICD2I  TO ICD2I
 14396         MOVE WS-SAVE-ICD2L  TO ICD2L
 14397         MOVE AL-UANON       TO ICD2A
 14398     END-IF
 14399     IF WS-SAVE-BENEL > 0
 14400         MOVE WS-SAVE-BENEI  TO BENEI
 14401         MOVE WS-SAVE-BENEL  TO BENEL
 14402         MOVE AL-UANON       TO BENEA
 14403     END-IF
 14404     IF WS-SAVE-BIRTHL > 0
 14405         MOVE WS-SAVE-BIRTHI  TO BIRTHI
 14406         MOVE WS-SAVE-BIRTHL  TO BIRTHL
 14407         MOVE AL-UANON        TO BIRTHA
 14408     END-IF
 14409     IF WS-SAVE-SOCIALL > 0
 14410         MOVE WS-SAVE-SOCIALI  TO SOCIALI
 14411         MOVE WS-SAVE-SOCIALL  TO SOCIALL
 14412         MOVE AL-UANON         TO SOCIALA
 14413     END-IF
 14414     IF WS-SAVE-SEXL > 0
 14415         MOVE WS-SAVE-SEXI  TO SEXI
 14416         MOVE WS-SAVE-SEXL  TO SEXL
 14417         MOVE AL-UANON      TO SEXA
 14418     END-IF
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 270
* EL131.cbl
 14419     IF WS-SAVE-MLNAMEL > 0
 14420         MOVE WS-SAVE-MLNAMEI  TO MLNAMEI
 14421         MOVE WS-SAVE-MLNAMEL  TO MLNAMEL
 14422         MOVE AL-UANON         TO MLNAMEA
 14423     END-IF
 14424     IF WS-SAVE-MFNAMEL > 0
 14425         MOVE WS-SAVE-MFNAMEI  TO MFNAMEI
 14426         MOVE WS-SAVE-MFNAMEL  TO MFNAMEL
 14427         MOVE AL-UANON         TO MFNAMEA
 14428     END-IF
 14429     IF WS-SAVE-MMINITL > 0
 14430         MOVE WS-SAVE-MMINITI  TO MMINITI
 14431         MOVE WS-SAVE-MMINITL  TO MMINITL
 14432         MOVE AL-UANON         TO MMINITA
 14433     END-IF
 14434     IF WS-SAVE-LOANNOL > 0
 14435         MOVE WS-SAVE-LOANNOI  TO LOANNOI
 14436         MOVE WS-SAVE-LOANNOL  TO LOANNOL
 14437         MOVE AL-UANON         TO LOANNOA
 14438     END-IF
 14439     IF WS-SAVE-LOANBALL > 0
 14440         MOVE WS-SAVE-LOANBALI  TO LOANBALI
 14441         MOVE WS-SAVE-LOANBALL  TO LOANBALL
 14442         MOVE AL-UANON          TO LOANBALA
 14443     END-IF
 14444     IF WS-SAVE-PROCL > 0
 14445         MOVE WS-SAVE-PROCI  TO PROCI
 14446         MOVE WS-SAVE-PROCL  TO PROCL
 14447         MOVE AL-UANON       TO PROCA
 14448     END-IF
 14449     IF WS-SAVE-SUPVL > 0
 14450         MOVE WS-SAVE-SUPVI  TO SUPVI
 14451         MOVE WS-SAVE-SUPVL  TO SUPVL
 14452         MOVE AL-UANON       TO SUPVA
 14453     END-IF
 14454     IF WS-SAVE-PRICDL > 0
 14455         MOVE WS-SAVE-PRICDI  TO PRICDI
 14456         MOVE WS-SAVE-PRICDL  TO PRICDL
 14457         MOVE AL-UANON        TO PRICDA
 14458     END-IF
 14459     IF WS-SAVE-FILETOL > 0
 14460         MOVE WS-SAVE-FILETOI  TO FILETOI
 14461         MOVE WS-SAVE-FILETOL  TO FILETOL
 14462         MOVE AL-UANON         TO FILETOA
 14463     END-IF
 14464     IF WS-SAVE-PDTHRUL > 0
 14465         MOVE WS-SAVE-PDTHRUI  TO PDTHRUI
 14466         MOVE WS-SAVE-PDTHRUL  TO PDTHRUL
 14467         MOVE AL-UANON         TO PDTHRUA
 14468     END-IF
 14469     IF WS-SAVE-PDAMTL > 0
 14470         MOVE WS-SAVE-PDAMTI  TO PDAMTI
 14471         MOVE WS-SAVE-PDAMTL  TO PDAMTL
 14472         MOVE AL-UANON        TO PDAMTA
 14473     END-IF
 14474     IF WS-SAVE-NODAYSL > 0
 14475         MOVE WS-SAVE-NODAYSI  TO NODAYSI
 14476         MOVE WS-SAVE-NODAYSL  TO NODAYSL
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 271
* EL131.cbl
 14477         MOVE AL-UANON         TO NODAYSA
 14478     END-IF
 14479     IF WS-SAVE-NOPMTSL > 0
 14480         MOVE WS-SAVE-NOPMTSI  TO NOPMTSI
 14481         MOVE WS-SAVE-NOPMTSL  TO NOPMTSL
 14482         MOVE AL-UANON         TO NOPMTSA
 14483     END-IF
 14484     IF WS-SAVE-FORMTYPL > 0
 14485         MOVE WS-SAVE-FORMTYPI  TO FORMTYPI
 14486         MOVE WS-SAVE-FORMTYPL  TO FORMTYPL
 14487         MOVE AL-UANON          TO FORMTYPA
 14488     END-IF
 14489     IF WS-SAVE-OCCL > 0
 14490         MOVE WS-SAVE-OCCI  TO OCCI
 14491         MOVE WS-SAVE-OCCL  TO OCCL
 14492         MOVE AL-UANON      TO OCCA
 14493     END-IF.
 14494 4200-EXIT.
 14495      EXIT.
 14496
 14497 5000-BUILD-MAP.
 14498     IF PI-RETURN-CD-1 = SPACE
 14499         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 14500
 14501     MOVE SPACE                  TO PI-RETURN-CD-1.
 14502
 14503     MOVE LOW-VALUES             TO EL131AI.
 14504
 14505     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 14506     MOVE PI-CARRIER             TO CARRIER-CODE.
 14507     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 14508     MOVE PI-CERT-NO             TO CERT-NO.
 14509
 14510 5000-READ-CLAIM-MASTER.
 14511
 14512
 14513* EXEC CICS READ
 14514*         SET      (ADDRESS OF CLAIM-MASTER)
 14515*         DATASET  (CLMS-FILE-ID)
 14516*         RIDFLD   (MSTR-KEY)
 14517*    END-EXEC.
 14518*    MOVE '&"S        E          (   #00012279' TO DFHEIV0
 14519     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14520     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14521     MOVE X'2020233030303132323739' TO DFHEIV0(25:11)
 14522     CALL 'kxdfhei1' USING DFHEIV0,
 14523           CLMS-FILE-ID,
 14524           DFHEIV20,
 14525           DFHEIV99,
 14526           MSTR-KEY,
 14527           DFHEIV99,
 14528           DFHEIV99,
 14529           DFHEIV99
 14530     SET ADDRESS OF CLAIM-MASTER TO
 14531         DFHEIV20
 14532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14533
 14534
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 272
* EL131.cbl
 14535     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 14536
 14537 5000-READ-DIAGNOSIS-TRAILER.
 14538
 14539
 14540* EXEC CICS HANDLE CONDITION
 14541*         NOTFND (5000-TRLR-NOT-FOUND)
 14542*    END-EXEC.
 14543*    MOVE '"$I                   ! B #00012289' TO DFHEIV0
 14544     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14545     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14546     MOVE X'4220233030303132323839' TO DFHEIV0(25:11)
 14547     CALL 'kxdfhei1' USING DFHEIV0
 14548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14549
 14550
 14551     MOVE MSTR-KEY               TO TRLR-KEY.
 14552     MOVE NINETY                 TO TRLR-SEQ-NO.
 14553
 14554
 14555* EXEC CICS READ
 14556*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14557*         DATASET  (TRLR-FILE-ID)
 14558*         RIDFLD   (TRLR-KEY)
 14559*    END-EXEC.
 14560*    MOVE '&"S        E          (   #00012296' TO DFHEIV0
 14561     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14562     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14563     MOVE X'2020233030303132323936' TO DFHEIV0(25:11)
 14564     CALL 'kxdfhei1' USING DFHEIV0,
 14565           TRLR-FILE-ID,
 14566           DFHEIV20,
 14567           DFHEIV99,
 14568           TRLR-KEY,
 14569           DFHEIV99,
 14570           DFHEIV99,
 14571           DFHEIV99
 14572     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14573         DFHEIV20
 14574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14575
 14576
 14577     MOVE AT-INFO-LINE-1         TO DIAGO.
 14578     MOVE AT-ICD-CODE-1          TO ICD1O.
 14579     MOVE AT-ICD-CODE-2          TO ICD2O.
 14580
 14581 5000-READ-CERTIFICATE-MASTER.
 14582
 14583     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 14584     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 14585     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 14586     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 14587     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 14588     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 14589     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 14590
 14591
 14592* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 273
* EL131.cbl
 14593*         NOTFND (5000-CERT-NOT-FOUND)
 14594*    END-EXEC.
 14595*    MOVE '"$I                   ! C #00012316' TO DFHEIV0
 14596     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14597     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14598     MOVE X'4320233030303132333136' TO DFHEIV0(25:11)
 14599     CALL 'kxdfhei1' USING DFHEIV0
 14600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14601
 14602
 14603
 14604* EXEC CICS READ
 14605*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14606*         DATASET  (CERT-FILE-ID)
 14607*         RIDFLD   (CERT-KEY)
 14608*    END-EXEC.
 14609*    MOVE '&"S        E          (   #00012320' TO DFHEIV0
 14610     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14611     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14612     MOVE X'2020233030303132333230' TO DFHEIV0(25:11)
 14613     CALL 'kxdfhei1' USING DFHEIV0,
 14614           CERT-FILE-ID,
 14615           DFHEIV20,
 14616           DFHEIV99,
 14617           CERT-KEY,
 14618           DFHEIV99,
 14619           DFHEIV99,
 14620           DFHEIV99
 14621     SET ADDRESS OF CERTIFICATE-MASTER TO
 14622         DFHEIV20
 14623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14624
 14625
 14626     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 14627     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 14628
 14629     GO TO 5000-EXIT.
 14630
 14631 5000-TRLR-NOT-FOUND.
 14632     MOVE ER-7687                TO EMI-ERROR.
 14633     MOVE -1                     TO DIAGL.
 14634     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14635     GO TO 5000-EXIT.
 14636
 14637 5000-CERT-NOT-FOUND.
 14638     MOVE ER-0206                TO EMI-ERROR.
 14639     MOVE -1                     TO CERTL.
 14640     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14641
 14642 5000-EXIT.
 14643     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 274
* EL131.cbl
 14645 5010-RESET-PI-AREA.
 14646     IF CERTI GREATER THAN LOW-VALUES
 14647         MOVE CERTI              TO PI-CERT-PRIME.
 14648
 14649     IF SUFXI GREATER THAN LOW-VALUES
 14650         MOVE SUFXI              TO PI-CERT-SFX.
 14651
 14652     IF CERTEFFI GREATER THAN LOW-VALUES
 14653         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 14654
 14655     IF CERTACTI GREATER THAN LOW-VALUES
 14656         MOVE CERTACTI           TO PI-ACCOUNT.
 14657
 14658     IF CERTSTI GREATER THAN LOW-VALUES
 14659         MOVE CERTSTI            TO PI-STATE.
 14660
 14661     IF CERTCARI GREATER THAN LOW-VALUES
 14662         MOVE CERTCARI           TO PI-CARRIER.
 14663
 14664     IF CERTGRPI GREATER THAN LOW-VALUES
 14665         MOVE CERTGRPI           TO PI-GROUPING.
 14666
 14667 5010-EXIT.
 14668     EXIT.
 14669
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 275
* EL131.cbl
 14671 5020-MOVE-MSTR.
 14672
 14673     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 14674     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 14675     MOVE WS-CLAIM-SEQU          TO SEQUO.
 14676     MOVE AL-SABON               TO SEQUA.
 14677     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 14678     MOVE CL-CLAIM-TYPE          TO TYPEO
 14679                                    pi-claim-type
 14680
 14681     IF CL-TOTAL-PAID-AMT  = +0 AND
 14682        CL-LAST-PMT-AMT    = +0 AND
 14683        CL-NO-OF-PMTS-MADE = +0
 14684          MOVE AL-UANON          TO TYPEA.
 14685
 14686     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14687     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14688     MOVE CL-CERT-PRIME          TO CERTO.
 14689     MOVE CL-CERT-SFX            TO SUFXO.
 14690     MOVE CL-CERT-CARRIER        TO CARRO.
 14691
 14692     IF CL-CLAIM-STATUS = 'C'
 14693         MOVE 'CLOSED'           TO STATUSO
 14694     ELSE
 14695         MOVE 'OPEN  '           TO STATUSO.
 14696
 14697     move cl-accident-claim-sw   to accswo
 14698     if cl-benefit-period not numeric
 14699        move zeros               to cl-benefit-period
 14700     end-if
 14701     move cl-benefit-period      to benpero
 14702     move cl-insured-type        to instypeo
 14703     MOVE CL-PROCESSOR-ID        TO PROCO.
 14704
 14705     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 14706     MOVE CL-CCN                 TO CCNOO.
 14707
 14708     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 14709     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 14710     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 14711     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14712
 14713     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 14714         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14715         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14716         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14717         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 14718     ELSE
 14719         MOVE SPACES             TO BIRTHO.
 14720
 14721     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 14722        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 14723         NEXT SENTENCE
 14724       ELSE
 14725         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 14726
 14727     IF PI-COMPANY-ID = 'DMD'
 14728       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 276
* EL131.cbl
 14729          IF SOCIALO = SPACES OR LOW-VALUES
 14730            MOVE ER-0885         TO EMI-ERROR
 14731            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14732
 14733     MOVE CL-INSURED-OCC-CD      TO OCCO.
 14734*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14735
 14736*    IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 14737*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14738*        MOVE SPACES                 TO DC-OPTION-CODE
 14739*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14740*        MOVE DC-GREG-DATE-1-EDIT TO ENDO
 14741*    ELSE
 14742*        MOVE SPACES             TO ENDO.
 14743
 14744     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 14745        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 14746        MOVE SPACES             TO DC-OPTION-CODE
 14747        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14748        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 14749        IF PI-USES-PAID-TO
 14750           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 14751           MOVE '6'                TO DC-OPTION-CODE
 14752           MOVE +1                 TO DC-ELAPSED-DAYS
 14753           MOVE +0                 TO DC-ELAPSED-MONTHS
 14754           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14755           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 14756        ELSE
 14757           NEXT SENTENCE
 14758     ELSE
 14759        MOVE SPACES             TO PDTHRUO.
 14760
 14761     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 14762     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 14763     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 14764     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 14765
 14766     IF MODIFY-CAP
 14767        MOVE AL-UNNOF            TO PDAMTA
 14768                                    NODAYSA
 14769                                    NOPMTSA
 14770        MOVE AL-UANOF            TO PDTHRUA.
 14771     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 14772     MOVE '2'                    TO CNTL-REC-TYPE
 14773     MOVE +0                     TO CNTL-SEQ-NO
 14774     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 14775
 14776
 14777* EXEC CICS READ
 14778*         DATASET  (CNTL-FILE-ID)
 14779*         SET      (ADDRESS OF CONTROL-FILE)
 14780*         RIDFLD   (CNTL-KEY)
 14781*         RESP     (WS-RESPONSE)
 14782*    END-EXEC
 14783*    MOVE '&"S        E          (  N#00012476' TO DFHEIV0
 14784     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14785     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14786     MOVE X'204E233030303132343736' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 277
* EL131.cbl
 14787     CALL 'kxdfhei1' USING DFHEIV0,
 14788           CNTL-FILE-ID,
 14789           DFHEIV20,
 14790           DFHEIV99,
 14791           CNTL-KEY,
 14792           DFHEIV99,
 14793           DFHEIV99,
 14794           DFHEIV99
 14795     SET ADDRESS OF CONTROL-FILE TO
 14796         DFHEIV20
 14797     MOVE EIBRESP  TO WS-RESPONSE
 14798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14799
 14800     IF WS-RESP-NORMAL
 14801        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 14802     end-if
 14803     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 14804         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14805         MOVE SPACES             TO DC-OPTION-CODE
 14806         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14807         MOVE DC-GREG-DATE-1-EDIT TO INCO
 14808     ELSE
 14809         MOVE SPACES             TO INCO.
 14810
 14811     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 14812        OR (PI-APPROVAL-LEVEL = '4' OR '5')
 14813        MOVE AL-UANOF            TO INCA
 14814     end-if
 14815     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 14816
 14817     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 14818         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14819         MOVE SPACES             TO DC-OPTION-CODE
 14820         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14821         MOVE DC-GREG-DATE-1-EDIT TO REPO
 14822     ELSE
 14823         MOVE SPACES             TO REPO.
 14824
 14825     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 14826         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 14827         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14828         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14829         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 14830     ELSE
 14831         MOVE SPACES             TO ESTO.
 14832
 14833     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 14834         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 14835         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14836         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14837         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 14838     ELSE
 14839         MOVE SPACES             TO MNTDTO.
 14840
 14841
 14842     IF CL-LAST-MAINT-TYPE = SPACE
 14843         MOVE 'SET-UP'           TO MNTTYPEO
 14844     ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 278
* EL131.cbl
 14845     IF CL-LAST-MAINT-TYPE = '1'
 14846         MOVE 'PAYMNT'           TO MNTTYPEO
 14847     ELSE
 14848     IF CL-LAST-MAINT-TYPE = '2'
 14849         MOVE 'LETTER'           TO MNTTYPEO
 14850     ELSE
 14851     IF CL-LAST-MAINT-TYPE = '3'
 14852         MOVE 'UPDATE'           TO MNTTYPEO
 14853     ELSE
 14854     IF CL-LAST-MAINT-TYPE = '4'
 14855         MOVE 'RESTOR'           TO MNTTYPEO
 14856     ELSE
 14857     IF CL-LAST-MAINT-TYPE = '5'
 14858         MOVE 'INC DT'           TO MNTTYPEO
 14859     ELSE
 14860     IF CL-LAST-MAINT-TYPE = '6'
 14861         MOVE ' CONV'            TO MNTTYPEO
 14862     ELSE
 14863     IF CL-LAST-MAINT-TYPE = 'C'
 14864         MOVE 'CHGBEN'           TO MNTTYPEO
 14865     ELSE
 14866     IF CL-LAST-MAINT-TYPE = 'E'
 14867         MOVE 'ERRCOR'           TO MNTTYPEO
 14868     ELSE
 14869         MOVE SPACES             TO MNTTYPEO.
 14870
 14871     MOVE CL-BENEFICIARY         TO BENEO.
 14872     MOVE CL-FILE-LOCATION       TO FILETOO.
 14873     IF CL-CRITICAL-PERIOD NOT NUMERIC
 14874        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 14875     END-IF
 14876     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 14877*    MOVE CL-CRIT-PER-RECURRENT
 14878*                                TO CRITPTO
 14879*    IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 14880*       MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 14881*    END-IF
 14882*    MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 14883     MOVE CL-PRIORITY-CD         TO PRICDO.
 14884     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14885     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 14886     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 14887     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 14888
 14889 5020-EXIT.
 14890     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 279
* EL131.cbl
 14892 5030-MOVE-CERT.
 14893
 14894     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 14895         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14896         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14897         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14898         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 14899       ELSE
 14900         MOVE SPACES             TO CERTEFFO
 14901         MOVE ZERO               TO HOLD-DATE.
 14902
 14903     MOVE CM-ACCOUNT             TO CERTACTO.
 14904     MOVE CM-STATE               TO CERTSTO PI-STATE.
 14905     MOVE CM-GROUPING            TO CERTGRPO.
 14906     MOVE CM-CARRIER             TO CERTCARO.
 14907     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14908     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14909     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14910     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14911     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14912     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14913     MOVE CM-JT-INITIAL          TO JNTINITO.
 14914     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14915
 14916*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14917     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 14918     MOVE '3'                    TO CNTL-REC-TYPE.
 14919     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 14920     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 14921     MOVE ZERO                   TO CNTL-SEQ-NO.
 14922
 14923
 14924* EXEC CICS READ
 14925*         SET        (ADDRESS OF CONTROL-FILE)
 14926*         DATASET    ('ELCNTL')
 14927*         RIDFLD     (CNTL-KEY)
 14928*         RESP       (WS-RESPONSE)
 14929*    END-EXEC.
 14930     MOVE 'ELCNTL' TO DFHEIV1
 14931*    MOVE '&"S        E          (  N#00012606' TO DFHEIV0
 14932     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14933     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14934     MOVE X'204E233030303132363036' TO DFHEIV0(25:11)
 14935     CALL 'kxdfhei1' USING DFHEIV0,
 14936           DFHEIV1,
 14937           DFHEIV20,
 14938           DFHEIV99,
 14939           CNTL-KEY,
 14940           DFHEIV99,
 14941           DFHEIV99,
 14942           DFHEIV99
 14943     SET ADDRESS OF CONTROL-FILE TO
 14944         DFHEIV20
 14945     MOVE EIBRESP  TO WS-RESPONSE
 14946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14947
 14948
 14949     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 280
* EL131.cbl
 14950        MOVE ZERO                TO CP-FREE-LOOK
 14951     ELSE
 14952        MOVE CF-ST-FREE-LOOK-PERIOD
 14953                                 TO CP-FREE-LOOK.
 14954
 14955     IF CM-LF-BENEFIT-CD = '00'
 14956        GO TO 5030-MOVE-CERT-AH.
 14957
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 281
* EL131.cbl
 14959     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 14960     MOVE '5'                    TO DC-OPTION-CODE
 14961     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14962     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 14963     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14964     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 14965     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 14966     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 14967     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14968     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 14969     MOVE '4'                    TO CP-REM-TERM-METHOD
 14970     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 14971     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14972     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 14973
 14974     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14975     IF CM-LF-PREMIUM-RATE NUMERIC
 14976         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14977     ELSE
 14978         MOVE ZEROS              TO LCVRATEO.
 14979
 14980     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14981         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 14982
 14983     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 14984
 14985     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 14986
 14987     IF CM-LF-CURRENT-STATUS = '8'
 14988        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14989            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14990            MOVE ' '             TO DC-OPTION-CODE
 14991            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14992            IF NOT DATE-CONVERSION-ERROR
 14993                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 14994
 14995     IF CM-LF-CURRENT-STATUS = '7'
 14996        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14997            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 14998            MOVE ' '             TO DC-OPTION-CODE
 14999            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15000            IF NOT DATE-CONVERSION-ERROR
 15001                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15002
 15003     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 15004         MOVE ' '                TO DC-OPTION-CODE
 15005         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 15006         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15007         IF NOT DATE-CONVERSION-ERROR
 15008             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 15009             MOVE HOLD-MONTH     TO WORK-MONTH
 15010             MOVE HOLD-YEAR      TO WORK-YEAR
 15011             MOVE WORK-DATE-MY   TO LCVEXITO.
 15012
 15013     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 15014        IF CP-REMAINING-TERM-3 = ZEROS
 15015           MOVE 'EXPIRED'        TO LCVSTATO
 15016        ELSE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 282
* EL131.cbl
 15017           MOVE 'ACTIVE'         TO LCVSTATO.
 15018
 15019     IF CM-LF-CURRENT-STATUS = '2'
 15020        MOVE 'PEND   '           TO LCVSTATO.
 15021     IF CM-LF-CURRENT-STATUS = '3'
 15022        MOVE 'RESTORE'           TO LCVSTATO.
 15023     IF CM-LF-CURRENT-STATUS = '5'
 15024        MOVE 'REISSUE'           TO LCVSTATO.
 15025     IF CM-LF-CURRENT-STATUS = '6'
 15026        MOVE 'LMP DIS'           TO LCVSTATO.
 15027     IF CM-LF-CURRENT-STATUS = '7'
 15028        MOVE 'DEATH  '           TO LCVSTATO.
 15029     IF CM-LF-CURRENT-STATUS = '8'
 15030        MOVE 'CANCEL '           TO LCVSTATO.
 15031     IF CM-LF-CURRENT-STATUS = '9'
 15032        MOVE 'RE-ONLY'           TO LCVSTATO.
 15033     IF CM-LF-CURRENT-STATUS = 'V'
 15034        MOVE 'VOID   '           TO LCVSTATO.
 15035     IF CM-LF-CURRENT-STATUS = 'D'
 15036        MOVE 'DECLINE'           TO LCVSTATO.
 15037
 15038     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15039     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15040     MOVE '4'                    TO BEN-REC-TYPE.
 15041     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 15042     MOVE ZERO                   TO BEN-SEQ-NO.
 15043
 15044
 15045* EXEC CICS READ GTEQ
 15046*         DATASET  (CNTL-FILE-ID)
 15047*         RIDFLD   (BENEFIT-KEY)
 15048*         SET      (ADDRESS OF CONTROL-FILE)
 15049*    END-EXEC.
 15050*    MOVE '&"S        G          (   #00012708' TO DFHEIV0
 15051     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15052     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15053     MOVE X'2020233030303132373038' TO DFHEIV0(25:11)
 15054     CALL 'kxdfhei1' USING DFHEIV0,
 15055           CNTL-FILE-ID,
 15056           DFHEIV20,
 15057           DFHEIV99,
 15058           BENEFIT-KEY,
 15059           DFHEIV99,
 15060           DFHEIV99,
 15061           DFHEIV99
 15062     SET ADDRESS OF CONTROL-FILE TO
 15063         DFHEIV20
 15064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15065
 15066
 15067     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15068        CF-RECORD-TYPE NOT = '4'
 15069         MOVE ER-0240            TO EMI-ERROR
 15070         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15071         GO TO 5030-MOVE-CERT-FINISH.
 15072
 15073     MOVE ZERO                   TO COUNT-2.
 15074     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 283
* EL131.cbl
 15075
 15076     IF SCREEN-ERROR
 15077         MOVE ER-0282            TO EMI-ERROR
 15078         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15079        ELSE
 15080         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 15081
 15082 5030-MOVE-CERT-AH.
 15083
 15084     IF CM-LF-BENEFIT-CD = '00'
 15085         IF CM-AH-BENEFIT-CD = '00'
 15086             GO TO 5030-MOVE-CERT-FINISH.
 15087
 15088     IF CM-AH-BENEFIT-CD = '00'
 15089        MOVE SPACES             TO ACVKINDO
 15090        COMPUTE PI-PAYMENT-AMT =
 15091                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 15092        GO TO 5030-MOVE-CERT-FINISH.
 15093
 15094     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15095     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 15096     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 15097     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 15098     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15099     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15100     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15101     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 15102
 15103**DMD **********************************************
 15104     IF PI-COMPANY-ID = 'DMD'
 15105         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 15106                                   CM-PMT-EXTENSION-DAYS
 15107         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 15108                                      CL-NO-OF-DAYS-PAID
 15109         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 15110             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 15111         MOVE WS-REM-MOS         TO ACVRTRMO
 15112                                    CP-REMAINING-TERM-3
 15113*        MOVE WS-REM-DAYS        TO DAYSPO
 15114         GO TO 5030-SKIP-RTRM.
 15115**DMD **********************************************
 15116
 15117     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15118     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15119     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15120     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15121
 15122 5030-SKIP-RTRM.
 15123     IF CM-AH-PREMIUM-RATE NUMERIC
 15124         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15125     ELSE
 15126         MOVE ZEROS              TO ACVRATEO.
 15127
 15128     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 15129     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 15130
 15131     IF CM-AH-CURRENT-STATUS = '8'
 15132        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 284
* EL131.cbl
 15133            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15134            MOVE ' '             TO DC-OPTION-CODE
 15135            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15136            IF NOT DATE-CONVERSION-ERROR
 15137                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15138
 15139     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15140        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15141            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 15142            MOVE ' '             TO DC-OPTION-CODE
 15143            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15144            IF NOT DATE-CONVERSION-ERROR
 15145                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15146
 15147     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15148        IF CP-REMAINING-TERM-3 = ZEROS
 15149           MOVE 'EXPIRED'        TO ACVSTATO
 15150        ELSE
 15151           MOVE 'ACTIVE'         TO ACVSTATO.
 15152
 15153     IF CM-AH-CURRENT-STATUS = '2'
 15154        MOVE 'PEND   '           TO ACVSTATO.
 15155     IF CM-AH-CURRENT-STATUS = '3'
 15156        MOVE 'RESTORE'           TO ACVSTATO.
 15157     IF CM-AH-CURRENT-STATUS = '5'
 15158        MOVE 'REISSUE'           TO ACVSTATO.
 15159     IF CM-AH-CURRENT-STATUS = '6'
 15160        MOVE 'LMP DIS'           TO ACVSTATO.
 15161     IF CM-AH-CURRENT-STATUS = '7'
 15162        MOVE 'DEATH  '           TO ACVSTATO.
 15163     IF CM-AH-CURRENT-STATUS = '8'
 15164        MOVE 'CANCEL '           TO ACVSTATO.
 15165     IF CM-AH-CURRENT-STATUS = '9'
 15166        MOVE 'RE-ONLY'           TO ACVSTATO.
 15167     IF CM-AH-CURRENT-STATUS = 'V'
 15168        MOVE 'VOID   '           TO ACVSTATO.
 15169     IF CM-AH-CURRENT-STATUS = '9'
 15170        MOVE 'DECLINE'           TO ACVSTATO.
 15171
 15172     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15173         MOVE ' '                TO DC-OPTION-CODE
 15174         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15175         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15176         IF NOT DATE-CONVERSION-ERROR
 15177             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 15178             MOVE HOLD-MONTH     TO WORK-MONTH
 15179             MOVE HOLD-YEAR      TO WORK-YEAR
 15180             MOVE WORK-DATE-MY   TO ACVEXITO.
 15181
 15182     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15183
 15184     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15185     MOVE '5'                    TO BEN-REC-TYPE.
 15186     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 15187     MOVE ZERO                   TO BEN-SEQ-NO.
 15188
 15189
 15190* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 285
* EL131.cbl
 15191*         DATASET  (CNTL-FILE-ID)
 15192*         RIDFLD   (BENEFIT-KEY)
 15193*         SET      (ADDRESS OF CONTROL-FILE)
 15194*    END-EXEC.
 15195*    MOVE '&"S        G          (   #00012836' TO DFHEIV0
 15196     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15197     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15198     MOVE X'2020233030303132383336' TO DFHEIV0(25:11)
 15199     CALL 'kxdfhei1' USING DFHEIV0,
 15200           CNTL-FILE-ID,
 15201           DFHEIV20,
 15202           DFHEIV99,
 15203           BENEFIT-KEY,
 15204           DFHEIV99,
 15205           DFHEIV99,
 15206           DFHEIV99
 15207     SET ADDRESS OF CONTROL-FILE TO
 15208         DFHEIV20
 15209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15210
 15211
 15212     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15213        CF-RECORD-TYPE NOT = '5'
 15214         MOVE ER-0250            TO EMI-ERROR
 15215         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15216         GO TO 5030-MOVE-CERT-FINISH.
 15217
 15218     MOVE ZERO                   TO COUNT-2.
 15219     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 15220
 15221     IF SCREEN-ERROR
 15222         MOVE ER-0283            TO EMI-ERROR
 15223         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15224       ELSE
 15225         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 15226
 15227 5030-MOVE-CERT-FINISH.
 15228
 15229     MOVE CM-LOAN-APR            TO APRO.
 15230     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15231     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15232     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 15233     MOVE CM-LOAN-NUMBER         TO LOANNOO
 15234     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 15235     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 15236
 15237     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 15238         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15239         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15240         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15241         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 15242     ELSE
 15243         MOVE SPACES               TO ADDONDTO.
 15244
 15245     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 15246
 15247 5030-EXIT.
 15248     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 286
* EL131.cbl
 15250 5040-FIND-BENEFIT.
 15251     ADD 1                       TO COUNT-2.
 15252     IF COUNT-2 GREATER THAN 8
 15253         GO TO 5050-BENEFIT-NOTFND.
 15254
 15255     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 15256         GO TO 5060-EXIT.
 15257
 15258     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 15259         GO TO 5050-BENEFIT-NOTFND.
 15260
 15261     GO TO 5040-FIND-BENEFIT.
 15262
 15263 5050-BENEFIT-NOTFND.
 15264     MOVE 'X'                    TO ERROR-SWITCH.
 15265
 15266 5060-EXIT.
 15267     EXIT.
 15268
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 287
* EL131.cbl
 15270 6000-CALCULATE-CERT-TERM.
 15271
 15272     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 15273         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 15274     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 15275         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 15276     IF CM-LOAN-APR NOT NUMERIC
 15277         MOVE ZEROS              TO CM-LOAN-APR.
 15278
 15279*    IF WS-CALC-METHOD  = 'G'
 15280         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 15281*     ELSE
 15282*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 15283
 15284     IF N GREATER 120
 15285         MOVE 120                TO N.
 15286
 15287     MOVE '6'                    TO DC-OPTION-CODE.
 15288     MOVE N                      TO DC-ELAPSED-MONTHS.
 15289     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 15290     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 15291
 15292     IF CM-LF-BENEFIT-CD NOT = ZERO
 15293         MOVE N                  TO CM-LF-ORIG-TERM
 15294         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 15295         IF NO-CONVERSION-ERROR
 15296             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 15297
 15298     IF CM-AH-BENEFIT-CD NOT = ZERO
 15299         MOVE N                  TO CM-AH-ORIG-TERM
 15300         IF NO-CONVERSION-ERROR
 15301             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 15302
 15303 6000-EXIT.
 15304      EXIT.
 15305
 15306 6100-CALC-GROSS-TERM.
 15307     MOVE CM-LOAN-BALANCE         TO L.
 15308     MOVE PI-PAYMENT-AMT          TO M.
 15309
 15310     COMPUTE N = L / M.
 15311     IF N LESS 1
 15312         MOVE 1  TO N.
 15313
 15314     IF CM-LF-BENEFIT-CD NOT = ZERO
 15315         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 15316     ELSE
 15317         MOVE ZEROS               TO WS-LF-RATE.
 15318
 15319     IF CM-AH-BENEFIT-CD NOT = ZERO
 15320         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 15321     ELSE
 15322         MOVE ZEROS               TO WS-AH-RATE.
 15323
 15324     COMPUTE I = CM-LOAN-APR / +1200.
 15325
 15326 6105-LOOP.
 15327     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 288
* EL131.cbl
 15328         GO TO 6200-EXIT.
 15329     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 15330     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 15331         ADD 1 TO N
 15332         GO TO 6105-LOOP.
 15333
 15334 6200-EXIT.
 15335      EXIT.
 15336
 15337 6210-CALC-LEFT-RIGHTONE.
 15338      MOVE L         TO LEFT-TOT-1.
 15339      SUBTRACT 1 FROM N.
 15340      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15341      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 15342      ADD 1 TO N.
 15343 6211-CALC-TERM1.
 15344      MOVE N         TO TERM1.
 15345      MULTIPLY M BY TERM1.
 15346 6212-LOOP.
 15347      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 15348      ADD 1 TO A-N.
 15349      MULTIPLY A-N BY TERM1.
 15350      SUBTRACT 1 FROM A-N.
 15351      ADD TERM1 TO LEFT-TOT-1.
 15352 6213-CALC-TERM2.
 15353      MOVE M         TO TERM2.
 15354      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 15355      MULTIPLY IA-N BY TERM2.
 15356      SUBTRACT TERM2 FROM LEFT-TOT-1.
 15357 6215-CALC-RIGHTONE.
 15358      MOVE M         TO RIGHT-TOT-1.
 15359      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 15360      MULTIPLY A-N BY RIGHT-TOT-1.
 15361 6220-EXIT.
 15362      EXIT.
 15363
 15364 6300-CALC-A-N.
 15365     IF N LESS 1
 15366         MOVE 0     TO A-N
 15367         GO TO 6300-EXIT.
 15368     IF I = 0
 15369         MOVE .00001 TO I.
 15370     ADD 1 TO I.
 15371     DIVIDE I INTO 1 GIVING V.
 15372     SUBTRACT 1 FROM I.
 15373     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 15374     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 15375     DIVIDE I INTO TERM3 GIVING A-N.
 15376 6300-EXIT.
 15377      EXIT.
 15378
 15379 6350-CALC-IA-N.
 15380     IF N LESS 1
 15381         MOVE 0      TO IA-N
 15382         GO TO 6400-EXIT.
 15383     ADD 1 TO N.
 15384     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 15385     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 289
* EL131.cbl
 15386     MULTIPLY N BY V-EX-N GIVING TERM3.
 15387     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 15388     SUBTRACT V FROM 1 GIVING TERM4.
 15389     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 15390 6400-EXIT.
 15391      EXIT.
 15392
 15393 6450-CALC-V-EX-N.
 15394     IF N LESS 1
 15395         MOVE 1    TO V-EX-N
 15396         GO TO 6490-EXIT.
 15397     MOVE N        TO NV-STORE.
 15398     IF V-EX-ONETIME = 1  OR
 15399        V NOT = V-EXPONENT (1)
 15400          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 15401 6460-LOOP.
 15402     IF N GREATER 248
 15403         MOVE 248 TO N.
 15404     IF N = 1
 15405         MOVE V               TO V-EX-N
 15406      ELSE
 15407         MOVE V-EXPONENT (N)  TO V-EX-N.
 15408     GO TO 6490-EXIT.
 15409
 15410 6470-BUILD-V-EX-TABLE.
 15411     MOVE 2      TO N.
 15412     MOVE V      TO V-EXPONENT (1)
 15413                    V-EX-N.
 15414 6471-LOOP.
 15415     MULTIPLY V BY V-EX-N.
 15416     MOVE V-EX-N   TO V-EXPONENT (N).
 15417     ADD 1 TO N.
 15418     IF N LESS 248
 15419         GO TO 6471-LOOP.
 15420     MOVE NV-STORE     TO N.
 15421     MOVE 0            TO V-EX-ONETIME.
 15422 6480-EXIT.
 15423      EXIT.
 15424
 15425 6490-EXIT.
 15426      EXIT.
 15427
 15428 6500-CALC-NET-TERM.
 15429     MOVE CM-LOAN-BALANCE         TO L.
 15430     MOVE PI-PAYMENT-AMT          TO M.
 15431
 15432     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 15433     IF WS-REMAIN GREATER ZERO
 15434         ADD 1 TO N.
 15435     IF N = 0
 15436         MOVE 1 TO N.
 15437
 15438 6700-EXIT.
 15439      EXIT.
 15440
 15441 6999-CALC-TERM-EXIT.
 15442     EXIT.
 15443
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 290
* EL131.cbl
 15445 7000-RESET-ATTRIBUTE.
 15446
 15447     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 15448                                    CERTSTA   CERTCARA
 15449                                    CERTGRPA.
 15450     MOVE -1                     TO CERTCARL.
 15451
 15452 7000-EXIT.
 15453     EXIT.
 15454
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 291
* EL131.cbl
 15456 7600-BROWSE-CLAIM.
 15457
 15458
 15459* EXEC CICS READ
 15460*        DATASET(CLMS-FILE-ID)
 15461*        SET    (ADDRESS OF CLAIM-MASTER)
 15462*        RIDFLD (MSTR-KEY)
 15463*        GENERIC
 15464*        EQUAL
 15465*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15466*    END-EXEC.
 15467*    MOVE '&"S  KG    E          (   #00013088' TO DFHEIV0
 15468     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15469     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15470     MOVE X'2020233030303133303838' TO DFHEIV0(25:11)
 15471     CALL 'kxdfhei1' USING DFHEIV0,
 15472           CLMS-FILE-ID,
 15473           DFHEIV20,
 15474           DFHEIV99,
 15475           MSTR-KEY,
 15476           ELMSTR-GENERIC-LENGTH,
 15477           DFHEIV99,
 15478           DFHEIV99
 15479     SET ADDRESS OF CLAIM-MASTER TO
 15480         DFHEIV20
 15481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15482
 15483
 15484     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 15485
 15486     if cl-assoc-cert-total = 0
 15487        move 1 to cl-assoc-cert-total
 15488     end-if
 15489     IF CL-ASSOC-CERT-SEQU = 0
 15490        MOVE 1 TO CL-ASSOC-CERT-SEQU
 15491     END-IF
 15492
 15493     IF CL-ASSOC-CERT-TOTAL = 1
 15494         MOVE AL-SADOF           TO BCERT1A
 15495                                    BSUFX1A
 15496                                    BCERT2A
 15497                                    BSUFX2A
 15498                                    BCERT3A
 15499                                    BSUFX3A
 15500                                    BCERT4A
 15501                                    BSUFX4A
 15502                                    BCERT5A
 15503                                    BSUFX5A
 15504                                    PCERTNOA
 15505                                    PSUFXA
 15506                                    LABEL1A
 15507                                    LABEL2A
 15508         GO TO 7699-EXIT.
 15509
 15510 7610-BROWSE-CLAIM-LOOP.
 15511
 15512     MOVE LOW-VALUES             TO BCERT1O
 15513                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 292
* EL131.cbl
 15514                                    BCERT2O
 15515                                    BSUFX2O
 15516                                    BCERT3O
 15517                                    BSUFX3O
 15518                                    BCERT4O
 15519                                    BSUFX4O
 15520                                    BCERT5O
 15521                                    BSUFX5O.
 15522
 15523
 15524* EXEC CICS HANDLE CONDITION
 15525*        ENDFILE  (7630-END-BROWSE)
 15526*    END-EXEC.
 15527*    MOVE '"$''                   ! D #00013136' TO DFHEIV0
 15528     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15529     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15530     MOVE X'4420233030303133313336' TO DFHEIV0(25:11)
 15531     CALL 'kxdfhei1' USING DFHEIV0
 15532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15533
 15534
 15535
 15536* EXEC CICS STARTBR
 15537*        DATASET    (CLMS-FILE-ID)
 15538*        RIDFLD     (MSTR-KEY)
 15539*    END-EXEC.
 15540     MOVE 0
 15541       TO DFHEIV11
 15542*    MOVE '&,         G          &   #00013140' TO DFHEIV0
 15543     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15544     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15545     MOVE X'2020233030303133313430' TO DFHEIV0(25:11)
 15546     CALL 'kxdfhei1' USING DFHEIV0,
 15547           CLMS-FILE-ID,
 15548           MSTR-KEY,
 15549           DFHEIV99,
 15550           DFHEIV11,
 15551           DFHEIV99
 15552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15553
 15554
 15555     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15556
 15557 7620-READ-CLAIM-LOOP.
 15558
 15559
 15560* EXEC CICS READNEXT
 15561*        DATASET   (CLMS-FILE-ID)
 15562*        SET       (ADDRESS OF CLAIM-MASTER)
 15563*        RIDFLD    (MSTR-KEY)
 15564*    END-EXEC.
 15565     MOVE 0
 15566       TO DFHEIV11
 15567*    MOVE '&.S                   )   #00013149' TO DFHEIV0
 15568     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15569     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15570     MOVE X'2020233030303133313439' TO DFHEIV0(25:11)
 15571     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 293
* EL131.cbl
 15572           CLMS-FILE-ID,
 15573           DFHEIV20,
 15574           DFHEIV99,
 15575           MSTR-KEY,
 15576           DFHEIV99,
 15577           DFHEIV11,
 15578           DFHEIV99,
 15579           DFHEIV99
 15580     SET ADDRESS OF CLAIM-MASTER TO
 15581         DFHEIV20
 15582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15583
 15584
 15585     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 15586        CL-CARRIER     NOT = CARRI           OR
 15587        CL-CLAIM-NO    NOT = CLAIMI
 15588        GO TO 7630-END-BROWSE.
 15589
 15590     IF WS-ASSOCIATED-CERTS = 1
 15591         MOVE CL-CERT-PRIME      TO BCERT1O
 15592         MOVE CL-CERT-SFX        TO BSUFX1O.
 15593
 15594     IF WS-ASSOCIATED-CERTS = 2
 15595         MOVE CL-CERT-PRIME      TO BCERT2O
 15596         MOVE CL-CERT-SFX        TO BSUFX2O.
 15597
 15598     IF WS-ASSOCIATED-CERTS = 3
 15599         MOVE CL-CERT-PRIME      TO BCERT3O
 15600         MOVE CL-CERT-SFX        TO BSUFX3O.
 15601
 15602     IF WS-ASSOCIATED-CERTS = 4
 15603         MOVE CL-CERT-PRIME      TO BCERT4O
 15604         MOVE CL-CERT-SFX        TO BSUFX4O.
 15605
 15606     IF WS-ASSOCIATED-CERTS = 5
 15607         MOVE CL-CERT-PRIME      TO BCERT5O
 15608         MOVE CL-CERT-SFX        TO BSUFX5O
 15609     ELSE
 15610         ADD +1                  TO WS-ASSOCIATED-CERTS
 15611         GO TO 7620-READ-CLAIM-LOOP.
 15612
 15613 7630-END-BROWSE.
 15614
 15615
 15616* EXEC CICS ENDBR
 15617*        DATASET   (CLMS-FILE-ID)
 15618*    END-EXEC.
 15619     MOVE 0
 15620       TO DFHEIV11
 15621*    MOVE '&2                    $   #00013185' TO DFHEIV0
 15622     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15623     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15624     MOVE X'2020233030303133313835' TO DFHEIV0(25:11)
 15625     CALL 'kxdfhei1' USING DFHEIV0,
 15626           CLMS-FILE-ID,
 15627           DFHEIV11,
 15628           DFHEIV99
 15629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 294
* EL131.cbl
 15630
 15631
 15632 7640-HIGHLIGHT-CERT-DISPLAYED.
 15633
 15634     MOVE AL-SANON               TO BCERT1A
 15635                                    BSUFX1A
 15636                                    BCERT2A
 15637                                    BSUFX2A
 15638                                    BCERT3A
 15639                                    BSUFX3A
 15640                                    BCERT4A
 15641                                    BSUFX4A
 15642                                    BCERT5A
 15643                                    BSUFX5A.
 15644
 15645     IF BCERT1O = CERTI AND
 15646        BSUFX1O = SUFXI
 15647            MOVE AL-SABON        TO BCERT1A
 15648                                    BSUFX1A.
 15649
 15650     IF BCERT2O = CERTI AND
 15651        BSUFX2O = SUFXI
 15652            MOVE AL-SABON        TO BCERT2A
 15653                                    BSUFX2A.
 15654
 15655     IF BCERT3O = CERTI AND
 15656        BSUFX3O = SUFXI
 15657            MOVE AL-SABON        TO BCERT3A
 15658                                    BSUFX3A.
 15659
 15660     IF BCERT4O = CERTI AND
 15661        BSUFX4O = SUFXI
 15662            MOVE AL-SABON        TO BCERT4A
 15663                                    BSUFX4A.
 15664
 15665     IF BCERT5O = CERTI AND
 15666        BSUFX5O = SUFXI
 15667            MOVE AL-SABON        TO BCERT5A
 15668                                    BSUFX5A.
 15669
 15670 7699-EXIT.
 15671     EXIT.
 15672
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 295
* EL131.cbl
 15674 7700-CHECK-SEQUENCE.
 15675
 15676
 15677* EXEC CICS HANDLE CONDITION
 15678*        ENDFILE  (7799-EXIT)
 15679*        NOTFND   (7799-EXIT)
 15680*    END-EXEC.
 15681*    MOVE '"$''I                  ! E #00013233' TO DFHEIV0
 15682     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15683     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15684     MOVE X'4520233030303133323333' TO DFHEIV0(25:11)
 15685     CALL 'kxdfhei1' USING DFHEIV0
 15686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15687
 15688
 15689
 15690* EXEC CICS READ
 15691*        DATASET(CLMS-FILE-ID)
 15692*        SET    (ADDRESS OF CLAIM-MASTER)
 15693*        RIDFLD (MSTR-KEY)
 15694*        GENERIC
 15695*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15696*    END-EXEC.
 15697*    MOVE '&"S  KG    E          (   #00013238' TO DFHEIV0
 15698     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15699     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15700     MOVE X'2020233030303133323338' TO DFHEIV0(25:11)
 15701     CALL 'kxdfhei1' USING DFHEIV0,
 15702           CLMS-FILE-ID,
 15703           DFHEIV20,
 15704           DFHEIV99,
 15705           MSTR-KEY,
 15706           ELMSTR-GENERIC-LENGTH,
 15707           DFHEIV99,
 15708           DFHEIV99
 15709     SET ADDRESS OF CLAIM-MASTER TO
 15710         DFHEIV20
 15711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15712
 15713
 15714     COMPUTE WS-ASSOC-CERT-TOTAL =
 15715             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15716
 15717     GO TO 7799-EXIT.
 15718
 15719 7710-RESEQUENCE-CLAIMS.
 15720
 15721
 15722* EXEC CICS HANDLE CONDITION
 15723*        ENDFILE  (7799-EXIT)
 15724*    END-EXEC.
 15725*    MOVE '"$''                   ! F #00013253' TO DFHEIV0
 15726     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15727     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15728     MOVE X'4620233030303133323533' TO DFHEIV0(25:11)
 15729     CALL 'kxdfhei1' USING DFHEIV0
 15730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15731
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 296
* EL131.cbl
 15732
 15733
 15734* EXEC CICS STARTBR
 15735*        DATASET(CLMS-FILE-ID)
 15736*        RIDFLD (MSTR-KEY)
 15737*    END-EXEC.
 15738     MOVE 0
 15739       TO DFHEIV11
 15740*    MOVE '&,         G          &   #00013257' TO DFHEIV0
 15741     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15742     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15743     MOVE X'2020233030303133323537' TO DFHEIV0(25:11)
 15744     CALL 'kxdfhei1' USING DFHEIV0,
 15745           CLMS-FILE-ID,
 15746           MSTR-KEY,
 15747           DFHEIV99,
 15748           DFHEIV11,
 15749           DFHEIV99
 15750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15751
 15752
 15753     COMPUTE WS-ASSOC-CERT-SEQU =
 15754             WS-ASSOC-CERT-SEQU + 1.
 15755
 15756     COMPUTE WS-READNEXT-SWITCH =
 15757             WS-READNEXT-SWITCH + 1.
 15758
 15759 7720-READ-CLAIM-LOOP.
 15760
 15761
 15762* EXEC CICS READNEXT
 15763*        DATASET(CLMS-FILE-ID)
 15764*        SET    (ADDRESS OF CLAIM-MASTER)
 15765*        RIDFLD (MSTR-KEY)
 15766*    END-EXEC.
 15767     MOVE 0
 15768       TO DFHEIV11
 15769*    MOVE '&.S                   )   #00013270' TO DFHEIV0
 15770     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15771     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15772     MOVE X'2020233030303133323730' TO DFHEIV0(25:11)
 15773     CALL 'kxdfhei1' USING DFHEIV0,
 15774           CLMS-FILE-ID,
 15775           DFHEIV20,
 15776           DFHEIV99,
 15777           MSTR-KEY,
 15778           DFHEIV99,
 15779           DFHEIV11,
 15780           DFHEIV99,
 15781           DFHEIV99
 15782     SET ADDRESS OF CLAIM-MASTER TO
 15783         DFHEIV20
 15784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15785
 15786
 15787     IF WS-READNEXT-SWITCH = 1
 15788         ADD 1                   TO WS-READNEXT-SWITCH
 15789         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 297
* EL131.cbl
 15790
 15791 7730-END-BROWSE.
 15792
 15793
 15794* EXEC CICS ENDBR
 15795*        DATASET(CLMS-FILE-ID)
 15796*    END-EXEC.
 15797     MOVE 0
 15798       TO DFHEIV11
 15799*    MOVE '&2                    $   #00013282' TO DFHEIV0
 15800     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15801     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15802     MOVE X'2020233030303133323832' TO DFHEIV0(25:11)
 15803     CALL 'kxdfhei1' USING DFHEIV0,
 15804           CLMS-FILE-ID,
 15805           DFHEIV11,
 15806           DFHEIV99
 15807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15808
 15809
 15810 7740-READ-CLAIM-UPDATE.
 15811
 15812     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 15813        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 15814        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 15815        GO TO 7799-EXIT
 15816     ELSE
 15817        MOVE ZERO                TO WS-READNEXT-SWITCH.
 15818
 15819
 15820* EXEC CICS READ
 15821*        DATASET(CLMS-FILE-ID)
 15822*        SET    (ADDRESS OF CLAIM-MASTER)
 15823*        RIDFLD (MSTR-KEY)
 15824*        UPDATE
 15825*    END-EXEC.
 15826*    MOVE '&"S        EU         (   #00013295' TO DFHEIV0
 15827     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15828     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15829     MOVE X'2020233030303133323935' TO DFHEIV0(25:11)
 15830     CALL 'kxdfhei1' USING DFHEIV0,
 15831           CLMS-FILE-ID,
 15832           DFHEIV20,
 15833           DFHEIV99,
 15834           MSTR-KEY,
 15835           DFHEIV99,
 15836           DFHEIV99,
 15837           DFHEIV99
 15838     SET ADDRESS OF CLAIM-MASTER TO
 15839         DFHEIV20
 15840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15841
 15842
 15843     if (cl-priority-cd = '8')
 15844        and (pi-processor-id not = 'PEMA' and 'JMS '
 15845             AND 'AMWA')
 15846        MOVE ER-8003             TO EMI-ERROR
 15847        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 298
* EL131.cbl
 15848                                 THRU 9900-EXIT
 15849        MOVE -1                  TO MAINTL
 15850        GO TO 8110-SEND-DATA
 15851     end-if
 15852
 15853     IF PI-COMPANY-ID = 'CID' or 'AHL'
 15854         MOVE 'Y'                TO CL-YESNOSW
 15855     END-IF.
 15856
 15857     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15858     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 15859
 15860
 15861* EXEC CICS REWRITE
 15862*         DATASET(CLMS-FILE-ID)
 15863*         FROM   (CLAIM-MASTER)
 15864*    END-EXEC.
 15865     MOVE LENGTH OF
 15866      CLAIM-MASTER
 15867       TO DFHEIV11
 15868*    MOVE '&& L                  %   #00013319' TO DFHEIV0
 15869     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15870     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15871     MOVE X'2020233030303133333139' TO DFHEIV0(25:11)
 15872     CALL 'kxdfhei1' USING DFHEIV0,
 15873           CLMS-FILE-ID,
 15874           CLAIM-MASTER,
 15875           DFHEIV11,
 15876           DFHEIV99
 15877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15878
 15879
 15880     GO TO 7710-RESEQUENCE-CLAIMS.
 15881
 15882 7799-EXIT.
 15883     EXIT.
 15884
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 299
* EL131.cbl
 15886 7800-CHECK-AUTO-ACTIVITY.
 15887
 15888
 15889* EXEC CICS HANDLE CONDITION
 15890*        NOTFND   (7800-NOT-FOUND)
 15891*    END-EXEC.
 15892*    MOVE '"$I                   ! G #00013332' TO DFHEIV0
 15893     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15894     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15895     MOVE X'4720233030303133333332' TO DFHEIV0(25:11)
 15896     CALL 'kxdfhei1' USING DFHEIV0
 15897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15898
 15899
 15900     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 15901     MOVE 'T'                        TO  CNTL-REC-TYPE.
 15902     MOVE SPACES                     TO  CNTL-PROC-ID.
 15903     MOVE +0                         TO  CNTL-SEQ-NO.
 15904
 15905
 15906* EXEC CICS READ
 15907*        DATASET   (CNTL-FILE-ID)
 15908*        RIDFLD    (CNTL-KEY)
 15909*        SET       (ADDRESS OF CONTROL-FILE)
 15910*    END-EXEC.
 15911*    MOVE '&"S        E          (   #00013341' TO DFHEIV0
 15912     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15913     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15914     MOVE X'2020233030303133333431' TO DFHEIV0(25:11)
 15915     CALL 'kxdfhei1' USING DFHEIV0,
 15916           CNTL-FILE-ID,
 15917           DFHEIV20,
 15918           DFHEIV99,
 15919           CNTL-KEY,
 15920           DFHEIV99,
 15921           DFHEIV99,
 15922           DFHEIV99
 15923     SET ADDRESS OF CONTROL-FILE TO
 15924         DFHEIV20
 15925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15926
 15927
 15928     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 15929         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 15930
 15931     IF CL-ACTIVITY-CODE NOT = ZEROS
 15932         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 15933         IF MISC-SUB IS GREATER THAN +9
 15934             SUBTRACT +9 FROM MISC-SUB
 15935             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 15936         ELSE
 15937             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 15938     ELSE
 15939         MOVE 'Y'                              TO  WS-RESET-SW.
 15940
 15941     IF STATUSI = 'C' OR 'CLOSED'
 15942         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 15943             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 300
* EL131.cbl
 15944                                         PI-LETTER-SW
 15945             GO TO 7800-EXIT.
 15946
 15947     IF STATUSI = 'C' OR 'CLOSED'
 15948         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 15949             MOVE 'N'                TO  PI-LETTER-SW
 15950         ELSE
 15951             MOVE 'Y'                TO  PI-LETTER-SW.
 15952
 15953     IF STATUSI = 'O' OR 'OPEN'
 15954         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 15955             MOVE 'N'                TO  PI-REC-FOUND-SW
 15956                                         PI-LETTER-SW
 15957             GO TO 7800-EXIT.
 15958
 15959     IF STATUSI = 'O' OR 'OPEN'
 15960         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 15961             MOVE 'N'                TO  PI-LETTER-SW
 15962         ELSE
 15963             MOVE 'Y'                TO  PI-LETTER-SW.
 15964
 15965     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 15966     GO TO 7800-EXIT.
 15967
 15968 7800-NOT-FOUND.
 15969
 15970     MOVE 'N'                        TO  PI-REC-FOUND-SW
 15971                                         PI-LETTER-SW.
 15972
 15973 7800-EXIT.
 15974     EXIT.
 15975
 15976 7850-AUTO-LETTER-WRITER.
 15977
 15978     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 15979     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 15980
 15981     IF STATUSI = 'C' OR 'CLOSED'
 15982         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 15983     ELSE
 15984         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 15985
 15986     IF STATUSI = 'C' OR 'CLOSED'
 15987         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 15988             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 15989             MOVE '6'                TO  DC-OPTION-CODE
 15990             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 15991             MOVE +0                 TO  DC-ELAPSED-MONTHS
 15992             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15993             IF NO-CONVERSION-ERROR
 15994                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 15995             ELSE
 15996                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 15997
 15998     IF STATUSI = 'C' OR 'CLOSED'
 15999         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 16000             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16001             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 301
* EL131.cbl
 16002             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 16003             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16004             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16005             IF NO-CONVERSION-ERROR
 16006                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16007             ELSE
 16008                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16009
 16010     IF STATUSI = 'O' OR 'OPEN'
 16011         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 16012             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16013             MOVE '6'                TO  DC-OPTION-CODE
 16014             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 16015             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16016             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16017             IF NO-CONVERSION-ERROR
 16018                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16019             ELSE
 16020                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16021
 16022     IF STATUSI = 'O' OR 'OPEN'
 16023         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 16024             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16025             MOVE '6'                TO  DC-OPTION-CODE
 16026             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 16027             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16028             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16029             IF NO-CONVERSION-ERROR
 16030                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16031             ELSE
 16032                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16033
 16034
 16035* EXEC CICS LINK
 16036*        PROGRAM    (LINK-1523)
 16037*        COMMAREA   (W-1523-LINKDATA)
 16038*        LENGTH     (W-1523-COMM-LENGTH)
 16039*    END-EXEC.
 16040*    MOVE '."C                   (   #00013453' TO DFHEIV0
 16041     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16042     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16043     MOVE X'2020233030303133343533' TO DFHEIV0(25:11)
 16044     CALL 'kxdfhei1' USING DFHEIV0,
 16045           LINK-1523,
 16046           W-1523-LINKDATA,
 16047           W-1523-COMM-LENGTH,
 16048           DFHEIV99,
 16049           DFHEIV99,
 16050           DFHEIV99,
 16051           DFHEIV99
 16052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16053
 16054
 16055     IF W-1523-ERROR-CODE = ZEROS
 16056         GO TO 7850-EXIT.
 16057
 16058     IF W-1523-FATAL-ERROR
 16059         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 302
* EL131.cbl
 16060         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16061
 16062     IF W-1523-ERROR-CODE = 0191
 16063         MOVE ER-0803                TO  EMI-ERROR
 16064         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16065
 16066 7850-EXIT.
 16067     EXIT.
 16068
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 303
* EL131.cbl
 16070 8000-CREATE-DMO-REC.
 16071     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 16072     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 16073     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 16074
 16075
 16076* EXEC CICS HANDLE CONDITION
 16077*         NOTFND   (8000-NOTE-NOT-FOUND)
 16078*    END-EXEC.
 16079*    MOVE '"$I                   ! H #00013479' TO DFHEIV0
 16080     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16081     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16082     MOVE X'4820233030303133343739' TO DFHEIV0(25:11)
 16083     CALL 'kxdfhei1' USING DFHEIV0
 16084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16085
 16086
 16087
 16088* EXEC CICS READ
 16089*         DATASET(NOTE-FILE-ID)
 16090*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 16091*         RIDFLD (NOTE-KEY)
 16092*    END-EXEC.
 16093*    MOVE '&"S        E          (   #00013483' TO DFHEIV0
 16094     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16095     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16096     MOVE X'2020233030303133343833' TO DFHEIV0(25:11)
 16097     CALL 'kxdfhei1' USING DFHEIV0,
 16098           NOTE-FILE-ID,
 16099           DFHEIV20,
 16100           DFHEIV99,
 16101           NOTE-KEY,
 16102           DFHEIV99,
 16103           DFHEIV99,
 16104           DFHEIV99
 16105     SET ADDRESS OF CERTIFICATE-NOTE TO
 16106         DFHEIV20
 16107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16108
 16109
 16110     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 16111     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 16112     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 16113
 16114     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 16115         MOVE 'CC'               TO DCT-PRODUCT-CODE
 16116     ELSE
 16117         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 16118
 16119     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 16120     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 16121
 16122
 16123* EXEC CICS LINK
 16124*        PROGRAM    ('DLO006')
 16125*        COMMAREA   (DCT-COMMUNICATION-AREA)
 16126*        LENGTH     (WS-DCT-LENGTH)
 16127*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 304
* EL131.cbl
 16128     MOVE 'DLO006' TO DFHEIV1
 16129*    MOVE '."C                   (   #00013501' TO DFHEIV0
 16130     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16131     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16132     MOVE X'2020233030303133353031' TO DFHEIV0(25:11)
 16133     CALL 'kxdfhei1' USING DFHEIV0,
 16134           DFHEIV1,
 16135           DCT-COMMUNICATION-AREA,
 16136           WS-DCT-LENGTH,
 16137           DFHEIV99,
 16138           DFHEIV99,
 16139           DFHEIV99,
 16140           DFHEIV99
 16141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16142
 16143
 16144     IF  DCT-RETURN-CODE = 'OK'
 16145         GO TO 8000-CONT.
 16146
 16147     IF DCT-RETURN-CODE = '01' OR '02'
 16148         GO TO 8000-EXIT.
 16149
 16150     IF DCT-RETURN-CODE = '03'
 16151         MOVE ER-0951            TO EMI-ERROR
 16152         MOVE -1                 TO MAINTL
 16153         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16154         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16155         GO TO 8110-SEND-DATA.
 16156
 16157     IF DCT-RETURN-CODE = '04'
 16158         MOVE ER-0946            TO EMI-ERROR
 16159         MOVE -1                 TO MAINTL
 16160         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16161         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16162         GO TO 8110-SEND-DATA.
 16163
 16164     IF DCT-RETURN-CODE = '05'
 16165         MOVE ER-0947            TO EMI-ERROR
 16166         MOVE -1                 TO MAINTL
 16167         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16168         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16169         GO TO 8110-SEND-DATA.
 16170
 16171     IF DCT-RETURN-CODE = '06'
 16172         MOVE ER-0921            TO EMI-ERROR
 16173         MOVE -1                 TO MAINTL
 16174         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16175         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16176         GO TO 8110-SEND-DATA.
 16177
 16178     IF DCT-RETURN-CODE = '07'
 16179         MOVE ER-0919            TO EMI-ERROR
 16180         MOVE -1                 TO MAINTL
 16181         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16182         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16183         GO TO 8110-SEND-DATA.
 16184
 16185     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 305
* EL131.cbl
 16186         MOVE ER-0948            TO EMI-ERROR
 16187         MOVE -1                 TO MAINTL
 16188         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16189         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16190         GO TO 8110-SEND-DATA.
 16191
 16192     IF DCT-RETURN-CODE = 'N1'
 16193         MOVE ER-0950            TO EMI-ERROR
 16194         MOVE -1                 TO MAINTL
 16195         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16196         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16197         GO TO 8110-SEND-DATA.
 16198
 16199     IF DCT-RETURN-CODE = 'E1'
 16200         MOVE ER-0974            TO EMI-ERROR
 16201         MOVE -1                 TO MAINTL
 16202         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16203         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16204         GO TO 8110-SEND-DATA.
 16205
 16206     IF DCT-RETURN-CODE = 'E2'
 16207         MOVE ER-0975            TO EMI-ERROR
 16208         MOVE -1                 TO MAINTL
 16209         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16210         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16211         GO TO 8110-SEND-DATA.
 16212
 16213     IF DCT-RETURN-CODE NOT = 'OK'
 16214         MOVE ER-0949            TO EMI-ERROR
 16215         MOVE -1                 TO MAINTL
 16216         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16217         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16218         GO TO 8110-SEND-DATA.
 16219
 16220 8000-CONT.
 16221
 16222     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 16223     MOVE 'CS'                   TO DM-RECORD-TYPE.
 16224     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 16225     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 16226     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 16227     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 16228     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 16229     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 16230
 16231     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 16232     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 16233     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 16234     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 16235     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 16236
 16237     IF STATUSI = 'OPEN' OR 'O'
 16238         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 16239      ELSE
 16240         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 16241
 16242     IF STATUSI = 'OPEN' OR 'O'
 16243        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 306
* EL131.cbl
 16244         MOVE '1'                TO DM-CLAIM-STATUS
 16245      ELSE
 16246         MOVE '2'                TO DM-CLAIM-STATUS.
 16247
 16248     IF STATUSI = 'CLOSED' OR 'C'
 16249        IF NOT FINAL-PAID
 16250         MOVE '3'                TO DM-CLAIM-STATUS
 16251      ELSE
 16252         MOVE '4'                TO DM-CLAIM-STATUS.
 16253
 16254     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 16255
 16256
 16257* EXEC CICS LINK
 16258*        PROGRAM    ('DLO025')
 16259*        COMMAREA   (DMO-COMMUNICATION-AREA)
 16260*        LENGTH     (WS-DMO-LENGTH)
 16261*    END-EXEC.
 16262     MOVE 'DLO025' TO DFHEIV1
 16263*    MOVE '."C                   (   #00013619' TO DFHEIV0
 16264     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16265     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16266     MOVE X'2020233030303133363139' TO DFHEIV0(25:11)
 16267     CALL 'kxdfhei1' USING DFHEIV0,
 16268           DFHEIV1,
 16269           DMO-COMMUNICATION-AREA,
 16270           WS-DMO-LENGTH,
 16271           DFHEIV99,
 16272           DFHEIV99,
 16273           DFHEIV99,
 16274           DFHEIV99
 16275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16276
 16277
 16278     IF  DM-RETURN-CODE = 'OK'
 16279         GO TO 8000-EXIT.
 16280
 16281     IF DM-RETURN-CODE = '01'
 16282         MOVE ER-8051            TO EMI-ERROR
 16283         MOVE -1                 TO MAINTL
 16284         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16285         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16286         GO TO 8110-SEND-DATA.
 16287
 16288     IF DM-RETURN-CODE = '02'
 16289         MOVE ER-8052            TO EMI-ERROR
 16290         MOVE -1                 TO MAINTL
 16291         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16292         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16293         GO TO 8110-SEND-DATA.
 16294
 16295     IF DM-RETURN-CODE = '03'
 16296         MOVE ER-8053            TO EMI-ERROR
 16297         MOVE -1                 TO MAINTL
 16298         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16299         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16300         GO TO 8110-SEND-DATA.
 16301
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 307
* EL131.cbl
 16302     IF DM-RETURN-CODE = '04'
 16303         MOVE ER-8054            TO EMI-ERROR
 16304         MOVE -1                 TO MAINTL
 16305         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16306         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16307         GO TO 8110-SEND-DATA.
 16308
 16309     IF DM-RETURN-CODE = '05'
 16310         MOVE ER-8055            TO EMI-ERROR
 16311         MOVE -1                 TO MAINTL
 16312         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16313         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16314         GO TO 8110-SEND-DATA.
 16315
 16316     IF DM-RETURN-CODE = '06'
 16317         MOVE ER-8056            TO EMI-ERROR
 16318         MOVE -1                 TO MAINTL
 16319         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16320         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16321         GO TO 8110-SEND-DATA.
 16322
 16323     IF DM-RETURN-CODE = '07'
 16324         MOVE ER-8057            TO EMI-ERROR
 16325         MOVE -1                 TO MAINTL
 16326         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16327         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16328         GO TO 8110-SEND-DATA.
 16329
 16330     IF DM-RETURN-CODE = '08'
 16331         MOVE ER-8058            TO EMI-ERROR
 16332         MOVE -1                 TO MAINTL
 16333         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16334         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16335         GO TO 8110-SEND-DATA.
 16336
 16337     IF DM-RETURN-CODE = '09'
 16338         MOVE ER-8059            TO EMI-ERROR
 16339         MOVE -1                 TO MAINTL
 16340         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16341         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16342         GO TO 8110-SEND-DATA.
 16343
 16344     IF DM-RETURN-CODE = '10'
 16345         MOVE ER-8060            TO EMI-ERROR
 16346         MOVE -1                 TO MAINTL
 16347         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16348         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16349         GO TO 8110-SEND-DATA.
 16350
 16351     IF DM-RETURN-CODE = '11'
 16352         MOVE ER-8061            TO EMI-ERROR
 16353         MOVE -1                 TO MAINTL
 16354         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16355         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16356         GO TO 8110-SEND-DATA.
 16357
 16358     IF DM-RETURN-CODE = '12'
 16359         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 308
* EL131.cbl
 16360         MOVE -1                 TO MAINTL
 16361         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16362         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16363         GO TO 8110-SEND-DATA.
 16364
 16365     IF DM-RETURN-CODE = '13'
 16366         MOVE ER-8063            TO EMI-ERROR
 16367         MOVE -1                 TO MAINTL
 16368         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16369         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16370         GO TO 8110-SEND-DATA.
 16371
 16372     IF DM-RETURN-CODE = '14'
 16373         MOVE ER-8064            TO EMI-ERROR
 16374         MOVE -1                 TO MAINTL
 16375         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16376         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16377         GO TO 8110-SEND-DATA.
 16378
 16379     IF DM-RETURN-CODE = '15'
 16380         MOVE ER-8065            TO EMI-ERROR
 16381         MOVE -1                 TO MAINTL
 16382         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16383         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16384         GO TO 8110-SEND-DATA.
 16385
 16386     IF DM-RETURN-CODE = '16'
 16387         MOVE ER-8154            TO EMI-ERROR
 16388         MOVE -1                 TO MAINTL
 16389         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16390         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16391         GO TO 8110-SEND-DATA.
 16392
 16393     IF DM-RETURN-CODE = '17'
 16394         MOVE ER-8155            TO EMI-ERROR
 16395         MOVE -1                 TO MAINTL
 16396         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16397         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16398         GO TO 8110-SEND-DATA.
 16399
 16400     IF DM-RETURN-CODE = 'N1'
 16401         MOVE ER-8152            TO EMI-ERROR
 16402         MOVE -1                 TO MAINTL
 16403         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16404         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16405         GO TO 8110-SEND-DATA.
 16406
 16407     IF DM-RETURN-CODE = 'E1'
 16408         MOVE ER-8153            TO EMI-ERROR
 16409         MOVE -1                 TO MAINTL
 16410         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16411         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16412         GO TO 8110-SEND-DATA.
 16413
 16414     MOVE ER-8066                TO EMI-ERROR.
 16415     MOVE -1                     TO MAINTL.
 16416     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16417     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 309
* EL131.cbl
 16418     GO TO 8110-SEND-DATA.
 16419
 16420 8000-NOTE-NOT-FOUND.
 16421
 16422* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16423*    MOVE '6"R                   !   #00013768' TO DFHEIV0
 16424     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16425     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16426     MOVE X'2020233030303133373638' TO DFHEIV0(25:11)
 16427     CALL 'kxdfhei1' USING DFHEIV0
 16428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16429
 16430     MOVE ER-0954                TO EMI-ERROR.
 16431     MOVE -1                     TO MAINTL.
 16432     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16433     GO TO 8110-SEND-DATA.
 16434
 16435 8000-EXIT.
 16436     EXIT.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 310
* EL131.cbl
 16438 8050-FORMAT-LAST-NAME-1ST.
 16439*****************************************************************
 16440*             M O V E   N A M E   R O U T I N E                 *
 16441*                                                               *
 16442*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 16443*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 16444*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 16445*                                                               *
 16446*                  FIELD               VALUE                    *
 16447*                  -----               -----                    *
 16448*           W-NAME-LAST    (CL15)      SMITH                    *
 16449*           W-NAME-FIRST   (CL15)      JOHN                     *
 16450*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 16451*                                                               *
 16452*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 16453*                SMITH, JOHN ALLEN                              *
 16454*                     OR                                        *
 16455*                SMITH, JOHN A.                                 *
 16456*                                                               *
 16457*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 16458*     COPYBOOK, ELCNWA.                                         *
 16459*****************************************************************.
 16460
 16461     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 16462     MOVE ZERO                   TO WS-NAME-SW.
 16463     SET NWA-INDEX               TO +1.
 16464
 16465     IF W-NAME-LAST   = SPACES  AND
 16466        W-NAME-MIDDLE = SPACES
 16467          MOVE +1                TO WS-NAME-SW.
 16468
 16469     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 16470     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16471
 16472     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 16473     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16474
 16475     SET NWA-INDEX UP BY +1.
 16476
 16477     IF W-NAME-MIDDLE NOT = SPACES
 16478         IF W-NAME-MIDDLE-2 = SPACES
 16479             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 16480             SET NWA-INDEX UP BY +1
 16481             MOVE '.'            TO WS-NW (NWA-INDEX)
 16482             SET NWA-INDEX UP BY +2
 16483         ELSE
 16484             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 16485             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 16486
 16487 8050-EXIT.
 16488     EXIT.
 16489
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 311
* EL131.cbl
 16491 8060-MOVE-NAME.
 16492     IF WS-NAME-SW GREATER THAN +1
 16493         GO TO 8060-EXIT.
 16494
 16495     IF WS-NAME-WORK2 = SPACES
 16496         GO TO 8060-EXIT.
 16497
 16498     SET NWA-INDEX2            TO +1.
 16499     SET NWA-INDEX3            TO +2.
 16500
 16501 8060-MOVE-NAME-CYCLE.
 16502     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 16503
 16504     IF NWA-INDEX LESS THAN +30
 16505         SET NWA-INDEX UP BY +1
 16506     ELSE
 16507         ADD +2 TO  WS-NAME-SW
 16508         GO TO 8060-EXIT.
 16509
 16510     IF NWA-INDEX2 LESS THAN +20
 16511         SET NWA-INDEX3 UP BY +1
 16512         SET NWA-INDEX2 UP BY +1.
 16513
 16514     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 16515        WS-NW2 (NWA-INDEX3) = SPACES
 16516         IF WS-NAME-SW = ZERO
 16517             MOVE ','            TO WS-NW (NWA-INDEX)
 16518             SET NWA-INDEX UP BY +2
 16519             MOVE +1             TO WS-NAME-SW
 16520             GO TO 8060-EXIT
 16521         ELSE
 16522             GO TO 8060-EXIT.
 16523
 16524     GO TO 8060-MOVE-NAME-CYCLE.
 16525
 16526 8060-EXIT.
 16527     EXIT.
 16528
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 312
* EL131.cbl
 16530
 16531 8070-UNLOCK-CLAIM-MSTR.
 16532
 16533* EXEC CICS UNLOCK
 16534*        DATASET   (CLMS-FILE-ID)
 16535*    END-EXEC.
 16536*    MOVE '&*                    #   #00013871' TO DFHEIV0
 16537     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16538     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16539     MOVE X'2020233030303133383731' TO DFHEIV0(25:11)
 16540     CALL 'kxdfhei1' USING DFHEIV0,
 16541           CLMS-FILE-ID,
 16542           DFHEIV99
 16543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16544
 16545
 16546 8070-EXIT.
 16547      EXIT.
 16548
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 313
* EL131.cbl
 16550 8100-SEND-MAP.
 16551     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 16552
 16553     move al-uanon               to accswa
 16554     IF NOT PI-NO-CARRIER-SECURITY
 16555        MOVE AL-SANOF            TO CERTCARA.
 16556     IF NOT PI-NO-ACCOUNT-SECURITY
 16557        MOVE AL-SANOF            TO CERTACTA.
 16558
 16559     IF PI-PROCESSOR-ID = 'LGXX'
 16560        MOVE AL-UANON            TO CCNOA.
 16561
 16562     IF PI-COMPANY-ID = 'DMD'
 16563        NEXT SENTENCE
 16564     ELSE
 16565        MOVE AL-SADOF            TO PFKEY6A.
 16566
 16567     IF PI-USES-PAID-TO
 16568        MOVE 'PAID TO  :' TO PTHRHDGO.
 16569
 16570
 16571* EXEC CICS SEND
 16572*         MAP     ('EL131A')
 16573*         MAPSET  ('EL131S')
 16574*         ERASE
 16575*         FREEKB
 16576*         CURSOR
 16577*    END-EXEC.
 16578     MOVE 'EL131A' TO DFHEIV1
 16579     MOVE -1
 16580       TO DFHEIV11
 16581     MOVE 'EL131S' TO DFHEIV2
 16582*    MOVE '8$     CT  E F  H     ,   #00013899' TO DFHEIV0
 16583     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16584     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 16585     MOVE X'2020233030303133383939' TO DFHEIV0(25:11)
 16586     CALL 'kxdfhei1' USING DFHEIV0,
 16587           DFHEIV1,
 16588           EL131AO,
 16589           DFHEIV99,
 16590           DFHEIV2,
 16591           DFHEIV99,
 16592           DFHEIV99,
 16593           DFHEIV99,
 16594           DFHEIV11,
 16595           DFHEIV99,
 16596           DFHEIV99,
 16597           DFHEIV99
 16598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16599
 16600
 16601     GO TO 9000-RETURN-TRANS.
 16602
 16603 8110-SEND-DATA.
 16604     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 16605
 16606     IF PI-USES-PAID-TO
 16607        MOVE 'PAID TO  :' TO PTHRHDGO.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 314
* EL131.cbl
 16608
 16609     IF PI-PROCESSOR-ID = 'LGXX'
 16610        MOVE AL-UANON            TO CCNOA.
 16611
 16612     IF PI-COMPANY-ID = 'DMD'
 16613        NEXT SENTENCE
 16614     ELSE
 16615        MOVE AL-SADOF            TO PFKEY6A.
 16616
 16617
 16618* EXEC CICS SEND
 16619*         MAP      ('EL131A')
 16620*         MAPSET   ('EL131S')
 16621*         DATAONLY
 16622*         FREEKB
 16623*         CURSOR
 16624*    END-EXEC.
 16625     MOVE 'EL131A' TO DFHEIV1
 16626     MOVE -1
 16627       TO DFHEIV11
 16628     MOVE 'EL131S' TO DFHEIV2
 16629*    MOVE '8$D    CT    F  H     ,   #00013923' TO DFHEIV0
 16630     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16631     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 16632     MOVE X'2020233030303133393233' TO DFHEIV0(25:11)
 16633     CALL 'kxdfhei1' USING DFHEIV0,
 16634           DFHEIV1,
 16635           EL131AO,
 16636           DFHEIV99,
 16637           DFHEIV2,
 16638           DFHEIV99,
 16639           DFHEIV99,
 16640           DFHEIV99,
 16641           DFHEIV11,
 16642           DFHEIV99,
 16643           DFHEIV99,
 16644           DFHEIV99
 16645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16646
 16647
 16648     GO TO 9000-RETURN-TRANS.
 16649
 16650 8120-FORMAT-TIME-DATE.
 16651     perform 8140-check-for-prev-errors
 16652                                 thru 8140-exit
 16653     IF SKIP-ATTRIBUTE = 'Y'
 16654        MOVE SPACES              TO SKIP-ATTRIBUTE
 16655        MOVE ER-0598             TO EMI-ERROR
 16656        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16657        GO TO 8125-SKIP-ATTRIBUTE.
 16658
 16659*     IF PI-COMPANY-ID = 'DMD'
 16660      IF PI-PROCESSOR-ID <> 'EMER'
 16661         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 16662                                    CERTCARA  CERTGRPA CERTA SUFXA
 16663
 16664     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 16665                                    ISSAGEA   JNTLNMEA  JNTFNMEA
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 315
* EL131.cbl
 16666                                    JNTINITA  JNTAGEA   APRA
 16667                                    LCVCDA    LCVOTRMA  LCVRTRMA
 16668                                    LCVBENEA  LCVFORMA  LCVCNDTA
 16669                                    LCVEXITA  LCVSTATA  LCVKINDA
 16670                                    ACVCDA    ACVOTRMA  ACVRTRMA
 16671                                    ACVBENEA  ACVFORMA  ACVCNDTA
 16672                                    ACVEXITA  ACVSTATA  ACVKINDA
 16673                                    PMTFREQA  INDGRPA   PREMTYPA
 16674                                    REINCDA   LCVRATEA  ACVRATEA
 16675                                    ADDONDTA.
 16676
 16677*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 16678*       IF PI-COMPANY-ID = 'DMD'
 16679*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 16680*                                   SUFXA
 16681*                                   PDAMTA    NODAYSA   NOPMTSA
 16682*                                   INCA      OCCA
 16683*          IF NOT SYSTEM-MODIFY-CAP
 16684*              MOVE AL-SANOF         TO PDTHRUA.
 16685
 16686     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 16687         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 16688
 16689 8125-SKIP-ATTRIBUTE.
 16690
 16691     MOVE SAVE-DATE              TO DATEO.
 16692
 16693* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 16694*    END-EXEC
 16695*    MOVE '0"A                   "   #00013975' TO DFHEIV0
 16696     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 16697     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 16698     MOVE X'2020233030303133393735' TO DFHEIV0(25:11)
 16699     CALL 'kxdfhei1' USING DFHEIV0,
 16700           LCP-CICS-TIME
 16701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16702
 16703* EXEC CICS FORMATTIME
 16704*              ABSTIME(LCP-CICS-TIME)
 16705*              TIME(LCP-TIME-OF-DAY-XX)
 16706*    END-EXEC
 16707*    MOVE 'j$(     (             #   #00013977' TO DFHEIV0
 16708     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 16709     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16710     MOVE X'2020233030303133393737' TO DFHEIV0(25:11)
 16711     CALL 'kxdfhei1' USING DFHEIV0,
 16712           LCP-CICS-TIME,
 16713           LCP-TIME-OF-DAY-XX
 16714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16715     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 16716     MOVE UN-HOURS               TO FOR-HOURS.
 16717     MOVE UN-MINUTES             TO FOR-MINUTES.
 16718     MOVE TIME-OUT               TO TIMEO.
 16719     MOVE PI-COMPANY-ID          TO COMPO.
 16720     MOVE PI-PROCESSOR-ID        TO USERIDO.
 16721     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 16722     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16723     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 316
* EL131.cbl
 16724     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
 16725
 16726 8130-EXIT.
 16727     EXIT.
 16728
 16729 8140-check-for-prev-errors.
 16730
 16731     MOVE PI-COMPANY-CD          TO trlr-company-cd
 16732     MOVE PI-CARRIER             TO trlr-carrier
 16733     MOVE PI-CLAIM-NO            TO trlr-claim-no
 16734     MOVE PI-CERT-NO             TO trlr-cert-no
 16735     MOVE +95                    TO TRLR-SEQ-NO
 16736
 16737
 16738* EXEC CICS READ
 16739*       DATASET  ('ELTRLR')
 16740*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16741*       RIDFLD   (TRLR-KEY)
 16742*       RESP     (WS-RESPONSE)
 16743*    END-EXEC
 16744     MOVE 'ELTRLR' TO DFHEIV1
 16745*    MOVE '&"S        E          (  N#00014003' TO DFHEIV0
 16746     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16747     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16748     MOVE X'204E233030303134303033' TO DFHEIV0(25:11)
 16749     CALL 'kxdfhei1' USING DFHEIV0,
 16750           DFHEIV1,
 16751           DFHEIV20,
 16752           DFHEIV99,
 16753           TRLR-KEY,
 16754           DFHEIV99,
 16755           DFHEIV99,
 16756           DFHEIV99
 16757     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16758         DFHEIV20
 16759     MOVE EIBRESP  TO WS-RESPONSE
 16760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16761
 16762     if ws-resp-normal
 16763        perform varying s1 from +1 by +1 until
 16764           at-note-error-no (s1) = spaces
 16765           if at-note-error-no (s1) = '1652'
 16766              continue
 16767           else
 16768              move at-note-error-no (s1)
 16769                                 to emi-error
 16770              move -1 to maintl
 16771              if at-note-error-no (s1) = '1653'
 16772                 evaluate true
 16773                    when pi-claim-type = 'L'
 16774                       move '  LF  '
 16775                        to emi-claim-type
 16776                    when pi-claim-type = 'I'
 16777                       move '  IU  '
 16778                        to emi-claim-type
 16779                    WHEN PI-CLAIM-TYPE = 'F'
 16780                       MOVE '  FL  '
 16781                        TO EMI-CLAIM-TYPE
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 317
* EL131.cbl
 16782                    when other
 16783                       move '  AH  '
 16784                        to emi-claim-type
 16785                 end-evaluate
 16786              end-if
 16787              PERFORM 9900-ERROR-FORMAT
 16788                                 THRU 9900-EXIT
 16789           end-if
 16790*          if at-note-error-no (s1) = '1653'
 16791*             perform varying emi-sub from 1 by 1 until
 16792*                emi-sub > 3
 16793*                if emi-error-number (emi-sub) = '1653'
 16794*                   evaluate true
 16795*                      when pi-claim-type = 'L'
 16796*                         move '  LF  '
 16797*                          to emi-claim-type
 16798*                      when pi-claim-type = 'I'
 16799*                         move '  IU  '
 16800*                          to emi-claim-type
 16801*                      when other
 16802*                         move '  AH  '
 16803*                          to emi-claim-type
 16804*                   end-evaluate
 16805*                end-if
 16806*             end-perform
 16807*          end-if
 16808        end-perform
 16809     else
 16810        display ' resp not normal ' ws-response ' '
 16811        trlr-key (2:19)
 16812     end-if
 16813
 16814     .
 16815 8140-exit.
 16816     exit.
 16817 8150-ENTERED-CLAIM-NOTFOUND.
 16818
 16819     MOVE ER-0204                TO EMI-ERROR.
 16820     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16821     MOVE -1                     TO MAINTL.
 16822     GO TO 8100-SEND-MAP.
 16823
 16824 8200-RETURN-PRIOR.
 16825     MOVE SPACE                  TO PI-RETURN-CD-1.
 16826     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 16827     GO TO 9200-XCTL.
 16828
 16829 8300-GET-HELP.
 16830     MOVE XCTL-EL010             TO CALL-PGM.
 16831     GO TO 9200-XCTL.
 16832
 16833 8400-RETURN-MASTER.
 16834     MOVE SPACE                  TO PI-RETURN-CD-1.
 16835     MOVE XCTL-EL126             TO CALL-PGM.
 16836     GO TO 9200-XCTL.
 16837
 16838 8500-TRLR-MNT.
 16839     IF PI-RETURN-CD-1 = 'X'
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 318
* EL131.cbl
 16840         MOVE ER-0311            TO EMI-ERROR
 16841         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16842         MOVE -1                 TO MAINTL
 16843         GO TO 8110-SEND-DATA.
 16844
 16845
 16846* EXEC CICS WRITEQ TS
 16847*         QUEUE     (PI-KEY)
 16848*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16849*         LENGTH    (PI-COMM-LENGTH)
 16850*    END-EXEC.
 16851*    MOVE '*"                    ''   #00014093' TO DFHEIV0
 16852     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16853     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16854     MOVE X'2020233030303134303933' TO DFHEIV0(25:11)
 16855     CALL 'kxdfhei1' USING DFHEIV0,
 16856           PI-KEY,
 16857           PROGRAM-INTERFACE-BLOCK,
 16858           PI-COMM-LENGTH,
 16859           DFHEIV99,
 16860           DFHEIV99,
 16861           DFHEIV99
 16862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16863
 16864
 16865     MOVE XCTL-EL142             TO CALL-PGM.
 16866     GO TO 9200-XCTL.
 16867
 16868 8600-ADDR-MNT.
 16869     IF PI-RETURN-CD-1 = 'X'
 16870         MOVE ER-0311            TO EMI-ERROR
 16871         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16872         MOVE -1                 TO MAINTL
 16873         GO TO 8110-SEND-DATA.
 16874
 16875
 16876* EXEC CICS WRITEQ TS
 16877*         QUEUE     (PI-KEY)
 16878*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16879*         LENGTH    (PI-COMM-LENGTH)
 16880*    END-EXEC.
 16881*    MOVE '*"                    ''   #00014109' TO DFHEIV0
 16882     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16883     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16884     MOVE X'2020233030303134313039' TO DFHEIV0(25:11)
 16885     CALL 'kxdfhei1' USING DFHEIV0,
 16886           PI-KEY,
 16887           PROGRAM-INTERFACE-BLOCK,
 16888           PI-COMM-LENGTH,
 16889           DFHEIV99,
 16890           DFHEIV99,
 16891           DFHEIV99
 16892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16893
 16894
 16895     MOVE XCTL-EL141             TO CALL-PGM.
 16896     GO TO 9200-XCTL.
 16897
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 319
* EL131.cbl
 16898 8700-CERT-MNT.
 16899     IF PI-RETURN-CD-1 = 'X'
 16900         MOVE ER-7690            TO EMI-ERROR
 16901         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16902         MOVE -1                 TO MAINTL
 16903         GO TO 8110-SEND-DATA.
 16904
 16905
 16906* EXEC CICS WRITEQ TS
 16907*         QUEUE     (PI-KEY)
 16908*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16909*         LENGTH    (PI-COMM-LENGTH)
 16910*    END-EXEC.
 16911*    MOVE '*"                    ''   #00014125' TO DFHEIV0
 16912     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16913     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16914     MOVE X'2020233030303134313235' TO DFHEIV0(25:11)
 16915     CALL 'kxdfhei1' USING DFHEIV0,
 16916           PI-KEY,
 16917           PROGRAM-INTERFACE-BLOCK,
 16918           PI-COMM-LENGTH,
 16919           DFHEIV99,
 16920           DFHEIV99,
 16921           DFHEIV99
 16922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16923
 16924
 16925     MOVE XCTL-EL1273            TO CALL-PGM.
 16926     GO TO 9200-XCTL.
 16927
 16928 8725-BENEFICIARY-MNT.
 16929     IF PI-RETURN-CD-1 = 'X'
 16930         MOVE ER-0311            TO EMI-ERROR
 16931         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16932         MOVE -1                 TO MAINTL
 16933         GO TO 8110-SEND-DATA.
 16934
 16935
 16936* EXEC CICS WRITEQ TS
 16937*         QUEUE     (PI-KEY)
 16938*         FROM      (EL131AI)
 16939*         LENGTH    (MAP-LENGTH)
 16940*    END-EXEC.
 16941*    MOVE '*"                    ''   #00014141' TO DFHEIV0
 16942     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16943     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16944     MOVE X'2020233030303134313431' TO DFHEIV0(25:11)
 16945     CALL 'kxdfhei1' USING DFHEIV0,
 16946           PI-KEY,
 16947           EL131AI,
 16948           MAP-LENGTH,
 16949           DFHEIV99,
 16950           DFHEIV99,
 16951           DFHEIV99
 16952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16953
 16954
 16955
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 320
* EL131.cbl
 16956* EXEC CICS WRITEQ TS
 16957*         QUEUE     (PI-KEY)
 16958*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16959*         LENGTH    (PI-COMM-LENGTH)
 16960*    END-EXEC.
 16961*    MOVE '*"                    ''   #00014147' TO DFHEIV0
 16962     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16963     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16964     MOVE X'2020233030303134313437' TO DFHEIV0(25:11)
 16965     CALL 'kxdfhei1' USING DFHEIV0,
 16966           PI-KEY,
 16967           PROGRAM-INTERFACE-BLOCK,
 16968           PI-COMM-LENGTH,
 16969           DFHEIV99,
 16970           DFHEIV99,
 16971           DFHEIV99
 16972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16973
 16974
 16975     MOVE XCTL-EL114             TO CALL-PGM.
 16976     GO TO 9200-XCTL.
 16977
 16978 8750-DMD-CLM-FIX.
 16979
 16980* EXEC CICS WRITEQ TS
 16981*         QUEUE     (PI-KEY)
 16982*         FROM      (PROGRAM-INTERFACE-BLOCK)
 16983*         LENGTH    (PI-COMM-LENGTH)
 16984*    END-EXEC.
 16985*    MOVE '*"                    ''   #00014157' TO DFHEIV0
 16986     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 16987     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16988     MOVE X'2020233030303134313537' TO DFHEIV0(25:11)
 16989     CALL 'kxdfhei1' USING DFHEIV0,
 16990           PI-KEY,
 16991           PROGRAM-INTERFACE-BLOCK,
 16992           PI-COMM-LENGTH,
 16993           DFHEIV99,
 16994           DFHEIV99,
 16995           DFHEIV99
 16996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16997
 16998
 16999     MOVE XCTL-EL400DMD          TO CALL-PGM.
 17000     GO TO 9200-XCTL.
 17001
 17002 8800-UNAUTHORIZED-ACCESS.
 17003     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 17004     GO TO 8990-SEND-TEXT.
 17005
 17006 8810-PF23-ENTERED.
 17007     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 17008     MOVE XCTL-EL005             TO CALL-PGM.
 17009     GO TO 9200-XCTL.
 17010
 17011 8820-XCTL-ERROR.
 17012
 17013* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 321
* EL131.cbl
 17014*        PGMIDERR (8990-SEND-TEXT)
 17015*    END-EXEC.
 17016*    MOVE '"$L                   ! I #00014176' TO DFHEIV0
 17017     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 17018     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17019     MOVE X'4920233030303134313736' TO DFHEIV0(25:11)
 17020     CALL 'kxdfhei1' USING DFHEIV0
 17021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17022
 17023
 17024     MOVE SPACE                 TO PI-ENTRY-CD-1.
 17025     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 17026     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 17027     MOVE XCTL-EL005            TO CALL-PGM.
 17028     GO TO 9200-XCTL.
 17029
 17030 8990-SEND-TEXT.
 17031
 17032* EXEC CICS SEND TEXT
 17033*         FROM      (LOGOFF-TEXT)
 17034*         LENGTH    (LOGOFF-LENGTH)
 17035*         ERASE
 17036*         FREEKB
 17037*    END-EXEC.
 17038*    MOVE '8&      T  E F  H   F -   #00014187' TO DFHEIV0
 17039     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 17040     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 17041     MOVE X'2020233030303134313837' TO DFHEIV0(25:11)
 17042     CALL 'kxdfhei1' USING DFHEIV0,
 17043           LOGOFF-TEXT,
 17044           LOGOFF-LENGTH,
 17045           DFHEIV99,
 17046           DFHEIV99,
 17047           DFHEIV99,
 17048           DFHEIV99,
 17049           DFHEIV99,
 17050           DFHEIV99,
 17051           DFHEIV99,
 17052           DFHEIV99,
 17053           DFHEIV99,
 17054           DFHEIV99
 17055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17056
 17057
 17058     GO TO 9100-RETURN-CICS.
 17059
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 322
* EL131.cbl
 17061 9000-RETURN-TRANS.
 17062
 17063* EXEC CICS RETURN
 17064*         TRANSID   (TRANS-ID)
 17065*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 17066*         LENGTH    (PI-COMM-LENGTH)
 17067*    END-EXEC.
 17068*    MOVE '.(CT                  ''   #00014198' TO DFHEIV0
 17069     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 17070     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17071     MOVE X'2020233030303134313938' TO DFHEIV0(25:11)
 17072     CALL 'kxdfhei1' USING DFHEIV0,
 17073           TRANS-ID,
 17074           PROGRAM-INTERFACE-BLOCK,
 17075           PI-COMM-LENGTH,
 17076           DFHEIV99,
 17077           DFHEIV99,
 17078           DFHEIV99
 17079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17080
 17081
 17082
 17083* GOBACK.
 17084     MOVE '9%                    "   ' TO DFHEIV0
 17085     MOVE 'EL131' TO DFHEIV1
 17086     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17087     GOBACK.
 17088
 17089 9100-RETURN-CICS.
 17090
 17091* EXEC CICS RETURN
 17092*    END-EXEC.
 17093*    MOVE '.(                    ''   #00014207' TO DFHEIV0
 17094     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 17095     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17096     MOVE X'2020233030303134323037' TO DFHEIV0(25:11)
 17097     CALL 'kxdfhei1' USING DFHEIV0,
 17098           DFHEIV99,
 17099           DFHEIV99,
 17100           DFHEIV99,
 17101           DFHEIV99,
 17102           DFHEIV99,
 17103           DFHEIV99
 17104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17105
 17106
 17107
 17108* GOBACK.
 17109     MOVE '9%                    "   ' TO DFHEIV0
 17110     MOVE 'EL131' TO DFHEIV1
 17111     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17112     GOBACK.
 17113
 17114 9200-XCTL.
 17115
 17116* EXEC CICS XCTL
 17117*         PROGRAM    (CALL-PGM)
 17118*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 323
* EL131.cbl
 17119*         LENGTH     (PI-COMM-LENGTH)
 17120*    END-EXEC.
 17121*    MOVE '.$C                   %   #00014213' TO DFHEIV0
 17122     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 17123     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17124     MOVE X'2020233030303134323133' TO DFHEIV0(25:11)
 17125     CALL 'kxdfhei1' USING DFHEIV0,
 17126           CALL-PGM,
 17127           PROGRAM-INTERFACE-BLOCK,
 17128           PI-COMM-LENGTH,
 17129           DFHEIV99
 17130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17131
 17132
 17133 9700-LINK-RTRM-FILE-ID.
 17134
 17135* EXEC CICS LINK
 17136*        PROGRAM  (RTRM-FILE-ID)
 17137*        COMMAREA (CALCULATION-PASS-AREA)
 17138*        LENGTH   (CP-COMM-LENGTH)
 17139*    END-EXEC.
 17140*    MOVE '."C                   (   #00014220' TO DFHEIV0
 17141     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17142     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17143     MOVE X'2020233030303134323230' TO DFHEIV0(25:11)
 17144     CALL 'kxdfhei1' USING DFHEIV0,
 17145           RTRM-FILE-ID,
 17146           CALCULATION-PASS-AREA,
 17147           CP-COMM-LENGTH,
 17148           DFHEIV99,
 17149           DFHEIV99,
 17150           DFHEIV99,
 17151           DFHEIV99
 17152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17153
 17154
 17155 9700-EXIT.
 17156      EXIT.
 17157
 17158 9800-CONVERT-DATE.
 17159     MOVE SPACES TO DC-ERROR-CODE.
 17160
 17161* EXEC CICS LINK
 17162*         PROGRAM    (DATE-CONV)
 17163*         COMMAREA   (DATE-CONVERSION-DATA)
 17164*         LENGTH     (DC-COMM-LENGTH)
 17165*    END-EXEC.
 17166*    MOVE '."C                   (   #00014231' TO DFHEIV0
 17167     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17168     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17169     MOVE X'2020233030303134323331' TO DFHEIV0(25:11)
 17170     CALL 'kxdfhei1' USING DFHEIV0,
 17171           DATE-CONV,
 17172           DATE-CONVERSION-DATA,
 17173           DC-COMM-LENGTH,
 17174           DFHEIV99,
 17175           DFHEIV99,
 17176           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 324
* EL131.cbl
 17177           DFHEIV99
 17178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17179
 17180
 17181 9800-EXIT.
 17182     EXIT.
 17183
 17184 9900-ERROR-FORMAT.
 17185
 17186* EXEC CICS LINK
 17187*         PROGRAM    (XCTL-EL001)
 17188*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17189*         LENGTH     (EMI-COMM-LENGTH)
 17190*    END-EXEC.
 17191*    MOVE '."C                   (   #00014241' TO DFHEIV0
 17192     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17193     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17194     MOVE X'2020233030303134323431' TO DFHEIV0(25:11)
 17195     CALL 'kxdfhei1' USING DFHEIV0,
 17196           XCTL-EL001,
 17197           ERROR-MESSAGE-INTERFACE-BLOCK,
 17198           EMI-COMM-LENGTH,
 17199           DFHEIV99,
 17200           DFHEIV99,
 17201           DFHEIV99,
 17202           DFHEIV99
 17203     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17204
 17205
 17206 9900-EXIT.
 17207     EXIT.
 17208
 17209 9990-ABEND.
 17210     MOVE DFHEIBLK               TO EMI-LINE1.
 17211
 17212* EXEC CICS LINK
 17213*         PROGRAM   (XCTL-EL004)
 17214*         COMMAREA  (EMI-LINE1)
 17215*         LENGTH    (72)
 17216*     END-EXEC.
 17217     MOVE 72
 17218       TO DFHEIV11
 17219*    MOVE '."C                   (   #00014252' TO DFHEIV0
 17220     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17221     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17222     MOVE X'2020233030303134323532' TO DFHEIV0(25:11)
 17223     CALL 'kxdfhei1' USING DFHEIV0,
 17224           XCTL-EL004,
 17225           EMI-LINE1,
 17226           DFHEIV11,
 17227           DFHEIV99,
 17228           DFHEIV99,
 17229           DFHEIV99,
 17230           DFHEIV99
 17231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17232
 17233
 17234     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 325
* EL131.cbl
 17235
 17236     GO TO 8110-SEND-DATA.
 17237
 17238 9995-SECURITY-VIOLATION.
 17239*           COPY ELCSCTP.
 17240******************************************************************
 17241*                                                                *
 17242*                            ELCSCTP                             *
 17243*                            VMOD=2.001                          *
 17244*                                                                *
 17245*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17246******************************************************************
 17247
 17248
 17249     MOVE EIBDATE          TO SM-JUL-DATE.
 17250     MOVE EIBTRMID         TO SM-TERMID.
 17251     MOVE THIS-PGM         TO SM-PGM.
 17252     MOVE EIBTIME          TO TIME-IN.
 17253     MOVE TIME-OUT         TO SM-TIME.
 17254     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17255
 17256
 17257* EXEC CICS LINK
 17258*         PROGRAM  ('EL003')
 17259*         COMMAREA (SECURITY-MESSAGE)
 17260*         LENGTH   (80)
 17261*    END-EXEC.
 17262     MOVE 'EL003' TO DFHEIV1
 17263     MOVE 80
 17264       TO DFHEIV11
 17265*    MOVE '."C                   (   #00014280' TO DFHEIV0
 17266     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17267     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17268     MOVE X'2020233030303134323830' TO DFHEIV0(25:11)
 17269     CALL 'kxdfhei1' USING DFHEIV0,
 17270           DFHEIV1,
 17271           SECURITY-MESSAGE,
 17272           DFHEIV11,
 17273           DFHEIV99,
 17274           DFHEIV99,
 17275           DFHEIV99,
 17276           DFHEIV99
 17277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17278
 17279
 17280******************************************************************
 17281
 17282
 17283
 17284 9999-DFHBACK SECTION.
 17285     MOVE '9%                    "   ' TO DFHEIV0
 17286     MOVE 'EL131' TO DFHEIV1
 17287     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17288     GOBACK.
 17289 9999-DFHEXIT.
 17290     IF DFHEIGDJ EQUAL 0001
 17291         NEXT SENTENCE
 17292     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 326
* EL131.cbl
 17293         GO TO 8820-XCTL-ERROR,
 17294               8150-ENTERED-CLAIM-NOTFOUND,
 17295               9990-ABEND
 17296         DEPENDING ON DFHEIGDI
 17297     ELSE IF DFHEIGDJ EQUAL 3
 17298         GO TO 0130-TS-ERROR,
 17299               0130-TS-ERROR
 17300         DEPENDING ON DFHEIGDI
 17301     ELSE IF DFHEIGDJ EQUAL 4
 17302         GO TO 0600-CONTINUE-NAME-UPDATE
 17303         DEPENDING ON DFHEIGDI
 17304     ELSE IF DFHEIGDJ EQUAL 5
 17305         GO TO 1004-BENE-NOT-FOUND
 17306         DEPENDING ON DFHEIGDI
 17307     ELSE IF DFHEIGDJ EQUAL 6
 17308         GO TO 1052-DONE,
 17309               1052-DONE
 17310         DEPENDING ON DFHEIGDI
 17311     ELSE IF DFHEIGDJ EQUAL 7
 17312         GO TO 1120-CNTL-NOTFND
 17313         DEPENDING ON DFHEIGDI
 17314     ELSE IF DFHEIGDJ EQUAL 8
 17315         GO TO 1150-NOTOPEN-ERROR,
 17316               1150-EXIT
 17317         DEPENDING ON DFHEIGDI
 17318     ELSE IF DFHEIGDJ EQUAL 9
 17319         GO TO 1490-STATE-NOTFND
 17320         DEPENDING ON DFHEIGDI
 17321     ELSE IF DFHEIGDJ EQUAL 10
 17322         GO TO 1500-CARR-NOTFND
 17323         DEPENDING ON DFHEIGDI
 17324     ELSE IF DFHEIGDJ EQUAL 11
 17325         GO TO 1620-ACCT-NOTFND
 17326         DEPENDING ON DFHEIGDI
 17327     ELSE IF DFHEIGDJ EQUAL 12
 17328         GO TO 2020-EXIT
 17329         DEPENDING ON DFHEIGDI
 17330     ELSE IF DFHEIGDJ EQUAL 13
 17331         GO TO 2030-EXIT
 17332         DEPENDING ON DFHEIGDI
 17333     ELSE IF DFHEIGDJ EQUAL 14
 17334         GO TO 2040-EXIT
 17335         DEPENDING ON DFHEIGDI
 17336     ELSE IF DFHEIGDJ EQUAL 15
 17337         GO TO 2050-EXIT
 17338         DEPENDING ON DFHEIGDI
 17339     ELSE IF DFHEIGDJ EQUAL 16
 17340         GO TO 2060-CERT-NOTFND
 17341         DEPENDING ON DFHEIGDI
 17342     ELSE IF DFHEIGDJ EQUAL 17
 17343         GO TO 2060-DUPKEY
 17344         DEPENDING ON DFHEIGDI
 17345     ELSE IF DFHEIGDJ EQUAL 18
 17346         GO TO 2070-NOT-FOUND
 17347         DEPENDING ON DFHEIGDI
 17348     ELSE IF DFHEIGDJ EQUAL 19
 17349         GO TO 2070-EXIT
 17350         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 327
* EL131.cbl
 17351     ELSE IF DFHEIGDJ EQUAL 20
 17352         GO TO 2080-EXIT
 17353         DEPENDING ON DFHEIGDI
 17354     ELSE IF DFHEIGDJ EQUAL 21
 17355         GO TO 2400-TRLR-NOTFND,
 17356               2410-EXIT
 17357         DEPENDING ON DFHEIGDI
 17358     ELSE IF DFHEIGDJ EQUAL 22
 17359         GO TO 2425-NINETY-NOTFND,
 17360               2425-NINETY-NOTFND
 17361         DEPENDING ON DFHEIGDI
 17362     ELSE IF DFHEIGDJ EQUAL 23
 17363         GO TO 2430-EXIT,
 17364               2440-EXIT
 17365         DEPENDING ON DFHEIGDI
 17366     ELSE IF DFHEIGDJ EQUAL 24
 17367         GO TO 2440-EXIT
 17368         DEPENDING ON DFHEIGDI
 17369     ELSE IF DFHEIGDJ EQUAL 25
 17370         GO TO 2460-EXIT
 17371         DEPENDING ON DFHEIGDI
 17372     ELSE IF DFHEIGDJ EQUAL 26
 17373         GO TO 2475-EXIT
 17374         DEPENDING ON DFHEIGDI
 17375     ELSE IF DFHEIGDJ EQUAL 27
 17376         GO TO 2650-EXIT
 17377         DEPENDING ON DFHEIGDI
 17378     ELSE IF DFHEIGDJ EQUAL 28
 17379         GO TO 2800-EXIT,
 17380               2800-EXIT
 17381         DEPENDING ON DFHEIGDI
 17382     ELSE IF DFHEIGDJ EQUAL 29
 17383         GO TO 3010-DEL-ACTQ,
 17384               3040-EXIT
 17385         DEPENDING ON DFHEIGDI
 17386     ELSE IF DFHEIGDJ EQUAL 30
 17387         GO TO 3010-NO-ACTIVITY,
 17388               3050-EXIT
 17389         DEPENDING ON DFHEIGDI
 17390     ELSE IF DFHEIGDJ EQUAL 31
 17391         GO TO 3010-CERT-NOT-FOUND
 17392         DEPENDING ON DFHEIGDI
 17393     ELSE IF DFHEIGDJ EQUAL 32
 17394         GO TO 3020-EXIT
 17395         DEPENDING ON DFHEIGDI
 17396     ELSE IF DFHEIGDJ EQUAL 33
 17397         GO TO 3060-EXIT,
 17398               3060-EXIT
 17399         DEPENDING ON DFHEIGDI
 17400     ELSE IF DFHEIGDJ EQUAL 34
 17401         GO TO 5000-TRLR-NOT-FOUND
 17402         DEPENDING ON DFHEIGDI
 17403     ELSE IF DFHEIGDJ EQUAL 35
 17404         GO TO 5000-CERT-NOT-FOUND
 17405         DEPENDING ON DFHEIGDI
 17406     ELSE IF DFHEIGDJ EQUAL 36
 17407         GO TO 7630-END-BROWSE
 17408         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 23-Mar-15 11:05 Page 328
* EL131.cbl
 17409     ELSE IF DFHEIGDJ EQUAL 37
 17410         GO TO 7799-EXIT,
 17411               7799-EXIT
 17412         DEPENDING ON DFHEIGDI
 17413     ELSE IF DFHEIGDJ EQUAL 38
 17414         GO TO 7799-EXIT
 17415         DEPENDING ON DFHEIGDI
 17416     ELSE IF DFHEIGDJ EQUAL 39
 17417         GO TO 7800-NOT-FOUND
 17418         DEPENDING ON DFHEIGDI
 17419     ELSE IF DFHEIGDJ EQUAL 40
 17420         GO TO 8000-NOTE-NOT-FOUND
 17421         DEPENDING ON DFHEIGDI
 17422     ELSE IF DFHEIGDJ EQUAL 41
 17423         GO TO 8990-SEND-TEXT
 17424         DEPENDING ON DFHEIGDI.
 17425     MOVE '9%                    "   ' TO DFHEIV0
 17426     MOVE 'EL131' TO DFHEIV1
 17427     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17428     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       13596     Code:       60560
