* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page   1
* EL162.cbl
* Options: int("EL162.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL162.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL162.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL162.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL162 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/02/95 14:07:28.
     7*                            VMOD=2.015
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*REMARKS.    TRANSACTION - EX17 - RECORD MAIL RECEIVED
    13*            USED TO REVIEW PENDING MAIL AND TO RECORD
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page   2
* EL162.cbl
    14*            INCOMING MAIL.
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    24* 121406    2006081100001  PEMA  ADD RECEIVE DATE EDIT
    25* 051107    2006052500001  AJRA  POPULATE UBY WITH USER ID
    26* 100610    2009122800001  AJRA  BYPASS LETTER W/ RESEND PRINTED D
    27* 102610    2009122800001  AJRA    REPLACE VERIFY W/ STOP DATE
    28* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    29******************************************************************
    30
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page   3
* EL162.cbl
    32 ENVIRONMENT DIVISION.
    33 DATA DIVISION.
    34 WORKING-STORAGE SECTION.
    35 01  DFH-START PIC X(04).
    36 77  FILLER  PIC X(32)  VALUE '********************************'.
    37 77  FILLER  PIC X(32)  VALUE '*    EL162 WORKING STORAGE     *'.
    38 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.015 *********'.
    39
    40*                            COPY ELCSCTM.
    41******************************************************************
    42*                                                                *
    43*                                                                *
    44*                            ELCSCTM                             *
    45*                            VMOD=2.001                          *
    46*                                                                *
    47*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    48*                                                                *
    49******************************************************************
    50 01  SECURITY-MESSAGE.
    51     12  FILLER                          PIC X(30)
    52            VALUE '** LOGIC SECURITY VIOLATION -'.
    53     12  SM-READ                         PIC X(6).
    54     12  FILLER                          PIC X(5)
    55            VALUE ' PGM='.
    56     12  SM-PGM                          PIC X(6).
    57     12  FILLER                          PIC X(5)
    58            VALUE ' OPR='.
    59     12  SM-PROCESSOR-ID                 PIC X(4).
    60     12  FILLER                          PIC X(6)
    61            VALUE ' TERM='.
    62     12  SM-TERMID                       PIC X(4).
    63     12  FILLER                          PIC XX   VALUE SPACE.
    64     12  SM-JUL-DATE                     PIC 9(5).
    65     12  FILLER                          PIC X    VALUE SPACE.
    66     12  SM-TIME                         PIC 99.99.
    67
    68
    69*                            COPY ELCSCRTY.
    70******************************************************************
    71*                                                                *
    72*                                                                *
    73*                            ELCSCRTY                            *
    74*                            VMOD=2.001                          *
    75*                                                                *
    76*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    77*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    78*        SAVED IN PI-SECURITY-ADDRESS.                           *
    79*                                                                *
    80******************************************************************
    81 01  SECURITY-CONTROL.
    82     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    83     12  FILLER                       PIC XX    VALUE 'SC'.
    84     12  SC-CREDIT-CODES.
    85         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    86             20  SC-CREDIT-DISPLAY    PIC X.
    87             20  SC-CREDIT-UPDATE     PIC X.
    88     12  SC-CLAIMS-CODES.
    89         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page   4
* EL162.cbl
    90             20  SC-CLAIMS-DISPLAY    PIC X.
    91             20  SC-CLAIMS-UPDATE     PIC X.
    92
    93 01  WS-DATE-AREA.
    94     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    95     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
    96     05  CURRENT-MINUS1-SAVE PIC XX      VALUE SPACES.
    97
    98 01  STANDARD-AREAS.
    99     12  SC-ITEM                 PIC S9(4)   VALUE +1  COMP.
   100     12  MAP-NAME.
   101         16  MAP-PRE             PIC XX      VALUE 'EL'.
   102         16  MAP-NUMBER          PIC X(4)    VALUE '162A'.
   103         16  FILLER              PIC XX      VALUE SPACES.
   104     12  MAPSET-NAME             PIC X(8)    VALUE 'EL162S'.
   105     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   106     12  TRANS-ID                PIC X(4)    VALUE 'EX17'.
   107     12  PGM-NAME                PIC X(8).
   108     12  TIME-IN                 PIC S9(7).
   109     12  TIME-OUT-R  REDEFINES TIME-IN.
   110         16  FILLER              PIC X.
   111         16  TIME-OUT            PIC 99V99.
   112         16  FILLER              PIC XX.
   113     12  XCTL-005                PIC X(5)    VALUE 'EL005'.
   114     12  XCTL-010                PIC X(5)    VALUE 'EL010'.
   115     12  XCTL-126                PIC X(5)    VALUE 'EL126'.
   116     12  LINK-001                PIC X(5)    VALUE 'EL001'.
   117     12  LINK-004                PIC X(5)    VALUE 'EL004'.
   118     12  LINK-ELDATCV            PIC X(7)    VALUE 'ELDATCV'.
   119     12  THIS-PGM                PIC X(8)    VALUE 'EL162'.
   120     12  PGM-EL141               PIC X(8)    VALUE 'EL141'.
   121     12  PGM-EL132               PIC X(8)    VALUE 'EL132'.
   122     12  PGM-EL150               PIC X(8)    VALUE 'EL150'.
   123     12  ELMSTR-FILE-ID          PIC X(8)    VALUE 'ELMSTR'.
   124     12  ELTRLR-FILE-ID          PIC X(8)    VALUE 'ELTRLR'.
   125     12  ERACCT-FILE-ID          PIC X(8)    VALUE 'ERACCT'.
   126     12  SUB                     PIC S999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page   5
* EL162.cbl
   128 01  ERROR-MESSAGES.
   129     12  ER-ZEROS                PIC X(4)    VALUE '0000'.
   130     12  ER-0004                 PIC X(4)    VALUE '0004'.
   131     12  ER-0008                 PIC X(4)    VALUE '0008'.
   132     12  ER-0029                 PIC X(4)    VALUE '0029'.
   133     12  ER-0050                 PIC X(4)    VALUE '0050'.
   134     12  ER-0021                 PIC X(4)    VALUE '0021'.
   135     12  ER-0042                 PIC X(4)    VALUE '0042'.
   136     12  ER-0066                 PIC X(4)    VALUE '0066'.
   137     12  ER-0067                 PIC X(4)    VALUE '0067'.
   138     12  ER-0070                 PIC X(4)    VALUE '0070'.
   139     12  ER-0133                 PIC X(4)    VALUE '0133'.
   140     12  ER-0168                 PIC X(4)    VALUE '0168'.
   141     12  ER-0172                 PIC X(4)    VALUE '0172'.
   142     12  ER-0179                 PIC X(4)    VALUE '0179'.
   143     12  ER-0318                 PIC X(4)    VALUE '0318'.
   144     12  ER-0319                 PIC X(4)    VALUE '0319'.
   145     12  ER-0320                 PIC X(4)    VALUE '0320'.
   146     12  ER-0321                 PIC X(4)    VALUE '0321'.
   147     12  ER-0322                 PIC X(4)    VALUE '0322'.
   148     12  ER-0514                 PIC X(4)    VALUE '0514'.
   149     12  ER-0539                 PIC X(4)    VALUE '0539'.
   150     12  ER-0895                 PIC X(4)    VALUE '0895'.
   151     12  ER-0896                 PIC X(4)    VALUE '0896'.
   152     12  ER-7839                 PIC X(4)    VALUE '7839'.
   153
   154     12  BIN-CURRENT-DATE        PIC XX.
   155     12  INDX-WORK               PIC 9(4).
   156     12  REC-DATA-SW             PIC X       VALUE ' '.
   157         88  REC-DATA                        VALUE '1'.
   158     12  VER-DATA-SW             PIC X       VALUE ' '.
   159         88  VER-DATA                        VALUE '1'.
   160     12  UNSOL-DATA-SW           PIC X       VALUE ' '.
   161         88  UNSOL-DATA                      VALUE '1'.
   162         88  FILE-DATA                       VALUE '2'.
   163     12  ADDR-TYPE               PIC X.
   164     12  ADDR-SEQ                PIC S9(4) COMP.
   165     12  ACTV-LENGTH             PIC S9(4) COMP VALUE +200.
   166     12  USENT-SAVE              PIC XX    VALUE LOW-VALUES.
   167     12  URECDTE-SAVE            PIC XX    VALUE LOW-VALUES.
   168     12  REC-DATE-SAVE OCCURS 4 TIMES INDEXED BY INDX     PIC XX.
   169     12  STOP-DATE-SAVE OCCURS 4 TIMES INDEXED BY INDX2   PIC XX.
   170     12  DEEDIT-FIELD            PIC X(15).
   171     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   172
   173     12  ACCT-KEY.
   174         16  ACCT-PARTIAL-KEY.
   175             20  ACCT-CO         PIC X.
   176             20  ACCT-CARRIER    PIC X.
   177             20  ACCT-GROUPING   PIC X(6).
   178             20  ACCT-STATE      PIC XX.
   179             20  ACCT-ACCOUNT    PIC X(10).
   180         16  ACCT-EXP-DATE       PIC XX.
   181     12  FILLER                  PIC S9(9)  VALUE +0 COMP.
   182     12  ACCT-SAVE-KEY           PIC X(20).
   183     12  WS-ZIP.
   184         16  WS-ZIP-CODE         PIC X(5).
   185         16  WS-DASH             PIC X     VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page   6
* EL162.cbl
   186         16  WS-ZIP-PLUS4        PIC X(4).
   187     12  WS-CANADIAN-POSTAL-CODES REDEFINES WS-ZIP.
   188         16  WS-CAN-POSTAL-CD-1  PIC X(3).
   189         16  WS-DASH-CAN         PIC X.
   190         16  WS-CAN-POSTAL-CD-2  PIC X(3).
   191         16  WS-CAN-FILLER       PIC X(3).
   192     12  WS-WORK-PHONE           PIC X(10)  VALUE ZEROS.
   193     12  WS-NUMERIC-PHONE REDEFINES WS-WORK-PHONE
   194                                 PIC 9(10).
   195     12  WS-REASON               PIC X(70).
   196
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page   7
* EL162.cbl
   198*                            COPY ELCDATE.
   199******************************************************************
   200*                                                                *
   201*                                                                *
   202*                            ELCDATE.                            *
   203*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   204*                            VMOD=2.003
   205*                                                                *
   206*                                                                *
   207*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   208*                 LENGTH = 200                                   *
   209******************************************************************
   210
   211 01  DATE-CONVERSION-DATA.
   212     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   213     12  DC-OPTION-CODE                PIC X.
   214         88  BIN-TO-GREG                VALUE ' '.
   215         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   216         88  EDIT-GREG-TO-BIN           VALUE '2'.
   217         88  YMD-GREG-TO-BIN            VALUE '3'.
   218         88  MDY-GREG-TO-BIN            VALUE '4'.
   219         88  JULIAN-TO-BIN              VALUE '5'.
   220         88  BIN-PLUS-ELAPSED           VALUE '6'.
   221         88  FIND-CENTURY               VALUE '7'.
   222         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   223         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   224         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   225         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   226         88  JULIAN-TO-BIN-3            VALUE 'C'.
   227         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   228         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   229         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   230         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   231         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   232         88  CHECK-LEAP-YEAR            VALUE 'H'.
   233         88  BIN-3-TO-GREG              VALUE 'I'.
   234         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   235         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   236         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   237         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   238         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   239         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   240         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   241         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   242         88  THREE-CHARACTER-BIN
   243                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   244         88  GREGORIAN-TO-BIN
   245                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   246         88  BIN-TO-GREGORIAN
   247                  VALUES ' ' '1' 'I' '8' 'G'.
   248         88  JULIAN-TO-BINARY
   249                  VALUES '5' 'C' 'E' 'F'.
   250     12  DC-ERROR-CODE                 PIC X.
   251         88  NO-CONVERSION-ERROR        VALUE ' '.
   252         88  DATE-CONVERSION-ERROR
   253                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   254         88  DATE-IS-ZERO               VALUE '1'.
   255         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page   8
* EL162.cbl
   256         88  DATE-IS-INVALID            VALUE '3'.
   257         88  DATE1-GREATER-DATE2        VALUE '4'.
   258         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   259         88  DATE-INVALID-OPTION        VALUE '9'.
   260         88  INVALID-CENTURY            VALUE 'A'.
   261         88  ONLY-CENTURY               VALUE 'B'.
   262         88  ONLY-LEAP-YEAR             VALUE 'C'.
   263         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   264     12  DC-END-OF-MONTH               PIC X.
   265         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   266     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   267         88  USE-NORMAL-PROCESS         VALUE ' '.
   268         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   269         88  ADJUST-UP-100-YRS          VALUE '2'.
   270     12  FILLER                        PIC X.
   271     12  DC-CONVERSION-DATES.
   272         16  DC-BIN-DATE-1             PIC XX.
   273         16  DC-BIN-DATE-2             PIC XX.
   274         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   275         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   276                       DC-GREG-DATE-1-EDIT.
   277             20  DC-EDIT1-MONTH        PIC 99.
   278             20  SLASH1-1              PIC X.
   279             20  DC-EDIT1-DAY          PIC 99.
   280             20  SLASH1-2              PIC X.
   281             20  DC-EDIT1-YEAR         PIC 99.
   282         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   283         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   284                     DC-GREG-DATE-2-EDIT.
   285             20  DC-EDIT2-MONTH        PIC 99.
   286             20  SLASH2-1              PIC X.
   287             20  DC-EDIT2-DAY          PIC 99.
   288             20  SLASH2-2              PIC X.
   289             20  DC-EDIT2-YEAR         PIC 99.
   290         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   291         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   292                     DC-GREG-DATE-1-YMD.
   293             20  DC-YMD-YEAR           PIC 99.
   294             20  DC-YMD-MONTH          PIC 99.
   295             20  DC-YMD-DAY            PIC 99.
   296         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   297         16  DC-GREG-DATE-1-MDY-R REDEFINES
   298                      DC-GREG-DATE-1-MDY.
   299             20  DC-MDY-MONTH          PIC 99.
   300             20  DC-MDY-DAY            PIC 99.
   301             20  DC-MDY-YEAR           PIC 99.
   302         16  DC-GREG-DATE-1-ALPHA.
   303             20  DC-ALPHA-MONTH        PIC X(10).
   304             20  DC-ALPHA-DAY          PIC 99.
   305             20  FILLER                PIC XX.
   306             20  DC-ALPHA-CENTURY.
   307                 24 DC-ALPHA-CEN-N     PIC 99.
   308             20  DC-ALPHA-YEAR         PIC 99.
   309         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   310         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   311         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   312         16  DC-JULIAN-DATE            PIC 9(05).
   313         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page   9
* EL162.cbl
   314                                       PIC 9(05).
   315         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   316             20  DC-JULIAN-YEAR        PIC 99.
   317             20  DC-JULIAN-DAYS        PIC 999.
   318         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   319         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   320         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   321     12  DATE-CONVERSION-VARIBLES.
   322         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   323         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   324             20  FILLER                PIC 9(3).
   325             20  HOLD-CEN-1-CCYY.
   326                 24  HOLD-CEN-1-CC     PIC 99.
   327                 24  HOLD-CEN-1-YY     PIC 99.
   328             20  HOLD-CEN-1-MO         PIC 99.
   329             20  HOLD-CEN-1-DA         PIC 99.
   330         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   331             20  HOLD-CEN-1-R-MO       PIC 99.
   332             20  HOLD-CEN-1-R-DA       PIC 99.
   333             20  HOLD-CEN-1-R-CCYY.
   334                 24  HOLD-CEN-1-R-CC   PIC 99.
   335                 24  HOLD-CEN-1-R-YY   PIC 99.
   336             20  FILLER                PIC 9(3).
   337         16  HOLD-CENTURY-1-X.
   338             20  FILLER                PIC X(3)  VALUE SPACES.
   339             20  HOLD-CEN-1-X-CCYY.
   340                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   341                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   342             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   343             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   344         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   345             20  HOLD-CEN-1-R-X-MO     PIC XX.
   346             20  HOLD-CEN-1-R-X-DA     PIC XX.
   347             20  HOLD-CEN-1-R-X-CCYY.
   348                 24  HOLD-CEN-1-R-X-CC PIC XX.
   349                 24  HOLD-CEN-1-R-X-YY PIC XX.
   350             20  FILLER                PIC XXX.
   351         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   352         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   353         16  DC-JULIAN-DATE-1          PIC 9(07).
   354         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   355             20  DC-JULIAN-1-CCYY.
   356                 24  DC-JULIAN-1-CC    PIC 99.
   357                 24  DC-JULIAN-1-YR    PIC 99.
   358             20  DC-JULIAN-DA-1        PIC 999.
   359         16  DC-JULIAN-DATE-2          PIC 9(07).
   360         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   361             20  DC-JULIAN-2-CCYY.
   362                 24  DC-JULIAN-2-CC    PIC 99.
   363                 24  DC-JULIAN-2-YR    PIC 99.
   364             20  DC-JULIAN-DA-2        PIC 999.
   365         16  DC-GREG-DATE-A-EDIT.
   366             20  DC-EDITA-MONTH        PIC 99.
   367             20  SLASHA-1              PIC X VALUE '/'.
   368             20  DC-EDITA-DAY          PIC 99.
   369             20  SLASHA-2              PIC X VALUE '/'.
   370             20  DC-EDITA-CCYY.
   371                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  10
* EL162.cbl
   372                 24  DC-EDITA-YEAR     PIC 99.
   373         16  DC-GREG-DATE-B-EDIT.
   374             20  DC-EDITB-MONTH        PIC 99.
   375             20  SLASHB-1              PIC X VALUE '/'.
   376             20  DC-EDITB-DAY          PIC 99.
   377             20  SLASHB-2              PIC X VALUE '/'.
   378             20  DC-EDITB-CCYY.
   379                 24  DC-EDITB-CENT     PIC 99.
   380                 24  DC-EDITB-YEAR     PIC 99.
   381         16  DC-GREG-DATE-CYMD         PIC 9(08).
   382         16  DC-GREG-DATE-CYMD-R REDEFINES
   383                              DC-GREG-DATE-CYMD.
   384             20  DC-CYMD-CEN           PIC 99.
   385             20  DC-CYMD-YEAR          PIC 99.
   386             20  DC-CYMD-MONTH         PIC 99.
   387             20  DC-CYMD-DAY           PIC 99.
   388         16  DC-GREG-DATE-MDCY         PIC 9(08).
   389         16  DC-GREG-DATE-MDCY-R REDEFINES
   390                              DC-GREG-DATE-MDCY.
   391             20  DC-MDCY-MONTH         PIC 99.
   392             20  DC-MDCY-DAY           PIC 99.
   393             20  DC-MDCY-CEN           PIC 99.
   394             20  DC-MDCY-YEAR          PIC 99.
   395    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   396        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   397    12  DC-EL310-DATE                  PIC X(21).
   398    12  FILLER                         PIC X(28).
   399
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  11
* EL162.cbl
   401*                            COPY ELCLOGOF.
   402******************************************************************
   403*                                                                *
   404*                                                                *
   405*                            ELCLOGOF.                           *
   406*                            VMOD=2.001                          *
   407*                                                                *
   408*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   409*                                                                *
   410******************************************************************
   411 01  CLASIC-LOGOFF.
   412     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   413     12  LOGOFF-TEXT.
   414         16  FILLER          PIC X(5)    VALUE SPACES.
   415         16  LOGOFF-MSG.
   416             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   417             20  FILLER      PIC X       VALUE SPACES.
   418             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   419         16  FILLER          PIC X(80)
   420           VALUE '* YOU ARE NOW LOGGED OFF'.
   421         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   422         16  FILLER          PIC X       VALUE QUOTE.
   423         16  LOGOFF-SYS-MSG  PIC X(17)
   424           VALUE 'S CLAS-IC SYSTEM '.
   425     12  TEXT-MESSAGES.
   426         16  UNACCESS-MSG    PIC X(29)
   427             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   428         16  PGMIDERR-MSG    PIC X(17)
   429             VALUE 'PROGRAM NOT FOUND'.
   430
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  12
* EL162.cbl
   432*                            COPY ELCATTR.
   433******************************************************************
   434*                                                                *
   435*                            ELCATTR.                            *
   436*                            VMOD=2.001                          *
   437*                                                                *
   438*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   439*                                                                *
   440*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   441*                                                                *
   442*                   POS 1   P=PROTECTED                          *
   443*                           U=UNPROTECTED                        *
   444*                           S=ASKIP                              *
   445*                   POS 2   A=ALPHA/NUMERIC                      *
   446*                           N=NUMERIC                            *
   447*                   POS 3   N=NORMAL                             *
   448*                           B=BRIGHT                             *
   449*                           D=DARK                               *
   450*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   451*                           OF=MODIFIED DATA TAG OFF             *
   452*                                                                *
   453*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   454******************************************************************
   455 01  ATTRIBUTE-LIST.
   456     12  AL-PABOF            PIC X       VALUE 'Y'.
   457     12  AL-PABON            PIC X       VALUE 'Z'.
   458     12  AL-PADOF            PIC X       VALUE '%'.
   459     12  AL-PADON            PIC X       VALUE '_'.
   460     12  AL-PANOF            PIC X       VALUE '-'.
   461     12  AL-PANON            PIC X       VALUE '/'.
   462     12  AL-SABOF            PIC X       VALUE '8'.
   463     12  AL-SABON            PIC X       VALUE '9'.
   464     12  AL-SADOF            PIC X       VALUE '@'.
   465     12  AL-SADON            PIC X       VALUE QUOTE.
   466     12  AL-SANOF            PIC X       VALUE '0'.
   467     12  AL-SANON            PIC X       VALUE '1'.
   468     12  AL-UABOF            PIC X       VALUE 'H'.
   469     12  AL-UABON            PIC X       VALUE 'I'.
   470     12  AL-UADOF            PIC X       VALUE '<'.
   471     12  AL-UADON            PIC X       VALUE '('.
   472     12  AL-UANOF            PIC X       VALUE ' '.
   473     12  AL-UANON            PIC X       VALUE 'A'.
   474     12  AL-UNBOF            PIC X       VALUE 'Q'.
   475     12  AL-UNBON            PIC X       VALUE 'R'.
   476     12  AL-UNDOF            PIC X       VALUE '*'.
   477     12  AL-UNDON            PIC X       VALUE ')'.
   478     12  AL-UNNOF            PIC X       VALUE '&'.
   479     12  AL-UNNON            PIC X       VALUE 'J'.
   480
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  13
* EL162.cbl
   482*                            COPY ELCEMIB.
   483******************************************************************
   484*                                                                *
   485*                                                                *
   486*                            ELCEMIB.                            *
   487*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   488*                            VMOD=2.005                          *
   489*                                                                *
   490*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   491*                                                                *
   492******************************************************************
   493 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   494     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   495     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   496     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   497     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   498     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   499     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   500     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   501     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   502     12  EMI-SWITCH1             PIC X        VALUE '1'.
   503         88  EMI-NO-ERRORS                    VALUE '1'.
   504         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   505         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   506     12  EMI-SWITCH2             PIC X        VALUE '1'.
   507         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   508     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   509         88  EMI-AREA1-EMPTY                  VALUE '1'.
   510         88  EMI-AREA1-FULL                   VALUE '2'.
   511     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   512         88  EMI-AREA2-EMPTY                  VALUE '1'.
   513         88  EMI-AREA2-FULL                   VALUE '2'.
   514     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   515         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   516         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   517         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   518         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   519         88  EMI-BYPASS-FATALS                VALUE 'X'.
   520     12  EMI-ERROR-LINES.
   521         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   522         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   523         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   524         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   525             20  EMI-ERR-CODES OCCURS 10 TIMES.
   526                 24  EMI-ERR-NUM         PIC X(4).
   527                 24  EMI-FILLER          PIC X.
   528                 24  EMI-SEV             PIC X.
   529                 24  FILLER              PIC X.
   530             20  FILLER                  PIC X(02).
   531     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   532         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   533             20  EMI-ERROR-NUMBER    PIC X(4).
   534             20  EMI-FILL            PIC X.
   535             20  EMI-SEVERITY        PIC X.
   536             20  FILLER              PIC X.
   537             20  EMI-ERROR-TEXT.
   538                 24  EMI-TEXT-VARIABLE   PIC X(10).
   539                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  14
* EL162.cbl
   540     12  EMI-SEVERITY-SAVE           PIC X.
   541         88  EMI-NOTE                    VALUE 'N'.
   542         88  EMI-WARNING                 VALUE 'W'.
   543         88  EMI-FORCABLE                VALUE 'F'.
   544         88  EMI-FATAL                   VALUE 'X'.
   545     12  EMI-MESSAGE-FLAG            PIC X.
   546         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   547         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   548     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   549     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   550         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   551         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   552         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   553     12  emi-claim-no                pic x(7).
   554     12  emi-claim-type              pic x(6).
   555     12  FILLER                      PIC X(124)  VALUE SPACES.
   556     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   557     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   558     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   559     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  15
* EL162.cbl
   561*                            COPY ELCINTF.
   562******************************************************************
   563*                                                                *
   564*                                                                *
   565*                            ELCINTF.                            *
   566*                            VMOD=2.017                          *
   567*                                                                *
   568*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   569*                                                                *
   570*       LENGTH = 1024                                            *
   571*                                                                *
   572******************************************************************
   573*                   C H A N G E   L O G
   574*
   575* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   576*-----------------------------------------------------------------
   577*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   578* EFFECTIVE    NUMBER
   579*-----------------------------------------------------------------
   580* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   581******************************************************************
   582 01  PROGRAM-INTERFACE-BLOCK.
   583     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   584     12  PI-CALLING-PROGRAM              PIC X(8).
   585     12  PI-SAVED-PROGRAM-1              PIC X(8).
   586     12  PI-SAVED-PROGRAM-2              PIC X(8).
   587     12  PI-SAVED-PROGRAM-3              PIC X(8).
   588     12  PI-SAVED-PROGRAM-4              PIC X(8).
   589     12  PI-SAVED-PROGRAM-5              PIC X(8).
   590     12  PI-SAVED-PROGRAM-6              PIC X(8).
   591     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   592     12  PI-COMPANY-ID                   PIC XXX.
   593     12  PI-COMPANY-CD                   PIC X.
   594
   595     12  PI-COMPANY-PASSWORD             PIC X(8).
   596
   597     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   598
   599     12  PI-CONTROL-IN-PROGRESS.
   600         16  PI-CARRIER                  PIC X.
   601         16  PI-GROUPING                 PIC X(6).
   602         16  PI-STATE                    PIC XX.
   603         16  PI-ACCOUNT                  PIC X(10).
   604         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   605                                         PIC X(10).
   606         16  PI-CLAIM-CERT-GRP.
   607             20  PI-CLAIM-NO             PIC X(7).
   608             20  PI-CERT-NO.
   609                 25  PI-CERT-PRIME       PIC X(10).
   610                 25  PI-CERT-SFX         PIC X.
   611             20  PI-CERT-EFF-DT          PIC XX.
   612         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   613             20  PI-PLAN-CODE            PIC X(2).
   614             20  PI-REVISION-NUMBER      PIC X(3).
   615             20  PI-PLAN-EFF-DT          PIC X(2).
   616             20  PI-PLAN-EXP-DT          PIC X(2).
   617             20  FILLER                  PIC X(11).
   618         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  16
* EL162.cbl
   619             20  PI-OE-REFERENCE-1.
   620                 25  PI-OE-REF-1-PRIME   PIC X(18).
   621                 25  PI-OE-REF-1-SUFF    PIC XX.
   622
   623     12  PI-SESSION-IN-PROGRESS          PIC X.
   624         88  CLAIM-SESSION                   VALUE '1'.
   625         88  CREDIT-SESSION                  VALUE '2'.
   626         88  WARRANTY-SESSION                VALUE '3'.
   627         88  MORTGAGE-SESSION                VALUE '4'.
   628         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   629
   630
   631*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   632
   633     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   634     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   635
   636     12  PI-CREDIT-USER                  PIC X.
   637         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   638         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   639
   640     12  PI-CLAIM-USER                   PIC X.
   641         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   642         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   643
   644     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   645         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   646         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   647         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   648         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   649         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   650
   651     12  PI-PROCESSOR-ID                 PIC X(4).
   652
   653     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   654
   655     12  PI-MEMBER-CAPTION               PIC X(10).
   656
   657     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   658         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   659
   660     12  PI-LIFE-OVERRIDE-L1             PIC X.
   661     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   662     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   663     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   664
   665     12  PI-AH-OVERRIDE-L1               PIC X.
   666     12  PI-AH-OVERRIDE-L2               PIC XX.
   667     12  PI-AH-OVERRIDE-L6               PIC X(6).
   668     12  PI-AH-OVERRIDE-L12              PIC X(12).
   669
   670     12  PI-NEW-SYSTEM                   PIC X(2).
   671
   672     12  PI-PRIMARY-CERT-NO              PIC X(11).
   673     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   674         88  PI-USES-PAID-TO                 VALUE '1'.
   675     12  PI-CRDTCRD-SYSTEM.
   676         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  17
* EL162.cbl
   677             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   678             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   679         16  PI-CC-MONTH-END-DT          PIC XX.
   680     12  PI-PROCESSOR-PRINTER            PIC X(4).
   681
   682     12  PI-OE-REFERENCE-2.
   683         16  PI-OE-REF-2-PRIME           PIC X(10).
   684         16  PI-OE-REF-2-SUFF            PIC X.
   685
   686     12  PI-REM-TRM-CALC-OPTION          PIC X.
   687
   688     12  PI-LANGUAGE-TYPE                PIC X.
   689             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   690             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   691             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   692
   693     12  PI-POLICY-LINKAGE-IND           PIC X.
   694         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   695         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   696                                                   LOW-VALUES.
   697
   698     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   699     12  PI-CLAIM-PW-SESSION             PIC X(1).
   700         88  PI-CLAIM-CREDIT                 VALUE '1'.
   701         88  PI-CLAIM-CONVEN                 VALUE '2'.
   702
   703     12  PI-PROCESSOR-CSR-IND            PIC X.
   704         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   705         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   706
   707     12  FILLER                          PIC X(3).
   708
   709     12  PI-SYSTEM-LEVEL                 PIC X(145).
   710
   711     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   712         PI-SYSTEM-LEVEL.
   713
   714         16  PI-ENTRY-CODES.
   715             20  PI-ENTRY-CD-1           PIC X.
   716             20  PI-ENTRY-CD-2           PIC X.
   717
   718         16  PI-RETURN-CODES.
   719             20  PI-RETURN-CD-1          PIC X.
   720             20  PI-RETURN-CD-2          PIC X.
   721
   722         16  PI-UPDATE-STATUS-SAVE.
   723             20  PI-UPDATE-BY            PIC X(4).
   724             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   725
   726         16  PI-LOWER-CASE-LETTERS       PIC X.
   727             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   728
   729*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   730*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   731*            88  CARRIER-CLM-CNTL            VALUE '2'.
   732
   733         16  PI-CERT-ACCESS-CONTROL      PIC X.
   734             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  18
* EL162.cbl
   735             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   736             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   737             88  ACCNT-CNTL                  VALUE '3'.
   738             88  CARR-ACCNT-CNTL             VALUE '4'.
   739
   740         16  PI-PROCESSOR-CAP-LIST.
   741             20  PI-SYSTEM-CONTROLS.
   742                24 PI-SYSTEM-DISPLAY     PIC X.
   743                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   744                24 PI-SYSTEM-MODIFY      PIC X.
   745                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   746             20  FILLER                  PIC XX.
   747             20  PI-DISPLAY-CAP          PIC X.
   748                 88  DISPLAY-CAP             VALUE 'Y'.
   749             20  PI-MODIFY-CAP           PIC X.
   750                 88  MODIFY-CAP              VALUE 'Y'.
   751             20  PI-MSG-AT-LOGON-CAP     PIC X.
   752                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   753             20  PI-FORCE-CAP            PIC X.
   754                 88  FORCE-CAP               VALUE 'Y'.
   755
   756         16  PI-PROGRAM-CONTROLS.
   757             20  PI-PGM-PRINT-OPT        PIC X.
   758             20  PI-PGM-FORMAT-OPT       PIC X.
   759             20  PI-PGM-PROCESS-OPT      PIC X.
   760             20  PI-PGM-TOTALS-OPT       PIC X.
   761
   762         16  PI-HELP-INTERFACE.
   763             20  PI-LAST-ERROR-NO        PIC X(4).
   764             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   765
   766         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   767             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   768
   769         16  PI-CR-CONTROL-IN-PROGRESS.
   770             20  PI-CR-CARRIER           PIC X.
   771             20  PI-CR-GROUPING          PIC X(6).
   772             20  PI-CR-STATE             PIC XX.
   773             20  PI-CR-ACCOUNT           PIC X(10).
   774             20  PI-CR-FIN-RESP          PIC X(10).
   775             20  PI-CR-TYPE              PIC X.
   776
   777         16  PI-CR-BATCH-NUMBER          PIC X(6).
   778
   779         16  PI-CR-MONTH-END-DT          PIC XX.
   780
   781         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   782             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   783             88  PI-ZERO-CARRIER             VALUE '1'.
   784             88  PI-ZERO-GROUPING            VALUE '2'.
   785             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   786
   787         16  PI-CARRIER-SECURITY         PIC X.
   788             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   789
   790         16  PI-ACCOUNT-SECURITY         PIC X(10).
   791             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   792             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  19
* EL162.cbl
   793
   794         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   795             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   796                                         INDEXED BY PI-ACCESS-NDX
   797                                         PIC X.
   798
   799         16  PI-GA-BILLING-CONTROL       PIC X.
   800             88  PI-GA-BILLING               VALUE '1'.
   801
   802         16  PI-MAIL-PROCESSING          PIC X.
   803             88  PI-MAIL-YES                 VALUE 'Y'.
   804
   805         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   806
   807         16  PI-AR-SYSTEM.
   808             20  PI-AR-PROCESSING-CNTL   PIC X.
   809                 88  PI-AR-PROCESSING        VALUE 'Y'.
   810             20  PI-AR-SUMMARY-CODE      PIC X(6).
   811             20  PI-AR-MONTH-END-DT      PIC XX.
   812
   813         16  PI-MP-SYSTEM.
   814             20  PI-MORTGAGE-USER            PIC X.
   815                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   816                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   817             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   818                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   819                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   820                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   821                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   822                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   823             20  PI-MP-MONTH-END-DT          PIC XX.
   824             20  PI-MP-REFERENCE-NO.
   825                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   826                 24  PI-MP-REFERENCE-SFX     PIC XX.
   827
   828         16  PI-LABEL-CONTROL            PIC X(01).
   829             88  PI-CREATE-LABELS                    VALUE 'Y'.
   830             88  PI-BYPASS-LABELS                    VALUE 'N'.
   831
   832         16  PI-BILL-GROUPING-CODE       PIC X(01).
   833             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   834
   835         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   836             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   837             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   838
   839         16  FILLER                      PIC X(14).
   840
   841     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   842******************************************************************
   843     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   844         16  PI-NEXT-TRLR-SUB    PIC S999  COMP-3.
   845         16  PI-ACTV-SAVE        PIC X(20).
   846         16  PI-ACTV-SAVE-SEQ    PIC S9(04) COMP.
   847         16  PI-ACTV-KEY.
   848           18  PI-ACTV-PARTIAL.
   849             20  PI-ACTV-COMP-CD     PIC X.
   850             20  PI-ACTV-CARRIER     PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  20
* EL162.cbl
   851             20  PI-ACTV-CLAIM       PIC X(7).
   852             20  PI-ACTV-CERT-NO.
   853                 22  PI-ACTV-CERT-NO-PRIME PIC X(10).
   854                 22  PI-ACTV-CERT-NO-SUFX  PIC X.
   855           18  PI-ACTV-SEQ           PIC S9(4) COMP.
   856
   857         16  PI-DISPLAYED-TRAILER-CODES.
   858             18  PI-TRLRS OCCURS 50 TIMES    PIC S9(4) COMP.
   859         16  PI-CLAM-KEY.
   860             20  PI-CLAM-COMP-CD     PIC X.
   861             20  PI-CLAM-CARRIER     PIC X.
   862             20  PI-CLAM-CLAIM       PIC X(7).
   863             20  PI-CLAM-CERT-NO.
   864                 24  PI-CLAM-CERT-NO-PRIME  PIC X(10).
   865                 24  PI-CLAM-CERT-NO-SUFX   PIC X.
   866         16  PI-DMD-FORCE-ERROR      PIC X.
   867             88  PI-DMD-FORCED             VALUE 'X'.
   868         16  FILLER                  PIC X(473).
   869
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  21
* EL162.cbl
   871*                            COPY ELCAID.
   872******************************************************************
   873*                                                                *
   874*                            ELCAID.                             *
   875*                            VMOD=2.001                          *
   876*                                                                *
   877*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   878*                                                                *
   879*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   880*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   881******************************************************************
   882
   883 01  DFHAID.
   884   02  DFHNULL   PIC  X  VALUE  ' '.
   885   02  DFHENTER  PIC  X  VALUE  QUOTE.
   886   02  DFHCLEAR  PIC  X  VALUE  '_'.
   887   02  DFHPEN    PIC  X  VALUE  '='.
   888   02  DFHOPID   PIC  X  VALUE  'W'.
   889   02  DFHPA1    PIC  X  VALUE  '%'.
   890   02  DFHPA2    PIC  X  VALUE  '>'.
   891   02  DFHPA3    PIC  X  VALUE  ','.
   892   02  DFHPF1    PIC  X  VALUE  '1'.
   893   02  DFHPF2    PIC  X  VALUE  '2'.
   894   02  DFHPF3    PIC  X  VALUE  '3'.
   895   02  DFHPF4    PIC  X  VALUE  '4'.
   896   02  DFHPF5    PIC  X  VALUE  '5'.
   897   02  DFHPF6    PIC  X  VALUE  '6'.
   898   02  DFHPF7    PIC  X  VALUE  '7'.
   899   02  DFHPF8    PIC  X  VALUE  '8'.
   900   02  DFHPF9    PIC  X  VALUE  '9'.
   901   02  DFHPF10   PIC  X  VALUE  ':'.
   902   02  DFHPF11   PIC  X  VALUE  '#'.
   903   02  DFHPF12   PIC  X  VALUE  '@'.
   904   02  DFHPF13   PIC  X  VALUE  'A'.
   905   02  DFHPF14   PIC  X  VALUE  'B'.
   906   02  DFHPF15   PIC  X  VALUE  'C'.
   907   02  DFHPF16   PIC  X  VALUE  'D'.
   908   02  DFHPF17   PIC  X  VALUE  'E'.
   909   02  DFHPF18   PIC  X  VALUE  'F'.
   910   02  DFHPF19   PIC  X  VALUE  'G'.
   911   02  DFHPF20   PIC  X  VALUE  'H'.
   912   02  DFHPF21   PIC  X  VALUE  'I'.
   913*00039    02  DFHPF22   PIC  X  VALUE  ''.
   914   02  DFHPF22   PIC  X  VALUE  '['.
   915   02  DFHPF23   PIC  X  VALUE  '.'.
   916   02  DFHPF24   PIC  X  VALUE  '<'.
   917   02  DFHMSRE   PIC  X  VALUE  'X'.
   918   02  DFHSTRF   PIC  X  VALUE  'h'.
   919   02  DFHTRIG   PIC  X  VALUE  '"'.
   920 01  FILLER    REDEFINES DFHAID.
   921     12  FILLER              PIC X(8).
   922     12  PF-VALUES           PIC X       OCCURS 2.
   923
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  22
* EL162.cbl
   925*                            COPY EL162S.
   926 01  EL162AI.
   927     05  FILLER            PIC  X(0012).
   928*    -------------------------------
   929     05  RUNDTEL PIC S9(0004) COMP.
   930     05  RUNDTEF PIC  X(0001).
   931     05  FILLER REDEFINES RUNDTEF.
   932         10  RUNDTEA PIC  X(0001).
   933     05  RUNDTEI PIC  X(0008).
   934*    -------------------------------
   935     05  RUNTIMEL PIC S9(0004) COMP.
   936     05  RUNTIMEF PIC  X(0001).
   937     05  FILLER REDEFINES RUNTIMEF.
   938         10  RUNTIMEA PIC  X(0001).
   939     05  RUNTIMEI PIC  X(0005).
   940*    -------------------------------
   941     05  CLAIMNOL PIC S9(0004) COMP.
   942     05  CLAIMNOF PIC  X(0001).
   943     05  FILLER REDEFINES CLAIMNOF.
   944         10  CLAIMNOA PIC  X(0001).
   945     05  CLAIMNOI PIC  X(0007).
   946*    -------------------------------
   947     05  TYPEL PIC S9(0004) COMP.
   948     05  TYPEF PIC  X(0001).
   949     05  FILLER REDEFINES TYPEF.
   950         10  TYPEA PIC  X(0001).
   951     05  TYPEI PIC  X(0006).
   952*    -------------------------------
   953     05  CARRL PIC S9(0004) COMP.
   954     05  CARRF PIC  X(0001).
   955     05  FILLER REDEFINES CARRF.
   956         10  CARRA PIC  X(0001).
   957     05  CARRI PIC  X(0001).
   958*    -------------------------------
   959     05  CERTNOL PIC S9(0004) COMP.
   960     05  CERTNOF PIC  X(0001).
   961     05  FILLER REDEFINES CERTNOF.
   962         10  CERTNOA PIC  X(0001).
   963     05  CERTNOI PIC  X(0011).
   964*    -------------------------------
   965     05  LASTNMEL PIC S9(0004) COMP.
   966     05  LASTNMEF PIC  X(0001).
   967     05  FILLER REDEFINES LASTNMEF.
   968         10  LASTNMEA PIC  X(0001).
   969     05  LASTNMEI PIC  X(0015).
   970*    -------------------------------
   971     05  FILEL PIC S9(0004) COMP.
   972     05  FILEF PIC  X(0001).
   973     05  FILLER REDEFINES FILEF.
   974         10  FILEA PIC  X(0001).
   975     05  FILEI PIC  X(0004).
   976*    -------------------------------
   977     05  RECDTE1L PIC S9(0004) COMP.
   978     05  RECDTE1F PIC  X(0001).
   979     05  FILLER REDEFINES RECDTE1F.
   980         10  RECDTE1A PIC  X(0001).
   981     05  RECDTE1I PIC  X(0008).
   982*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  23
* EL162.cbl
   983     05  STOPDT1L PIC S9(0004) COMP.
   984     05  STOPDT1F PIC  X(0001).
   985     05  FILLER REDEFINES STOPDT1F.
   986         10  STOPDT1A PIC  X(0001).
   987     05  STOPDT1I PIC  X(0008).
   988*    -------------------------------
   989     05  SENT1L PIC S9(0004) COMP.
   990     05  SENT1F PIC  X(0001).
   991     05  FILLER REDEFINES SENT1F.
   992         10  SENT1A PIC  X(0001).
   993     05  SENT1I PIC  X(0008).
   994*    -------------------------------
   995     05  BY1L PIC S9(0004) COMP.
   996     05  BY1F PIC  X(0001).
   997     05  FILLER REDEFINES BY1F.
   998         10  BY1A PIC  X(0001).
   999     05  BY1I PIC  X(0004).
  1000*    -------------------------------
  1001     05  RESEND1L PIC S9(0004) COMP.
  1002     05  RESEND1F PIC  X(0001).
  1003     05  FILLER REDEFINES RESEND1F.
  1004         10  RESEND1A PIC  X(0001).
  1005     05  RESEND1I PIC  X(0008).
  1006*    -------------------------------
  1007     05  FOLLOW1L PIC S9(0004) COMP.
  1008     05  FOLLOW1F PIC  X(0001).
  1009     05  FILLER REDEFINES FOLLOW1F.
  1010         10  FOLLOW1A PIC  X(0001).
  1011     05  FOLLOW1I PIC  X(0008).
  1012*    -------------------------------
  1013     05  FORM1L PIC S9(0004) COMP.
  1014     05  FORM1F PIC  X(0001).
  1015     05  FILLER REDEFINES FORM1F.
  1016         10  FORM1A PIC  X(0001).
  1017     05  FORM1I PIC  X(0004).
  1018*    -------------------------------
  1019     05  TO1L PIC S9(0004) COMP.
  1020     05  TO1F PIC  X(0001).
  1021     05  FILLER REDEFINES TO1F.
  1022         10  TO1A PIC  X(0001).
  1023     05  TO1I PIC  X(0008).
  1024*    -------------------------------
  1025     05  ARCH1L PIC S9(0004) COMP.
  1026     05  ARCH1F PIC  X(0001).
  1027     05  FILLER REDEFINES ARCH1F.
  1028         10  ARCH1A PIC  X(0001).
  1029     05  ARCH1I PIC  X(0008).
  1030*    -------------------------------
  1031     05  TRLR1L PIC S9(0004) COMP.
  1032     05  TRLR1F PIC  X(0001).
  1033     05  FILLER REDEFINES TRLR1F.
  1034         10  TRLR1A PIC  X(0001).
  1035     05  TRLR1I PIC  X(0004).
  1036*    -------------------------------
  1037     05  TYPE1L PIC S9(0004) COMP.
  1038     05  TYPE1F PIC  X(0001).
  1039     05  FILLER REDEFINES TYPE1F.
  1040         10  TYPE1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  24
* EL162.cbl
  1041     05  TYPE1I PIC  X(0001).
  1042*    -------------------------------
  1043     05  RE1L PIC S9(0004) COMP.
  1044     05  RE1F PIC  X(0001).
  1045     05  FILLER REDEFINES RE1F.
  1046         10  RE1A PIC  X(0001).
  1047     05  RE1I PIC  X(0070).
  1048*    -------------------------------
  1049     05  RECDTE2L PIC S9(0004) COMP.
  1050     05  RECDTE2F PIC  X(0001).
  1051     05  FILLER REDEFINES RECDTE2F.
  1052         10  RECDTE2A PIC  X(0001).
  1053     05  RECDTE2I PIC  X(0008).
  1054*    -------------------------------
  1055     05  STOPDT2L PIC S9(0004) COMP.
  1056     05  STOPDT2F PIC  X(0001).
  1057     05  FILLER REDEFINES STOPDT2F.
  1058         10  STOPDT2A PIC  X(0001).
  1059     05  STOPDT2I PIC  X(0008).
  1060*    -------------------------------
  1061     05  SENT2L PIC S9(0004) COMP.
  1062     05  SENT2F PIC  X(0001).
  1063     05  FILLER REDEFINES SENT2F.
  1064         10  SENT2A PIC  X(0001).
  1065     05  SENT2I PIC  X(0008).
  1066*    -------------------------------
  1067     05  BY2L PIC S9(0004) COMP.
  1068     05  BY2F PIC  X(0001).
  1069     05  FILLER REDEFINES BY2F.
  1070         10  BY2A PIC  X(0001).
  1071     05  BY2I PIC  X(0004).
  1072*    -------------------------------
  1073     05  RESEND2L PIC S9(0004) COMP.
  1074     05  RESEND2F PIC  X(0001).
  1075     05  FILLER REDEFINES RESEND2F.
  1076         10  RESEND2A PIC  X(0001).
  1077     05  RESEND2I PIC  X(0008).
  1078*    -------------------------------
  1079     05  FOLLOW2L PIC S9(0004) COMP.
  1080     05  FOLLOW2F PIC  X(0001).
  1081     05  FILLER REDEFINES FOLLOW2F.
  1082         10  FOLLOW2A PIC  X(0001).
  1083     05  FOLLOW2I PIC  X(0008).
  1084*    -------------------------------
  1085     05  FORM2L PIC S9(0004) COMP.
  1086     05  FORM2F PIC  X(0001).
  1087     05  FILLER REDEFINES FORM2F.
  1088         10  FORM2A PIC  X(0001).
  1089     05  FORM2I PIC  X(0004).
  1090*    -------------------------------
  1091     05  TO2L PIC S9(0004) COMP.
  1092     05  TO2F PIC  X(0001).
  1093     05  FILLER REDEFINES TO2F.
  1094         10  TO2A PIC  X(0001).
  1095     05  TO2I PIC  X(0008).
  1096*    -------------------------------
  1097     05  ARCH2L PIC S9(0004) COMP.
  1098     05  ARCH2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  25
* EL162.cbl
  1099     05  FILLER REDEFINES ARCH2F.
  1100         10  ARCH2A PIC  X(0001).
  1101     05  ARCH2I PIC  X(0008).
  1102*    -------------------------------
  1103     05  TRLR2L PIC S9(0004) COMP.
  1104     05  TRLR2F PIC  X(0001).
  1105     05  FILLER REDEFINES TRLR2F.
  1106         10  TRLR2A PIC  X(0001).
  1107     05  TRLR2I PIC  X(0004).
  1108*    -------------------------------
  1109     05  TYPE2L PIC S9(0004) COMP.
  1110     05  TYPE2F PIC  X(0001).
  1111     05  FILLER REDEFINES TYPE2F.
  1112         10  TYPE2A PIC  X(0001).
  1113     05  TYPE2I PIC  X(0001).
  1114*    -------------------------------
  1115     05  RE2L PIC S9(0004) COMP.
  1116     05  RE2F PIC  X(0001).
  1117     05  FILLER REDEFINES RE2F.
  1118         10  RE2A PIC  X(0001).
  1119     05  RE2I PIC  X(0070).
  1120*    -------------------------------
  1121     05  RECDTE3L PIC S9(0004) COMP.
  1122     05  RECDTE3F PIC  X(0001).
  1123     05  FILLER REDEFINES RECDTE3F.
  1124         10  RECDTE3A PIC  X(0001).
  1125     05  RECDTE3I PIC  X(0008).
  1126*    -------------------------------
  1127     05  STOPDT3L PIC S9(0004) COMP.
  1128     05  STOPDT3F PIC  X(0001).
  1129     05  FILLER REDEFINES STOPDT3F.
  1130         10  STOPDT3A PIC  X(0001).
  1131     05  STOPDT3I PIC  X(0008).
  1132*    -------------------------------
  1133     05  SENT3L PIC S9(0004) COMP.
  1134     05  SENT3F PIC  X(0001).
  1135     05  FILLER REDEFINES SENT3F.
  1136         10  SENT3A PIC  X(0001).
  1137     05  SENT3I PIC  X(0008).
  1138*    -------------------------------
  1139     05  BY3L PIC S9(0004) COMP.
  1140     05  BY3F PIC  X(0001).
  1141     05  FILLER REDEFINES BY3F.
  1142         10  BY3A PIC  X(0001).
  1143     05  BY3I PIC  X(0004).
  1144*    -------------------------------
  1145     05  RESEND3L PIC S9(0004) COMP.
  1146     05  RESEND3F PIC  X(0001).
  1147     05  FILLER REDEFINES RESEND3F.
  1148         10  RESEND3A PIC  X(0001).
  1149     05  RESEND3I PIC  X(0008).
  1150*    -------------------------------
  1151     05  FOLLOW3L PIC S9(0004) COMP.
  1152     05  FOLLOW3F PIC  X(0001).
  1153     05  FILLER REDEFINES FOLLOW3F.
  1154         10  FOLLOW3A PIC  X(0001).
  1155     05  FOLLOW3I PIC  X(0008).
  1156*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  26
* EL162.cbl
  1157     05  FORM3L PIC S9(0004) COMP.
  1158     05  FORM3F PIC  X(0001).
  1159     05  FILLER REDEFINES FORM3F.
  1160         10  FORM3A PIC  X(0001).
  1161     05  FORM3I PIC  X(0004).
  1162*    -------------------------------
  1163     05  TO3L PIC S9(0004) COMP.
  1164     05  TO3F PIC  X(0001).
  1165     05  FILLER REDEFINES TO3F.
  1166         10  TO3A PIC  X(0001).
  1167     05  TO3I PIC  X(0008).
  1168*    -------------------------------
  1169     05  ARCH3L PIC S9(0004) COMP.
  1170     05  ARCH3F PIC  X(0001).
  1171     05  FILLER REDEFINES ARCH3F.
  1172         10  ARCH3A PIC  X(0001).
  1173     05  ARCH3I PIC  X(0008).
  1174*    -------------------------------
  1175     05  TRLR3L PIC S9(0004) COMP.
  1176     05  TRLR3F PIC  X(0001).
  1177     05  FILLER REDEFINES TRLR3F.
  1178         10  TRLR3A PIC  X(0001).
  1179     05  TRLR3I PIC  X(0004).
  1180*    -------------------------------
  1181     05  TYPE3L PIC S9(0004) COMP.
  1182     05  TYPE3F PIC  X(0001).
  1183     05  FILLER REDEFINES TYPE3F.
  1184         10  TYPE3A PIC  X(0001).
  1185     05  TYPE3I PIC  X(0001).
  1186*    -------------------------------
  1187     05  RE3L PIC S9(0004) COMP.
  1188     05  RE3F PIC  X(0001).
  1189     05  FILLER REDEFINES RE3F.
  1190         10  RE3A PIC  X(0001).
  1191     05  RE3I PIC  X(0070).
  1192*    -------------------------------
  1193     05  RECDTE4L PIC S9(0004) COMP.
  1194     05  RECDTE4F PIC  X(0001).
  1195     05  FILLER REDEFINES RECDTE4F.
  1196         10  RECDTE4A PIC  X(0001).
  1197     05  RECDTE4I PIC  X(0008).
  1198*    -------------------------------
  1199     05  STOPDT4L PIC S9(0004) COMP.
  1200     05  STOPDT4F PIC  X(0001).
  1201     05  FILLER REDEFINES STOPDT4F.
  1202         10  STOPDT4A PIC  X(0001).
  1203     05  STOPDT4I PIC  X(0008).
  1204*    -------------------------------
  1205     05  SENT4L PIC S9(0004) COMP.
  1206     05  SENT4F PIC  X(0001).
  1207     05  FILLER REDEFINES SENT4F.
  1208         10  SENT4A PIC  X(0001).
  1209     05  SENT4I PIC  X(0008).
  1210*    -------------------------------
  1211     05  BY4L PIC S9(0004) COMP.
  1212     05  BY4F PIC  X(0001).
  1213     05  FILLER REDEFINES BY4F.
  1214         10  BY4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  27
* EL162.cbl
  1215     05  BY4I PIC  X(0004).
  1216*    -------------------------------
  1217     05  RESEND4L PIC S9(0004) COMP.
  1218     05  RESEND4F PIC  X(0001).
  1219     05  FILLER REDEFINES RESEND4F.
  1220         10  RESEND4A PIC  X(0001).
  1221     05  RESEND4I PIC  X(0008).
  1222*    -------------------------------
  1223     05  FOLLOW4L PIC S9(0004) COMP.
  1224     05  FOLLOW4F PIC  X(0001).
  1225     05  FILLER REDEFINES FOLLOW4F.
  1226         10  FOLLOW4A PIC  X(0001).
  1227     05  FOLLOW4I PIC  X(0008).
  1228*    -------------------------------
  1229     05  FORM4L PIC S9(0004) COMP.
  1230     05  FORM4F PIC  X(0001).
  1231     05  FILLER REDEFINES FORM4F.
  1232         10  FORM4A PIC  X(0001).
  1233     05  FORM4I PIC  X(0004).
  1234*    -------------------------------
  1235     05  TO4L PIC S9(0004) COMP.
  1236     05  TO4F PIC  X(0001).
  1237     05  FILLER REDEFINES TO4F.
  1238         10  TO4A PIC  X(0001).
  1239     05  TO4I PIC  X(0008).
  1240*    -------------------------------
  1241     05  ARCH4L PIC S9(0004) COMP.
  1242     05  ARCH4F PIC  X(0001).
  1243     05  FILLER REDEFINES ARCH4F.
  1244         10  ARCH4A PIC  X(0001).
  1245     05  ARCH4I PIC  X(0008).
  1246*    -------------------------------
  1247     05  TRLR4L PIC S9(0004) COMP.
  1248     05  TRLR4F PIC  X(0001).
  1249     05  FILLER REDEFINES TRLR4F.
  1250         10  TRLR4A PIC  X(0001).
  1251     05  TRLR4I PIC  X(0004).
  1252*    -------------------------------
  1253     05  TYPE4L PIC S9(0004) COMP.
  1254     05  TYPE4F PIC  X(0001).
  1255     05  FILLER REDEFINES TYPE4F.
  1256         10  TYPE4A PIC  X(0001).
  1257     05  TYPE4I PIC  X(0001).
  1258*    -------------------------------
  1259     05  RE4L PIC S9(0004) COMP.
  1260     05  RE4F PIC  X(0001).
  1261     05  FILLER REDEFINES RE4F.
  1262         10  RE4A PIC  X(0001).
  1263     05  RE4I PIC  X(0070).
  1264*    -------------------------------
  1265     05  URECDTEL PIC S9(0004) COMP.
  1266     05  URECDTEF PIC  X(0001).
  1267     05  FILLER REDEFINES URECDTEF.
  1268         10  URECDTEA PIC  X(0001).
  1269     05  URECDTEI PIC  X(0008).
  1270*    -------------------------------
  1271     05  USENTL PIC S9(0004) COMP.
  1272     05  USENTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  28
* EL162.cbl
  1273     05  FILLER REDEFINES USENTF.
  1274         10  USENTA PIC  X(0001).
  1275     05  USENTI PIC  X(0008).
  1276*    -------------------------------
  1277     05  UBYL PIC S9(0004) COMP.
  1278     05  UBYF PIC  X(0001).
  1279     05  FILLER REDEFINES UBYF.
  1280         10  UBYA PIC  X(0001).
  1281     05  UBYI PIC  X(0004).
  1282*    -------------------------------
  1283     05  UFORML PIC S9(0004) COMP.
  1284     05  UFORMF PIC  X(0001).
  1285     05  FILLER REDEFINES UFORMF.
  1286         10  UFORMA PIC  X(0001).
  1287     05  UFORMI PIC  X(0004).
  1288*    -------------------------------
  1289     05  UREL PIC S9(0004) COMP.
  1290     05  UREF PIC  X(0001).
  1291     05  FILLER REDEFINES UREF.
  1292         10  UREA PIC  X(0001).
  1293     05  UREI PIC  X(0070).
  1294*    -------------------------------
  1295     05  ADDR1L PIC S9(0004) COMP.
  1296     05  ADDR1F PIC  X(0001).
  1297     05  FILLER REDEFINES ADDR1F.
  1298         10  ADDR1A PIC  X(0001).
  1299     05  ADDR1I PIC  X(0030).
  1300*    -------------------------------
  1301     05  ADDR2L PIC S9(0004) COMP.
  1302     05  ADDR2F PIC  X(0001).
  1303     05  FILLER REDEFINES ADDR2F.
  1304         10  ADDR2A PIC  X(0001).
  1305     05  ADDR2I PIC  X(0030).
  1306*    -------------------------------
  1307     05  ADDR3L PIC S9(0004) COMP.
  1308     05  ADDR3F PIC  X(0001).
  1309     05  FILLER REDEFINES ADDR3F.
  1310         10  ADDR3A PIC  X(0001).
  1311     05  ADDR3I PIC  X(0030).
  1312*    -------------------------------
  1313     05  ADDR4L PIC S9(0004) COMP.
  1314     05  ADDR4F PIC  X(0001).
  1315     05  FILLER REDEFINES ADDR4F.
  1316         10  ADDR4A PIC  X(0001).
  1317     05  ADDR4I PIC  X(0030).
  1318*    -------------------------------
  1319     05  ZIPL PIC S9(0004) COMP.
  1320     05  ZIPF PIC  X(0001).
  1321     05  FILLER REDEFINES ZIPF.
  1322         10  ZIPA PIC  X(0001).
  1323     05  ZIPI PIC  X(0010).
  1324*    -------------------------------
  1325     05  PHONEL PIC S9(0004) COMP.
  1326     05  PHONEF PIC  X(0001).
  1327     05  FILLER REDEFINES PHONEF.
  1328         10  PHONEA PIC  X(0001).
  1329     05  PHONEI PIC  X(0012).
  1330*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  29
* EL162.cbl
  1331     05  TRLRL PIC S9(0004) COMP.
  1332     05  TRLRF PIC  X(0001).
  1333     05  FILLER REDEFINES TRLRF.
  1334         10  TRLRA PIC  X(0001).
  1335     05  TRLRI PIC  X(0004).
  1336*    -------------------------------
  1337     05  ERRMSG1L PIC S9(0004) COMP.
  1338     05  ERRMSG1F PIC  X(0001).
  1339     05  FILLER REDEFINES ERRMSG1F.
  1340         10  ERRMSG1A PIC  X(0001).
  1341     05  ERRMSG1I PIC  X(0072).
  1342*    -------------------------------
  1343     05  ENTERPFL PIC S9(0004) COMP.
  1344     05  ENTERPFF PIC  X(0001).
  1345     05  FILLER REDEFINES ENTERPFF.
  1346         10  ENTERPFA PIC  X(0001).
  1347     05  ENTERPFI PIC  99.
  1348*    -------------------------------
  1349     05  PF4KEYL PIC S9(0004) COMP.
  1350     05  PF4KEYF PIC  X(0001).
  1351     05  FILLER REDEFINES PF4KEYF.
  1352         10  PF4KEYA PIC  X(0001).
  1353     05  PF4KEYI PIC  X(0015).
  1354*    -------------------------------
  1355     05  PF5KEYL PIC S9(0004) COMP.
  1356     05  PF5KEYF PIC  X(0001).
  1357     05  FILLER REDEFINES PF5KEYF.
  1358         10  PF5KEYA PIC  X(0001).
  1359     05  PF5KEYI PIC  X(0014).
  1360 01  EL162AO REDEFINES EL162AI.
  1361     05  FILLER            PIC  X(0012).
  1362*    -------------------------------
  1363     05  FILLER            PIC  X(0003).
  1364     05  RUNDTEO PIC  X(0008).
  1365*    -------------------------------
  1366     05  FILLER            PIC  X(0003).
  1367     05  RUNTIMEO PIC  99.99.
  1368*    -------------------------------
  1369     05  FILLER            PIC  X(0003).
  1370     05  CLAIMNOO PIC  X(0007).
  1371*    -------------------------------
  1372     05  FILLER            PIC  X(0003).
  1373     05  TYPEO PIC  X(0006).
  1374*    -------------------------------
  1375     05  FILLER            PIC  X(0003).
  1376     05  CARRO PIC  X(0001).
  1377*    -------------------------------
  1378     05  FILLER            PIC  X(0003).
  1379     05  CERTNOO PIC  X(0011).
  1380*    -------------------------------
  1381     05  FILLER            PIC  X(0003).
  1382     05  LASTNMEO PIC  X(0015).
  1383*    -------------------------------
  1384     05  FILLER            PIC  X(0003).
  1385     05  FILEO PIC  X(0004).
  1386*    -------------------------------
  1387     05  FILLER            PIC  X(0003).
  1388     05  RECDTE1O PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  30
* EL162.cbl
  1389*    -------------------------------
  1390     05  FILLER            PIC  X(0003).
  1391     05  STOPDT1O PIC  X(0008).
  1392*    -------------------------------
  1393     05  FILLER            PIC  X(0003).
  1394     05  SENT1O PIC  X(0008).
  1395*    -------------------------------
  1396     05  FILLER            PIC  X(0003).
  1397     05  BY1O PIC  X(0004).
  1398*    -------------------------------
  1399     05  FILLER            PIC  X(0003).
  1400     05  RESEND1O PIC  X(0008).
  1401*    -------------------------------
  1402     05  FILLER            PIC  X(0003).
  1403     05  FOLLOW1O PIC  X(0008).
  1404*    -------------------------------
  1405     05  FILLER            PIC  X(0003).
  1406     05  FORM1O PIC  X(0004).
  1407*    -------------------------------
  1408     05  FILLER            PIC  X(0003).
  1409     05  TO1O PIC  X(0008).
  1410*    -------------------------------
  1411     05  FILLER            PIC  X(0003).
  1412     05  ARCH1O PIC  X(0008).
  1413*    -------------------------------
  1414     05  FILLER            PIC  X(0003).
  1415     05  TRLR1O PIC  9999.
  1416*    -------------------------------
  1417     05  FILLER            PIC  X(0003).
  1418     05  TYPE1O PIC  X(0001).
  1419*    -------------------------------
  1420     05  FILLER            PIC  X(0003).
  1421     05  RE1O PIC  X(0070).
  1422*    -------------------------------
  1423     05  FILLER            PIC  X(0003).
  1424     05  RECDTE2O PIC  X(0008).
  1425*    -------------------------------
  1426     05  FILLER            PIC  X(0003).
  1427     05  STOPDT2O PIC  X(0008).
  1428*    -------------------------------
  1429     05  FILLER            PIC  X(0003).
  1430     05  SENT2O PIC  X(0008).
  1431*    -------------------------------
  1432     05  FILLER            PIC  X(0003).
  1433     05  BY2O PIC  X(0004).
  1434*    -------------------------------
  1435     05  FILLER            PIC  X(0003).
  1436     05  RESEND2O PIC  X(0008).
  1437*    -------------------------------
  1438     05  FILLER            PIC  X(0003).
  1439     05  FOLLOW2O PIC  X(0008).
  1440*    -------------------------------
  1441     05  FILLER            PIC  X(0003).
  1442     05  FORM2O PIC  X(0004).
  1443*    -------------------------------
  1444     05  FILLER            PIC  X(0003).
  1445     05  TO2O PIC  X(0008).
  1446*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  31
* EL162.cbl
  1447     05  FILLER            PIC  X(0003).
  1448     05  ARCH2O PIC  X(0008).
  1449*    -------------------------------
  1450     05  FILLER            PIC  X(0003).
  1451     05  TRLR2O PIC  9999.
  1452*    -------------------------------
  1453     05  FILLER            PIC  X(0003).
  1454     05  TYPE2O PIC  X(0001).
  1455*    -------------------------------
  1456     05  FILLER            PIC  X(0003).
  1457     05  RE2O PIC  X(0070).
  1458*    -------------------------------
  1459     05  FILLER            PIC  X(0003).
  1460     05  RECDTE3O PIC  X(0008).
  1461*    -------------------------------
  1462     05  FILLER            PIC  X(0003).
  1463     05  STOPDT3O PIC  X(0008).
  1464*    -------------------------------
  1465     05  FILLER            PIC  X(0003).
  1466     05  SENT3O PIC  X(0008).
  1467*    -------------------------------
  1468     05  FILLER            PIC  X(0003).
  1469     05  BY3O PIC  X(0004).
  1470*    -------------------------------
  1471     05  FILLER            PIC  X(0003).
  1472     05  RESEND3O PIC  X(0008).
  1473*    -------------------------------
  1474     05  FILLER            PIC  X(0003).
  1475     05  FOLLOW3O PIC  X(0008).
  1476*    -------------------------------
  1477     05  FILLER            PIC  X(0003).
  1478     05  FORM3O PIC  X(0004).
  1479*    -------------------------------
  1480     05  FILLER            PIC  X(0003).
  1481     05  TO3O PIC  X(0008).
  1482*    -------------------------------
  1483     05  FILLER            PIC  X(0003).
  1484     05  ARCH3O PIC  X(0008).
  1485*    -------------------------------
  1486     05  FILLER            PIC  X(0003).
  1487     05  TRLR3O PIC  9999.
  1488*    -------------------------------
  1489     05  FILLER            PIC  X(0003).
  1490     05  TYPE3O PIC  X(0001).
  1491*    -------------------------------
  1492     05  FILLER            PIC  X(0003).
  1493     05  RE3O PIC  X(0070).
  1494*    -------------------------------
  1495     05  FILLER            PIC  X(0003).
  1496     05  RECDTE4O PIC  X(0008).
  1497*    -------------------------------
  1498     05  FILLER            PIC  X(0003).
  1499     05  STOPDT4O PIC  X(0008).
  1500*    -------------------------------
  1501     05  FILLER            PIC  X(0003).
  1502     05  SENT4O PIC  X(0008).
  1503*    -------------------------------
  1504     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  32
* EL162.cbl
  1505     05  BY4O PIC  X(0004).
  1506*    -------------------------------
  1507     05  FILLER            PIC  X(0003).
  1508     05  RESEND4O PIC  X(0008).
  1509*    -------------------------------
  1510     05  FILLER            PIC  X(0003).
  1511     05  FOLLOW4O PIC  X(0008).
  1512*    -------------------------------
  1513     05  FILLER            PIC  X(0003).
  1514     05  FORM4O PIC  X(0004).
  1515*    -------------------------------
  1516     05  FILLER            PIC  X(0003).
  1517     05  TO4O PIC  X(0008).
  1518*    -------------------------------
  1519     05  FILLER            PIC  X(0003).
  1520     05  ARCH4O PIC  X(0008).
  1521*    -------------------------------
  1522     05  FILLER            PIC  X(0003).
  1523     05  TRLR4O PIC  9999.
  1524*    -------------------------------
  1525     05  FILLER            PIC  X(0003).
  1526     05  TYPE4O PIC  X(0001).
  1527*    -------------------------------
  1528     05  FILLER            PIC  X(0003).
  1529     05  RE4O PIC  X(0070).
  1530*    -------------------------------
  1531     05  FILLER            PIC  X(0003).
  1532     05  URECDTEO PIC  99B99B99.
  1533*    -------------------------------
  1534     05  FILLER            PIC  X(0003).
  1535     05  USENTO PIC  99B99B99.
  1536*    -------------------------------
  1537     05  FILLER            PIC  X(0003).
  1538     05  UBYO PIC  X(0004).
  1539*    -------------------------------
  1540     05  FILLER            PIC  X(0003).
  1541     05  UFORMO PIC  X(0004).
  1542*    -------------------------------
  1543     05  FILLER            PIC  X(0003).
  1544     05  UREO PIC  X(0070).
  1545*    -------------------------------
  1546     05  FILLER            PIC  X(0003).
  1547     05  ADDR1O PIC  X(0030).
  1548*    -------------------------------
  1549     05  FILLER            PIC  X(0003).
  1550     05  ADDR2O PIC  X(0030).
  1551*    -------------------------------
  1552     05  FILLER            PIC  X(0003).
  1553     05  ADDR3O PIC  X(0030).
  1554*    -------------------------------
  1555     05  FILLER            PIC  X(0003).
  1556     05  ADDR4O PIC  X(0030).
  1557*    -------------------------------
  1558     05  FILLER            PIC  X(0003).
  1559     05  ZIPO PIC  X(0010).
  1560*    -------------------------------
  1561     05  FILLER            PIC  X(0003).
  1562     05  PHONEO PIC  999B999B9999.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  33
* EL162.cbl
  1563*    -------------------------------
  1564     05  FILLER            PIC  X(0003).
  1565     05  TRLRO PIC  9999.
  1566*    -------------------------------
  1567     05  FILLER            PIC  X(0003).
  1568     05  ERRMSG1O PIC  X(0072).
  1569*    -------------------------------
  1570     05  FILLER            PIC  X(0003).
  1571     05  ENTERPFO PIC  X(0002).
  1572*    -------------------------------
  1573     05  FILLER            PIC  X(0003).
  1574     05  PF4KEYO PIC  X(0015).
  1575*    -------------------------------
  1576     05  FILLER            PIC  X(0003).
  1577     05  PF5KEYO PIC  X(0014).
  1578*    -------------------------------
  1579
  1580 01  MAP-REDEF REDEFINES EL162AI.
  1581     12  FILLER              PIC X(93).
  1582     12  TRL-LINES.
  1583       14  TRAILER-LINES  OCCURS 4 TIMES INDEXED BY SC-INDX.
  1584         16  SC-RECL         PIC S9(4)  COMP.
  1585         16  SC-RECA         PIC X.
  1586         16  SC-REC          PIC X(8).
  1587         16  SC-REC-O REDEFINES SC-REC PIC 99B99B99.
  1588         16  SC-STOPL        PIC S9(4)  COMP.
  1589         16  SC-STOPA        PIC X.
  1590         16  SC-STOP         PIC X(8).
  1591         16  SC-STOP-O REDEFINES SC-STOP PIC 99B99B99.
  1592         16  FILLER          PIC X(3).
  1593         16  SC-SENT         PIC X(8).
  1594         16  FILLER          PIC X(3).
  1595         16  SC-BY           PIC X(4).
  1596         16  FILLER          PIC X(3).
  1597         16  SC-RESEND       PIC X(8).
  1598         16  FILLER          PIC X(3).
  1599         16  SC-FOLLOWUP     PIC X(8).
  1600         16  FILLER          PIC X(3).
  1601         16  SC-FORM         PIC X(4).
  1602         16  FILLER          PIC X(3).
  1603         16  SC-TO           PIC X(8).
  1604         16  FILLER          PIC X(3).
  1605         16  SC-ARCHIVE      PIC X(8).
  1606         16  FILLER          PIC X(3).
  1607         16  SC-TRLRNO       PIC 9(4).
  1608         16  FILLER          PIC X(3).
  1609         16  SC-TYPE         PIC X.
  1610         16  FILLER          PIC X(3).
  1611         16  SC-REASON       PIC X(70).
  1612
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  34
* EL162.cbl
  1614****************************************************************
  1615*
  1616* Copyright (c) 2007 by Clerity Solutions, Inc.
  1617* All rights reserved.
  1618*
  1619****************************************************************
  1620 01  DFHEIV.
  1621   02  DFHEIV0               PIC X(35).
  1622   02  DFHEIV1               PIC X(08).
  1623   02  DFHEIV2               PIC X(08).
  1624   02  DFHEIV3               PIC X(08).
  1625   02  DFHEIV4               PIC X(06).
  1626   02  DFHEIV5               PIC X(04).
  1627   02  DFHEIV6               PIC X(04).
  1628   02  DFHEIV7               PIC X(02).
  1629   02  DFHEIV8               PIC X(02).
  1630   02  DFHEIV9               PIC X(01).
  1631   02  DFHEIV10              PIC S9(7) COMP-3.
  1632   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1633   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1634   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1635   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1636   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1637   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1638   02  DFHEIV17              PIC X(04).
  1639   02  DFHEIV18              PIC X(04).
  1640   02  DFHEIV19              PIC X(04).
  1641   02  DFHEIV20              USAGE IS POINTER.
  1642   02  DFHEIV21              USAGE IS POINTER.
  1643   02  DFHEIV22              USAGE IS POINTER.
  1644   02  DFHEIV23              USAGE IS POINTER.
  1645   02  DFHEIV24              USAGE IS POINTER.
  1646   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1647   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1648   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1649   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1650   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1651   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1652   02  FILLER                PIC X(02).
  1653   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1654   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1655   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1656   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1657   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1658 LINKAGE  SECTION.
  1659*****************************************************************
  1660*                                                               *
  1661* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1662* All rights reserved.                                          *
  1663*                                                               *
  1664*****************************************************************
  1665 01  dfheiblk.
  1666     02  eibtime          pic s9(7) comp-3.
  1667     02  eibdate          pic s9(7) comp-3.
  1668     02  eibtrnid         pic x(4).
  1669     02  eibtaskn         pic s9(7) comp-3.
  1670     02  eibtrmid         pic x(4).
  1671     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  35
* EL162.cbl
  1672     02  eibcposn         pic s9(4) comp.
  1673     02  eibcalen         pic s9(4) comp.
  1674     02  eibaid           pic x(1).
  1675     02  eibfiller1       pic x(1).
  1676     02  eibfn            pic x(2).
  1677     02  eibfiller2       pic x(2).
  1678     02  eibrcode         pic x(6).
  1679     02  eibfiller3       pic x(2).
  1680     02  eibds            pic x(8).
  1681     02  eibreqid         pic x(8).
  1682     02  eibrsrce         pic x(8).
  1683     02  eibsync          pic x(1).
  1684     02  eibfree          pic x(1).
  1685     02  eibrecv          pic x(1).
  1686     02  eibsend          pic x(1).
  1687     02  eibatt           pic x(1).
  1688     02  eibeoc           pic x(1).
  1689     02  eibfmh           pic x(1).
  1690     02  eibcompl         pic x(1).
  1691     02  eibsig           pic x(1).
  1692     02  eibconf          pic x(1).
  1693     02  eiberr           pic x(1).
  1694     02  eibrldbk         pic x(1).
  1695     02  eiberrcd         pic x(4).
  1696     02  eibsynrb         pic x(1).
  1697     02  eibnodat         pic x(1).
  1698     02  eibfiller5       pic x(2).
  1699     02  eibresp          pic 9(09) comp.
  1700     02  eibresp2         pic 9(09) comp.
  1701     02  dfheigdj         pic s9(4) comp.
  1702     02  dfheigdk         pic s9(4) comp.
  1703
  1704 01  DFHCOMMAREA             PIC X(1024).
  1705
  1706*01 PARMLIST .
  1707*    02  FILLER              PIC S9(8)   COMP.
  1708*    02  CLAM-POINTER        PIC S9(8)   COMP.
  1709*    02  ACTV-POINTER        PIC S9(8)   COMP.
  1710*    02  ACCT-POINTER        PIC S9(8)   COMP.
  1711
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  36
* EL162.cbl
  1713*                            COPY ELCMSTR.
  1714******************************************************************
  1715*                                                                *
  1716*                            ELCMSTR.                            *
  1717*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1718*                            VMOD=2.012                          *
  1719*                                                                *
  1720*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1721*                                                                *
  1722*   FILE TYPE = VSAM,KSDS                                        *
  1723*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1724*                                                                *
  1725*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1726*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1727*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1728*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1729*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1730*                                                 RKP=75,LEN=21  *
  1731*                                                                *
  1732*   **** NOTE ****                                               *
  1733*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1734*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1735*                                                                *
  1736*   LOG = YES                                                    *
  1737*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1738******************************************************************
  1739*                   C H A N G E   L O G
  1740*
  1741* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1742*-----------------------------------------------------------------
  1743*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1744* EFFECTIVE    NUMBER
  1745*-----------------------------------------------------------------
  1746* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1747* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1748* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  1749* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1750* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1751******************************************************************
  1752 01  CLAIM-MASTER.
  1753     12  CL-RECORD-ID                PIC XX.
  1754         88  VALID-CL-ID         VALUE 'CL'.
  1755
  1756     12  CL-CONTROL-PRIMARY.
  1757         16  CL-COMPANY-CD           PIC X.
  1758         16  CL-CARRIER              PIC X.
  1759         16  CL-CLAIM-NO             PIC X(7).
  1760         16  CL-CERT-NO.
  1761             20  CL-CERT-PRIME       PIC X(10).
  1762             20  CL-CERT-SFX         PIC X.
  1763
  1764     12  CL-CONTROL-BY-NAME.
  1765         16  CL-COMPANY-CD-A1        PIC X.
  1766         16  CL-INSURED-LAST-NAME    PIC X(15).
  1767         16  CL-INSURED-NAME.
  1768             20  CL-INSURED-1ST-NAME PIC X(12).
  1769             20  CL-INSURED-MID-INIT PIC X.
  1770
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  37
* EL162.cbl
  1771     12  CL-CONTROL-BY-SSN.
  1772         16  CL-COMPANY-CD-A2        PIC X.
  1773         16  CL-SOC-SEC-NO.
  1774             20  CL-SSN-STATE        PIC XX.
  1775             20  CL-SSN-ACCOUNT      PIC X(6).
  1776             20  CL-SSN-LN3          PIC X(3).
  1777
  1778     12  CL-CONTROL-BY-CERT-NO.
  1779         16  CL-COMPANY-CD-A4        PIC X.
  1780         16  CL-CERT-NO-A4.
  1781             20  CL-CERT-A4-PRIME    PIC X(10).
  1782             20  CL-CERT-A4-SFX      PIC X.
  1783
  1784     12  CL-CONTROL-BY-CCN.
  1785         16  CL-COMPANY-CD-A5        PIC X.
  1786         16  CL-CCN-A5.
  1787             20  CL-CCN.
  1788                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1789                 24  CL-CCN-PRIME-A5 PIC X(12).
  1790             20  CL-CCN-FILLER-A5    PIC X(4).
  1791
  1792     12  CL-INSURED-PROFILE-DATA.
  1793         16  CL-INSURED-BIRTH-DT     PIC XX.
  1794         16  CL-INSURED-SEX-CD       PIC X.
  1795             88  INSURED-IS-MALE        VALUE 'M'.
  1796             88  INSURED-IS-FEMALE      VALUE 'F'.
  1797             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  1798         16  CL-INSURED-OCC-CD       PIC X(6).
  1799         16  FILLER                  PIC X(5).
  1800
  1801     12  CL-PROCESSING-INFO.
  1802         16  CL-PROCESSOR-ID         PIC X(4).
  1803         16  CL-CLAIM-STATUS         PIC X.
  1804             88  CLAIM-IS-OPEN          VALUE 'O'.
  1805             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1806         16  CL-CLAIM-TYPE           PIC X.
  1807*            88  AH-CLAIM               VALUE 'A'.
  1808*            88  LIFE-CLAIM             VALUE 'L'.
  1809*            88  PROPERTY-CLAIM         VALUE 'P'.
  1810*            88  IUI-CLAIM              VALUE 'I'.
  1811*            88  GAP-CLAIM              VALUE 'G'.
  1812*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  1813         16  CL-CLAIM-PREM-TYPE      PIC X.
  1814             88  SINGLE-PREMIUM         VALUE '1'.
  1815             88  O-B-COVERAGE           VALUE '2'.
  1816             88  OPEN-END-COVERAGE      VALUE '3'.
  1817         16  CL-INCURRED-DT          PIC XX.
  1818         16  CL-REPORTED-DT          PIC XX.
  1819         16  CL-FILE-ESTABLISH-DT    PIC XX.
  1820         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  1821         16  CL-LAST-PMT-DT          PIC XX.
  1822         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  1823         16  CL-PAID-THRU-DT         PIC XX.
  1824         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  1825         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  1826         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  1827         16  CL-PMT-CALC-METHOD      PIC X.
  1828             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  38
* EL162.cbl
  1829             88  CL-365-DAY-YR          VALUE '2'.
  1830             88  CL-FULL-MONTHS         VALUE '3'.
  1831         16  CL-CAUSE-CD             PIC X(6).
  1832
  1833         16  CL-PRIME-CERT-NO.
  1834             20  CL-PRIME-CERT-PRIME PIC X(10).
  1835             20  CL-PRIME-CERT-SFX   PIC X.
  1836
  1837         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  1838             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  1839             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  1840
  1841         16  CL-MICROFILM-NO         PIC X(10).
  1842         16  FILLER REDEFINES CL-MICROFILM-NO.
  1843             20  CL-BENEFIT-PERIOD   PIC 99.
  1844             20  FILLER              PIC X(8).
  1845         16  CL-PROG-FORM-TYPE       PIC X.
  1846         16  CL-LAST-ADD-ON-DT       PIC XX.
  1847
  1848         16  CL-LAST-REOPEN-DT       PIC XX.
  1849         16  CL-LAST-CLOSE-DT        PIC XX.
  1850         16  CL-LAST-CLOSE-REASON    PIC X(01).
  1851             88  FINAL-PAID             VALUE '1'.
  1852             88  CLAIM-DENIED           VALUE '2'.
  1853             88  AUTO-CLOSE             VALUE '3'.
  1854             88  MANUAL-CLOSE           VALUE '4'.
  1855             88  BENEFITS-CHANGED       VALUE 'C'.
  1856             88  SETUP-ERRORS           VALUE 'E'.
  1857         16  CL-ASSOC-CERT-SEQU      PIC S99.
  1858         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  1859         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  1860             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  1861         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1862         16  FILLER                  PIC X.
  1863
  1864     12  CL-CERTIFICATE-DATA.
  1865         16  CL-CERT-ORIGIN          PIC X.
  1866             88  CERT-WAS-ONLINE        VALUE '1'.
  1867             88  CERT-WAS-CREATED       VALUE '2'.
  1868             88  COVERAGE-WAS-ADDED     VALUE '3'.
  1869         16  CL-CERT-KEY-DATA.
  1870             20  CL-CERT-CARRIER     PIC X.
  1871             20  CL-CERT-GROUPING    PIC X(6).
  1872             20  CL-CERT-STATE       PIC XX.
  1873             20  CL-CERT-ACCOUNT.
  1874                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  1875                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  1876             20  CL-CERT-EFF-DT      PIC XX.
  1877
  1878     12  CL-STATUS-CONTROLS.
  1879         16  CL-PRIORITY-CD          PIC X.
  1880             88  CONFIDENTIAL-DATA      VALUE '8'.
  1881             88  HIGHEST-PRIORITY       VALUE '9'.
  1882         16  CL-SUPV-ATTN-CD         PIC X.
  1883             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  1884             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  1885         16  CL-PURGED-DT            PIC XX.
  1886         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  39
* EL162.cbl
  1887         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  1888         16  CL-NEXT-RESEND-DT       PIC XX.
  1889         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  1890         16  CL-CRITICAL-PERIOD      PIC 99.
  1891*        16  FILLER                  PIC XX.
  1892         16  CL-LAST-MAINT-DT        PIC XX.
  1893         16  CL-LAST-MAINT-USER      PIC X(4).
  1894         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  1895         16  CL-LAST-MAINT-TYPE      PIC X.
  1896             88  CLAIM-SET-UP           VALUE ' '.
  1897             88  PAYMENT-MADE           VALUE '1'.
  1898             88  LETTER-SENT            VALUE '2'.
  1899             88  MASTER-WAS-ALTERED     VALUE '3'.
  1900             88  MASTER-WAS-RESTORED    VALUE '4'.
  1901             88  INCURRED-DATE-CHANGED  VALUE '5'.
  1902             88  FILE-CONVERTED         VALUE '6'.
  1903             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  1904             88  ERROR-CORRECTION       VALUE 'E'.
  1905         16  CL-RELATED-CLAIM-NO     PIC X(7).
  1906         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  1907         16  CL-BENEFICIARY          PIC X(10).
  1908         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  1909         16  CL-DENIAL-TYPE          PIC X.
  1910             88  CL-TYPE-DENIAL          VALUE '1'.
  1911             88  CL-TYPE-RESCISSION      VALUE '2'.
  1912             88  CL-TYPE-REFORMATION     VALUE '3'.
  1913             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1914             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1915         16  filler                  pic x(5).
  1916*        16  CL-CRIT-PER-RECURRENT   PIC X.
  1917*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  1918*        16  CL-RTW-DT               PIC XX.
  1919
  1920     12  CL-TRAILER-CONTROLS.
  1921         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  1922             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  1923             88  CL-LAST-TRL-AVAIL      VALUE +100.
  1924             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  1925         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  1926         16  FILLER                  PIC XX.
  1927         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  1928         16  CL-ADDRESS-TRAILER-CNT.
  1929             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  1930                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  1931             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  1932                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  1933             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  1934                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  1935             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  1936                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  1937             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  1938                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  1939             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  1940                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  1941             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  1942                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  1943
  1944     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  40
* EL162.cbl
  1945         16  CL-CV-REFNO-PRIME       PIC X(18).
  1946         16  CL-CV-REFNO-SFX         PIC XX.
  1947
  1948     12  CL-FILE-LOCATION            PIC X(4).
  1949
  1950     12  CL-PROCESS-ERRORS.
  1951         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  1952             88  NO-FATAL-ERRORS        VALUE ZERO.
  1953         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  1954             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  1955
  1956     12  CL-PRODUCT-CD               PIC X.
  1957
  1958     12  CL-CURRENT-KEY-DATA.
  1959         16  CL-CURRENT-CARRIER      PIC X.
  1960         16  CL-CURRENT-GROUPING     PIC X(6).
  1961         16  CL-CURRENT-STATE        PIC XX.
  1962         16  CL-CURRENT-ACCOUNT      PIC X(10).
  1963
  1964     12  CL-ASSOCIATES               PIC X.
  1965         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  1966         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  1967         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  1968         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  1969
  1970     12  CL-ACTIVITY-CODE            PIC 99.
  1971     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  1972     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  1973
  1974     12  CL-LAPSE-REPORT-CODE        PIC 9.
  1975     12  CL-LAG-REPORT-CODE          PIC 9.
  1976     12  CL-LOAN-TYPE                PIC XX.
  1977     12  CL-LEGAL-STATE              PIC XX.
  1978
  1979     12  CL-YESNOSW                  PIC X.
  1980     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  1981         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  1982         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  1983         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  1984     12  cl-insured-type             pic x.
  1985         88  cl-claim-on-primary         value 'P'.
  1986         88  cl-claim-on-co-borrower     value 'C'.
  1987     12  cl-benefit-expiration-dt    PIC XX.
  1988
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  41
* EL162.cbl
  1990*                            COPY ELCTRLR.
  1991******************************************************************
  1992*                                                                *
  1993*                            ELCTRLR.                            *
  1994*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1995*                            VMOD=2.014                          *
  1996*                                                                *
  1997*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  1998*                                                                *
  1999*   FILE TYPE = VSAM,KSDS                                        *
  2000*   RECORD SIZE = 200    RECFORM = FIXED                         *
  2001*                                                                *
  2002*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  2003*       ALTERNATE INDEX = NONE                                   *
  2004*                                                                *
  2005*   LOG = YES                                                    *
  2006*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2007******************************************************************
  2008*                   C H A N G E   L O G
  2009*
  2010* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2011*-----------------------------------------------------------------
  2012*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2013* EFFECTIVE    NUMBER
  2014*-----------------------------------------------------------------
  2015* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  2016* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  2017* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  2018* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  2019* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  2020* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  2021* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  2022* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  2023* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  2024* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  2025* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  2026* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  2027* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  2028* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  2029* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  2030* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2031* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  2032* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  2033* 040814    2014030500002  AJRA  ADD ICD CODES
  2034* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2035******************************************************************
  2036 01  ACTIVITY-TRAILERS.
  2037     12  AT-RECORD-ID                    PIC XX.
  2038         88  VALID-AT-ID                       VALUE 'AT'.
  2039
  2040     12  AT-CONTROL-PRIMARY.
  2041         16  AT-COMPANY-CD               PIC X.
  2042         16  AT-CARRIER                  PIC X.
  2043         16  AT-CLAIM-NO                 PIC X(7).
  2044         16  AT-CERT-NO.
  2045             20  AT-CERT-PRIME           PIC X(10).
  2046             20  AT-CERT-SFX             PIC X.
  2047         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  42
* EL162.cbl
  2048             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  2049             88  AT-LAST-TRL-AVAIL            VALUE +100.
  2050             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  2051             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  2052             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  2053             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  2054             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  2055             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  2056             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  2057             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  2058             88  AT-DIAGNOSIS-TRL             VALUE +90.
  2059             88  AT-BENEFICIARY-TRL           VALUE +91.
  2060             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  2061             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  2062             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  2063             88  AT-ERROR-MSGS-TRL            VALUE +95.
  2064
  2065     12  AT-TRAILER-TYPE                 PIC X.
  2066         88  RESERVE-EXPENSE-TR               VALUE '1'.
  2067         88  PAYMENT-TR                       VALUE '2'.
  2068         88  AUTO-PAY-TR                      VALUE '3'.
  2069         88  CORRESPONDENCE-TR                VALUE '4'.
  2070         88  ADDRESS-TR                       VALUE '5'.
  2071         88  GENERAL-INFO-TR                  VALUE '6'.
  2072         88  AUTO-PROMPT-TR                   VALUE '7'.
  2073         88  DENIAL-TR                        VALUE '8'.
  2074         88  INCURRED-CHG-TR                  VALUE '9'.
  2075         88  FORM-CONTROL-TR                  VALUE 'A'.
  2076
  2077     12  AT-RECORDED-DT                  PIC XX.
  2078     12  AT-RECORDED-BY                  PIC X(4).
  2079     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  2080
  2081     12  AT-TRAILER-BODY                 PIC X(165).
  2082
  2083     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  2084         16  AT-RESERVE-CONTROLS.
  2085             20  AT-MANUAL-SW            PIC X.
  2086                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  2087             20  AT-FUTURE-SW            PIC X.
  2088                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  2089             20  AT-PTC-SW               PIC X.
  2090                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  2091             20  AT-IBNR-SW              PIC X.
  2092                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  2093             20  AT-PTC-LF-SW            PIC X.
  2094                 88  AT-LF-PTC-USED          VALUE '1'.
  2095             20  AT-CDT-ACCESS-METHOD    PIC X.
  2096                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  2097                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  2098                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  2099             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  2100         16  AT-LAST-COMPUTED-DT         PIC XX.
  2101         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  2102         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  2103         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  2104         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  2105         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  43
* EL162.cbl
  2106         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  2107         16  AT-EXPENSE-CONTROLS.
  2108             20  AT-EXPENSE-METHOD       PIC X.
  2109                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  2110                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  2111                 88  PERCENT-OF-PMT           VALUE '3'.
  2112                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  2113             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  2114             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  2115         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  2116         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  2117
  2118         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  2119         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  2120
  2121*        16  FILLER                      PIC X(53).
  2122         16  FILLER                      PIC X(47).
  2123
  2124         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  2125         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  2126
  2127         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  2128             20  AT-OPEN-CLOSE-DATE      PIC XX.
  2129             20  AT-OPEN-CLOSE-TYPE      PIC X.
  2130*                    C = CLOSED
  2131*                    O = OPEN
  2132             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  2133*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  2134
  2135     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  2136         16  AT-PAYMENT-TYPE             PIC X.
  2137             88  PARTIAL-PAYMENT                VALUE '1'.
  2138             88  FINAL-PAYMENT                  VALUE '2'.
  2139             88  LUMP-SUM-PAYMENT               VALUE '3'.
  2140             88  ADDITIONAL-PAYMENT             VALUE '4'.
  2141             88  CHARGEABLE-EXPENSE             VALUE '5'.
  2142             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  2143             88  VOIDED-PAYMENT                 VALUE '9'.
  2144             88  TRANSFER                       VALUE 'T'.
  2145             88  LIFE-INTEREST                  VALUE 'I'.
  2146
  2147         16  AT-CLAIM-TYPE               PIC X.
  2148             88  PAID-FOR-AH                    VALUE 'A'.
  2149             88  PAID-FOR-LIFE                  VALUE 'L'.
  2150             88  PAID-FOR-IUI                   VALUE 'I'.
  2151             88  PAID-FOR-GAP                   VALUE 'G'.
  2152             88  PAID-FOR-FAM                   VALUE 'F'.
  2153         16  AT-CLAIM-PREM-TYPE          PIC X.
  2154             88  AT-SINGLE-PREMIUM              VALUE '1'.
  2155             88  AT-O-B-COVERAGE                VALUE '2'.
  2156             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  2157         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  2158         16  AT-CHECK-NO                 PIC X(7).
  2159         16  AT-PAID-FROM-DT             PIC XX.
  2160         16  AT-PAID-THRU-DT             PIC XX.
  2161         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  2162         16  FILLER                      PIC X.
  2163         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  44
* EL162.cbl
  2164         16  AT-PAYMENT-ORIGIN           PIC X.
  2165             88  ONLINE-MANUAL-PMT              VALUE '1'.
  2166             88  ONLINE-AUTO-PMT                VALUE '2'.
  2167             88  OFFLINE-PMT                    VALUE '3'.
  2168         16  AT-CHECK-WRITTEN-DT         PIC XX.
  2169         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  2170         16  AT-VOID-DATA.
  2171             20  AT-VOID-DT              PIC XX.
  2172*00144       20  AT-VOID-REASON          PIC X(30).
  2173             20  AT-VOID-REASON          PIC X(26).
  2174         16  AT-PMT-APPROVED-BY          PIC X(04).
  2175         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  2176         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  2177         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  2178                                         PIC S99V9(5)  COMP-3.
  2179         16  AT-CREDIT-INTERFACE.
  2180             20  AT-PMT-SELECT-DT        PIC XX.
  2181                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  2182             20  AT-PMT-ACCEPT-DT        PIC XX.
  2183                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  2184             20  AT-VOID-SELECT-DT       PIC XX.
  2185                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  2186             20  AT-VOID-ACCEPT-DT       PIC XX.
  2187                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  2188
  2189         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  2190                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  2191                 88  CONVERSION-PAYMENT           VALUE +99999999.
  2192         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  2193
  2194         16  AT-FORCE-CONTROL            PIC X.
  2195             88  PAYMENT-WAS-FORCED           VALUE '1'.
  2196         16  AT-PREV-LAST-PMT-DT         PIC XX.
  2197         16  AT-PREV-PAID-THRU-DT        PIC XX.
  2198         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  2199         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  2200         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  2201         16  AT-BENEFIT-TYPE             PIC X.
  2202
  2203         16  AT-EXPENSE-TYPE             PIC X.
  2204         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  2205
  2206         16  AT-PAYEE-TYPE-CD.
  2207             20  AT-PAYEE-TYPE           PIC X.
  2208                 88  INSURED-PAID           VALUE 'I'.
  2209                 88  BENEFICIARY-PAID       VALUE 'B'.
  2210                 88  ACCOUNT-PAID           VALUE 'A'.
  2211                 88  OTHER-1-PAID           VALUE 'O'.
  2212                 88  OTHER-2-PAID           VALUE 'Q'.
  2213                 88  DOCTOR-PAID            VALUE 'P'.
  2214                 88  EMPLOYER-PAID          VALUE 'E'.
  2215             20  AT-PAYEE-SEQ            PIC X.
  2216
  2217         16  AT-CASH-PAYMENT             PIC X.
  2218         16  AT-GROUPED-PAYMENT          PIC X.
  2219         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  2220         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  2221         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  45
* EL162.cbl
  2222         16  AT-VOID-TYPE                PIC X.
  2223             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  2224             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  2225         16  AT-AIG-UNEMP-IND            PIC X.
  2226             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  2227         16  AT-ASSOCIATES               PIC X.
  2228             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  2229             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  2230
  2231         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  2232         16  AT-CV-PMT-CODE              PIC X.
  2233             88  FULL-DEATH-PAYMENT         VALUE '1'.
  2234             88  HALF-DEATH-PAYMENT         VALUE '2'.
  2235             88  FULL-ADD-PAYMENT           VALUE '3'.
  2236             88  HALF-ADD-PAYMENT           VALUE '4'.
  2237             88  FULL-RIDER-PAYMENT         VALUE '5'.
  2238             88  HALF-RIDER-PAYMENT         VALUE '6'.
  2239             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  2240             88  ADDL-PAYMENT               VALUE '8'.
  2241
  2242         16  AT-EOB-CODE1                PIC XXX.
  2243         16  AT-EOB-CODE2                PIC XXX.
  2244         16  AT-EOB-CODE3                PIC XXX.
  2245         16  FILLER REDEFINES AT-EOB-CODE3.
  2246             20  AT-PRINT-CLM-FORM       PIC X.
  2247             20  AT-PRINT-SURVEY         PIC X.
  2248             20  AT-SPECIAL-RELEASE      PIC X.
  2249         16  AT-EOB-CODE4                PIC XXX.
  2250         16  FILLER REDEFINES AT-EOB-CODE4.
  2251             20  AT-INT-PMT-SELECT-DT    PIC XX.
  2252             20  FILLER                  PIC X.
  2253         16  AT-EOB-CODE5                PIC XXX.
  2254         16  FILLER REDEFINES AT-EOB-CODE5.
  2255             20  AT-PMT-PROOF-DT         PIC XX.
  2256             20  FILLER                  PIC X.
  2257
  2258         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  2259             88  AT-PRINT-EOB            VALUE 'Y'.
  2260
  2261         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  2262         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  2263
  2264     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  2265         16  AT-SCHEDULE-START-DT        PIC XX.
  2266         16  AT-SCHEDULE-END-DT          PIC XX.
  2267         16  AT-TERMINATED-DT            PIC XX.
  2268         16  AT-LAST-PMT-TYPE            PIC X.
  2269             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  2270             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  2271         16  AT-FIRST-PMT-DATA.
  2272             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  2273             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  2274             20  AT-1ST-PAY-THRU-DT      PIC XX.
  2275         16  AT-REGULAR-PMT-DATA.
  2276             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  2277             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  2278             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  2279         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  46
* EL162.cbl
  2280             20  AT-AUTO-PAYEE-TYPE      PIC X.
  2281                 88  INSURED-PAID-AUTO      VALUE 'I'.
  2282                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  2283                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  2284                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  2285                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  2286             20  AT-AUTO-PAYEE-SEQ       PIC X.
  2287         16  AT-AUTO-PAY-DAY             PIC 99.
  2288         16  AT-AUTO-CASH                PIC X.
  2289             88  AT-CASH                      VALUE 'Y'.
  2290             88  AT-NON-CASH                  VALUE 'N'.
  2291*        16  FILLER                      PIC X(129).
  2292         16  AT-AUTO-END-LETTER          PIC X(4).
  2293         16  FILLER                      PIC X(125).
  2294
  2295         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  2296         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  2297
  2298     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  2299         16  AT-LETTER-SENT-DT           PIC XX.
  2300         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  2301         16  AT-AUTO-RE-SEND-DT          PIC XX.
  2302         16  AT-LETTER-ANSWERED-DT       PIC XX.
  2303         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  2304         16  AT-LETTER-ORIGIN            PIC X.
  2305             88  ONLINE-CREATION              VALUE '1' '3'.
  2306             88  OFFLINE-CREATION             VALUE '2' '4'.
  2307             88  NAPER-ONLINE-CREATION        VALUE '3'.
  2308             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  2309         16  AT-STD-LETTER-FORM          PIC X(4).
  2310         16  AT-REASON-TEXT              PIC X(70).
  2311         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  2312         16  AT-ADDRESEE-TYPE            PIC X.
  2313              88  INSURED-ADDRESEE            VALUE 'I'.
  2314              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  2315              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  2316              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  2317              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  2318              88  OTHER-ADDRESEE-1            VALUE 'O'.
  2319              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  2320         16  AT-ADDRESSEE-NAME           PIC X(30).
  2321         16  AT-INITIAL-PRINT-DATE       PIC XX.
  2322         16  AT-RESEND-PRINT-DATE        PIC XX.
  2323         16  AT-CORR-SOL-UNSOL           PIC X.
  2324         16  AT-LETTER-PURGED-DT         PIC XX.
  2325*
  2326*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  2327*
  2328         16  AT-CSO-REDEFINITION.
  2329             20  AT-RESEND-LETTER-FORM   PIC X(4).
  2330             20  AT-AUTO-CLOSE-IND       PIC X(1).
  2331             20  AT-LETTER-TO-BENE       PIC X(1).
  2332             20  AT-STOP-LETTER-DT       PIC X(2).
  2333             20  FILLER                  PIC X(19).
  2334*             20  FILLER                  PIC X(27).
  2335             20  AT-CSO-LETTER-STATUS    PIC X.
  2336                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  2337                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  47
* EL162.cbl
  2338                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  2339             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  2340             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  2341*
  2342*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  2343*
  2344*        16  FILLER                      PIC X(26).
  2345*
  2346*        16  AT-DMD-BSR-CODE             PIC X.
  2347*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  2348*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  2349*
  2350*        16  AT-DMD-LETTER-STATUS        PIC X.
  2351*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  2352*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  2353*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  2354*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  2355*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  2356
  2357         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  2358         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  2359
  2360     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  2361         16  AT-ADDRESS-TYPE             PIC X.
  2362             88  INSURED-ADDRESS               VALUE 'I'.
  2363             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  2364             88  ACCOUNT-ADDRESS               VALUE 'A'.
  2365             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  2366             88  EMPLOYER-ADDRESS              VALUE 'E'.
  2367             88  OTHER-ADDRESS-1               VALUE 'O'.
  2368             88  OTHER-ADDRESS-2               VALUE 'Q'.
  2369         16  AT-MAIL-TO-NAME             PIC X(30).
  2370         16  AT-ADDRESS-LINE-1           PIC X(30).
  2371         16  AT-ADDRESS-LINE-2           PIC X(30).
  2372         16  AT-CITY-STATE.
  2373             20  AT-CITY                 PIC X(28).
  2374             20  AT-STATE                PIC XX.
  2375         16  AT-ZIP.
  2376             20  AT-ZIP-CODE.
  2377                 24  AT-ZIP-1ST          PIC X.
  2378                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2379                 24  FILLER              PIC X(4).
  2380             20  AT-ZIP-PLUS4            PIC X(4).
  2381         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  2382             20  AT-CAN-POSTAL-1         PIC XXX.
  2383             20  AT-CAN-POSTAL-2         PIC XXX.
  2384             20  FILLER                  PIC XXX.
  2385         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  2386*         16  FILLER                      PIC X(23).
  2387         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  2388         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  2389         16  FILLER                      PIC X(13).
  2390         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  2391         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  2392
  2393     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  2394         16  AT-INFO-LINE-1              PIC X(60).
  2395         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  48
* EL162.cbl
  2396             20  AT-NOTE-ERROR-NO OCCURS 15
  2397                                         PIC X(4).
  2398         16  AT-INFO-LINE-2              PIC X(60).
  2399         16  FILLER REDEFINES AT-INFO-LINE-2.
  2400             20  AT-ICD-CODE-1           PIC X(8).
  2401             20  AT-ICD-CODE-2           PIC X(8).
  2402             20  FILLER                  PIC X(44).
  2403         16  AT-INFO-TRAILER-TYPE        PIC X.
  2404             88  AT-ERRORS-NOTE          VALUE 'E'.
  2405             88  AT-PAYMENT-NOTE         VALUE 'P'.
  2406             88  AT-CALL-NOTE            VALUE 'C'.
  2407             88  AT-MAINT-NOTE           VALUE 'M'.
  2408             88  AT-CERT-CHANGE          VALUE 'X'.
  2409             88  AT-APPROVAL-NOTE        VALUE 'R'.
  2410             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  2411             88  AT-CERT-CANCELLED       VALUE 'T'.
  2412         16  AT-CALL-TYPE                PIC X.
  2413             88  AT-PHONE-CALL-IN        VALUE 'I'.
  2414             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  2415         16  AT-NOTE-CONTINUATION        PIC X.
  2416             88  AT-CONTINUED-NOTE       VALUE 'X'.
  2417         16  AT-EOB-CODES-EXIST          PIC X.
  2418             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  2419         16  FILLER                      PIC X(35).
  2420         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  2421         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  2422
  2423     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  2424         16  AT-PROMPT-LINE-1            PIC X(60).
  2425         16  AT-PROMPT-LINE-2            PIC X(60).
  2426         16  AT-PROMPT-START-DT          PIC XX.
  2427         16  AT-PROMPT-END-DT            PIC XX.
  2428         16  FILLER                      PIC X(35).
  2429         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  2430         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  2431
  2432     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  2433         16  AT-DENIAL-INFO-1            PIC X(60).
  2434         16  AT-DENIAL-INFO-2            PIC X(60).
  2435         16  AT-DENIAL-DT                PIC XX.
  2436         16  AT-RETRACTION-DT            PIC XX.
  2437         16  AT-DENIAL-REASON-CODE       PIC X(4).
  2438*         16  FILLER                      PIC X(31).
  2439         16  AT-DENIAL-PROOF-DT          PIC XX.
  2440         16  FILLER                      PIC X(29).
  2441         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  2442         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  2443
  2444     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  2445         16  AT-OLD-INCURRED-DT          PIC XX.
  2446         16  AT-OLD-REPORTED-DT          PIC XX.
  2447         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  2448         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  2449         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  2450         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  2451         16  AT-OLD-PAID-THRU-DT         PIC XX.
  2452         16  AT-LAST-PMT-MADE-DT         PIC XX.
  2453         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  49
* EL162.cbl
  2454         16  AT-OLD-DIAG-CODE            PIC X(6).
  2455         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  2456         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  2457         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  2458         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  2459         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  2460         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  2461         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  2462         16  AT-OLD-ICD-CODE-1           PIC X(8).
  2463         16  AT-OLD-ICD-CODE-2           PIC X(8).
  2464         16  FILLER                      PIC X(9).
  2465         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  2466
  2467     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  2468         16  AT-FORM-SEND-ON-DT          PIC XX.
  2469         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  2470         16  AT-FORM-RE-SEND-DT          PIC XX.
  2471         16  AT-FORM-ANSWERED-DT         PIC XX.
  2472         16  AT-FORM-PRINTED-DT          PIC XX.
  2473         16  AT-FORM-REPRINT-DT          PIC XX.
  2474         16  AT-FORM-TYPE                PIC X.
  2475             88  INITIAL-FORM                  VALUE '1'.
  2476             88  PROGRESS-FORM                 VALUE '2'.
  2477         16  AT-INSTRUCT-LN-1            PIC X(28).
  2478         16  AT-INSTRUCT-LN-2            PIC X(28).
  2479         16  AT-INSTRUCT-LN-3            PIC X(28).
  2480         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  2481         16  AT-FORM-ADDRESS             PIC X.
  2482             88  FORM-TO-INSURED              VALUE 'I'.
  2483             88  FORM-TO-ACCOUNT              VALUE 'A'.
  2484             88  FORM-TO-OTHER-1              VALUE 'O'.
  2485             88  FORM-TO-OTHER-2              VALUE 'Q'.
  2486         16  AT-RELATED-1.
  2487             20 AT-REL-CARR-1            PIC X.
  2488             20 AT-REL-CLAIM-1           PIC X(7).
  2489             20 AT-REL-CERT-1            PIC X(11).
  2490         16  AT-RELATED-2.
  2491             20 AT-REL-CARR-2            PIC X.
  2492             20 AT-REL-CLAIM-2           PIC X(7).
  2493             20 AT-REL-CERT-2            PIC X(11).
  2494         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  2495         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  2496         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  2497         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  2498         16  AT-FORM-REM-PRINT-DT        PIC XX.
  2499         16  AT-STOP-FORM-DT             PIC X(2).
  2500
  2501         16  FILLER                      PIC X(09).
  2502         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  2503         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  2504******************************************************************
  2505
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  50
* EL162.cbl
  2507*                            COPY ERCACCT.
  2508******************************************************************
  2509*                                                                *
  2510*                                                                *
  2511*                            ERCACCT                             *
  2512*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2513*                            VMOD=2.031                          *
  2514*                                                                *
  2515*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2516*                                                                *
  2517*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2518*   VSAM ACCOUNT MASTER FILES.                                   *
  2519*                                                                *
  2520*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2521*                                                                *
  2522*   FILE TYPE = VSAM,KSDS                                        *
  2523*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2524*                                                                *
  2525*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2526*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2527*                                                                *
  2528*   LOG = NO                                                     *
  2529*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2530*                                                                *
  2531*                                                                *
  2532******************************************************************
  2533*                   C H A N G E   L O G
  2534*
  2535* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2536*-----------------------------------------------------------------
  2537*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2538* EFFECTIVE    NUMBER
  2539*-----------------------------------------------------------------
  2540* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2541* 092705    2005050300006  PEMA  ADD SPP LEASES
  2542* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2543* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2544* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2545* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2546* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2547******************************************************************
  2548
  2549 01  ACCOUNT-MASTER.
  2550     12  AM-RECORD-ID                      PIC XX.
  2551         88  VALID-AM-ID                      VALUE 'AM'.
  2552
  2553     12  AM-CONTROL-PRIMARY.
  2554         16  AM-COMPANY-CD                 PIC X.
  2555         16  AM-MSTR-CNTRL.
  2556             20  AM-CONTROL-A.
  2557                 24  AM-CARRIER            PIC X.
  2558                 24  AM-GROUPING.
  2559                     28 AM-GROUPING-PREFIX PIC XXX.
  2560                     28 AM-GROUPING-PRIME  PIC XXX.
  2561                 24  AM-STATE              PIC XX.
  2562                 24  AM-ACCOUNT.
  2563                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2564                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  51
* EL162.cbl
  2565             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2566                                           PIC X(19).
  2567             20  AM-CNTRL-B.
  2568                 24  AM-EXPIRATION-DT      PIC XX.
  2569                 24  FILLER                PIC X(4).
  2570             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2571                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2572
  2573     12  AM-CONTROL-BY-VAR-GRP.
  2574         16  AM-COMPANY-CD-A1              PIC X.
  2575         16  AM-VG-CARRIER                 PIC X.
  2576         16  AM-VG-GROUPING                PIC X(6).
  2577         16  AM-VG-STATE                   PIC XX.
  2578         16  AM-VG-ACCOUNT                 PIC X(10).
  2579         16  AM-VG-DATE.
  2580             20  AM-VG-EXPIRATION-DT       PIC XX.
  2581             20  FILLER                    PIC X(4).
  2582         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2583                                           PIC 9(11)      COMP-3.
  2584     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2585         16  FILLER                        PIC X(10).
  2586         16  AM-VG-KEY3.
  2587             20  AM-VG3-ACCOUNT            PIC X(10).
  2588             20  AM-VG3-EXP-DT             PIC XX.
  2589         16  FILLER                        PIC X(4).
  2590     12  AM-MAINT-INFORMATION.
  2591         16  AM-LAST-MAINT-DT              PIC XX.
  2592         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2593         16  AM-LAST-MAINT-USER            PIC X(4).
  2594         16  FILLER                        PIC XX.
  2595
  2596     12  AM-EFFECTIVE-DT                   PIC XX.
  2597     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2598
  2599     12  AM-PREV-DATES  COMP-3.
  2600         16  AM-PREV-EXP-DT                PIC 9(11).
  2601         16  AM-PREV-EFF-DT                PIC 9(11).
  2602
  2603     12  AM-REPORT-CODE-1                  PIC X(10).
  2604     12  AM-REPORT-CODE-2                  PIC X(10).
  2605
  2606     12  AM-CITY-CODE                      PIC X(4).
  2607     12  AM-COUNTY-PARISH                  PIC X(6).
  2608
  2609     12  AM-NAME                           PIC X(30).
  2610     12  AM-PERSON                         PIC X(30).
  2611     12  AM-ADDRS                          PIC X(30).
  2612     12  AM-CITY.
  2613         16  AM-ADDR-CITY                  PIC X(28).
  2614         16  AM-ADDR-STATE                 PIC XX.
  2615     12  AM-ZIP.
  2616         16  AM-ZIP-PRIME.
  2617             20  AM-ZIP-PRI-1ST            PIC X.
  2618                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2619             20  FILLER                    PIC X(4).
  2620         16  AM-ZIP-PLUS4                  PIC X(4).
  2621     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2622         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  52
* EL162.cbl
  2623         16  AM-CAN-POSTAL-2               PIC XXX.
  2624         16  FILLER                        PIC XXX.
  2625     12  AM-TEL-NO.
  2626         16  AM-AREA-CODE                  PIC 999.
  2627         16  AM-TEL-PRE                    PIC 999.
  2628         16  AM-TEL-NBR                    PIC 9(4).
  2629     12  AM-TEL-LOC                        PIC X.
  2630         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2631         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2632
  2633     12  AM-COMM-STRUCTURE.
  2634         16  AM-DEFN-1.
  2635             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2636                 24  AM-AGT.
  2637                     28  AM-AGT-PREFIX     PIC X(4).
  2638                     28  AM-AGT-PRIME      PIC X(6).
  2639                 24  AM-COM-TYP            PIC X.
  2640                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2641                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2642                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2643                 24  AM-RECALC-LV-INDIC    PIC X.
  2644                 24  AM-RETRO-LV-INDIC     PIC X.
  2645                 24  AM-GL-CODES           PIC X.
  2646                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2647                 24  FILLER                PIC X(01).
  2648         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2649             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2650                 24  FILLER                PIC X(11).
  2651                 24  AM-L-COMA             PIC XXX.
  2652                 24  AM-J-COMA             PIC XXX.
  2653                 24  AM-A-COMA             PIC XXX.
  2654                 24  FILLER                PIC X(6).
  2655
  2656     12  AM-COMM-CHANGE-STATUS             PIC X.
  2657         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2658
  2659     12  AM-CSR-CODE                       PIC X(4).
  2660
  2661     12  AM-BILLING-STATUS                 PIC X.
  2662         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2663         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2664     12  AM-AUTO-REFUND-SW                 PIC X.
  2665         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2666         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2667     12  AM-GPCD                           PIC 99.
  2668     12  AM-IG                             PIC X.
  2669         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2670         88  AM-HAS-GROUP                     VALUE '2'.
  2671     12  AM-STATUS                         PIC X.
  2672         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2673         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2674         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2675         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2676         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2677         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2678     12  AM-REMIT-TO                       PIC 99.
  2679     12  AM-ID-NO                          PIC X(11).
  2680
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  53
* EL162.cbl
  2681     12  AM-CAL-TABLE                      PIC XX.
  2682     12  AM-LF-DEVIATION                   PIC XXX.
  2683     12  AM-AH-DEVIATION                   PIC XXX.
  2684     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2685     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2686     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2687     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2688     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2689     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2690
  2691     12  AM-USER-FIELDS.
  2692         16  AM-FLD-1                      PIC XX.
  2693         16  AM-FLD-2                      PIC XX.
  2694         16  AM-FLD-3                      PIC XX.
  2695         16  AM-FLD-4                      PIC XX.
  2696         16  AM-FLD-5                      PIC XX.
  2697
  2698     12  AM-1ST-PROD-DATE.
  2699         16  AM-1ST-PROD-YR                PIC XX.
  2700         16  AM-1ST-PROD-MO                PIC XX.
  2701         16  AM-1ST-PROD-DA                PIC XX.
  2702     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2703     12  AM-CERTS-PURGED-DATE.
  2704         16  AM-PUR-YR                     PIC XX.
  2705         16  AM-PUR-MO                     PIC XX.
  2706         16  AM-PUR-DA                     PIC XX.
  2707     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2708     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2709     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2710     12  AM-INACTIVE-DATE.
  2711         16  AM-INA-MO                     PIC 99.
  2712         16  AM-INA-DA                     PIC 99.
  2713         16  AM-INA-YR                     PIC 99.
  2714     12  AM-AR-HI-CERT-DATE                PIC XX.
  2715
  2716     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2717     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2718
  2719     12  AM-OB-PAYMENT-MODE                PIC X.
  2720         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2721         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2722         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2723         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2724
  2725     12  AM-AH-ONLY-INDICATOR              PIC X.
  2726         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2727         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2728
  2729     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2730
  2731     12  AM-OVER-SHORT.
  2732         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2733         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2734
  2735     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2736     12  AM-DCC-CLP-STATE                  PIC XX.
  2737
  2738     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  54
* EL162.cbl
  2739     12  AM-RECALC-REIN                    PIC X.
  2740
  2741     12  AM-REI-TABLE                      PIC XXX.
  2742     12  AM-REI-ET-LF                      PIC X.
  2743     12  AM-REI-ET-AH                      PIC X.
  2744     12  AM-REI-PE-LF                      PIC X.
  2745     12  AM-REI-PE-AH                      PIC X.
  2746     12  AM-REI-PRT-ST                     PIC X.
  2747     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2748     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2749     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2750     12  AM-REI-GROUP-A                    PIC X(6).
  2751     12  AM-REI-MORT                       PIC X(4).
  2752     12  AM-REI-PRT-OW                     PIC X.
  2753     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2754     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2755     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2756     12  AM-REI-GROUP-B                    PIC X(6).
  2757
  2758     12  AM-TRUST-TYPE                     PIC X(2).
  2759
  2760     12  AM-EMPLOYER-STMT-USED             PIC X.
  2761     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2762
  2763     12  AM-STD-AH-TYPE                    PIC XX.
  2764     12  AM-EARN-METHODS.
  2765         16  AM-EARN-METHOD-R              PIC X.
  2766             88 AM-REF-RL-R78                 VALUE 'R'.
  2767             88 AM-REF-RL-PR                  VALUE 'P'.
  2768             88 AM-REF-RL-MEAN                VALUE 'M'.
  2769             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2770         16  AM-EARN-METHOD-L              PIC X.
  2771             88 AM-REF-LL-R78                 VALUE 'R'.
  2772             88 AM-REF-LL-PR                  VALUE 'P'.
  2773             88 AM-REF-LL-MEAN                VALUE 'M'.
  2774             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2775         16  AM-EARN-METHOD-A              PIC X.
  2776             88 AM-REF-AH-R78                 VALUE 'R'.
  2777             88 AM-REF-AH-PR                  VALUE 'P'.
  2778             88 AM-REF-AH-MEAN                VALUE 'M'.
  2779             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2780             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2781             88 AM-REF-AH-NET                 VALUE 'N'.
  2782
  2783     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2784     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2785     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2786
  2787     12  AM-RET-Y-N                        PIC X.
  2788     12  AM-RET-P-E                        PIC X.
  2789     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2790     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2791     12  AM-RET-GRP                        PIC X(6).
  2792     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2793         16  AM-POOL-PRIME                 PIC XXX.
  2794         16  AM-POOL-SUB                   PIC XXX.
  2795     12  AM-RETRO-EARNINGS.
  2796         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  55
* EL162.cbl
  2797         16  AM-RET-EARN-L                 PIC X.
  2798         16  AM-RET-EARN-A                 PIC X.
  2799     12  AM-RET-ST-TAX-USE                 PIC X.
  2800         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2801         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2802     12  AM-RETRO-BEG-EARNINGS.
  2803         16  AM-RET-BEG-EARN-R             PIC X.
  2804         16  AM-RET-BEG-EARN-L             PIC X.
  2805         16  AM-RET-BEG-EARN-A             PIC X.
  2806     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2807     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2808
  2809     12  AM-USER-SELECT-OPTIONS.
  2810         16  AM-USER-SELECT-1              PIC X(10).
  2811         16  AM-USER-SELECT-2              PIC X(10).
  2812         16  AM-USER-SELECT-3              PIC X(10).
  2813         16  AM-USER-SELECT-4              PIC X(10).
  2814         16  AM-USER-SELECT-5              PIC X(10).
  2815
  2816     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2817
  2818     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2819
  2820     12  AM-RPT045A-SWITCH                 PIC X.
  2821         88  RPT045A-OFF                   VALUE 'N'.
  2822
  2823     12  AM-INSURANCE-LIMITS.
  2824         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2825         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2826
  2827     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2828         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2829
  2830     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2831         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2832         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2833
  2834     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2835
  2836     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2837     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2838     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2839     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2840     12  AM-DCC-UEF-STATE                  PIC XX.
  2841     12  FILLER                            PIC XXX.
  2842     12  AM-REPORT-CODE-3                  PIC X(10).
  2843*    12  FILLER                            PIC X(22).
  2844
  2845     12  AM-RESERVE-DATE.
  2846         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2847         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2848         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2849
  2850     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2851     12  AM-NOTIFICATION-TYPES.
  2852         16  AM-NOTIF-OF-LETTERS           PIC X.
  2853         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2854         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  56
* EL162.cbl
  2855         16  AM-NOTIF-OF-STATUS            PIC X.
  2856
  2857     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2858         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2859         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2860         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2861         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2862
  2863     12  AM-BENEFIT-CONTROLS.
  2864         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2865             20  AM-BENEFIT-CODE           PIC XX.
  2866             20  AM-BENEFIT-TYPE           PIC X.
  2867             20  AM-BENEFIT-REVISION       PIC XXX.
  2868             20  AM-BENEFIT-REM-TERM       PIC X.
  2869             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2870             20  FILLER                    PIC XX.
  2871         16  FILLER                        PIC X(80).
  2872
  2873     12  AM-TRANSFER-DATA.
  2874         16  AM-TRANSFERRED-FROM.
  2875             20  AM-TRNFROM-CARRIER        PIC X.
  2876             20  AM-TRNFROM-GROUPING.
  2877                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2878                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2879             20  AM-TRNFROM-STATE          PIC XX.
  2880             20  AM-TRNFROM-ACCOUNT.
  2881                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2882                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2883             20  AM-TRNFROM-DTE            PIC XX.
  2884         16  AM-TRANSFERRED-TO.
  2885             20  AM-TRNTO-CARRIER          PIC X.
  2886             20  AM-TRNTO-GROUPING.
  2887                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2888                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2889             20  AM-TRNTO-STATE            PIC XX.
  2890             20  AM-TRNTO-ACCOUNT.
  2891                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2892                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2893             20  AM-TRNTO-DTE              PIC XX.
  2894         16  FILLER                        PIC X(10).
  2895
  2896     12  AM-SAVED-REMIT-TO                 PIC 99.
  2897
  2898     12  AM-COMM-STRUCTURE-SAVED.
  2899         16  AM-DEFN-1-SAVED.
  2900             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2901                 24  AM-AGT-SV             PIC X(10).
  2902                 24  AM-COM-TYP-SV         PIC X.
  2903                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2904                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2905                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2906                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2907                 24  FILLER                PIC X.
  2908                 24  AM-GL-CODES-SV        PIC X.
  2909                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2910                 24  FILLER                PIC X.
  2911         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2912             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  57
* EL162.cbl
  2913                 24  FILLER                PIC X(11).
  2914                 24  AM-L-COMA-SV          PIC XXX.
  2915                 24  AM-J-COMA-SV          PIC XXX.
  2916                 24  AM-A-COMA-SV          PIC XXX.
  2917                 24  FILLER                PIC X(6).
  2918
  2919     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2920         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2921            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2922            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2923            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2924
  2925     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2926     12  FILLER                            PIC X(120).
  2927
  2928     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2929         16  AM-CONTROL-NAME               PIC X(30).
  2930         16  AM-EXECUTIVE-ONE.
  2931             20  AM-EXEC1-NAME             PIC X(15).
  2932             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2933                                                          COMP-3.
  2934             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2935                                                          COMP-3.
  2936         16  AM-EXECUTIVE-TWO.
  2937             20  AM-EXEC2-NAME             PIC X(15).
  2938             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2939                                                          COMP-3.
  2940             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2941                                                          COMP-3.
  2942
  2943     12  AM-RETRO-ADDITIONAL-DATA.
  2944         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2945         16  AM-RETRO-PREM-P-E             PIC X.
  2946         16  AM-RETRO-CLMS-P-I             PIC X.
  2947         16  AM-RETRO-RET-BRACKET-LF.
  2948             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2949                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2950                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2951             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2952                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2953                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2954             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2955                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2956                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2957         16  AM-RETRO-RET-BRACKET-AH.
  2958             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2959                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2960                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2961                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2962             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2963                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2964                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2965             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2966                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2967                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2968
  2969     12  AM-COMMENTS.
  2970         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  58
* EL162.cbl
  2971
  2972     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2973         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2974         16  AM-FLI-BILLING-CODE           PIC X.
  2975         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2976         16  AM-FLI-UNITED-IDENT           PIC X.
  2977         16  AM-FLI-INTEREST-LOST-DATA.
  2978             20  AM-FLI-BANK-NO            PIC X(5).
  2979             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2980             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2981             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2982         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2983             20  AM-FLI-AGT                PIC X(9).
  2984             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2985             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2986         16  FILLER                        PIC X(102).
  2987
  2988     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2989         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2990             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2991             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2992             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2993             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2994             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2995         16  FILLER                          PIC X(10).
  2996******************************************************************
  2997
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  59
* EL162.cbl
  2999 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  3000                          ACTIVITY-TRAILERS ACCOUNT-MASTER.
  3001 0000-DFHEXIT SECTION.
  3002     MOVE '9#                    $   ' TO DFHEIV0.
  3003     MOVE 'EL162' TO DFHEIV1.
  3004     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3005
  3006     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  3007     MOVE '5'                   TO DC-OPTION-CODE.
  3008     PERFORM 9700-DATE-LINK.
  3009     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  3010     MOVE DC-BIN-DATE-1         TO  BIN-CURRENT-DATE.
  3011
  3012     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  3013
  3014     IF PI-COMPANY-ID = 'DMD'
  3015         MOVE -1                TO  DC-ELAPSED-MONTHS
  3016         MOVE +0                TO  DC-ELAPSED-DAYS
  3017         MOVE '6'               TO  DC-OPTION-CODE
  3018         PERFORM 9700-DATE-LINK
  3019         MOVE DC-BIN-DATE-2     TO  CURRENT-MINUS1-SAVE.
  3020
  3021     IF EIBCALEN NOT GREATER THAN ZERO
  3022         GO TO 8800-UNAUTHORIZED-ACCESS.
  3023
  3024     IF PI-CALLING-PROGRAM = PGM-EL150
  3025         MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  3026         MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  3027         MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  3028         MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  3029         MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  3030         MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  3031         MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  3032         MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  3033         MOVE +1                   TO SUB
  3034         PERFORM  2000-ZERO-PI-TRLR-TABLE THRU 2010-EXIT
  3035         MOVE LOW-VALUES           TO EL162AO
  3036                                      PI-DISPLAYED-TRAILER-CODES
  3037         MOVE 1                    TO PI-ACTV-SEQ
  3038                                      PI-NEXT-TRLR-SUB
  3039         GO TO 7000-BUILD-SCREEN.
  3040
  3041     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3042         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3043************ FIRST TIME IN FROM MENU, FORCE THE CLAIM
  3044************ TO BE DESIGNATED THRU EL132.
  3045             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  3046             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  3047             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  3048             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  3049             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  3050             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  3051             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  3052             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  3053             MOVE PGM-EL132            TO PGM-NAME
  3054             GO TO 9300-XCTL
  3055         ELSE
  3056             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  60
* EL162.cbl
  3057             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  3058             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  3059             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  3060             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  3061             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  3062             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  3063             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  3064             MOVE +1                   TO SUB
  3065             PERFORM  2000-ZERO-PI-TRLR-TABLE THRU 2010-EXIT
  3066             MOVE LOW-VALUES           TO EL162AO
  3067                                       PI-DISPLAYED-TRAILER-CODES
  3068             MOVE 1                    TO PI-ACTV-SEQ
  3069                                          PI-NEXT-TRLR-SUB
  3070             GO TO 7000-BUILD-SCREEN.
  3071
  3072     IF EIBAID = DFHCLEAR
  3073         GO TO 9400-CLEAR.
  3074
  3075
  3076* EXEC CICS HANDLE CONDITION
  3077*        PGMIDERR(9600-PGMID-ERROR)
  3078*        ERROR   (9990-ABEND)
  3079*    END-EXEC.
  3080*    MOVE '"$L.                  ! " #00003071' TO DFHEIV0
  3081     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  3082     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3083     MOVE X'2220233030303033303731' TO DFHEIV0(25:11)
  3084     CALL 'kxdfhei1' USING DFHEIV0
  3085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3086
  3087
  3088     IF PI-PROCESSOR-ID = 'LGXX'
  3089         GO TO 0200-RECEIVE.
  3090
  3091
  3092* EXEC CICS READQ TS
  3093*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  3094*        INTO    (SECURITY-CONTROL)
  3095*        LENGTH  (SC-COMM-LENGTH)
  3096*        ITEM    (SC-ITEM)
  3097*    END-EXEC.
  3098*    MOVE '*$II   L              ''   #00003079' TO DFHEIV0
  3099     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3100     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3101     MOVE X'2020233030303033303739' TO DFHEIV0(25:11)
  3102     CALL 'kxdfhei1' USING DFHEIV0,
  3103           PI-SECURITY-TEMP-STORE-ID,
  3104           SECURITY-CONTROL,
  3105           SC-COMM-LENGTH,
  3106           SC-ITEM,
  3107           DFHEIV99,
  3108           DFHEIV99
  3109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3110
  3111
  3112     MOVE SC-CLAIMS-DISPLAY (2)    TO  PI-DISPLAY-CAP.
  3113     MOVE SC-CLAIMS-UPDATE  (2)    TO  PI-MODIFY-CAP.
  3114
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  61
* EL162.cbl
  3115     IF NOT MODIFY-CAP
  3116         MOVE 'UPDATE'             TO  SM-READ
  3117         PERFORM 9995-SECURITY-VIOLATION
  3118         MOVE ER-0070              TO  EMI-ERROR
  3119         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3120         GO TO 8100-SEND-INITIAL-MAP.
  3121
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  62
* EL162.cbl
  3123 0200-RECEIVE.
  3124
  3125     MOVE LOW-VALUES TO EL162AI.
  3126
  3127     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  3128         MOVE ER-0008            TO EMI-ERROR
  3129         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3130         GO TO 8200-SEND-DATAONLY.
  3131
  3132
  3133* EXEC CICS RECEIVE
  3134*        MAP   (MAP-NAME)
  3135*        MAPSET(MAPSET-NAME)
  3136*        INTO  (EL162AI)
  3137*    END-EXEC.
  3138     MOVE LENGTH OF
  3139      EL162AI
  3140       TO DFHEIV11
  3141*    MOVE '8"T I  L              ''   #00003106' TO DFHEIV0
  3142     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3143     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3144     MOVE X'2020233030303033313036' TO DFHEIV0(25:11)
  3145     CALL 'kxdfhei1' USING DFHEIV0,
  3146           MAP-NAME,
  3147           EL162AI,
  3148           DFHEIV11,
  3149           MAPSET-NAME,
  3150           DFHEIV99,
  3151           DFHEIV99
  3152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3153
  3154
  3155     IF ENTERPFL = ZERO
  3156         GO TO 0300-CHECK-PFKEYS.
  3157
  3158     IF EIBAID NOT = DFHENTER
  3159         MOVE ER-0004            TO EMI-ERROR
  3160         GO TO 0320-INPUT-ERROR.
  3161
  3162     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  3163         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  3164     ELSE
  3165         MOVE ER-0029            TO EMI-ERROR
  3166         GO TO 0320-INPUT-ERROR.
  3167
  3168 0300-CHECK-PFKEYS.
  3169     IF EIBAID = DFHPF23
  3170         GO TO 8810-PF23.
  3171
  3172     IF EIBAID = DFHPF24
  3173         GO TO 9200-RETURN-MAIN-MENU.
  3174
  3175     IF EIBAID = DFHPF12
  3176         GO TO 9500-PF12.
  3177
  3178     IF PI-COMPANY-ID = 'DMD'
  3179         MOVE SPACE              TO PI-DMD-FORCE-ERROR.
  3180
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  63
* EL162.cbl
  3181     IF EIBAID = DFHPF4
  3182         IF PI-COMPANY-ID NOT = 'DMD'
  3183             MOVE ER-0029        TO EMI-ERROR
  3184             GO TO 0320-INPUT-ERROR
  3185         ELSE
  3186             MOVE 'X'            TO PI-DMD-FORCE-ERROR
  3187             MOVE DFHENTER       TO EIBAID
  3188             GO TO 0330-EDIT-DATA.
  3189
  3190     IF EIBAID = DFHPF5
  3191         IF PI-RETURN-TO-PROGRAM = 'EL150'
  3192             MOVE ER-0029        TO EMI-ERROR
  3193             GO TO 0320-INPUT-ERROR
  3194         ELSE
  3195             MOVE LOW-VALUES     TO PI-PROGRAM-WORK-AREA
  3196             MOVE PGM-EL132      TO PGM-NAME
  3197             GO TO 9300-XCTL.
  3198
  3199     IF PI-CLAIM-NO = SPACES
  3200        MOVE ER-0319             TO EMI-ERROR
  3201        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3202        GO TO 8100-SEND-INITIAL-MAP.
  3203
  3204     IF SC-RECL (1) > 0 OR SC-STOPL (1) > 0 OR
  3205        SC-RECL (2) > 0 OR SC-STOPL (2) > 0 OR
  3206        SC-RECL (3) > 0 OR SC-STOPL (3) > 0 OR
  3207        SC-RECL (4) > 0 OR SC-STOPL (4) > 0 OR
  3208        UREL > 0  OR USENTL > 0  OR
  3209*00409         UBYL > 0  OR UFORML > 0  OR URECDTEL > 0
  3210        UFORML > 0  OR URECDTEL > 0
  3211          IF EIBAID NOT = DFHENTER
  3212             MOVE ER-0050            TO EMI-ERROR
  3213             GO TO 0320-INPUT-ERROR.
  3214
  3215     IF EIBAID = DFHPF1
  3216         GO TO 6000-BROWSE-FORWARD.
  3217
  3218     IF EIBAID = DFHPF2
  3219         GO TO 6100-BROWSE-BACKWARD.
  3220
  3221     IF EIBAID = DFHPF6
  3222         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  3223         MOVE PGM-EL141          TO PGM-NAME
  3224         GO TO 9300-XCTL.
  3225
  3226     IF EIBAID = DFHENTER
  3227         GO TO 0330-EDIT-DATA.
  3228
  3229     MOVE ER-0029                TO EMI-ERROR.
  3230
  3231 0320-INPUT-ERROR.
  3232     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3233
  3234     MOVE AL-UNBON        TO ENTERPFA.
  3235
  3236     IF ENTERPFL = 0
  3237         MOVE -1          TO URECDTEL
  3238     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  64
* EL162.cbl
  3239         MOVE -1          TO ENTERPFL.
  3240
  3241     GO TO 8200-SEND-DATAONLY.
  3242
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  65
* EL162.cbl
  3244 0330-EDIT-DATA.
  3245     SET SC-INDX  INDX           TO 1.
  3246     SET INDX2                   TO 1.
  3247
  3248 0331-LOOP.
  3249     IF SC-RECL (SC-INDX) > ZERO
  3250        MOVE SC-REC (SC-INDX)    TO DEEDIT-FIELD
  3251        PERFORM 8600-DEEDIT
  3252        MOVE '1'                 TO REC-DATA-SW
  3253        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3254        MOVE '4'                 TO DC-OPTION-CODE
  3255        PERFORM 9700-DATE-LINK
  3256        IF DATE-CONVERSION-ERROR
  3257           MOVE ER-0021          TO EMI-ERROR
  3258           MOVE -1               TO SC-RECL (SC-INDX)
  3259           MOVE AL-UABON         TO SC-RECA (SC-INDX)
  3260           PERFORM 9900-ERROR-FORMAT
  3261                                 THRU 9900-EXIT
  3262        ELSE
  3263           IF DC-BIN-DATE-1 > BIN-CURRENT-DATE
  3264              MOVE ER-0539       TO EMI-ERROR
  3265              MOVE -1            TO SC-RECL (SC-INDX)
  3266              MOVE AL-UABON      TO SC-RECA (SC-INDX)
  3267              PERFORM 9900-ERROR-FORMAT
  3268                                 THRU 9900-EXIT
  3269           ELSE
  3270              MOVE DC-BIN-DATE-1 TO REC-DATE-SAVE (INDX)
  3271              MOVE DEEDIT-FIELD-V0
  3272                                 TO SC-REC-O (SC-INDX)
  3273              INSPECT SC-REC (SC-INDX) CONVERTING ' ' TO '/'
  3274           END-IF
  3275        END-IF
  3276     ELSE
  3277        MOVE LOW-VALUES          TO REC-DATE-SAVE (INDX)
  3278     END-IF
  3279     IF PI-COMPANY-ID = 'DMD'
  3280       IF SC-RECL (SC-INDX) > 0
  3281         IF REC-DATE-SAVE (INDX) < CURRENT-MINUS1-SAVE
  3282         IF NOT PI-DMD-FORCED
  3283           MOVE ER-7839        TO EMI-ERROR
  3284           MOVE -1             TO SC-RECL (SC-INDX)
  3285           MOVE AL-UABON       TO SC-RECA (SC-INDX)
  3286           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3287         END-IF
  3288         ELSE
  3289         IF REC-DATE-SAVE (INDX) > BIN-CURRENT-DATE
  3290           MOVE ER-0539          TO EMI-ERROR
  3291           MOVE -1               TO SC-RECL (SC-INDX)
  3292           MOVE AL-UABON         TO SC-RECA (SC-INDX)
  3293           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3294
  3295     IF SC-STOPL (SC-INDX) > ZERO
  3296        MOVE SC-STOP (SC-INDX)    TO DEEDIT-FIELD
  3297        PERFORM 8600-DEEDIT
  3298        MOVE '1'                 TO REC-DATA-SW
  3299        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3300        MOVE '4'                 TO DC-OPTION-CODE
  3301        PERFORM 9700-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  66
* EL162.cbl
  3302        IF DATE-CONVERSION-ERROR
  3303           MOVE ER-0021          TO EMI-ERROR
  3304           MOVE -1               TO SC-STOPL (SC-INDX)
  3305           MOVE AL-UABON         TO SC-STOPA (SC-INDX)
  3306           PERFORM 9900-ERROR-FORMAT
  3307                                 THRU 9900-EXIT
  3308        ELSE
  3309           IF DC-BIN-DATE-1 > BIN-CURRENT-DATE
  3310              MOVE ER-0895       TO EMI-ERROR
  3311              MOVE -1            TO SC-STOPL (SC-INDX)
  3312              MOVE AL-UABON      TO SC-STOPA (SC-INDX)
  3313              PERFORM 9900-ERROR-FORMAT
  3314                                 THRU 9900-EXIT
  3315           ELSE
  3316              MOVE DC-BIN-DATE-1 TO STOP-DATE-SAVE (INDX2)
  3317              MOVE DEEDIT-FIELD-V0 TO SC-STOP-O (SC-INDX)
  3318              INSPECT SC-STOP (SC-INDX) CONVERTING ' ' TO '/'
  3319           END-IF
  3320        END-IF
  3321     ELSE
  3322        MOVE LOW-VALUES          TO STOP-DATE-SAVE (INDX2)
  3323     END-IF.
  3324
  3325     SET SC-INDX
  3326            INDX2
  3327            INDX UP BY 1.
  3328
  3329     IF SC-INDX NOT = 5
  3330        GO TO 0331-LOOP.
  3331
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  67
* EL162.cbl
  3333
  3334     IF URECDTEL > 0
  3335        MOVE URECDTEI            TO DEEDIT-FIELD
  3336        PERFORM 8600-DEEDIT
  3337        MOVE '1'                 TO UNSOL-DATA-SW
  3338        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3339        MOVE '4'                 TO DC-OPTION-CODE
  3340        PERFORM 9700-DATE-LINK
  3341        IF DATE-CONVERSION-ERROR
  3342           MOVE ER-0021          TO EMI-ERROR
  3343           MOVE -1               TO URECDTEL
  3344           MOVE AL-UABON         TO URECDTEA
  3345           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3346        ELSE
  3347           MOVE DC-BIN-DATE-1    TO URECDTE-SAVE
  3348           MOVE DEEDIT-FIELD-V0  TO URECDTEO
  3349           INSPECT URECDTEI CONVERTING ' ' TO '/'.
  3350
  3351     IF PI-COMPANY-ID = 'DMD'
  3352       IF URECDTEL > 0
  3353         IF URECDTE-SAVE < CURRENT-MINUS1-SAVE
  3354         IF NOT PI-DMD-FORCED
  3355           MOVE ER-7839        TO EMI-ERROR
  3356           MOVE -1             TO URECDTEL
  3357           MOVE AL-UABON       TO URECDTEA
  3358           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3359         END-IF
  3360         ELSE
  3361         IF URECDTE-SAVE > BIN-CURRENT-DATE
  3362           MOVE ER-0539          TO EMI-ERROR
  3363           MOVE -1               TO URECDTEL
  3364           MOVE AL-UABON         TO URECDTEA
  3365           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3366
  3367     IF USENTL > 0
  3368        MOVE USENTI              TO DEEDIT-FIELD
  3369        PERFORM 8600-DEEDIT
  3370        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  3371        MOVE '4'                 TO DC-OPTION-CODE
  3372        PERFORM 9700-DATE-LINK
  3373        IF DATE-CONVERSION-ERROR
  3374           MOVE ER-0021          TO EMI-ERROR
  3375           MOVE -1               TO USENTL
  3376           MOVE AL-UABON         TO USENTA
  3377           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3378          ELSE
  3379           MOVE DC-BIN-DATE-1    TO USENT-SAVE
  3380           MOVE DEEDIT-FIELD-V0  TO USENTO
  3381           INSPECT USENTI CONVERTING ' ' TO '/'
  3382        ELSE
  3383           MOVE LOW-VALUES       TO USENT-SAVE.
  3384
  3385     IF USENT-SAVE   NOT = LOW-VALUES AND
  3386        URECDTE-SAVE NOT = LOW-VALUES
  3387          IF USENT-SAVE GREATER THAN URECDTE-SAVE
  3388             MOVE ER-0514        TO EMI-ERROR
  3389             MOVE -1             TO URECDTEL
  3390             MOVE AL-UABON       TO URECDTEA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  68
* EL162.cbl
  3391             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3392
  3393     IF URECDTE-SAVE NOT = LOW-VALUES
  3394          IF URECDTE-SAVE GREATER THAN BIN-CURRENT-DATE
  3395             MOVE ER-0539        TO EMI-ERROR
  3396             MOVE -1             TO URECDTEL
  3397             MOVE AL-UABON       TO URECDTEA
  3398             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3399
  3400     IF URECDTEL = ZEROS
  3401        IF USENTL > ZEROS  OR
  3402*00570            UBYL   > ZEROS  OR
  3403           UFORML > ZEROS  OR
  3404           UREL   > ZEROS
  3405              MOVE ER-0321          TO EMI-ERROR
  3406              MOVE -1               TO URECDTEL
  3407              PERFORM 9900-ERROR-FORMAT THRU  9900-EXIT.
  3408
  3409     IF NOT EMI-NO-ERRORS
  3410        GO TO 8200-SEND-DATAONLY.
  3411
  3412     IF NOT MODIFY-CAP
  3413         MOVE ER-0070            TO EMI-ERROR
  3414         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3415         MOVE LOW-VALUES TO EL162AO
  3416         GO TO 8100-SEND-INITIAL-MAP.
  3417
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  69
* EL162.cbl
  3419     PERFORM 3000-BUILD-KEYS.
  3420
  3421     IF REC-DATA
  3422        PERFORM 4000-UPDATE-RECEIVE-DATES THRU 4099-EXIT
  3423                VARYING SC-INDX FROM 1 BY 1 UNTIL
  3424                SC-INDX = 5.
  3425
  3426     PERFORM 4100-CREATE-NEW-TRLR THRU 4199-EXIT.
  3427
  3428     MOVE ER-ZEROS               TO EMI-ERROR.
  3429     MOVE SPACES                 TO ADDR1I ADDR2I ADDR3I ADDR4I
  3430                                    ZIPI PHONEI.
  3431
  3432     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3433
  3434     MOVE -1                     TO SC-RECL (1).
  3435     GO TO 8200-SEND-DATAONLY.
  3436
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  70
* EL162.cbl
  3438 2000-ZERO-PI-TRLR-TABLE.
  3439
  3440     MOVE +0                     TO PI-TRLRS (SUB).
  3441     ADD +1 TO SUB.
  3442
  3443     IF SUB > +50
  3444        MOVE +0                  TO SUB
  3445        GO TO 2010-EXIT.
  3446
  3447     GO TO 2000-ZERO-PI-TRLR-TABLE.
  3448
  3449 2010-EXIT.
  3450     EXIT.
  3451
  3452 3000-BUILD-KEYS.
  3453     MOVE PI-CLAIM-NO            TO PI-CLAM-CLAIM
  3454                                    PI-ACTV-CLAIM
  3455                                    CLAIMNOI.
  3456
  3457     MOVE PI-CERT-NO             TO PI-CLAM-CERT-NO
  3458                                    PI-ACTV-CERT-NO
  3459                                    CERTNOI.
  3460
  3461     MOVE PI-COMPANY-CD          TO PI-CLAM-COMP-CD
  3462                                    PI-ACTV-COMP-CD.
  3463
  3464     MOVE PI-CARRIER             TO PI-CLAM-CARRIER
  3465                                    PI-ACTV-CARRIER
  3466                                    CARRI.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  71
* EL162.cbl
  3468 4000-UPDATE-RECEIVE-DATES.
  3469
  3470     IF SC-RECL (SC-INDX) = ZERO AND SC-STOPL (SC-INDX)
  3471        GO TO 4099-EXIT.
  3472
  3473     MOVE SC-TRLRNO (SC-INDX)    TO PI-ACTV-SEQ.
  3474
  3475*00648      IF SC-RECL (SC-INDX) = ZERO
  3476*00649          EXEC CICS READ
  3477*00650               DATASET (ELTRLR-FILE-ID)
  3478*00651               RIDFLD  (PI-ACTV-KEY)
  3479*00652               SET     (ADDRESS OF ACTIVITY-TRAILERS)
  3480*00653          END-EXEC
  3481*00654         ELSE
  3482
  3483* EXEC CICS READ
  3484*             DATASET(ELTRLR-FILE-ID)
  3485*             RIDFLD (PI-ACTV-KEY)
  3486*             SET    (ADDRESS OF ACTIVITY-TRAILERS)
  3487*             UPDATE
  3488*        END-EXEC.
  3489*    MOVE '&"S        EU         (   #00003439' TO DFHEIV0
  3490     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3491     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3492     MOVE X'2020233030303033343339' TO DFHEIV0(25:11)
  3493     CALL 'kxdfhei1' USING DFHEIV0,
  3494           ELTRLR-FILE-ID,
  3495           DFHEIV20,
  3496           DFHEIV99,
  3497           PI-ACTV-KEY,
  3498           DFHEIV99,
  3499           DFHEIV99,
  3500           DFHEIV99
  3501     SET ADDRESS OF ACTIVITY-TRAILERS TO
  3502         DFHEIV20
  3503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3504
  3505
  3506     SET INDX2 TO SC-INDX.
  3507
  3508     IF SC-STOPL (SC-INDX) = ZEROS
  3509         GO TO 4000-BYPASS-STOP-DATE
  3510     END-IF.
  3511
  3512     IF (CORRESPONDENCE-TR AND
  3513         STOP-DATE-SAVE (INDX2) LESS THAN AT-LETTER-SENT-DT)
  3514              OR
  3515        (FORM-CONTROL-TR AND
  3516         STOP-DATE-SAVE (INDX2) LESS THAN AT-FORM-SEND-ON-DT)
  3517           MOVE ER-0896          TO EMI-ERROR
  3518           MOVE -1               TO SC-STOPL (SC-INDX)
  3519           MOVE AL-UABON         TO SC-STOPA (SC-INDX)
  3520           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3521
  3522* EXEC CICS SYNCPOINT
  3523*               ROLLBACK
  3524*          END-EXEC
  3525*    MOVE '6"R                   !   #00003461' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  72
* EL162.cbl
  3526     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  3527     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3528     MOVE X'2020233030303033343631' TO DFHEIV0(25:11)
  3529     CALL 'kxdfhei1' USING DFHEIV0
  3530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3531           GO TO 8200-SEND-DATAONLY
  3532     END-IF.
  3533
  3534     IF CORRESPONDENCE-TR
  3535        MOVE STOP-DATE-SAVE (INDX2) TO AT-STOP-LETTER-DT
  3536        MOVE PI-PROCESSOR-ID     TO AT-CORR-LAST-UPDATED-BY
  3537        MOVE BIN-CURRENT-DATE    TO AT-CORR-LAST-MAINT-DT
  3538     END-IF.
  3539
  3540     IF FORM-CONTROL-TR
  3541        MOVE STOP-DATE-SAVE (INDX2) TO AT-STOP-FORM-DT
  3542        MOVE PI-PROCESSOR-ID     TO AT-FORM-LAST-UPDATED-BY
  3543        MOVE BIN-CURRENT-DATE    TO AT-FORM-LAST-MAINT-DT
  3544     END-IF.
  3545     MOVE AL-UANOF               TO SC-STOPA (SC-INDX).
  3546
  3547 4000-BYPASS-STOP-DATE.
  3548
  3549     IF SC-RECL (SC-INDX) = ZEROS
  3550*00673         GO TO 4099-EXIT.
  3551        GO TO 4090-REWRITE
  3552     END-IF.
  3553
  3554     SET INDX TO SC-INDX.
  3555
  3556     IF (CORRESPONDENCE-TR AND
  3557         REC-DATE-SAVE (INDX)  LESS THAN AT-LETTER-SENT-DT)
  3558              OR
  3559        (FORM-CONTROL-TR AND
  3560         REC-DATE-SAVE (INDX)  LESS THAN AT-FORM-SEND-ON-DT)
  3561           MOVE ER-0514          TO EMI-ERROR
  3562           MOVE -1               TO SC-RECL (SC-INDX)
  3563           MOVE AL-UABON         TO SC-RECA (SC-INDX)
  3564           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3565
  3566* EXEC CICS SYNCPOINT
  3567*               ROLLBACK
  3568*          END-EXEC
  3569*    MOVE '6"R                   !   #00003498' TO DFHEIV0
  3570     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  3571     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3572     MOVE X'2020233030303033343938' TO DFHEIV0(25:11)
  3573     CALL 'kxdfhei1' USING DFHEIV0
  3574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3575           GO TO 8200-SEND-DATAONLY.
  3576
  3577     IF CORRESPONDENCE-TR
  3578        MOVE REC-DATE-SAVE (INDX)   TO AT-LETTER-ANSWERED-DT
  3579        MOVE PI-PROCESSOR-ID        TO AT-CORR-LAST-UPDATED-BY
  3580        MOVE BIN-CURRENT-DATE       TO AT-CORR-LAST-MAINT-DT.
  3581
  3582     IF FORM-CONTROL-TR
  3583        MOVE PI-PROCESSOR-ID        TO AT-FORM-LAST-UPDATED-BY
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  73
* EL162.cbl
  3584        MOVE BIN-CURRENT-DATE       TO AT-FORM-LAST-MAINT-DT
  3585        IF SC-TYPE (SC-INDX) = 'C'
  3586           MOVE REC-DATE-SAVE (INDX)   TO AT-FORM-ANSWERED-DT
  3587        ELSE
  3588        IF SC-TYPE (SC-INDX) = 'E'
  3589           MOVE REC-DATE-SAVE (INDX)   TO AT-EMP-FORM-ANSWERED-DT
  3590        ELSE
  3591        IF SC-TYPE (SC-INDX) = 'P'
  3592           MOVE REC-DATE-SAVE (INDX)   TO AT-PHY-FORM-ANSWERED-DT.
  3593
  3594     MOVE AL-UANOF               TO SC-RECA (SC-INDX).
  3595
  3596 4090-REWRITE.
  3597
  3598     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  3599
  3600     IF PI-COMPANY-ID = 'DMD'
  3601         MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY.
  3602
  3603
  3604* EXEC CICS REWRITE
  3605*         FROM   (ACTIVITY-TRAILERS)
  3606*         DATASET(ELTRLR-FILE-ID)
  3607*    END-EXEC.
  3608     MOVE LENGTH OF
  3609      ACTIVITY-TRAILERS
  3610       TO DFHEIV11
  3611*    MOVE '&& L                  %   #00003529' TO DFHEIV0
  3612     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3613     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3614     MOVE X'2020233030303033353239' TO DFHEIV0(25:11)
  3615     CALL 'kxdfhei1' USING DFHEIV0,
  3616           ELTRLR-FILE-ID,
  3617           ACTIVITY-TRAILERS,
  3618           DFHEIV11,
  3619           DFHEIV99
  3620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3621
  3622
  3623 4099-EXIT.
  3624      EXIT.
  3625
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  74
* EL162.cbl
  3627 4100-CREATE-NEW-TRLR.
  3628
  3629
  3630* EXEC CICS READ
  3631*         DATASET(ELMSTR-FILE-ID)
  3632*         SET    (ADDRESS OF CLAIM-MASTER)
  3633*         RIDFLD (PI-CLAM-KEY)
  3634*         UPDATE
  3635*    END-EXEC.
  3636*    MOVE '&"S        EU         (   #00003540' TO DFHEIV0
  3637     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3638     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3639     MOVE X'2020233030303033353430' TO DFHEIV0(25:11)
  3640     CALL 'kxdfhei1' USING DFHEIV0,
  3641           ELMSTR-FILE-ID,
  3642           DFHEIV20,
  3643           DFHEIV99,
  3644           PI-CLAM-KEY,
  3645           DFHEIV99,
  3646           DFHEIV99,
  3647           DFHEIV99
  3648     SET ADDRESS OF CLAIM-MASTER TO
  3649         DFHEIV20
  3650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3651
  3652
  3653     IF FILEL > ZEROS
  3654        MOVE FILEI               TO CL-FILE-LOCATION.
  3655
  3656     IF NOT UNSOL-DATA
  3657        GO TO 4150-REWRITE-CLAIM.
  3658
  3659     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
  3660
  3661
  3662* EXEC CICS GETMAIN
  3663*         SET    (ADDRESS OF ACTIVITY-TRAILERS)
  3664*         INITIMG(GETMAIN-SPACE)
  3665*         LENGTH (ACTV-LENGTH)
  3666*    END-EXEC.
  3667*    MOVE ',"IL                  $   #00003555' TO DFHEIV0
  3668     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  3669     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3670     MOVE X'2020233030303033353535' TO DFHEIV0(25:11)
  3671     CALL 'kxdfhei1' USING DFHEIV0,
  3672           DFHEIV20,
  3673           ACTV-LENGTH,
  3674           GETMAIN-SPACE
  3675     SET ADDRESS OF ACTIVITY-TRAILERS TO
  3676         DFHEIV20
  3677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3678
  3679
  3680     MOVE 'AT'                   TO AT-RECORD-ID.
  3681     MOVE  4                     TO AT-TRAILER-TYPE.
  3682     MOVE BIN-CURRENT-DATE       TO AT-RECORDED-DT
  3683                                    AT-CORR-LAST-MAINT-DT
  3684
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  75
* EL162.cbl
  3685     IF UBYL > +0
  3686        MOVE UBYI                TO AT-RECORDED-BY
  3687                                    AT-CORR-LAST-UPDATED-BY
  3688     ELSE
  3689        MOVE PI-PROCESSOR-ID     TO AT-RECORDED-BY
  3690                                    AT-CORR-LAST-UPDATED-BY.
  3691
  3692     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  3693     MOVE PI-ACTV-KEY            TO AT-CONTROL-PRIMARY.
  3694     MOVE PI-CLAIM-NO            TO AT-CLAIM-NO.
  3695     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
  3696     MOVE USENT-SAVE             TO AT-LETTER-SENT-DT.
  3697     MOVE LOW-VALUES             TO AT-RECEIPT-FOLLOW-UP
  3698                                    AT-AUTO-RE-SEND-DT
  3699                                    AT-INITIAL-PRINT-DATE
  3700                                    AT-RESEND-PRINT-DATE.
  3701     MOVE URECDTE-SAVE           TO AT-LETTER-ANSWERED-DT.
  3702     MOVE ZEROS                  TO AT-LETTER-ARCHIVE-NO.
  3703     MOVE '1'                    TO AT-LETTER-ORIGIN.
  3704
  3705     IF UFORML > 0
  3706        MOVE UFORMI              TO AT-STD-LETTER-FORM
  3707       ELSE
  3708        MOVE SPACES              TO AT-STD-LETTER-FORM.
  3709
  3710     IF UREL > 0
  3711        MOVE UREI                TO AT-REASON-TEXT
  3712       ELSE
  3713        MOVE SPACES              TO AT-REASON-TEXT.
  3714
  3715     MOVE SPACES                 TO AT-ADDRESSEE-NAME
  3716                                    AT-ADDRESEE-TYPE.
  3717     MOVE ZEROS                  TO AT-ADDRESS-REC-SEQ-NO.
  3718     MOVE 'U'                    TO AT-CORR-SOL-UNSOL.
  3719
  3720
  3721* EXEC CICS WRITE
  3722*         DATASET(ELTRLR-FILE-ID)
  3723*         FROM   (ACTIVITY-TRAILERS)
  3724*         RIDFLD (AT-CONTROL-PRIMARY)
  3725*    END-EXEC.
  3726     MOVE LENGTH OF
  3727      ACTIVITY-TRAILERS
  3728       TO DFHEIV11
  3729*    MOVE '&$ L                  ''   #00003601' TO DFHEIV0
  3730     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3731     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3732     MOVE X'2020233030303033363031' TO DFHEIV0(25:11)
  3733     CALL 'kxdfhei1' USING DFHEIV0,
  3734           ELTRLR-FILE-ID,
  3735           ACTIVITY-TRAILERS,
  3736           DFHEIV11,
  3737           AT-CONTROL-PRIMARY,
  3738           DFHEIV99,
  3739           DFHEIV99
  3740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3741
  3742
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  76
* EL162.cbl
  3743     MOVE SPACES                 TO URECDTEI
  3744                                    USENTI
  3745*00795                                     UBYI
  3746                                    UFORMI
  3747                                    UREI.
  3748
  3749     MOVE AL-UANOF               TO URECDTEA
  3750                                    USENTA
  3751*00801                                     UBYA
  3752                                    UFORMA
  3753                                    UREA.
  3754
  3755     MOVE PI-PROCESSOR-ID        TO UBYI.
  3756
  3757 4150-REWRITE-CLAIM.
  3758
  3759* EXEC CICS HANDLE CONDITION
  3760*        DUPKEY (4199-EXIT)
  3761*    END-EXEC.
  3762*    MOVE '"$$                   ! # #00003622' TO DFHEIV0
  3763     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  3764     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3765     MOVE X'2320233030303033363232' TO DFHEIV0(25:11)
  3766     CALL 'kxdfhei1' USING DFHEIV0
  3767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3768
  3769
  3770     MOVE PI-PROCESSOR-ID   TO  CL-LAST-MAINT-USER.
  3771     MOVE EIBTIME           TO  CL-LAST-MAINT-HHMMSS.
  3772     MOVE BIN-CURRENT-DATE  TO  CL-LAST-MAINT-DT.
  3773     MOVE '2'               TO  CL-LAST-MAINT-TYPE.
  3774
  3775     IF PI-COMPANY-ID = 'DMD'
  3776         MOVE 11                 TO CL-ACTIVITY-CODE
  3777         MOVE BIN-CURRENT-DATE   TO CL-ACTIVITY-MAINT-DT
  3778         MOVE 'CORR'             TO CL-ACTIVITY-MAINT-TYPE
  3779         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID.
  3780
  3781
  3782* EXEC CICS REWRITE
  3783*         DATASET(ELMSTR-FILE-ID)
  3784*         FROM   (CLAIM-MASTER)
  3785*    END-EXEC.
  3786     MOVE LENGTH OF
  3787      CLAIM-MASTER
  3788       TO DFHEIV11
  3789*    MOVE '&& L                  %   #00003637' TO DFHEIV0
  3790     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3791     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3792     MOVE X'2020233030303033363337' TO DFHEIV0(25:11)
  3793     CALL 'kxdfhei1' USING DFHEIV0,
  3794           ELMSTR-FILE-ID,
  3795           CLAIM-MASTER,
  3796           DFHEIV11,
  3797           DFHEIV99
  3798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3799
  3800
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  77
* EL162.cbl
  3801 4199-EXIT.
  3802      EXIT.
  3803
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  78
* EL162.cbl
  3805 4200-LOCATE-ADDRESS.
  3806     IF ADDR-TYPE = '3' AND ADDR-SEQ = ZEROS
  3807        GO TO 4210-READ-ACCOUNT.
  3808
  3809     IF ADDR-TYPE = SPACES OR ADDR-SEQ = ZEROS
  3810        GO TO 4290-ERROR.
  3811
  3812     MOVE ADDR-SEQ               TO PI-ACTV-SEQ.
  3813
  3814
  3815* EXEC CICS HANDLE CONDITION
  3816*         NOTFND(4290-ERROR)
  3817*    END-EXEC.
  3818*    MOVE '"$I                   ! $ #00003655' TO DFHEIV0
  3819     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3820     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3821     MOVE X'2420233030303033363535' TO DFHEIV0(25:11)
  3822     CALL 'kxdfhei1' USING DFHEIV0
  3823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3824
  3825
  3826
  3827* EXEC CICS READ
  3828*         DATASET(ELTRLR-FILE-ID)
  3829*         RIDFLD (PI-ACTV-KEY)
  3830*         SET    (ADDRESS OF ACTIVITY-TRAILERS)
  3831*    END-EXEC.
  3832*    MOVE '&"S        E          (   #00003659' TO DFHEIV0
  3833     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3834     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3835     MOVE X'2020233030303033363539' TO DFHEIV0(25:11)
  3836     CALL 'kxdfhei1' USING DFHEIV0,
  3837           ELTRLR-FILE-ID,
  3838           DFHEIV20,
  3839           DFHEIV99,
  3840           PI-ACTV-KEY,
  3841           DFHEIV99,
  3842           DFHEIV99,
  3843           DFHEIV99
  3844     SET ADDRESS OF ACTIVITY-TRAILERS TO
  3845         DFHEIV20
  3846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3847
  3848
  3849     MOVE AT-MAIL-TO-NAME        TO ADDR1O.
  3850     MOVE AT-ADDRESS-LINE-1      TO ADDR2O.
  3851     MOVE AT-ADDRESS-LINE-2      TO ADDR3O.
  3852*    MOVE AT-CITY-STATE          TO ADDR4O.
  3853     STRING AT-CITY ' ' AT-STATE
  3854        DELIMITED BY '  ' INTO ADDR4O
  3855     END-STRING
  3856     MOVE AT-PHONE-NO            TO PHONEO.
  3857     INSPECT PHONEI CONVERTING ' ' TO '-'.
  3858
  3859     IF AT-CANADIAN-POST-CODE
  3860         MOVE AT-CAN-POSTAL-1    TO WS-CAN-POSTAL-CD-1
  3861         MOVE AT-CAN-POSTAL-2    TO WS-CAN-POSTAL-CD-2
  3862         MOVE SPACES             TO WS-DASH-CAN
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  79
* EL162.cbl
  3863                                    WS-CAN-FILLER
  3864         MOVE WS-CANADIAN-POSTAL-CODES
  3865                                 TO ZIPO
  3866     ELSE
  3867         MOVE AT-ZIP-CODE        TO WS-ZIP-CODE
  3868         IF AT-ZIP-PLUS4 = SPACES OR ZEROS
  3869             MOVE SPACES         TO WS-ZIP-PLUS4
  3870                                    WS-DASH
  3871             MOVE WS-ZIP         TO ZIPO
  3872         ELSE
  3873             MOVE AT-ZIP-PLUS4   TO WS-ZIP-PLUS4
  3874             MOVE '-'            TO WS-DASH
  3875             MOVE WS-ZIP         TO ZIPO.
  3876
  3877     GO TO 4299-EXIT.
  3878
  3879 4210-READ-ACCOUNT.
  3880     MOVE PI-COMPANY-CD          TO ACCT-CO.
  3881     MOVE PI-CARRIER             TO ACCT-CARRIER.
  3882     MOVE PI-GROUPING            TO ACCT-GROUPING.
  3883     MOVE PI-STATE               TO ACCT-STATE.
  3884     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  3885     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DATE.
  3886
  3887
  3888* EXEC CICS HANDLE CONDITION
  3889*         NOTOPEN(8880-ACCT-NOT-OPEN)
  3890*         NOTFND (4250-ACCT-NOT-FOUND)
  3891*    END-EXEC.
  3892*    MOVE '"$JI                  ! % #00003703' TO DFHEIV0
  3893     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  3894     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3895     MOVE X'2520233030303033373033' TO DFHEIV0(25:11)
  3896     CALL 'kxdfhei1' USING DFHEIV0
  3897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3898
  3899
  3900
  3901* EXEC CICS STARTBR
  3902*         RIDFLD   (ACCT-KEY)
  3903*         DATASET  (ERACCT-FILE-ID)
  3904*         KEYLENGTH(13)
  3905*         GENERIC
  3906*    END-EXEC.
  3907     MOVE 13
  3908       TO DFHEIV11
  3909     MOVE 0
  3910       TO DFHEIV12
  3911*    MOVE '&,   KG    G          &   #00003708' TO DFHEIV0
  3912     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3913     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3914     MOVE X'2020233030303033373038' TO DFHEIV0(25:11)
  3915     CALL 'kxdfhei1' USING DFHEIV0,
  3916           ERACCT-FILE-ID,
  3917           ACCT-KEY,
  3918           DFHEIV11,
  3919           DFHEIV12,
  3920           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  80
* EL162.cbl
  3921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3922
  3923
  3924     MOVE ACCT-PARTIAL-KEY       TO ACCT-SAVE-KEY.
  3925
  3926 4230-READNEXT.
  3927
  3928* EXEC CICS READNEXT
  3929*         DATASET(ERACCT-FILE-ID)
  3930*         SET    (ADDRESS OF ACCOUNT-MASTER)
  3931*         RIDFLD (ACCT-KEY)
  3932*    END-EXEC.
  3933     MOVE 0
  3934       TO DFHEIV11
  3935*    MOVE '&.S                   )   #00003718' TO DFHEIV0
  3936     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3937     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3938     MOVE X'2020233030303033373138' TO DFHEIV0(25:11)
  3939     CALL 'kxdfhei1' USING DFHEIV0,
  3940           ERACCT-FILE-ID,
  3941           DFHEIV20,
  3942           DFHEIV99,
  3943           ACCT-KEY,
  3944           DFHEIV99,
  3945           DFHEIV11,
  3946           DFHEIV99,
  3947           DFHEIV99
  3948     SET ADDRESS OF ACCOUNT-MASTER TO
  3949         DFHEIV20
  3950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3951
  3952
  3953     IF ACCT-PARTIAL-KEY NOT = ACCT-SAVE-KEY
  3954        GO TO 4250-ACCT-NOT-FOUND.
  3955
  3956     IF PI-CERT-EFF-DT NOT LESS THAN AM-EFFECTIVE-DT AND
  3957        PI-CERT-EFF-DT     LESS THAN AM-EXPIRATION-DT
  3958        NEXT SENTENCE
  3959      ELSE
  3960        GO TO 4230-READNEXT.
  3961
  3962     MOVE AM-NAME                TO ADDR1O.
  3963     MOVE AM-PERSON              TO ADDR2O.
  3964     MOVE AM-ADDRS               TO ADDR3O.
  3965*    MOVE AM-CITY                TO ADDR4O.
  3966     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3967        DELIMITED BY '  ' INTO ADDR4O
  3968     END-STRING
  3969
  3970     MOVE AM-TEL-NO              TO WS-WORK-PHONE.
  3971     INSPECT WS-WORK-PHONE CONVERTING ' ' TO '0'.
  3972     MOVE WS-NUMERIC-PHONE       TO PHONEO.
  3973     INSPECT PHONEI CONVERTING ' ' TO '-'.
  3974
  3975     IF AM-CANADIAN-POST-CODE
  3976         MOVE AM-CAN-POSTAL-1    TO WS-CAN-POSTAL-CD-1
  3977         MOVE AM-CAN-POSTAL-2    TO WS-CAN-POSTAL-CD-2
  3978         MOVE SPACES             TO WS-DASH-CAN
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  81
* EL162.cbl
  3979                                    WS-CAN-FILLER
  3980         MOVE WS-CANADIAN-POSTAL-CODES
  3981                                 TO ZIPO
  3982     ELSE
  3983         MOVE AM-ZIP-PRIME       TO WS-ZIP-CODE
  3984         IF AM-ZIP-PLUS4 = SPACES OR ZEROS
  3985             MOVE SPACES         TO WS-ZIP-PLUS4
  3986                                    WS-DASH
  3987             MOVE WS-ZIP         TO ZIPO
  3988         ELSE
  3989             MOVE AM-ZIP-PLUS4   TO WS-ZIP-PLUS4
  3990             MOVE '-'            TO WS-DASH
  3991             MOVE WS-ZIP         TO ZIPO.
  3992
  3993     PERFORM 4240-ENDBR.
  3994
  3995     GO TO 4299-EXIT.
  3996
  3997 4240-ENDBR.
  3998
  3999* EXEC CICS ENDBR
  4000*         DATASET(ERACCT-FILE-ID)
  4001*    END-EXEC.
  4002     MOVE 0
  4003       TO DFHEIV11
  4004*    MOVE '&2                    $   #00003769' TO DFHEIV0
  4005     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4006     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4007     MOVE X'2020233030303033373639' TO DFHEIV0(25:11)
  4008     CALL 'kxdfhei1' USING DFHEIV0,
  4009           ERACCT-FILE-ID,
  4010           DFHEIV11,
  4011           DFHEIV99
  4012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4013
  4014
  4015 4250-ACCT-NOT-FOUND.
  4016     PERFORM 4240-ENDBR.
  4017     MOVE ER-0179                TO EMI-ERROR.
  4018     MOVE -1                     TO SC-RECL (1).
  4019     MOVE SPACES                 TO ADDR1I ADDR2I ADDR3I ADDR4I
  4020                                    ZIPI PHONEI.
  4021
  4022     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4023
  4024 4290-ERROR.
  4025     MOVE ER-0322                TO EMI-ERROR.
  4026     MOVE -1                     TO SC-RECL (1).
  4027     MOVE SPACES                 TO ADDR1I ADDR2I ADDR3I ADDR4I
  4028                                    ZIPI PHONEI.
  4029
  4030     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4031
  4032 4299-EXIT.
  4033      EXIT.
  4034
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  82
* EL162.cbl
  4036 6000-BROWSE-FORWARD.
  4037     IF PI-ACTV-SAVE NOT = PI-ACTV-PARTIAL
  4038        MOVE ER-0066             TO EMI-ERROR
  4039        MOVE -1                  TO SC-RECL (1)
  4040        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4041        GO TO 8200-SEND-DATAONLY.
  4042
  4043     MOVE LOW-VALUES             TO EL162AI.
  4044     ADD 1 TO PI-ACTV-SEQ.
  4045
  4046     GO TO 7000-BUILD-SCREEN.
  4047
  4048 6100-BROWSE-BACKWARD.
  4049
  4050     IF PI-NEXT-TRLR-SUB > 8
  4051        SUBTRACT 4 FROM PI-NEXT-TRLR-SUB.
  4052
  4053     MOVE PI-NEXT-TRLR-SUB       TO SUB.
  4054
  4055     IF SUB = 1 OR 5
  4056        MOVE ER-0067             TO EMI-ERROR
  4057        MOVE -1                  TO SC-RECL (1)
  4058        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4059        MOVE  1                  TO SUB
  4060        MOVE  +1                 TO PI-NEXT-TRLR-SUB
  4061     ELSE
  4062        SUBTRACT 4 FROM SUB
  4063        MOVE SUB                 TO PI-NEXT-TRLR-SUB.
  4064
  4065     MOVE LOW-VALUES             TO EL162AI
  4066                                    TRL-LINES.
  4067     MOVE PI-ACTV-SAVE           TO PI-ACTV-PARTIAL.
  4068
  4069     MOVE PI-TRLRS (SUB)         TO PI-ACTV-SEQ.
  4070
  4071     GO TO 7000-BUILD-SCREEN.
  4072
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  83
* EL162.cbl
  4074 6200-FORMAT-DATA.
  4075
  4076     IF FORM-CONTROL-TR
  4077        GO TO 6250-FORMAT-FORM.
  4078
  4079     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES
  4080        MOVE AT-LETTER-ANSWERED-DT TO DC-BIN-DATE-1
  4081        MOVE SPACES                TO DC-OPTION-CODE
  4082        PERFORM 9700-DATE-LINK
  4083        MOVE DC-GREG-DATE-1-EDIT   TO SC-REC (SC-INDX).
  4084
  4085     IF AT-STOP-LETTER-DT NOT = LOW-VALUES AND SPACES
  4086        MOVE AT-STOP-LETTER-DT     TO DC-BIN-DATE-1
  4087        MOVE SPACES                TO DC-OPTION-CODE
  4088        PERFORM 9700-DATE-LINK
  4089        MOVE DC-GREG-DATE-1-EDIT   TO SC-STOP (SC-INDX)
  4090     END-IF.
  4091
  4092     IF AT-LETTER-SENT-DT NOT = LOW-VALUES
  4093        MOVE AT-LETTER-SENT-DT   TO DC-BIN-DATE-1
  4094        MOVE SPACES              TO DC-OPTION-CODE
  4095        PERFORM 9700-DATE-LINK
  4096        MOVE DC-GREG-DATE-1-EDIT TO SC-SENT (SC-INDX).
  4097
  4098     IF AT-AUTO-RE-SEND-DT NOT = LOW-VALUES
  4099        MOVE AT-AUTO-RE-SEND-DT  TO DC-BIN-DATE-1
  4100        MOVE SPACES              TO DC-OPTION-CODE
  4101        PERFORM 9700-DATE-LINK
  4102        MOVE DC-GREG-DATE-1-EDIT TO SC-RESEND (SC-INDX).
  4103
  4104     IF AT-RECEIPT-FOLLOW-UP NOT = LOW-VALUES
  4105        MOVE AT-RECEIPT-FOLLOW-UP TO DC-BIN-DATE-1
  4106        MOVE SPACES               TO DC-OPTION-CODE
  4107        PERFORM 9700-DATE-LINK
  4108        MOVE DC-GREG-DATE-1-EDIT  TO SC-FOLLOWUP (SC-INDX).
  4109
  4110     MOVE AT-STD-LETTER-FORM     TO SC-FORM (SC-INDX).
  4111
  4112     IF INSURED-ADDRESEE
  4113        MOVE 'INSURED'           TO SC-TO (SC-INDX)
  4114     ELSE
  4115     IF BENEFICIARY-ADDRESEE
  4116        MOVE 'BENEFI '           TO SC-TO (SC-INDX)
  4117     ELSE
  4118     IF ACCOUNT-ADDRESEE
  4119        MOVE 'ACCOUNT'           TO SC-TO (SC-INDX)
  4120     ELSE
  4121     IF PHYSICIAN-ADDRESEE
  4122        MOVE 'DOCTOR'            TO SC-TO (SC-INDX)
  4123     ELSE
  4124     IF EMPLOYER-ADDRESEE
  4125        MOVE 'EMPLOYER'          TO SC-TO (SC-INDX)
  4126     ELSE
  4127     IF OTHER-ADDRESEE-1
  4128        MOVE 'OTHER-1'           TO SC-TO (SC-INDX)
  4129     ELSE
  4130        MOVE 'OTHER-2'           TO SC-TO (SC-INDX).
  4131
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  84
* EL162.cbl
  4132     IF AT-LETTER-ARCHIVE-NO NOT = +0
  4133        MOVE AT-LETTER-ARCHIVE-NO TO SC-ARCHIVE (SC-INDX)
  4134     ELSE
  4135        MOVE SPACES              TO SC-ARCHIVE (SC-INDX).
  4136
  4137     MOVE 'L'                    TO SC-TYPE   (SC-INDX).
  4138
  4139     MOVE AT-REASON-TEXT         TO SC-REASON (SC-INDX).
  4140
  4141*    IF PI-COMPANY-ID = 'DMD'
  4142*       IF AT-DMD-LETTER-PURGED
  4143*          MOVE AT-REASON-TEXT          TO WS-REASON
  4144*          MOVE AT-DMD-LETTER-PURGE-DT  TO DC-BIN-DATE-1
  4145*          MOVE SPACES                  TO DC-OPTION-CODE
  4146*          PERFORM 9700-DATE-LINK
  4147*          MOVE 'PURGED -'              TO WS-REASON (51:9)
  4148*          MOVE DC-GREG-DATE-1-EDIT     TO WS-REASON (60:11)
  4149*          MOVE WS-REASON               TO SC-REASON (SC-INDX).
  4150*
  4151     MOVE AT-RECORDED-BY         TO SC-BY     (SC-INDX).
  4152     MOVE AT-SEQUENCE-NO         TO SC-TRLRNO (SC-INDX).
  4153     MOVE AL-UANOF               TO SC-RECA   (SC-INDX)
  4154                                    SC-STOPA  (SC-INDX).
  4155
  4156     GO TO 6299-EXIT.
  4157
  4158 6250-FORMAT-FORM.
  4159
  4160     IF AT-STOP-FORM-DT NOT = LOW-VALUES AND SPACES
  4161        MOVE AT-STOP-FORM-DT       TO DC-BIN-DATE-1
  4162        MOVE SPACES                TO DC-OPTION-CODE
  4163        PERFORM 9700-DATE-LINK
  4164        MOVE DC-GREG-DATE-1-EDIT   TO SC-STOP (SC-INDX)
  4165     END-IF.
  4166
  4167     IF AT-FORM-SEND-ON-DT NOT = LOW-VALUES
  4168        IF (AT-FORM-ANSWERED-DT = LOW-VALUES)
  4169                         OR
  4170           (AT-FORM-ANSWERED-DT NOT = LOW-VALUES  AND
  4171            AT-FORM-ANSWERED-DT = BIN-CURRENT-DATE)
  4172             NEXT SENTENCE
  4173         ELSE
  4174             GO TO 6260-CHECK-EMPLOYER-FORM
  4175     ELSE
  4176        GO TO 6260-CHECK-EMPLOYER-FORM.
  4177
  4178     IF AT-FORM-ANSWERED-DT NOT = LOW-VALUES
  4179        MOVE AT-FORM-ANSWERED-DT TO DC-BIN-DATE-1
  4180        MOVE SPACES              TO DC-OPTION-CODE
  4181        PERFORM 9700-DATE-LINK
  4182        MOVE DC-GREG-DATE-1-EDIT TO SC-REC (SC-INDX).
  4183
  4184     IF AT-FORM-SEND-ON-DT NOT = LOW-VALUES
  4185        MOVE AT-FORM-SEND-ON-DT  TO DC-BIN-DATE-1
  4186        MOVE SPACES              TO DC-OPTION-CODE
  4187        PERFORM 9700-DATE-LINK
  4188        MOVE DC-GREG-DATE-1-EDIT TO SC-SENT (SC-INDX).
  4189
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  85
* EL162.cbl
  4190     IF AT-FORM-RE-SEND-DT NOT = LOW-VALUES
  4191        MOVE AT-FORM-RE-SEND-DT  TO DC-BIN-DATE-1
  4192        MOVE SPACES              TO DC-OPTION-CODE
  4193        PERFORM 9700-DATE-LINK
  4194        MOVE DC-GREG-DATE-1-EDIT TO SC-RESEND (SC-INDX).
  4195
  4196     IF AT-FORM-FOLLOW-UP-DT NOT = LOW-VALUES
  4197        MOVE AT-FORM-FOLLOW-UP-DT   TO DC-BIN-DATE-1
  4198        MOVE SPACES                 TO DC-OPTION-CODE
  4199        PERFORM 9700-DATE-LINK
  4200        MOVE DC-GREG-DATE-1-EDIT TO SC-FOLLOWUP (SC-INDX).
  4201
  4202     IF AT-FORM-TYPE = '1'
  4203        MOVE 'INIT'              TO SC-FORM (SC-INDX)
  4204     ELSE
  4205        MOVE 'PROG'              TO SC-FORM (SC-INDX).
  4206
  4207     IF FORM-TO-INSURED
  4208        MOVE 'INSURED'           TO SC-TO (SC-INDX)
  4209     ELSE
  4210     IF FORM-TO-ACCOUNT
  4211        MOVE 'ACCOUNT'           TO SC-TO (SC-INDX)
  4212     ELSE
  4213     IF FORM-TO-OTHER-1
  4214        MOVE 'OTHER-1'           TO SC-TO (SC-INDX)
  4215     ELSE
  4216     IF FORM-TO-OTHER-2
  4217        MOVE 'OTHER-2'           TO SC-TO (SC-INDX).
  4218
  4219     MOVE 'CLAIMANT'             TO SC-ARCHIVE (SC-INDX).
  4220     MOVE 'C'                    TO SC-TYPE    (SC-INDX).
  4221     MOVE AT-SEQUENCE-NO         TO PI-TRLRS (PI-NEXT-TRLR-SUB)
  4222     MOVE AT-INSTRUCT-LN-1       TO SC-REASON  (SC-INDX).
  4223     MOVE AT-RECORDED-BY         TO SC-BY      (SC-INDX).
  4224     MOVE AT-SEQUENCE-NO         TO SC-TRLRNO  (SC-INDX).
  4225     MOVE AL-UANOF               TO SC-RECA    (SC-INDX).
  4226     MOVE AL-UANOF               TO SC-STOPA   (SC-INDX).
  4227
  4228 6260-CHECK-EMPLOYER-FORM.
  4229
  4230     IF AT-EMP-FORM-SEND-ON-DT NOT = LOW-VALUES
  4231        IF (AT-EMP-FORM-ANSWERED-DT = LOW-VALUES)
  4232                          OR
  4233           (AT-EMP-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4234            AT-EMP-FORM-ANSWERED-DT = BIN-CURRENT-DATE)
  4235              NEXT SENTENCE
  4236          ELSE
  4237              GO TO 6280-CHECK-PHYSICIAN-FORM
  4238     ELSE
  4239        GO TO 6280-CHECK-PHYSICIAN-FORM.
  4240
  4241     IF SC-TYPE (SC-INDX) = 'C'
  4242        SET SC-INDX UP BY 1
  4243        ADD +1 TO PI-NEXT-TRLR-SUB.
  4244
  4245     IF AT-EMP-FORM-ANSWERED-DT NOT = LOW-VALUES
  4246        MOVE AT-EMP-FORM-ANSWERED-DT TO DC-BIN-DATE-1
  4247        MOVE SPACES                  TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  86
* EL162.cbl
  4248        PERFORM 9700-DATE-LINK
  4249        MOVE DC-GREG-DATE-1-EDIT     TO SC-REC (SC-INDX).
  4250
  4251     IF AT-EMP-FORM-SEND-ON-DT NOT = LOW-VALUES
  4252        MOVE AT-EMP-FORM-SEND-ON-DT TO DC-BIN-DATE-1
  4253        MOVE SPACES                 TO DC-OPTION-CODE
  4254        PERFORM 9700-DATE-LINK
  4255        MOVE DC-GREG-DATE-1-EDIT    TO SC-SENT (SC-INDX).
  4256
  4257     IF AT-FORM-RE-SEND-DT NOT = LOW-VALUES
  4258        MOVE AT-FORM-RE-SEND-DT  TO DC-BIN-DATE-1
  4259        MOVE SPACES              TO DC-OPTION-CODE
  4260        PERFORM 9700-DATE-LINK
  4261        MOVE DC-GREG-DATE-1-EDIT TO SC-RESEND (SC-INDX).
  4262
  4263     IF AT-FORM-FOLLOW-UP-DT NOT = LOW-VALUES
  4264        MOVE AT-FORM-FOLLOW-UP-DT   TO DC-BIN-DATE-1
  4265        MOVE SPACES                 TO DC-OPTION-CODE
  4266        PERFORM 9700-DATE-LINK
  4267        MOVE DC-GREG-DATE-1-EDIT    TO SC-FOLLOWUP (SC-INDX).
  4268
  4269     IF AT-FORM-TYPE = '1'
  4270        MOVE 'INIT'              TO SC-FORM (SC-INDX)
  4271     ELSE
  4272        MOVE 'PROG'              TO SC-FORM (SC-INDX).
  4273
  4274     IF FORM-TO-INSURED
  4275        MOVE 'INSURED'           TO SC-TO (SC-INDX)
  4276     ELSE
  4277     IF FORM-TO-ACCOUNT
  4278        MOVE 'ACCOUNT'           TO SC-TO (SC-INDX)
  4279     ELSE
  4280     IF FORM-TO-OTHER-1
  4281        MOVE 'OTHER-1'           TO SC-TO (SC-INDX)
  4282     ELSE
  4283     IF FORM-TO-OTHER-2
  4284        MOVE 'OTHER-2'           TO SC-TO (SC-INDX).
  4285
  4286     MOVE 'EMPLOYER'             TO SC-ARCHIVE (SC-INDX).
  4287     MOVE 'E'                    TO SC-TYPE    (SC-INDX).
  4288     MOVE AT-SEQUENCE-NO         TO PI-TRLRS (PI-NEXT-TRLR-SUB)
  4289     MOVE AT-INSTRUCT-LN-1       TO SC-REASON  (SC-INDX).
  4290     MOVE AT-RECORDED-BY         TO SC-BY      (SC-INDX).
  4291     MOVE AT-SEQUENCE-NO         TO SC-TRLRNO  (SC-INDX).
  4292     MOVE AL-UANOF               TO SC-RECA    (SC-INDX)
  4293                                    SC-STOPA   (SC-INDX).
  4294
  4295 6280-CHECK-PHYSICIAN-FORM.
  4296
  4297     IF AT-PHY-FORM-SEND-ON-DT NOT = LOW-VALUES
  4298        IF (AT-PHY-FORM-ANSWERED-DT = LOW-VALUES)
  4299                         OR
  4300           (AT-PHY-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4301            AT-PHY-FORM-ANSWERED-DT = BIN-CURRENT-DATE)
  4302              NEXT SENTENCE
  4303          ELSE
  4304              GO TO 6299-EXIT
  4305     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  87
* EL162.cbl
  4306        GO TO 6299-EXIT.
  4307
  4308     IF SC-TYPE (SC-INDX) = 'C' OR 'E'
  4309        SET SC-INDX UP BY 1
  4310        ADD +1 TO PI-NEXT-TRLR-SUB.
  4311
  4312     IF AT-PHY-FORM-ANSWERED-DT NOT = LOW-VALUES
  4313        MOVE AT-PHY-FORM-ANSWERED-DT TO DC-BIN-DATE-1
  4314        MOVE SPACES                  TO DC-OPTION-CODE
  4315        PERFORM 9700-DATE-LINK
  4316        MOVE DC-GREG-DATE-1-EDIT     TO SC-REC (SC-INDX).
  4317
  4318     IF AT-PHY-FORM-SEND-ON-DT NOT = LOW-VALUES
  4319        MOVE AT-PHY-FORM-SEND-ON-DT TO DC-BIN-DATE-1
  4320        MOVE SPACES                 TO DC-OPTION-CODE
  4321        PERFORM 9700-DATE-LINK
  4322        MOVE DC-GREG-DATE-1-EDIT    TO SC-SENT (SC-INDX).
  4323
  4324     IF AT-FORM-RE-SEND-DT NOT = LOW-VALUES
  4325        MOVE AT-FORM-RE-SEND-DT  TO DC-BIN-DATE-1
  4326        MOVE SPACES              TO DC-OPTION-CODE
  4327        PERFORM 9700-DATE-LINK
  4328        MOVE DC-GREG-DATE-1-EDIT TO SC-RESEND (SC-INDX).
  4329
  4330     IF AT-FORM-FOLLOW-UP-DT NOT = LOW-VALUES
  4331        MOVE AT-FORM-FOLLOW-UP-DT   TO DC-BIN-DATE-1
  4332        MOVE SPACES                 TO DC-OPTION-CODE
  4333        PERFORM 9700-DATE-LINK
  4334        MOVE DC-GREG-DATE-1-EDIT    TO SC-FOLLOWUP (SC-INDX).
  4335
  4336     IF AT-FORM-TYPE = '1'
  4337        MOVE 'INIT'              TO SC-FORM (SC-INDX)
  4338     ELSE
  4339        MOVE 'PROG'              TO SC-FORM (SC-INDX).
  4340
  4341     IF FORM-TO-INSURED
  4342        MOVE 'INSURED'           TO SC-TO (SC-INDX)
  4343     ELSE
  4344     IF FORM-TO-ACCOUNT
  4345        MOVE 'ACCOUNT'           TO SC-TO (SC-INDX)
  4346     ELSE
  4347     IF FORM-TO-OTHER-1
  4348        MOVE 'OTHER-1'           TO SC-TO (SC-INDX)
  4349     ELSE
  4350     IF FORM-TO-OTHER-2
  4351        MOVE 'OTHER-2'           TO SC-TO (SC-INDX).
  4352
  4353     MOVE ' DOCTOR '             TO SC-ARCHIVE (SC-INDX).
  4354     MOVE 'P'                    TO SC-TYPE    (SC-INDX).
  4355     MOVE AT-SEQUENCE-NO         TO PI-TRLRS (PI-NEXT-TRLR-SUB)
  4356     MOVE AT-INSTRUCT-LN-1       TO SC-REASON  (SC-INDX).
  4357     MOVE AT-RECORDED-BY         TO SC-BY      (SC-INDX).
  4358     MOVE AT-SEQUENCE-NO         TO SC-TRLRNO  (SC-INDX).
  4359     MOVE AL-UANOF               TO SC-RECA    (SC-INDX)
  4360                                    SC-STOPA   (SC-INDX).
  4361
  4362 6299-EXIT.
  4363      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  88
* EL162.cbl
  4364
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  89
* EL162.cbl
  4366 7000-BUILD-SCREEN.
  4367
  4368     IF PI-CLAIM-NO = SPACES
  4369        MOVE ER-0319             TO EMI-ERROR
  4370        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4371        GO TO 8100-SEND-INITIAL-MAP.
  4372
  4373     PERFORM 3000-BUILD-KEYS.
  4374
  4375     MOVE PI-PROCESSOR-ID        TO UBYI.
  4376
  4377
  4378* EXEC CICS HANDLE CONDITION
  4379*         NOTOPEN(8870-CLAIM-NOT-OPEN)
  4380*         NOTFND (8860-CLAIM-NOT-FOUND)
  4381*    END-EXEC.
  4382*    MOVE '"$JI                  ! & #00004135' TO DFHEIV0
  4383     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  4384     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4385     MOVE X'2620233030303034313335' TO DFHEIV0(25:11)
  4386     CALL 'kxdfhei1' USING DFHEIV0
  4387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4388
  4389
  4390
  4391* EXEC CICS READ
  4392*         DATASET(ELMSTR-FILE-ID)
  4393*         RIDFLD (PI-CLAM-KEY)
  4394*         SET    (ADDRESS OF CLAIM-MASTER)
  4395*    END-EXEC.
  4396*    MOVE '&"S        E          (   #00004140' TO DFHEIV0
  4397     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4398     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4399     MOVE X'2020233030303034313430' TO DFHEIV0(25:11)
  4400     CALL 'kxdfhei1' USING DFHEIV0,
  4401           ELMSTR-FILE-ID,
  4402           DFHEIV20,
  4403           DFHEIV99,
  4404           PI-CLAM-KEY,
  4405           DFHEIV99,
  4406           DFHEIV99,
  4407           DFHEIV99
  4408     SET ADDRESS OF CLAIM-MASTER TO
  4409         DFHEIV20
  4410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4411
  4412
  4413     EVALUATE TRUE
  4414     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  4415        MOVE PI-LIFE-OVERRIDE-L6 TO TYPEI
  4416     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
  4417        MOVE PI-AH-OVERRIDE-L6   TO TYPEI
  4418     WHEN CL-CLAIM-TYPE = 'I'
  4419        MOVE ' IU   '            TO TYPEI
  4420     WHEN CL-CLAIM-TYPE = 'G'
  4421        MOVE ' GAP  '            TO TYPEI
  4422
  4423     WHEN CL-CLAIM-TYPE = 'F'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  90
* EL162.cbl
  4424        MOVE ' FAM  '            TO TYPEI
  4425     END-EVALUATE
  4426
  4427     MOVE CL-INSURED-LAST-NAME   TO LASTNMEI.
  4428     MOVE CL-FILE-LOCATION       TO FILEI.
  4429     MOVE PI-ACTV-PARTIAL        TO PI-ACTV-SAVE.
  4430
  4431     IF CL-1ST-TRL-AVAIL
  4432        GO TO 7100-NOT-FOUND.
  4433
  4434 7010-START-BROWSE.
  4435
  4436
  4437* EXEC CICS HANDLE CONDITION
  4438*         NOTOPEN(8820-ACTV-NOT-OPEN)
  4439*         NOTFND (7100-NOT-FOUND)
  4440*         ENDFILE(7100-NOT-FOUND)
  4441*    END-EXEC.
  4442*    MOVE '"$JI''                 ! '' #00004169' TO DFHEIV0
  4443     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  4444     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4445     MOVE X'2720233030303034313639' TO DFHEIV0(25:11)
  4446     CALL 'kxdfhei1' USING DFHEIV0
  4447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4448
  4449
  4450
  4451* EXEC CICS STARTBR
  4452*         DATASET(ELTRLR-FILE-ID)
  4453*         RIDFLD (PI-ACTV-KEY)
  4454*         GTEQ
  4455*    END-EXEC.
  4456     MOVE 0
  4457       TO DFHEIV11
  4458*    MOVE '&,         G          &   #00004175' TO DFHEIV0
  4459     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4460     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4461     MOVE X'2020233030303034313735' TO DFHEIV0(25:11)
  4462     CALL 'kxdfhei1' USING DFHEIV0,
  4463           ELTRLR-FILE-ID,
  4464           PI-ACTV-KEY,
  4465           DFHEIV99,
  4466           DFHEIV11,
  4467           DFHEIV99
  4468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4469
  4470
  4471     SET SC-INDX TO 1.
  4472
  4473 7020-READ-NEXT.
  4474
  4475
  4476* EXEC CICS READNEXT
  4477*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
  4478*         RIDFLD   (PI-ACTV-KEY)
  4479*         DATASET  (ELTRLR-FILE-ID)
  4480*    END-EXEC.
  4481     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  91
* EL162.cbl
  4482       TO DFHEIV11
  4483*    MOVE '&.S                   )   #00004185' TO DFHEIV0
  4484     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4485     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4486     MOVE X'2020233030303034313835' TO DFHEIV0(25:11)
  4487     CALL 'kxdfhei1' USING DFHEIV0,
  4488           ELTRLR-FILE-ID,
  4489           DFHEIV20,
  4490           DFHEIV99,
  4491           PI-ACTV-KEY,
  4492           DFHEIV99,
  4493           DFHEIV11,
  4494           DFHEIV99,
  4495           DFHEIV99
  4496     SET ADDRESS OF ACTIVITY-TRAILERS TO
  4497         DFHEIV20
  4498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4499
  4500
  4501     IF PI-ACTV-PARTIAL NOT = PI-ACTV-SAVE
  4502        GO TO 7100-NOT-FOUND.
  4503
  4504     IF AT-TRAILER-TYPE = '4' OR  'A'
  4505        NEXT SENTENCE
  4506     ELSE
  4507        GO TO 7020-READ-NEXT.
  4508
  4509     IF CORRESPONDENCE-TR
  4510        IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND
  4511           AT-LETTER-ANSWERED-DT NOT = BIN-CURRENT-DATE
  4512             GO TO 7020-READ-NEXT.
  4513
  4514     IF CORRESPONDENCE-TR AND
  4515        AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND
  4516        AT-RESEND-LETTER-FORM NOT = LOW-VALUES
  4517             GO TO 7020-READ-NEXT
  4518     END-IF.
  4519
  4520     IF CORRESPONDENCE-TR AND
  4521        AT-STOP-LETTER-DT NOT = LOW-VALUES AND
  4522        AT-STOP-LETTER-DT NOT = SPACES AND
  4523        AT-STOP-LETTER-DT NOT = BIN-CURRENT-DATE
  4524*        AT-STOP-LETTER-DT = AT-LETTER-SENT-DT
  4525             GO TO 7020-READ-NEXT
  4526     END-IF.
  4527
  4528     IF NOT FORM-CONTROL-TR
  4529        GO TO 7030-CONTINUE.
  4530
  4531     IF ((AT-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4532          AT-FORM-ANSWERED-DT NOT = BIN-CURRENT-DATE) OR
  4533          AT-FORM-SEND-ON-DT = LOW-VALUES)
  4534       AND
  4535        ((AT-EMP-FORM-ANSWERED-DT NOT = LOW-VALUES AND
  4536          AT-EMP-FORM-ANSWERED-DT NOT = BIN-CURRENT-DATE) OR
  4537          AT-EMP-FORM-SEND-ON-DT = LOW-VALUES)
  4538       AND
  4539        ((AT-PHY-FORM-ANSWERED-DT NOT = LOW-VALUES AND
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  92
* EL162.cbl
  4540          AT-PHY-FORM-ANSWERED-DT NOT = BIN-CURRENT-DATE) OR
  4541          AT-PHY-FORM-SEND-ON-DT = LOW-VALUES)
  4542             GO TO 7020-READ-NEXT.
  4543
  4544     IF (AT-EMP-FORM-SEND-ON-DT NOT = LOW-VALUES) AND
  4545        (AT-PHY-FORM-SEND-ON-DT NOT = LOW-VALUES)
  4546        IF SC-INDX > 2
  4547           MOVE PI-ACTV-SAVE-SEQ TO PI-ACTV-SEQ
  4548           GO TO 7040-END-BUILD-SCREEN.
  4549
  4550     IF (AT-EMP-FORM-SEND-ON-DT NOT = LOW-VALUES) OR
  4551        (AT-PHY-FORM-SEND-ON-DT NOT = LOW-VALUES)
  4552        IF SC-INDX > 3
  4553           MOVE PI-ACTV-SAVE-SEQ TO PI-ACTV-SEQ
  4554           GO TO 7040-END-BUILD-SCREEN.
  4555
  4556 7030-CONTINUE.
  4557
  4558     PERFORM 6200-FORMAT-DATA THRU 6299-EXIT.
  4559
  4560     MOVE PI-ACTV-SEQ             TO PI-ACTV-SAVE-SEQ.
  4561
  4562     MOVE AT-SEQUENCE-NO          TO PI-TRLRS (PI-NEXT-TRLR-SUB).
  4563
  4564     ADD 1   TO PI-NEXT-TRLR-SUB.
  4565     SET SC-INDX UP BY 1.
  4566
  4567     IF SC-INDX NOT = 5
  4568        GO TO 7020-READ-NEXT.
  4569
  4570 7040-END-BUILD-SCREEN.
  4571
  4572     IF SC-INDX = +2
  4573        ADD +3 TO PI-NEXT-TRLR-SUB
  4574     ELSE
  4575     IF SC-INDX = +3
  4576        ADD +2 TO PI-NEXT-TRLR-SUB
  4577     ELSE
  4578     IF SC-INDX = +4
  4579        ADD +1 TO PI-NEXT-TRLR-SUB.
  4580
  4581     MOVE -1                     TO SC-RECL (1).
  4582     GO TO 8100-SEND-INITIAL-MAP.
  4583
  4584 7100-NOT-FOUND.
  4585     IF PI-NEXT-TRLR-SUB = 1
  4586        MOVE ER-0320             TO EMI-ERROR
  4587        MOVE -1                  TO URECDTEL
  4588        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4589        GO TO 8100-SEND-INITIAL-MAP.
  4590
  4591     MOVE -1                     TO SC-RECL (1).
  4592
  4593*    IF ANY LINES WERE PRINTED THEN
  4594*    SET THE SUB TO ALWAYS BE 1 GREATER THAN A MULTIPLE OF 4.
  4595
  4596     SET INDX-WORK TO SC-INDX.
  4597
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  93
* EL162.cbl
  4598     IF SC-INDX NOT = 1
  4599        COMPUTE PI-NEXT-TRLR-SUB = (4 - INDX-WORK) + 1 +
  4600                                    PI-NEXT-TRLR-SUB.
  4601
  4602     IF EIBAID NOT = DFHPF1
  4603        GO TO 8100-SEND-INITIAL-MAP.
  4604
  4605     MOVE ER-0066                TO EMI-ERROR.
  4606     MOVE -1                     TO SC-RECL (1).
  4607
  4608     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4609
  4610     GO TO 8100-SEND-INITIAL-MAP.
  4611
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  94
* EL162.cbl
  4613 8100-SEND-INITIAL-MAP.
  4614     MOVE SAVE-DATE    TO RUNDTEO.
  4615     MOVE EIBTIME      TO TIME-IN.
  4616     MOVE TIME-OUT     TO RUNTIMEO.
  4617
  4618     IF NOT EMI-NO-ERRORS
  4619         SET EMI-INDX TO 1
  4620         MOVE EMI-MESSAGE-AREA (EMI-INDX) TO ERRMSG1O.
  4621
  4622     IF PI-COMPANY-ID NOT = 'DMD'
  4623         MOVE SPACES             TO PF4KEYO.
  4624
  4625     IF PI-RETURN-TO-PROGRAM = 'EL150'
  4626         MOVE SPACES             TO PF5KEYO.
  4627
  4628
  4629* EXEC CICS SEND
  4630*        MAP   (MAP-NAME)
  4631*        MAPSET(MAPSET-NAME)
  4632*        FROM  (EL162AO)
  4633*        ERASE
  4634*        CURSOR
  4635*    END-EXEC.
  4636     MOVE LENGTH OF
  4637      EL162AO
  4638       TO DFHEIV12
  4639     MOVE -1
  4640       TO DFHEIV11
  4641*    MOVE '8$     CT  E    H L F ,   #00004318' TO DFHEIV0
  4642     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  4643     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4644     MOVE X'2020233030303034333138' TO DFHEIV0(25:11)
  4645     CALL 'kxdfhei1' USING DFHEIV0,
  4646           MAP-NAME,
  4647           EL162AO,
  4648           DFHEIV12,
  4649           MAPSET-NAME,
  4650           DFHEIV99,
  4651           DFHEIV99,
  4652           DFHEIV99,
  4653           DFHEIV11,
  4654           DFHEIV99,
  4655           DFHEIV99,
  4656           DFHEIV99
  4657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4658
  4659
  4660     GO TO 9100-RETURN-TRAN.
  4661
  4662 8200-SEND-DATAONLY.
  4663     MOVE SAVE-DATE            TO RUNDTEO.
  4664     MOVE EIBTIME              TO TIME-IN.
  4665     MOVE TIME-OUT             TO RUNTIMEO.
  4666     MOVE EMI-MESSAGE-AREA (1) TO ERRMSG1O.
  4667
  4668     IF PI-COMPANY-ID NOT = 'DMD'
  4669         MOVE SPACES             TO PF4KEYO.
  4670
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  95
* EL162.cbl
  4671     IF PI-RETURN-TO-PROGRAM = 'EL150'
  4672         MOVE SPACES             TO PF5KEYO.
  4673
  4674
  4675* EXEC CICS SEND
  4676*        MAP   (MAP-NAME)
  4677*        MAPSET(MAPSET-NAME)
  4678*        FROM  (EL162AO)
  4679*        DATAONLY
  4680*        CURSOR
  4681*    END-EXEC.
  4682     MOVE LENGTH OF
  4683      EL162AO
  4684       TO DFHEIV12
  4685     MOVE -1
  4686       TO DFHEIV11
  4687*    MOVE '8$D    CT       H L F ,   #00004340' TO DFHEIV0
  4688     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  4689     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4690     MOVE X'2020233030303034333430' TO DFHEIV0(25:11)
  4691     CALL 'kxdfhei1' USING DFHEIV0,
  4692           MAP-NAME,
  4693           EL162AO,
  4694           DFHEIV12,
  4695           MAPSET-NAME,
  4696           DFHEIV99,
  4697           DFHEIV99,
  4698           DFHEIV99,
  4699           DFHEIV11,
  4700           DFHEIV99,
  4701           DFHEIV99,
  4702           DFHEIV99
  4703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4704
  4705
  4706     GO TO 9100-RETURN-TRAN.
  4707
  4708 8300-SEND-TEXT.
  4709
  4710* EXEC CICS SEND TEXT
  4711*        FROM  (LOGOFF-TEXT)
  4712*        LENGTH(LOGOFF-LENGTH)
  4713*        ERASE
  4714*        FREEKB
  4715*    END-EXEC.
  4716*    MOVE '8&      T  E F  H   F -   #00004351' TO DFHEIV0
  4717     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  4718     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  4719     MOVE X'2020233030303034333531' TO DFHEIV0(25:11)
  4720     CALL 'kxdfhei1' USING DFHEIV0,
  4721           LOGOFF-TEXT,
  4722           LOGOFF-LENGTH,
  4723           DFHEIV99,
  4724           DFHEIV99,
  4725           DFHEIV99,
  4726           DFHEIV99,
  4727           DFHEIV99,
  4728           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  96
* EL162.cbl
  4729           DFHEIV99,
  4730           DFHEIV99,
  4731           DFHEIV99,
  4732           DFHEIV99
  4733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4734
  4735
  4736
  4737* EXEC CICS RETURN
  4738*    END-EXEC.
  4739*    MOVE '.(                    ''   #00004358' TO DFHEIV0
  4740     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4741     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4742     MOVE X'2020233030303034333538' TO DFHEIV0(25:11)
  4743     CALL 'kxdfhei1' USING DFHEIV0,
  4744           DFHEIV99,
  4745           DFHEIV99,
  4746           DFHEIV99,
  4747           DFHEIV99,
  4748           DFHEIV99,
  4749           DFHEIV99
  4750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4751
  4752
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  97
* EL162.cbl
  4754 8600-DEEDIT.
  4755
  4756* EXEC CICS BIF DEEDIT
  4757*        FIELD (DEEDIT-FIELD)
  4758*        LENGTH(15)
  4759*    END-EXEC.
  4760     MOVE 15
  4761       TO DFHEIV11
  4762*    MOVE '@"L                   #   #00004363' TO DFHEIV0
  4763     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4764     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4765     MOVE X'2020233030303034333633' TO DFHEIV0(25:11)
  4766     CALL 'kxdfhei1' USING DFHEIV0,
  4767           DEEDIT-FIELD,
  4768           DFHEIV11
  4769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4770
  4771
  4772 8800-UNAUTHORIZED-ACCESS.
  4773     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  4774     GO TO 8300-SEND-TEXT.
  4775
  4776 8810-PF23.
  4777     MOVE EIBAID                   TO PI-ENTRY-CD-1.
  4778     MOVE XCTL-005 TO PGM-NAME.
  4779     GO TO 9300-XCTL.
  4780
  4781 8820-ACTV-NOT-OPEN.
  4782     MOVE ER-0172                TO EMI-ERROR.
  4783     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4784     GO TO 8200-SEND-DATAONLY.
  4785
  4786 8860-CLAIM-NOT-FOUND.
  4787     MOVE ER-0319                TO EMI-ERROR.
  4788     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4789     GO TO 8100-SEND-INITIAL-MAP.
  4790
  4791 8870-CLAIM-NOT-OPEN.
  4792     MOVE ER-0042                TO EMI-ERROR.
  4793     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4794     GO TO 8200-SEND-DATAONLY.
  4795
  4796 8880-ACCT-NOT-OPEN.
  4797     MOVE ER-0168                TO EMI-ERROR
  4798     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4799     GO TO 8200-SEND-DATAONLY.
  4800
  4801 9100-RETURN-TRAN.
  4802     MOVE EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  4803     MOVE MAP-NUMBER           TO PI-CURRENT-SCREEN-NO.
  4804
  4805* EXEC CICS RETURN
  4806*        TRANSID(TRANS-ID)
  4807*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  4808*        LENGTH(PI-COMM-LENGTH)
  4809*    END-EXEC.
  4810*    MOVE '.(CT                  ''   #00004400' TO DFHEIV0
  4811     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  98
* EL162.cbl
  4812     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4813     MOVE X'2020233030303034343030' TO DFHEIV0(25:11)
  4814     CALL 'kxdfhei1' USING DFHEIV0,
  4815           TRANS-ID,
  4816           PROGRAM-INTERFACE-BLOCK,
  4817           PI-COMM-LENGTH,
  4818           DFHEIV99,
  4819           DFHEIV99,
  4820           DFHEIV99
  4821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4822
  4823
  4824 9200-RETURN-MAIN-MENU.
  4825     MOVE XCTL-126 TO PGM-NAME.
  4826     GO TO 9300-XCTL.
  4827
  4828 9300-XCTL.
  4829
  4830* EXEC CICS XCTL
  4831*        PROGRAM(PGM-NAME)
  4832*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  4833*        LENGTH(PI-COMM-LENGTH)
  4834*    END-EXEC.
  4835*    MOVE '.$C                   %   #00004411' TO DFHEIV0
  4836     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4837     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4838     MOVE X'2020233030303034343131' TO DFHEIV0(25:11)
  4839     CALL 'kxdfhei1' USING DFHEIV0,
  4840           PGM-NAME,
  4841           PROGRAM-INTERFACE-BLOCK,
  4842           PI-COMM-LENGTH,
  4843           DFHEIV99
  4844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4845
  4846
  4847 9400-CLEAR.
  4848     MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME.
  4849     GO TO 9300-XCTL.
  4850
  4851 9500-PF12.
  4852     MOVE XCTL-010 TO PGM-NAME.
  4853     GO TO 9300-XCTL.
  4854
  4855 9600-PGMID-ERROR.
  4856
  4857* EXEC CICS HANDLE CONDITION
  4858*        PGMIDERR(8300-SEND-TEXT)
  4859*    END-EXEC.
  4860*    MOVE '"$L                   ! ( #00004426' TO DFHEIV0
  4861     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4862     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4863     MOVE X'2820233030303034343236' TO DFHEIV0(25:11)
  4864     CALL 'kxdfhei1' USING DFHEIV0
  4865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4866
  4867
  4868     MOVE PGM-NAME     TO PI-CALLING-PROGRAM.
  4869     MOVE ' '          TO PI-ENTRY-CD-1.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page  99
* EL162.cbl
  4870     MOVE XCTL-005     TO PGM-NAME.
  4871     MOVE PGM-NAME     TO LOGOFF-PGM.
  4872     MOVE PGMIDERR-MSG TO LOGOFF-FILL.
  4873     GO TO 9300-XCTL.
  4874
  4875 9700-DATE-LINK.
  4876     MOVE LINK-ELDATCV           TO PGM-NAME.
  4877
  4878
  4879* EXEC CICS LINK
  4880*         PROGRAM (PGM-NAME)
  4881*         COMMAREA(DATE-CONVERSION-DATA)
  4882*         LENGTH  (DC-COMM-LENGTH)
  4883*    END-EXEC.
  4884*    MOVE '."C                   (   #00004440' TO DFHEIV0
  4885     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4886     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4887     MOVE X'2020233030303034343430' TO DFHEIV0(25:11)
  4888     CALL 'kxdfhei1' USING DFHEIV0,
  4889           PGM-NAME,
  4890           DATE-CONVERSION-DATA,
  4891           DC-COMM-LENGTH,
  4892           DFHEIV99,
  4893           DFHEIV99,
  4894           DFHEIV99,
  4895           DFHEIV99
  4896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4897
  4898
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 100
* EL162.cbl
  4900 9900-ERROR-FORMAT.
  4901     IF NOT EMI-ERRORS-COMPLETE
  4902         MOVE LINK-001 TO PGM-NAME
  4903
  4904* EXEC CICS LINK
  4905*            PROGRAM (PGM-NAME)
  4906*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  4907*            LENGTH  (EMI-COMM-LENGTH)
  4908*        END-EXEC.
  4909*    MOVE '."C                   (   #00004450' TO DFHEIV0
  4910     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4911     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4912     MOVE X'2020233030303034343530' TO DFHEIV0(25:11)
  4913     CALL 'kxdfhei1' USING DFHEIV0,
  4914           PGM-NAME,
  4915           ERROR-MESSAGE-INTERFACE-BLOCK,
  4916           EMI-COMM-LENGTH,
  4917           DFHEIV99,
  4918           DFHEIV99,
  4919           DFHEIV99,
  4920           DFHEIV99
  4921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4922
  4923
  4924 9900-EXIT.
  4925     EXIT.
  4926
  4927 9990-ABEND.
  4928     MOVE LINK-004 TO PGM-NAME.
  4929     MOVE DFHEIBLK TO EMI-LINE1.
  4930
  4931
  4932* EXEC CICS LINK
  4933*        PROGRAM (PGM-NAME)
  4934*        COMMAREA(EMI-LINE1)
  4935*        LENGTH  (72)
  4936*    END-EXEC.
  4937     MOVE 72
  4938       TO DFHEIV11
  4939*    MOVE '."C                   (   #00004463' TO DFHEIV0
  4940     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4941     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4942     MOVE X'2020233030303034343633' TO DFHEIV0(25:11)
  4943     CALL 'kxdfhei1' USING DFHEIV0,
  4944           PGM-NAME,
  4945           EMI-LINE1,
  4946           DFHEIV11,
  4947           DFHEIV99,
  4948           DFHEIV99,
  4949           DFHEIV99,
  4950           DFHEIV99
  4951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4952
  4953
  4954     GO TO 8200-SEND-DATAONLY.
  4955
  4956 9995-SECURITY-VIOLATION.
  4957*                            COPY ELCSCTP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 101
* EL162.cbl
  4958******************************************************************
  4959*                                                                *
  4960*                            ELCSCTP                             *
  4961*                            VMOD=2.001                          *
  4962*                                                                *
  4963*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  4964******************************************************************
  4965
  4966
  4967     MOVE EIBDATE          TO SM-JUL-DATE.
  4968     MOVE EIBTRMID         TO SM-TERMID.
  4969     MOVE THIS-PGM         TO SM-PGM.
  4970     MOVE EIBTIME          TO TIME-IN.
  4971     MOVE TIME-OUT         TO SM-TIME.
  4972     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  4973
  4974
  4975* EXEC CICS LINK
  4976*         PROGRAM  ('EL003')
  4977*         COMMAREA (SECURITY-MESSAGE)
  4978*         LENGTH   (80)
  4979*    END-EXEC.
  4980     MOVE 'EL003' TO DFHEIV1
  4981     MOVE 80
  4982       TO DFHEIV11
  4983*    MOVE '."C                   (   #00004489' TO DFHEIV0
  4984     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4985     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4986     MOVE X'2020233030303034343839' TO DFHEIV0(25:11)
  4987     CALL 'kxdfhei1' USING DFHEIV0,
  4988           DFHEIV1,
  4989           SECURITY-MESSAGE,
  4990           DFHEIV11,
  4991           DFHEIV99,
  4992           DFHEIV99,
  4993           DFHEIV99,
  4994           DFHEIV99
  4995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4996
  4997
  4998******************************************************************
  4999
  5000
  5001
  5002 9999-DFHBACK SECTION.
  5003     MOVE '9%                    "   ' TO DFHEIV0
  5004     MOVE 'EL162' TO DFHEIV1
  5005     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5006     GOBACK.
  5007 9999-DFHEXIT.
  5008     IF DFHEIGDJ EQUAL 0001
  5009         NEXT SENTENCE
  5010     ELSE IF DFHEIGDJ EQUAL 2
  5011         GO TO 9600-PGMID-ERROR,
  5012               9990-ABEND
  5013         DEPENDING ON DFHEIGDI
  5014     ELSE IF DFHEIGDJ EQUAL 3
  5015         GO TO 4199-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:16 Page 102
* EL162.cbl
  5016         DEPENDING ON DFHEIGDI
  5017     ELSE IF DFHEIGDJ EQUAL 4
  5018         GO TO 4290-ERROR
  5019         DEPENDING ON DFHEIGDI
  5020     ELSE IF DFHEIGDJ EQUAL 5
  5021         GO TO 8880-ACCT-NOT-OPEN,
  5022               4250-ACCT-NOT-FOUND
  5023         DEPENDING ON DFHEIGDI
  5024     ELSE IF DFHEIGDJ EQUAL 6
  5025         GO TO 8870-CLAIM-NOT-OPEN,
  5026               8860-CLAIM-NOT-FOUND
  5027         DEPENDING ON DFHEIGDI
  5028     ELSE IF DFHEIGDJ EQUAL 7
  5029         GO TO 8820-ACTV-NOT-OPEN,
  5030               7100-NOT-FOUND,
  5031               7100-NOT-FOUND
  5032         DEPENDING ON DFHEIGDI
  5033     ELSE IF DFHEIGDJ EQUAL 8
  5034         GO TO 8300-SEND-TEXT
  5035         DEPENDING ON DFHEIGDI.
  5036     MOVE '9%                    "   ' TO DFHEIV0
  5037     MOVE 'EL162' TO DFHEIV1
  5038     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5039     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4868     Code:       13933
