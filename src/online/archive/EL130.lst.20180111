* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page   1
* EL130.cbl
* Options: int("EL130.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL130.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL130.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page   2
* EL130.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34* 020513  CR2011090100001  PEMA  FORCE ENTRY OF SEX CODE
    35* 020613    2012092400007  AJRA  ADD CAUSAL STATE MESSAGE
    36* 042413    2013042300001  AJRA  FIX SPECIAL MSG WHEN MULTIPLE CER
    37* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    38* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    39* 040814    2014030500002  AJRA  ADD ICD CODES
    40* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    41* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    42* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44* 101917  CR2017083000003  TANA  ADD CONTRACT CONTESTABLE MSG
    45* 121417  IR2017121200001  PEMA  Correct assignment of ben period
    46******************************************************************
    47
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page   3
* EL130.cbl
    49 ENVIRONMENT DIVISION.
    50 DATA DIVISION.
    51 WORKING-STORAGE SECTION.
    52 01  DFH-START PIC X(04).
    53 77  FILLER  PIC X(32)  VALUE '********************************'.
    54 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    55 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    56 77  A1                          PIC S999 COMP-3 VALUE +0.
    57 77  E1                          PIC S999 COMP-3 VALUE +0.
    58 77  s1                          pic s999 comp-3 value +0.
    59 77  s2                          pic s999 comp-3 value +0.
    60 77  P1                          PIC S999 COMP-3 VALUE +0.
    61 77  P2                          PIC S999 COMP-3 VALUE +0.
    62 77  WS-CRIT-PER-RECURRENT       PIC 99    VALUE zeros.
    63 77  WS-MAX-BENEFITS             PIC 99    VALUE ZEROS.
    64 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    65 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    66 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    67 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    68 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    69 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    70     88  ERPDEF-FOUND                 VALUE 'Y'.
    71 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    72 77  WS-BENEFITS-PREV-PAID       PIC S9(4)V999 VALUE +0  COMP-3.
    73 77  ws-dcc-product-code         pic xxx value spaces.
    74 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    75 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    76 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    77 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    78 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    79 77  ws-zero-bens-avail          pic x value ' '.
    80*    COPY ELCSCTM.
    81******************************************************************
    82*                                                                *
    83*                                                                *
    84*                            ELCSCTM                             *
    85*                            VMOD=2.001                          *
    86*                                                                *
    87*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    88*                                                                *
    89******************************************************************
    90 01  SECURITY-MESSAGE.
    91     12  FILLER                          PIC X(30)
    92            VALUE '** LOGIC SECURITY VIOLATION -'.
    93     12  SM-READ                         PIC X(6).
    94     12  FILLER                          PIC X(5)
    95            VALUE ' PGM='.
    96     12  SM-PGM                          PIC X(6).
    97     12  FILLER                          PIC X(5)
    98            VALUE ' OPR='.
    99     12  SM-PROCESSOR-ID                 PIC X(4).
   100     12  FILLER                          PIC X(6)
   101            VALUE ' TERM='.
   102     12  SM-TERMID                       PIC X(4).
   103     12  FILLER                          PIC XX   VALUE SPACE.
   104     12  SM-JUL-DATE                     PIC 9(5).
   105     12  FILLER                          PIC X    VALUE SPACE.
   106     12  SM-TIME                         PIC 99.99.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page   4
* EL130.cbl
   107
   108
   109*    COPY ELCSCRTY.
   110******************************************************************
   111*                                                                *
   112*                                                                *
   113*                            ELCSCRTY                            *
   114*                            VMOD=2.001                          *
   115*                                                                *
   116*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   117*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   118*        SAVED IN PI-SECURITY-ADDRESS.                           *
   119*                                                                *
   120******************************************************************
   121 01  SECURITY-CONTROL.
   122     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   123     12  FILLER                       PIC XX    VALUE 'SC'.
   124     12  SC-CREDIT-CODES.
   125         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   126             20  SC-CREDIT-DISPLAY    PIC X.
   127             20  SC-CREDIT-UPDATE     PIC X.
   128     12  SC-CLAIMS-CODES.
   129         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   130             20  SC-CLAIMS-DISPLAY    PIC X.
   131             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page   5
* EL130.cbl
   133 01  WS-DATE-AREA.
   134     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   135     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   136     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   137
   138 01  ws-dcc-error-line.
   139     05  filler occurs 15.
   140         10  ws-error-no        pic x(4).
   141 01  WS-CRI-SSN-WORK-AREA.
   142     05  WS-CRI-SOC-SEC-NO.
   143         10  WS-SS-REPT-CD       PIC X(5).
   144         10  WS-SS-LAST-NAME     PIC X(5).
   145         10  WS-SS-INITIAL       PIC X.
   146
   147     05  WS-CRI-REPORT-CODE.
   148         10  FILLER              PIC X(5).
   149         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   150
   151     05  WS-CRI-LAST-NAME.
   152         10  WS-CRI-NAME-MOVE    PIC X(5).
   153         10  FILLER              PIC X(10).
   154
   155 01  STANDARD-AREAS.
   156     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   157     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   158     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   159     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   160     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   161     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   162     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   163     12  PGM-NAME            PIC X(8).
   164     12  TIME-IN             PIC S9(7).
   165     12  TIME-OUT-R  REDEFINES TIME-IN.
   166         16  FILLER          PIC X.
   167         16  TIME-OUT        PIC 99V99.
   168         16  FILLER          PIC X(2).
   169     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   170     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   171     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   172     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   173     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   174     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   175     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   176     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   177     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   178     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   179     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   180     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   181     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   182     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   183     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   184     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   185     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   186     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   187     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   188     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   189     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   190     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page   6
* EL130.cbl
   191     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   192     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   193     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
   194     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   195     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   196     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   197     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   198     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   199     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   200     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   201     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   202     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   203     12  FILE-ID             PIC X(8).
   204     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   205     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   206     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   207     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   208     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   209     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   210     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   211     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   212     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   213
   214 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   215     12  M                   PIC S9(7)V99           VALUE ZEROS.
   216     12  L                   PIC S9(7)V99           VALUE ZEROS.
   217     12  N                   PIC S9(3)              VALUE ZEROS.
   218     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   219     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   220     12  I                   PIC S99V9(5)           VALUE ZEROS.
   221     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   222     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   223     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   224     12  R                   PIC S9(3)              VALUE ZEROS.
   225     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   226     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   227     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   228     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   229     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   230     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   231     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   232     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   233     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   234
   235 01  TERM-CALC-WORK-AREA.
   236     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   237     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   238     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   239     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   240     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   241     12  V-EXPONENTS.
   242        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   243     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   244
   245 01  MISC-WORK-AREAS.
   246     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   247     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   248     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page   7
* EL130.cbl
   249     12  QID.
   250         16  QID-TERM        PIC X(4).
   251         16  FILLER          PIC X(4)    VALUE '130A'.
   252     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   253     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   254     12  WS-GROUP-NO.
   255         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   256         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   257
   258     12  WS-RESPONSE         PIC S9(8)   COMP.
   259         88  WS-RESP-NORMAL              VALUE +00.
   260         88  WS-RESP-ERROR               VALUE +01.
   261         88  WS-RESP-NOTFND              VALUE +13.
   262         88  WS-RESP-DUPKEY              VALUE +15.
   263         88  WS-RESP-NOTOPEN             VALUE +19.
   264         88  WS-RESP-ENDFILE             VALUE +20.
   265
   266***************************************************************
   267*                                                             *
   268*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   269*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   270*    CHANGES WITH IN MAP EL130A.                              *
   271*                                                             *
   272***************************************************************
   273
   274     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   275     12  WS-SAVE-CLAIM-MASTER.
   276         16  FILLER                    PIC XX.
   277         16  WS-SAVE-CLAIM-KEY.
   278             20  WS-SAVE-COMPANY-CD    PIC X.
   279             20  WS-SAVE-CARRIER       PIC X.
   280             20  WS-SAVE-CLAIM-NO      PIC X(7).
   281             20  WS-SAVE-CERT-NO       PIC X(11).
   282         16  FILLER                    PIC X(328).
   283     12  SAVE-CURRENT-DATE         PIC XX.
   284     12  SAVE-CONTROL              PIC X(39).
   285     12  SAVE-ERACCT-KEY           PIC X(26).
   286     12  SAVE-COUNTER              PIC S9(8)   COMP.
   287     12  SAVE-METHOD               PIC X.
   288     12  SAVE-COMPANY-ID           PIC XXX.
   289     12  SAVE-COMPANY-CD           PIC X.
   290     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   291     12  SAVE-CREDIT-USER          PIC X.
   292     12  SAVE-CLAIM-USER           PIC X.
   293     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   294     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   295     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   296     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   297     12  SAVE-AH-OVERRIDE-L1       PIC X.
   298     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   299     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   300     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   301     12  FILLER                    PIC X.
   302*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   303     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   304     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   305     12  SAVE-EL127-TO-EL130-CNTRL.
   306         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page   8
* EL130.cbl
   307         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   308         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   309             20  SAVE-EL127-CARRIER  PIC X.
   310             20  SAVE-EL127-GROUPING PIC X(6).
   311             20  SAVE-EL127-STATE    PIC X(2).
   312             20  SAVE-EL127-ACCOUNT  PIC X(10).
   313             20  SAVE-EL127-CERT-NO  PIC X(11).
   314             20  SAVE-EL127-EFF-DT   PIC XX.
   315     12  SAVE-EL659-TO-EL130-CNTRL.
   316         16  SAVE-EL659-CARRIER    PIC X.
   317         16  SAVE-EL659-GROUPING   PIC X(6).
   318         16  SAVE-EL659-STATE      PIC XX.
   319         16  SAVE-EL659-ACCOUNT    PIC X(10).
   320     12  DIVIDE-QUOT               PIC 999.
   321     12  DIVIDE-REM                PIC 999.
   322     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   323     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   324     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   325     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   326     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   327     12  WS-RESERVE-CONTROLS       PIC X(9).
   328     12  WS-EXPENSE-CONTROLS       PIC X(7).
   329     12  WS-REIN-TABLE.
   330         16  WS-REIN-1             PIC X            VALUE SPACE.
   331         16  WS-REIN-2             PIC X            VALUE SPACE.
   332         16  WS-REIN-3             PIC X            VALUE SPACE.
   333     12  WS-BENE-CALC-METHOD       PIC X.
   334     12  ws-lf-joint-indicator     pic x.
   335     12  ws-ah-joint-indicator     pic x.
   336     12  WS-EARNINGS-CALC          PIC X.
   337     12  WS-LF-EARNINGS-CALC       PIC X.
   338         88 TEX-REG                VALUE '4'.
   339         88 NET-PAY                VALUE '5'.
   340     12  WS-AH-EARNINGS-CALC       PIC X.
   341     12  WS-SPECIAL-CALC-CD        PIC X(01).
   342     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   343     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   344     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   345     12  WS-ICD-CODE-1             PIC X(8).
   346     12  WS-ICD-CODE-2             PIC X(8).
   347     12  WS-CLAIM-NUMBER.
   348         16  WS-CN-PREFIX.
   349             20  WS-CN-PRF-A PIC X.
   350             20  WS-CN-PRF-B PIC X.
   351         16  WS-CN-NUMBER    PIC 9(5).
   352     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   353     12  WS-CLAIM-SEQU.
   354         16  FILLER          PIC X    VALUE '('.
   355         16  WS-CURRENT-SEQU PIC Z9.
   356         16  FILLER          PIC X(4) VALUE ' OF '.
   357         16  WS-OF-SEQU      PIC Z9.
   358         16  FILLER          PIC X    VALUE ')'.
   359     12  DATE-WORK.
   360       14  FILLER                PIC XX.
   361       14  DATE-MM               PIC XX.
   362       14  DATE-DD               PIC XX.
   363       14  DATE-YY               PIC XX.
   364     12  CURR-DATE REDEFINES DATE-WORK.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page   9
* EL130.cbl
   365         16  CURR-MM.
   366           18  CURR-M1           PIC 9.
   367           18  CURR-M2           PIC 9.
   368         16  FILLER              PIC X(5).
   369         16  CURR-YEAR           PIC 9.
   370     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   371     12  SUB                     PIC 99.
   372     12  MY-DATE.
   373         16  MY-MM               PIC XX.
   374         16  FILLER              PIC X VALUE '/'.
   375         16  MY-YY               PIC XX.
   376
   377     12  WS-EDIT-BEN-CODE        PIC XX.
   378         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   379                                          '90' THRU '99'.
   380
   381     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   382     12  WS-BEN-HOLD             PIC XX.
   383     12  WS-BEN-ALPHA-HOLD.
   384         15  WS-BEN-ALPHA-2      PIC XX.
   385         15  WS-BEN-ALPHA-1      PIC X.
   386     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   387     12  WS-REC-TYPE             PIC X.
   388     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   389     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   390     12  ARCH-NUMBER             PIC S9(8)   COMP.
   391     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   392         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   393         88  REIN-REC-FOUND                  VALUE 'Y'.
   394
   395     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   396     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   397
   398
   399 01  CSO-WORK-FIELDS.
   400     12  WS-BLANK            PIC X       VALUE ' '.
   401
   402     12  WS-MA-CONTROL-PRIMARY.
   403         16  WS-MA-COMPANY-CD        PIC  X.
   404         16  WS-MA-CARRIER           PIC  X.
   405         16  WS-MA-GROUPING          PIC  X(6).
   406         16  WS-MA-STATE             PIC  XX.
   407         16  WS-MA-ACCOUNT           PIC  X(10).
   408         16  WS-MA-CERT-EFF-DT       PIC  XX.
   409         16  WS-MA-CERT-NO.
   410             20  WS-MA-CERT-PRIME    PIC  X(10).
   411             20  WS-MA-CERT-SFX      PIC  X.
   412
   413     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   414     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   415     12  WS-SOC-SEC-NUMBER.
   416         16  WS-SOC-SEC-NO       PIC 9(9).
   417         16  WS-SOC-SEC-BLANK    PIC X(2).
   418     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   419         16  WS-SSN-1-3          PIC 9(3).
   420         16  WS-SSN-DASH1        PIC X(1).
   421         16  WS-SSN-4-5          PIC 9(2).
   422         16  WS-SSN-DASH2        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  10
* EL130.cbl
   423         16  WS-SSN-6-9          PIC 9(4).
   424
   425     12  WS-DIAG-VIN-MSG.
   426         16  FILLER          PIC X(11)
   427             VALUE 'VIN NUMBER '.
   428         16  WS-DIAG-VIN     PIC X(17).
   429
   430     12  WS-VERIFY-NOTE      PIC X(34)
   431         VALUE '2ND BENE SSN VERIFICATION REQUIRED'.
   432
   433     12  WS-CAUSAL-NOTE      PIC X(40)
   434         VALUE 'VERIFY IF DX RELATED TO PRIOR CONDITION '.
   435
   436     12  WS-VFY-SSN-NOTE     PIC X(25)
   437         VALUE 'SSN VERIFICATION REQUIRED'.
   438
   439 01  MAP-DATE-AREAS.
   440     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   441     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
   442     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   443     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   444     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   445     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   446     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   447     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   448     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   449     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   450     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   451     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   452     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   453     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   454     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   455     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   456     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   457     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   458     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   459         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   460     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   461     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   462     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   463     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   464
   465 01  ACCESS-KEYS.
   466     12  ELACTQ-KEY.
   467         16  ELACTQ-COMPANY-CD       PIC X.
   468         16  ELACTQ-CARRIER          PIC X.
   469         16  ELACTQ-CLAIM-NO         PIC X(7).
   470         16  ELACTQ-CERT-NO          PIC X(11).
   471     12  ELMSTR-KEY.
   472         16  MSTR-COMP-CD            PIC X.
   473         16  MSTR-CARRIER            PIC X.
   474         16  MSTR-CLAIM-NO           PIC X(7).
   475         16  MSTR-CERT-NO.
   476             20  MSTR-CERT-NO-PRIME  PIC X(10).
   477             20  MSTR-CERT-NO-SUFX   PIC X.
   478     12  SAVE-ELMSTR-KEY.
   479         16  SAVE-COMP-CD            PIC X.
   480         16  SAVE-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  11
* EL130.cbl
   481         16  SAVE-CLAIM-NO           PIC X(7).
   482         16  SAVE-CERT-NO.
   483             20  SAVE-CERT-NO-PRIME  PIC X(10).
   484             20  SAVE-CERT-NO-SUFX   PIC X.
   485     12  ELMSTR5-KEY.
   486         16  MSTR5-COMP-CD           PIC X.
   487         16  MSTR5-CERT-NO.
   488             20  MSTR5-CERT-NO-PRIME PIC X(10).
   489             20  MSTR5-CERT-NO-SUFX  PIC X.
   490     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   491         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   492         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   493         88  CLAIM-RECORD-FOUND            VALUE 'H'.
   494     12  ELCNTL-KEY.
   495         16  CNTL-COMP-ID    PIC X(3).
   496         16  CNTL-REC-TYPE   PIC X.
   497         16  CNTL-ACCESS.
   498             20  FILLER      PIC XX.
   499             20  CNTL-BENEFIT.
   500                 24  FILLER  PIC X.
   501                 24  CNTL-CARRIER PIC X.
   502         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   503     12  ELCERT-KEY.
   504         16  CERT-COMP-CD    PIC X.
   505         16  CERT-CARRIER    PIC X.
   506         16  CERT-GROUPING   PIC X(6).
   507         16  CERT-STATE      PIC X(2).
   508         16  CERT-ACCOUNT.
   509             20  CERT-ACCOUNT-PREFIX PIC X(4).
   510             20  CERT-ACCOUNT-PRIME  PIC X(6).
   511         16  CERT-EFF-DT     PIC XX.
   512         16  CERT-CERT-NO.
   513             20  CERT-CERT-NO-PRIME  PIC X(10).
   514             20  CERT-CERT-NO-SUFX   PIC X.
   515     12  ELCERT-KEY-5.
   516         16  CERT-COMP-CD-5      PIC X.
   517         16  CERT-CERT-5.
   518             20  CERT-CERT-5-PRIME   PIC X(10).
   519             20  CERT-CERT-5-SUFX    PIC X.
   520     12  ERACCT-KEY.
   521         16  ACCT-COMP-CD    PIC X.
   522         16  ACCT-CARRIER    PIC X.
   523         16  ACCT-GROUPING   PIC X(6).
   524         16  ACCT-STATE      PIC X(2).
   525         16  ACCT-ACCOUNT    PIC X(10).
   526         16  ACCT-EXP-DT     PIC XX.
   527     12  ELTRLR-KEY.
   528         16  TRLR-COMP-CD    PIC X.
   529         16  TRLR-CARRIER    PIC X.
   530         16  TRLR-CLAIM-NO   PIC X(7).
   531         16  TRLR-CERT-NO.
   532             20  TRLR-CERT-NO-PRIME  PIC X(10).
   533             20  TRLR-CERT-NO-SUFX   PIC X.
   534         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   535         16  TRLR-TYPE       PIC X.
   536     12  ELBENE-KEY.
   537         16  BENE-COMP-CD    PIC X.
   538         16  BENE-RCD-TYPE   PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  12
* EL130.cbl
   539         16  BENE-CODE       PIC X(10).
   540     12  ERREIN-KEY.
   541         16  REIN-COMP-CD        PIC X(01).
   542         16  REIN-TYPE           PIC X(01).
   543         16  REIN-TABLE-CO.
   544             20  REIN-CODE-1     PIC X(01).
   545             20  REIN-CODE-2     PIC X(01).
   546             20  REIN-CODE-3     PIC X(01).
   547         16  FILLER              PIC X(03).
   548     12  ELCRTT-KEY.
   549         16  CTRLR-COMP-CD       PIC X.
   550         16  CTRLR-CARRIER       PIC X.
   551         16  CTRLR-GROUPING      PIC X(6).
   552         16  CTRLR-STATE         PIC X(2).
   553         16  CTRLR-ACCOUNT       PIC X(10).
   554         16  CTRLR-EFF-DT        PIC XX.
   555         16  CTRLR-CERT-NO       PIC X(11).
   556         16  CTRLR-REC-TYPE      PIC X.
   557 01  ws-acct-found-sw            pic x value ' '.
   558     88  acct-found                value 'Y'.
   559 01  ERPDEF-KEY-SAVE             PIC X(18).
   560 01  ERPDEF-KEY.
   561     12  ERPDEF-COMPANY-CD       PIC X.
   562     12  ERPDEF-STATE            PIC XX.
   563     12  ERPDEF-PROD-CD          PIC XXX.
   564     12  F                       PIC X(7).
   565     12  ERPDEF-BEN-TYPE         PIC X.
   566     12  ERPDEF-BEN-CODE         PIC XX.
   567     12  ERPDEF-EXP-DT           PIC XX.
   568 01  ERROR-MESSAGES.
   569     12  ER-0000                 PIC X(4)  VALUE '0000'.
   570     12  ER-0004                 PIC X(4)  VALUE '0004'.
   571     12  ER-0019                 PIC X(4)  VALUE '0019'.
   572     12  ER-0023                 PIC X(4)  VALUE '0023'.
   573     12  ER-0029                 PIC X(4)  VALUE '0029'.
   574     12  ER-0033                 PIC X(4)  VALUE '0033'.
   575     12  ER-0068                 PIC X(4)  VALUE '0068'.
   576     12  ER-0070                 PIC X(4)  VALUE '0070'.
   577     12  ER-0194                 PIC X(4)  VALUE '0194'.
   578     12  ER-0202                 PIC X(4)  VALUE '0202'.
   579     12  ER-0203                 PIC X(4)  VALUE '0203'.
   580     12  ER-0204                 PIC X(4)  VALUE '0204'.
   581     12  ER-0205                 PIC X(4)  VALUE '0205'.
   582     12  ER-0206                 PIC X(4)  VALUE '0206'.
   583     12  ER-0207                 PIC X(4)  VALUE '0207'.
   584     12  ER-0213                 PIC X(4)  VALUE '0213'.
   585     12  ER-0214                 PIC X(4)  VALUE '0214'.
   586     12  ER-0217                 PIC X(4)  VALUE '0217'.
   587     12  ER-0219                 PIC X(4)  VALUE '0219'.
   588     12  ER-0220                 PIC X(4)  VALUE '0220'.
   589     12  ER-0221                 PIC X(4)  VALUE '0221'.
   590     12  ER-0222                 PIC X(4)  VALUE '0222'.
   591     12  ER-0223                 PIC X(4)  VALUE '0223'.
   592     12  ER-0224                 PIC X(4)  VALUE '0224'.
   593     12  ER-0225                 PIC X(4)  VALUE '0225'.
   594     12  ER-0226                 PIC X(4)  VALUE '0226'.
   595     12  ER-0227                 PIC X(4)  VALUE '0227'.
   596     12  ER-0229                 PIC X(4)  VALUE '0229'.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  13
* EL130.cbl
   597     12  ER-0230                 PIC X(4)  VALUE '0230'.
   598     12  ER-0231                 PIC X(4)  VALUE '0231'.
   599     12  ER-0232                 PIC X(4)  VALUE '0232'.
   600     12  ER-0233                 PIC X(4)  VALUE '0233'.
   601     12  ER-0234                 PIC X(4)  VALUE '0234'.
   602     12  ER-0235                 PIC X(4)  VALUE '0235'.
   603     12  ER-0236                 PIC X(4)  VALUE '0236'.
   604     12  ER-0237                 PIC X(4)  VALUE '0237'.
   605     12  ER-0238                 PIC X(4)  VALUE '0238'.
   606     12  ER-0239                 PIC X(4)  VALUE '0239'.
   607     12  ER-0240                 PIC X(4)  VALUE '0240'.
   608     12  ER-0241                 PIC X(4)  VALUE '0241'.
   609     12  ER-0243                 PIC X(4)  VALUE '0243'.
   610     12  ER-0244                 PIC X(4)  VALUE '0244'.
   611     12  ER-0245                 PIC X(4)  VALUE '0245'.
   612     12  ER-0246                 PIC X(4)  VALUE '0246'.
   613     12  ER-0247                 PIC X(4)  VALUE '0247'.
   614     12  ER-0248                 PIC X(4)  VALUE '0248'.
   615     12  ER-0250                 PIC X(4)  VALUE '0250'.
   616     12  ER-0251                 PIC X(4)  VALUE '0251'.
   617     12  ER-0252                 PIC X(4)  VALUE '0252'.
   618     12  ER-0253                 PIC X(4)  VALUE '0253'.
   619     12  ER-0254                 PIC X(4)  VALUE '0254'.
   620     12  ER-0257                 PIC X(4)  VALUE '0257'.
   621     12  ER-0258                 PIC X(4)  VALUE '0258'.
   622     12  ER-0260                 PIC X(4)  VALUE '0260'.
   623     12  ER-0261                 PIC X(4)  VALUE '0261'.
   624     12  ER-0263                 PIC X(4)  VALUE '0263'.
   625     12  ER-0264                 PIC X(4)  VALUE '0264'.
   626     12  ER-0265                 PIC X(4)  VALUE '0265'.
   627     12  ER-0266                 PIC X(4)  VALUE '0266'.
   628     12  ER-0267                 PIC X(4)  VALUE '0267'.
   629     12  ER-0334                 PIC X(4)  VALUE '0334'.
   630     12  ER-0337                 PIC X(4)  VALUE '0337'.
   631     12  ER-0412                 PIC X(4)  VALUE '0412'.
   632     12  ER-0413                 PIC X(4)  VALUE '0413'.
   633     12  ER-0428                 PIC X(4)  VALUE '0428'.
   634     12  ER-0429                 PIC X(4)  VALUE '0429'.
   635     12  ER-0430                 PIC X(4)  VALUE '0430'.
   636     12  ER-0433                 PIC X(4)  VALUE '0433'.
   637     12  ER-0434                 PIC X(4)  VALUE '0434'.
   638     12  ER-0458                 PIC X(4)  VALUE '0458'.
   639     12  ER-0489                 PIC X(4)  VALUE '0489'.
   640     12  ER-0509                 PIC X(4)  VALUE '0509'.
   641     12  ER-0510                 PIC X(4)  VALUE '0510'.
   642     12  ER-0511                 PIC X(4)  VALUE '0511'.
   643     12  ER-0512                 PIC X(4)  VALUE '0512'.
   644     12  ER-0516                 PIC X(4)  VALUE '0516'.
   645     12  ER-0517                 PIC X(4)  VALUE '0517'.
   646     12  ER-0518                 PIC X(4)  VALUE '0518'.
   647     12  ER-0519                 PIC X(4)  VALUE '0519'.
   648     12  ER-0520                 PIC X(4)  VALUE '0520'.
   649     12  ER-0521                 PIC X(4)  VALUE '0521'.
   650     12  ER-0522                 PIC X(4)  VALUE '0522'.
   651     12  ER-0523                 PIC X(4)  VALUE '0523'.
   652     12  ER-0544                 PIC X(4)  VALUE '0544'.
   653     12  ER-0546                 PIC X(4)  VALUE '0546'.
   654     12  ER-0558                 PIC X(4)  VALUE '0558'.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  14
* EL130.cbl
   655     12  ER-0560                 PIC X(4)  VALUE '0560'.
   656     12  ER-0562                 PIC X(4)  VALUE '0562'.
   657     12  ER-0565                 PIC X(4)  VALUE '0565'.
   658     12  ER-0569                 PIC X(4)  VALUE '0569'.
   659     12  ER-0693                 PIC X(4)  VALUE '0693'.
   660     12  ER-0715                 PIC X(4)  VALUE '0715'.
   661     12  ER-0840                 PIC X(4)  VALUE '0840'.
   662     12  ER-0841                 PIC X(4)  VALUE '0841'.
   663     12  ER-0842                 PIC X(4)  VALUE '0842'.
   664     12  ER-0843                 PIC X(4)  VALUE '0843'.
   665     12  ER-0878                 PIC X(4)  VALUE '0878'.
   666     12  ER-0887                 PIC X(4)  VALUE '0887'.
   667     12  ER-0992                 PIC X(4)  VALUE '0992'.
   668     12  ER-1651                 PIC X(4)  VALUE '1651'.
   669     12  ER-1652                 PIC X(4)  VALUE '1652'.
   670     12  ER-1653                 PIC X(4)  VALUE '1653'.
   671     12  ER-1654                 PIC X(4)  VALUE '1654'.
   672     12  ER-1655                 PIC X(4)  VALUE '1655'.
   673     12  er-1659                 pic x(4)  value '1659'.
   674     12  er-1660                 pic x(4)  value '1660'.
   675     12  er-1661                 pic x(4)  value '1661'.
   676     12  er-1671                 pic x(4)  value '1671'.
   677     12  er-1672                 pic x(4)  value '1672'.
   678     12  er-1673                 pic x(4)  value '1673'.
   679     12  er-1675                 pic x(4)  value '1675'.
   680     12  er-1676                 pic x(4)  value '1676'.
   681     12  ER-1679                 PIC X(4)  VALUE '1679'.
   682     12  ER-2280                 PIC X(4)  VALUE '2280'.
   683     12  ER-2370                 PIC X(4)  VALUE '2370'.
   684     12  ER-2371                 PIC X(4)  VALUE '2371'.
   685     12  ER-2378                 PIC X(4)  VALUE '2378'.
   686     12  ER-2380                 PIC X(4)  VALUE '2380'.
   687     12  ER-2566                 PIC X(4)  VALUE '2566'.
   688     12  ER-2848                 PIC X(4)  VALUE '2848'.
   689     12  ER-3548                 PIC X(4)  VALUE '3548'.
   690     12  ER-7008                 PIC X(4)  VALUE '7008'.
   691     12  ER-7319                 PIC X(4)  VALUE '7319'.
   692     12  ER-7321                 PIC X(4)  VALUE '7321'.
   693     12  ER-7352                 PIC X(4)  VALUE '7352'.
   694     12  ER-7353                 PIC X(4)  VALUE '7353'.
   695     12  ER-7575                 PIC X(4)  VALUE '7575'.
   696     12  ER-7577                 PIC X(4)  VALUE '7577'.
   697     12  ER-7582                 PIC X(4)  VALUE '7582'.
   698     12  ER-7634                 PIC X(4)  VALUE '7634'.
   699     12  ER-7635                 PIC X(4)  VALUE '7635'.
   700     12  ER-7636                 PIC X(4)  VALUE '7636'.
   701     12  ER-7637                 PIC X(4)  VALUE '7637'.
   702     12  ER-7638                 PIC X(4)  VALUE '7638'.
   703     12  ER-7639                 PIC X(4)  VALUE '7639'.
   704     12  ER-7640                 PIC X(4)  VALUE '7640'.
   705     12  ER-7641                 PIC X(4)  VALUE '7641'.
   706     12  ER-7642                 PIC X(4)  VALUE '7642'.
   707     12  ER-7643                 PIC X(4)  VALUE '7643'.
   708     12  ER-7646                 PIC X(4)  VALUE '7646'.
   709     12  ER-7647                 PIC X(4)  VALUE '7647'.
   710     12  ER-7648                 PIC X(4)  VALUE '7648'.
   711     12  ER-7649                 PIC X(4)  VALUE '7649'.
   712     12  ER-7651                 PIC X(4)  VALUE '7651'.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  15
* EL130.cbl
   713     12  ER-7670                 PIC X(4)  VALUE '7670'.
   714     12  ER-7671                 PIC X(4)  VALUE '7671'.
   715     12  ER-7686                 PIC X(4)  VALUE '7686'.
   716     12  ER-7688                 PIC X(4)  VALUE '7688'.
   717     12  ER-7689                 PIC X(4)  VALUE '7689'.
   718     12  ER-7691                 PIC X(4)  VALUE '7691'.
   719*    COPY ERCPDEF.
   720******************************************************************
   721*                                                                *
   722*                                                                *
   723*                            ERCPDEF.                            *
   724*                                                                *
   725*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   726*                                                                *
   727*    FILE TYPE = VSAM,KSDS                                       *
   728*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   729*                                                                *
   730*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   731*                                                                *
   732*    LOG = YES                                                   *
   733*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   734******************************************************************
   735*                   C H A N G E   L O G
   736*
   737* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   738*-----------------------------------------------------------------
   739*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   740* EFFECTIVE    NUMBER
   741*-----------------------------------------------------------------
   742* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   743* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   744* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   745******************************************************************
   746 01  PRODUCT-MASTER.
   747    12  PD-RECORD-ID                 PIC X(02).
   748        88  VALID-PD-ID                  VALUE 'PD'.
   749    12  PD-CONTROL-PRIMARY.
   750        16  PD-COMPANY-CD            PIC X.
   751        16  PD-STATE                 PIC XX.
   752        16  PD-PRODUCT-CD            PIC XXX.
   753        16  PD-FILLER                PIC X(7).
   754        16  PD-BEN-TYPE              PIC X.
   755        16  PD-BEN-CODE              PIC XX.
   756        16  PD-PROD-EXP-DT           PIC XX.
   757    12  FILLER                       PIC X(50).
   758    12  PD-PRODUCT-DATA OCCURS 8.
   759        16  PD-PROD-CODE             PIC X.
   760            88  PD-PROD-LIFE           VALUE 'L'.
   761            88  PD-PROD-PROP           VALUE 'P'.
   762            88  PD-PROD-AH             VALUE 'A'.
   763            88  PD-PROD-IU             VALUE 'I'.
   764            88  PD-PROD-GAP            VALUE 'G'.
   765            88  PD-PROD-FAML           VALUE 'F'.
   766        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   767        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   768        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   769        16  PD-MAX-TERM              PIC S999        COMP-3.
   770        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  16
* EL130.cbl
   771        16  FILLER                   PIC X.
   772        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   773        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   774        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   775        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   776        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   777        16  PD-REC-CRIT-PERIOD       PIC 99.
   778        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
   779            20  PD-RECURRING-YN      PIC X.
   780            20  FILLER               PIC X.
   781        16  PD-RTW-MOS               PIC 99.
   782        16  PD-MAX-EXTENSION         PIC 99.
   783        16  pd-ben-pct               pic sv999 comp-3.
   784*       16  FILLER                   PIC XX.
   785    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   786    12  PD-TERM-LIMITS OCCURS 15.
   787        16  PD-LOW-TERM              PIC S999        COMP-3.
   788        16  PD-HI-TERM               PIC S999        COMP-3.
   789*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   790    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   791        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   792        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   793    12  PD-EARN-FACTORS.
   794        16  FILLER OCCURS 15.
   795            20  FILLER OCCURS 15.
   796                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   797    12  PD-PRODUCT-DESC              PIC X(80).
   798    12  PD-TRUNCATED                 PIC X.
   799    12  FILLER                       PIC X(59).
   800    12  PD-MAINT-INFORMATION.
   801        16  PD-LAST-MAINT-DT         PIC X(02).
   802        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   803        16  PD-LAST-MAINT-BY         PIC X(04).
   804*    COPY ELCLNKLT.
   805******************************************************************
   806*                                                                *
   807*                                                                *
   808*                           ELCLNKLT                             *
   809*                            VMOD=2.003                          *
   810*                                                                *
   811*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   812*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   813*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   814*                                                                *
   815*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   816*   COMPLETING THE REQUIRED FIELDS.                              *
   817*                                                                *
   818*   THE CALLING PROGRAM SHOULD CHECK:                            *
   819*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   820*                              9999 INDICATES AN UNKNOWN ABEND   *
   821*                                   WAS DETECTED.                *
   822*                              ALL OTHER VALUES ARE NORMAL ERROR *
   823*                              CODES FOUND IN THE ERROR FILE.    *
   824******************************************************************
   825 01  W-1523-LINKDATA.
   826     12  W-1523-COMMON-PI-DATA.
   827         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   828         16  FILLER              PIC  X(67).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  17
* EL130.cbl
   829         16  W-1523-COMPANY-CD   PIC  X(01).
   830         16  FILLER              PIC  X(10).
   831         16  W-1523-CONTROL-IN-PROGRESS.
   832             20  W-1523-CARRIER  PIC  X(01).
   833             20  W-1523-GROUPING PIC  X(06).
   834             20  W-1523-STATE    PIC  X(02).
   835             20  W-1523-ACCOUNT  PIC  X(10).
   836             20  W-1523-CLAIM-CERT-GRP.
   837                 24  W-1523-CLAIM-NO
   838                                 PIC  X(07).
   839                 24  W-1523-CERT-NO.
   840                     28  W-1523-CERT-PRIME
   841                                 PIC  X(10).
   842                     28  W-1523-CERT-SFX
   843                                 PIC  X(01).
   844                 24  W-1523-CERT-EFF-DT
   845                                 PIC  X(02).
   846         16  FILLER              PIC X(265).
   847
   848     12  W-1523-WORK-AREA.
   849         16  W-1523-FORM-NUMBER  PIC  X(04).
   850         16  W-1523-NUMBER-COPIES
   851                                 PIC  9(01).
   852         16  W-1523-ADDR-TYPE    PIC  X(02).
   853         16  W-1523-FOLLOW-UP-DATE
   854                                 PIC  X(02).
   855         16  W-1523-RESEND-DATE  PIC  X(02).
   856         16  W-1523-ERROR-CODE   PIC  9(04).
   857             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   858             88  W-1523-FATAL-ERROR
   859                                    VALUES  0006 0013 0042
   860                                            0154 0168 0169
   861                                            0176 9999 0172
   862                                            0179 0186 0281
   863                                            0332 2055 3697
   864                                            3698 3699 3770
   865                                            3771 3772 7675
   866                                            9106 9808 9883
   867                                            9887.
   868             88  W-1523-STOP-ERRORS
   869                                    VALUES  0013 0042 0154
   870                                            0168 0169 0172
   871                                            0281 0332 2055
   872                                            3698 3699 7675
   873                                            9106 9808 9883
   874                                            9999.
   875         16  W-1523-REASON       PIC  X(70).
   876         16  W-1523-ARCHIVE-NUMBER
   877                                 PIC  9(08).
   878     12  W-1523-POINTER-AREA.
   879         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   880         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   881         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   882         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   883         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  18
* EL130.cbl
   885*    COPY ELCINTF.
   886******************************************************************
   887*                                                                *
   888*                                                                *
   889*                            ELCINTF.                            *
   890*                            VMOD=2.017                          *
   891*                                                                *
   892*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   893*                                                                *
   894*       LENGTH = 1024                                            *
   895*                                                                *
   896******************************************************************
   897*                   C H A N G E   L O G
   898*
   899* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   900*-----------------------------------------------------------------
   901*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   902* EFFECTIVE    NUMBER
   903*-----------------------------------------------------------------
   904* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   905******************************************************************
   906 01  PROGRAM-INTERFACE-BLOCK.
   907     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   908     12  PI-CALLING-PROGRAM              PIC X(8).
   909     12  PI-SAVED-PROGRAM-1              PIC X(8).
   910     12  PI-SAVED-PROGRAM-2              PIC X(8).
   911     12  PI-SAVED-PROGRAM-3              PIC X(8).
   912     12  PI-SAVED-PROGRAM-4              PIC X(8).
   913     12  PI-SAVED-PROGRAM-5              PIC X(8).
   914     12  PI-SAVED-PROGRAM-6              PIC X(8).
   915     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   916     12  PI-COMPANY-ID                   PIC XXX.
   917     12  PI-COMPANY-CD                   PIC X.
   918
   919     12  PI-COMPANY-PASSWORD             PIC X(8).
   920
   921     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   922
   923     12  PI-CONTROL-IN-PROGRESS.
   924         16  PI-CARRIER                  PIC X.
   925         16  PI-GROUPING                 PIC X(6).
   926         16  PI-STATE                    PIC XX.
   927         16  PI-ACCOUNT                  PIC X(10).
   928         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   929                                         PIC X(10).
   930         16  PI-CLAIM-CERT-GRP.
   931             20  PI-CLAIM-NO             PIC X(7).
   932             20  PI-CERT-NO.
   933                 25  PI-CERT-PRIME       PIC X(10).
   934                 25  PI-CERT-SFX         PIC X.
   935             20  PI-CERT-EFF-DT          PIC XX.
   936         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   937             20  PI-PLAN-CODE            PIC X(2).
   938             20  PI-REVISION-NUMBER      PIC X(3).
   939             20  PI-PLAN-EFF-DT          PIC X(2).
   940             20  PI-PLAN-EXP-DT          PIC X(2).
   941             20  FILLER                  PIC X(11).
   942         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  19
* EL130.cbl
   943             20  PI-OE-REFERENCE-1.
   944                 25  PI-OE-REF-1-PRIME   PIC X(18).
   945                 25  PI-OE-REF-1-SUFF    PIC XX.
   946
   947     12  PI-SESSION-IN-PROGRESS          PIC X.
   948         88  CLAIM-SESSION                   VALUE '1'.
   949         88  CREDIT-SESSION                  VALUE '2'.
   950         88  WARRANTY-SESSION                VALUE '3'.
   951         88  MORTGAGE-SESSION                VALUE '4'.
   952         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   953
   954
   955*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   956
   957     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   958     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   959
   960     12  PI-CREDIT-USER                  PIC X.
   961         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   962         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   963
   964     12  PI-CLAIM-USER                   PIC X.
   965         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   966         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   967
   968     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   969         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   970         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   971         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   972         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   973         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   974
   975     12  PI-PROCESSOR-ID                 PIC X(4).
   976
   977     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   978
   979     12  PI-MEMBER-CAPTION               PIC X(10).
   980
   981     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   982         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   983
   984     12  PI-LIFE-OVERRIDE-L1             PIC X.
   985     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   986     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   987     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   988
   989     12  PI-AH-OVERRIDE-L1               PIC X.
   990     12  PI-AH-OVERRIDE-L2               PIC XX.
   991     12  PI-AH-OVERRIDE-L6               PIC X(6).
   992     12  PI-AH-OVERRIDE-L12              PIC X(12).
   993
   994     12  PI-NEW-SYSTEM                   PIC X(2).
   995
   996     12  PI-PRIMARY-CERT-NO              PIC X(11).
   997     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   998         88  PI-USES-PAID-TO                 VALUE '1'.
   999     12  PI-CRDTCRD-SYSTEM.
  1000         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  20
* EL130.cbl
  1001             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1002             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1003         16  PI-CC-MONTH-END-DT          PIC XX.
  1004     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1005
  1006     12  PI-OE-REFERENCE-2.
  1007         16  PI-OE-REF-2-PRIME           PIC X(10).
  1008         16  PI-OE-REF-2-SUFF            PIC X.
  1009
  1010     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1011
  1012     12  PI-LANGUAGE-TYPE                PIC X.
  1013             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1014             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1015             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1016
  1017     12  PI-POLICY-LINKAGE-IND           PIC X.
  1018         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1019         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1020                                                   LOW-VALUES.
  1021
  1022     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1023     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1024         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1025         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1026
  1027     12  PI-PROCESSOR-CSR-IND            PIC X.
  1028         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1029         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1030
  1031     12  FILLER                          PIC X(3).
  1032
  1033     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1034
  1035     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1036         PI-SYSTEM-LEVEL.
  1037
  1038         16  PI-ENTRY-CODES.
  1039             20  PI-ENTRY-CD-1           PIC X.
  1040             20  PI-ENTRY-CD-2           PIC X.
  1041
  1042         16  PI-RETURN-CODES.
  1043             20  PI-RETURN-CD-1          PIC X.
  1044             20  PI-RETURN-CD-2          PIC X.
  1045
  1046         16  PI-UPDATE-STATUS-SAVE.
  1047             20  PI-UPDATE-BY            PIC X(4).
  1048             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1049
  1050         16  PI-LOWER-CASE-LETTERS       PIC X.
  1051             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1052
  1053*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1054*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1055*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1056
  1057         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1058             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  21
* EL130.cbl
  1059             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1060             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1061             88  ACCNT-CNTL                  VALUE '3'.
  1062             88  CARR-ACCNT-CNTL             VALUE '4'.
  1063
  1064         16  PI-PROCESSOR-CAP-LIST.
  1065             20  PI-SYSTEM-CONTROLS.
  1066                24 PI-SYSTEM-DISPLAY     PIC X.
  1067                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1068                24 PI-SYSTEM-MODIFY      PIC X.
  1069                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1070             20  FILLER                  PIC XX.
  1071             20  PI-DISPLAY-CAP          PIC X.
  1072                 88  DISPLAY-CAP             VALUE 'Y'.
  1073             20  PI-MODIFY-CAP           PIC X.
  1074                 88  MODIFY-CAP              VALUE 'Y'.
  1075             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1076                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1077             20  PI-FORCE-CAP            PIC X.
  1078                 88  FORCE-CAP               VALUE 'Y'.
  1079
  1080         16  PI-PROGRAM-CONTROLS.
  1081             20  PI-PGM-PRINT-OPT        PIC X.
  1082             20  PI-PGM-FORMAT-OPT       PIC X.
  1083             20  PI-PGM-PROCESS-OPT      PIC X.
  1084             20  PI-PGM-TOTALS-OPT       PIC X.
  1085
  1086         16  PI-HELP-INTERFACE.
  1087             20  PI-LAST-ERROR-NO        PIC X(4).
  1088             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1089
  1090         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1091             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1092
  1093         16  PI-CR-CONTROL-IN-PROGRESS.
  1094             20  PI-CR-CARRIER           PIC X.
  1095             20  PI-CR-GROUPING          PIC X(6).
  1096             20  PI-CR-STATE             PIC XX.
  1097             20  PI-CR-ACCOUNT           PIC X(10).
  1098             20  PI-CR-FIN-RESP          PIC X(10).
  1099             20  PI-CR-TYPE              PIC X.
  1100
  1101         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1102
  1103         16  PI-CR-MONTH-END-DT          PIC XX.
  1104
  1105         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1106             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1107             88  PI-ZERO-CARRIER             VALUE '1'.
  1108             88  PI-ZERO-GROUPING            VALUE '2'.
  1109             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1110
  1111         16  PI-CARRIER-SECURITY         PIC X.
  1112             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1113
  1114         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1115             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1116             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  22
* EL130.cbl
  1117
  1118         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1119             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1120                                         INDEXED BY PI-ACCESS-NDX
  1121                                         PIC X.
  1122
  1123         16  PI-GA-BILLING-CONTROL       PIC X.
  1124             88  PI-GA-BILLING               VALUE '1'.
  1125
  1126         16  PI-MAIL-PROCESSING          PIC X.
  1127             88  PI-MAIL-YES                 VALUE 'Y'.
  1128
  1129         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1130
  1131         16  PI-AR-SYSTEM.
  1132             20  PI-AR-PROCESSING-CNTL   PIC X.
  1133                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1134             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1135             20  PI-AR-MONTH-END-DT      PIC XX.
  1136
  1137         16  PI-MP-SYSTEM.
  1138             20  PI-MORTGAGE-USER            PIC X.
  1139                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1140                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1141             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1142                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1143                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1144                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1145                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1146                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1147             20  PI-MP-MONTH-END-DT          PIC XX.
  1148             20  PI-MP-REFERENCE-NO.
  1149                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1150                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1151
  1152         16  PI-LABEL-CONTROL            PIC X(01).
  1153             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1154             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1155
  1156         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1157             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1158
  1159         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1160             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1161             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1162
  1163         16  FILLER                      PIC X(14).
  1164
  1165     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1166******************************************************************
  1167     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  1168         16  PI-MSTR-DT               PIC XX.
  1169         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
  1170         16  PI-TRLR-DT               PIC XX.
  1171         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
  1172         16  PI-LAST-CLAIM            PIC X(7).
  1173         16  PI-LAST-CARR             PIC X.
  1174         16  PI-LAST-CERT.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  23
* EL130.cbl
  1175             20  PI-LAST-CERT-PRIME   PIC X(10).
  1176             20  PI-LAST-CERT-SUFX    PIC X.
  1177         16  PI-LAST-CLAIM-TYPE       PIC X.
  1178         16  PI-CURSOR                PIC S9(4)   COMP.
  1179         16  PI-SAVE-CERT.
  1180             20  PI-SAVE-CERT-PRIME   PIC X(10).
  1181             20  PI-SAVE-CERT-SUFX    PIC X.
  1182         16  PI-SAVE-EFFDT            PIC X(2).
  1183         16  PI-SAVE-ACCOUNT          PIC X(10).
  1184         16  PI-INCURR-SW             PIC X.
  1185         16  PI-PRT-OPT               PIC X.
  1186         16  PI-ALT-PRT               PIC X(4).
  1187         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1188             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
  1189         16  FILLER                   PIC X(272).
  1190         16  PI-EL127-TO-EL130-CNTRL.
  1191             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1192             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1193             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1194                 24  PI-EL127-CARRIER        PIC X.
  1195                 24  PI-EL127-GROUPING       PIC X(6).
  1196                 24  PI-EL127-STATE          PIC X(2).
  1197                 24  PI-EL127-ACCOUNT        PIC X(10).
  1198                 24  PI-EL127-CERT-NO.
  1199                     28  PI-EL127-CERT-PRIME PIC X(10).
  1200                     28  PI-EL127-CERT-SUFX  PIC X.
  1201                 24  PI-EL127-EFF-DT         PIC XX.
  1202*        16  FILLER                          PIC X(50).
  1203         16  FILLER                          PIC X(31).
  1204         16  PI-EL659-TO-EL130-CNTRL.
  1205             20  PI-EL659-CARRIER            PIC X.
  1206             20  PI-EL659-GROUPING           PIC X(6).
  1207             20  PI-EL659-STATE              PIC XX.
  1208             20  PI-EL659-ACCOUNT            PIC X(10).
  1209
  1210         16  FILLER                          PIC X(19).
  1211
  1212         16  PI-SAVE-INCUR-DT                PIC X(02).
  1213         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1214*         16  FILLER                          PIC X(65).
  1215         16  PI-ST-VFY-2ND-BENE              PIC X.
  1216         16  PI-ST-CAUSAL-STATE              PIC X.
  1217         16  pi-dcc-max-benefits             pic s999 comp-3.
  1218         16  pi-dcc-max-amt                  pic s9(9)v99 comp-3.
  1219         16  pi-emi-sub                      pic 99.
  1220         16  FILLER                          PIC X(53).
  1221
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  24
* EL130.cbl
  1223*    COPY EL130S.
  1224 01  EL130AI.
  1225     05  FILLER            PIC  X(0012).
  1226*    -------------------------------
  1227     05  RUNDTEL PIC S9(0004) COMP.
  1228     05  RUNDTEF PIC  X(0001).
  1229     05  FILLER REDEFINES RUNDTEF.
  1230         10  RUNDTEA PIC  X(0001).
  1231     05  RUNDTEI PIC  X(0008).
  1232*    -------------------------------
  1233     05  RUNTIMEL PIC S9(0004) COMP.
  1234     05  RUNTIMEF PIC  X(0001).
  1235     05  FILLER REDEFINES RUNTIMEF.
  1236         10  RUNTIMEA PIC  X(0001).
  1237     05  RUNTIMEI PIC  X(0005).
  1238*    -------------------------------
  1239     05  COMPL PIC S9(0004) COMP.
  1240     05  COMPF PIC  X(0001).
  1241     05  FILLER REDEFINES COMPF.
  1242         10  COMPA PIC  X(0001).
  1243     05  COMPI PIC  X(0003).
  1244*    -------------------------------
  1245     05  SEQUL PIC S9(0004) COMP.
  1246     05  SEQUF PIC  X(0001).
  1247     05  FILLER REDEFINES SEQUF.
  1248         10  SEQUA PIC  X(0001).
  1249     05  SEQUI PIC  X(0010).
  1250*    -------------------------------
  1251     05  MAINTL PIC S9(0004) COMP.
  1252     05  MAINTF PIC  X(0001).
  1253     05  FILLER REDEFINES MAINTF.
  1254         10  MAINTA PIC  X(0001).
  1255     05  MAINTI PIC  X(0001).
  1256*    -------------------------------
  1257     05  CLMNOL PIC S9(0004) COMP.
  1258     05  CLMNOF PIC  X(0001).
  1259     05  FILLER REDEFINES CLMNOF.
  1260         10  CLMNOA PIC  X(0001).
  1261     05  CLMNOI PIC  X(0007).
  1262*    -------------------------------
  1263     05  CLMCARRL PIC S9(0004) COMP.
  1264     05  CLMCARRF PIC  X(0001).
  1265     05  FILLER REDEFINES CLMCARRF.
  1266         10  CLMCARRA PIC  X(0001).
  1267     05  CLMCARRI PIC  X(0001).
  1268*    -------------------------------
  1269     05  CLMTYPEL PIC S9(0004) COMP.
  1270     05  CLMTYPEF PIC  X(0001).
  1271     05  FILLER REDEFINES CLMTYPEF.
  1272         10  CLMTYPEA PIC  X(0001).
  1273     05  CLMTYPEI PIC  X(0001).
  1274*    -------------------------------
  1275     05  CERTNOL PIC S9(0004) COMP.
  1276     05  CERTNOF PIC  X(0001).
  1277     05  FILLER REDEFINES CERTNOF.
  1278         10  CERTNOA PIC  X(0001).
  1279     05  CERTNOI PIC  X(0010).
  1280*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  25
* EL130.cbl
  1281     05  SUFXL PIC S9(0004) COMP.
  1282     05  SUFXF PIC  X(0001).
  1283     05  FILLER REDEFINES SUFXF.
  1284         10  SUFXA PIC  X(0001).
  1285     05  SUFXI PIC  X(0001).
  1286*    -------------------------------
  1287     05  PCERTNOL PIC S9(0004) COMP.
  1288     05  PCERTNOF PIC  X(0001).
  1289     05  FILLER REDEFINES PCERTNOF.
  1290         10  PCERTNOA PIC  X(0001).
  1291     05  PCERTNOI PIC  X(0010).
  1292*    -------------------------------
  1293     05  PSUFXL PIC S9(0004) COMP.
  1294     05  PSUFXF PIC  X(0001).
  1295     05  FILLER REDEFINES PSUFXF.
  1296         10  PSUFXA PIC  X(0001).
  1297     05  PSUFXI PIC  X(0001).
  1298*    -------------------------------
  1299     05  INCURL PIC S9(0004) COMP.
  1300     05  INCURF PIC  X(0001).
  1301     05  FILLER REDEFINES INCURF.
  1302         10  INCURA PIC  X(0001).
  1303     05  INCURI PIC  X(0008).
  1304*    -------------------------------
  1305     05  REPORTL PIC S9(0004) COMP.
  1306     05  REPORTF PIC  X(0001).
  1307     05  FILLER REDEFINES REPORTF.
  1308         10  REPORTA PIC  X(0001).
  1309     05  REPORTI PIC  X(0008).
  1310*    -------------------------------
  1311     05  ICD1L PIC S9(0004) COMP.
  1312     05  ICD1F PIC  X(0001).
  1313     05  FILLER REDEFINES ICD1F.
  1314         10  ICD1A PIC  X(0001).
  1315     05  ICD1I PIC  X(0008).
  1316*    -------------------------------
  1317     05  ICD2L PIC S9(0004) COMP.
  1318     05  ICD2F PIC  X(0001).
  1319     05  FILLER REDEFINES ICD2F.
  1320         10  ICD2A PIC  X(0001).
  1321     05  ICD2I PIC  X(0008).
  1322*    -------------------------------
  1323     05  DIAGL PIC S9(0004) COMP.
  1324     05  DIAGF PIC  X(0001).
  1325     05  FILLER REDEFINES DIAGF.
  1326         10  DIAGA PIC  X(0001).
  1327     05  DIAGI PIC  X(0060).
  1328*    -------------------------------
  1329     05  BENECDL PIC S9(0004) COMP.
  1330     05  BENECDF PIC  X(0001).
  1331     05  FILLER REDEFINES BENECDF.
  1332         10  BENECDA PIC  X(0001).
  1333     05  BENECDI PIC  X(0010).
  1334*    -------------------------------
  1335     05  BIRTHDTL PIC S9(0004) COMP.
  1336     05  BIRTHDTF PIC  X(0001).
  1337     05  FILLER REDEFINES BIRTHDTF.
  1338         10  BIRTHDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  26
* EL130.cbl
  1339     05  BIRTHDTI PIC  X(0008).
  1340*    -------------------------------
  1341     05  SSNL PIC S9(0004) COMP.
  1342     05  SSNF PIC  X(0001).
  1343     05  FILLER REDEFINES SSNF.
  1344         10  SSNA PIC  X(0001).
  1345     05  SSNI PIC  X(0011).
  1346*    -------------------------------
  1347     05  SEXL PIC S9(0004) COMP.
  1348     05  SEXF PIC  X(0001).
  1349     05  FILLER REDEFINES SEXF.
  1350         10  SEXA PIC  X(0001).
  1351     05  SEXI PIC  X(0001).
  1352*    -------------------------------
  1353     05  INSTYPEL PIC S9(0004) COMP.
  1354     05  INSTYPEF PIC  X(0001).
  1355     05  FILLER REDEFINES INSTYPEF.
  1356         10  INSTYPEA PIC  X(0001).
  1357     05  INSTYPEI PIC  X(0001).
  1358*    -------------------------------
  1359     05  LSTNMEL PIC S9(0004) COMP.
  1360     05  LSTNMEF PIC  X(0001).
  1361     05  FILLER REDEFINES LSTNMEF.
  1362         10  LSTNMEA PIC  X(0001).
  1363     05  LSTNMEI PIC  X(0015).
  1364*    -------------------------------
  1365     05  FSTNMEL PIC S9(0004) COMP.
  1366     05  FSTNMEF PIC  X(0001).
  1367     05  FILLER REDEFINES FSTNMEF.
  1368         10  FSTNMEA PIC  X(0001).
  1369     05  FSTNMEI PIC  X(0012).
  1370*    -------------------------------
  1371     05  INITL PIC S9(0004) COMP.
  1372     05  INITF PIC  X(0001).
  1373     05  FILLER REDEFINES INITF.
  1374         10  INITA PIC  X(0001).
  1375     05  INITI PIC  X(0001).
  1376*    -------------------------------
  1377     05  LOANNOL PIC S9(0004) COMP.
  1378     05  LOANNOF PIC  X(0001).
  1379     05  FILLER REDEFINES LOANNOF.
  1380         10  LOANNOA PIC  X(0001).
  1381     05  LOANNOI PIC  X(0008).
  1382*    -------------------------------
  1383     05  CRTLNMEL PIC S9(0004) COMP.
  1384     05  CRTLNMEF PIC  X(0001).
  1385     05  FILLER REDEFINES CRTLNMEF.
  1386         10  CRTLNMEA PIC  X(0001).
  1387     05  CRTLNMEI PIC  X(0015).
  1388*    -------------------------------
  1389     05  CRTFNMEL PIC S9(0004) COMP.
  1390     05  CRTFNMEF PIC  X(0001).
  1391     05  FILLER REDEFINES CRTFNMEF.
  1392         10  CRTFNMEA PIC  X(0001).
  1393     05  CRTFNMEI PIC  X(0012).
  1394*    -------------------------------
  1395     05  CRTINITL PIC S9(0004) COMP.
  1396     05  CRTINITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  27
* EL130.cbl
  1397     05  FILLER REDEFINES CRTINITF.
  1398         10  CRTINITA PIC  X(0001).
  1399     05  CRTINITI PIC  X(0001).
  1400*    -------------------------------
  1401     05  LOANBALL PIC S9(0004) COMP.
  1402     05  LOANBALF PIC  X(0001).
  1403     05  FILLER REDEFINES LOANBALF.
  1404         10  LOANBALA PIC  X(0001).
  1405     05  LOANBALI PIC  9(7)V99.
  1406*    -------------------------------
  1407     05  MANRSVL PIC S9(0004) COMP.
  1408     05  MANRSVF PIC  X(0001).
  1409     05  FILLER REDEFINES MANRSVF.
  1410         10  MANRSVA PIC  X(0001).
  1411     05  MANRSVI PIC  9(7)V99.
  1412*    -------------------------------
  1413     05  SUPVL PIC S9(0004) COMP.
  1414     05  SUPVF PIC  X(0001).
  1415     05  FILLER REDEFINES SUPVF.
  1416         10  SUPVA PIC  X(0001).
  1417     05  SUPVI PIC  X(0001).
  1418*    -------------------------------
  1419     05  PRICDL PIC S9(0004) COMP.
  1420     05  PRICDF PIC  X(0001).
  1421     05  FILLER REDEFINES PRICDF.
  1422         10  PRICDA PIC  X(0001).
  1423     05  PRICDI PIC  X(0001).
  1424*    -------------------------------
  1425     05  PRODL PIC S9(0004) COMP.
  1426     05  PRODF PIC  X(0001).
  1427     05  FILLER REDEFINES PRODF.
  1428         10  PRODA PIC  X(0001).
  1429     05  PRODI PIC  X(0008).
  1430*    -------------------------------
  1431     05  PRODCDL PIC S9(0004) COMP.
  1432     05  PRODCDF PIC  X(0001).
  1433     05  FILLER REDEFINES PRODCDF.
  1434         10  PRODCDA PIC  X(0001).
  1435     05  PRODCDI PIC  X(0001).
  1436*    -------------------------------
  1437     05  FILETOL PIC S9(0004) COMP.
  1438     05  FILETOF PIC  X(0001).
  1439     05  FILLER REDEFINES FILETOF.
  1440         10  FILETOA PIC  X(0001).
  1441     05  FILETOI PIC  X(0004).
  1442*    -------------------------------
  1443     05  PROCCDL PIC S9(0004) COMP.
  1444     05  PROCCDF PIC  X(0001).
  1445     05  FILLER REDEFINES PROCCDF.
  1446         10  PROCCDA PIC  X(0001).
  1447     05  PROCCDI PIC  X(0004).
  1448*    -------------------------------
  1449     05  RELCLML PIC S9(0004) COMP.
  1450     05  RELCLMF PIC  X(0001).
  1451     05  FILLER REDEFINES RELCLMF.
  1452         10  RELCLMA PIC  X(0001).
  1453     05  RELCLMI PIC  X(0007).
  1454*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  28
* EL130.cbl
  1455     05  PRTOPTL PIC S9(0004) COMP.
  1456     05  PRTOPTF PIC  X(0001).
  1457     05  FILLER REDEFINES PRTOPTF.
  1458         10  PRTOPTA PIC  X(0001).
  1459     05  PRTOPTI PIC  X(0001).
  1460*    -------------------------------
  1461     05  ALTPRTL PIC S9(0004) COMP.
  1462     05  ALTPRTF PIC  X(0001).
  1463     05  FILLER REDEFINES ALTPRTF.
  1464         10  ALTPRTA PIC  X(0001).
  1465     05  ALTPRTI PIC  X(0004).
  1466*    -------------------------------
  1467     05  CERTMTL PIC S9(0004) COMP.
  1468     05  CERTMTF PIC  X(0001).
  1469     05  FILLER REDEFINES CERTMTF.
  1470         10  CERTMTA PIC  X(0001).
  1471     05  CERTMTI PIC  X(0001).
  1472*    -------------------------------
  1473     05  CRTCARRL PIC S9(0004) COMP.
  1474     05  CRTCARRF PIC  X(0001).
  1475     05  FILLER REDEFINES CRTCARRF.
  1476         10  CRTCARRA PIC  X(0001).
  1477     05  CRTCARRI PIC  X(0001).
  1478*    -------------------------------
  1479     05  GROUPL PIC S9(0004) COMP.
  1480     05  GROUPF PIC  X(0001).
  1481     05  FILLER REDEFINES GROUPF.
  1482         10  GROUPA PIC  X(0001).
  1483     05  GROUPI PIC  X(0006).
  1484*    -------------------------------
  1485     05  STATEL PIC S9(0004) COMP.
  1486     05  STATEF PIC  X(0001).
  1487     05  FILLER REDEFINES STATEF.
  1488         10  STATEA PIC  X(0001).
  1489     05  STATEI PIC  X(0002).
  1490*    -------------------------------
  1491     05  ACCOUNTL PIC S9(0004) COMP.
  1492     05  ACCOUNTF PIC  X(0001).
  1493     05  FILLER REDEFINES ACCOUNTF.
  1494         10  ACCOUNTA PIC  X(0001).
  1495     05  ACCOUNTI PIC  X(0010).
  1496*    -------------------------------
  1497     05  EFFDTL PIC S9(0004) COMP.
  1498     05  EFFDTF PIC  X(0001).
  1499     05  FILLER REDEFINES EFFDTF.
  1500         10  EFFDTA PIC  X(0001).
  1501     05  EFFDTI PIC  X(0008).
  1502*    -------------------------------
  1503     05  CRTSSNL PIC S9(0004) COMP.
  1504     05  CRTSSNF PIC  X(0001).
  1505     05  FILLER REDEFINES CRTSSNF.
  1506         10  CRTSSNA PIC  X(0001).
  1507     05  CRTSSNI PIC  X(0011).
  1508*    -------------------------------
  1509     05  MEMCAPL PIC S9(0004) COMP.
  1510     05  MEMCAPF PIC  X(0001).
  1511     05  FILLER REDEFINES MEMCAPF.
  1512         10  MEMCAPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  29
* EL130.cbl
  1513     05  MEMCAPI PIC  X(0010).
  1514*    -------------------------------
  1515     05  MEMBERL PIC S9(0004) COMP.
  1516     05  MEMBERF PIC  X(0001).
  1517     05  FILLER REDEFINES MEMBERF.
  1518         10  MEMBERA PIC  X(0001).
  1519     05  MEMBERI PIC  X(0012).
  1520*    -------------------------------
  1521     05  REINCDL PIC S9(0004) COMP.
  1522     05  REINCDF PIC  X(0001).
  1523     05  FILLER REDEFINES REINCDF.
  1524         10  REINCDA PIC  X(0001).
  1525     05  REINCDI PIC  X(0001).
  1526*    -------------------------------
  1527     05  ISSAGEL PIC S9(0004) COMP.
  1528     05  ISSAGEF PIC  X(0001).
  1529     05  FILLER REDEFINES ISSAGEF.
  1530         10  ISSAGEA PIC  X(0001).
  1531     05  ISSAGEI PIC  X(0002).
  1532*    -------------------------------
  1533     05  APRL PIC S9(0004) COMP.
  1534     05  APRF PIC  X(0001).
  1535     05  FILLER REDEFINES APRF.
  1536         10  APRA PIC  X(0001).
  1537     05  APRI PIC  9(4)V9(4).
  1538*    -------------------------------
  1539     05  PMTFREQL PIC S9(0004) COMP.
  1540     05  PMTFREQF PIC  X(0001).
  1541     05  FILLER REDEFINES PMTFREQF.
  1542         10  PMTFREQA PIC  X(0001).
  1543     05  PMTFREQI PIC  99.
  1544*    -------------------------------
  1545     05  INDGRPL PIC S9(0004) COMP.
  1546     05  INDGRPF PIC  X(0001).
  1547     05  FILLER REDEFINES INDGRPF.
  1548         10  INDGRPA PIC  X(0001).
  1549     05  INDGRPI PIC  X(0001).
  1550*    -------------------------------
  1551     05  PREMTYPL PIC S9(0004) COMP.
  1552     05  PREMTYPF PIC  X(0001).
  1553     05  FILLER REDEFINES PREMTYPF.
  1554         10  PREMTYPA PIC  X(0001).
  1555     05  PREMTYPI PIC  X(0001).
  1556*    -------------------------------
  1557     05  ADDONDTL PIC S9(0004) COMP.
  1558     05  ADDONDTF PIC  X(0001).
  1559     05  FILLER REDEFINES ADDONDTF.
  1560         10  ADDONDTA PIC  X(0001).
  1561     05  ADDONDTI PIC  X(0008).
  1562*    -------------------------------
  1563     05  JNTLNMEL PIC S9(0004) COMP.
  1564     05  JNTLNMEF PIC  X(0001).
  1565     05  FILLER REDEFINES JNTLNMEF.
  1566         10  JNTLNMEA PIC  X(0001).
  1567     05  JNTLNMEI PIC  X(0015).
  1568*    -------------------------------
  1569     05  JNTFNMEL PIC S9(0004) COMP.
  1570     05  JNTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  30
* EL130.cbl
  1571     05  FILLER REDEFINES JNTFNMEF.
  1572         10  JNTFNMEA PIC  X(0001).
  1573     05  JNTFNMEI PIC  X(0002).
  1574*    -------------------------------
  1575     05  JNTINITL PIC S9(0004) COMP.
  1576     05  JNTINITF PIC  X(0001).
  1577     05  FILLER REDEFINES JNTINITF.
  1578         10  JNTINITA PIC  X(0001).
  1579     05  JNTINITI PIC  X(0001).
  1580*    -------------------------------
  1581     05  JNTAGEL PIC S9(0004) COMP.
  1582     05  JNTAGEF PIC  X(0001).
  1583     05  FILLER REDEFINES JNTAGEF.
  1584         10  JNTAGEA PIC  X(0001).
  1585     05  JNTAGEI PIC  X(0002).
  1586*    -------------------------------
  1587     05  LCVDSCRL PIC S9(0004) COMP.
  1588     05  LCVDSCRF PIC  X(0001).
  1589     05  FILLER REDEFINES LCVDSCRF.
  1590         10  LCVDSCRA PIC  X(0001).
  1591     05  LCVDSCRI PIC  X(0006).
  1592*    -------------------------------
  1593     05  LCVKINDL PIC S9(0004) COMP.
  1594     05  LCVKINDF PIC  X(0001).
  1595     05  FILLER REDEFINES LCVKINDF.
  1596         10  LCVKINDA PIC  X(0001).
  1597     05  LCVKINDI PIC  X(0003).
  1598*    -------------------------------
  1599     05  LCVCDL PIC S9(0004) COMP.
  1600     05  LCVCDF PIC  X(0001).
  1601     05  FILLER REDEFINES LCVCDF.
  1602         10  LCVCDA PIC  X(0001).
  1603     05  LCVCDI PIC  X(0002).
  1604*    -------------------------------
  1605     05  LCVOTRML PIC S9(0004) COMP.
  1606     05  LCVOTRMF PIC  X(0001).
  1607     05  FILLER REDEFINES LCVOTRMF.
  1608         10  LCVOTRMA PIC  X(0001).
  1609     05  LCVOTRMI PIC  999.
  1610*    -------------------------------
  1611     05  LCVRTRML PIC S9(0004) COMP.
  1612     05  LCVRTRMF PIC  X(0001).
  1613     05  FILLER REDEFINES LCVRTRMF.
  1614         10  LCVRTRMA PIC  X(0001).
  1615     05  LCVRTRMI PIC  X(0003).
  1616*    -------------------------------
  1617     05  LCVRATEL PIC S9(0004) COMP.
  1618     05  LCVRATEF PIC  X(0001).
  1619     05  FILLER REDEFINES LCVRATEF.
  1620         10  LCVRATEA PIC  X(0001).
  1621     05  LCVRATEI PIC  9999V99.
  1622*    -------------------------------
  1623     05  LCVBENEL PIC S9(0004) COMP.
  1624     05  LCVBENEF PIC  X(0001).
  1625     05  FILLER REDEFINES LCVBENEF.
  1626         10  LCVBENEA PIC  X(0001).
  1627     05  LCVBENEI PIC  9(9)V99.
  1628*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  31
* EL130.cbl
  1629     05  LCVFORML PIC S9(0004) COMP.
  1630     05  LCVFORMF PIC  X(0001).
  1631     05  FILLER REDEFINES LCVFORMF.
  1632         10  LCVFORMA PIC  X(0001).
  1633     05  LCVFORMI PIC  X(0012).
  1634*    -------------------------------
  1635     05  LCVCNDTL PIC S9(0004) COMP.
  1636     05  LCVCNDTF PIC  X(0001).
  1637     05  FILLER REDEFINES LCVCNDTF.
  1638         10  LCVCNDTA PIC  X(0001).
  1639     05  LCVCNDTI PIC  X(0008).
  1640*    -------------------------------
  1641     05  LCVEXITL PIC S9(0004) COMP.
  1642     05  LCVEXITF PIC  X(0001).
  1643     05  FILLER REDEFINES LCVEXITF.
  1644         10  LCVEXITA PIC  X(0001).
  1645     05  LCVEXITI PIC  X(0008).
  1646*    -------------------------------
  1647     05  LCVSTATL PIC S9(0004) COMP.
  1648     05  LCVSTATF PIC  X(0001).
  1649     05  FILLER REDEFINES LCVSTATF.
  1650         10  LCVSTATA PIC  X(0001).
  1651     05  LCVSTATI PIC  X(0006).
  1652*    -------------------------------
  1653     05  ACVDSCRL PIC S9(0004) COMP.
  1654     05  ACVDSCRF PIC  X(0001).
  1655     05  FILLER REDEFINES ACVDSCRF.
  1656         10  ACVDSCRA PIC  X(0001).
  1657     05  ACVDSCRI PIC  X(0006).
  1658*    -------------------------------
  1659     05  ACVKINDL PIC S9(0004) COMP.
  1660     05  ACVKINDF PIC  X(0001).
  1661     05  FILLER REDEFINES ACVKINDF.
  1662         10  ACVKINDA PIC  X(0001).
  1663     05  ACVKINDI PIC  X(0003).
  1664*    -------------------------------
  1665     05  ACVCDL PIC S9(0004) COMP.
  1666     05  ACVCDF PIC  X(0001).
  1667     05  FILLER REDEFINES ACVCDF.
  1668         10  ACVCDA PIC  X(0001).
  1669     05  ACVCDI PIC  X(0002).
  1670*    -------------------------------
  1671     05  ACVOTRML PIC S9(0004) COMP.
  1672     05  ACVOTRMF PIC  X(0001).
  1673     05  FILLER REDEFINES ACVOTRMF.
  1674         10  ACVOTRMA PIC  X(0001).
  1675     05  ACVOTRMI PIC  999.
  1676*    -------------------------------
  1677     05  ACVRTRML PIC S9(0004) COMP.
  1678     05  ACVRTRMF PIC  X(0001).
  1679     05  FILLER REDEFINES ACVRTRMF.
  1680         10  ACVRTRMA PIC  X(0001).
  1681     05  ACVRTRMI PIC  X(0003).
  1682*    -------------------------------
  1683     05  ACVRATEL PIC S9(0004) COMP.
  1684     05  ACVRATEF PIC  X(0001).
  1685     05  FILLER REDEFINES ACVRATEF.
  1686         10  ACVRATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  32
* EL130.cbl
  1687     05  ACVRATEI PIC  9999V99.
  1688*    -------------------------------
  1689     05  ACVBENEL PIC S9(0004) COMP.
  1690     05  ACVBENEF PIC  X(0001).
  1691     05  FILLER REDEFINES ACVBENEF.
  1692         10  ACVBENEA PIC  X(0001).
  1693     05  ACVBENEI PIC  9(9)V99.
  1694*    -------------------------------
  1695     05  ACVFORML PIC S9(0004) COMP.
  1696     05  ACVFORMF PIC  X(0001).
  1697     05  FILLER REDEFINES ACVFORMF.
  1698         10  ACVFORMA PIC  X(0001).
  1699     05  ACVFORMI PIC  X(0012).
  1700*    -------------------------------
  1701     05  ACVCNDTL PIC S9(0004) COMP.
  1702     05  ACVCNDTF PIC  X(0001).
  1703     05  FILLER REDEFINES ACVCNDTF.
  1704         10  ACVCNDTA PIC  X(0001).
  1705     05  ACVCNDTI PIC  X(0008).
  1706*    -------------------------------
  1707     05  ACVEXITL PIC S9(0004) COMP.
  1708     05  ACVEXITF PIC  X(0001).
  1709     05  FILLER REDEFINES ACVEXITF.
  1710         10  ACVEXITA PIC  X(0001).
  1711     05  ACVEXITI PIC  X(0008).
  1712*    -------------------------------
  1713     05  ACVSTATL PIC S9(0004) COMP.
  1714     05  ACVSTATF PIC  X(0001).
  1715     05  FILLER REDEFINES ACVSTATF.
  1716         10  ACVSTATA PIC  X(0001).
  1717     05  ACVSTATI PIC  X(0006).
  1718*    -------------------------------
  1719     05  ERRMSG1L PIC S9(0004) COMP.
  1720     05  ERRMSG1F PIC  X(0001).
  1721     05  FILLER REDEFINES ERRMSG1F.
  1722         10  ERRMSG1A PIC  X(0001).
  1723     05  ERRMSG1I PIC  X(0072).
  1724*    -------------------------------
  1725     05  ERRMSG2L PIC S9(0004) COMP.
  1726     05  ERRMSG2F PIC  X(0001).
  1727     05  FILLER REDEFINES ERRMSG2F.
  1728         10  ERRMSG2A PIC  X(0001).
  1729     05  ERRMSG2I PIC  X(0072).
  1730*    -------------------------------
  1731     05  BCERT1L PIC S9(0004) COMP.
  1732     05  BCERT1F PIC  X(0001).
  1733     05  FILLER REDEFINES BCERT1F.
  1734         10  BCERT1A PIC  X(0001).
  1735     05  BCERT1I PIC  X(0010).
  1736*    -------------------------------
  1737     05  BSUFX1L PIC S9(0004) COMP.
  1738     05  BSUFX1F PIC  X(0001).
  1739     05  FILLER REDEFINES BSUFX1F.
  1740         10  BSUFX1A PIC  X(0001).
  1741     05  BSUFX1I PIC  X(0001).
  1742*    -------------------------------
  1743     05  BCERT2L PIC S9(0004) COMP.
  1744     05  BCERT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  33
* EL130.cbl
  1745     05  FILLER REDEFINES BCERT2F.
  1746         10  BCERT2A PIC  X(0001).
  1747     05  BCERT2I PIC  X(0010).
  1748*    -------------------------------
  1749     05  BSUFX2L PIC S9(0004) COMP.
  1750     05  BSUFX2F PIC  X(0001).
  1751     05  FILLER REDEFINES BSUFX2F.
  1752         10  BSUFX2A PIC  X(0001).
  1753     05  BSUFX2I PIC  X(0001).
  1754*    -------------------------------
  1755     05  BCERT3L PIC S9(0004) COMP.
  1756     05  BCERT3F PIC  X(0001).
  1757     05  FILLER REDEFINES BCERT3F.
  1758         10  BCERT3A PIC  X(0001).
  1759     05  BCERT3I PIC  X(0010).
  1760*    -------------------------------
  1761     05  BSUFX3L PIC S9(0004) COMP.
  1762     05  BSUFX3F PIC  X(0001).
  1763     05  FILLER REDEFINES BSUFX3F.
  1764         10  BSUFX3A PIC  X(0001).
  1765     05  BSUFX3I PIC  X(0001).
  1766*    -------------------------------
  1767     05  BCERT4L PIC S9(0004) COMP.
  1768     05  BCERT4F PIC  X(0001).
  1769     05  FILLER REDEFINES BCERT4F.
  1770         10  BCERT4A PIC  X(0001).
  1771     05  BCERT4I PIC  X(0010).
  1772*    -------------------------------
  1773     05  BSUFX4L PIC S9(0004) COMP.
  1774     05  BSUFX4F PIC  X(0001).
  1775     05  FILLER REDEFINES BSUFX4F.
  1776         10  BSUFX4A PIC  X(0001).
  1777     05  BSUFX4I PIC  X(0001).
  1778*    -------------------------------
  1779     05  BCERT5L PIC S9(0004) COMP.
  1780     05  BCERT5F PIC  X(0001).
  1781     05  FILLER REDEFINES BCERT5F.
  1782         10  BCERT5A PIC  X(0001).
  1783     05  BCERT5I PIC  X(0010).
  1784*    -------------------------------
  1785     05  BSUFX5L PIC S9(0004) COMP.
  1786     05  BSUFX5F PIC  X(0001).
  1787     05  FILLER REDEFINES BSUFX5F.
  1788         10  BSUFX5A PIC  X(0001).
  1789     05  BSUFX5I PIC  X(0001).
  1790*    -------------------------------
  1791     05  ENTERPFL PIC S9(0004) COMP.
  1792     05  ENTERPFF PIC  X(0001).
  1793     05  FILLER REDEFINES ENTERPFF.
  1794         10  ENTERPFA PIC  X(0001).
  1795     05  ENTERPFI PIC  99.
  1796*    -------------------------------
  1797     05  PF5L PIC S9(0004) COMP.
  1798     05  PF5F PIC  X(0001).
  1799     05  FILLER REDEFINES PF5F.
  1800         10  PF5A PIC  X(0001).
  1801     05  PF5I PIC  X(0013).
  1802 01  EL130AO REDEFINES EL130AI.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  34
* EL130.cbl
  1803     05  FILLER            PIC  X(0012).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  RUNDTEO PIC  X(0008).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  RUNTIMEO PIC  99.99.
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  COMPO PIC  X(0003).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  SEQUO PIC  X(0010).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  MAINTO PIC  X(0001).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  CLMNOO PIC  X(0007).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  CLMCARRO PIC  X(0001).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  CLMTYPEO PIC  X(0001).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  CERTNOO PIC  X(0010).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  SUFXO PIC  X(0001).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  PCERTNOO PIC  X(0010).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  PSUFXO PIC  X(0001).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  INCURO PIC  X(0008).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  REPORTO PIC  X(0008).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  ICD1O PIC  X(0008).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  ICD2O PIC  X(0008).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  DIAGO PIC  X(0060).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  BENECDO PIC  X(0010).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  BIRTHDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  35
* EL130.cbl
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  SSNO PIC  X(0011).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  SEXO PIC  X(0001).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  INSTYPEO PIC  X(0001).
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  LSTNMEO PIC  X(0015).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  FSTNMEO PIC  X(0012).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  INITO PIC  X(0001).
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  LOANNOO PIC  X(0008).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  CRTLNMEO PIC  X(0015).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  CRTFNMEO PIC  X(0012).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  CRTINITO PIC  X(0001).
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  LOANBALO PIC  ZZZZZ9.99.
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  MANRSVO PIC  Z(5)9.99.
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  SUPVO PIC  X(0001).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  PRICDO PIC  X(0001).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  PRODO PIC  X(0008).
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  PRODCDO PIC  X(0001).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  FILETOO PIC  X(0004).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  PROCCDO PIC  X(0004).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  RELCLMO PIC  X(0007).
  1918*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  36
* EL130.cbl
  1919     05  FILLER            PIC  X(0003).
  1920     05  PRTOPTO PIC  X(0001).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  ALTPRTO PIC  X(0004).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  CERTMTO PIC  X(0001).
  1927*    -------------------------------
  1928     05  FILLER            PIC  X(0003).
  1929     05  CRTCARRO PIC  X(0001).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  GROUPO PIC  X(0006).
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  STATEO PIC  X(0002).
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  ACCOUNTO PIC  X(0010).
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  EFFDTO PIC  X(0008).
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  CRTSSNO PIC  X(0011).
  1945*    -------------------------------
  1946     05  FILLER            PIC  X(0003).
  1947     05  MEMCAPO PIC  X(0010).
  1948*    -------------------------------
  1949     05  FILLER            PIC  X(0003).
  1950     05  MEMBERO PIC  X(0012).
  1951*    -------------------------------
  1952     05  FILLER            PIC  X(0003).
  1953     05  REINCDO PIC  X(0001).
  1954*    -------------------------------
  1955     05  FILLER            PIC  X(0003).
  1956     05  ISSAGEO PIC  X(0002).
  1957*    -------------------------------
  1958     05  FILLER            PIC  X(0003).
  1959     05  APRO PIC  9(3).9(4).
  1960*    -------------------------------
  1961     05  FILLER            PIC  X(0003).
  1962     05  PMTFREQO PIC  99.
  1963*    -------------------------------
  1964     05  FILLER            PIC  X(0003).
  1965     05  INDGRPO PIC  X(0001).
  1966*    -------------------------------
  1967     05  FILLER            PIC  X(0003).
  1968     05  PREMTYPO PIC  X(0001).
  1969*    -------------------------------
  1970     05  FILLER            PIC  X(0003).
  1971     05  ADDONDTO PIC  X(0008).
  1972*    -------------------------------
  1973     05  FILLER            PIC  X(0003).
  1974     05  JNTLNMEO PIC  X(0015).
  1975*    -------------------------------
  1976     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  37
* EL130.cbl
  1977     05  JNTFNMEO PIC  X(0002).
  1978*    -------------------------------
  1979     05  FILLER            PIC  X(0003).
  1980     05  JNTINITO PIC  X(0001).
  1981*    -------------------------------
  1982     05  FILLER            PIC  X(0003).
  1983     05  JNTAGEO PIC  X(0002).
  1984*    -------------------------------
  1985     05  FILLER            PIC  X(0003).
  1986     05  LCVDSCRO PIC  X(0006).
  1987*    -------------------------------
  1988     05  FILLER            PIC  X(0003).
  1989     05  LCVKINDO PIC  X(0003).
  1990*    -------------------------------
  1991     05  FILLER            PIC  X(0003).
  1992     05  LCVCDO PIC  X(0002).
  1993*    -------------------------------
  1994     05  FILLER            PIC  X(0003).
  1995     05  LCVOTRMO PIC  999.
  1996*    -------------------------------
  1997     05  FILLER            PIC  X(0003).
  1998     05  LCVRTRMO PIC  ZZZ.
  1999*    -------------------------------
  2000     05  FILLER            PIC  X(0003).
  2001     05  LCVRATEO PIC  ZZZ.ZZ.
  2002*    -------------------------------
  2003     05  FILLER            PIC  X(0003).
  2004     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2005*    -------------------------------
  2006     05  FILLER            PIC  X(0003).
  2007     05  LCVFORMO PIC  X(0012).
  2008*    -------------------------------
  2009     05  FILLER            PIC  X(0003).
  2010     05  LCVCNDTO PIC  X(0008).
  2011*    -------------------------------
  2012     05  FILLER            PIC  X(0003).
  2013     05  LCVEXITO PIC  X(0008).
  2014*    -------------------------------
  2015     05  FILLER            PIC  X(0003).
  2016     05  LCVSTATO PIC  X(0006).
  2017*    -------------------------------
  2018     05  FILLER            PIC  X(0003).
  2019     05  ACVDSCRO PIC  X(0006).
  2020*    -------------------------------
  2021     05  FILLER            PIC  X(0003).
  2022     05  ACVKINDO PIC  X(0003).
  2023*    -------------------------------
  2024     05  FILLER            PIC  X(0003).
  2025     05  ACVCDO PIC  X(0002).
  2026*    -------------------------------
  2027     05  FILLER            PIC  X(0003).
  2028     05  ACVOTRMO PIC  999.
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
  2031     05  ACVRTRMO PIC  ZZZ.
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  ACVRATEO PIC  ZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  38
* EL130.cbl
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  ACVFORMO PIC  X(0012).
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
  2043     05  ACVCNDTO PIC  X(0008).
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
  2046     05  ACVEXITO PIC  X(0008).
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  ACVSTATO PIC  X(0006).
  2050*    -------------------------------
  2051     05  FILLER            PIC  X(0003).
  2052     05  ERRMSG1O PIC  X(0072).
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  ERRMSG2O PIC  X(0072).
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
  2058     05  BCERT1O PIC  X(0010).
  2059*    -------------------------------
  2060     05  FILLER            PIC  X(0003).
  2061     05  BSUFX1O PIC  X(0001).
  2062*    -------------------------------
  2063     05  FILLER            PIC  X(0003).
  2064     05  BCERT2O PIC  X(0010).
  2065*    -------------------------------
  2066     05  FILLER            PIC  X(0003).
  2067     05  BSUFX2O PIC  X(0001).
  2068*    -------------------------------
  2069     05  FILLER            PIC  X(0003).
  2070     05  BCERT3O PIC  X(0010).
  2071*    -------------------------------
  2072     05  FILLER            PIC  X(0003).
  2073     05  BSUFX3O PIC  X(0001).
  2074*    -------------------------------
  2075     05  FILLER            PIC  X(0003).
  2076     05  BCERT4O PIC  X(0010).
  2077*    -------------------------------
  2078     05  FILLER            PIC  X(0003).
  2079     05  BSUFX4O PIC  X(0001).
  2080*    -------------------------------
  2081     05  FILLER            PIC  X(0003).
  2082     05  BCERT5O PIC  X(0010).
  2083*    -------------------------------
  2084     05  FILLER            PIC  X(0003).
  2085     05  BSUFX5O PIC  X(0001).
  2086*    -------------------------------
  2087     05  FILLER            PIC  X(0003).
  2088     05  ENTERPFO PIC  X(0002).
  2089*    -------------------------------
  2090     05  FILLER            PIC  X(0003).
  2091     05  PF5O PIC  X(0013).
  2092*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  39
* EL130.cbl
  2094*    COPY ELCDATE.
  2095******************************************************************
  2096*                                                                *
  2097*                                                                *
  2098*                            ELCDATE.                            *
  2099*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2100*                            VMOD=2.003
  2101*                                                                *
  2102*                                                                *
  2103*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2104*                 LENGTH = 200                                   *
  2105******************************************************************
  2106
  2107 01  DATE-CONVERSION-DATA.
  2108     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2109     12  DC-OPTION-CODE                PIC X.
  2110         88  BIN-TO-GREG                VALUE ' '.
  2111         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2112         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2113         88  YMD-GREG-TO-BIN            VALUE '3'.
  2114         88  MDY-GREG-TO-BIN            VALUE '4'.
  2115         88  JULIAN-TO-BIN              VALUE '5'.
  2116         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2117         88  FIND-CENTURY               VALUE '7'.
  2118         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2119         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2120         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2121         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2122         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2123         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2124         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2125         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2126         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2127         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2128         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2129         88  BIN-3-TO-GREG              VALUE 'I'.
  2130         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2131         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2132         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2133         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2134         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2135         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2136         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2137         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2138         88  THREE-CHARACTER-BIN
  2139                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2140         88  GREGORIAN-TO-BIN
  2141                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2142         88  BIN-TO-GREGORIAN
  2143                  VALUES ' ' '1' 'I' '8' 'G'.
  2144         88  JULIAN-TO-BINARY
  2145                  VALUES '5' 'C' 'E' 'F'.
  2146     12  DC-ERROR-CODE                 PIC X.
  2147         88  NO-CONVERSION-ERROR        VALUE ' '.
  2148         88  DATE-CONVERSION-ERROR
  2149                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2150         88  DATE-IS-ZERO               VALUE '1'.
  2151         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  40
* EL130.cbl
  2152         88  DATE-IS-INVALID            VALUE '3'.
  2153         88  DATE1-GREATER-DATE2        VALUE '4'.
  2154         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2155         88  DATE-INVALID-OPTION        VALUE '9'.
  2156         88  INVALID-CENTURY            VALUE 'A'.
  2157         88  ONLY-CENTURY               VALUE 'B'.
  2158         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2159         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2160     12  DC-END-OF-MONTH               PIC X.
  2161         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2162     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2163         88  USE-NORMAL-PROCESS         VALUE ' '.
  2164         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2165         88  ADJUST-UP-100-YRS          VALUE '2'.
  2166     12  FILLER                        PIC X.
  2167     12  DC-CONVERSION-DATES.
  2168         16  DC-BIN-DATE-1             PIC XX.
  2169         16  DC-BIN-DATE-2             PIC XX.
  2170         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2171         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2172                       DC-GREG-DATE-1-EDIT.
  2173             20  DC-EDIT1-MONTH        PIC 99.
  2174             20  SLASH1-1              PIC X.
  2175             20  DC-EDIT1-DAY          PIC 99.
  2176             20  SLASH1-2              PIC X.
  2177             20  DC-EDIT1-YEAR         PIC 99.
  2178         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2179         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2180                     DC-GREG-DATE-2-EDIT.
  2181             20  DC-EDIT2-MONTH        PIC 99.
  2182             20  SLASH2-1              PIC X.
  2183             20  DC-EDIT2-DAY          PIC 99.
  2184             20  SLASH2-2              PIC X.
  2185             20  DC-EDIT2-YEAR         PIC 99.
  2186         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2187         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2188                     DC-GREG-DATE-1-YMD.
  2189             20  DC-YMD-YEAR           PIC 99.
  2190             20  DC-YMD-MONTH          PIC 99.
  2191             20  DC-YMD-DAY            PIC 99.
  2192         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2193         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2194                      DC-GREG-DATE-1-MDY.
  2195             20  DC-MDY-MONTH          PIC 99.
  2196             20  DC-MDY-DAY            PIC 99.
  2197             20  DC-MDY-YEAR           PIC 99.
  2198         16  DC-GREG-DATE-1-ALPHA.
  2199             20  DC-ALPHA-MONTH        PIC X(10).
  2200             20  DC-ALPHA-DAY          PIC 99.
  2201             20  FILLER                PIC XX.
  2202             20  DC-ALPHA-CENTURY.
  2203                 24 DC-ALPHA-CEN-N     PIC 99.
  2204             20  DC-ALPHA-YEAR         PIC 99.
  2205         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2206         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2207         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2208         16  DC-JULIAN-DATE            PIC 9(05).
  2209         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  41
* EL130.cbl
  2210                                       PIC 9(05).
  2211         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2212             20  DC-JULIAN-YEAR        PIC 99.
  2213             20  DC-JULIAN-DAYS        PIC 999.
  2214         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2215         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2216         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2217     12  DATE-CONVERSION-VARIBLES.
  2218         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2219         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2220             20  FILLER                PIC 9(3).
  2221             20  HOLD-CEN-1-CCYY.
  2222                 24  HOLD-CEN-1-CC     PIC 99.
  2223                 24  HOLD-CEN-1-YY     PIC 99.
  2224             20  HOLD-CEN-1-MO         PIC 99.
  2225             20  HOLD-CEN-1-DA         PIC 99.
  2226         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2227             20  HOLD-CEN-1-R-MO       PIC 99.
  2228             20  HOLD-CEN-1-R-DA       PIC 99.
  2229             20  HOLD-CEN-1-R-CCYY.
  2230                 24  HOLD-CEN-1-R-CC   PIC 99.
  2231                 24  HOLD-CEN-1-R-YY   PIC 99.
  2232             20  FILLER                PIC 9(3).
  2233         16  HOLD-CENTURY-1-X.
  2234             20  FILLER                PIC X(3)  VALUE SPACES.
  2235             20  HOLD-CEN-1-X-CCYY.
  2236                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2237                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2238             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2239             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2240         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2241             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2242             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2243             20  HOLD-CEN-1-R-X-CCYY.
  2244                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2245                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2246             20  FILLER                PIC XXX.
  2247         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2248         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2249         16  DC-JULIAN-DATE-1          PIC 9(07).
  2250         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2251             20  DC-JULIAN-1-CCYY.
  2252                 24  DC-JULIAN-1-CC    PIC 99.
  2253                 24  DC-JULIAN-1-YR    PIC 99.
  2254             20  DC-JULIAN-DA-1        PIC 999.
  2255         16  DC-JULIAN-DATE-2          PIC 9(07).
  2256         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2257             20  DC-JULIAN-2-CCYY.
  2258                 24  DC-JULIAN-2-CC    PIC 99.
  2259                 24  DC-JULIAN-2-YR    PIC 99.
  2260             20  DC-JULIAN-DA-2        PIC 999.
  2261         16  DC-GREG-DATE-A-EDIT.
  2262             20  DC-EDITA-MONTH        PIC 99.
  2263             20  SLASHA-1              PIC X VALUE '/'.
  2264             20  DC-EDITA-DAY          PIC 99.
  2265             20  SLASHA-2              PIC X VALUE '/'.
  2266             20  DC-EDITA-CCYY.
  2267                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  42
* EL130.cbl
  2268                 24  DC-EDITA-YEAR     PIC 99.
  2269         16  DC-GREG-DATE-B-EDIT.
  2270             20  DC-EDITB-MONTH        PIC 99.
  2271             20  SLASHB-1              PIC X VALUE '/'.
  2272             20  DC-EDITB-DAY          PIC 99.
  2273             20  SLASHB-2              PIC X VALUE '/'.
  2274             20  DC-EDITB-CCYY.
  2275                 24  DC-EDITB-CENT     PIC 99.
  2276                 24  DC-EDITB-YEAR     PIC 99.
  2277         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2278         16  DC-GREG-DATE-CYMD-R REDEFINES
  2279                              DC-GREG-DATE-CYMD.
  2280             20  DC-CYMD-CEN           PIC 99.
  2281             20  DC-CYMD-YEAR          PIC 99.
  2282             20  DC-CYMD-MONTH         PIC 99.
  2283             20  DC-CYMD-DAY           PIC 99.
  2284         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2285         16  DC-GREG-DATE-MDCY-R REDEFINES
  2286                              DC-GREG-DATE-MDCY.
  2287             20  DC-MDCY-MONTH         PIC 99.
  2288             20  DC-MDCY-DAY           PIC 99.
  2289             20  DC-MDCY-CEN           PIC 99.
  2290             20  DC-MDCY-YEAR          PIC 99.
  2291    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2292        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2293    12  DC-EL310-DATE                  PIC X(21).
  2294    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  43
* EL130.cbl
  2296*    COPY ELCCALC.
  2297******************************************************************
  2298*                                                                *
  2299*                           ELCCALC.                            *
  2300*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2301*                            VMOD=2.025                          *
  2302*                                                                *
  2303*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2304*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2305*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2306*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2307*                                                                *
  2308*  PASSED TO ELRTRM                                              *
  2309*  -----------------                                             *
  2310*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2311*  ORIGINAL TERM                                                 *
  2312*  BEGINNING DATE                                                *
  2313*  ENDING DATE                                                   *
  2314*  COMPANY I.D.                                                  *
  2315*  ACCOUNT MASTER USER FIELD                                     *
  2316*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2317*  FREE LOOK DAYS                                                *
  2318*                                                                *
  2319*  RETURNED FROM ELRTRM                                          *
  2320*  ---------------------                                         *
  2321*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2322*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2323*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2324*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2325*----------------------------------------------------------------*
  2326*  PASSED TO ELRAMT                                              *
  2327*  ----------------                                              *
  2328*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2329*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2330*  ORIGINAL AMOUNT                                               *
  2331*  ALTERNATE BENEFIT (BALLON)                                    *
  2332*  A.P.R. - NET PAY ONLY                                         *
  2333*  METHOD
  2334*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2335*  COMPANY I.D.                                                  *
  2336*  BENEFIT TYPE                                                  *
  2337*                                                                *
  2338*  RETURNED FROM ELRAMT                                          *
  2339*  --------------------                                          *
  2340*  REMAINING AMOUNT 1 - CURRENT                                  *
  2341*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2342*  REMAINING AMOUNT FACTOR
  2343*----------------------------------------------------------------*
  2344*  PASSED TO ELRESV                                              *
  2345*  -----------------                                             *
  2346*  CERTIFICATE EFFECTIVE DATE                                    *
  2347*  VALUATION DATE                                                *
  2348*  PAID THRU DATE                                                *
  2349*  BENEFIT                                                       *
  2350*  INCURRED DATE                                                 *
  2351*  REPORTED DATE                                                 *
  2352*  ISSUE AGE                                                     *
  2353*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  44
* EL130.cbl
  2354*  CDT PERCENT                                                   *
  2355*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2356* *CLAIM TYPE (LIFE, A/H)                                        *
  2357* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2358* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2359*                                                                *
  2360*  RETURNED FROM ELRESV                                          *
  2361*  --------------------                                          *
  2362*  CDT TABLE USED                                                *
  2363*  CDT FACTOR USED                                               *
  2364*  PAY TO CURRENT RESERVE                                        *
  2365*  I.B.N.R. - A/H ONLY                                           *
  2366*  FUTURE (ACCRUED) AH ONLY                                      *
  2367*----------------------------------------------------------------*
  2368*  PASSED TO ELRATE                                              *
  2369*  ----------------                                              *
  2370*  CERT ISSUE DATE                                               *
  2371*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2372*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2373*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2374*  STATE CODE (CLIENT DEFINED)                                   *
  2375*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2376*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2377*  DEVIATION CODE                                                *
  2378*  ISSUE AGE                                                     *
  2379*  ORIGINAL BENEFIT AMOUNT                                       *
  2380*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2381*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2382*  BENEFIT KIND (LIFE OR A/H)                                    *
  2383*  A.P.R.                                                        *
  2384*  METHOD
  2385*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2386*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2387*  COMPANY I.D. (3 CHARACTER)                                    *
  2388*  BENEFIT CODE                                                  *
  2389*  BENEFIT OVERRIDE CODE                                         *
  2390*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2391*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2392*  JOINT INDICATOR (CSL ONLY)                                    *
  2393*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2394*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2395*                                                                *
  2396*  RETURNED FROM ELRATE                                          *
  2397*  --------------------                                          *
  2398*  CALCULATED PREMIUM                                            *
  2399*  PREMIUM RATE                                                  *
  2400*  MORTALITY CODE                                                *
  2401*  MAX ATTAINED AGE                                              *
  2402*  MAX AGE                                                       *
  2403*  MAX TERM                                                      *
  2404*  MAX MONTHLY BENEFIT                                           *
  2405*  MAX TOTAL BENIFIT                                             *
  2406*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2407*----------------------------------------------------------------*
  2408*  PASSED TO ELRFND                                              *
  2409*  ----------------                                              *
  2410*  CERT ISSUE DATE                                               *
  2411*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  45
* EL130.cbl
  2412*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2413*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2414*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2415*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2416*  STATE CODE (CLIENT DEFINED)                                   *
  2417*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2418*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2419*  DEVIATION CODE                                                *
  2420*  ISSUE AGE                                                     *
  2421*  ORIGINAL BENEFIT AMOUNT                                       *
  2422*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2423*  PROCESS TYPE (CANCEL)                                         *
  2424*  BENEFIT KIND (LIFE OR A/H)                                    *
  2425*  A.P.R.                                                        *
  2426*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2427*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2428*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2429*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2430*  COMPANY I.D. (3 CHARACTER)                                    *
  2431*  BENEFIT CODE                                                  *
  2432*  BENEFIT OVERRIDE CODE                                         *
  2433*                                                                *
  2434*  RETURNED FROM ELRFND                                          *
  2435*  --------------------                                          *
  2436*  CALCULATED REFUND                                             *
  2437*----------------------------------------------------------------*
  2438*  PASSED TO ELEARN                                              *
  2439*  ----------------                                              *
  2440*  CERT ISSUE DATE                                               *
  2441*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2442*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2443*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2444*  STATE CODE (CLIENT DEFINED)                                   *
  2445*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2446*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2447*  DEVIATION CODE                                                *
  2448*  ISSUE AGE                                                     *
  2449*  ORIGINAL BENEFIT AMOUNT                                       *
  2450*  BENEFIT KIND (LIFE OR A/H)                                    *
  2451*  A.P.R.                                                        *
  2452*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2453*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2454*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2455*  COMPANY I.D. (3 CHARACTER)                                    *
  2456*  BENEFIT CODE                                                  *
  2457*  BENEFIT OVERRIDE CODE                                         *
  2458*                                                                *
  2459*  RETURNED FROM ELEARN                                          *
  2460*  --------------------                                          *
  2461*  INDICATED  EARNINGS                                           *
  2462*----------------------------------------------------------------*
  2463*                 LENGTH = 450                                   *
  2464*                                                                *
  2465******************************************************************
  2466******************************************************************
  2467*                   C H A N G E   L O G
  2468*
  2469* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  46
* EL130.cbl
  2470*-----------------------------------------------------------------
  2471*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2472* EFFECTIVE    NUMBER
  2473*-----------------------------------------------------------------
  2474* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2475* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2476* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2477* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2478* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2479* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2480* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2481* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2482* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2483* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2484* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2485******************************************************************
  2486
  2487 01  CALCULATION-PASS-AREA.
  2488     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2489                                     COMP.
  2490
  2491     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2492       88  NO-CP-ERROR                             VALUE ZERO.
  2493       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2494                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2495       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2496       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2497       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2498       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2499       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2500       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2501       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2502       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2503       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2504       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2505       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2506       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2507       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2508       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2509       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2510       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2511       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2512
  2513     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2514       88  NO-CP-ERROR-2                           VALUE ZERO.
  2515***********************  INPUT AREAS ****************************
  2516
  2517     12  CP-CALCULATION-AREA.
  2518         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2519         16  CP-CERT-EFF-DT        PIC XX.
  2520         16  CP-VALUATION-DT       PIC XX.
  2521         16  CP-PAID-THRU-DT       PIC XX.
  2522         16  CP-BENEFIT-TYPE       PIC X.
  2523           88  CP-AH                               VALUE 'A' 'D'
  2524                                                   'I' 'U'.
  2525           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2526           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2527         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  47
* EL130.cbl
  2528         16  CP-REPORTED-DT        PIC XX.
  2529         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2530         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2531         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2532                                     COMP-3.
  2533         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2534                                     COMP-3.
  2535         16  CP-CDT-METHOD         PIC X.
  2536           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2537           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2538           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2539         16  CP-CLAIM-TYPE         PIC X.
  2540           88  CP-AH-CLAIM                         VALUE 'A'.
  2541           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2542         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2543                                     COMP-3.
  2544         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2545                                     COMP-3.
  2546         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2547                                     COMP-3.
  2548         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2549                                     COMP-3.
  2550         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2551                                     COMP-3.
  2552         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2553                                     COMP-3.
  2554         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2555                                     COMP-3.
  2556         16  CP-REM-TERM-METHOD    PIC X.
  2557           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2558           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2559           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2560           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2561           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2562           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2563           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2564         16  CP-EARNING-METHOD     PIC X.
  2565           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2566           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2567           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2568           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2569           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2570           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2571           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2572           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2573           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2574           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2575           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2576           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2577           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2578           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2579         16  CP-PROCESS-TYPE       PIC X.
  2580           88  CP-CLAIM                            VALUE '1'.
  2581           88  CP-CANCEL                           VALUE '2'.
  2582           88  CP-ISSUE                            VALUE '3'.
  2583         16  CP-SPECIAL-CALC-CD    PIC X.
  2584           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2585           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  48
* EL130.cbl
  2586           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2587           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2588           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2589           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2590           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2591           88  CP-FARM-PLAN                    VALUE 'F'.
  2592           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2593           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2594           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2595           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2596           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2597           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2598           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2599           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2600           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2601           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2602                                                     'W' 'X'.
  2603           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2604           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2605           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2606           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2607           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2608           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2609           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2610           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2611           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2612           88  CP-CSL-METH-1                   VALUE '5'.
  2613           88  CP-CSL-METH-2                   VALUE '6'.
  2614           88  CP-CSL-METH-3                   VALUE '7'.
  2615           88  CP-CSL-METH-4                   VALUE '8'.
  2616
  2617         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2618                                     COMP-3.
  2619         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2620         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2621         16  CP-STATE              PIC XX          VALUE SPACE.
  2622         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2623         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2624           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2625               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2626         16  CP-R78-OPTION         PIC X.
  2627           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2628           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2629
  2630         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2631         16  CP-IBNR-RESERVE-SW    PIC X.
  2632         16  CP-CLAIM-STATUS       PIC X.
  2633         16  CP-RATE-FILE          PIC X.
  2634         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2635                                     COMP-3.
  2636
  2637         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2638         16  CP-AH-OVERRIDE-CODE   PIC X.
  2639
  2640         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2641                                     COMP-3.
  2642         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2643                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  49
* EL130.cbl
  2644         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2645                                     COMP-3.
  2646         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2647                                     COMP-3.
  2648         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2649                                     COMP-3.
  2650         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2651                                  PIC S9(7)V99 COMP-3.
  2652
  2653         16  CP-PAID-FROM-DATE     PIC X(02).
  2654         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2655         16  CP-EXT-DAYS-CALC      PIC X.
  2656           88  CP-EXT-NO-CHG                   VALUE ' '.
  2657           88  CP-EXT-CHG-LF                   VALUE '1'.
  2658           88  CP-EXT-CHG-AH                   VALUE '2'.
  2659           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2660         16  CP-DOMICILE-STATE     PIC XX.
  2661         16  CP-CARRIER            PIC X.
  2662         16  CP-REIN-FLAG          PIC X.
  2663         16  CP-REM-TRM-CALC-OPTION PIC X.
  2664           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2665                      '2' '3' '4' '5'.
  2666           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2667           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2668           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2669           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2670           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2671           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2672           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2673           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2674         16  CP-SIG-SWITCH         PIC X.
  2675         16  CP-RATING-METHOD      PIC X.
  2676           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2677           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2678           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2679           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2680           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2681           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2682           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2683           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2684           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2685         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2686                                     COMP-3.
  2687         16  CP-BEN-CATEGORY       PIC X.
  2688         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2689         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2690                                   PIC S99V9(5) COMP-3.
  2691         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2692         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2693                                   PIC S99V9(5) COMP-3.
  2694         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2695         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2696         16  CP-EXPIRE-DT          PIC XX.
  2697         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2698         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2699         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2700         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2701         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  50
* EL130.cbl
  2702             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2703             88  CP-CALC-CLP              VALUE 'C'.
  2704         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2705         16  CP-CANCEL-REASON      PIC X.
  2706         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2707         16  CP-PMT-MODE           PIC X.
  2708         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2709         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2710         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2711         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2712         16  FILLER                PIC X.
  2713
  2714***************    OUTPUT FROM ELRESV   ************************
  2715
  2716         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2717
  2718         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2719                                     COMP-3.
  2720         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2721                                     COMP-3.
  2722         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2723                                     COMP-3.
  2724         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2725                                     COMP-3.
  2726         16  FILLER                PIC X(09).
  2727***************    OUTPUT FROM ELRTRM   *************************
  2728
  2729         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2730                                     COMP-3.
  2731         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2732                                     COMP-3.
  2733         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2734                                     COMP-3.
  2735         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2736                                     COMP-3.
  2737         16  FILLER                PIC X(12).
  2738
  2739***************    OUTPUT FROM ELRAMT   *************************
  2740
  2741         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2742                                     COMP-3.
  2743         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2744                                     COMP-3.
  2745         16  FILLER                PIC X(12).
  2746
  2747***************    OUTPUT FROM ELRATE   *************************
  2748
  2749         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2750                                     COMP-3.
  2751         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2752                                     COMP-3.
  2753         16  CP-MORTALITY-CODE     PIC X(4).
  2754         16  CP-RATE-EDIT-FLAG     PIC X.
  2755             88  CP-RATES-NEED-APR                  VALUE '1'.
  2756         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2757                                     COMP-3.
  2758         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2759         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  51
* EL130.cbl
  2760         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2761                                   PIC S9(7)V99 COMP-3.
  2762         16  FILLER                PIC X(07).
  2763
  2764***************    OUTPUT FROM ELRFND   *************************
  2765
  2766         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2767                                     COMP-3.
  2768         16  CP-REFUND-TYPE-USED   PIC X.
  2769           88  CP-R-AS-R78                         VALUE '1'.
  2770           88  CP-R-AS-PRORATA                     VALUE '2'.
  2771           88  CP-R-AS-CALIF                       VALUE '3'.
  2772           88  CP-R-AS-TEXAS                       VALUE '4'.
  2773           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2774           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2775           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2776           88  CP-R-AS-MEAN                        VALUE '8'.
  2777           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2778           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2779           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2780           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2781           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2782           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2783         16  FILLER                PIC X(12).
  2784
  2785***************    OUTPUT FROM ELEARN   *************************
  2786
  2787         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2788                                     COMP-3.
  2789         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2790                                     COMP-3.
  2791         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2792                                     COMP-3.
  2793         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2794                                     COMP-3.
  2795         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2796                                     COMP-3.
  2797         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2798                                     COMP-3.
  2799         16  CP-EARNING-TYPE-USED  PIC X.
  2800           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2801           88  CP-E-AS-R78                         VALUE '1'.
  2802           88  CP-E-AS-PRORATA                     VALUE '2'.
  2803           88  CP-E-AS-TEXAS                       VALUE '4'.
  2804           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2805           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2806           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2807           88  CP-E-AS-MEAN                        VALUE '8'.
  2808           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2809         16  FILLER                PIC X(12).
  2810
  2811***************    OUTPUT FROM ELPMNT   *************************
  2812
  2813         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2814                                     COMP-3.
  2815         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2816                                     COMP-3.
  2817         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  52
* EL130.cbl
  2818
  2819***************   MISC WORK AREAS    *****************************
  2820         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2821                                     COMP-3.
  2822         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2823                                     COMP-3.
  2824         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2825                                     COMP-3.
  2826         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2827                                     COMP-3.
  2828         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2829                                     COMP-3.
  2830         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2831                                     COMP-3.
  2832         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2833             88  OPEN-RATE-FILE                   VALUE 'O'.
  2834             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2835             88  IO-ERROR                         VALUE 'E'.
  2836
  2837         16  CP-FIRST-PAY-DATE     PIC XX.
  2838
  2839         16  CP-JOINT-INDICATOR    PIC X.
  2840
  2841         16  CP-RESERVE-REMAINING-TERM
  2842                                   PIC S9(4)V9    VALUE ZERO
  2843                                     COMP-3.
  2844
  2845         16  CP-INSURED-BIRTH-DT   PIC XX.
  2846
  2847         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2848                                     COMP-3.
  2849
  2850         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2851                                     COMP-3.
  2852
  2853         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2854                                     COMP-3.
  2855
  2856         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2857                                     COMP-3.
  2858
  2859         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2860                                     COMP-3.
  2861
  2862         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2863                                     COMP-3.
  2864
  2865         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2866                                     COMP-3.
  2867
  2868         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2869             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2870
  2871         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2872                                     COMP-3.
  2873         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2874                                     COMP-3.
  2875         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  53
* EL130.cbl
  2876         16  cp-extra-periods      pic 9 value zeros.
  2877         16  cp-net-only-state     pic x value spaces.
  2878         16  FILLER                PIC X(13).
  2879******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  54
* EL130.cbl
  2881*    COPY ELCLOGOF.
  2882******************************************************************
  2883*                                                                *
  2884*                                                                *
  2885*                            ELCLOGOF.                           *
  2886*                            VMOD=2.001                          *
  2887*                                                                *
  2888*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2889*                                                                *
  2890******************************************************************
  2891 01  CLASIC-LOGOFF.
  2892     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2893     12  LOGOFF-TEXT.
  2894         16  FILLER          PIC X(5)    VALUE SPACES.
  2895         16  LOGOFF-MSG.
  2896             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2897             20  FILLER      PIC X       VALUE SPACES.
  2898             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2899         16  FILLER          PIC X(80)
  2900           VALUE '* YOU ARE NOW LOGGED OFF'.
  2901         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2902         16  FILLER          PIC X       VALUE QUOTE.
  2903         16  LOGOFF-SYS-MSG  PIC X(17)
  2904           VALUE 'S CLAS-IC SYSTEM '.
  2905     12  TEXT-MESSAGES.
  2906         16  UNACCESS-MSG    PIC X(29)
  2907             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2908         16  PGMIDERR-MSG    PIC X(17)
  2909             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  55
* EL130.cbl
  2911*    COPY ELCATTR.
  2912******************************************************************
  2913*                                                                *
  2914*                            ELCATTR.                            *
  2915*                            VMOD=2.001                          *
  2916*                                                                *
  2917*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2918*                                                                *
  2919*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2920*                                                                *
  2921*                   POS 1   P=PROTECTED                          *
  2922*                           U=UNPROTECTED                        *
  2923*                           S=ASKIP                              *
  2924*                   POS 2   A=ALPHA/NUMERIC                      *
  2925*                           N=NUMERIC                            *
  2926*                   POS 3   N=NORMAL                             *
  2927*                           B=BRIGHT                             *
  2928*                           D=DARK                               *
  2929*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2930*                           OF=MODIFIED DATA TAG OFF             *
  2931*                                                                *
  2932*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2933******************************************************************
  2934 01  ATTRIBUTE-LIST.
  2935     12  AL-PABOF            PIC X       VALUE 'Y'.
  2936     12  AL-PABON            PIC X       VALUE 'Z'.
  2937     12  AL-PADOF            PIC X       VALUE '%'.
  2938     12  AL-PADON            PIC X       VALUE '_'.
  2939     12  AL-PANOF            PIC X       VALUE '-'.
  2940     12  AL-PANON            PIC X       VALUE '/'.
  2941     12  AL-SABOF            PIC X       VALUE '8'.
  2942     12  AL-SABON            PIC X       VALUE '9'.
  2943     12  AL-SADOF            PIC X       VALUE '@'.
  2944     12  AL-SADON            PIC X       VALUE QUOTE.
  2945     12  AL-SANOF            PIC X       VALUE '0'.
  2946     12  AL-SANON            PIC X       VALUE '1'.
  2947     12  AL-UABOF            PIC X       VALUE 'H'.
  2948     12  AL-UABON            PIC X       VALUE 'I'.
  2949     12  AL-UADOF            PIC X       VALUE '<'.
  2950     12  AL-UADON            PIC X       VALUE '('.
  2951     12  AL-UANOF            PIC X       VALUE ' '.
  2952     12  AL-UANON            PIC X       VALUE 'A'.
  2953     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2954     12  AL-UNBON            PIC X       VALUE 'R'.
  2955     12  AL-UNDOF            PIC X       VALUE '*'.
  2956     12  AL-UNDON            PIC X       VALUE ')'.
  2957     12  AL-UNNOF            PIC X       VALUE '&'.
  2958     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  56
* EL130.cbl
  2960*    COPY ELCEMIB.
  2961******************************************************************
  2962*                                                                *
  2963*                                                                *
  2964*                            ELCEMIB.                            *
  2965*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2966*                            VMOD=2.005                          *
  2967*                                                                *
  2968*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2969*                                                                *
  2970******************************************************************
  2971 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2972     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2973     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2974     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2975     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2976     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2977     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2978     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2979     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2980     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2981         88  EMI-NO-ERRORS                    VALUE '1'.
  2982         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2983         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2984     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2985         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2986     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2987         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2988         88  EMI-AREA1-FULL                   VALUE '2'.
  2989     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2990         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2991         88  EMI-AREA2-FULL                   VALUE '2'.
  2992     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2993         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2994         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2995         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2996         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2997         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2998     12  EMI-ERROR-LINES.
  2999         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3000         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3001         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3002         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3003             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3004                 24  EMI-ERR-NUM         PIC X(4).
  3005                 24  EMI-FILLER          PIC X.
  3006                 24  EMI-SEV             PIC X.
  3007                 24  FILLER              PIC X.
  3008             20  FILLER                  PIC X(02).
  3009     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3010         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3011             20  EMI-ERROR-NUMBER    PIC X(4).
  3012             20  EMI-FILL            PIC X.
  3013             20  EMI-SEVERITY        PIC X.
  3014             20  FILLER              PIC X.
  3015             20  EMI-ERROR-TEXT.
  3016                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3017                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  57
* EL130.cbl
  3018     12  EMI-SEVERITY-SAVE           PIC X.
  3019         88  EMI-NOTE                    VALUE 'N'.
  3020         88  EMI-WARNING                 VALUE 'W'.
  3021         88  EMI-FORCABLE                VALUE 'F'.
  3022         88  EMI-FATAL                   VALUE 'X'.
  3023     12  EMI-MESSAGE-FLAG            PIC X.
  3024         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3025         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3026     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3027     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3028         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3029         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3030         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3031     12  emi-claim-no                pic x(7).
  3032     12  emi-claim-type              pic x(6).
  3033     12  FILLER                      PIC X(124)  VALUE SPACES.
  3034     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3035     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3036     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3037     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  58
* EL130.cbl
  3039*    COPY ELCJPFX.
  3040******************************************************************
  3041*                                                                *
  3042*                                                                *
  3043*                            ELCJPFX.                            *
  3044*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3045*                            VMOD=2.002                          *
  3046*                                                                *
  3047*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3048*                                                                *
  3049*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3050*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3051*        ELCNTL - CONTROL FILE                                   *
  3052*        ELMSTR - CLAIM MASTERS                                  *
  3053*        ELTRLR - ACTIVITY TRAILERS                              *
  3054*        ELCHKQ - CHECK QUE                                      *
  3055******************************************************************
  3056 01  JOURNAL-RECORD.
  3057     12  jp-date                     pic s9(5) comp-3.
  3058     12  jp-time                     pic s9(7) comp-3.
  3059     12  JP-USER-ID                  PIC X(4).
  3060     12  JP-FILE-ID                  PIC X(8).
  3061     12  JP-PROGRAM-ID               PIC X(8).
  3062     12  JP-RECORD-TYPE              PIC X.
  3063         88 JP-ADD              VALUE 'A'.
  3064         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3065         88 JP-AFTER-CHANGE     VALUE 'C'.
  3066         88 JP-DELETE           VALUE 'D'.
  3067         88 JP-GENERIC-DELETE   VALUE 'G'.
  3068         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3069         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3070     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3071     12  JP-RECORD-AREA
  3072
  3073
  3074         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  59
* EL130.cbl
  3076*    COPY ELCAID.
  3077******************************************************************
  3078*                                                                *
  3079*                            ELCAID.                             *
  3080*                            VMOD=2.001                          *
  3081*                                                                *
  3082*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3083*                                                                *
  3084*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3085*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3086******************************************************************
  3087
  3088 01  DFHAID.
  3089   02  DFHNULL   PIC  X  VALUE  ' '.
  3090   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3091   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3092   02  DFHPEN    PIC  X  VALUE  '='.
  3093   02  DFHOPID   PIC  X  VALUE  'W'.
  3094   02  DFHPA1    PIC  X  VALUE  '%'.
  3095   02  DFHPA2    PIC  X  VALUE  '>'.
  3096   02  DFHPA3    PIC  X  VALUE  ','.
  3097   02  DFHPF1    PIC  X  VALUE  '1'.
  3098   02  DFHPF2    PIC  X  VALUE  '2'.
  3099   02  DFHPF3    PIC  X  VALUE  '3'.
  3100   02  DFHPF4    PIC  X  VALUE  '4'.
  3101   02  DFHPF5    PIC  X  VALUE  '5'.
  3102   02  DFHPF6    PIC  X  VALUE  '6'.
  3103   02  DFHPF7    PIC  X  VALUE  '7'.
  3104   02  DFHPF8    PIC  X  VALUE  '8'.
  3105   02  DFHPF9    PIC  X  VALUE  '9'.
  3106   02  DFHPF10   PIC  X  VALUE  ':'.
  3107   02  DFHPF11   PIC  X  VALUE  '#'.
  3108   02  DFHPF12   PIC  X  VALUE  '@'.
  3109   02  DFHPF13   PIC  X  VALUE  'A'.
  3110   02  DFHPF14   PIC  X  VALUE  'B'.
  3111   02  DFHPF15   PIC  X  VALUE  'C'.
  3112   02  DFHPF16   PIC  X  VALUE  'D'.
  3113   02  DFHPF17   PIC  X  VALUE  'E'.
  3114   02  DFHPF18   PIC  X  VALUE  'F'.
  3115   02  DFHPF19   PIC  X  VALUE  'G'.
  3116   02  DFHPF20   PIC  X  VALUE  'H'.
  3117   02  DFHPF21   PIC  X  VALUE  'I'.
  3118*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3119   02  DFHPF22   PIC  X  VALUE  '['.
  3120   02  DFHPF23   PIC  X  VALUE  '.'.
  3121   02  DFHPF24   PIC  X  VALUE  '<'.
  3122   02  DFHMSRE   PIC  X  VALUE  'X'.
  3123   02  DFHSTRF   PIC  X  VALUE  'h'.
  3124   02  DFHTRIG   PIC  X  VALUE  '"'.
  3125
  3126 01  FILLER    REDEFINES DFHAID.
  3127     12  FILLER              PIC X(8).
  3128     12  PF-VALUES           PIC X       OCCURS 12.
  3129
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  60
* EL130.cbl
  3131****************************************************************
  3132*
  3133* Copyright (c) 2007-2013 Dell Inc.
  3134* All rights reserved.
  3135*
  3136****************************************************************
  3137 01  DFHEIV.
  3138   02  DFHEIV0               PIC X(35).
  3139   02  DFHEIV1               PIC X(08).
  3140   02  DFHEIV2               PIC X(08).
  3141   02  DFHEIV3               PIC X(08).
  3142   02  DFHEIV4               PIC X(06).
  3143   02  DFHEIV5               PIC X(04).
  3144   02  DFHEIV6               PIC X(04).
  3145   02  DFHEIV7               PIC X(02).
  3146   02  DFHEIV8               PIC X(02).
  3147   02  DFHEIV9               PIC X(01).
  3148   02  DFHEIV10              PIC S9(7) COMP-3.
  3149   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3150   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3151   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3152   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3153   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3154   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3155   02  DFHEIV17              PIC X(04).
  3156   02  DFHEIV18              PIC X(04).
  3157   02  DFHEIV19              PIC X(04).
  3158   02  DFHEIV20              USAGE IS POINTER.
  3159   02  DFHEIV21              USAGE IS POINTER.
  3160   02  DFHEIV22              USAGE IS POINTER.
  3161   02  DFHEIV23              USAGE IS POINTER.
  3162   02  DFHEIV24              USAGE IS POINTER.
  3163   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3164   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3165   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3166   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3167   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3168   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3169   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3170   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3171   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3172   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3173   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3174   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3175   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3176   02  FILLER                PIC X(02).
  3177   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3178   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3179   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3180   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3181   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3182   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3183   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3184 LINKAGE  SECTION.
  3185*****************************************************************
  3186*                                                               *
  3187* Copyright (c) 2007-2013 Dell Inc.                             *
  3188* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  61
* EL130.cbl
  3189*                                                               *
  3190*****************************************************************
  3191 01  dfheiblk.
  3192     02  eibtime          pic s9(7) comp-3.
  3193     02  eibdate          pic s9(7) comp-3.
  3194     02  eibtrnid         pic x(4).
  3195     02  eibtaskn         pic s9(7) comp-3.
  3196     02  eibtrmid         pic x(4).
  3197     02  dfheigdi         pic s9(4) comp.
  3198     02  eibcposn         pic s9(4) comp.
  3199     02  eibcalen         pic s9(4) comp.
  3200     02  eibaid           pic x(1).
  3201     02  eibfiller1       pic x(1).
  3202     02  eibfn            pic x(2).
  3203     02  eibfiller2       pic x(2).
  3204     02  eibrcode         pic x(6).
  3205     02  eibfiller3       pic x(2).
  3206     02  eibds            pic x(8).
  3207     02  eibreqid         pic x(8).
  3208     02  eibrsrce         pic x(8).
  3209     02  eibsync          pic x(1).
  3210     02  eibfree          pic x(1).
  3211     02  eibrecv          pic x(1).
  3212     02  eibsend          pic x(1).
  3213     02  eibatt           pic x(1).
  3214     02  eibeoc           pic x(1).
  3215     02  eibfmh           pic x(1).
  3216     02  eibcompl         pic x(1).
  3217     02  eibsig           pic x(1).
  3218     02  eibconf          pic x(1).
  3219     02  eiberr           pic x(1).
  3220     02  eibrldbk         pic x(1).
  3221     02  eiberrcd         pic x(4).
  3222     02  eibsynrb         pic x(1).
  3223     02  eibnodat         pic x(1).
  3224     02  eibfiller5       pic x(2).
  3225     02  eibresp          pic s9(8) comp.
  3226     02  eibresp2         pic s9(8) comp.
  3227     02  dfheigdj         pic s9(4) comp.
  3228     02  dfheigdk         pic s9(4) comp.
  3229
  3230 01  DFHCOMMAREA             PIC X(1024).
  3231
  3232*01 PARMLIST .
  3233*    02  FILLER              PIC S9(8)   COMP.
  3234*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3235*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3236*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3237*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3238*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3239*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3240*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3241*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3242*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  62
* EL130.cbl
  3244*    COPY ELCMSTR.
  3245******************************************************************
  3246*                                                                *
  3247*                            ELCMSTR.                            *
  3248*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3249*                            VMOD=2.012                          *
  3250*                                                                *
  3251*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3252*                                                                *
  3253*   FILE TYPE = VSAM,KSDS                                        *
  3254*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3255*                                                                *
  3256*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3257*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3258*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3259*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3260*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3261*                                                 RKP=75,LEN=21  *
  3262*                                                                *
  3263*   **** NOTE ****                                               *
  3264*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3265*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3266*                                                                *
  3267*   LOG = YES                                                    *
  3268*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3269******************************************************************
  3270*                   C H A N G E   L O G
  3271*
  3272* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3273*-----------------------------------------------------------------
  3274*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3275* EFFECTIVE    NUMBER
  3276*-----------------------------------------------------------------
  3277* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3278* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3279* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3280* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3281* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3282* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3283******************************************************************
  3284 01  CLAIM-MASTER.
  3285     12  CL-RECORD-ID                PIC XX.
  3286         88  VALID-CL-ID         VALUE 'CL'.
  3287
  3288     12  CL-CONTROL-PRIMARY.
  3289         16  CL-COMPANY-CD           PIC X.
  3290         16  CL-CARRIER              PIC X.
  3291         16  CL-CLAIM-NO             PIC X(7).
  3292         16  CL-CERT-NO.
  3293             20  CL-CERT-PRIME       PIC X(10).
  3294             20  CL-CERT-SFX         PIC X.
  3295
  3296     12  CL-CONTROL-BY-NAME.
  3297         16  CL-COMPANY-CD-A1        PIC X.
  3298         16  CL-INSURED-LAST-NAME    PIC X(15).
  3299         16  CL-INSURED-NAME.
  3300             20  CL-INSURED-1ST-NAME PIC X(12).
  3301             20  CL-INSURED-MID-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  63
* EL130.cbl
  3302
  3303     12  CL-CONTROL-BY-SSN.
  3304         16  CL-COMPANY-CD-A2        PIC X.
  3305         16  CL-SOC-SEC-NO.
  3306             20  CL-SSN-STATE        PIC XX.
  3307             20  CL-SSN-ACCOUNT      PIC X(6).
  3308             20  CL-SSN-LN3          PIC X(3).
  3309
  3310     12  CL-CONTROL-BY-CERT-NO.
  3311         16  CL-COMPANY-CD-A4        PIC X.
  3312         16  CL-CERT-NO-A4.
  3313             20  CL-CERT-A4-PRIME    PIC X(10).
  3314             20  CL-CERT-A4-SFX      PIC X.
  3315
  3316     12  CL-CONTROL-BY-CCN.
  3317         16  CL-COMPANY-CD-A5        PIC X.
  3318         16  CL-CCN-A5.
  3319             20  CL-CCN.
  3320                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3321                 24  CL-CCN-PRIME-A5 PIC X(12).
  3322             20  CL-CCN-FILLER-A5    PIC X(4).
  3323
  3324     12  CL-INSURED-PROFILE-DATA.
  3325         16  CL-INSURED-BIRTH-DT     PIC XX.
  3326         16  CL-INSURED-SEX-CD       PIC X.
  3327             88  INSURED-IS-MALE        VALUE 'M'.
  3328             88  INSURED-IS-FEMALE      VALUE 'F'.
  3329             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3330         16  CL-INSURED-OCC-CD       PIC X(6).
  3331         16  FILLER                  PIC X(5).
  3332
  3333     12  CL-PROCESSING-INFO.
  3334         16  CL-PROCESSOR-ID         PIC X(4).
  3335         16  CL-CLAIM-STATUS         PIC X.
  3336             88  CLAIM-IS-OPEN          VALUE 'O'.
  3337             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3338         16  CL-CLAIM-TYPE           PIC X.
  3339*            88  AH-CLAIM               VALUE 'A'.
  3340*            88  LIFE-CLAIM             VALUE 'L'.
  3341*            88  PROPERTY-CLAIM         VALUE 'P'.
  3342*            88  IUI-CLAIM              VALUE 'I'.
  3343*            88  GAP-CLAIM              VALUE 'G'.
  3344*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3345         16  CL-CLAIM-PREM-TYPE      PIC X.
  3346             88  SINGLE-PREMIUM         VALUE '1'.
  3347             88  O-B-COVERAGE           VALUE '2'.
  3348             88  OPEN-END-COVERAGE      VALUE '3'.
  3349         16  CL-INCURRED-DT          PIC XX.
  3350         16  CL-REPORTED-DT          PIC XX.
  3351         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3352         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3353         16  CL-LAST-PMT-DT          PIC XX.
  3354         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3355         16  CL-PAID-THRU-DT         PIC XX.
  3356         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3357         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3358         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3359         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  64
* EL130.cbl
  3360             88  CL-360-DAY-YR          VALUE '1'.
  3361             88  CL-365-DAY-YR          VALUE '2'.
  3362             88  CL-FULL-MONTHS         VALUE '3'.
  3363         16  CL-CAUSE-CD             PIC X(6).
  3364
  3365         16  CL-PRIME-CERT-NO.
  3366             20  CL-PRIME-CERT-PRIME PIC X(10).
  3367             20  CL-PRIME-CERT-SFX   PIC X.
  3368
  3369         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3370             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3371             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3372
  3373         16  CL-MICROFILM-NO         PIC X(10).
  3374         16  FILLER REDEFINES CL-MICROFILM-NO.
  3375             20  CL-BENEFIT-PERIOD   PIC 99.
  3376             20  FILLER              PIC X(8).
  3377         16  CL-PROG-FORM-TYPE       PIC X.
  3378         16  CL-LAST-ADD-ON-DT       PIC XX.
  3379
  3380         16  CL-LAST-REOPEN-DT       PIC XX.
  3381         16  CL-LAST-CLOSE-DT        PIC XX.
  3382         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3383             88  FINAL-PAID             VALUE '1'.
  3384             88  CLAIM-DENIED           VALUE '2'.
  3385             88  AUTO-CLOSE             VALUE '3'.
  3386             88  MANUAL-CLOSE           VALUE '4'.
  3387             88  BENEFITS-CHANGED       VALUE 'C'.
  3388             88  SETUP-ERRORS           VALUE 'E'.
  3389         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3390         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3391         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3392             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3393         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3394         16  FILLER                  PIC X.
  3395
  3396     12  CL-CERTIFICATE-DATA.
  3397         16  CL-CERT-ORIGIN          PIC X.
  3398             88  CERT-WAS-ONLINE        VALUE '1'.
  3399             88  CERT-WAS-CREATED       VALUE '2'.
  3400             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3401         16  CL-CERT-KEY-DATA.
  3402             20  CL-CERT-CARRIER     PIC X.
  3403             20  CL-CERT-GROUPING    PIC X(6).
  3404             20  CL-CERT-STATE       PIC XX.
  3405             20  CL-CERT-ACCOUNT.
  3406                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3407                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3408             20  CL-CERT-EFF-DT      PIC XX.
  3409
  3410     12  CL-STATUS-CONTROLS.
  3411         16  CL-PRIORITY-CD          PIC X.
  3412             88  CONFIDENTIAL-DATA      VALUE '8'.
  3413             88  HIGHEST-PRIORITY       VALUE '9'.
  3414         16  CL-SUPV-ATTN-CD         PIC X.
  3415             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3416             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3417         16  CL-PURGED-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  65
* EL130.cbl
  3418         16  CL-RESTORED-DT          PIC XX.
  3419         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3420         16  CL-NEXT-RESEND-DT       PIC XX.
  3421         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3422         16  CL-CRITICAL-PERIOD      PIC 99.
  3423*        16  FILLER                  PIC XX.
  3424         16  CL-LAST-MAINT-DT        PIC XX.
  3425         16  CL-LAST-MAINT-USER      PIC X(4).
  3426         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3427         16  CL-LAST-MAINT-TYPE      PIC X.
  3428             88  CLAIM-SET-UP           VALUE ' '.
  3429             88  PAYMENT-MADE           VALUE '1'.
  3430             88  LETTER-SENT            VALUE '2'.
  3431             88  MASTER-WAS-ALTERED     VALUE '3'.
  3432             88  MASTER-WAS-RESTORED    VALUE '4'.
  3433             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3434             88  FILE-CONVERTED         VALUE '6'.
  3435             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3436             88  ERROR-CORRECTION       VALUE 'E'.
  3437         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3438         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3439         16  CL-BENEFICIARY          PIC X(10).
  3440         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3441         16  CL-DENIAL-TYPE          PIC X.
  3442             88  CL-TYPE-DENIAL          VALUE '1'.
  3443             88  CL-TYPE-RESCISSION      VALUE '2'.
  3444             88  CL-TYPE-REFORMATION     VALUE '3'.
  3445             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3446             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3447         16  CL-NO-OF-EXTENSIONS     PIC 99.
  3448         16  filler                  pic x(3).
  3449*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3450*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3451*        16  CL-RTW-DT               PIC XX.
  3452
  3453     12  CL-TRAILER-CONTROLS.
  3454         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3455             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3456             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3457             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3458         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3459         16  FILLER                  PIC XX.
  3460         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3461         16  CL-ADDRESS-TRAILER-CNT.
  3462             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3463                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3464             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3465                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3466             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3467                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3468             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3469                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3470             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3471                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3472             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3473                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3474             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3475                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  66
* EL130.cbl
  3476
  3477     12  CL-CV-REFERENCE-NO.
  3478         16  CL-CV-REFNO-PRIME       PIC X(18).
  3479         16  CL-CV-REFNO-SFX         PIC XX.
  3480
  3481     12  CL-FILE-LOCATION            PIC X(4).
  3482
  3483     12  CL-PROCESS-ERRORS.
  3484         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3485             88  NO-FATAL-ERRORS        VALUE ZERO.
  3486         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3487             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3488
  3489     12  CL-PRODUCT-CD               PIC X.
  3490
  3491     12  CL-CURRENT-KEY-DATA.
  3492         16  CL-CURRENT-CARRIER      PIC X.
  3493         16  CL-CURRENT-GROUPING     PIC X(6).
  3494         16  CL-CURRENT-STATE        PIC XX.
  3495         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3496
  3497     12  CL-ASSOCIATES               PIC X.
  3498         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3499         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3500         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3501         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3502
  3503     12  CL-ACTIVITY-CODE            PIC 99.
  3504     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3505     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3506
  3507     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3508     12  CL-LAG-REPORT-CODE          PIC 9.
  3509     12  CL-LOAN-TYPE                PIC XX.
  3510     12  CL-LEGAL-STATE              PIC XX.
  3511
  3512     12  CL-YESNOSW                  PIC X.
  3513     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3514         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3515         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3516         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3517     12  cl-insured-type             pic x.
  3518         88  cl-claim-on-primary         value 'P'.
  3519         88  cl-claim-on-co-borrower     value 'C'.
  3520     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  67
* EL130.cbl
  3522*    COPY ELCCNTL.
  3523******************************************************************
  3524*                                                                *
  3525*                                                                *
  3526*                            ELCCNTL.                            *
  3527*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3528*                            VMOD=2.059                          *
  3529*                                                                *
  3530*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3531*                                                                *
  3532*   FILE TYPE = VSAM,KSDS                                        *
  3533*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3534*                                                                *
  3535*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3536*       ALTERNATE INDEX = NONE                                   *
  3537*                                                                *
  3538*   LOG = YES                                                    *
  3539*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3540******************************************************************
  3541*                   C H A N G E   L O G
  3542*
  3543* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3544*-----------------------------------------------------------------
  3545*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3546* EFFECTIVE    NUMBER
  3547*-----------------------------------------------------------------
  3548* 082503                   PEMA  ADD BENEFIT GROUP
  3549* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3550* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3551* 092705    2005050300006  PEMA  ADD SPP LEASES
  3552* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3553* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3554* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3555* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3556* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3557* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3558* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3559* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3560* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3561* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3562* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  3563******************************************************************
  3564*
  3565 01  CONTROL-FILE.
  3566     12  CF-RECORD-ID                       PIC XX.
  3567         88  VALID-CF-ID                        VALUE 'CF'.
  3568
  3569     12  CF-CONTROL-PRIMARY.
  3570         16  CF-COMPANY-ID                  PIC XXX.
  3571         16  CF-RECORD-TYPE                 PIC X.
  3572             88  CF-COMPANY-MASTER              VALUE '1'.
  3573             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3574             88  CF-STATE-MASTER                VALUE '3'.
  3575             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3576             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3577             88  CF-CARRIER-MASTER              VALUE '6'.
  3578             88  CF-MORTALITY-MASTER            VALUE '7'.
  3579             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  68
* EL130.cbl
  3580             88  CF-TERMINAL-MASTER             VALUE '9'.
  3581             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3582             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3583             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3584             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3585             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3586             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3587             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3588             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3589             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3590         16  CF-ACCESS-CD-GENL              PIC X(4).
  3591         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3592             20  CF-PROCESSOR               PIC X(4).
  3593         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3594             20  CF-STATE-CODE              PIC XX.
  3595             20  FILLER                     PIC XX.
  3596         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3597             20  FILLER                     PIC XX.
  3598             20  CF-HI-BEN-IN-REC           PIC XX.
  3599         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3600             20  FILLER                     PIC XXX.
  3601             20  CF-CARRIER-CNTL            PIC X.
  3602         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3603             20  FILLER                     PIC XX.
  3604             20  CF-HI-TYPE-IN-REC          PIC 99.
  3605         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3606             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3607                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3608             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3609             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3610         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3611             20  FILLER                     PIC X.
  3612             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3613         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3614             20  FILLER                     PIC XX.
  3615             20  CF-MORTGAGE-PLAN           PIC XX.
  3616         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3617
  3618     12  CF-LAST-MAINT-DT                   PIC XX.
  3619     12  CF-LAST-MAINT-BY                   PIC X(4).
  3620     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3621
  3622     12  CF-RECORD-BODY                     PIC X(728).
  3623
  3624
  3625****************************************************************
  3626*             COMPANY MASTER RECORD                            *
  3627****************************************************************
  3628
  3629     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3630         16  CF-COMPANY-ADDRESS.
  3631             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3632             20  CF-CL-IN-CARE-OF           PIC X(30).
  3633             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3634             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3635             20  CF-CL-CITY-STATE           PIC X(30).
  3636             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3637             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  69
* EL130.cbl
  3638         16  CF-COMPANY-CD                  PIC X.
  3639         16  CF-COMPANY-PASSWORD            PIC X(8).
  3640         16  CF-SECURITY-OPTION             PIC X.
  3641             88  ALL-SECURITY                   VALUE '1'.
  3642             88  COMPANY-VERIFY                 VALUE '2'.
  3643             88  PROCESSOR-VERIFY               VALUE '3'.
  3644             88  NO-SECURITY                    VALUE '4'.
  3645             88  ALL-BUT-TERM                   VALUE '5'.
  3646         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3647             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3648         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3649             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3650         16  CF-INFORCE-LOCATION            PIC X.
  3651             88  CERTS-ARE-ONLINE               VALUE '1'.
  3652             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3653             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3654         16  CF-LOWER-CASE-LETTERS          PIC X.
  3655         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3656             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3657             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3658             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3659             88  CF-ACCNT-CNTL                  VALUE '3'.
  3660             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3661
  3662         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3663         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3664
  3665         16  CF-LGX-CREDIT-USER             PIC X.
  3666             88  CO-IS-NOT-USER                 VALUE 'N'.
  3667             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3668
  3669         16 CF-CREDIT-CALC-CODES.
  3670             20  CF-CR-REM-TERM-CALC PIC X.
  3671               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3672               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3673               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3674               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3675               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3676               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3677               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3678             20  CF-CR-R78-METHOD           PIC X.
  3679               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3680               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3681
  3682         16  CF-CLAIM-CONTROL-COUNTS.
  3683             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3684                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3685
  3686             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3687                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3688
  3689             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3690                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3691
  3692             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3693                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3694
  3695         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  70
* EL130.cbl
  3696
  3697         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3698             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3699             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3700             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3701             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3702                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3703                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3704             20  CF-CO-PREM-REJECT-SW       PIC X.
  3705                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3706                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3707             20  CF-CO-REF-REJECT-SW        PIC X.
  3708                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3709                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3710
  3711         16  CF-CO-REPORTING-DT             PIC XX.
  3712         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3713         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3714           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3715           88  CF-CO-MONTH-END                  VALUE '1'.
  3716
  3717         16  CF-LGX-CLAIM-USER              PIC X.
  3718             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3719             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3720
  3721         16  CF-CREDIT-EDIT-CONTROLS.
  3722             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3723             20  CF-MIN-AGE                 PIC 99.
  3724             20  CF-DEFAULT-AGE             PIC 99.
  3725             20  CF-MIN-TERM                PIC S999      COMP-3.
  3726             20  CF-MAX-TERM                PIC S999      COMP-3.
  3727             20  CF-DEFAULT-SEX             PIC X.
  3728             20  CF-JOINT-AGE-INPUT         PIC X.
  3729                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3730             20  CF-BIRTH-DATE-INPUT        PIC X.
  3731                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3732             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3733                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3734                 88  CF-ZERO-CARRIER            VALUE '1'.
  3735                 88  CF-ZERO-GROUPING           VALUE '2'.
  3736                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3737             20  CF-EDIT-SW                 PIC X.
  3738                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3739             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3740             20  CF-CR-PR-METHOD            PIC X.
  3741               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3742               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3743             20  FILLER                     PIC X.
  3744
  3745         16  CF-CREDIT-MISC-CONTROLS.
  3746             20  CF-REIN-TABLE-SW           PIC X.
  3747                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3748             20  CF-COMP-TABLE-SW           PIC X.
  3749                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3750             20  CF-EXPERIENCE-RETENTION-AGE
  3751                                            PIC S9        COMP-3.
  3752             20  CF-CONVERSION-DT           PIC XX.
  3753             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  71
* EL130.cbl
  3754             20  CF-RUN-FREQUENCY-SW        PIC X.
  3755                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3756                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3757
  3758             20  CF-CR-CHECK-NO-CONTROL.
  3759                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3760                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3761                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3762                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3763                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3764                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3765
  3766                 24  CF-CR-CHECK-COUNT       REDEFINES
  3767                     CF-CR-CHECK-COUNTER      PIC X(4).
  3768
  3769                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3770                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3771
  3772                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3773                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3774                 24  CF-MAIL-PROCESSING       PIC X.
  3775                     88  MAIL-PROCESSING          VALUE 'Y'.
  3776
  3777         16  CF-MISC-SYSTEM-CONTROL.
  3778             20  CF-SYSTEM-C                 PIC X.
  3779                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3780             20  CF-SYSTEM-D                 PIC X.
  3781                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3782             20  CF-SOC-SEC-NO-SW            PIC X.
  3783                 88  SOC-SEC-NO-USED             VALUE '1'.
  3784             20  CF-MEMBER-NO-SW             PIC X.
  3785                 88  MEMBER-NO-USED              VALUE '1'.
  3786             20  CF-TAX-ID-NUMBER            PIC X(11).
  3787             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3788             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3789                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3790                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3791                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3792                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3793             20  CF-SYSTEM-E                 PIC X.
  3794                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3795
  3796         16  CF-LGX-LIFE-USER               PIC X.
  3797             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3798             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3799
  3800         16  CF-CR-MONTH-END-DT             PIC XX.
  3801
  3802         16  CF-FILE-MAINT-DATES.
  3803             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3804                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3805             20  CF-LAST-BATCH       REDEFINES
  3806                 CF-LAST-BATCH-NO               PIC X(4).
  3807             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3808             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3809             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3810             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3811             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  72
* EL130.cbl
  3812             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3813             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3814             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3815             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3816             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3817
  3818         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3819         16  FILLER                         PIC X.
  3820
  3821         16  CF-ALT-MORT-CODE               PIC X(4).
  3822         16  CF-MEMBER-CAPTION              PIC X(10).
  3823
  3824         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3825             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3826             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3827             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3828             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3829             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3830
  3831         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3832
  3833         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3834         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3835         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3836         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3837
  3838         16  CF-AH-OVERRIDE-L1              PIC X.
  3839         16  CF-AH-OVERRIDE-L2              PIC XX.
  3840         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3841         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3842
  3843         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3844         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3845
  3846         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3847         16  CF-AR-LAST-EL860-DT            PIC XX.
  3848         16  CF-MP-MONTH-END-DT             PIC XX.
  3849
  3850         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3851         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3852             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3853
  3854         16  CF-AR-MONTH-END-DT             PIC XX.
  3855
  3856         16  CF-CRDTCRD-USER                PIC X.
  3857             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3858             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3859
  3860         16  CF-CC-MONTH-END-DT             PIC XX.
  3861
  3862         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3863
  3864         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3865             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3866             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3867             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3868         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3869         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  73
* EL130.cbl
  3870         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3871         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3872             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3873             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3874         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3875         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3876         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3877             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3878         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3879
  3880         16  CF-CL-ZIP-CODE.
  3881             20  CF-CL-ZIP-PRIME.
  3882                 24  CF-CL-ZIP-1ST          PIC X.
  3883                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3884                 24  FILLER                 PIC X(4).
  3885             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3886         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3887             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3888             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3889             20  FILLER                     PIC XXX.
  3890
  3891         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3892         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3893         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3894         16  CF-CO-OPTION-START-DATE        PIC XX.
  3895         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3896           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3897                                                      '3' '4'.
  3898           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3899           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3900           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3901           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3902           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3903           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3904
  3905         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3906
  3907         16  CF-PAYMENT-APPROVAL-LEVELS.
  3908             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3909             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3910             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3911             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3912             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3913             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3914
  3915         16  CF-END-USER-REPORTING-USER     PIC X.
  3916             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3917             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3918
  3919         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3920             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3921             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3922
  3923         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3924
  3925         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3926         16  FILLER                         PIC X.
  3927
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  74
* EL130.cbl
  3928         16  CF-CREDIT-ARCHIVE-CNTL.
  3929             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3930             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3931             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3932
  3933         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3934
  3935         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3936             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3937             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3938
  3939         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3940             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3941             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3942
  3943         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3944
  3945         16  CF-CO-ACH-ID-CODE              PIC  X.
  3946             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3947             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3948             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3949         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3950         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3951         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3952         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3953         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3954         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3955         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3956         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3957         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3958                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3959         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3960                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3961
  3962         16  CF-CO-OVER-SHORT.
  3963             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3964             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3965
  3966*         16  FILLER                         PIC X(102).
  3967         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3968             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3969             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3970
  3971         16  CF-AH-APPROVAL-DAYS.
  3972             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3973             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3974             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3975             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3976
  3977         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3978
  3979         16  CF-APPROV-LEV-5.
  3980             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3981             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3982             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3983
  3984         16  FILLER                         PIC X(68).
  3985****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  75
* EL130.cbl
  3986*             PROCESSOR/USER RECORD                            *
  3987****************************************************************
  3988
  3989     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3990         16  CF-PROCESSOR-NAME              PIC X(30).
  3991         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3992         16  CF-PROCESSOR-TITLE             PIC X(26).
  3993         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3994                 88  MESSAGE-YES                VALUE 'Y'.
  3995                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3996
  3997*****************************************************
  3998****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3999****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4000****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4001****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4002*****************************************************
  4003
  4004         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4005             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4006             20  CF-APPLICATION-FORCE       PIC X.
  4007             20  CF-INDIVIDUAL-APP.
  4008                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4009                     28  CF-BROWSE-APP      PIC X.
  4010                     28  CF-UPDATE-APP      PIC X.
  4011
  4012         16  CF-CURRENT-TERM-ON             PIC X(4).
  4013         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4014             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4015             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4016             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4017             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4018             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4019             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4020             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4021         16  CF-PROCESSOR-CARRIER           PIC X.
  4022             88  NO-CARRIER-SECURITY            VALUE ' '.
  4023         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4024             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4025         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4026             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4027         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4028             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4029
  4030         16  CF-PROC-SYS-ACCESS-SW.
  4031             20  CF-PROC-CREDIT-CLAIMS-SW.
  4032                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4033                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4034                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4035                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4036             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4037                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4038                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4039             20  CF-PROC-LIFE-GNRLDGR-SW.
  4040                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4041                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4042                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4043                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  76
* EL130.cbl
  4044             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4045                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4046                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4047         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4048             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4049             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4050         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4051
  4052         16  CF-APPROVAL-LEVEL                  PIC X.
  4053             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4054             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4055             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4056             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4057             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4058
  4059         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4060
  4061         16  CF-LANGUAGE-TYPE                   PIC X.
  4062             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4063             88  CF-LANG-IS-FR                      VALUE 'F'.
  4064
  4065         16  CF-CSR-IND                         PIC X.
  4066         16  FILLER                             PIC X(239).
  4067
  4068****************************************************************
  4069*             PROCESSOR/REMINDERS RECORD                       *
  4070****************************************************************
  4071
  4072     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4073         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4074             20  CF-START-REMIND-DT         PIC XX.
  4075             20  CF-END-REMIND-DT           PIC XX.
  4076             20  CF-REMINDER-TEXT           PIC X(50).
  4077         16  FILLER                         PIC X(296).
  4078
  4079
  4080****************************************************************
  4081*             STATE MASTER RECORD                              *
  4082****************************************************************
  4083
  4084     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4085         16  CF-STATE-ABBREVIATION          PIC XX.
  4086         16  CF-STATE-NAME                  PIC X(25).
  4087         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4088         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4089             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4090             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4091             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4092             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4093                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4094                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4095             20  CF-ST-PREM-REJECT-SW       PIC X.
  4096                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4097                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4098             20  CF-ST-REF-REJECT-SW        PIC X.
  4099                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4100                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4101         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  77
* EL130.cbl
  4102         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4103         16  CF-ST-REFUND-RULES.
  4104             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4105             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4106             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4107         16  CF-ST-FST-PMT-EXTENSION.
  4108             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4109             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4110                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4111                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4112                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4113                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4114         16  CF-ST-STATE-CALL.
  4115             20  CF-ST-CALL-UNEARNED        PIC X.
  4116             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4117             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4118         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4119             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4120             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4121         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4122         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4123         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4124         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4125         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4126         16  FILLER                         PIC X.
  4127         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4128             20  CF-ST-BENEFIT-CD           PIC XX.
  4129             20  CF-ST-BENEFIT-KIND         PIC X.
  4130                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4131                 88  CF-ST-AH-KIND              VALUE 'A'.
  4132             20  CF-ST-REM-TERM-CALC        PIC X.
  4133                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4134                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4135                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4136                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4137                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4138                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4139                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4140                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4141
  4142             20  CF-ST-REFUND-CALC          PIC X.
  4143                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4144                 88  ST-REFD-BY-R78             VALUE '1'.
  4145                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4146                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4147                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4148                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4149                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4150                 88  ST-REFD-UTAH               VALUE '7'.
  4151                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4152                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4153                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4154
  4155             20  CF-ST-EARNING-CALC         PIC X.
  4156                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4157                 88  ST-EARN-BY-R78             VALUE '1'.
  4158                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4159                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  78
* EL130.cbl
  4160                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4161                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4162                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4163                 88  ST-EARN-MEAN               VALUE '8'.
  4164                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4165
  4166             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4167                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4168                 88  ST-OVRD-BY-R78             VALUE '1'.
  4169                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4170                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4171                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4172                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4173                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4174                 88  ST-OVRD-MEAN               VALUE '8'.
  4175                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4176             20  cf-st-extra-periods        pic 9.
  4177*            20  FILLER                     PIC X.
  4178
  4179         16  CF-ST-COMMISSION-CAPS.
  4180             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4181             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4182             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4183             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4184         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4185                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4186                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  4187                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  4188
  4189         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4190
  4191         16  CF-ST-STATUTORY-INTEREST.
  4192             20  CF-ST-STAT-DATE-FROM       PIC X.
  4193                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4194                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4195             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4196             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4197             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4198             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4199             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4200
  4201         16  CF-ST-OVER-SHORT.
  4202             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4203             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4204
  4205         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4206
  4207         16  CF-ST-RT-CALC                  PIC X.
  4208
  4209         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4210         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4211         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4212         16  CF-ST-RF-LR-CALC               PIC X.
  4213         16  CF-ST-RF-LL-CALC               PIC X.
  4214         16  CF-ST-RF-LN-CALC               PIC X.
  4215         16  CF-ST-RF-AH-CALC               PIC X.
  4216         16  CF-ST-RF-CP-CALC               PIC X.
  4217*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  79
* EL130.cbl
  4218*CIDMOD         16  FILLER                         PIC X(192).
  4219         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4220             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4221         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4222         16  CF-ST-VFY-2ND-BENE             PIC X.
  4223         16  CF-ST-CAUSAL-STATE             PIC X.
  4224         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4225         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4226         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4227             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4228         16  CF-ST-NET-ONLY-STATE           PIC X.
  4229             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4230         16  cf-commission-cap-required     pic x.
  4231         16  CF-ST-GA-COMMISSION-CAPS.
  4232             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  4233             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  4234             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  4235             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  4236         16  CF-ST-TOT-COMMISSION-CAPS.
  4237             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  4238             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  4239             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  4240             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  4241         16  FILLER                         PIC X(156).
  4242
  4243****************************************************************
  4244*             BENEFIT MASTER RECORD                            *
  4245****************************************************************
  4246
  4247     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4248         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4249             20  CF-BENEFIT-CODE            PIC XX.
  4250             20  CF-BENEFIT-NUMERIC  REDEFINES
  4251                 CF-BENEFIT-CODE            PIC XX.
  4252             20  CF-BENEFIT-ALPHA           PIC XXX.
  4253             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4254             20  CF-BENEFIT-COMMENT         PIC X(10).
  4255
  4256             20  CF-LF-COVERAGE-TYPE        PIC X.
  4257                 88  CF-REDUCING                VALUE 'R'.
  4258                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4259
  4260             20  CF-SPECIAL-CALC-CD         PIC X.
  4261                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4262                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4263                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4264                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4265                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4266                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4267                 88  CF-FARM-PLAN               VALUE 'F'.
  4268                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4269                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4270                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4271                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4272                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4273                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4274                 88  CF-PRUDENTIAL              VALUE 'P'.
  4275                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  80
* EL130.cbl
  4276                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4277                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4278                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4279                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4280                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4281
  4282             20  CF-JOINT-INDICATOR         PIC X.
  4283                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4284
  4285*            20  FILLER                     PIC X(12).
  4286             20  cf-maximum-benefits        pic s999 comp-3.
  4287             20  FILLER                     PIC X(09).
  4288             20  CF-BENEFIT-CATEGORY        PIC X.
  4289             20  CF-LOAN-TYPE               PIC X(8).
  4290
  4291             20  CF-CO-REM-TERM-CALC        PIC X.
  4292                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4293                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4294                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4295                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4296                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4297
  4298             20  CF-CO-EARNINGS-CALC        PIC X.
  4299                 88  CO-EARN-BY-R78             VALUE '1'.
  4300                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4301                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4302                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4303                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4304                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4305                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4306                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4307
  4308             20  CF-CO-REFUND-CALC          PIC X.
  4309                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4310                 88  CO-REFD-BY-R78             VALUE '1'.
  4311                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4312                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4313                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4314                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4315                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4316                 88  CO-REFD-MEAN               VALUE '8'.
  4317                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4318                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4319                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4320
  4321             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4322                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4323                 88  CO-OVRD-BY-R78             VALUE '1'.
  4324                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4325                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4326                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4327                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4328                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4329                 88  CO-OVRD-MEAN               VALUE '8'.
  4330                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4331
  4332             20  CF-CO-BEN-I-G-CD           PIC X.
  4333                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  81
* EL130.cbl
  4334                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4335                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4336
  4337         16  FILLER                         PIC X(304).
  4338
  4339
  4340****************************************************************
  4341*             CARRIER MASTER RECORD                            *
  4342****************************************************************
  4343
  4344     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4345         16  CF-ADDRESS-DATA.
  4346             20  CF-MAIL-TO-NAME            PIC X(30).
  4347             20  CF-IN-CARE-OF              PIC X(30).
  4348             20  CF-ADDRESS-LINE-1          PIC X(30).
  4349             20  CF-ADDRESS-LINE-2          PIC X(30).
  4350             20  CF-CITY-STATE              PIC X(30).
  4351             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4352             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4353
  4354         16  CF-CLAIM-NO-CONTROL.
  4355             20  CF-CLAIM-NO-METHOD         PIC X.
  4356                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4357                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4358                 88  CLAIM-NO-SEQ               VALUE '3'.
  4359                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4360             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4361                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4362                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4363                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4364
  4365         16  CF-CHECK-NO-CONTROL.
  4366             20  CF-CHECK-NO-METHOD         PIC X.
  4367                 88  CHECK-NO-MANUAL            VALUE '1'.
  4368                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4369                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4370                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4371             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4372                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4373
  4374         16  CF-DOMICILE-STATE              PIC XX.
  4375
  4376         16  CF-EXPENSE-CONTROLS.
  4377             20  CF-EXPENSE-METHOD          PIC X.
  4378                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4379                 88  DOLLARS-PER-PMT            VALUE '2'.
  4380                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4381                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4382             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4383             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4384
  4385         16  CF-CORRESPONDENCE-CONTROL.
  4386             20  CF-LETTER-RESEND-OPT       PIC X.
  4387                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4388                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4389             20  FILLER                     PIC X(4).
  4390
  4391         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  82
* EL130.cbl
  4392             20  CF-MANUAL-SW               PIC X.
  4393                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4394             20  CF-FUTURE-SW               PIC X.
  4395                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4396             20  CF-PTC-SW                  PIC X.
  4397                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4398             20  CF-IBNR-SW                 PIC X.
  4399                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4400             20  CF-PTC-LF-SW               PIC X.
  4401                 88  CF-LF-PTC-USED             VALUE '1'.
  4402             20  CF-CDT-ACCESS-METHOD       PIC X.
  4403                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4404                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4405                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4406             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4407
  4408         16  CF-CLAIM-CALC-METHOD           PIC X.
  4409             88  360-PLUS-MONTHS                VALUE '1'.
  4410             88  365-PLUS-MONTHS                VALUE '2'.
  4411             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4412             88  360-DAILY                      VALUE '4'.
  4413             88  365-DAILY                      VALUE '5'.
  4414
  4415         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4416         16  FILLER                         PIC X(11).
  4417
  4418         16  CF-LIMIT-AMOUNTS.
  4419             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4420             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4421             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4422             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4423             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4424             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4425             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4426             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4427             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4428             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4429
  4430         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4431         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4432         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4433
  4434         16  CF-ZIP-CODE.
  4435             20  CF-ZIP-PRIME.
  4436                 24  CF-ZIP-1ST             PIC X.
  4437                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4438                 24  FILLER                 PIC X(4).
  4439             20  CF-ZIP-PLUS4               PIC X(4).
  4440         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4441             20  CF-CAN-POSTAL-1            PIC XXX.
  4442             20  CF-CAN-POSTAL-2            PIC XXX.
  4443             20  FILLER                     PIC XXX.
  4444
  4445         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4446         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4447         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4448
  4449         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  83
* EL130.cbl
  4450             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4451             88  CF-NO-RATING                   VALUE 'N'.
  4452
  4453         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4454
  4455         16  CF-CARRIER-OVER-SHORT.
  4456             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4457             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4458
  4459         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4460         16  CF-SECPAY-SWITCH               PIC X.
  4461             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4462             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4463         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4464         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4465         16  FILLER                         PIC X(444).
  4466*        16  FILLER                         PIC X(452).
  4467
  4468
  4469****************************************************************
  4470*             MORTALITY MASTER RECORD                          *
  4471****************************************************************
  4472
  4473     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4474         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4475                                INDEXED BY CF-MORT-NDX.
  4476             20  CF-MORT-TABLE              PIC X(5).
  4477             20  CF-MORT-TABLE-TYPE         PIC X.
  4478                 88  CF-MORT-JOINT              VALUE 'J'.
  4479                 88  CF-MORT-SINGLE             VALUE 'S'.
  4480                 88  CF-MORT-COMBINED           VALUE 'C'.
  4481                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4482                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4483             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4484             20  CF-MORT-AGE-METHOD         PIC XX.
  4485                 88  CF-AGE-LAST                VALUE 'AL'.
  4486                 88  CF-AGE-NEAR                VALUE 'AN'.
  4487             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4488             20  CF-MORT-ADJUSTMENT-DIRECTION
  4489                                            PIC X.
  4490                 88  CF-MINUS                   VALUE '-'.
  4491                 88  CF-PLUS                    VALUE '+'.
  4492             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4493             20  CF-MORT-JOINT-CODE         PIC X.
  4494                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4495             20  CF-MORT-PC-Q               PIC X.
  4496                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4497             20  CF-MORT-TABLE-CODE         PIC X(4).
  4498             20  CF-MORT-COMMENTS           PIC X(15).
  4499             20  FILLER                     PIC X(14).
  4500
  4501         16  FILLER                         PIC X(251).
  4502
  4503
  4504****************************************************************
  4505*             BUSSINESS TYPE MASTER RECORD                     *
  4506****************************************************************
  4507
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  84
* EL130.cbl
  4508     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4509* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4510* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4511* AND RECORD 05 IS TYPES 81-99
  4512         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4513             20  CF-BUSINESS-TITLE          PIC  X(19).
  4514             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4515                                            PIC S9V9(4) COMP-3.
  4516             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4517             20  FILLER                     PIC  X.
  4518         16  FILLER                         PIC  X(248).
  4519
  4520
  4521****************************************************************
  4522*             TERMINAL MASTER RECORD                           *
  4523****************************************************************
  4524
  4525     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4526
  4527         16  CF-COMPANY-TERMINALS.
  4528             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4529                                  PIC X(4).
  4530         16  FILLER               PIC X(248).
  4531
  4532
  4533****************************************************************
  4534*             LIFE EDIT MASTER RECORD                          *
  4535****************************************************************
  4536
  4537     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4538         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4539             20  CF-LIFE-CODE-IN            PIC XX.
  4540             20  CF-LIFE-CODE-OUT           PIC XX.
  4541         16  FILLER                         PIC X(248).
  4542
  4543
  4544****************************************************************
  4545*             AH EDIT MASTER RECORD                            *
  4546****************************************************************
  4547
  4548     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4549         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4550             20  CF-AH-CODE-IN              PIC XXX.
  4551             20  CF-AH-CODE-OUT             PIC XX.
  4552         16  FILLER                         PIC X(248).
  4553
  4554
  4555****************************************************************
  4556*             CREDIBILITY TABLES                               *
  4557****************************************************************
  4558
  4559     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4560         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4561                             INDEXED BY CF-CRDB-NDX.
  4562             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4563             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4564             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4565         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  85
* EL130.cbl
  4566
  4567
  4568****************************************************************
  4569*             REPORT CUSTOMIZATION RECORD                      *
  4570****************************************************************
  4571
  4572     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4573         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4574             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4575             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4576             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4577**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4578****       A T-TRANSFER.                                   ****
  4579             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4580
  4581         16  FILLER                         PIC XX.
  4582
  4583         16  CF-CARRIER-CNTL-OPT.
  4584             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4585                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4586                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4587             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4588                                            PIC X.
  4589         16  CF-GROUP-CNTL-OPT.
  4590             20  CF-GROUP-OPT-SEQ           PIC 9.
  4591                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4592                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4593             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4594                                            PIC X(6).
  4595         16  CF-STATE-CNTL-OPT.
  4596             20  CF-STATE-OPT-SEQ           PIC 9.
  4597                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4598                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4599             20  CF-STATE-SELECT OCCURS 3 TIMES
  4600                                            PIC XX.
  4601         16  CF-ACCOUNT-CNTL-OPT.
  4602             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4603                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4604                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4605             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4606                                            PIC X(10).
  4607         16  CF-BUS-TYP-CNTL-OPT.
  4608             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4609                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4610                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4611             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4612                                            PIC XX.
  4613         16  CF-LF-TYP-CNTL-OPT.
  4614             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4615                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4616                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4617             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4618                                            PIC XX.
  4619         16  CF-AH-TYP-CNTL-OPT.
  4620             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4621                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4622                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4623             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  86
* EL130.cbl
  4624                                            PIC XX.
  4625         16  CF-REPTCD1-CNTL-OPT.
  4626             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4627                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4628                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4629             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4630                                            PIC X(10).
  4631         16  CF-REPTCD2-CNTL-OPT.
  4632             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4633                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4634                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4635             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4636                                            PIC X(10).
  4637         16  CF-USER1-CNTL-OPT.
  4638             20  CF-USER1-OPT-SEQ           PIC 9.
  4639                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4640                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4641             20  CF-USER1-SELECT OCCURS 3 TIMES
  4642                                            PIC X(10).
  4643         16  CF-USER2-CNTL-OPT.
  4644             20  CF-USER2-OPT-SEQ           PIC 9.
  4645                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4646                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4647             20  CF-USER2-SELECT OCCURS 3 TIMES
  4648                                            PIC X(10).
  4649         16  CF-USER3-CNTL-OPT.
  4650             20  CF-USER3-OPT-SEQ           PIC 9.
  4651                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4652                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4653             20  CF-USER3-SELECT OCCURS 3 TIMES
  4654                                            PIC X(10).
  4655         16  CF-USER4-CNTL-OPT.
  4656             20  CF-USER4-OPT-SEQ           PIC 9.
  4657                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4658                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4659             20  CF-USER4-SELECT OCCURS 3 TIMES
  4660                                            PIC X(10).
  4661         16  CF-USER5-CNTL-OPT.
  4662             20  CF-USER5-OPT-SEQ           PIC 9.
  4663                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4664                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4665             20  CF-USER5-SELECT OCCURS 3 TIMES
  4666                                            PIC X(10).
  4667         16  CF-REINS-CNTL-OPT.
  4668             20  CF-REINS-OPT-SEQ           PIC 9.
  4669                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4670                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4671             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4672                 24  CF-REINS-PRIME         PIC XXX.
  4673                 24  CF-REINS-SUB           PIC XXX.
  4674
  4675         16  CF-AGENT-CNTL-OPT.
  4676             20  CF-AGENT-OPT-SEQ           PIC 9.
  4677                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4678                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4679             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4680                                            PIC X(10).
  4681
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  87
* EL130.cbl
  4682         16  FILLER                         PIC X(43).
  4683
  4684         16  CF-LOSS-RATIO-SELECT.
  4685             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4686             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4687         16  CF-ENTRY-DATE-SELECT.
  4688             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4689             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4690         16  CF-EFFECTIVE-DATE-SELECT.
  4691             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4692             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4693
  4694         16  CF-EXCEPTION-LIST-IND          PIC X.
  4695             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4696
  4697         16  FILLER                         PIC X(318).
  4698
  4699****************************************************************
  4700*                  EXCEPTION REPORTING RECORD                  *
  4701****************************************************************
  4702
  4703     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4704         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4705             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4706
  4707         16  CF-COMBINED-LIFE-AH-OPT.
  4708             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4709             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4710             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4711             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4712
  4713         16  CF-LIFE-OPT.
  4714             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4715             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4716             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4717             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4718             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4719             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4720             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4721             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4722             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4723             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4724
  4725         16  CF-AH-OPT.
  4726             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4727             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4728             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4729             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4730             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4731             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4732             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4733             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4734             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4735             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4736
  4737         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4738             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4739             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  88
* EL130.cbl
  4740             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4741
  4742         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4743
  4744         16  FILLER                         PIC X(673).
  4745
  4746
  4747****************************************************************
  4748*             MORTGAGE SYSTEM PLAN RECORD                      *
  4749****************************************************************
  4750
  4751     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4752         16  CF-PLAN-TYPE                   PIC X.
  4753             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4754             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4755             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4756         16  CF-PLAN-ABBREV                 PIC XXX.
  4757         16  CF-PLAN-DESCRIPT               PIC X(10).
  4758         16  CF-PLAN-NOTES                  PIC X(20).
  4759         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4760         16  CF-PLAN-UNDERWRITING.
  4761             20  CF-PLAN-TERM-DATA.
  4762                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4763                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4764             20  CF-PLAN-AGE-DATA.
  4765                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4766                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4767                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4768             20  CF-PLAN-BENEFIT-DATA.
  4769                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4770                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4771                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4772                                            PIC S9(7)V99  COMP-3.
  4773         16  CF-PLAN-POLICY-FORMS.
  4774             20  CF-POLICY-FORM             PIC X(12).
  4775             20  CF-MASTER-APPLICATION      PIC X(12).
  4776             20  CF-MASTER-POLICY           PIC X(12).
  4777         16  CF-PLAN-RATING.
  4778             20  CF-RATE-CODE               PIC X(5).
  4779             20  CF-SEX-RATING              PIC X.
  4780                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4781                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4782             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4783             20  CF-SUB-STD-TYPE            PIC X.
  4784                 88  CF-PCT-OF-PREM            VALUE '1'.
  4785                 88  CF-PCT-OF-BENE            VALUE '2'.
  4786         16  CF-PLAN-PREM-TOLERANCES.
  4787             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4788             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4789         16  CF-PLAN-PYMT-TOLERANCES.
  4790             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4791             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4792         16  CF-PLAN-MISC-DATA.
  4793             20  FILLER                     PIC X.
  4794             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4795             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4796         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4797         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  89
* EL130.cbl
  4798             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4799                                                     '1'.
  4800             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4801                                                     '2'.
  4802         16  CF-MIB-SEARCH-SW               PIC X.
  4803             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4804             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4805             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4806             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4807         16  CF-ALPHA-SEARCH-SW             PIC X.
  4808             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4809             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4810             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4811             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4812             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4813             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4814             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4815             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4816             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4817             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4818                                                     'A' 'B' 'C'
  4819                                                     'X' 'Y' 'Z'.
  4820         16  CF-EFF-DT-RULE-SW              PIC X.
  4821             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4822             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4823             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4824             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4825             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4826         16  FILLER                         PIC X(4).
  4827         16  CF-HEALTH-QUESTIONS            PIC X.
  4828             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4829         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4830         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4831         16  CF-PLAN-SNGL-JNT               PIC X.
  4832             88  CF-COMBINED-PLAN              VALUE 'C'.
  4833             88  CF-JNT-PLAN                   VALUE 'J'.
  4834             88  CF-SNGL-PLAN                  VALUE 'S'.
  4835         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4836         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4837         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4838         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4839         16  CF-RERATE-CNTL                 PIC  X.
  4840             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4841             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4842             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4843             88  CF-AUTO-RECALC                 VALUE '4'.
  4844         16  CF-BENEFIT-TYPE                PIC  X.
  4845             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4846             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4847         16  CF-POLICY-FEE                  PIC S999V99
  4848                                                    COMP-3.
  4849         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4850         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4851         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4852         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4853         16  FILLER                         PIC  X(32).
  4854         16  CF-TERMINATION-FORM            PIC  X(04).
  4855         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  90
* EL130.cbl
  4856         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4857                                                       COMP-3.
  4858         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4859         16  CF-ISSUE-LETTER                PIC  X(4).
  4860         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4861         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4862             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4863             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4864         16  CF-MP-REFUND-CALC              PIC X.
  4865             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4866             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4867             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4868             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4869             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4870             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4871             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4872             88  CF-MP-REFD-MEAN                VALUE '8'.
  4873         16  CF-ALT-RATE-CODE               PIC  X(5).
  4874
  4875
  4876         16  FILLER                         PIC X(498).
  4877****************************************************************
  4878*             MORTGAGE COMPANY MASTER RECORD                   *
  4879****************************************************************
  4880
  4881     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4882         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4883         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4884             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4885             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4886             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4887             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4888             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4889
  4890         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4891         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4892         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4893         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4894         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4895
  4896         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4897             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4898         16  CF-MP-RECON-USE-IND            PIC X(1).
  4899             88  CF-MP-USE-RECON             VALUE 'Y'.
  4900         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4901             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4902         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4903             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4904             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4905         16  FILLER                         PIC X(1).
  4906         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4907             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4908         16  CF-MORTG-MIB-VERSION           PIC X.
  4909             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4910             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4911             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4912         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4913             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  91
* EL130.cbl
  4914                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4915             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4916                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4917             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4918                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4919             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4920                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4921             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4922                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4923             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4924                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4925         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4926         16  FILLER                         PIC X(7).
  4927         16  CF-MORTG-DESTINATION-SYMBOL.
  4928             20  CF-MORTG-MIB-COMM          PIC X(5).
  4929             20  CF-MORTG-MIB-TERM          PIC X(5).
  4930         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4931             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4932         16  FILLER                         PIC X(03).
  4933         16  CF-MP-CHECK-NO-CONTROL.
  4934             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4935                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4936                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4937                                                ' ' LOW-VALUES.
  4938                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4939                                               VALUE '3'.
  4940         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4941         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4942         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4943             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4944                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4945             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4946                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4947             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4948                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4949             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4950                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4951             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4952                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4953             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4954                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4955         16  CF-MORTG-BILLING-AREA.
  4956             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4957                                            PIC X.
  4958         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4959         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4960         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4961         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4962             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4963             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4964         16  FILLER                         PIC X.
  4965         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4966             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4967             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4968         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4969         16  FILLER                         PIC X(8).
  4970         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4971         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  92
* EL130.cbl
  4972         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4973         16  CF-ACH-COMPANY-ID.
  4974             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4975                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4976                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4977                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4978             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4979         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4980             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4981         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4982             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4983             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4984         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4985         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4986         16  FILLER                         PIC X(536).
  4987
  4988****************************************************************
  4989*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4990****************************************************************
  4991
  4992     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4993         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4994             20  CF-FEMALE-HEIGHT.
  4995                 24  CF-FEMALE-FT           PIC 99.
  4996                 24  CF-FEMALE-IN           PIC 99.
  4997             20  CF-FEMALE-MIN-WT           PIC 999.
  4998             20  CF-FEMALE-MAX-WT           PIC 999.
  4999         16  FILLER                         PIC X(428).
  5000
  5001     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5002         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5003             20  CF-MALE-HEIGHT.
  5004                 24  CF-MALE-FT             PIC 99.
  5005                 24  CF-MALE-IN             PIC 99.
  5006             20  CF-MALE-MIN-WT             PIC 999.
  5007             20  CF-MALE-MAX-WT             PIC 999.
  5008         16  FILLER                         PIC X(428).
  5009******************************************************************
  5010*             AUTOMATIC ACTIVITY RECORD                          *
  5011******************************************************************
  5012     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5013         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5014             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5015             20  CF-SYS-LETTER-ID           PIC X(04).
  5016             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5017             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5018             20  CF-SYS-RESET-SW            PIC X(01).
  5019             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5020             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5021
  5022         16  FILLER                         PIC X(50).
  5023
  5024         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5025             20  CF-USER-ACTIVE-SW          PIC X(01).
  5026             20  CF-USER-LETTER-ID          PIC X(04).
  5027             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5028             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5029             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  93
* EL130.cbl
  5030             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5031             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5032             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5033
  5034         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  94
* EL130.cbl
  5036*    COPY ELCCERT.
  5037******************************************************************
  5038*                                                                *
  5039*                            ELCCERT.                            *
  5040*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5041*                            VMOD=2.013                          *
  5042*                                                                *
  5043*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5044*                                                                *
  5045*   FILE TYPE = VSAM,KSDS                                        *
  5046*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5047*                                                                *
  5048*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5049*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5050*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5051*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5052*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5053*                                                                *
  5054*   LOG = YES                                                    *
  5055*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5056******************************************************************
  5057*                   C H A N G E   L O G
  5058*
  5059* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5060*-----------------------------------------------------------------
  5061*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5062* EFFECTIVE    NUMBER
  5063*-----------------------------------------------------------------
  5064* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5065* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5066* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5067* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5068* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5069* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5070* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5071* 032612  CR2011110200001  PEMA  AHL CHANGES
  5072* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5073* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5074******************************************************************
  5075
  5076 01  CERTIFICATE-MASTER.
  5077     12  CM-RECORD-ID                      PIC XX.
  5078         88  VALID-CM-ID                      VALUE 'CM'.
  5079
  5080     12  CM-CONTROL-PRIMARY.
  5081         16  CM-COMPANY-CD                 PIC X.
  5082         16  CM-CARRIER                    PIC X.
  5083         16  CM-GROUPING.
  5084             20  CM-GROUPING-PREFIX        PIC X(3).
  5085             20  CM-GROUPING-PRIME         PIC X(3).
  5086         16  CM-STATE                      PIC XX.
  5087         16  CM-ACCOUNT.
  5088             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5089             20  CM-ACCOUNT-PRIME          PIC X(6).
  5090         16  CM-CERT-EFF-DT                PIC XX.
  5091         16  CM-CERT-NO.
  5092             20  CM-CERT-PRIME             PIC X(10).
  5093             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  95
* EL130.cbl
  5094
  5095     12  CM-CONTROL-BY-NAME.
  5096         16  CM-COMPANY-CD-A1              PIC X.
  5097         16  CM-INSURED-LAST-NAME          PIC X(15).
  5098         16  CM-INSURED-INITIALS.
  5099             20  CM-INSURED-INITIAL1       PIC X.
  5100             20  CM-INSURED-INITIAL2       PIC X.
  5101
  5102     12  CM-CONTROL-BY-SSN.
  5103         16  CM-COMPANY-CD-A2              PIC X.
  5104         16  CM-SOC-SEC-NO.
  5105             20  CM-SSN-STATE              PIC XX.
  5106             20  CM-SSN-ACCOUNT            PIC X(6).
  5107             20  CM-SSN-LN3.
  5108                 25  CM-INSURED-INITIALS-A2.
  5109                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5110                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5111                 25 CM-PART-LAST-NAME-A2         PIC X.
  5112
  5113     12  CM-CONTROL-BY-CERT-NO.
  5114         16  CM-COMPANY-CD-A4              PIC X.
  5115         16  CM-CERT-NO-A4                 PIC X(11).
  5116
  5117     12  CM-CONTROL-BY-MEMB.
  5118         16  CM-COMPANY-CD-A5              PIC X.
  5119         16  CM-MEMBER-NO.
  5120             20  CM-MEMB-STATE             PIC XX.
  5121             20  CM-MEMB-ACCOUNT           PIC X(6).
  5122             20  CM-MEMB-LN4.
  5123                 25  CM-INSURED-INITIALS-A5.
  5124                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5125                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5126                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5127
  5128     12  CM-INSURED-PROFILE-DATA.
  5129         16  CM-INSURED-FIRST-NAME.
  5130             20  CM-INSURED-1ST-INIT       PIC X.
  5131             20  FILLER                    PIC X(9).
  5132         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5133         16  CM-INSURED-SEX                PIC X.
  5134             88  CM-SEX-MALE                  VALUE 'M'.
  5135             88  CM-SEX-FEMAL                 VALUE 'F'.
  5136         16  CM-INSURED-JOINT-AGE          PIC 99.
  5137         16  CM-JOINT-INSURED-NAME.
  5138             20  CM-JT-LAST-NAME           PIC X(15).
  5139             20  CM-JT-FIRST-NAME.
  5140                 24  CM-JT-1ST-INIT        PIC X.
  5141                 24  FILLER                PIC X(9).
  5142             20  CM-JT-INITIAL             PIC X.
  5143
  5144     12  CM-LIFE-DATA.
  5145         16  CM-LF-BENEFIT-CD              PIC XX.
  5146         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5147         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5148         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5149         16  CM-LF-DEV-CODE                PIC XXX.
  5150         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5151         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  96
* EL130.cbl
  5152         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5153         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5154         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5155         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5156         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5157         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5158         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5159         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5160         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5161         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5162         16  cm-temp-epiq                  pic xx.
  5163             88  EPIQ-CLASS                  value 'EQ'.
  5164*        16  FILLER                        PIC XX.
  5165
  5166     12  CM-AH-DATA.
  5167         16  CM-AH-BENEFIT-CD              PIC XX.
  5168         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5169         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5170         16  CM-AH-DEV-CODE                PIC XXX.
  5171         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5172         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5173         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5174         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5175         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5176         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5177         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5178         16  CM-AH-PAID-THRU-DT            PIC XX.
  5179             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5180         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5181         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5182         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5183         16  FILLER                        PIC X.
  5184
  5185     12  CM-LOAN-INFORMATION.
  5186         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5187         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5188                                           PIC S9(5)V99  COMP-3.
  5189         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5190         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5191         16  CM-PAY-FREQUENCY              PIC S99.
  5192         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5193         16  CM-RATE-CLASS                 PIC XX.
  5194         16  CM-BENEFICIARY                PIC X(25).
  5195         16  CM-POLICY-FORM-NO             PIC X(12).
  5196         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5197         16  CM-LAST-ADD-ON-DT             PIC XX.
  5198         16  CM-DEDUCTIBLE-AMOUNTS.
  5199             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5200             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5201         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5202             20  CM-RESIDENT-STATE         PIC XX.
  5203             20  CM-RATE-CODE              PIC X(4).
  5204             20  FILLER                    PIC XX.
  5205         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5206             20  CM-LOAN-OFFICER           PIC X(5).
  5207             20  FILLER                    PIC XXX.
  5208         16  CM-CSR-CODE                   PIC XXX.
  5209         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  97
* EL130.cbl
  5210             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5211         16  CM-POST-CARD-IND              PIC X.
  5212         16  CM-NH-INTERFACE-SW            PIC X.
  5213         16  CM-PREMIUM-TYPE               PIC X.
  5214             88  CM-SING-PRM                  VALUE '1'.
  5215             88  CM-O-B-COVERAGE              VALUE '2'.
  5216             88  CM-OPEN-END                  VALUE '3'.
  5217         16  CM-IND-GRP-TYPE               PIC X.
  5218             88  CM-INDIVIDUAL                VALUE 'I'.
  5219             88  CM-GROUP                     VALUE 'G'.
  5220         16  CM-SKIP-CODE                  PIC X.
  5221             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5222             88  SKIP-JULY                    VALUE '1'.
  5223             88  SKIP-AUGUST                  VALUE '2'.
  5224             88  SKIP-SEPTEMBER               VALUE '3'.
  5225             88  SKIP-JULY-AUG                VALUE '4'.
  5226             88  SKIP-AUG-SEPT                VALUE '5'.
  5227             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5228             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5229             88  SKIP-JUNE                    VALUE '8'.
  5230             88  SKIP-JUNE-JULY               VALUE '9'.
  5231             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5232             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5233         16  CM-PAYMENT-MODE               PIC X.
  5234             88  PAY-MONTHLY                  VALUE SPACE.
  5235             88  PAY-WEEKLY                   VALUE '1'.
  5236             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5237             88  PAY-BI-WEEKLY                VALUE '3'.
  5238             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5239         16  CM-LOAN-NUMBER                PIC X(8).
  5240         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5241         16  CM-OLD-LOF                    PIC XXX.
  5242*        16  CM-LOAN-OFFICER               PIC XXX.
  5243         16  CM-REIN-TABLE                 PIC XXX.
  5244         16  CM-SPECIAL-REIN-CODE          PIC X.
  5245         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5246         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5247         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5248
  5249     12  CM-STATUS-DATA.
  5250         16  CM-ENTRY-STATUS               PIC X.
  5251         16  CM-ENTRY-DT                   PIC XX.
  5252
  5253         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5254         16  CM-LF-CANCEL-DT               PIC XX.
  5255         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5256
  5257         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5258         16  CM-LF-DEATH-DT                PIC XX.
  5259         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5260
  5261         16  CM-LF-CURRENT-STATUS          PIC X.
  5262             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5263                                                'M' '4' '5' '9'.
  5264             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5265             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5266             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5267             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  98
* EL130.cbl
  5268             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5269             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5270             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5271             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5272             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5273             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5274             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5275             88  CM-LF-DECLINED               VALUE 'D'.
  5276             88  CM-LF-VOIDED                 VALUE 'V'.
  5277
  5278         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5279         16  CM-AH-CANCEL-DT               PIC XX.
  5280         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5281
  5282         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5283         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5284         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5285
  5286         16  CM-AH-CURRENT-STATUS          PIC X.
  5287             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5288                                                'M' '4' '5' '9'.
  5289             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5290             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5291             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5292             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5293             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5294             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5295             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5296             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5297             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5298             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5299             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5300             88  CM-AH-DECLINED               VALUE 'D'.
  5301             88  CM-AH-VOIDED                 VALUE 'V'.
  5302
  5303         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5304             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5305             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5306             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5307         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5308
  5309         16  CM-ENTRY-BATCH                PIC X(6).
  5310         16  CM-LF-EXIT-BATCH              PIC X(6).
  5311         16  CM-AH-EXIT-BATCH              PIC X(6).
  5312         16  CM-LAST-MONTH-END             PIC XX.
  5313
  5314     12  CM-NOTE-SW                        PIC X.
  5315         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5316         88  CERT-NOTES-PRESENT               VALUE '1'.
  5317         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5318         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5319         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5320         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5321         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5322         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5323     12  CM-COMP-EXCP-SW                   PIC X.
  5324         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5325         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page  99
* EL130.cbl
  5326     12  CM-INSURED-ADDRESS-SW             PIC X.
  5327         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5328         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5329
  5330*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5331     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5332     12  FILLER                            PIC X.
  5333
  5334*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5335     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5336     12  FILLER                            PIC X.
  5337*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5338     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5339
  5340     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5341         88  CERT-ADDED-BATCH                 VALUE ' '.
  5342         88  CERT-ADDED-ONLINE                VALUE '1'.
  5343         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5344         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5345         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5346     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5347         88  CERT-AS-LOADED                   VALUE ' '.
  5348         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5349         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5350         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5351         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5352         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5353         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5354         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5355
  5356     12  CM-ACCOUNT-COMM-PCTS.
  5357         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5358         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5359
  5360     12  CM-USER-FIELD                     PIC X.
  5361     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5362     12  CM-CLP-STATE                      PIC XX.
  5363     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5364     12  CM-USER-RESERVED                  PIC XXX.
  5365     12  FILLER REDEFINES CM-USER-RESERVED.
  5366         16  CM-AH-CLASS-CD                PIC XX.
  5367         16  F                             PIC X.
  5368******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 100
* EL130.cbl
  5370*    COPY ERCACCT.
  5371******************************************************************
  5372*                                                                *
  5373*                                                                *
  5374*                            ERCACCT                             *
  5375*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5376*                            VMOD=2.031                          *
  5377*                                                                *
  5378*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5379*                                                                *
  5380*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5381*   VSAM ACCOUNT MASTER FILES.                                   *
  5382*                                                                *
  5383*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5384*                                                                *
  5385*   FILE TYPE = VSAM,KSDS                                        *
  5386*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5387*                                                                *
  5388*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5389*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5390*                                                                *
  5391*   LOG = NO                                                     *
  5392*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5393*                                                                *
  5394*                                                                *
  5395******************************************************************
  5396*                   C H A N G E   L O G
  5397*
  5398* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5399*-----------------------------------------------------------------
  5400*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5401* EFFECTIVE    NUMBER
  5402*-----------------------------------------------------------------
  5403* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5404* 092705    2005050300006  PEMA  ADD SPP LEASES
  5405* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5406* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5407* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5408* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5409* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5410* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  5411******************************************************************
  5412
  5413 01  ACCOUNT-MASTER.
  5414     12  AM-RECORD-ID                      PIC XX.
  5415         88  VALID-AM-ID                      VALUE 'AM'.
  5416
  5417     12  AM-CONTROL-PRIMARY.
  5418         16  AM-COMPANY-CD                 PIC X.
  5419         16  AM-MSTR-CNTRL.
  5420             20  AM-CONTROL-A.
  5421                 24  AM-CARRIER            PIC X.
  5422                 24  AM-GROUPING.
  5423                     28 AM-GROUPING-PREFIX PIC XXX.
  5424                     28 AM-GROUPING-PRIME  PIC XXX.
  5425                 24  AM-STATE              PIC XX.
  5426                 24  AM-ACCOUNT.
  5427                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 101
* EL130.cbl
  5428                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5429             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5430                                           PIC X(19).
  5431             20  AM-CNTRL-B.
  5432                 24  AM-EXPIRATION-DT      PIC XX.
  5433                 24  FILLER                PIC X(4).
  5434             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5435                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5436
  5437     12  AM-CONTROL-BY-VAR-GRP.
  5438         16  AM-COMPANY-CD-A1              PIC X.
  5439         16  AM-VG-CARRIER                 PIC X.
  5440         16  AM-VG-GROUPING                PIC X(6).
  5441         16  AM-VG-STATE                   PIC XX.
  5442         16  AM-VG-ACCOUNT                 PIC X(10).
  5443         16  AM-VG-DATE.
  5444             20  AM-VG-EXPIRATION-DT       PIC XX.
  5445             20  FILLER                    PIC X(4).
  5446         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5447                                           PIC 9(11)      COMP-3.
  5448     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5449         16  FILLER                        PIC X(10).
  5450         16  AM-VG-KEY3.
  5451             20  AM-VG3-ACCOUNT            PIC X(10).
  5452             20  AM-VG3-EXP-DT             PIC XX.
  5453         16  FILLER                        PIC X(4).
  5454     12  AM-MAINT-INFORMATION.
  5455         16  AM-LAST-MAINT-DT              PIC XX.
  5456         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5457         16  AM-LAST-MAINT-USER            PIC X(4).
  5458         16  FILLER                        PIC XX.
  5459
  5460     12  AM-EFFECTIVE-DT                   PIC XX.
  5461     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5462
  5463     12  AM-PREV-DATES  COMP-3.
  5464         16  AM-PREV-EXP-DT                PIC 9(11).
  5465         16  AM-PREV-EFF-DT                PIC 9(11).
  5466
  5467     12  AM-REPORT-CODE-1                  PIC X(10).
  5468     12  AM-REPORT-CODE-2                  PIC X(10).
  5469
  5470     12  AM-CITY-CODE                      PIC X(4).
  5471     12  AM-COUNTY-PARISH                  PIC X(6).
  5472
  5473     12  AM-NAME                           PIC X(30).
  5474     12  AM-PERSON                         PIC X(30).
  5475     12  AM-ADDRS                          PIC X(30).
  5476     12  AM-CITY.
  5477         16  AM-ADDR-CITY                  PIC X(28).
  5478         16  AM-ADDR-STATE                 PIC XX.
  5479     12  AM-ZIP.
  5480         16  AM-ZIP-PRIME.
  5481             20  AM-ZIP-PRI-1ST            PIC X.
  5482                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5483             20  FILLER                    PIC X(4).
  5484         16  AM-ZIP-PLUS4                  PIC X(4).
  5485     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 102
* EL130.cbl
  5486         16  AM-CAN-POSTAL-1               PIC XXX.
  5487         16  AM-CAN-POSTAL-2               PIC XXX.
  5488         16  FILLER                        PIC XXX.
  5489     12  AM-TEL-NO.
  5490         16  AM-AREA-CODE                  PIC 999.
  5491         16  AM-TEL-PRE                    PIC 999.
  5492         16  AM-TEL-NBR                    PIC 9(4).
  5493     12  AM-TEL-LOC                        PIC X.
  5494         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5495         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5496
  5497     12  AM-COMM-STRUCTURE.
  5498         16  AM-DEFN-1.
  5499             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5500                 24  AM-AGT.
  5501                     28  AM-AGT-PREFIX     PIC X(4).
  5502                     28  AM-AGT-PRIME      PIC X(6).
  5503                 24  AM-COM-TYP            PIC X.
  5504                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5505                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5506                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5507                 24  AM-RECALC-LV-INDIC    PIC X.
  5508                 24  AM-RETRO-LV-INDIC     PIC X.
  5509                 24  AM-GL-CODES           PIC X.
  5510                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5511                 24  FILLER                PIC X(01).
  5512         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5513             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5514                 24  FILLER                PIC X(11).
  5515                 24  AM-L-COMA             PIC XXX.
  5516                 24  AM-J-COMA             PIC XXX.
  5517                 24  AM-A-COMA             PIC XXX.
  5518                 24  FILLER                PIC X(6).
  5519
  5520     12  AM-COMM-CHANGE-STATUS             PIC X.
  5521         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5522
  5523     12  AM-CSR-CODE                       PIC X(4).
  5524
  5525     12  AM-BILLING-STATUS                 PIC X.
  5526         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5527         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5528     12  AM-AUTO-REFUND-SW                 PIC X.
  5529         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5530         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5531     12  AM-GPCD                           PIC 99.
  5532     12  AM-IG                             PIC X.
  5533         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5534         88  AM-HAS-GROUP                     VALUE '2'.
  5535     12  AM-STATUS                         PIC X.
  5536         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5537         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5538         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5539         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5540         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5541         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5542         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  5543         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 103
* EL130.cbl
  5544         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  5545         88  AM-ACCOUNT-PENDING               VALUE '9'.
  5546     12  AM-REMIT-TO                       PIC 99.
  5547     12  AM-ID-NO                          PIC X(11).
  5548
  5549     12  AM-CAL-TABLE                      PIC XX.
  5550     12  AM-LF-DEVIATION                   PIC XXX.
  5551     12  AM-AH-DEVIATION                   PIC XXX.
  5552     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5553     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5554     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5555     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5556     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5557     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5558
  5559     12  AM-USER-FIELDS.
  5560         16  AM-FLD-1                      PIC XX.
  5561         16  AM-FLD-2                      PIC XX.
  5562         16  AM-FLD-3                      PIC XX.
  5563         16  AM-FLD-4                      PIC XX.
  5564         16  AM-FLD-5                      PIC XX.
  5565
  5566     12  AM-1ST-PROD-DATE.
  5567         16  AM-1ST-PROD-YR                PIC XX.
  5568         16  AM-1ST-PROD-MO                PIC XX.
  5569         16  AM-1ST-PROD-DA                PIC XX.
  5570     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5571     12  AM-CERTS-PURGED-DATE.
  5572         16  AM-PUR-YR                     PIC XX.
  5573         16  AM-PUR-MO                     PIC XX.
  5574         16  AM-PUR-DA                     PIC XX.
  5575     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5576     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5577     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5578     12  AM-INACTIVE-DATE.
  5579         16  AM-INA-MO                     PIC 99.
  5580         16  AM-INA-DA                     PIC 99.
  5581         16  AM-INA-YR                     PIC 99.
  5582     12  AM-AR-HI-CERT-DATE                PIC XX.
  5583
  5584     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5585     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5586
  5587     12  AM-OB-PAYMENT-MODE                PIC X.
  5588         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5589         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5590         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5591         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5592
  5593     12  AM-AH-ONLY-INDICATOR              PIC X.
  5594         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5595         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5596
  5597     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5598
  5599     12  AM-OVER-SHORT.
  5600         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5601         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 104
* EL130.cbl
  5602
  5603     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5604     12  AM-DCC-CLP-STATE                  PIC XX.
  5605
  5606     12  AM-RECALC-COMM                    PIC X.
  5607     12  AM-RECALC-REIN                    PIC X.
  5608
  5609     12  AM-REI-TABLE                      PIC XXX.
  5610     12  AM-REI-ET-LF                      PIC X.
  5611     12  AM-REI-ET-AH                      PIC X.
  5612     12  AM-REI-PE-LF                      PIC X.
  5613     12  AM-REI-PE-AH                      PIC X.
  5614     12  AM-REI-PRT-ST                     PIC X.
  5615     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5616     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5617     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5618     12  AM-REI-GROUP-A                    PIC X(6).
  5619     12  AM-REI-MORT                       PIC X(4).
  5620     12  AM-REI-PRT-OW                     PIC X.
  5621     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5622     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5623     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5624     12  AM-REI-GROUP-B                    PIC X(6).
  5625
  5626     12  AM-TRUST-TYPE                     PIC X(2).
  5627
  5628     12  AM-EMPLOYER-STMT-USED             PIC X.
  5629     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5630
  5631     12  AM-STD-AH-TYPE                    PIC XX.
  5632     12  AM-EARN-METHODS.
  5633         16  AM-EARN-METHOD-R              PIC X.
  5634             88 AM-REF-RL-R78                 VALUE 'R'.
  5635             88 AM-REF-RL-PR                  VALUE 'P'.
  5636             88 AM-REF-RL-MEAN                VALUE 'M'.
  5637             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5638         16  AM-EARN-METHOD-L              PIC X.
  5639             88 AM-REF-LL-R78                 VALUE 'R'.
  5640             88 AM-REF-LL-PR                  VALUE 'P'.
  5641             88 AM-REF-LL-MEAN                VALUE 'M'.
  5642             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5643         16  AM-EARN-METHOD-A              PIC X.
  5644             88 AM-REF-AH-R78                 VALUE 'R'.
  5645             88 AM-REF-AH-PR                  VALUE 'P'.
  5646             88 AM-REF-AH-MEAN                VALUE 'M'.
  5647             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5648             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5649             88 AM-REF-AH-NET                 VALUE 'N'.
  5650
  5651     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5652     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5653     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5654
  5655     12  AM-RET-Y-N                        PIC X.
  5656     12  AM-RET-P-E                        PIC X.
  5657     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5658     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5659     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 105
* EL130.cbl
  5660     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5661         16  AM-POOL-PRIME                 PIC XXX.
  5662         16  AM-POOL-SUB                   PIC XXX.
  5663     12  AM-RETRO-EARNINGS.
  5664         16  AM-RET-EARN-R                 PIC X.
  5665         16  AM-RET-EARN-L                 PIC X.
  5666         16  AM-RET-EARN-A                 PIC X.
  5667     12  AM-RET-ST-TAX-USE                 PIC X.
  5668         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5669         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5670     12  AM-RETRO-BEG-EARNINGS.
  5671         16  AM-RET-BEG-EARN-R             PIC X.
  5672         16  AM-RET-BEG-EARN-L             PIC X.
  5673         16  AM-RET-BEG-EARN-A             PIC X.
  5674     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5675     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5676
  5677     12  AM-USER-SELECT-OPTIONS.
  5678         16  AM-USER-SELECT-1              PIC X(10).
  5679         16  AM-USER-SELECT-2              PIC X(10).
  5680         16  AM-USER-SELECT-3              PIC X(10).
  5681         16  AM-USER-SELECT-4              PIC X(10).
  5682         16  AM-USER-SELECT-5              PIC X(10).
  5683
  5684     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5685
  5686     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5687
  5688     12  AM-RPT045A-SWITCH                 PIC X.
  5689         88  RPT045A-OFF                   VALUE 'N'.
  5690
  5691     12  AM-INSURANCE-LIMITS.
  5692         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5693         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5694
  5695     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5696         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5697
  5698     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5699         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5700         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5701
  5702     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5703
  5704     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5705     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5706     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5707     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5708     12  AM-DCC-UEF-STATE                  PIC XX.
  5709     12  FILLER                            PIC XXX.
  5710     12  AM-REPORT-CODE-3                  PIC X(10).
  5711*    12  FILLER                            PIC X(22).
  5712
  5713     12  AM-RESERVE-DATE.
  5714         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5715         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5716         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5717
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 106
* EL130.cbl
  5718     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5719     12  AM-NOTIFICATION-TYPES.
  5720         16  AM-NOTIF-OF-LETTERS           PIC X.
  5721         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5722         16  AM-NOTIF-OF-REPORTS           PIC X.
  5723         16  AM-NOTIF-OF-STATUS            PIC X.
  5724
  5725     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5726         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5727         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5728         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5729         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5730
  5731     12  AM-BENEFIT-CONTROLS.
  5732         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5733             20  AM-BENEFIT-CODE           PIC XX.
  5734             20  AM-BENEFIT-TYPE           PIC X.
  5735             20  AM-BENEFIT-REVISION       PIC XXX.
  5736             20  AM-BENEFIT-REM-TERM       PIC X.
  5737             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5738             20  FILLER                    PIC XX.
  5739         16  FILLER                        PIC X(80).
  5740
  5741     12  AM-TRANSFER-DATA.
  5742         16  AM-TRANSFERRED-FROM.
  5743             20  AM-TRNFROM-CARRIER        PIC X.
  5744             20  AM-TRNFROM-GROUPING.
  5745                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5746                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5747             20  AM-TRNFROM-STATE          PIC XX.
  5748             20  AM-TRNFROM-ACCOUNT.
  5749                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5750                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5751             20  AM-TRNFROM-DTE            PIC XX.
  5752         16  AM-TRANSFERRED-TO.
  5753             20  AM-TRNTO-CARRIER          PIC X.
  5754             20  AM-TRNTO-GROUPING.
  5755                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5756                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5757             20  AM-TRNTO-STATE            PIC XX.
  5758             20  AM-TRNTO-ACCOUNT.
  5759                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5760                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5761             20  AM-TRNTO-DTE              PIC XX.
  5762         16  FILLER                        PIC X(10).
  5763
  5764     12  AM-SAVED-REMIT-TO                 PIC 99.
  5765
  5766     12  AM-COMM-STRUCTURE-SAVED.
  5767         16  AM-DEFN-1-SAVED.
  5768             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5769                 24  AM-AGT-SV             PIC X(10).
  5770                 24  AM-COM-TYP-SV         PIC X.
  5771                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5772                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5773                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5774                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5775                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 107
* EL130.cbl
  5776                 24  AM-GL-CODES-SV        PIC X.
  5777                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5778                 24  FILLER                PIC X.
  5779         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5780             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5781                 24  FILLER                PIC X(11).
  5782                 24  AM-L-COMA-SV          PIC XXX.
  5783                 24  AM-J-COMA-SV          PIC XXX.
  5784                 24  AM-A-COMA-SV          PIC XXX.
  5785                 24  FILLER                PIC X(6).
  5786
  5787     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5788         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5789            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5790            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5791            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5792
  5793     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5794     12  FILLER                            PIC X(120).
  5795
  5796     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5797         16  AM-CONTROL-NAME               PIC X(30).
  5798         16  AM-EXECUTIVE-ONE.
  5799             20  AM-EXEC1-NAME             PIC X(15).
  5800             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5801                                                          COMP-3.
  5802             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5803                                                          COMP-3.
  5804         16  AM-EXECUTIVE-TWO.
  5805             20  AM-EXEC2-NAME             PIC X(15).
  5806             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5807                                                          COMP-3.
  5808             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5809                                                          COMP-3.
  5810
  5811     12  AM-RETRO-ADDITIONAL-DATA.
  5812         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5813         16  AM-RETRO-PREM-P-E             PIC X.
  5814         16  AM-RETRO-CLMS-P-I             PIC X.
  5815         16  AM-RETRO-RET-BRACKET-LF.
  5816             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5817                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5818                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5819             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5820                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5821                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5822             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5823                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5824                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5825         16  AM-RETRO-RET-BRACKET-AH.
  5826             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5827                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5828                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5829                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5830             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5831                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5832                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5833             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 108
* EL130.cbl
  5834                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5835                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5836
  5837     12  AM-COMMENTS.
  5838         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5839
  5840     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5841         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5842         16  AM-FLI-BILLING-CODE           PIC X.
  5843         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5844         16  AM-FLI-UNITED-IDENT           PIC X.
  5845         16  AM-FLI-INTEREST-LOST-DATA.
  5846             20  AM-FLI-BANK-NO            PIC X(5).
  5847             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5848             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5849             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5850         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5851             20  AM-FLI-AGT                PIC X(9).
  5852             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5853             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5854         16  FILLER                        PIC X(102).
  5855
  5856     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5857         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5858             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5859             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5860             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5861             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5862             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5863         16  FILLER                          PIC X(10).
  5864******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 109
* EL130.cbl
  5866*    COPY ELCTRLR.
  5867******************************************************************
  5868*                                                                *
  5869*                            ELCTRLR.                            *
  5870*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5871*                            VMOD=2.014                          *
  5872*                                                                *
  5873*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5874*                                                                *
  5875*   FILE TYPE = VSAM,KSDS                                        *
  5876*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5877*                                                                *
  5878*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5879*       ALTERNATE INDEX = NONE                                   *
  5880*                                                                *
  5881*   LOG = YES                                                    *
  5882*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5883******************************************************************
  5884*                   C H A N G E   L O G
  5885*
  5886* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5887*-----------------------------------------------------------------
  5888*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5889* EFFECTIVE    NUMBER
  5890*-----------------------------------------------------------------
  5891* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5892* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5893* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5894* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5895* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5896* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5897* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5898* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5899* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5900* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5901* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5902* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5903* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5904* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5905* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5906* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5907* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5908* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5909* 040814    2014030500002  AJRA  ADD ICD CODES
  5910* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5911* 013017  CR2016053100001  PEMA  ACH PROCESSING
  5912* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  5913******************************************************************
  5914 01  ACTIVITY-TRAILERS.
  5915     12  AT-RECORD-ID                    PIC XX.
  5916         88  VALID-AT-ID                       VALUE 'AT'.
  5917
  5918     12  AT-CONTROL-PRIMARY.
  5919         16  AT-COMPANY-CD               PIC X.
  5920         16  AT-CARRIER                  PIC X.
  5921         16  AT-CLAIM-NO                 PIC X(7).
  5922         16  AT-CERT-NO.
  5923             20  AT-CERT-PRIME           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 110
* EL130.cbl
  5924             20  AT-CERT-SFX             PIC X.
  5925         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5926             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5927             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5928             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5929             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5930             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5931             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5932             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5933             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5934             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5935             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5936             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5937             88  AT-BENEFICIARY-TRL           VALUE +91.
  5938             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5939             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5940             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5941             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5942
  5943     12  AT-TRAILER-TYPE                 PIC X.
  5944         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5945         88  PAYMENT-TR                       VALUE '2'.
  5946         88  AUTO-PAY-TR                      VALUE '3'.
  5947         88  CORRESPONDENCE-TR                VALUE '4'.
  5948         88  ADDRESS-TR                       VALUE '5'.
  5949         88  GENERAL-INFO-TR                  VALUE '6'.
  5950         88  AUTO-PROMPT-TR                   VALUE '7'.
  5951         88  DENIAL-TR                        VALUE '8'.
  5952         88  INCURRED-CHG-TR                  VALUE '9'.
  5953         88  FORM-CONTROL-TR                  VALUE 'A'.
  5954
  5955     12  AT-RECORDED-DT                  PIC XX.
  5956     12  AT-RECORDED-BY                  PIC X(4).
  5957     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5958
  5959     12  AT-TRAILER-BODY                 PIC X(165).
  5960
  5961     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5962         16  AT-RESERVE-CONTROLS.
  5963             20  AT-MANUAL-SW            PIC X.
  5964                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5965             20  AT-FUTURE-SW            PIC X.
  5966                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5967             20  AT-PTC-SW               PIC X.
  5968                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5969             20  AT-IBNR-SW              PIC X.
  5970                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5971             20  AT-PTC-LF-SW            PIC X.
  5972                 88  AT-LF-PTC-USED          VALUE '1'.
  5973             20  AT-CDT-ACCESS-METHOD    PIC X.
  5974                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5975                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5976                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5977             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5978         16  AT-LAST-COMPUTED-DT         PIC XX.
  5979         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5980         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5981         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 111
* EL130.cbl
  5982         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5983         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5984         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5985         16  AT-EXPENSE-CONTROLS.
  5986             20  AT-EXPENSE-METHOD       PIC X.
  5987                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5988                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5989                 88  PERCENT-OF-PMT           VALUE '3'.
  5990                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5991             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5992             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5993         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5994         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5995
  5996         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5997         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5998
  5999*        16  FILLER                      PIC X(53).
  6000         16  FILLER                      PIC X(47).
  6001
  6002         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6003         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6004
  6005         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6006             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6007             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6008*                    C = CLOSED
  6009*                    O = OPEN
  6010             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6011*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6012
  6013     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6014         16  AT-PAYMENT-TYPE             PIC X.
  6015             88  PARTIAL-PAYMENT                VALUE '1'.
  6016             88  FINAL-PAYMENT                  VALUE '2'.
  6017             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6018             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6019             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6020             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6021             88  VOIDED-PAYMENT                 VALUE '9'.
  6022             88  TRANSFER                       VALUE 'T'.
  6023             88  LIFE-INTEREST                  VALUE 'I'.
  6024
  6025         16  AT-CLAIM-TYPE               PIC X.
  6026             88  PAID-FOR-AH                    VALUE 'A'.
  6027             88  PAID-FOR-LIFE                  VALUE 'L'.
  6028             88  PAID-FOR-IUI                   VALUE 'I'.
  6029             88  PAID-FOR-GAP                   VALUE 'G'.
  6030             88  PAID-FOR-FAM                   VALUE 'F'.
  6031         16  AT-CLAIM-PREM-TYPE          PIC X.
  6032             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6033             88  AT-O-B-COVERAGE                VALUE '2'.
  6034             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6035         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6036         16  AT-CHECK-NO                 PIC X(7).
  6037         16  AT-PAID-FROM-DT             PIC XX.
  6038         16  AT-PAID-THRU-DT             PIC XX.
  6039         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 112
* EL130.cbl
  6040         16  AT-ACH-PAYMENT              PIC X.
  6041*        16  FILLER                      PIC X.
  6042         16  AT-PAYEES-NAME              PIC X(30).
  6043         16  AT-PAYMENT-ORIGIN           PIC X.
  6044             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6045             88  ONLINE-AUTO-PMT                VALUE '2'.
  6046             88  OFFLINE-PMT                    VALUE '3'.
  6047         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6048         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6049         16  AT-VOID-DATA.
  6050             20  AT-VOID-DT              PIC XX.
  6051*00144       20  AT-VOID-REASON          PIC X(30).
  6052             20  AT-VOID-REASON          PIC X(26).
  6053         16  AT-PMT-APPROVED-BY          PIC X(04).
  6054         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6055         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6056         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6057                                         PIC S99V9(5)  COMP-3.
  6058         16  AT-CREDIT-INTERFACE.
  6059             20  AT-PMT-SELECT-DT        PIC XX.
  6060                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6061             20  AT-PMT-ACCEPT-DT        PIC XX.
  6062                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6063             20  AT-VOID-SELECT-DT       PIC XX.
  6064                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6065             20  AT-VOID-ACCEPT-DT       PIC XX.
  6066                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6067
  6068         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6069                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6070                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6071         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6072
  6073         16  AT-FORCE-CONTROL            PIC X.
  6074             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6075         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6076         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6077         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6078         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6079         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6080         16  AT-BENEFIT-TYPE             PIC X.
  6081
  6082         16  AT-EXPENSE-TYPE             PIC X.
  6083         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6084
  6085         16  AT-PAYEE-TYPE-CD.
  6086             20  AT-PAYEE-TYPE           PIC X.
  6087                 88  INSURED-PAID           VALUE 'I'.
  6088                 88  BENEFICIARY-PAID       VALUE 'B'.
  6089                 88  ACCOUNT-PAID           VALUE 'A'.
  6090                 88  OTHER-1-PAID           VALUE 'O'.
  6091                 88  OTHER-2-PAID           VALUE 'Q'.
  6092                 88  DOCTOR-PAID            VALUE 'P'.
  6093                 88  EMPLOYER-PAID          VALUE 'E'.
  6094             20  AT-PAYEE-SEQ            PIC X.
  6095
  6096         16  AT-CASH-PAYMENT             PIC X.
  6097         16  AT-GROUPED-PAYMENT          PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 113
* EL130.cbl
  6098         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6099         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6100         16  AT-APPROVED-LEVEL           PIC X.
  6101         16  AT-VOID-TYPE                PIC X.
  6102             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6103             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6104         16  AT-AIG-UNEMP-IND            PIC X.
  6105             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6106         16  AT-ASSOCIATES               PIC X.
  6107             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6108             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6109
  6110         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6111         16  AT-CV-PMT-CODE              PIC X.
  6112             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6113             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6114             88  FULL-ADD-PAYMENT           VALUE '3'.
  6115             88  HALF-ADD-PAYMENT           VALUE '4'.
  6116             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6117             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6118             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6119             88  ADDL-PAYMENT               VALUE '8'.
  6120
  6121         16  AT-EOB-CODE1                PIC XXX.
  6122         16  AT-EOB-CODE2                PIC XXX.
  6123         16  AT-EOB-CODE3                PIC XXX.
  6124         16  FILLER REDEFINES AT-EOB-CODE3.
  6125             20  AT-PRINT-CLM-FORM       PIC X.
  6126             20  AT-PRINT-SURVEY         PIC X.
  6127             20  AT-SPECIAL-RELEASE      PIC X.
  6128         16  AT-EOB-CODE4                PIC XXX.
  6129         16  FILLER REDEFINES AT-EOB-CODE4.
  6130             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6131             20  FILLER                  PIC X.
  6132         16  AT-EOB-CODE5                PIC XXX.
  6133         16  FILLER REDEFINES AT-EOB-CODE5.
  6134             20  AT-PMT-PROOF-DT         PIC XX.
  6135             20  FILLER                  PIC X.
  6136
  6137         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6138             88  AT-PRINT-EOB            VALUE 'Y'.
  6139
  6140         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6141         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6142
  6143     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6144         16  AT-SCHEDULE-START-DT        PIC XX.
  6145         16  AT-SCHEDULE-END-DT          PIC XX.
  6146         16  AT-TERMINATED-DT            PIC XX.
  6147         16  AT-LAST-PMT-TYPE            PIC X.
  6148             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6149             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6150         16  AT-FIRST-PMT-DATA.
  6151             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6152             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6153             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6154         16  AT-REGULAR-PMT-DATA.
  6155             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 114
* EL130.cbl
  6156             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6157             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6158         16  AT-AUTO-PAYEE-CD.
  6159             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6160                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6161                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6162                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6163                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6164                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6165             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6166         16  AT-AUTO-PAY-DAY             PIC 99.
  6167         16  AT-AUTO-CASH                PIC X.
  6168             88  AT-CASH                      VALUE 'Y'.
  6169             88  AT-NON-CASH                  VALUE 'N'.
  6170*        16  FILLER                      PIC X(129).
  6171         16  AT-AUTO-END-LETTER          PIC X(4).
  6172         16  FILLER                      PIC X(125).
  6173
  6174         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6175         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6176
  6177     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6178         16  AT-LETTER-SENT-DT           PIC XX.
  6179         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6180         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6181         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6182         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6183         16  AT-LETTER-ORIGIN            PIC X.
  6184             88  ONLINE-CREATION              VALUE '1' '3'.
  6185             88  OFFLINE-CREATION             VALUE '2' '4'.
  6186             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6187             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6188         16  AT-STD-LETTER-FORM          PIC X(4).
  6189         16  AT-REASON-TEXT              PIC X(70).
  6190         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6191         16  AT-ADDRESEE-TYPE            PIC X.
  6192              88  INSURED-ADDRESEE            VALUE 'I'.
  6193              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6194              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6195              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6196              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6197              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6198              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6199         16  AT-ADDRESSEE-NAME           PIC X(30).
  6200         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6201         16  AT-RESEND-PRINT-DATE        PIC XX.
  6202         16  AT-CORR-SOL-UNSOL           PIC X.
  6203         16  AT-LETTER-PURGED-DT         PIC XX.
  6204*
  6205*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6206*
  6207         16  AT-CSO-REDEFINITION.
  6208             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6209             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6210             20  AT-LETTER-TO-BENE       PIC X(1).
  6211             20  AT-STOP-LETTER-DT       PIC X(2).
  6212             20  AT-AUTH-RCVD            PIC X(1).
  6213             20  FILLER                  PIC X(18).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 115
* EL130.cbl
  6214*             20  FILLER                  PIC X(27).
  6215             20  AT-CSO-LETTER-STATUS    PIC X.
  6216                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6217                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6218                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6219             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6220             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6221*
  6222*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6223*
  6224*        16  FILLER                      PIC X(26).
  6225*
  6226*        16  AT-DMD-BSR-CODE             PIC X.
  6227*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6228*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6229*
  6230*        16  AT-DMD-LETTER-STATUS        PIC X.
  6231*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6232*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6233*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6234*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6235*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6236
  6237         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6238         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6239
  6240     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6241         16  AT-ADDRESS-TYPE             PIC X.
  6242             88  INSURED-ADDRESS               VALUE 'I'.
  6243             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6244             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6245             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6246             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6247             88  OTHER-ADDRESS-1               VALUE 'O'.
  6248             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6249         16  AT-MAIL-TO-NAME             PIC X(30).
  6250         16  AT-ADDRESS-LINE-1           PIC X(30).
  6251         16  AT-ADDRESS-LINE-2           PIC X(30).
  6252         16  AT-CITY-STATE.
  6253             20  AT-CITY                 PIC X(28).
  6254             20  AT-STATE                PIC XX.
  6255         16  AT-ZIP.
  6256             20  AT-ZIP-CODE.
  6257                 24  AT-ZIP-1ST          PIC X.
  6258                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6259                 24  FILLER              PIC X(4).
  6260             20  AT-ZIP-PLUS4            PIC X(4).
  6261         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6262             20  AT-CAN-POSTAL-1         PIC XXX.
  6263             20  AT-CAN-POSTAL-2         PIC XXX.
  6264             20  FILLER                  PIC XXX.
  6265         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6266*         16  FILLER                      PIC X(23).
  6267         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6268         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6269         16  FILLER                      PIC X(13).
  6270         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6271         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 116
* EL130.cbl
  6272
  6273     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6274         16  AT-INFO-LINE-1              PIC X(60).
  6275         16  FILLER REDEFINES AT-INFO-LINE-1.
  6276             20  AT-NOTE-ERROR-NO OCCURS 15
  6277                                         PIC X(4).
  6278         16  AT-INFO-LINE-2              PIC X(60).
  6279         16  FILLER REDEFINES AT-INFO-LINE-2.
  6280             20  AT-ICD-CODE-1           PIC X(8).
  6281             20  AT-ICD-CODE-2           PIC X(8).
  6282             20  FILLER                  PIC X(44).
  6283         16  AT-INFO-TRAILER-TYPE        PIC X.
  6284             88  AT-ERRORS-NOTE          VALUE 'E'.
  6285             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6286             88  AT-CALL-NOTE            VALUE 'C'.
  6287             88  AT-MAINT-NOTE           VALUE 'M'.
  6288             88  AT-CERT-CHANGE          VALUE 'X'.
  6289             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6290             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6291             88  AT-CERT-CANCELLED       VALUE 'T'.
  6292         16  AT-CALL-TYPE                PIC X.
  6293             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6294             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6295         16  AT-NOTE-CONTINUATION        PIC X.
  6296             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6297         16  AT-EOB-CODES-EXIST          PIC X.
  6298             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6299         16  FILLER                      PIC X(35).
  6300         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6301         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6302
  6303     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6304         16  AT-PROMPT-LINE-1            PIC X(60).
  6305         16  AT-PROMPT-LINE-2            PIC X(60).
  6306         16  AT-PROMPT-START-DT          PIC XX.
  6307         16  AT-PROMPT-END-DT            PIC XX.
  6308         16  FILLER                      PIC X(35).
  6309         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6310         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6311
  6312     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6313         16  AT-DENIAL-INFO-1            PIC X(60).
  6314         16  AT-DENIAL-INFO-2            PIC X(60).
  6315         16  AT-DENIAL-DT                PIC XX.
  6316         16  AT-RETRACTION-DT            PIC XX.
  6317         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6318*         16  FILLER                      PIC X(31).
  6319         16  AT-DENIAL-PROOF-DT          PIC XX.
  6320         16  FILLER                      PIC X(29).
  6321         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6322         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6323
  6324     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6325         16  AT-OLD-INCURRED-DT          PIC XX.
  6326         16  AT-OLD-REPORTED-DT          PIC XX.
  6327         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6328         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6329         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 117
* EL130.cbl
  6330         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6331         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6332         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6333         16  FILLER                      PIC X(26).
  6334         16  AT-OLD-DIAG-CODE            PIC X(6).
  6335         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6336         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6337         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6338         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6339         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6340         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6341         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6342         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6343         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6344         16  FILLER                      PIC X(9).
  6345         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6346
  6347     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6348         16  AT-FORM-SEND-ON-DT          PIC XX.
  6349         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6350         16  AT-FORM-RE-SEND-DT          PIC XX.
  6351         16  AT-FORM-ANSWERED-DT         PIC XX.
  6352         16  AT-FORM-PRINTED-DT          PIC XX.
  6353         16  AT-FORM-REPRINT-DT          PIC XX.
  6354         16  AT-FORM-TYPE                PIC X.
  6355             88  INITIAL-FORM                  VALUE '1'.
  6356             88  PROGRESS-FORM                 VALUE '2'.
  6357         16  AT-INSTRUCT-LN-1            PIC X(28).
  6358         16  AT-INSTRUCT-LN-2            PIC X(28).
  6359         16  AT-INSTRUCT-LN-3            PIC X(28).
  6360         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6361         16  AT-FORM-ADDRESS             PIC X.
  6362             88  FORM-TO-INSURED              VALUE 'I'.
  6363             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6364             88  FORM-TO-OTHER-1              VALUE 'O'.
  6365             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6366         16  AT-RELATED-1.
  6367             20 AT-REL-CARR-1            PIC X.
  6368             20 AT-REL-CLAIM-1           PIC X(7).
  6369             20 AT-REL-CERT-1            PIC X(11).
  6370         16  AT-RELATED-2.
  6371             20 AT-REL-CARR-2            PIC X.
  6372             20 AT-REL-CLAIM-2           PIC X(7).
  6373             20 AT-REL-CERT-2            PIC X(11).
  6374         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6375         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6376         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6377         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6378         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6379         16  AT-STOP-FORM-DT             PIC X(2).
  6380
  6381         16  FILLER                      PIC X(09).
  6382         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6383         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6384******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 118
* EL130.cbl
  6386*    COPY ELCBENE.
  6387******************************************************************
  6388*                                                                *
  6389*                            ELCBENE.                            *
  6390*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6391*                            VMOD=2.006                          *
  6392*                                                                *
  6393*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6394*                                                                *
  6395*   FILE TYPE = VSAM,KSDS                                        *
  6396*   RECORD SIZE = 500   RECFORM = FIX                            *
  6397*                                                                *
  6398*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6399*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6400*                                                                *
  6401*   LOG = YES                                                    *
  6402*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6403*                                                                *
  6404*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6405******************************************************************
  6406*                   C H A N G E   L O G
  6407*
  6408* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6409*-----------------------------------------------------------------
  6410*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6411* EFFECTIVE    NUMBER
  6412*-----------------------------------------------------------------
  6413* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6414* 082317  CR2017082100003  PEMA  Add sub type
  6415******************************************************************
  6416
  6417 01  BENEFICIARY-MASTER.
  6418     12  BE-RECORD-ID                PIC XX.
  6419         88  VALID-BE-ID                VALUE 'BE'.
  6420
  6421     12  BE-CONTROL-PRIMARY.
  6422         16  BE-COMPANY-CD           PIC X.
  6423         16  BE-RECORD-TYPE          PIC X.
  6424             88  BENEFICIARY-RECORD  VALUE 'B'.
  6425             88  ADJUSTOR-RECORD     VALUE 'A'.
  6426         16  BE-BENEFICIARY          PIC X(10).
  6427     12  BE-CONTROL-BY-NAME.
  6428         16  BE-COMPANY-CD-A1        PIC X.
  6429         16  BE-RECORD-TYPE-A1       PIC X.
  6430         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6431         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6432
  6433     12  BE-LAST-MAINT-DT            PIC XX.
  6434     12  BE-LAST-MAINT-BY            PIC X(4).
  6435     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6436
  6437     12  BE-ADDRESS-DATA.
  6438         16  BE-MAIL-TO-NAME         PIC X(30).
  6439         16  BE-ADDRESS-LINE-1       PIC X(30).
  6440         16  BE-ADDRESS-LINE-2       PIC X(30).
  6441         16  BE-ADDRESS-LINE-3       PIC X(30).
  6442         16  BE-CITY-STATE.
  6443             20  BE-CITY             PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 119
* EL130.cbl
  6444             20  BE-STATE            PIC XX.
  6445         16  BE-ZIP-CODE.
  6446             20  BE-ZIP-PRIME.
  6447                 24  BE-ZIP-1ST      PIC X.
  6448                     88  BE-CANADIAN-POST-CODE
  6449                                         VALUE 'A' THRU 'Z'.
  6450                 24  FILLER          PIC X(4).
  6451             20  BE-ZIP-PLUS4        PIC X(4).
  6452         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6453             20  BE-CAN-POSTAL-1     PIC XXX.
  6454             20  BE-CAN-POSTAL-2     PIC XXX.
  6455             20  FILLER              PIC XXX.
  6456         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6457         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6458
  6459******************************************************************
  6460*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6461*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6462******************************************************************
  6463     12  BE-CARRIER                  PIC X.
  6464
  6465     12  BE-ADDRESS-DATA2.
  6466         16  BE-MAIL-TO-NAME2        PIC X(30).
  6467         16  BE-ADDRESS-LINE-12      PIC X(30).
  6468         16  BE-ADDRESS-LINE-22      PIC X(30).
  6469         16  BE-ADDRESS-LINE-32      PIC X(30).
  6470         16  BE-CITY-STATE2.
  6471             20  BE-CITY2            PIC X(28).
  6472             20  BE-STATE2           PIC XX.
  6473         16  BE-ZIP-CODE2.
  6474             20  BE-ZIP-PRIME2.
  6475                 24  BE-ZIP-1ST2     PIC X.
  6476                     88  BE-CANADIAN-POST-CODE2
  6477                                         VALUE 'A' THRU 'Z'.
  6478                 24  FILLER          PIC X(4).
  6479             20  BE-ZIP-PLUS42       PIC X(4).
  6480         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6481             20  BE-CAN-POSTAL-12    PIC XXX.
  6482             20  BE-CAN-POSTAL-22    PIC XXX.
  6483             20  FILLER              PIC XXX.
  6484         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6485         16  BE-ACH-DATA.
  6486             20  BE-ACH-YES-OR-NO    PIC X.
  6487                 88  BE-ON-ACH       VALUE 'Y'.
  6488                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  6489             20  BE-ACH-ABA-ROUTING-NUMBER
  6490                                     PIC X(15).
  6491             20  BE-ACH-BANK-ACCOUNT-NUMBER
  6492                                     PIC X(20).
  6493             20  BE-ACH-SUB-TYPE     PIC XX.
  6494             20  FILLER              PIC X(23).
  6495         16  BE-BILLING-STMT-DATA.
  6496*            20  BE-BSR              PIC X.
  6497*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  6498*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6499*            20  BE-BSR-FROM         PIC X(30).
  6500*            20  BE-BSR-DEPT         PIC X(30).
  6501             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 120
* EL130.cbl
  6502             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6503             20  BE-OUTPUT-TYPE      PIC X.
  6504                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6505                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6506
  6507     12  FILLER                      PIC X(28).
  6508******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 121
* EL130.cbl
  6510*    COPY ELCDAR.
  6511******************************************************************
  6512*                                                                *
  6513*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6514*   FILE TYPE = VSAM,KSDS                                        *
  6515*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6516*   BASE CLUSTER = DLYACTV                                       *
  6517*   LOG = YES                                                    *
  6518*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6519*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6520*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6521*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6522*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6523*               BY PROGRAM "LGINFCE".                            *
  6524*                                                                *
  6525******************************************************************
  6526 01  DAILY-ACTIVITY-RECORD.
  6527     05  DA-KEY.
  6528         10  DA-COMP-CD          PIC X.
  6529         10  DA-CARRIER          PIC X.
  6530         10  DA-CLAIM-NO         PIC X(7).
  6531         10  DA-CERT-NO.
  6532             15  DA-CERT-PRIME   PIC X(10).
  6533             15  DA-CERT-SFX     PIC X.
  6534     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6535     05  DA-RECORD-TYPE          PIC X.
  6536     05  FILLER                  PIC X(2).
  6537******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 122
* EL130.cbl
  6539*    COPY ELCACTQ.
  6540******************************************************************
  6541*                                                                *
  6542*                            ELCACTQ.                            *
  6543*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6544*                            VMOD=2.004                          *
  6545*                                                                *
  6546*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6547*                                                                *
  6548*   FILE TYPE = VSAM,KSDS                                        *
  6549*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6550*                                                                *
  6551*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6552*       ALTERNATE INDEX = NONE                                   *
  6553*                                                                *
  6554*   LOG = YES                                                    *
  6555*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6556*                                                                *
  6557*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6558******************************************************************
  6559
  6560 01  ACTIVITY-QUE.
  6561     12  AQ-RECORD-ID                PIC XX.
  6562         88  VALID-AQ-ID                VALUE 'AQ'.
  6563
  6564     12  AQ-CONTROL-PRIMARY.
  6565         16  AQ-COMPANY-CD           PIC X.
  6566         16  AQ-CARRIER              PIC X.
  6567         16  AQ-CLAIM-NO             PIC X(7).
  6568         16  AQ-CERT-NO.
  6569             20  AQ-CERT-PRIME       PIC X(10).
  6570             20  AQ-CERT-SFX         PIC X.
  6571
  6572     12  AQ-PENDING-ACTIVITY-FLAGS.
  6573         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6574         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6575             88  PENDING-PAYMENTS       VALUE '1'.
  6576         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6577             88  PENDING-FULL-PRINT     VALUE '1'.
  6578             88  PENDING-PART-PRINT     VALUE '2'.
  6579         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6580             88  PENDING-LETTERS        VALUE '1'.
  6581         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6582             88  PENDING-RESTORE        VALUE 'C'.
  6583             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6584
  6585     12  FILLER                      PIC X(20).
  6586
  6587     12  AQ-RESEND-DATE              PIC XX.
  6588     12  AQ-FOLLOWUP-DATE            PIC XX.
  6589     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6590     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6591     12  AQ-AUTO-LETTER              PIC X(4).
  6592     12  FILLER                      PIC XX.
  6593     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6594*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 123
* EL130.cbl
  6596*    COPY ELCARCH.
  6597******************************************************************
  6598*                                                                *
  6599*                            ELCARCH.                            *
  6600*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6601*                            VMOD=2.007                          *
  6602*                                                                *
  6603*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6604*                                                                *
  6605*   FILE TYPE = VSAM,KSDS                                        *
  6606*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6607*                                                                *
  6608*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6609*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6610*                                                                *
  6611*   LOG = NO                                                     *
  6612*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6613*                                                                *
  6614*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6615******************************************************************
  6616 01  LETTER-ARCHIVE.
  6617     12  LA-RECORD-ID                PIC XX.
  6618         88  VALID-LA-ID                VALUE 'LA'.
  6619
  6620     12  LA-CONTROL-PRIMARY.
  6621         16  LA-COMPANY-CD           PIC X.
  6622         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6623         16  LA-RECORD-TYPE          PIC X.
  6624             88  LA-HEADER-DATA         VALUE '1'.
  6625             88  LA-ADDRESS-DATA        VALUE '2'.
  6626             88  LA-TEXT-DATA           VALUE '3'.
  6627             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6628         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6629
  6630     12  LA-CONTROL-BY-TYPE.
  6631         16  LA-COMPANY-CD-A1        PIC X.
  6632         16  LA-RECORD-TYPE-A1       PIC X.
  6633         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6634         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6635
  6636     12  LA-TEXT-RECORD.
  6637         16  LA-SKIP-CONTROL         PIC XX.
  6638             88  NO-LINES-SKIPPED       VALUE SPACES.
  6639             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6640         16  LA-TEXT-LINE            PIC X(70).
  6641
  6642     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6643         16  FILLER                  PIC XX.
  6644         16  LA-ADDRESS-LINE         PIC X(30).
  6645         16  FILLER                  PIC X(40).
  6646
  6647     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6648         16  FILLER                  PIC XX.
  6649         16  LA-CARRIER              PIC X.
  6650         16  LA-CLAIM-NO             PIC X(7).
  6651         16  LA-CERT-NO.
  6652             20  LA-CERT-PRIME       PIC X(10).
  6653             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 124
* EL130.cbl
  6654         16  LA-NO-OF-COPIES         PIC S9.
  6655         16  LA-RESEND-DATE          PIC XX.
  6656         16  LA-PROCESSOR-CD         PIC X(4).
  6657         16  LA-CREATION-DT          PIC XX.
  6658         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6659         16  LA-RESEND-PRINT-DATE    PIC XX.
  6660         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6661         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6662*
  6663* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6664*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6665*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6666*   I        20  LA-DMD-RES-ST           PIC XX.
  6667*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6668*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6669*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6670*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6671*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6672*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6673*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6674*   I        20  LA-DMD-UND-CODE         PIC XX.
  6675*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6676*   V    16  FILLER                  PIC X(15).
  6677* -----
  6678*
  6679* REINSERTED  CSO  MODS
  6680*
  6681         16  FILLER.
  6682             20  FILLER                  PIC X(29).
  6683             20  LA-CSO-LETTER-STATUS    PIC X.
  6684                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6685                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6686                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6687             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6688             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6689*
  6690
  6691     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6692         16  FILLER                  PIC XX.
  6693         16  LA4-CARRIER             PIC X.
  6694         16  LA4-CLAIM-NO            PIC X(7).
  6695         16  LA4-CERT-NO.
  6696             20  LA4-CERT-PRIME      PIC X(10).
  6697             20  LA4-CERT-SFX        PIC X.
  6698         16  LA4-NO-OF-COPIES        PIC S9.
  6699         16  LA4-RESEND-DATE         PIC XX.
  6700         16  LA4-PROCESSOR-CD        PIC X(4).
  6701         16  LA4-CREATION-DT         PIC XX.
  6702         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6703         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6704         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6705         16  LA4-FORM-TYPE           PIC X.
  6706             88  LA4-INITIAL-FORM    VALUE '1'.
  6707             88  LA4-PROGRESS-FORM   VALUE '2'.
  6708         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6709         16  LA4-STATE               PIC X(02).
  6710         16  FILLER                  PIC X(31).
  6711******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 125
* EL130.cbl
  6713*    COPY ERCREIN.
  6714******************************************************************
  6715*                                                                *
  6716*                            ERCREIN                             *
  6717*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6718*                            VMOD=2.010                          *
  6719*                                                                *
  6720*   ONLINE CREDIT SYSTEM                                         *
  6721*                                                                *
  6722*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6723*                                                                *
  6724*   FILE TYPE = VSAM,KSDS                                        *
  6725*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6726*                                                                *
  6727*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6728*       ALTERNATE PATH = NONE                                    *
  6729*                                                                *
  6730*   LOG = NO                                                     *
  6731*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6732*                                                                *
  6733******************************************************************
  6734*                   C H A N G E   L O G
  6735*
  6736* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6737*-----------------------------------------------------------------
  6738*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6739* EFFECTIVE    NUMBER
  6740*-----------------------------------------------------------------
  6741* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6742* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6743******************************************************************
  6744 01  REINSURANCE-RECORD.
  6745     12  RE-RECORD-ID                      PIC XX.
  6746         88  VALID-RE-ID                      VALUE 'RE'.
  6747
  6748     12  RE-CONTROL-PRIMARY.
  6749         16  RE-COMPANY-CD                 PIC X.
  6750         16  RE-KEY.
  6751             20  RE-CODE                   PIC X.
  6752                 88  RE-TABLE-RECORD          VALUE 'A'.
  6753                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6754             20  RE-TABLE                  PIC XXX.
  6755             20  FILLER                    PIC XXX.
  6756         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6757             20  FILLER                    PIC X.
  6758             20  RE-COMPANY.
  6759                 24  RE-COMP-PRIME         PIC XXX.
  6760                 24  RE-COMP-SUB           PIC XXX.
  6761
  6762     12  RE-MAINT-INFORMATION.
  6763         16  RE-LAST-MAINT-DT              PIC XX.
  6764         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6765         16  RE-LAST-MAINT-USER            PIC X(4).
  6766         16  FILLER                        PIC X(10).
  6767
  6768     12  RE-TABLE-DATA.
  6769         16  RE-100-COMP                   PIC 99.
  6770
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 126
* EL130.cbl
  6771         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6772             20  RE-REI-COMP-NO.
  6773                 24  RE-REI-COMP           PIC XXX.
  6774                 24  RE-REI-COMP-SUB       PIC XXX.
  6775             20  RE-LF-QC                  PIC X.
  6776             20  RE-AH-QC                  PIC X.
  6777             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6778             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6779             20  RE-LFAGE-LO               PIC 99.
  6780             20  RE-LFAGE-HI               PIC 99.
  6781             20  RE-AHAGE-LO               PIC 99.
  6782             20  RE-AHAGE-HI               PIC 99.
  6783             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6784             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6785             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6786             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6787             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6788             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6789             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6790             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6791             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6792             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6793             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6794             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6795             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6796             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6797             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6798             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6799             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6800             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6801             20  RE-LF-BEN-CODE            PIC X.
  6802             20  RE-AH-BEN-CODE            PIC X.
  6803             20  RE-INTERACTIVE            PIC X.
  6804             20  RE-REMAINING              PIC X.
  6805             20  RE-LF-RUNOFF-SW           PIC X.
  6806             20  RE-AH-RUNOFF-SW           PIC X.
  6807             20  FILLER                    PIC X(19).
  6808
  6809         16  RE-COMP-INFO-END              PIC X(6).
  6810         16  RE-NSP-ST-CD-LF               PIC XX.
  6811         16  RE-NSP-ST-CD-AH               PIC XX.
  6812         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6813             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6814
  6815         16  FILLER                        PIC X(27).
  6816
  6817     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6818         16  RE-NAME                       PIC X(30).
  6819         16  RE-LF-PE                      PIC X.
  6820         16  RE-AH-PE                      PIC X.
  6821         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6822         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6823         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6824         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6825         16  RE-PRT-ST                     PIC X.
  6826         16  RE-PRT-OW                     PIC X.
  6827         16  RE-MORT-CODE                  PIC X(4).
  6828         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 127
* EL130.cbl
  6829         16  RE-ZERO-LF-FEE                PIC X.
  6830         16  RE-ZERO-AH-FEE                PIC X.
  6831         16  RE-CEDE-NAME                  PIC X(30).
  6832         16  RE-LF-COMM                    PIC X.
  6833         16  RE-AH-COMM                    PIC X.
  6834         16  RE-LF-TAX                     PIC X.
  6835         16  RE-AH-TAX                     PIC X.
  6836         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6837         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6838         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6839
  6840         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6841             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6842
  6843         16  RE-LF-CEDING-FEE-BRACKETS.
  6844             20  RE-LF-FEE-METHOD          PIC X.
  6845                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6846                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6847                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6848                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6849             20  RE-LF-FEE-BASIS           PIC X.
  6850                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6851                 88  RE-LF-NET-CEDED               VALUE '2'.
  6852                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6853                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6854                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6855                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6856                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6857                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6858             20  FILLER                    PIC XXX.
  6859             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6860                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6861                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6862
  6863         16  RE-AH-CEDING-FEE-BRACKETS.
  6864             20  RE-AH-FEE-METHOD          PIC X.
  6865                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6866                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6867                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6868                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6869             20  RE-AH-FEE-BASIS           PIC X.
  6870                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6871                 88  RE-AH-NET-CEDED               VALUE '2'.
  6872                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6873                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6874                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6875                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6876                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6877                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6878             20  FILLER                    PIC XXX.
  6879             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6880                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6881                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6882
  6883         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6884
  6885         16  RE-OLD-CEDING-STMT            PIC X.
  6886
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 128
* EL130.cbl
  6887         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6888         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6889         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6890         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6891         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6892         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6893         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6894         16  RE-MORT-SW                    PIC X.
  6895         16  RE-CEDING-TYPE-FLAG           PIC X.
  6896             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6897             88  RE-CEDED                          VALUE 'C'.
  6898             88  RE-ASSUMED                        VALUE 'A'.
  6899             88  RE-PHANTOM                        VALUE 'P'.
  6900
  6901         16  RE-CEDING-STMT-OPT-A          PIC X.
  6902             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6903         16  RE-CEDING-STMT-OPT-B          PIC X.
  6904             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6905         16  RE-CEDING-STMT-OPT-C          PIC X.
  6906             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6907         16  RE-CEDING-STMT-OPT-D          PIC X.
  6908             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6909         16  RE-CEDING-STMT-OPT-E          PIC X.
  6910             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6911
  6912         16  RE-PRT-CRSV                   PIC X.
  6913
  6914         16  RE-GL-CENTER                  PIC X(4).
  6915
  6916         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6917
  6918         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6919
  6920         16  RE-EARN-STOP-CODE             PIC X.
  6921             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6922             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6923
  6924         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6925             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6926
  6927         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6928         16  FILLER                        PIC X(2281).
  6929
  6930         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6931
  6932******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 129
* EL130.cbl
  6934*    COPY ERCMAIL.
  6935******************************************************************
  6936*                                                                *
  6937*                                                                *
  6938*                            ERCMAIL                             *
  6939*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6940*                            VMOD=2.003                          *
  6941*                                                                *
  6942*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6943*                                                                *
  6944*   FILE TYPE = VSAM,KSDS                                        *
  6945*   RECORD SIZE = 374   RECFORM = FIX                            *
  6946*                                                                *
  6947*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6948*   ALTERNATE PATH    = NOT USED                                 *
  6949*                                                                *
  6950*   LOG = YES                                                    *
  6951*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6952******************************************************************
  6953*                   C H A N G E   L O G
  6954*
  6955* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6956*-----------------------------------------------------------------
  6957*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6958* EFFECTIVE    NUMBER
  6959*-----------------------------------------------------------------
  6960* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6961* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6962* 111108                   PEMA  ADD CRED BENE ADDR2
  6963******************************************************************
  6964
  6965 01  MAILING-DATA.
  6966     12  MA-RECORD-ID                      PIC XX.
  6967         88  VALID-MA-ID                       VALUE 'MA'.
  6968
  6969     12  MA-CONTROL-PRIMARY.
  6970         16  MA-COMPANY-CD                 PIC X.
  6971         16  MA-CARRIER                    PIC X.
  6972         16  MA-GROUPING.
  6973             20  MA-GROUPING-PREFIX        PIC XXX.
  6974             20  MA-GROUPING-PRIME         PIC XXX.
  6975         16  MA-STATE                      PIC XX.
  6976         16  MA-ACCOUNT.
  6977             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6978             20  MA-ACCOUNT-PRIME          PIC X(6).
  6979         16  MA-CERT-EFF-DT                PIC XX.
  6980         16  MA-CERT-NO.
  6981             20  MA-CERT-PRIME             PIC X(10).
  6982             20  MA-CERT-SFX               PIC X.
  6983
  6984     12  FILLER                            PIC XX.
  6985
  6986     12  MA-ACCESS-CONTROL.
  6987         16  MA-SOURCE-SYSTEM              PIC XX.
  6988             88  MA-FROM-CREDIT                VALUE 'CR'.
  6989             88  MA-FROM-VSI                   VALUE 'VS'.
  6990             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6991             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 130
* EL130.cbl
  6992         16  MA-RECORD-ADD-DT              PIC XX.
  6993         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6994         16  MA-LAST-MAINT-DT              PIC XX.
  6995         16  MA-LAST-MAINT-BY              PIC XXXX.
  6996         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6997
  6998     12  MA-PROFILE-INFO.
  6999         16  MA-QUALIFY-CODE-1             PIC XX.
  7000         16  MA-QUALIFY-CODE-2             PIC XX.
  7001         16  MA-QUALIFY-CODE-3             PIC XX.
  7002         16  MA-QUALIFY-CODE-4             PIC XX.
  7003         16  MA-QUALIFY-CODE-5             PIC XX.
  7004
  7005         16  MA-INSURED-LAST-NAME          PIC X(15).
  7006         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7007         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7008         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7009         16  MA-INSURED-BIRTH-DT           PIC XX.
  7010         16  MA-INSURED-SEX                PIC X.
  7011             88  MA-SEX-MALE                   VALUE 'M'.
  7012             88  MA-SEX-FEMALE                 VALUE 'F'.
  7013         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7014
  7015         16  MA-ADDRESS-CORRECTED          PIC X.
  7016         16  MA-JOINT-BIRTH-DT             PIC XX.
  7017*        16  FILLER                        PIC X(12).
  7018
  7019         16  MA-ADDRESS-LINE-1             PIC X(30).
  7020         16  MA-ADDRESS-LINE-2             PIC X(30).
  7021         16  MA-CITY-STATE.
  7022             20  MA-CITY                   PIC X(28).
  7023             20  MA-ADDR-STATE             PIC XX.
  7024         16  MA-ZIP.
  7025             20  MA-ZIP-CODE.
  7026                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7027                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7028                 24  FILLER                PIC X(4).
  7029             20  MA-ZIP-PLUS4              PIC X(4).
  7030         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7031             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7032             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7033             20  FILLER                    PIC X(3).
  7034
  7035         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7036
  7037         16  FILLER                        PIC XXX.
  7038*        16  FILLER                        PIC X(10).
  7039
  7040     12  MA-CRED-BENE-INFO.
  7041         16  MA-CRED-BENE-NAME                 PIC X(25).
  7042         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7043         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7044         16  MA-CRED-BENE-CTYST.
  7045             20  MA-CRED-BENE-CITY             PIC X(28).
  7046             20  MA-CRED-BENE-STATE            PIC XX.
  7047         16  MA-CRED-BENE-ZIP.
  7048             20  MA-CB-ZIP-CODE.
  7049                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 131
* EL130.cbl
  7050                     88  MA-CB-CANADIAN-POST-CODE
  7051                                           VALUE 'A' THRU 'Z'.
  7052                 24  FILLER                    PIC X(4).
  7053             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7054         16  MA-CB-CANADIAN-POSTAL-CODE
  7055                            REDEFINES MA-CRED-BENE-ZIP.
  7056             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7057             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7058             20  FILLER                        PIC X(3).
  7059     12  MA-POST-CARD-MAIL-DATA.
  7060         16  MA-MAIL-DATA OCCURS 7.
  7061             20  MA-MAIL-TYPE              PIC X.
  7062                 88  MA-12MO-MAILING           VALUE '1'.
  7063                 88  MA-EXP-MAILING            VALUE '2'.
  7064             20  MA-MAIL-STATUS            PIC X.
  7065                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7066                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7067                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7068             20  MA-MAIL-DATE              PIC XX.
  7069     12  FILLER                            PIC XX.
  7070     12  FILLER                            PIC XX.
  7071*    12  FILLER                            PIC X(30).
  7072******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 132
* EL130.cbl
  7074*    COPY ELCCRTT.
  7075******************************************************************
  7076*                                                                *
  7077*                            ELCCRTT.                            *
  7078*                                                                *
  7079*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7080*                                                                *
  7081*   FILE TYPE = VSAM,KSDS                                        *
  7082*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7083*                                                                *
  7084*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7085*                                                                *
  7086*   LOG = YES                                                    *
  7087*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7088******************************************************************
  7089*                   C H A N G E   L O G
  7090*
  7091* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7092*-----------------------------------------------------------------
  7093*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7094* EFFECTIVE    NUMBER
  7095*-----------------------------------------------------------------
  7096* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7097* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7098* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7099* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7100* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7101* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7102* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7103* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7104* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  7105******************************************************************
  7106
  7107 01  CERTIFICATE-TRAILERS.
  7108     12  CS-RECORD-ID                      PIC XX.
  7109         88  VALID-CS-ID                      VALUE 'CS'.
  7110
  7111     12  CS-CONTROL-PRIMARY.
  7112         16  CS-COMPANY-CD                 PIC X.
  7113         16  CS-CARRIER                    PIC X.
  7114         16  CS-GROUPING                   PIC X(6).
  7115         16  CS-STATE                      PIC XX.
  7116         16  CS-ACCOUNT                    PIC X(10).
  7117         16  CS-CERT-EFF-DT                PIC XX.
  7118         16  CS-CERT-NO.
  7119             20  CS-CERT-PRIME             PIC X(10).
  7120             20  CS-CERT-SFX               PIC X.
  7121         16  CS-TRAILER-TYPE               PIC X.
  7122             88  COMM-TRLR           VALUE 'A'.
  7123             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7124             88  CERT-DATA-TRLR      VALUE 'C'.
  7125
  7126     12  CS-DATA-AREA                      PIC X(516).
  7127
  7128     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7129         16  CS-BANK-COMMISSION-AREA.
  7130             20  CS-BANK-COMMS       OCCURS 10.
  7131                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 133
* EL130.cbl
  7132                 24  CS-COM-TYP            PIC X.
  7133                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7134                 24  CS-RECALC-LV-INDIC    PIC X.
  7135                 24  FILLER                PIC X(10).
  7136         16  FILLER                        PIC X(256).
  7137
  7138     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7139****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7140         16  CS-MB-CLAIM-DATA OCCURS 24.
  7141             20  CS-CLAIM-NO               PIC X(7).
  7142             20  CS-CLAIM-TYPE             PIC X.
  7143                 88  CS-AH-CLM               VALUE 'A'.
  7144                 88  CS-IU-CLM               VALUE 'I'.
  7145                 88  CS-GP-CLM               VALUE 'G'.
  7146                 88  CS-LF-CLM               VALUE 'L'.
  7147                 88  CS-PR-CLM               VALUE 'P'.
  7148                 88  CS-FL-CLM               VALUE 'F'.
  7149             20  CS-INSURED-TYPE           PIC X.
  7150                 88  CS-PRIM-INSURED          VALUE 'P'.
  7151                 88  CS-CO-BORROWER           VALUE 'C'.
  7152             20  CS-BENEFIT-PERIOD         PIC 99.
  7153             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7154             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7155             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7156         16  FILLER                        PIC X(12).
  7157     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7158         16  CS-VIN-NUMBER                 PIC X(17).
  7159         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7160         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7161         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7162         16  cs-agent-name.
  7163             20  cs-agent-fname            pic x(20).
  7164             20  cs-agent-mi               pic x.
  7165             20  cs-agent-lname            pic x(25).
  7166         16  cs-license-no                 pic x(15).
  7167         16  cs-npn-number                 pic x(10).
  7168         16  cs-agent-edit-status          pic x.
  7169             88  cs-ae-refer-to-manager      value 'M'.
  7170             88  cs-ae-cover-sheet           value 'C'.
  7171             88  cs-ae-sig-form              value 'S'.
  7172             88  cs-ae-verified              value 'V'.
  7173             88  cs-unidentified-signature   value 'U'.
  7174             88  cs-cert-returned            value 'R'.
  7175             88  cs-accept-no-commission     value 'N'.
  7176         16  cs-year                       pic 9999.
  7177         16  cs-make                       pic x(20).
  7178         16  cs-model                      pic x(20).
  7179         16  cs-future                     pic x(20).
  7180         16  cs-vehicle-odometer           pic s9(7) comp-3.
  7181         16  FILLER                        PIC X(356). *> was 420
  7182*        16  FILLER                        PIC X(496).
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 134
* EL130.cbl
  7184
  7185 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7186                          CONTROL-FILE CERTIFICATE-MASTER
  7187                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  7188                          BENEFICIARY-MASTER
  7189                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  7190                          LETTER-ARCHIVE REINSURANCE-RECORD
  7191                          MAILING-DATA CERTIFICATE-TRAILERS.
  7192 0000-DFHEXIT SECTION.
  7193     MOVE '9#                    $   ' TO DFHEIV0.
  7194     MOVE 'EL130' TO DFHEIV1.
  7195     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7196     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7197     MOVE '5'                    TO DC-OPTION-CODE.
  7198     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7199     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7200     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7201
  7202     IF EIBCALEN = ZERO
  7203         GO TO 8800-UNAUTHORIZED-ACCESS
  7204     END-IF.
  7205
  7206     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7207     MOVE EIBTRMID               TO QID-TERM.
  7208     MOVE +2                     TO EMI-NUMBER-OF-LINES
  7209     move spaces                 to emi-error-lines
  7210     MOVE '2'                    TO EMI-SWITCH2.
  7211     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7212     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7213
  7214
  7215* EXEC CICS HANDLE CONDITION
  7216*        QIDERR     (0100-TEST-ENTRY)
  7217*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  7218*        PGMIDERR   (9600-PGMID-ERROR)
  7219*        TERMIDERR  (8820-TERM-ERROR)
  7220*        TRANSIDERR (8830-TRAN-ERROR)
  7221*        ERROR      (9990-ABEND)
  7222*    END-EXEC.
  7223*    MOVE '"$N?L[\.              ! " #00007210' TO DFHEIV0
  7224     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  7225     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7226     MOVE X'2220233030303037323130' TO DFHEIV0(25:11)
  7227     CALL 'kxdfhei1' USING DFHEIV0
  7228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7229
  7230
  7231     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  7232        PI-CALLING-PROGRAM   = XCTL-6592
  7233         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  7234     ELSE
  7235         MOVE SPACES             TO RETURNED-FROM
  7236     END-IF.
  7237
  7238     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7239         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7240             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7241             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 135
* EL130.cbl
  7242             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7243             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7244             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7245             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7246             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7247             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7248         ELSE
  7249             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7250             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7251             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7252             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7253             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7254             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7255             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7256             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7257         END-IF
  7258     END-IF.
  7259
  7260     IF EIBTRNID = TRANS-ID
  7261         IF EIBAID = DFHCLEAR
  7262             GO TO 9400-CLEAR
  7263         ELSE
  7264             GO TO 0200-RECEIVE
  7265         END-IF
  7266     END-IF.
  7267
  7268     IF RETURNED-FROM NOT = SPACES
  7269         GO TO 0600-RECOVER-TEMP-STORAGE
  7270     END-IF.
  7271
  7272     MOVE LOW-VALUES TO EL130AO.
  7273     move zeros to pi-dcc-max-amt
  7274                   pi-dcc-max-benefits
  7275
  7276
  7277
  7278* EXEC CICS DELETEQ TS
  7279*         QUEUE   (QID)
  7280*    END-EXEC.
  7281*    MOVE '*&                    #   #00007265' TO DFHEIV0
  7282     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7283     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7284     MOVE X'2020233030303037323635' TO DFHEIV0(25:11)
  7285     CALL 'kxdfhei1' USING DFHEIV0,
  7286           QID,
  7287           DFHEIV99
  7288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7289
  7290
  7291 0100-TEST-ENTRY.
  7292     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7293         GO TO 0650-FROM-EL127
  7294     ELSE
  7295         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7296                                    PI-CERT-PROCESSED
  7297                                    PI-LETTER-ERROR-CODE
  7298     END-IF.
  7299
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 136
* EL130.cbl
  7300     IF PI-RETURN-TO-PROGRAM = XCTL-132
  7301         GO TO 0640-FROM-EL132
  7302     END-IF.
  7303
  7304     GO TO 8100-SEND-INITIAL-MAP.
  7305
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 137
* EL130.cbl
  7307 0200-RECEIVE.
  7308     MOVE LOW-VALUES             TO EL130AI.
  7309
  7310     IF PI-PROCESSOR-ID = 'LGXX'
  7311*        NEXT SENTENCE
  7312         CONTINUE
  7313     ELSE
  7314
  7315* EXEC CICS READQ TS
  7316*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7317*            INTO    (SECURITY-CONTROL)
  7318*            LENGTH  (SC-COMM-LENGTH)
  7319*            ITEM    (SC-ITEM)
  7320*        END-EXEC
  7321*    MOVE '*$II   L              ''   #00007292' TO DFHEIV0
  7322     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7323     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7324     MOVE X'2020233030303037323932' TO DFHEIV0(25:11)
  7325     CALL 'kxdfhei1' USING DFHEIV0,
  7326           PI-SECURITY-TEMP-STORE-ID,
  7327           SECURITY-CONTROL,
  7328           SC-COMM-LENGTH,
  7329           SC-ITEM,
  7330           DFHEIV99,
  7331           DFHEIV99
  7332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7333         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  7334         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  7335         IF NOT DISPLAY-CAP
  7336             MOVE 'READ'              TO  SM-READ
  7337             PERFORM 9995-SECURITY-VIOLATION
  7338             MOVE ER-0070             TO  EMI-ERROR
  7339             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7340             GO TO 8100-SEND-INITIAL-MAP
  7341         END-IF
  7342     END-IF.
  7343
  7344     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7345         MOVE ER-7008 TO EMI-ERROR
  7346         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7347         MOVE -1 TO MAINTL
  7348         GO TO 8200-SEND-DATAONLY
  7349     END-IF.
  7350
  7351
  7352
  7353* EXEC CICS RECEIVE
  7354*         MAP     (MAP-NAME)
  7355*         MAPSET  (MAPSET-NAME)
  7356*         INTO    (EL130AI)
  7357*    END-EXEC.
  7358     MOVE LENGTH OF
  7359      EL130AI
  7360       TO DFHEIV11
  7361*    MOVE '8"T I  L              ''   #00007317' TO DFHEIV0
  7362     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7363     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7364     MOVE X'2020233030303037333137' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 138
* EL130.cbl
  7365     CALL 'kxdfhei1' USING DFHEIV0,
  7366           MAP-NAME,
  7367           EL130AI,
  7368           DFHEIV11,
  7369           MAPSET-NAME,
  7370           DFHEIV99,
  7371           DFHEIV99
  7372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7373
  7374
  7375     IF NOT PI-NO-CARRIER-SECURITY
  7376        MOVE +1                  TO CLMCARRL
  7377        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  7378     END-IF.
  7379
  7380     IF ENTERPFL = ZERO
  7381         GO TO 0300-CHECK-PFKEYS
  7382     END-IF.
  7383
  7384     IF EIBAID NOT = DFHENTER
  7385         MOVE ER-0004            TO EMI-ERROR
  7386         GO TO 0320-INPUT-ERROR
  7387     END-IF.
  7388
  7389     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  7390         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7391     ELSE
  7392         MOVE ER-0029            TO EMI-ERROR
  7393         GO TO 0320-INPUT-ERROR
  7394     END-IF.
  7395
  7396 0300-CHECK-PFKEYS.
  7397     IF EIBAID = DFHPF23
  7398         GO TO 8810-PF23
  7399     END-IF.
  7400
  7401     IF EIBAID = DFHPF24
  7402         GO TO 9200-RETURN-MAIN-MENU
  7403     END-IF.
  7404
  7405     IF EIBAID = DFHPF12
  7406         GO TO 9500-PF12
  7407     END-IF.
  7408
  7409     IF EIBAID = DFHPF3
  7410         MOVE SPACES              TO MAINTI
  7411         MOVE ZEROS               TO MAINTL
  7412         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7413         MOVE XCTL-127            TO PGM-NAME
  7414         GO TO 9300-XCTL
  7415     END-IF.
  7416
  7417     IF EIBAID = DFHPF4
  7418         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7419         MOVE XCTL-132            TO PGM-NAME
  7420         GO TO 9300-XCTL
  7421     END-IF.
  7422
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 139
* EL130.cbl
  7423     IF EIBAID = DFHPF13
  7424         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7425             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7426             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7427             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7428             MOVE PI-STATE            TO  PI-CR-STATE
  7429             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7430             MOVE XCTL-650            TO  PGM-NAME
  7431             GO TO 9300-XCTL
  7432         ELSE
  7433             MOVE -1                  TO  ENTERPFL
  7434             MOVE ER-2566             TO  EMI-ERROR
  7435             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7436             GO TO 8100-SEND-INITIAL-MAP
  7437         END-IF
  7438     END-IF.
  7439
  7440     IF EIBAID = DFHPF5
  7441         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7442             ADD +1 TO PI-CERT-PROCESSED
  7443             GO TO 0650-FROM-EL127
  7444         ELSE
  7445             MOVE ER-7686         TO EMI-ERROR
  7446             GO TO 0320-INPUT-ERROR
  7447         END-IF
  7448     END-IF.
  7449
  7450     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7451         GO TO 0800-TEST-PREVIOUS-CONTROL
  7452     END-IF.
  7453
  7454     IF PI-HAS-CLAS-IC-CRDTCRD
  7455         IF EIBAID = DFHPF10
  7456             MOVE XCTL-725          TO PGM-NAME
  7457             GO TO 9300-XCTL
  7458         END-IF
  7459     END-IF.
  7460
  7461     IF EIBAID = DFHPF14
  7462         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7463         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7464         MOVE XCTL-659            TO PGM-NAME
  7465         GO TO 9300-XCTL
  7466     END-IF.
  7467
  7468     IF EIBAID = DFHPF15
  7469         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7470         MOVE XCTL-114            TO PGM-NAME
  7471         GO TO 9300-XCTL
  7472     END-IF.
  7473
  7474*    IF EIBAID = DFHPF11
  7475*       GO TO 0600-RECOVER-TEMP-STORAGE
  7476*    END-IF
  7477     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7478         GO TO 0330-EDIT-DATA
  7479     END-IF.
  7480
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 140
* EL130.cbl
  7481     MOVE ER-0029                TO EMI-ERROR.
  7482
  7483 0320-INPUT-ERROR.
  7484     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7485
  7486     MOVE AL-UNBON               TO ENTERPFA.
  7487
  7488     IF ENTERPFL = ZERO
  7489         MOVE -1                 TO MAINTL
  7490     ELSE
  7491         MOVE -1                 TO ENTERPFL
  7492     END-IF.
  7493
  7494     GO TO 8200-SEND-DATAONLY.
  7495
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 141
* EL130.cbl
  7497 0330-EDIT-DATA.
  7498
  7499     IF MAINTI = 'S'
  7500         IF PRTOPTL GREATER THAN 0
  7501             IF PRTOPTI NOT = 'N' AND 'L'
  7502                 MOVE AL-UABON   TO  PRTOPTA
  7503                 MOVE -1         TO  PRTOPTL
  7504                 MOVE ER-0334    TO  EMI-ERROR
  7505                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7506                 GO TO 8200-SEND-DATAONLY
  7507             ELSE
  7508                 IF PRTOPTI = 'L'
  7509                     GO TO 0400-CREATE-ELACTQ
  7510                 ELSE
  7511                     GO TO 0480-PRINT-NOW
  7512                 END-IF
  7513             END-IF
  7514         ELSE
  7515             GO TO 1000-SHOW-CLAIM
  7516         END-IF
  7517     END-IF.
  7518
  7519     IF NOT MODIFY-CAP
  7520         MOVE 'UPDATE'       TO  SM-READ
  7521         PERFORM 9995-SECURITY-VIOLATION
  7522         MOVE ER-0070        TO  EMI-ERROR
  7523         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7524         GO TO 8100-SEND-INITIAL-MAP
  7525     END-IF.
  7526
  7527     IF MAINTI = 'D'
  7528         GO TO 2000-DELETE-CLAIM
  7529     END-IF.
  7530
  7531     IF MAINTI = 'A'
  7532         GO TO 3000-ADD-CLAIM
  7533     END-IF.
  7534
  7535     IF MAINTI = 'I'
  7536         GO TO 5000-INCURRED-CHANGE
  7537     END-IF.
  7538
  7539     MOVE ER-0023                TO EMI-ERROR.
  7540     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7541     MOVE -1                     TO MAINTL.
  7542     MOVE AL-UABON               TO MAINTA.
  7543
  7544     GO TO 8200-SEND-DATAONLY.
  7545
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 142
* EL130.cbl
  7547 0400-CREATE-ELACTQ.
  7548     IF CLMNOI   = PI-LAST-CLAIM      AND
  7549        CLMCARRI = PI-LAST-CARR       AND
  7550        CERTNOI  = PI-LAST-CERT-PRIME AND
  7551        SUFXI    = PI-LAST-CERT-SUFX
  7552         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7553         MOVE PI-LAST-CARR       TO PI-CARRIER
  7554         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7555     ELSE
  7556         MOVE ER-0207            TO EMI-ERROR
  7557         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7558         MOVE -1                 TO MAINTL
  7559         GO TO 8200-SEND-DATAONLY
  7560     END-IF.
  7561
  7562     IF (NOT PI-NO-CARRIER-SECURITY OR
  7563         NOT PI-NO-ACCOUNT-SECURITY)
  7564         MOVE AL-UABON      TO  PRTOPTA
  7565         MOVE -1            TO  PRTOPTL
  7566         MOVE ER-2378       TO  EMI-ERROR
  7567         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7568         GO TO 8200-SEND-DATAONLY
  7569     END-IF.
  7570
  7571     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7572     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7573     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7574     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7575
  7576
  7577
  7578* EXEC CICS HANDLE CONDITION
  7579*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7580*    END-EXEC.
  7581*    MOVE '"$I                   ! # #00007525' TO DFHEIV0
  7582     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7583     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7584     MOVE X'2320233030303037353235' TO DFHEIV0(25:11)
  7585     CALL 'kxdfhei1' USING DFHEIV0
  7586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7587
  7588
  7589
  7590
  7591* EXEC CICS READ
  7592*         UPDATE
  7593*         DATASET    (ELACTQ-DSID)
  7594*         SET        (ADDRESS OF ACTIVITY-QUE)
  7595*         RIDFLD     (ELACTQ-KEY)
  7596*    END-EXEC.
  7597*    MOVE '&"S        EU         (   #00007530' TO DFHEIV0
  7598     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7599     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7600     MOVE X'2020233030303037353330' TO DFHEIV0(25:11)
  7601     CALL 'kxdfhei1' USING DFHEIV0,
  7602           ELACTQ-DSID,
  7603           DFHEIV20,
  7604           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 143
* EL130.cbl
  7605           ELACTQ-KEY,
  7606           DFHEIV99,
  7607           DFHEIV99,
  7608           DFHEIV99
  7609     SET ADDRESS OF ACTIVITY-QUE TO
  7610         DFHEIV20
  7611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7612
  7613
  7614     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7615     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7616
  7617
  7618
  7619* EXEC CICS REWRITE
  7620*         DATASET     (ELACTQ-DSID)
  7621*         FROM        (ACTIVITY-QUE)
  7622*    END-EXEC.
  7623     MOVE LENGTH OF
  7624      ACTIVITY-QUE
  7625       TO DFHEIV11
  7626*    MOVE '&& L                  %   #00007541' TO DFHEIV0
  7627     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7628     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7629     MOVE X'2020233030303037353431' TO DFHEIV0(25:11)
  7630     CALL 'kxdfhei1' USING DFHEIV0,
  7631           ELACTQ-DSID,
  7632           ACTIVITY-QUE,
  7633           DFHEIV11,
  7634           DFHEIV99
  7635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7636
  7637
  7638     GO TO 0470-STATUS-FINISH.
  7639
  7640 0450-ADD-ELACTQ-RECORD.
  7641
  7642
  7643* EXEC CICS GETMAIN
  7644*        SET     (ADDRESS OF ACTIVITY-QUE)
  7645*        LENGTH  (ELACTQ-LENGTH)
  7646*        INITIMG (GETMAIN-SPACE)
  7647*    END-EXEC.
  7648*    MOVE ',"IL                  $   #00007550' TO DFHEIV0
  7649     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7650     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7651     MOVE X'2020233030303037353530' TO DFHEIV0(25:11)
  7652     CALL 'kxdfhei1' USING DFHEIV0,
  7653           DFHEIV20,
  7654           ELACTQ-LENGTH,
  7655           GETMAIN-SPACE
  7656     SET ADDRESS OF ACTIVITY-QUE TO
  7657         DFHEIV20
  7658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7659
  7660
  7661     MOVE 'AQ'              TO AQ-RECORD-ID.
  7662     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 144
* EL130.cbl
  7663     MOVE +0                TO AQ-PAYMENT-COUNTER
  7664                               AQ-PMT-UNAPPROVED-COUNT.
  7665     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7666                               AQ-FOLLOWUP-DATE.
  7667     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7668     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7669
  7670
  7671
  7672* EXEC CICS WRITE
  7673*         DATASET     (ELACTQ-DSID)
  7674*         FROM        (ACTIVITY-QUE)
  7675*         RIDFLD      (ELACTQ-KEY)
  7676*    END-EXEC.
  7677     MOVE LENGTH OF
  7678      ACTIVITY-QUE
  7679       TO DFHEIV11
  7680*    MOVE '&$ L                  ''   #00007566' TO DFHEIV0
  7681     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7682     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7683     MOVE X'2020233030303037353636' TO DFHEIV0(25:11)
  7684     CALL 'kxdfhei1' USING DFHEIV0,
  7685           ELACTQ-DSID,
  7686           ACTIVITY-QUE,
  7687           DFHEIV11,
  7688           ELACTQ-KEY,
  7689           DFHEIV99,
  7690           DFHEIV99
  7691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7692
  7693
  7694 0470-STATUS-FINISH.
  7695     MOVE AL-UANOF               TO  PRTOPTA
  7696                                     ALTPRTA.
  7697
  7698     MOVE SPACES                 TO  PRTOPTO
  7699                                     ALTPRTO.
  7700
  7701     MOVE ER-0000                TO EMI-ERROR.
  7702     MOVE -1                     TO MAINTL.
  7703     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7704     GO TO 8100-SEND-INITIAL-MAP.
  7705
  7706 0480-PRINT-NOW.
  7707
  7708
  7709* EXEC CICS HANDLE CONDITION
  7710*        TERMIDERR   (8820-TERM-ERROR)
  7711*        TRANSIDERR  (8830-TRAN-ERROR)
  7712*    END-EXEC.
  7713*    MOVE '"$[\                  ! $ #00007586' TO DFHEIV0
  7714     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7715     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7716     MOVE X'2420233030303037353836' TO DFHEIV0(25:11)
  7717     CALL 'kxdfhei1' USING DFHEIV0
  7718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7719
  7720
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 145
* EL130.cbl
  7721     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7722     MOVE '1'                    TO  CNTL-REC-TYPE.
  7723     MOVE SPACES                 TO  CNTL-ACCESS.
  7724     MOVE +0                     TO  CNTL-SEQ-NO.
  7725     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7726
  7727     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7728
  7729     IF CF-FORMS-PRINTER-ID = SPACES
  7730         IF ALTPRTL NOT GREATER THAN 0
  7731             MOVE ER-0337        TO  EMI-ERROR
  7732             MOVE -1             TO  ALTPRTL
  7733             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7734             GO TO 8200-SEND-DATAONLY
  7735         END-IF
  7736     END-IF.
  7737
  7738     IF ALTPRTL GREATER THAN 0
  7739         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7740     END-IF.
  7741
  7742     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7743     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7744     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7745
  7746
  7747
  7748* EXEC CICS START
  7749*        TRANSID   (START-TRANS-ID)
  7750*        TERMID    (CF-FORMS-PRINTER-ID)
  7751*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7752*        LENGTH    (PI-COMM-LENGTH)
  7753*    END-EXEC.
  7754*    MOVE '0( LFT                1   #00007617' TO DFHEIV0
  7755     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7756     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  7757     MOVE X'2020233030303037363137' TO DFHEIV0(25:11)
  7758     CALL 'kxdfhei1' USING DFHEIV0,
  7759           DFHEIV99,
  7760           START-TRANS-ID,
  7761           DFHEIV99,
  7762           PROGRAM-INTERFACE-BLOCK,
  7763           PI-COMM-LENGTH,
  7764           CF-FORMS-PRINTER-ID,
  7765           DFHEIV99,
  7766           DFHEIV99,
  7767           DFHEIV99,
  7768           DFHEIV99,
  7769           DFHEIV99,
  7770           DFHEIV99,
  7771           DFHEIV99,
  7772           DFHEIV99,
  7773           DFHEIV99,
  7774           DFHEIV99
  7775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7776
  7777
  7778     MOVE AL-UANOF               TO  PRTOPTA
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 146
* EL130.cbl
  7779                                     ALTPRTA.
  7780
  7781     MOVE SPACES                 TO  PRTOPTO
  7782                                     ALTPRTO.
  7783
  7784     MOVE ER-0000                TO  EMI-ERROR.
  7785     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7786     MOVE -1                     TO  MAINTL.
  7787     GO TO 8100-SEND-INITIAL-MAP.
  7788
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 147
* EL130.cbl
  7790 0500-CREATE-TEMP-STORAGE.
  7791     MOVE EIBCPOSN               TO PI-CURSOR.
  7792
  7793    move emi-line1               to errmsg1o
  7794    move emi-line2               to errmsg2o
  7795    move emi-sub                 to pi-emi-sub
  7796
  7797
  7798* EXEC CICS WRITEQ TS
  7799*        QUEUE   (QID)
  7800*        FROM    (EL130AI)
  7801*        LENGTH  (QID-MAP-LENGTH)
  7802*    END-EXEC.
  7803*    MOVE '*"     L              ''   #00007643' TO DFHEIV0
  7804     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7805     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7806     MOVE X'2020233030303037363433' TO DFHEIV0(25:11)
  7807     CALL 'kxdfhei1' USING DFHEIV0,
  7808           QID,
  7809           EL130AI,
  7810           QID-MAP-LENGTH,
  7811           DFHEIV99,
  7812           DFHEIV99,
  7813           DFHEIV99
  7814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7815
  7816
  7817
  7818
  7819* EXEC CICS WRITEQ TS
  7820*        QUEUE    (QID)
  7821*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7822*        LENGTH   (PI-COMM-LENGTH)
  7823*    END-EXEC.
  7824*    MOVE '*"     L              ''   #00007650' TO DFHEIV0
  7825     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7826     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7827     MOVE X'2020233030303037363530' TO DFHEIV0(25:11)
  7828     CALL 'kxdfhei1' USING DFHEIV0,
  7829           QID,
  7830           PROGRAM-INTERFACE-BLOCK,
  7831           PI-COMM-LENGTH,
  7832           DFHEIV99,
  7833           DFHEIV99,
  7834           DFHEIV99
  7835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7836
  7837
  7838 0599-EXIT.
  7839      EXIT.
  7840
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 148
* EL130.cbl
  7842 0600-RECOVER-TEMP-STORAGE.
  7843     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7844     MOVE PI-EL127-TO-EL130-CNTRL
  7845                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7846     MOVE PI-EL659-TO-EL130-CNTRL
  7847                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7848     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7849     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7850     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7851     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7852     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7853     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7854     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7855     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7856     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7857     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7858     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7859     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7860     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7861     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7862     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7863     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7864                                 TO SAVE-BENEFICIARY
  7865
  7866
  7867
  7868* EXEC CICS HANDLE CONDITION
  7869*        NOTFND  (0660-NOT-FOUND)
  7870*        QIDERR  (0670-QIDERR)
  7871*    END-EXEC.
  7872*    MOVE '"$IN                  ! % #00007685' TO DFHEIV0
  7873     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7874     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7875     MOVE X'2520233030303037363835' TO DFHEIV0(25:11)
  7876     CALL 'kxdfhei1' USING DFHEIV0
  7877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7878
  7879
  7880
  7881
  7882* EXEC CICS READQ TS
  7883*        QUEUE    (QID)
  7884*        INTO     (EL130AI)
  7885*        LENGTH   (QID-MAP-LENGTH)
  7886*    END-EXEC.
  7887*    MOVE '*$I    L              ''   #00007691' TO DFHEIV0
  7888     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7889     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7890     MOVE X'2020233030303037363931' TO DFHEIV0(25:11)
  7891     CALL 'kxdfhei1' USING DFHEIV0,
  7892           QID,
  7893           EL130AI,
  7894           QID-MAP-LENGTH,
  7895           DFHEIV99,
  7896           DFHEIV99,
  7897           DFHEIV99
  7898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7899
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 149
* EL130.cbl
  7900
  7901     IF RETURNED-FROM = XCTL-131
  7902        IF CLAIM-DELETED-BY-EL131
  7903            MOVE LOW-VALUES      TO CERTNOI
  7904                                    SUFXI
  7905            MOVE ZEROS           TO CERTNOL
  7906                                    SUFXL
  7907         END-IF
  7908     END-IF.
  7909
  7910     IF RETURNED-FROM = XCTL-131
  7911         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7912         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7913                                    PI-CERT-PROCESSED
  7914     ELSE
  7915
  7916
  7917* EXEC CICS READQ TS
  7918*             QUEUE   (QID)
  7919*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7920*             LENGTH  (PI-COMM-LENGTH)
  7921*        END-EXEC
  7922*    MOVE '*$I    L              ''   #00007712' TO DFHEIV0
  7923     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7924     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7925     MOVE X'2020233030303037373132' TO DFHEIV0(25:11)
  7926     CALL 'kxdfhei1' USING DFHEIV0,
  7927           QID,
  7928           PROGRAM-INTERFACE-BLOCK,
  7929           PI-COMM-LENGTH,
  7930           DFHEIV99,
  7931           DFHEIV99,
  7932           DFHEIV99
  7933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7934     END-IF.
  7935
  7936
  7937* EXEC CICS DELETEQ TS
  7938*        QUEUE   (QID)
  7939*    END-EXEC.
  7940*    MOVE '*&                    #   #00007719' TO DFHEIV0
  7941     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7942     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7943     MOVE X'2020233030303037373139' TO DFHEIV0(25:11)
  7944     CALL 'kxdfhei1' USING DFHEIV0,
  7945           QID,
  7946           DFHEIV99
  7947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7948
  7949
  7950     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7951
  7952     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7953         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7954         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7955         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7956         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7957         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 150
* EL130.cbl
  7958         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  7959         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  7960         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  7961         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  7962         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  7963         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  7964         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  7965         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  7966         MOVE SAVE-CERT-ACCESS-CONTROL
  7967                                    TO PI-CERT-ACCESS-CONTROL
  7968         MOVE SAVE-CARRIER-CONTROL-LEVEL
  7969                                    TO PI-CARRIER-CONTROL-LEVEL
  7970     END-IF.
  7971
  7972*    IF EIBAID = DFHPF11
  7973*       move errmsg1i            to emi-line1
  7974*       move errmsg2i            to emi-line2
  7975*       move pi-emi-sub          to emi-sub
  7976*       go to 8200-SEND-DATAONLY
  7977*    end-if
  7978     IF RETURNED-FROM = XCTL-127
  7979         MOVE SAVE-EL127-TO-EL130-CNTRL
  7980                                 TO PI-EL127-TO-EL130-CNTRL
  7981     END-IF.
  7982
  7983     IF RETURNED-FROM = XCTL-6592
  7984        MOVE SAVE-EL659-TO-EL130-CNTRL
  7985                                 TO PI-EL659-TO-EL130-CNTRL
  7986     END-IF.
  7987
  7988     IF RETURNED-FROM = XCTL-114
  7989        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  7990           MOVE SAVE-BENEFICIARY TO BENECDI
  7991           MOVE +10              TO BENECDL
  7992           MOVE -1               TO BIRTHDTL
  7993        END-IF
  7994     END-IF.
  7995     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  7996
  7997     IF MAINTL NOT = ZERO
  7998         MOVE AL-UANON           TO MAINTA
  7999     END-IF.
  8000
  8001     IF ENTERPFL NOT = ZERO
  8002         MOVE AL-UNNON           TO ENTERPFA
  8003     END-IF.
  8004
  8005     IF RETURNED-FROM = XCTL-127
  8006         GO TO 0650-FROM-EL127
  8007     END-IF.
  8008
  8009     IF RETURNED-FROM = XCTL-132
  8010         GO TO 0640-FROM-EL132
  8011     END-IF.
  8012
  8013     IF RETURNED-FROM = XCTL-650
  8014         MOVE AL-SABON           TO PF5A
  8015         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 151
* EL130.cbl
  8016     END-IF.
  8017
  8018     IF RETURNED-FROM = XCTL-6592
  8019         GO TO 0630-FROM-EL6592
  8020     END-IF.
  8021
  8022     IF MAINTI = 'S' OR 'I'
  8023        GO TO 1000-SHOW-CLAIM
  8024     END-IF.
  8025
  8026     GO TO 8100-SEND-INITIAL-MAP.
  8027
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 152
* EL130.cbl
  8029 0630-FROM-EL6592.
  8030     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  8031     MOVE PI-EL659-GROUPING      TO GROUPO.
  8032     MOVE PI-EL659-STATE         TO STATEO.
  8033     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  8034
  8035     MOVE AL-UANON               TO CRTCARRA
  8036                                    GROUPA
  8037                                    STATEA
  8038                                    ACCOUNTA.
  8039     GO TO 8100-SEND-INITIAL-MAP.
  8040
  8041 0640-FROM-EL132.
  8042     IF PI-CLAIM-NO = SPACES
  8043         GO TO 0645-NO-CLAIM-SELECTED
  8044     END-IF.
  8045
  8046     MOVE LOW-VALUES             TO EL130AI.
  8047     MOVE 'MSTR'                 TO FILE-SWITCH.
  8048     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8049     MOVE PI-CARRIER             TO MSTR-CARRIER.
  8050     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  8051                                    CLMNOO.
  8052     MOVE AL-UANON               TO CLMNOA.
  8053     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  8054
  8055
  8056
  8057* EXEC CICS HANDLE CONDITION
  8058*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8059*    END-EXEC.
  8060*    MOVE '"$I                   ! & #00007829' TO DFHEIV0
  8061     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8062     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8063     MOVE X'2620233030303037383239' TO DFHEIV0(25:11)
  8064     CALL 'kxdfhei1' USING DFHEIV0
  8065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8066
  8067
  8068     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8069     MOVE 'X'                    TO CLAIM-SWITCH.
  8070     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8071     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8072     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8073     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8074     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8075     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8076
  8077     MOVE ER-0213                TO EMI-ERROR.
  8078     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8079     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  8080     GO TO 8100-SEND-INITIAL-MAP.
  8081
  8082 0645-NO-CLAIM-SELECTED.
  8083
  8084     IF MAINTI = 'S' OR 'I'
  8085        GO TO 1000-SHOW-CLAIM
  8086     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 153
* EL130.cbl
  8087
  8088     GO TO 8100-SEND-INITIAL-MAP.
  8089
  8090 0650-FROM-EL127.
  8091
  8092     IF PI-CERT-SELECT-CNT GREATER THAN +6
  8093         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  8094                                    PI-CERT-PROCESSED
  8095     END-IF.
  8096
  8097     IF PI-RETURN-TO-PROGRAM = XCTL-727
  8098         MOVE +1                 TO PI-CERT-SELECT-CNT
  8099                                    PI-CERT-PROCESSED
  8100         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  8101         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  8102         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  8103         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  8104         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  8105         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  8106     END-IF.
  8107
  8108     IF PI-CERT-SELECT-CNT = ZERO
  8109         IF CERTNOI NOT = SPACES AND LOW-VALUES
  8110             MOVE CERTNOI        TO PI-CERT-NO
  8111             MOVE SUFXI          TO PI-CERT-SFX
  8112             GO TO 3000-READ-CERT
  8113         ELSE
  8114             GO TO 8100-SEND-INITIAL-MAP
  8115         END-IF
  8116     END-IF.
  8117
  8118     MOVE AL-SABON               TO PF5A.
  8119
  8120     IF PI-CERT-PROCESSED = 1
  8121         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  8122     END-IF.
  8123
  8124     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  8125     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  8126
  8127     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  8128     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  8129                                 TO CERT-CARRIER
  8130                                    PI-CARRIER.
  8131     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  8132                                 TO CERT-GROUPING
  8133                                    PI-GROUPING.
  8134     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  8135                                 TO CERT-STATE
  8136                                    PI-STATE.
  8137     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  8138                                 TO CERT-ACCOUNT
  8139                                    PI-ACCOUNT.
  8140     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  8141                                 TO CERT-EFF-DT
  8142                                    PI-CERT-EFF-DT.
  8143     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  8144                                 TO CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 154
* EL130.cbl
  8145                                    PI-CERT-NO.
  8146
  8147     MOVE 'CERT'                 TO FILE-SWITCH.
  8148     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8149
  8150     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  8151     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  8152     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  8153
  8154     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8155         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  8156         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  8157         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8158         IF INCURRED-DATE-MATCH
  8159             MOVE ER-7352        TO EMI-ERROR
  8160             MOVE -1             TO CERTNOL
  8161             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8162         ELSE
  8163             IF NO-CLAIMS-FOR-CERT
  8164                 MOVE ER-7353    TO EMI-ERROR
  8165                 MOVE -1         TO CERTNOL
  8166                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8167             ELSE
  8168                 MOVE ER-0558    TO EMI-ERROR
  8169                 MOVE -1         TO CERTNOL
  8170                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8171             END-IF
  8172         END-IF
  8173     END-IF.
  8174
  8175     MOVE SPACES                 TO PI-PRT-OPT
  8176                                    PI-ALT-PRT.
  8177
  8178     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8179
  8180     if (ws-lf-joint-indicator not = 'J')
  8181        and (ws-ah-joint-indicator not = 'J')
  8182        move 'P'                 to INSTYPEO
  8183        MOVE AL-UANON            TO INSTYPEA
  8184     end-if
  8185     IF LSTNMEL NOT GREATER ZERO
  8186        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  8187         MOVE CRTLNMEI           TO  LSTNMEO
  8188         MOVE CRTFNMEI           TO  FSTNMEO
  8189         MOVE CRTINITI           TO  INITO
  8190         MOVE AL-UANON           TO  LSTNMEA
  8191                                     FSTNMEA
  8192                                     INITA
  8193     END-IF.
  8194
  8195     IF SSNL GREATER ZERO
  8196         GO TO 0655-SKIP-SOCIAL-SECURITY
  8197     END-IF.
  8198
  8199     IF CRTSSNI = SPACES OR LOW-VALUES
  8200         GO TO 0655-SKIP-SOCIAL-SECURITY
  8201     END-IF.
  8202
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 155
* EL130.cbl
  8203     IF CM-SSN-STATE   = CM-STATE AND
  8204        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  8205            GO TO 0655-SKIP-SOCIAL-SECURITY
  8206     END-IF.
  8207
  8208     MOVE CRTSSNI                TO SSNO
  8209     MOVE AL-UANON               TO SSNA.
  8210
  8211 0655-SKIP-SOCIAL-SECURITY.
  8212
  8213     IF CLMCARRL NOT = ZERO  AND
  8214        CLMCARRI NOT = CRTCARRI
  8215        MOVE ER-0562             TO EMI-ERROR
  8216        MOVE AL-UABON            TO CLMCARRA
  8217        MOVE -1                  TO CLMCARRL
  8218        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8219     END-IF.
  8220
  8221     IF CLMCARRL = ZERO
  8222        MOVE AL-UANON            TO CLMCARRA
  8223        MOVE CRTCARRI            TO CLMCARRI
  8224     END-IF.
  8225
  8226     MOVE 'A'                    TO MAINTO.
  8227     MOVE AL-UANON               TO MAINTA.
  8228
  8229     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  8230        GO TO 8100-SEND-INITIAL-MAP
  8231     ELSE
  8232        GO TO 8150-SEND-MAP-CURSOR
  8233     END-IF.
  8234
  8235 0660-NOT-FOUND.
  8236     MOVE ER-0214                TO EMI-ERROR.
  8237     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8238     GO TO 8100-SEND-INITIAL-MAP.
  8239
  8240 0670-QIDERR.
  8241     MOVE ER-0033                TO EMI-ERROR.
  8242     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8243     GO TO 8100-SEND-INITIAL-MAP.
  8244
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 156
* EL130.cbl
  8246 0680-PLUG-SELECTED-CERTS.
  8247
  8248     MOVE AL-SANON               TO BCERT1A
  8249                                    BSUFX1A
  8250                                    BCERT2A
  8251                                    BSUFX2A
  8252                                    BCERT3A
  8253                                    BSUFX3A
  8254                                    BCERT4A
  8255                                    BSUFX4A
  8256                                    BCERT5A
  8257                                    BSUFX5A.
  8258
  8259     IF PCERTNOO = SPACES OR LOW-VALUES
  8260         MOVE PI-EL127-CERT-PRIME (1)
  8261                                 TO PCERTNOO
  8262         MOVE PI-EL127-CERT-SUFX  (1)
  8263                                 TO PSUFXO
  8264     END-IF.
  8265
  8266     MOVE PI-EL127-CERT-PRIME (1)
  8267                                 TO BCERT1O.
  8268     MOVE PI-EL127-CERT-SUFX  (1)
  8269                                 TO BSUFX1O.
  8270
  8271     IF PI-CERT-SELECT-CNT GREATER THAN 1
  8272         MOVE PI-EL127-CERT-PRIME (2)
  8273                                 TO BCERT2O
  8274         MOVE PI-EL127-CERT-SUFX  (2)
  8275                                 TO BSUFX2O
  8276     ELSE
  8277         MOVE LOW-VALUES         TO BCERT2O
  8278                                    BSUFX2O
  8279     END-IF.
  8280
  8281     IF PI-CERT-SELECT-CNT GREATER THAN 2
  8282         MOVE PI-EL127-CERT-PRIME (3)
  8283                                 TO BCERT3O
  8284         MOVE PI-EL127-CERT-SUFX  (3)
  8285                                 TO BSUFX3O
  8286     ELSE
  8287         MOVE LOW-VALUES         TO BCERT3O
  8288                                    BSUFX3O
  8289     END-IF.
  8290
  8291     IF PI-CERT-SELECT-CNT GREATER THAN 3
  8292         MOVE PI-EL127-CERT-PRIME (4)
  8293                                 TO BCERT4O
  8294         MOVE PI-EL127-CERT-SUFX  (4)
  8295                                 TO BSUFX4O
  8296     ELSE
  8297         MOVE LOW-VALUES         TO BCERT4O
  8298                                    BSUFX4O
  8299     END-IF.
  8300
  8301     IF PI-CERT-SELECT-CNT GREATER THAN 4
  8302         MOVE PI-EL127-CERT-PRIME (5)
  8303                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 157
* EL130.cbl
  8304         MOVE PI-EL127-CERT-SUFX  (5)
  8305                                 TO BSUFX5O
  8306     ELSE
  8307         MOVE LOW-VALUES         TO BCERT5O
  8308                                    BSUFX5O
  8309     END-IF.
  8310
  8311 0680-EXIT.
  8312     EXIT.
  8313
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 158
* EL130.cbl
  8315 0690-HIGHLIGHT-CERTS.
  8316
  8317     MOVE AL-UANON               TO PCERTNOA
  8318                                    PSUFXA.
  8319
  8320     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8321        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8322            MOVE AL-SABON        TO BCERT1A
  8323                                    BSUFX1A
  8324     ELSE
  8325         MOVE AL-SANON           TO BCERT1A
  8326                                    BSUFX1A
  8327     END-IF.
  8328
  8329     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8330        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8331            MOVE AL-SABON        TO BCERT2A
  8332                                    BSUFX2A
  8333     ELSE
  8334         MOVE AL-SANON           TO BCERT2A
  8335                                    BSUFX2A
  8336     END-IF.
  8337
  8338     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8339        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8340            MOVE AL-SABON        TO BCERT3A
  8341                                    BSUFX3A
  8342     ELSE
  8343         MOVE AL-SANON           TO BCERT3A
  8344                                    BSUFX3A
  8345     END-IF.
  8346
  8347     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8348        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8349            MOVE AL-SABON        TO BCERT4A
  8350                                    BSUFX4A
  8351     ELSE
  8352         MOVE AL-SANON           TO BCERT4A
  8353                                    BSUFX4A
  8354     END-IF.
  8355
  8356     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8357        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8358            MOVE AL-SABON        TO BCERT5A
  8359                                    BSUFX5A
  8360     ELSE
  8361         MOVE AL-SANON           TO BCERT5A
  8362                                    BSUFX5A
  8363     END-IF.
  8364
  8365 0690-EXIT.
  8366     EXIT.
  8367
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 159
* EL130.cbl
  8369 0800-TEST-PREVIOUS-CONTROL.
  8370     IF CLMNOI   = PI-LAST-CLAIM       AND
  8371        CLMCARRI = PI-LAST-CARR        AND
  8372        CERTNOI  = PI-LAST-CERT-PRIME  AND
  8373        SUFXI    = PI-LAST-CERT-SUFX
  8374*        NEXT SENTENCE
  8375         CONTINUE
  8376     ELSE
  8377         MOVE ER-0207            TO EMI-ERROR
  8378         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8379         MOVE -1                 TO MAINTL
  8380         GO TO 8200-SEND-DATAONLY
  8381     END-IF.
  8382
  8383     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  8384
  8385     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  8386     MOVE PI-LAST-CARR           TO PI-CARRIER.
  8387     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  8388
  8389     IF EIBAID = DFHPF7
  8390         MOVE XCTL-157           TO PGM-NAME
  8391     END-IF.
  8392
  8393     IF EIBAID = DFHPF8
  8394         MOVE XCTL-141           TO PGM-NAME
  8395     END-IF.
  8396
  8397     IF EIBAID = DFHPF9
  8398        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  8399                                    PI-SAVED-PROGRAM-2
  8400                                    PI-SAVED-PROGRAM-3
  8401                                    PI-SAVED-PROGRAM-4
  8402                                    PI-SAVED-PROGRAM-5
  8403                                    PI-SAVED-PROGRAM-6
  8404        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  8405        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  8406        MOVE XCTL-150            TO PGM-NAME
  8407     END-IF.
  8408
  8409     GO TO 9300-XCTL.
  8410
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 160
* EL130.cbl
  8412 1000-SHOW-CLAIM.
  8413
  8414     IF CLMNOL = ZERO
  8415         MOVE -1                 TO CLMNOL
  8416         MOVE AL-UABON           TO CLMNOA
  8417         MOVE ER-0202            TO EMI-ERROR
  8418         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8419     ELSE
  8420         MOVE AL-UANON           TO CLMNOA
  8421     END-IF.
  8422
  8423     IF PI-NO-CARRIER-SECURITY
  8424        IF CLMCARRL = ZERO
  8425             MOVE -1             TO CLMCARRL
  8426             MOVE AL-UABON       TO CLMCARRA
  8427             MOVE ER-0194        TO EMI-ERROR
  8428             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8429         ELSE
  8430             MOVE AL-UANON       TO CLMCARRA
  8431         END-IF
  8432     END-IF.
  8433
  8434     IF SUFXL = ZERO
  8435         MOVE SPACES             TO SUFXI
  8436         MOVE AL-UANON           TO SUFXA
  8437     ELSE
  8438         MOVE AL-UANON           TO SUFXA
  8439     END-IF.
  8440
  8441     IF NOT EMI-NO-ERRORS
  8442         GO TO 1050-SEND-CHECK
  8443     END-IF.
  8444
  8445
  8446
  8447* EXEC CICS HANDLE CONDITION
  8448*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8449*    END-EXEC.
  8450*    MOVE '"$I                   ! '' #00008211' TO DFHEIV0
  8451     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8452     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8453     MOVE X'2720233030303038323131' TO DFHEIV0(25:11)
  8454     CALL 'kxdfhei1' USING DFHEIV0
  8455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8456
  8457
  8458     MOVE 'MSTR'                 TO FILE-SWITCH
  8459     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8460
  8461     MOVE CLMCARRI               TO MSTR-CARRIER.
  8462     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8463
  8464     IF CERTNOL = ZERO     OR
  8465        CERTNOI = SPACES   OR
  8466        CERTNOI = LOW-VALUES
  8467         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8468         MOVE AL-SANON        TO CERTNOA
  8469                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 161
* EL130.cbl
  8470     ELSE
  8471         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8472     END-IF.
  8473
  8474     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8475     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8476
  8477
  8478
  8479* EXEC CICS HANDLE CONDITION
  8480*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8481*    END-EXEC.
  8482*    MOVE '"$I                   ! ( #00008235' TO DFHEIV0
  8483     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8484     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8485     MOVE X'2820233030303038323335' TO DFHEIV0(25:11)
  8486     CALL 'kxdfhei1' USING DFHEIV0
  8487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8488
  8489
  8490     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8491
  8492     IF NOT PI-NO-ACCOUNT-SECURITY
  8493         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8494           MOVE ER-2371          TO EMI-ERROR
  8495           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8496           MOVE -1               TO MAINTL
  8497           GO TO 8200-SEND-DATAONLY
  8498         END-IF
  8499     END-IF.
  8500
  8501
  8502
  8503* EXEC CICS HANDLE CONDITION
  8504*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8505*    END-EXEC.
  8506*    MOVE '"$I                   ! ) #00008251' TO DFHEIV0
  8507     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8508     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8509     MOVE X'2920233030303038323531' TO DFHEIV0(25:11)
  8510     CALL 'kxdfhei1' USING DFHEIV0
  8511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8512
  8513
  8514     MOVE 'Y'                    TO CLAIM-SWITCH.
  8515     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8516     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8517     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8518     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8519     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8520
  8521 1000-SHOW-END-OF-PERFORM.
  8522
  8523     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8524     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8525     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8526     MOVE CL-CERT-STATE          TO CERT-STATE.
  8527     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 162
* EL130.cbl
  8528     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8529     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8530
  8531     MOVE 'CERT'                 TO FILE-SWITCH.
  8532
  8533     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8534
  8535     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8536     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8537     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8538     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8539     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8540     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8541     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8542     MOVE CLMCARRI               TO PI-LAST-CARR.
  8543
  8544     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8545
  8546     IF MAINTI = 'I'
  8547         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8548                 BIRTHDTA  LSTNMEA   RELCLMA
  8549                 LOANNOA   LOANBALA  BENECDA
  8550         MOVE AL-SANON TO  SSNA
  8551         MOVE SPACES   TO  INCURI    REPORTI
  8552         MOVE 'Y'      TO PI-INCURR-SW
  8553         MOVE ER-0522  TO EMI-ERROR
  8554         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8555     ELSE
  8556         MOVE ' '      TO PI-INCURR-SW
  8557     END-IF.
  8558
  8559     MOVE -1                     TO MAINTL.
  8560     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8561     MOVE CERT-GROUPING          TO PI-GROUPING.
  8562     MOVE CERT-STATE             TO PI-STATE.
  8563     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8564     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8565     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8566     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8567
  8568     IF RETURNED-FROM NOT = SPACES
  8569         GO TO 8100-SEND-INITIAL-MAP
  8570     ELSE
  8571         GO TO 8200-SEND-DATAONLY
  8572     END-IF.
  8573
  8574 1025-SHOW-RECORD-NOT-FOUND.
  8575
  8576     IF FILE-SWITCH = 'MSTR'
  8577         MOVE ER-0204            TO EMI-ERROR
  8578     ELSE
  8579         IF FILE-SWITCH = 'TRLR'
  8580             MOVE ER-0205        TO EMI-ERROR
  8581         ELSE
  8582             MOVE ER-0206        TO EMI-ERROR
  8583         END-IF
  8584     END-IF.
  8585
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 163
* EL130.cbl
  8586     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8587
  8588 1050-SEND-CHECK.
  8589
  8590     IF RETURNED-FROM NOT = SPACES
  8591         GO TO 8100-SEND-INITIAL-MAP
  8592     ELSE
  8593         MOVE -1                 TO MAINTL
  8594         GO TO 8200-SEND-DATAONLY
  8595     END-IF.
  8596
  8597 2000-DELETE-CLAIM.
  8598     IF NOT MODIFY-CAP
  8599         MOVE ER-0070            TO EMI-ERROR
  8600         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8601         MOVE -1                 TO MAINTL
  8602         GO TO 8200-SEND-DATAONLY
  8603     END-IF.
  8604
  8605     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8606        CLMCARRI NOT = PI-LAST-CARR        OR
  8607        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8608        SUFXI    NOT = PI-LAST-CERT-SUFX
  8609         MOVE ER-0207            TO EMI-ERROR
  8610         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8611         MOVE -1                 TO MAINTL
  8612         GO TO 8200-SEND-DATAONLY
  8613     END-IF.
  8614
  8615
  8616
  8617* EXEC CICS HANDLE CONDITION
  8618*        NOTFND   (2050-DELETE-NOT-FOUND)
  8619*    END-EXEC.
  8620*    MOVE '"$I                   ! * #00008357' TO DFHEIV0
  8621     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8622     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8623     MOVE X'2A20233030303038333537' TO DFHEIV0(25:11)
  8624     CALL 'kxdfhei1' USING DFHEIV0
  8625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8626
  8627
  8628     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8629
  8630     MOVE CLMCARRI               TO MSTR-CARRIER.
  8631     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8632     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8633     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8634
  8635     MOVE 'MSTR'                 TO FILE-SWITCH.
  8636     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8637
  8638     MOVE 'Y'                    TO CLAIM-SWITCH.
  8639
  8640     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8641        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8642         MOVE ER-0068        TO EMI-ERROR
  8643         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 164
* EL130.cbl
  8644         MOVE -1             TO MAINTL
  8645         GO TO 8200-SEND-DATAONLY
  8646     END-IF.
  8647
  8648     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8649         MOVE ER-0569            TO EMI-ERROR
  8650         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8651         MOVE -1                 TO MAINTL
  8652         GO TO 8200-SEND-DATAONLY
  8653     END-IF.
  8654
  8655     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8656         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8657     END-IF.
  8658
  8659     IF CL-PURGED-DT NOT = LOW-VALUES
  8660         MOVE ER-7691            TO EMI-ERROR
  8661         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8662         MOVE -1                 TO MAINTL
  8663         GO TO 8200-SEND-DATAONLY
  8664     END-IF.
  8665
  8666     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8667     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8668     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8669     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8670     MOVE +0                     TO TRLR-SEQ-NO.
  8671     MOVE '1'                    TO TRLR-TYPE.
  8672
  8673     MOVE 'TRLR'                 TO FILE-SWITCH.
  8674
  8675
  8676
  8677* EXEC CICS READ
  8678*        UPDATE
  8679*        DATASET  (ELTRLR-DSID)
  8680*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8681*        RIDFLD   (ELTRLR-KEY)
  8682*    END-EXEC.
  8683*    MOVE '&"S        EU         (   #00008409' TO DFHEIV0
  8684     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8685     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8686     MOVE X'2020233030303038343039' TO DFHEIV0(25:11)
  8687     CALL 'kxdfhei1' USING DFHEIV0,
  8688           ELTRLR-DSID,
  8689           DFHEIV20,
  8690           DFHEIV99,
  8691           ELTRLR-KEY,
  8692           DFHEIV99,
  8693           DFHEIV99,
  8694           DFHEIV99
  8695     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8696         DFHEIV20
  8697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8698
  8699
  8700     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8701        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 165
* EL130.cbl
  8702         MOVE ER-0068        TO EMI-ERROR
  8703         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8704         MOVE -1             TO MAINTL
  8705         GO TO 8200-SEND-DATAONLY
  8706     END-IF.
  8707
  8708
  8709
  8710* EXEC CICS DELETE
  8711*        DATASET   (ELTRLR-DSID)
  8712*    END-EXEC.
  8713*    MOVE '&(                    &   #00008425' TO DFHEIV0
  8714     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8715     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8716     MOVE X'2020233030303038343235' TO DFHEIV0(25:11)
  8717     CALL 'kxdfhei1' USING DFHEIV0,
  8718           ELTRLR-DSID,
  8719           DFHEIV99,
  8720           DFHEIV99,
  8721           DFHEIV99,
  8722           DFHEIV99
  8723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8724
  8725
  8726     MOVE +90                    TO TRLR-SEQ-NO.
  8727     MOVE '6'                    TO TRLR-TYPE.
  8728
  8729
  8730
  8731* EXEC CICS READ
  8732*        UPDATE
  8733*        DATASET  (ELTRLR-DSID)
  8734*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8735*        RIDFLD   (ELTRLR-KEY)
  8736*    END-EXEC.
  8737*    MOVE '&"S        EU         (   #00008433' TO DFHEIV0
  8738     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8739     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8740     MOVE X'2020233030303038343333' TO DFHEIV0(25:11)
  8741     CALL 'kxdfhei1' USING DFHEIV0,
  8742           ELTRLR-DSID,
  8743           DFHEIV20,
  8744           DFHEIV99,
  8745           ELTRLR-KEY,
  8746           DFHEIV99,
  8747           DFHEIV99,
  8748           DFHEIV99
  8749     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8750         DFHEIV20
  8751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8752
  8753
  8754
  8755
  8756* EXEC CICS DELETE
  8757*        DATASET   (ELTRLR-DSID)
  8758*    END-EXEC.
  8759*    MOVE '&(                    &   #00008441' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 166
* EL130.cbl
  8760     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8761     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8762     MOVE X'2020233030303038343431' TO DFHEIV0(25:11)
  8763     CALL 'kxdfhei1' USING DFHEIV0,
  8764           ELTRLR-DSID,
  8765           DFHEIV99,
  8766           DFHEIV99,
  8767           DFHEIV99,
  8768           DFHEIV99
  8769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8770
  8771
  8772     MOVE +91                    TO TRLR-SEQ-NO.
  8773     MOVE '6'                    TO TRLR-TYPE.
  8774
  8775
  8776
  8777* EXEC CICS READ
  8778*        UPDATE
  8779*        DATASET  (ELTRLR-DSID)
  8780*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8781*        RIDFLD   (ELTRLR-KEY)
  8782*        RESP     (WS-RESPONSE)
  8783*    END-EXEC
  8784*    MOVE '&"S        EU         (  N#00008449' TO DFHEIV0
  8785     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8786     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8787     MOVE X'204E233030303038343439' TO DFHEIV0(25:11)
  8788     CALL 'kxdfhei1' USING DFHEIV0,
  8789           ELTRLR-DSID,
  8790           DFHEIV20,
  8791           DFHEIV99,
  8792           ELTRLR-KEY,
  8793           DFHEIV99,
  8794           DFHEIV99,
  8795           DFHEIV99
  8796     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8797         DFHEIV20
  8798     MOVE EIBRESP  TO WS-RESPONSE
  8799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8800
  8801     IF WS-RESP-NORMAL
  8802
  8803* EXEC CICS DELETE
  8804*          DATASET   (ELTRLR-DSID)
  8805*       END-EXEC
  8806*    MOVE '&(                    &   #00008458' TO DFHEIV0
  8807     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8808     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8809     MOVE X'2020233030303038343538' TO DFHEIV0(25:11)
  8810     CALL 'kxdfhei1' USING DFHEIV0,
  8811           ELTRLR-DSID,
  8812           DFHEIV99,
  8813           DFHEIV99,
  8814           DFHEIV99,
  8815           DFHEIV99
  8816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8817     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 167
* EL130.cbl
  8818
  8819     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8820     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8821     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8822     MOVE CL-CERT-STATE          TO CERT-STATE.
  8823     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8824     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8825     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8826
  8827     MOVE 'CERT'                 TO FILE-SWITCH.
  8828
  8829     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8830
  8831     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8832
  8833     IF WS-NUM-HOLD NOT = +0
  8834         GO TO 2005-REWRITE-CERT
  8835     END-IF.
  8836
  8837     IF NOT CERT-WAS-CREATED
  8838         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8839         GO TO 2005-REWRITE-CERT
  8840     END-IF.
  8841
  8842
  8843
  8844* EXEC CICS DELETE
  8845*        DATASET   (ELCERT-DSID)
  8846*    END-EXEC.
  8847*    MOVE '&(                    &   #00008487' TO DFHEIV0
  8848     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8849     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8850     MOVE X'2020233030303038343837' TO DFHEIV0(25:11)
  8851     CALL 'kxdfhei1' USING DFHEIV0,
  8852           ELCERT-DSID,
  8853           DFHEIV99,
  8854           DFHEIV99,
  8855           DFHEIV99,
  8856           DFHEIV99
  8857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8858
  8859
  8860     GO TO 2010-DELETE-CL.
  8861
  8862 2005-REWRITE-CERT.
  8863
  8864     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8865
  8866
  8867
  8868* EXEC CICS HANDLE CONDITION
  8869*         DUPKEY   (2010-DELETE-CL)
  8870*    END-EXEC.
  8871*    MOVE '"$$                   ! + #00008498' TO DFHEIV0
  8872     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8873     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8874     MOVE X'2B20233030303038343938' TO DFHEIV0(25:11)
  8875     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 168
* EL130.cbl
  8876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8877
  8878
  8879
  8880
  8881* EXEC CICS REWRITE
  8882*        DATASET  (ELCERT-DSID)
  8883*        FROM     (CERTIFICATE-MASTER)
  8884*    END-EXEC.
  8885     MOVE LENGTH OF
  8886      CERTIFICATE-MASTER
  8887       TO DFHEIV11
  8888*    MOVE '&& L                  %   #00008503' TO DFHEIV0
  8889     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8890     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8891     MOVE X'2020233030303038353033' TO DFHEIV0(25:11)
  8892     CALL 'kxdfhei1' USING DFHEIV0,
  8893           ELCERT-DSID,
  8894           CERTIFICATE-MASTER,
  8895           DFHEIV11,
  8896           DFHEIV99
  8897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8898
  8899
  8900 2010-DELETE-CL.
  8901
  8902
  8903
  8904* EXEC CICS DELETE
  8905*        DATASET  (ELMSTR-DSID)
  8906*    END-EXEC.
  8907*    MOVE '&(                    &   #00008511' TO DFHEIV0
  8908     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8909     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8910     MOVE X'2020233030303038353131' TO DFHEIV0(25:11)
  8911     CALL 'kxdfhei1' USING DFHEIV0,
  8912           ELMSTR-DSID,
  8913           DFHEIV99,
  8914           DFHEIV99,
  8915           DFHEIV99,
  8916           DFHEIV99
  8917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8918
  8919
  8920     MOVE -1                     TO ONE-OR-MIN1.
  8921     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8922
  8923     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8924         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8925                                    WS-SAVE-CLAIM-KEY
  8926         MOVE +1                 TO ONE-OR-MIN1
  8927         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8928     END-IF.
  8929
  8930     MOVE ER-0000                TO EMI-ERROR.
  8931     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8932     MOVE LOW-VALUES             TO EL130AO.
  8933     MOVE -1                     TO MAINTL.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 169
* EL130.cbl
  8934     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8935     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
  8936                                    PI-CERT-PROCESSED
  8937                                    PI-LETTER-ERROR-CODE.
  8938     GO TO 8100-SEND-INITIAL-MAP.
  8939
  8940 2050-DELETE-NOT-FOUND.
  8941     IF FILE-SWITCH = 'MSTR'
  8942         MOVE -1                 TO CLMNOL
  8943         MOVE ER-0204            TO EMI-ERROR
  8944     ELSE
  8945         IF FILE-SWITCH = 'TRLR'
  8946             MOVE -1             TO MAINTL
  8947             MOVE ER-0205        TO EMI-ERROR
  8948         ELSE
  8949             MOVE -1             TO CERTNOL
  8950             MOVE ER-0206        TO EMI-ERROR
  8951         END-IF
  8952     END-IF.
  8953
  8954     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8955     GO TO 8200-SEND-DATAONLY.
  8956
  8957 3000-ADD-CLAIM.
  8958     IF NOT MODIFY-CAP
  8959         MOVE ER-0070            TO EMI-ERROR
  8960         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8961         MOVE -1                 TO MAINTL
  8962         GO TO 8200-SEND-DATAONLY
  8963     END-IF.
  8964
  8965     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  8966
  8967     IF CERTMTI = 'S'
  8968         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  8969            SUFXI    = PI-SAVE-CERT-SUFX   AND
  8970            WS-EFFDT = PI-SAVE-EFFDT       AND
  8971            ACCOUNTI = PI-SAVE-ACCOUNT
  8972             IF EMI-ERROR = 0
  8973                 GO TO 3010-TEST-FOR-ERRORS
  8974             ELSE
  8975                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  8976                 MOVE PI-CARRIER       TO  CERT-CARRIER
  8977                 MOVE PI-GROUPING      TO  CERT-GROUPING
  8978                 MOVE PI-STATE         TO  CERT-STATE
  8979                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  8980                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  8981                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  8982
  8983
  8984* EXEC CICS HANDLE CONDITION
  8985*                    NOTFND   (3010-TEST-FOR-ERRORS)
  8986*                END-EXEC
  8987*    MOVE '"$I                   ! , #00008578' TO DFHEIV0
  8988     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8989     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8990     MOVE X'2C20233030303038353738' TO DFHEIV0(25:11)
  8991     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 170
* EL130.cbl
  8992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8993                 PERFORM 7940-READ-CERT THRU 7940-EXIT
  8994                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  8995                 GO TO 3010-TEST-FOR-ERRORS
  8996             END-IF
  8997         END-IF
  8998     END-IF.
  8999
  9000     IF CERTMTI = 'A'
  9001         IF NOT PI-NO-CARRIER-SECURITY OR
  9002             NOT PI-NO-ACCOUNT-SECURITY
  9003             MOVE ER-2370          TO EMI-ERROR
  9004             MOVE -1               TO MAINTL
  9005             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9006             GO TO 8200-SEND-DATAONLY
  9007         ELSE
  9008             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  9009             GO TO 3010-TEST-FOR-ERRORS
  9010         END-IF
  9011     END-IF.
  9012
  9013     IF CERTNOL = ZEROS
  9014        GO TO 3010-TEST-FOR-ERRORS
  9015     END-IF.
  9016
  9017 3000-READ-CERT.
  9018
  9019     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  9020                                    MSTR5-COMP-CD.
  9021     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  9022                                    MSTR5-CERT-NO-PRIME.
  9023     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  9024                                    MSTR5-CERT-NO-SUFX.
  9025
  9026
  9027
  9028* EXEC CICS HANDLE CONDITION
  9029*         DUPKEY   (3008-DUP-ERROR)
  9030*         NOTFND   (3009-NOT-FOUND)
  9031*    END-EXEC
  9032*    MOVE '"$$I                  ! - #00008615' TO DFHEIV0
  9033     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  9034     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9035     MOVE X'2D20233030303038363135' TO DFHEIV0(25:11)
  9036     CALL 'kxdfhei1' USING DFHEIV0
  9037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9038
  9039     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  9040
  9041     IF NOT PI-NO-ACCOUNT-SECURITY
  9042         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  9043             MOVE ER-2371          TO EMI-ERROR
  9044             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9045             MOVE -1               TO MAINTL
  9046             GO TO 8200-SEND-DATAONLY
  9047         END-IF
  9048     END-IF.
  9049
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 171
* EL130.cbl
  9050     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  9051     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
  9052     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  9053     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  9054     MOVE CM-CARRIER             TO PI-CARRIER.
  9055     MOVE CM-GROUPING            TO PI-GROUPING.
  9056     MOVE CM-STATE               TO PI-STATE.
  9057     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  9058     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  9059     MOVE CM-CERT-NO             TO PI-CERT-NO.
  9060     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  9061
  9062     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  9063         IF LSTNMEO = SPACES OR LOW-VALUES
  9064             MOVE CRTLNMEI       TO  LSTNMEO
  9065             MOVE AL-UANON       TO  LSTNMEA
  9066         END-IF
  9067     END-IF.
  9068
  9069     MOVE 'S'                    TO CERTMTO.
  9070*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  9071     MOVE AL-SANON               TO CERTNOA.
  9072     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  9073                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  9074     IF EMI-NO-ERRORS
  9075         MOVE -1                  TO MAINTL
  9076     END-IF.
  9077
  9078     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9079         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9080         IF INCURRED-DATE-MATCH
  9081             MOVE ER-7352         TO EMI-ERROR
  9082             MOVE -1              TO CERTNOL
  9083             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9084         ELSE
  9085             IF NO-CLAIMS-FOR-CERT
  9086                 MOVE ER-7353     TO EMI-ERROR
  9087                 MOVE -1          TO CERTNOL
  9088                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9089             ELSE
  9090                 MOVE ER-0558     TO EMI-ERROR
  9091                 MOVE -1          TO CERTNOL
  9092                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9093                 GO TO 3010-TEST-FOR-ERRORS
  9094             END-IF
  9095         END-IF
  9096     END-IF.
  9097
  9098 3007-SEND-SCREEN.
  9099     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9100         GO TO 8150-SEND-MAP-CURSOR
  9101     ELSE
  9102         GO TO 8200-SEND-DATAONLY
  9103     END-IF.
  9104
  9105 3008-DUP-ERROR.
  9106     MOVE ER-0560                TO EMI-ERROR.
  9107     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 172
* EL130.cbl
  9108     MOVE -1                     TO CERTNOL.
  9109     GO TO 3007-SEND-SCREEN.
  9110
  9111 3009-NOT-FOUND.
  9112     MOVE ER-0214                TO EMI-ERROR.
  9113     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9114     MOVE -1                     TO CERTNOL.
  9115     GO TO 3007-SEND-SCREEN.
  9116
  9117 3010-TEST-FOR-ERRORS.
  9118
  9119     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  9120     perform 6500-get-acct    thru 6500-exit
  9121     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  9122*     perform 6500-get-acct    thru 6500-exit
  9123
  9124     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
  9125     move +0                     to e1
  9126     move spaces                 to ws-dcc-error-line
  9127     move ' '                    to ws-zero-bens-avail
  9128
  9129     if ws-dcc-product-code not = spaces
  9130        PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
  9131        IF ERPDEF-FOUND
  9132           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  9133           MOVE WS-INCUR         TO DC-BIN-DATE-2
  9134           MOVE '1'              TO DC-OPTION-CODE
  9135           MOVE +0               TO DC-ELAPSED-MONTHS
  9136                                    DC-ELAPSED-DAYS
  9137           PERFORM 9700-LINK-DATE-CONVERT
  9138                                 THRU 9700-EXIT
  9139           IF NO-CONVERSION-ERROR
  9140              MOVE DC-ELAPSED-MONTHS
  9141                                 TO WS-MONTHS-BETWEEN
  9142              IF DC-ELAPSED-DAYS > 1
  9143                 ADD 1 TO WS-MONTHS-BETWEEN
  9144              END-IF
  9145           ELSE
  9146              MOVE ZEROS         TO WS-MONTHS-BETWEEN
  9147           END-IF
  9148
  9149           evaluate true
  9150              when (ws-excl-period not = zeros)
  9151                 and (ws-months-between <= ws-excl-period)
  9152                 MOVE -1         TO MAINTL
  9153                 add +1          to e1
  9154                 move 'Y'        to ws-zero-bens-avail
  9155                 MOVE ER-1651    TO EMI-ERROR
  9156                                    ws-error-no (e1)
  9157                 PERFORM 9900-ERROR-FORMAT
  9158                                 THRU 9900-EXIT
  9159              when (ws-cov-ends not = zeros)
  9160                 and (ws-months-between > ws-cov-ends)
  9161                 MOVE -1         TO MAINTL
  9162                 add +1          to e1
  9163                 move 'Y'        to ws-zero-bens-avail
  9164                 MOVE ER-1653    TO EMI-ERROR
  9165                                    ws-error-no (e1)
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 173
* EL130.cbl
  9166                 evaluate true
  9167                    when clmtypei = 'L'
  9168                       move '  LF  ' to emi-claim-type
  9169                    when clmtypei = 'I'
  9170                       move '  IU  ' to emi-claim-type
  9171                    when clmtypei = 'F'
  9172                       move '  FL  ' to emi-claim-type
  9173                    when other
  9174                       move '  AH  ' to emi-claim-type
  9175                 end-evaluate
  9176                 PERFORM 9900-ERROR-FORMAT
  9177                                 THRU 9900-EXIT
  9178              when (ws-acc-period not = zeros)
  9179                 and (ws-months-between <= ws-acc-period)
  9180                 MOVE -1         TO MAINTL
  9181                 add +1          to e1
  9182                 MOVE ER-1652    TO EMI-ERROR
  9183                                    ws-error-no (e1)
  9184                 PERFORM 9900-ERROR-FORMAT
  9185                                 THRU 9900-EXIT
  9186                 add +1          to e1
  9187                 move er-1655    to emi-error
  9188                                    ws-error-no (e1)
  9189                 PERFORM 9900-ERROR-FORMAT
  9190                                 THRU 9900-EXIT
  9191              when clmtypei = 'I'
  9192                 add +1          to e1
  9193                 move er-1661    to emi-error
  9194                                    ws-error-no (e1)
  9195                 PERFORM 9900-ERROR-FORMAT
  9196                                 THRU 9900-EXIT
  9197           end-evaluate
  9198        END-IF
  9199*       perform 3996-read-cert-claim-trailer
  9200*                                thru 3996-exit
  9201     END-IF
  9202     perform 3996-read-cert-claim-trailer
  9203                                 thru 3996-exit
  9204     IF CERTMTI NOT = 'A'
  9205         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9206             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  9207             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  9208             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  9209             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9210             IF INCURRED-DATE-MATCH
  9211                 MOVE ER-7352         TO EMI-ERROR
  9212                 MOVE -1              TO CERTNOL
  9213                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9214             ELSE
  9215                 IF NO-CLAIMS-FOR-CERT
  9216                     MOVE ER-7353     TO EMI-ERROR
  9217                     MOVE -1          TO CERTNOL
  9218                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9219                 ELSE
  9220                     MOVE ER-0558     TO EMI-ERROR
  9221                     MOVE -1          TO CERTNOL
  9222                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9223                 END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 174
* EL130.cbl
  9224             END-IF
  9225         END-IF
  9226     END-IF.
  9227
  9228     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  9229         MOVE ER-0433             TO EMI-ERROR
  9230         MOVE -1                  TO MAINTL
  9231         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9232         GO TO 8200-SEND-DATAONLY
  9233     END-IF.
  9234
  9235     IF (EMI-NO-ERRORS)
  9236        OR (ZEROS = EMI-FATAL-CTR AND EMI-FORCABLE-CTR)
  9237         GO TO 3015-TRY-TO-BUILD
  9238     END-IF.
  9239
  9240     IF EIBAID = DFHPF6
  9241         IF EMI-FATAL-CTR NOT EQUAL ZERO
  9242             MOVE ER-0434         TO EMI-ERROR
  9243             MOVE -1              TO MAINTL
  9244             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9245             GO TO 8200-SEND-DATAONLY
  9246         ELSE
  9247             MOVE +1              TO INCURL
  9248             GO TO 3015-TRY-TO-BUILD
  9249         END-IF
  9250     END-IF.
  9251
  9252     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9253         GO TO 8150-SEND-MAP-CURSOR
  9254     ELSE
  9255         GO TO 8200-SEND-DATAONLY
  9256     END-IF.
  9257
  9258 3015-TRY-TO-BUILD.
  9259     IF CLMNOL EQUAL ZERO
  9260         GO TO 3030-BUILD-CONT
  9261     END-IF.
  9262
  9263
  9264
  9265* EXEC CICS HANDLE CONDITION
  9266*        NOTFND   (3030-BUILD-CONT)
  9267*    END-EXEC.
  9268*    MOVE '"$I                   ! . #00008845' TO DFHEIV0
  9269     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9270     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9271     MOVE X'2E20233030303038383435' TO DFHEIV0(25:11)
  9272     CALL 'kxdfhei1' USING DFHEIV0
  9273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9274
  9275
  9276     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9277
  9278     MOVE CLMCARRI               TO MSTR-CARRIER.
  9279     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  9280     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9281     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 175
* EL130.cbl
  9282
  9283     MOVE 'MSTR'                 TO FILE-SWITCH.
  9284
  9285     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9286
  9287     MOVE ER-0221                TO EMI-ERROR.
  9288
  9289     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9290     MOVE -1                     TO MAINTL.
  9291     GO TO 8200-SEND-DATAONLY.
  9292
  9293 3030-BUILD-CONT.
  9294     IF (CERTMTI NOT = 'A')
  9295        and (pi-company-id not = 'DCC' and 'VPP')
  9296         GO TO 3060-BUILD-CONT
  9297     END-IF.
  9298
  9299
  9300
  9301* EXEC CICS HANDLE CONDITION
  9302*        NOTFND   (3033-ACCT-NOT-FOUND)
  9303*        ENDFILE  (3033-ACCT-NOT-FOUND)
  9304*    END-EXEC.
  9305*    MOVE '"$I''                  ! / #00008873' TO DFHEIV0
  9306     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9307     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9308     MOVE X'2F20233030303038383733' TO DFHEIV0(25:11)
  9309     CALL 'kxdfhei1' USING DFHEIV0
  9310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9311
  9312
  9313     MOVE SPACES                 TO ERACCT-KEY.
  9314
  9315     IF CARR-GROUP-ST-ACCNT-CNTL
  9316         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  9317         MOVE CRTCARRI           TO ACCT-CARRIER
  9318         MOVE GROUPI             TO ACCT-GROUPING
  9319         MOVE STATEI             TO ACCT-STATE
  9320         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  9321         GO TO 3031-MOVE-ACCT-KEY
  9322     END-IF.
  9323
  9324     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9325     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  9326
  9327     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  9328         MOVE STATEI             TO ACCT-STATE
  9329     END-IF.
  9330
  9331     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  9332         MOVE CRTCARRI           TO ACCT-CARRIER
  9333     END-IF.
  9334
  9335 3031-MOVE-ACCT-KEY.
  9336     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  9337
  9338
  9339
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 176
* EL130.cbl
  9340* EXEC CICS STARTBR
  9341*        DATASET     (ERACCT2-DSID)
  9342*        RIDFLD      (SAVE-ERACCT-KEY)
  9343*        GENERIC
  9344*        KEYLENGTH   (20)
  9345*    END-EXEC.
  9346     MOVE 20
  9347       TO DFHEIV11
  9348     MOVE 0
  9349       TO DFHEIV12
  9350*    MOVE '&,   KG    G          &   #00008904' TO DFHEIV0
  9351     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  9352     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9353     MOVE X'2020233030303038393034' TO DFHEIV0(25:11)
  9354     CALL 'kxdfhei1' USING DFHEIV0,
  9355           ERACCT2-DSID,
  9356           SAVE-ERACCT-KEY,
  9357           DFHEIV11,
  9358           DFHEIV12,
  9359           DFHEIV99
  9360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9361
  9362
  9363
  9364
  9365* EXEC CICS HANDLE CONDITION
  9366*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  9367*    END-EXEC.
  9368*    MOVE '"$''                   ! 0 #00008912' TO DFHEIV0
  9369     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  9370     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9371     MOVE X'3020233030303038393132' TO DFHEIV0(25:11)
  9372     CALL 'kxdfhei1' USING DFHEIV0
  9373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9374
  9375
  9376 3031-READ-ACCT-LOOP.
  9377
  9378
  9379* EXEC CICS READNEXT
  9380*        DATASET   (ERACCT2-DSID)
  9381*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9382*        RIDFLD    (SAVE-ERACCT-KEY)
  9383*    END-EXEC.
  9384     MOVE 0
  9385       TO DFHEIV11
  9386*    MOVE '&.S                   )   #00008918' TO DFHEIV0
  9387     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9388     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9389     MOVE X'2020233030303038393138' TO DFHEIV0(25:11)
  9390     CALL 'kxdfhei1' USING DFHEIV0,
  9391           ERACCT2-DSID,
  9392           DFHEIV20,
  9393           DFHEIV99,
  9394           SAVE-ERACCT-KEY,
  9395           DFHEIV99,
  9396           DFHEIV11,
  9397           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 177
* EL130.cbl
  9398           DFHEIV99
  9399     SET ADDRESS OF ACCOUNT-MASTER TO
  9400         DFHEIV20
  9401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9402
  9403
  9404     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  9405        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
  9406        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  9407        ACCT-STATE    NOT = AM-VG-STATE       OR
  9408        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  9409         GO TO 3033-ACCT-NOT-FOUND
  9410     END-IF.
  9411
  9412     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  9413        WS-EFFDT LESS AM-EXPIRATION-DT
  9414         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  9415         MOVE AM-CARRIER       TO CERT-CARRIER
  9416         MOVE AM-GROUPING      TO CERT-GROUPING
  9417         MOVE AM-STATE         TO CERT-STATE
  9418         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  9419         MOVE WS-EFFDT         TO CERT-EFF-DT
  9420         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  9421         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  9422         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  9423         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  9424     END-IF.
  9425
  9426     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  9427         GO TO 3031-READ-ACCT-LOOP
  9428     END-IF.
  9429
  9430 3032-NOT-IN-DT-RANGE.
  9431     MOVE ER-0226                TO EMI-ERROR.
  9432     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9433     MOVE -1                     TO EFFDTL.
  9434     GO TO 8200-SEND-DATAONLY.
  9435
  9436 3033-ACCT-NOT-FOUND.
  9437     MOVE ER-0226 TO EMI-ERROR.
  9438     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9439     MOVE -1                     TO ACCOUNTL.
  9440     GO TO 8200-SEND-DATAONLY.
  9441
  9442 3034-CHECK-EMPLOYER-STATEMENT.
  9443
  9444     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  9445*        NEXT SENTENCE
  9446         CONTINUE
  9447     ELSE
  9448         GO TO  3034-CHECK-ACCOUNT-LIMITS
  9449     END-IF.
  9450
  9451     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  9452     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  9453     MOVE '1'                    TO  DC-OPTION-CODE.
  9454     MOVE +0                     TO  DC-ELAPSED-MONTHS
  9455                                     DC-ELAPSED-DAYS.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 178
* EL130.cbl
  9456     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9457
  9458     IF (AM-EMPLOYER-STMT-USED = '1' AND
  9459         DC-ELAPSED-DAYS LESS THAN +31)
  9460                      OR
  9461        (AM-EMPLOYER-STMT-USED = '2' AND
  9462         DC-ELAPSED-DAYS LESS THAN +61)
  9463                      OR
  9464        (AM-EMPLOYER-STMT-USED = '3' AND
  9465         DC-ELAPSED-DAYS LESS THAN +91)
  9466            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  9467     END-IF.
  9468
  9469 3034-CHECK-ACCOUNT-LIMITS.
  9470
  9471     IF CERTMTI NOT = 'A'
  9472         GO TO 3060-BUILD-CONT
  9473     END-IF.
  9474
  9475     IF AM-STATUS NOT = '0'
  9476         MOVE ER-0225                TO EMI-ERROR
  9477         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9478         MOVE -1                     TO ACCOUNTL
  9479     END-IF.
  9480
  9481     IF EIBAID = DFHPF6
  9482         IF EMI-FATAL-CTR NOT = ZERO
  9483             MOVE ER-0434         TO EMI-ERROR
  9484             MOVE -1              TO MAINTL
  9485             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9486             GO TO 8200-SEND-DATAONLY
  9487         END-IF
  9488     END-IF.
  9489
  9490*    IF PI-COMPANY-ID NOT = 'CRI'
  9491*        GO TO 3035-END-BROWSE
  9492*    END-IF.
  9493
  9494 3035-END-BROWSE.
  9495
  9496
  9497* EXEC CICS ENDBR
  9498*        DATASET    (ERACCT2-DSID)
  9499*    END-EXEC.
  9500     MOVE 0
  9501       TO DFHEIV11
  9502*    MOVE '&2                    $   #00009016' TO DFHEIV0
  9503     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9504     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9505     MOVE X'2020233030303039303136' TO DFHEIV0(25:11)
  9506     CALL 'kxdfhei1' USING DFHEIV0,
  9507           ERACCT2-DSID,
  9508           DFHEIV11,
  9509           DFHEIV99
  9510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9511
  9512
  9513 3040-CHECK-CERT-ALREADY-ON.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 179
* EL130.cbl
  9514
  9515
  9516* EXEC CICS HANDLE CONDITION
  9517*        NOTFND   (3070-BUILD-CONT)
  9518*    END-EXEC.
  9519*    MOVE '"$I                   ! 1 #00009022' TO DFHEIV0
  9520     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9522     MOVE X'3120233030303039303232' TO DFHEIV0(25:11)
  9523     CALL 'kxdfhei1' USING DFHEIV0
  9524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9525
  9526
  9527     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9528
  9529     MOVE ER-0229                TO EMI-ERROR.
  9530     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9531     MOVE -1                     TO MAINTL.
  9532     GO TO 8200-SEND-DATAONLY.
  9533
  9534 3060-BUILD-CONT.
  9535     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9536     MOVE CRTCARRI               TO CERT-CARRIER.
  9537     MOVE GROUPI                 TO CERT-GROUPING.
  9538     MOVE STATEI                 TO CERT-STATE.
  9539     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9540     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9541     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
  9542     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9543
  9544
  9545
  9546* EXEC CICS HANDLE CONDITION
  9547*        NOTFND  (3065-CERT-NOT-FOUND)
  9548*    END-EXEC.
  9549*    MOVE '"$I                   ! 2 #00009044' TO DFHEIV0
  9550     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9551     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9552     MOVE X'3220233030303039303434' TO DFHEIV0(25:11)
  9553     CALL 'kxdfhei1' USING DFHEIV0
  9554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9555
  9556
  9557     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9558
  9559     GO TO 3070-BUILD-CONT.
  9560
  9561 3065-CERT-NOT-FOUND.
  9562     MOVE ER-0244                TO EMI-ERROR.
  9563     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9564     MOVE -1                     TO CERTNOL.
  9565     GO TO 8200-SEND-DATAONLY.
  9566
  9567 3070-BUILD-CONT.
  9568     IF CLMNOL NOT = ZERO
  9569         GO TO 3200-BUILD-ZERO-TRAILER
  9570     END-IF.
  9571
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 180
* EL130.cbl
  9572     MOVE SPACES                 TO ELCNTL-KEY.
  9573
  9574     IF CONTROL-IS-ACTUAL-CARRIER
  9575         MOVE PI-CARRIER         TO CNTL-CARRIER
  9576     ELSE
  9577         MOVE PI-CARRIER-CONTROL-LEVEL
  9578                                 TO CNTL-CARRIER
  9579     END-IF.
  9580
  9581     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9582     MOVE '6'                    TO CNTL-REC-TYPE.
  9583     MOVE +0                     TO CNTL-SEQ-NO.
  9584
  9585
  9586
  9587* EXEC CICS HANDLE CONDITION
  9588*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9589*    END-EXEC.
  9590*    MOVE '"$I                   ! 3 #00009077' TO DFHEIV0
  9591     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9592     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9593     MOVE X'3320233030303039303737' TO DFHEIV0(25:11)
  9594     CALL 'kxdfhei1' USING DFHEIV0
  9595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9596
  9597
  9598
  9599
  9600* EXEC CICS READ
  9601*        UPDATE
  9602*        DATASET   (ELCNTL-DSID)
  9603*        SET       (ADDRESS OF CONTROL-FILE)
  9604*        RIDFLD    (ELCNTL-KEY)
  9605*    END-EXEC.
  9606*    MOVE '&"S        EU         (   #00009082' TO DFHEIV0
  9607     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9608     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9609     MOVE X'2020233030303039303832' TO DFHEIV0(25:11)
  9610     CALL 'kxdfhei1' USING DFHEIV0,
  9611           ELCNTL-DSID,
  9612           DFHEIV20,
  9613           DFHEIV99,
  9614           ELCNTL-KEY,
  9615           DFHEIV99,
  9616           DFHEIV99,
  9617           DFHEIV99
  9618     SET ADDRESS OF CONTROL-FILE TO
  9619         DFHEIV20
  9620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9621
  9622
  9623     IF CLAIM-NO-MANUAL
  9624         GO TO 3120-CLAIM-MUST-BE-INPUT
  9625     END-IF.
  9626
  9627     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9628     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9629
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 181
* EL130.cbl
  9630     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' OR 'VPP'
  9631         CONTINUE
  9632     ELSE
  9633         GO TO 3080-ASSIGN-LOOP
  9634     END-IF.
  9635
  9636
  9637
  9638* EXEC CICS UNLOCK
  9639*        DATASET   (ELCNTL-DSID)
  9640*    END-EXEC.
  9641*    MOVE '&*                    #   #00009103' TO DFHEIV0
  9642     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9643     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9644     MOVE X'2020233030303039313033' TO DFHEIV0(25:11)
  9645     CALL 'kxdfhei1' USING DFHEIV0,
  9646           ELCNTL-DSID,
  9647           DFHEIV99
  9648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9649
  9650
  9651     MOVE '1'                    TO CNTL-REC-TYPE.
  9652     MOVE SPACES                 TO CNTL-ACCESS.
  9653
  9654     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9655
  9656
  9657
  9658* EXEC CICS HANDLE CONDITION
  9659*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9660*    END-EXEC.
  9661*    MOVE '"$I                   ! 4 #00009113' TO DFHEIV0
  9662     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9663     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9664     MOVE X'3420233030303039313133' TO DFHEIV0(25:11)
  9665     CALL 'kxdfhei1' USING DFHEIV0
  9666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9667
  9668
  9669     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9670
  9671     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9672
  9673 3080-ASSIGN-LOOP.
  9674     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9675        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9676         MOVE +0                 TO SAVE-COUNTER
  9677     END-IF.
  9678
  9679     ADD +1 TO SAVE-COUNTER.
  9680
  9681     IF SAVE-METHOD  = '3'
  9682         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9683         GO TO 3090-SET-COMP
  9684     END-IF.
  9685
  9686     IF SAVE-METHOD  = '4'
  9687         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 182
* EL130.cbl
  9688         MOVE CLMCARRI           TO WS-CN-PRF-A
  9689         GO TO 3090-SET-COMP
  9690     END-IF.
  9691
  9692     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9693     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
  9694     MOVE SAVE-DATE              TO CURR-DATE.
  9695
  9696     IF CURR-MM LESS '10'
  9697         MOVE CURR-M2             TO WS-CN-PRF-B
  9698     END-IF.
  9699
  9700     IF CURR-MM = '10'
  9701        MOVE 'A'                 TO WS-CN-PRF-B
  9702     END-IF.
  9703     IF CURR-MM = '11'
  9704        MOVE 'B'                 TO WS-CN-PRF-B
  9705     END-IF.
  9706     IF CURR-MM = '12'
  9707        MOVE 'C'                 TO WS-CN-PRF-B
  9708     END-IF.
  9709
  9710     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9711
  9712 3090-SET-COMP.
  9713
  9714     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9715     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
  9716                                    CLMNOO.
  9717     MOVE AL-UANON               TO CLMNOA.
  9718     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9719     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9720     MOVE CLMCARRI               TO MSTR-CARRIER.
  9721
  9722
  9723
  9724* EXEC CICS HANDLE CONDITION
  9725*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9726*    END-EXEC.
  9727*    MOVE '"$I                   ! 5 #00009171' TO DFHEIV0
  9728     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9729     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9730     MOVE X'3520233030303039313731' TO DFHEIV0(25:11)
  9731     CALL 'kxdfhei1' USING DFHEIV0
  9732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9733
  9734
  9735     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9736
  9737     GO TO 3080-ASSIGN-LOOP.
  9738
  9739 3100-CARRIER-NOT-FOUND.
  9740     MOVE ER-0252                TO EMI-ERROR.
  9741     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9742     MOVE -1                     TO CLMCARRL.
  9743     GO TO 8200-SEND-DATAONLY.
  9744
  9745 3110-COMPANY-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 183
* EL130.cbl
  9746     MOVE ER-0254                TO EMI-ERROR.
  9747     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9748     MOVE -1                     TO MAINTL.
  9749     GO TO 8200-SEND-DATAONLY.
  9750
  9751 3120-CLAIM-MUST-BE-INPUT.
  9752     MOVE ER-0264                TO EMI-ERROR.
  9753     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9754     MOVE -1                     TO CLMNOL.
  9755     GO TO 8200-SEND-DATAONLY.
  9756
  9757 3200-BUILD-ZERO-TRAILER.
  9758
  9759
  9760* EXEC CICS HANDLE CONDITION
  9761*        NOTFND
  9762*    END-EXEC.
  9763*    MOVE '"$                   ! 6 #00009199' TO DFHEIV0
  9764     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9765     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9766     MOVE X'3620233030303039313939' TO DFHEIV0(25:11)
  9767     CALL 'kxdfhei1' USING DFHEIV0
  9768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9769
  9770
  9771
  9772
  9773* EXEC CICS GETMAIN
  9774*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9775*        LENGTH  (ELTRLR-LENGTH)
  9776*    END-EXEC.
  9777*    MOVE '," L                  $   #00009204' TO DFHEIV0
  9778     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9779     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9780     MOVE X'2020233030303039323034' TO DFHEIV0(25:11)
  9781     CALL 'kxdfhei1' USING DFHEIV0,
  9782           DFHEIV20,
  9783           ELTRLR-LENGTH,
  9784           DFHEIV99
  9785     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9786         DFHEIV20
  9787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9788
  9789
  9790     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9791     MOVE 'AT'                   TO AT-RECORD-ID.
  9792
  9793     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9794     MOVE CLMCARRI               TO AT-CARRIER.
  9795     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9796     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9797     MOVE +0                     TO AT-SEQUENCE-NO.
  9798     MOVE '1'                    TO AT-TRAILER-TYPE.
  9799
  9800     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9801     MOVE '5'                    TO DC-OPTION-CODE.
  9802     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9803     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 184
* EL130.cbl
  9804                                    AT-RESERVES-LAST-MAINT-DT.
  9805
  9806     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9807                                    AT-RESERVES-LAST-UPDATED-BY.
  9808
  9809     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9810
  9811     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
  9812
  9813     MOVE +0                     TO AT-FUTURE-RESERVE
  9814                                    AT-IBNR-RESERVE
  9815                                    AT-PAY-CURRENT-RESERVE
  9816                                    AT-INITIAL-MANUAL-RESERVE
  9817                                    AT-CURRENT-MANUAL-RESERVE
  9818                                    AT-ITD-LIFE-REFUNDS
  9819                                    AT-ITD-AH-REFUNDS
  9820                                    AT-ITD-ADDITIONAL-RESERVE.
  9821
  9822     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9823
  9824     IF MANRSVL NOT = ZERO
  9825         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
  9826                                    AT-CURRENT-MANUAL-RESERVE
  9827     END-IF.
  9828
  9829     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9830
  9831     MOVE +0                     TO AT-ITD-PAID-EXPENSES
  9832                                    AT-ITD-CHARGEABLE-EXPENSE.
  9833
  9834     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9835     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9836     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9837
  9838
  9839
  9840* EXEC CICS WRITE
  9841*        DATASET   (ELTRLR-DSID)
  9842*        FROM      (ACTIVITY-TRAILERS)
  9843*        RIDFLD    (AT-CONTROL-PRIMARY)
  9844*    END-EXEC.
  9845     MOVE LENGTH OF
  9846      ACTIVITY-TRAILERS
  9847       TO DFHEIV11
  9848*    MOVE '&$ L                  ''   #00009258' TO DFHEIV0
  9849     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9850     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9851     MOVE X'2020233030303039323538' TO DFHEIV0(25:11)
  9852     CALL 'kxdfhei1' USING DFHEIV0,
  9853           ELTRLR-DSID,
  9854           ACTIVITY-TRAILERS,
  9855           DFHEIV11,
  9856           AT-CONTROL-PRIMARY,
  9857           DFHEIV99,
  9858           DFHEIV99
  9859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9860
  9861
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 185
* EL130.cbl
  9862     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
  9863
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 186
* EL130.cbl
  9865
  9866 3250-BUILD-I1-ADDRESS-TRAILER.
  9867
  9868     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9869     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9870     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9871     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9872     MOVE GROUPI                 TO WS-MA-GROUPING.
  9873     MOVE STATEI                 TO WS-MA-STATE.
  9874     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9875     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9876     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9877     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9878
  9879
  9880* EXEC CICS HANDLE CONDITION
  9881*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9882*    END-EXEC.
  9883*    MOVE '"$I                   ! 7 #00009281' TO DFHEIV0
  9884     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9885     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9886     MOVE X'3720233030303039323831' TO DFHEIV0(25:11)
  9887     CALL 'kxdfhei1' USING DFHEIV0
  9888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9889
  9890
  9891
  9892* EXEC CICS READ
  9893*        EQUAL
  9894*        DATASET   (ERMAIL-DSID)
  9895*        SET       (ADDRESS OF MAILING-DATA)
  9896*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9897*    END-EXEC.
  9898*    MOVE '&"S        E          (   #00009285' TO DFHEIV0
  9899     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9900     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9901     MOVE X'2020233030303039323835' TO DFHEIV0(25:11)
  9902     CALL 'kxdfhei1' USING DFHEIV0,
  9903           ERMAIL-DSID,
  9904           DFHEIV20,
  9905           DFHEIV99,
  9906           WS-MA-CONTROL-PRIMARY,
  9907           DFHEIV99,
  9908           DFHEIV99,
  9909           DFHEIV99
  9910     SET ADDRESS OF MAILING-DATA TO
  9911         DFHEIV20
  9912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9913
  9914
  9915     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9916         GO TO 3290-NO-INSURED-ADDRESS
  9917     END-IF.
  9918
  9919     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9920     MOVE 'AT'                   TO AT-RECORD-ID.
  9921
  9922     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 187
* EL130.cbl
  9923     MOVE CLMCARRI               TO AT-CARRIER.
  9924     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9925     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9926     MOVE +1                     TO AT-SEQUENCE-NO.
  9927     MOVE '5'                    TO AT-TRAILER-TYPE.
  9928
  9929     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9930     IF MA-INSURED-MIDDLE-INIT > SPACES
  9931        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9932               ' ' DELIMITED BY SIZE
  9933               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9934               ' ' DELIMITED BY SIZE
  9935               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9936        INTO AT-MAIL-TO-NAME
  9937     ELSE
  9938        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9939               ' ' DELIMITED BY SIZE
  9940               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9941        INTO AT-MAIL-TO-NAME
  9942     END-IF.
  9943     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9944     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9945*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9946     MOVE MA-CITY                TO AT-CITY
  9947     MOVE MA-ADDR-STATE          TO AT-STATE
  9948     MOVE MA-ZIP                 TO AT-ZIP
  9949     MOVE MA-PHONE-NO            TO AT-PHONE-NO
  9950
  9951     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9952                                    AT-ADDRESS-LAST-MAINT-DT.
  9953
  9954     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9955                                    AT-ADDRESS-LAST-UPDATED-BY.
  9956
  9957     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9958
  9959
  9960* EXEC CICS WRITE
  9961*        DATASET   (ELTRLR-DSID)
  9962*        FROM      (ACTIVITY-TRAILERS)
  9963*        RIDFLD    (AT-CONTROL-PRIMARY)
  9964*    END-EXEC.
  9965     MOVE LENGTH OF
  9966      ACTIVITY-TRAILERS
  9967       TO DFHEIV11
  9968*    MOVE '&$ L                  ''   #00009336' TO DFHEIV0
  9969     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9970     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9971     MOVE X'2020233030303039333336' TO DFHEIV0(25:11)
  9972     CALL 'kxdfhei1' USING DFHEIV0,
  9973           ELTRLR-DSID,
  9974           ACTIVITY-TRAILERS,
  9975           DFHEIV11,
  9976           AT-CONTROL-PRIMARY,
  9977           DFHEIV99,
  9978           DFHEIV99
  9979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9980
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 188
* EL130.cbl
  9981
  9982     ADD +1                      TO WS-INSURED-ADDR-CNT.
  9983     GO TO 3300-BUILD-NINETY-TRAILER.
  9984
  9985 3290-NO-INSURED-ADDRESS.
  9986      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
  9987
  9988 3300-BUILD-NINETY-TRAILER.
  9989
  9990     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9991     MOVE 'AT'                   TO AT-RECORD-ID.
  9992
  9993     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9994     MOVE CLMCARRI               TO AT-CARRIER.
  9995
  9996     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9997     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9998     MOVE +90                    TO AT-SEQUENCE-NO.
  9999     MOVE '6'                    TO AT-TRAILER-TYPE.
 10000
 10001     IF DIAGL NOT = ZERO
 10002         MOVE DIAGI              TO AT-INFO-LINE-1
 10003     END-IF.
 10004
 10005     IF ICD1L NOT = ZERO
 10006         MOVE ICD1I              TO AT-ICD-CODE-1
 10007     END-IF.
 10008
 10009     IF ICD2L NOT = ZERO
 10010         MOVE ICD2I              TO AT-ICD-CODE-2
 10011     END-IF.
 10012
 10013     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 10014                                    AT-GEN-INFO-LAST-MAINT-DT.
 10015
 10016     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 10017                                    AT-GEN-INFO-LAST-UPDATED-BY.
 10018     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 10019
 10020
 10021
 10022* EXEC CICS WRITE
 10023*        DATASET   (ELTRLR-DSID)
 10024*        FROM      (ACTIVITY-TRAILERS)
 10025*        RIDFLD    (AT-CONTROL-PRIMARY)
 10026*    END-EXEC.
 10027     MOVE LENGTH OF
 10028      ACTIVITY-TRAILERS
 10029       TO DFHEIV11
 10030*    MOVE '&$ L                  ''   #00009381' TO DFHEIV0
 10031     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10032     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10033     MOVE X'2020233030303039333831' TO DFHEIV0(25:11)
 10034     CALL 'kxdfhei1' USING DFHEIV0,
 10035           ELTRLR-DSID,
 10036           ACTIVITY-TRAILERS,
 10037           DFHEIV11,
 10038           AT-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 189
* EL130.cbl
 10039           DFHEIV99,
 10040           DFHEIV99
 10041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10042
 10043
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 190
* EL130.cbl
 10045 3400-CHECK-CERT-MAINT.
 10046
 10047     IF CERTMTI = 'A'
 10048         GO TO 3600-BUILD-NEW-CERT
 10049     END-IF.
 10050
 10051     IF NO-CLAIM-ATTACHED
 10052         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
 10053     END-IF.
 10054
 10055     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
 10056
 10057     IF CM-LF-CURRENT-STATUS = '2' OR
 10058        CM-AH-CURRENT-STATUS = '2'
 10059         GO TO 3400-REWRITE-CERT
 10060     END-IF.
 10061
 10062     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10063
 10064 3400-REWRITE-CERT.
 10065
 10066
 10067
 10068* EXEC CICS HANDLE CONDITION
 10069*        DUPKEY (3410-DUP-KEY)
 10070*    END-EXEC.
 10071*    MOVE '"$$                   ! 8 #00009410' TO DFHEIV0
 10072     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10074     MOVE X'3820233030303039343130' TO DFHEIV0(25:11)
 10075     CALL 'kxdfhei1' USING DFHEIV0
 10076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10077
 10078
 10079
 10080
 10081* EXEC CICS REWRITE
 10082*        DATASET   (ELCERT-DSID)
 10083*        FROM      (CERTIFICATE-MASTER)
 10084*    END-EXEC.
 10085     MOVE LENGTH OF
 10086      CERTIFICATE-MASTER
 10087       TO DFHEIV11
 10088*    MOVE '&& L                  %   #00009415' TO DFHEIV0
 10089     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10090     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10091     MOVE X'2020233030303039343135' TO DFHEIV0(25:11)
 10092     CALL 'kxdfhei1' USING DFHEIV0,
 10093           ELCERT-DSID,
 10094           CERTIFICATE-MASTER,
 10095           DFHEIV11,
 10096           DFHEIV99
 10097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10098
 10099
 10100 3410-DUP-KEY.
 10101     GO TO 3800-BUILD-NEW-CLAIM.
 10102
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 191
* EL130.cbl
 10103 3600-BUILD-NEW-CERT.
 10104
 10105
 10106* EXEC CICS GETMAIN
 10107*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 10108*        LENGTH   (ELCERT-LENGTH)
 10109*    END-EXEC.
 10110*    MOVE '," L                  $   #00009425' TO DFHEIV0
 10111     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10112     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10113     MOVE X'2020233030303039343235' TO DFHEIV0(25:11)
 10114     CALL 'kxdfhei1' USING DFHEIV0,
 10115           DFHEIV20,
 10116           ELCERT-LENGTH,
 10117           DFHEIV99
 10118     SET ADDRESS OF CERTIFICATE-MASTER TO
 10119         DFHEIV20
 10120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10121
 10122
 10123     MOVE SPACES                 TO CERTIFICATE-MASTER.
 10124
 10125     MOVE 'CM'                   TO CM-RECORD-ID.
 10126
 10127     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
 10128                                    CM-COMPANY-CD-A1
 10129                                    CM-COMPANY-CD-A2
 10130                                    CM-COMPANY-CD-A4
 10131                                    CM-COMPANY-CD-A5.
 10132
 10133     MOVE CERT-CARRIER           TO CM-CARRIER.
 10134     MOVE CERT-GROUPING          TO CM-GROUPING.
 10135     MOVE CERT-STATE             TO CM-STATE.
 10136     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
 10137     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
 10138     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
 10139
 10140     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
 10141                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
 10142                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
 10143                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
 10144                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
 10145                       CM-LIVES              CM-LOAN-TERM
 10146                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
 10147                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
 10148                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
 10149                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
 10150                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
 10151                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
 10152                       CM-LF-ALT-PREMIUM-RATE
 10153                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
 10154                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
 10155                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
 10156                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
 10157                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
 10158
 10159     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
 10160                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 192
* EL130.cbl
 10161                                    CM-AH-SETTLEMENT-DT
 10162                                    CM-AH-CANCEL-EXIT-DT
 10163                                    CM-AH-SETTLEMENT-EXIT-DT
 10164                                    CM-LF-LOAN-EXPIRE-DT
 10165                                    CM-LF-CANCEL-DT
 10166                                    CM-LF-DEATH-DT
 10167                                    CM-LF-CANCEL-EXIT-DT
 10168                                    CM-LF-DEATH-EXIT-DT
 10169                                    CM-LAST-ADD-ON-DT
 10170                                    CM-ENTRY-DT.
 10171
 10172     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
 10173     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
 10174     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10175
 10176     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
 10177                                    CM-PART-LAST-NAME-A2
 10178                                    CM-PART-LAST-NAME-A5.
 10179
 10180     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
 10181                                    CM-INSURED-INITIAL1-A2
 10182                                    CM-INSURED-INITIAL1-A5
 10183                                    CM-INSURED-FIRST-NAME.
 10184
 10185     IF CRTINITL GREATER ZERO
 10186         MOVE CRTINITI           TO CM-INSURED-INITIAL2
 10187                                    CM-INSURED-INITIAL2-A2
 10188                                    CM-INSURED-INITIAL2-A5
 10189     ELSE
 10190         MOVE SPACES             TO CM-INSURED-INITIAL2
 10191                                    CM-INSURED-INITIAL2-A2
 10192                                    CM-INSURED-INITIAL2-A5
 10193     END-IF.
 10194
 10195     IF CM-INSURED-INITIALS = SPACES
 10196         MOVE '**'               TO CM-INSURED-INITIALS
 10197     END-IF.
 10198
 10199     IF MEMBERL GREATER ZERO
 10200         MOVE MEMBERI              TO CM-MEMBER-NO
 10201     ELSE
 10202         MOVE CERT-STATE           TO CM-MEMB-STATE
 10203         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
 10204         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
 10205         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
 10206     END-IF.
 10207
 10208     IF JNTLNMEL GREATER ZERO
 10209         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
 10210     END-IF.
 10211
 10212     IF JNTFNMEL GREATER ZERO
 10213         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
 10214     END-IF.
 10215
 10216     IF JNTINITL GREATER ZERO
 10217         MOVE JNTINITI           TO CM-JT-INITIAL
 10218     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 193
* EL130.cbl
 10219
 10220     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10221
 10222
 10223
 10224* EXEC CICS HANDLE CONDITION
 10225*        DUPKEY   (3690-CERT-WRITTEN)
 10226*    END-EXEC.
 10227*    MOVE '"$$                   ! 9 #00009530' TO DFHEIV0
 10228     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10229     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10230     MOVE X'3920233030303039353330' TO DFHEIV0(25:11)
 10231     CALL 'kxdfhei1' USING DFHEIV0
 10232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10233
 10234
 10235
 10236
 10237* EXEC CICS WRITE
 10238*        DATASET   (ELCERT-DSID)
 10239*        FROM      (CERTIFICATE-MASTER)
 10240*        RIDFLD    (CM-CONTROL-PRIMARY)
 10241*    END-EXEC.
 10242     MOVE LENGTH OF
 10243      CERTIFICATE-MASTER
 10244       TO DFHEIV11
 10245*    MOVE '&$ L                  ''   #00009535' TO DFHEIV0
 10246     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10247     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10248     MOVE X'2020233030303039353335' TO DFHEIV0(25:11)
 10249     CALL 'kxdfhei1' USING DFHEIV0,
 10250           ELCERT-DSID,
 10251           CERTIFICATE-MASTER,
 10252           DFHEIV11,
 10253           CM-CONTROL-PRIMARY,
 10254           DFHEIV99,
 10255           DFHEIV99
 10256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10257
 10258
 10259 3690-CERT-WRITTEN.
 10260
 10261     GO TO 3800-BUILD-NEW-CLAIM.
 10262
 10263 3690-EXIT.
 10264      EXIT.
 10265
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 194
* EL130.cbl
 10267 3700-BUILD-CERT.
 10268
 10269     IF CERTMTI NOT = 'A'
 10270         GO TO 3700-FINISH-CERT-BUILD
 10271     END-IF.
 10272
 10273     IF CERTMTI = 'A'
 10274         IF LCVCDL = ZEROS
 10275             MOVE ZEROS          TO CM-LF-BENEFIT-CD
 10276                                    CM-LF-ORIG-TERM
 10277                                    CM-LF-BENEFIT-AMT
 10278                                    CM-LF-PREMIUM-RATE
 10279             GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10280         END-IF
 10281     END-IF.
 10282
 10283     IF LCVCDL GREATER ZERO
 10284         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
 10285     END-IF.
 10286
 10287     IF LCVOTRML GREATER ZERO
 10288         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
 10289     END-IF.
 10290
 10291     IF LCVBENEL GREATER ZERO
 10292         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
 10293     END-IF.
 10294
 10295     IF LCVRATEL GREATER ZERO
 10296         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
 10297     END-IF.
 10298
 10299     IF WS-EXPIRE NOT = LOW-VALUES
 10300         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
 10301     END-IF.
 10302
 10303     IF LCVFORML GREATER ZERO
 10304         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
 10305     END-IF.
 10306
 10307     IF LCVCNDTL = ZERO
 10308        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10309     END-IF.
 10310
 10311     IF WS-LCVCNDT NOT = LOW-VALUES
 10312        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 10313        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
 10314        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10315     END-IF.
 10316
 10317     IF CM-LF-CURRENT-STATUS = '7'
 10318        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
 10319        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 10320        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10321                                    CM-LF-DEATH-DT
 10322        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10323     END-IF.
 10324
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 195
* EL130.cbl
 10325     IF CM-LF-CURRENT-STATUS = '8'
 10326        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 10327        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
 10328     END-IF.
 10329
 10330 3700-BUILD-AH-COVERAGE-SIDE.
 10331
 10332     IF CERTMTI = 'A'
 10333         IF ACVCDL = ZEROS
 10334             MOVE ZEROS          TO CM-AH-BENEFIT-CD
 10335                                    CM-AH-ORIG-TERM
 10336                                    CM-AH-BENEFIT-AMT
 10337                                    CM-AH-PREMIUM-RATE
 10338             GO TO 3700-COVERAGE-BUILT
 10339         END-IF
 10340     END-IF.
 10341
 10342     IF ACVCDL GREATER ZERO
 10343         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
 10344     END-IF.
 10345
 10346     IF ACVOTRML GREATER ZERO
 10347         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
 10348     END-IF.
 10349
 10350     IF ACVBENEL GREATER ZERO
 10351         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
 10352     END-IF.
 10353
 10354     IF ACVRATEL GREATER ZERO
 10355         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
 10356     END-IF.
 10357
 10358     IF WS-EXPIRE NOT = LOW-VALUES
 10359         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
 10360     END-IF.
 10361
 10362     IF ACVFORML GREATER ZERO
 10363         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
 10364     END-IF.
 10365
 10366     IF ACVCNDTL = ZERO
 10367        GO TO 3700-COVERAGE-BUILT
 10368     END-IF.
 10369
 10370     IF WS-ACVCNDT NOT = LOW-VALUES
 10371        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 10372        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
 10373        GO TO 3700-COVERAGE-BUILT
 10374     END-IF.
 10375
 10376     IF CM-AH-CURRENT-STATUS = '6'
 10377        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
 10378        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 10379        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10380        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
 10381        GO TO 3700-COVERAGE-BUILT
 10382     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 196
* EL130.cbl
 10383
 10384     IF CM-AH-CURRENT-STATUS = '8'
 10385        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 10386        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
 10387     END-IF.
 10388
 10389 3700-COVERAGE-BUILT.
 10390     IF ISSAGEL GREATER ZERO
 10391         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
 10392     END-IF.
 10393
 10394     IF JNTAGEL GREATER ZERO
 10395         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
 10396     END-IF.
 10397
 10398     IF SEXL GREATER ZERO
 10399         MOVE SEXI               TO CM-INSURED-SEX
 10400     END-IF.
 10401
 10402     IF APRL GREATER ZERO
 10403         MOVE WS-APR             TO CM-LOAN-APR
 10404     END-IF.
 10405
 10406     IF PMTFREQL GREATER ZERO
 10407         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
 10408     END-IF.
 10409
 10410     IF INDGRPL GREATER ZERO
 10411         MOVE INDGRPI            TO CM-IND-GRP-TYPE
 10412     END-IF.
 10413
 10414     IF CERTMTI = 'A'
 10415         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10416     END-IF.
 10417
 10418     IF REINCDL GREATER ZERO
 10419         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 10420                                    WS-REIN-1
 10421                                    WS-REIN-2
 10422                                    WS-REIN-3
 10423         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10424     END-IF.
 10425
 10426     IF WS-ADD-ON-DT NOT = LOW-VALUES
 10427         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
 10428     END-IF.
 10429
 10430     IF CRTSSNL GREATER ZERO
 10431         MOVE CRTSSNI            TO CM-SOC-SEC-NO
 10432     ELSE
 10433         IF SSNL GREATER ZERO
 10434             MOVE SSNI           TO CM-SOC-SEC-NO
 10435         END-IF
 10436     END-IF.
 10437
 10438     IF CRTSSNL = ZERO AND
 10439        SSNL    = ZERO
 10440         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 197
* EL130.cbl
 10441         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
 10442         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
 10443         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 10444     END-IF.
 10445
 10446     IF CM-LF-CURRENT-STATUS = SPACES
 10447         MOVE '1'                TO CM-LF-CURRENT-STATUS
 10448     END-IF.
 10449
 10450     IF CM-AH-CURRENT-STATUS = SPACES
 10451         MOVE '1'                TO CM-AH-CURRENT-STATUS
 10452     END-IF.
 10453
 10454     IF CERTMTI = 'A'
 10455         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
 10456     END-IF.
 10457
 10458 3700-FINISH-CERT-BUILD.
 10459
 10460     IF LOANNOL GREATER ZERO
 10461         MOVE LOANNOI            TO CM-LOAN-NUMBER
 10462     END-IF.
 10463
 10464     IF LOANBALL GREATER ZERO
 10465         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
 10466     END-IF.
 10467
 10468     IF PREMTYPL GREATER ZERO
 10469         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
 10470     END-IF.
 10471
 10472 3700-EXIT.
 10473      EXIT.
 10474
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 198
* EL130.cbl
 10476 3800-BUILD-NEW-CLAIM.
 10477
 10478*************************************************************
 10479*****           START OF ACTIVITY FILE PROCESSING          **
 10480*************************************************************
 10481     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
 10482         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
 10483                 6700-EXIT
 10484     END-IF.
 10485*************************************************************
 10486*****            END OF ACTIVITY FILE PROCESSING           **
 10487*************************************************************
 10488
 10489
 10490
 10491
 10492* EXEC CICS GETMAIN
 10493*        SET     (ADDRESS OF CLAIM-MASTER)
 10494*        LENGTH  (ELMSTR-LENGTH)
 10495*    END-EXEC.
 10496*    MOVE '," L                  $   #00009773' TO DFHEIV0
 10497     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10498     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10499     MOVE X'2020233030303039373733' TO DFHEIV0(25:11)
 10500     CALL 'kxdfhei1' USING DFHEIV0,
 10501           DFHEIV20,
 10502           ELMSTR-LENGTH,
 10503           DFHEIV99
 10504     SET ADDRESS OF CLAIM-MASTER TO
 10505         DFHEIV20
 10506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10507
 10508
 10509     MOVE SPACES TO CLAIM-MASTER.
 10510
 10511     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
 10512         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
 10513         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
 10514         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
 10515         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
 10516         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
 10517         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
 10518         CL-ACTIVITY-MAINT-DT   cl-benefit-expiration-dt
 10519
 10520     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
 10521             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
 10522             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
 10523             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
 10524             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
 10525             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
 10526             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
 10527             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
 10528             CL-FORCEABLE-ERROR-CNT.
 10529
 10530     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10531
 10532     MOVE ZEROS                  TO CL-ACTIVITY-CODE
 10533                                    CL-LAPSE-REPORT-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 199
* EL130.cbl
 10534                                    CL-LAG-REPORT-CODE
 10535                                    CL-CRITICAL-PERIOD
 10536*                                   CL-CRIT-PER-RTW-MOS
 10537     move 01                     to cl-benefit-period
 10538
 10539     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10540     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10541
 10542     IF BENECDL NOT = ZEROS
 10543        MOVE BENECDI             TO CL-BENEFICIARY
 10544     END-IF.
 10545
 10546     MOVE 'CL'                   TO CL-RECORD-ID.
 10547     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10548
 10549     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10550                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10551                             CL-COMPANY-CD-A5.
 10552
 10553     MOVE CLMCARRI               TO CL-CARRIER.
 10554
 10555     IF CLMNOL = ZERO
 10556         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10557     ELSE
 10558         MOVE CLMNOI             TO CL-CLAIM-NO
 10559     END-IF.
 10560
 10561     MOVE CERTNOI                TO CL-CERT-PRIME
 10562                                    CL-CERT-A4-PRIME.
 10563
 10564     MOVE SUFXI                  TO CL-CERT-SFX
 10565                                    CL-CERT-A4-SFX.
 10566
 10567     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10568
 10569     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10570
 10571     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10572
 10573     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10574
 10575     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10576     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10577
 10578     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10579
 10580     IF CERTMTI = 'A'
 10581         MOVE '2'                TO CL-CERT-ORIGIN
 10582     ELSE
 10583         MOVE '1'                TO CL-CERT-ORIGIN
 10584     END-IF.
 10585
 10586     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10587     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10588     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10589     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10590     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10591
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 200
* EL130.cbl
 10592 3820-REWRITE-CONTROL-FILE.
 10593
 10594     IF CLMNOL GREATER ZERO
 10595         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10596     END-IF.
 10597
 10598     IF CF-RECORD-TYPE = '6'
 10599         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10600     ELSE
 10601         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10602     END-IF.
 10603
 10604
 10605
 10606* EXEC CICS REWRITE
 10607*        DATASET   (ELCNTL-DSID)
 10608*        FROM      (CONTROL-FILE)
 10609*    END-EXEC.
 10610     MOVE LENGTH OF
 10611      CONTROL-FILE
 10612       TO DFHEIV11
 10613*    MOVE '&& L                  %   #00009874' TO DFHEIV0
 10614     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10615     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10616     MOVE X'2020233030303039383734' TO DFHEIV0(25:11)
 10617     CALL 'kxdfhei1' USING DFHEIV0,
 10618           ELCNTL-DSID,
 10619           CONTROL-FILE,
 10620           DFHEIV11,
 10621           DFHEIV99
 10622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10623
 10624
 10625 3830-SEQUENCE-CLAIM-RECORDS.
 10626
 10627     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10628     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10629     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10630
 10631     IF WS-ASSOC-CERT-TOTAL = ZERO
 10632         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10633                                    CL-ASSOC-CERT-TOTAL
 10634         GO TO 3840-WRITE-CLAIM-MASTER
 10635     END-IF.
 10636
 10637     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10638         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10639     ELSE
 10640         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10641     END-IF.
 10642
 10643     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10644     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10645     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10646
 10647 3840-WRITE-CLAIM-MASTER.
 10648
 10649     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 201
* EL130.cbl
 10650     IF WS-REC-FOUND-SW = 'Y'
 10651         MOVE 01                 TO  CL-ACTIVITY-CODE
 10652         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
 10653         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10654     END-IF.
 10655
 10656
 10657
 10658* EXEC CICS HANDLE CONDITION
 10659*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10660*    END-EXEC.
 10661*    MOVE '"$$                   ! : #00009911' TO DFHEIV0
 10662     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10663     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10664     MOVE X'3A20233030303039393131' TO DFHEIV0(25:11)
 10665     CALL 'kxdfhei1' USING DFHEIV0
 10666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10667
 10668
 10669** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10670     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10671
 10672
 10673*       CL-CERT-NO
 10674*    IF CL-COMPANY-CD = X'04'
 10675*    ELSE
 10676*       IF CL-COMPANY-CD = X'05'
 10677*       ELSE
 10678*       END-IF
 10679*    END-IF
 10680
 10681* EXEC CICS WRITE
 10682*        DATASET   (ELMSTR-DSID)
 10683*        FROM      (CLAIM-MASTER)
 10684*        RIDFLD    (CL-CONTROL-PRIMARY)
 10685*    END-EXEC.
 10686     MOVE LENGTH OF
 10687      CLAIM-MASTER
 10688       TO DFHEIV11
 10689*    MOVE '&$ L                  ''   #00009931' TO DFHEIV0
 10690     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10691     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10692     MOVE X'2020233030303039393331' TO DFHEIV0(25:11)
 10693     CALL 'kxdfhei1' USING DFHEIV0,
 10694           ELMSTR-DSID,
 10695           CLAIM-MASTER,
 10696           DFHEIV11,
 10697           CL-CONTROL-PRIMARY,
 10698           DFHEIV99,
 10699           DFHEIV99
 10700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10701
 10702
 10703 3850-CLAIM-MSTR-WRITTEN.
 10704
 10705     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10706         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10707     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 202
* EL130.cbl
 10708
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 203
* EL130.cbl
 10710 3990-ADD-DONE.
 10711*    MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10712*                                  EMI-SUB      EMI-SWITCH-AREA-2.
 10713*    MOVE SPACES                TO EMI-ACTION-SWITCH
 10714*                                  EMI-ERROR-LINES.
 10715
 10716     IF CLMNOL = ZERO
 10717         move spaces             to emi-claim-no
 10718         MOVE ER-0265            TO EMI-ERROR
 10719         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10720         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (EMI-SUB)
 10721                                    PI-LAST-CLAIM
 10722     ELSE
 10723         MOVE CLMNOI             TO PI-LAST-CLAIM
 10724                                    MSTR-CLAIM-NO
 10725         MOVE ER-0000            TO EMI-ERROR
 10726         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10727     END-IF.
 10728
 10729     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 10730       AND (PI-ST-VFY-2ND-BENE = 'L' OR 'B')
 10731         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10732         MOVE ER-7575            TO EMI-ERROR
 10733         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10734     END-IF.
 10735
 10736     IF CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 10737       AND (PI-ST-VFY-2ND-BENE = 'A' OR 'B')
 10738         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10739         MOVE ER-7582            TO EMI-ERROR
 10740         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10741     END-IF.
 10742
 10743     IF PI-STATE = 'VA' OR 'PA' OR 'GA'
 10744        PERFORM 3991-CHECK-2-YEAR-CONTESTABLE THRU 3991-EXIT
 10745     END-IF.
 10746     IF WS-NO-INSURED-ADDRESS = 'Y'
 10747         MOVE ER-3548            TO EMI-ERROR
 10748         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10749     END-IF.
 10750
 10751     IF PI-ST-CAUSAL-STATE = 'B'  OR
 10752       (PI-ST-CAUSAL-STATE = 'L' AND
 10753              CLMTYPEI = PI-LIFE-OVERRIDE-L1)   OR
 10754       (PI-ST-CAUSAL-STATE = 'A' AND
 10755              CLMTYPEI = PI-AH-OVERRIDE-L1)
 10756         PERFORM 3994B-BUILD-NINETY-FOUR-TRAILER THRU 3994B-EXIT
 10757         MOVE ER-7577            TO EMI-ERROR
 10758         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10759     END-IF.
 10760     if pi-company-id = 'DCC' OR 'VPP'
 10761        PERFORM 3994C-BUILD-NINETY-FIVE-TRAILER
 10762                                 THRU 3994C-EXIT
 10763     end-if
 10764     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10765     MOVE CLMCARRI                   TO  PI-CARRIER.
 10766     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10767     MOVE SUFXI                      TO  PI-CERT-SFX.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 204
* EL130.cbl
 10768
 10769     IF WS-LETTER-SW = 'Y'
 10770         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
 10771         IF W-1523-ERROR-CODE NOT = ZEROS
 10772             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10773             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10774         END-IF
 10775     END-IF.
 10776
 10777     perform 3998-update-cert-claim-trailer
 10778                                 thru 3998-exit
 10779     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10780     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10781     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10782     MOVE CLMCARRI               TO PI-LAST-CARR.
 10783
 10784     IF PRTOPTL GREATER THAN 0
 10785         MOVE PRTOPTI            TO PI-PRT-OPT
 10786     END-IF.
 10787     IF ALTPRTL GREATER THAN 0
 10788         MOVE ALTPRTI            TO PI-ALT-PRT
 10789     END-IF.
 10790
 10791     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10792         MOVE LOW-VALUES         TO EL130AI
 10793         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10794         MOVE AL-SANON           TO CERTNOA
 10795         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10796         MOVE AL-SANON           TO SUFXA
 10797         MOVE PI-LAST-CARR       TO CLMCARRO
 10798         MOVE AL-UANON           TO CLMCARRA
 10799         MOVE PI-LAST-CLAIM      TO CLMNOO
 10800         MOVE AL-UANON           TO CLMNOA
 10801         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
 10802         MOVE AL-UANON           TO CLMTYPEA
 10803     ELSE
 10804         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10805         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10806     END-IF.
 10807
 10808     IF PI-PRT-OPT = 'N' OR 'L'
 10809         MOVE PI-PRT-OPT         TO PRTOPTO
 10810         MOVE 1                  TO PRTOPTL
 10811     END-IF.
 10812
 10813     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10814         MOVE PI-ALT-PRT         TO ALTPRTO
 10815         MOVE 4                  TO ALTPRTL
 10816     END-IF.
 10817
 10818     IF PRTOPTL GREATER THAN 0
 10819         IF PRTOPTI = 'L'
 10820             GO TO 0400-CREATE-ELACTQ
 10821         ELSE
 10822             GO TO 0480-PRINT-NOW
 10823         END-IF
 10824     END-IF.
 10825     move 'S'                    to mainti
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 205
* EL130.cbl
 10826     PERFORM 0500-CREATE-TEMP-STORAGE
 10827                                 THRU 0599-EXIT
 10828     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10829         GO TO 8100-SEND-INITIAL-MAP
 10830     ELSE
 10831         MOVE LOW-VALUES         TO MAINTO
 10832         MOVE -1                 TO MAINTL
 10833         GO TO 8200-SEND-DATAONLY
 10834     END-IF.
 10835
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 206
* EL130.cbl
 10837 3991-CHECK-2-YEAR-CONTESTABLE.
 10838     SET ELAPSED-BETWEEN-BIN TO TRUE
 10839     MOVE ZERO               TO DC-ELAPSED-MONTHS
 10840                                DC-ELAPSED-DAYS
 10841
 10842     MOVE PI-SAVE-EFFDT  TO DC-BIN-DATE-1.
 10843     MOVE CL-INCURRED-DT TO DC-BIN-DATE-2.
 10844     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10845     IF DC-ODD-DAYS-OVER > ZERO
 10846        ADD 1 TO DC-ELAPSED-MONTHS
 10847     END-IF
 10848
 10849     IF DC-ELAPSED-MONTHS <= 24
 10850        MOVE CL-REPORTED-DT TO DC-BIN-DATE-2
 10851        MOVE ZERO           TO DC-ELAPSED-MONTHS
 10852                               DC-ELAPSED-DAYS
 10853        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10854        IF DC-ODD-DAYS-OVER > ZERO
 10855           ADD 1 TO DC-ELAPSED-MONTHS
 10856        END-IF
 10857        IF DC-ELAPSED-MONTHS > 24
 10858           MOVE ER-1679            TO EMI-ERROR
 10859           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10860           PERFORM 3992-BUILD-TRAILER THRU 3992-EXIT
 10861        END-IF
 10862     END-IF.
 10863
 10864 3991-EXIT.
 10865     EXIT.
 10866 3992-BUILD-TRAILER.
 10867
 10868     MOVE SPACES             TO AT-GENERAL-INFO-TR
 10869     INITIALIZE AT-GENERAL-INFO-TR
 10870     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 10871     MOVE 'AT'               TO AT-RECORD-ID
 10872     MOVE +96                TO AT-SEQUENCE-NO
 10873     MOVE '6'                TO AT-TRAILER-TYPE
 10874     MOVE WS-TODAY-DT        TO AT-RECORDED-DT
 10875                                AT-GEN-INFO-LAST-MAINT-DT
 10876     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 10877                                AT-GEN-INFO-LAST-UPDATED-BY
 10878     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 10879
 10880     MOVE EMI-LINE2 TO AT-INFO-LINE-1
 10881     MOVE SPACES             TO AT-INFO-LINE-2.
 10882
 10883 3992-WRITE.
 10884
 10885
 10886* EXEC CICS HANDLE CONDITION
 10887*        DUPREC    (3992-DUPREC)
 10888*    END-EXEC.
 10889*    MOVE '"$%                   ! ; #00010119' TO DFHEIV0
 10890     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10891     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10892     MOVE X'3B20233030303130313139' TO DFHEIV0(25:11)
 10893     CALL 'kxdfhei1' USING DFHEIV0
 10894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 207
* EL130.cbl
 10895
 10896
 10897
 10898* EXEC CICS WRITE
 10899*         DATASET     ('ELTRLR')
 10900*         FROM        (ACTIVITY-TRAILERS)
 10901*         RIDFLD      (AT-CONTROL-PRIMARY)
 10902*     END-EXEC.
 10903     MOVE LENGTH OF
 10904      ACTIVITY-TRAILERS
 10905       TO DFHEIV11
 10906     MOVE 'ELTRLR' TO DFHEIV1
 10907*    MOVE '&$ L                  ''   #00010123' TO DFHEIV0
 10908     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10909     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10910     MOVE X'2020233030303130313233' TO DFHEIV0(25:11)
 10911     CALL 'kxdfhei1' USING DFHEIV0,
 10912           DFHEIV1,
 10913           ACTIVITY-TRAILERS,
 10914           DFHEIV11,
 10915           AT-CONTROL-PRIMARY,
 10916           DFHEIV99,
 10917           DFHEIV99
 10918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10919
 10920
 10921     GO TO 3992-EXIT.
 10922
 10923 3992-DUPREC.
 10924     SUBTRACT +1 FROM AT-SEQUENCE-NO.
 10925     GO TO 3992-WRITE.
 10926
 10927 3992-EXIT.
 10928     EXIT.
 10929 3993-MODIFY-SCREEN-ATTRB.
 10930
 10931     IF CERTMTL GREATER ZERO
 10932         MOVE AL-UANON           TO CERTMTA
 10933     END-IF.
 10934
 10935     IF EFFDTL GREATER ZERO
 10936         MOVE AL-UANON           TO EFFDTA
 10937     END-IF.
 10938
 10939     IF ACCOUNTL GREATER ZERO
 10940         MOVE AL-UANON           TO ACCOUNTA
 10941     END-IF.
 10942
 10943     IF STATEL GREATER ZERO
 10944         MOVE AL-UANON           TO STATEA
 10945     END-IF.
 10946
 10947     IF CRTCARRL GREATER ZERO
 10948         MOVE AL-UANON           TO CRTCARRA
 10949     END-IF.
 10950
 10951     IF GROUPL GREATER ZERO
 10952         MOVE AL-UANON           TO GROUPA
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 208
* EL130.cbl
 10953     END-IF.
 10954
 10955     IF CRTLNMEL GREATER ZERO
 10956         MOVE AL-UANON           TO CRTLNMEA
 10957     END-IF.
 10958
 10959     IF CRTFNMEL GREATER ZERO
 10960         MOVE AL-UANON           TO CRTFNMEA
 10961     END-IF.
 10962
 10963     IF CRTINITL GREATER ZERO
 10964         MOVE AL-UANON           TO CRTINITA
 10965     END-IF.
 10966
 10967     IF ISSAGEL GREATER ZERO
 10968         MOVE AL-UNNON           TO ISSAGEA
 10969     END-IF.
 10970
 10971     IF JNTLNMEL GREATER ZERO
 10972         MOVE AL-UANON           TO JNTLNMEA
 10973     END-IF.
 10974
 10975     IF JNTFNMEL GREATER ZERO
 10976         MOVE AL-UANON           TO JNTFNMEA
 10977     END-IF.
 10978
 10979     IF JNTINITL GREATER ZERO
 10980         MOVE AL-UANON           TO JNTINITA
 10981     END-IF.
 10982
 10983     IF JNTAGEL GREATER ZERO
 10984         MOVE AL-UNNON           TO JNTAGEA
 10985     END-IF.
 10986
 10987     IF CRTSSNL GREATER ZERO
 10988         MOVE AL-UANON           TO CRTSSNA
 10989     END-IF.
 10990
 10991     IF ACVDSCRL GREATER ZERO
 10992         MOVE AL-SANON           TO ACVDSCRA
 10993     END-IF.
 10994
 10995     IF ACVKINDL GREATER ZERO
 10996         MOVE AL-SANON           TO ACVKINDA
 10997     END-IF.
 10998
 10999     IF ACVCDL GREATER ZERO
 11000         MOVE AL-UANON           TO ACVCDA
 11001     END-IF.
 11002
 11003     IF ACVOTRML GREATER ZERO
 11004         MOVE AL-UNNON           TO ACVOTRMA
 11005     END-IF.
 11006
 11007     IF ACVRTRML GREATER ZERO
 11008         MOVE AL-UNNON           TO ACVRTRMA
 11009     END-IF.
 11010
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 209
* EL130.cbl
 11011     IF ACVRATEL GREATER ZERO
 11012         MOVE AL-UNNON           TO ACVRATEA
 11013     END-IF.
 11014
 11015     IF ACVBENEL GREATER ZERO
 11016         MOVE AL-UNNON           TO ACVBENEA
 11017     END-IF.
 11018
 11019     IF ACVFORML GREATER ZERO
 11020         MOVE AL-UANON           TO ACVFORMA
 11021     END-IF.
 11022
 11023     IF ACVCNDTL GREATER ZERO
 11024         MOVE AL-UANON           TO ACVCNDTA
 11025     END-IF.
 11026
 11027     IF ACVEXITL GREATER ZERO
 11028         MOVE AL-UANON           TO ACVEXITA
 11029     END-IF.
 11030
 11031     IF ACVSTATL GREATER ZERO
 11032         MOVE AL-UANON           TO ACVSTATA
 11033     END-IF.
 11034
 11035     IF LCVDSCRL GREATER ZERO
 11036         MOVE AL-SANON           TO LCVDSCRA
 11037     END-IF.
 11038
 11039     IF LCVKINDL GREATER ZERO
 11040         MOVE AL-SANON           TO LCVKINDA
 11041     END-IF.
 11042
 11043     IF LCVCDL GREATER ZERO
 11044         MOVE AL-UANON           TO LCVCDA
 11045     END-IF.
 11046
 11047     IF LCVOTRML GREATER ZERO
 11048         MOVE AL-UNNON           TO LCVOTRMA
 11049     END-IF.
 11050
 11051     IF LCVRTRML GREATER ZERO
 11052         MOVE AL-UNNON           TO LCVRTRMA
 11053     END-IF.
 11054
 11055     IF LCVRATEL GREATER ZERO
 11056         MOVE AL-UNNON           TO LCVRATEA
 11057     END-IF.
 11058
 11059     IF LCVBENEL GREATER ZERO
 11060         MOVE AL-UNNON           TO LCVBENEA
 11061     END-IF.
 11062
 11063     IF LCVFORML GREATER ZERO
 11064         MOVE AL-UANON           TO LCVFORMA
 11065     END-IF.
 11066
 11067     IF LCVCNDTL GREATER ZERO
 11068         MOVE AL-UANON           TO LCVCNDTA
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 210
* EL130.cbl
 11069     END-IF.
 11070
 11071     IF LCVEXITL GREATER ZERO
 11072         MOVE AL-UANON           TO LCVEXITA
 11073     END-IF.
 11074
 11075     IF LCVSTATL GREATER ZERO
 11076         MOVE AL-UANON           TO LCVSTATA
 11077     END-IF.
 11078
 11079     IF MEMCAPL GREATER ZERO
 11080         MOVE AL-UANON           TO MEMCAPA
 11081     END-IF.
 11082
 11083     IF APRL GREATER ZERO
 11084         MOVE AL-UNNON           TO APRA
 11085     END-IF.
 11086
 11087     IF PMTFREQL GREATER ZERO
 11088         MOVE AL-UNNON           TO PMTFREQA
 11089     END-IF.
 11090
 11091     IF INDGRPL GREATER ZERO
 11092         MOVE AL-UANON           TO INDGRPA
 11093     END-IF.
 11094
 11095     IF PREMTYPL GREATER ZERO
 11096         MOVE AL-UANON           TO PREMTYPA
 11097     END-IF.
 11098
 11099     IF REINCDL GREATER ZERO
 11100         MOVE AL-UANON           TO REINCDA
 11101     END-IF.
 11102
 11103     IF ADDONDTL GREATER ZERO
 11104         MOVE AL-UANON           TO ADDONDTA
 11105     END-IF.
 11106
 11107     IF MEMBERL GREATER ZERO
 11108         MOVE AL-UANON           TO MEMBERA
 11109     END-IF.
 11110
 11111     IF BCERT1L GREATER ZERO
 11112         MOVE AL-SANON           TO BCERT1A
 11113                                    BSUFX1A
 11114     END-IF.
 11115
 11116     IF BCERT2L GREATER ZERO
 11117         MOVE AL-SANON           TO BCERT2A
 11118                                    BSUFX2A
 11119     END-IF.
 11120
 11121     IF BCERT3L GREATER ZERO
 11122         MOVE AL-SANON           TO BCERT3A
 11123                                    BSUFX3A
 11124     END-IF.
 11125
 11126     IF BCERT4L GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 211
* EL130.cbl
 11127         MOVE AL-SANON           TO BCERT4A
 11128                                    BSUFX4A
 11129     END-IF.
 11130
 11131     IF BCERT5L GREATER ZERO
 11132         MOVE AL-SANON           TO BCERT5A
 11133                                    BSUFX5A
 11134     END-IF.
 11135
 11136 3993-MODIFY-CLAIM-ATTRB.
 11137
 11138     IF PCERTNOL GREATER ZERO
 11139         MOVE AL-UANON           TO PCERTNOA
 11140     END-IF.
 11141
 11142     IF PSUFXL GREATER ZERO
 11143         MOVE AL-UANON           TO PSUFXA
 11144     END-IF.
 11145
 11146     IF LSTNMEL GREATER ZERO
 11147         MOVE AL-UANON           TO LSTNMEA
 11148     END-IF.
 11149
 11150     IF FSTNMEL GREATER ZERO
 11151         MOVE AL-UANON           TO FSTNMEA
 11152     END-IF.
 11153
 11154     IF INITL GREATER ZERO
 11155         MOVE AL-UANON           TO INITA
 11156     END-IF.
 11157
 11158     IF SEXL GREATER ZERO
 11159         MOVE AL-UANON           TO SEXA
 11160     END-IF.
 11161
 11162     IF BIRTHDTL GREATER ZERO
 11163         MOVE AL-UANON           TO BIRTHDTA
 11164     END-IF.
 11165
 11166     IF SSNL GREATER ZERO
 11167         MOVE AL-UANON           TO SSNA
 11168     END-IF.
 11169
 11170     IF INCURL GREATER ZERO
 11171         MOVE AL-UANON           TO INCURA
 11172     END-IF.
 11173
 11174     IF REPORTL GREATER ZERO
 11175         MOVE AL-UANON           TO REPORTA
 11176     END-IF.
 11177
 11178*    IF ESTENDL GREATER ZERO
 11179*        MOVE AL-UANON           TO ESTENDA
 11180*    END-IF.
 11181
 11182     IF DIAGL GREATER ZERO
 11183         MOVE AL-UANON           TO DIAGA
 11184     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 212
* EL130.cbl
 11185*
 11186     IF ICD1L GREATER ZERO
 11187         MOVE AL-UANON           TO ICD1A
 11188     END-IF.
 11189
 11190     IF ICD2L GREATER ZERO
 11191         MOVE AL-UANON           TO ICD2A
 11192     END-IF.
 11193
 11194*    IF CAUSEL GREATER ZERO
 11195*        MOVE AL-UANON           TO CAUSEA
 11196*    END-IF.
 11197
 11198     IF MANRSVL GREATER ZERO
 11199         MOVE AL-UNNON           TO MANRSVA
 11200     END-IF.
 11201
 11202     IF RELCLML GREATER ZERO
 11203         MOVE AL-UANON           TO RELCLMA
 11204     END-IF.
 11205
 11206     IF LOANNOL GREATER ZERO
 11207         MOVE AL-UANON           TO LOANNOA
 11208     END-IF.
 11209
 11210     IF LOANBALL GREATER ZERO
 11211         MOVE AL-UNNON           TO LOANBALA
 11212     END-IF.
 11213
 11214     IF PROCCDL GREATER ZERO
 11215         MOVE AL-UANON           TO PROCCDA
 11216     END-IF.
 11217
 11218     IF BENECDL GREATER THAN ZERO
 11219         MOVE AL-UANON           TO  BENECDA
 11220     END-IF.
 11221
 11222     IF PRICDL GREATER ZERO
 11223         MOVE AL-UANON           TO PRICDA
 11224     END-IF.
 11225
 11226     IF SUPVL GREATER ZERO
 11227         MOVE AL-UANON           TO SUPVA
 11228     END-IF.
 11229
 11230     IF FILETOL GREATER ZERO
 11231         MOVE AL-UANON           TO FILETOA
 11232     END-IF.
 11233
 11234
 11235 3993-MODIFY-CLAIM-KEY-ATTRB.
 11236
 11237     IF CLMNOL GREATER ZERO
 11238         MOVE AL-UANON           TO CLMNOA
 11239     END-IF.
 11240
 11241     IF CLMCARRL GREATER ZERO
 11242         MOVE AL-UANON           TO CLMCARRA
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 213
* EL130.cbl
 11243     END-IF.
 11244
 11245     IF CLMTYPEL GREATER ZERO
 11246         MOVE AL-UANON           TO CLMTYPEA
 11247     END-IF.
 11248
 11249     IF CERTNOL GREATER ZERO
 11250         MOVE AL-SANON           TO CERTNOA
 11251     END-IF.
 11252
 11253     IF SUFXL GREATER ZERO
 11254         MOVE AL-SANON           TO SUFXA
 11255     END-IF.
 11256
 11257 3993-EXIT.
 11258     EXIT.
 11259
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 214
* EL130.cbl
 11261 3994-BUILD-NINETY-THREE-TRAILER.
 11262
 11263     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11264     MOVE 'AT'                   TO AT-RECORD-ID.
 11265
 11266     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11267     MOVE CLMCARRI               TO AT-CARRIER.
 11268
 11269     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11270     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11271     MOVE +93                    TO AT-SEQUENCE-NO.
 11272     MOVE '6'                    TO AT-TRAILER-TYPE.
 11273     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11274
 11275     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 11276         MOVE WS-VERIFY-NOTE     TO AT-INFO-LINE-1
 11277     ELSE
 11278         MOVE WS-VFY-SSN-NOTE    TO AT-INFO-LINE-1
 11279     END-IF
 11280
 11281     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11282                                    AT-GEN-INFO-LAST-MAINT-DT.
 11283
 11284     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11285                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11286     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11287
 11288
 11289
 11290* EXEC CICS WRITE
 11291*        DATASET   (ELTRLR-DSID)
 11292*        FROM      (ACTIVITY-TRAILERS)
 11293*        RIDFLD    (AT-CONTROL-PRIMARY)
 11294*    END-EXEC.
 11295     MOVE LENGTH OF
 11296      ACTIVITY-TRAILERS
 11297       TO DFHEIV11
 11298*    MOVE '&$ L                  ''   #00010497' TO DFHEIV0
 11299     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11300     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11301     MOVE X'2020233030303130343937' TO DFHEIV0(25:11)
 11302     CALL 'kxdfhei1' USING DFHEIV0,
 11303           ELTRLR-DSID,
 11304           ACTIVITY-TRAILERS,
 11305           DFHEIV11,
 11306           AT-CONTROL-PRIMARY,
 11307           DFHEIV99,
 11308           DFHEIV99
 11309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11310
 11311
 11312 3994-EXIT.
 11313     EXIT.
 11314
 11315 3994B-BUILD-NINETY-FOUR-TRAILER.
 11316
 11317     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11318     MOVE 'AT'                   TO AT-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 215
* EL130.cbl
 11319
 11320     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11321     MOVE CLMCARRI               TO AT-CARRIER.
 11322
 11323     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11324     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11325     MOVE +94                    TO AT-SEQUENCE-NO.
 11326     MOVE '6'                    TO AT-TRAILER-TYPE.
 11327     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11328
 11329     MOVE WS-CAUSAL-NOTE         TO AT-INFO-LINE-1.
 11330
 11331     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11332                                    AT-GEN-INFO-LAST-MAINT-DT.
 11333
 11334     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11335                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11336     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11337
 11338
 11339
 11340* EXEC CICS WRITE
 11341*        DATASET   (ELTRLR-DSID)
 11342*        FROM      (ACTIVITY-TRAILERS)
 11343*        RIDFLD    (AT-CONTROL-PRIMARY)
 11344*    END-EXEC.
 11345     MOVE LENGTH OF
 11346      ACTIVITY-TRAILERS
 11347       TO DFHEIV11
 11348*    MOVE '&$ L                  ''   #00010530' TO DFHEIV0
 11349     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11350     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11351     MOVE X'2020233030303130353330' TO DFHEIV0(25:11)
 11352     CALL 'kxdfhei1' USING DFHEIV0,
 11353           ELTRLR-DSID,
 11354           ACTIVITY-TRAILERS,
 11355           DFHEIV11,
 11356           AT-CONTROL-PRIMARY,
 11357           DFHEIV99,
 11358           DFHEIV99
 11359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11360
 11361
 11362 3994B-EXIT.
 11363     EXIT.
 11364 3994C-BUILD-NINETY-FIVE-TRAILER.
 11365
 11366     MOVE SPACES                 TO ACTIVITY-TRAILERS
 11367     MOVE 'AT'                   TO AT-RECORD-ID
 11368
 11369     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD
 11370     MOVE CLMCARRI               TO AT-CARRIER
 11371
 11372     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO
 11373     MOVE CERT-CERT-NO           TO AT-CERT-NO
 11374     MOVE +95                    TO AT-SEQUENCE-NO
 11375     MOVE '6'                    TO AT-TRAILER-TYPE
 11376     MOVE 'E'                    TO AT-INFO-TRAILER-TYPE
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 216
* EL130.cbl
 11377
 11378     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11379                                    AT-GEN-INFO-LAST-MAINT-DT
 11380
 11381     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11382                                    AT-GEN-INFO-LAST-UPDATED-BY
 11383     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 11384
 11385     perform varying e1 from +1 by +1 until
 11386        ws-error-no (e1) = spaces
 11387        move ws-error-no (e1)    to at-note-error-no (e1)
 11388     end-perform
 11389
 11390     if at-info-line-1 not = spaces
 11391
 11392* EXEC CICS WRITE
 11393*          DATASET  (ELTRLR-DSID)
 11394*          FROM     (ACTIVITY-TRAILERS)
 11395*          RIDFLD   (AT-CONTROL-PRIMARY)
 11396*       END-EXEC
 11397     MOVE LENGTH OF
 11398      ACTIVITY-TRAILERS
 11399       TO DFHEIV11
 11400*    MOVE '&$ L                  ''   #00010565' TO DFHEIV0
 11401     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11402     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11403     MOVE X'2020233030303130353635' TO DFHEIV0(25:11)
 11404     CALL 'kxdfhei1' USING DFHEIV0,
 11405           ELTRLR-DSID,
 11406           ACTIVITY-TRAILERS,
 11407           DFHEIV11,
 11408           AT-CONTROL-PRIMARY,
 11409           DFHEIV99,
 11410           DFHEIV99
 11411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11412     end-if
 11413
 11414     .
 11415 3994C-EXIT.
 11416     EXIT.
 11417 3995-BUILD-CLAIM-RECORD.
 11418     IF PROCCDL GREATER ZERO
 11419         MOVE PROCCDI            TO CL-PROCESSOR-ID
 11420     ELSE
 11421         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 11422     END-IF.
 11423
 11424     IF FSTNMEL GREATER ZERO
 11425         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 11426     END-IF.
 11427
 11428     IF INITL GREATER ZERO
 11429         MOVE INITI              TO CL-INSURED-MID-INIT
 11430     END-IF.
 11431
 11432     IF BIRTHDTL GREATER ZERO
 11433         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 11434     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 217
* EL130.cbl
 11435
 11436     IF SEXL GREATER ZERO
 11437         MOVE SEXI               TO CL-INSURED-SEX-CD
 11438     END-IF.
 11439
 11440     MOVE 'O'                    TO CL-CLAIM-STATUS.
 11441
 11442*    IF CLMTYPEL GREATER ZERO
 11443     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 11444*    END-IF.
 11445
 11446     IF PREMTYPL GREATER ZERO
 11447         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 11448     END-IF.
 11449
 11450     IF INCURL GREATER ZERO
 11451         MOVE WS-INCUR           TO CL-INCURRED-DT
 11452     END-IF.
 11453
 11454     IF (PI-COMPANY-ID = 'DCC' OR 'VPP')
 11455        AND (ERPDEF-FOUND)
 11456        MOVE WS-MAX-BENEFITS     TO CL-CRITICAL-PERIOD
 11457*       MOVE WS-CRIT-PER-RECURRENT
 11458*                                TO CL-CRIT-PER-RECURRENT
 11459*       MOVE WS-CRIT-PER-RTW-MOS TO CL-CRIT-PER-RTW-MOS
 11460        if ws-crit-per-recurrent > 01
 11461           move zeros            to cl-benefit-period
 11462        end-if
 11463     ELSE
 11464        IF CL-CLAIM-TYPE = 'L' OR 'P'
 11465           MOVE CM-LF-CRITICAL-PERIOD
 11466                                 TO CL-CRITICAL-PERIOD
 11467        ELSE
 11468           MOVE CM-AH-CRITICAL-PERIOD
 11469                                 TO CL-CRITICAL-PERIOD
 11470        END-IF
 11471     END-IF
 11472
 11473     IF CL-CRITICAL-PERIOD NOT = ZEROS
 11474        COMPUTE DC-ELAPSED-MONTHS =
 11475           CL-CRITICAL-PERIOD - WS-BENEFITS-PREV-PAID
 11476        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
 11477        MOVE ZEROS               TO DC-ELAPSED-DAYS
 11478        MOVE '6'                 TO DC-OPTION-CODE
 11479        PERFORM 9700-LINK-DATE-CONVERT
 11480                                 THRU 9700-EXIT
 11481        MOVE DC-BIN-DATE-2       TO CL-BENEFIT-EXPIRATION-DT
 11482     END-IF
 11483
 11484     if instypel > zero
 11485        move instypei            to cl-insured-type
 11486     end-if
 11487     IF REPORTL GREATER ZERO
 11488         MOVE WS-REPORT          TO CL-REPORTED-DT
 11489     END-IF.
 11490
 11491     IF EIBAID = DFHPF6
 11492         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 218
* EL130.cbl
 11493             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 11494                 IF EMI-FORCABLE-CTR = +1
 11495                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
 11496                 END-IF
 11497         END-IF
 11498     END-IF.
 11499
 11500*    IF ESTENDL GREATER ZERO
 11501*       MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 11502*    END-IF.
 11503
 11504     IF ADDONDTL GREATER ZERO
 11505         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 11506     END-IF.
 11507
 11508*    IF CAUSEL GREATER ZERO
 11509*        MOVE CAUSEI             TO CL-CAUSE-CD
 11510*    END-IF.
 11511
 11512     IF SSNL GREATER ZERO
 11513         MOVE SSNI               TO CL-SOC-SEC-NO
 11514     ELSE
 11515         MOVE CERT-STATE         TO CL-SSN-STATE
 11516         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 11517         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 11518     END-IF.
 11519
 11520     IF PRICDL GREATER ZERO
 11521         MOVE PRICDI             TO CL-PRIORITY-CD
 11522     END-IF.
 11523
 11524     IF SUPVL GREATER ZERO
 11525         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 11526     END-IF.
 11527
 11528     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 11529     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 11530     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 11531
 11532     IF RELCLML GREATER ZERO
 11533         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 11534     END-IF.
 11535
 11536     IF FILETOL GREATER ZERO
 11537         MOVE FILETOI            TO CL-FILE-LOCATION
 11538     END-IF.
 11539
 11540 3995-EXIT.
 11541      EXIT.
 11542 3996-read-cert-claim-trailer.
 11543
 11544     move cm-ah-benefit-amt      to ws-monthly-benefit
 11545     if (pi-dcc-max-amt < ws-monthly-benefit)
 11546        and (pi-dcc-max-amt not = zeros)
 11547        move pi-dcc-max-amt      to ws-monthly-benefit
 11548     end-if
 11549
 11550     MOVE CM-COMPANY-CD          TO CTRLR-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 219
* EL130.cbl
 11551     MOVE CM-CARRIER             TO CTRLR-CARRIER
 11552     MOVE CM-GROUPING            TO CTRLR-GROUPING
 11553     MOVE CM-STATE               TO CTRLR-STATE
 11554     MOVE CM-ACCOUNT             TO CTRLR-ACCOUNT
 11555     MOVE CM-CERT-EFF-DT         TO CTRLR-EFF-DT
 11556     MOVE CM-CERT-NO             TO CTRLR-CERT-NO
 11557     MOVE 'B'                    TO CTRLR-REC-TYPE
 11558
 11559* EXEC CICS READ
 11560*       DATASET  (ELCRTT-DSID)
 11561*       set     (address of CERTIFICATE-TRAILERS)
 11562*       RIDFLD   (ELCRTT-KEY)
 11563*       RESP     (WS-RESPONSE)
 11564*    END-EXEC
 11565*    MOVE '&"S        E          (  N#00010716' TO DFHEIV0
 11566     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11567     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11568     MOVE X'204E233030303130373136' TO DFHEIV0(25:11)
 11569     CALL 'kxdfhei1' USING DFHEIV0,
 11570           ELCRTT-DSID,
 11571           DFHEIV20,
 11572           DFHEIV99,
 11573           ELCRTT-KEY,
 11574           DFHEIV99,
 11575           DFHEIV99,
 11576           DFHEIV99
 11577     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11578         DFHEIV20
 11579     MOVE EIBRESP  TO WS-RESPONSE
 11580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11581***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11582***                                                            ***
 11583***  This may need some work here. I think I should accumulate ***
 11584***  all the claims with the same claim type?????????          ***
 11585***                                                            ***
 11586***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11587     IF WS-RESP-NORMAL
 11588        move zeros to ws-tot-days-paid ws-tot-amt-paid
 11589        perform varying s1 from +1 by +1 until
 11590           (s1 > +24)
 11591           or (cs-claim-no (s1) = spaces)
 11592           if cs-claim-type (s1) = clmtypei
 11593              move er-1659       to ws-error-no (e1)
 11594              compute ws-tot-days-paid =
 11595                 ws-tot-days-paid + cs-days-paid (s1)
 11596              compute ws-tot-amt-paid =
 11597                 ws-tot-amt-paid + cs-total-paid (s1)
 11598           end-if
 11599        end-perform
 11600*        compute ws-pd-bens rounded = ws-tot-days-paid / 30
 11601*        if (ws-pd-bens >= pi-dcc-max-benefits)
 11602*           and (pi-dcc-max-benefits not = zeros)
 11603*           add +1                to e1
 11604*           MOVE ER-1660          TO EMI-ERROR
 11605*                                    ws-error-no (e1)
 11606*           PERFORM 9900-ERROR-FORMAT
 11607*                                 THRU 9900-EXIT
 11608*        end-if
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 220
* EL130.cbl
 11609     end-if
 11610**       if instypei = 'P'
 11611**          move +1 to s1
 11612**       else
 11613**          MOVE +2 to s1
 11614**       end-if
 11615*
 11616*        move +1 to s1
 11617*        evaluate clmtypei
 11618*           when 'A'
 11619*              move +1 to s2
 11620*           when 'I'
 11621*              move +2 to s2
 11622*           when 'G'
 11623*              move +3 to s2
 11624*           when 'L'
 11625*              move +4 to s2
 11626*           when 'P'
 11627*              move +5 to s2
 11628*        end-evaluate
 11629*        if cs-claim-type (s1 s2) = clmtypei
 11630*           if cs-no-of-claims (s1 s2) > zeros
 11631*              move er-1659       to ws-error-no (e1)
 11632*           end-if
 11633*           compute WS-BENEFITS-PREV-PAID =
 11634*              cs-total-paid (s1 s2) / ws-monthly-benefit
 11635*           if (WS-BENEFITS-PREV-PAID >= pi-dcc-max-benefits)
 11636*              and (pi-dcc-max-benefits not = zeros)
 11637*              add +1             to e1
 11638*              MOVE ER-1660       TO EMI-ERROR
 11639*                                    ws-error-no (e1)
 11640*              PERFORM 9900-ERROR-FORMAT
 11641*                                 THRU 9900-EXIT
 11642*           end-if
 11643*        end-if
 11644*     end-if
 11645
 11646     .
 11647 3996-exit.
 11648     exit.
 11649
 11650 3997-GET-ERPDEF.
 11651
 11652     if cm-clp-state = spaces or low-values or zeros
 11653        move cm-state            to cm-clp-state
 11654     end-if
 11655     MOVE SPACES                 TO WS-ERPDEF-SW
 11656     MOVE ZEROS                  TO WS-MAX-BENEFITS
 11657                                    WS-CRIT-PER-RTW-MOS
 11658                                    WS-CRIT-PER-RECURRENT
 11659
 11660     MOVE PI-COMPANY-CD       TO ERPDEF-KEY
 11661     MOVE CM-clp-state        TO ERPDEF-STATE
 11662     MOVE ws-dcc-product-code TO ERPDEF-PROD-CD
 11663***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11664***                                                            ***
 11665***  If they set up a claim where there is no coverage on the  ***
 11666***  addendum with the intention of denying.  We need to do    ***
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 221
* EL130.cbl
 11667***  some funky stuff here.                                    ***
 11668***                                                            ***
 11669***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11670
 11671     evaluate true
 11672        when (clmtypei = 'L' or 'P')
 11673           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 11674              and 'CU')
 11675           move 'L'              to erpdef-ben-type
 11676           move cm-lf-benefit-cd to erpdef-ben-code
 11677        when (clmtypei not = 'L' and 'P')
 11678           and (cm-ah-benefit-cd not = '00' and '  ')
 11679           move 'A'              to erpdef-ben-type
 11680           move cm-ah-benefit-cd to erpdef-ben-code
 11681        when (clmtypei not = 'L' and 'P')
 11682           and (cm-ah-benefit-cd = '00' or '  ')
 11683           move 'L'              to erpdef-ben-type
 11684           move cm-lf-benefit-cd to erpdef-ben-code
 11685        when (clmtypei = 'L' or 'P')
 11686           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 11687           move 'A'              to erpdef-ben-type
 11688           move cm-ah-benefit-cd to erpdef-ben-code
 11689        when other
 11690           move 'A'              to erpdef-ben-type
 11691           move cm-ah-benefit-cd to erpdef-ben-code
 11692     end-evaluate
 11693*    MOVE 'A'                 TO ERPDEF-BEN-TYPE
 11694*    MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 11695     MOVE CM-CERT-EFF-DT      TO ERPDEF-EXP-DT
 11696     MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 11697
 11698
 11699* EXEC CICS STARTBR
 11700*        DATASET  ('ERPDEF')
 11701*        RIDFLD   (ERPDEF-KEY)
 11702*        GTEQ
 11703*        RESP     (WS-RESPONSE)
 11704*    END-EXEC
 11705     MOVE 'ERPDEF' TO DFHEIV1
 11706     MOVE 0
 11707       TO DFHEIV11
 11708*    MOVE '&,         G          &  N#00010839' TO DFHEIV0
 11709     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11710     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11711     MOVE X'204E233030303130383339' TO DFHEIV0(25:11)
 11712     CALL 'kxdfhei1' USING DFHEIV0,
 11713           DFHEIV1,
 11714           ERPDEF-KEY,
 11715           DFHEIV99,
 11716           DFHEIV11,
 11717           DFHEIV99
 11718     MOVE EIBRESP  TO WS-RESPONSE
 11719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11720
 11721     IF WS-RESP-NORMAL
 11722
 11723* EXEC CICS READNEXT
 11724*          DATASET  ('ERPDEF')
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 222
* EL130.cbl
 11725*          INTO     (PRODUCT-MASTER)
 11726*          RIDFLD   (ERPDEF-KEY)
 11727*          RESP     (WS-RESPONSE)
 11728*       END-EXEC
 11729     MOVE LENGTH OF
 11730      PRODUCT-MASTER
 11731       TO DFHEIV12
 11732     MOVE 'ERPDEF' TO DFHEIV1
 11733     MOVE 0
 11734       TO DFHEIV11
 11735*    MOVE '&.IL                  )  N#00010847' TO DFHEIV0
 11736     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11737     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11738     MOVE X'204E233030303130383437' TO DFHEIV0(25:11)
 11739     CALL 'kxdfhei1' USING DFHEIV0,
 11740           DFHEIV1,
 11741           PRODUCT-MASTER,
 11742           DFHEIV12,
 11743           ERPDEF-KEY,
 11744           DFHEIV99,
 11745           DFHEIV11,
 11746           DFHEIV99,
 11747           DFHEIV99
 11748     MOVE EIBRESP  TO WS-RESPONSE
 11749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11750
 11751        IF WS-RESP-NORMAL
 11752           IF (ERPDEF-KEY-SAVE (1:16) =
 11753              PD-CONTROL-PRIMARY (1:16))
 11754              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 11755
 11756              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 11757                 (A1 > +8)
 11758                 OR (PD-PROD-CODE (A1) = CLMTYPEI)
 11759              END-PERFORM
 11760              IF A1 < +9
 11761                 SET ERPDEF-FOUND TO TRUE
 11762                 move pd-max-amt (a1)
 11763                              to pi-dcc-max-amt
 11764                 MOVE PD-CRIT-PERIOD (A1)
 11765                              TO WS-MAX-BENEFITS
 11766                                 pi-dcc-max-benefits
 11767                 if pd-rec-crit-period (a1) not numeric
 11768                    move 01      to pd-rec-crit-period (a1)
 11769                 end-if
 11770                 MOVE PD-REC-CRIT-PERIOD (A1)
 11771                              TO WS-CRIT-PER-RECURRENT
 11772                 IF PD-RTW-MOS (A1) NUMERIC
 11773                    MOVE PD-RTW-MOS (A1)
 11774                              TO WS-CRIT-PER-RTW-MOS
 11775                 ELSE
 11776                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 11777                 END-IF
 11778                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 11779                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 11780                                 TO WS-EXCL-PERIOD
 11781                 END-IF
 11782                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 223
* EL130.cbl
 11783                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 11784                                 TO WS-COV-ENDS
 11785                 END-IF
 11786                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 11787                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 11788                                 TO WS-ACC-PERIOD
 11789                 END-IF
 11790              else
 11791                 MOVE -1         TO MAINTL
 11792                 move er-1673    to emi-error
 11793                 PERFORM 9900-ERROR-FORMAT
 11794                                 THRU 9900-EXIT
 11795              END-IF
 11796           else
 11797              MOVE -1            TO MAINTL
 11798              move er-1671       to emi-error
 11799              PERFORM 9900-ERROR-FORMAT
 11800                                 THRU 9900-EXIT
 11801           END-IF
 11802        END-IF
 11803     END-IF
 11804
 11805     .
 11806 3997-EXIT.
 11807     EXIT.
 11808
 11809 3998-update-cert-claim-trailer.
 11810
 11811
 11812* EXEC CICS GETMAIN
 11813*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 11814*       LENGTH   (ELCRTT-LENGTH)
 11815*       INITIMG  (GETMAIN-SPACE)
 11816*    END-EXEC
 11817*    MOVE ',"IL                  $   #00010914' TO DFHEIV0
 11818     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11819     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11820     MOVE X'2020233030303130393134' TO DFHEIV0(25:11)
 11821     CALL 'kxdfhei1' USING DFHEIV0,
 11822           DFHEIV20,
 11823           ELCRTT-LENGTH,
 11824           GETMAIN-SPACE
 11825     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11826         DFHEIV20
 11827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11828
 11829     MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 11830     MOVE CM-CARRIER       TO CTRLR-CARRIER
 11831     MOVE CM-GROUPING      TO CTRLR-GROUPING
 11832     MOVE CM-STATE         TO CTRLR-STATE
 11833     MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 11834     MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 11835     MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 11836     MOVE 'B'              TO CTRLR-REC-TYPE
 11837
 11838* EXEC CICS READ
 11839*       UPDATE
 11840*       DATASET  (ELCRTT-DSID)
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 224
* EL130.cbl
 11841*       into     (CERTIFICATE-TRAILERS)
 11842*       RIDFLD   (ELCRTT-KEY)
 11843*       RESP     (WS-RESPONSE)
 11844*    END-EXEC
 11845     MOVE LENGTH OF
 11846      CERTIFICATE-TRAILERS
 11847       TO DFHEIV11
 11848*    MOVE '&"IL       EU         (  N#00010928' TO DFHEIV0
 11849     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11850     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11851     MOVE X'204E233030303130393238' TO DFHEIV0(25:11)
 11852     CALL 'kxdfhei1' USING DFHEIV0,
 11853           ELCRTT-DSID,
 11854           CERTIFICATE-TRAILERS,
 11855           DFHEIV11,
 11856           ELCRTT-KEY,
 11857           DFHEIV99,
 11858           DFHEIV99,
 11859           DFHEIV99
 11860     MOVE EIBRESP  TO WS-RESPONSE
 11861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11862     IF WS-RESP-NORMAL
 11863        perform varying s1 from +1 by +1 until
 11864           (s1 > +24)
 11865           or (cs-claim-no (s1) = spaces)
 11866        end-perform
 11867        if s1 < +25
 11868           perform 3999-upd-crt-trlr thru 3999-exit
 11869
 11870* EXEC CICS REWRITE
 11871*             DATASET  (ELCRTT-DSID)
 11872*             from     (CERTIFICATE-TRAILERS)
 11873*             RESP     (WS-RESPONSE)
 11874*          END-EXEC
 11875     MOVE LENGTH OF
 11876      CERTIFICATE-TRAILERS
 11877       TO DFHEIV11
 11878*    MOVE '&& L                  %  N#00010942' TO DFHEIV0
 11879     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11880     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11881     MOVE X'204E233030303130393432' TO DFHEIV0(25:11)
 11882     CALL 'kxdfhei1' USING DFHEIV0,
 11883           ELCRTT-DSID,
 11884           CERTIFICATE-TRAILERS,
 11885           DFHEIV11,
 11886           DFHEIV99
 11887     MOVE EIBRESP  TO WS-RESPONSE
 11888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11889        end-if
 11890     else
 11891        if ws-resp-notfnd
 11892           move 'CS'             to certificate-trailers
 11893           move cm-control-primary to cs-control-primary
 11894           move 'B'              to cs-trailer-type
 11895           perform varying s1 from +1 by +1 until s1 > +24
 11896              move zeros         to cs-days-paid (s1)
 11897                                    cs-total-paid (s1)
 11898                                    cs-benefit-period (s1)
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 225
* EL130.cbl
 11899                                    cs-remaining-bens (s1)
 11900           end-perform
 11901           move +1               to s1
 11902           perform 3999-upd-crt-trlr
 11903                                 thru 3999-exit
 11904
 11905* EXEC CICS WRITE
 11906*             DATASET  (ELCRTT-DSID)
 11907*             from     (CERTIFICATE-TRAILERS)
 11908*             RIDFLD   (cs-control-primary)
 11909*             RESP     (WS-RESPONSE)
 11910*          END-EXEC
 11911     MOVE LENGTH OF
 11912      CERTIFICATE-TRAILERS
 11913       TO DFHEIV11
 11914*    MOVE '&$ L                  ''  N#00010962' TO DFHEIV0
 11915     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11916     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11917     MOVE X'204E233030303130393632' TO DFHEIV0(25:11)
 11918     CALL 'kxdfhei1' USING DFHEIV0,
 11919           ELCRTT-DSID,
 11920           CERTIFICATE-TRAILERS,
 11921           DFHEIV11,
 11922           cs-control-primary,
 11923           DFHEIV99,
 11924           DFHEIV99
 11925     MOVE EIBRESP  TO WS-RESPONSE
 11926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11927        end-if
 11928     END-IF
 11929
 11930     .
 11931 3998-exit.
 11932     exit.
 11933
 11934 3999-upd-crt-trlr.
 11935     move clmnoi                 to cs-claim-no       (s1)
 11936     move clmtypei               to cs-claim-type     (s1)
 11937     move instypei               to cs-insured-type   (s1)
 11938     if ws-crit-per-recurrent > 01
 11939        move zeros               to cs-benefit-period(s1)
 11940     else
 11941        move 01                  to cs-benefit-period(s1)
 11942     end-if
 11943*    move cl-benefit-period      to cs-benefit-period (s1)
 11944*    move cl-critical-period     to cs-remaining-bens (s1)
 11945     move zeros                  to cs-remaining-bens (s1)
 11946     .
 11947 3999-exit.
 11948     exit.
 11949 4000-CALCULATE-CERT-TERM.
 11950
 11951     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 11952
 11953     MOVE N                      TO WS-TERM.
 11954
 11955     IF WS-TERM GREATER 120
 11956         MOVE 120                TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 226
* EL130.cbl
 11957     END-IF.
 11958
 11959 4000-CALC-TERM-EXIT.
 11960      EXIT.
 11961
 11962 4100-CALC-GROSS-TERM.
 11963     MOVE HOLD-LOAN-BAL           TO L.
 11964     MOVE WS-ACVBENE              TO M.
 11965     COMPUTE N = L / M.
 11966     IF N LESS 1
 11967         MOVE 1  TO N
 11968     END-IF.
 11969
 11970     IF LCVCDL GREATER ZERO
 11971         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 11972     ELSE
 11973         MOVE ZEROS               TO WS-LF-RATE
 11974     END-IF.
 11975
 11976     IF ACVCDL GREATER ZERO
 11977         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 11978     ELSE
 11979         MOVE ZEROS               TO WS-AH-RATE
 11980     END-IF.
 11981
 11982     COMPUTE I = WS-APR / +1200.
 11983
 11984 4105-LOOP.
 11985     IF N GREATER 240
 11986         GO TO 4200-EXIT
 11987     END-IF.
 11988
 11989     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 11990
 11991     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 11992         ADD 1 TO N
 11993         GO TO 4105-LOOP
 11994     END-IF.
 11995
 11996 4200-EXIT.
 11997      EXIT.
 11998
 11999 4210-CALC-LEFT-RIGHTONE.
 12000      MOVE L         TO LEFT-TOT-1.
 12001      SUBTRACT 1 FROM N.
 12002      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 12003      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 12004      ADD 1 TO N.
 12005
 12006 4211-CALC-TERM1.
 12007      MOVE N         TO TERM1.
 12008      MULTIPLY M BY TERM1.
 12009
 12010 4212-LOOP.
 12011      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 12012      ADD 1 TO A-N.
 12013      MULTIPLY A-N BY TERM1.
 12014      SUBTRACT 1 FROM A-N.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 227
* EL130.cbl
 12015      ADD TERM1 TO LEFT-TOT-1.
 12016
 12017 4213-CALC-TERM2.
 12018      MOVE M         TO TERM2.
 12019      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 12020      MULTIPLY IA-N BY TERM2.
 12021      SUBTRACT TERM2 FROM LEFT-TOT-1.
 12022
 12023 4215-CALC-RIGHTONE.
 12024      MOVE M         TO RIGHT-TOT-1.
 12025      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 12026      MULTIPLY A-N BY RIGHT-TOT-1.
 12027
 12028 4220-EXIT.
 12029      EXIT.
 12030
 12031 4300-CALC-A-N.
 12032     IF N LESS 1
 12033         MOVE 0     TO A-N
 12034         GO TO 4300-EXIT
 12035     END-IF.
 12036
 12037     IF I = 0
 12038         MOVE .00001 TO I
 12039     END-IF.
 12040
 12041     ADD 1 TO I.
 12042     DIVIDE I INTO 1 GIVING V.
 12043     SUBTRACT 1 FROM I.
 12044     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 12045     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 12046     DIVIDE I INTO TERM3 GIVING A-N.
 12047
 12048 4300-EXIT.
 12049      EXIT.
 12050
 12051 4350-CALC-IA-N.
 12052     IF N LESS 1
 12053         MOVE 0      TO IA-N
 12054         GO TO 4400-EXIT
 12055     END-IF.
 12056
 12057     ADD 1 TO N.
 12058     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 12059     SUBTRACT 1 FROM N.
 12060     MULTIPLY N BY V-EX-N GIVING TERM3.
 12061     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 12062     SUBTRACT V FROM 1 GIVING TERM4.
 12063     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 12064
 12065 4400-EXIT.
 12066      EXIT.
 12067
 12068 4450-CALC-V-EX-N.
 12069     IF N LESS 1
 12070         MOVE 1    TO V-EX-N
 12071         GO TO 4490-EXIT
 12072     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 228
* EL130.cbl
 12073
 12074     MOVE N        TO NV-STORE.
 12075
 12076     IF V-EX-ONETIME = 1  OR
 12077        V NOT = V-EXPONENT (1)
 12078          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 12079     END-IF.
 12080
 12081 4460-LOOP.
 12082     IF N GREATER 248
 12083         MOVE 248 TO N
 12084     END-IF.
 12085
 12086     IF N = 1
 12087         MOVE V               TO V-EX-N
 12088     ELSE
 12089         MOVE V-EXPONENT (N)  TO V-EX-N
 12090     END-IF.
 12091
 12092     GO TO 4490-EXIT.
 12093
 12094 4470-BUILD-V-EX-TABLE.
 12095     MOVE 2      TO N.
 12096     MOVE V      TO V-EXPONENT (1)
 12097                    V-EX-N.
 12098
 12099 4471-LOOP.
 12100     MULTIPLY V BY V-EX-N.
 12101     MOVE V-EX-N   TO V-EXPONENT (N).
 12102
 12103     ADD 1 TO N.
 12104     IF N LESS 248
 12105         GO TO 4471-LOOP
 12106     END-IF.
 12107
 12108     MOVE NV-STORE     TO N.
 12109     MOVE ZERO         TO V-EX-ONETIME.
 12110
 12111 4480-EXIT.
 12112      EXIT.
 12113
 12114 4490-EXIT.
 12115      EXIT.
 12116
 12117 4500-CALC-NET-TERM.
 12118     MOVE HOLD-LOAN-BAL           TO L.
 12119     MOVE WS-ACVBENE              TO M.
 12120     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 12121
 12122     IF WS-REMAIN GREATER ZERO
 12123         ADD 1 TO N
 12124     END-IF.
 12125
 12126     IF N = 0
 12127         MOVE 1 TO N
 12128     END-IF.
 12129
 12130 4700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 229
* EL130.cbl
 12131      EXIT.
 12132
 12133 4999-CALC-TERM-EXIT.
 12134     EXIT.
 12135
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 230
* EL130.cbl
 12137 5000-INCURRED-CHANGE.
 12138     IF NOT MODIFY-CAP
 12139         MOVE ER-0070            TO EMI-ERROR
 12140         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12141         MOVE -1                 TO MAINTL
 12142         GO TO 8200-SEND-DATAONLY
 12143     END-IF.
 12144
 12145     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 12146        CLMCARRI     NOT = PI-LAST-CARR        OR
 12147        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 12148        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 12149        PI-INCURR-SW NOT = 'Y'
 12150          GO TO 1000-SHOW-CLAIM
 12151     END-IF.
 12152
 12153     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 12154     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 12155     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 12156
 12157     IF EMI-NO-ERRORS
 12158         GO TO 5000-TRY-TO-BUILD
 12159     END-IF.
 12160
 12161     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 12162        MOVE ER-0433             TO EMI-ERROR
 12163        MOVE -1                  TO MAINTL
 12164        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12165        GO TO 8200-SEND-DATAONLY
 12166     END-IF.
 12167
 12168     IF EIBAID = DFHPF6
 12169         IF EMI-FATAL-CTR NOT EQUAL ZERO
 12170            MOVE ER-0434         TO EMI-ERROR
 12171            MOVE -1              TO MAINTL
 12172            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12173            GO TO 8200-SEND-DATAONLY
 12174         ELSE
 12175            MOVE +1              TO INCURL
 12176            GO TO 5000-TRY-TO-BUILD
 12177         END-IF
 12178     END-IF.
 12179
 12180     GO TO 8200-SEND-DATAONLY.
 12181
 12182 5000-TRY-TO-BUILD.
 12183
 12184     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 12185
 12186     MOVE CLMCARRI               TO MSTR-CARRIER.
 12187
 12188     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 12189     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 12190     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 12191
 12192     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 12193
 12194     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 231
* EL130.cbl
 12195         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 12196     END-IF.
 12197
 12198     IF CL-PURGED-DT NOT = LOW-VALUES
 12199
 12200
 12201* EXEC CICS UNLOCK
 12202*            DATASET   (ELMSTR-DSID)
 12203*        END-EXEC
 12204*    MOVE '&*                    #   #00011241' TO DFHEIV0
 12205     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12206     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12207     MOVE X'2020233030303131323431' TO DFHEIV0(25:11)
 12208     CALL 'kxdfhei1' USING DFHEIV0,
 12209           ELMSTR-DSID,
 12210           DFHEIV99
 12211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12212         MOVE ER-7691            TO EMI-ERROR
 12213         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12214         MOVE -1                 TO MAINTL
 12215         GO TO 8200-SEND-DATAONLY
 12216     END-IF.
 12217
 12218     IF CL-AUTO-PAY-SEQ NOT = ZERO
 12219
 12220
 12221* EXEC CICS UNLOCK
 12222*            DATASET   (ELMSTR-DSID)
 12223*       END-EXEC
 12224*    MOVE '&*                    #   #00011252' TO DFHEIV0
 12225     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12226     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12227     MOVE X'2020233030303131323532' TO DFHEIV0(25:11)
 12228     CALL 'kxdfhei1' USING DFHEIV0,
 12229           ELMSTR-DSID,
 12230           DFHEIV99
 12231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12232         MOVE ER-0523             TO EMI-ERROR
 12233         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12234         MOVE -1                  TO MAINTL
 12235         GO TO 8200-SEND-DATAONLY
 12236     END-IF.
 12237
 12238     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 12239
 12240     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 12241     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 12242     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 12243     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 12244     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 12245
 12246     IF MANRSVL GREATER ZERO
 12247        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 12248                                    AT-CURRENT-MANUAL-RESERVE
 12249     END-IF.
 12250     MOVE 1                      TO SUB.
 12251
 12252 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 232
* EL130.cbl
 12253     IF SUB = 1
 12254        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 12255        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 12256        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 12257     ELSE
 12258        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 12259        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 12260                                    AT-OPEN-CLOSE-REASON (SUB)
 12261     END-IF.
 12262
 12263     IF SUB NOT = 6
 12264        ADD 1                    TO SUB
 12265        GO TO 5010-LOOP
 12266     END-IF.
 12267
 12268 5020-UPDATE.
 12269
 12270     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12271
 12272     IF DIAGL = ZERO
 12273       AND ICD1L = ZERO
 12274       AND ICD2L = ZERO
 12275         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 12276         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 12277         MOVE AT-ICD-CODE-1      TO WS-ICD-CODE-1
 12278         MOVE AT-ICD-CODE-2      TO WS-ICD-CODE-2
 12279         GO TO 5025-BYPASS-UPDATE
 12280     END-IF.
 12281
 12282     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 12283
 12284     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 12285     IF DIAGL NOT = ZERO
 12286         MOVE DIAGI              TO AT-INFO-LINE-1
 12287     END-IF.
 12288
 12289     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
 12290     IF ICD1L NOT = ZERO
 12291         MOVE ICD1I              TO AT-ICD-CODE-1
 12292     END-IF.
 12293
 12294     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
 12295     IF ICD2L NOT = ZERO
 12296         MOVE ICD2I              TO AT-ICD-CODE-2
 12297     END-IF.
 12298
 12299     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12300
 12301 5025-BYPASS-UPDATE.
 12302
 12303
 12304
 12305* EXEC CICS GETMAIN
 12306*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12307*        LENGTH   (ELTRLR-LENGTH)
 12308*    END-EXEC.
 12309*    MOVE '," L                  $   #00011327' TO DFHEIV0
 12310     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 233
* EL130.cbl
 12311     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12312     MOVE X'2020233030303131333237' TO DFHEIV0(25:11)
 12313     CALL 'kxdfhei1' USING DFHEIV0,
 12314           DFHEIV20,
 12315           ELTRLR-LENGTH,
 12316           DFHEIV99
 12317     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12318         DFHEIV20
 12319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12320
 12321
 12322     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 12323     MOVE 'AT'                   TO AT-RECORD-ID.
 12324
 12325     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 12326     MOVE MSTR-CARRIER           TO AT-CARRIER.
 12327     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 12328     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 12329     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 12330     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 12331     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12332     MOVE '9'                    TO AT-TRAILER-TYPE.
 12333     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 12334     MOVE '5'                    TO DC-OPTION-CODE.
 12335     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12336     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 12337
 12338     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 12339     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12340
 12341     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 12342     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 12343     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 12344     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 12345     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 12346     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 12347     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 12348     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 12349     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 12350     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 12351     MOVE WS-ICD-CODE-1          TO AT-OLD-ICD-CODE-1.
 12352     MOVE WS-ICD-CODE-2          TO AT-OLD-ICD-CODE-2.
 12353
 12354     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 12355     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 12356     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 12357     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 12358     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 12359
 12360
 12361
 12362* EXEC CICS WRITE
 12363*        DATASET   (ELTRLR-DSID)
 12364*        FROM      (ACTIVITY-TRAILERS)
 12365*        RIDFLD    (AT-CONTROL-PRIMARY)
 12366*    END-EXEC.
 12367     MOVE LENGTH OF
 12368      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 234
* EL130.cbl
 12369       TO DFHEIV11
 12370*    MOVE '&$ L                  ''   #00011371' TO DFHEIV0
 12371     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12372     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12373     MOVE X'2020233030303131333731' TO DFHEIV0(25:11)
 12374     CALL 'kxdfhei1' USING DFHEIV0,
 12375           ELTRLR-DSID,
 12376           ACTIVITY-TRAILERS,
 12377           DFHEIV11,
 12378           AT-CONTROL-PRIMARY,
 12379           DFHEIV99,
 12380           DFHEIV99
 12381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12382
 12383
 12384     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12385     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12386     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 12387     MOVE CL-CERT-STATE          TO CERT-STATE.
 12388     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12389     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 12390     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 12391
 12392
 12393
 12394* EXEC CICS HANDLE CONDITION
 12395*        NOTFND   (5050-CERT-NOT-FOUND)
 12396*    END-EXEC.
 12397*    MOVE '"$I                   ! < #00011386' TO DFHEIV0
 12398     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12399     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12400     MOVE X'3C20233030303131333836' TO DFHEIV0(25:11)
 12401     CALL 'kxdfhei1' USING DFHEIV0
 12402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12403
 12404
 12405     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 12406
 12407     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 12408
 12409
 12410
 12411* EXEC CICS HANDLE CONDITION
 12412*         DUPKEY   (5030-CERT-WRITTEN)
 12413*    END-EXEC.
 12414*    MOVE '"$$                   ! = #00011395' TO DFHEIV0
 12415     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12417     MOVE X'3D20233030303131333935' TO DFHEIV0(25:11)
 12418     CALL 'kxdfhei1' USING DFHEIV0
 12419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12420
 12421
 12422
 12423
 12424* EXEC CICS REWRITE
 12425*        DATASET  (ELCERT-DSID)
 12426*        FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 235
* EL130.cbl
 12427*    END-EXEC.
 12428     MOVE LENGTH OF
 12429      CERTIFICATE-MASTER
 12430       TO DFHEIV11
 12431*    MOVE '&& L                  %   #00011400' TO DFHEIV0
 12432     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12433     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12434     MOVE X'2020233030303131343030' TO DFHEIV0(25:11)
 12435     CALL 'kxdfhei1' USING DFHEIV0,
 12436           ELCERT-DSID,
 12437           CERTIFICATE-MASTER,
 12438           DFHEIV11,
 12439           DFHEIV99
 12440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12441
 12442
 12443 5030-CERT-WRITTEN.
 12444
 12445     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 12446                                    CL-INCURRED-DT
 12447                                    CL-REPORTED-DT
 12448                                    CL-EST-END-OF-DISAB-DT
 12449                                    CL-PAID-THRU-DT.
 12450
 12451     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 12452                                    CL-NO-OF-PMTS-MADE
 12453                                    CL-NO-OF-DAYS-PAID.
 12454
 12455     IF CLAIM-IS-CLOSED
 12456        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 12457        MOVE 'O'                 TO CL-CLAIM-STATUS
 12458     END-IF.
 12459
 12460     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 12461     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 12462     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 12463
 12464
 12465
 12466* EXEC CICS HANDLE CONDITION
 12467*         DUPKEY   (5035-CLAIM-WRITTEN)
 12468*    END-EXEC.
 12469*    MOVE '"$$                   ! > #00011427' TO DFHEIV0
 12470     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12471     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12472     MOVE X'3E20233030303131343237' TO DFHEIV0(25:11)
 12473     CALL 'kxdfhei1' USING DFHEIV0
 12474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12475
 12476
 12477
 12478
 12479* EXEC CICS REWRITE
 12480*        DATASET   (ELMSTR-DSID)
 12481*        FROM      (CLAIM-MASTER)
 12482*    END-EXEC.
 12483     MOVE LENGTH OF
 12484      CLAIM-MASTER
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 236
* EL130.cbl
 12485       TO DFHEIV11
 12486*    MOVE '&& L                  %   #00011432' TO DFHEIV0
 12487     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12488     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12489     MOVE X'2020233030303131343332' TO DFHEIV0(25:11)
 12490     CALL 'kxdfhei1' USING DFHEIV0,
 12491           ELMSTR-DSID,
 12492           CLAIM-MASTER,
 12493           DFHEIV11,
 12494           DFHEIV99
 12495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12496
 12497
 12498 5035-CLAIM-WRITTEN.
 12499
 12500     MOVE ER-0000                TO EMI-ERROR.
 12501     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12502
 12503     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 12504     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 12505     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 12506     MOVE CLMCARRI               TO PI-LAST-CARR.
 12507
 12508     IF PRTOPTL GREATER ZERO
 12509         MOVE PRTOPTI            TO PI-PRT-OPT
 12510     END-IF.
 12511
 12512     IF ALTPRTL GREATER ZERO
 12513         MOVE ALTPRTI            TO PI-ALT-PRT
 12514     END-IF.
 12515
 12516     MOVE LOW-VALUES             TO EL130AI.
 12517
 12518     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 12519     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 12520     MOVE PI-LAST-CARR           TO CLMCARRO.
 12521     MOVE PI-LAST-CLAIM          TO CLMNOO.
 12522
 12523     IF PI-PRT-OPT = 'N' OR 'L'
 12524         MOVE PI-PRT-OPT         TO PRTOPTO
 12525         MOVE 1                  TO PRTOPTL
 12526     END-IF.
 12527
 12528     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 12529         MOVE PI-ALT-PRT         TO ALTPRTO
 12530         MOVE 4                  TO ALTPRTL
 12531     END-IF.
 12532
 12533     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 12534     MOVE AL-SANON               TO CERTNOA SUFXA.
 12535
 12536     MOVE SPACES                 TO PI-INCURR-SW.
 12537
 12538     IF PRTOPTL GREATER ZERO
 12539         IF PRTOPTI = 'L'
 12540             GO TO 0400-CREATE-ELACTQ
 12541         ELSE
 12542             GO TO 0480-PRINT-NOW
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 237
* EL130.cbl
 12543         END-IF
 12544     END-IF.
 12545
 12546     GO TO 8100-SEND-INITIAL-MAP.
 12547
 12548 5050-CERT-NOT-FOUND.
 12549
 12550     MOVE ER-0244                TO EMI-ERROR.
 12551     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12552     MOVE -1                     TO CERTNOL.
 12553     GO TO 8200-SEND-DATAONLY.
 12554
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 238
* EL130.cbl
 12556 5500-BUILD-FORM-TRAILER.
 12557*************************************************************
 12558*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12559*************************************************************
 12560
 12561     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 12562
 12563     IF  WS-BEN-ALPHA-2 = '30'
 12564         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 12565         MOVE '6'                TO DC-OPTION-CODE
 12566         IF CL-CARRIER = 'C'
 12567             MOVE +14            TO DC-ELAPSED-DAYS
 12568             MOVE +0             TO DC-ELAPSED-MONTHS
 12569             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12570             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 12571         ELSE
 12572             MOVE +21            TO DC-ELAPSED-DAYS
 12573             MOVE +0             TO DC-ELAPSED-MONTHS
 12574             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12575             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 12576         END-IF
 12577     END-IF.
 12578
 12579
 12580
 12581* EXEC CICS GETMAIN
 12582*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12583*         LENGTH   (ELTRLR-LENGTH)
 12584*         INITIMG  (GETMAIN-SPACE)
 12585*    END-EXEC.
 12586*    MOVE ',"IL                  $   #00011519' TO DFHEIV0
 12587     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12588     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12589     MOVE X'2020233030303131353139' TO DFHEIV0(25:11)
 12590     CALL 'kxdfhei1' USING DFHEIV0,
 12591           DFHEIV20,
 12592           ELTRLR-LENGTH,
 12593           GETMAIN-SPACE
 12594     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12595         DFHEIV20
 12596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12597
 12598
 12599     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 12600     MOVE 'AT'                   TO AT-RECORD-ID.
 12601
 12602     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 12603     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12604     MOVE 'A'                    TO AT-TRAILER-TYPE.
 12605     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 12606                                    AT-FORM-LAST-MAINT-DT.
 12607     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 12608                                    AT-FORM-LAST-UPDATED-BY.
 12609     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12610     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 12611     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 12612                                    AT-FORM-RE-SEND-DT
 12613                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 239
* EL130.cbl
 12614                                    AT-EMP-FORM-ANSWERED-DT
 12615                                    AT-PHY-FORM-ANSWERED-DT
 12616                                    AT-EMP-FORM-SEND-ON-DT
 12617                                    AT-FORM-PRINTED-DT
 12618                                    AT-FORM-REPRINT-DT.
 12619     MOVE '1'                    TO AT-FORM-TYPE.
 12620
 12621     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 12622                                    AT-INSTRUCT-LN-2
 12623                                    AT-INSTRUCT-LN-3.
 12624
 12625     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 12626     MOVE 'I'                    TO AT-FORM-ADDRESS.
 12627
 12628     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 12629
 12630     IF AM-EMPLOYER-STMT-USED = 'Y'
 12631        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 12632     END-IF.
 12633
 12634
 12635
 12636* EXEC CICS WRITE
 12637*         DATASET  (ELTRLR-DSID)
 12638*         FROM     (ACTIVITY-TRAILERS)
 12639*         RIDFLD   (AT-CONTROL-PRIMARY)
 12640*    END-EXEC.
 12641     MOVE LENGTH OF
 12642      ACTIVITY-TRAILERS
 12643       TO DFHEIV11
 12644*    MOVE '&$ L                  ''   #00011561' TO DFHEIV0
 12645     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12646     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12647     MOVE X'2020233030303131353631' TO DFHEIV0(25:11)
 12648     CALL 'kxdfhei1' USING DFHEIV0,
 12649           ELTRLR-DSID,
 12650           ACTIVITY-TRAILERS,
 12651           DFHEIV11,
 12652           AT-CONTROL-PRIMARY,
 12653           DFHEIV99,
 12654           DFHEIV99
 12655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12656
 12657
 12658 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 240
* EL130.cbl
 12660*************************************************************
 12661*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12662*************************************************************
 12663
 12664 5700-BUILD-ARCHIVE-HEADER.
 12665
 12666     MOVE '1'                    TO CNTL-REC-TYPE.
 12667     MOVE ZEROS                  TO CNTL-SEQ-NO.
 12668     MOVE SPACES                 TO CNTL-ACCESS.
 12669
 12670
 12671
 12672* EXEC CICS READ
 12673*         DATASET  (ELCNTL-DSID)
 12674*         SET      (ADDRESS OF CONTROL-FILE)
 12675*         RIDFLD   (ELCNTL-KEY)
 12676*         UPDATE
 12677*    END-EXEC.
 12678*    MOVE '&"S        EU         (   #00011580' TO DFHEIV0
 12679     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12680     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12681     MOVE X'2020233030303131353830' TO DFHEIV0(25:11)
 12682     CALL 'kxdfhei1' USING DFHEIV0,
 12683           ELCNTL-DSID,
 12684           DFHEIV20,
 12685           DFHEIV99,
 12686           ELCNTL-KEY,
 12687           DFHEIV99,
 12688           DFHEIV99,
 12689           DFHEIV99
 12690     SET ADDRESS OF CONTROL-FILE TO
 12691         DFHEIV20
 12692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12693
 12694
 12695     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 12696
 12697     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 12698
 12699
 12700
 12701* EXEC CICS REWRITE
 12702*         FROM     (CONTROL-FILE)
 12703*         DATASET  (ELCNTL-DSID)
 12704*    END-EXEC.
 12705     MOVE LENGTH OF
 12706      CONTROL-FILE
 12707       TO DFHEIV11
 12708*    MOVE '&& L                  %   #00011592' TO DFHEIV0
 12709     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12710     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12711     MOVE X'2020233030303131353932' TO DFHEIV0(25:11)
 12712     CALL 'kxdfhei1' USING DFHEIV0,
 12713           ELCNTL-DSID,
 12714           CONTROL-FILE,
 12715           DFHEIV11,
 12716           DFHEIV99
 12717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 241
* EL130.cbl
 12718
 12719
 12720
 12721
 12722* EXEC CICS HANDLE CONDITION
 12723*         NOTOPEN  (9990-ABEND)
 12724*         DUPKEY   (5799-EXIT)
 12725*    END-EXEC.
 12726*    MOVE '"$J$                  ! ? #00011598' TO DFHEIV0
 12727     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 12728     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12729     MOVE X'3F20233030303131353938' TO DFHEIV0(25:11)
 12730     CALL 'kxdfhei1' USING DFHEIV0
 12731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12732
 12733
 12734
 12735
 12736* EXEC CICS GETMAIN
 12737*         SET     (ADDRESS OF LETTER-ARCHIVE)
 12738*         LENGTH  (ELARCH-LENGTH)
 12739*    END-EXEC.
 12740*    MOVE '," L                  $   #00011604' TO DFHEIV0
 12741     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 12742     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12743     MOVE X'2020233030303131363034' TO DFHEIV0(25:11)
 12744     CALL 'kxdfhei1' USING DFHEIV0,
 12745           DFHEIV20,
 12746           ELARCH-LENGTH,
 12747           DFHEIV99
 12748     SET ADDRESS OF LETTER-ARCHIVE TO
 12749         DFHEIV20
 12750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12751
 12752
 12753     MOVE SPACES                 TO LETTER-ARCHIVE.
 12754     MOVE 'LA'                   TO LA-RECORD-ID.
 12755     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 12756                                    LA-ARCHIVE-NO-A1.
 12757     MOVE '4'                    TO LA-RECORD-TYPE
 12758                                    LA-RECORD-TYPE-A1.
 12759     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 12760                                    LA-LINE-SEQ-NO-A1.
 12761     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 12762                                    LA-COMPANY-CD-A1.
 12763     MOVE CL-CARRIER             TO LA4-CARRIER.
 12764     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 12765     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 12766     MOVE CL-CERT-STATE          TO LA4-STATE.
 12767     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 12768     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 12769     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 12770     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 12771                                    LA4-RESEND-PRINT-DATE
 12772                                    LA4-FORM-REM-PRINT-DT
 12773                                    LA4-RESEND-DATE.
 12774     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 12775     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 242
* EL130.cbl
 12776
 12777
 12778
 12779* EXEC CICS WRITE
 12780*         DATASET  (ELARCH-DSID)
 12781*         FROM     (LETTER-ARCHIVE)
 12782*         RIDFLD   (LA-CONTROL-PRIMARY)
 12783*    END-EXEC.
 12784     MOVE LENGTH OF
 12785      LETTER-ARCHIVE
 12786       TO DFHEIV11
 12787*    MOVE '&$ L                  ''   #00011634' TO DFHEIV0
 12788     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12789     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12790     MOVE X'2020233030303131363334' TO DFHEIV0(25:11)
 12791     CALL 'kxdfhei1' USING DFHEIV0,
 12792           ELARCH-DSID,
 12793           LETTER-ARCHIVE,
 12794           DFHEIV11,
 12795           LA-CONTROL-PRIMARY,
 12796           DFHEIV99,
 12797           DFHEIV99
 12798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12799
 12800
 12801 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 243
* EL130.cbl
 12803 6000-EDIT-CLAIM-DATA.
 12804
 12805     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 12806     MOVE '2'                    TO DC-OPTION-CODE.
 12807     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12808     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 12809
 12810     IF MAINTL NOT = ZERO
 12811         MOVE AL-UANON           TO MAINTA
 12812     END-IF
 12813
 12814     IF CLMNOL GREATER ZERO
 12815         IF CLMNOI = SPACES OR LOW-VALUES
 12816             MOVE -1             TO CLMNOL
 12817             MOVE AL-UABON       TO CLMNOA
 12818             MOVE ER-7688        TO EMI-ERROR
 12819             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12820         ELSE
 12821             MOVE AL-UANON       TO CLMNOA
 12822         END-IF
 12823     END-IF.
 12824
 12825     IF CERTNOL = ZERO
 12826         MOVE -1                 TO CERTNOL
 12827         MOVE AL-SABON           TO CERTNOA
 12828         MOVE ER-0203            TO EMI-ERROR
 12829         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12830     ELSE
 12831         MOVE AL-SANON           TO CERTNOA
 12832     END-IF.
 12833
 12834     IF SUFXL = ZERO
 12835         MOVE SPACES             TO SUFXI
 12836         MOVE AL-SANON           TO SUFXA
 12837     ELSE
 12838         MOVE AL-SANON           TO SUFXA
 12839     END-IF.
 12840
 12841     IF CLMCARRL = ZERO
 12842         MOVE -1                 TO CLMCARRL
 12843         MOVE ER-0194            TO EMI-ERROR
 12844         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12845     ELSE
 12846         MOVE CLMCARRI           TO PI-CARRIER
 12847         IF PI-NO-CARRIER-SECURITY
 12848             MOVE AL-UANON       TO CLMCARRA
 12849         END-IF
 12850     END-IF.
 12851
 12852     IF CLMTYPEL > ZERO
 12853        IF ((PI-COMPANY-ID = 'DCC' OR 'VPP')
 12854           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12855              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G' AND 'F'))
 12856                        OR
 12857           ((PI-COMPANY-ID = 'CID' OR 'AHL')
 12858           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12859              AND PI-AH-OVERRIDE-L1))
 12860              MOVE -1             TO CLMTYPEL
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 244
* EL130.cbl
 12861              MOVE AL-UABON       TO CLMTYPEA
 12862              MOVE ER-7634        TO EMI-ERROR
 12863              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12864        ELSE
 12865           MOVE AL-UANON       TO CLMTYPEA
 12866        END-IF
 12867     ELSE
 12868        IF MAINTI = 'A'
 12869           MOVE -1             TO CLMTYPEL
 12870           MOVE AL-UABON       TO CLMTYPEA
 12871           MOVE ER-0546        TO EMI-ERROR
 12872           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12873        END-IF
 12874     END-IF
 12875     if instypel > ZERO
 12876        if instypei = 'P' OR 'C'
 12877           move al-uanon         to instypea
 12878        else
 12879           MOVE -1               TO INSTYPEL
 12880           MOVE AL-UABON         TO INSTYPEA
 12881           MOVE ER-1654          TO EMI-ERROR
 12882           PERFORM 9900-ERROR-FORMAT
 12883                                 THRU 9900-EXIT
 12884        END-IF
 12885     ELSE
 12886        IF MAINTI = 'A'
 12887           MOVE -1               TO INSTYPEL
 12888           MOVE AL-UABON         TO INSTYPEA
 12889           MOVE ER-1654          TO EMI-ERROR
 12890           PERFORM 9900-ERROR-FORMAT
 12891                                 THRU 9900-EXIT
 12892        END-IF
 12893     END-IF
 12894     if (instypel <> zeros)
 12895        and (emi-error not = er-1654)
 12896        and (instypei = 'C')
 12897        and (crtfnmei = fstnmei)
 12898        move er-1675             to emi-error
 12899        MOVE -1                  TO INSTYPEL
 12900        MOVE AL-UABON            TO INSTYPEA
 12901        PERFORM 9900-ERROR-FORMAT
 12902                                 THRU 9900-EXIT
 12903    end-if
 12904     if (instypel <> zeros)
 12905        and (emi-error not = er-1654)
 12906        and (instypei = 'P')
 12907        and (crtfnmei <> fstnmei)
 12908        move er-1676             to emi-error
 12909        MOVE -1                  TO INSTYPEL
 12910        MOVE AL-UABON            TO INSTYPEA
 12911        PERFORM 9900-ERROR-FORMAT
 12912                                 THRU 9900-EXIT
 12913    end-if
 12914     IF PCERTNOL = ZERO
 12915        MOVE CERTNOI             TO PCERTNOI
 12916        MOVE CERTNOL             TO PCERTNOL
 12917        MOVE AL-UANON            TO PCERTNOA
 12918     ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 245
* EL130.cbl
 12919        MOVE AL-UANON            TO PCERTNOA
 12920     END-IF.
 12921
 12922     IF PSUFXL = ZERO
 12923        MOVE SUFXI               TO PSUFXI
 12924        MOVE SUFXL               TO PSUFXL
 12925        MOVE AL-UANON            TO PSUFXA
 12926     ELSE
 12927        MOVE AL-UANON            TO PSUFXA
 12928     END-IF.
 12929
 12930     IF MAINTI = 'I'
 12931         GO TO 6020-EDIT
 12932     END-IF.
 12933
 12934     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 12935         MOVE -1                 TO LSTNMEL
 12936         MOVE ER-0236            TO EMI-ERROR
 12937         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12938     ELSE
 12939         MOVE AL-UANON           TO LSTNMEA
 12940     END-IF.
 12941     if fstnmel not = zeros
 12942        move al-uanon            to fstnmea
 12943     end-if
 12944     IF SEXL > ZEROS
 12945        IF SEXI = 'M' OR 'F'
 12946           move al-uanon         to sexa
 12947           CONTINUE
 12948        ELSE
 12949           MOVE -1               TO SEXL
 12950           MOVE AL-UABON         TO SEXA
 12951           MOVE ER-0219          TO EMI-ERROR
 12952           PERFORM 9900-ERROR-FORMAT
 12953                                 THRU 9900-EXIT
 12954        END-IF
 12955     ELSE
 12956        IF MAINTI = 'A'
 12957           MOVE -1               TO SEXL
 12958           MOVE AL-UABON         TO SEXA
 12959           MOVE ER-0219          TO EMI-ERROR
 12960           PERFORM 9900-ERROR-FORMAT
 12961                                 THRU 9900-EXIT
 12962        END-IF
 12963     END-IF
 12964     IF SSNL GREATER THAN ZERO
 12965         MOVE SSNI TO WS-SOC-SEC-NUMBER
 12966         IF WS-SOC-SEC-NO NUMERIC AND
 12967           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 12968             NEXT SENTENCE
 12969         ELSE
 12970            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 12971               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 12972               WS-SSN-DASH2 = '-'
 12973                 NEXT SENTENCE
 12974            ELSE
 12975                 MOVE ER-0887        TO  EMI-ERROR
 12976                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 246
* EL130.cbl
 12977                 MOVE AL-UABON       TO  SSNA
 12978                 MOVE -1             TO  SSNL
 12979            END-IF
 12980        END-IF
 12981     END-IF.
 12982
 12983     IF BIRTHDTL = ZERO
 12984         GO TO 6020-EDIT
 12985     END-IF.
 12986
 12987     IF BIRTHDTL GREATER ZERO
 12988         MOVE BIRTHDTI           TO DATE-WORK
 12989         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12990         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12991         MOVE '4'                TO DC-OPTION-CODE
 12992         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12993         IF DATE-CONVERSION-ERROR
 12994             MOVE AL-UABON       TO BIRTHDTA
 12995             MOVE -1             TO BIRTHDTL
 12996             MOVE ER-0220        TO EMI-ERROR
 12997             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12998             GO TO 6020-EDIT
 12999         END-IF
 13000     END-IF.
 13001
 13002******************************************************************
 13003**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 13004**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 13005**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
 13006******************************************************************
 13007
 13008     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 13009         MOVE BIRTHDTI           TO  DATE-WORK
 13010         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13011         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 13012         MOVE '4'                TO  DC-OPTION-CODE
 13013         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
 13014         MOVE +0                 TO  DC-ELAPSED-MONTHS
 13015                                     DC-ELAPSED-DAYS
 13016         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13017         IF DATE-CONVERSION-ERROR
 13018             MOVE AL-UABON       TO  BIRTHDTA
 13019             MOVE -1             TO  BIRTHDTL
 13020             MOVE ER-0220        TO  EMI-ERROR
 13021             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13022             GO TO 6020-EDIT
 13023         END-IF
 13024     END-IF.
 13025
 13026     MOVE AL-UANON               TO  BIRTHDTA.
 13027     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 13028     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 13029     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 13030
 13031 6020-EDIT.
 13032     IF INCURL GREATER ZERO
 13033         MOVE INCURI             TO DATE-WORK
 13034         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 247
* EL130.cbl
 13035         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13036         MOVE '4'                TO DC-OPTION-CODE
 13037         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13038         IF DATE-CONVERSION-ERROR
 13039             MOVE AL-UABON       TO INCURA
 13040             MOVE -1             TO INCURL
 13041             MOVE ER-0222        TO EMI-ERROR
 13042             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13043         ELSE
 13044             MOVE AL-UANON       TO INCURA
 13045             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 13046             MOVE DC-BIN-DATE-1  TO WS-INCUR
 13047                                    PI-SAVE-INCUR-DT
 13048             IF WS-INCUR GREATER THAN WS-TODAY-DT
 13049                 MOVE ER-0511     TO EMI-ERROR
 13050                 MOVE -1          TO INCURL
 13051                 MOVE AL-UABON    TO INCURA
 13052                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13053             ELSE
 13054*                NEXT SENTENCE
 13055                 CONTINUE
 13056             END-IF
 13057         END-IF
 13058     ELSE
 13059         MOVE ER-0516         TO EMI-ERROR
 13060         MOVE AL-UABON        TO INCURA
 13061         MOVE -1              TO INCURL
 13062         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13063     END-IF.
 13064
 13065     IF REPORTL GREATER ZERO
 13066         MOVE REPORTI            TO DATE-WORK
 13067         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13068         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13069         MOVE '4'                TO DC-OPTION-CODE
 13070         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13071         IF DATE-CONVERSION-ERROR
 13072             MOVE AL-UABON       TO REPORTA
 13073             MOVE -1             TO REPORTL
 13074             MOVE ER-0223        TO EMI-ERROR
 13075             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13076         ELSE
 13077             MOVE AL-UANON       TO REPORTA
 13078             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 13079             MOVE DC-BIN-DATE-1  TO WS-REPORT
 13080             IF WS-REPORT GREATER THAN WS-TODAY-DT
 13081                 MOVE ER-0512     TO EMI-ERROR
 13082                 MOVE -1          TO REPORTL
 13083                 MOVE AL-UABON    TO REPORTA
 13084                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13085             ELSE
 13086*                NEXT SENTENCE
 13087                 CONTINUE
 13088             END-IF
 13089         END-IF
 13090     ELSE
 13091         MOVE ER-0517         TO EMI-ERROR
 13092         MOVE -1              TO REPORTL
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 248
* EL130.cbl
 13093         MOVE AL-UABON        TO REPORTA
 13094         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13095     END-IF.
 13096
 13097     IF WS-REPORT NOT = LOW-VALUES
 13098         IF WS-INCUR GREATER THAN WS-REPORT
 13099             MOVE AL-UABON       TO REPORTA
 13100             MOVE -1             TO REPORTL
 13101             MOVE ER-0509        TO EMI-ERROR
 13102             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13103         END-IF
 13104     END-IF.
 13105
 13106     IF ICD1L GREATER THAN ZERO
 13107         IF (ICD1I GREATER THAN SPACES) AND
 13108            (ICD1I(4:1) NOT = '.')
 13109             IF ICD1I(4:1) = ' '
 13110                 MOVE '.' TO ICD1I(4:1)
 13111             ELSE
 13112                 IF ICD1I(8:1) = ' '
 13113                     MOVE ICD1I(7:1) TO ICD1I(8:1)
 13114                     MOVE ICD1I(6:1) TO ICD1I(7:1)
 13115                     MOVE ICD1I(5:1) TO ICD1I(6:1)
 13116                     MOVE ICD1I(4:1) TO ICD1I(5:1)
 13117                     MOVE '.'        TO ICD1I(4:1)
 13118                 END-IF
 13119             END-IF
 13120         END-IF
 13121         IF (ICD1I GREATER THAN SPACES) AND
 13122            (ICD1I(1:1) NOT > ' ' OR
 13123             ICD1I(2:1) NOT > ' ' OR
 13124             ICD1I(3:1) NOT > ' ' OR
 13125             ICD1I(4:1) NOT = '.')
 13126              MOVE ER-0992        TO  EMI-ERROR
 13127              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13128              MOVE AL-UABON       TO ICD1A
 13129              MOVE -1             TO ICD1L
 13130         END-IF
 13131     END-IF.
 13132
 13133     IF ICD2L GREATER THAN ZERO
 13134         IF (ICD2I GREATER THAN SPACES) AND
 13135            (ICD2I(4:1) NOT = '.')
 13136             IF ICD2I(4:1) = ' '
 13137                 MOVE '.' TO ICD2I(4:1)
 13138             ELSE
 13139                 IF ICD2I(8:1) = ' '
 13140                     MOVE ICD2I(7:1) TO ICD2I(8:1)
 13141                     MOVE ICD2I(6:1) TO ICD2I(7:1)
 13142                     MOVE ICD2I(5:1) TO ICD2I(6:1)
 13143                     MOVE ICD2I(4:1) TO ICD2I(5:1)
 13144                     MOVE '.'        TO ICD2I(4:1)
 13145                 END-IF
 13146             END-IF
 13147         END-IF
 13148         IF (ICD2I GREATER THAN SPACES) AND
 13149            (ICD2I(1:1) NOT > ' ' OR
 13150             ICD2I(2:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 249
* EL130.cbl
 13151             ICD2I(3:1) NOT > ' ' OR
 13152             ICD2I(4:1) NOT = '.')
 13153              MOVE ER-0992        TO  EMI-ERROR
 13154              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13155              MOVE AL-UABON       TO ICD2A
 13156              MOVE -1             TO ICD2L
 13157         END-IF
 13158     END-IF
 13159
 13160*    IF ESTENDL GREATER ZERO
 13161*        MOVE ESTENDI            TO DATE-WORK
 13162*        PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13163*        MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13164*        MOVE '4'                TO DC-OPTION-CODE
 13165*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13166*        IF DATE-CONVERSION-ERROR
 13167*            MOVE AL-UABON       TO ESTENDA
 13168*            MOVE -1             TO ESTENDL
 13169*            MOVE ER-0224        TO EMI-ERROR
 13170*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13171*        ELSE
 13172*            MOVE AL-UANON       TO ESTENDA
 13173*            MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 13174*            MOVE DC-BIN-DATE-1  TO WS-ESTEND
 13175*            IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13176*               MOVE AL-UABON    TO ESTENDA
 13177*               MOVE -1          TO ESTENDL
 13178*               MOVE ER-0544     TO EMI-ERROR
 13179*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13180*            END-IF
 13181*        END-IF
 13182*    END-IF.
 13183*
 13184*    IF WS-ESTEND NOT = LOW-VALUES
 13185*        IF WS-INCUR GREATER THAN WS-ESTEND
 13186*            MOVE AL-UABON       TO ESTENDA
 13187*            MOVE -1             TO ESTENDL
 13188*            MOVE ER-0510        TO EMI-ERROR
 13189*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13190*        END-IF
 13191*    END-IF.
 13192
 13193     IF PRTOPTL GREATER ZERO
 13194         IF PRTOPTI NOT = 'N' AND 'L'
 13195             MOVE AL-UABON       TO PRTOPTA
 13196             MOVE -1             TO PRTOPTL
 13197             MOVE ER-0334        TO EMI-ERROR
 13198             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13199         END-IF
 13200     END-IF.
 13201
 13202     IF MANRSVL GREATER ZERO
 13203
 13204* EXEC CICS BIF DEEDIT
 13205*            FIELD   (MANRSVI)
 13206*            LENGTH  (9)
 13207*        END-EXEC
 13208     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 250
* EL130.cbl
 13209       TO DFHEIV11
 13210*    MOVE '@"L                   #   #00012042' TO DFHEIV0
 13211     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13212     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13213     MOVE X'2020233030303132303432' TO DFHEIV0(25:11)
 13214     CALL 'kxdfhei1' USING DFHEIV0,
 13215           MANRSVI,
 13216           DFHEIV11
 13217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13218         IF MANRSVI NOT NUMERIC
 13219             MOVE AL-UNBON       TO MANRSVA
 13220             MOVE -1             TO MANRSVL
 13221             MOVE ER-0489        TO EMI-ERROR
 13222             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13223         ELSE
 13224             MOVE AL-UNNON       TO MANRSVA
 13225             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 13226         END-IF
 13227     END-IF.
 13228
 13229     MOVE SPACES                 TO ELCNTL-KEY.
 13230
 13231     IF CONTROL-IS-ACTUAL-CARRIER
 13232         MOVE PI-CARRIER         TO CNTL-CARRIER
 13233     ELSE
 13234         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 13235     END-IF.
 13236
 13237     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13238     MOVE '6'                    TO CNTL-REC-TYPE.
 13239     MOVE +0                     TO CNTL-SEQ-NO.
 13240
 13241
 13242
 13243* EXEC CICS HANDLE CONDITION
 13244*        NOTFND   (3100-CARRIER-NOT-FOUND)
 13245*    END-EXEC.
 13246*    MOVE '"$I                   ! @ #00012070' TO DFHEIV0
 13247     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13248     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13249     MOVE X'4020233030303132303730' TO DFHEIV0(25:11)
 13250     CALL 'kxdfhei1' USING DFHEIV0
 13251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13252
 13253
 13254     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13255
 13256     IF NOT CF-MANUAL-RESERVES-USED AND
 13257           WS-MANRSV GREATER ZERO
 13258         MOVE ER-0518             TO EMI-ERROR
 13259         MOVE -1                  TO MANRSVL
 13260         MOVE AL-UNBON            TO MANRSVA
 13261         MOVE ZEROS               TO WS-MANRSV
 13262         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13263     END-IF.
 13264
 13265     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 13266     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 251
* EL130.cbl
 13267
 13268     IF SUPVL GREATER ZERO
 13269         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 13270             MOVE -1             TO SUPVL
 13271             MOVE AL-UABON       TO SUPVA
 13272             MOVE ER-0230        TO EMI-ERROR
 13273             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13274         ELSE
 13275             MOVE AL-UANON       TO SUPVA
 13276         END-IF
 13277     END-IF.
 13278
 13279     IF PROCCDL = ZERO
 13280        GO TO 6050-CONTINUE-EDITS
 13281     END-IF.
 13282
 13283     MOVE SPACES                 TO ELCNTL-KEY.
 13284     MOVE PROCCDI                TO CNTL-ACCESS.
 13285
 13286     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13287     MOVE '2'                    TO CNTL-REC-TYPE.
 13288     MOVE +0                     TO CNTL-SEQ-NO.
 13289
 13290
 13291
 13292* EXEC CICS HANDLE CONDITION
 13293*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 13294*    END-EXEC.
 13295*    MOVE '"$I                   ! A #00012111' TO DFHEIV0
 13296     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13297     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13298     MOVE X'4120233030303132313131' TO DFHEIV0(25:11)
 13299     CALL 'kxdfhei1' USING DFHEIV0
 13300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13301
 13302
 13303     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13304
 13305     GO TO 6050-CONTINUE-EDITS.
 13306
 13307 6040-NO-PROCESSOR-RECORD.
 13308     MOVE ER-0019                TO EMI-ERROR.
 13309     MOVE -1                     TO PROCCDL.
 13310     MOVE AL-UABON               TO PROCCDA.
 13311     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13312
 13313 6050-CONTINUE-EDITS.
 13314     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 13315           GO TO 6070-CONTINUE-EDITS
 13316     END-IF.
 13317
 13318     MOVE BENECDI                TO BENE-CODE.
 13319     MOVE 'B'                    TO BENE-RCD-TYPE.
 13320     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 13321
 13322
 13323
 13324* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 252
* EL130.cbl
 13325*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 13326*    END-EXEC.
 13327*    MOVE '"$I                   ! B #00012135' TO DFHEIV0
 13328     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13329     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13330     MOVE X'4220233030303132313335' TO DFHEIV0(25:11)
 13331     CALL 'kxdfhei1' USING DFHEIV0
 13332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13333
 13334
 13335
 13336* EXEC CICS READ
 13337*         DATASET   (ELBENE-DSID)
 13338*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 13339*         RIDFLD    (ELBENE-KEY)
 13340*    END-EXEC.
 13341*    MOVE '&"S        E          (   #00012139' TO DFHEIV0
 13342     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13343     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13344     MOVE X'2020233030303132313339' TO DFHEIV0(25:11)
 13345     CALL 'kxdfhei1' USING DFHEIV0,
 13346           ELBENE-DSID,
 13347           DFHEIV20,
 13348           DFHEIV99,
 13349           ELBENE-KEY,
 13350           DFHEIV99,
 13351           DFHEIV99,
 13352           DFHEIV99
 13353     SET ADDRESS OF BENEFICIARY-MASTER TO
 13354         DFHEIV20
 13355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13356
 13357
 13358     GO TO 6070-CONTINUE-EDITS.
 13359
 13360 6060-NO-BENEFICIARY-RECORD.
 13361     MOVE ER-0565                TO EMI-ERROR.
 13362     MOVE -1                     TO BENECDL.
 13363     MOVE AL-UABON               TO BENECDA.
 13364     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13365
 13366
 13367 6070-CONTINUE-EDITS.
 13368     IF CERTMTL GREATER ZERO
 13369         IF CERTMTI NOT = 'A' AND 'S'
 13370             MOVE -1             TO CERTMTL
 13371             MOVE AL-UABON       TO CERTMTA
 13372             MOVE ER-0267        TO EMI-ERROR
 13373             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13374         ELSE
 13375             MOVE AL-UANON       TO CERTMTA
 13376         END-IF
 13377     ELSE
 13378         GO TO 6000-EXIT
 13379     END-IF.
 13380
 13381     IF EFFDTL GREATER ZERO
 13382         MOVE EFFDTI             TO DATE-WORK
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 253
* EL130.cbl
 13383         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13384         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13385         MOVE '4'                TO DC-OPTION-CODE
 13386         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13387         IF DATE-CONVERSION-ERROR
 13388             MOVE AL-UABON       TO EFFDTA
 13389             MOVE -1             TO EFFDTL
 13390             MOVE ER-0231        TO EMI-ERROR
 13391             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13392         ELSE
 13393             MOVE AL-UANON       TO EFFDTA
 13394             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 13395             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 13396         END-IF
 13397     ELSE
 13398         MOVE ER-0231            TO EMI-ERROR
 13399         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13400         MOVE -1                 TO EFFDTL
 13401         MOVE AL-UABON           TO EFFDTA
 13402     END-IF.
 13403
 13404     IF ACCOUNTL = ZERO
 13405         MOVE ER-0232            TO EMI-ERROR
 13406         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13407         MOVE AL-UABON           TO ACCOUNTA
 13408         MOVE -1                 TO ACCOUNTL
 13409     ELSE
 13410         MOVE AL-UANON           TO ACCOUNTA
 13411     END-IF.
 13412
 13413     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 13414        (STATEL = ZERO)
 13415         MOVE ER-0233        TO EMI-ERROR
 13416         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13417         MOVE AL-UABON       TO STATEA
 13418         MOVE -1             TO STATEL
 13419     ELSE
 13420         MOVE AL-UANON       TO STATEA
 13421     END-IF.
 13422
 13423     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 13424        (CRTCARRL = ZERO)
 13425         MOVE ER-0234        TO EMI-ERROR
 13426         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13427         MOVE AL-UABON       TO CRTCARRA
 13428         MOVE -1             TO CRTCARRL
 13429     ELSE
 13430         MOVE AL-UANON       TO CRTCARRA
 13431     END-IF.
 13432
 13433     IF PI-CERT-ACCESS-CONTROL = '1' AND
 13434        GROUPL = ZERO
 13435         MOVE ER-0235            TO EMI-ERROR
 13436         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13437         MOVE AL-UABON           TO GROUPA
 13438         MOVE -1                 TO GROUPL
 13439     ELSE
 13440         MOVE AL-UANON           TO GROUPA
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 254
* EL130.cbl
 13441     END-IF.
 13442
 13443     IF CRTLNMEL = ZERO
 13444         IF LSTNMEI = SPACES OR LOW-VALUES
 13445             MOVE ER-0236            TO  EMI-ERROR
 13446             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13447             MOVE AL-UABON           TO  CRTLNMEA
 13448             MOVE -1                 TO  CRTLNMEL
 13449         ELSE
 13450             MOVE LSTNMEI            TO  CRTLNMEI
 13451             MOVE AL-UANON           TO  CRTLNMEA
 13452         END-IF
 13453     ELSE
 13454         MOVE AL-UANON               TO  CRTLNMEA
 13455     END-IF.
 13456
 13457     IF CRTFNMEL = ZERO
 13458         IF FSTNMEI = SPACES OR LOW-VALUES
 13459*            NEXT SENTENCE
 13460             CONTINUE
 13461         ELSE
 13462             MOVE FSTNMEI            TO  CRTFNMEI
 13463             MOVE AL-UANON           TO  CRTFNMEA
 13464         END-IF
 13465     END-IF.
 13466
 13467     IF CRTINITL = ZERO
 13468         IF INITI = SPACES OR LOW-VALUES
 13469*            NEXT SENTENCE
 13470             CONTINUE
 13471         ELSE
 13472             MOVE INITI              TO  CRTINITI
 13473             MOVE AL-UANON           TO  CRTINITA
 13474         END-IF
 13475     END-IF.
 13476
 13477 6000-EXIT.
 13478     EXIT.
 13479
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 255
* EL130.cbl
 13481 6200-EDIT-CERT-DATA.
 13482     IF ISSAGEL GREATER ZERO
 13483         IF ISSAGEI NOT NUMERIC
 13484             MOVE ER-0237        TO EMI-ERROR
 13485             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13486             MOVE -1             TO ISSAGEL
 13487             MOVE AL-UNBON       TO ISSAGEA
 13488         ELSE
 13489             MOVE AL-UNNON       TO ISSAGEA
 13490         END-IF
 13491     END-IF.
 13492
 13493     IF JNTAGEL GREATER ZERO
 13494         IF JNTAGEI NOT NUMERIC
 13495             MOVE ER-0238        TO EMI-ERROR
 13496             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13497             MOVE -1             TO JNTAGEL
 13498             MOVE AL-UNBON       TO JNTAGEA
 13499         ELSE
 13500             MOVE AL-UNNON       TO JNTAGEA
 13501         END-IF
 13502     END-IF.
 13503
 13504     IF LCVCDL GREATER ZERO
 13505         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 13506         IF INVALID-BENEFIT-CODE
 13507             MOVE ER-7635        TO EMI-ERROR
 13508             MOVE -1             TO LCVCDL
 13509             MOVE AL-UABON       TO LCVCDA
 13510             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13511         ELSE
 13512             MOVE LCVCDI         TO WS-BEN-HOLD
 13513             MOVE '4'            TO WS-REC-TYPE
 13514             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13515             IF WS-BEN-ALPHA-HOLD = SPACES
 13516                MOVE ER-7635     TO EMI-ERROR
 13517                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13518                MOVE -1          TO LCVCDL
 13519                MOVE AL-UABON    TO LCVCDA
 13520             ELSE
 13521                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 13522                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 13523                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 13524                MOVE AL-UANON           TO LCVCDA
 13525             END-IF
 13526         END-IF
 13527     END-IF.
 13528
 13529     IF ACVCDL GREATER ZERO
 13530         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 13531         IF INVALID-BENEFIT-CODE
 13532             MOVE ER-7635        TO EMI-ERROR
 13533             MOVE -1             TO ACVCDL
 13534             MOVE AL-UABON       TO ACVCDA
 13535             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13536         ELSE
 13537             MOVE ACVCDI         TO WS-BEN-HOLD
 13538             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 256
* EL130.cbl
 13539             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13540             IF WS-BEN-ALPHA-HOLD = SPACES
 13541                MOVE ER-7635     TO EMI-ERROR
 13542                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13543                MOVE -1          TO ACVCDL
 13544                MOVE AL-UABON    TO ACVCDA
 13545             ELSE
 13546                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 13547                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 13548                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 13549                MOVE AL-UANON           TO ACVCDA
 13550             END-IF
 13551         END-IF
 13552     END-IF.
 13553
 13554     IF LCVOTRML GREATER ZERO
 13555         IF LCVOTRMI NOT NUMERIC
 13556             MOVE ER-7636        TO EMI-ERROR
 13557             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13558             MOVE -1             TO LCVOTRML
 13559             MOVE AL-UNBON       TO LCVOTRMA
 13560         ELSE
 13561             MOVE AL-UNNON       TO LCVOTRMA
 13562         END-IF
 13563     END-IF.
 13564
 13565     IF ACVOTRML GREATER ZERO
 13566         IF ACVOTRMI NOT NUMERIC
 13567             MOVE ER-7636        TO EMI-ERROR
 13568             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13569             MOVE -1             TO ACVOTRML
 13570             MOVE AL-UNBON       TO ACVOTRMA
 13571         ELSE
 13572             MOVE AL-UNNON       TO ACVOTRMA
 13573         END-IF
 13574     END-IF.
 13575
 13576     IF LCVRATEL GREATER ZERO
 13577
 13578* EXEC CICS BIF DEEDIT
 13579*            FIELD    (LCVRATEI)
 13580*            LENGTH   (06)
 13581*        END-EXEC
 13582     MOVE 06
 13583       TO DFHEIV11
 13584*    MOVE '@"L                   #   #00012364' TO DFHEIV0
 13585     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13586     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13587     MOVE X'2020233030303132333634' TO DFHEIV0(25:11)
 13588     CALL 'kxdfhei1' USING DFHEIV0,
 13589           LCVRATEI,
 13590           DFHEIV11
 13591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13592         IF LCVRATEI NOT NUMERIC
 13593             MOVE AL-UNBON       TO LCVRATEA
 13594             MOVE -1             TO LCVRATEL
 13595             MOVE ER-2280        TO EMI-ERROR
 13596             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 257
* EL130.cbl
 13597         ELSE
 13598             MOVE AL-UNNON       TO LCVRATEA
 13599             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 13600         END-IF
 13601     END-IF.
 13602
 13603     IF ACVRATEL GREATER ZERO
 13604
 13605* EXEC CICS BIF DEEDIT
 13606*            FIELD    (ACVRATEI)
 13607*            LENGTH   (06)
 13608*        END-EXEC
 13609     MOVE 06
 13610       TO DFHEIV11
 13611*    MOVE '@"L                   #   #00012380' TO DFHEIV0
 13612     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13613     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13614     MOVE X'2020233030303132333830' TO DFHEIV0(25:11)
 13615     CALL 'kxdfhei1' USING DFHEIV0,
 13616           ACVRATEI,
 13617           DFHEIV11
 13618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13619         IF ACVRATEI NOT NUMERIC
 13620             MOVE AL-UNBON       TO ACVRATEA
 13621             MOVE -1             TO ACVRATEL
 13622             MOVE ER-2280        TO EMI-ERROR
 13623             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13624         ELSE
 13625             MOVE AL-UNNON       TO ACVRATEA
 13626             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 13627         END-IF
 13628     END-IF.
 13629
 13630     IF LCVBENEL GREATER ZERO
 13631
 13632* EXEC CICS BIF DEEDIT
 13633*            FIELD    (LCVBENEI)
 13634*            LENGTH   (11)
 13635*        END-EXEC
 13636     MOVE 11
 13637       TO DFHEIV11
 13638*    MOVE '@"L                   #   #00012396' TO DFHEIV0
 13639     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13640     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13641     MOVE X'2020233030303132333936' TO DFHEIV0(25:11)
 13642     CALL 'kxdfhei1' USING DFHEIV0,
 13643           LCVBENEI,
 13644           DFHEIV11
 13645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13646         IF LCVBENEI NOT NUMERIC
 13647             MOVE AL-UNBON       TO LCVBENEA
 13648             MOVE -1             TO LCVBENEL
 13649             MOVE ER-7637        TO EMI-ERROR
 13650             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13651         ELSE
 13652             MOVE AL-UNNON       TO LCVBENEA
 13653             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 13654         END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 258
* EL130.cbl
 13655     END-IF.
 13656
 13657     IF ACVBENEL GREATER ZERO
 13658
 13659* EXEC CICS BIF DEEDIT
 13660*            FIELD    (ACVBENEI)
 13661*            LENGTH   (11)
 13662*        END-EXEC
 13663     MOVE 11
 13664       TO DFHEIV11
 13665*    MOVE '@"L                   #   #00012412' TO DFHEIV0
 13666     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13667     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13668     MOVE X'2020233030303132343132' TO DFHEIV0(25:11)
 13669     CALL 'kxdfhei1' USING DFHEIV0,
 13670           ACVBENEI,
 13671           DFHEIV11
 13672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13673         IF ACVBENEI NOT NUMERIC
 13674             MOVE AL-UNBON       TO ACVBENEA
 13675             MOVE -1             TO ACVBENEL
 13676             MOVE ER-7637        TO EMI-ERROR
 13677             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13678         ELSE
 13679             MOVE AL-UNNON       TO ACVBENEA
 13680             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 13681         END-IF
 13682     END-IF.
 13683
 13684     IF LCVCNDTL GREATER ZERO
 13685         IF LCVCNDTI NOT = SPACES
 13686             MOVE LCVCNDTI        TO DATE-WORK
 13687             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13688             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13689             MOVE '4'             TO DC-OPTION-CODE
 13690             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13691             IF DATE-CONVERSION-ERROR
 13692                 MOVE AL-UABON    TO LCVCNDTA
 13693                 MOVE -1          TO LCVCNDTL
 13694                 MOVE ER-7638     TO EMI-ERROR
 13695                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13696             ELSE
 13697                 MOVE AL-UANON    TO LCVCNDTA
 13698                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 13699                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 13700             END-IF
 13701         END-IF
 13702     END-IF.
 13703
 13704     IF ACVCNDTL GREATER ZERO
 13705         IF ACVCNDTI NOT = SPACES
 13706             MOVE ACVCNDTI        TO DATE-WORK
 13707             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13708             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13709             MOVE '4'             TO DC-OPTION-CODE
 13710             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13711             IF DATE-CONVERSION-ERROR
 13712                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 259
* EL130.cbl
 13713                 MOVE -1          TO ACVCNDTL
 13714                 MOVE ER-7638     TO EMI-ERROR
 13715                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13716             ELSE
 13717                 MOVE AL-UANON    TO ACVCNDTA
 13718                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 13719                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 13720             END-IF
 13721         END-IF
 13722     END-IF.
 13723
 13724     IF ADDONDTL GREATER ZERO
 13725         MOVE ADDONDTI        TO DATE-WORK
 13726         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13727         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13728         MOVE '4'             TO DC-OPTION-CODE
 13729         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13730         IF DATE-CONVERSION-ERROR
 13731             MOVE AL-UABON    TO ADDONDTA
 13732             MOVE -1          TO ADDONDTL
 13733             MOVE ER-7651     TO EMI-ERROR
 13734             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13735         ELSE
 13736             MOVE AL-UANON    TO ADDONDTA
 13737             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 13738             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 13739         END-IF
 13740     END-IF.
 13741
 13742     IF APRL GREATER ZERO
 13743
 13744* EXEC CICS BIF DEEDIT
 13745*            FIELD    (APRI)
 13746*            LENGTH   (8)
 13747*        END-EXEC
 13748     MOVE 8
 13749       TO DFHEIV11
 13750*    MOVE '@"L                   #   #00012486' TO DFHEIV0
 13751     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13752     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13753     MOVE X'2020233030303132343836' TO DFHEIV0(25:11)
 13754     CALL 'kxdfhei1' USING DFHEIV0,
 13755           APRI,
 13756           DFHEIV11
 13757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13758         IF APRI NOT NUMERIC
 13759             MOVE AL-UNBON       TO APRA
 13760             MOVE -1             TO APRL
 13761             MOVE ER-0248        TO EMI-ERROR
 13762             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13763         ELSE
 13764             MOVE AL-UNNON       TO APRA
 13765             MOVE APRI           TO WS-APR APRO
 13766         END-IF
 13767     END-IF.
 13768
 13769     IF PMTFREQL GREATER ZERO
 13770
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 260
* EL130.cbl
 13771* EXEC CICS BIF DEEDIT
 13772*            FIELD   (PMTFREQI)
 13773*            LENGTH  (2)
 13774*        END-EXEC
 13775     MOVE 2
 13776       TO DFHEIV11
 13777*    MOVE '@"L                   #   #00012502' TO DFHEIV0
 13778     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13779     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13780     MOVE X'2020233030303132353032' TO DFHEIV0(25:11)
 13781     CALL 'kxdfhei1' USING DFHEIV0,
 13782           PMTFREQI,
 13783           DFHEIV11
 13784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13785         IF PMTFREQI NOT NUMERIC
 13786             MOVE -1             TO PMTFREQL
 13787             MOVE AL-UNBON       TO PMTFREQA
 13788             MOVE ER-0258        TO EMI-ERROR
 13789             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13790         ELSE
 13791             MOVE AL-UNNON       TO PMTFREQA
 13792             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 13793         END-IF
 13794     END-IF.
 13795
 13796     IF INDGRPL GREATER ZERO
 13797         IF INDGRPI = 'I' OR 'G'
 13798             MOVE AL-UANON       TO INDGRPA
 13799         ELSE
 13800             MOVE -1 TO INDGRPL
 13801             MOVE AL-UABON       TO INDGRPA
 13802             MOVE ER-0260        TO EMI-ERROR
 13803             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13804         END-IF
 13805     END-IF.
 13806
 13807     IF LOANBALL GREATER ZERO
 13808         MOVE LOANBALI           TO DEEDIT-FIELD
 13809
 13810* EXEC CICS BIF DEEDIT
 13811*            FIELD   (DEEDIT-FIELD)
 13812*            LENGTH  (12)
 13813*        END-EXEC
 13814     MOVE 12
 13815       TO DFHEIV11
 13816*    MOVE '@"L                   #   #00012530' TO DFHEIV0
 13817     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13818     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13819     MOVE X'2020233030303132353330' TO DFHEIV0(25:11)
 13820     CALL 'kxdfhei1' USING DFHEIV0,
 13821           DEEDIT-FIELD,
 13822           DFHEIV11
 13823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13824         IF DEEDIT-FIELD NOT NUMERIC
 13825             MOVE AL-UNBON       TO LOANBALA
 13826             MOVE -1             TO LOANBALL
 13827             MOVE ER-0247        TO EMI-ERROR
 13828             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 261
* EL130.cbl
 13829         ELSE
 13830             MOVE AL-UNNON       TO LOANBALA
 13831             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 13832         END-IF
 13833     END-IF.
 13834
 13835     IF PREMTYPL GREATER ZERO
 13836         IF (PREMTYPI = '1' OR '2' OR '3')
 13837             MOVE AL-UANON       TO PREMTYPA
 13838         ELSE
 13839             MOVE -1             TO PREMTYPL
 13840             MOVE AL-UABON       TO PREMTYPA
 13841             MOVE ER-0227        TO EMI-ERROR
 13842             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13843         END-IF
 13844     END-IF.
 13845
 13846     IF REINCDL GREATER ZERO
 13847         MOVE LOW-VALUES         TO  ERREIN-KEY
 13848         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 13849         MOVE REINCDI            TO  REIN-CODE-1
 13850                                     REIN-CODE-2
 13851                                     REIN-CODE-3
 13852         MOVE 'A'                TO  REIN-TYPE
 13853         PERFORM 7992-READ-REIN THRU 7992-EXIT
 13854         IF REIN-REC-NOT-FOUND
 13855             MOVE ER-0266        TO  EMI-ERROR
 13856             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13857             MOVE -1             TO  REINCDL
 13858             MOVE AL-UABON       TO  REINCDA
 13859         ELSE
 13860             MOVE AL-UANON       TO  REINCDA
 13861         END-IF
 13862     END-IF.
 13863
 13864     IF CERTMTI NOT = 'A'
 13865        GO TO 6200-EXIT
 13866     END-IF.
 13867
 13868     IF PREMTYPI = '1'
 13869         IF LCVCDL GREATER ZERO
 13870             IF WS-LF-SPECIAL-CALC-CD = 'O'
 13871                 MOVE ER-0841        TO  EMI-ERROR
 13872                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13873                 MOVE -1             TO  PREMTYPL
 13874                 MOVE AL-UABON       TO  PREMTYPA
 13875             END-IF
 13876         END-IF
 13877     END-IF.
 13878
 13879     IF PREMTYPI = '1'
 13880         IF ACVCDL GREATER ZERO
 13881             IF WS-AH-SPECIAL-CALC-CD = 'O'
 13882                 MOVE ER-0841        TO  EMI-ERROR
 13883                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13884                 MOVE -1             TO  PREMTYPL
 13885                 MOVE AL-UABON       TO  PREMTYPA
 13886             END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 262
* EL130.cbl
 13887         END-IF
 13888     END-IF.
 13889
 13890     IF PREMTYPI = '2'
 13891         IF LCVCDL GREATER ZERO
 13892             IF (PI-COMPANY-ID = 'HAN') AND
 13893                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 13894                        OR
 13895                 WS-LF-SPECIAL-CALC-CD = 'O'
 13896*                NEXT SENTENCE
 13897                 CONTINUE
 13898             ELSE
 13899                 MOVE ER-0840        TO  EMI-ERROR
 13900                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13901                 MOVE -1             TO  PREMTYPL
 13902                 MOVE AL-UABON       TO  PREMTYPA
 13903             END-IF
 13904         END-IF
 13905     END-IF.
 13906
 13907     IF PREMTYPI = '2'
 13908         IF ACVCDL GREATER ZERO
 13909             IF (PI-COMPANY-ID = 'HAN')  AND
 13910                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 13911                        OR
 13912                 WS-AH-SPECIAL-CALC-CD = 'O'
 13913*                NEXT SENTENCE
 13914                 CONTINUE
 13915             ELSE
 13916                 MOVE ER-0840        TO  EMI-ERROR
 13917                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13918                 MOVE -1             TO  PREMTYPL
 13919                 MOVE AL-UABON       TO  PREMTYPA
 13920             END-IF
 13921         END-IF
 13922     END-IF.
 13923
 13924     IF LCVCDL = ZEROS
 13925        GO TO 6200-EXIT
 13926     END-IF.
 13927
 13928     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 13929         IF PMTFREQI NOT = ZEROS
 13930             MOVE ER-0428        TO EMI-ERROR
 13931             MOVE -1             TO PMTFREQL
 13932             MOVE AL-UNBON       TO PMTFREQA
 13933             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13934             GO TO 6200-CHECK-APR
 13935         END-IF
 13936     END-IF.
 13937
 13938     IF PMTFREQL = ZEROS AND TEX-REG
 13939         MOVE ER-0429            TO EMI-ERROR
 13940         MOVE -1                 TO PMTFREQL
 13941         MOVE AL-UNBON           TO PMTFREQA
 13942         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13943         GO TO 6200-CHECK-APR
 13944     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 263
* EL130.cbl
 13945
 13946     IF LCVOTRMI NOT NUMERIC
 13947         GO TO 6200-CHECK-APR
 13948     END-IF.
 13949
 13950     IF WS-PMTFREQ NOT = ZERO
 13951         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 13952         GIVING DIVIDE-QUOT
 13953         REMAINDER DIVIDE-REM
 13954         IF DIVIDE-REM GREATER ZERO
 13955             MOVE ER-0430            TO EMI-ERROR
 13956             MOVE -1                 TO PMTFREQL
 13957             MOVE AL-UNBON           TO PMTFREQA
 13958             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13959         END-IF
 13960     END-IF.
 13961
 13962 6200-CHECK-APR.
 13963     IF NET-PAY AND APRL = ZEROS
 13964        MOVE ER-0257             TO EMI-ERROR
 13965        MOVE -1                  TO APRL
 13966        MOVE AL-UABON            TO APRA
 13967        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13968     END-IF.
 13969
 13970 6200-EXIT.
 13971     EXIT.
 13972
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 264
* EL130.cbl
 13974 6300-REQUIRED-CERT-EDIT.
 13975
 13976     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 13977        GO TO 6300-REQUIRED-AH-EDIT
 13978     END-IF
 13979
 13980     IF LCVCDL = ZERO
 13981        MOVE ER-7639             TO EMI-ERROR
 13982        MOVE -1                  TO LCVCDL
 13983        MOVE AL-UABON            TO LCVCDA
 13984        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13985     END-IF.
 13986
 13987     IF LCVOTRML = ZERO
 13988        MOVE ER-7670             TO EMI-ERROR
 13989        MOVE -1                  TO LCVOTRML
 13990        MOVE AL-UNBON            TO LCVOTRMA
 13991        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13992     END-IF.
 13993
 13994     IF LCVBENEL = ZERO
 13995        MOVE ER-7671             TO EMI-ERROR
 13996        MOVE -1                  TO LCVBENEL
 13997        MOVE AL-UNBON            TO LCVBENEA
 13998        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13999     END-IF.
 14000
 14001     GO TO 6399-EXIT.
 14002
 14003 6300-REQUIRED-AH-EDIT.
 14004
 14005     IF ACVCDL = ZERO
 14006        MOVE ER-7639             TO EMI-ERROR
 14007        MOVE -1                  TO ACVCDL
 14008        MOVE AL-UABON            TO ACVCDA
 14009        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14010     END-IF.
 14011
 14012     IF ACVOTRML = ZERO
 14013         MOVE ER-7670             TO EMI-ERROR
 14014         MOVE -1                  TO ACVOTRML
 14015         MOVE AL-UNBON            TO ACVOTRMA
 14016         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14017     END-IF.
 14018
 14019     IF ACVBENEL = ZERO
 14020        MOVE ER-7671             TO EMI-ERROR
 14021        MOVE -1                  TO ACVBENEL
 14022        MOVE AL-UNBON            TO ACVBENEA
 14023        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14024     END-IF.
 14025
 14026 6399-EXIT.
 14027      EXIT.
 14028
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 265
* EL130.cbl
 14030 6400-TEST-CLAIM-REASONABILITY.
 14031
 14032     IF WS-INCUR = LOW-VALUES
 14033        GO TO 6499-EXIT
 14034     END-IF.
 14035
 14036     IF WS-EFFDT NOT = LOW-VALUES
 14037         IF WS-INCUR LESS WS-EFFDT
 14038             MOVE ER-0458          TO EMI-ERROR
 14039             MOVE -1               TO INCURL
 14040             MOVE AL-UABON         TO INCURA
 14041             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14042         END-IF
 14043     END-IF.
 14044
 14045     IF CERTMTI = 'A'
 14046        GO TO 6460-TEST-NEW-CERT
 14047     END-IF.
 14048
 14049     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 14050     MOVE CRTCARRI               TO CERT-CARRIER.
 14051     MOVE GROUPI                 TO CERT-GROUPING.
 14052     MOVE STATEI                 TO CERT-STATE.
 14053     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 14054     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 14055     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 14056
 14057
 14058
 14059* EXEC CICS HANDLE CONDITION
 14060*         DUPKEY   (6499-EXIT)
 14061*         NOTFND   (6499-EXIT)
 14062*    END-EXEC.
 14063*    MOVE '"$$I                  ! C #00012768' TO DFHEIV0
 14064     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 14065     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14066     MOVE X'4320233030303132373638' TO DFHEIV0(25:11)
 14067     CALL 'kxdfhei1' USING DFHEIV0
 14068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14069
 14070
 14071     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 14072
 14073     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 14074        'I' OR 'G' OR 'F')
 14075        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 14076     ELSE
 14077        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 14078     END-IF.
 14079
 14080     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14081     MOVE '6'                    TO DC-OPTION-CODE.
 14082     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14083
 14084     IF (WS-INCUR GREATER THAN DC-BIN-DATE-2)
 14085        and (dc-elapsed-months > zeros)
 14086        MOVE ER-0519             TO EMI-ERROR
 14087        MOVE -1                  TO INCURL
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 266
* EL130.cbl
 14088        MOVE AL-UABON            TO INCURA
 14089        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14090     END-IF.
 14091
 14092     IF CLMCARRI NOT = CRTCARRI
 14093        MOVE ER-0562             TO EMI-ERROR
 14094        MOVE AL-UABON            TO CLMCARRA
 14095        MOVE -1                  TO CLMCARRL
 14096        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14097     END-IF.
 14098
 14099     if (pi-company-id = 'DCC' OR 'VPP')
 14100        and (ws-dcc-product-code <> spaces)
 14101        continue
 14102     else
 14103      IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F') AND
 14104        CM-AH-BENEFIT-CD = '00')
 14105                  OR
 14106        (CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 14107        CM-LF-BENEFIT-CD = '00')
 14108         MOVE ER-0521         TO EMI-ERROR
 14109         MOVE AL-UABON        TO CLMTYPEA
 14110         MOVE -1              TO CLMTYPEL
 14111         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14112      END-IF
 14113     end-if
 14114*    IF CLMTYPEI = 'I' AND
 14115*       CM-AH-CRITICAL-PERIOD = +0
 14116*        MOVE ER-0521         TO EMI-ERROR
 14117*        MOVE AL-UABON        TO CLMTYPEA
 14118*        MOVE -1              TO CLMTYPEL
 14119*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14120*    END-IF
 14121
 14122*    IF PI-COMPANY-ID = 'CRI'
 14123*        IF MAINTI = 'A'
 14124*            IF CERT-PEND-ISSUE-ERROR  OR
 14125*               CERT-PEND-ISSUE-RETURNED
 14126*                MOVE -1                 TO CERTNOL
 14127*                MOVE AL-UABON           TO CERTNOA
 14128*                MOVE ER-7640            TO EMI-ERROR
 14129*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14130*            END-IF
 14131*        END-IF
 14132*    END-IF.
 14133
 14134     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 14135         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 14136         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 14137             GO TO 6450-DATE-ERROR
 14138         END-IF
 14139     END-IF.
 14140
 14141     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 14142         CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 14143         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 14144             GO TO 6450-DATE-ERROR
 14145         END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 267
* EL130.cbl
 14146     END-IF.
 14147
 14148     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14149         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 14150             GO TO 6450-DATE-ERROR
 14151         END-IF
 14152     END-IF.
 14153
 14154     GO TO 6499-EXIT.
 14155
 14156 6450-DATE-ERROR.
 14157     MOVE ER-0520                TO EMI-ERROR.
 14158     MOVE -1                     TO INCURL.
 14159     MOVE AL-UABON               TO INCURA.
 14160     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14161
 14162*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 14163*       (EMI-SEVERITY-SAVE = 'X')
 14164*        ADD 1                TO EMI-FORCABLE-CTR
 14165*        SUBTRACT 1 FROM EMI-FATAL-CTR
 14166*    END-IF.
 14167
 14168     GO TO 6499-EXIT.
 14169
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 268
* EL130.cbl
 14171 6460-TEST-NEW-CERT.
 14172
 14173     IF NOT EMI-NO-ERRORS
 14174        GO TO 6499-EXIT
 14175     END-IF.
 14176
 14177     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 14178
 14179     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14180          OR 'F') AND
 14181         ACVOTRML GREATER ZERO)
 14182        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 14183     END-IF.
 14184
 14185     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 14186         LCVOTRML GREATER ZERO
 14187        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 14188     END-IF.
 14189
 14190     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 14191
 14192*    IF PI-COMPANY-ID = 'HAN'
 14193*        IF ADDONDTL GREATER ZERO
 14194*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 14195*            IF CLMTYPEI = 'A'
 14196*                IF ACVOTRMI NOT = ZEROS
 14197*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 14198*                ELSE
 14199*                    NEXT SENTENCE
 14200*                    CONTINUE
 14201*                END-IF
 14202*            ELSE
 14203*                IF LCVOTRMI NOT = ZEROS
 14204*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 14205*                END-IF
 14206*            END-IF
 14207*        END-IF
 14208*    END-IF.
 14209
 14210     MOVE '6'                    TO DC-OPTION-CODE.
 14211     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14212
 14213     IF NO-CONVERSION-ERROR
 14214         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 14215     END-IF.
 14216
 14217     IF WS-INCUR GREATER THAN WS-EXPIRE
 14218        MOVE ER-0519             TO EMI-ERROR
 14219        MOVE -1                  TO INCURL
 14220        MOVE AL-UABON            TO INCURA
 14221        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14222     END-IF.
 14223
 14224     IF CLMCARRI NOT = CRTCARRI
 14225        MOVE ER-0562             TO EMI-ERROR
 14226        MOVE AL-UABON            TO CLMCARRA
 14227        MOVE -1                  TO CLMCARRL
 14228        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 269
* EL130.cbl
 14229     END-IF.
 14230
 14231     if (pi-company-id = 'DCC' OR 'VPP')
 14232        and (ws-dcc-product-code <> spaces)
 14233        continue
 14234     else
 14235        IF (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F')
 14236           and (ACVCDL = ZEROS)
 14237           MOVE ER-0521          TO EMI-ERROR
 14238           MOVE AL-UABON         TO CLMTYPEA
 14239           MOVE -1               TO CLMTYPEL
 14240           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14241        END-IF
 14242     end-if
 14243
 14244     if (pi-company-id = 'DCC' OR 'VPP')
 14245        and (ws-dcc-product-code <> spaces)
 14246        continue
 14247     else
 14248        IF (CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 14249           and (LCVCDL = ZEROS)
 14250           MOVE ER-0521          TO EMI-ERROR
 14251           MOVE AL-UABON         TO CLMTYPEA
 14252           MOVE -1               TO CLMTYPEL
 14253           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14254        END-IF
 14255     end-if
 14256
 14257     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14258         IF LCVCNDTL GREATER ZERO
 14259             IF WS-INCUR GREATER THAN WS-LCVCNDT
 14260                 GO TO 6450-DATE-ERROR
 14261             END-IF
 14262         END-IF
 14263     END-IF.
 14264
 14265     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 14266         IF ACVCNDTL GREATER ZERO
 14267             IF WS-INCUR GREATER THAN WS-ACVCNDT
 14268                 GO TO 6450-DATE-ERROR
 14269             END-IF
 14270         END-IF
 14271     END-IF.
 14272
 14273 6499-EXIT.
 14274     EXIT.
 14275 6500-get-acct.
 14276
 14277     MOVE SPACES                 TO ERACCT-KEY
 14278                                    ws-dcc-product-code
 14279                                    ws-acct-found-sw
 14280
 14281     IF CARR-GROUP-ST-ACCNT-CNTL
 14282        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 14283        MOVE CRTCARRI            TO ACCT-CARRIER
 14284        MOVE GROUPI              TO ACCT-GROUPING
 14285        MOVE STATEI              TO ACCT-STATE
 14286        MOVE ACCOUNTI            TO ACCT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 270
* EL130.cbl
 14287        GO TO 6500-startbr
 14288     END-IF
 14289
 14290     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 14291     MOVE ACCOUNTI               TO ACCT-ACCOUNT
 14292
 14293     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
 14294        MOVE STATEI             TO ACCT-STATE
 14295     END-IF
 14296
 14297     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
 14298        MOVE CRTCARRI           TO ACCT-CARRIER
 14299     END-IF
 14300
 14301     .
 14302 6500-startbr.
 14303
 14304     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY
 14305
 14306
 14307* EXEC CICS STARTBR
 14308*       DATASET     (ERACCT2-DSID)
 14309*       RIDFLD      (SAVE-ERACCT-KEY)
 14310*       GENERIC
 14311*       KEYLENGTH   (20)
 14312*       resp        (ws-response)
 14313*    END-EXEC
 14314     MOVE 20
 14315       TO DFHEIV11
 14316     MOVE 0
 14317       TO DFHEIV12
 14318*    MOVE '&,   KG    G          &  N#00013008' TO DFHEIV0
 14319     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 14320     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14321     MOVE X'204E233030303133303038' TO DFHEIV0(25:11)
 14322     CALL 'kxdfhei1' USING DFHEIV0,
 14323           ERACCT2-DSID,
 14324           SAVE-ERACCT-KEY,
 14325           DFHEIV11,
 14326           DFHEIV12,
 14327           DFHEIV99
 14328     MOVE EIBRESP  TO ws-response
 14329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14330
 14331     if not ws-resp-normal
 14332        go to 6500-exit
 14333     end-if
 14334
 14335     .
 14336 6500-readnext.
 14337
 14338
 14339* EXEC CICS READNEXT
 14340*       DATASET   (ERACCT2-DSID)
 14341*       SET       (ADDRESS OF ACCOUNT-MASTER)
 14342*       RIDFLD    (SAVE-ERACCT-KEY)
 14343*    END-EXEC
 14344     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 271
* EL130.cbl
 14345       TO DFHEIV11
 14346*    MOVE '&.S                   )   #00013023' TO DFHEIV0
 14347     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14348     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14349     MOVE X'2020233030303133303233' TO DFHEIV0(25:11)
 14350     CALL 'kxdfhei1' USING DFHEIV0,
 14351           ERACCT2-DSID,
 14352           DFHEIV20,
 14353           DFHEIV99,
 14354           SAVE-ERACCT-KEY,
 14355           DFHEIV99,
 14356           DFHEIV11,
 14357           DFHEIV99,
 14358           DFHEIV99
 14359     SET ADDRESS OF ACCOUNT-MASTER TO
 14360         DFHEIV20
 14361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14362
 14363     IF (ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1)
 14364        or (ACCT-CARRIER  NOT = AM-VG-CARRIER )
 14365        or (ACCT-GROUPING NOT = AM-VG-GROUPING)
 14366        or (ACCT-STATE    NOT = AM-VG-STATE   )
 14367        or (ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT )
 14368        go to 6500-endbr
 14369     END-IF
 14370
 14371     IF (WS-EFFDT >= AM-EFFECTIVE-DT)
 14372        and (WS-EFFDT < AM-EXPIRATION-DT)
 14373        set acct-found to true
 14374        MOVE AM-dcc-product-code to ws-dcc-product-code
 14375        GO TO 6500-endbr
 14376     END-IF
 14377
 14378     IF WS-EFFDT >= AM-EXPIRATION-DT
 14379         GO TO 6500-readnext
 14380     END-IF
 14381
 14382     .
 14383 6500-endbr.
 14384
 14385
 14386* EXEC CICS ENDBR
 14387*        DATASET    (ERACCT2-DSID)
 14388*    END-EXEC
 14389     MOVE 0
 14390       TO DFHEIV11
 14391*    MOVE '&2                    $   #00013051' TO DFHEIV0
 14392     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14393     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14394     MOVE X'2020233030303133303531' TO DFHEIV0(25:11)
 14395     CALL 'kxdfhei1' USING DFHEIV0,
 14396           ERACCT2-DSID,
 14397           DFHEIV11,
 14398           DFHEIV99
 14399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14400
 14401     .
 14402 6500-exit.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 272
* EL130.cbl
 14403     exit.
 14404 6600-CHECK-AUTO-ACTIVITY.
 14405
 14406
 14407* EXEC CICS HANDLE CONDITION
 14408*        NOTFND   (6600-NOT-FOUND)
 14409*    END-EXEC.
 14410*    MOVE '"$I                   ! D #00013060' TO DFHEIV0
 14411     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14412     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14413     MOVE X'4420233030303133303630' TO DFHEIV0(25:11)
 14414     CALL 'kxdfhei1' USING DFHEIV0
 14415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14416
 14417
 14418     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 14419     MOVE 'T'                        TO  CNTL-REC-TYPE.
 14420     MOVE SPACES                     TO  CNTL-ACCESS.
 14421     MOVE +0                         TO  CNTL-SEQ-NO.
 14422
 14423     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 14424
 14425     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 14426         MOVE 'N'                    TO  WS-REC-FOUND-SW
 14427                                         WS-LETTER-SW
 14428         GO TO 6600-EXIT
 14429     END-IF.
 14430
 14431     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 14432         MOVE 'N'                     TO  WS-LETTER-SW
 14433     ELSE
 14434         MOVE 'Y'                     TO  WS-LETTER-SW
 14435     END-IF.
 14436
 14437     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 14438     GO TO 6600-EXIT.
 14439
 14440 6600-START-AUTO-LETTER-WRITER.
 14441
 14442     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 14443     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 14444
 14445     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 14446
 14447     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 14448         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14449         MOVE '6'                     TO  DC-OPTION-CODE
 14450         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 14451         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14452         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14453         IF NO-CONVERSION-ERROR
 14454             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 14455         ELSE
 14456             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 14457         END-IF
 14458     END-IF.
 14459
 14460     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 273
* EL130.cbl
 14461         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14462         MOVE '6'                     TO  DC-OPTION-CODE
 14463         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 14464         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14465         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14466         IF NO-CONVERSION-ERROR
 14467             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 14468         ELSE
 14469             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
 14470         END-IF
 14471     END-IF.
 14472
 14473
 14474
 14475* EXEC CICS LINK
 14476*        PROGRAM    (LINK-1523)
 14477*        COMMAREA   (W-1523-LINKDATA)
 14478*        LENGTH     (W-1523-COMM-LENGTH)
 14479*    END-EXEC.
 14480*    MOVE '."C                   (   #00013120' TO DFHEIV0
 14481     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14482     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14483     MOVE X'2020233030303133313230' TO DFHEIV0(25:11)
 14484     CALL 'kxdfhei1' USING DFHEIV0,
 14485           LINK-1523,
 14486           W-1523-LINKDATA,
 14487           W-1523-COMM-LENGTH,
 14488           DFHEIV99,
 14489           DFHEIV99,
 14490           DFHEIV99,
 14491           DFHEIV99
 14492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14493
 14494
 14495     GO TO 6600-EXIT.
 14496
 14497 6600-NOT-FOUND.
 14498     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 14499
 14500 6600-EXIT.
 14501     EXIT.
 14502
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 274
* EL130.cbl
 14503/
 14504*************************************************************
 14505*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 14506*************************************************************
 14507
 14508 6700-OUTPUT-ACTIVITY-RECORD.
 14509
 14510
 14511
 14512* EXEC CICS GETMAIN
 14513*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 14514*        LENGTH (DLYACTV-LENGTH)
 14515*        INITIMG (WS-BLANK)
 14516*    END-EXEC.
 14517*    MOVE ',"IL                  $   #00013142' TO DFHEIV0
 14518     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14519     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14520     MOVE X'2020233030303133313432' TO DFHEIV0(25:11)
 14521     CALL 'kxdfhei1' USING DFHEIV0,
 14522           DFHEIV20,
 14523           DLYACTV-LENGTH,
 14524           WS-BLANK
 14525     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 14526         DFHEIV20
 14527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14528
 14529
 14530     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 14531     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 14532     MOVE CLMCARRI               TO DA-CARRIER.
 14533     IF CLMNOL EQUAL ZERO
 14534         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 14535     ELSE
 14536         MOVE CLMNOI             TO DA-CLAIM-NO
 14537     END-IF.
 14538     MOVE CERTNOI                TO DA-CERT-PRIME.
 14539     MOVE SUFXI                  TO DA-CERT-SFX.
 14540     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 14541     MOVE 'A'                    TO DA-RECORD-TYPE.
 14542
 14543
 14544* EXEC CICS HANDLE CONDITION
 14545*        NOTOPEN (6700-NOTOPEN-ERROR)
 14546*        DUPREC (6700-EXIT)
 14547*    END-EXEC.
 14548*    MOVE '"$J%                  ! E #00013161' TO DFHEIV0
 14549     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 14550     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14551     MOVE X'4520233030303133313631' TO DFHEIV0(25:11)
 14552     CALL 'kxdfhei1' USING DFHEIV0
 14553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14554
 14555
 14556
 14557* EXEC CICS WRITE
 14558*        DATASET (DLYACTV-DSID)
 14559*        RIDFLD (DA-KEY)
 14560*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 275
* EL130.cbl
 14561*        LENGTH (DLYACTV-LENGTH)
 14562*    END-EXEC.
 14563*    MOVE '&$ L                  ''   #00013166' TO DFHEIV0
 14564     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14565     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14566     MOVE X'2020233030303133313636' TO DFHEIV0(25:11)
 14567     CALL 'kxdfhei1' USING DFHEIV0,
 14568           DLYACTV-DSID,
 14569           DAILY-ACTIVITY-RECORD,
 14570           DLYACTV-LENGTH,
 14571           DA-KEY,
 14572           DFHEIV99,
 14573           DFHEIV99
 14574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14575
 14576     GO TO 6700-EXIT.
 14577
 14578 6700-NOTOPEN-ERROR.
 14579     MOVE '2955'                 TO EMI-ERROR.
 14580     MOVE -1                     TO MAINTL.
 14581     MOVE AL-UANON               TO MAINTA.
 14582     PERFORM 9900-ERROR-FORMAT THRU
 14583             9900-EXIT.
 14584     GO TO 8200-SEND-DATAONLY.
 14585
 14586 6700-EXIT.
 14587     EXIT.
 14588
 14589*************************************************************
 14590*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 14591*************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 276
* EL130.cbl
 14592/
 14593 6990-DEEDIT-DATE.
 14594
 14595
 14596* EXEC CICS BIF DEEDIT
 14597*        FIELD   (DATE-WORK)
 14598*        LENGTH  (8)
 14599*    END-EXEC.
 14600     MOVE 8
 14601       TO DFHEIV11
 14602*    MOVE '@"L                   #   #00013191' TO DFHEIV0
 14603     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14604     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14605     MOVE X'2020233030303133313931' TO DFHEIV0(25:11)
 14606     CALL 'kxdfhei1' USING DFHEIV0,
 14607           DATE-WORK,
 14608           DFHEIV11
 14609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14610
 14611 6990-EXIT.
 14612     EXIT.
 14613
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 277
* EL130.cbl
 14615 7000-BUILD-OUTPUT-MAP.
 14616
 14617     IF CLAIM-SWITCH = 'N'
 14618         GO TO 7050-BUILD-MAP-CERT-DATA
 14619     END-IF.
 14620
 14621     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 14622         MOVE SPACES                 TO SEQUO
 14623         MOVE AL-SABOF               TO SEQUA
 14624     ELSE
 14625         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 14626         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 14627         MOVE WS-CLAIM-SEQU          TO SEQUO
 14628         MOVE AL-SABON               TO SEQUA
 14629     END-IF.
 14630
 14631     MOVE CL-CARRIER             TO CLMCARRO.
 14632     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 14633     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14634     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14635     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14636     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14637     MOVE CL-INSURED-MID-INIT    TO INITO.
 14638     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14639     move cl-insured-type        to instypeo
 14640*    MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 14641
 14642     MOVE AL-UANON               TO CLMCARRA
 14643                                    CLMTYPEA
 14644                                    PCERTNOA
 14645                                    PSUFXA
 14646                                    LSTNMEA
 14647                                    FSTNMEA
 14648                                    INITA
 14649                                    SEXA
 14650
 14651     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 14652
 14653     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 14654         MOVE ' '                 TO DC-OPTION-CODE
 14655         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14656         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14657         IF NOT DATE-CONVERSION-ERROR
 14658             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 14659             MOVE AL-UANON            TO BIRTHDTA
 14660         END-IF
 14661     END-IF.
 14662
 14663     MOVE CL-SOC-SEC-NO          TO SSNO.
 14664     MOVE AL-UANON               TO SSNA.
 14665
 14666     IF CL-INCURRED-DT NOT = LOW-VALUES
 14667         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14668         MOVE ' '                TO DC-OPTION-CODE
 14669         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14670         IF NOT DATE-CONVERSION-ERROR
 14671             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 14672             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 278
* EL130.cbl
 14673         END-IF
 14674     END-IF.
 14675
 14676     IF CL-REPORTED-DT NOT = LOW-VALUES
 14677         MOVE ' '                TO DC-OPTION-CODE
 14678         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14679         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14680         IF NOT DATE-CONVERSION-ERROR
 14681             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 14682             MOVE AL-UANON            TO REPORTA
 14683         END-IF
 14684     END-IF.
 14685
 14686*    IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 14687*        MOVE ' '                 TO DC-OPTION-CODE
 14688*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14689*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14690*        IF NOT DATE-CONVERSION-ERROR
 14691*            MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 14692*            MOVE AL-UANON            TO ESTENDA
 14693*        END-IF
 14694*    END-IF.
 14695
 14696     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 14697     MOVE WS-ICD-CODE-1          TO ICD1O.
 14698     MOVE WS-ICD-CODE-2          TO ICD2O.
 14699*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14700     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 14701     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 14702     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 14703     MOVE CL-PRIORITY-CD         TO PRICDO.
 14704     MOVE AL-UANON               TO DIAGA
 14705                                    ICD1A
 14706                                    ICD2A
 14707*                                   CAUSEA
 14708                                    RELCLMA
 14709                                    PROCCDA
 14710                                    PRICDA.
 14711     MOVE AL-UNNON               TO MANRSVA.
 14712
 14713*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 14714*        MOVE CL-PRODUCT-CD          TO PRODCDO
 14715*        MOVE AL-UANON               TO PRODCDA
 14716*    END-IF.
 14717
 14718     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14719     MOVE CL-FILE-LOCATION       TO FILETOO.
 14720     MOVE CL-BENEFICIARY         TO BENECDO.
 14721     MOVE AL-UANON               TO SUPVA
 14722                                    FILETOA
 14723                                    BENECDA.
 14724
 14725     IF CLAIM-SWITCH = 'X'
 14726         GO TO 7099-EXIT
 14727     END-IF.
 14728
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 279
* EL130.cbl
 14730 7050-BUILD-MAP-CERT-DATA.
 14731     MOVE CM-CERT-PRIME          TO CERTNOO.
 14732     MOVE CM-CERT-SFX            TO SUFXO.
 14733     MOVE AL-SANON               TO CERTNOA
 14734                                    SUFXA.
 14735
 14736     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 14737         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14738         MOVE ' '                TO DC-OPTION-CODE
 14739         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14740         IF NOT DATE-CONVERSION-ERROR
 14741             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 14742         END-IF
 14743     END-IF.
 14744
 14745     MOVE CM-ACCOUNT             TO ACCOUNTO.
 14746     MOVE CM-STATE               TO STATEO.
 14747     MOVE CM-CARRIER             TO CRTCARRO.
 14748     MOVE CM-GROUPING            TO GROUPO.
 14749     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14750     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14751     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14752     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14753     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14754     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14755     MOVE CM-JT-INITIAL          TO JNTINITO.
 14756     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14757     MOVE AL-UANON               TO ACCOUNTA
 14758                                    STATEA
 14759                                    CRTCARRA
 14760                                    GROUPA
 14761                                    CRTLNMEA
 14762                                    CRTFNMEA
 14763                                    CRTINITA
 14764                                    JNTLNMEA
 14765                                    JNTFNMEA
 14766                                    JNTINITA.
 14767     MOVE AL-UNNON               TO ISSAGEA
 14768                                    JNTAGEA.
 14769
 14770     IF CM-SSN-STATE   = CM-STATE AND
 14771        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 14772*        NEXT SENTENCE
 14773         CONTINUE
 14774     ELSE
 14775         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 14776     END-IF.
 14777
 14778     MOVE AL-UANON               TO CRTSSNA.
 14779
 14780     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 14781     MOVE '2'                    TO DC-OPTION-CODE.
 14782     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14783     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 14784
 14785*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14786     MOVE SPACES                 TO ELCNTL-KEY.
 14787     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 280
* EL130.cbl
 14788     MOVE '3'                    TO CNTL-REC-TYPE.
 14789     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14790     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14791
 14792
 14793
 14794* EXEC CICS READ
 14795*        DATASET  (ELCNTL-DSID)
 14796*        SET      (ADDRESS OF CONTROL-FILE)
 14797*        RIDFLD   (ELCNTL-KEY)
 14798*        RESP     (WS-RESPONSE)
 14799*    END-EXEC.
 14800*    MOVE '&"S        E          (  N#00013377' TO DFHEIV0
 14801     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14802     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14803     MOVE X'204E233030303133333737' TO DFHEIV0(25:11)
 14804     CALL 'kxdfhei1' USING DFHEIV0,
 14805           ELCNTL-DSID,
 14806           DFHEIV20,
 14807           DFHEIV99,
 14808           ELCNTL-KEY,
 14809           DFHEIV99,
 14810           DFHEIV99,
 14811           DFHEIV99
 14812     SET ADDRESS OF CONTROL-FILE TO
 14813         DFHEIV20
 14814     MOVE EIBRESP  TO WS-RESPONSE
 14815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14816
 14817
 14818     IF WS-RESP-NOTFND
 14819          MOVE ER-2848           TO EMI-ERROR
 14820          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14821          GO TO 8100-SEND-INITIAL-MAP
 14822     END-IF.
 14823
 14824     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 14825     MOVE CF-ST-VFY-2ND-BENE TO PI-ST-VFY-2ND-BENE.
 14826     MOVE CF-ST-CAUSAL-STATE TO PI-ST-CAUSAL-STATE.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 281
* EL130.cbl
 14828     IF CM-LF-BENEFIT-CD = '00'
 14829         MOVE ZEROS              TO LCVOTRMO
 14830                                    LCVRTRMO
 14831                                    LCVRATEO
 14832                                    LCVBENEO
 14833         MOVE SPACES             TO LCVDSCRO
 14834                                    LCVCDO
 14835                                    LCVKINDO
 14836                                    LCVFORMO
 14837                                    LCVCNDTO
 14838                                    LCVEXITO
 14839                                    LCVSTATO
 14840         IF CLMTYPEL GREATER THAN ZERO AND
 14841            CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14842                MOVE ER-0521     TO EMI-ERROR
 14843                MOVE AL-UABON    TO CLMTYPEA
 14844                MOVE -1          TO CLMTYPEL
 14845                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14846                GO TO 7060-FILL-AH-COVERAGE
 14847         ELSE
 14848             GO TO 7060-FILL-AH-COVERAGE
 14849         END-IF
 14850     END-IF.
 14851
 14852     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14853     MOVE AL-UANON               TO LCVDSCRA.
 14854     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 14855     MOVE '4'                    TO WS-REC-TYPE.
 14856     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14857     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 14858     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 14859     MOVE AL-UANON               TO LCVCDA.
 14860     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 14861                                    CP-ORIGINAL-TERM.
 14862     MOVE AL-UNNON               TO LCVOTRMA.
 14863     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14864     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14865     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14866     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14867     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14868     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14869
 14870     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14871     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14872
 14873     IF CM-LF-PREMIUM-RATE NUMERIC
 14874         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14875     ELSE
 14876         MOVE ZEROS              TO LCVRATEO
 14877     END-IF.
 14878
 14879     MOVE AL-UNNON               TO LCVRATEA.
 14880
 14881     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14882         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 14883     END-IF.
 14884
 14885     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 282
* EL130.cbl
 14886
 14887     MOVE AL-UNNON               TO LCVBENEA.
 14888
 14889     IF CM-POLICY-FORM-NO NOT = SPACES
 14890         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 14891     ELSE
 14892         MOVE WS-FORM-HOLD       TO LCVFORMO
 14893     END-IF.
 14894
 14895     MOVE SPACES                 TO WS-FORM-HOLD.
 14896     MOVE 'L'                    TO WS-REC-TYPE.
 14897     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 14898
 14899     IF WS-FORM-HOLD NOT = SPACES
 14900         MOVE WS-FORM-HOLD       TO LCVFORMO
 14901         MOVE AL-UANON           TO LCVFORMA
 14902     END-IF.
 14903
 14904     IF CM-LF-CURRENT-STATUS = '8'
 14905         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14906             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14907             MOVE ' '             TO DC-OPTION-CODE
 14908             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14909             IF NOT DATE-CONVERSION-ERROR
 14910                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14911                 MOVE AL-UANON            TO LCVCNDTA
 14912             END-IF
 14913         END-IF
 14914     END-IF.
 14915
 14916     IF CM-LF-CURRENT-STATUS = '7'
 14917         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14918             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 14919             MOVE ' '            TO DC-OPTION-CODE
 14920             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14921             IF NOT DATE-CONVERSION-ERROR
 14922                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14923                 MOVE AL-UANON   TO LCVCNDTA
 14924             END-IF
 14925         END-IF
 14926     END-IF.
 14927
 14928     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 14929         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 14930             MOVE ' '            TO DC-OPTION-CODE
 14931             MOVE CM-LF-DEATH-EXIT-DT
 14932                                 TO DC-BIN-DATE-1
 14933             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14934             IF NOT DATE-CONVERSION-ERROR
 14935                 MOVE DC-GREG-DATE-1-EDIT
 14936                                 TO LCVEXITO
 14937             END-IF
 14938         END-IF
 14939     END-IF.
 14940
 14941     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 14942         IF CP-REMAINING-TERM-3 = ZEROS
 14943             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 283
* EL130.cbl
 14944         ELSE
 14945             MOVE 'ACTIVE'       TO LCVSTATO
 14946         END-IF
 14947     END-IF.
 14948
 14949     IF CM-LF-CURRENT-STATUS = '2'
 14950        MOVE 'PEND  '            TO LCVSTATO
 14951     END-IF.
 14952     IF CM-LF-CURRENT-STATUS = '3'
 14953        MOVE 'RESTORE'           TO LCVSTATO
 14954     END-IF.
 14955     IF CM-LF-CURRENT-STATUS = '5'
 14956        MOVE 'REISSUE'           TO LCVSTATO
 14957     END-IF.
 14958     IF CM-LF-CURRENT-STATUS = '6'
 14959        MOVE 'LMP DIS'           TO LCVSTATO
 14960     END-IF.
 14961     IF CM-LF-CURRENT-STATUS = '7'
 14962        MOVE 'DEATH  '           TO LCVSTATO
 14963     END-IF.
 14964     IF CM-LF-CURRENT-STATUS = '8'
 14965        MOVE 'CANCEL '           TO LCVSTATO
 14966     END-IF.
 14967     IF CM-LF-CURRENT-STATUS = '9'
 14968        MOVE 'RE-ONLY'           TO LCVSTATO
 14969     END-IF.
 14970     IF CM-LF-CURRENT-STATUS = 'V'
 14971        MOVE 'VOID   '           TO LCVSTATO
 14972     END-IF.
 14973     IF CM-LF-CURRENT-STATUS = 'D'
 14974        MOVE 'DECLINE'           TO LCVSTATO
 14975     END-IF.
 14976
 14977     IF PI-COMPANY-ID = 'CID'
 14978         IF CM-LF-BENEFIT-CD >= '2O' AND
 14979            CM-LF-BENEFIT-CD <= '2V'
 14980             MOVE ER-0878       TO EMI-ERROR
 14981             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14982         END-IF
 14983     END-IF.
 14984
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 284
* EL130.cbl
 14986 7060-FILL-AH-COVERAGE.
 14987
 14988     IF CM-AH-BENEFIT-CD = '00'
 14989         MOVE ZEROS              TO ACVOTRMO
 14990                                    ACVRTRMO
 14991                                    ACVRATEO
 14992                                    ACVBENEO
 14993         MOVE SPACES             TO ACVDSCRO
 14994                                    ACVCDO
 14995                                    ACVKINDO
 14996                                    ACVFORMO
 14997                                    ACVCNDTO
 14998                                    ACVEXITO
 14999                                    ACVSTATO
 15000         IF (CLMTYPEL GREATER THAN ZERO AND
 15001             (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 15002             MOVE ER-0521     TO EMI-ERROR
 15003             MOVE AL-UABON    TO CLMTYPEA
 15004             MOVE -1          TO CLMTYPEL
 15005             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15006             GO TO 7070-BUILD-MAP-FINISH
 15007         ELSE
 15008             GO TO 7070-BUILD-MAP-FINISH
 15009         END-IF
 15010     END-IF.
 15011
 15012     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15013     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 15014     MOVE AL-UANON               TO ACVDSCRA
 15015                                    ACVCDA.
 15016     MOVE '5'                    TO WS-REC-TYPE.
 15017     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 15018     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 15019
 15020     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 15021                                    CP-ORIGINAL-TERM.
 15022     MOVE AL-UNNON               TO ACVOTRMA.
 15023
 15024     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15025     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15026     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 15027     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15028     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15029     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15030
 15031     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 15032     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15033
 15034     IF CM-AH-PREMIUM-RATE NUMERIC
 15035         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15036     ELSE
 15037         MOVE ZEROS              TO ACVRATEO
 15038     END-IF.
 15039
 15040     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 15041     MOVE AL-UNNON               TO ACVRATEA
 15042                                    ACVBENEA.
 15043
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 285
* EL130.cbl
 15044     IF CM-POLICY-FORM-NO NOT = SPACES
 15045         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 15046     ELSE
 15047         MOVE WS-FORM-HOLD       TO ACVFORMO
 15048         MOVE SPACES TO WS-FORM-HOLD
 15049         MOVE 'A'                TO WS-REC-TYPE
 15050         PERFORM 7400-READ-STATE THRU 7499-EXIT
 15051         IF WS-FORM-HOLD NOT = SPACES
 15052             MOVE WS-FORM-HOLD   TO ACVFORMO
 15053         END-IF
 15054     END-IF.
 15055
 15056     MOVE AL-UANON               TO ACVFORMA.
 15057
 15058     IF CM-AH-CURRENT-STATUS = '8'
 15059         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 15060             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15061             MOVE ' '             TO DC-OPTION-CODE
 15062             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15063             IF NOT DATE-CONVERSION-ERROR
 15064                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 15065                MOVE AL-UANON    TO ACVCNDTA
 15066             END-IF
 15067         END-IF
 15068     END-IF.
 15069
 15070     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15071         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15072             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 15073             MOVE ' '             TO DC-OPTION-CODE
 15074             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15075             IF NOT DATE-CONVERSION-ERROR
 15076                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 15077                MOVE AL-UANON            TO ACVCNDTA
 15078             END-IF
 15079         END-IF
 15080     END-IF.
 15081
 15082     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15083         MOVE ' '                TO DC-OPTION-CODE
 15084         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15085         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15086         IF NOT DATE-CONVERSION-ERROR
 15087             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 15088         END-IF
 15089     END-IF.
 15090
 15091     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15092         IF CP-REMAINING-TERM-3 = ZEROS
 15093             MOVE 'EXPIRED'      TO ACVSTATO
 15094         ELSE
 15095             MOVE 'ACTIVE'       TO ACVSTATO
 15096         END-IF
 15097     END-IF.
 15098
 15099     IF CM-AH-CURRENT-STATUS = '2'
 15100         MOVE 'PEND  '           TO ACVSTATO
 15101     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 286
* EL130.cbl
 15102     IF CM-AH-CURRENT-STATUS = '3'
 15103         MOVE 'RESTORE'          TO ACVSTATO
 15104     END-IF.
 15105     IF CM-AH-CURRENT-STATUS = '5'
 15106         MOVE 'REISSUE'          TO ACVSTATO
 15107     END-IF.
 15108     IF CM-AH-CURRENT-STATUS = '6'
 15109         MOVE 'LMP DIS'          TO ACVSTATO
 15110     END-IF.
 15111     IF CM-AH-CURRENT-STATUS = '7'
 15112         MOVE 'DEATH  '          TO ACVSTATO
 15113     END-IF.
 15114     IF CM-AH-CURRENT-STATUS = '8'
 15115         MOVE 'CANCEL '          TO ACVSTATO
 15116     END-IF.
 15117     IF CM-AH-CURRENT-STATUS = '9'
 15118         MOVE 'RE-ONLY'          TO ACVSTATO
 15119     END-IF.
 15120     IF CM-AH-CURRENT-STATUS = 'V'
 15121         MOVE 'VOID   '          TO ACVSTATO
 15122     END-IF.
 15123     IF CM-AH-CURRENT-STATUS = 'D'
 15124         MOVE 'DECLINE'          TO ACVSTATO
 15125     END-IF.
 15126
 15127     IF PI-COMPANY-ID = 'DCC' OR 'VPP'
 15128        IF CM-ACCOUNT (9:2) = 'BI'
 15129           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 15130           MOVE CM-CARRIER       TO CTRLR-CARRIER
 15131           MOVE CM-GROUPING      TO CTRLR-GROUPING
 15132           MOVE CM-STATE         TO CTRLR-STATE
 15133           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 15134           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 15135           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 15136           MOVE 'C'              TO CTRLR-REC-TYPE
 15137
 15138* EXEC CICS READ
 15139*            DATASET  (ELCRTT-DSID)
 15140*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 15141*            RIDFLD   (ELCRTT-KEY)
 15142*            RESP     (WS-RESPONSE)
 15143*          END-EXEC
 15144*    MOVE '&"S        E          (  N#00013703' TO DFHEIV0
 15145     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15146     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15147     MOVE X'204E233030303133373033' TO DFHEIV0(25:11)
 15148     CALL 'kxdfhei1' USING DFHEIV0,
 15149           ELCRTT-DSID,
 15150           DFHEIV20,
 15151           DFHEIV99,
 15152           ELCRTT-KEY,
 15153           DFHEIV99,
 15154           DFHEIV99,
 15155           DFHEIV99
 15156     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 15157         DFHEIV20
 15158     MOVE EIBRESP  TO WS-RESPONSE
 15159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 287
* EL130.cbl
 15160           IF WS-RESP-NORMAL
 15161               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 15162               MOVE WS-DIAG-VIN-MSG TO DIAGO
 15163               MOVE AL-UANON        TO DIAGA
 15164           END-IF
 15165        END-IF
 15166     END-IF.
 15167
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 288
* EL130.cbl
 15169 7070-BUILD-MAP-FINISH.
 15170     MOVE CM-LOAN-APR            TO APRO.
 15171     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15172     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15173     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 15174     MOVE AL-UNNON               TO APRA
 15175                                    PMTFREQA.
 15176     MOVE AL-UANON               TO INDGRPA
 15177                                    PREMTYPA.
 15178
 15179     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 15180         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 15181         MOVE AL-UANON               TO REINCDA
 15182     END-IF.
 15183
 15184     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 15185*        NEXT SENTENCE
 15186         CONTINUE
 15187     ELSE
 15188         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15189         MOVE ' '                TO DC-OPTION-CODE
 15190         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15191         IF NOT DATE-CONVERSION-ERROR
 15192             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 15193             MOVE AL-UANON            TO ADDONDTA
 15194         END-IF
 15195     END-IF.
 15196
 15197     IF CLAIM-SWITCH = 'N'
 15198         IF SEXL = ZEROS
 15199             MOVE CM-INSURED-SEX TO SEXO
 15200*            MOVE AL-UANON       TO SEXA
 15201         END-IF
 15202     END-IF.
 15203
 15204     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 15205         MOVE CM-MEMBER-NO       TO MEMBERO
 15206         MOVE AL-UANON           TO MEMBERA
 15207     END-IF.
 15208
 15209     IF MAINTI = 'A'
 15210         IF (LOANNOL = ZEROS OR
 15211             EIBAID = DFHPF5)
 15212             MOVE CM-LOAN-NUMBER TO LOANNOO
 15213             MOVE AL-UANON       TO LOANNOA
 15214         ELSE
 15215*            NEXT SENTENCE
 15216             CONTINUE
 15217         END-IF
 15218     ELSE
 15219         MOVE CM-LOAN-NUMBER     TO LOANNOO
 15220         MOVE AL-UANON           TO LOANNOA
 15221     END-IF.
 15222
 15223     IF MAINTI = 'A'
 15224         IF (LOANBALL = ZEROS OR
 15225             EIBAID = DFHPF5)
 15226             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 289
* EL130.cbl
 15227             MOVE AL-UNNON       TO LOANBALA
 15228         ELSE
 15229*            NEXT SENTENCE
 15230             CONTINUE
 15231         END-IF
 15232     ELSE
 15233         MOVE CM-LOAN-BALANCE    TO LOANBALO
 15234         MOVE AL-UNNON           TO LOANBALA
 15235     END-IF.
 15236
 15237     IF CM-PREMIUM-TYPE NOT = '3'
 15238         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15239             PERFORM 7200-PROTECT-CERT-FIELDS
 15240         ELSE
 15241             PERFORM 7300-RESET-KEY-ATTRBS
 15242         END-IF
 15243     ELSE
 15244         PERFORM 7300-RESET-KEY-ATTRBS
 15245     END-IF.
 15246
 15247*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15248*        NEXT SENTENCE
 15249*        CONTINUE
 15250*    ELSE
 15251         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 15252*    END-IF.
 15253
 15254 7099-EXIT.
 15255     EXIT.
 15256
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 290
* EL130.cbl
 15258 7100-READ-BENEFIT.
 15259
 15260
 15261* EXEC CICS HANDLE CONDITION
 15262*         NOTFND   (7120-NOT-FOUND)
 15263*    END-EXEC.
 15264*    MOVE '"$I                   ! F #00013809' TO DFHEIV0
 15265     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15266     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15267     MOVE X'4620233030303133383039' TO DFHEIV0(25:11)
 15268     CALL 'kxdfhei1' USING DFHEIV0
 15269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15270
 15271
 15272     MOVE SPACES                 TO ELCNTL-KEY.
 15273     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 15274     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 15275     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15276     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15277
 15278 7105-READ-FILE.
 15279     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 15280
 15281     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 15282        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 15283          GO TO 7120-NOT-FOUND
 15284     END-IF.
 15285
 15286     MOVE 1                      TO SUB.
 15287 7110-LOOP.
 15288     IF SUB = 9
 15289         GO TO 7120-NOT-FOUND
 15290     END-IF.
 15291
 15292     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 15293         ADD 1                   TO SUB
 15294         GO TO 7110-LOOP
 15295     END-IF.
 15296
 15297     if ws-rec-type = '4'
 15298        move cf-joint-indicator (sub)
 15299                                 to ws-lf-joint-indicator
 15300     else
 15301        move cf-joint-indicator (sub)
 15302                                 to ws-ah-joint-indicator
 15303     end-if
 15304     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 15305     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 15306     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 15307
 15308     GO TO 7199-EXIT.
 15309
 15310 7120-NOT-FOUND.
 15311     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 15312                                    WS-FORM-HOLD.
 15313
 15314 7199-EXIT.
 15315      EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 291
* EL130.cbl
 15316
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 292
* EL130.cbl
 15318 7200-PROTECT-CERT-FIELDS.
 15319     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15320                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15321                                LCVFORMA ACVFORMA JNTLNMEA
 15322                                JNTFNMEA JNTINITA.
 15323
 15324     IF CM-LF-CURRENT-STATUS = '2' OR
 15325        CM-AH-CURRENT-STATUS = '2'
 15326         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 15327     END-IF.
 15328
 15329     MOVE AL-SANOF TO
 15330            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 15331            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 15332            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 15333            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 15334            LCVRATEA   ACVRATEA.
 15335
 15336     MOVE 'S'                    TO CERTMTI.
 15337
 15338 7300-RESET-KEY-ATTRBS.
 15339     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15340                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15341                                LCVFORMA ACVFORMA JNTLNMEA
 15342                                JNTFNMEA JNTINITA.
 15343
 15344     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15345         MOVE AL-SANOF           TO REINCDA
 15346     END-IF.
 15347
 15348     MOVE 'S'                    TO CERTMTI.
 15349
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 293
* EL130.cbl
 15351 7400-READ-STATE.
 15352
 15353
 15354* EXEC CICS HANDLE CONDITION
 15355*         NOTFND   (7499-EXIT)
 15356*    END-EXEC.
 15357*    MOVE '"$I                   ! G #00013894' TO DFHEIV0
 15358     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15359     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15360     MOVE X'4720233030303133383934' TO DFHEIV0(25:11)
 15361     CALL 'kxdfhei1' USING DFHEIV0
 15362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15363
 15364
 15365     MOVE SPACES                 TO ELCNTL-KEY.
 15366     MOVE CM-STATE               TO CNTL-ACCESS.
 15367     MOVE '3'                    TO CNTL-REC-TYPE.
 15368     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15369     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15370
 15371     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 15372
 15373     MOVE 1                      TO SUB.
 15374
 15375 7410-LOOP.
 15376     IF SUB = 21
 15377        GO TO 7499-EXIT
 15378     END-IF.
 15379
 15380*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 15381*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 15382*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 15383*        GO TO 7499-EXIT.
 15384
 15385     ADD 1                       TO SUB.
 15386     GO TO 7410-LOOP.
 15387
 15388 7499-EXIT.
 15389      EXIT.
 15390
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 294
* EL130.cbl
 15392 7500-BROWSE-FOR-DUPLICATE.
 15393
 15394     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 15395
 15396
 15397
 15398* EXEC CICS HANDLE CONDITION
 15399*        NOTFND   (7500-EXIT)
 15400*        DUPKEY   (7500-DUPLICATE-KEY)
 15401*        ENDFILE  (7500-EXIT)
 15402*    END-EXEC.
 15403*    MOVE '"$I$''                 ! H #00013930' TO DFHEIV0
 15404     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 15405     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15406     MOVE X'4820233030303133393330' TO DFHEIV0(25:11)
 15407     CALL 'kxdfhei1' USING DFHEIV0
 15408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15409
 15410
 15411
 15412
 15413* EXEC CICS STARTBR
 15414*        DATASET    (ELMSTR5-DSID)
 15415*        RIDFLD     (ELMSTR5-KEY)
 15416*    END-EXEC.
 15417     MOVE 0
 15418       TO DFHEIV11
 15419*    MOVE '&,         G          &   #00013937' TO DFHEIV0
 15420     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15421     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15422     MOVE X'2020233030303133393337' TO DFHEIV0(25:11)
 15423     CALL 'kxdfhei1' USING DFHEIV0,
 15424           ELMSTR5-DSID,
 15425           ELMSTR5-KEY,
 15426           DFHEIV99,
 15427           DFHEIV11,
 15428           DFHEIV99
 15429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15430
 15431
 15432
 15433
 15434* EXEC CICS HANDLE CONDITION
 15435*        ENDFILE  (7500-END-BROWSE)
 15436*    END-EXEC.
 15437*    MOVE '"$''                   ! I #00013943' TO DFHEIV0
 15438     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15439     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15440     MOVE X'4920233030303133393433' TO DFHEIV0(25:11)
 15441     CALL 'kxdfhei1' USING DFHEIV0
 15442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15443
 15444
 15445 7500-READ-CLAIM-LOOP.
 15446
 15447
 15448
 15449* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 295
* EL130.cbl
 15450*        DATASET   (ELMSTR5-DSID)
 15451*        SET       (ADDRESS OF CLAIM-MASTER)
 15452*        RIDFLD    (ELMSTR5-KEY)
 15453*    END-EXEC.
 15454     MOVE 0
 15455       TO DFHEIV11
 15456*    MOVE '&.S                   )   #00013950' TO DFHEIV0
 15457     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15458     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15459     MOVE X'2020233030303133393530' TO DFHEIV0(25:11)
 15460     CALL 'kxdfhei1' USING DFHEIV0,
 15461           ELMSTR5-DSID,
 15462           DFHEIV20,
 15463           DFHEIV99,
 15464           ELMSTR5-KEY,
 15465           DFHEIV99,
 15466           DFHEIV11,
 15467           DFHEIV99,
 15468           DFHEIV99
 15469     SET ADDRESS OF CLAIM-MASTER TO
 15470         DFHEIV20
 15471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15472
 15473
 15474 7500-DUPLICATE-KEY.
 15475
 15476     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 15477        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 15478        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 15479        CL-CERT-STATE     NOT = CM-STATE       OR
 15480        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 15481        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 15482        CL-CERT-NO        NOT = CM-CERT-NO
 15483           GO TO 7500-CHECK-MATCH-COUNT
 15484     END-IF.
 15485
 15486     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 15487
 15488     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 15489        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 15490        GO TO 7500-END-BROWSE
 15491     ELSE
 15492        GO TO 7500-READ-CLAIM-LOOP
 15493     END-IF.
 15494
 15495 7500-CHECK-MATCH-COUNT.
 15496
 15497     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 15498        CL-CERT-NO    = CM-CERT-NO
 15499          GO TO 7500-READ-CLAIM-LOOP
 15500     END-IF.
 15501
 15502 7500-END-BROWSE.
 15503
 15504
 15505
 15506* EXEC CICS ENDBR
 15507*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 296
* EL130.cbl
 15508*    END-EXEC.
 15509     MOVE 0
 15510       TO DFHEIV11
 15511*    MOVE '&2                    $   #00013987' TO DFHEIV0
 15512     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15513     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15514     MOVE X'2020233030303133393837' TO DFHEIV0(25:11)
 15515     CALL 'kxdfhei1' USING DFHEIV0,
 15516           ELMSTR5-DSID,
 15517           DFHEIV11,
 15518           DFHEIV99
 15519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15520
 15521
 15522 7500-EXIT.
 15523     EXIT.
 15524
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 297
* EL130.cbl
 15526 7550-FALL-THRU-PARA.
 15527
 15528
 15529
 15530* EXEC CICS DUMP
 15531*         DUMPCODE ('E130')
 15532*         TASK
 15533*    END-EXEC.
 15534     MOVE 'E130' TO DFHEIV5
 15535*    MOVE '<"   T                $   #00013998' TO DFHEIV0
 15536     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 15537     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15538     MOVE X'2020233030303133393938' TO DFHEIV0(25:11)
 15539     CALL 'kxdfhei1' USING DFHEIV0,
 15540           DFHEIV5,
 15541           DFHEIV99,
 15542           DFHEIV99
 15543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15544
 15545
 15546
 15547
 15548* EXEC CICS RETURN
 15549*    END-EXEC.
 15550*    MOVE '.(                    ''   #00014004' TO DFHEIV0
 15551     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15552     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15553     MOVE X'2020233030303134303034' TO DFHEIV0(25:11)
 15554     CALL 'kxdfhei1' USING DFHEIV0,
 15555           DFHEIV99,
 15556           DFHEIV99,
 15557           DFHEIV99,
 15558           DFHEIV99,
 15559           DFHEIV99,
 15560           DFHEIV99
 15561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15562
 15563
 15564 7600-BROWSE-CLAIM.
 15565
 15566
 15567
 15568* EXEC CICS READ
 15569*        DATASET(ELMSTR-DSID)
 15570*        SET    (ADDRESS OF CLAIM-MASTER)
 15571*        RIDFLD (ELMSTR-KEY)
 15572*        GENERIC
 15573*        EQUAL
 15574*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15575*    END-EXEC.
 15576*    MOVE '&"S  KG    E          (   #00014010' TO DFHEIV0
 15577     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15578     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15579     MOVE X'2020233030303134303130' TO DFHEIV0(25:11)
 15580     CALL 'kxdfhei1' USING DFHEIV0,
 15581           ELMSTR-DSID,
 15582           DFHEIV20,
 15583           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 298
* EL130.cbl
 15584           ELMSTR-KEY,
 15585           ELMSTR-GENERIC-LENGTH,
 15586           DFHEIV99,
 15587           DFHEIV99
 15588     SET ADDRESS OF CLAIM-MASTER TO
 15589         DFHEIV20
 15590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15591
 15592
 15593     MOVE CL-CERT-PRIME          TO CERTNOI.
 15594     MOVE CL-CERT-SFX            TO SUFXI.
 15595
 15596 7610-BROWSE-CLAIM-LOOP.
 15597
 15598     MOVE LOW-VALUES             TO BCERT1O
 15599                                    BSUFX1O
 15600                                    BCERT2O
 15601                                    BSUFX2O
 15602                                    BCERT3O
 15603                                    BSUFX3O
 15604                                    BCERT4O
 15605                                    BSUFX4O
 15606                                    BCERT5O
 15607                                    BSUFX5O.
 15608
 15609     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 15610
 15611
 15612
 15613* EXEC CICS HANDLE CONDITION
 15614*        ENDFILE  (7630-END-BROWSE)
 15615*    END-EXEC.
 15616*    MOVE '"$''                   ! J #00014038' TO DFHEIV0
 15617     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15618     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15619     MOVE X'4A20233030303134303338' TO DFHEIV0(25:11)
 15620     CALL 'kxdfhei1' USING DFHEIV0
 15621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15622
 15623
 15624
 15625
 15626* EXEC CICS STARTBR
 15627*        DATASET    (ELMSTR-DSID)
 15628*        RIDFLD     (ELMSTR-KEY)
 15629*    END-EXEC.
 15630     MOVE 0
 15631       TO DFHEIV11
 15632*    MOVE '&,         G          &   #00014043' TO DFHEIV0
 15633     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15634     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15635     MOVE X'2020233030303134303433' TO DFHEIV0(25:11)
 15636     CALL 'kxdfhei1' USING DFHEIV0,
 15637           ELMSTR-DSID,
 15638           ELMSTR-KEY,
 15639           DFHEIV99,
 15640           DFHEIV11,
 15641           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 299
* EL130.cbl
 15642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15643
 15644
 15645     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15646
 15647 7620-READ-CLAIM-LOOP.
 15648
 15649
 15650
 15651* EXEC CICS READNEXT
 15652*        DATASET   (ELMSTR-DSID)
 15653*        SET       (ADDRESS OF CLAIM-MASTER)
 15654*        RIDFLD    (ELMSTR-KEY)
 15655*    END-EXEC.
 15656     MOVE 0
 15657       TO DFHEIV11
 15658*    MOVE '&.S                   )   #00014053' TO DFHEIV0
 15659     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15660     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15661     MOVE X'2020233030303134303533' TO DFHEIV0(25:11)
 15662     CALL 'kxdfhei1' USING DFHEIV0,
 15663           ELMSTR-DSID,
 15664           DFHEIV20,
 15665           DFHEIV99,
 15666           ELMSTR-KEY,
 15667           DFHEIV99,
 15668           DFHEIV11,
 15669           DFHEIV99,
 15670           DFHEIV99
 15671     SET ADDRESS OF CLAIM-MASTER TO
 15672         DFHEIV20
 15673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15674
 15675
 15676     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 15677        CL-CARRIER     NOT = CLMCARRI       OR
 15678        CL-CLAIM-NO    NOT = CLMNOI
 15679          GO TO 7630-END-BROWSE
 15680     END-IF.
 15681
 15682     IF WS-ASSOCIATED-CERTS = 1
 15683         MOVE CL-CERT-PRIME      TO BCERT1O
 15684         MOVE CL-CERT-SFX        TO BSUFX1O
 15685     END-IF.
 15686
 15687     IF WS-ASSOCIATED-CERTS = 2
 15688         MOVE CL-CERT-PRIME      TO BCERT2O
 15689         MOVE CL-CERT-SFX        TO BSUFX2O
 15690     END-IF.
 15691
 15692     IF WS-ASSOCIATED-CERTS = 3
 15693         MOVE CL-CERT-PRIME      TO BCERT3O
 15694         MOVE CL-CERT-SFX        TO BSUFX3O
 15695     END-IF.
 15696
 15697     IF WS-ASSOCIATED-CERTS = 4
 15698         MOVE CL-CERT-PRIME      TO BCERT4O
 15699         MOVE CL-CERT-SFX        TO BSUFX4O
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 300
* EL130.cbl
 15700     END-IF.
 15701
 15702     IF WS-ASSOCIATED-CERTS = 5
 15703         MOVE CL-CERT-PRIME      TO BCERT5O
 15704         MOVE CL-CERT-SFX        TO BSUFX5O
 15705     ELSE
 15706         ADD +1                  TO WS-ASSOCIATED-CERTS
 15707         GO TO 7620-READ-CLAIM-LOOP
 15708     END-IF.
 15709
 15710 7630-END-BROWSE.
 15711
 15712
 15713
 15714* EXEC CICS ENDBR
 15715*        DATASET   (ELMSTR-DSID)
 15716*    END-EXEC.
 15717     MOVE 0
 15718       TO DFHEIV11
 15719*    MOVE '&2                    $   #00014096' TO DFHEIV0
 15720     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15721     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15722     MOVE X'2020233030303134303936' TO DFHEIV0(25:11)
 15723     CALL 'kxdfhei1' USING DFHEIV0,
 15724           ELMSTR-DSID,
 15725           DFHEIV11,
 15726           DFHEIV99
 15727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15728
 15729
 15730 7640-HIGHLIGHT-CERT-DISPLAYED.
 15731
 15732     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 15733     MOVE AL-SANON               TO BCERT1A
 15734                                    BSUFX1A
 15735                                    BCERT2A
 15736                                    BSUFX2A
 15737                                    BCERT3A
 15738                                    BSUFX3A
 15739                                    BCERT4A
 15740                                    BSUFX4A
 15741                                    BCERT5A
 15742                                    BSUFX5A.
 15743
 15744     IF BCERT1O = CERTNOI AND
 15745        BSUFX1O = SUFXI
 15746            MOVE AL-SABON        TO BCERT1A
 15747                                    BSUFX1A
 15748     END-IF.
 15749
 15750     IF BCERT2O = CERTNOI AND
 15751        BSUFX2O = SUFXI
 15752            MOVE AL-SABON        TO BCERT2A
 15753                                    BSUFX2A
 15754     END-IF.
 15755
 15756     IF BCERT3O = CERTNOI AND
 15757        BSUFX3O = SUFXI
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 301
* EL130.cbl
 15758            MOVE AL-SABON        TO BCERT3A
 15759                                    BSUFX3A
 15760     END-IF.
 15761
 15762     IF BCERT4O = CERTNOI AND
 15763        BSUFX4O = SUFXI
 15764            MOVE AL-SABON        TO BCERT4A
 15765                                    BSUFX4A
 15766     END-IF.
 15767
 15768     IF BCERT5O = CERTNOI AND
 15769        BSUFX5O = SUFXI
 15770            MOVE AL-SABON        TO BCERT5A
 15771                                    BSUFX5A
 15772     END-IF.
 15773
 15774 7699-EXIT.
 15775     EXIT.
 15776
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 302
* EL130.cbl
 15778 7700-CHECK-SEQUENCE.
 15779
 15780
 15781
 15782* EXEC CICS HANDLE CONDITION
 15783*        ENDFILE  (7799-EXIT)
 15784*        NOTFND   (7799-EXIT)
 15785*    END-EXEC.
 15786*    MOVE '"$''I                  ! K #00014151' TO DFHEIV0
 15787     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15788     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15789     MOVE X'4B20233030303134313531' TO DFHEIV0(25:11)
 15790     CALL 'kxdfhei1' USING DFHEIV0
 15791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15792
 15793
 15794
 15795
 15796* EXEC CICS READ
 15797*        DATASET(ELMSTR-DSID)
 15798*        SET    (ADDRESS OF CLAIM-MASTER)
 15799*        RIDFLD (ELMSTR-KEY)
 15800*        GENERIC
 15801*        EQUAL
 15802*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15803*    END-EXEC.
 15804*    MOVE '&"S  KG    E          (   #00014157' TO DFHEIV0
 15805     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15806     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15807     MOVE X'2020233030303134313537' TO DFHEIV0(25:11)
 15808     CALL 'kxdfhei1' USING DFHEIV0,
 15809           ELMSTR-DSID,
 15810           DFHEIV20,
 15811           DFHEIV99,
 15812           ELMSTR-KEY,
 15813           ELMSTR-GENERIC-LENGTH,
 15814           DFHEIV99,
 15815           DFHEIV99
 15816     SET ADDRESS OF CLAIM-MASTER TO
 15817         DFHEIV20
 15818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15819
 15820
 15821     COMPUTE WS-ASSOC-CERT-TOTAL =
 15822             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15823
 15824     GO TO 7799-EXIT.
 15825
 15826 7710-RESEQUENCE-CLAIMS.
 15827
 15828
 15829
 15830* EXEC CICS HANDLE CONDITION
 15831*        ENDFILE  (7790-END-BROWSE)
 15832*    END-EXEC.
 15833*    MOVE '"$''                   ! L #00014174' TO DFHEIV0
 15834     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15835     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 303
* EL130.cbl
 15836     MOVE X'4C20233030303134313734' TO DFHEIV0(25:11)
 15837     CALL 'kxdfhei1' USING DFHEIV0
 15838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15839
 15840
 15841
 15842
 15843* EXEC CICS STARTBR
 15844*        DATASET    (ELMSTR-DSID)
 15845*        RIDFLD     (ELMSTR-KEY)
 15846*    END-EXEC.
 15847     MOVE 0
 15848       TO DFHEIV11
 15849*    MOVE '&,         G          &   #00014179' TO DFHEIV0
 15850     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15851     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15852     MOVE X'2020233030303134313739' TO DFHEIV0(25:11)
 15853     CALL 'kxdfhei1' USING DFHEIV0,
 15854           ELMSTR-DSID,
 15855           ELMSTR-KEY,
 15856           DFHEIV99,
 15857           DFHEIV11,
 15858           DFHEIV99
 15859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15860
 15861
 15862     ADD +1 TO WS-ASSOC-CERT-SEQU
 15863               WS-READNEXT-SWITCH.
 15864
 15865 7720-READ-CLAIM-LOOP.
 15866
 15867
 15868
 15869* EXEC CICS READNEXT
 15870*        DATASET   (ELMSTR-DSID)
 15871*        SET       (ADDRESS OF CLAIM-MASTER)
 15872*        RIDFLD    (ELMSTR-KEY)
 15873*    END-EXEC.
 15874     MOVE 0
 15875       TO DFHEIV11
 15876*    MOVE '&.S                   )   #00014190' TO DFHEIV0
 15877     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15878     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15879     MOVE X'2020233030303134313930' TO DFHEIV0(25:11)
 15880     CALL 'kxdfhei1' USING DFHEIV0,
 15881           ELMSTR-DSID,
 15882           DFHEIV20,
 15883           DFHEIV99,
 15884           ELMSTR-KEY,
 15885           DFHEIV99,
 15886           DFHEIV11,
 15887           DFHEIV99,
 15888           DFHEIV99
 15889     SET ADDRESS OF CLAIM-MASTER TO
 15890         DFHEIV20
 15891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15892
 15893
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 304
* EL130.cbl
 15894     IF WS-READNEXT-SWITCH = 1
 15895         ADD 1 TO WS-READNEXT-SWITCH
 15896         GO TO 7720-READ-CLAIM-LOOP
 15897     END-IF.
 15898
 15899 7730-END-BROWSE.
 15900
 15901
 15902
 15903* EXEC CICS ENDBR
 15904*        DATASET   (ELMSTR-DSID)
 15905*    END-EXEC.
 15906     MOVE 0
 15907       TO DFHEIV11
 15908*    MOVE '&2                    $   #00014204' TO DFHEIV0
 15909     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15910     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15911     MOVE X'2020233030303134323034' TO DFHEIV0(25:11)
 15912     CALL 'kxdfhei1' USING DFHEIV0,
 15913           ELMSTR-DSID,
 15914           DFHEIV11,
 15915           DFHEIV99
 15916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15917
 15918
 15919 7740-READ-CLAIM-UPDATE.
 15920
 15921     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 15922        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 15923        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 15924          GO TO 7799-EXIT
 15925     ELSE
 15926          MOVE ZERO              TO WS-READNEXT-SWITCH
 15927     END-IF.
 15928
 15929
 15930
 15931* EXEC CICS READ
 15932*        DATASET(ELMSTR-DSID)
 15933*        SET    (ADDRESS OF CLAIM-MASTER)
 15934*        RIDFLD (ELMSTR-KEY)
 15935*        UPDATE
 15936*    END-EXEC.
 15937*    MOVE '&"S        EU         (   #00014219' TO DFHEIV0
 15938     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15939     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15940     MOVE X'2020233030303134323139' TO DFHEIV0(25:11)
 15941     CALL 'kxdfhei1' USING DFHEIV0,
 15942           ELMSTR-DSID,
 15943           DFHEIV20,
 15944           DFHEIV99,
 15945           ELMSTR-KEY,
 15946           DFHEIV99,
 15947           DFHEIV99,
 15948           DFHEIV99
 15949     SET ADDRESS OF CLAIM-MASTER TO
 15950         DFHEIV20
 15951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 305
* EL130.cbl
 15952
 15953
 15954     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15955     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 15956
 15957
 15958
 15959* EXEC CICS REWRITE
 15960*         DATASET     (ELMSTR-DSID)
 15961*         FROM        (CLAIM-MASTER)
 15962*    END-EXEC.
 15963     MOVE LENGTH OF
 15964      CLAIM-MASTER
 15965       TO DFHEIV11
 15966*    MOVE '&& L                  %   #00014230' TO DFHEIV0
 15967     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15968     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15969     MOVE X'2020233030303134323330' TO DFHEIV0(25:11)
 15970     CALL 'kxdfhei1' USING DFHEIV0,
 15971           ELMSTR-DSID,
 15972           CLAIM-MASTER,
 15973           DFHEIV11,
 15974           DFHEIV99
 15975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15976
 15977
 15978     GO TO 7710-RESEQUENCE-CLAIMS.
 15979
 15980 7790-END-BROWSE.
 15981
 15982
 15983
 15984* EXEC CICS ENDBR
 15985*        DATASET   (ELMSTR-DSID)
 15986*    END-EXEC.
 15987     MOVE 0
 15988       TO DFHEIV11
 15989*    MOVE '&2                    $   #00014240' TO DFHEIV0
 15990     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15991     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15992     MOVE X'2020233030303134323430' TO DFHEIV0(25:11)
 15993     CALL 'kxdfhei1' USING DFHEIV0,
 15994           ELMSTR-DSID,
 15995           DFHEIV11,
 15996           DFHEIV99
 15997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15998
 15999
 16000 7799-EXIT.
 16001     EXIT.
 16002
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 306
* EL130.cbl
 16004************************************************
 16005*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 16006************************************************
 16007
 16008 7900-READ-ACTV-UPDATE.
 16009     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16010     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16011     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16012     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16013     MOVE +0                     TO TRLR-SEQ-NO.
 16014     MOVE '1'                    TO TRLR-TYPE.
 16015     GO TO 7900-READ-TRAILER-UPDATE.
 16016
 16017 7900-READ-NINETY-UPDATE.
 16018     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16019     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16020     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16021     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16022     MOVE +90                    TO TRLR-SEQ-NO.
 16023     MOVE '6'                    TO TRLR-TYPE.
 16024
 16025 7900-READ-TRAILER-UPDATE.
 16026
 16027
 16028* EXEC CICS READ  UPDATE
 16029*        DATASET    (ELTRLR-DSID)
 16030*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 16031*        RIDFLD     (ELTRLR-KEY)
 16032*    END-EXEC.
 16033*    MOVE '&"S        EU         (   #00014271' TO DFHEIV0
 16034     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16035     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16036     MOVE X'2020233030303134323731' TO DFHEIV0(25:11)
 16037     CALL 'kxdfhei1' USING DFHEIV0,
 16038           ELTRLR-DSID,
 16039           DFHEIV20,
 16040           DFHEIV99,
 16041           ELTRLR-KEY,
 16042           DFHEIV99,
 16043           DFHEIV99,
 16044           DFHEIV99
 16045     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16046         DFHEIV20
 16047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16048
 16049
 16050 7900-EXIT.
 16051      EXIT.
 16052
 16053 7910-READ-ACTV.
 16054     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16055     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16056     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16057     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16058     MOVE +0                     TO TRLR-SEQ-NO.
 16059     MOVE '1'                    TO TRLR-TYPE.
 16060     GO TO 7910-READ-TRAILER.
 16061
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 307
* EL130.cbl
 16062 7910-READ-NINETY.
 16063     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16064     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16065     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16066     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16067     MOVE +90                    TO TRLR-SEQ-NO.
 16068     MOVE '6'                    TO TRLR-TYPE.
 16069
 16070 7910-READ-TRAILER.
 16071     MOVE 'TRLR'                 TO FILE-SWITCH.
 16072
 16073
 16074
 16075* EXEC CICS READ
 16076*        DATASET   (ELTRLR-DSID)
 16077*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16078*        RIDFLD    (ELTRLR-KEY)
 16079*    END-EXEC.
 16080*    MOVE '&"S        E          (   #00014301' TO DFHEIV0
 16081     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16082     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16083     MOVE X'2020233030303134333031' TO DFHEIV0(25:11)
 16084     CALL 'kxdfhei1' USING DFHEIV0,
 16085           ELTRLR-DSID,
 16086           DFHEIV20,
 16087           DFHEIV99,
 16088           ELTRLR-KEY,
 16089           DFHEIV99,
 16090           DFHEIV99,
 16091           DFHEIV99
 16092     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16093         DFHEIV20
 16094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16095
 16096
 16097 7910-EXIT.
 16098      EXIT.
 16099
 16100 7915-REWRITE-TRAILER.
 16101
 16102
 16103* EXEC CICS REWRITE
 16104*        DATASET   (ELTRLR-DSID)
 16105*        FROM      (ACTIVITY-TRAILERS)
 16106*    END-EXEC.
 16107     MOVE LENGTH OF
 16108      ACTIVITY-TRAILERS
 16109       TO DFHEIV11
 16110*    MOVE '&& L                  %   #00014312' TO DFHEIV0
 16111     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16112     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16113     MOVE X'2020233030303134333132' TO DFHEIV0(25:11)
 16114     CALL 'kxdfhei1' USING DFHEIV0,
 16115           ELTRLR-DSID,
 16116           ACTIVITY-TRAILERS,
 16117           DFHEIV11,
 16118           DFHEIV99
 16119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 308
* EL130.cbl
 16120
 16121
 16122 7915-EXIT.
 16123      EXIT.
 16124
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 309
* EL130.cbl
 16126********************************************
 16127*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 16128********************************************
 16129
 16130 7920-READ-CLAIM-UPDATE.
 16131
 16132
 16133
 16134* EXEC CICS READ
 16135*        UPDATE
 16136*        DATASET   (ELMSTR-DSID)
 16137*        SET       (ADDRESS OF CLAIM-MASTER)
 16138*        RIDFLD    (ELMSTR-KEY)
 16139*    END-EXEC.
 16140*    MOVE '&"S        EU         (   #00014328' TO DFHEIV0
 16141     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16142     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16143     MOVE X'2020233030303134333238' TO DFHEIV0(25:11)
 16144     CALL 'kxdfhei1' USING DFHEIV0,
 16145           ELMSTR-DSID,
 16146           DFHEIV20,
 16147           DFHEIV99,
 16148           ELMSTR-KEY,
 16149           DFHEIV99,
 16150           DFHEIV99,
 16151           DFHEIV99
 16152     SET ADDRESS OF CLAIM-MASTER TO
 16153         DFHEIV20
 16154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16155
 16156
 16157 7920-EXIT.
 16158      EXIT.
 16159
 16160 7950-READ-CLAIM.
 16161
 16162
 16163* EXEC CICS READ
 16164*        DATASET   (ELMSTR-DSID)
 16165*        SET       (ADDRESS OF CLAIM-MASTER)
 16166*        RIDFLD    (ELMSTR-KEY)
 16167*    END-EXEC.
 16168*    MOVE '&"S        E          (   #00014340' TO DFHEIV0
 16169     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16170     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16171     MOVE X'2020233030303134333430' TO DFHEIV0(25:11)
 16172     CALL 'kxdfhei1' USING DFHEIV0,
 16173           ELMSTR-DSID,
 16174           DFHEIV20,
 16175           DFHEIV99,
 16176           ELMSTR-KEY,
 16177           DFHEIV99,
 16178           DFHEIV99,
 16179           DFHEIV99
 16180     SET ADDRESS OF CLAIM-MASTER TO
 16181         DFHEIV20
 16182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16183
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 310
* EL130.cbl
 16184
 16185 7950-EXIT.
 16186      EXIT.
 16187
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 311
* EL130.cbl
 16189***************************************
 16190*  I/O REQUESTS AGAINST CONTROL FILE  *
 16191***************************************
 16192
 16193 7960-READ-CNTL-UPDATE.
 16194
 16195
 16196* EXEC CICS READ
 16197*        UPDATE
 16198*        DATASET  (ELCNTL-DSID)
 16199*        SET      (ADDRESS OF CONTROL-FILE)
 16200*        RIDFLD   (ELCNTL-KEY)
 16201*    END-EXEC.
 16202*    MOVE '&"S        EU         (   #00014356' TO DFHEIV0
 16203     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16204     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16205     MOVE X'2020233030303134333536' TO DFHEIV0(25:11)
 16206     CALL 'kxdfhei1' USING DFHEIV0,
 16207           ELCNTL-DSID,
 16208           DFHEIV20,
 16209           DFHEIV99,
 16210           ELCNTL-KEY,
 16211           DFHEIV99,
 16212           DFHEIV99,
 16213           DFHEIV99
 16214     SET ADDRESS OF CONTROL-FILE TO
 16215         DFHEIV20
 16216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16217
 16218
 16219 7960-EXIT.
 16220      EXIT.
 16221
 16222 7970-READ-CNTL.
 16223
 16224
 16225* EXEC CICS READ
 16226*        DATASET  (ELCNTL-DSID)
 16227*        SET      (ADDRESS OF CONTROL-FILE)
 16228*        RIDFLD   (ELCNTL-KEY)
 16229*    END-EXEC.
 16230*    MOVE '&"S        E          (   #00014368' TO DFHEIV0
 16231     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16232     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16233     MOVE X'2020233030303134333638' TO DFHEIV0(25:11)
 16234     CALL 'kxdfhei1' USING DFHEIV0,
 16235           ELCNTL-DSID,
 16236           DFHEIV20,
 16237           DFHEIV99,
 16238           ELCNTL-KEY,
 16239           DFHEIV99,
 16240           DFHEIV99,
 16241           DFHEIV99
 16242     SET ADDRESS OF CONTROL-FILE TO
 16243         DFHEIV20
 16244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16245
 16246
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 312
* EL130.cbl
 16247 7970-EXIT.
 16248      EXIT.
 16249
 16250 7975-READ-CNTL-GTEQ.
 16251
 16252
 16253* EXEC CICS READ
 16254*         DATASET   (ELCNTL-DSID)
 16255*         SET       (ADDRESS OF CONTROL-FILE)
 16256*         RIDFLD    (ELCNTL-KEY)
 16257*         GTEQ
 16258*     END-EXEC.
 16259*    MOVE '&"S        G          (   #00014379' TO DFHEIV0
 16260     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16261     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16262     MOVE X'2020233030303134333739' TO DFHEIV0(25:11)
 16263     CALL 'kxdfhei1' USING DFHEIV0,
 16264           ELCNTL-DSID,
 16265           DFHEIV20,
 16266           DFHEIV99,
 16267           ELCNTL-KEY,
 16268           DFHEIV99,
 16269           DFHEIV99,
 16270           DFHEIV99
 16271     SET ADDRESS OF CONTROL-FILE TO
 16272         DFHEIV20
 16273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16274
 16275
 16276 7975-EXIT.
 16277      EXIT.
 16278
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 313
* EL130.cbl
 16280**************************************************
 16281*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 16282**************************************************
 16283
 16284 7980-READ-CERT5.
 16285
 16286
 16287* EXEC CICS READ
 16288*         DATASET  (ELCERT5-DSID)
 16289*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 16290*         RIDFLD   (ELCERT-KEY-5)
 16291*     END-EXEC.
 16292*    MOVE '&"S        E          (   #00014396' TO DFHEIV0
 16293     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16294     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16295     MOVE X'2020233030303134333936' TO DFHEIV0(25:11)
 16296     CALL 'kxdfhei1' USING DFHEIV0,
 16297           ELCERT5-DSID,
 16298           DFHEIV20,
 16299           DFHEIV99,
 16300           ELCERT-KEY-5,
 16301           DFHEIV99,
 16302           DFHEIV99,
 16303           DFHEIV99
 16304     SET ADDRESS OF CERTIFICATE-MASTER TO
 16305         DFHEIV20
 16306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16307
 16308
 16309 7980-EXIT.
 16310      EXIT.
 16311
 16312 7930-READ-CERT-UPDATE.
 16313
 16314
 16315* EXEC CICS READ
 16316*        DATASET  (ELCERT-DSID)
 16317*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16318*        RIDFLD   (ELCERT-KEY)
 16319*        UPDATE
 16320*    END-EXEC.
 16321*    MOVE '&"S        EU         (   #00014407' TO DFHEIV0
 16322     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16323     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16324     MOVE X'2020233030303134343037' TO DFHEIV0(25:11)
 16325     CALL 'kxdfhei1' USING DFHEIV0,
 16326           ELCERT-DSID,
 16327           DFHEIV20,
 16328           DFHEIV99,
 16329           ELCERT-KEY,
 16330           DFHEIV99,
 16331           DFHEIV99,
 16332           DFHEIV99
 16333     SET ADDRESS OF CERTIFICATE-MASTER TO
 16334         DFHEIV20
 16335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16336
 16337
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 314
* EL130.cbl
 16338 7930-EXIT.
 16339      EXIT.
 16340
 16341 7940-READ-CERT.
 16342
 16343
 16344* EXEC CICS READ
 16345*        DATASET  (ELCERT-DSID)
 16346*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16347*        RIDFLD   (ELCERT-KEY)
 16348*    END-EXEC.
 16349*    MOVE '&"S        E          (   #00014419' TO DFHEIV0
 16350     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16351     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16352     MOVE X'2020233030303134343139' TO DFHEIV0(25:11)
 16353     CALL 'kxdfhei1' USING DFHEIV0,
 16354           ELCERT-DSID,
 16355           DFHEIV20,
 16356           DFHEIV99,
 16357           ELCERT-KEY,
 16358           DFHEIV99,
 16359           DFHEIV99,
 16360           DFHEIV99
 16361     SET ADDRESS OF CERTIFICATE-MASTER TO
 16362         DFHEIV20
 16363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16364
 16365
 16366 7940-EXIT.
 16367      EXIT.
 16368
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 315
* EL130.cbl
 16370**************************************************
 16371*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 16372**************************************************
 16373
 16374 7991-READ-BENE.
 16375
 16376
 16377* EXEC CICS READ
 16378*         DATASET   (ELBENE-DSID)
 16379*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 16380*         RIDFLD    (ELBENE-KEY)
 16381*     END-EXEC.
 16382*    MOVE '&"S        E          (   #00014435' TO DFHEIV0
 16383     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16384     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16385     MOVE X'2020233030303134343335' TO DFHEIV0(25:11)
 16386     CALL 'kxdfhei1' USING DFHEIV0,
 16387           ELBENE-DSID,
 16388           DFHEIV20,
 16389           DFHEIV99,
 16390           ELBENE-KEY,
 16391           DFHEIV99,
 16392           DFHEIV99,
 16393           DFHEIV99
 16394     SET ADDRESS OF BENEFICIARY-MASTER TO
 16395         DFHEIV20
 16396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16397
 16398
 16399 7991-EXIT.
 16400      EXIT.
 16401
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 316
* EL130.cbl
 16403**************************************************
 16404*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 16405**************************************************
 16406
 16407 7992-READ-REIN.
 16408
 16409
 16410
 16411* EXEC CICS HANDLE CONDITION
 16412*        NOTFND   (7992-NOT-FOUND)
 16413*    END-EXEC.
 16414*    MOVE '"$I                   ! M #00014452' TO DFHEIV0
 16415     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16417     MOVE X'4D20233030303134343532' TO DFHEIV0(25:11)
 16418     CALL 'kxdfhei1' USING DFHEIV0
 16419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16420
 16421
 16422
 16423
 16424* EXEC CICS READ
 16425*        DATASET   (ERREIN-DSID)
 16426*        SET       (ADDRESS OF REINSURANCE-RECORD)
 16427*        RIDFLD    (ERREIN-KEY)
 16428*    END-EXEC.
 16429*    MOVE '&"S        E          (   #00014457' TO DFHEIV0
 16430     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16431     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16432     MOVE X'2020233030303134343537' TO DFHEIV0(25:11)
 16433     CALL 'kxdfhei1' USING DFHEIV0,
 16434           ERREIN-DSID,
 16435           DFHEIV20,
 16436           DFHEIV99,
 16437           ERREIN-KEY,
 16438           DFHEIV99,
 16439           DFHEIV99,
 16440           DFHEIV99
 16441     SET ADDRESS OF REINSURANCE-RECORD TO
 16442         DFHEIV20
 16443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16444
 16445
 16446     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 16447
 16448     GO TO 7992-EXIT.
 16449
 16450 7992-NOT-FOUND.
 16451     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 16452
 16453 7992-EXIT.
 16454     EXIT.
 16455
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 317
* EL130.cbl
 16457 8000-LOAD-ERROR-MESSAGES.
 16458     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 16459
 16460     IF EMI-NO-ERRORS
 16461         GO TO 8000-EXIT
 16462     END-IF.
 16463
 16464     perform varying e1 from +1 by +1 until e1 > +3
 16465        if emi-error-number (e1) = '1651' or '1652' or '1653'
 16466                                or '1655' or '1660'
 16467           move 'W'              to emi-severity (e1)
 16468        end-if
 16469     end-perform
 16470     IF EMI-NUMBER-OF-LINES = 1
 16471         MOVE EMI-LINE1          TO ERRMSG1O
 16472         GO TO 8000-EXIT
 16473     END-IF.
 16474
 16475     IF EMI-NUMBER-OF-LINES = 2
 16476          MOVE EMI-LINE1         TO ERRMSG1O
 16477          MOVE EMI-LINE2         TO ERRMSG2O
 16478          GO TO 8000-EXIT
 16479     END-IF.
 16480
 16481     MOVE EMI-LINE1              TO ERRMSG1O.
 16482
 16483 8000-EXIT.
 16484     EXIT.
 16485
 16486 8100-SEND-INITIAL-MAP.
 16487     MOVE SAVE-DATE              TO RUNDTEO.
 16488     MOVE EIBTIME                TO TIME-IN.
 16489     MOVE TIME-OUT               TO RUNTIMEO.
 16490     IF EIBAID = DFHPF11
 16491        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16492        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16493     end-if
 16494     IF RETURNED-FROM = XCTL-114
 16495        CONTINUE
 16496     ELSE
 16497        MOVE -1                  TO MAINTL
 16498     END-IF.
 16499
 16500*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16501         MOVE SPACES             TO PRODO.
 16502         MOVE AL-SANOF           TO PRODCDA.
 16503*    END-IF.
 16504
 16505     MOVE PI-COMPANY-ID          TO COMPO.
 16506     MOVE AL-PABOF               TO COMPA.
 16507     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16508     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16509     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16510
 16511     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16512
 16513     IF NOT PI-NO-CARRIER-SECURITY
 16514        MOVE PI-CARRIER-SECURITY TO CLMCARRO
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 318
* EL130.cbl
 16515        MOVE AL-SABOF            TO CLMCARRA
 16516     END-IF.
 16517
 16518     IF PI-PROCESSOR-ID = 'PEMA'
 16519        MOVE AL-UANON            TO CERTNOA
 16520                                    SUFXA
 16521     END-IF.
 16522*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16523*        NEXT SENTENCE
 16524*        CONTINUE
 16525*    ELSE
 16526         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16527*    END-IF.
 16528
 16529
 16530
 16531* EXEC CICS SEND
 16532*        MAP     (MAP-NAME)
 16533*        MAPSET  (MAPSET-NAME)
 16534*        FROM    (EL130AO)
 16535*        ERASE
 16536*        CURSOR
 16537*    END-EXEC.
 16538     MOVE LENGTH OF
 16539      EL130AO
 16540       TO DFHEIV12
 16541     MOVE -1
 16542       TO DFHEIV11
 16543*    MOVE '8$     CT  E    H L F ,   #00014547' TO DFHEIV0
 16544     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16545     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16546     MOVE X'2020233030303134353437' TO DFHEIV0(25:11)
 16547     CALL 'kxdfhei1' USING DFHEIV0,
 16548           MAP-NAME,
 16549           EL130AO,
 16550           DFHEIV12,
 16551           MAPSET-NAME,
 16552           DFHEIV99,
 16553           DFHEIV99,
 16554           DFHEIV99,
 16555           DFHEIV11,
 16556           DFHEIV99,
 16557           DFHEIV99,
 16558           DFHEIV99
 16559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16560
 16561
 16562     GO TO 9100-RETURN-TRAN.
 16563
 16564 8150-SEND-MAP-CURSOR.
 16565     MOVE SAVE-DATE              TO RUNDTEO.
 16566     MOVE EIBTIME                TO TIME-IN.
 16567     MOVE TIME-OUT               TO RUNTIMEO.
 16568     IF EIBAID = DFHPF11
 16569        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16570        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16571     end-if
 16572     MOVE PI-COMPANY-ID          TO COMPO.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 319
* EL130.cbl
 16573     MOVE AL-PABOF               TO COMPA
 16574     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16575     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16576     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16577
 16578*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16579         MOVE SPACES             TO PRODO.
 16580         MOVE AL-SANOF           TO PRODCDA.
 16581*    END-IF.
 16582
 16583     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16584
 16585     IF NOT PI-NO-CARRIER-SECURITY
 16586         MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16587         MOVE AL-SABOF            TO CLMCARRA
 16588     END-IF.
 16589
 16590     IF PI-PROCESSOR-ID = 'PEMA'
 16591        MOVE AL-UANON            TO CERTNOA
 16592                                    SUFXA
 16593     END-IF.
 16594*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16595*        NEXT SENTENCE
 16596*        CONTINUE
 16597*    ELSE
 16598         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16599*    END-IF.
 16600
 16601
 16602
 16603* EXEC CICS SEND
 16604*        MAP      (MAP-NAME)
 16605*        MAPSET   (MAPSET-NAME)
 16606*        FROM     (EL130AO)
 16607*        CURSOR   (PI-CURSOR)
 16608*        ERASE
 16609*    END-EXEC.
 16610     MOVE LENGTH OF
 16611      EL130AO
 16612       TO DFHEIV11
 16613*    MOVE '8$     CT  E    H L F ,   #00014595' TO DFHEIV0
 16614     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16615     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16616     MOVE X'2020233030303134353935' TO DFHEIV0(25:11)
 16617     CALL 'kxdfhei1' USING DFHEIV0,
 16618           MAP-NAME,
 16619           EL130AO,
 16620           DFHEIV11,
 16621           MAPSET-NAME,
 16622           DFHEIV99,
 16623           DFHEIV99,
 16624           DFHEIV99,
 16625           PI-CURSOR,
 16626           DFHEIV99,
 16627           DFHEIV99,
 16628           DFHEIV99
 16629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16630
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 320
* EL130.cbl
 16631
 16632     GO TO 9100-RETURN-TRAN.
 16633
 16634 8200-SEND-DATAONLY.
 16635     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16636
 16637     IF EIBAID = DFHPF11
 16638        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16639        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16640        go to 8100-send-initial-map
 16641     end-if
 16642*    IF EIBAID = DFHPF11
 16643*       MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16644*       move pi-last-claim       to emi-claim-no
 16645*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16646*       go to 8100-send-initial-map
 16647*    END-IF.
 16648     .
 16649 8200-BYPASS-ERROR.
 16650     MOVE SAVE-DATE              TO RUNDTEO.
 16651     MOVE EIBTIME                TO TIME-IN.
 16652     MOVE TIME-OUT               TO RUNTIMEO.
 16653     MOVE PI-COMPANY-ID          TO COMPO.
 16654     MOVE AL-PABOF               TO COMPA
 16655     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16656
 16657*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16658         MOVE SPACES             TO PRODO.
 16659         MOVE AL-SANOF           TO PRODCDA.
 16660*    END-IF.
 16661
 16662     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16663     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16664
 16665     IF PI-PROCESSOR-ID = 'PEMA'
 16666        MOVE AL-UANON            TO CERTNOA
 16667                                    SUFXA
 16668     END-IF.
 16669     IF NOT PI-NO-CARRIER-SECURITY
 16670        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16671        MOVE AL-SABOF            TO CLMCARRA
 16672     END-IF.
 16673
 16674*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16675*        NEXT SENTENCE
 16676*        CONTINUE
 16677*    ELSE
 16678         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16679*    END-IF.
 16680
 16681*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 16682         MOVE AL-SANOF           TO PRODCDA.
 16683*    END-IF.
 16684
 16685
 16686
 16687* EXEC CICS SEND
 16688*        MAP      (MAP-NAME)
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 321
* EL130.cbl
 16689*        MAPSET   (MAPSET-NAME)
 16690*        FROM     (EL130AO)
 16691*        DATAONLY
 16692*        CURSOR
 16693*    END-EXEC.
 16694     MOVE LENGTH OF
 16695      EL130AO
 16696       TO DFHEIV12
 16697     MOVE -1
 16698       TO DFHEIV11
 16699*    MOVE '8$D    CT       H L F ,   #00014657' TO DFHEIV0
 16700     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16701     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16702     MOVE X'2020233030303134363537' TO DFHEIV0(25:11)
 16703     CALL 'kxdfhei1' USING DFHEIV0,
 16704           MAP-NAME,
 16705           EL130AO,
 16706           DFHEIV12,
 16707           MAPSET-NAME,
 16708           DFHEIV99,
 16709           DFHEIV99,
 16710           DFHEIV99,
 16711           DFHEIV11,
 16712           DFHEIV99,
 16713           DFHEIV99,
 16714           DFHEIV99
 16715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16716
 16717
 16718     GO TO 9100-RETURN-TRAN.
 16719
 16720 8300-SEND-TEXT.
 16721
 16722
 16723* EXEC CICS SEND TEXT
 16724*        FROM     (LOGOFF-TEXT)
 16725*        LENGTH   (LOGOFF-LENGTH)
 16726*        ERASE
 16727*        FREEKB
 16728*    END-EXEC.
 16729*    MOVE '8&      T  E F  H   F -   #00014669' TO DFHEIV0
 16730     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16731     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16732     MOVE X'2020233030303134363639' TO DFHEIV0(25:11)
 16733     CALL 'kxdfhei1' USING DFHEIV0,
 16734           LOGOFF-TEXT,
 16735           LOGOFF-LENGTH,
 16736           DFHEIV99,
 16737           DFHEIV99,
 16738           DFHEIV99,
 16739           DFHEIV99,
 16740           DFHEIV99,
 16741           DFHEIV99,
 16742           DFHEIV99,
 16743           DFHEIV99,
 16744           DFHEIV99,
 16745           DFHEIV99
 16746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 322
* EL130.cbl
 16747
 16748
 16749
 16750
 16751* EXEC CICS RETURN
 16752*    END-EXEC.
 16753*    MOVE '.(                    ''   #00014677' TO DFHEIV0
 16754     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16755     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16756     MOVE X'2020233030303134363737' TO DFHEIV0(25:11)
 16757     CALL 'kxdfhei1' USING DFHEIV0,
 16758           DFHEIV99,
 16759           DFHEIV99,
 16760           DFHEIV99,
 16761           DFHEIV99,
 16762           DFHEIV99,
 16763           DFHEIV99
 16764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16765
 16766
 16767 8800-UNAUTHORIZED-ACCESS.
 16768     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16769     GO TO 8300-SEND-TEXT.
 16770
 16771 8810-PF23.
 16772     MOVE EIBAID TO PI-ENTRY-CD-1.
 16773     MOVE XCTL-005               TO PGM-NAME.
 16774     GO TO 9300-XCTL.
 16775
 16776 8820-TERM-ERROR.
 16777     MOVE ER-0412                TO EMI-ERROR.
 16778     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16779     MOVE -1                     TO MAINTL.
 16780     GO TO 8200-SEND-DATAONLY.
 16781
 16782 8830-TRAN-ERROR.
 16783     MOVE ER-0413                TO EMI-ERROR.
 16784     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16785     MOVE -1                     TO MAINTL.
 16786     GO TO 8200-SEND-DATAONLY.
 16787
 16788 9000-RETURN-CICS.
 16789
 16790
 16791* EXEC CICS RETURN
 16792*    END-EXEC.
 16793*    MOVE '.(                    ''   #00014703' TO DFHEIV0
 16794     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16795     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16796     MOVE X'2020233030303134373033' TO DFHEIV0(25:11)
 16797     CALL 'kxdfhei1' USING DFHEIV0,
 16798           DFHEIV99,
 16799           DFHEIV99,
 16800           DFHEIV99,
 16801           DFHEIV99,
 16802           DFHEIV99,
 16803           DFHEIV99
 16804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 323
* EL130.cbl
 16805
 16806
 16807 9100-RETURN-TRAN.
 16808     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16809     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 16810
 16811
 16812
 16813* EXEC CICS RETURN
 16814*        TRANSID   (TRANS-ID)
 16815*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16816*        LENGTH    (PI-COMM-LENGTH)
 16817*    END-EXEC.
 16818*    MOVE '.(CT                  ''   #00014711' TO DFHEIV0
 16819     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16820     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16821     MOVE X'2020233030303134373131' TO DFHEIV0(25:11)
 16822     CALL 'kxdfhei1' USING DFHEIV0,
 16823           TRANS-ID,
 16824           PROGRAM-INTERFACE-BLOCK,
 16825           PI-COMM-LENGTH,
 16826           DFHEIV99,
 16827           DFHEIV99,
 16828           DFHEIV99
 16829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16830
 16831
 16832 9200-RETURN-MAIN-MENU.
 16833     MOVE XCTL-126               TO PGM-NAME.
 16834     GO TO 9300-XCTL.
 16835
 16836 9300-XCTL.
 16837
 16838
 16839* EXEC CICS XCTL
 16840*        PROGRAM   (PGM-NAME)
 16841*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16842*        LENGTH    (PI-COMM-LENGTH)
 16843*    END-EXEC.
 16844*    MOVE '.$C                   %   #00014723' TO DFHEIV0
 16845     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16846     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16847     MOVE X'2020233030303134373233' TO DFHEIV0(25:11)
 16848     CALL 'kxdfhei1' USING DFHEIV0,
 16849           PGM-NAME,
 16850           PROGRAM-INTERFACE-BLOCK,
 16851           PI-COMM-LENGTH,
 16852           DFHEIV99
 16853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16854
 16855
 16856 9400-CLEAR.
 16857     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 16858     GO TO 9300-XCTL.
 16859
 16860 9500-PF12.
 16861     MOVE XCTL-010               TO PGM-NAME.
 16862     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 324
* EL130.cbl
 16863
 16864 9600-PGMID-ERROR.
 16865
 16866
 16867* EXEC CICS HANDLE CONDITION
 16868*        PGMIDERR  (8300-SEND-TEXT)
 16869*    END-EXEC.
 16870*    MOVE '"$L                   ! N #00014739' TO DFHEIV0
 16871     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16872     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16873     MOVE X'4E20233030303134373339' TO DFHEIV0(25:11)
 16874     CALL 'kxdfhei1' USING DFHEIV0
 16875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16876
 16877
 16878     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 16879     MOVE ' '                    TO PI-ENTRY-CD-1.
 16880     MOVE XCTL-005               TO PGM-NAME.
 16881     MOVE PGM-NAME               TO LOGOFF-PGM.
 16882     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 16883     GO TO 9300-XCTL.
 16884
 16885 9700-LINK-DATE-CONVERT.
 16886     MOVE LINK-ELDATCV           TO PGM-NAME.
 16887
 16888
 16889* EXEC CICS LINK
 16890*        PROGRAM    (PGM-NAME)
 16891*        COMMAREA   (DATE-CONVERSION-DATA)
 16892*        LENGTH     (DC-COMM-LENGTH)
 16893*    END-EXEC.
 16894*    MOVE '."C                   (   #00014753' TO DFHEIV0
 16895     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16896     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16897     MOVE X'2020233030303134373533' TO DFHEIV0(25:11)
 16898     CALL 'kxdfhei1' USING DFHEIV0,
 16899           PGM-NAME,
 16900           DATE-CONVERSION-DATA,
 16901           DC-COMM-LENGTH,
 16902           DFHEIV99,
 16903           DFHEIV99,
 16904           DFHEIV99,
 16905           DFHEIV99
 16906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16907
 16908
 16909 9700-EXIT.
 16910     EXIT.
 16911
 16912 9800-LINK-REM-TERM.
 16913     MOVE LINK-ELRTRM            TO PGM-NAME.
 16914
 16915
 16916* EXEC CICS LINK
 16917*        PROGRAM    (PGM-NAME)
 16918*        COMMAREA   (CALCULATION-PASS-AREA)
 16919*        LENGTH     (CP-COMM-LENGTH)
 16920*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 325
* EL130.cbl
 16921*    MOVE '."C                   (   #00014765' TO DFHEIV0
 16922     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16923     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16924     MOVE X'2020233030303134373635' TO DFHEIV0(25:11)
 16925     CALL 'kxdfhei1' USING DFHEIV0,
 16926           PGM-NAME,
 16927           CALCULATION-PASS-AREA,
 16928           CP-COMM-LENGTH,
 16929           DFHEIV99,
 16930           DFHEIV99,
 16931           DFHEIV99,
 16932           DFHEIV99
 16933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16934
 16935
 16936 9800-EXIT.
 16937     EXIT.
 16938
 16939 9900-ERROR-FORMAT.
 16940*    if emi-error = 1651 or 1652 or 1653 or 1655
 16941*       display ' 9900 error ' emi-error
 16942*       display emi-message-area (1)
 16943*       display emi-message-area (2)
 16944*       display emi-message-area (3)
 16945*    end-if
 16946     IF NOT EMI-ERRORS-COMPLETE
 16947         MOVE LINK-001           TO PGM-NAME
 16948
 16949* EXEC CICS LINK
 16950*            PROGRAM   (PGM-NAME)
 16951*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 16952*            LENGTH    (EMI-COMM-LENGTH)
 16953*        END-EXEC
 16954*    MOVE '."C                   (   #00014783' TO DFHEIV0
 16955     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16956     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16957     MOVE X'2020233030303134373833' TO DFHEIV0(25:11)
 16958     CALL 'kxdfhei1' USING DFHEIV0,
 16959           PGM-NAME,
 16960           ERROR-MESSAGE-INTERFACE-BLOCK,
 16961           EMI-COMM-LENGTH,
 16962           DFHEIV99,
 16963           DFHEIV99,
 16964           DFHEIV99,
 16965           DFHEIV99
 16966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16967         if emi-error = 1651 or 1652 or 1653 or 1655 or 1660
 16968            subtract 1 from emi-fatal-ctr
 16969         end-if
 16970     END-IF.
 16971
 16972     .
 16973 9900-EXIT.
 16974     EXIT.
 16975
 16976 9990-ABEND.
 16977     MOVE -1                     TO MAINTL.
 16978     MOVE LINK-004               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 326
* EL130.cbl
 16979     MOVE DFHEIBLK               TO EMI-LINE1.
 16980
 16981
 16982* EXEC CICS LINK
 16983*        PROGRAM   (PGM-NAME)
 16984*        COMMAREA  (EMI-LINE1)
 16985*        LENGTH    (72)
 16986*    END-EXEC.
 16987     MOVE 72
 16988       TO DFHEIV11
 16989*    MOVE '."C                   (   #00014802' TO DFHEIV0
 16990     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16991     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16992     MOVE X'2020233030303134383032' TO DFHEIV0(25:11)
 16993     CALL 'kxdfhei1' USING DFHEIV0,
 16994           PGM-NAME,
 16995           EMI-LINE1,
 16996           DFHEIV11,
 16997           DFHEIV99,
 16998           DFHEIV99,
 16999           DFHEIV99,
 17000           DFHEIV99
 17001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17002
 17003
 17004     MOVE EMI-LINE1              TO ERRMSG2O.
 17005
 17006     GO TO 8200-BYPASS-ERROR.
 17007
 17008
 17009
 17010* GOBACK.
 17011     MOVE '9%                    "   ' TO DFHEIV0
 17012     MOVE 'EL130' TO DFHEIV1
 17013     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17014     GOBACK.
 17015
 17016 9995-SECURITY-VIOLATION.
 17017*             COPY ELCSCTP.
 17018******************************************************************
 17019*                                                                *
 17020*                            ELCSCTP                             *
 17021*                            VMOD=2.001                          *
 17022*                                                                *
 17023*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17024******************************************************************
 17025
 17026
 17027     MOVE EIBDATE          TO SM-JUL-DATE.
 17028     MOVE EIBTRMID         TO SM-TERMID.
 17029     MOVE THIS-PGM         TO SM-PGM.
 17030     MOVE EIBTIME          TO TIME-IN.
 17031     MOVE TIME-OUT         TO SM-TIME.
 17032     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17033
 17034
 17035* EXEC CICS LINK
 17036*         PROGRAM  ('EL003')
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 327
* EL130.cbl
 17037*         COMMAREA (SECURITY-MESSAGE)
 17038*         LENGTH   (80)
 17039*    END-EXEC.
 17040     MOVE 'EL003' TO DFHEIV1
 17041     MOVE 80
 17042       TO DFHEIV11
 17043*    MOVE '."C                   (   #00014833' TO DFHEIV0
 17044     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17045     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17046     MOVE X'2020233030303134383333' TO DFHEIV0(25:11)
 17047     CALL 'kxdfhei1' USING DFHEIV0,
 17048           DFHEIV1,
 17049           SECURITY-MESSAGE,
 17050           DFHEIV11,
 17051           DFHEIV99,
 17052           DFHEIV99,
 17053           DFHEIV99,
 17054           DFHEIV99
 17055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17056
 17057
 17058******************************************************************
 17059
 17060
 17061 9995-EXIT.
 17062     EXIT.
 17063
 17064
 17065 9999-DFHBACK SECTION.
 17066     MOVE '9%                    "   ' TO DFHEIV0
 17067     MOVE 'EL130' TO DFHEIV1
 17068     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17069     GOBACK.
 17070 9999-DFHEXIT.
 17071     IF DFHEIGDJ EQUAL 0001
 17072         NEXT SENTENCE
 17073     ELSE IF DFHEIGDJ EQUAL 2
 17074         GO TO 0100-TEST-ENTRY,
 17075               8100-SEND-INITIAL-MAP,
 17076               9600-PGMID-ERROR,
 17077               8820-TERM-ERROR,
 17078               8830-TRAN-ERROR,
 17079               9990-ABEND
 17080         DEPENDING ON DFHEIGDI
 17081     ELSE IF DFHEIGDJ EQUAL 3
 17082         GO TO 0450-ADD-ELACTQ-RECORD
 17083         DEPENDING ON DFHEIGDI
 17084     ELSE IF DFHEIGDJ EQUAL 4
 17085         GO TO 8820-TERM-ERROR,
 17086               8830-TRAN-ERROR
 17087         DEPENDING ON DFHEIGDI
 17088     ELSE IF DFHEIGDJ EQUAL 5
 17089         GO TO 0660-NOT-FOUND,
 17090               0670-QIDERR
 17091         DEPENDING ON DFHEIGDI
 17092     ELSE IF DFHEIGDJ EQUAL 6
 17093         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17094         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 328
* EL130.cbl
 17095     ELSE IF DFHEIGDJ EQUAL 7
 17096         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17097         DEPENDING ON DFHEIGDI
 17098     ELSE IF DFHEIGDJ EQUAL 8
 17099         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17100         DEPENDING ON DFHEIGDI
 17101     ELSE IF DFHEIGDJ EQUAL 9
 17102         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17103         DEPENDING ON DFHEIGDI
 17104     ELSE IF DFHEIGDJ EQUAL 10
 17105         GO TO 2050-DELETE-NOT-FOUND
 17106         DEPENDING ON DFHEIGDI
 17107     ELSE IF DFHEIGDJ EQUAL 11
 17108         GO TO 2010-DELETE-CL
 17109         DEPENDING ON DFHEIGDI
 17110     ELSE IF DFHEIGDJ EQUAL 12
 17111         GO TO 3010-TEST-FOR-ERRORS
 17112         DEPENDING ON DFHEIGDI
 17113     ELSE IF DFHEIGDJ EQUAL 13
 17114         GO TO 3008-DUP-ERROR,
 17115               3009-NOT-FOUND
 17116         DEPENDING ON DFHEIGDI
 17117     ELSE IF DFHEIGDJ EQUAL 14
 17118         GO TO 3030-BUILD-CONT
 17119         DEPENDING ON DFHEIGDI
 17120     ELSE IF DFHEIGDJ EQUAL 15
 17121         GO TO 3033-ACCT-NOT-FOUND,
 17122               3033-ACCT-NOT-FOUND
 17123         DEPENDING ON DFHEIGDI
 17124     ELSE IF DFHEIGDJ EQUAL 16
 17125         GO TO 3032-NOT-IN-DT-RANGE
 17126         DEPENDING ON DFHEIGDI
 17127     ELSE IF DFHEIGDJ EQUAL 17
 17128         GO TO 3070-BUILD-CONT
 17129         DEPENDING ON DFHEIGDI
 17130     ELSE IF DFHEIGDJ EQUAL 18
 17131         GO TO 3065-CERT-NOT-FOUND
 17132         DEPENDING ON DFHEIGDI
 17133     ELSE IF DFHEIGDJ EQUAL 19
 17134         GO TO 3100-CARRIER-NOT-FOUND
 17135         DEPENDING ON DFHEIGDI
 17136     ELSE IF DFHEIGDJ EQUAL 20
 17137         GO TO 3110-COMPANY-NOT-FOUND
 17138         DEPENDING ON DFHEIGDI
 17139     ELSE IF DFHEIGDJ EQUAL 21
 17140         GO TO 3200-BUILD-ZERO-TRAILER
 17141         DEPENDING ON DFHEIGDI
 17142     ELSE IF DFHEIGDJ EQUAL 22
 17143         GO TO 9999-DFHBACK
 17144         DEPENDING ON DFHEIGDI
 17145     ELSE IF DFHEIGDJ EQUAL 23
 17146         GO TO 3290-NO-INSURED-ADDRESS
 17147         DEPENDING ON DFHEIGDI
 17148     ELSE IF DFHEIGDJ EQUAL 24
 17149         GO TO 3410-DUP-KEY
 17150         DEPENDING ON DFHEIGDI
 17151     ELSE IF DFHEIGDJ EQUAL 25
 17152         GO TO 3690-CERT-WRITTEN
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 329
* EL130.cbl
 17153         DEPENDING ON DFHEIGDI
 17154     ELSE IF DFHEIGDJ EQUAL 26
 17155         GO TO 3850-CLAIM-MSTR-WRITTEN
 17156         DEPENDING ON DFHEIGDI
 17157     ELSE IF DFHEIGDJ EQUAL 27
 17158         GO TO 3992-DUPREC
 17159         DEPENDING ON DFHEIGDI
 17160     ELSE IF DFHEIGDJ EQUAL 28
 17161         GO TO 5050-CERT-NOT-FOUND
 17162         DEPENDING ON DFHEIGDI
 17163     ELSE IF DFHEIGDJ EQUAL 29
 17164         GO TO 5030-CERT-WRITTEN
 17165         DEPENDING ON DFHEIGDI
 17166     ELSE IF DFHEIGDJ EQUAL 30
 17167         GO TO 5035-CLAIM-WRITTEN
 17168         DEPENDING ON DFHEIGDI
 17169     ELSE IF DFHEIGDJ EQUAL 31
 17170         GO TO 9990-ABEND,
 17171               5799-EXIT
 17172         DEPENDING ON DFHEIGDI
 17173     ELSE IF DFHEIGDJ EQUAL 32
 17174         GO TO 3100-CARRIER-NOT-FOUND
 17175         DEPENDING ON DFHEIGDI
 17176     ELSE IF DFHEIGDJ EQUAL 33
 17177         GO TO 6040-NO-PROCESSOR-RECORD
 17178         DEPENDING ON DFHEIGDI
 17179     ELSE IF DFHEIGDJ EQUAL 34
 17180         GO TO 6060-NO-BENEFICIARY-RECORD
 17181         DEPENDING ON DFHEIGDI
 17182     ELSE IF DFHEIGDJ EQUAL 35
 17183         GO TO 6499-EXIT,
 17184               6499-EXIT
 17185         DEPENDING ON DFHEIGDI
 17186     ELSE IF DFHEIGDJ EQUAL 36
 17187         GO TO 6600-NOT-FOUND
 17188         DEPENDING ON DFHEIGDI
 17189     ELSE IF DFHEIGDJ EQUAL 37
 17190         GO TO 6700-NOTOPEN-ERROR,
 17191               6700-EXIT
 17192         DEPENDING ON DFHEIGDI
 17193     ELSE IF DFHEIGDJ EQUAL 38
 17194         GO TO 7120-NOT-FOUND
 17195         DEPENDING ON DFHEIGDI
 17196     ELSE IF DFHEIGDJ EQUAL 39
 17197         GO TO 7499-EXIT
 17198         DEPENDING ON DFHEIGDI
 17199     ELSE IF DFHEIGDJ EQUAL 40
 17200         GO TO 7500-EXIT,
 17201               7500-DUPLICATE-KEY,
 17202               7500-EXIT
 17203         DEPENDING ON DFHEIGDI
 17204     ELSE IF DFHEIGDJ EQUAL 41
 17205         GO TO 7500-END-BROWSE
 17206         DEPENDING ON DFHEIGDI
 17207     ELSE IF DFHEIGDJ EQUAL 42
 17208         GO TO 7630-END-BROWSE
 17209         DEPENDING ON DFHEIGDI
 17210     ELSE IF DFHEIGDJ EQUAL 43
* Micro Focus Server Express         V5.1 revision 000 05-Jan-18 09:01 Page 330
* EL130.cbl
 17211         GO TO 7799-EXIT,
 17212               7799-EXIT
 17213         DEPENDING ON DFHEIGDI
 17214     ELSE IF DFHEIGDJ EQUAL 44
 17215         GO TO 7790-END-BROWSE
 17216         DEPENDING ON DFHEIGDI
 17217     ELSE IF DFHEIGDJ EQUAL 45
 17218         GO TO 7992-NOT-FOUND
 17219         DEPENDING ON DFHEIGDI
 17220     ELSE IF DFHEIGDJ EQUAL 46
 17221         GO TO 8300-SEND-TEXT
 17222         DEPENDING ON DFHEIGDI.
 17223     MOVE '9%                    "   ' TO DFHEIV0
 17224     MOVE 'EL130' TO DFHEIV1
 17225     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17226     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12816     Code:       54738
