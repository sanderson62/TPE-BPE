* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page   1
* EL691.cbl
* Options: int("EL691.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL691.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL691.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL691.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL691.
     4*
     5*AUTHOR.    LOGIC, INC.
     6*           DALLAS, TEXAS.
     7
     8*DATE-COMPILED.
     9
    10*REMARKS.
    11*        THIS PROGRAM PROVIDES THE FUNCTIONS TO BROWSE AND EDIT
    12*    THE DETAIL OF AN ARCHIVED LETTER.
    13
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page   2
* EL691.cbl
    14*    TRANS ID = EXN1
    15
    16******************************************************************
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24* 071111    2011022800001  AJRA  NAPERSOFT - NEW SCREEN
    25* 100312    2011022800001  AJRA  CHANGE RECEIVED MSG
    26* 121112    2012101700002  AJRA  ADD PF6 TO CERT NOTE, ENDT ARCH N
    27******************************************************************
    28
    29 DATA DIVISION.
    30 WORKING-STORAGE SECTION.
    31 01  DFH-START PIC X(04).
    32 77  FILLER  PIC X(32) VALUE '********************************'.
    33 77  FILLER  PIC X(32) VALUE '*    EL691 WORKING STORAGE     *'.
    34 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page   3
* EL691.cbl
    36
    37 01  W-WORK-AREAS.
    38     12  FILLER                  PIC  X(18)
    39                                      VALUE 'PROGRAM WORK AREA:'.
    40     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
    41     12  W-CALL-PGM              PIC  X(08).
    42     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
    43     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
    44     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
    45
    46     12  W-TIME-IN               PIC S9(07).
    47     12  FILLER REDEFINES W-TIME-IN.
    48         16  FILLER              PIC  X(01).
    49         16  W-TIME-OUT          PIC  9(02)V9(02).
    50         16  FILLER              PIC  X(02).
    51
    52     12  W-DEEDIT-FIELD          PIC  X(15).
    53     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
    54
    55     12  W-ERROR-COUNT           PIC S9(3)       VALUE ZERO.
    56     12  W-UPDATE-SW             PIC S9          VALUE ZERO.
    57     12  W-RESEND-DATE           PIC XX    VALUE LOW-VALUES.
    58     12  W-SENT-DATE             PIC XX    VALUE LOW-VALUES.
    59     12  W-FINAL-ACT-DATE        PIC XX    VALUE LOW-VALUES.
    60     12  W-RECEIVED-DATE         PIC XX    VALUE LOW-VALUES.
    61     12  W-STOP-LETTER-DATE      PIC XX    VALUE LOW-VALUES.
    62     12  W-RESPONSE              PIC S9(8)   COMP.
    63         88  RESP-NORMAL                  VALUE +00.
    64         88  RESP-NOTFND                  VALUE +13.
    65         88  RESP-DUPREC                  VALUE +14.
    66         88  RESP-DUPKEY                  VALUE +15.
    67         88  RESP-NOTOPEN                 VALUE +19.
    68         88  RESP-ENDFILE                 VALUE +20.
    69
    70     12  W-ARCH-SAVE-KEY         PIC  X(03).
    71     12  W-ARCH-KEY.
    72         16  W-ARCH-COMPANY-CD   PIC  X(01).
    73         16  W-ARCH-NUMBER       PIC S9(08)      COMP.
    74
    75     12  W-ARCT-KEY.
    76         16  W-ARCT-COMPANY-CD   PIC  X(01).
    77         16  W-ARCT-ARCHIVE-NO   PIC S9(08) COMP.
    78         16  W-ARCT-RECORD-TYPE  PIC  X(01).
    79             88  W-ARCT-COMMENT-DATA   VALUE '3'.
    80         16  W-ARCT-LINE-SEQ-NO  PIC S9(04) COMP.
    81
    82     12  W-CERT-NOTE-MSG.
    83         16  FILLER              PIC X(29)
    84             VALUE 'REQUESTED DOCUMENT RECEIVED  '.
    85         16  W-CERT-NOTE-RECV-DT PIC X(8).
    86
    87     12  ELCERT-FILE-ID          PIC  X(08)  VALUE 'ELCERT'.
    88     12  ERCNOT-FILE-ID          PIC  X(08)  VALUE 'ERCNOT'.
    89     12  ERCNOT-LENGTH           PIC S9(4)   COMP VALUE +150.
    90     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
    91     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
    92     12  ERCNOT-KEY.
    93         16  ERCNOT-PARTIAL-KEY.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page   4
* EL691.cbl
    94             20 ERCNOT-COMPANY-CD    PIC X.
    95             20 ERCNOT-CARRIER       PIC X.
    96             20 ERCNOT-GROUPING      PIC X(06).
    97             20 ERCNOT-STATE         PIC XX.
    98             20 ERCNOT-ACCOUNT       PIC X(10).
    99             20 ERCNOT-EFF-DT        PIC XX.
   100             20 ERCNOT-CERT-NO.
   101                25 ERCNOT-CERT-PRIME PIC X(10).
   102                25 ERCNOT-CERT-SFX   PIC X.
   103             20 ERCNOT-REC-TYP       PIC X.
   104         16 ERCNOT-SEQ           PIC S9(4) COMP.
   105     12  SV-PRIOR-KEY.
   106         16 SV-COMPANY-CD            PIC X.
   107         16 SV-CARRIER               PIC X.
   108         16 SV-GROUPING              PIC X(06).
   109         16 SV-STATE                 PIC XX.
   110         16 SV-ACCOUNT               PIC X(10).
   111         16 SV-EFF-DT                PIC XX.
   112         16 SV-CERT-NO.
   113            20 SV-CERT-PRIME         PIC X(10).
   114            20 SV-CERT-SFX           PIC X(1).
   115         16 SV-REC-TYP               PIC X.
   116         16  SV-NOTE-SEQUENCE        PIC S9(4) COMP.
   117     12  ELCERT-KEY.
   118         16  ELCERT-COMPANY-CD        PIC X.
   119         16  ELCERT-CARRIER           PIC X.
   120         16  ELCERT-GROUPING          PIC X(6).
   121         16  ELCERT-STATE             PIC XX.
   122         16  ELCERT-ACCOUNT           PIC X(10).
   123         16  ELCERT-EFF-DT            PIC XX.
   124         16  ELCERT-CERT-NO.
   125             20  ELCERT-CERT-PRIME    PIC X(10).
   126             20  ELCERT-CERT-SFX      PIC X.
   127
   128
   129 01  FILLER                      PIC  X(22)
   130                                 VALUE 'INTERFACE AREA STARTS:'.
   131*    COPY ELCINTF.
   132******************************************************************
   133*                                                                *
   134*                                                                *
   135*                            ELCINTF.                            *
   136*                            VMOD=2.017                          *
   137*                                                                *
   138*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   139*                                                                *
   140*       LENGTH = 1024                                            *
   141*                                                                *
   142******************************************************************
   143*                   C H A N G E   L O G
   144*
   145* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   146*-----------------------------------------------------------------
   147*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   148* EFFECTIVE    NUMBER
   149*-----------------------------------------------------------------
   150* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   151******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page   5
* EL691.cbl
   152 01  PROGRAM-INTERFACE-BLOCK.
   153     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   154     12  PI-CALLING-PROGRAM              PIC X(8).
   155     12  PI-SAVED-PROGRAM-1              PIC X(8).
   156     12  PI-SAVED-PROGRAM-2              PIC X(8).
   157     12  PI-SAVED-PROGRAM-3              PIC X(8).
   158     12  PI-SAVED-PROGRAM-4              PIC X(8).
   159     12  PI-SAVED-PROGRAM-5              PIC X(8).
   160     12  PI-SAVED-PROGRAM-6              PIC X(8).
   161     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   162     12  PI-COMPANY-ID                   PIC XXX.
   163     12  PI-COMPANY-CD                   PIC X.
   164
   165     12  PI-COMPANY-PASSWORD             PIC X(8).
   166
   167     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   168
   169     12  PI-CONTROL-IN-PROGRESS.
   170         16  PI-CARRIER                  PIC X.
   171         16  PI-GROUPING                 PIC X(6).
   172         16  PI-STATE                    PIC XX.
   173         16  PI-ACCOUNT                  PIC X(10).
   174         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   175                                         PIC X(10).
   176         16  PI-CLAIM-CERT-GRP.
   177             20  PI-CLAIM-NO             PIC X(7).
   178             20  PI-CERT-NO.
   179                 25  PI-CERT-PRIME       PIC X(10).
   180                 25  PI-CERT-SFX         PIC X.
   181             20  PI-CERT-EFF-DT          PIC XX.
   182         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   183             20  PI-PLAN-CODE            PIC X(2).
   184             20  PI-REVISION-NUMBER      PIC X(3).
   185             20  PI-PLAN-EFF-DT          PIC X(2).
   186             20  PI-PLAN-EXP-DT          PIC X(2).
   187             20  FILLER                  PIC X(11).
   188         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   189             20  PI-OE-REFERENCE-1.
   190                 25  PI-OE-REF-1-PRIME   PIC X(18).
   191                 25  PI-OE-REF-1-SUFF    PIC XX.
   192
   193     12  PI-SESSION-IN-PROGRESS          PIC X.
   194         88  CLAIM-SESSION                   VALUE '1'.
   195         88  CREDIT-SESSION                  VALUE '2'.
   196         88  WARRANTY-SESSION                VALUE '3'.
   197         88  MORTGAGE-SESSION                VALUE '4'.
   198         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   199
   200
   201*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   202
   203     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   204     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   205
   206     12  PI-CREDIT-USER                  PIC X.
   207         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   208         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   209
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page   6
* EL691.cbl
   210     12  PI-CLAIM-USER                   PIC X.
   211         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   212         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   213
   214     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   215         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   216         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   217         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   218         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   219         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   220
   221     12  PI-PROCESSOR-ID                 PIC X(4).
   222
   223     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   224
   225     12  PI-MEMBER-CAPTION               PIC X(10).
   226
   227     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   228         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   229
   230     12  PI-LIFE-OVERRIDE-L1             PIC X.
   231     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   232     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   233     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   234
   235     12  PI-AH-OVERRIDE-L1               PIC X.
   236     12  PI-AH-OVERRIDE-L2               PIC XX.
   237     12  PI-AH-OVERRIDE-L6               PIC X(6).
   238     12  PI-AH-OVERRIDE-L12              PIC X(12).
   239
   240     12  PI-NEW-SYSTEM                   PIC X(2).
   241
   242     12  PI-PRIMARY-CERT-NO              PIC X(11).
   243     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   244         88  PI-USES-PAID-TO                 VALUE '1'.
   245     12  PI-CRDTCRD-SYSTEM.
   246         16  PI-CRDTCRD-USER             PIC X.
   247             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   248             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   249         16  PI-CC-MONTH-END-DT          PIC XX.
   250     12  PI-PROCESSOR-PRINTER            PIC X(4).
   251
   252     12  PI-OE-REFERENCE-2.
   253         16  PI-OE-REF-2-PRIME           PIC X(10).
   254         16  PI-OE-REF-2-SUFF            PIC X.
   255
   256     12  PI-REM-TRM-CALC-OPTION          PIC X.
   257
   258     12  PI-LANGUAGE-TYPE                PIC X.
   259             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   260             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   261             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   262
   263     12  PI-POLICY-LINKAGE-IND           PIC X.
   264         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   265         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   266                                                   LOW-VALUES.
   267
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page   7
* EL691.cbl
   268     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   269     12  PI-CLAIM-PW-SESSION             PIC X(1).
   270         88  PI-CLAIM-CREDIT                 VALUE '1'.
   271         88  PI-CLAIM-CONVEN                 VALUE '2'.
   272
   273     12  PI-PROCESSOR-CSR-IND            PIC X.
   274         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   275         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   276
   277     12  FILLER                          PIC X(3).
   278
   279     12  PI-SYSTEM-LEVEL                 PIC X(145).
   280
   281     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   282         PI-SYSTEM-LEVEL.
   283
   284         16  PI-ENTRY-CODES.
   285             20  PI-ENTRY-CD-1           PIC X.
   286             20  PI-ENTRY-CD-2           PIC X.
   287
   288         16  PI-RETURN-CODES.
   289             20  PI-RETURN-CD-1          PIC X.
   290             20  PI-RETURN-CD-2          PIC X.
   291
   292         16  PI-UPDATE-STATUS-SAVE.
   293             20  PI-UPDATE-BY            PIC X(4).
   294             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   295
   296         16  PI-LOWER-CASE-LETTERS       PIC X.
   297             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   298
   299*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   300*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   301*            88  CARRIER-CLM-CNTL            VALUE '2'.
   302
   303         16  PI-CERT-ACCESS-CONTROL      PIC X.
   304             88  ST-ACCNT-CNTL               VALUE ' '.
   305             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   306             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   307             88  ACCNT-CNTL                  VALUE '3'.
   308             88  CARR-ACCNT-CNTL             VALUE '4'.
   309
   310         16  PI-PROCESSOR-CAP-LIST.
   311             20  PI-SYSTEM-CONTROLS.
   312                24 PI-SYSTEM-DISPLAY     PIC X.
   313                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   314                24 PI-SYSTEM-MODIFY      PIC X.
   315                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   316             20  FILLER                  PIC XX.
   317             20  PI-DISPLAY-CAP          PIC X.
   318                 88  DISPLAY-CAP             VALUE 'Y'.
   319             20  PI-MODIFY-CAP           PIC X.
   320                 88  MODIFY-CAP              VALUE 'Y'.
   321             20  PI-MSG-AT-LOGON-CAP     PIC X.
   322                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   323             20  PI-FORCE-CAP            PIC X.
   324                 88  FORCE-CAP               VALUE 'Y'.
   325
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page   8
* EL691.cbl
   326         16  PI-PROGRAM-CONTROLS.
   327             20  PI-PGM-PRINT-OPT        PIC X.
   328             20  PI-PGM-FORMAT-OPT       PIC X.
   329             20  PI-PGM-PROCESS-OPT      PIC X.
   330             20  PI-PGM-TOTALS-OPT       PIC X.
   331
   332         16  PI-HELP-INTERFACE.
   333             20  PI-LAST-ERROR-NO        PIC X(4).
   334             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   335
   336         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   337             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   338
   339         16  PI-CR-CONTROL-IN-PROGRESS.
   340             20  PI-CR-CARRIER           PIC X.
   341             20  PI-CR-GROUPING          PIC X(6).
   342             20  PI-CR-STATE             PIC XX.
   343             20  PI-CR-ACCOUNT           PIC X(10).
   344             20  PI-CR-FIN-RESP          PIC X(10).
   345             20  PI-CR-TYPE              PIC X.
   346
   347         16  PI-CR-BATCH-NUMBER          PIC X(6).
   348
   349         16  PI-CR-MONTH-END-DT          PIC XX.
   350
   351         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   352             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   353             88  PI-ZERO-CARRIER             VALUE '1'.
   354             88  PI-ZERO-GROUPING            VALUE '2'.
   355             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   356
   357         16  PI-CARRIER-SECURITY         PIC X.
   358             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   359
   360         16  PI-ACCOUNT-SECURITY         PIC X(10).
   361             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   362             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   363
   364         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   365             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   366                                         INDEXED BY PI-ACCESS-NDX
   367                                         PIC X.
   368
   369         16  PI-GA-BILLING-CONTROL       PIC X.
   370             88  PI-GA-BILLING               VALUE '1'.
   371
   372         16  PI-MAIL-PROCESSING          PIC X.
   373             88  PI-MAIL-YES                 VALUE 'Y'.
   374
   375         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   376
   377         16  PI-AR-SYSTEM.
   378             20  PI-AR-PROCESSING-CNTL   PIC X.
   379                 88  PI-AR-PROCESSING        VALUE 'Y'.
   380             20  PI-AR-SUMMARY-CODE      PIC X(6).
   381             20  PI-AR-MONTH-END-DT      PIC XX.
   382
   383         16  PI-MP-SYSTEM.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page   9
* EL691.cbl
   384             20  PI-MORTGAGE-USER            PIC X.
   385                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   386                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   387             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   388                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   389                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   390                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   391                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   392                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   393             20  PI-MP-MONTH-END-DT          PIC XX.
   394             20  PI-MP-REFERENCE-NO.
   395                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   396                 24  PI-MP-REFERENCE-SFX     PIC XX.
   397
   398         16  PI-LABEL-CONTROL            PIC X(01).
   399             88  PI-CREATE-LABELS                    VALUE 'Y'.
   400             88  PI-BYPASS-LABELS                    VALUE 'N'.
   401
   402         16  PI-BILL-GROUPING-CODE       PIC X(01).
   403             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   404
   405         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   406             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   407             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   408
   409         16  FILLER                      PIC X(14).
   410
   411     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   412******************************************************************
   413     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   414*    COPY ELC1042.
   415******************************************************************
   416*                                                                *
   417*                                                                *
   418*                           ELC1042                              *
   419*                            VMOD=2.002                          *
   420*                                                                *
   421*    NOTE                                                        *
   422*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   423*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   424*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   425*        TO THESE PROGRAMS.                                      *
   426*                                                                *
   427*    NOTE                                                        *
   428*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   429*        USE ONLY!                                               *
   430*                                                                *
   431******************************************************************
   432
   433         16  PI-1042-WA.
   434             20  PI-ACTION       PIC  X(01).
   435                 88 PI-SHOW-MODE           VALUE '1'.
   436                 88 PI-CLEAR-MODE          VALUE '2'.
   437                 88 PI-CREATE-MODE         VALUE '3'.
   438             20  PI-COMM-CONTROL PIC  X(12).
   439             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   440             20  PI-EOF-SW       PIC  X(01).
   441                 88  PI-FILE-EOF           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  10
* EL691.cbl
   442             20  PI-FILETYP      PIC  X(01).
   443             20  PI-FORM-SQUEEZE-CONTROL
   444                                 PIC  X(01).
   445                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   446                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   447             20  PI-LAST-CONTROL PIC  X(12).
   448             20  PI-TEMP-STOR-ITEMS
   449                                 PIC S9(04) COMP.
   450             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   451             20  PI-UPDATE-SW    PIC  9(01).
   452                 88 ANY-UPDATES            VALUE 1.
   453             20  PI-104-SCREEN-SENT-IND
   454                                 PIC  X(01).
   455                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   456                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   457             20  PI-1042-SCREEN-SENT-IND
   458                                 PIC  X(01).
   459                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   460                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
   461             20  PI-1042-ARCHIVE-IND
   462                                 PIC  X(01).
   463                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
   464             20  FILLER          PIC  X(29).
   465*    COPY ELC689PI.
   466******************************************************************
   467*                                                                *
   468*                            ELC689PI                            *
   469*                            VMOD=2.003                          *
   470*                                                                *
   471*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   472*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
   473*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   474*                                                                *
   475*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   476*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   477*    BETWEEN PROGRAMS.                                           *
   478*                                                                *
   479*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   480*                                                                *
   481*               EL631 - EL689  - EL6891 - EL6892                 *
   482*                                                                *
   483******************************************************************
   484*                   C H A N G E   L O G
   485*
   486* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   487*-----------------------------------------------------------------
   488*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   489* EFFECTIVE    NUMBER
   490*-----------------------------------------------------------------
   491* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
   492* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
   493* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
   494******************************************************************
   495
   496
   497         16  PI-689-WORK-AREA.
   498             20  PI-689-ALT-PRINTER-ID
   499                                 PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  11
* EL691.cbl
   500             20  PI-689-ARCHIVE-NUMBER
   501                                 PIC  9(08).
   502             20  PI-689-ARCHIVE-SW
   503                                 PIC  X(01).
   504                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
   505             20  PI-689-DATA-SOURCE
   506                                 PIC  X(01).
   507                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
   508                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
   509                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
   510                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
   511                 88  PI-689-SRC-CHECKS         VALUE '5'.
   512             20  PI-689-ERROR-IND
   513                                 PIC  X(01).
   514                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
   515             20  PI-689-ERROR    PIC  9(04).
   516                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
   517                 88  PI-689-FATAL-ERROR
   518                     VALUES 0004 0006 0008 0013 0023 0029 0033
   519                            0042 0047 0051 0066 0067 0070
   520                            0168 0169 0174 0175 0176 0177 0179
   521                            0180 0181 0182 0184 0185 0189 0190
   522                            0191
   523                            0215 0279 0280
   524                            0412 0413 0454
   525                            0533 0537
   526                            2055 2114 2208 2209 2216 2232 2369
   527                            2398 2433 2908 2999
   528                            3000 3770 3771 3775
   529                            7250 7365 7367 7368 7369 7370 7371
   530                            7272 7373 7374 7376 7377 7378 7379
   531                            7381 7388 7390 7393 7395 7396 7398
   532                            9095 9096 9281 9298 9299 9320 9327
   533                            9426 9427.
   534                 88  PI-689-STOP-ERROR
   535                     VALUES 0004 0008 0013 0023 0029 0033
   536                            0042 0047 0066 0067 0070
   537                            0168 0169 0174 0175 0176 0177
   538                            0181 0182 0184 0185 0189 0190
   539                            0279 0280
   540                            0412 0413 0454
   541                            2055 2208 2209 2216 2232
   542                            2398 2999
   543                            3000 3770 3771 3775
   544                            7250 7365 7369 7370 7371
   545                            7272 7373 7374 7376 7377 7378 7379
   546                            7381 7388 7390 7393 7396 7398
   547                            9095 9096 9299 9320 9426.
   548             20  PI-689-FOLLOW-UP-DATE
   549                                 PIC  X(02).
   550             20  PI-689-FORM-NUMBER
   551                                 PIC  X(04).
   552             20  PI-689-LABEL-SOURCE
   553                                 PIC X(01).
   554                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
   555                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
   556                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
   557                 88  PI-689-SOURCE-COMP     VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  12
* EL691.cbl
   558                 88  PI-689-SOURCE-MAIL     VALUE '5'.
   559                 88  PI-689-SOURCE-CHECK    VALUE '6'.
   560                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
   561             20  PI-689-NUMBER-COPIES
   562                                 PIC  9(01).
   563             20  PI-689-NUMBER-LABEL-LINES
   564                                 PIC  9(01).
   565             20  PI-689-NUMBER-TEXT-RECORDS
   566                                 PIC  9(03).
   567             20  PI-689-PRINT-ORDER-SW
   568                                 PIC  X(01).
   569                 88  PI-689-PRINT-FIRST     VALUE '1'.
   570                 88  PI-689-PRINT-SECOND    VALUE '2'.
   571                 88  PI-689-PRINT-LATER     VALUE '3'.
   572                 88  PI-689-PRINT-ONLY      VALUE '4'.
   573             20  PI-689-PRINT-RESTRICTION
   574                                 PIC  X(01).
   575                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
   576                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
   577                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
   578             20  PI-689-PRINT-SW PIC  X(01).
   579                 88  PI-689-PRINT-PERFORMED VALUE '1'.
   580             20  PI-689-RESEND-DATE-1
   581                                 PIC  X(02).
   582             20  PI-689-RESEND-LETR-1
   583                                 PIC X(4).
   584             20  PI-689-TEMP-STOR-ID
   585                                 PIC  X(08).
   586             20  PI-689-USE-SCREEN-IND
   587                                 PIC  X(01).
   588                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
   589             20  PI-689-ARCH-POINTER
   590                                 PIC S9(08) COMP.
   591                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
   592             20  PI-689-ARCT-POINTER
   593                                 PIC S9(08) COMP.
   594                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
   595             20  PI-689-VARIABLE-DATA-GRP.
   596                 24  PI-689-VARIABLE-DATA-1
   597                                 PIC  X(30).
   598                 24  PI-689-VARIABLE-DATA-2
   599                                 PIC  X(30).
   600                 24  PI-689-VARIABLE-DATA-3
   601                                 PIC  X(30).
   602                 24  PI-689-VARIABLE-DATA-4
   603                                 PIC  X(30).
   604
   605         16  PI-689-KEY-DATA-FIELDS.
   606             20  PI-689-ACCOUNT  PIC  X(10).
   607             20  PI-689-CARRIER  PIC  X(01).
   608             20  PI-689-CERT-NO.
   609                 24  PI-689-CERT-PRIME
   610                                 PIC  X(10).
   611                 24  PI-689-CERT-SFX
   612                                 PIC  X(01).
   613             20  PI-689-CHG-SEQ-NO
   614                                 PIC S9(04)    COMP.
   615             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  13
* EL691.cbl
   616                                 PIC  X(02).
   617             20  PI-689-ENTRY-BATCH
   618                                 PIC  X(06).
   619             20  PI-689-EFF-DATE PIC  X(02).
   620             20  PI-689-EXP-DATE PIC  X(02).
   621             20  PI-689-GROUPING PIC  X(06).
   622             20  PI-689-RESP-PERSON
   623                                 PIC  X(10).
   624             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
   625             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
   626                                 PIC  X(04).
   627             20  PI-689-STATE    PIC  X(02).
   628             20  PI-689-TYPE     PIC  X(01).
   629             20  PI-689-CONTROL  PIC S9(08)    COMP.
   630             20  PI-689-ALT-SEQ-NO
   631                                 PIC S9(04)    COMP.
   632         16  PI-689-DATE-EDIT    PIC  X(08).
   633         16  PI-689-FOLLOW-UP-EDIT
   634                                 PIC  X(08).
   635         16  PI-689-RESEND1-EDIT PIC  X(08).
   636         16  PI-689-SEQ-EDIT     PIC  X(08).
   637         16  PI-689-BCSEQ-EDIT   PIC  X(04).
   638         16  PI-689-LBL-OVERRIDE PIC  X(01).
   639             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
   640         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
   641         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
   642         16  PI-690-WORK-AREA.
   643             20  PI-690-ARCHIVE-TABLE.
   644                 24  PI-690-ARCHIVE-NUM OCCURS 12 TIMES
   645                                 PIC S9(08) COMP.
   646             20  PI-690-CURSOR   PIC S9(04) COMP.
   647             20  PI-690-FIRST-DATA.
   648                 24  PI-690-FIRST-CERT-NO.
   649                     28  PI-690-FIRST-CERT-PRIME
   650                                 PIC  X(10).
   651                     28  PI-690-FIRST-SUFFIX
   652                                 PIC  X(01).
   653                 24  PI-690-FIRST-CARRIER
   654                                 PIC  X(01).
   655                 24  PI-690-FIRST-GROUPING
   656                                 PIC  X(06).
   657                 24  PI-690-FIRST-STATE
   658                                 PIC  X(02).
   659                 24  PI-690-FIRST-ACCOUNT
   660                                 PIC  X(10).
   661                 24  PI-690-FIRST-EFFECT-DATE
   662                                 PIC  X(02).
   663                 24  PI-690-FIRST-ENTRY.
   664                     28  PI-690-FIRST-CONTROL-PREFIX
   665                                 PIC  X(02).
   666                     28  PI-690-FIRST-CONTROL
   667                                 PIC S9(08) COMP.
   668                 24  PI-690-FIRST-FORM
   669                                 PIC  X(04).
   670                 24  PI-690-FIRST-PROCESSOR
   671                                 PIC  X(04).
   672                 24  PI-690-FIRST-ARCHIVE-NO
   673                                 PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  14
* EL691.cbl
   674             20  PI-690-INIT-DATA.
   675                 24  PI-690-INIT-CERT-NO.
   676                     28  PI-690-INIT-CERT-PRIME
   677                                 PIC  X(10).
   678                     28  PI-690-INIT-SUFFIX
   679                                 PIC  X(01).
   680                 24  PI-690-INIT-CARRIER
   681                                 PIC  X(01).
   682                 24  PI-690-INIT-GROUPING
   683                                 PIC  X(06).
   684                 24  PI-690-INIT-STATE
   685                                 PIC  X(02).
   686                 24  PI-690-INIT-ACCOUNT
   687                                 PIC  X(10).
   688                 24  PI-690-INIT-EFFECT-DATE
   689                                 PIC  X(02).
   690                 24  PI-690-INIT-EFF-DTE
   691                                 PIC  X(08).
   692                 24  PI-690-INIT-ENTRY.
   693                     28  PI-690-INIT-CONTROL-PREFIX
   694                                 PIC  X(02).
   695                     28  PI-690-INIT-CONTROL
   696                                 PIC S9(08) COMP.
   697                 24  PI-690-INIT-FORM
   698                                 PIC  X(04).
   699                 24  PI-690-INIT-PROCESSOR
   700                                 PIC  X(04).
   701                 24  PI-690-INIT-ARCHIVE-NO
   702                                 PIC S9(08) COMP.
   703             20  PI-690-LAST-DATA.
   704                 24  PI-690-LAST-CERT-NO.
   705                     28  PI-690-LAST-CERT-PRIME
   706                                 PIC  X(10).
   707                     28  PI-690-LAST-SUFFIX
   708                                 PIC  X(01).
   709                 24  PI-690-LAST-CARRIER
   710                                 PIC  X(01).
   711                 24  PI-690-LAST-GROUPING
   712                                 PIC  X(06).
   713                 24  PI-690-LAST-STATE
   714                                 PIC  X(02).
   715                 24  PI-690-LAST-ACCOUNT
   716                                 PIC  X(10).
   717                 24  PI-690-LAST-EFFECT-DATE
   718                                 PIC  X(02).
   719                 24  PI-690-LAST-ENTRY.
   720                     28  PI-690-LAST-CONTROL-PREFIX
   721                                 PIC  X(02).
   722                     28  PI-690-LAST-CONTROL
   723                                 PIC S9(08) COMP.
   724                 24  PI-690-LAST-FORM
   725                                 PIC  X(04).
   726                 24  PI-690-LAST-PROCESSOR
   727                                 PIC  X(04).
   728                 24  PI-690-LAST-ARCHIVE-NO
   729                                 PIC S9(08) COMP.
   730             20  PI-690-LAST-ARCH-NDX
   731                                 PIC S9(04) COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  15
* EL691.cbl
   732             20  PI-690-BRWS-TYPE-IND
   733                                 PIC  9(01).
   734                 88  PI-690-BRWS-CERTRP               VALUE 1.
   735                 88  PI-690-BRWS-FORM                 VALUE 2.
   736                 88  PI-690-BRWS-PROCESSOR            VALUE 3.
   737                 88  PI-690-BRWS-ACCOUNT              VALUE 4.
   738                 88  PI-690-BRWS-ENTRY-CNTL           VALUE 5.
   739                 88  PI-690-BRWS-ARCHIVE              VALUE 6.
   740             20  PI-690-LAST-BROWSE-IND
   741                                 PIC  X(01).
   742                 88  PI-690-LAST-BRWS-FWRD            VALUE '1'.
   743                 88  PI-690-LAST-BRWS-BWRD            VALUE '2'.
   744             20  PI-690-STATUS-SELECTION-IND
   745                                 PIC  X(01).
   746                 88  PI-690-SELECT-ALL       VALUE 'N'.
   747                 88  PI-690-VALID-SELECTION  VALUE 'A' 'C' 'H'
   748                                               'X' 'P' 'V' 'N'.
   749         16  PI-ARCHIVE-COMPLETE    PIC X(01).
   750         16  PI-ARCHIVE-RECEIVED    PIC X(01).
   751         16  PI-ARCHIVE-STOPPED     PIC X(01).
   752         16  PI-ARCHIVE-FINAL       PIC X(01).
   753         16  PI-COMMENT-INDEX       PIC S9(4) COMP.
   754         16  FILLER              PIC X(63).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  16
* EL691.cbl
   756
   757 01  W-CONSTANT-AREA.
   758     12  FILLER                  PIC  X(18)
   759                                 VALUE 'PROGRAM CONSTANTS:'.
   760     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
   761
   762     12  W-ARCH-FILE-ID          PIC  X(08)  VALUE 'ERARCH'.
   763     12  W-ARCT-FILE-ID          PIC  X(08)  VALUE 'ERARCT'.
   764     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
   765     12  W-LINK-001              PIC  X(08)  VALUE 'EL001'.
   766     12  W-LINK-004              PIC  X(08)  VALUE 'EL004'.
   767     12  W-MAP                   PIC  X(08)  VALUE 'EL691A'.
   768     12  W-MAP-REDEFINE  REDEFINES   W-MAP.
   769         16  FILLER              PIC  X(02).
   770         16  W-MAP-NUM           PIC  X(06).
   771     12  W-MAPSET                PIC  X(08)  VALUE 'EL691S'.
   772     12  W-THIS-PGM              PIC  X(08)  VALUE 'EL691'.
   773     12  W-TRANSACTION           PIC  X(04)  VALUE 'EXN1'.
   774     12  W-XCTL-005              PIC  X(08)  VALUE 'EL005'.
   775     12  W-XCTL-626              PIC  X(08)  VALUE 'EL626'.
   776     12  W-XCTL-1279             PIC  X(08)  VALUE 'EL1279'.
   777     12  SLASH                   PIC X       VALUE '/'.
   778     12  W-ZEROS                 PIC  S9(03) VALUE +0 COMP-3.
   779     12  W-ADD-ARCT              PIC  X      VALUE 'N'.
   780     12  W-DONE-ADDING           PIC  X      VALUE 'N'.
   781     12  W-NEED-COMMENT          PIC  X      VALUE 'N'.
   782
   783 01  ERROR-MESSAGES.
   784     12  ER-0000                 PIC  X(04) VALUE '0000'.
   785     12  ER-0004                 PIC  X(04) VALUE '0004'.
   786     12  ER-0029                 PIC  X(04) VALUE '0029'.
   787     12  ER-0051                 PIC  X(04) VALUE '0051'.
   788     12  ER-0070                 PIC  X(04) VALUE '0070'.
   789     12  ER-0295                 PIC  X(04) VALUE '0295'.
   790     12  ER-0296                 PIC  X(04) VALUE '0296'.
   791     12  ER-0539                 PIC  X(04) VALUE '0539'.
   792     12  ER-0895                 PIC  X(04) VALUE '0895'.
   793     12  ER-0897                 PIC  X(04) VALUE '0897'.
   794     12  ER-3112                 PIC  X(04) VALUE '3112'.
   795     12  ER-7008                 PIC  X(04) VALUE '7008'.
   796     12  ER-7363                 PIC  X(04) VALUE '7363'.
   797     12  ER-7371                 PIC  X(04) VALUE '7371'.
   798     12  ER-7373                 PIC  X(04) VALUE '7373'.
   799     12  ER-7388                 PIC  X(04) VALUE '7388'.
   800     12  ER-9097                 PIC  X(04) VALUE '9097'.
   801     12  ER-9245                 PIC  X(04) VALUE '9245'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  17
* EL691.cbl
   803*    COPY ELCAID.
   804******************************************************************
   805*                                                                *
   806*                            ELCAID.                             *
   807*                            VMOD=2.001                          *
   808*                                                                *
   809*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   810*                                                                *
   811*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   812*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   813******************************************************************
   814
   815 01  DFHAID.
   816   02  DFHNULL   PIC  X  VALUE  ' '.
   817   02  DFHENTER  PIC  X  VALUE  QUOTE.
   818   02  DFHCLEAR  PIC  X  VALUE  '_'.
   819   02  DFHPEN    PIC  X  VALUE  '='.
   820   02  DFHOPID   PIC  X  VALUE  'W'.
   821   02  DFHPA1    PIC  X  VALUE  '%'.
   822   02  DFHPA2    PIC  X  VALUE  '>'.
   823   02  DFHPA3    PIC  X  VALUE  ','.
   824   02  DFHPF1    PIC  X  VALUE  '1'.
   825   02  DFHPF2    PIC  X  VALUE  '2'.
   826   02  DFHPF3    PIC  X  VALUE  '3'.
   827   02  DFHPF4    PIC  X  VALUE  '4'.
   828   02  DFHPF5    PIC  X  VALUE  '5'.
   829   02  DFHPF6    PIC  X  VALUE  '6'.
   830   02  DFHPF7    PIC  X  VALUE  '7'.
   831   02  DFHPF8    PIC  X  VALUE  '8'.
   832   02  DFHPF9    PIC  X  VALUE  '9'.
   833   02  DFHPF10   PIC  X  VALUE  ':'.
   834   02  DFHPF11   PIC  X  VALUE  '#'.
   835   02  DFHPF12   PIC  X  VALUE  '@'.
   836   02  DFHPF13   PIC  X  VALUE  'A'.
   837   02  DFHPF14   PIC  X  VALUE  'B'.
   838   02  DFHPF15   PIC  X  VALUE  'C'.
   839   02  DFHPF16   PIC  X  VALUE  'D'.
   840   02  DFHPF17   PIC  X  VALUE  'E'.
   841   02  DFHPF18   PIC  X  VALUE  'F'.
   842   02  DFHPF19   PIC  X  VALUE  'G'.
   843   02  DFHPF20   PIC  X  VALUE  'H'.
   844   02  DFHPF21   PIC  X  VALUE  'I'.
   845*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   846   02  DFHPF22   PIC  X  VALUE  '['.
   847   02  DFHPF23   PIC  X  VALUE  '.'.
   848   02  DFHPF24   PIC  X  VALUE  '<'.
   849   02  DFHMSRE   PIC  X  VALUE  'X'.
   850   02  DFHSTRF   PIC  X  VALUE  'h'.
   851   02  DFHTRIG   PIC  X  VALUE  '"'.
   852 01  FILLER    REDEFINES DFHAID.
   853     12  FILLER                  PIC  X(08).
   854     12  PF-VALUES               PIC  X(01) OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  18
* EL691.cbl
   856*    COPY ELCATTR.
   857******************************************************************
   858*                                                                *
   859*                            ELCATTR.                            *
   860*                            VMOD=2.001                          *
   861*                                                                *
   862*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   863*                                                                *
   864*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   865*                                                                *
   866*                   POS 1   P=PROTECTED                          *
   867*                           U=UNPROTECTED                        *
   868*                           S=ASKIP                              *
   869*                   POS 2   A=ALPHA/NUMERIC                      *
   870*                           N=NUMERIC                            *
   871*                   POS 3   N=NORMAL                             *
   872*                           B=BRIGHT                             *
   873*                           D=DARK                               *
   874*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   875*                           OF=MODIFIED DATA TAG OFF             *
   876*                                                                *
   877*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   878******************************************************************
   879 01  ATTRIBUTE-LIST.
   880     12  AL-PABOF            PIC X       VALUE 'Y'.
   881     12  AL-PABON            PIC X       VALUE 'Z'.
   882     12  AL-PADOF            PIC X       VALUE '%'.
   883     12  AL-PADON            PIC X       VALUE '_'.
   884     12  AL-PANOF            PIC X       VALUE '-'.
   885     12  AL-PANON            PIC X       VALUE '/'.
   886     12  AL-SABOF            PIC X       VALUE '8'.
   887     12  AL-SABON            PIC X       VALUE '9'.
   888     12  AL-SADOF            PIC X       VALUE '@'.
   889     12  AL-SADON            PIC X       VALUE QUOTE.
   890     12  AL-SANOF            PIC X       VALUE '0'.
   891     12  AL-SANON            PIC X       VALUE '1'.
   892     12  AL-UABOF            PIC X       VALUE 'H'.
   893     12  AL-UABON            PIC X       VALUE 'I'.
   894     12  AL-UADOF            PIC X       VALUE '<'.
   895     12  AL-UADON            PIC X       VALUE '('.
   896     12  AL-UANOF            PIC X       VALUE ' '.
   897     12  AL-UANON            PIC X       VALUE 'A'.
   898     12  AL-UNBOF            PIC X       VALUE 'Q'.
   899     12  AL-UNBON            PIC X       VALUE 'R'.
   900     12  AL-UNDOF            PIC X       VALUE '*'.
   901     12  AL-UNDON            PIC X       VALUE ')'.
   902     12  AL-UNNOF            PIC X       VALUE '&'.
   903     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  19
* EL691.cbl
   905*    COPY ELCDATE.
   906******************************************************************
   907*                                                                *
   908*                                                                *
   909*                            ELCDATE.                            *
   910*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   911*                            VMOD=2.003
   912*                                                                *
   913*                                                                *
   914*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   915*                 LENGTH = 200                                   *
   916******************************************************************
   917
   918 01  DATE-CONVERSION-DATA.
   919     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   920     12  DC-OPTION-CODE                PIC X.
   921         88  BIN-TO-GREG                VALUE ' '.
   922         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   923         88  EDIT-GREG-TO-BIN           VALUE '2'.
   924         88  YMD-GREG-TO-BIN            VALUE '3'.
   925         88  MDY-GREG-TO-BIN            VALUE '4'.
   926         88  JULIAN-TO-BIN              VALUE '5'.
   927         88  BIN-PLUS-ELAPSED           VALUE '6'.
   928         88  FIND-CENTURY               VALUE '7'.
   929         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   930         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   931         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   932         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   933         88  JULIAN-TO-BIN-3            VALUE 'C'.
   934         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   935         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   936         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   937         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   938         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   939         88  CHECK-LEAP-YEAR            VALUE 'H'.
   940         88  BIN-3-TO-GREG              VALUE 'I'.
   941         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   942         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   943         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   944         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   945         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   946         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   947         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   948         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   949         88  THREE-CHARACTER-BIN
   950                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   951         88  GREGORIAN-TO-BIN
   952                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   953         88  BIN-TO-GREGORIAN
   954                  VALUES ' ' '1' 'I' '8' 'G'.
   955         88  JULIAN-TO-BINARY
   956                  VALUES '5' 'C' 'E' 'F'.
   957     12  DC-ERROR-CODE                 PIC X.
   958         88  NO-CONVERSION-ERROR        VALUE ' '.
   959         88  DATE-CONVERSION-ERROR
   960                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   961         88  DATE-IS-ZERO               VALUE '1'.
   962         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  20
* EL691.cbl
   963         88  DATE-IS-INVALID            VALUE '3'.
   964         88  DATE1-GREATER-DATE2        VALUE '4'.
   965         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   966         88  DATE-INVALID-OPTION        VALUE '9'.
   967         88  INVALID-CENTURY            VALUE 'A'.
   968         88  ONLY-CENTURY               VALUE 'B'.
   969         88  ONLY-LEAP-YEAR             VALUE 'C'.
   970         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   971     12  DC-END-OF-MONTH               PIC X.
   972         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   973     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   974         88  USE-NORMAL-PROCESS         VALUE ' '.
   975         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   976         88  ADJUST-UP-100-YRS          VALUE '2'.
   977     12  FILLER                        PIC X.
   978     12  DC-CONVERSION-DATES.
   979         16  DC-BIN-DATE-1             PIC XX.
   980         16  DC-BIN-DATE-2             PIC XX.
   981         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   982         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   983                       DC-GREG-DATE-1-EDIT.
   984             20  DC-EDIT1-MONTH        PIC 99.
   985             20  SLASH1-1              PIC X.
   986             20  DC-EDIT1-DAY          PIC 99.
   987             20  SLASH1-2              PIC X.
   988             20  DC-EDIT1-YEAR         PIC 99.
   989         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   990         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   991                     DC-GREG-DATE-2-EDIT.
   992             20  DC-EDIT2-MONTH        PIC 99.
   993             20  SLASH2-1              PIC X.
   994             20  DC-EDIT2-DAY          PIC 99.
   995             20  SLASH2-2              PIC X.
   996             20  DC-EDIT2-YEAR         PIC 99.
   997         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   998         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   999                     DC-GREG-DATE-1-YMD.
  1000             20  DC-YMD-YEAR           PIC 99.
  1001             20  DC-YMD-MONTH          PIC 99.
  1002             20  DC-YMD-DAY            PIC 99.
  1003         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1004         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1005                      DC-GREG-DATE-1-MDY.
  1006             20  DC-MDY-MONTH          PIC 99.
  1007             20  DC-MDY-DAY            PIC 99.
  1008             20  DC-MDY-YEAR           PIC 99.
  1009         16  DC-GREG-DATE-1-ALPHA.
  1010             20  DC-ALPHA-MONTH        PIC X(10).
  1011             20  DC-ALPHA-DAY          PIC 99.
  1012             20  FILLER                PIC XX.
  1013             20  DC-ALPHA-CENTURY.
  1014                 24 DC-ALPHA-CEN-N     PIC 99.
  1015             20  DC-ALPHA-YEAR         PIC 99.
  1016         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1017         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1018         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1019         16  DC-JULIAN-DATE            PIC 9(05).
  1020         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  21
* EL691.cbl
  1021                                       PIC 9(05).
  1022         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1023             20  DC-JULIAN-YEAR        PIC 99.
  1024             20  DC-JULIAN-DAYS        PIC 999.
  1025         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1026         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1027         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1028     12  DATE-CONVERSION-VARIBLES.
  1029         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1030         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1031             20  FILLER                PIC 9(3).
  1032             20  HOLD-CEN-1-CCYY.
  1033                 24  HOLD-CEN-1-CC     PIC 99.
  1034                 24  HOLD-CEN-1-YY     PIC 99.
  1035             20  HOLD-CEN-1-MO         PIC 99.
  1036             20  HOLD-CEN-1-DA         PIC 99.
  1037         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1038             20  HOLD-CEN-1-R-MO       PIC 99.
  1039             20  HOLD-CEN-1-R-DA       PIC 99.
  1040             20  HOLD-CEN-1-R-CCYY.
  1041                 24  HOLD-CEN-1-R-CC   PIC 99.
  1042                 24  HOLD-CEN-1-R-YY   PIC 99.
  1043             20  FILLER                PIC 9(3).
  1044         16  HOLD-CENTURY-1-X.
  1045             20  FILLER                PIC X(3)  VALUE SPACES.
  1046             20  HOLD-CEN-1-X-CCYY.
  1047                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1048                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1049             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1050             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1051         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1052             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1053             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1054             20  HOLD-CEN-1-R-X-CCYY.
  1055                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1056                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1057             20  FILLER                PIC XXX.
  1058         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1059         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1060         16  DC-JULIAN-DATE-1          PIC 9(07).
  1061         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1062             20  DC-JULIAN-1-CCYY.
  1063                 24  DC-JULIAN-1-CC    PIC 99.
  1064                 24  DC-JULIAN-1-YR    PIC 99.
  1065             20  DC-JULIAN-DA-1        PIC 999.
  1066         16  DC-JULIAN-DATE-2          PIC 9(07).
  1067         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1068             20  DC-JULIAN-2-CCYY.
  1069                 24  DC-JULIAN-2-CC    PIC 99.
  1070                 24  DC-JULIAN-2-YR    PIC 99.
  1071             20  DC-JULIAN-DA-2        PIC 999.
  1072         16  DC-GREG-DATE-A-EDIT.
  1073             20  DC-EDITA-MONTH        PIC 99.
  1074             20  SLASHA-1              PIC X VALUE '/'.
  1075             20  DC-EDITA-DAY          PIC 99.
  1076             20  SLASHA-2              PIC X VALUE '/'.
  1077             20  DC-EDITA-CCYY.
  1078                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  22
* EL691.cbl
  1079                 24  DC-EDITA-YEAR     PIC 99.
  1080         16  DC-GREG-DATE-B-EDIT.
  1081             20  DC-EDITB-MONTH        PIC 99.
  1082             20  SLASHB-1              PIC X VALUE '/'.
  1083             20  DC-EDITB-DAY          PIC 99.
  1084             20  SLASHB-2              PIC X VALUE '/'.
  1085             20  DC-EDITB-CCYY.
  1086                 24  DC-EDITB-CENT     PIC 99.
  1087                 24  DC-EDITB-YEAR     PIC 99.
  1088         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1089         16  DC-GREG-DATE-CYMD-R REDEFINES
  1090                              DC-GREG-DATE-CYMD.
  1091             20  DC-CYMD-CEN           PIC 99.
  1092             20  DC-CYMD-YEAR          PIC 99.
  1093             20  DC-CYMD-MONTH         PIC 99.
  1094             20  DC-CYMD-DAY           PIC 99.
  1095         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1096         16  DC-GREG-DATE-MDCY-R REDEFINES
  1097                              DC-GREG-DATE-MDCY.
  1098             20  DC-MDCY-MONTH         PIC 99.
  1099             20  DC-MDCY-DAY           PIC 99.
  1100             20  DC-MDCY-CEN           PIC 99.
  1101             20  DC-MDCY-YEAR          PIC 99.
  1102    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1103        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1104    12  DC-EL310-DATE                  PIC X(21).
  1105    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  23
* EL691.cbl
  1107*    COPY ELCNWA.
  1108*****************************************************************
  1109*                                                               *
  1110*                                                               *
  1111*                            ELCNWA.                            *
  1112*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1113*                            VMOD=2.003                         *
  1114*                                                               *
  1115*            M O V E   N A M E   W O R K   A R E A.             *
  1116*                                                               *
  1117*****************************************************************.
  1118
  1119 01  WS-NAME-WORK-AREA.
  1120     05  WS-INSURED-LAST-NAME        PIC X(15).
  1121     05  WS-INSURED-1ST-NAME         PIC X(12).
  1122     05  WS-INSURED-MID-INIT         PIC X.
  1123
  1124     05  WS-NAME-WORK.
  1125         10  WS-NW                   PIC X
  1126             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  1127
  1128     05  WS-NAME-WORK2.
  1129         10  WS-NW2                  PIC X
  1130             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  1131                                        NWA-INDEX0.
  1132
  1133     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  1134                                     COMP-3.
  1135
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  24
* EL691.cbl
  1137*    COPY ELCEMIB.
  1138******************************************************************
  1139*                                                                *
  1140*                                                                *
  1141*                            ELCEMIB.                            *
  1142*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1143*                            VMOD=2.005                          *
  1144*                                                                *
  1145*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1146*                                                                *
  1147******************************************************************
  1148 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1149     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1150     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1151     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1152     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1153     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1154     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1155     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1156     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1157     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1158         88  EMI-NO-ERRORS                    VALUE '1'.
  1159         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1160         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1161     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1162         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1163     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1164         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1165         88  EMI-AREA1-FULL                   VALUE '2'.
  1166     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1167         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1168         88  EMI-AREA2-FULL                   VALUE '2'.
  1169     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1170         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1171         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1172         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1173         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1174         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1175     12  EMI-ERROR-LINES.
  1176         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1177         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1178         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1179         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1180             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1181                 24  EMI-ERR-NUM         PIC X(4).
  1182                 24  EMI-FILLER          PIC X.
  1183                 24  EMI-SEV             PIC X.
  1184                 24  FILLER              PIC X.
  1185             20  FILLER                  PIC X(02).
  1186     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1187         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1188             20  EMI-ERROR-NUMBER    PIC X(4).
  1189             20  EMI-FILL            PIC X.
  1190             20  EMI-SEVERITY        PIC X.
  1191             20  FILLER              PIC X.
  1192             20  EMI-ERROR-TEXT.
  1193                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1194                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  25
* EL691.cbl
  1195     12  EMI-SEVERITY-SAVE           PIC X.
  1196         88  EMI-NOTE                    VALUE 'N'.
  1197         88  EMI-WARNING                 VALUE 'W'.
  1198         88  EMI-FORCABLE                VALUE 'F'.
  1199         88  EMI-FATAL                   VALUE 'X'.
  1200     12  EMI-MESSAGE-FLAG            PIC X.
  1201         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1202         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1203     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1204     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1205         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1206         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1207         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1208     12  FILLER                      PIC X(137)  VALUE SPACES.
  1209     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1210     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1211     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1212     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1213 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  26
* EL691.cbl
  1215*    COPY ELCLOGOF.
  1216******************************************************************
  1217*                                                                *
  1218*                                                                *
  1219*                            ELCLOGOF.                           *
  1220*                            VMOD=2.001                          *
  1221*                                                                *
  1222*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1223*                                                                *
  1224******************************************************************
  1225 01  CLASIC-LOGOFF.
  1226     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1227     12  LOGOFF-TEXT.
  1228         16  FILLER          PIC X(5)    VALUE SPACES.
  1229         16  LOGOFF-MSG.
  1230             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1231             20  FILLER      PIC X       VALUE SPACES.
  1232             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1233         16  FILLER          PIC X(80)
  1234           VALUE '* YOU ARE NOW LOGGED OFF'.
  1235         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1236         16  FILLER          PIC X       VALUE QUOTE.
  1237         16  LOGOFF-SYS-MSG  PIC X(17)
  1238           VALUE 'S CLAS-IC SYSTEM '.
  1239     12  TEXT-MESSAGES.
  1240         16  UNACCESS-MSG    PIC X(29)
  1241             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1242         16  PGMIDERR-MSG    PIC X(17)
  1243             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  27
* EL691.cbl
  1245*    COPY ELCSCTM.
  1246******************************************************************
  1247*                                                                *
  1248*                                                                *
  1249*                            ELCSCTM                             *
  1250*                            VMOD=2.001                          *
  1251*                                                                *
  1252*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  1253*                                                                *
  1254******************************************************************
  1255 01  SECURITY-MESSAGE.
  1256     12  FILLER                          PIC X(30)
  1257            VALUE '** LOGIC SECURITY VIOLATION -'.
  1258     12  SM-READ                         PIC X(6).
  1259     12  FILLER                          PIC X(5)
  1260            VALUE ' PGM='.
  1261     12  SM-PGM                          PIC X(6).
  1262     12  FILLER                          PIC X(5)
  1263            VALUE ' OPR='.
  1264     12  SM-PROCESSOR-ID                 PIC X(4).
  1265     12  FILLER                          PIC X(6)
  1266            VALUE ' TERM='.
  1267     12  SM-TERMID                       PIC X(4).
  1268     12  FILLER                          PIC XX   VALUE SPACE.
  1269     12  SM-JUL-DATE                     PIC 9(5).
  1270     12  FILLER                          PIC X    VALUE SPACE.
  1271     12  SM-TIME                         PIC 99.99.
  1272
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  28
* EL691.cbl
  1274*    COPY ELCSCRTY.
  1275******************************************************************
  1276*                                                                *
  1277*                                                                *
  1278*                            ELCSCRTY                            *
  1279*                            VMOD=2.001                          *
  1280*                                                                *
  1281*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  1282*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  1283*        SAVED IN PI-SECURITY-ADDRESS.                           *
  1284*                                                                *
  1285******************************************************************
  1286 01  SECURITY-CONTROL.
  1287     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  1288     12  FILLER                       PIC XX    VALUE 'SC'.
  1289     12  SC-CREDIT-CODES.
  1290         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  1291             20  SC-CREDIT-DISPLAY    PIC X.
  1292             20  SC-CREDIT-UPDATE     PIC X.
  1293     12  SC-CLAIMS-CODES.
  1294         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  1295             20  SC-CLAIMS-DISPLAY    PIC X.
  1296             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  29
* EL691.cbl
  1298
  1299*    COPY EL691S.
  1300 01  EL691AI.
  1301     05  FILLER            PIC  X(0012).
  1302*    -------------------------------
  1303     05  RUNDTEL PIC S9(0004) COMP.
  1304     05  RUNDTEF PIC  X(0001).
  1305     05  FILLER REDEFINES RUNDTEF.
  1306         10  RUNDTEA PIC  X(0001).
  1307     05  RUNDTEI PIC  X(0008).
  1308*    -------------------------------
  1309     05  RUNTIMEL PIC S9(0004) COMP.
  1310     05  RUNTIMEF PIC  X(0001).
  1311     05  FILLER REDEFINES RUNTIMEF.
  1312         10  RUNTIMEA PIC  X(0001).
  1313     05  RUNTIMEI PIC  X(0005).
  1314*    -------------------------------
  1315     05  COMPANYL PIC S9(0004) COMP.
  1316     05  COMPANYF PIC  X(0001).
  1317     05  FILLER REDEFINES COMPANYF.
  1318         10  COMPANYA PIC  X(0001).
  1319     05  COMPANYI PIC  X(0003).
  1320*    -------------------------------
  1321     05  USERIDL PIC S9(0004) COMP.
  1322     05  USERIDF PIC  X(0001).
  1323     05  FILLER REDEFINES USERIDF.
  1324         10  USERIDA PIC  X(0001).
  1325     05  USERIDI PIC  X(0004).
  1326*    -------------------------------
  1327     05  CARRIERL PIC S9(0004) COMP.
  1328     05  CARRIERF PIC  X(0001).
  1329     05  FILLER REDEFINES CARRIERF.
  1330         10  CARRIERA PIC  X(0001).
  1331     05  CARRIERI PIC  X(0001).
  1332*    -------------------------------
  1333     05  GROUPL PIC S9(0004) COMP.
  1334     05  GROUPF PIC  X(0001).
  1335     05  FILLER REDEFINES GROUPF.
  1336         10  GROUPA PIC  X(0001).
  1337     05  GROUPI PIC  X(0006).
  1338*    -------------------------------
  1339     05  STATEL PIC S9(0004) COMP.
  1340     05  STATEF PIC  X(0001).
  1341     05  FILLER REDEFINES STATEF.
  1342         10  STATEA PIC  X(0001).
  1343     05  STATEI PIC  X(0002).
  1344*    -------------------------------
  1345     05  ACCTL PIC S9(0004) COMP.
  1346     05  ACCTF PIC  X(0001).
  1347     05  FILLER REDEFINES ACCTF.
  1348         10  ACCTA PIC  X(0001).
  1349     05  ACCTI PIC  X(0010).
  1350*    -------------------------------
  1351     05  CERTL PIC S9(0004) COMP.
  1352     05  CERTF PIC  X(0001).
  1353     05  FILLER REDEFINES CERTF.
  1354         10  CERTA PIC  X(0001).
  1355     05  CERTI PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  30
* EL691.cbl
  1356*    -------------------------------
  1357     05  SFXL PIC S9(0004) COMP.
  1358     05  SFXF PIC  X(0001).
  1359     05  FILLER REDEFINES SFXF.
  1360         10  SFXA PIC  X(0001).
  1361     05  SFXI PIC  X(0001).
  1362*    -------------------------------
  1363     05  MAINTL PIC S9(0004) COMP.
  1364     05  MAINTF PIC  X(0001).
  1365     05  FILLER REDEFINES MAINTF.
  1366         10  MAINTA PIC  X(0001).
  1367     05  MAINTI PIC  X(0001).
  1368*    -------------------------------
  1369     05  MAINTBYL PIC S9(0004) COMP.
  1370     05  MAINTBYF PIC  X(0001).
  1371     05  FILLER REDEFINES MAINTBYF.
  1372         10  MAINTBYA PIC  X(0001).
  1373     05  MAINTBYI PIC  X(0004).
  1374*    -------------------------------
  1375     05  MAINTDTL PIC S9(0004) COMP.
  1376     05  MAINTDTF PIC  X(0001).
  1377     05  FILLER REDEFINES MAINTDTF.
  1378         10  MAINTDTA PIC  X(0001).
  1379     05  MAINTDTI PIC  X(0008).
  1380*    -------------------------------
  1381     05  MAINTTML PIC S9(0004) COMP.
  1382     05  MAINTTMF PIC  X(0001).
  1383     05  FILLER REDEFINES MAINTTMF.
  1384         10  MAINTTMA PIC  X(0001).
  1385     05  MAINTTMI PIC  X(0005).
  1386*    -------------------------------
  1387     05  ARCHNOL PIC S9(0004) COMP.
  1388     05  ARCHNOF PIC  X(0001).
  1389     05  FILLER REDEFINES ARCHNOF.
  1390         10  ARCHNOA PIC  X(0001).
  1391     05  ARCHNOI PIC  X(0008).
  1392*    -------------------------------
  1393     05  ENDARCHL PIC S9(0004) COMP.
  1394     05  ENDARCHF PIC  X(0001).
  1395     05  FILLER REDEFINES ENDARCHF.
  1396         10  ENDARCHA PIC  X(0001).
  1397     05  ENDARCHI PIC  X(0008).
  1398*    -------------------------------
  1399     05  FORMNOL PIC S9(0004) COMP.
  1400     05  FORMNOF PIC  X(0001).
  1401     05  FILLER REDEFINES FORMNOF.
  1402         10  FORMNOA PIC  X(0001).
  1403     05  FORMNOI PIC  X(0004).
  1404*    -------------------------------
  1405     05  RESFORML PIC S9(0004) COMP.
  1406     05  RESFORMF PIC  X(0001).
  1407     05  FILLER REDEFINES RESFORMF.
  1408         10  RESFORMA PIC  X(0001).
  1409     05  RESFORMI PIC  X(0004).
  1410*    -------------------------------
  1411     05  CREATDTL PIC S9(0004) COMP.
  1412     05  CREATDTF PIC  X(0001).
  1413     05  FILLER REDEFINES CREATDTF.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  31
* EL691.cbl
  1414         10  CREATDTA PIC  X(0001).
  1415     05  CREATDTI PIC  X(0008).
  1416*    -------------------------------
  1417     05  RESENDL PIC S9(0004) COMP.
  1418     05  RESENDF PIC  X(0001).
  1419     05  FILLER REDEFINES RESENDF.
  1420         10  RESENDA PIC  X(0001).
  1421     05  RESENDI PIC  X(0008).
  1422*    -------------------------------
  1423     05  CREATBYL PIC S9(0004) COMP.
  1424     05  CREATBYF PIC  X(0001).
  1425     05  FILLER REDEFINES CREATBYF.
  1426         10  CREATBYA PIC  X(0001).
  1427     05  CREATBYI PIC  X(0004).
  1428*    -------------------------------
  1429     05  PRINTDTL PIC S9(0004) COMP.
  1430     05  PRINTDTF PIC  X(0001).
  1431     05  FILLER REDEFINES PRINTDTF.
  1432         10  PRINTDTA PIC  X(0001).
  1433     05  PRINTDTI PIC  X(0008).
  1434*    -------------------------------
  1435     05  RESPRNTL PIC S9(0004) COMP.
  1436     05  RESPRNTF PIC  X(0001).
  1437     05  FILLER REDEFINES RESPRNTF.
  1438         10  RESPRNTA PIC  X(0001).
  1439     05  RESPRNTI PIC  X(0008).
  1440*    -------------------------------
  1441     05  STCOMPL PIC S9(0004) COMP.
  1442     05  STCOMPF PIC  X(0001).
  1443     05  FILLER REDEFINES STCOMPF.
  1444         10  STCOMPA PIC  X(0001).
  1445     05  STCOMPI PIC  X(0019).
  1446*    -------------------------------
  1447     05  REPLYL PIC S9(0004) COMP.
  1448     05  REPLYF PIC  X(0001).
  1449     05  FILLER REDEFINES REPLYF.
  1450         10  REPLYA PIC  X(0001).
  1451     05  REPLYI PIC  X(0008).
  1452*    -------------------------------
  1453     05  STRECVL PIC S9(0004) COMP.
  1454     05  STRECVF PIC  X(0001).
  1455     05  FILLER REDEFINES STRECVF.
  1456         10  STRECVA PIC  X(0001).
  1457     05  STRECVI PIC  X(0019).
  1458*    -------------------------------
  1459     05  STOPDTEL PIC S9(0004) COMP.
  1460     05  STOPDTEF PIC  X(0001).
  1461     05  FILLER REDEFINES STOPDTEF.
  1462         10  STOPDTEA PIC  X(0001).
  1463     05  STOPDTEI PIC  X(0008).
  1464*    -------------------------------
  1465     05  STSTOPL PIC S9(0004) COMP.
  1466     05  STSTOPF PIC  X(0001).
  1467     05  FILLER REDEFINES STSTOPF.
  1468         10  STSTOPA PIC  X(0001).
  1469     05  STSTOPI PIC  X(0019).
  1470*    -------------------------------
  1471     05  FINDATEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  32
* EL691.cbl
  1472     05  FINDATEF PIC  X(0001).
  1473     05  FILLER REDEFINES FINDATEF.
  1474         10  FINDATEA PIC  X(0001).
  1475     05  FINDATEI PIC  X(0008).
  1476*    -------------------------------
  1477     05  STFINLL PIC S9(0004) COMP.
  1478     05  STFINLF PIC  X(0001).
  1479     05  FILLER REDEFINES STFINLF.
  1480         10  STFINLA PIC  X(0001).
  1481     05  STFINLI PIC  X(0019).
  1482*    -------------------------------
  1483     05  FINLACTL PIC S9(0004) COMP.
  1484     05  FINLACTF PIC  X(0001).
  1485     05  FILLER REDEFINES FINLACTF.
  1486         10  FINLACTA PIC  X(0001).
  1487     05  FINLACTI PIC  X(0001).
  1488*    -------------------------------
  1489     05  COMMENTL PIC S9(0004) COMP.
  1490     05  COMMENTF PIC  X(0001).
  1491     05  FILLER REDEFINES COMMENTF.
  1492         10  COMMENTA PIC  X(0001).
  1493     05  COMMENTI PIC  X(0069).
  1494*    -------------------------------
  1495     05  ERRMSG1L PIC S9(0004) COMP.
  1496     05  ERRMSG1F PIC  X(0001).
  1497     05  FILLER REDEFINES ERRMSG1F.
  1498         10  ERRMSG1A PIC  X(0001).
  1499     05  ERRMSG1I PIC  X(0079).
  1500*    -------------------------------
  1501     05  ERRMSG2L PIC S9(0004) COMP.
  1502     05  ERRMSG2F PIC  X(0001).
  1503     05  FILLER REDEFINES ERRMSG2F.
  1504         10  ERRMSG2A PIC  X(0001).
  1505     05  ERRMSG2I PIC  X(0079).
  1506 01  EL691AO REDEFINES EL691AI.
  1507     05  FILLER            PIC  X(0012).
  1508*    -------------------------------
  1509     05  FILLER            PIC  X(0003).
  1510     05  RUNDTEO PIC  X(0008).
  1511*    -------------------------------
  1512     05  FILLER            PIC  X(0003).
  1513     05  RUNTIMEO PIC  99.99.
  1514*    -------------------------------
  1515     05  FILLER            PIC  X(0003).
  1516     05  COMPANYO PIC  X(0003).
  1517*    -------------------------------
  1518     05  FILLER            PIC  X(0003).
  1519     05  USERIDO PIC  X(0004).
  1520*    -------------------------------
  1521     05  FILLER            PIC  X(0003).
  1522     05  CARRIERO PIC  X(0001).
  1523*    -------------------------------
  1524     05  FILLER            PIC  X(0003).
  1525     05  GROUPO PIC  X(0006).
  1526*    -------------------------------
  1527     05  FILLER            PIC  X(0003).
  1528     05  STATEO PIC  X(0002).
  1529*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  33
* EL691.cbl
  1530     05  FILLER            PIC  X(0003).
  1531     05  ACCTO PIC  X(0010).
  1532*    -------------------------------
  1533     05  FILLER            PIC  X(0003).
  1534     05  CERTO PIC  X(0010).
  1535*    -------------------------------
  1536     05  FILLER            PIC  X(0003).
  1537     05  SFXO PIC  X(0001).
  1538*    -------------------------------
  1539     05  FILLER            PIC  X(0003).
  1540     05  MAINTO PIC  X(0001).
  1541*    -------------------------------
  1542     05  FILLER            PIC  X(0003).
  1543     05  MAINTBYO PIC  X(0004).
  1544*    -------------------------------
  1545     05  FILLER            PIC  X(0003).
  1546     05  MAINTDTO PIC  99B99B99.
  1547*    -------------------------------
  1548     05  FILLER            PIC  X(0003).
  1549     05  MAINTTMO PIC  99.99.
  1550*    -------------------------------
  1551     05  FILLER            PIC  X(0003).
  1552     05  ARCHNOO PIC  X(0008).
  1553*    -------------------------------
  1554     05  FILLER            PIC  X(0003).
  1555     05  ENDARCHO PIC  X(0008).
  1556*    -------------------------------
  1557     05  FILLER            PIC  X(0003).
  1558     05  FORMNOO PIC  X(0004).
  1559*    -------------------------------
  1560     05  FILLER            PIC  X(0003).
  1561     05  RESFORMO PIC  X(0004).
  1562*    -------------------------------
  1563     05  FILLER            PIC  X(0003).
  1564     05  CREATDTO PIC  99B99B99.
  1565*    -------------------------------
  1566     05  FILLER            PIC  X(0003).
  1567     05  RESENDO PIC  99B99B99.
  1568*    -------------------------------
  1569     05  FILLER            PIC  X(0003).
  1570     05  CREATBYO PIC  X(0004).
  1571*    -------------------------------
  1572     05  FILLER            PIC  X(0003).
  1573     05  PRINTDTO PIC  99B99B99.
  1574*    -------------------------------
  1575     05  FILLER            PIC  X(0003).
  1576     05  RESPRNTO PIC  99B99B99.
  1577*    -------------------------------
  1578     05  FILLER            PIC  X(0003).
  1579     05  STCOMPO PIC  X(0019).
  1580*    -------------------------------
  1581     05  FILLER            PIC  X(0003).
  1582     05  REPLYO PIC  99B99B99.
  1583*    -------------------------------
  1584     05  FILLER            PIC  X(0003).
  1585     05  STRECVO PIC  X(0019).
  1586*    -------------------------------
  1587     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  34
* EL691.cbl
  1588     05  STOPDTEO PIC  99B99B99.
  1589*    -------------------------------
  1590     05  FILLER            PIC  X(0003).
  1591     05  STSTOPO PIC  X(0019).
  1592*    -------------------------------
  1593     05  FILLER            PIC  X(0003).
  1594     05  FINDATEO PIC  99B99B99.
  1595*    -------------------------------
  1596     05  FILLER            PIC  X(0003).
  1597     05  STFINLO PIC  X(0019).
  1598*    -------------------------------
  1599     05  FILLER            PIC  X(0003).
  1600     05  FINLACTO PIC  X(0001).
  1601*    -------------------------------
  1602     05  FILLER            PIC  X(0003).
  1603     05  COMMENTO PIC  X(0069).
  1604*    -------------------------------
  1605     05  FILLER            PIC  X(0003).
  1606     05  ERRMSG1O PIC  X(0079).
  1607*    -------------------------------
  1608     05  FILLER            PIC  X(0003).
  1609     05  ERRMSG2O PIC  X(0079).
  1610*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  35
* EL691.cbl
  1612****************************************************************
  1613*
  1614* Copyright (c) 2007 by Clerity Solutions, Inc.
  1615* All rights reserved.
  1616*
  1617****************************************************************
  1618 01  DFHEIV.
  1619   02  DFHEIV0               PIC X(35).
  1620   02  DFHEIV1               PIC X(08).
  1621   02  DFHEIV2               PIC X(08).
  1622   02  DFHEIV3               PIC X(08).
  1623   02  DFHEIV4               PIC X(06).
  1624   02  DFHEIV5               PIC X(04).
  1625   02  DFHEIV6               PIC X(04).
  1626   02  DFHEIV7               PIC X(02).
  1627   02  DFHEIV8               PIC X(02).
  1628   02  DFHEIV9               PIC X(01).
  1629   02  DFHEIV10              PIC S9(7) COMP-3.
  1630   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1631   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1632   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1633   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1634   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1635   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1636   02  DFHEIV17              PIC X(04).
  1637   02  DFHEIV18              PIC X(04).
  1638   02  DFHEIV19              PIC X(04).
  1639   02  DFHEIV20              USAGE IS POINTER.
  1640   02  DFHEIV21              USAGE IS POINTER.
  1641   02  DFHEIV22              USAGE IS POINTER.
  1642   02  DFHEIV23              USAGE IS POINTER.
  1643   02  DFHEIV24              USAGE IS POINTER.
  1644   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1645   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1646   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1647   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1648   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1649   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1650   02  FILLER                PIC X(02).
  1651   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1652   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1653   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1654   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1655   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1656 LINKAGE  SECTION.
  1657*****************************************************************
  1658*                                                               *
  1659* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1660* All rights reserved.                                          *
  1661*                                                               *
  1662*****************************************************************
  1663 01  dfheiblk.
  1664     02  eibtime          pic s9(7) comp-3.
  1665     02  eibdate          pic s9(7) comp-3.
  1666     02  eibtrnid         pic x(4).
  1667     02  eibtaskn         pic s9(7) comp-3.
  1668     02  eibtrmid         pic x(4).
  1669     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  36
* EL691.cbl
  1670     02  eibcposn         pic s9(4) comp.
  1671     02  eibcalen         pic s9(4) comp.
  1672     02  eibaid           pic x(1).
  1673     02  eibfiller1       pic x(1).
  1674     02  eibfn            pic x(2).
  1675     02  eibfiller2       pic x(2).
  1676     02  eibrcode         pic x(6).
  1677     02  eibfiller3       pic x(2).
  1678     02  eibds            pic x(8).
  1679     02  eibreqid         pic x(8).
  1680     02  eibrsrce         pic x(8).
  1681     02  eibsync          pic x(1).
  1682     02  eibfree          pic x(1).
  1683     02  eibrecv          pic x(1).
  1684     02  eibsend          pic x(1).
  1685     02  eibatt           pic x(1).
  1686     02  eibeoc           pic x(1).
  1687     02  eibfmh           pic x(1).
  1688     02  eibcompl         pic x(1).
  1689     02  eibsig           pic x(1).
  1690     02  eibconf          pic x(1).
  1691     02  eiberr           pic x(1).
  1692     02  eibrldbk         pic x(1).
  1693     02  eiberrcd         pic x(4).
  1694     02  eibsynrb         pic x(1).
  1695     02  eibnodat         pic x(1).
  1696     02  eibfiller5       pic x(2).
  1697     02  eibresp          pic 9(09) comp.
  1698     02  eibresp2         pic 9(09) comp.
  1699     02  dfheigdj         pic s9(4) comp.
  1700     02  dfheigdk         pic s9(4) comp.
  1701 01  DFHCOMMAREA                 PIC X(1024).
  1702
  1703*    COPY ERCARCH.
  1704******************************************************************
  1705*                                                                *
  1706*                            ERCARCH.                            *
  1707*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1708*                            VMOD=2.002                          *
  1709*                                                                *
  1710*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  1711*                                                                *
  1712*   FILE TYPE = VSAM,KSDS                                        *
  1713*   RECORD SIZE = 250  RECFORM = FIXED                           *
  1714*                                                                *
  1715*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  1716*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  1717*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  1718*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  1719*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  1720*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  1721*                                                                *
  1722*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1723******************************************************************
  1724*                   C H A N G E   L O G
  1725*
  1726* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1727*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  37
* EL691.cbl
  1728*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1729* EFFECTIVE    NUMBER
  1730*-----------------------------------------------------------------
  1731* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1732* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  1733* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1734******************************************************************
  1735 01  LETTER-ARCHIVE.
  1736     12  LA-RECORD-ID                PIC  X(02).
  1737         88  LA-VALID-ID                VALUE 'LA'.
  1738
  1739     12  LA-CONTROL-PRIMARY.
  1740         16  LA-COMPANY-CD           PIC  X(01).
  1741         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  1742
  1743     12  LA-CONTROL-BY-CERT-RESP.
  1744         16  LA-COMPANY-CD-A2        PIC  X(01).
  1745         16  LA-CERT-NO-A2.
  1746             20  LA-CERT-PRIME-A2    PIC  X(10).
  1747             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  1748         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  1749             20  LA-RESP-PERSON-A2   PIC  X(10).
  1750             20  LA-TYPE-A2          PIC  X(01).
  1751         16  LA-CARRIER-A2           PIC  X(01).
  1752         16  LA-GROUPING-A2          PIC  X(06).
  1753         16  LA-STATE-A2             PIC  X(02).
  1754         16  LA-ACCOUNT-A2           PIC  X(10).
  1755         16  LA-EFFECT-DATE-A2       PIC  X(02).
  1756         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  1757
  1758     12  LA-CONTROL-BY-FORM.
  1759         16  LA-COMPANY-CD-A3        PIC  X(01).
  1760         16  LA-FORM-A3              PIC  X(04).
  1761         16  LA-CARRIER-A3           PIC  X(01).
  1762         16  LA-GROUPING-A3          PIC  X(06).
  1763         16  LA-STATE-A3             PIC  X(02).
  1764         16  LA-ACCOUNT-A3           PIC  X(10).
  1765         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  1766
  1767     12  LA-CONTROL-BY-PROCESSOR.
  1768         16  LA-COMPANY-CD-A4        PIC  X(01).
  1769         16  LA-PROCESSOR-CD         PIC  X(04).
  1770         16  LA-CARRIER-A4           PIC  X(01).
  1771         16  LA-GROUPING-A4          PIC  X(06).
  1772         16  LA-STATE-A4             PIC  X(02).
  1773         16  LA-ACCOUNT-A4           PIC  X(10).
  1774         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  1775
  1776     12  LA-CONTROL-BY-KEY-FIELDS.
  1777         16  LA-COMPANY-CD-A5        PIC  X(01).
  1778         16  LA-CARRIER-A5           PIC  X(01).
  1779         16  LA-GROUPING-A5          PIC  X(06).
  1780         16  LA-STATE-A5             PIC  X(02).
  1781         16  LA-ACCOUNT-A5           PIC  X(10).
  1782         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  1783
  1784     12  LA-CONTROL-BY-GROUP-CODE.
  1785         16  LA-COMPANY-CD-A6        PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  38
* EL691.cbl
  1786         16  LA-ENTRY-A6.
  1787             20  LA-FILLER           PIC  X(02).
  1788             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  1789         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  1790
  1791     12  FILLER                      PIC  X(09).
  1792
  1793     12  LA-HEADER-RECORD.
  1794         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  1795         16  LA-CREATION-DATE        PIC  X(02).
  1796         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  1797         16  LA-FINAL-ACT-DATE       REDEFINES
  1798               LA-FOLLOW-UP-DATE     PIC  X(02).
  1799         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  1800         16  LA-NO-OF-COPIES         PIC S9(01).
  1801         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  1802         16  LA-REPLY-DATE           PIC  X(02).
  1803         16  LA-RESEND-DATES.
  1804             20  LA-RESEND-DATE      PIC  X(02).
  1805             20  LA-SENT-DATE        PIC  X(02).
  1806             20  FILLER              PIC  X(08).
  1807         16  LA-SOURCE-INFORMATION.
  1808             20  LA-DATA-SOURCE      PIC  X(01).
  1809             20  LA-ADDR-SOURCE      PIC  X(01).
  1810         16  LA-STATUS               PIC  X(01).
  1811             88  LA-STATUS-ACTIVE         VALUE 'A'.
  1812             88  LA-STATUS-COMPLETED      VALUE 'C'.
  1813             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  1814             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  1815             88  LA-STATUS-PURGED         VALUE 'P'.
  1816             88  LA-STATUS-VOIDED         VALUE 'V'.
  1817         16  LA-LAST-RESENT-PRINT-DATE
  1818                                     PIC  X(02).
  1819         16  LA-PRINT-RESTRICTION    PIC  X(01).
  1820             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  1821                                          VALUE 'C'.
  1822             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  1823                                          VALUE 'F'.
  1824             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  1825                                          VALUE 'P'.
  1826         16  LA-PURGED-DATE          PIC  X(02).
  1827         16  LA-VOIDED-DATE          PIC  X(02).
  1828         16  LA-RESEND-LETR          PIC  X(4).
  1829         16  FILLER                  PIC  X(08).
  1830*        16  LA-RESEND-LETR-2        PIC  X(4).
  1831*        16  LA-RESEND-LETR-3        PIC  X(4).
  1832*        16  FILLER                  PIC  X(59).
  1833         16  LA-ARCHIVE-STATUS       PIC  X.
  1834             88  LA-TEMP                VALUE 'T'.
  1835             88  LA-QWS                 VALUE 'Q'.
  1836             88  LA-BATCH               VALUE 'B'.
  1837         16  LA-FINAL-ACT-IND        PIC  X(1).
  1838         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  1839         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  1840         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  1841                                     PIC X(4).
  1842         16  FILLER                  PIC  X(42).
  1843*        16  FILLER                  PIC  X(71).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  39
* EL691.cbl
  1844         16  LA-LAST-MAINT-DATE      PIC  X(2).
  1845         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  1846         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  1847                                     PIC  X(4).
  1848         16  LA-LAST-UPDATED-BY      PIC  X(4).
  1849
  1850******************************************************************
  1851
  1852*    COPY ERCARCT.
  1853******************************************************************
  1854*                                                                *
  1855*                            ERCARCT.                            *
  1856*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1857*                            VMOD=2.002                          *
  1858*                                                                *
  1859*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  1860*                                                                *
  1861*   FILE TYPE = VSAM,KSDS                                        *
  1862*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  1863*                                                                *
  1864*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  1865*                                                                *
  1866*   LOG = NO                                                     *
  1867*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1868******************************************************************
  1869*                   C H A N G E   L O G
  1870*
  1871* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1872*-----------------------------------------------------------------
  1873*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1874* EFFECTIVE    NUMBER
  1875*-----------------------------------------------------------------
  1876* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  1877******************************************************************
  1878 01  LETTER-ARCHIVE-TEXT.
  1879     12  LT-RECORD-ID                PIC  X(02).
  1880         88  LT-VALID-ID                VALUE 'LT'.
  1881
  1882     12  LT-CONTROL-PRIMARY.
  1883         16  LT-COMPANY-CD           PIC  X(01).
  1884         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  1885         16  LT-RECORD-TYPE          PIC  X(01).
  1886             88  LT-ADDRESS-DATA        VALUE '1'.
  1887             88  LT-TEXT-DATA           VALUE '2'.
  1888             88  LT-COMMENT-DATA        VALUE '3'.
  1889         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  1890
  1891     12  FILLER                      PIC  X(28).
  1892     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  1893
  1894     12  LT-TEXT-RECORD.
  1895         16  LT-LETTER-TEXT OCCURS 20 TIMES
  1896                            INDEXED BY LT-NDX.
  1897             20  LT-TEXT-LINE        PIC  X(70).
  1898             20  LT-SKIP-CONTROL     PIC  X(02).
  1899                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  1900                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  1901             20  FILLER              PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  40
* EL691.cbl
  1902
  1903     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  1904         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  1905             20  LT-COMMENT-LINE     PIC X(69).
  1906             20  LT-COMMENT-CHG-DT   PIC X(02).
  1907             20  LT-COMMENT-CHG-BY   PIC X(04).
  1908             20  FILLER              PIC X(05).
  1909
  1910
  1911*    COPY ERCCNOT.
  1912******************************************************************
  1913*                                                                *
  1914*                            ERCCNOT                             *
  1915*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1916*                            VMOD=2.003                          *
  1917*                                                                *
  1918*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  1919*                                                                *
  1920*        FILE TYPE= VSAM,KSDS                                    *
  1921*        RECORD SIZE = 150    RECFORM = FIXED                    *
  1922*                                                                *
  1923*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  1924*                                                                *
  1925*        LOG = YES                                               *
  1926*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1927*                                                                *
  1928******************************************************************
  1929*                   C H A N G E   L O G
  1930*
  1931* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1932*-----------------------------------------------------------------
  1933*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1934* EFFECTIVE    NUMBER
  1935*-----------------------------------------------------------------
  1936* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  1937******************************************************************
  1938
  1939 01  CERT-NOTE-FILE.
  1940     12  CZ-RECORD-ID                PIC  XX.
  1941         88  VALID-CZ-ID                  VALUE 'CZ'.
  1942
  1943     12  CZ-CONTROL-PRIMARY.
  1944         16  CZ-COMPANY-CD           PIC X.
  1945         16  CZ-CARRIER              PIC X.
  1946         16  CZ-GROUPING.
  1947             20 CZ-GROUPING-PREFIX   PIC XXX.
  1948             20 CZ-GROUPING-PRIME    PIC XXX.
  1949         16  CZ-STATE                PIC XX.
  1950         16  CZ-ACCOUNT.
  1951             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  1952             20 CZ-ACCOUNT-PRIME     PIC X(6).
  1953         16  CZ-CERT-EFF-DT          PIC XX.
  1954         16  CZ-CERT-NO.
  1955             20  CZ-CERT-PRIME       PIC X(10).
  1956             20  CZ-CERT-SFX         PIC X.
  1957         16  CZ-RECORD-TYPE          PIC X.
  1958             88  CERT-NOTE           VALUE '1'.
  1959             88  CLAIM-CERT-NOTE     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  41
* EL691.cbl
  1960         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  1961
  1962     12  CZ-LAST-MAINT-DT            PIC XX.
  1963     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  1964     12  CZ-LAST-MAINT-USER          PIC X(4).
  1965
  1966     12  CZ-NOTE-INFORMATION.
  1967         16  CZ-NOTE                 PIC X(63).
  1968         16  FILLER                  PIC X(39).
  1969******************************************************************
  1970
  1971*    COPY ELCCERT.
  1972******************************************************************
  1973*                                                                *
  1974*                            ELCCERT.                            *
  1975*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1976*                            VMOD=2.013                          *
  1977*                                                                *
  1978*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1979*                                                                *
  1980*   FILE TYPE = VSAM,KSDS                                        *
  1981*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1982*                                                                *
  1983*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1984*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1985*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1986*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1987*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1988*                                                                *
  1989*   LOG = YES                                                    *
  1990*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1991******************************************************************
  1992*                   C H A N G E   L O G
  1993*
  1994* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1995*-----------------------------------------------------------------
  1996*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1997* EFFECTIVE    NUMBER
  1998*-----------------------------------------------------------------
  1999* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2000* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2001* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2002* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2003* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2004* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2005* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2006* 032612  CR2011110200001  PEMA  AHL CHANGES
  2007******************************************************************
  2008
  2009 01  CERTIFICATE-MASTER.
  2010     12  CM-RECORD-ID                      PIC XX.
  2011         88  VALID-CM-ID                      VALUE 'CM'.
  2012
  2013     12  CM-CONTROL-PRIMARY.
  2014         16  CM-COMPANY-CD                 PIC X.
  2015         16  CM-CARRIER                    PIC X.
  2016         16  CM-GROUPING.
  2017             20  CM-GROUPING-PREFIX        PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  42
* EL691.cbl
  2018             20  CM-GROUPING-PRIME         PIC X(3).
  2019         16  CM-STATE                      PIC XX.
  2020         16  CM-ACCOUNT.
  2021             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2022             20  CM-ACCOUNT-PRIME          PIC X(6).
  2023         16  CM-CERT-EFF-DT                PIC XX.
  2024         16  CM-CERT-NO.
  2025             20  CM-CERT-PRIME             PIC X(10).
  2026             20  CM-CERT-SFX               PIC X.
  2027
  2028     12  CM-CONTROL-BY-NAME.
  2029         16  CM-COMPANY-CD-A1              PIC X.
  2030         16  CM-INSURED-LAST-NAME          PIC X(15).
  2031         16  CM-INSURED-INITIALS.
  2032             20  CM-INSURED-INITIAL1       PIC X.
  2033             20  CM-INSURED-INITIAL2       PIC X.
  2034
  2035     12  CM-CONTROL-BY-SSN.
  2036         16  CM-COMPANY-CD-A2              PIC X.
  2037         16  CM-SOC-SEC-NO.
  2038             20  CM-SSN-STATE              PIC XX.
  2039             20  CM-SSN-ACCOUNT            PIC X(6).
  2040             20  CM-SSN-LN3.
  2041                 25  CM-INSURED-INITIALS-A2.
  2042                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2043                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2044                 25 CM-PART-LAST-NAME-A2         PIC X.
  2045
  2046     12  CM-CONTROL-BY-CERT-NO.
  2047         16  CM-COMPANY-CD-A4              PIC X.
  2048         16  CM-CERT-NO-A4                 PIC X(11).
  2049
  2050     12  CM-CONTROL-BY-MEMB.
  2051         16  CM-COMPANY-CD-A5              PIC X.
  2052         16  CM-MEMBER-NO.
  2053             20  CM-MEMB-STATE             PIC XX.
  2054             20  CM-MEMB-ACCOUNT           PIC X(6).
  2055             20  CM-MEMB-LN4.
  2056                 25  CM-INSURED-INITIALS-A5.
  2057                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2058                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2059                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2060
  2061     12  CM-INSURED-PROFILE-DATA.
  2062         16  CM-INSURED-FIRST-NAME.
  2063             20  CM-INSURED-1ST-INIT       PIC X.
  2064             20  FILLER                    PIC X(9).
  2065         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2066         16  CM-INSURED-SEX                PIC X.
  2067             88  CM-SEX-MALE                  VALUE 'M'.
  2068             88  CM-SEX-FEMAL                 VALUE 'F'.
  2069         16  CM-INSURED-JOINT-AGE          PIC 99.
  2070         16  CM-JOINT-INSURED-NAME.
  2071             20  CM-JT-LAST-NAME           PIC X(15).
  2072             20  CM-JT-FIRST-NAME.
  2073                 24  CM-JT-1ST-INIT        PIC X.
  2074                 24  FILLER                PIC X(9).
  2075             20  CM-JT-INITIAL             PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  43
* EL691.cbl
  2076
  2077     12  CM-LIFE-DATA.
  2078         16  CM-LF-BENEFIT-CD              PIC XX.
  2079         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2080         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2081         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2082         16  CM-LF-DEV-CODE                PIC XXX.
  2083         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2084         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2085         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2086         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2087         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2088         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2089         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2090         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2091         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2092         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2093         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2094         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2095         16  FILLER                        PIC XX.
  2096
  2097     12  CM-AH-DATA.
  2098         16  CM-AH-BENEFIT-CD              PIC XX.
  2099         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2100         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2101         16  CM-AH-DEV-CODE                PIC XXX.
  2102         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2103         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2104         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2105         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2106         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2107         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2108         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2109         16  CM-AH-PAID-THRU-DT            PIC XX.
  2110             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2111         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2112         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2113         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2114         16  FILLER                        PIC X.
  2115
  2116     12  CM-LOAN-INFORMATION.
  2117         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2118         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2119                                           PIC S9(5)V99  COMP-3.
  2120         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2121         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2122         16  CM-PAY-FREQUENCY              PIC S99.
  2123         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2124         16  CM-RATE-CLASS                 PIC XX.
  2125         16  CM-BENEFICIARY                PIC X(25).
  2126         16  CM-POLICY-FORM-NO             PIC X(12).
  2127         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2128         16  CM-LAST-ADD-ON-DT             PIC XX.
  2129         16  CM-DEDUCTIBLE-AMOUNTS.
  2130             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2131             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2132         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2133             20  CM-RESIDENT-STATE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  44
* EL691.cbl
  2134             20  CM-RATE-CODE              PIC X(4).
  2135             20  FILLER                    PIC XX.
  2136         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2137             20  CM-LOAN-OFFICER           PIC X(5).
  2138             20  FILLER                    PIC XXX.
  2139         16  CM-CSR-CODE                   PIC XXX.
  2140         16  CM-UNDERWRITING-CODE          PIC X.
  2141             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2142         16  CM-POST-CARD-IND              PIC X.
  2143         16  CM-NH-INTERFACE-SW            PIC X.
  2144         16  CM-PREMIUM-TYPE               PIC X.
  2145             88  CM-SING-PRM                  VALUE '1'.
  2146             88  CM-O-B-COVERAGE              VALUE '2'.
  2147             88  CM-OPEN-END                  VALUE '3'.
  2148         16  CM-IND-GRP-TYPE               PIC X.
  2149             88  CM-INDIVIDUAL                VALUE 'I'.
  2150             88  CM-GROUP                     VALUE 'G'.
  2151         16  CM-SKIP-CODE                  PIC X.
  2152             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2153             88  SKIP-JULY                    VALUE '1'.
  2154             88  SKIP-AUGUST                  VALUE '2'.
  2155             88  SKIP-SEPTEMBER               VALUE '3'.
  2156             88  SKIP-JULY-AUG                VALUE '4'.
  2157             88  SKIP-AUG-SEPT                VALUE '5'.
  2158             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2159             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2160             88  SKIP-JUNE                    VALUE '8'.
  2161             88  SKIP-JUNE-JULY               VALUE '9'.
  2162             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2163             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2164         16  CM-PAYMENT-MODE               PIC X.
  2165             88  PAY-MONTHLY                  VALUE SPACE.
  2166             88  PAY-WEEKLY                   VALUE '1'.
  2167             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2168             88  PAY-BI-WEEKLY                VALUE '3'.
  2169             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2170         16  CM-LOAN-NUMBER                PIC X(8).
  2171         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2172         16  CM-OLD-LOF                    PIC XXX.
  2173*        16  CM-LOAN-OFFICER               PIC XXX.
  2174         16  CM-REIN-TABLE                 PIC XXX.
  2175         16  CM-SPECIAL-REIN-CODE          PIC X.
  2176         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2177         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2178         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2179
  2180     12  CM-STATUS-DATA.
  2181         16  CM-ENTRY-STATUS               PIC X.
  2182         16  CM-ENTRY-DT                   PIC XX.
  2183
  2184         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2185         16  CM-LF-CANCEL-DT               PIC XX.
  2186         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2187
  2188         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2189         16  CM-LF-DEATH-DT                PIC XX.
  2190         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2191
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  45
* EL691.cbl
  2192         16  CM-LF-CURRENT-STATUS          PIC X.
  2193             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2194                                                'M' '4' '5' '9'.
  2195             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2196             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2197             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2198             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2199             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2200             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2201             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2202             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2203             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2204             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2205             88  CM-LF-DECLINED               VALUE 'D'.
  2206             88  CM-LF-VOIDED                 VALUE 'V'.
  2207
  2208         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2209         16  CM-AH-CANCEL-DT               PIC XX.
  2210         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2211
  2212         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2213         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2214         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2215
  2216         16  CM-AH-CURRENT-STATUS          PIC X.
  2217             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2218                                                'M' '4' '5' '9'.
  2219             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2220             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2221             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2222             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2223             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2224             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2225             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2226             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2227             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2228             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2229             88  CM-AH-DECLINED               VALUE 'D'.
  2230             88  CM-AH-VOIDED                 VALUE 'V'.
  2231
  2232         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2233             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2234             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2235             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2236         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2237
  2238         16  CM-ENTRY-BATCH                PIC X(6).
  2239         16  CM-LF-EXIT-BATCH              PIC X(6).
  2240         16  CM-AH-EXIT-BATCH              PIC X(6).
  2241         16  CM-LAST-MONTH-END             PIC XX.
  2242
  2243     12  CM-NOTE-SW                        PIC X.
  2244         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2245         88  CERT-NOTES-PRESENT               VALUE '1'.
  2246         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2247         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2248         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2249         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  46
* EL691.cbl
  2250         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2251         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2252     12  CM-COMP-EXCP-SW                   PIC X.
  2253         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2254         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2255     12  CM-INSURED-ADDRESS-SW             PIC X.
  2256         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2257         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2258
  2259*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2260     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2261     12  FILLER                            PIC X.
  2262
  2263*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2264     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2265     12  FILLER                            PIC X.
  2266*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2267     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2268
  2269     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2270         88  CERT-ADDED-BATCH                 VALUE ' '.
  2271         88  CERT-ADDED-ONLINE                VALUE '1'.
  2272         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2273         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2274         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2275     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2276         88  CERT-AS-LOADED                   VALUE ' '.
  2277         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2278         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2279         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2280         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2281         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2282         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2283         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2284
  2285     12  CM-ACCOUNT-COMM-PCTS.
  2286         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2287         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2288
  2289     12  CM-USER-FIELD                     PIC X.
  2290     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2291     12  CM-CLP-STATE                      PIC XX.
  2292     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2293     12  CM-USER-RESERVED                  PIC XXX.
  2294     12  FILLER REDEFINES CM-USER-RESERVED.
  2295         16  CM-AH-CLASS-CD                PIC XX.
  2296         16  F                             PIC X.
  2297******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  47
* EL691.cbl
  2299
  2300 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA LETTER-ARCHIVE
  2301                          LETTER-ARCHIVE-TEXT CERT-NOTE-FILE
  2302                          CERTIFICATE-MASTER.
  2303 0000-DFHEXIT SECTION.
  2304     MOVE '9#                    $   ' TO DFHEIV0.
  2305     MOVE 'EL691' TO DFHEIV1.
  2306     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2307     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  2308
  2309     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  2310     MOVE '5'                    TO DC-OPTION-CODE.
  2311     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  2312     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  2313     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  2314                                    W-CURRENT-SAVE.
  2315
  2316     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  2317     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  2318                                 TO EMI-SAVE-AREA.
  2319
  2320     IF  EIBCALEN EQUAL 0
  2321         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  2322         GO TO 8300-SEND-TEXT
  2323     END-IF.
  2324
  2325     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  2326         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  2327             MOVE PI-SAVED-PROGRAM-5
  2328                                 TO PI-SAVED-PROGRAM-6
  2329             MOVE PI-SAVED-PROGRAM-4
  2330                                 TO PI-SAVED-PROGRAM-5
  2331             MOVE PI-SAVED-PROGRAM-3
  2332                                 TO PI-SAVED-PROGRAM-4
  2333             MOVE PI-SAVED-PROGRAM-2
  2334                                 TO PI-SAVED-PROGRAM-3
  2335             MOVE PI-SAVED-PROGRAM-1
  2336                                 TO PI-SAVED-PROGRAM-2
  2337             MOVE PI-RETURN-TO-PROGRAM
  2338                                 TO PI-SAVED-PROGRAM-1
  2339             MOVE PI-CALLING-PROGRAM
  2340                                 TO PI-RETURN-TO-PROGRAM
  2341             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  2342         ELSE
  2343             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  2344             MOVE PI-RETURN-TO-PROGRAM
  2345                                     TO PI-CALLING-PROGRAM
  2346             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  2347             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  2348             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  2349             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  2350             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  2351             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  2352             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  2353         END-IF
  2354     ELSE
  2355         GO TO 0200-RECEIVE
  2356     END-IF.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  48
* EL691.cbl
  2357
  2358     GO TO 1000-SHOW.
  2359
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  49
* EL691.cbl
  2361
  2362 0200-RECEIVE.
  2363
  2364
  2365* EXEC CICS HANDLE AID
  2366*        CLEAR    (9300-DFHCLEAR)
  2367*        PA1      (9200-PA)
  2368*        PA2      (9200-PA)
  2369*        PA3      (9200-PA)
  2370*    END-EXEC.
  2371*    MOVE '"&=!"#               V! " #00002360' TO DFHEIV0
  2372     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  2373     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  2374     MOVE X'2220233030303032333630' TO DFHEIV0(25:11)
  2375     CALL 'kxdfhei1' USING DFHEIV0
  2376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2377
  2378
  2379
  2380* EXEC CICS HANDLE CONDITION
  2381*        PGMIDERR (9700-PGMID-ERROR)
  2382*        ERROR    (9800-ABEND)
  2383*    END-EXEC.
  2384*    MOVE '"$L.                  ! # #00002367' TO DFHEIV0
  2385     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  2386     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2387     MOVE X'2320233030303032333637' TO DFHEIV0(25:11)
  2388     CALL 'kxdfhei1' USING DFHEIV0
  2389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2390
  2391
  2392
  2393* EXEC CICS RECEIVE
  2394*        MAP      (W-MAP)
  2395*        MAPSET   (W-MAPSET)
  2396*        INTO     (EL691AI)
  2397*    END-EXEC.
  2398     MOVE LENGTH OF
  2399      EL691AI
  2400       TO DFHEIV11
  2401*    MOVE '8"T I  L              ''   #00002372' TO DFHEIV0
  2402     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2403     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2404     MOVE X'2020233030303032333732' TO DFHEIV0(25:11)
  2405     CALL 'kxdfhei1' USING DFHEIV0,
  2406           W-MAP,
  2407           EL691AI,
  2408           DFHEIV11,
  2409           W-MAPSET,
  2410           DFHEIV99,
  2411           DFHEIV99
  2412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2413
  2414
  2415     IF  NOT DISPLAY-CAP
  2416         MOVE 'READ'             TO SM-READ
  2417         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2418         MOVE ER-9097            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  50
* EL691.cbl
  2419         MOVE -1                 TO MAINTL
  2420         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2421         GO TO 8100-SEND-INITIAL-MAP
  2422     END-IF.
  2423
  2424
  2425 0300-CHECK-PFKEYS.
  2426
  2427     IF  EIBAID EQUAL DFHPF23
  2428         MOVE EIBAID             TO PI-ENTRY-CD-1
  2429         MOVE W-XCTL-005         TO W-CALL-PGM
  2430         GO TO 9400-XCTL
  2431     END-IF.
  2432
  2433     IF  EIBAID EQUAL DFHPF24
  2434         MOVE W-XCTL-626         TO W-CALL-PGM
  2435         GO TO 9400-XCTL
  2436     END-IF.
  2437
  2438     IF  EIBAID EQUAL DFHPF6
  2439         MOVE W-XCTL-1279        TO W-CALL-PGM
  2440         GO TO 9400-XCTL
  2441     END-IF
  2442
  2443     IF  MAINTI EQUAL 'C'  AND
  2444         EIBAID EQUAL DFHENTER
  2445          GO TO 0700-PROCESS-CHANGES
  2446     END-IF.
  2447
  2448     MOVE ER-0029                TO EMI-ERROR.
  2449
  2450
  2451 0320-INPUT-ERROR.
  2452
  2453     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2454     MOVE -1                     TO  MAINTL.
  2455     GO TO 8200-SEND-DATAONLY.
  2456
  2457
  2458 0700-PROCESS-CHANGES.
  2459
  2460     IF  NOT MODIFY-CAP
  2461         MOVE 'UPDATE'           TO SM-READ
  2462         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2463         MOVE ER-0070            TO EMI-ERROR
  2464         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2465         MOVE -1                 TO MAINTL
  2466         GO TO 8100-SEND-INITIAL-MAP
  2467     END-IF.
  2468
  2469     MOVE 'N'                    TO W-NEED-COMMENT.
  2470
  2471     IF RESENDL GREATER ZERO
  2472         MOVE 'Y'                TO W-NEED-COMMENT
  2473         IF RESENDI = SPACES
  2474             MOVE AL-UANON       TO  RESENDA
  2475             MOVE +1             TO  W-UPDATE-SW
  2476             MOVE LOW-VALUES     TO  W-RESEND-DATE
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  51
* EL691.cbl
  2477         ELSE
  2478             MOVE RESENDI       TO  W-DEEDIT-FIELD
  2479             PERFORM 8600-DEEDIT THRU 8600-EXIT
  2480             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  2481                 MOVE W-DEEDIT-FIELD-V0  TO  RESENDO
  2482                 INSPECT RESENDI CONVERTING SPACES TO SLASH
  2483                 MOVE '4'        TO  DC-OPTION-CODE
  2484                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  2485                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2486                 IF DC-ERROR-CODE NOT = SPACES
  2487                     MOVE ER-0295         TO  EMI-ERROR
  2488                     MOVE -1              TO  RESENDL
  2489                     MOVE AL-UABON        TO  RESENDA
  2490                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2491                 ELSE
  2492                     MOVE AL-UANON       TO  RESENDA
  2493                     MOVE +1             TO  W-UPDATE-SW
  2494                     MOVE DC-BIN-DATE-1  TO  W-RESEND-DATE
  2495                 END-IF
  2496             ELSE
  2497                 MOVE ER-0295    TO  EMI-ERROR
  2498                 MOVE -1         TO  RESENDL
  2499                 MOVE AL-UABON   TO  RESENDA
  2500                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2501             END-IF
  2502         END-IF
  2503     END-IF.
  2504
  2505     IF FINDATEL GREATER ZERO
  2506         IF FINDATEI = SPACES
  2507             MOVE AL-UANON       TO  FINDATEA
  2508             MOVE +1             TO  W-UPDATE-SW
  2509             MOVE LOW-VALUES     TO  W-FINAL-ACT-DATE
  2510             MOVE SPACES         TO  PI-ARCHIVE-FINAL
  2511         ELSE
  2512             MOVE 'Y'             TO  PI-ARCHIVE-FINAL
  2513             MOVE FINDATEI        TO  W-DEEDIT-FIELD
  2514             PERFORM 8600-DEEDIT THRU 8600-EXIT
  2515             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  2516                 MOVE W-DEEDIT-FIELD-V0  TO  FINDATEO
  2517                 INSPECT FINDATEI CONVERTING SPACES TO SLASH
  2518                 MOVE '4'                 TO  DC-OPTION-CODE
  2519                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  2520                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2521                 IF DC-ERROR-CODE NOT = SPACES
  2522                     MOVE ER-0296        TO  EMI-ERROR
  2523                     MOVE -1             TO  FINDATEL
  2524                     MOVE AL-UABON       TO  FINDATEA
  2525                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2526                 ELSE
  2527                     MOVE AL-UANON       TO  FINDATEA
  2528                     MOVE +1             TO  W-UPDATE-SW
  2529                     MOVE DC-BIN-DATE-1  TO  W-FINAL-ACT-DATE
  2530                 END-IF
  2531             ELSE
  2532                 MOVE ER-0296    TO  EMI-ERROR
  2533                 MOVE -1         TO  FINDATEL
  2534                 MOVE AL-UABON   TO  FINDATEA
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  52
* EL691.cbl
  2535                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2536             END-IF
  2537         END-IF
  2538     END-IF.
  2539
  2540     IF REPLYL GREATER ZERO
  2541         IF REPLYI = SPACES
  2542             MOVE AL-UANON       TO  REPLYA
  2543             MOVE +1             TO  W-UPDATE-SW
  2544             MOVE LOW-VALUES     TO  W-RECEIVED-DATE
  2545             MOVE SPACES         TO  PI-ARCHIVE-RECEIVED
  2546         ELSE
  2547             MOVE 'Y'            TO  PI-ARCHIVE-RECEIVED
  2548             MOVE REPLYI         TO  W-DEEDIT-FIELD
  2549             PERFORM 8600-DEEDIT THRU 8600-EXIT
  2550             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  2551                 MOVE W-DEEDIT-FIELD-V0  TO  REPLYO
  2552                 INSPECT REPLYI CONVERTING SPACES TO SLASH
  2553                 MOVE '4'        TO  DC-OPTION-CODE
  2554                 MOVE W-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  2555                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2556                 IF DC-ERROR-CODE NOT = SPACES
  2557                     MOVE ER-9245        TO  EMI-ERROR
  2558                     MOVE -1             TO  REPLYL
  2559                     MOVE AL-UABON       TO  REPLYA
  2560                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2561                 ELSE
  2562                   IF DC-BIN-DATE-1 GREATER THAN W-SAVE-BIN-DATE
  2563                       MOVE ER-0539      TO  EMI-ERROR
  2564                       MOVE -1           TO  REPLYL
  2565                       MOVE AL-UABON     TO  REPLYA
  2566                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2567                   ELSE
  2568                       MOVE AL-UANON     TO  REPLYA
  2569                       MOVE +1           TO  W-UPDATE-SW
  2570                       MOVE DC-BIN-DATE-1 TO W-RECEIVED-DATE
  2571                       MOVE DC-GREG-DATE-1-EDIT TO
  2572                                        W-CERT-NOTE-RECV-DT
  2573                   END-IF
  2574                 END-IF
  2575             ELSE
  2576                 MOVE ER-9245    TO  EMI-ERROR
  2577                 MOVE -1         TO  REPLYL
  2578                 MOVE AL-UABON   TO  REPLYA
  2579                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2580             END-IF
  2581         END-IF
  2582     END-IF.
  2583
  2584     IF STOPDTEL GREATER ZERO
  2585         IF STOPDTEI = SPACES
  2586             MOVE AL-UANON       TO  STOPDTEA
  2587             MOVE +1             TO  W-UPDATE-SW
  2588             MOVE LOW-VALUES     TO  W-STOP-LETTER-DATE
  2589             MOVE SPACES         TO  PI-ARCHIVE-STOPPED
  2590             MOVE AL-UANOF       TO  RESENDA
  2591                                     RESFORMA
  2592                                     FINDATEA
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  53
* EL691.cbl
  2593                                     FINLACTA
  2594                                     REPLYA
  2595                                     COMMENTA
  2596         ELSE
  2597             MOVE 'Y'            TO  PI-ARCHIVE-STOPPED
  2598             MOVE 'Y'            TO  W-NEED-COMMENT
  2599             MOVE STOPDTEI       TO  W-DEEDIT-FIELD
  2600             PERFORM 8600-DEEDIT THRU 8600-EXIT
  2601             IF W-DEEDIT-FIELD-V0 IS NUMERIC
  2602                 MOVE W-DEEDIT-FIELD-V0  TO  STOPDTEO
  2603                 INSPECT STOPDTEI CONVERTING SPACES TO SLASH
  2604                 MOVE '4'        TO  DC-OPTION-CODE
  2605                 MOVE W-DEEDIT-FIELD-V0  TO  DC-GREG-DATE-1-MDY
  2606                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2607                 IF DC-ERROR-CODE NOT = SPACES
  2608                     MOVE ER-0897         TO  EMI-ERROR
  2609                     MOVE -1              TO  STOPDTEL
  2610                     MOVE AL-UABON        TO  STOPDTEA
  2611                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2612                 ELSE
  2613                   IF DC-BIN-DATE-1 GREATER THAN W-SAVE-BIN-DATE
  2614                       MOVE ER-0895      TO  EMI-ERROR
  2615                       MOVE -1           TO  STOPDTEL
  2616                       MOVE AL-UABON     TO  STOPDTEA
  2617                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2618                   ELSE
  2619                     MOVE AL-UANON       TO  STOPDTEA
  2620                     MOVE +1             TO  W-UPDATE-SW
  2621                     MOVE DC-BIN-DATE-1  TO  W-STOP-LETTER-DATE
  2622                   END-IF
  2623                 END-IF
  2624             ELSE
  2625                 MOVE ER-0897    TO  EMI-ERROR
  2626                 MOVE -1         TO  STOPDTEL
  2627                 MOVE AL-UABON   TO  STOPDTEA
  2628                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2629             END-IF
  2630         END-IF
  2631     END-IF.
  2632
  2633     IF W-NEED-COMMENT = 'Y'  AND
  2634        COMMENTL NOT > ZERO
  2635           MOVE -1         TO  COMMENTL
  2636           MOVE ER-7363    TO  EMI-ERROR
  2637           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2638     END-IF.
  2639
  2640     IF COMMENTL GREATER ZERO
  2641      OR  RESFORML GREATER ZERO
  2642      OR  FINLACTL GREATER ZERO
  2643         MOVE +1          TO  W-UPDATE-SW
  2644     END-IF.
  2645
  2646     IF W-ERROR-COUNT GREATER ZERO
  2647         GO TO 8200-SEND-DATAONLY
  2648     END-IF.
  2649
  2650     IF W-UPDATE-SW NOT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  54
* EL691.cbl
  2651         MOVE ER-3112    TO  EMI-ERROR
  2652         MOVE -1         TO  MAINTL
  2653         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2654         GO TO 8200-SEND-DATAONLY
  2655     END-IF.
  2656
  2657     IF PI-ARCHIVE-STOPPED = 'Y'
  2658        MOVE AL-SANOF       TO RESENDA
  2659                               RESFORMA
  2660                               FINDATEA
  2661                               FINLACTA
  2662                               REPLYA
  2663                               COMMENTA
  2664     END-IF.
  2665
  2666     PERFORM 3000-READ-FOR-UPDATE THRU 3000-EXIT.
  2667
  2668     IF RESENDL GREATER ZERO
  2669         MOVE W-RESEND-DATE      TO  LA-RESEND-DATE
  2670     END-IF.
  2671
  2672     IF FINDATEL GREATER ZERO
  2673         MOVE W-FINAL-ACT-DATE   TO  LA-FINAL-ACT-DATE
  2674     END-IF.
  2675
  2676     IF REPLYL GREATER ZERO
  2677         MOVE W-RECEIVED-DATE    TO  LA-REPLY-DATE
  2678         IF W-RECEIVED-DATE NOT EQUAL LOW-VALUES
  2679             PERFORM 4000-ADD-CERT-NOTE THRU 4099-EXIT
  2680         END-IF
  2681     END-IF.
  2682
  2683     IF RESFORML GREATER ZERO
  2684        MOVE RESFORMI            TO  LA-RESEND-LETR
  2685     END-IF.
  2686
  2687     IF FINLACTL GREATER ZERO
  2688        MOVE FINLACTI            TO  LA-FINAL-ACT-IND
  2689     END-IF.
  2690
  2691     IF STOPDTEL GREATER ZERO
  2692        MOVE W-STOP-LETTER-DATE  TO  LA-VOIDED-DATE
  2693     END-IF.
  2694
  2695     PERFORM 3100-REWRITE THRU 3100-EXIT.
  2696
  2697     IF COMMENTL NOT GREATER ZERO
  2698
  2699         MOVE ER-0000            TO  EMI-ERROR
  2700         MOVE ' '                TO  MAINTO
  2701         MOVE -1                 TO  MAINTL
  2702         MOVE AL-UANOF           TO  MAINTA
  2703         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2704         GO TO 1000-SHOW
  2705     END-IF.
  2706
  2707     PERFORM 3200-READ-ARCT-FOR-UPDATE THRU 3200-EXIT.
  2708
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  55
* EL691.cbl
  2709     IF PI-COMMENT-INDEX EQUAL +20
  2710         MOVE ER-0051    TO  EMI-ERROR
  2711         MOVE -1         TO  MAINTL
  2712         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2713         GO TO 8200-SEND-DATAONLY
  2714     END-IF
  2715
  2716     SET PI-COMMENT-INDEX UP BY +1.
  2717     SET LC-NDX TO PI-COMMENT-INDEX.
  2718     MOVE COMMENTI        TO  LT-COMMENT-LINE (LC-NDX).
  2719     MOVE W-SAVE-BIN-DATE TO  LT-COMMENT-CHG-DT (LC-NDX).
  2720     MOVE PI-PROCESSOR-ID TO  LT-COMMENT-CHG-BY (LC-NDX).
  2721     ADD +1               TO  LT-NUM-LINES-ON-RECORD.
  2722
  2723
  2724     IF W-ADD-ARCT = 'N'
  2725         PERFORM 3300-REWRITE-ARCT THRU 3300-EXIT
  2726     ELSE
  2727         PERFORM 3350-INSERT-ARCT THRU 3350-EXIT
  2728     END-IF.
  2729
  2730
  2731     MOVE ER-0000                TO  EMI-ERROR.
  2732     MOVE ' '                    TO  MAINTO.
  2733     MOVE -1                     TO  MAINTL.
  2734     MOVE AL-UANOF               TO  MAINTA.
  2735     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2736     GO TO 1000-SHOW.
  2737
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  56
* EL691.cbl
  2739
  2740 1000-SHOW.
  2741***************************************************************
  2742*     THIS ROUTINE WILL READ THE ARCHIVE FILE WITH THE        *
  2743*     ARCHIVE NUMBER SPECIFIED FROM THE PRIOR SCREEN.         *
  2744***************************************************************
  2745     MOVE LOW-VALUES              TO W-ARCT-KEY.
  2746     MOVE PI-COMPANY-CD           TO W-ARCH-COMPANY-CD
  2747                                     W-ARCT-COMPANY-CD.
  2748     MOVE PI-689-ARCHIVE-NUMBER   TO W-ARCH-NUMBER
  2749                                     W-ARCT-ARCHIVE-NO.
  2750     MOVE '3'                     TO W-ARCT-RECORD-TYPE.
  2751     MOVE +0                      TO W-ARCT-LINE-SEQ-NO.
  2752
  2753
  2754* EXEC CICS HANDLE CONDITION
  2755*         NOTOPEN    (8010-ARCH-NOT-OPEN)
  2756*         NOTFND     (1070-ARCH-NOT-FOUND)
  2757*         ENDFILE    (1070-ARCH-NOT-FOUND)
  2758*    END-EXEC.
  2759*    MOVE '"$JI''                 ! $ #00002716' TO DFHEIV0
  2760     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  2761     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2762     MOVE X'2420233030303032373136' TO DFHEIV0(25:11)
  2763     CALL 'kxdfhei1' USING DFHEIV0
  2764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2765
  2766
  2767
  2768* EXEC CICS READ
  2769*        DATASET (W-ARCH-FILE-ID)
  2770*        SET     (ADDRESS OF LETTER-ARCHIVE)
  2771*        RIDFLD  (W-ARCH-KEY)
  2772*    END-EXEC.
  2773*    MOVE '&"S        E          (   #00002722' TO DFHEIV0
  2774     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2775     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2776     MOVE X'2020233030303032373232' TO DFHEIV0(25:11)
  2777     CALL 'kxdfhei1' USING DFHEIV0,
  2778           W-ARCH-FILE-ID,
  2779           DFHEIV20,
  2780           DFHEIV99,
  2781           W-ARCH-KEY,
  2782           DFHEIV99,
  2783           DFHEIV99,
  2784           DFHEIV99
  2785     SET ADDRESS OF LETTER-ARCHIVE TO
  2786         DFHEIV20
  2787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2788
  2789
  2790     MOVE LA-FORM-A3             TO FORMNOO.
  2791     MOVE LA-ARCHIVE-NO          TO ARCHNOO.
  2792     MOVE LA-CARRIER-A2          TO CARRIERO.
  2793     MOVE LA-GROUPING-A2         TO GROUPO.
  2794     MOVE LA-STATE-A2            TO STATEO.
  2795     MOVE LA-ACCOUNT-A2          TO ACCTO.
  2796     MOVE LA-CERT-PRIME-A2       TO CERTO.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  57
* EL691.cbl
  2797     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
  2798
  2799     IF LA-ENDT-ARCH-NO-X EQUAL LOW-VALUES OR SPACES
  2800          MOVE SPACES            TO ENDARCHO
  2801     ELSE
  2802          MOVE LA-ENDT-ARCH-NO   TO ENDARCHO
  2803     END-IF
  2804
  2805     IF  LA-CREATION-DATE EQUAL LOW-VALUES OR SPACES
  2806         MOVE SPACES             TO CREATDTI
  2807     ELSE
  2808         MOVE LA-CREATION-DATE   TO DC-BIN-DATE-1
  2809         MOVE ' '                TO DC-OPTION-CODE
  2810         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2811         MOVE DC-GREG-DATE-1-EDIT TO CREATDTI
  2812     END-IF.
  2813
  2814     MOVE LA-PROCESSOR-CD        TO CREATBYI.
  2815
  2816     IF  LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES OR SPACES
  2817         MOVE SPACES             TO PRINTDTI
  2818     ELSE
  2819         MOVE LA-INITIAL-PRINT-DATE TO DC-BIN-DATE-1
  2820         MOVE ' '                TO DC-OPTION-CODE
  2821         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2822         MOVE DC-GREG-DATE-1-EDIT TO PRINTDTI
  2823     END-IF.
  2824
  2825     IF  LA-RESEND-DATE = LOW-VALUES OR SPACES
  2826         MOVE SPACES             TO RESENDI
  2827     ELSE
  2828         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
  2829         MOVE ' '                TO DC-OPTION-CODE
  2830         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2831         MOVE DC-GREG-DATE-1-EDIT TO RESENDI
  2832     END-IF.
  2833
  2834     MOVE LA-RESEND-LETR         TO RESFORMI.
  2835
  2836     IF  LA-SENT-DATE = LOW-VALUES OR SPACES
  2837         MOVE SPACES             TO RESPRNTI
  2838         MOVE SPACES             TO PI-ARCHIVE-COMPLETE
  2839     ELSE
  2840         MOVE 'Y'                TO PI-ARCHIVE-COMPLETE
  2841         MOVE LA-SENT-DATE     TO DC-BIN-DATE-1
  2842         MOVE ' '                TO DC-OPTION-CODE
  2843         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2844         MOVE DC-GREG-DATE-1-EDIT TO RESPRNTI
  2845     END-IF.
  2846
  2847     IF  LA-FINAL-ACT-DATE EQUAL LOW-VALUES OR SPACES
  2848         MOVE SPACES             TO FINDATEI
  2849         MOVE SPACES             TO PI-ARCHIVE-FINAL
  2850     ELSE
  2851         MOVE 'Y'                TO PI-ARCHIVE-FINAL
  2852         MOVE LA-FINAL-ACT-DATE  TO DC-BIN-DATE-1
  2853         MOVE ' '                TO DC-OPTION-CODE
  2854         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  58
* EL691.cbl
  2855         MOVE DC-GREG-DATE-1-EDIT TO FINDATEI
  2856     END-IF.
  2857
  2858     MOVE LA-FINAL-ACT-IND       TO FINLACTI.
  2859
  2860     IF  LA-REPLY-DATE = LOW-VALUES OR SPACES
  2861         MOVE SPACES             TO REPLYI
  2862         MOVE SPACES             TO PI-ARCHIVE-RECEIVED
  2863     ELSE
  2864         MOVE 'Y'                TO PI-ARCHIVE-RECEIVED
  2865         MOVE LA-REPLY-DATE      TO DC-BIN-DATE-1
  2866         MOVE ' '                TO DC-OPTION-CODE
  2867         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2868         MOVE DC-GREG-DATE-1-EDIT TO REPLYI
  2869     END-IF.
  2870
  2871     IF  LA-VOIDED-DATE = LOW-VALUES OR SPACES
  2872         MOVE SPACES             TO STOPDTEI
  2873         MOVE SPACES             TO PI-ARCHIVE-STOPPED
  2874     ELSE
  2875         MOVE 'Y'                TO PI-ARCHIVE-STOPPED
  2876         MOVE LA-VOIDED-DATE     TO DC-BIN-DATE-1
  2877         MOVE ' '                TO DC-OPTION-CODE
  2878         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2879         MOVE DC-GREG-DATE-1-EDIT TO STOPDTEI
  2880     END-IF.
  2881
  2882     IF LA-LAST-MAINT-DATE = LOW-VALUES OR SPACES
  2883         MOVE SPACES             TO MAINTDTI
  2884     ELSE
  2885         MOVE LA-LAST-MAINT-DATE TO DC-BIN-DATE-1
  2886         MOVE ' '                TO DC-OPTION-CODE
  2887         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  2888         MOVE DC-GREG-DATE-1-EDIT TO MAINTDTI
  2889     END-IF.
  2890
  2891     IF LA-LAST-MAINT-TIMEX = LOW-VALUES OR SPACES
  2892         MOVE ZEROES             TO MAINTTMO
  2893     ELSE
  2894         MOVE LA-LAST-MAINT-TIME TO W-TIME-IN
  2895         MOVE W-TIME-OUT         TO MAINTTMO
  2896     END-IF.
  2897
  2898     MOVE LA-LAST-UPDATED-BY     TO MAINTBYI.
  2899
  2900     IF (LA-SENT-DATE NOT EQUAL LOW-VALUES AND SPACES)
  2901       OR (LA-VOIDED-DATE  NOT EQUAL LOW-VALUES AND SPACES)
  2902          MOVE AL-SANOF          TO RESENDA
  2903                                    RESFORMA
  2904                                    FINDATEA
  2905                                    FINLACTA
  2906                                    REPLYA
  2907                                    COMMENTA
  2908     END-IF.
  2909
  2910     IF LA-SENT-DATE NOT EQUAL LOW-VALUES AND SPACES
  2911         MOVE AL-SANOF           TO STOPDTEA
  2912     END-IF.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  59
* EL691.cbl
  2913
  2914
  2915* EXEC CICS HANDLE CONDITION
  2916*         NOTOPEN    (8015-ARCT-NOT-OPEN)
  2917*         NOTFND     (1000-ARCT-NOT-FOUND)
  2918*         ENDFILE    (1000-ARCT-NOT-FOUND)
  2919*    END-EXEC.
  2920*    MOVE '"$JI''                 ! % #00002852' TO DFHEIV0
  2921     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  2922     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2923     MOVE X'2520233030303032383532' TO DFHEIV0(25:11)
  2924     CALL 'kxdfhei1' USING DFHEIV0
  2925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2926
  2927
  2928
  2929* EXEC CICS READ
  2930*        DATASET  (W-ARCT-FILE-ID)
  2931*        SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  2932*        RIDFLD   (W-ARCT-KEY)
  2933*    END-EXEC.
  2934*    MOVE '&"S        E          (   #00002858' TO DFHEIV0
  2935     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2936     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2937     MOVE X'2020233030303032383538' TO DFHEIV0(25:11)
  2938     CALL 'kxdfhei1' USING DFHEIV0,
  2939           W-ARCT-FILE-ID,
  2940           DFHEIV20,
  2941           DFHEIV99,
  2942           W-ARCT-KEY,
  2943           DFHEIV99,
  2944           DFHEIV99,
  2945           DFHEIV99
  2946     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  2947         DFHEIV20
  2948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2949
  2950
  2951     SET LC-NDX TO W-ZEROS.
  2952     PERFORM 20 TIMES
  2953         SET LC-NDX UP BY +1
  2954         IF LT-COMMENT-LINE (LC-NDX) > SPACES
  2955             MOVE LT-COMMENT-LINE (LC-NDX) TO COMMENTI
  2956             SET PI-COMMENT-INDEX TO LC-NDX
  2957         END-IF
  2958     END-PERFORM.
  2959
  2960     MOVE -1                     TO MAINTL.
  2961     GO TO 8100-SEND-INITIAL-MAP.
  2962
  2963 1000-ARCT-NOT-FOUND.
  2964
  2965     SET PI-COMMENT-INDEX        TO W-ZEROS.
  2966     MOVE -1                     TO MAINTL.
  2967     GO TO 8100-SEND-INITIAL-MAP.
  2968
  2969 1000-EXIT.
  2970     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  60
* EL691.cbl
  2971
  2972
  2973 1070-ARCH-NOT-FOUND.
  2974
  2975     MOVE ER-7371                TO EMI-ERROR.
  2976     MOVE -1                     TO ARCHNOL.
  2977     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2978     GO TO 8100-SEND-INITIAL-MAP.
  2979
  2980
  2981 3000-READ-FOR-UPDATE SECTION.
  2982
  2983
  2984* EXEC CICS HANDLE CONDITION
  2985*         NOTOPEN    (8010-ARCH-NOT-OPEN)
  2986*         NOTFND     (1070-ARCH-NOT-FOUND)
  2987*         ENDFILE    (1070-ARCH-NOT-FOUND)
  2988*    END-EXEC.
  2989*    MOVE '"$JI''                 ! & #00002896' TO DFHEIV0
  2990     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  2991     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2992     MOVE X'2620233030303032383936' TO DFHEIV0(25:11)
  2993     CALL 'kxdfhei1' USING DFHEIV0
  2994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2995
  2996
  2997     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
  2998     MOVE PI-689-ARCHIVE-NUMBER TO W-ARCH-NUMBER
  2999
  3000
  3001* EXEC CICS READ
  3002*        DATASET (W-ARCH-FILE-ID)
  3003*        SET     (ADDRESS OF LETTER-ARCHIVE)
  3004*        RIDFLD  (W-ARCH-KEY)
  3005*        UPDATE
  3006*    END-EXEC.
  3007*    MOVE '&"S        EU         (   #00002905' TO DFHEIV0
  3008     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3009     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3010     MOVE X'2020233030303032393035' TO DFHEIV0(25:11)
  3011     CALL 'kxdfhei1' USING DFHEIV0,
  3012           W-ARCH-FILE-ID,
  3013           DFHEIV20,
  3014           DFHEIV99,
  3015           W-ARCH-KEY,
  3016           DFHEIV99,
  3017           DFHEIV99,
  3018           DFHEIV99
  3019     SET ADDRESS OF LETTER-ARCHIVE TO
  3020         DFHEIV20
  3021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3022
  3023
  3024 3000-EXIT.
  3025     EXIT.
  3026
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  61
* EL691.cbl
  3028
  3029 3100-REWRITE SECTION.
  3030
  3031     MOVE PI-PROCESSOR-ID        TO  LA-LAST-UPDATED-BY
  3032                                     MAINTBYI.
  3033     MOVE W-SAVE-BIN-DATE        TO  LA-LAST-MAINT-DATE.
  3034     MOVE W-SAVE-DATE            TO  MAINTDTI.
  3035
  3036     MOVE EIBTIME                TO  LA-LAST-MAINT-TIME
  3037                                     W-TIME-IN.
  3038     MOVE W-TIME-OUT             TO  MAINTTMO.
  3039
  3040
  3041* EXEC CICS REWRITE
  3042*        DATASET (W-ARCH-FILE-ID)
  3043*        FROM    (LETTER-ARCHIVE)
  3044*    END-EXEC.
  3045     MOVE LENGTH OF
  3046      LETTER-ARCHIVE
  3047       TO DFHEIV11
  3048*    MOVE '&& L                  %   #00002928' TO DFHEIV0
  3049     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3050     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3051     MOVE X'2020233030303032393238' TO DFHEIV0(25:11)
  3052     CALL 'kxdfhei1' USING DFHEIV0,
  3053           W-ARCH-FILE-ID,
  3054           LETTER-ARCHIVE,
  3055           DFHEIV11,
  3056           DFHEIV99
  3057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3058
  3059
  3060 3100-EXIT.
  3061     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  62
* EL691.cbl
  3063 3200-READ-ARCT-FOR-UPDATE  SECTION.
  3064
  3065
  3066* EXEC CICS HANDLE CONDITION
  3067*         NOTFND     (3200-NOT-FOUND)
  3068*         ENDFILE    (3200-NOT-FOUND)
  3069*    END-EXEC.
  3070*    MOVE '"$I''                  ! '' #00002938' TO DFHEIV0
  3071     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  3072     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3073     MOVE X'2720233030303032393338' TO DFHEIV0(25:11)
  3074     CALL 'kxdfhei1' USING DFHEIV0
  3075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3076
  3077
  3078     MOVE PI-COMPANY-CD TO W-ARCT-COMPANY-CD.
  3079     MOVE PI-689-ARCHIVE-NUMBER TO W-ARCT-ARCHIVE-NO.
  3080     MOVE '3'                   TO W-ARCT-RECORD-TYPE.
  3081     MOVE +0                    TO W-ARCT-LINE-SEQ-NO.
  3082
  3083
  3084* EXEC CICS READ
  3085*        DATASET  (W-ARCT-FILE-ID)
  3086*        SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  3087*        RIDFLD   (W-ARCT-KEY)
  3088*        UPDATE
  3089*    END-EXEC.
  3090*    MOVE '&"S        EU         (   #00002948' TO DFHEIV0
  3091     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3092     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3093     MOVE X'2020233030303032393438' TO DFHEIV0(25:11)
  3094     CALL 'kxdfhei1' USING DFHEIV0,
  3095           W-ARCT-FILE-ID,
  3096           DFHEIV20,
  3097           DFHEIV99,
  3098           W-ARCT-KEY,
  3099           DFHEIV99,
  3100           DFHEIV99,
  3101           DFHEIV99
  3102     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  3103         DFHEIV20
  3104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3105
  3106
  3107     MOVE 'N' TO W-ADD-ARCT.
  3108     GO TO 3200-EXIT.
  3109
  3110 3200-NOT-FOUND.
  3111
  3112
  3113* EXEC CICS GETMAIN
  3114*         SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  3115*         LENGTH   (W-ARCT-LENGTH)
  3116*    END-EXEC.
  3117*    MOVE '," L                  $   #00002960' TO DFHEIV0
  3118     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  3119     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3120     MOVE X'2020233030303032393630' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  63
* EL691.cbl
  3121     CALL 'kxdfhei1' USING DFHEIV0,
  3122           DFHEIV20,
  3123           W-ARCT-LENGTH,
  3124           DFHEIV99
  3125     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  3126         DFHEIV20
  3127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3128
  3129
  3130     MOVE 'Y'                    TO W-ADD-ARCT.
  3131     MOVE LOW-VALUES             TO LETTER-ARCHIVE-TEXT.
  3132     MOVE 'LT'                   TO LT-RECORD-ID.
  3133     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
  3134     MOVE PI-689-ARCHIVE-NUMBER  TO LT-ARCHIVE-NO.
  3135     MOVE '3'                    TO LT-RECORD-TYPE.
  3136     MOVE +0                     TO LT-LINE-SEQ-NO.
  3137     MOVE +0                     TO LT-NUM-LINES-ON-RECORD.
  3138     SET PI-COMMENT-INDEX        TO W-ZEROS.
  3139
  3140 3200-EXIT.
  3141     EXIT.
  3142
  3143 3300-REWRITE-ARCT SECTION.
  3144
  3145
  3146* EXEC CICS REWRITE
  3147*        DATASET (W-ARCT-FILE-ID)
  3148*        FROM    (LETTER-ARCHIVE-TEXT)
  3149*    END-EXEC.
  3150     MOVE LENGTH OF
  3151      LETTER-ARCHIVE-TEXT
  3152       TO DFHEIV11
  3153*    MOVE '&& L                  %   #00002980' TO DFHEIV0
  3154     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3155     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3156     MOVE X'2020233030303032393830' TO DFHEIV0(25:11)
  3157     CALL 'kxdfhei1' USING DFHEIV0,
  3158           W-ARCT-FILE-ID,
  3159           LETTER-ARCHIVE-TEXT,
  3160           DFHEIV11,
  3161           DFHEIV99
  3162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3163
  3164
  3165 3300-EXIT.
  3166     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  64
* EL691.cbl
  3168
  3169 3350-INSERT-ARCT SECTION.
  3170
  3171* EXEC CICS WRITE
  3172*         DATASET   (W-ARCT-FILE-ID)
  3173*         FROM      (LETTER-ARCHIVE-TEXT)
  3174*         RIDFLD    (LT-CONTROL-PRIMARY)
  3175*    END-EXEC.
  3176     MOVE LENGTH OF
  3177      LETTER-ARCHIVE-TEXT
  3178       TO DFHEIV11
  3179*    MOVE '&$ L                  ''   #00002990' TO DFHEIV0
  3180     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3181     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3182     MOVE X'2020233030303032393930' TO DFHEIV0(25:11)
  3183     CALL 'kxdfhei1' USING DFHEIV0,
  3184           W-ARCT-FILE-ID,
  3185           LETTER-ARCHIVE-TEXT,
  3186           DFHEIV11,
  3187           LT-CONTROL-PRIMARY,
  3188           DFHEIV99,
  3189           DFHEIV99
  3190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3191
  3192
  3193 3350-EXIT.
  3194     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  65
* EL691.cbl
  3196
  3197
  3198 4000-ADD-CERT-NOTE  SECTION.
  3199
  3200     MOVE SPACES                 TO  ERCNOT-KEY
  3201                                     ELCERT-KEY.
  3202
  3203     MOVE PI-COMPANY-CD          TO  ERCNOT-COMPANY-CD
  3204                                     ELCERT-COMPANY-CD.
  3205     MOVE PI-CARRIER             TO  ERCNOT-CARRIER
  3206                                     ELCERT-CARRIER.
  3207     MOVE PI-GROUPING            TO  ERCNOT-GROUPING
  3208                                     ELCERT-GROUPING.
  3209     MOVE PI-STATE               TO  ERCNOT-STATE
  3210                                     ELCERT-STATE.
  3211     MOVE PI-ACCOUNT             TO  ERCNOT-ACCOUNT
  3212                                     ELCERT-ACCOUNT.
  3213     MOVE PI-CERT-EFF-DT         TO  ERCNOT-EFF-DT
  3214                                     ELCERT-EFF-DT.
  3215     MOVE PI-CERT-PRIME          TO  ERCNOT-CERT-PRIME
  3216                                     ELCERT-CERT-PRIME.
  3217     MOVE PI-CERT-SFX            TO  ERCNOT-CERT-SFX
  3218                                     ELCERT-CERT-SFX.
  3219     MOVE '1'                    TO  ERCNOT-REC-TYP
  3220     MOVE ZEROS                  TO  ERCNOT-SEQ.
  3221     MOVE ERCNOT-KEY             TO  SV-PRIOR-KEY.
  3222
  3223
  3224
  3225* EXEC CICS HANDLE CONDITION
  3226*         NOTFND(4010-ENDBR)
  3227*         ENDFILE(4010-ENDBR)
  3228*    END-EXEC.
  3229*    MOVE '"$I''                  ! ( #00003027' TO DFHEIV0
  3230     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  3231     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3232     MOVE X'2820233030303033303237' TO DFHEIV0(25:11)
  3233     CALL 'kxdfhei1' USING DFHEIV0
  3234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3235
  3236
  3237
  3238* EXEC CICS STARTBR
  3239*         DATASET(ERCNOT-FILE-ID)
  3240*         RIDFLD(ERCNOT-KEY)
  3241*         KEYLENGTH(ERCNOT-START-LENGTH)
  3242*         GENERIC
  3243*         GTEQ
  3244*    END-EXEC.
  3245     MOVE 0
  3246       TO DFHEIV11
  3247*    MOVE '&,   KG    G          &   #00003032' TO DFHEIV0
  3248     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  3249     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3250     MOVE X'2020233030303033303332' TO DFHEIV0(25:11)
  3251     CALL 'kxdfhei1' USING DFHEIV0,
  3252           ERCNOT-FILE-ID,
  3253           ERCNOT-KEY,
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  66
* EL691.cbl
  3254           ERCNOT-START-LENGTH,
  3255           DFHEIV11,
  3256           DFHEIV99
  3257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3258
  3259
  3260 4001-LOOP.
  3261
  3262* EXEC CICS READNEXT
  3263*         SET(ADDRESS OF CERT-NOTE-FILE)
  3264*         DATASET(ERCNOT-FILE-ID)
  3265*         RIDFLD(ERCNOT-KEY)
  3266*    END-EXEC.
  3267     MOVE 0
  3268       TO DFHEIV11
  3269*    MOVE '&.S                   )   #00003041' TO DFHEIV0
  3270     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3271     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3272     MOVE X'2020233030303033303431' TO DFHEIV0(25:11)
  3273     CALL 'kxdfhei1' USING DFHEIV0,
  3274           ERCNOT-FILE-ID,
  3275           DFHEIV20,
  3276           DFHEIV99,
  3277           ERCNOT-KEY,
  3278           DFHEIV99,
  3279           DFHEIV11,
  3280           DFHEIV99,
  3281           DFHEIV99
  3282     SET ADDRESS OF CERT-NOTE-FILE TO
  3283         DFHEIV20
  3284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3285
  3286
  3287     IF CZ-COMPANY-CD NOT = SV-COMPANY-CD
  3288         GO TO 4010-ENDBR
  3289     END-IF.
  3290
  3291     IF (CZ-CARRIER = SV-CARRIER)
  3292        AND (CZ-GROUPING = SV-GROUPING)
  3293        AND (CZ-STATE = SV-STATE)
  3294        AND (CZ-ACCOUNT = SV-ACCOUNT)
  3295        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  3296        AND (CZ-CERT-NO = SV-CERT-NO)
  3297        AND (CZ-RECORD-TYPE = SV-REC-TYP)
  3298          MOVE CZ-NOTE-SEQUENCE TO SV-NOTE-SEQUENCE
  3299          GO TO 4001-LOOP
  3300     END-IF.
  3301
  3302 4010-ENDBR.
  3303
  3304
  3305* EXEC CICS ENDBR
  3306*         DATASET(ERCNOT-FILE-ID)
  3307*    END-EXEC.
  3308     MOVE 0
  3309       TO DFHEIV11
  3310*    MOVE '&2                    $   #00003064' TO DFHEIV0
  3311     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  67
* EL691.cbl
  3312     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3313     MOVE X'2020233030303033303634' TO DFHEIV0(25:11)
  3314     CALL 'kxdfhei1' USING DFHEIV0,
  3315           ERCNOT-FILE-ID,
  3316           DFHEIV11,
  3317           DFHEIV99
  3318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3319
  3320
  3321     MOVE SV-PRIOR-KEY           TO  ERCNOT-KEY.
  3322     MOVE SPACES                 TO  CERT-NOTE-FILE.
  3323     ADD 1                       TO  ERCNOT-SEQ.
  3324     MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY.
  3325     MOVE  'CZ'                  TO  CZ-RECORD-ID.
  3326     MOVE W-CERT-NOTE-MSG        TO  CZ-NOTE.
  3327     MOVE PI-PROCESSOR-ID        TO  CZ-LAST-MAINT-USER.
  3328     MOVE W-SAVE-BIN-DATE        TO  CZ-LAST-MAINT-DT.
  3329     MOVE EIBTIME                TO  CZ-LAST-MAINT-HHMMSS.
  3330
  3331
  3332* EXEC CICS WRITE
  3333*         DATASET(ERCNOT-FILE-ID)
  3334*         FROM(CERT-NOTE-FILE)
  3335*         RIDFLD(ERCNOT-KEY)
  3336*         RESP(W-RESPONSE)
  3337*    END-EXEC.
  3338     MOVE LENGTH OF
  3339      CERT-NOTE-FILE
  3340       TO DFHEIV11
  3341*    MOVE '&$ L                  ''  N#00003078' TO DFHEIV0
  3342     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3343     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3344     MOVE X'204E233030303033303738' TO DFHEIV0(25:11)
  3345     CALL 'kxdfhei1' USING DFHEIV0,
  3346           ERCNOT-FILE-ID,
  3347           CERT-NOTE-FILE,
  3348           DFHEIV11,
  3349           ERCNOT-KEY,
  3350           DFHEIV99,
  3351           DFHEIV99
  3352     MOVE EIBRESP  TO W-RESPONSE
  3353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3354
  3355
  3356     IF RESP-NORMAL
  3357         PERFORM 4800-CERTIFICATE-UPDATE THRU 4899-EXIT
  3358     END-IF.
  3359
  3360 4099-EXIT.
  3361     EXIT.
  3362
  3363
  3364 4800-CERTIFICATE-UPDATE SECTION.
  3365
  3366
  3367* EXEC CICS HANDLE CONDITION
  3368*        NOTFND   (4899-EXIT)
  3369*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  68
* EL691.cbl
  3370*    MOVE '"$I                   ! ) #00003095' TO DFHEIV0
  3371     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3372     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3373     MOVE X'2920233030303033303935' TO DFHEIV0(25:11)
  3374     CALL 'kxdfhei1' USING DFHEIV0
  3375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3376
  3377
  3378
  3379* EXEC CICS READ
  3380*    EQUAL
  3381*    DATASET   (ELCERT-FILE-ID)
  3382*    SET       (ADDRESS OF CERTIFICATE-MASTER)
  3383*    RIDFLD    (ELCERT-KEY)
  3384*    UPDATE
  3385*    RESP      (W-RESPONSE)
  3386*    END-EXEC.
  3387*    MOVE '&"S        EU         (  N#00003099' TO DFHEIV0
  3388     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3389     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3390     MOVE X'204E233030303033303939' TO DFHEIV0(25:11)
  3391     CALL 'kxdfhei1' USING DFHEIV0,
  3392           ELCERT-FILE-ID,
  3393           DFHEIV20,
  3394           DFHEIV99,
  3395           ELCERT-KEY,
  3396           DFHEIV99,
  3397           DFHEIV99,
  3398           DFHEIV99
  3399     SET ADDRESS OF CERTIFICATE-MASTER TO
  3400         DFHEIV20
  3401     MOVE EIBRESP  TO W-RESPONSE
  3402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3403
  3404
  3405     IF RESP-NORMAL
  3406        IF CM-NOTE-SW = ' '
  3407           MOVE '1'        TO CM-NOTE-SW
  3408        ELSE
  3409           IF CM-NOTE-SW = '2'
  3410              MOVE '3'      TO CM-NOTE-SW
  3411           ELSE
  3412              IF CM-NOTE-SW = '4'
  3413                  MOVE '5'    TO CM-NOTE-SW
  3414              ELSE
  3415                 IF CM-NOTE-SW = '6'
  3416                    MOVE '7'  TO CM-NOTE-SW
  3417                 END-IF
  3418              END-IF
  3419           END-IF
  3420        END-IF
  3421
  3422* EXEC CICS REWRITE
  3423*          FROM      (CERTIFICATE-MASTER)
  3424*          DATASET   (ELCERT-FILE-ID)
  3425*       END-EXEC
  3426     MOVE LENGTH OF
  3427      CERTIFICATE-MASTER
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  69
* EL691.cbl
  3428       TO DFHEIV11
  3429*    MOVE '&& L                  %   #00003124' TO DFHEIV0
  3430     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3431     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3432     MOVE X'2020233030303033313234' TO DFHEIV0(25:11)
  3433     CALL 'kxdfhei1' USING DFHEIV0,
  3434           ELCERT-FILE-ID,
  3435           CERTIFICATE-MASTER,
  3436           DFHEIV11,
  3437           DFHEIV99
  3438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3439     END-IF.
  3440
  3441 4899-EXIT.
  3442      EXIT.
  3443
  3444
  3445
  3446 8010-ARCH-NOT-OPEN.
  3447
  3448     MOVE ER-7388                TO EMI-ERROR.
  3449     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3450     MOVE -1                     TO MAINTL.
  3451     GO TO 8200-SEND-DATAONLY.
  3452
  3453 8015-ARCT-NOT-OPEN.
  3454
  3455     MOVE ER-7373                TO EMI-ERROR.
  3456     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3457     MOVE -1                     TO MAINTL.
  3458     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  70
* EL691.cbl
  3460
  3461 8100-SEND-INITIAL-MAP.
  3462
  3463     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
  3464
  3465     IF  NOT EMI-NO-ERRORS
  3466         MOVE EMI-MESSAGE-AREA (1)
  3467                                 TO ERRMSG1O
  3468     ELSE
  3469         MOVE SPACES             TO ERRMSG1O
  3470     END-IF.
  3471
  3472
  3473* EXEC CICS SEND
  3474*        MAP    (W-MAP)
  3475*        MAPSET (W-MAPSET)
  3476*        FROM   (EL691AO)
  3477*        ERASE
  3478*        CURSOR
  3479*    END-EXEC.
  3480     MOVE LENGTH OF
  3481      EL691AO
  3482       TO DFHEIV12
  3483     MOVE -1
  3484       TO DFHEIV11
  3485*    MOVE '8$     CT  E    H L F ,   #00003161' TO DFHEIV0
  3486     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3487     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3488     MOVE X'2020233030303033313631' TO DFHEIV0(25:11)
  3489     CALL 'kxdfhei1' USING DFHEIV0,
  3490           W-MAP,
  3491           EL691AO,
  3492           DFHEIV12,
  3493           W-MAPSET,
  3494           DFHEIV99,
  3495           DFHEIV99,
  3496           DFHEIV99,
  3497           DFHEIV11,
  3498           DFHEIV99,
  3499           DFHEIV99,
  3500           DFHEIV99
  3501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3502
  3503
  3504     GO TO 9000-RETURN-TRANS.
  3505
  3506 8100-EXIT.
  3507     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  71
* EL691.cbl
  3509
  3510 8200-SEND-DATAONLY.
  3511
  3512     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
  3513
  3514     IF  NOT EMI-NO-ERRORS
  3515         MOVE EMI-MESSAGE-AREA (1)
  3516                                 TO ERRMSG1O
  3517     ELSE
  3518         MOVE SPACES             TO ERRMSG1O
  3519     END-IF.
  3520
  3521
  3522* EXEC CICS SEND
  3523*        MAP    (W-MAP)
  3524*        MAPSET (W-MAPSET)
  3525*        FROM   (EL691AO)
  3526*        DATAONLY
  3527*        CURSOR
  3528*    END-EXEC.
  3529     MOVE LENGTH OF
  3530      EL691AO
  3531       TO DFHEIV12
  3532     MOVE -1
  3533       TO DFHEIV11
  3534*    MOVE '8$D    CT       H L F ,   #00003186' TO DFHEIV0
  3535     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3536     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3537     MOVE X'2020233030303033313836' TO DFHEIV0(25:11)
  3538     CALL 'kxdfhei1' USING DFHEIV0,
  3539           W-MAP,
  3540           EL691AO,
  3541           DFHEIV12,
  3542           W-MAPSET,
  3543           DFHEIV99,
  3544           DFHEIV99,
  3545           DFHEIV99,
  3546           DFHEIV11,
  3547           DFHEIV99,
  3548           DFHEIV99,
  3549           DFHEIV99
  3550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3551
  3552
  3553     GO TO 9000-RETURN-TRANS.
  3554
  3555 8200-EXIT.
  3556     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  72
* EL691.cbl
  3558
  3559 8300-SEND-TEXT.
  3560
  3561
  3562* EXEC CICS SEND TEXT
  3563*        FROM    (LOGOFF-TEXT)
  3564*        LENGTH  (LOGOFF-LENGTH)
  3565*        ERASE
  3566*        FREEKB
  3567*    END-EXEC.
  3568*    MOVE '8&      T  E F  H   F -   #00003202' TO DFHEIV0
  3569     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3570     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3571     MOVE X'2020233030303033323032' TO DFHEIV0(25:11)
  3572     CALL 'kxdfhei1' USING DFHEIV0,
  3573           LOGOFF-TEXT,
  3574           LOGOFF-LENGTH,
  3575           DFHEIV99,
  3576           DFHEIV99,
  3577           DFHEIV99,
  3578           DFHEIV99,
  3579           DFHEIV99,
  3580           DFHEIV99,
  3581           DFHEIV99,
  3582           DFHEIV99,
  3583           DFHEIV99,
  3584           DFHEIV99
  3585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3586
  3587
  3588     GO TO 9000-RETURN-TRANS.
  3589
  3590 8300-EXIT.
  3591     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  73
* EL691.cbl
  3593
  3594 8600-DEEDIT.
  3595
  3596
  3597* EXEC CICS BIF DEEDIT
  3598*         FIELD    (W-DEEDIT-FIELD)
  3599*         LENGTH   (15)
  3600*    END-EXEC.
  3601     MOVE 15
  3602       TO DFHEIV11
  3603*    MOVE '@"L                   #   #00003217' TO DFHEIV0
  3604     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3605     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3606     MOVE X'2020233030303033323137' TO DFHEIV0(25:11)
  3607     CALL 'kxdfhei1' USING DFHEIV0,
  3608           W-DEEDIT-FIELD,
  3609           DFHEIV11
  3610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3611
  3612
  3613 8600-EXIT.
  3614     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  74
* EL691.cbl
  3616
  3617 9000-RETURN-TRANS.
  3618
  3619     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
  3620     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
  3621
  3622* EXEC CICS RETURN
  3623*        TRANSID    (W-TRANSACTION)
  3624*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3625*        LENGTH     (PI-COMM-LENGTH)
  3626*    END-EXEC.
  3627*    MOVE '.(CT                  ''   #00003230' TO DFHEIV0
  3628     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3629     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3630     MOVE X'2020233030303033323330' TO DFHEIV0(25:11)
  3631     CALL 'kxdfhei1' USING DFHEIV0,
  3632           W-TRANSACTION,
  3633           PROGRAM-INTERFACE-BLOCK,
  3634           PI-COMM-LENGTH,
  3635           DFHEIV99,
  3636           DFHEIV99,
  3637           DFHEIV99
  3638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3639
  3640
  3641 9000-EXIT.
  3642     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  75
* EL691.cbl
  3644
  3645 9200-PA.
  3646
  3647     MOVE ER-7008                TO EMI-ERROR.
  3648     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3649     MOVE -1                     TO MAINTL.
  3650     GO TO 8200-SEND-DATAONLY.
  3651
  3652 9200-EXIT.
  3653     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  76
* EL691.cbl
  3655
  3656 9300-DFHCLEAR.
  3657
  3658     MOVE PI-RETURN-TO-PROGRAM TO W-CALL-PGM.
  3659     GO TO 9400-XCTL.
  3660
  3661 9300-EXIT.
  3662     EXIT.
  3663
  3664 9400-XCTL.
  3665
  3666
  3667* EXEC CICS XCTL
  3668*        PROGRAM  (W-CALL-PGM)
  3669*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  3670*        LENGTH   (PI-COMM-LENGTH)
  3671*    END-EXEC.
  3672*    MOVE '.$C                   %   #00003261' TO DFHEIV0
  3673     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3674     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3675     MOVE X'2020233030303033323631' TO DFHEIV0(25:11)
  3676     CALL 'kxdfhei1' USING DFHEIV0,
  3677           W-CALL-PGM,
  3678           PROGRAM-INTERFACE-BLOCK,
  3679           PI-COMM-LENGTH,
  3680           DFHEIV99
  3681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3682
  3683
  3684 9400-EXIT.
  3685     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  77
* EL691.cbl
  3687
  3688 9500-LINK-DATE-CONVERT.
  3689
  3690
  3691* EXEC CICS LINK
  3692*        PROGRAM    ('ELDATCV')
  3693*        COMMAREA   (DATE-CONVERSION-DATA)
  3694*        LENGTH     (DC-COMM-LENGTH)
  3695*    END-EXEC.
  3696     MOVE 'ELDATCV' TO DFHEIV1
  3697*    MOVE '."C                   (   #00003273' TO DFHEIV0
  3698     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3699     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3700     MOVE X'2020233030303033323733' TO DFHEIV0(25:11)
  3701     CALL 'kxdfhei1' USING DFHEIV0,
  3702           DFHEIV1,
  3703           DATE-CONVERSION-DATA,
  3704           DC-COMM-LENGTH,
  3705           DFHEIV99,
  3706           DFHEIV99,
  3707           DFHEIV99,
  3708           DFHEIV99
  3709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3710
  3711
  3712 9500-EXIT.
  3713     EXIT.
  3714
  3715 9600-FORMAT-DATE-TIME.
  3716
  3717     MOVE W-SAVE-DATE            TO RUNDTEO.
  3718     MOVE EIBTIME                TO W-TIME-IN.
  3719     MOVE W-TIME-OUT             TO RUNTIMEO.
  3720     MOVE PI-COMPANY-ID          TO COMPANYO.
  3721     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3722     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
  3723
  3724     IF PI-ARCHIVE-COMPLETE = 'Y'
  3725        MOVE AL-SANOF           TO STCOMPA
  3726        MOVE AL-SADOF           TO STRECVA
  3727                                   STSTOPA
  3728                                   STFINLA
  3729     ELSE
  3730       IF PI-ARCHIVE-RECEIVED = 'Y'
  3731           MOVE AL-SANOF        TO STRECVA
  3732           MOVE AL-SADOF        TO STCOMPA
  3733                                   STSTOPA
  3734                                   STFINLA
  3735       ELSE
  3736         IF PI-ARCHIVE-STOPPED = 'Y'
  3737             MOVE AL-SANOF      TO STSTOPA
  3738             MOVE AL-SADOF      TO STCOMPA
  3739                                   STRECVA
  3740                                   STFINLA
  3741         ELSE
  3742           IF PI-ARCHIVE-FINAL = 'Y'
  3743               MOVE AL-SANOF    TO STFINLA
  3744               MOVE AL-SADOF    TO STCOMPA
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  78
* EL691.cbl
  3745                                   STRECVA
  3746                                   STSTOPA
  3747           ELSE
  3748               MOVE AL-SADOF    TO STCOMPA
  3749                                   STRECVA
  3750                                   STSTOPA
  3751                                   STFINLA
  3752           END-IF
  3753         END-IF
  3754       END-IF
  3755     END-IF.
  3756
  3757
  3758 9600-EXIT.
  3759     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  79
* EL691.cbl
  3761
  3762 9700-PGMID-ERROR.
  3763
  3764
  3765* EXEC CICS  HANDLE CONDITION
  3766*        PGMIDERR  (8300-SEND-TEXT)
  3767*    END-EXEC.
  3768*    MOVE '"$L                   ! * #00003331' TO DFHEIV0
  3769     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3770     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3771     MOVE X'2A20233030303033333331' TO DFHEIV0(25:11)
  3772     CALL 'kxdfhei1' USING DFHEIV0
  3773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3774
  3775
  3776     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
  3777     MOVE ' '                    TO PI-ENTRY-CD-1.
  3778     MOVE W-XCTL-005             TO W-CALL-PGM
  3779                                    LOGOFF-PGM.
  3780     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  3781
  3782     PERFORM 9400-XCTL THRU 9400-EXIT.
  3783
  3784 9700-EXIT.
  3785     EXIT.
  3786
  3787 9800-ABEND.
  3788
  3789     MOVE W-LINK-004             TO W-CALL-PGM.
  3790     MOVE DFHEIBLK               TO EMI-LINE1
  3791
  3792
  3793* EXEC CICS  LINK
  3794*        PROGRAM   (W-CALL-PGM)
  3795*        COMMAREA  (EMI-LINE1)
  3796*        LENGTH    (72)
  3797*    END-EXEC.
  3798     MOVE 72
  3799       TO DFHEIV11
  3800*    MOVE '."C                   (   #00003351' TO DFHEIV0
  3801     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3802     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3803     MOVE X'2020233030303033333531' TO DFHEIV0(25:11)
  3804     CALL 'kxdfhei1' USING DFHEIV0,
  3805           W-CALL-PGM,
  3806           EMI-LINE1,
  3807           DFHEIV11,
  3808           DFHEIV99,
  3809           DFHEIV99,
  3810           DFHEIV99,
  3811           DFHEIV99
  3812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3813
  3814
  3815     GO TO 8200-SEND-DATAONLY.
  3816
  3817 9800-EXIT.
  3818     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  80
* EL691.cbl
  3820
  3821 9900-ERROR-FORMAT.
  3822
  3823     IF  EMI-ERROR EQUAL ER-9097
  3824         NEXT SENTENCE
  3825     ELSE
  3826         IF  EMI-ERRORS-COMPLETE
  3827                 OR
  3828             EMI-ERROR EQUAL W-LAST-ERROR
  3829             GO TO 9900-EXIT
  3830     END-IF.
  3831
  3832     ADD +1  TO  W-ERROR-COUNT.
  3833     MOVE W-LINK-001             TO W-CALL-PGM.
  3834
  3835
  3836* EXEC CICS LINK
  3837*        PROGRAM    (W-CALL-PGM)
  3838*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  3839*        LENGTH     (EMI-COMM-LENGTH)
  3840*    END-EXEC.
  3841*    MOVE '."C                   (   #00003377' TO DFHEIV0
  3842     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3843     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3844     MOVE X'2020233030303033333737' TO DFHEIV0(25:11)
  3845     CALL 'kxdfhei1' USING DFHEIV0,
  3846           W-CALL-PGM,
  3847           ERROR-MESSAGE-INTERFACE-BLOCK,
  3848           EMI-COMM-LENGTH,
  3849           DFHEIV99,
  3850           DFHEIV99,
  3851           DFHEIV99,
  3852           DFHEIV99
  3853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3854
  3855
  3856     MOVE EMI-ERROR              TO W-LAST-ERROR.
  3857
  3858 9900-EXIT.
  3859     EXIT.
  3860
  3861 9905-INITIALIZE-SECURITY.
  3862******************************************************************
  3863*                                                                *
  3864*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  3865*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
  3866*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
  3867*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
  3868*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  3869*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  3870*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  3871*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
  3872*                                                                *
  3873*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
  3874*       IS ALSO PROVIDED BY THIS LOGIC.                          *
  3875*                                                                *
  3876******************************************************************
  3877
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  81
* EL691.cbl
  3878     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
  3879         MOVE 'Y'                TO PI-DISPLAY-CAP
  3880                                    PI-MODIFY-CAP
  3881     ELSE
  3882
  3883* EXEC CICS READQ TS
  3884*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  3885*            INTO   (SECURITY-CONTROL)
  3886*            LENGTH (SC-COMM-LENGTH)
  3887*            ITEM   (1)
  3888*        END-EXEC
  3889     MOVE 1
  3890       TO DFHEIV11
  3891*    MOVE '*$II   L              ''   #00003409' TO DFHEIV0
  3892     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3893     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3894     MOVE X'2020233030303033343039' TO DFHEIV0(25:11)
  3895     CALL 'kxdfhei1' USING DFHEIV0,
  3896           PI-SECURITY-TEMP-STORE-ID,
  3897           SECURITY-CONTROL,
  3898           SC-COMM-LENGTH,
  3899           DFHEIV11,
  3900           DFHEIV99,
  3901           DFHEIV99
  3902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3903         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
  3904                                 TO PI-DISPLAY-CAP
  3905         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
  3906                                 TO PI-MODIFY-CAP
  3907     END-IF.
  3908
  3909 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  82
* EL691.cbl
  3911
  3912 9995-SECURITY-VIOLATION.
  3913
  3914     MOVE EIBDATE                TO SM-JUL-DATE.
  3915     MOVE EIBTRMID               TO SM-TERMID.
  3916     MOVE W-THIS-PGM             TO SM-PGM.
  3917     MOVE EIBTIME                TO W-TIME-IN.
  3918     MOVE W-TIME-OUT             TO SM-TIME.
  3919     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
  3920
  3921
  3922* EXEC CICS LINK
  3923*         PROGRAM  ('EL003')
  3924*         COMMAREA (SECURITY-MESSAGE)
  3925*         LENGTH   (80)
  3926*    END-EXEC.
  3927     MOVE 'EL003' TO DFHEIV1
  3928     MOVE 80
  3929       TO DFHEIV11
  3930*    MOVE '."C                   (   #00003433' TO DFHEIV0
  3931     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3932     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3933     MOVE X'2020233030303033343333' TO DFHEIV0(25:11)
  3934     CALL 'kxdfhei1' USING DFHEIV0,
  3935           DFHEIV1,
  3936           SECURITY-MESSAGE,
  3937           DFHEIV11,
  3938           DFHEIV99,
  3939           DFHEIV99,
  3940           DFHEIV99,
  3941           DFHEIV99
  3942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3943
  3944
  3945 9995-EXIT.
  3946     EXIT.
  3947
  3948 9999-GOBACK.
  3949
  3950
  3951* GOBACK.
  3952     MOVE '9%                    "   ' TO DFHEIV0
  3953     MOVE 'EL691' TO DFHEIV1
  3954     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3955     GOBACK.
  3956
  3957 9999-EXIT.
  3958     EXIT.
  3959
  3960 9999-DFHBACK SECTION.
  3961     MOVE '9%                    "   ' TO DFHEIV0
  3962     MOVE 'EL691' TO DFHEIV1
  3963     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3964     GOBACK.
  3965 9999-DFHEXIT.
  3966     IF DFHEIGDJ EQUAL 0001
  3967         NEXT SENTENCE
  3968     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:21 Page  83
* EL691.cbl
  3969         GO TO 9300-DFHCLEAR,
  3970               9200-PA,
  3971               9200-PA,
  3972               9200-PA
  3973         DEPENDING ON DFHEIGDI
  3974     ELSE IF DFHEIGDJ EQUAL 3
  3975         GO TO 9700-PGMID-ERROR,
  3976               9800-ABEND
  3977         DEPENDING ON DFHEIGDI
  3978     ELSE IF DFHEIGDJ EQUAL 4
  3979         GO TO 8010-ARCH-NOT-OPEN,
  3980               1070-ARCH-NOT-FOUND,
  3981               1070-ARCH-NOT-FOUND
  3982         DEPENDING ON DFHEIGDI
  3983     ELSE IF DFHEIGDJ EQUAL 5
  3984         GO TO 8015-ARCT-NOT-OPEN,
  3985               1000-ARCT-NOT-FOUND,
  3986               1000-ARCT-NOT-FOUND
  3987         DEPENDING ON DFHEIGDI
  3988     ELSE IF DFHEIGDJ EQUAL 6
  3989         GO TO 8010-ARCH-NOT-OPEN,
  3990               1070-ARCH-NOT-FOUND,
  3991               1070-ARCH-NOT-FOUND
  3992         DEPENDING ON DFHEIGDI
  3993     ELSE IF DFHEIGDJ EQUAL 7
  3994         GO TO 3200-NOT-FOUND,
  3995               3200-NOT-FOUND
  3996         DEPENDING ON DFHEIGDI
  3997     ELSE IF DFHEIGDJ EQUAL 8
  3998         GO TO 4010-ENDBR,
  3999               4010-ENDBR
  4000         DEPENDING ON DFHEIGDI
  4001     ELSE IF DFHEIGDJ EQUAL 9
  4002         GO TO 4899-EXIT
  4003         DEPENDING ON DFHEIGDI
  4004     ELSE IF DFHEIGDJ EQUAL 10
  4005         GO TO 8300-SEND-TEXT
  4006         DEPENDING ON DFHEIGDI.
  4007     MOVE '9%                    "   ' TO DFHEIV0
  4008     MOVE 'EL691' TO DFHEIV1
  4009     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4010     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4808     Code:        9207
