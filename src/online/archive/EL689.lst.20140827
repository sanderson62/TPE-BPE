* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page   1
* EL689.cbl
* Options: int("EL689.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL689.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL689.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL689.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3
     4 PROGRAM-ID.                 EL689 .
     5*              PROGRAM CONVERTED BY
     6*              COBOL CONVERSION AID PO 5785-ABJ
     7*              CONVERSION DATE 04/20/94 15:10:07.
     8*                            VMOD=2.037
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12*DATE-COMPILED.
    13*REMARKS.    TRANSACTION - EXH3 - CREDIT LETTER WRITER.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page   2
* EL689.cbl
    14*
    15******************************************************************
    16
    17* W-FILE-USED REFERENCE LIST:
    18* (1)  ELCNTL - COMPANY
    19* (2)  ELCNTL - LIFE BENEFIT
    20* (3)  ELCNTL - A&H BENEFIT
    21* (4)  ELCNTL - CARRIER
    22* (5)  MAIL
    23* (6)  ERACCT
    24* (7)  USED FOR SYSTEM VARIABLES ?
    25* (8)  ELCERT
    26* (9)  PENDING BUSINESS
    27* (10) COMPENSATION
    28* (11) ELCNTL - PROCESSOR DATA ?
    29* (12) ERCHEK
    30* (13) ERPYAJ
    31* (14) NOT USED
    32* (15) NOT USED
    33* (16) NOT USED
    34* (17) NOT USED
    35* (18) NOT USED
    36* (19) NOT USED
    37* (20) NOT USED
    38*
    39******************************************************************
    40*                   C H A N G E   L O G
    41*
    42* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    43*-----------------------------------------------------------------
    44*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    45* EFFECTIVE    NUMBER
    46*-----------------------------------------------------------------
    47* 101501    2001100100006  SMVA  ADD USERID to screen header
    48*                                ADJUSTED REDEFINES EL689AI FILLER
    49* 031504    2004020600009  SMVA  PULL MOST CURRENT ACCT ADDRESS
    50* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    51* 100705    2004072800003  PEMA  ADD NEW VARIABLES
    52* 072308    2008062700001  PEMA  ADD NEW VARIABLES
    53* 092908    2008013100006  PEMA  MOVE VAR 154
    54* 102408  CR2008091000001  PEMA  MOVE PNDB VARS TO CERT VARS
    55* 051209  CR2009021700003  PEMA  ADD CRED BENE VARIABLES
    56* 051209  CR2009042700002  PEMA  ADD ERACCT ACCT NUMBER VARIABLE
    57* 022510  IR2009062300003  PEMA  ADD ENDFILE TEST TO ERACCT READ
    58* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    59* 041811  CR2011010400001  PEMA  DISABLE PF8 FOR CERTAIN USERS
    60* 042011  CR2011010400001  PEMA  FIX CRED BENE ADDRESS LINES
    61* 061411  CR2011061300001  PEMA  ADD ALWA TO PF8 DISABLE LIST
    62* 092911  IR2011092900001  AJRA  CLEAR LABEL LINES BEFORE CRED BEN
    63* 022712  IR2012022700001  AJRA  DON'T COUNT &&&&&& IN LINES
    64* 122011  CR2011022800001  AJRA  NAPERSOFT
    65* 090612  IR2012090600001  AJRA  NAPERSOFT
    66* 091712  IR2012091400001  AJRA  NAPERSOFT CERT ID
    67* 091912  IR2012091900001  AJRA  ALLOW FOLLOW UP DATE TO = CURR DT
    68* 101812  CR2012101700002  AJRA  ADD ENDARCH AND SCREENID
    69* 110512  CR2012101700002  AJRA  EXIT LETTER WRITER AFTER PF7
    70* 120512  CR2012101700002  AJRA  ADD RE ENCL CODE
    71* 011013  CR2012101700002  AJRA  CHECK REQ REASON CODE IND
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page   3
* EL689.cbl
    72* 012413  CR2013012100001  AJRA  ADD AUTO BILLING NOTE
    73* 121213  CR2013090300001  AJRA  VALIDATE ENC CODE AGAINST ELENCC
    74* 123113  CR2013090300001  AJRA  USE NEXT BUS DT FOR RESEND DT CAL
    75* 010814  CR2013090300001  AJRA  CALL SQL STORED PROC FOR NEXT BUS
    76* 021214  IR2014021200002  AJRA  ADD SQL DISCONNECT
    77******************************************************************
    78
    79 DATA DIVISION.
    80 WORKING-STORAGE SECTION.
    81 01  DFH-START PIC X(04).
    82 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    83 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    84                                   USAGE POINTER.
    85 77  FILLER  PIC X(32) VALUE '********************************'.
    86 77  FILLER  PIC X(32) VALUE '*    EL689 WORKING STORAGE     *'.
    87 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
    88
*   89 EXEC SQL
*   90    INCLUDE SQLDA
*   91 END-EXEC
    92 01 SQLDA sync.
    93    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    94    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    95    05 SQLN                  PIC S9(4) COMP-5 value 0.
    96    05 SQLD                  PIC S9(4) COMP-5 value 0.
    97    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    98       10 SQLTYPE            PIC S9(4) COMP-5.
    99       10 SQLLEN             PIC S9(4) COMP-5.
   100$IF P64 SET
   101X      *> For 64-bit environments, ensure that SQLDATA is
   102X      *> aligned on an 8-byte boundary.
   103X      10 FILLER             PIC S9(9) COMP-5.
   104$END
   105       10 SQLDATA            USAGE POINTER.
   106       10 SQLIND             USAGE POINTER.
   107       10 SQLNAME.
   108          15 SQLNAMEL        PIC S9(4) COMP-5.
   109          15 SQLNAMEC        PIC X(30).
   110
   111* Values for SQLTYPE
   112
   113 78  ESQL-DATE-CHAR              VALUE 384.
   114 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   115 78  ESQL-DATE-REC               VALUE 386.
   116 78  ESQL-DATE-REC-NULL          VALUE 387.
   117 78  ESQL-TIME-CHAR              VALUE 388.
   118 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   119 78  ESQL-TIME-REC               VALUE 390.
   120 78  ESQL-TIME-REC-NULL          VALUE 391.
   121 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   122 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   123 78  ESQL-TIMESTAMP-REC          VALUE 394.
   124 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   125 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   126 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   127 78  ESQL-TS-OFFSET-REC          VALUE 398.
   128 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   129 78  ESQL-LONGVARBINARY          VALUE 404.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page   4
* EL689.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   131 78  ESQL-LONGVARCHAR            VALUE 408.
   132 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   133 78  ESQL-BINARY                 VALUE 444.
   134 78  ESQL-BINARY-NULL            VALUE 445.
   135 78  ESQL-VARBINARY              VALUE 446.
   136 78  ESQL-VARBINARY-NULL         VALUE 447.
   137 78  ESQL-VARCHAR                VALUE 448.
   138 78  ESQL-VARCHAR-NULL           VALUE 449.
   139
   140 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   141 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   142
   143 78  ESQL-CHAR                   VALUE 452.
   144 78  ESQL-CHAR-NULL              VALUE 453.
   145
   146 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   147 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   148
   149 78  ESQL-DOUBLE                 VALUE 480.
   150 78  ESQL-DOUBLE-NULL            VALUE 481.
   151 78  ESQL-REAL                   VALUE 482.
   152 78  ESQL-REAL-NULL              VALUE 483.
   153 78  ESQL-DECIMAL                VALUE 484.
   154 78  ESQL-DECIMAL-NULL           VALUE 485.
   155 78  ESQL-INTEGER                VALUE 496.
   156 78  ESQL-INTEGER-NULL           VALUE 497.
   157 78  ESQL-SMALLINT               VALUE 500.
   158 78  ESQL-SMALLINT-NULL          VALUE 501.
   159 78  ESQL-TINYINT                VALUE 502.
   160 78  ESQL-TINYINT-NULL           VALUE 503.
   161
*  162 EXEC SQL
*  163    INCLUDE SQLCA
*  164 END-EXEC
   165 01 SQLCA.
   166     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   167     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   168     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   169     05  SQLERRM.
   170         49  SQLERRML    PIC S9(4) COMP-5.
   171         49  SQLERRMC    PIC X(70).
   172     05  SQLERRP         PIC X(8).
   173     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   174     05  SQLWARN.
   175         10  SQLWARN0    PIC X.
   176         10  SQLWARN1    PIC X.
   177         10  SQLWARN2    PIC X.
   178         10  SQLWARN3    PIC X.
   179         10  SQLWARN4    PIC X.
   180         10  SQLWARN5    PIC X.
   181         10  SQLWARN6    PIC X.
   182         10  SQLWARN7    PIC X.
   183     05  SQLEXT.
   184         10  SQLWARN8    PIC X.
   185         10  SQLWARN9    PIC X.
   186         10  SQLWARN10   PIC X.
   187         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page   5
* EL689.cbl
   188     05  SQLSTATE    PIC X(5).
   189
   190 EXEC SQL
   191    BEGIN DECLARE SECTION
   192 END-EXEC
   193
   194 01  SQLCMD                      PIC X(1024).
   195 01  SVR                         PIC X(32).
   196 01  USR                         PIC X(32).
   197 01  PASS                        PIC X(32).
   198 01  USR-PASS                    PIC X(64).
   199
   200 01  WS-SQL-DATA.
   201     05  WS-CYCLE-DATE           PIC X(10).
   202     05  WS-NEXT-BUS-DT          PIC X(10).
   203
   204 EXEC SQL
   205    END DECLARE SECTION
   206 END-EXEC
   207
   208 01  P pointer.
   209 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   210 01  KIXHOST             pic x(9) value Z"HOSTNAME".
   211 01  var-ptr pointer.
   212 01  env-var-len                 pic 9(4)  binary.
   213 01  rc                          pic 9(9)  binary.
   214 01  WS-KIXHOST                  PIC X(10).
   215 01  WS-KIXSYS.
   216     05  WS-KIX-FIL1             PIC X(10).
   217     05  WS-KIX-APPS             PIC X(10).
   218     05  WS-KIX-ENV              PIC X(10).
   219     05  WS-KIX-MYENV            PIC X(10).
   220     05  WS-KIX-SYS              PIC X(10).
   221 01 srch-commarea.
   222*                                copy ELCADLTRSPI.
   223******************************************************************
   224*                   C H A N G E   L O G
   225*
   226* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   227*-----------------------------------------------------------------
   228*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   229* EFFECTIVE    NUMBER
   230*-----------------------------------------------------------------
   231* 060611    2011022800001  PEMA  NEW COPYBOOK
   232* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   233* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   234******************************************************************
   235****************************************
   236*  commarea for NaperSoft On Demand Admin services letters
   237*  (business logic input & output)
   238****************************************
   239     03  BL-INPUT.
   240         05  BL-DATA-SRCE        PIC X.
   241         05  BL-LETTER-ID        PIC XXXX.
   242         05  BL-CARRIER          PIC X.
   243         05  BL-GROUP            PIC X(6).
   244         05  BL-STATE            PIC XX.
   245         05  BL-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page   6
* EL689.cbl
   246         05  BL-EFF-DT           PIC X(10).
   247         05  BL-CERT-NO          PIC X(11).
   248         05  BL-BATCH-NO         PIC X(6).
   249         05  BL-BATCH-SEQ        PIC 9(8).
   250         05  BL-RESP-NO          PIC X(10).
   251         05  BL-NO-OF-COPIES     PIC 99.
   252         05  BL-PROC-ID          PIC XXXX.
   253         05  BL-COMP-ID          PIC XXX.
   254         05  BL-PRINT-NOW-SW     PIC X.
   255         05  BL-ENC-CD           PIC XXX.
   256         05  BL-RESEND-DT        PIC X(10).
   257         05  BL-FOLLOW-UP-DT     PIC X(10).
   258         05  BL-ARCHIVE-NO       PIC 9(8).
   259         05  BL-FUNC             PIC X(8).
   260         05  BL-COMMENTS         PIC X(100).
   261         05  FILLER REDEFINES BL-COMMENTS.
   262             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   263             10  BL-LETTER-TO-ACCT PIC X.
   264             10  BL-LETTER-TO-BENE PIC X.
   265             10  BL-WRITE-ERARCH   PIC X.
   266                 88  ERARCH-QWS      VALUE 'Q'.
   267                 88  ERARCH-BATCH    VALUE 'B'.
   268                 88  ERARCH-TEMP     VALUE 'T'.
   269             10  BL-PROCESS-TYPE PIC X(07).
   270             10  BL-CERT-FORM-ID PIC X(05).
   271             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   272             10  BL-SOURCE-SCREEN PIC X(8).
   273             10  FILLER          PIC X(25).
   274     03  BL-OUTPUT.
   275         05  BL-STATUS                   PIC X.
   276             88  BL-OK                      VALUE "P".
   277             88  BL-FAIL                  VALUE "F".
   278         05  BL-MESSAGE          PIC X(50).
   279     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   280     03  FILLER                  PIC X(31).
   281 01  W-WORK-AREAS.
   282     12  FILLER                  PIC  X(18)
   283                                      VALUE 'PROGRAM WORK AREA:'.
   284
   285     12  W-ASKTIME-CTR           PIC S9(04)  COMP   VALUE +0.
   286     12  W-CWA-NDX               PIC S9(04)  COMP   VALUE +0.
   287     12  W-DISPLAY-NDX           PIC S9(04)  COMP   VALUE +0.
   288     12  W-FIRST-BAD-VARIABLE    PIC S9(04)  COMP   VALUE +0.
   289     12  W-NDX                   PIC S9(04)  COMP   VALUE +0.
   290     12  W-NDX2                  PIC S9(04)  COMP   VALUE +0.
   291     12  W-SEQ-CTR               PIC S9(04)  COMP   VALUE +0.
   292     12  W-TS-ITEM               PIC S9(04)  COMP   VALUE +0.
   293     12  W-TOTAL-LINE-LENGTH     PIC S9(04)  COMP   VALUE +0.
   294     12  W-WORK-NDX              PIC S9(04)  COMP   VALUE +0.
   295
   296     12  W-ADJUST-SHORT          PIC S9(03) VALUE +0   COMP-3.
   297     12  W-DIFFERENCE            PIC S9(07)V9(02)
   298                                            VALUE +0   COMP-3.
   299     12  W-INITIAL-COLUMN        PIC S9(03) VALUE +0   COMP-3.
   300     12  W-LAST-COLUMN           PIC S9(03) VALUE +70 COMP-3.
   301     12  W-LAST-SQUEEZED-SPACE   PIC S9(03) VALUE +0   COMP-3.
   302     12  W-LAST-TX-SPACE         PIC S9(03) VALUE +0   COMP-3.
   303     12  W-LAST-WC-SPACE         PIC S9(03) VALUE +0   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page   7
* EL689.cbl
   304     12  W-LINE-COUNT            PIC S9(03) VALUE +0   COMP-3.
   305     12  W-LINE-INDENT-1         PIC  9(02) VALUE 0    COMP-3.
   306     12  W-LINE-INDENT-2         PIC  9(02) VALUE 0    COMP-3.
   307     12  W-LINE-INDENT-3         PIC  9(02) VALUE 0    COMP-3.
   308     12  W-LINE-INDENT-4         PIC  9(02) VALUE 0    COMP-3.
   309     12  W-LINE-INDENT-5         PIC  9(02) VALUE 0    COMP-3.
   310     12  W-MAX-LINES-PER-PAGE    PIC  9(02) VALUE 56   COMP-3.
   311     12  W-NEXT-INDENT           PIC  9(02) VALUE 0    COMP-3.
   312     12  W-PAGE                  PIC S9(02) VALUE +0   COMP-3.
   313     12  W-PAGE-LINE             PIC S9(03) VALUE +0   COMP-3.
   314     12  W-PARAGRAPH-INDENT      PIC  9(02) VALUE 0    COMP-3.
   315     12  W-ROLL-COUNTER          PIC S9(03) VALUE +0   COMP-3.
   316     12  W-START-COLUMN          PIC S9(03) VALUE +1   COMP-3.
   317     12  W-TEMP-CURRENT-LINE     PIC S9(03) VALUE +0   COMP-3.
   318     12  W-TOO-FAR               PIC S9(03) VALUE +71 COMP-3.
   319     12  W-TOP-MARGIN            PIC  9(02) VALUE 0    COMP-3.
   320     12  W-TOTAL-TX-LINES        PIC S9(03) VALUE +0   COMP-3.
   321     12  W-TS-GROUP-WORK         PIC  9(05) VALUE 0    COMP-3.
   322     12  W-WORK-INDENT           PIC  9(02) VALUE 0    COMP-3.
   323     12  W-WORK-AMOUNT           PIC S9(09)V9(02)
   324                                            VALUE +0   COMP-3.
   325
   326     12  W-DATA-SOURCE           PIC  9(01) VALUE 0.
   327     12  W-LABEL-SOURCE          PIC  9(01) value 0.
   328         88  W-LABEL-SOURCE-VALID           VALUE 1 THRU 7.
   329     12  W-LABEL-JOINT-NAME      PIC  X(30) VALUE SPACES.
   330     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
   331     12  W-NUMB-LABEL-LINES      PIC  9(01) VALUE 0.
   332     12  W-PRINT-CONTROL         PIC  9(02) VALUE 0.
   333     12  W-SAVE-REVISION         PIC  9(03) value 0.
   334     12  W-DISPLAY-3             PIC  9(03) value 0.
   335     12  W-DISPLAY-8             PIC  9(08) value 0.
   336     12  W-DISPLAY-7             PIC  9(07) value 0.
   337     12  W-EDIT-2-5-S            PIC  Z9.9(05).
   338     12  W-EDIT-3-0              PIC  ZZ9.
   339     12  W-EDIT-7-2              PIC  $$,$$$,$$9.99.
   340     12  W-EDIT-7-2-NEGATIVE     PIC  $$,$$$,$$9.99-.
   341     12  W-EDIT-9-2              PIC  $$$$,$$$,$$9.99.
   342     12  W-EDIT-12-2             PIC  $$$$,$$$,$$$,$$9.99.
   343
   344     12  WS-ACCT-PKEY-MATCH-SW   PIC  X(01) VALUE SPACE.
   345         88  PRIOR-MATCH-ACCT-PKEY          VALUE 'Y'.
   346
   347     12  W-ARCH-SUPPRESS         PIC 99999999.
   348     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   349                                 PIC  X(08).
   350     12  W-COMP-WORK-AREA.
   351         16  W-CWA-CHAR OCCURS 10 TIMES
   352                                 PIC  X(01).
   353     12  W-INCOMING-ARCHIVE      PIC  X(08).
   354     12  W-INCOMING-ARCH-NO REDEFINES W-INCOMING-ARCHIVE
   355                                 PIC  9(08).
   356
   357     12  W-BATCH-BREAKDOWN.
   358         16  W-BATCH-CONTROL     PIC S9(08) COMP.
   359         16  W-BATCH-SEQ         PIC S9(04) COMP.
   360     12  W-BEN-HOLD              PIC  X(02).
   361     12  W-BENEFIT-WORK          PIC  X(03).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page   8
* EL689.cbl
   362     12  W-BEN-R REDEFINES W-BENEFIT-WORK.
   363         16  W-ELIM-DAYS         PIC  X(02).
   364         16  FILLER              PIC  X(01).
   365     12  W-CALL-PGM              PIC  X(08).
   366     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
   367
   368     12  FILLER                  PIC  X(09) VALUE 'LINE CNTL'.
   369     12  W-LINE-CONTROL-RECORD.
   370         16  W-LC-LINE-WIDTH     PIC  9(02).
   371         16  FILLER              PIC  X(01).
   372         16  W-LC-PARAGRAPH-INDENT
   373                                 PIC  9(02).
   374         16  FILLER              PIC  X(01).
   375         16  W-LC-MAX-LINES-PER-PAGE
   376                                 PIC  9(02).
   377         16  FILLER              PIC  X(01).
   378         16  W-LC-LINE-ADJUST    PIC  9(02).
   379         16  FILLER              PIC  X(01).
   380         16  W-LC-LINE-INDENT-1  PIC  9(02).
   381         16  FILLER              PIC  X(01).
   382         16  W-LC-LINE-INDENT-2  PIC  9(02).
   383         16  FILLER              PIC  X(01).
   384         16  W-LC-LINE-INDENT-3  PIC  9(02).
   385         16  FILLER              PIC  X(01).
   386         16  W-LC-LINE-INDENT-4  PIC  9(02).
   387         16  FILLER              PIC  X(01).
   388         16  W-LC-LINE-INDENT-5  PIC  9(02).
   389         16  FILLER              PIC  X(01).
   390         16  W-LC-TOP-MARGIN     PIC  9(02).
   391         16  FILLER              PIC  X(01).
   392         16  W-LC-CASE-IND       PIC  X(01).
   393             88  W-LC-USE-BOTH-CASES        VALUE 'Y'.
   394         16  FILLER              PIC  X(01).
   395         16  W-LC-PAGE-IND       PIC  X(01).
   396             88  W-LC-CREATE-PAGES          VALUE 'Y'.
   397     12  W-DATE-WORK             PIC  9(07).
   398     12  W-DT-REDEF REDEFINES W-DATE-WORK.
   399         16  FILLER              PIC  X(02).
   400         16  W-DT-WORK           PIC  9(05).
   401
   402     12  W-DEEDIT-FIELD          PIC  X(15).
   403     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
   404
   405     12  W-EDIT-DATE-1.
   406         16  W-ED1-MM            PIC  X(02).
   407         16  FILLER              PIC  X(01) VALUE '/'.
   408         16  W-ED1-DD            PIC  X(02).
   409         16  FILLER              PIC  X(01) VALUE '/'.
   410         16  W-ED1-YY            PIC  X(02).
   411
   412     12  W-EDIT-DATE-2.
   413         16  W-ED2-DD            PIC  X(02).
   414         16  FILLER              PIC  X(01) VALUE '/'.
   415         16  W-ED2-MM            PIC  X(02).
   416         16  FILLER              PIC  X(01) VALUE '/'.
   417         16  W-ED2-YY            PIC  X(02).
   418
   419     12  W-EDIT-A-DATE.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page   9
* EL689.cbl
   420         16  W-EDIT-A-MM                  PIC X(2).
   421         16  FILLER                       PIC X(1).
   422         16  W-EDIT-A-DD                  PIC X(2).
   423         16  FILLER                       PIC X(1).
   424         16  W-EDIT-A-CCYY.
   425             20  W-EDIT-A-CC              PIC X(2).
   426             20  W-EDIT-A-YY              PIC X(2).
   427
   428     12  W-LABEL-HOLD-AREA.
   429         16  W-LABEL-LINES OCCURS 6 TIMES.
   430             20  W-LABEL-ZIP.
   431                 24  W-LABEL-1ST-ZIP  PIC  X(05).
   432                 24  W-LABEL-DASH     PIC  X(01).
   433                 24  W-LABEL-2ND-ZIP  PIC  X(04).
   434             20  W-LAB-CAN-POSTAL-CODES REDEFINES W-LABEL-ZIP.
   435                 24  W-LAB-CAN-POSTAL-CD-1
   436                                      PIC  X(03).
   437                 24  W-LAB-CAN-DASH   PIC  X(01).
   438                 24  W-LAB-CAN-POSTAL-CD-2
   439                                      PIC  X(03).
   440                 24  W-LAB-CAN-FILLER PIC  X(03).
   441             20  FILLER               PIC  X(10).
   442             20  W-LAST-ZIP.
   443                 24  W-LAST-1ST-ZIP   PIC  X(05).
   444                 24  W-LABEL-DASH-LAST
   445                                      PIC  X(01).
   446                 24  W-LAST-2ND-ZIP   PIC  X(04).
   447             20  W-LAST-CAN-POSTAL-CODES REDEFINES W-LAST-ZIP.
   448                 24  W-LAST-CAN-POSTAL-CD-1
   449                                      PIC  X(03).
   450                 24  W-LAST-CAN-DASH  PIC  X(01).
   451                 24  W-LAST-CAN-POSTAL-CD-2
   452                                      PIC  X(03).
   453                 24  W-LAST-CAN-FILLER
   454                                      PIC  X(03).
   455
   456     12  W-LAST-CHAR             PIC  X(01).
   457         88  W-LAST-CHAR-PUNC    VALUE '-' '/'.
   458     12  W-LAST-SQ-CHAR          PIC  X(01).
   459
   460     12  W-LINE-NUM.
   461         16  W-LINE1             PIC  X(01).
   462         16  W-LINE23            PIC  9(02).
   463     12  W-LIN-NUM REDEFINES W-LINE-NUM
   464                                 PIC  9(03).
   465
   466     12  W-NAME-LAST             PIC  X(15).
   467     12  W-NAME-FIRST.
   468         16  W-NAME-FIRST-INIT   PIC  X(01).
   469         16  W-NAME-FIRST-REMAIN PIC  X(14).
   470     12  W-NAME-MIDDLE.
   471         16  FILLER              PIC  X(01).
   472         16  W-NAME-MIDDLE-2     PIC  X(01).
   473         16  FILLER              PIC  X(13).
   474
   475     12  W-PAGE-PRT.
   476         16  FILLER              PIC  X(34) VALUE SPACES.
   477         16  W-PAGE-NUMBER       PIC  Z9.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  10
* EL689.cbl
   478         16  FILLER              PIC  X(01) VALUE '.'.
   479         16  FILLER              PIC  X(33) VALUE SPACES.
   480
   481     12  W-PHONE-IN              PIC  9(11) VALUE ZEROS.
   482     12  W-PHONE-IN-R   REDEFINES W-PHONE-IN.
   483         16  FILLER              PIC  9(01).
   484         16  W-PHI-AREA          PIC  9(03).
   485         16  W-PHI-PFX           PIC  9(03).
   486         16  W-PHI-SFX           PIC  9(04).
   487     12  W-PHONE-OUT.
   488         16  W-PO-AREA           PIC  X(03).
   489         16  FILLER              PIC  X(01) VALUE '-'.
   490         16  W-PO-PFX            PIC  X(03).
   491         16  FILLER              PIC  X(01) VALUE '-'.
   492         16  W-PO-SFX            PIC  X(04).
   493
   494     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
   495     12  W-SAVE-BIN-NEXT-BUS-DT  PIC  X(02) VALUE SPACES.
   496     12  W-SAVE-NEXT-BUS-DT-EDIT-A PIC X(10)   VALUE SPACES.
   497     12  W-SAVE-CYCLE-DAY-OF-WEEK PIC S9   COMP-3 VALUE +0.
   498     12  W-SAVE-EDIT-A-DATE      PIC  X(10) VALUE SPACES.
   499     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
   500     12  W-SAVE-PLAN             PIC  X(02) VALUE SPACES.
   501
   502     12  W-SINGLE-LINE           PIC  X(70).
   503     12  W-SINGLE-LINE-BY REDEFINES W-SINGLE-LINE.
   504         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY NDX1 NDX2 NDXA
   505                                 PIC  X(01).
   506
   507     12  W-SQUEEZED-LINE.
   508         16  W-SQ-CHAR OCCURS 70 TIMES
   509                       INDEXED BY W-SQ-NDX
   510                                 PIC  X(01).
   511
   512     12  W-TIME-IN               PIC S9(07).
   513     12  W-TIME-OUT-R REDEFINES W-TIME-IN.
   514         16  FILLER              PIC  X(01).
   515         16  W-TIME-OUT          PIC  99V9(02).
   516         16  FILLER              PIC  X(02).
   517
   518     12  W-TS-NAME-TEXT.
   519         16  W-TS-ID-TEXT        PIC  X(04) VALUE '104A'.
   520         16  W-TS-ID-TIME
   521             REDEFINES W-TS-ID-TEXT
   522                                 PIC S9(07) COMP-3.
   523         16  W-TS-TERM-TEXT.
   524             20 W-TS-TERM-PREFIX PIC  X(02).
   525             20 FILLER           PIC  X(02).
   526     12  W-TS-NAME-SCREEN.
   527         16  FILLER              PIC  X(04) VALUE '689X'.
   528         16  W-TS-TERM-SCREEN    PIC  X(04).
   529
   530     12  W-WORK-LINE.
   531         16  W-WORK-CHAR OCCURS 70 TIMES
   532                       INDEXED BY W-WC-NDX
   533                                  W-WC-NDX2
   534                                  W-WC-NDX3
   535                                 PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  11
* EL689.cbl
   536
   537     12  W-WORK-ZIP-NUMERIC      PIC  9(09).
   538     12  W-WORK-ZIP REDEFINES W-WORK-ZIP-NUMERIC.
   539         16  W-WORK-ZIP5         PIC  X(05).
   540         16  W-WORK-ZIP4         PIC  X(04).
   541     12  W-CANADIAN-POSTAL-CODES REDEFINES W-WORK-ZIP-NUMERIC.
   542         16  W-CAN-POSTAL-CD-1.
   543             20  FILLER          PIC  X(01).
   544                 88 W-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
   545             20  FILLER          PIC  X(02).
   546         16  W-CAN-POSTAL-CD-2   PIC  X(03).
   547         16  W-FILLER            PIC  X(03).
   548
   549**** Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
   550*                   COPY ELCZREC.
   551******************************************************************
   552*                                                                *
   553*                                                                *
   554*                            ELCZREC.                            *
   555*                                                                *
   556*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   557*                                                                *
   558******************************************************************
   559*-----------------------------------------------------------------
   560*                   C H A N G E   L O G
   561*
   562* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   563*-----------------------------------------------------------------
   564*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   565* EFFECTIVE    NUMBER
   566*-----------------------------------------------------------------
   567* 122011    2011022800001  AJRA  NEW FILE
   568* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   569* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   570* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   571* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   572*-----------------------------------------------------------------
   573 01  W-Z-CONTROL-DATA.
   574     05  W-NUMBER-OF-COPIES      PIC  9.
   575     05  FILLER                  PIC  X.
   576     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   577     05  FILLER                  PIC  X.
   578     05  W-DAYS-TO-RESEND        PIC  999.
   579     05  FILLER                  PIC  X.
   580     05  W-FORM-TO-RESEND        PIC  X(4).
   581     05  W-ADD-BAR-CODE          PIC  X.
   582     05  W-PROMPT-LETTER         PIC  X.
   583     05  W-HAS-RETURN-ENV        PIC  X.
   584     05  W-ENCLOSURE-CD          PIC  XXX.
   585     05  W-SIG-FLAG-DEFAULT      PIC  X.
   586     05  W-AUTO-CLOSE-IND        PIC  X.
   587     05  FILLER                  PIC  X.
   588     05  W-LETTER-TO-BENE        PIC  X.
   589     05  FILLER                  PIC  X.
   590     05  W-LETTER-TO-ACCT        PIC  X.
   591     05  FILLER                  PIC  X.
   592     05  W-LETTER-TYPE           PIC  X.
   593     05  FILLER                  PIC  X.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  12
* EL689.cbl
   594     05  W-PRINT-CERTIFICATE     PIC  X.
   595     05  FILLER                  PIC  X.
   596     05  W-REFUND-REQUIRED       PIC  X.
   597     05  FILLER                  PIC  X.
   598     05  W-ONBASE-CODE           PIC  XX.
   599     05  FILLER                  PIC  X.
   600     05  W-ACCT-SUMM             PIC  X.
   601     05  FILLER                  PIC  X.
   602     05  W-CSO-SUMM              PIC  X.
   603     05  FILLER                  PIC  X.
   604     05  W-REASONS-REQUIRED      PIC  X.
   605     05  FILLER                  PIC  X(29).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  13
* EL689.cbl
   607 01  W-SWITCH-INDICATORS-AREA.
   608     12  FILLER                  PIC  X(16)
   609                                      VALUE 'PROGRAM SWITCHS:'.
   610     12  W-ADDRESS-ONLY-SW       PIC  X(01) VALUE ' '.
   611         88  W-ADDRESS-ONLY      VALUE 'Y'.
   612         88  W-FULL-DATA         VALUE ' '.
   613     12  W-ACCT-BROWSE-STARTED-SW
   614                                 PIC  X(01) VALUE 'N'.
   615         88  W-ACCT-BROWSE-STARTED          VALUE 'Y'.
   616     12  W-ARCT-BROWSE-STARTED   PIC  X(01) VALUE 'N'.
   617     12  W-CERT-FOUND-SW         PIC  X(01) VALUE 'N'.
   618         88  W-CERT-FOUND                   VALUE 'Y'.
   619     12  W-CHARACTER-TYPE        PIC  X(01).
   620         88  W-END-OF-SENTENCE   VALUE '.' '?' '!'.
   621         88  W-PUNCTUATION       VALUE '.' '?' '!' ',' ';'.
   622         88  W-SPACE             VALUE ' '.
   623     12  W-COMP-BROWSE-SW        PIC  X(01) VALUE 'N'.
   624         88  W-COMP-BROWSE-STARTED          VALUE 'Y'.
   625     12  W-DATA-SHRINK-IND       PIC  X(01) VALUE SPACES.
   626         88  W-DATA-SHRINKING    VALUE 'Y'.
   627     12  W-END-OF-SENTENCE-IND   PIC  X(01) VALUE SPACES.
   628         88  W-END-OF-SENTENCE-WORKING      VALUE 'Y'.
   629     12  W-FIRST-BAD-VARIABLE-IND
   630                                 PIC  X(01) VALUE SPACES.
   631         88  W-FIRST-BAD-VARIABLE-FOUND     VALUE 'Y'.
   632     12  W-FIRST-CHAR-FOUND-IND  PIC  X(01) VALUE SPACES.
   633         88  W-FIRST-CHAR-FOUND             VALUE 'Y'.
   634         88  W-FIRST-CHAR-NOT-FOUND         VALUE SPACES.
   635     12  W-FORM-CHANGED-IND      PIC  X(01) VALUE SPACES.
   636         88  W-FORM-CHANGED                 VALUE 'Y'.
   637     12  W-FORM-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   638         88  W-FORM-SQUEEZE-ON              VALUE 'Y'.
   639         88  W-FORM-SQUEEZE-OFF             VALUE ' '.
   640     12  W-HOLD-IND              PIC  X(01) VALUE SPACES.
   641         88  W-HOLD-ON                      VALUE 'Y'.
   642         88  W-HOLD-OFF                     VALUE ' '.
   643     12  W-INDIVIDUAL-DATA-SW    PIC  X(01) VALUE ' '.
   644         88  W-INDIVIDUAL-DATA-COMPLETED    VALUE 'Y'.
   645         88  W-INDIV-DATA-NOT-COMPLETED     VALUE ' '.
   646     12  W-KEY-FIELDS-CHANGED-IND
   647                                 PIC  X(01) VALUE ' '.
   648         88  W-KEY-FIELDS-CHANGED           VALUE 'Y'.
   649         88  W-KEY-FIELDS-NOT-CHANGED       VALUE ' '.
   650     12  W-LAST-ONE              PIC  X(01) VALUE HIGH-VALUES.
   651         88  W-LAST-ONE-A-SPACE  VALUE ' '.
   652     12  W-LINE-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   653         88  W-NEW-PARAGRAPH                VALUE 'P' 'Q' 'R' 'S'
   654                                                   'T' 'U'.
   655         88  W-CONTINUE-PARAGRAPH           VALUE 'C' 'D' 'E' 'F'
   656                                                   'G' 'H'.
   657         88  W-FORM-CONTROL-LINE            VALUE 'K'.
   658         88  W-DO-NOT-ADJUST                VALUE 'N'.
   659         88  W-ADJUST-TO-LINE-LENGTH        VALUE 'A'.
   660         88  W-AS-IS                        VALUE 'A' 'N'.
   661         88  W-CONTINUE-PREVIOUS-PROCESS    VALUE ' ' '1' '2' '3'
   662                                                   '4' '5'.
   663
   664     12  W-PNDB-FOUND-SW         PIC  X(01) VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  14
* EL689.cbl
   665         88  W-PNDB-FOUND                   VALUE 'Y'.
   666     12  W-REMAINING-VAR-SW      PIC  X(01) VALUE SPACES.
   667         88  W-REMAINING-VAR-FOUND          VALUE 'Y'.
   668     12  W-REVERSE-DATE-SW       PIC  X(01) VALUE SPACES.
   669         88  W-REVERSE-DATE                 VALUE 'Y'.
   670     12  W-TEXT-BROWSED-SW       PIC  X(01) VALUE 'N'.
   671         88  W-TEXT-BROWSE-STARTED          VALUE 'Y'.
   672         88  W-TEXT-BROWSE-NOT-STARTED      VALUE 'N'.
   673
   674     12  W-VALID-ENDT-SW         PIC  X(01) VALUE 'N'.
   675         88  W-VALID-ENDT                   VALUE 'Y'.
   676     12  W-RESPONSE              PIC S9(8)   COMP.
   677         88  RESP-NORMAL                  VALUE +00.
   678         88  RESP-NOTFND                  VALUE +13.
   679         88  RESP-DUPREC                  VALUE +14.
   680         88  RESP-DUPKEY                  VALUE +15.
   681         88  RESP-NOTOPEN                 VALUE +19.
   682         88  RESP-ENDFILE                 VALUE +20.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  15
* EL689.cbl
   684 01  WS-SAVE-AREA.
   685     12  WS-SAV-AM-DEFN-1.
   686         16  WS-SAV-AM-AGT-COMMS OCCURS 10 TIMES.
   687             20  WS-SAV-AM-AGT             PIC  X(10).
   688             20  WS-SAV-AM-COM-TYP         PIC  X(01).
   689             20  FILLER                    PIC  X(15).
   690     12  WS-SAV-AM-REMIT-TO                PIC  9(02).
   691     12  WS-SAV-AM-CSR-CODE                PIC  X(04).
   692     12  WS-SAV-AM-CARRIER                 PIC  X(01).
   693     12  WS-SAV-AM-ACCOUNT                 PIC  X(10).
   694     12  WS-SAV-AM-CONTROL-NAME            PIC  X(30).
   695     12  WS-SAV-AM-NAME                    PIC  X(30).
   696     12  WS-SAV-AM-PERSON                  PIC  X(30).
   697     12  WS-SAV-AM-ADDRS                   PIC  X(30).
   698     12  WS-SAV-AM-CITY                    PIC  X(30).
   699     12  WS-SAV-AM-ERACCT-ACCOUNT          PIC  X(10).
   700     12  WS-SAV-AM-ZIP.
   701         16  WS-SAV-AM-ZIP-PRIME.
   702             20  WS-SAV-AM-ZIP-PRI-1ST     PIC  X(01).
   703                 88  SAVE-AM-CANADIAN-POST-CODE       VALUE
   704                     'A' THRU 'Z'.
   705             20  FILLER                    PIC  X(04).
   706         16  FILLER                        PIC  X(04).
   707     12  WS-SAV-AM-CANADIAN-POSTAL-CODE REDEFINES
   708                        WS-SAV-AM-ZIP      PIC  X(09).
   709     12  WS-SAV-AM-TEL-NO.
   710         16  WS-SAV-AM-AREA-CODE           PIC 9(03).
   711         16  WS-SAV-AM-TEL-PRE             PIC 9(03).
   712         16  WS-SAV-AM-TEL-NBR             PIC 9(04).
   713 01  W-KEY-AREAS.
   714     12  FILLER                    PIC  X(13)
   715                                      VALUE 'PROGRAM KEYS:'.
   716
   717     12  W-ACCT-SAVE-KEY           PIC  X(20).
   718     12  W-ACCT-KEY.
   719         16  W-ACCT-PARTIAL-KEY.
   720             20  W-ACCT-COMPANY-CD PIC  X(01).
   721             20  W-ACCT-CARRIER    PIC  X(01).
   722             20  W-ACCT-GROUPING   PIC  X(06).
   723             20  W-ACCT-STATE      PIC  X(02).
   724             20  W-ACCT-ACCOUNT    PIC  X(10).
   725         16  W-ACCT-EXP-DT         PIC  X(02).
   726
   727     12  W-ARCH-SAVE-KEY         PIC  X(05).
   728     12  W-ARCH-KEY.
   729         16  W-ARCH-PARTIAL-KEY.
   730             20  W-ARCH-COMPANY-CD
   731                                 PIC  X(01).
   732             20  W-ARCH-NUMBER   PIC S9(08)      COMP.
   733         16  W-ARCH-SEQ-NO       PIC S9(04)      COMP VALUE +0.
   734
   735     12  W-ARCT-KEY.
   736         16  W-ARCT-PARTIAL-KEY.
   737             20  W-ARCT-COMPANY-CD
   738                                 PIC  X(01).
   739             20  W-ARCT-NUMBER   PIC S9(08)      COMP.
   740         16  W-ARCT-REC-TYPE     PIC  X(01).
   741         16  W-ARCT-SEQ-NO       PIC S9(04)      COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  16
* EL689.cbl
   742
   743     12  W-CERT-KEY.
   744         16  W-CERT-COMPANY-CD   PIC  X(01).
   745         16  W-CERT-CARRIER      PIC  X(01).
   746         16  W-CERT-GROUPING     PIC  X(06).
   747         16  W-CERT-STATE        PIC  X(02).
   748         16  W-CERT-ACCOUNT      PIC  X(10).
   749         16  W-CERT-EFF-DT       PIC  X(02).
   750         16  W-CERT-CERT-NO.
   751             20  W-CERT-CERT-PRIME
   752                                 PIC  X(10).
   753             20  W-CERT-CERT-SFX PIC  X(01).
   754
   755     12  W-CHEK-KEY.
   756         16  W-CHEK-COMPANY-CD   PIC  X(01).
   757         16  W-CHEK-CARRIER      PIC  X(01).
   758         16  W-CHEK-GROUPING     PIC  X(06).
   759         16  W-CHEK-STATE        PIC  X(02).
   760         16  W-CHEK-ACCOUNT      PIC  X(10).
   761         16  W-CHEK-EFF-DT       PIC  X(02).
   762         16  W-CHEK-CERT-NO.
   763             20  W-CHEK-CERT-PRIME
   764                                 PIC  X(10).
   765             20  W-CHEK-CERT-SFX PIC  X(01).
   766         16  W-CHEK-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   767
   768     12  W-CNTL-KEY.
   769         16  W-CNTL-COMPANY-ID   PIC  X(03).
   770         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   771         16  W-CNTL-GENL.
   772             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   773             20  W-CNTL-GEN2.
   774                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   775                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   776         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   777
   778     12  W-COMP-SAVE-KEY         PIC  X(29).
   779     12  W-COMP-KEY.
   780         16  W-COMP-COMPANY-CD   PIC  X(01).
   781         16  W-COMP-CARRIER      PIC  X(01).
   782         16  W-COMP-GROUPING     PIC  X(06).
   783         16  W-COMP-RESP-PERSON.
   784             20  W-COMP-RP-CHAR OCCURS 10 TIMES
   785                                INDEXED BY W-COMP-NDX
   786                                 PIC  X(01).
   787         16  W-COMP-ACCOUNT      PIC  X(10).
   788         16  W-COMP-TYPE         PIC  X(01).
   789
   790     12  W-DELETE-KEY.
   791         16  W-DELETE-PARTIAL-KEY.
   792             20  W-DELETE-COMPANY-CD
   793                                 PIC  X(01).
   794             20  W-DELETE-NUMBER PIC S9(08)      COMP.
   795         16  W-DELETE-RECORD-TYPE
   796                                 PIC  X(01).
   797         16  W-DELETE-SEQ        PIC S9(04)      COMP VALUE +0.
   798
   799     12  W-MAIL-KEY.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  17
* EL689.cbl
   800         16  W-MAIL-COMPANY-CD   PIC  X(01).
   801         16  W-MAIL-CARRIER      PIC  X(01).
   802         16  W-MAIL-GROUPING     PIC  X(06).
   803         16  W-MAIL-STATE        PIC  X(02).
   804         16  W-MAIL-ACCOUNT      PIC  X(10).
   805         16  W-MAIL-EFF-DT       PIC  X(02).
   806         16  W-MAIL-CERT-NO.
   807             20  W-MAIL-CERT-PRIME
   808                                 PIC  X(10).
   809             20  W-MAIL-CERT-SFX PIC  X(01).
   810
   811     12  W-PNDB-KEY.
   812         16  W-PNDB-COMPANY-CD   PIC  X(01).
   813         16  W-PNDB-ENTRY        PIC  X(06).
   814         16  W-PNDB-SEQ-NO       PIC S9(04)  COMP.
   815         16  W-PNDB-CHG-SEQ-NO   PIC S9(04)  COMP.
   816
   817     12  W-PNDB2-KEY.
   818         16  W-PNDB2-COMPANY-CD  PIC  X(01).
   819         16  W-PNDB2-CARRIER     PIC  X(01).
   820         16  W-PNDB2-GROUPING    PIC  X(06).
   821         16  W-PNDB2-STATE       PIC  X(02).
   822         16  W-PNDB2-ACCOUNT     PIC  X(10).
   823         16  W-PNDB2-EFF-DT      PIC  X(02).
   824         16  W-PNDB2-CERT-NO.
   825             20  W-PNDB2-CERT-PRIME
   826                                 PIC  X(10).
   827             20  W-PNDB2-CERT-SFX
   828                                 PIC  X(01).
   829         16  W-PNDB2-ALT-CHG-SEQ-NO
   830                                 PIC S9(04)  COMP.
   831         16  W-PNDB2-TYPE        PIC  X(01).
   832
   833     12  W-PYAJ-KEY.
   834         16  W-PYAJ-COMPANY-CD   PIC  X(01).
   835         16  W-PYAJ-CARRIER      PIC  X(01).
   836         16  W-PYAJ-GROUPING     PIC  X(06).
   837         16  W-PYAJ-FIN-RESP     PIC  X(10).
   838         16  W-PYAJ-ACCOUNT      PIC  X(10).
   839         16  W-PYAJ-FILE-SEQ-NO  PIC S9(08)    COMP.
   840         16  W-PYAJ-RECORD-TYPE  PIC  X(01).
   841
   842     12  W-SC-QUID-KEY.
   843         16  W-SC-QUID-TERMINAL  PIC  X(04).
   844         16  W-SC-QUID-SYSTEM    PIC  X(04).
   845
   846     12  W-TEXT-SAVE-KEY         PIC  X(05).
   847     12  W-TEXT-KEY.
   848         16  W-TEXT-PARTIAL-KEY.
   849             20  W-TEXT-COMPANY-CD
   850                                 PIC  X(01).
   851             20  W-TEXT-LETTER   PIC  X(04).
   852         16  W-TEXT-FILLER       PIC  X(08)   VALUE SPACES.
   853         16  W-TEXT-SEQ          PIC S9(04)   VALUE +0    COMP.
   854
   855     12  W-ERENDT-KEY-BY-ARCH.
   856         16  W-ERENDT-COMPANY-CD-A1 PIC X.
   857         16  W-ERENDT-ARCHIVE       PIC 9(8) BINARY.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  18
* EL689.cbl
   858
   859     12  W-ELEOBC-KEY.
   860         16  W-EOBC-COMPANY-CD   PIC X.
   861         16  W-EOBC-REC-TYPE     PIC X.
   862         16  W-EOBC-CODE         PIC X(4).
   863         16  FILLER              PIC X(9).
   864     12  W-ERNOTE-KEY.
   865         16  W-NOTE-COMPANY-CD   PIC X.
   866         16  W-NOTE-CARRIER      PIC X.
   867         16  W-NOTE-GROUPING     PIC X(6).
   868         16  W-NOTE-STATE        PIC XX.
   869         16  W-NOTE-ACCOUNT      PIC X(10).
   870         16  W-NOTE-CERT-EFF-DT  PIC XX.
   871         16  W-NOTE-CERT-PRIME   PIC X(10).
   872         16  W-NOTE-CERT-SFX     PIC X.
   873     12  W-SAVE-KEY.
   874         16  W-SV-COMPANY-CD     PIC X.
   875         16  W-SV-CARRIER        PIC X.
   876         16  W-SV-GROUPING       PIC X(6).
   877         16  W-SV-STATE          PIC XX.
   878         16  W-SV-ACCOUNT        PIC X(10).
   879         16  W-SV-CERT-EFF-DT    PIC XX.
   880         16  W-SV-CERT-PRIME     PIC X(10).
   881         16  W-SV-CERT-SFX       PIC X.
   882     12  W-BILLING-NOTE.
   883         16  W-BN-NOTE           PIC X(25).
   884         16  W-BN-LTRID          PIC X(4).
   885         16  FILLER              PIC X(3).
   886         16  W-BN-DATE           PIC X(8).
   887         16  FILLER              PIC X(3).
   888         16  W-BN-USERID         PIC X(4).
   889         16  FILLER              PIC X(30).
   890     12  W-LEN                   PIC S9(5) COMP-3 VALUE +0.
   891     12  NOTE-SUB                PIC S9(5) COMP-3 VALUE +0.
   892     12  W-CERT-UPDATE-SW        PIC X  VALUE ' '.
   893         88  NO-CERT-RW                 VALUE 'N'.
   894         88  CERT-RW                    VALUE 'Y'.
   895
   896     12  W-ELENCC-KEY.
   897         16  W-ENCC-COMPANY-CD   PIC X.
   898         16  W-ENCC-REC-TYPE     PIC X.
   899         16  W-ENCC-ENC-CODE     PIC X(5).
   900         16  FILLER              PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  19
* EL689.cbl
   902 01  FILLER                      PIC  X(22)
   903                                 VALUE 'INTERFACE AREA STARTS:'.
   904*    COPY ELCINTF.
   905******************************************************************
   906*                                                                *
   907*                                                                *
   908*                            ELCINTF.                            *
   909*                            VMOD=2.017                          *
   910*                                                                *
   911*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   912*                                                                *
   913*       LENGTH = 1024                                            *
   914*                                                                *
   915******************************************************************
   916*                   C H A N G E   L O G
   917*
   918* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   919*-----------------------------------------------------------------
   920*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   921* EFFECTIVE    NUMBER
   922*-----------------------------------------------------------------
   923* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   924******************************************************************
   925 01  PROGRAM-INTERFACE-BLOCK.
   926     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   927     12  PI-CALLING-PROGRAM              PIC X(8).
   928     12  PI-SAVED-PROGRAM-1              PIC X(8).
   929     12  PI-SAVED-PROGRAM-2              PIC X(8).
   930     12  PI-SAVED-PROGRAM-3              PIC X(8).
   931     12  PI-SAVED-PROGRAM-4              PIC X(8).
   932     12  PI-SAVED-PROGRAM-5              PIC X(8).
   933     12  PI-SAVED-PROGRAM-6              PIC X(8).
   934     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   935     12  PI-COMPANY-ID                   PIC XXX.
   936     12  PI-COMPANY-CD                   PIC X.
   937
   938     12  PI-COMPANY-PASSWORD             PIC X(8).
   939
   940     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   941
   942     12  PI-CONTROL-IN-PROGRESS.
   943         16  PI-CARRIER                  PIC X.
   944         16  PI-GROUPING                 PIC X(6).
   945         16  PI-STATE                    PIC XX.
   946         16  PI-ACCOUNT                  PIC X(10).
   947         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   948                                         PIC X(10).
   949         16  PI-CLAIM-CERT-GRP.
   950             20  PI-CLAIM-NO             PIC X(7).
   951             20  PI-CERT-NO.
   952                 25  PI-CERT-PRIME       PIC X(10).
   953                 25  PI-CERT-SFX         PIC X.
   954             20  PI-CERT-EFF-DT          PIC XX.
   955         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   956             20  PI-PLAN-CODE            PIC X(2).
   957             20  PI-REVISION-NUMBER      PIC X(3).
   958             20  PI-PLAN-EFF-DT          PIC X(2).
   959             20  PI-PLAN-EXP-DT          PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  20
* EL689.cbl
   960             20  FILLER                  PIC X(11).
   961         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   962             20  PI-OE-REFERENCE-1.
   963                 25  PI-OE-REF-1-PRIME   PIC X(18).
   964                 25  PI-OE-REF-1-SUFF    PIC XX.
   965
   966     12  PI-SESSION-IN-PROGRESS          PIC X.
   967         88  CLAIM-SESSION                   VALUE '1'.
   968         88  CREDIT-SESSION                  VALUE '2'.
   969         88  WARRANTY-SESSION                VALUE '3'.
   970         88  MORTGAGE-SESSION                VALUE '4'.
   971         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   972
   973
   974*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   975
   976     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   977     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   978
   979     12  PI-CREDIT-USER                  PIC X.
   980         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   981         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   982
   983     12  PI-CLAIM-USER                   PIC X.
   984         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   985         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   986
   987     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   988         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   989         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   990         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   991         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   992         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   993
   994     12  PI-PROCESSOR-ID                 PIC X(4).
   995
   996     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   997
   998     12  PI-MEMBER-CAPTION               PIC X(10).
   999
  1000     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1001         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1002
  1003     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1004     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1005     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1006     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1007
  1008     12  PI-AH-OVERRIDE-L1               PIC X.
  1009     12  PI-AH-OVERRIDE-L2               PIC XX.
  1010     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1011     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1012
  1013     12  PI-NEW-SYSTEM                   PIC X(2).
  1014
  1015     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1016     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1017         88  PI-USES-PAID-TO                 VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  21
* EL689.cbl
  1018     12  PI-CRDTCRD-SYSTEM.
  1019         16  PI-CRDTCRD-USER             PIC X.
  1020             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1021             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1022         16  PI-CC-MONTH-END-DT          PIC XX.
  1023     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1024
  1025     12  PI-OE-REFERENCE-2.
  1026         16  PI-OE-REF-2-PRIME           PIC X(10).
  1027         16  PI-OE-REF-2-SUFF            PIC X.
  1028
  1029     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1030
  1031     12  PI-LANGUAGE-TYPE                PIC X.
  1032             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1033             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1034             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1035
  1036     12  PI-POLICY-LINKAGE-IND           PIC X.
  1037         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1038         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1039                                                   LOW-VALUES.
  1040
  1041     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1042     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1043         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1044         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1045
  1046     12  PI-PROCESSOR-CSR-IND            PIC X.
  1047         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1048         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1049
  1050     12  FILLER                          PIC X(3).
  1051
  1052     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1053
  1054     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1055         PI-SYSTEM-LEVEL.
  1056
  1057         16  PI-ENTRY-CODES.
  1058             20  PI-ENTRY-CD-1           PIC X.
  1059             20  PI-ENTRY-CD-2           PIC X.
  1060
  1061         16  PI-RETURN-CODES.
  1062             20  PI-RETURN-CD-1          PIC X.
  1063             20  PI-RETURN-CD-2          PIC X.
  1064
  1065         16  PI-UPDATE-STATUS-SAVE.
  1066             20  PI-UPDATE-BY            PIC X(4).
  1067             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1068
  1069         16  PI-LOWER-CASE-LETTERS       PIC X.
  1070             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1071
  1072*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1073*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1074*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1075
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  22
* EL689.cbl
  1076         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1077             88  ST-ACCNT-CNTL               VALUE ' '.
  1078             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1079             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1080             88  ACCNT-CNTL                  VALUE '3'.
  1081             88  CARR-ACCNT-CNTL             VALUE '4'.
  1082
  1083         16  PI-PROCESSOR-CAP-LIST.
  1084             20  PI-SYSTEM-CONTROLS.
  1085                24 PI-SYSTEM-DISPLAY     PIC X.
  1086                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1087                24 PI-SYSTEM-MODIFY      PIC X.
  1088                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1089             20  FILLER                  PIC XX.
  1090             20  PI-DISPLAY-CAP          PIC X.
  1091                 88  DISPLAY-CAP             VALUE 'Y'.
  1092             20  PI-MODIFY-CAP           PIC X.
  1093                 88  MODIFY-CAP              VALUE 'Y'.
  1094             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1095                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1096             20  PI-FORCE-CAP            PIC X.
  1097                 88  FORCE-CAP               VALUE 'Y'.
  1098
  1099         16  PI-PROGRAM-CONTROLS.
  1100             20  PI-PGM-PRINT-OPT        PIC X.
  1101             20  PI-PGM-FORMAT-OPT       PIC X.
  1102             20  PI-PGM-PROCESS-OPT      PIC X.
  1103             20  PI-PGM-TOTALS-OPT       PIC X.
  1104
  1105         16  PI-HELP-INTERFACE.
  1106             20  PI-LAST-ERROR-NO        PIC X(4).
  1107             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1108
  1109         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1110             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1111
  1112         16  PI-CR-CONTROL-IN-PROGRESS.
  1113             20  PI-CR-CARRIER           PIC X.
  1114             20  PI-CR-GROUPING          PIC X(6).
  1115             20  PI-CR-STATE             PIC XX.
  1116             20  PI-CR-ACCOUNT           PIC X(10).
  1117             20  PI-CR-FIN-RESP          PIC X(10).
  1118             20  PI-CR-TYPE              PIC X.
  1119
  1120         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1121
  1122         16  PI-CR-MONTH-END-DT          PIC XX.
  1123
  1124         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1125             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1126             88  PI-ZERO-CARRIER             VALUE '1'.
  1127             88  PI-ZERO-GROUPING            VALUE '2'.
  1128             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1129
  1130         16  PI-CARRIER-SECURITY         PIC X.
  1131             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1132
  1133         16  PI-ACCOUNT-SECURITY         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  23
* EL689.cbl
  1134             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1135             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1136
  1137         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1138             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1139                                         INDEXED BY PI-ACCESS-NDX
  1140                                         PIC X.
  1141
  1142         16  PI-GA-BILLING-CONTROL       PIC X.
  1143             88  PI-GA-BILLING               VALUE '1'.
  1144
  1145         16  PI-MAIL-PROCESSING          PIC X.
  1146             88  PI-MAIL-YES                 VALUE 'Y'.
  1147
  1148         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1149
  1150         16  PI-AR-SYSTEM.
  1151             20  PI-AR-PROCESSING-CNTL   PIC X.
  1152                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1153             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1154             20  PI-AR-MONTH-END-DT      PIC XX.
  1155
  1156         16  PI-MP-SYSTEM.
  1157             20  PI-MORTGAGE-USER            PIC X.
  1158                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1159                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1160             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1161                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1162                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1163                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1164                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1165                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1166             20  PI-MP-MONTH-END-DT          PIC XX.
  1167             20  PI-MP-REFERENCE-NO.
  1168                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1169                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1170
  1171         16  PI-LABEL-CONTROL            PIC X(01).
  1172             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1173             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1174
  1175         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1176             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1177
  1178         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1179             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1180             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1181
  1182         16  FILLER                      PIC X(14).
  1183
  1184     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1185******************************************************************
  1186     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
  1187*    COPY ELC1042.
  1188******************************************************************
  1189*                                                                *
  1190*                                                                *
  1191*                           ELC1042                              *
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  24
* EL689.cbl
  1192*                            VMOD=2.002                          *
  1193*                                                                *
  1194*    NOTE                                                        *
  1195*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  1196*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  1197*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  1198*        TO THESE PROGRAMS.                                      *
  1199*                                                                *
  1200*    NOTE                                                        *
  1201*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  1202*        USE ONLY!                                               *
  1203*                                                                *
  1204******************************************************************
  1205
  1206         16  PI-1042-WA.
  1207             20  PI-ACTION       PIC  X(01).
  1208                 88 PI-SHOW-MODE           VALUE '1'.
  1209                 88 PI-CLEAR-MODE          VALUE '2'.
  1210                 88 PI-CREATE-MODE         VALUE '3'.
  1211             20  PI-COMM-CONTROL PIC  X(12).
  1212             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1213             20  PI-EOF-SW       PIC  X(01).
  1214                 88  PI-FILE-EOF           VALUE 'Y'.
  1215             20  PI-FILETYP      PIC  X(01).
  1216             20  PI-FORM-SQUEEZE-CONTROL
  1217                                 PIC  X(01).
  1218                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1219                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1220             20  PI-LAST-CONTROL PIC  X(12).
  1221             20  PI-TEMP-STOR-ITEMS
  1222                                 PIC S9(04) COMP.
  1223             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1224             20  PI-UPDATE-SW    PIC  9(01).
  1225                 88 ANY-UPDATES            VALUE 1.
  1226             20  PI-104-SCREEN-SENT-IND
  1227                                 PIC  X(01).
  1228                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1229                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1230             20  PI-1042-SCREEN-SENT-IND
  1231                                 PIC  X(01).
  1232                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1233                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1234             20  PI-1042-ARCHIVE-IND
  1235                                 PIC  X(01).
  1236                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1237             20  FILLER          PIC  X(29).
  1238*    COPY ELC689PI.
  1239******************************************************************
  1240*                                                                *
  1241*                            ELC689PI                            *
  1242*                            VMOD=2.003                          *
  1243*                                                                *
  1244*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  1245*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  1246*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  1247*                                                                *
  1248*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  1249*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  25
* EL689.cbl
  1250*    BETWEEN PROGRAMS.                                           *
  1251*                                                                *
  1252*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  1253*                                                                *
  1254*               EL631 - EL689  - EL6891 - EL6892                 *
  1255*                                                                *
  1256******************************************************************
  1257*                   C H A N G E   L O G
  1258*
  1259* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1260*-----------------------------------------------------------------
  1261*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1262* EFFECTIVE    NUMBER
  1263*-----------------------------------------------------------------
  1264* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  1265* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  1266* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1267******************************************************************
  1268
  1269
  1270         16  PI-689-WORK-AREA.
  1271             20  PI-689-ALT-PRINTER-ID
  1272                                 PIC  X(04).
  1273             20  PI-689-ARCHIVE-NUMBER
  1274                                 PIC  9(08).
  1275             20  PI-689-ARCHIVE-SW
  1276                                 PIC  X(01).
  1277                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  1278             20  PI-689-DATA-SOURCE
  1279                                 PIC  X(01).
  1280                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  1281                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  1282                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  1283                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  1284                 88  PI-689-SRC-CHECKS         VALUE '5'.
  1285             20  PI-689-ERROR-IND
  1286                                 PIC  X(01).
  1287                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  1288             20  PI-689-ERROR    PIC  9(04).
  1289                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  1290                 88  PI-689-FATAL-ERROR
  1291                     VALUES 0004 0006 0008 0013 0023 0029 0033
  1292                            0042 0047 0051 0066 0067 0070
  1293                            0168 0169 0174 0175 0176 0177 0179
  1294                            0180 0181 0182 0184 0185 0189 0190
  1295                            0191
  1296                            0215 0279 0280
  1297                            0412 0413 0454
  1298                            0533 0537
  1299                            2055 2114 2208 2209 2216 2232 2369
  1300                            2398 2433 2908 2999
  1301                            3000 3770 3771 3775
  1302                            7250 7365 7367 7368 7369 7370 7371
  1303                            7272 7373 7374 7376 7377 7378 7379
  1304                            7381 7388 7390 7393 7395 7396 7398
  1305                            9095 9096 9281 9298 9299 9320 9327
  1306                            9426 9427.
  1307                 88  PI-689-STOP-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  26
* EL689.cbl
  1308                     VALUES 0004 0008 0013 0023 0029 0033
  1309                            0042 0047 0066 0067 0070
  1310                            0168 0169 0174 0175 0176 0177
  1311                            0181 0182 0184 0185 0189 0190
  1312                            0279 0280
  1313                            0412 0413 0454
  1314                            2055 2208 2209 2216 2232
  1315                            2398 2999
  1316                            3000 3770 3771 3775
  1317                            7250 7365 7369 7370 7371
  1318                            7272 7373 7374 7376 7377 7378 7379
  1319                            7381 7388 7390 7393 7396 7398
  1320                            9095 9096 9299 9320 9426.
  1321             20  PI-689-FOLLOW-UP-DATE
  1322                                 PIC  X(02).
  1323             20  PI-689-FORM-NUMBER
  1324                                 PIC  X(04).
  1325             20  PI-689-LABEL-SOURCE
  1326                                 PIC X(01).
  1327                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  1328                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  1329                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  1330                 88  PI-689-SOURCE-COMP     VALUE '4'.
  1331                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  1332                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  1333                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  1334             20  PI-689-NUMBER-COPIES
  1335                                 PIC  9(01).
  1336             20  PI-689-NUMBER-LABEL-LINES
  1337                                 PIC  9(01).
  1338             20  PI-689-NUMBER-TEXT-RECORDS
  1339                                 PIC  9(03).
  1340             20  PI-689-PRINT-ORDER-SW
  1341                                 PIC  X(01).
  1342                 88  PI-689-PRINT-FIRST     VALUE '1'.
  1343                 88  PI-689-PRINT-SECOND    VALUE '2'.
  1344                 88  PI-689-PRINT-LATER     VALUE '3'.
  1345                 88  PI-689-PRINT-ONLY      VALUE '4'.
  1346             20  PI-689-PRINT-RESTRICTION
  1347                                 PIC  X(01).
  1348                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  1349                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  1350                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  1351             20  PI-689-PRINT-SW PIC  X(01).
  1352                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  1353             20  PI-689-RESEND-DATE-1
  1354                                 PIC  X(02).
  1355             20  PI-689-RESEND-LETR-1
  1356                                 PIC X(4).
  1357             20  PI-689-TEMP-STOR-ID
  1358                                 PIC  X(08).
  1359             20  PI-689-USE-SCREEN-IND
  1360                                 PIC  X(01).
  1361                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  1362             20  PI-689-ARCH-POINTER
  1363                                 PIC S9(08) COMP.
  1364                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  1365             20  PI-689-ARCT-POINTER
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  27
* EL689.cbl
  1366                                 PIC S9(08) COMP.
  1367                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  1368             20  PI-689-VARIABLE-DATA-GRP.
  1369                 24  PI-689-VARIABLE-DATA-1
  1370                                 PIC  X(30).
  1371                 24  PI-689-VARIABLE-DATA-2
  1372                                 PIC  X(30).
  1373                 24  PI-689-VARIABLE-DATA-3
  1374                                 PIC  X(30).
  1375                 24  PI-689-VARIABLE-DATA-4
  1376                                 PIC  X(30).
  1377
  1378         16  PI-689-KEY-DATA-FIELDS.
  1379             20  PI-689-ACCOUNT  PIC  X(10).
  1380             20  PI-689-CARRIER  PIC  X(01).
  1381             20  PI-689-CERT-NO.
  1382                 24  PI-689-CERT-PRIME
  1383                                 PIC  X(10).
  1384                 24  PI-689-CERT-SFX
  1385                                 PIC  X(01).
  1386             20  PI-689-CHG-SEQ-NO
  1387                                 PIC S9(04)    COMP.
  1388             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  1389                                 PIC  X(02).
  1390             20  PI-689-ENTRY-BATCH
  1391                                 PIC  X(06).
  1392             20  PI-689-EFF-DATE PIC  X(02).
  1393             20  PI-689-EXP-DATE PIC  X(02).
  1394             20  PI-689-GROUPING PIC  X(06).
  1395             20  PI-689-RESP-PERSON
  1396                                 PIC  X(10).
  1397             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  1398             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  1399                                 PIC  X(04).
  1400             20  PI-689-STATE    PIC  X(02).
  1401             20  PI-689-TYPE     PIC  X(01).
  1402             20  PI-689-CONTROL  PIC S9(08)    COMP.
  1403             20  PI-689-ALT-SEQ-NO
  1404                                 PIC S9(04)    COMP.
  1405         16  PI-689-DATE-EDIT    PIC  X(08).
  1406         16  PI-689-FOLLOW-UP-EDIT
  1407                                 PIC  X(08).
  1408         16  PI-689-RESEND1-EDIT PIC  X(08).
  1409         16  PI-689-SEQ-EDIT     PIC  X(08).
  1410         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  1411         16  PI-689-LBL-OVERRIDE PIC  X(01).
  1412             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  1413         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  1414         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
  1415         16  PI-PROMPT-IND       PIC X(1).
  1416         16  PI-CERT-FORM-ID     PIC X(5).
  1417         16  PI-PRINT-NOW        PIC X(1).
  1418         16  PI-ENCLOSURE-CD     PIC X(3).
  1419         16  PI-CERT-REQ-IND     PIC X(1).
  1420         16  PI-ENDT-ARCH-NO     PIC 9(8).
  1421         16  PI-REASON-REQ-IND   PIC X(1).
  1422         16  FILLER              PIC X(244).
  1423*        16  FILLER                        PIC X(276).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  28
* EL689.cbl
  1424*        16  FILLER                        PIC X(280).
  1425
  1426 01  FILLER                      PIC  X(20)
  1427                                 VALUE ':INTERFACE AREA ENDS'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  29
* EL689.cbl
  1429 01  FILLER                      PIC  X(16)
  1430                        VALUE 'MAP AREA STARTS:'.
  1431*    COPY EL689S.
  1432 01  EL689AI.
  1433     05  FILLER            PIC  X(0012).
  1434*    -------------------------------
  1435     05  RUNDTEL PIC S9(0004) COMP.
  1436     05  RUNDTEF PIC  X(0001).
  1437     05  FILLER REDEFINES RUNDTEF.
  1438         10  RUNDTEA PIC  X(0001).
  1439     05  RUNDTEI PIC  X(0008).
  1440*    -------------------------------
  1441     05  RUNTIMEL PIC S9(0004) COMP.
  1442     05  RUNTIMEF PIC  X(0001).
  1443     05  FILLER REDEFINES RUNTIMEF.
  1444         10  RUNTIMEA PIC  X(0001).
  1445     05  RUNTIMEI PIC  X(0005).
  1446*    -------------------------------
  1447     05  HOSTL PIC S9(0004) COMP.
  1448     05  HOSTF PIC  X(0001).
  1449     05  FILLER REDEFINES HOSTF.
  1450         10  HOSTA PIC  X(0001).
  1451     05  HOSTI PIC  X(0010).
  1452*    -------------------------------
  1453     05  SYSL PIC S9(0004) COMP.
  1454     05  SYSF PIC  X(0001).
  1455     05  FILLER REDEFINES SYSF.
  1456         10  SYSA PIC  X(0001).
  1457     05  SYSI PIC  X(0008).
  1458*    -------------------------------
  1459     05  COMPANYL PIC S9(0004) COMP.
  1460     05  COMPANYF PIC  X(0001).
  1461     05  FILLER REDEFINES COMPANYF.
  1462         10  COMPANYA PIC  X(0001).
  1463     05  COMPANYI PIC  X(0003).
  1464*    -------------------------------
  1465     05  USERIDL PIC S9(0004) COMP.
  1466     05  USERIDF PIC  X(0001).
  1467     05  FILLER REDEFINES USERIDF.
  1468         10  USERIDA PIC  X(0001).
  1469     05  USERIDI PIC  X(0004).
  1470*    -------------------------------
  1471     05  MAINTL PIC S9(0004) COMP.
  1472     05  MAINTF PIC  X(0001).
  1473     05  FILLER REDEFINES MAINTF.
  1474         10  MAINTA PIC  X(0001).
  1475     05  MAINTI PIC  X(0001).
  1476*    -------------------------------
  1477     05  FORML PIC S9(0004) COMP.
  1478     05  FORMF PIC  X(0001).
  1479     05  FILLER REDEFINES FORMF.
  1480         10  FORMA PIC  X(0001).
  1481     05  FORMI PIC  X(0004).
  1482*    -------------------------------
  1483     05  ARCHNUML PIC S9(0004) COMP.
  1484     05  ARCHNUMF PIC  X(0001).
  1485     05  FILLER REDEFINES ARCHNUMF.
  1486         10  ARCHNUMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  30
* EL689.cbl
  1487     05  ARCHNUMI PIC  99999999.
  1488*    -------------------------------
  1489     05  PRTNOWL PIC S9(0004) COMP.
  1490     05  PRTNOWF PIC  X(0001).
  1491     05  FILLER REDEFINES PRTNOWF.
  1492         10  PRTNOWA PIC  X(0001).
  1493     05  PRTNOWI PIC  X(0001).
  1494*    -------------------------------
  1495     05  CARRIERL PIC S9(0004) COMP.
  1496     05  CARRIERF PIC  X(0001).
  1497     05  FILLER REDEFINES CARRIERF.
  1498         10  CARRIERA PIC  X(0001).
  1499     05  CARRIERI PIC  X(0001).
  1500*    -------------------------------
  1501     05  GROUPL PIC S9(0004) COMP.
  1502     05  GROUPF PIC  X(0001).
  1503     05  FILLER REDEFINES GROUPF.
  1504         10  GROUPA PIC  X(0001).
  1505     05  GROUPI PIC  X(0006).
  1506*    -------------------------------
  1507     05  STATEL PIC S9(0004) COMP.
  1508     05  STATEF PIC  X(0001).
  1509     05  FILLER REDEFINES STATEF.
  1510         10  STATEA PIC  X(0001).
  1511     05  STATEI PIC  X(0002).
  1512*    -------------------------------
  1513     05  ACCTL PIC S9(0004) COMP.
  1514     05  ACCTF PIC  X(0001).
  1515     05  FILLER REDEFINES ACCTF.
  1516         10  ACCTA PIC  X(0001).
  1517     05  ACCTI PIC  X(0010).
  1518*    -------------------------------
  1519     05  CERTL PIC S9(0004) COMP.
  1520     05  CERTF PIC  X(0001).
  1521     05  FILLER REDEFINES CERTF.
  1522         10  CERTA PIC  X(0001).
  1523     05  CERTI PIC  X(0010).
  1524*    -------------------------------
  1525     05  SFXL PIC S9(0004) COMP.
  1526     05  SFXF PIC  X(0001).
  1527     05  FILLER REDEFINES SFXF.
  1528         10  SFXA PIC  X(0001).
  1529     05  SFXI PIC  X(0001).
  1530*    -------------------------------
  1531     05  TYPEL PIC S9(0004) COMP.
  1532     05  TYPEF PIC  X(0001).
  1533     05  FILLER REDEFINES TYPEF.
  1534         10  TYPEA PIC  X(0001).
  1535     05  TYPEI PIC  X(0001).
  1536*    -------------------------------
  1537     05  DATEL PIC S9(0004) COMP.
  1538     05  DATEF PIC  X(0001).
  1539     05  FILLER REDEFINES DATEF.
  1540         10  DATEA PIC  X(0001).
  1541     05  DATEI PIC  X(0008).
  1542*    -------------------------------
  1543     05  FOLLOWL PIC S9(0004) COMP.
  1544     05  FOLLOWF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  31
* EL689.cbl
  1545     05  FILLER REDEFINES FOLLOWF.
  1546         10  FOLLOWA PIC  X(0001).
  1547     05  FOLLOWI PIC  X(0008).
  1548*    -------------------------------
  1549     05  RESEND1L PIC S9(0004) COMP.
  1550     05  RESEND1F PIC  X(0001).
  1551     05  FILLER REDEFINES RESEND1F.
  1552         10  RESEND1A PIC  X(0001).
  1553     05  RESEND1I PIC  X(0008).
  1554*    -------------------------------
  1555     05  ENCL PIC S9(0004) COMP.
  1556     05  ENCF PIC  X(0001).
  1557     05  FILLER REDEFINES ENCF.
  1558         10  ENCA PIC  X(0001).
  1559     05  ENCI PIC  X(0003).
  1560*    -------------------------------
  1561     05  ENDARCHL PIC S9(0004) COMP.
  1562     05  ENDARCHF PIC  X(0001).
  1563     05  FILLER REDEFINES ENDARCHF.
  1564         10  ENDARCHA PIC  X(0001).
  1565     05  ENDARCHI PIC  99999999.
  1566*    -------------------------------
  1567     05  CERTIDL PIC S9(0004) COMP.
  1568     05  CERTIDF PIC  X(0001).
  1569     05  FILLER REDEFINES CERTIDF.
  1570         10  CERTIDA PIC  X(0001).
  1571     05  CERTIDI PIC  X(0005).
  1572*    -------------------------------
  1573     05  ADDRSL PIC S9(0004) COMP.
  1574     05  ADDRSF PIC  X(0001).
  1575     05  FILLER REDEFINES ADDRSF.
  1576         10  ADDRSA PIC  X(0001).
  1577     05  ADDRSI PIC  X(0001).
  1578*    -------------------------------
  1579     05  PRINTERL PIC S9(0004) COMP.
  1580     05  PRINTERF PIC  X(0001).
  1581     05  FILLER REDEFINES PRINTERF.
  1582         10  PRINTERA PIC  X(0001).
  1583     05  PRINTERI PIC  X(0004).
  1584*    -------------------------------
  1585     05  COPIESL PIC S9(0004) COMP.
  1586     05  COPIESF PIC  X(0001).
  1587     05  FILLER REDEFINES COPIESF.
  1588         10  COPIESA PIC  X(0001).
  1589     05  COPIESI PIC  X(0001).
  1590*    -------------------------------
  1591     05  DATASORL PIC S9(0004) COMP.
  1592     05  DATASORF PIC  X(0001).
  1593     05  FILLER REDEFINES DATASORF.
  1594         10  DATASORA PIC  X(0001).
  1595     05  DATASORI PIC  X(0001).
  1596*    -------------------------------
  1597     05  ADDRLBLL PIC S9(0004) COMP.
  1598     05  ADDRLBLF PIC  X(0001).
  1599     05  FILLER REDEFINES ADDRLBLF.
  1600         10  ADDRLBLA PIC  X(0001).
  1601     05  ADDRLBLI PIC  X(0001).
  1602*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  32
* EL689.cbl
  1603     05  RPERSONL PIC S9(0004) COMP.
  1604     05  RPERSONF PIC  X(0001).
  1605     05  FILLER REDEFINES RPERSONF.
  1606         10  RPERSONA PIC  X(0001).
  1607     05  RPERSONI PIC  X(0010).
  1608*    -------------------------------
  1609     05  BENTRYL PIC S9(0004) COMP.
  1610     05  BENTRYF PIC  X(0001).
  1611     05  FILLER REDEFINES BENTRYF.
  1612         10  BENTRYA PIC  X(0001).
  1613     05  BENTRYI PIC  X(0006).
  1614*    -------------------------------
  1615     05  SEQL PIC S9(0004) COMP.
  1616     05  SEQF PIC  X(0001).
  1617     05  FILLER REDEFINES SEQF.
  1618         10  SEQA PIC  X(0001).
  1619     05  SEQI PIC  X(0008).
  1620*    -------------------------------
  1621     05  BCSEQL PIC S9(0004) COMP.
  1622     05  BCSEQF PIC  X(0001).
  1623     05  FILLER REDEFINES BCSEQF.
  1624         10  BCSEQA PIC  X(0001).
  1625     05  BCSEQI PIC  X(0004).
  1626*    -------------------------------
  1627     05  L1L PIC S9(0004) COMP.
  1628     05  L1F PIC  X(0001).
  1629     05  FILLER REDEFINES L1F.
  1630         10  L1A PIC  X(0001).
  1631     05  L1I PIC  X(0003).
  1632*    -------------------------------
  1633     05  TEXT1L PIC S9(0004) COMP.
  1634     05  TEXT1F PIC  X(0001).
  1635     05  FILLER REDEFINES TEXT1F.
  1636         10  TEXT1A PIC  X(0001).
  1637     05  TEXT1I PIC  X(0070).
  1638*    -------------------------------
  1639     05  L2L PIC S9(0004) COMP.
  1640     05  L2F PIC  X(0001).
  1641     05  FILLER REDEFINES L2F.
  1642         10  L2A PIC  X(0001).
  1643     05  L2I PIC  X(0003).
  1644*    -------------------------------
  1645     05  TEXT2L PIC S9(0004) COMP.
  1646     05  TEXT2F PIC  X(0001).
  1647     05  FILLER REDEFINES TEXT2F.
  1648         10  TEXT2A PIC  X(0001).
  1649     05  TEXT2I PIC  X(0070).
  1650*    -------------------------------
  1651     05  L3L PIC S9(0004) COMP.
  1652     05  L3F PIC  X(0001).
  1653     05  FILLER REDEFINES L3F.
  1654         10  L3A PIC  X(0001).
  1655     05  L3I PIC  X(0003).
  1656*    -------------------------------
  1657     05  TEXT3L PIC S9(0004) COMP.
  1658     05  TEXT3F PIC  X(0001).
  1659     05  FILLER REDEFINES TEXT3F.
  1660         10  TEXT3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  33
* EL689.cbl
  1661     05  TEXT3I PIC  X(0070).
  1662*    -------------------------------
  1663     05  L4L PIC S9(0004) COMP.
  1664     05  L4F PIC  X(0001).
  1665     05  FILLER REDEFINES L4F.
  1666         10  L4A PIC  X(0001).
  1667     05  L4I PIC  X(0003).
  1668*    -------------------------------
  1669     05  TEXT4L PIC S9(0004) COMP.
  1670     05  TEXT4F PIC  X(0001).
  1671     05  FILLER REDEFINES TEXT4F.
  1672         10  TEXT4A PIC  X(0001).
  1673     05  TEXT4I PIC  X(0070).
  1674*    -------------------------------
  1675     05  L5L PIC S9(0004) COMP.
  1676     05  L5F PIC  X(0001).
  1677     05  FILLER REDEFINES L5F.
  1678         10  L5A PIC  X(0001).
  1679     05  L5I PIC  X(0003).
  1680*    -------------------------------
  1681     05  TEXT5L PIC S9(0004) COMP.
  1682     05  TEXT5F PIC  X(0001).
  1683     05  FILLER REDEFINES TEXT5F.
  1684         10  TEXT5A PIC  X(0001).
  1685     05  TEXT5I PIC  X(0070).
  1686*    -------------------------------
  1687     05  L6L PIC S9(0004) COMP.
  1688     05  L6F PIC  X(0001).
  1689     05  FILLER REDEFINES L6F.
  1690         10  L6A PIC  X(0001).
  1691     05  L6I PIC  X(0003).
  1692*    -------------------------------
  1693     05  TEXT6L PIC S9(0004) COMP.
  1694     05  TEXT6F PIC  X(0001).
  1695     05  FILLER REDEFINES TEXT6F.
  1696         10  TEXT6A PIC  X(0001).
  1697     05  TEXT6I PIC  X(0070).
  1698*    -------------------------------
  1699     05  L7L PIC S9(0004) COMP.
  1700     05  L7F PIC  X(0001).
  1701     05  FILLER REDEFINES L7F.
  1702         10  L7A PIC  X(0001).
  1703     05  L7I PIC  X(0003).
  1704*    -------------------------------
  1705     05  TEXT7L PIC S9(0004) COMP.
  1706     05  TEXT7F PIC  X(0001).
  1707     05  FILLER REDEFINES TEXT7F.
  1708         10  TEXT7A PIC  X(0001).
  1709     05  TEXT7I PIC  X(0070).
  1710*    -------------------------------
  1711     05  L8L PIC S9(0004) COMP.
  1712     05  L8F PIC  X(0001).
  1713     05  FILLER REDEFINES L8F.
  1714         10  L8A PIC  X(0001).
  1715     05  L8I PIC  X(0003).
  1716*    -------------------------------
  1717     05  TEXT8L PIC S9(0004) COMP.
  1718     05  TEXT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  34
* EL689.cbl
  1719     05  FILLER REDEFINES TEXT8F.
  1720         10  TEXT8A PIC  X(0001).
  1721     05  TEXT8I PIC  X(0070).
  1722*    -------------------------------
  1723     05  L9L PIC S9(0004) COMP.
  1724     05  L9F PIC  X(0001).
  1725     05  FILLER REDEFINES L9F.
  1726         10  L9A PIC  X(0001).
  1727     05  L9I PIC  X(0003).
  1728*    -------------------------------
  1729     05  TEXT9L PIC S9(0004) COMP.
  1730     05  TEXT9F PIC  X(0001).
  1731     05  FILLER REDEFINES TEXT9F.
  1732         10  TEXT9A PIC  X(0001).
  1733     05  TEXT9I PIC  X(0070).
  1734*    -------------------------------
  1735     05  L10L PIC S9(0004) COMP.
  1736     05  L10F PIC  X(0001).
  1737     05  FILLER REDEFINES L10F.
  1738         10  L10A PIC  X(0001).
  1739     05  L10I PIC  X(0003).
  1740*    -------------------------------
  1741     05  TEXT10L PIC S9(0004) COMP.
  1742     05  TEXT10F PIC  X(0001).
  1743     05  FILLER REDEFINES TEXT10F.
  1744         10  TEXT10A PIC  X(0001).
  1745     05  TEXT10I PIC  X(0070).
  1746*    -------------------------------
  1747     05  L11L PIC S9(0004) COMP.
  1748     05  L11F PIC  X(0001).
  1749     05  FILLER REDEFINES L11F.
  1750         10  L11A PIC  X(0001).
  1751     05  L11I PIC  X(0003).
  1752*    -------------------------------
  1753     05  TEXT11L PIC S9(0004) COMP.
  1754     05  TEXT11F PIC  X(0001).
  1755     05  FILLER REDEFINES TEXT11F.
  1756         10  TEXT11A PIC  X(0001).
  1757     05  TEXT11I PIC  X(0070).
  1758*    -------------------------------
  1759     05  L12L PIC S9(0004) COMP.
  1760     05  L12F PIC  X(0001).
  1761     05  FILLER REDEFINES L12F.
  1762         10  L12A PIC  X(0001).
  1763     05  L12I PIC  X(0003).
  1764*    -------------------------------
  1765     05  TEXT12L PIC S9(0004) COMP.
  1766     05  TEXT12F PIC  X(0001).
  1767     05  FILLER REDEFINES TEXT12F.
  1768         10  TEXT12A PIC  X(0001).
  1769     05  TEXT12I PIC  X(0070).
  1770*    -------------------------------
  1771     05  ERRMSGL PIC S9(0004) COMP.
  1772     05  ERRMSGF PIC  X(0001).
  1773     05  FILLER REDEFINES ERRMSGF.
  1774         10  ERRMSGA PIC  X(0001).
  1775     05  ERRMSGI PIC  X(0079).
  1776*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  35
* EL689.cbl
  1777     05  ENTERPFL PIC S9(0004) COMP.
  1778     05  ENTERPFF PIC  X(0001).
  1779     05  FILLER REDEFINES ENTERPFF.
  1780         10  ENTERPFA PIC  X(0001).
  1781     05  ENTERPFI PIC  99.
  1782*    -------------------------------
  1783     05  PF8HDL PIC S9(0004) COMP.
  1784     05  PF8HDF PIC  X(0001).
  1785     05  FILLER REDEFINES PF8HDF.
  1786         10  PF8HDA PIC  X(0001).
  1787     05  PF8HDI PIC  X(0022).
  1788 01  EL689AO REDEFINES EL689AI.
  1789     05  FILLER            PIC  X(0012).
  1790*    -------------------------------
  1791     05  FILLER            PIC  X(0003).
  1792     05  RUNDTEO PIC  X(0008).
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  RUNTIMEO PIC  99.99.
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  HOSTO PIC  X(0010).
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  SYSO PIC  X(0008).
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  COMPANYO PIC  X(0003).
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  USERIDO PIC  X(0004).
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  MAINTO PIC  X(0001).
  1811*    -------------------------------
  1812     05  FILLER            PIC  X(0003).
  1813     05  FORMO PIC  X(0004).
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  ARCHNUMO PIC  99999999.
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  PRTNOWO PIC  X(0001).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  CARRIERO PIC  X(0001).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  GROUPO PIC  X(0006).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  STATEO PIC  X(0002).
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  ACCTO PIC  X(0010).
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  CERTO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  36
* EL689.cbl
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  SFXO PIC  X(0001).
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  TYPEO PIC  X(0001).
  1841*    -------------------------------
  1842     05  FILLER            PIC  X(0003).
  1843     05  DATEO PIC  X(0008).
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  FOLLOWO PIC  X(0008).
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  RESEND1O PIC  X(0008).
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  ENCO PIC  X(0003).
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  ENDARCHO PIC  99999999.
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  CERTIDO PIC  X(0005).
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  ADDRSO PIC  X(0001).
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  PRINTERO PIC  X(0004).
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
  1867     05  COPIESO PIC  X(0001).
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
  1870     05  DATASORO PIC  X(0001).
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  ADDRLBLO PIC  X(0001).
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  RPERSONO PIC  X(0010).
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  BENTRYO PIC  X(0006).
  1880*    -------------------------------
  1881     05  FILLER            PIC  X(0003).
  1882     05  SEQO PIC  X(0008).
  1883*    -------------------------------
  1884     05  FILLER            PIC  X(0003).
  1885     05  BCSEQO PIC  X(0004).
  1886*    -------------------------------
  1887     05  FILLER            PIC  X(0003).
  1888     05  L1O PIC  X(0003).
  1889*    -------------------------------
  1890     05  FILLER            PIC  X(0003).
  1891     05  TEXT1O PIC  X(0070).
  1892*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  37
* EL689.cbl
  1893     05  FILLER            PIC  X(0003).
  1894     05  L2O PIC  X(0003).
  1895*    -------------------------------
  1896     05  FILLER            PIC  X(0003).
  1897     05  TEXT2O PIC  X(0070).
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  L3O PIC  X(0003).
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  TEXT3O PIC  X(0070).
  1904*    -------------------------------
  1905     05  FILLER            PIC  X(0003).
  1906     05  L4O PIC  X(0003).
  1907*    -------------------------------
  1908     05  FILLER            PIC  X(0003).
  1909     05  TEXT4O PIC  X(0070).
  1910*    -------------------------------
  1911     05  FILLER            PIC  X(0003).
  1912     05  L5O PIC  X(0003).
  1913*    -------------------------------
  1914     05  FILLER            PIC  X(0003).
  1915     05  TEXT5O PIC  X(0070).
  1916*    -------------------------------
  1917     05  FILLER            PIC  X(0003).
  1918     05  L6O PIC  X(0003).
  1919*    -------------------------------
  1920     05  FILLER            PIC  X(0003).
  1921     05  TEXT6O PIC  X(0070).
  1922*    -------------------------------
  1923     05  FILLER            PIC  X(0003).
  1924     05  L7O PIC  X(0003).
  1925*    -------------------------------
  1926     05  FILLER            PIC  X(0003).
  1927     05  TEXT7O PIC  X(0070).
  1928*    -------------------------------
  1929     05  FILLER            PIC  X(0003).
  1930     05  L8O PIC  X(0003).
  1931*    -------------------------------
  1932     05  FILLER            PIC  X(0003).
  1933     05  TEXT8O PIC  X(0070).
  1934*    -------------------------------
  1935     05  FILLER            PIC  X(0003).
  1936     05  L9O PIC  X(0003).
  1937*    -------------------------------
  1938     05  FILLER            PIC  X(0003).
  1939     05  TEXT9O PIC  X(0070).
  1940*    -------------------------------
  1941     05  FILLER            PIC  X(0003).
  1942     05  L10O PIC  X(0003).
  1943*    -------------------------------
  1944     05  FILLER            PIC  X(0003).
  1945     05  TEXT10O PIC  X(0070).
  1946*    -------------------------------
  1947     05  FILLER            PIC  X(0003).
  1948     05  L11O PIC  X(0003).
  1949*    -------------------------------
  1950     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  38
* EL689.cbl
  1951     05  TEXT11O PIC  X(0070).
  1952*    -------------------------------
  1953     05  FILLER            PIC  X(0003).
  1954     05  L12O PIC  X(0003).
  1955*    -------------------------------
  1956     05  FILLER            PIC  X(0003).
  1957     05  TEXT12O PIC  X(0070).
  1958*    -------------------------------
  1959     05  FILLER            PIC  X(0003).
  1960     05  ERRMSGO PIC  X(0079).
  1961*    -------------------------------
  1962     05  FILLER            PIC  X(0003).
  1963     05  ENTERPFO PIC  X(0002).
  1964*    -------------------------------
  1965     05  FILLER            PIC  X(0003).
  1966     05  PF8HDO PIC  X(0022).
  1967*    -------------------------------
  1968 01  W-MAP-REDEF REDEFINES EL689AI.
  1969*    12  FILLER                  PIC X(218).
  1970     12  FILLER                  PIC X(267).
  1971     12  EL689RI.
  1972         16  W-TEXT-LINES OCCURS 12 TIMES INDEXED BY W-SC-NDX.
  1973             20  W-SC-LINEL      PIC S9(04) COMP.
  1974             20  W-SC-LINEA      PIC  X(01).
  1975             20  W-SC-LINE       PIC  X(03).
  1976             20  W-SC-TEXTL      PIC S9(04) COMP.
  1977             20  W-SC-TEXTA      PIC  X(01).
  1978             20  W-SC-TEXT       PIC  X(70).
  1979*    12  FILLER                  PIC  X(87).
  1980     12  FILLER                  PIC  X(112).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  39
* EL689.cbl
  1982 01  W-CONSTANT-AREA.
  1983     12  FILLER                  PIC  X(18)
  1984                                 VALUE 'PROGRAM CONSTANTS:'.
  1985     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
  1986     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
  1987     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
  1988     12  W-ENDT-LENGTH           PIC S9(04)  COMP  VALUE +579.
  1989     12  W-NOTE-LENGTH           PIC S9(04)  COMP  VALUE +825.
  1990     12  W-EOBC-LENGTH           PIC S9(04)  COMP  VALUE +350.
  1991     12  W-ENCC-LENGTH           PIC S9(04)  COMP  VALUE +400.
  1992     12  W-MAX-LINES             PIC S9(03) VALUE +300 COMP-3.
  1993     12  W-NUM-LINES-PER-SCREEN  PIC  9(02)        VALUE 12.
  1994     12  W-TS-NUM-REC-IN-GROUP   PIC  9(02)        VALUE 50.
  1995     12  W-TS-LENGTH             PIC S9(04)  COMP  VALUE +3650.
  1996     12  W-TS-MAP-LENGTH         PIC S9(04)  COMP  VALUE +1260.
  1997     12  W-ZEROS                 PIC S9(03) VALUE +000 COMP-3.
  1998
  1999     12  W-ACCT-FILE-ID          PIC  X(08) VALUE 'ERACCT'.
  2000     12  W-ACCT2-FILE-ID         PIC  X(08) VALUE 'ERACCT2'.
  2001     12  W-ARCH-FILE-ID          PIC  X(08) VALUE 'ERARCH'.
  2002     12  W-ARCH2-FILE-ID         PIC  X(08) VALUE 'ERARCH2'.
  2003     12  W-ARCH3-FILE-ID         PIC  X(08) VALUE 'ERARCH3'.
  2004     12  W-ARCH4-FILE-ID         PIC  X(08) VALUE 'ERARCH4'.
  2005     12  W-ARCH5-FILE-ID         PIC  X(08) VALUE 'ERARCH5'.
  2006     12  W-ARCT-FILE-ID          PIC  X(08) VALUE 'ERARCT'.
  2007     12  W-CERT-FILE-ID          PIC  X(08) VALUE 'ELCERT'.
  2008     12  W-CHEK-FILE-ID          PIC  X(08) VALUE 'ERCHEK'.
  2009     12  W-CNTL-FILE-ID          PIC  X(08) VALUE 'ELCNTL'.
  2010     12  W-COMP-FILE-ID          PIC  X(08) VALUE 'ERCOMP'.
  2011     12  W-NOTE-FILE-ID          PIC  X(08) VALUE 'ERNOTE'.
  2012     12  W-EOBC-FILE-ID          PIC  X(08) VALUE 'ELEOBC'.
  2013     12  W-ENCC-FILE-ID          PIC  X(08) VALUE 'ELENCC'.
  2014     12  W-GETMAIN-SPACE         PIC  X(01) VALUE SPACE.
  2015     12  W-LGXX-ID               PIC  X(04) VALUE 'LGXX'.
  2016     12  W-LINK-001              PIC  X(05) VALUE 'EL001'.
  2017     12  W-LINK-004              PIC  X(05) VALUE 'EL004'.
  2018     12  W-LINK-ELDATCV          PIC  X(07) VALUE 'ELDATCV'.
  2019     12  W-LOWER-CASE            PIC  X(26)
  2020         VALUE 'abcdefghijklmnopqrstuvwxyz'.
  2021     12  W-MAIL-FILE-ID          PIC  X(08) VALUE 'ERMAIL'.
  2022     12  W-MAP.
  2023         16  W-MAP-PREFIX        PIC  X(02) VALUE 'EL'.
  2024         16  W-MAP-NUM           PIC  X(04) VALUE '689A'.
  2025         16  W-MAP-FILLER        PIC  X(02) VALUE SPACES.
  2026     12  W-MAPSET                PIC  X(08) VALUE 'EL689S'.
  2027     12  W-PGM-EL1042            PIC  X(08) VALUE 'EL1042'.
  2028     12  W-PGM-EL690             PIC  X(08) VALUE 'EL690'.
  2029     12  W-PGM-EL626             PIC  X(08) VALUE 'EL626'.
  2030     12  W-PNDB-FILE-ID          PIC  X(08) VALUE 'ERPNDB'.
  2031     12  W-PRINT-TRANS           PIC  X(04) VALUE 'EXH5'.
  2032     12  W-PYAJ-FILE-ID          PIC  X(08) VALUE 'ERPYAJ'.
  2033
  2034     12  W-TEXT-FILE-ID          PIC  X(08) VALUE 'ELLETR'.
  2035     12  W-THIS-PGM              PIC  X(08) VALUE 'EL689'.
  2036     12  W-TOP-FORM              PIC  X(70)
  2037                              VALUE '*****TOP OF FORM *****'.
  2038     12  W-TRANSACTION           PIC  X(04) VALUE 'EXH3'.
  2039     12  W-UPPER-CASE            PIC  X(26)
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  40
* EL689.cbl
  2040         VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
  2041     12  W-XCTL-005              PIC  X(05) VALUE 'EL005'.
  2042     12  W-XCTL-010              PIC  X(05) VALUE 'EL010'.
  2043     12  W-XCTL-626              PIC  X(05) VALUE 'EL626'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  41
* EL689.cbl
  2045 01  W-VARIABLE-PROCESS-CNTLS.
  2046     12  FILLER                  PIC  X(26)
  2047                        VALUE 'VARIABLE WORK AREA STARTS:'.
  2048     12  W-NUM-OF-VARIABLES      PIC S9(03) VALUE +189 COMP-3.
  2049     12  W-VAR-HOLD.
  2050         16  W-V1                PIC  X(01).
  2051         16  W-V2                PIC  X(01).
  2052         16  W-V3                PIC  X(01).
  2053     12  FILLER REDEFINES W-VAR-HOLD.
  2054         16  W-VAR-RELATIVE-NUM  PIC  9(03).
  2055     12  W-FIELD-SQUEEZE-IND     PIC  X(01).
  2056         88  W-SQUEEZE-FIELD          VALUE '#'.
  2057
  2058 01  W-SUPPORTED-VARIABLES.
  2059
  2060*****************COMPANY VARIABLES - ELCNTL ********************
  2061*****COMPANY NAME
  2062     12  FILLER                  PIC  X(03) VALUE '001'.
  2063     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2064     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2065     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2066     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2067
  2068*****FULL COMPANY ADDRESS
  2069     12  FILLER                  PIC  X(03) VALUE '002'.
  2070     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2071     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2072     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2073     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2074
  2075     12  FILLER                  PIC  X(03) VALUE '003'.
  2076     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2077     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2078     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2079     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2080
  2081     12  FILLER                  PIC  X(03) VALUE '004'.
  2082     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2083     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2084     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2085     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2086
  2087     12  FILLER                  PIC  X(03) VALUE '005'.
  2088     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2089     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2090     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2091     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2092
  2093     12  FILLER                  PIC  X(03) VALUE '006'.
  2094     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2095     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2096     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2097     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2098
  2099*****REMAINING 4 ARE NOT CURRENTLY USED
  2100     12  FILLER                  PIC  X(03) VALUE '007'.
  2101     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2102     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  42
* EL689.cbl
  2103     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2104     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2105
  2106     12  FILLER                  PIC  X(03) VALUE '008'.
  2107     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2108     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2109     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2110     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2111
  2112     12  FILLER                  PIC  X(03) VALUE '009'.
  2113     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2114     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2115     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2116     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2117
  2118     12  FILLER                  PIC  X(03) VALUE '010'.
  2119     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2120     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2121     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2122     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2123
  2124************ LIFE BENEFIT VARIABLES - ELCNTL *******************
  2125*****LIFE BENEFIT DESCRIPTION
  2126     12  FILLER                  PIC  X(03) VALUE '011'.
  2127     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2128     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2129     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2130     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2131
  2132*****REMAINING 3 ARE NOT CURRENTLY USED
  2133     12  FILLER                  PIC  X(03) VALUE '012'.
  2134     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2135     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2136     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2137     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2138
  2139     12  FILLER                  PIC  X(03) VALUE '013'.
  2140     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2141     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2142     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2143     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2144
  2145     12  FILLER                  PIC  X(03) VALUE '014'.
  2146     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2147     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2148     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2149     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2150
  2151************* A&H BENEFIT VARIABLES - ELCNTL *******************
  2152*****AH BENEFIT DESCRIPTION
  2153     12  FILLER                  PIC  X(03) VALUE '015'.
  2154     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2155     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2156     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2157     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2158
  2159*****ELIMINATION PERIOD
  2160     12  FILLER                  PIC  X(03) VALUE '016'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  43
* EL689.cbl
  2161     12  FILLER                  PIC S9(04) COMP VALUE +2.
  2162     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2163     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2164     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2165
  2166*****REMAINING 3 ARE NOT CURRENTLY USED
  2167     12  FILLER                  PIC  X(03) VALUE '017'.
  2168     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2169     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2170     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2171     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2172
  2173     12  FILLER                  PIC  X(03) VALUE '018'.
  2174     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2175     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2176     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2177     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2178
  2179     12  FILLER                  PIC  X(03) VALUE '019'.
  2180     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2181     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2182     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2183     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2184
  2185*****************CARRIER VARIABLES - ELCNTL ********************
  2186*****CARRIER NAME
  2187     12  FILLER                  PIC  X(03) VALUE '020'.
  2188     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2189     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2190     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2191     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2192
  2193*****FULL CARRIER ADDRESS
  2194     12  FILLER                  PIC  X(03) VALUE '021'.
  2195     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2196     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2197     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2198     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2199
  2200     12  FILLER                  PIC  X(03) VALUE '022'.
  2201     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2202     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2203     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2204     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2205
  2206     12  FILLER                  PIC  X(03) VALUE '023'.
  2207     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2208     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2209     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2210     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2211
  2212     12  FILLER                  PIC  X(03) VALUE '024'.
  2213     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2214     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2215     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2216     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2217
  2218     12  FILLER                  PIC  X(03) VALUE '025'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  44
* EL689.cbl
  2219     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2220     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2221     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2222     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2223
  2224*****CARRIER PHONE NUMBER
  2225     12  FILLER                  PIC  X(03) VALUE '026'.
  2226     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2227     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2228     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2229     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2230
  2231*****REMAINING 4 ARE NOT CURRENTLY USED
  2232     12  FILLER                  PIC  X(03) VALUE '027'.
  2233     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2234     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2235     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2236     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2237
  2238     12  FILLER                  PIC  X(03) VALUE '028'.
  2239     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2240     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2241     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2242     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2243
  2244     12  FILLER                  PIC  X(03) VALUE '029'.
  2245     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2246     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2247     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2248     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2249
  2250     12  FILLER                  PIC  X(03) VALUE '030'.
  2251     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2252     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2253     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2254     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2255
  2256***************** MAIL VARIABLES - ELMAIL **********************
  2257*****FULL MAIL ADDRESS
  2258     12  FILLER                  PIC  X(03) VALUE '031'.
  2259     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2260     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2261     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2262     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2263
  2264     12  FILLER                  PIC  X(03) VALUE '032'.
  2265     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2266     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2267     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2268     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2269
  2270     12  FILLER                  PIC  X(03) VALUE '033'.
  2271     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2272     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2273     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2274     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2275
  2276     12  FILLER                  PIC  X(03) VALUE '034'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  45
* EL689.cbl
  2277     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2278     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2279     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2280     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2281
  2282     12  FILLER                  PIC  X(03) VALUE '035'.
  2283     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2284     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2285     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2286     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2287
  2288     12  FILLER                  PIC  X(03) VALUE '036'.
  2289     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2290     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2291     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2292     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2293**** CRED BENE NAME FROM ERMAIL
  2294     12  FILLER                  PIC  X(03) VALUE '037'.
  2295     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2296     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2297     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2298     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2299*****REMAINING 2 ARE NOT CURRENTLY USED
  2300     12  FILLER                  PIC  X(03) VALUE '038'.
  2301     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2302     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2303     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2304     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2305
  2306     12  FILLER                  PIC  X(03) VALUE '039'.
  2307     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2308     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2309     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2310     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2311
  2312*************** ACCOUNT VARIABLES - ERACCT *********************
  2313*****ACCOUNT NAME
  2314     12  FILLER                  PIC  X(03) VALUE '040'.
  2315     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2316     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2317     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2318     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2319
  2320*****FULL ACCOUNT ADDRESS
  2321     12  FILLER                  PIC  X(03) VALUE '041'.
  2322     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2323     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2324     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2325     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2326
  2327     12  FILLER                  PIC  X(03) VALUE '042'.
  2328     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2329     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2330     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2331     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2332
  2333     12  FILLER                  PIC  X(03) VALUE '043'.
  2334     12  FILLER                  PIC S9(04) COMP VALUE +30.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  46
* EL689.cbl
  2335     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2336     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2337     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2338
  2339     12  FILLER                  PIC  X(03) VALUE '044'.
  2340     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2341     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2342     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2343     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2344
  2345     12  FILLER                  PIC  X(03) VALUE '045'.
  2346     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2347     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2348     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2349     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2350
  2351*****ACCOUNT PHONE NUMBER
  2352     12  FILLER                  PIC  X(03) VALUE '046'.
  2353     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2354     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2355     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2356     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2357
  2358*****ACCOUNT CONTROL NAME AM-CONTROL-NAME
  2359     12  FILLER                  PIC  X(03) VALUE '047'.
  2360     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2361     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2362     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2363     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2364
  2365****ACCOUNT CSR CODE
  2366     12  FILLER                  PIC  X(03) VALUE '048'.
  2367     12  FILLER                  PIC S9(04) COMP VALUE +4..
  2368     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2369     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2370     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2371****ACCOUNT ACCOUNT NUMBER
  2372     12  FILLER                  PIC  X(03) VALUE '049'.
  2373     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2374     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2375     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2376     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2377
  2378**** CRED BENE ADDRESS LINE 1 ERMAIL
  2379     12  FILLER                  PIC  X(03) VALUE '050'.
  2380     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2381     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2382     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2383     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2384
  2385**** CRED BENE ADDRESS LINE 2 ERMAIL
  2386     12  FILLER                  PIC  X(03) VALUE '051'.
  2387     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2388     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2389     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2390     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2391
  2392**** CRED BENE CITY STATE   ERMAIL
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  47
* EL689.cbl
  2393     12  FILLER                  PIC  X(03) VALUE '052'.
  2394     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2395     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2396     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2397     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2398
  2399**** CRED BENE ZIP  1 ERMAIL
  2400     12  FILLER                  PIC  X(03) VALUE '053'.
  2401     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2402     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2403     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2404     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2405
  2406*****REMAINING 6 ARE NOT CURRENTLY USED
  2407     12  FILLER                  PIC  X(03) VALUE '054'.
  2408     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2409     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2410     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2411     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2412
  2413     12  FILLER                  PIC  X(03) VALUE '055'.
  2414     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2415     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2416     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2417     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2418
  2419     12  FILLER                  PIC  X(03) VALUE '056'.
  2420     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2421     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2422     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2423     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2424
  2425     12  FILLER                  PIC  X(03) VALUE '057'.
  2426     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2427     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2428     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2429     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2430
  2431     12  FILLER                  PIC  X(03) VALUE '058'.
  2432     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2433     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2434     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2435     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2436
  2437     12  FILLER                  PIC  X(03) VALUE '059'.
  2438     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2439     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2440     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2441     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2442
  2443*************** NON FILE VARIABLES *****************************
  2444*****CURRENT DATE
  2445     12  FILLER                  PIC  X(03) VALUE '060'.
  2446     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2447     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2448     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2449     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2450
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  48
* EL689.cbl
  2451*****FULL CURRENT DATE
  2452     12  FILLER                  PIC  X(03) VALUE '061'.
  2453     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2454     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2455     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2456     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2457
  2458*****FORM
  2459     12  FILLER                  PIC  X(03) VALUE '062'.
  2460     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2461     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2462     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2463     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2464
  2465*****VARIABLE 1
  2466     12  FILLER                  PIC  X(03) VALUE '063'.
  2467     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2468     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2469     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2470     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2471
  2472*****VARIABLE 2
  2473     12  FILLER                  PIC  X(03) VALUE '064'.
  2474     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2475     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2476     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2477     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2478
  2479*****VARIABLE 3
  2480     12  FILLER                  PIC  X(03) VALUE '065'.
  2481     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2482     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2483     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2484     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2485
  2486*****VARIABLE 4
  2487     12  FILLER                  PIC  X(03) VALUE '066'.
  2488     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2489     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2490     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2491     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2492
  2493*****REMAINING 3 ARE NOT CURRENTLY USED
  2494     12  FILLER                  PIC  X(03) VALUE '067'.
  2495     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2496     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2497     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2498     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2499
  2500     12  FILLER                  PIC  X(03) VALUE '068'.
  2501     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2502     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2503     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2504     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2505
  2506     12  FILLER                  PIC  X(03) VALUE '069'.
  2507     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2508     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  49
* EL689.cbl
  2509     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2510     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2511
  2512************** CERTIFICATE VARIABLES - ELCERT *****************
  2513*****CARRIER CODE IN CERT
  2514     12  FILLER                  PIC  X(03) VALUE '070'.
  2515     12  FILLER                  PIC S9(04) COMP VALUE +1.
  2516     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2517     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2518     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2519
  2520*****GROUPING CODE IN CERT
  2521     12  FILLER                  PIC  X(03) VALUE '071'.
  2522     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2523     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2524     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2525     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2526
  2527*****ACCOUNT NUMBER IN CERT
  2528     12  FILLER                  PIC  X(03) VALUE '072'.
  2529     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2530     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2531     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2532     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2533
  2534*****CERTIFICATE NUMBER
  2535     12  FILLER                  PIC  X(03) VALUE '073'.
  2536     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2537     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2538     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2539     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2540
  2541*****CERT EFFECTIVE DATE
  2542     12  FILLER                  PIC  X(03) VALUE '074'.
  2543     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2544     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2545     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2546     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2547
  2548*****CERT EXPIRATION DATE (LIFE)
  2549     12  FILLER                  PIC  X(03) VALUE '075'.
  2550     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2551     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2552     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2553     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2554
  2555*****CERT EXPIRATION DATE (AH)
  2556     12  FILLER                  PIC  X(03) VALUE '076'.
  2557     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2558     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2559     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2560     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2561
  2562*****LIFE TERM
  2563     12  FILLER                  PIC  X(03) VALUE '077'.
  2564     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2565     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2566     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  50
* EL689.cbl
  2567     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2568
  2569*****AH  TERM
  2570     12  FILLER                  PIC  X(03) VALUE '078'.
  2571     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2572     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2573     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2574     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2575
  2576*****LIFE COVERAGE AMOUNT
  2577     12  FILLER                  PIC  X(03) VALUE '079'.
  2578     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2579     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2580     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2581     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2582
  2583*****AH MONTHLY BENEFIT
  2584     12  FILLER                  PIC  X(03) VALUE '080'.
  2585     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2586     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2587     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2588     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2589
  2590*****LIFE CANCEL DATE
  2591     12  FILLER                  PIC  X(03) VALUE '081'.
  2592     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2593     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2594     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2595     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2596
  2597*****AH CANCEL DATE
  2598     12  FILLER                  PIC  X(03) VALUE '082'.
  2599     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2600     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2601     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2602     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2603
  2604*****LIFE COVERAGE FORM NUMBER
  2605     12  FILLER                  PIC  X(03) VALUE '083'.
  2606     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2607     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2608     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2609     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2610
  2611*****UNUSED
  2612     12  FILLER                  PIC  X(03) VALUE '084'.
  2613     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2614     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2615     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2616     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2617
  2618*****INSUREDS AGE AT POLICY ISSUE (NOT USED)
  2619     12  FILLER                  PIC  X(03) VALUE '085'.
  2620     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2621     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2622     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2623     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2624
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  51
* EL689.cbl
  2625*****LOAN NUMBER
  2626     12  FILLER                  PIC  X(03) VALUE '086'.
  2627     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2628     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2629     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2630     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2631
  2632*****LOAN BALANCE
  2633     12  FILLER                  PIC  X(03) VALUE '087'.
  2634     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2635     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2636     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2637     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2638
  2639*****MEMBER NUMBER
  2640     12  FILLER                  PIC  X(03) VALUE '088'.
  2641     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2642     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2643     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2644     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2645
  2646*****INSURED SOC SEC NUMBER
  2647     12  FILLER                  PIC  X(03) VALUE '089'.
  2648     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2649     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2650     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2651     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2652
  2653*****INSURED INITIALS & LAST NAME (CERTIFICATE)
  2654     12  FILLER                  PIC  X(03) VALUE '090'.
  2655     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2656     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2657     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2658     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2659
  2660*****INSURED FIRST NAME (CERTIFICATE)
  2661     12  FILLER                  PIC  X(03) VALUE '091'.
  2662     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2663     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2664     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2665     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2666
  2667*****INSURED MIDDLE INITIAL (CERTIFICATE)
  2668     12  FILLER                  PIC  X(03) VALUE '092'.
  2669     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2670     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2671     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2672     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2673
  2674*****ORIG TERM * MON BEN
  2675     12  FILLER                  PIC  X(03) VALUE '093'.
  2676     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2677     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2678     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2679     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2680
  2681*****INSURED'S NAME (LAST, FIRST, INIT)
  2682     12  FILLER                  PIC  X(03) VALUE '094'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  52
* EL689.cbl
  2683     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2684     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2685     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2686     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2687
  2688*****INSURED'S NAME (FIRST, INIT, LAST)
  2689     12  FILLER                  PIC  X(03) VALUE  '095'.
  2690     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2691     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2692     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2693     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2694
  2695*****TITLE (MR/MS)
  2696     12  FILLER                  PIC  X(03) VALUE '096'.
  2697     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2698     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2699     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2700     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2701
  2702*****LIFE PREMIUM (CERTIFICATE)
  2703     12  FILLER                  PIC  X(03) VALUE '097'.
  2704     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2705     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2706     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2707     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2708
  2709*****A/H PREMIUM (CERTIFICATE)
  2710     12  FILLER                  PIC  X(03) VALUE '098'.
  2711     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2712     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2713     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2714     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2715
  2716*****JOINT'S INITIALS & LAST NAME (CERTIFICATE)
  2717     12  FILLER                  PIC  X(03) VALUE '099'.
  2718     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2719     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2720     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2721     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2722
  2723*****JOINT'S FIRST NAME (CERTIFICATE)
  2724     12  FILLER                  PIC  X(03) VALUE '100'.
  2725     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2726     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2727     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2728     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2729
  2730*****JOINT'S MIDDLE INITIAL (CERTIFICATE)
  2731     12  FILLER                  PIC  X(03) VALUE '101'.
  2732     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2733     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2734     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2735     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2736
  2737*****JOINT'S NAME (LAST, FIRST, INIT)
  2738     12  FILLER                  PIC  X(03) VALUE '102'.
  2739     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2740     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  53
* EL689.cbl
  2741     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2742     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2743
  2744*****JOINT'S NAME (FIRST, INIT, LAST)
  2745     12  FILLER                  PIC  X(03) VALUE '103'.
  2746     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2747     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2748     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2749     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2750
  2751*****INSURED'S FIRST AND LAST NAME
  2752     12  FILLER                  PIC  X(03) VALUE '104'.
  2753     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2754     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2755     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2756     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2757
  2758*****JOINT'S FIRST AND LAST NAME
  2759     12  FILLER                  PIC  X(03) VALUE '105'.
  2760     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2761     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2762     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2763     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2764
  2765*****ENTERED LIFE REFUND (CERT)
  2766     12  FILLER                  PIC  X(03) VALUE '106'.
  2767     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2768     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2769     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2770     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2771
  2772*****ENTERED A/H REFUND (CERT)
  2773     12  FILLER                  PIC  X(03) VALUE '107'.
  2774     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2775     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2776     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2777     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2778
  2779*****INSURED'S LAST NAME
  2780     12  FILLER                  PIC  X(03) VALUE '108'.
  2781     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2782     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2783     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2784     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2785
  2786*****BENEFICIARY
  2787     12  FILLER                  PIC  X(03) VALUE  '109'.
  2788     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2789     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2790     12  FILLER                  PIC  X(01) VALUE 'Y'.
  2791     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2792
  2793************** PENDING VARIABLES - ERPNDB *********************
  2794*****INSURED DATE OF BIRTH
  2795     12  FILLER                  PIC  X(03) VALUE '110'.
  2796     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2797     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2798     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  54
* EL689.cbl
  2799     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2800
  2801*****ENTERED LIFE PREMIUM (PENDING)
  2802     12  FILLER                  PIC  X(03) VALUE '111'.
  2803     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2804     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2805     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2806     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2807
  2808*****ENTERED A/H PREMIUM (PENDING)
  2809     12  FILLER                  PIC  X(03) VALUE '112'.
  2810     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2811     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2812     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2813     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2814
  2815*****CALCULATED LIFE PREMIUM (PENDING)
  2816     12  FILLER                  PIC  X(03) VALUE '113'.
  2817     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2818     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2819     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2820     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2821
  2822*****CALCULATED A/H PREMIUM (PENDING)
  2823     12  FILLER                  PIC  X(03) VALUE '114'.
  2824     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2825     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2826     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2827     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2828
  2829*****DIFFERENCE ENTER/COMPUTED LIFE PREMIUM (PENDING)
  2830     12  FILLER                  PIC  X(03) VALUE '115'.
  2831     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2832     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2833     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2834     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2835
  2836*****DIFFERENCE ENTER/COMPUTED A/H PREMIUM (PENDING)
  2837     12  FILLER                  PIC  X(03) VALUE '116'.
  2838     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2839     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2840     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2841     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2842
  2843*****PRIOR CANCEL DATE
  2844     12  FILLER                  PIC  X(03) VALUE '117'.
  2845     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2846     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2847     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2848     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2849
  2850*****ENTERED LIFE REFUND (PENDING)
  2851     12  FILLER                  PIC  X(03) VALUE '118'.
  2852     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2853     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2854     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2855     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2856
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  55
* EL689.cbl
  2857*****ENTERED A/H REFUND (PENDING)
  2858     12  FILLER                  PIC  X(03) VALUE '119'.
  2859     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2860     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2861     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2862     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2863
  2864*****CALCULATED LIFE REFUND (PENDING)
  2865     12  FILLER                  PIC  X(03) VALUE '120'.
  2866     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2867     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2868     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2869     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2870
  2871*****CALCULATED A/H REFUND (PENDING)
  2872     12  FILLER                  PIC  X(03) VALUE '121'.
  2873     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2874     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2875     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2876     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2877
  2878*****DIFFERENCE ENTER/COMPUTED LIFE REFUND (PENDING)
  2879     12  FILLER                  PIC  X(03) VALUE '122'.
  2880     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2881     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2882     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2883     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2884
  2885*****DIFFERENCE ENTER/COMPUTED A/H REFUND (PENDING)
  2886     12  FILLER                  PIC  X(03) VALUE '123'.
  2887     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2888     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2889     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2890     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2891
  2892*****INSUREDS AGE
  2893     12  FILLER                  PIC  X(03) VALUE '124'.
  2894     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2895     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2896     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2897     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2898
  2899*****LIFE BENEFIT (PENDING)
  2900     12  FILLER                  PIC  X(03) VALUE '125'.
  2901     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2902     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2903     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2904     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2905
  2906*****A/H BENEFIT (PENDING)
  2907     12  FILLER                  PIC  X(03) VALUE '126'.
  2908     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2909     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2910     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2911     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2912
  2913*****LIFE RATE
  2914     12  FILLER                  PIC  X(03) VALUE '127'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  56
* EL689.cbl
  2915     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2916     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2917     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2918     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2919
  2920*****A/H RATE
  2921     12  FILLER                  PIC  X(03) VALUE '128'.
  2922     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2923     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2924     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2925     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2926
  2927*****TERM (PENDING)
  2928     12  FILLER                  PIC  X(03) VALUE '129'.
  2929     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2930     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2931     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2932     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2933
  2934*****BATCH NUMBER
  2935     12  FILLER                  PIC  X(03) VALUE '130'.
  2936     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2937     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2938     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2939     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2940
  2941*****TOTAL OF LIFE AND A&H REFUND
  2942     12  FILLER                  PIC  X(03) VALUE '131'.
  2943     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2944     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2945     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2946     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2947
  2948*****NH INTEREST ON REFUNDS
  2949     12  FILLER                  PIC  X(03) VALUE '132'.
  2950     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2951     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2952     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2953     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2954*****GREATER OF THE LIFE AND AH CANCEL DATE
  2955     12  FILLER                  PIC  X(03) VALUE '133'.
  2956     12  FILLER                  PIC S9(04) COMP VALUE +8.
  2957     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2958     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2959     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2960
  2961*****THE NEXT 6 NOT CURRENTLY USED
  2962     12  FILLER                  PIC  X(03) VALUE '134'.
  2963     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2964     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2965     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2966     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2967
  2968     12  FILLER                  PIC  X(03) VALUE '135'.
  2969     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2970     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2971     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2972     12  FILLER                  PIC S9(04) COMP VALUE +09.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  57
* EL689.cbl
  2973
  2974     12  FILLER                  PIC  X(03) VALUE '136'.
  2975     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2976     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2977     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2978     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2979
  2980     12  FILLER                  PIC  X(03) VALUE '137'.
  2981     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2982     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2983     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2984     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2985
  2986     12  FILLER                  PIC  X(03) VALUE '138'.
  2987     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2988     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2989     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2990     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2991
  2992     12  FILLER                  PIC  X(03) VALUE '139'.
  2993     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2994     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2995     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2996     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2997
  2998************** COMPENSATION VARIABLES - ERCOMP ****************
  2999*****COMPENSATION ACCT NAME
  3000     12  FILLER                  PIC  X(03) VALUE '140'.
  3001     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3002     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3003     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3004     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3005
  3006*****FULL COMPENSATION ADDRESS TYPE 'A'
  3007     12  FILLER                  PIC  X(03) VALUE '141'.
  3008     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3009     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3010     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3011     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3012
  3013     12  FILLER                  PIC  X(03) VALUE '142'.
  3014     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3015     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3016     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3017     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3018
  3019     12  FILLER                  PIC  X(03) VALUE '143'.
  3020     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3021     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3022     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3023     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3024
  3025     12  FILLER                  PIC  X(03) VALUE '144'.
  3026     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3027     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3028     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3029     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3030
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  58
* EL689.cbl
  3031     12  FILLER                  PIC  X(03) VALUE '145'.
  3032     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3033     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3034     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3035     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3036
  3037     12  FILLER                  PIC  X(03) VALUE '146'.
  3038     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3039     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3040     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3041     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3042
  3043*****COMPENSATION PHONE NUMBER
  3044     12  FILLER                  PIC  X(03) VALUE '147'.
  3045     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3046     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3047     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3048     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3049
  3050*****COMPENSATION CSR NAME
  3051     12  FILLER                  PIC  X(03) VALUE '148'.
  3052     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3053     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3054     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3055     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3056
  3057*****COMPENSATION LAST STATEMENT DATE
  3058     12  FILLER                  PIC  X(03) VALUE '149'.
  3059     12  FILLER                  PIC S9(04) COMP VALUE +18.
  3060     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3061     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3062     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3063
  3064*****COMPENSATION ENDING BALANCE
  3065     12  FILLER                  PIC  X(03) VALUE '150'.
  3066     12  FILLER                  PIC S9(04) COMP VALUE +14.
  3067     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3068     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3069     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3070
  3071******************  PROCESSOR DATA - ELCNTL (2) ****************
  3072*****EXECUTING PROCESSOR NAME
  3073     12  FILLER                  PIC  X(03) VALUE '151'.
  3074     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3075     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3076     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3077     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3078
  3079*****PROCESSOR TITLE
  3080     12  FILLER                  PIC  X(03) VALUE '152'.
  3081     12  FILLER                  PIC S9(04) COMP VALUE +26.
  3082     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3083     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3084     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3085
  3086*****PROCESSOR
  3087     12  FILLER                  PIC  X(03) VALUE '153'.
  3088     12  FILLER                  PIC S9(04) COMP VALUE +04.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  59
* EL689.cbl
  3089     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3090     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3091     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3092
  3093*****CSR TITLE
  3094     12  FILLER                  PIC  X(03) VALUE '154'.
  3095     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3096     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3097     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3098     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3099*****REMAINING 2 ARE NOT CURRENTLY USED
  3100     12  FILLER                  PIC  X(03) VALUE '155'.
  3101     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3102     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3103     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3104     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3105
  3106     12  FILLER                  PIC  X(03) VALUE '156'.
  3107     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3108     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3109     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3110     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3111
  3112******************  CHECK DATA - ERCHEK    *********************
  3113*****CHECK AMOUNT
  3114     12  FILLER                  PIC  X(03) VALUE '157'.
  3115     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3116     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3117     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3118     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3119
  3120*****CHECK NUMBER
  3121     12  FILLER                  PIC  X(03) VALUE '158'.
  3122     12  FILLER                  PIC S9(04) COMP VALUE +7.
  3123     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3124     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3125     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3126
  3127*****PAYEE 1 NAME
  3128     12  FILLER                  PIC  X(03) VALUE '159'.
  3129     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3130     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3131     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3132     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3133
  3134*****PAYEE 2 NAME
  3135     12  FILLER                  PIC  X(03) VALUE '160'.
  3136     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3137     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3138     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3139     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3140
  3141*****ADDRSS 1
  3142     12  FILLER                  PIC  X(03) VALUE '161'.
  3143     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3144     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3145     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3146     12  FILLER                  PIC S9(04) COMP VALUE +12.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  60
* EL689.cbl
  3147
  3148*****ADDRESS 2
  3149     12  FILLER                  PIC  X(03) VALUE '162'.
  3150     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3151     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3152     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3153     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3154
  3155*****PAYEE CITY STATE
  3156     12  FILLER                  PIC  X(03) VALUE '163'.
  3157     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3158     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3159     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3160     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3161
  3162*****ZIP CODE
  3163     12  FILLER                  PIC  X(03) VALUE '164'.
  3164     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3165     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3166     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3167     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3168
  3169*****CHECK CONTROL
  3170     12  FILLER                  PIC  X(03) VALUE '165'.
  3171     12  FILLER                  PIC S9(04) COMP VALUE +08.
  3172     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3173     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3174     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3175
  3176*****REASON FOR CHECK
  3177     12  FILLER                  PIC  X(03) VALUE '166'.
  3178     12  FILLER                  PIC S9(04) COMP VALUE +25.
  3179     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3180     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3181     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3182
  3183*****REMAINING 3 ARE NOT CURRENTLY USED
  3184     12  FILLER                  PIC  X(03) VALUE '167'.
  3185     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3186     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3187     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3188     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3189
  3190     12  FILLER                  PIC  X(03) VALUE '168'.
  3191     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3192     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3193     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3194     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3195
  3196     12  FILLER                  PIC  X(03) VALUE '169'.
  3197     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3198     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3199     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3200     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3201
  3202
  3203*********** PAYMENT AND ADJUSTMENT DATA - ERPYAJ  **************
  3204*****CHECK AMOUNT - PYAJ
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  61
* EL689.cbl
  3205     12  FILLER                  PIC  X(03) VALUE '170'.
  3206     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3207     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3208     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3209     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3210
  3211*****CHECK NUMBER - PYAJ
  3212     12  FILLER                  PIC  X(03) VALUE '171'.
  3213     12  FILLER                  PIC S9(04) COMP VALUE +7.
  3214     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3215     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3216     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3217
  3218*****CHECK CONTROL - PYAJ
  3219     12  FILLER                  PIC  X(03) VALUE '172'.
  3220     12  FILLER                  PIC S9(04) COMP VALUE +08.
  3221     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3222     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3223     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3224
  3225***** COMMENT - PYAJ
  3226     12  FILLER                  PIC  X(03) VALUE '173'.
  3227     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3228     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3229     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3230     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3231
  3232*****NEW FIELDS.
  3233*****COMPENSATION FULL ADDRESS TYPE 'G'
  3234     12  FILLER                  PIC  X(03) VALUE '174'.
  3235     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3236     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3237     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3238     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3239
  3240     12  FILLER                  PIC  X(03) VALUE '175'.
  3241     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3242     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3243     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3244     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3245
  3246     12  FILLER                  PIC  X(03) VALUE '176'.
  3247     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3248     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3249     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3250     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3251
  3252     12  FILLER                  PIC  X(03) VALUE '177'.
  3253     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3254     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3255     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3256     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3257
  3258     12  FILLER                  PIC  X(03) VALUE '178'.
  3259     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3260     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3261     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3262     12  FILLER                  PIC S9(04) COMP VALUE +10.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  62
* EL689.cbl
  3263
  3264     12  FILLER                  PIC  X(03) VALUE '179'.
  3265     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3266     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3267     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3268     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3269
  3270*****COMPENSATION FINANCIAL RESPONSIBLE NO.
  3271     12  FILLER                  PIC  X(03) VALUE '180'.
  3272     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3273     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3274     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3275     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3276**** COMPENSATION BILLING SWITCH
  3277     12  FILLER                  PIC XXX    VALUE '181'.
  3278     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3279     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3280     12  FILLER                  PIC X      VALUE ALL 'N'.
  3281     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3282*****COMPENSATION FAX NUMBER
  3283     12  FILLER                  PIC  X(03) VALUE '182'.
  3284     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3285     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3286     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3287     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3288**** COMPENSATION STATUS
  3289     12  FILLER                  PIC XXX    VALUE '183'.
  3290     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3291     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3292     12  FILLER                  PIC X      VALUE ALL 'N'.
  3293     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3294***** THE VARS 184 - 189 WILL TYPICALLY BE USED FOR DCC BANKS
  3295*****COMPENSATION FULL ADDRESS TYPE 'B'
  3296     12  FILLER                  PIC  X(03) VALUE '184'.
  3297     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3298     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3299     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3300     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3301
  3302     12  FILLER                  PIC  X(03) VALUE '185'.
  3303     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3304     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3305     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3306     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3307
  3308     12  FILLER                  PIC  X(03) VALUE '186'.
  3309     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3310     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3311     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3312     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3313
  3314     12  FILLER                  PIC  X(03) VALUE '187'.
  3315     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3316     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3317     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3318     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3319
  3320     12  FILLER                  PIC  X(03) VALUE '188'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  63
* EL689.cbl
  3321     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3322     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3323     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3324     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3325
  3326     12  FILLER                  PIC  X(03) VALUE '189'.
  3327     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3328     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3329     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3330     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3331
  3332
  3333 01  FILLER REDEFINES W-SUPPORTED-VARIABLES.
  3334*    12  W-VARIABLE-GRP OCCURS 180 TIMES
  3335     12  W-VARIABLE-GRP OCCURS 189 TIMES
  3336                        INDEXED BY W-VG-NDX.
  3337         16  W-VARIABLE-ID         PIC  X(03).
  3338         16  W-VARIABLE-SIZE       PIC S9(04) COMP.
  3339         16  W-VG-TEXT.
  3340             20  W-VAR-CHAR
  3341                        OCCURS 30 TIMES
  3342                        INDEXED BY W-VC-NDX
  3343                                   PIC  X(01).
  3344         16  W-VARIABLE-UPLOW-IND  PIC  X(01).
  3345             88  W-USE-UPPER-AND-LOWER-CASE VALUE 'Y'.
  3346
  3347         16  W-VARIABLE-SOURCE   PIC S9(04) COMP.
  3348
  3349 01  W-VAR-END                   PIC  X(23)
  3350                        VALUE ':VARIABLE WORK AREA END'.
  3351
  3352 01  W-PROGRAM-TABLE-AREA.
  3353     12  FILLER                  PIC  X(15)
  3354                                 VALUE 'PROGRAM TABLES:'.
  3355
  3356     12  W-RECORD-TABLE              VALUE SPACES.
  3357         16  W-RC-GRP OCCURS 500 TIMES
  3358                       INDEXED BY W-RG-NDX
  3359                                  W-RG-NDX1.
  3360             20  W-RC-TEXT.
  3361                 24  W-RC-CHAR OCCURS 70 TIMES
  3362                                INDEXED BY W-RC-NDX
  3363                                           W-RC-NDX1
  3364                                 PIC  X(01).
  3365             20  W-RC-PC         PIC  9(02).
  3366             20  W-RC-SC         PIC  X(01).
  3367
  3368     12  FILLER REDEFINES W-RECORD-TABLE.
  3369         16  W-REC-CHAR OCCURS 36500 TIMES
  3370                        INDEXED BY W-RVS-NDX
  3371                                   W-RVS-NDX2
  3372                                 PIC  X(01).
  3373     12  FILLER REDEFINES W-RECORD-TABLE.
  3374         16  W-TS-GROUP OCCURS 10 TIMES
  3375                        INDEXED BY W-TS-NDX
  3376                                 PIC X(3650).
  3377
  3378     12  FILLER                  PIC  X(11)
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  64
* EL689.cbl
  3379                                 VALUE 'TEXT TABLE:'.
  3380     12  W-TX-TABLE                  VALUE SPACES.
  3381         16  W-TX-GRP OCCURS 500 TIMES
  3382                       INDEXED BY W-TG-NDX
  3383                                  W-TG-NDX2.
  3384             20  W-TX-TEXT.
  3385                 24  W-TX-CHAR OCCURS 70 TIMES
  3386                                    INDEXED BY W-TX-NDX
  3387                                               W-TX-NDX1
  3388                                               W-TX-NDX2
  3389                                 PIC  X(01).
  3390             20  W-TX-PC         PIC  9(02).
  3391             20  W-TX-SC         PIC  X(01).
  3392
  3393     12  FILLER                  PIC  X(11)
  3394                                 VALUE 'FILE TABLE:'.
  3395     12  W-FILE-TABLE                VALUE SPACES.
  3396         16  W-FILE-USE-IND OCCURS 20 TIMES
  3397                       INDEXED BY W-FILE-NDX
  3398                                 PIC  X(01).
  3399             88  W-FILE-NOT-USED     VALUE SPACE.
  3400             88  W-FILE-USED         VALUE 'Y'.
  3401
  3402     12  FILLER                  PIC  X(14)
  3403                                 VALUE 'END OF TABLES:'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  65
* EL689.cbl
  3405 01  ERROR-MESSAGES.
  3406     12  ER-0000                 PIC  X(04) VALUE '0000'.
  3407     12  ER-0004                 PIC  X(04) VALUE '0004'.
  3408     12  ER-0006                 PIC  X(04) VALUE '0006'.
  3409     12  ER-0008                 PIC  X(04) VALUE '0008'.
  3410     12  ER-0013                 PIC  X(04) VALUE '0013'.
  3411     12  ER-0023                 PIC  X(04) VALUE '0023'.
  3412     12  ER-0029                 PIC  X(04) VALUE '0029'.
  3413     12  ER-0033                 PIC  X(04) VALUE '0033'.
  3414     12  ER-0042                 PIC  X(04) VALUE '0042'.
  3415     12  ER-0047                 PIC  X(04) VALUE '0047'.
  3416     12  ER-0051                 PIC  X(04) VALUE '0051'.
  3417     12  ER-0066                 PIC  X(04) VALUE '0066'.
  3418     12  ER-0067                 PIC  X(04) VALUE '0067'.
  3419     12  ER-0070                 PIC  X(04) VALUE '0070'.
  3420     12  ER-0168                 PIC  X(04) VALUE '0168'.
  3421     12  ER-0169                 PIC  X(04) VALUE '0169'.
  3422     12  ER-0174                 PIC  X(04) VALUE '0174'.
  3423     12  ER-0175                 PIC  X(04) VALUE '0175'.
  3424     12  ER-0176                 PIC  X(04) VALUE '0176'.
  3425     12  ER-0177                 PIC  X(04) VALUE '0177'.
  3426     12  ER-0179                 PIC  X(04) VALUE '0179'.
  3427     12  ER-0180                 PIC  X(04) VALUE '0180'.
  3428     12  ER-0181                 PIC  X(04) VALUE '0181'.
  3429     12  ER-0182                 PIC  X(04) VALUE '0182'.
  3430     12  ER-0184                 PIC  X(04) VALUE '0184'.
  3431     12  ER-0185                 PIC  X(04) VALUE '0185'.
  3432     12  ER-0187                 PIC  X(04) VALUE '0187'.
  3433     12  ER-0188                 PIC  X(04) VALUE '0188'.
  3434     12  ER-0189                 PIC  X(04) VALUE '0189'.
  3435     12  ER-0190                 PIC  X(04) VALUE '0190'.
  3436     12  ER-0191                 PIC  X(04) VALUE '0191'.
  3437     12  ER-0215                 PIC  X(04) VALUE '0215'.
  3438     12  ER-0279                 PIC  X(04) VALUE '0279'.
  3439     12  ER-0280                 PIC  X(04) VALUE '0280'.
  3440     12  ER-0412                 PIC  X(04) VALUE '0412'.
  3441     12  ER-0413                 PIC  X(04) VALUE '0413'.
  3442     12  ER-0454                 PIC  X(04) VALUE '0454'.
  3443     12  ER-0533                 PIC  X(04) VALUE '0533'.
  3444     12  ER-0537                 PIC  X(04) VALUE '0537'.
  3445     12  ER-0715                 PIC  X(04) VALUE '0715'.
  3446     12  ER-0894                 PIC  X(04) VALUE '0894'.
  3447     12  ER-1560                 PIC  X(04) VALUE '1560'.
  3448     12  ER-1565                 PIC  X(04) VALUE '1565'.
  3449     12  ER-1778                 PIC  X(04) VALUE '1778'.
  3450     12  ER-1818                 PIC  X(04) VALUE '1818'.
  3451     12  ER-2055                 PIC  X(04) VALUE '2055'.
  3452     12  ER-2114                 PIC  X(04) VALUE '2114'.
  3453     12  ER-2208                 PIC  X(04) VALUE '2208'.
  3454     12  ER-2209                 PIC  X(04) VALUE '2209'.
  3455     12  ER-2216                 PIC  X(04) VALUE '2216'.
  3456     12  ER-2232                 PIC  X(04) VALUE '2232'.
  3457     12  ER-2369                 PIC  X(04) VALUE '2369'.
  3458     12  ER-2398                 PIC  X(04) VALUE '2398'.
  3459     12  ER-2433                 PIC  X(04) VALUE '2433'.
  3460     12  ER-2908                 PIC  X(04) VALUE '2908'.
  3461     12  ER-2999                 PIC  X(04) VALUE '2999'.
  3462     12  ER-3000                 PIC  X(04) VALUE '3000'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  66
* EL689.cbl
  3463     12  ER-3770                 PIC  X(04) VALUE '3770'.
  3464     12  ER-3771                 PIC  X(04) VALUE '3771'.
  3465     12  ER-3775                 PIC  X(04) VALUE '3775'.
  3466     12  ER-3783                 PIC  X(04) VALUE '3783'.
  3467     12  ER-7243                 PIC  X(04) VALUE '7243'.
  3468     12  ER-7245                 PIC  X(04) VALUE '7245'.
  3469     12  ER-7246                 PIC  X(04) VALUE '7246'.
  3470     12  ER-7247                 PIC  X(04) VALUE '7247'.
  3471     12  ER-7250                 PIC  X(04) VALUE '7250'.
  3472     12  ER-7365                 PIC  X(04) VALUE '7365'.
  3473     12  ER-7367                 PIC  X(04) VALUE '7367'.
  3474     12  ER-7368                 PIC  X(04) VALUE '7368'.
  3475     12  ER-7369                 PIC  X(04) VALUE '7369'.
  3476     12  ER-7370                 PIC  X(04) VALUE '7370'.
  3477     12  ER-7371                 PIC  X(04) VALUE '7371'.
  3478     12  ER-7372                 PIC  X(04) VALUE '7372'.
  3479     12  ER-7373                 PIC  X(04) VALUE '7373'.
  3480     12  ER-7374                 PIC  X(04) VALUE '7374'.
  3481     12  ER-7376                 PIC  X(04) VALUE '7376'.
  3482     12  ER-7377                 PIC  X(04) VALUE '7377'.
  3483     12  ER-7378                 PIC  X(04) VALUE '7378'.
  3484     12  ER-7379                 PIC  X(04) VALUE '7379'.
  3485     12  ER-7381                 PIC  X(04) VALUE '7381'.
  3486     12  ER-7388                 PIC  X(04) VALUE '7388'.
  3487     12  ER-7390                 PIC  X(04) VALUE '7390'.
  3488     12  ER-7393                 PIC  X(04) VALUE '7393'.
  3489     12  ER-7395                 PIC  X(04) VALUE '7395'.
  3490     12  ER-7396                 PIC  X(04) VALUE '7396'.
  3491     12  ER-7398                 PIC  X(04) VALUE '7398'.
  3492     12  ER-8965                 PIC  X(04) VALUE '8965'.
  3493     12  ER-9095                 PIC  X(04) VALUE '9095'.
  3494     12  ER-9097                 PIC  X(04) VALUE '9097'.
  3495     12  ER-9281                 PIC  X(04) VALUE '9281'.
  3496     12  ER-9283                 PIC  X(04) VALUE '9283'.
  3497     12  ER-9298                 PIC  X(04) VALUE '9298'.
  3498     12  ER-9299                 PIC  X(04) VALUE '9299'.
  3499     12  ER-9320                 PIC  X(04) VALUE '9320'.
  3500     12  ER-9327                 PIC  X(04) VALUE '9327'.
  3501     12  ER-9426                 PIC  X(04) VALUE '9426'.
  3502     12  ER-9427                 PIC  X(04) VALUE '9427'.
  3503     12  ER-9840                 PIC  X(04) VALUE '9840'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  67
* EL689.cbl
  3505*    COPY ELCAID.
  3506******************************************************************
  3507*                                                                *
  3508*                            ELCAID.                             *
  3509*                            VMOD=2.001                          *
  3510*                                                                *
  3511*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3512*                                                                *
  3513*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3514*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3515******************************************************************
  3516
  3517 01  DFHAID.
  3518   02  DFHNULL   PIC  X  VALUE  ' '.
  3519   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3520   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3521   02  DFHPEN    PIC  X  VALUE  '='.
  3522   02  DFHOPID   PIC  X  VALUE  'W'.
  3523   02  DFHPA1    PIC  X  VALUE  '%'.
  3524   02  DFHPA2    PIC  X  VALUE  '>'.
  3525   02  DFHPA3    PIC  X  VALUE  ','.
  3526   02  DFHPF1    PIC  X  VALUE  '1'.
  3527   02  DFHPF2    PIC  X  VALUE  '2'.
  3528   02  DFHPF3    PIC  X  VALUE  '3'.
  3529   02  DFHPF4    PIC  X  VALUE  '4'.
  3530   02  DFHPF5    PIC  X  VALUE  '5'.
  3531   02  DFHPF6    PIC  X  VALUE  '6'.
  3532   02  DFHPF7    PIC  X  VALUE  '7'.
  3533   02  DFHPF8    PIC  X  VALUE  '8'.
  3534   02  DFHPF9    PIC  X  VALUE  '9'.
  3535   02  DFHPF10   PIC  X  VALUE  ':'.
  3536   02  DFHPF11   PIC  X  VALUE  '#'.
  3537   02  DFHPF12   PIC  X  VALUE  '@'.
  3538   02  DFHPF13   PIC  X  VALUE  'A'.
  3539   02  DFHPF14   PIC  X  VALUE  'B'.
  3540   02  DFHPF15   PIC  X  VALUE  'C'.
  3541   02  DFHPF16   PIC  X  VALUE  'D'.
  3542   02  DFHPF17   PIC  X  VALUE  'E'.
  3543   02  DFHPF18   PIC  X  VALUE  'F'.
  3544   02  DFHPF19   PIC  X  VALUE  'G'.
  3545   02  DFHPF20   PIC  X  VALUE  'H'.
  3546   02  DFHPF21   PIC  X  VALUE  'I'.
  3547*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3548   02  DFHPF22   PIC  X  VALUE  '['.
  3549   02  DFHPF23   PIC  X  VALUE  '.'.
  3550   02  DFHPF24   PIC  X  VALUE  '<'.
  3551   02  DFHMSRE   PIC  X  VALUE  'X'.
  3552   02  DFHSTRF   PIC  X  VALUE  'h'.
  3553   02  DFHTRIG   PIC  X  VALUE  '"'.
  3554 01  FILLER    REDEFINES DFHAID.
  3555     12  FILLER                  PIC  X(08).
  3556     12  PF-VALUES               PIC  X(01) OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  68
* EL689.cbl
  3558*    COPY ELCATTR.
  3559******************************************************************
  3560*                                                                *
  3561*                            ELCATTR.                            *
  3562*                            VMOD=2.001                          *
  3563*                                                                *
  3564*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  3565*                                                                *
  3566*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  3567*                                                                *
  3568*                   POS 1   P=PROTECTED                          *
  3569*                           U=UNPROTECTED                        *
  3570*                           S=ASKIP                              *
  3571*                   POS 2   A=ALPHA/NUMERIC                      *
  3572*                           N=NUMERIC                            *
  3573*                   POS 3   N=NORMAL                             *
  3574*                           B=BRIGHT                             *
  3575*                           D=DARK                               *
  3576*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  3577*                           OF=MODIFIED DATA TAG OFF             *
  3578*                                                                *
  3579*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  3580******************************************************************
  3581 01  ATTRIBUTE-LIST.
  3582     12  AL-PABOF            PIC X       VALUE 'Y'.
  3583     12  AL-PABON            PIC X       VALUE 'Z'.
  3584     12  AL-PADOF            PIC X       VALUE '%'.
  3585     12  AL-PADON            PIC X       VALUE '_'.
  3586     12  AL-PANOF            PIC X       VALUE '-'.
  3587     12  AL-PANON            PIC X       VALUE '/'.
  3588     12  AL-SABOF            PIC X       VALUE '8'.
  3589     12  AL-SABON            PIC X       VALUE '9'.
  3590     12  AL-SADOF            PIC X       VALUE '@'.
  3591     12  AL-SADON            PIC X       VALUE QUOTE.
  3592     12  AL-SANOF            PIC X       VALUE '0'.
  3593     12  AL-SANON            PIC X       VALUE '1'.
  3594     12  AL-UABOF            PIC X       VALUE 'H'.
  3595     12  AL-UABON            PIC X       VALUE 'I'.
  3596     12  AL-UADOF            PIC X       VALUE '<'.
  3597     12  AL-UADON            PIC X       VALUE '('.
  3598     12  AL-UANOF            PIC X       VALUE ' '.
  3599     12  AL-UANON            PIC X       VALUE 'A'.
  3600     12  AL-UNBOF            PIC X       VALUE 'Q'.
  3601     12  AL-UNBON            PIC X       VALUE 'R'.
  3602     12  AL-UNDOF            PIC X       VALUE '*'.
  3603     12  AL-UNDON            PIC X       VALUE ')'.
  3604     12  AL-UNNOF            PIC X       VALUE '&'.
  3605     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  69
* EL689.cbl
  3607*    COPY ELCDATE.
  3608******************************************************************
  3609*                                                                *
  3610*                                                                *
  3611*                            ELCDATE.                            *
  3612*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3613*                            VMOD=2.003
  3614*                                                                *
  3615*                                                                *
  3616*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3617*                 LENGTH = 200                                   *
  3618******************************************************************
  3619
  3620 01  DATE-CONVERSION-DATA.
  3621     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3622     12  DC-OPTION-CODE                PIC X.
  3623         88  BIN-TO-GREG                VALUE ' '.
  3624         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3625         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3626         88  YMD-GREG-TO-BIN            VALUE '3'.
  3627         88  MDY-GREG-TO-BIN            VALUE '4'.
  3628         88  JULIAN-TO-BIN              VALUE '5'.
  3629         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3630         88  FIND-CENTURY               VALUE '7'.
  3631         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3632         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3633         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3634         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3635         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3636         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3637         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3638         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3639         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3640         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3641         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3642         88  BIN-3-TO-GREG              VALUE 'I'.
  3643         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3644         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3645         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3646         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3647         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3648         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3649         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3650         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3651         88  THREE-CHARACTER-BIN
  3652                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3653         88  GREGORIAN-TO-BIN
  3654                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3655         88  BIN-TO-GREGORIAN
  3656                  VALUES ' ' '1' 'I' '8' 'G'.
  3657         88  JULIAN-TO-BINARY
  3658                  VALUES '5' 'C' 'E' 'F'.
  3659     12  DC-ERROR-CODE                 PIC X.
  3660         88  NO-CONVERSION-ERROR        VALUE ' '.
  3661         88  DATE-CONVERSION-ERROR
  3662                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3663         88  DATE-IS-ZERO               VALUE '1'.
  3664         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  70
* EL689.cbl
  3665         88  DATE-IS-INVALID            VALUE '3'.
  3666         88  DATE1-GREATER-DATE2        VALUE '4'.
  3667         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3668         88  DATE-INVALID-OPTION        VALUE '9'.
  3669         88  INVALID-CENTURY            VALUE 'A'.
  3670         88  ONLY-CENTURY               VALUE 'B'.
  3671         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3672         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3673     12  DC-END-OF-MONTH               PIC X.
  3674         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3675     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3676         88  USE-NORMAL-PROCESS         VALUE ' '.
  3677         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3678         88  ADJUST-UP-100-YRS          VALUE '2'.
  3679     12  FILLER                        PIC X.
  3680     12  DC-CONVERSION-DATES.
  3681         16  DC-BIN-DATE-1             PIC XX.
  3682         16  DC-BIN-DATE-2             PIC XX.
  3683         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3684         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3685                       DC-GREG-DATE-1-EDIT.
  3686             20  DC-EDIT1-MONTH        PIC 99.
  3687             20  SLASH1-1              PIC X.
  3688             20  DC-EDIT1-DAY          PIC 99.
  3689             20  SLASH1-2              PIC X.
  3690             20  DC-EDIT1-YEAR         PIC 99.
  3691         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3692         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3693                     DC-GREG-DATE-2-EDIT.
  3694             20  DC-EDIT2-MONTH        PIC 99.
  3695             20  SLASH2-1              PIC X.
  3696             20  DC-EDIT2-DAY          PIC 99.
  3697             20  SLASH2-2              PIC X.
  3698             20  DC-EDIT2-YEAR         PIC 99.
  3699         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3700         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3701                     DC-GREG-DATE-1-YMD.
  3702             20  DC-YMD-YEAR           PIC 99.
  3703             20  DC-YMD-MONTH          PIC 99.
  3704             20  DC-YMD-DAY            PIC 99.
  3705         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3706         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3707                      DC-GREG-DATE-1-MDY.
  3708             20  DC-MDY-MONTH          PIC 99.
  3709             20  DC-MDY-DAY            PIC 99.
  3710             20  DC-MDY-YEAR           PIC 99.
  3711         16  DC-GREG-DATE-1-ALPHA.
  3712             20  DC-ALPHA-MONTH        PIC X(10).
  3713             20  DC-ALPHA-DAY          PIC 99.
  3714             20  FILLER                PIC XX.
  3715             20  DC-ALPHA-CENTURY.
  3716                 24 DC-ALPHA-CEN-N     PIC 99.
  3717             20  DC-ALPHA-YEAR         PIC 99.
  3718         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3719         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3720         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3721         16  DC-JULIAN-DATE            PIC 9(05).
  3722         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  71
* EL689.cbl
  3723                                       PIC 9(05).
  3724         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3725             20  DC-JULIAN-YEAR        PIC 99.
  3726             20  DC-JULIAN-DAYS        PIC 999.
  3727         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3728         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3729         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3730     12  DATE-CONVERSION-VARIBLES.
  3731         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3732         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3733             20  FILLER                PIC 9(3).
  3734             20  HOLD-CEN-1-CCYY.
  3735                 24  HOLD-CEN-1-CC     PIC 99.
  3736                 24  HOLD-CEN-1-YY     PIC 99.
  3737             20  HOLD-CEN-1-MO         PIC 99.
  3738             20  HOLD-CEN-1-DA         PIC 99.
  3739         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3740             20  HOLD-CEN-1-R-MO       PIC 99.
  3741             20  HOLD-CEN-1-R-DA       PIC 99.
  3742             20  HOLD-CEN-1-R-CCYY.
  3743                 24  HOLD-CEN-1-R-CC   PIC 99.
  3744                 24  HOLD-CEN-1-R-YY   PIC 99.
  3745             20  FILLER                PIC 9(3).
  3746         16  HOLD-CENTURY-1-X.
  3747             20  FILLER                PIC X(3)  VALUE SPACES.
  3748             20  HOLD-CEN-1-X-CCYY.
  3749                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3750                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3751             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3752             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3753         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3754             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3755             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3756             20  HOLD-CEN-1-R-X-CCYY.
  3757                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3758                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3759             20  FILLER                PIC XXX.
  3760         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3761         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3762         16  DC-JULIAN-DATE-1          PIC 9(07).
  3763         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3764             20  DC-JULIAN-1-CCYY.
  3765                 24  DC-JULIAN-1-CC    PIC 99.
  3766                 24  DC-JULIAN-1-YR    PIC 99.
  3767             20  DC-JULIAN-DA-1        PIC 999.
  3768         16  DC-JULIAN-DATE-2          PIC 9(07).
  3769         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3770             20  DC-JULIAN-2-CCYY.
  3771                 24  DC-JULIAN-2-CC    PIC 99.
  3772                 24  DC-JULIAN-2-YR    PIC 99.
  3773             20  DC-JULIAN-DA-2        PIC 999.
  3774         16  DC-GREG-DATE-A-EDIT.
  3775             20  DC-EDITA-MONTH        PIC 99.
  3776             20  SLASHA-1              PIC X VALUE '/'.
  3777             20  DC-EDITA-DAY          PIC 99.
  3778             20  SLASHA-2              PIC X VALUE '/'.
  3779             20  DC-EDITA-CCYY.
  3780                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  72
* EL689.cbl
  3781                 24  DC-EDITA-YEAR     PIC 99.
  3782         16  DC-GREG-DATE-B-EDIT.
  3783             20  DC-EDITB-MONTH        PIC 99.
  3784             20  SLASHB-1              PIC X VALUE '/'.
  3785             20  DC-EDITB-DAY          PIC 99.
  3786             20  SLASHB-2              PIC X VALUE '/'.
  3787             20  DC-EDITB-CCYY.
  3788                 24  DC-EDITB-CENT     PIC 99.
  3789                 24  DC-EDITB-YEAR     PIC 99.
  3790         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3791         16  DC-GREG-DATE-CYMD-R REDEFINES
  3792                              DC-GREG-DATE-CYMD.
  3793             20  DC-CYMD-CEN           PIC 99.
  3794             20  DC-CYMD-YEAR          PIC 99.
  3795             20  DC-CYMD-MONTH         PIC 99.
  3796             20  DC-CYMD-DAY           PIC 99.
  3797         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3798         16  DC-GREG-DATE-MDCY-R REDEFINES
  3799                              DC-GREG-DATE-MDCY.
  3800             20  DC-MDCY-MONTH         PIC 99.
  3801             20  DC-MDCY-DAY           PIC 99.
  3802             20  DC-MDCY-CEN           PIC 99.
  3803             20  DC-MDCY-YEAR          PIC 99.
  3804    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3805        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3806    12  DC-EL310-DATE                  PIC X(21).
  3807    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  73
* EL689.cbl
  3809*    COPY ELCNWA.
  3810*****************************************************************
  3811*                                                               *
  3812*                                                               *
  3813*                            ELCNWA.                            *
  3814*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3815*                            VMOD=2.003                         *
  3816*                                                               *
  3817*            M O V E   N A M E   W O R K   A R E A.             *
  3818*                                                               *
  3819*****************************************************************.
  3820
  3821 01  WS-NAME-WORK-AREA.
  3822     05  WS-INSURED-LAST-NAME        PIC X(15).
  3823     05  WS-INSURED-1ST-NAME         PIC X(12).
  3824     05  WS-INSURED-MID-INIT         PIC X.
  3825
  3826     05  WS-NAME-WORK.
  3827         10  WS-NW                   PIC X
  3828             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  3829
  3830     05  WS-NAME-WORK2.
  3831         10  WS-NW2                  PIC X
  3832             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  3833                                        NWA-INDEX0.
  3834
  3835     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  3836                                     COMP-3.
  3837
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  74
* EL689.cbl
  3839*    COPY ELCEMIB.
  3840******************************************************************
  3841*                                                                *
  3842*                                                                *
  3843*                            ELCEMIB.                            *
  3844*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3845*                            VMOD=2.005                          *
  3846*                                                                *
  3847*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  3848*                                                                *
  3849******************************************************************
  3850 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  3851     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  3852     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  3853     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  3854     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  3855     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  3856     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  3857     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  3858     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  3859     12  EMI-SWITCH1             PIC X        VALUE '1'.
  3860         88  EMI-NO-ERRORS                    VALUE '1'.
  3861         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  3862         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  3863     12  EMI-SWITCH2             PIC X        VALUE '1'.
  3864         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  3865     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  3866         88  EMI-AREA1-EMPTY                  VALUE '1'.
  3867         88  EMI-AREA1-FULL                   VALUE '2'.
  3868     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  3869         88  EMI-AREA2-EMPTY                  VALUE '1'.
  3870         88  EMI-AREA2-FULL                   VALUE '2'.
  3871     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  3872         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  3873         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  3874         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  3875         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  3876         88  EMI-BYPASS-FATALS                VALUE 'X'.
  3877     12  EMI-ERROR-LINES.
  3878         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3879         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3880         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3881         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3882             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3883                 24  EMI-ERR-NUM         PIC X(4).
  3884                 24  EMI-FILLER          PIC X.
  3885                 24  EMI-SEV             PIC X.
  3886                 24  FILLER              PIC X.
  3887             20  FILLER                  PIC X(02).
  3888     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3889         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3890             20  EMI-ERROR-NUMBER    PIC X(4).
  3891             20  EMI-FILL            PIC X.
  3892             20  EMI-SEVERITY        PIC X.
  3893             20  FILLER              PIC X.
  3894             20  EMI-ERROR-TEXT.
  3895                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3896                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  75
* EL689.cbl
  3897     12  EMI-SEVERITY-SAVE           PIC X.
  3898         88  EMI-NOTE                    VALUE 'N'.
  3899         88  EMI-WARNING                 VALUE 'W'.
  3900         88  EMI-FORCABLE                VALUE 'F'.
  3901         88  EMI-FATAL                   VALUE 'X'.
  3902     12  EMI-MESSAGE-FLAG            PIC X.
  3903         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3904         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3905     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3906     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3907         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3908         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3909         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3910     12  emi-claim-no                pic x(7).
  3911     12  emi-claim-type              pic x(6).
  3912     12  FILLER                      PIC X(124)  VALUE SPACES.
  3913     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3914     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3915     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3916     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  3917 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  76
* EL689.cbl
  3919*    COPY ELCLOGOF.
  3920******************************************************************
  3921*                                                                *
  3922*                                                                *
  3923*                            ELCLOGOF.                           *
  3924*                            VMOD=2.001                          *
  3925*                                                                *
  3926*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  3927*                                                                *
  3928******************************************************************
  3929 01  CLASIC-LOGOFF.
  3930     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  3931     12  LOGOFF-TEXT.
  3932         16  FILLER          PIC X(5)    VALUE SPACES.
  3933         16  LOGOFF-MSG.
  3934             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  3935             20  FILLER      PIC X       VALUE SPACES.
  3936             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  3937         16  FILLER          PIC X(80)
  3938           VALUE '* YOU ARE NOW LOGGED OFF'.
  3939         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  3940         16  FILLER          PIC X       VALUE QUOTE.
  3941         16  LOGOFF-SYS-MSG  PIC X(17)
  3942           VALUE 'S CLAS-IC SYSTEM '.
  3943     12  TEXT-MESSAGES.
  3944         16  UNACCESS-MSG    PIC X(29)
  3945             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  3946         16  PGMIDERR-MSG    PIC X(17)
  3947             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  77
* EL689.cbl
  3949*    COPY ELCSCTM.
  3950******************************************************************
  3951*                                                                *
  3952*                                                                *
  3953*                            ELCSCTM                             *
  3954*                            VMOD=2.001                          *
  3955*                                                                *
  3956*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  3957*                                                                *
  3958******************************************************************
  3959 01  SECURITY-MESSAGE.
  3960     12  FILLER                          PIC X(30)
  3961            VALUE '** LOGIC SECURITY VIOLATION -'.
  3962     12  SM-READ                         PIC X(6).
  3963     12  FILLER                          PIC X(5)
  3964            VALUE ' PGM='.
  3965     12  SM-PGM                          PIC X(6).
  3966     12  FILLER                          PIC X(5)
  3967            VALUE ' OPR='.
  3968     12  SM-PROCESSOR-ID                 PIC X(4).
  3969     12  FILLER                          PIC X(6)
  3970            VALUE ' TERM='.
  3971     12  SM-TERMID                       PIC X(4).
  3972     12  FILLER                          PIC XX   VALUE SPACE.
  3973     12  SM-JUL-DATE                     PIC 9(5).
  3974     12  FILLER                          PIC X    VALUE SPACE.
  3975     12  SM-TIME                         PIC 99.99.
  3976
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  78
* EL689.cbl
  3978*    COPY ELCSCRTY.
  3979******************************************************************
  3980*                                                                *
  3981*                                                                *
  3982*                            ELCSCRTY                            *
  3983*                            VMOD=2.001                          *
  3984*                                                                *
  3985*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  3986*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  3987*        SAVED IN PI-SECURITY-ADDRESS.                           *
  3988*                                                                *
  3989******************************************************************
  3990 01  SECURITY-CONTROL.
  3991     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  3992     12  FILLER                       PIC XX    VALUE 'SC'.
  3993     12  SC-CREDIT-CODES.
  3994         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  3995             20  SC-CREDIT-DISPLAY    PIC X.
  3996             20  SC-CREDIT-UPDATE     PIC X.
  3997     12  SC-CLAIMS-CODES.
  3998         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  3999             20  SC-CLAIMS-DISPLAY    PIC X.
  4000             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  79
* EL689.cbl
  4002
  4003 01  W-TS-WORK-AREA              PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  80
* EL689.cbl
  4005****************************************************************
  4006*
  4007* Copyright (c) 2007 by Clerity Solutions, Inc.
  4008* All rights reserved.
  4009*
  4010****************************************************************
  4011 01  DFHEIV.
  4012   02  DFHEIV0               PIC X(35).
  4013   02  DFHEIV1               PIC X(08).
  4014   02  DFHEIV2               PIC X(08).
  4015   02  DFHEIV3               PIC X(08).
  4016   02  DFHEIV4               PIC X(06).
  4017   02  DFHEIV5               PIC X(04).
  4018   02  DFHEIV6               PIC X(04).
  4019   02  DFHEIV7               PIC X(02).
  4020   02  DFHEIV8               PIC X(02).
  4021   02  DFHEIV9               PIC X(01).
  4022   02  DFHEIV10              PIC S9(7) COMP-3.
  4023   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4024   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4025   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4026   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4027   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4028   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4029   02  DFHEIV17              PIC X(04).
  4030   02  DFHEIV18              PIC X(04).
  4031   02  DFHEIV19              PIC X(04).
  4032   02  DFHEIV20              USAGE IS POINTER.
  4033   02  DFHEIV21              USAGE IS POINTER.
  4034   02  DFHEIV22              USAGE IS POINTER.
  4035   02  DFHEIV23              USAGE IS POINTER.
  4036   02  DFHEIV24              USAGE IS POINTER.
  4037   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4038   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4039   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4040   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4041   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4042   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4043   02  FILLER                PIC X(02).
  4044   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4045   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4046   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4047   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4048   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4049 LINKAGE  SECTION.
  4050*****************************************************************
  4051*                                                               *
  4052* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4053* All rights reserved.                                          *
  4054*                                                               *
  4055*****************************************************************
  4056 01  dfheiblk.
  4057     02  eibtime          pic s9(7) comp-3.
  4058     02  eibdate          pic s9(7) comp-3.
  4059     02  eibtrnid         pic x(4).
  4060     02  eibtaskn         pic s9(7) comp-3.
  4061     02  eibtrmid         pic x(4).
  4062     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  81
* EL689.cbl
  4063     02  eibcposn         pic s9(4) comp.
  4064     02  eibcalen         pic s9(4) comp.
  4065     02  eibaid           pic x(1).
  4066     02  eibfiller1       pic x(1).
  4067     02  eibfn            pic x(2).
  4068     02  eibfiller2       pic x(2).
  4069     02  eibrcode         pic x(6).
  4070     02  eibfiller3       pic x(2).
  4071     02  eibds            pic x(8).
  4072     02  eibreqid         pic x(8).
  4073     02  eibrsrce         pic x(8).
  4074     02  eibsync          pic x(1).
  4075     02  eibfree          pic x(1).
  4076     02  eibrecv          pic x(1).
  4077     02  eibsend          pic x(1).
  4078     02  eibatt           pic x(1).
  4079     02  eibeoc           pic x(1).
  4080     02  eibfmh           pic x(1).
  4081     02  eibcompl         pic x(1).
  4082     02  eibsig           pic x(1).
  4083     02  eibconf          pic x(1).
  4084     02  eiberr           pic x(1).
  4085     02  eibrldbk         pic x(1).
  4086     02  eiberrcd         pic x(4).
  4087     02  eibsynrb         pic x(1).
  4088     02  eibnodat         pic x(1).
  4089     02  eibfiller5       pic x(2).
  4090     02  eibresp          pic 9(09) comp.
  4091     02  eibresp2         pic 9(09) comp.
  4092     02  dfheigdj         pic s9(4) comp.
  4093     02  dfheigdk         pic s9(4) comp.
  4094 01  DFHCOMMAREA                 PIC X(1024).
  4095 01  var  pic x(30).
  4096
  4097*    COPY ERCACCT.
  4098******************************************************************
  4099*                                                                *
  4100*                                                                *
  4101*                            ERCACCT                             *
  4102*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4103*                            VMOD=2.031                          *
  4104*                                                                *
  4105*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4106*                                                                *
  4107*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4108*   VSAM ACCOUNT MASTER FILES.                                   *
  4109*                                                                *
  4110*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4111*                                                                *
  4112*   FILE TYPE = VSAM,KSDS                                        *
  4113*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4114*                                                                *
  4115*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4116*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4117*                                                                *
  4118*   LOG = NO                                                     *
  4119*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4120*                                                                *
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  82
* EL689.cbl
  4121*                                                                *
  4122******************************************************************
  4123*                   C H A N G E   L O G
  4124*
  4125* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4126*-----------------------------------------------------------------
  4127*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4128* EFFECTIVE    NUMBER
  4129*-----------------------------------------------------------------
  4130* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4131* 092705    2005050300006  PEMA  ADD SPP LEASES
  4132* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4133* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4134* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4135* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4136* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4137******************************************************************
  4138
  4139 01  ACCOUNT-MASTER.
  4140     12  AM-RECORD-ID                      PIC XX.
  4141         88  VALID-AM-ID                      VALUE 'AM'.
  4142
  4143     12  AM-CONTROL-PRIMARY.
  4144         16  AM-COMPANY-CD                 PIC X.
  4145         16  AM-MSTR-CNTRL.
  4146             20  AM-CONTROL-A.
  4147                 24  AM-CARRIER            PIC X.
  4148                 24  AM-GROUPING.
  4149                     28 AM-GROUPING-PREFIX PIC XXX.
  4150                     28 AM-GROUPING-PRIME  PIC XXX.
  4151                 24  AM-STATE              PIC XX.
  4152                 24  AM-ACCOUNT.
  4153                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4154                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4155             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4156                                           PIC X(19).
  4157             20  AM-CNTRL-B.
  4158                 24  AM-EXPIRATION-DT      PIC XX.
  4159                 24  FILLER                PIC X(4).
  4160             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4161                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4162
  4163     12  AM-CONTROL-BY-VAR-GRP.
  4164         16  AM-COMPANY-CD-A1              PIC X.
  4165         16  AM-VG-CARRIER                 PIC X.
  4166         16  AM-VG-GROUPING                PIC X(6).
  4167         16  AM-VG-STATE                   PIC XX.
  4168         16  AM-VG-ACCOUNT                 PIC X(10).
  4169         16  AM-VG-DATE.
  4170             20  AM-VG-EXPIRATION-DT       PIC XX.
  4171             20  FILLER                    PIC X(4).
  4172         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4173                                           PIC 9(11)      COMP-3.
  4174     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4175         16  FILLER                        PIC X(10).
  4176         16  AM-VG-KEY3.
  4177             20  AM-VG3-ACCOUNT            PIC X(10).
  4178             20  AM-VG3-EXP-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  83
* EL689.cbl
  4179         16  FILLER                        PIC X(4).
  4180     12  AM-MAINT-INFORMATION.
  4181         16  AM-LAST-MAINT-DT              PIC XX.
  4182         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4183         16  AM-LAST-MAINT-USER            PIC X(4).
  4184         16  FILLER                        PIC XX.
  4185
  4186     12  AM-EFFECTIVE-DT                   PIC XX.
  4187     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4188
  4189     12  AM-PREV-DATES  COMP-3.
  4190         16  AM-PREV-EXP-DT                PIC 9(11).
  4191         16  AM-PREV-EFF-DT                PIC 9(11).
  4192
  4193     12  AM-REPORT-CODE-1                  PIC X(10).
  4194     12  AM-REPORT-CODE-2                  PIC X(10).
  4195
  4196     12  AM-CITY-CODE                      PIC X(4).
  4197     12  AM-COUNTY-PARISH                  PIC X(6).
  4198
  4199     12  AM-NAME                           PIC X(30).
  4200     12  AM-PERSON                         PIC X(30).
  4201     12  AM-ADDRS                          PIC X(30).
  4202     12  AM-CITY.
  4203         16  AM-ADDR-CITY                  PIC X(28).
  4204         16  AM-ADDR-STATE                 PIC XX.
  4205     12  AM-ZIP.
  4206         16  AM-ZIP-PRIME.
  4207             20  AM-ZIP-PRI-1ST            PIC X.
  4208                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4209             20  FILLER                    PIC X(4).
  4210         16  AM-ZIP-PLUS4                  PIC X(4).
  4211     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4212         16  AM-CAN-POSTAL-1               PIC XXX.
  4213         16  AM-CAN-POSTAL-2               PIC XXX.
  4214         16  FILLER                        PIC XXX.
  4215     12  AM-TEL-NO.
  4216         16  AM-AREA-CODE                  PIC 999.
  4217         16  AM-TEL-PRE                    PIC 999.
  4218         16  AM-TEL-NBR                    PIC 9(4).
  4219     12  AM-TEL-LOC                        PIC X.
  4220         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4221         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4222
  4223     12  AM-COMM-STRUCTURE.
  4224         16  AM-DEFN-1.
  4225             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4226                 24  AM-AGT.
  4227                     28  AM-AGT-PREFIX     PIC X(4).
  4228                     28  AM-AGT-PRIME      PIC X(6).
  4229                 24  AM-COM-TYP            PIC X.
  4230                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4231                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4232                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4233                 24  AM-RECALC-LV-INDIC    PIC X.
  4234                 24  AM-RETRO-LV-INDIC     PIC X.
  4235                 24  AM-GL-CODES           PIC X.
  4236                 24  AM-COMM-CHARGEBACK    PIC 9(02).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  84
* EL689.cbl
  4237                 24  FILLER                PIC X(01).
  4238         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4239             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4240                 24  FILLER                PIC X(11).
  4241                 24  AM-L-COMA             PIC XXX.
  4242                 24  AM-J-COMA             PIC XXX.
  4243                 24  AM-A-COMA             PIC XXX.
  4244                 24  FILLER                PIC X(6).
  4245
  4246     12  AM-COMM-CHANGE-STATUS             PIC X.
  4247         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4248
  4249     12  AM-CSR-CODE                       PIC X(4).
  4250
  4251     12  AM-BILLING-STATUS                 PIC X.
  4252         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4253         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4254     12  AM-AUTO-REFUND-SW                 PIC X.
  4255         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4256         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4257     12  AM-GPCD                           PIC 99.
  4258     12  AM-IG                             PIC X.
  4259         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4260         88  AM-HAS-GROUP                     VALUE '2'.
  4261     12  AM-STATUS                         PIC X.
  4262         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4263         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4264         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4265         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4266         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4267         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4268     12  AM-REMIT-TO                       PIC 99.
  4269     12  AM-ID-NO                          PIC X(11).
  4270
  4271     12  AM-CAL-TABLE                      PIC XX.
  4272     12  AM-LF-DEVIATION                   PIC XXX.
  4273     12  AM-AH-DEVIATION                   PIC XXX.
  4274     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4275     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4276     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4277     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4278     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4279     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4280
  4281     12  AM-USER-FIELDS.
  4282         16  AM-FLD-1                      PIC XX.
  4283         16  AM-FLD-2                      PIC XX.
  4284         16  AM-FLD-3                      PIC XX.
  4285         16  AM-FLD-4                      PIC XX.
  4286         16  AM-FLD-5                      PIC XX.
  4287
  4288     12  AM-1ST-PROD-DATE.
  4289         16  AM-1ST-PROD-YR                PIC XX.
  4290         16  AM-1ST-PROD-MO                PIC XX.
  4291         16  AM-1ST-PROD-DA                PIC XX.
  4292     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4293     12  AM-CERTS-PURGED-DATE.
  4294         16  AM-PUR-YR                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  85
* EL689.cbl
  4295         16  AM-PUR-MO                     PIC XX.
  4296         16  AM-PUR-DA                     PIC XX.
  4297     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4298     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4299     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4300     12  AM-INACTIVE-DATE.
  4301         16  AM-INA-MO                     PIC 99.
  4302         16  AM-INA-DA                     PIC 99.
  4303         16  AM-INA-YR                     PIC 99.
  4304     12  AM-AR-HI-CERT-DATE                PIC XX.
  4305
  4306     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4307     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4308
  4309     12  AM-OB-PAYMENT-MODE                PIC X.
  4310         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4311         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4312         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4313         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4314
  4315     12  AM-AH-ONLY-INDICATOR              PIC X.
  4316         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4317         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4318
  4319     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4320
  4321     12  AM-OVER-SHORT.
  4322         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4323         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4324
  4325     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4326     12  AM-DCC-CLP-STATE                  PIC XX.
  4327
  4328     12  AM-RECALC-COMM                    PIC X.
  4329     12  AM-RECALC-REIN                    PIC X.
  4330
  4331     12  AM-REI-TABLE                      PIC XXX.
  4332     12  AM-REI-ET-LF                      PIC X.
  4333     12  AM-REI-ET-AH                      PIC X.
  4334     12  AM-REI-PE-LF                      PIC X.
  4335     12  AM-REI-PE-AH                      PIC X.
  4336     12  AM-REI-PRT-ST                     PIC X.
  4337     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4338     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  4339     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4340     12  AM-REI-GROUP-A                    PIC X(6).
  4341     12  AM-REI-MORT                       PIC X(4).
  4342     12  AM-REI-PRT-OW                     PIC X.
  4343     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4344     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4345     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4346     12  AM-REI-GROUP-B                    PIC X(6).
  4347
  4348     12  AM-TRUST-TYPE                     PIC X(2).
  4349
  4350     12  AM-EMPLOYER-STMT-USED             PIC X.
  4351     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4352
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  86
* EL689.cbl
  4353     12  AM-STD-AH-TYPE                    PIC XX.
  4354     12  AM-EARN-METHODS.
  4355         16  AM-EARN-METHOD-R              PIC X.
  4356             88 AM-REF-RL-R78                 VALUE 'R'.
  4357             88 AM-REF-RL-PR                  VALUE 'P'.
  4358             88 AM-REF-RL-MEAN                VALUE 'M'.
  4359             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4360         16  AM-EARN-METHOD-L              PIC X.
  4361             88 AM-REF-LL-R78                 VALUE 'R'.
  4362             88 AM-REF-LL-PR                  VALUE 'P'.
  4363             88 AM-REF-LL-MEAN                VALUE 'M'.
  4364             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4365         16  AM-EARN-METHOD-A              PIC X.
  4366             88 AM-REF-AH-R78                 VALUE 'R'.
  4367             88 AM-REF-AH-PR                  VALUE 'P'.
  4368             88 AM-REF-AH-MEAN                VALUE 'M'.
  4369             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4370             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4371             88 AM-REF-AH-NET                 VALUE 'N'.
  4372
  4373     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4374     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4375     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4376
  4377     12  AM-RET-Y-N                        PIC X.
  4378     12  AM-RET-P-E                        PIC X.
  4379     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4380     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4381     12  AM-RET-GRP                        PIC X(6).
  4382     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4383         16  AM-POOL-PRIME                 PIC XXX.
  4384         16  AM-POOL-SUB                   PIC XXX.
  4385     12  AM-RETRO-EARNINGS.
  4386         16  AM-RET-EARN-R                 PIC X.
  4387         16  AM-RET-EARN-L                 PIC X.
  4388         16  AM-RET-EARN-A                 PIC X.
  4389     12  AM-RET-ST-TAX-USE                 PIC X.
  4390         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4391         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4392     12  AM-RETRO-BEG-EARNINGS.
  4393         16  AM-RET-BEG-EARN-R             PIC X.
  4394         16  AM-RET-BEG-EARN-L             PIC X.
  4395         16  AM-RET-BEG-EARN-A             PIC X.
  4396     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4397     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4398
  4399     12  AM-USER-SELECT-OPTIONS.
  4400         16  AM-USER-SELECT-1              PIC X(10).
  4401         16  AM-USER-SELECT-2              PIC X(10).
  4402         16  AM-USER-SELECT-3              PIC X(10).
  4403         16  AM-USER-SELECT-4              PIC X(10).
  4404         16  AM-USER-SELECT-5              PIC X(10).
  4405
  4406     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4407
  4408     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4409
  4410     12  AM-RPT045A-SWITCH                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  87
* EL689.cbl
  4411         88  RPT045A-OFF                   VALUE 'N'.
  4412
  4413     12  AM-INSURANCE-LIMITS.
  4414         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4415         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4416
  4417     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4418         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4419
  4420     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4421         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4422         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4423
  4424     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4425
  4426     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4427     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4428     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4429     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4430     12  AM-DCC-UEF-STATE                  PIC XX.
  4431     12  FILLER                            PIC XXX.
  4432     12  AM-REPORT-CODE-3                  PIC X(10).
  4433*    12  FILLER                            PIC X(22).
  4434
  4435     12  AM-RESERVE-DATE.
  4436         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4437         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4438         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4439
  4440     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4441     12  AM-NOTIFICATION-TYPES.
  4442         16  AM-NOTIF-OF-LETTERS           PIC X.
  4443         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4444         16  AM-NOTIF-OF-REPORTS           PIC X.
  4445         16  AM-NOTIF-OF-STATUS            PIC X.
  4446
  4447     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4448         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4449         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4450         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4451         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4452
  4453     12  AM-BENEFIT-CONTROLS.
  4454         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4455             20  AM-BENEFIT-CODE           PIC XX.
  4456             20  AM-BENEFIT-TYPE           PIC X.
  4457             20  AM-BENEFIT-REVISION       PIC XXX.
  4458             20  AM-BENEFIT-REM-TERM       PIC X.
  4459             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4460             20  FILLER                    PIC XX.
  4461         16  FILLER                        PIC X(80).
  4462
  4463     12  AM-TRANSFER-DATA.
  4464         16  AM-TRANSFERRED-FROM.
  4465             20  AM-TRNFROM-CARRIER        PIC X.
  4466             20  AM-TRNFROM-GROUPING.
  4467                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4468                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  88
* EL689.cbl
  4469             20  AM-TRNFROM-STATE          PIC XX.
  4470             20  AM-TRNFROM-ACCOUNT.
  4471                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4472                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4473             20  AM-TRNFROM-DTE            PIC XX.
  4474         16  AM-TRANSFERRED-TO.
  4475             20  AM-TRNTO-CARRIER          PIC X.
  4476             20  AM-TRNTO-GROUPING.
  4477                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4478                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4479             20  AM-TRNTO-STATE            PIC XX.
  4480             20  AM-TRNTO-ACCOUNT.
  4481                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4482                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4483             20  AM-TRNTO-DTE              PIC XX.
  4484         16  FILLER                        PIC X(10).
  4485
  4486     12  AM-SAVED-REMIT-TO                 PIC 99.
  4487
  4488     12  AM-COMM-STRUCTURE-SAVED.
  4489         16  AM-DEFN-1-SAVED.
  4490             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4491                 24  AM-AGT-SV             PIC X(10).
  4492                 24  AM-COM-TYP-SV         PIC X.
  4493                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4494                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4495                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4496                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4497                 24  FILLER                PIC X.
  4498                 24  AM-GL-CODES-SV        PIC X.
  4499                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4500                 24  FILLER                PIC X.
  4501         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4502             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4503                 24  FILLER                PIC X(11).
  4504                 24  AM-L-COMA-SV          PIC XXX.
  4505                 24  AM-J-COMA-SV          PIC XXX.
  4506                 24  AM-A-COMA-SV          PIC XXX.
  4507                 24  FILLER                PIC X(6).
  4508
  4509     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4510         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4511            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4512            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4513            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4514
  4515     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4516     12  FILLER                            PIC X(120).
  4517
  4518     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4519         16  AM-CONTROL-NAME               PIC X(30).
  4520         16  AM-EXECUTIVE-ONE.
  4521             20  AM-EXEC1-NAME             PIC X(15).
  4522             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4523                                                          COMP-3.
  4524             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4525                                                          COMP-3.
  4526         16  AM-EXECUTIVE-TWO.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  89
* EL689.cbl
  4527             20  AM-EXEC2-NAME             PIC X(15).
  4528             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4529                                                          COMP-3.
  4530             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4531                                                          COMP-3.
  4532
  4533     12  AM-RETRO-ADDITIONAL-DATA.
  4534         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4535         16  AM-RETRO-PREM-P-E             PIC X.
  4536         16  AM-RETRO-CLMS-P-I             PIC X.
  4537         16  AM-RETRO-RET-BRACKET-LF.
  4538             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4539                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4540                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4541             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4542                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4543                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4544             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4545                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4546                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4547         16  AM-RETRO-RET-BRACKET-AH.
  4548             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4549                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4550                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4551                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4552             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4553                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4554                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4555             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4556                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4557                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4558
  4559     12  AM-COMMENTS.
  4560         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4561
  4562     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4563         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4564         16  AM-FLI-BILLING-CODE           PIC X.
  4565         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4566         16  AM-FLI-UNITED-IDENT           PIC X.
  4567         16  AM-FLI-INTEREST-LOST-DATA.
  4568             20  AM-FLI-BANK-NO            PIC X(5).
  4569             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4570             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4571             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4572         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4573             20  AM-FLI-AGT                PIC X(9).
  4574             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4575             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4576         16  FILLER                        PIC X(102).
  4577
  4578     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4579         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4580             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4581             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4582             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4583             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4584             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  90
* EL689.cbl
  4585         16  FILLER                          PIC X(10).
  4586******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  91
* EL689.cbl
  4588*    COPY ERCARCH.
  4589******************************************************************
  4590*                                                                *
  4591*                            ERCARCH.                            *
  4592*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4593*                            VMOD=2.002                          *
  4594*                                                                *
  4595*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4596*                                                                *
  4597*   FILE TYPE = VSAM,KSDS                                        *
  4598*   RECORD SIZE = 250  RECFORM = FIXED                           *
  4599*                                                                *
  4600*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  4601*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  4602*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  4603*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  4604*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  4605*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  4606*                                                                *
  4607*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4608******************************************************************
  4609*                   C H A N G E   L O G
  4610*
  4611* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4612*-----------------------------------------------------------------
  4613*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4614* EFFECTIVE    NUMBER
  4615*-----------------------------------------------------------------
  4616* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  4617* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4618* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4619******************************************************************
  4620 01  LETTER-ARCHIVE.
  4621     12  LA-RECORD-ID                PIC  X(02).
  4622         88  LA-VALID-ID                VALUE 'LA'.
  4623
  4624     12  LA-CONTROL-PRIMARY.
  4625         16  LA-COMPANY-CD           PIC  X(01).
  4626         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  4627
  4628     12  LA-CONTROL-BY-CERT-RESP.
  4629         16  LA-COMPANY-CD-A2        PIC  X(01).
  4630         16  LA-CERT-NO-A2.
  4631             20  LA-CERT-PRIME-A2    PIC  X(10).
  4632             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  4633         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  4634             20  LA-RESP-PERSON-A2   PIC  X(10).
  4635             20  LA-TYPE-A2          PIC  X(01).
  4636         16  LA-CARRIER-A2           PIC  X(01).
  4637         16  LA-GROUPING-A2          PIC  X(06).
  4638         16  LA-STATE-A2             PIC  X(02).
  4639         16  LA-ACCOUNT-A2           PIC  X(10).
  4640         16  LA-EFFECT-DATE-A2       PIC  X(02).
  4641         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  4642
  4643     12  LA-CONTROL-BY-FORM.
  4644         16  LA-COMPANY-CD-A3        PIC  X(01).
  4645         16  LA-FORM-A3              PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  92
* EL689.cbl
  4646         16  LA-CARRIER-A3           PIC  X(01).
  4647         16  LA-GROUPING-A3          PIC  X(06).
  4648         16  LA-STATE-A3             PIC  X(02).
  4649         16  LA-ACCOUNT-A3           PIC  X(10).
  4650         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  4651
  4652     12  LA-CONTROL-BY-PROCESSOR.
  4653         16  LA-COMPANY-CD-A4        PIC  X(01).
  4654         16  LA-PROCESSOR-CD         PIC  X(04).
  4655         16  LA-CARRIER-A4           PIC  X(01).
  4656         16  LA-GROUPING-A4          PIC  X(06).
  4657         16  LA-STATE-A4             PIC  X(02).
  4658         16  LA-ACCOUNT-A4           PIC  X(10).
  4659         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  4660
  4661     12  LA-CONTROL-BY-KEY-FIELDS.
  4662         16  LA-COMPANY-CD-A5        PIC  X(01).
  4663         16  LA-CARRIER-A5           PIC  X(01).
  4664         16  LA-GROUPING-A5          PIC  X(06).
  4665         16  LA-STATE-A5             PIC  X(02).
  4666         16  LA-ACCOUNT-A5           PIC  X(10).
  4667         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  4668
  4669     12  LA-CONTROL-BY-GROUP-CODE.
  4670         16  LA-COMPANY-CD-A6        PIC  X(01).
  4671         16  LA-ENTRY-A6.
  4672             20  LA-FILLER           PIC  X(02).
  4673             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  4674         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  4675
  4676     12  FILLER                      PIC  X(09).
  4677
  4678     12  LA-HEADER-RECORD.
  4679         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  4680         16  LA-CREATION-DATE        PIC  X(02).
  4681         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  4682         16  LA-FINAL-ACT-DATE       REDEFINES
  4683               LA-FOLLOW-UP-DATE     PIC  X(02).
  4684         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  4685         16  LA-NO-OF-COPIES         PIC S9(01).
  4686         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  4687         16  LA-REPLY-DATE           PIC  X(02).
  4688         16  LA-RESEND-DATES.
  4689             20  LA-RESEND-DATE      PIC  X(02).
  4690             20  LA-SENT-DATE        PIC  X(02).
  4691             20  FILLER              PIC  X(08).
  4692         16  LA-SOURCE-INFORMATION.
  4693             20  LA-DATA-SOURCE      PIC  X(01).
  4694             20  LA-ADDR-SOURCE      PIC  X(01).
  4695         16  LA-STATUS               PIC  X(01).
  4696             88  LA-STATUS-ACTIVE         VALUE 'A'.
  4697             88  LA-STATUS-COMPLETED      VALUE 'C'.
  4698             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  4699             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  4700             88  LA-STATUS-PURGED         VALUE 'P'.
  4701             88  LA-STATUS-VOIDED         VALUE 'V'.
  4702         16  LA-LAST-RESENT-PRINT-DATE
  4703                                     PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  93
* EL689.cbl
  4704         16  LA-PRINT-RESTRICTION    PIC  X(01).
  4705             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4706                                          VALUE 'C'.
  4707             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4708                                          VALUE 'F'.
  4709             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4710                                          VALUE 'P'.
  4711         16  LA-PURGED-DATE          PIC  X(02).
  4712         16  LA-VOIDED-DATE          PIC  X(02).
  4713         16  LA-RESEND-LETR          PIC  X(4).
  4714         16  FILLER                  PIC  X(08).
  4715*        16  LA-RESEND-LETR-2        PIC  X(4).
  4716*        16  LA-RESEND-LETR-3        PIC  X(4).
  4717*        16  FILLER                  PIC  X(59).
  4718         16  LA-ARCHIVE-STATUS       PIC  X.
  4719             88  LA-TEMP                VALUE 'T'.
  4720             88  LA-QWS                 VALUE 'Q'.
  4721             88  LA-BATCH               VALUE 'B'.
  4722         16  LA-FINAL-ACT-IND        PIC  X(1).
  4723         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  4724         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  4725         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  4726                                     PIC X(4).
  4727         16  FILLER                  PIC  X(42).
  4728*        16  FILLER                  PIC  X(71).
  4729         16  LA-LAST-MAINT-DATE      PIC  X(2).
  4730         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  4731         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  4732                                     PIC  X(4).
  4733         16  LA-LAST-UPDATED-BY      PIC  X(4).
  4734
  4735******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  94
* EL689.cbl
  4737*    COPY ERCARCT.
  4738******************************************************************
  4739*                                                                *
  4740*                            ERCARCT.                            *
  4741*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4742*                            VMOD=2.002                          *
  4743*                                                                *
  4744*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  4745*                                                                *
  4746*   FILE TYPE = VSAM,KSDS                                        *
  4747*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  4748*                                                                *
  4749*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  4750*                                                                *
  4751*   LOG = NO                                                     *
  4752*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4753******************************************************************
  4754*                   C H A N G E   L O G
  4755*
  4756* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4757*-----------------------------------------------------------------
  4758*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4759* EFFECTIVE    NUMBER
  4760*-----------------------------------------------------------------
  4761* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4762******************************************************************
  4763 01  LETTER-ARCHIVE-TEXT.
  4764     12  LT-RECORD-ID                PIC  X(02).
  4765         88  LT-VALID-ID                VALUE 'LT'.
  4766
  4767     12  LT-CONTROL-PRIMARY.
  4768         16  LT-COMPANY-CD           PIC  X(01).
  4769         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  4770         16  LT-RECORD-TYPE          PIC  X(01).
  4771             88  LT-ADDRESS-DATA        VALUE '1'.
  4772             88  LT-TEXT-DATA           VALUE '2'.
  4773             88  LT-COMMENT-DATA        VALUE '3'.
  4774         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  4775
  4776     12  FILLER                      PIC  X(28).
  4777     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  4778
  4779     12  LT-TEXT-RECORD.
  4780         16  LT-LETTER-TEXT OCCURS 20 TIMES
  4781                            INDEXED BY LT-NDX.
  4782             20  LT-TEXT-LINE        PIC  X(70).
  4783             20  LT-SKIP-CONTROL     PIC  X(02).
  4784                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  4785                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  4786             20  FILLER              PIC  X(08).
  4787
  4788     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  4789         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  4790             20  LT-COMMENT-LINE     PIC X(69).
  4791             20  LT-COMMENT-CHG-DT   PIC X(02).
  4792             20  LT-COMMENT-CHG-BY   PIC X(04).
  4793             20  FILLER              PIC X(05).
  4794
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  95
* EL689.cbl
  4796*    COPY ELCCERT.
  4797******************************************************************
  4798*                                                                *
  4799*                            ELCCERT.                            *
  4800*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4801*                            VMOD=2.013                          *
  4802*                                                                *
  4803*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4804*                                                                *
  4805*   FILE TYPE = VSAM,KSDS                                        *
  4806*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4807*                                                                *
  4808*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4809*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4810*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4811*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4812*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4813*                                                                *
  4814*   LOG = YES                                                    *
  4815*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4816******************************************************************
  4817*                   C H A N G E   L O G
  4818*
  4819* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4820*-----------------------------------------------------------------
  4821*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4822* EFFECTIVE    NUMBER
  4823*-----------------------------------------------------------------
  4824* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4825* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4826* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4827* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4828* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4829* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4830* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4831* 032612  CR2011110200001  PEMA  AHL CHANGES
  4832******************************************************************
  4833
  4834 01  CERTIFICATE-MASTER.
  4835     12  CM-RECORD-ID                      PIC XX.
  4836         88  VALID-CM-ID                      VALUE 'CM'.
  4837
  4838     12  CM-CONTROL-PRIMARY.
  4839         16  CM-COMPANY-CD                 PIC X.
  4840         16  CM-CARRIER                    PIC X.
  4841         16  CM-GROUPING.
  4842             20  CM-GROUPING-PREFIX        PIC X(3).
  4843             20  CM-GROUPING-PRIME         PIC X(3).
  4844         16  CM-STATE                      PIC XX.
  4845         16  CM-ACCOUNT.
  4846             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4847             20  CM-ACCOUNT-PRIME          PIC X(6).
  4848         16  CM-CERT-EFF-DT                PIC XX.
  4849         16  CM-CERT-NO.
  4850             20  CM-CERT-PRIME             PIC X(10).
  4851             20  CM-CERT-SFX               PIC X.
  4852
  4853     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  96
* EL689.cbl
  4854         16  CM-COMPANY-CD-A1              PIC X.
  4855         16  CM-INSURED-LAST-NAME          PIC X(15).
  4856         16  CM-INSURED-INITIALS.
  4857             20  CM-INSURED-INITIAL1       PIC X.
  4858             20  CM-INSURED-INITIAL2       PIC X.
  4859
  4860     12  CM-CONTROL-BY-SSN.
  4861         16  CM-COMPANY-CD-A2              PIC X.
  4862         16  CM-SOC-SEC-NO.
  4863             20  CM-SSN-STATE              PIC XX.
  4864             20  CM-SSN-ACCOUNT            PIC X(6).
  4865             20  CM-SSN-LN3.
  4866                 25  CM-INSURED-INITIALS-A2.
  4867                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4868                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4869                 25 CM-PART-LAST-NAME-A2         PIC X.
  4870
  4871     12  CM-CONTROL-BY-CERT-NO.
  4872         16  CM-COMPANY-CD-A4              PIC X.
  4873         16  CM-CERT-NO-A4                 PIC X(11).
  4874
  4875     12  CM-CONTROL-BY-MEMB.
  4876         16  CM-COMPANY-CD-A5              PIC X.
  4877         16  CM-MEMBER-NO.
  4878             20  CM-MEMB-STATE             PIC XX.
  4879             20  CM-MEMB-ACCOUNT           PIC X(6).
  4880             20  CM-MEMB-LN4.
  4881                 25  CM-INSURED-INITIALS-A5.
  4882                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4883                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4884                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4885
  4886     12  CM-INSURED-PROFILE-DATA.
  4887         16  CM-INSURED-FIRST-NAME.
  4888             20  CM-INSURED-1ST-INIT       PIC X.
  4889             20  FILLER                    PIC X(9).
  4890         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4891         16  CM-INSURED-SEX                PIC X.
  4892             88  CM-SEX-MALE                  VALUE 'M'.
  4893             88  CM-SEX-FEMAL                 VALUE 'F'.
  4894         16  CM-INSURED-JOINT-AGE          PIC 99.
  4895         16  CM-JOINT-INSURED-NAME.
  4896             20  CM-JT-LAST-NAME           PIC X(15).
  4897             20  CM-JT-FIRST-NAME.
  4898                 24  CM-JT-1ST-INIT        PIC X.
  4899                 24  FILLER                PIC X(9).
  4900             20  CM-JT-INITIAL             PIC X.
  4901
  4902     12  CM-LIFE-DATA.
  4903         16  CM-LF-BENEFIT-CD              PIC XX.
  4904         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4905         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4906         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4907         16  CM-LF-DEV-CODE                PIC XXX.
  4908         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4909         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4910         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4911         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  97
* EL689.cbl
  4912         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4913         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4914         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4915         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4916         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4917         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4918         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4919         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4920         16  FILLER                        PIC XX.
  4921
  4922     12  CM-AH-DATA.
  4923         16  CM-AH-BENEFIT-CD              PIC XX.
  4924         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4925         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4926         16  CM-AH-DEV-CODE                PIC XXX.
  4927         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4928         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4929         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4930         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4931         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4932         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4933         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4934         16  CM-AH-PAID-THRU-DT            PIC XX.
  4935             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4936         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4937         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4938         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4939         16  FILLER                        PIC X.
  4940
  4941     12  CM-LOAN-INFORMATION.
  4942         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4943         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4944                                           PIC S9(5)V99  COMP-3.
  4945         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4946         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4947         16  CM-PAY-FREQUENCY              PIC S99.
  4948         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4949         16  CM-RATE-CLASS                 PIC XX.
  4950         16  CM-BENEFICIARY                PIC X(25).
  4951         16  CM-POLICY-FORM-NO             PIC X(12).
  4952         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4953         16  CM-LAST-ADD-ON-DT             PIC XX.
  4954         16  CM-DEDUCTIBLE-AMOUNTS.
  4955             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4956             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4957         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4958             20  CM-RESIDENT-STATE         PIC XX.
  4959             20  CM-RATE-CODE              PIC X(4).
  4960             20  FILLER                    PIC XX.
  4961         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4962             20  CM-LOAN-OFFICER           PIC X(5).
  4963             20  FILLER                    PIC XXX.
  4964         16  CM-CSR-CODE                   PIC XXX.
  4965         16  CM-UNDERWRITING-CODE          PIC X.
  4966             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4967         16  CM-POST-CARD-IND              PIC X.
  4968         16  CM-NH-INTERFACE-SW            PIC X.
  4969         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  98
* EL689.cbl
  4970             88  CM-SING-PRM                  VALUE '1'.
  4971             88  CM-O-B-COVERAGE              VALUE '2'.
  4972             88  CM-OPEN-END                  VALUE '3'.
  4973         16  CM-IND-GRP-TYPE               PIC X.
  4974             88  CM-INDIVIDUAL                VALUE 'I'.
  4975             88  CM-GROUP                     VALUE 'G'.
  4976         16  CM-SKIP-CODE                  PIC X.
  4977             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4978             88  SKIP-JULY                    VALUE '1'.
  4979             88  SKIP-AUGUST                  VALUE '2'.
  4980             88  SKIP-SEPTEMBER               VALUE '3'.
  4981             88  SKIP-JULY-AUG                VALUE '4'.
  4982             88  SKIP-AUG-SEPT                VALUE '5'.
  4983             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4984             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4985             88  SKIP-JUNE                    VALUE '8'.
  4986             88  SKIP-JUNE-JULY               VALUE '9'.
  4987             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4988             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4989         16  CM-PAYMENT-MODE               PIC X.
  4990             88  PAY-MONTHLY                  VALUE SPACE.
  4991             88  PAY-WEEKLY                   VALUE '1'.
  4992             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4993             88  PAY-BI-WEEKLY                VALUE '3'.
  4994             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4995         16  CM-LOAN-NUMBER                PIC X(8).
  4996         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4997         16  CM-OLD-LOF                    PIC XXX.
  4998*        16  CM-LOAN-OFFICER               PIC XXX.
  4999         16  CM-REIN-TABLE                 PIC XXX.
  5000         16  CM-SPECIAL-REIN-CODE          PIC X.
  5001         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5002         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5003         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5004
  5005     12  CM-STATUS-DATA.
  5006         16  CM-ENTRY-STATUS               PIC X.
  5007         16  CM-ENTRY-DT                   PIC XX.
  5008
  5009         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5010         16  CM-LF-CANCEL-DT               PIC XX.
  5011         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5012
  5013         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5014         16  CM-LF-DEATH-DT                PIC XX.
  5015         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5016
  5017         16  CM-LF-CURRENT-STATUS          PIC X.
  5018             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5019                                                'M' '4' '5' '9'.
  5020             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5021             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5022             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5023             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5024             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5025             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5026             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5027             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page  99
* EL689.cbl
  5028             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5029             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5030             88  CM-LF-DECLINED               VALUE 'D'.
  5031             88  CM-LF-VOIDED                 VALUE 'V'.
  5032
  5033         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5034         16  CM-AH-CANCEL-DT               PIC XX.
  5035         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5036
  5037         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5038         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5039         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5040
  5041         16  CM-AH-CURRENT-STATUS          PIC X.
  5042             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5043                                                'M' '4' '5' '9'.
  5044             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5045             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5046             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5047             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5048             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5049             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5050             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5051             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5052             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5053             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5054             88  CM-AH-DECLINED               VALUE 'D'.
  5055             88  CM-AH-VOIDED                 VALUE 'V'.
  5056
  5057         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5058             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5059             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5060             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5061         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5062
  5063         16  CM-ENTRY-BATCH                PIC X(6).
  5064         16  CM-LF-EXIT-BATCH              PIC X(6).
  5065         16  CM-AH-EXIT-BATCH              PIC X(6).
  5066         16  CM-LAST-MONTH-END             PIC XX.
  5067
  5068     12  CM-NOTE-SW                        PIC X.
  5069         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5070         88  CERT-NOTES-PRESENT               VALUE '1'.
  5071         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5072         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5073         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5074         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5075         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5076         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5077     12  CM-COMP-EXCP-SW                   PIC X.
  5078         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5079         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5080     12  CM-INSURED-ADDRESS-SW             PIC X.
  5081         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5082         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5083
  5084*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5085     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 100
* EL689.cbl
  5086     12  FILLER                            PIC X.
  5087
  5088*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5089     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5090     12  FILLER                            PIC X.
  5091*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5092     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5093
  5094     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5095         88  CERT-ADDED-BATCH                 VALUE ' '.
  5096         88  CERT-ADDED-ONLINE                VALUE '1'.
  5097         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5098         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5099         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5100     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5101         88  CERT-AS-LOADED                   VALUE ' '.
  5102         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5103         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5104         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5105         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5106         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5107         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5108         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5109
  5110     12  CM-ACCOUNT-COMM-PCTS.
  5111         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5112         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5113
  5114     12  CM-USER-FIELD                     PIC X.
  5115     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5116     12  CM-CLP-STATE                      PIC XX.
  5117     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5118     12  CM-USER-RESERVED                  PIC XXX.
  5119     12  FILLER REDEFINES CM-USER-RESERVED.
  5120         16  CM-AH-CLASS-CD                PIC XX.
  5121         16  F                             PIC X.
  5122******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 101
* EL689.cbl
  5124*    COPY ERCCHEK.
  5125******************************************************************
  5126*                                                                *
  5127*                                                                *
  5128*                            ERCCHEK                             *
  5129*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5130*                            VMOD=2.008                          *
  5131*                                                                *
  5132*   FILE DESCRIPTION = CHECK RECORDS                             *
  5133*                                                                *
  5134*   FILE TYPE = VSAM,KSDS                                        *
  5135*   RECORD SIZE = 600    RECFORM = FIXED                         *
  5136*                                                                *
  5137*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  5138*       ALTERNATE INDEX = NONE                                   *
  5139*                                                                *
  5140*   LOG = YES                                                    *
  5141*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5142******************************************************************
  5143 01  CHECK-RECORDS.
  5144     12  CH-RECORD-ID                      PIC XX.
  5145         88  VALID-CH-ID                      VALUE 'CH'.
  5146
  5147     12  CH-CONTROL-PRIMARY.
  5148         16  CH-COMPANY-CD                 PIC X.
  5149         16  CH-CARRIER                    PIC X.
  5150         16  CH-GROUPING                   PIC X(6).
  5151         16  CH-STATE                      PIC XX.
  5152         16  CH-ACCOUNT                    PIC X(10).
  5153         16  CH-CERT-EFF-DT                PIC XX.
  5154         16  CH-CERT-NO.
  5155             20  CH-CERT-PRIME             PIC X(10).
  5156             20  CH-CERT-SFX               PIC X.
  5157         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  5158
  5159     12  CH-RECORDED-DT                    PIC XX.
  5160     12  CH-RECORDED-BY                    PIC X(4).
  5161     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  5162
  5163     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  5164     12  CH-CHECK-NO                       PIC X(7).
  5165     12  CH-REASON-FOR-CHECK               PIC X(25).
  5166     12  CH-CHECK-WRITTEN-DT               PIC XX.
  5167     12  CH-OFFLINE-CHECK-IND              PIC X.
  5168         88  MANUAL-CHECK-WRITTEN             VALUE 'Y'.
  5169
  5170     12  CH-PAYEE-INFO.
  5171         16  CH-PAYEE-NAME-1               PIC X(30).
  5172         16  CH-PAYEE-NAME-2               PIC X(30).
  5173         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  5174         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  5175         16  CH-PAYEE-CITY-ST              PIC X(30).
  5176         16  CH-PAYEE-ZIP-CODE.
  5177             20  CH-PAYEE-ZIP.
  5178                 24  CH-ZIP-PRI-1ST        PIC X.
  5179                     88  CH-CANADIAN-POST-CODE
  5180                                           VALUES 'A' THRU 'Z'.
  5181                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 102
* EL689.cbl
  5182             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  5183         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  5184             20  CH-CAN-POSTAL-1           PIC XXX.
  5185             20  CH-CAN-POSTAL-2           PIC XXX.
  5186             20  FILLER                    PIC XXX.
  5187
  5188     12  CH-CHECK-STUB-TEXT.
  5189         16  CH-STUB-LINE-1                PIC X(50).
  5190         16  CH-STUB-LINE-2                PIC X(50).
  5191         16  CH-STUB-LINE-3                PIC X(50).
  5192         16  FILLER.
  5193           18  CH-STUB-LINE-4              PIC X(20).
  5194           18  CH-LIENHOLDER-NAME          PIC X(30).
  5195
  5196     12  CH-COMPENSATION-CONTROL.
  5197         16  CH-COMP-CARRIER               PIC X.
  5198         16  CH-COMP-GROUPING              PIC X(6).
  5199         16  CH-COMP-FIN-RESP              PIC X(10).
  5200         16  CH-COMP-ACCOUNT               PIC X(10).
  5201
  5202     12  CH-CREDIT-SELECT-DT               PIC XX.
  5203     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  5204     12  CH-PAYEE-CODE                     PIC X(6).
  5205
  5206     12  CH-VOID-DATA.
  5207         20  CH-VOID-DT                    PIC XX.
  5208         20  CH-VOID-BY                    PIC X(4).
  5209         20  CH-VOID-REASON                PIC X(25).
  5210
  5211     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  5212             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5213     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  5214
  5215     12  CH-CHECK-REFERENCE                PIC X(12).
  5216     12  CH-CHECK-ORIGIN-SW                PIC X.
  5217             88  CH-REFUND-CHECK              VALUE 'R'.
  5218             88  CH-MAINT-CHECK               VALUE 'M'.
  5219
  5220     12  CH-CANC-DT                        PIC XX.
  5221     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  5222     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  5223
  5224     12  CH-INSURED-NAME                   PIC X(28).
  5225
  5226     12  CH-DEDUCT-WITHHELD                PIC S9(5)V99  COMP-3.
  5227     12  CH-ADDITIONAL-CHARGE              PIC S9(5)V99  COMP-3.
  5228
  5229     12  CH-LETTER-TABLE.
  5230         16  CH-LETTERS OCCURS 3 TIMES
  5231                        INDEXED BY CH-LT-NDX
  5232                                           PIC X(04).
  5233
  5234     12  FILLER                            PIC X(07).
  5235
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 103
* EL689.cbl
  5237*    COPY ELCCNTL.
  5238******************************************************************
  5239*                                                                *
  5240*                                                                *
  5241*                            ELCCNTL.                            *
  5242*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5243*                            VMOD=2.059                          *
  5244*                                                                *
  5245*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5246*                                                                *
  5247*   FILE TYPE = VSAM,KSDS                                        *
  5248*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5249*                                                                *
  5250*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5251*       ALTERNATE INDEX = NONE                                   *
  5252*                                                                *
  5253*   LOG = YES                                                    *
  5254*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5255******************************************************************
  5256*                   C H A N G E   L O G
  5257*
  5258* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5259*-----------------------------------------------------------------
  5260*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5261* EFFECTIVE    NUMBER
  5262*-----------------------------------------------------------------
  5263* 082503                   PEMA  ADD BENEFIT GROUP
  5264* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5265* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5266* 092705    2005050300006  PEMA  ADD SPP LEASES
  5267* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5268* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5269* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5270* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5271* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5272* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5273* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5274* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5275* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5276******************************************************************
  5277*
  5278 01  CONTROL-FILE.
  5279     12  CF-RECORD-ID                       PIC XX.
  5280         88  VALID-CF-ID                        VALUE 'CF'.
  5281
  5282     12  CF-CONTROL-PRIMARY.
  5283         16  CF-COMPANY-ID                  PIC XXX.
  5284         16  CF-RECORD-TYPE                 PIC X.
  5285             88  CF-COMPANY-MASTER              VALUE '1'.
  5286             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5287             88  CF-STATE-MASTER                VALUE '3'.
  5288             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5289             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5290             88  CF-CARRIER-MASTER              VALUE '6'.
  5291             88  CF-MORTALITY-MASTER            VALUE '7'.
  5292             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5293             88  CF-TERMINAL-MASTER             VALUE '9'.
  5294             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 104
* EL689.cbl
  5295             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5296             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5297             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5298             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5299             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5300             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5301             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5302             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5303         16  CF-ACCESS-CD-GENL              PIC X(4).
  5304         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5305             20  CF-PROCESSOR               PIC X(4).
  5306         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5307             20  CF-STATE-CODE              PIC XX.
  5308             20  FILLER                     PIC XX.
  5309         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5310             20  FILLER                     PIC XX.
  5311             20  CF-HI-BEN-IN-REC           PIC XX.
  5312         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5313             20  FILLER                     PIC XXX.
  5314             20  CF-CARRIER-CNTL            PIC X.
  5315         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5316             20  FILLER                     PIC XX.
  5317             20  CF-HI-TYPE-IN-REC          PIC 99.
  5318         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5319             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5320                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5321             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5322             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5323         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5324             20  FILLER                     PIC X.
  5325             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5326         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5327             20  FILLER                     PIC XX.
  5328             20  CF-MORTGAGE-PLAN           PIC XX.
  5329         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5330
  5331     12  CF-LAST-MAINT-DT                   PIC XX.
  5332     12  CF-LAST-MAINT-BY                   PIC X(4).
  5333     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5334
  5335     12  CF-RECORD-BODY                     PIC X(728).
  5336
  5337
  5338****************************************************************
  5339*             COMPANY MASTER RECORD                            *
  5340****************************************************************
  5341
  5342     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5343         16  CF-COMPANY-ADDRESS.
  5344             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5345             20  CF-CL-IN-CARE-OF           PIC X(30).
  5346             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5347             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5348             20  CF-CL-CITY-STATE           PIC X(30).
  5349             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5350             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5351         16  CF-COMPANY-CD                  PIC X.
  5352         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 105
* EL689.cbl
  5353         16  CF-SECURITY-OPTION             PIC X.
  5354             88  ALL-SECURITY                   VALUE '1'.
  5355             88  COMPANY-VERIFY                 VALUE '2'.
  5356             88  PROCESSOR-VERIFY               VALUE '3'.
  5357             88  NO-SECURITY                    VALUE '4'.
  5358             88  ALL-BUT-TERM                   VALUE '5'.
  5359         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5360             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5361         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5362             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5363         16  CF-INFORCE-LOCATION            PIC X.
  5364             88  CERTS-ARE-ONLINE               VALUE '1'.
  5365             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5366             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5367         16  CF-LOWER-CASE-LETTERS          PIC X.
  5368         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5369             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5370             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5371             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5372             88  CF-ACCNT-CNTL                  VALUE '3'.
  5373             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5374
  5375         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5376         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5377
  5378         16  CF-LGX-CREDIT-USER             PIC X.
  5379             88  CO-IS-NOT-USER                 VALUE 'N'.
  5380             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5381
  5382         16 CF-CREDIT-CALC-CODES.
  5383             20  CF-CR-REM-TERM-CALC PIC X.
  5384               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5385               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5386               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5387               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5388               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5389               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5390               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5391             20  CF-CR-R78-METHOD           PIC X.
  5392               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5393               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5394
  5395         16  CF-CLAIM-CONTROL-COUNTS.
  5396             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5397                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5398
  5399             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5400                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5401
  5402             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5403                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5404
  5405             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5406                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5407
  5408         16  CF-CURRENT-MONTH-END           PIC XX.
  5409
  5410         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 106
* EL689.cbl
  5411             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5412             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5413             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5414             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5415                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5416                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5417             20  CF-CO-PREM-REJECT-SW       PIC X.
  5418                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5419                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5420             20  CF-CO-REF-REJECT-SW        PIC X.
  5421                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5422                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5423
  5424         16  CF-CO-REPORTING-DT             PIC XX.
  5425         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5426         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5427           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5428           88  CF-CO-MONTH-END                  VALUE '1'.
  5429
  5430         16  CF-LGX-CLAIM-USER              PIC X.
  5431             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5432             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5433
  5434         16  CF-CREDIT-EDIT-CONTROLS.
  5435             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5436             20  CF-MIN-AGE                 PIC 99.
  5437             20  CF-DEFAULT-AGE             PIC 99.
  5438             20  CF-MIN-TERM                PIC S999      COMP-3.
  5439             20  CF-MAX-TERM                PIC S999      COMP-3.
  5440             20  CF-DEFAULT-SEX             PIC X.
  5441             20  CF-JOINT-AGE-INPUT         PIC X.
  5442                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5443             20  CF-BIRTH-DATE-INPUT        PIC X.
  5444                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5445             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5446                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5447                 88  CF-ZERO-CARRIER            VALUE '1'.
  5448                 88  CF-ZERO-GROUPING           VALUE '2'.
  5449                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5450             20  CF-EDIT-SW                 PIC X.
  5451                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5452             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5453             20  CF-CR-PR-METHOD            PIC X.
  5454               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5455               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5456             20  FILLER                     PIC X.
  5457
  5458         16  CF-CREDIT-MISC-CONTROLS.
  5459             20  CF-REIN-TABLE-SW           PIC X.
  5460                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5461             20  CF-COMP-TABLE-SW           PIC X.
  5462                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5463             20  CF-EXPERIENCE-RETENTION-AGE
  5464                                            PIC S9        COMP-3.
  5465             20  CF-CONVERSION-DT           PIC XX.
  5466             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5467             20  CF-RUN-FREQUENCY-SW        PIC X.
  5468                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 107
* EL689.cbl
  5469                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5470
  5471             20  CF-CR-CHECK-NO-CONTROL.
  5472                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5473                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5474                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5475                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5476                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5477                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5478
  5479                 24  CF-CR-CHECK-COUNT       REDEFINES
  5480                     CF-CR-CHECK-COUNTER      PIC X(4).
  5481
  5482                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5483                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5484
  5485                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5486                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5487                 24  CF-MAIL-PROCESSING       PIC X.
  5488                     88  MAIL-PROCESSING          VALUE 'Y'.
  5489
  5490         16  CF-MISC-SYSTEM-CONTROL.
  5491             20  CF-SYSTEM-C                 PIC X.
  5492                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5493             20  CF-SYSTEM-D                 PIC X.
  5494                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5495             20  CF-SOC-SEC-NO-SW            PIC X.
  5496                 88  SOC-SEC-NO-USED             VALUE '1'.
  5497             20  CF-MEMBER-NO-SW             PIC X.
  5498                 88  MEMBER-NO-USED              VALUE '1'.
  5499             20  CF-TAX-ID-NUMBER            PIC X(11).
  5500             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5501             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5502                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5503                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5504                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5505                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5506             20  CF-SYSTEM-E                 PIC X.
  5507                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5508
  5509         16  CF-LGX-LIFE-USER               PIC X.
  5510             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5511             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5512
  5513         16  CF-CR-MONTH-END-DT             PIC XX.
  5514
  5515         16  CF-FILE-MAINT-DATES.
  5516             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5517                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5518             20  CF-LAST-BATCH       REDEFINES
  5519                 CF-LAST-BATCH-NO               PIC X(4).
  5520             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5521             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5522             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5523             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5524             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5525             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5526             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 108
* EL689.cbl
  5527             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5528             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5529             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5530
  5531         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5532         16  FILLER                         PIC X.
  5533
  5534         16  CF-ALT-MORT-CODE               PIC X(4).
  5535         16  CF-MEMBER-CAPTION              PIC X(10).
  5536
  5537         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5538             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5539             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5540             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5541             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5542             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5543
  5544         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5545
  5546         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5547         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5548         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5549         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5550
  5551         16  CF-AH-OVERRIDE-L1              PIC X.
  5552         16  CF-AH-OVERRIDE-L2              PIC XX.
  5553         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5554         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5555
  5556         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5557         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5558
  5559         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5560         16  CF-AR-LAST-EL860-DT            PIC XX.
  5561         16  CF-MP-MONTH-END-DT             PIC XX.
  5562
  5563         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5564         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5565             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5566
  5567         16  CF-AR-MONTH-END-DT             PIC XX.
  5568
  5569         16  CF-CRDTCRD-USER                PIC X.
  5570             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5571             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5572
  5573         16  CF-CC-MONTH-END-DT             PIC XX.
  5574
  5575         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5576
  5577         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5578             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5579             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5580             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5581         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5582         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5583         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5584         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 109
* EL689.cbl
  5585             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5586             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5587         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5588         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5589         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5590             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5591         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5592
  5593         16  CF-CL-ZIP-CODE.
  5594             20  CF-CL-ZIP-PRIME.
  5595                 24  CF-CL-ZIP-1ST          PIC X.
  5596                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5597                 24  FILLER                 PIC X(4).
  5598             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5599         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5600             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5601             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5602             20  FILLER                     PIC XXX.
  5603
  5604         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5605         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5606         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5607         16  CF-CO-OPTION-START-DATE        PIC XX.
  5608         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5609           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5610                                                      '3' '4'.
  5611           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5612           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5613           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5614           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5615           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5616           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5617
  5618         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5619
  5620         16  CF-PAYMENT-APPROVAL-LEVELS.
  5621             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5622             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5623             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5624             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5625             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5626             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5627
  5628         16  CF-END-USER-REPORTING-USER     PIC X.
  5629             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5630             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5631
  5632         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5633             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5634             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5635
  5636         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5637
  5638         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5639         16  FILLER                         PIC X.
  5640
  5641         16  CF-CREDIT-ARCHIVE-CNTL.
  5642             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 110
* EL689.cbl
  5643             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5644             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5645
  5646         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5647
  5648         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5649             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5650             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5651
  5652         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5653             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5654             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5655
  5656         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5657
  5658         16  CF-CO-ACH-ID-CODE              PIC  X.
  5659             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5660             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5661             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5662         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5663         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5664         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5665         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5666         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5667         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5668         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5669         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5670         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5671                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5672         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5673                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5674
  5675         16  CF-CO-OVER-SHORT.
  5676             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5677             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5678
  5679*         16  FILLER                         PIC X(102).
  5680         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5681             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5682             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5683
  5684         16  CF-AH-APPROVAL-DAYS.
  5685             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5686             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5687             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5688             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5689
  5690         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5691
  5692         16  CF-APPROV-LEV-5.
  5693             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5694             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5695             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5696
  5697         16  FILLER                         PIC X(68).
  5698****************************************************************
  5699*             PROCESSOR/USER RECORD                            *
  5700****************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 111
* EL689.cbl
  5701
  5702     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5703         16  CF-PROCESSOR-NAME              PIC X(30).
  5704         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5705         16  CF-PROCESSOR-TITLE             PIC X(26).
  5706         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5707                 88  MESSAGE-YES                VALUE 'Y'.
  5708                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5709
  5710*****************************************************
  5711****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5712****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5713****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5714****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5715*****************************************************
  5716
  5717         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5718             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5719             20  CF-APPLICATION-FORCE       PIC X.
  5720             20  CF-INDIVIDUAL-APP.
  5721                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5722                     28  CF-BROWSE-APP      PIC X.
  5723                     28  CF-UPDATE-APP      PIC X.
  5724
  5725         16  CF-CURRENT-TERM-ON             PIC X(4).
  5726         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5727             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5728             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5729             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5730             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5731             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5732             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5733             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5734         16  CF-PROCESSOR-CARRIER           PIC X.
  5735             88  NO-CARRIER-SECURITY            VALUE ' '.
  5736         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5737             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5738         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5739             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5740         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5741             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5742
  5743         16  CF-PROC-SYS-ACCESS-SW.
  5744             20  CF-PROC-CREDIT-CLAIMS-SW.
  5745                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5746                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5747                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5748                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5749             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5750                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5751                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5752             20  CF-PROC-LIFE-GNRLDGR-SW.
  5753                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5754                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5755                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5756                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5757             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5758                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 112
* EL689.cbl
  5759                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5760         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5761             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5762             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5763         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5764
  5765         16  CF-APPROVAL-LEVEL                  PIC X.
  5766             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5767             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5768             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5769             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5770             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5771
  5772         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5773
  5774         16  CF-LANGUAGE-TYPE                   PIC X.
  5775             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5776             88  CF-LANG-IS-FR                      VALUE 'F'.
  5777
  5778         16  CF-CSR-IND                         PIC X.
  5779         16  FILLER                             PIC X(239).
  5780
  5781****************************************************************
  5782*             PROCESSOR/REMINDERS RECORD                       *
  5783****************************************************************
  5784
  5785     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5786         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5787             20  CF-START-REMIND-DT         PIC XX.
  5788             20  CF-END-REMIND-DT           PIC XX.
  5789             20  CF-REMINDER-TEXT           PIC X(50).
  5790         16  FILLER                         PIC X(296).
  5791
  5792
  5793****************************************************************
  5794*             STATE MASTER RECORD                              *
  5795****************************************************************
  5796
  5797     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5798         16  CF-STATE-ABBREVIATION          PIC XX.
  5799         16  CF-STATE-NAME                  PIC X(25).
  5800         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5801         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5802             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5803             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5804             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5805             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5806                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5807                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5808             20  CF-ST-PREM-REJECT-SW       PIC X.
  5809                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5810                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5811             20  CF-ST-REF-REJECT-SW        PIC X.
  5812                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5813                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5814         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5815         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5816         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 113
* EL689.cbl
  5817             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5818             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5819             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5820         16  CF-ST-FST-PMT-EXTENSION.
  5821             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5822             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5823                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5824                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5825                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5826                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5827         16  CF-ST-STATE-CALL.
  5828             20  CF-ST-CALL-UNEARNED        PIC X.
  5829             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5830             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5831         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5832             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5833             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5834         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5835         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5836         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5837         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5838         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5839         16  FILLER                         PIC X.
  5840         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5841             20  CF-ST-BENEFIT-CD           PIC XX.
  5842             20  CF-ST-BENEFIT-KIND         PIC X.
  5843                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5844                 88  CF-ST-AH-KIND              VALUE 'A'.
  5845             20  CF-ST-REM-TERM-CALC        PIC X.
  5846                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5847                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5848                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5849                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5850                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5851                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5852                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5853                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5854
  5855             20  CF-ST-REFUND-CALC          PIC X.
  5856                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5857                 88  ST-REFD-BY-R78             VALUE '1'.
  5858                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5859                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5860                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5861                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5862                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5863                 88  ST-REFD-UTAH               VALUE '7'.
  5864                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5865                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5866                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5867
  5868             20  CF-ST-EARNING-CALC         PIC X.
  5869                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5870                 88  ST-EARN-BY-R78             VALUE '1'.
  5871                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5872                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5873                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5874                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 114
* EL689.cbl
  5875                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5876                 88  ST-EARN-MEAN               VALUE '8'.
  5877                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5878
  5879             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5880                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5881                 88  ST-OVRD-BY-R78             VALUE '1'.
  5882                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5883                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5884                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5885                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5886                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5887                 88  ST-OVRD-MEAN               VALUE '8'.
  5888                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5889             20  FILLER                     PIC X.
  5890
  5891         16  CF-ST-COMMISSION-CAPS.
  5892             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5893             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5894             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5895             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5896         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5897                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5898
  5899         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5900
  5901         16  CF-ST-STATUTORY-INTEREST.
  5902             20  CF-ST-STAT-DATE-FROM       PIC X.
  5903                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5904                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5905             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5906             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5907             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5908             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5909             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5910
  5911         16  CF-ST-OVER-SHORT.
  5912             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5913             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5914
  5915         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5916
  5917         16  CF-ST-RT-CALC                  PIC X.
  5918
  5919         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5920         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5921         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5922         16  CF-ST-RF-LR-CALC               PIC X.
  5923         16  CF-ST-RF-LL-CALC               PIC X.
  5924         16  CF-ST-RF-LN-CALC               PIC X.
  5925         16  CF-ST-RF-AH-CALC               PIC X.
  5926         16  CF-ST-RF-CP-CALC               PIC X.
  5927*        16  FILLER                         PIC X(206).
  5928*CIDMOD         16  FILLER                         PIC X(192).
  5929         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5930             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5931         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5932         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 115
* EL689.cbl
  5933         16  CF-ST-CAUSAL-STATE             PIC X.
  5934         16  FILLER                         PIC X(185).
  5935
  5936****************************************************************
  5937*             BENEFIT MASTER RECORD                            *
  5938****************************************************************
  5939
  5940     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5941         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5942             20  CF-BENEFIT-CODE            PIC XX.
  5943             20  CF-BENEFIT-NUMERIC  REDEFINES
  5944                 CF-BENEFIT-CODE            PIC XX.
  5945             20  CF-BENEFIT-ALPHA           PIC XXX.
  5946             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5947             20  CF-BENEFIT-COMMENT         PIC X(10).
  5948
  5949             20  CF-LF-COVERAGE-TYPE        PIC X.
  5950                 88  CF-REDUCING                VALUE 'R'.
  5951                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5952
  5953             20  CF-SPECIAL-CALC-CD         PIC X.
  5954                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5955                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5956                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5957                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5958                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5959                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5960                 88  CF-FARM-PLAN               VALUE 'F'.
  5961                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5962                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5963                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5964                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5965                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5966                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5967                 88  CF-PRUDENTIAL              VALUE 'P'.
  5968                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5969                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5970                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5971                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5972                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5973                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5974
  5975             20  CF-JOINT-INDICATOR         PIC X.
  5976                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5977
  5978*            20  FILLER                     PIC X(12).
  5979             20  FILLER                     PIC X(11).
  5980             20  CF-BENEFIT-CATEGORY        PIC X.
  5981             20  CF-LOAN-TYPE               PIC X(8).
  5982
  5983             20  CF-CO-REM-TERM-CALC        PIC X.
  5984                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5985                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5986                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5987                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5988                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5989
  5990             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 116
* EL689.cbl
  5991                 88  CO-EARN-BY-R78             VALUE '1'.
  5992                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5993                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5994                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5995                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5996                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5997                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5998                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5999
  6000             20  CF-CO-REFUND-CALC          PIC X.
  6001                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  6002                 88  CO-REFD-BY-R78             VALUE '1'.
  6003                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  6004                 88  CO-REFD-AS-CALIF           VALUE '3'.
  6005                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  6006                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  6007                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  6008                 88  CO-REFD-MEAN               VALUE '8'.
  6009                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  6010                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  6011                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  6012
  6013             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  6014                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  6015                 88  CO-OVRD-BY-R78             VALUE '1'.
  6016                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  6017                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  6018                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  6019                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  6020                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  6021                 88  CO-OVRD-MEAN               VALUE '8'.
  6022                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  6023
  6024             20  CF-CO-BEN-I-G-CD           PIC X.
  6025                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  6026                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  6027                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  6028
  6029         16  FILLER                         PIC X(304).
  6030
  6031
  6032****************************************************************
  6033*             CARRIER MASTER RECORD                            *
  6034****************************************************************
  6035
  6036     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6037         16  CF-ADDRESS-DATA.
  6038             20  CF-MAIL-TO-NAME            PIC X(30).
  6039             20  CF-IN-CARE-OF              PIC X(30).
  6040             20  CF-ADDRESS-LINE-1          PIC X(30).
  6041             20  CF-ADDRESS-LINE-2          PIC X(30).
  6042             20  CF-CITY-STATE              PIC X(30).
  6043             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  6044             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  6045
  6046         16  CF-CLAIM-NO-CONTROL.
  6047             20  CF-CLAIM-NO-METHOD         PIC X.
  6048                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 117
* EL689.cbl
  6049                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  6050                 88  CLAIM-NO-SEQ               VALUE '3'.
  6051                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  6052             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  6053                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  6054                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  6055                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  6056
  6057         16  CF-CHECK-NO-CONTROL.
  6058             20  CF-CHECK-NO-METHOD         PIC X.
  6059                 88  CHECK-NO-MANUAL            VALUE '1'.
  6060                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  6061                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  6062                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  6063             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  6064                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  6065
  6066         16  CF-DOMICILE-STATE              PIC XX.
  6067
  6068         16  CF-EXPENSE-CONTROLS.
  6069             20  CF-EXPENSE-METHOD          PIC X.
  6070                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  6071                 88  DOLLARS-PER-PMT            VALUE '2'.
  6072                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  6073                 88  DOLLARS-PER-MONTH          VALUE '4'.
  6074             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  6075             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  6076
  6077         16  CF-CORRESPONDENCE-CONTROL.
  6078             20  CF-LETTER-RESEND-OPT       PIC X.
  6079                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  6080                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  6081             20  FILLER                     PIC X(4).
  6082
  6083         16  CF-RESERVE-CONTROLS.
  6084             20  CF-MANUAL-SW               PIC X.
  6085                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  6086             20  CF-FUTURE-SW               PIC X.
  6087                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  6088             20  CF-PTC-SW                  PIC X.
  6089                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  6090             20  CF-IBNR-SW                 PIC X.
  6091                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  6092             20  CF-PTC-LF-SW               PIC X.
  6093                 88  CF-LF-PTC-USED             VALUE '1'.
  6094             20  CF-CDT-ACCESS-METHOD       PIC X.
  6095                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  6096                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  6097                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  6098             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  6099
  6100         16  CF-CLAIM-CALC-METHOD           PIC X.
  6101             88  360-PLUS-MONTHS                VALUE '1'.
  6102             88  365-PLUS-MONTHS                VALUE '2'.
  6103             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  6104             88  360-DAILY                      VALUE '4'.
  6105             88  365-DAILY                      VALUE '5'.
  6106
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 118
* EL689.cbl
  6107         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6108         16  FILLER                         PIC X(11).
  6109
  6110         16  CF-LIMIT-AMOUNTS.
  6111             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6112             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6113             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6114             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6115             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6116             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6117             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6118             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6119             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6120             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6121
  6122         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6123         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6124         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6125
  6126         16  CF-ZIP-CODE.
  6127             20  CF-ZIP-PRIME.
  6128                 24  CF-ZIP-1ST             PIC X.
  6129                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6130                 24  FILLER                 PIC X(4).
  6131             20  CF-ZIP-PLUS4               PIC X(4).
  6132         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6133             20  CF-CAN-POSTAL-1            PIC XXX.
  6134             20  CF-CAN-POSTAL-2            PIC XXX.
  6135             20  FILLER                     PIC XXX.
  6136
  6137         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6138         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6139         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6140
  6141         16  CF-RATING-SWITCH               PIC X.
  6142             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6143             88  CF-NO-RATING                   VALUE 'N'.
  6144
  6145         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6146
  6147         16  CF-CARRIER-OVER-SHORT.
  6148             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6149             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6150
  6151         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6152         16  CF-SECPAY-SWITCH               PIC X.
  6153             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6154             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6155         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6156         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6157         16  FILLER                         PIC X(444).
  6158*        16  FILLER                         PIC X(452).
  6159
  6160
  6161****************************************************************
  6162*             MORTALITY MASTER RECORD                          *
  6163****************************************************************
  6164
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 119
* EL689.cbl
  6165     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6166         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6167                                INDEXED BY CF-MORT-NDX.
  6168             20  CF-MORT-TABLE              PIC X(5).
  6169             20  CF-MORT-TABLE-TYPE         PIC X.
  6170                 88  CF-MORT-JOINT              VALUE 'J'.
  6171                 88  CF-MORT-SINGLE             VALUE 'S'.
  6172                 88  CF-MORT-COMBINED           VALUE 'C'.
  6173                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6174                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6175             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6176             20  CF-MORT-AGE-METHOD         PIC XX.
  6177                 88  CF-AGE-LAST                VALUE 'AL'.
  6178                 88  CF-AGE-NEAR                VALUE 'AN'.
  6179             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6180             20  CF-MORT-ADJUSTMENT-DIRECTION
  6181                                            PIC X.
  6182                 88  CF-MINUS                   VALUE '-'.
  6183                 88  CF-PLUS                    VALUE '+'.
  6184             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6185             20  CF-MORT-JOINT-CODE         PIC X.
  6186                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6187             20  CF-MORT-PC-Q               PIC X.
  6188                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6189             20  CF-MORT-TABLE-CODE         PIC X(4).
  6190             20  CF-MORT-COMMENTS           PIC X(15).
  6191             20  FILLER                     PIC X(14).
  6192
  6193         16  FILLER                         PIC X(251).
  6194
  6195
  6196****************************************************************
  6197*             BUSSINESS TYPE MASTER RECORD                     *
  6198****************************************************************
  6199
  6200     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6201* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6202* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6203* AND RECORD 05 IS TYPES 81-99
  6204         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6205             20  CF-BUSINESS-TITLE          PIC  X(19).
  6206             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6207                                            PIC S9V9(4) COMP-3.
  6208             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6209             20  FILLER                     PIC  X.
  6210         16  FILLER                         PIC  X(248).
  6211
  6212
  6213****************************************************************
  6214*             TERMINAL MASTER RECORD                           *
  6215****************************************************************
  6216
  6217     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6218
  6219         16  CF-COMPANY-TERMINALS.
  6220             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6221                                  PIC X(4).
  6222         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 120
* EL689.cbl
  6223
  6224
  6225****************************************************************
  6226*             LIFE EDIT MASTER RECORD                          *
  6227****************************************************************
  6228
  6229     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6230         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6231             20  CF-LIFE-CODE-IN            PIC XX.
  6232             20  CF-LIFE-CODE-OUT           PIC XX.
  6233         16  FILLER                         PIC X(248).
  6234
  6235
  6236****************************************************************
  6237*             AH EDIT MASTER RECORD                            *
  6238****************************************************************
  6239
  6240     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6241         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6242             20  CF-AH-CODE-IN              PIC XXX.
  6243             20  CF-AH-CODE-OUT             PIC XX.
  6244         16  FILLER                         PIC X(248).
  6245
  6246
  6247****************************************************************
  6248*             CREDIBILITY TABLES                               *
  6249****************************************************************
  6250
  6251     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6252         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6253                             INDEXED BY CF-CRDB-NDX.
  6254             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6255             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6256             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6257         16  FILLER                         PIC  X(332).
  6258
  6259
  6260****************************************************************
  6261*             REPORT CUSTOMIZATION RECORD                      *
  6262****************************************************************
  6263
  6264     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6265         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6266             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6267             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6268             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6269**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6270****       A T-TRANSFER.                                   ****
  6271             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6272
  6273         16  FILLER                         PIC XX.
  6274
  6275         16  CF-CARRIER-CNTL-OPT.
  6276             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6277                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6278                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6279             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6280                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 121
* EL689.cbl
  6281         16  CF-GROUP-CNTL-OPT.
  6282             20  CF-GROUP-OPT-SEQ           PIC 9.
  6283                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6284                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6285             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6286                                            PIC X(6).
  6287         16  CF-STATE-CNTL-OPT.
  6288             20  CF-STATE-OPT-SEQ           PIC 9.
  6289                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6290                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6291             20  CF-STATE-SELECT OCCURS 3 TIMES
  6292                                            PIC XX.
  6293         16  CF-ACCOUNT-CNTL-OPT.
  6294             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6295                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6296                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6297             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6298                                            PIC X(10).
  6299         16  CF-BUS-TYP-CNTL-OPT.
  6300             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6301                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6302                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6303             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6304                                            PIC XX.
  6305         16  CF-LF-TYP-CNTL-OPT.
  6306             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6307                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6308                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6309             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6310                                            PIC XX.
  6311         16  CF-AH-TYP-CNTL-OPT.
  6312             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6313                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6314                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6315             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6316                                            PIC XX.
  6317         16  CF-REPTCD1-CNTL-OPT.
  6318             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6319                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6320                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6321             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6322                                            PIC X(10).
  6323         16  CF-REPTCD2-CNTL-OPT.
  6324             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6325                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6326                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6327             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6328                                            PIC X(10).
  6329         16  CF-USER1-CNTL-OPT.
  6330             20  CF-USER1-OPT-SEQ           PIC 9.
  6331                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6332                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6333             20  CF-USER1-SELECT OCCURS 3 TIMES
  6334                                            PIC X(10).
  6335         16  CF-USER2-CNTL-OPT.
  6336             20  CF-USER2-OPT-SEQ           PIC 9.
  6337                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6338                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 122
* EL689.cbl
  6339             20  CF-USER2-SELECT OCCURS 3 TIMES
  6340                                            PIC X(10).
  6341         16  CF-USER3-CNTL-OPT.
  6342             20  CF-USER3-OPT-SEQ           PIC 9.
  6343                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6344                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6345             20  CF-USER3-SELECT OCCURS 3 TIMES
  6346                                            PIC X(10).
  6347         16  CF-USER4-CNTL-OPT.
  6348             20  CF-USER4-OPT-SEQ           PIC 9.
  6349                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6350                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6351             20  CF-USER4-SELECT OCCURS 3 TIMES
  6352                                            PIC X(10).
  6353         16  CF-USER5-CNTL-OPT.
  6354             20  CF-USER5-OPT-SEQ           PIC 9.
  6355                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6356                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6357             20  CF-USER5-SELECT OCCURS 3 TIMES
  6358                                            PIC X(10).
  6359         16  CF-REINS-CNTL-OPT.
  6360             20  CF-REINS-OPT-SEQ           PIC 9.
  6361                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6362                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6363             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6364                 24  CF-REINS-PRIME         PIC XXX.
  6365                 24  CF-REINS-SUB           PIC XXX.
  6366
  6367         16  CF-AGENT-CNTL-OPT.
  6368             20  CF-AGENT-OPT-SEQ           PIC 9.
  6369                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6370                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6371             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6372                                            PIC X(10).
  6373
  6374         16  FILLER                         PIC X(43).
  6375
  6376         16  CF-LOSS-RATIO-SELECT.
  6377             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6378             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6379         16  CF-ENTRY-DATE-SELECT.
  6380             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6381             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6382         16  CF-EFFECTIVE-DATE-SELECT.
  6383             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6384             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6385
  6386         16  CF-EXCEPTION-LIST-IND          PIC X.
  6387             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6388
  6389         16  FILLER                         PIC X(318).
  6390
  6391****************************************************************
  6392*                  EXCEPTION REPORTING RECORD                  *
  6393****************************************************************
  6394
  6395     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6396         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 123
* EL689.cbl
  6397             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6398
  6399         16  CF-COMBINED-LIFE-AH-OPT.
  6400             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6401             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6402             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6403             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6404
  6405         16  CF-LIFE-OPT.
  6406             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6407             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6408             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6409             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6410             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6411             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6412             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6413             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6414             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6415             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6416
  6417         16  CF-AH-OPT.
  6418             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6419             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6420             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6421             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6422             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6423             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6424             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6425             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6426             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6427             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6428
  6429         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6430             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6431             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6432             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6433
  6434         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6435
  6436         16  FILLER                         PIC X(673).
  6437
  6438
  6439****************************************************************
  6440*             MORTGAGE SYSTEM PLAN RECORD                      *
  6441****************************************************************
  6442
  6443     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6444         16  CF-PLAN-TYPE                   PIC X.
  6445             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6446             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6447             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6448         16  CF-PLAN-ABBREV                 PIC XXX.
  6449         16  CF-PLAN-DESCRIPT               PIC X(10).
  6450         16  CF-PLAN-NOTES                  PIC X(20).
  6451         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6452         16  CF-PLAN-UNDERWRITING.
  6453             20  CF-PLAN-TERM-DATA.
  6454                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 124
* EL689.cbl
  6455                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6456             20  CF-PLAN-AGE-DATA.
  6457                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6458                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6459                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6460             20  CF-PLAN-BENEFIT-DATA.
  6461                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6462                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6463                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6464                                            PIC S9(7)V99  COMP-3.
  6465         16  CF-PLAN-POLICY-FORMS.
  6466             20  CF-POLICY-FORM             PIC X(12).
  6467             20  CF-MASTER-APPLICATION      PIC X(12).
  6468             20  CF-MASTER-POLICY           PIC X(12).
  6469         16  CF-PLAN-RATING.
  6470             20  CF-RATE-CODE               PIC X(5).
  6471             20  CF-SEX-RATING              PIC X.
  6472                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6473                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6474             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6475             20  CF-SUB-STD-TYPE            PIC X.
  6476                 88  CF-PCT-OF-PREM            VALUE '1'.
  6477                 88  CF-PCT-OF-BENE            VALUE '2'.
  6478         16  CF-PLAN-PREM-TOLERANCES.
  6479             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6480             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6481         16  CF-PLAN-PYMT-TOLERANCES.
  6482             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6483             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6484         16  CF-PLAN-MISC-DATA.
  6485             20  FILLER                     PIC X.
  6486             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6487             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6488         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6489         16  CF-PLAN-IND-GRP                PIC X.
  6490             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6491                                                     '1'.
  6492             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6493                                                     '2'.
  6494         16  CF-MIB-SEARCH-SW               PIC X.
  6495             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6496             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6497             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6498             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6499         16  CF-ALPHA-SEARCH-SW             PIC X.
  6500             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6501             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6502             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6503             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6504             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6505             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6506             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6507             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6508             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6509             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6510                                                     'A' 'B' 'C'
  6511                                                     'X' 'Y' 'Z'.
  6512         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 125
* EL689.cbl
  6513             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6514             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6515             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6516             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6517             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6518         16  FILLER                         PIC X(4).
  6519         16  CF-HEALTH-QUESTIONS            PIC X.
  6520             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6521         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6522         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6523         16  CF-PLAN-SNGL-JNT               PIC X.
  6524             88  CF-COMBINED-PLAN              VALUE 'C'.
  6525             88  CF-JNT-PLAN                   VALUE 'J'.
  6526             88  CF-SNGL-PLAN                  VALUE 'S'.
  6527         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6528         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6529         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6530         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6531         16  CF-RERATE-CNTL                 PIC  X.
  6532             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6533             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6534             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6535             88  CF-AUTO-RECALC                 VALUE '4'.
  6536         16  CF-BENEFIT-TYPE                PIC  X.
  6537             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6538             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6539         16  CF-POLICY-FEE                  PIC S999V99
  6540                                                    COMP-3.
  6541         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6542         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6543         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6544         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6545         16  FILLER                         PIC  X(32).
  6546         16  CF-TERMINATION-FORM            PIC  X(04).
  6547         16  FILLER                         PIC  X(08).
  6548         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6549                                                       COMP-3.
  6550         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6551         16  CF-ISSUE-LETTER                PIC  X(4).
  6552         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6553         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6554             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6555             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6556         16  CF-MP-REFUND-CALC              PIC X.
  6557             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6558             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6559             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6560             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6561             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6562             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6563             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6564             88  CF-MP-REFD-MEAN                VALUE '8'.
  6565         16  CF-ALT-RATE-CODE               PIC  X(5).
  6566
  6567
  6568         16  FILLER                         PIC X(498).
  6569****************************************************************
  6570*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 126
* EL689.cbl
  6571****************************************************************
  6572
  6573     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6574         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6575         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6576             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6577             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6578             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6579             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6580             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6581
  6582         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6583         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6584         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6585         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6586         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6587
  6588         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6589             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6590         16  CF-MP-RECON-USE-IND            PIC X(1).
  6591             88  CF-MP-USE-RECON             VALUE 'Y'.
  6592         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6593             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6594         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6595             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6596             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6597         16  FILLER                         PIC X(1).
  6598         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6599             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6600         16  CF-MORTG-MIB-VERSION           PIC X.
  6601             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6602             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6603             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6604         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6605             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6606                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6607             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6608                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6609             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6610                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6611             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6612                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6613             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6614                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6615             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6616                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6617         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6618         16  FILLER                         PIC X(7).
  6619         16  CF-MORTG-DESTINATION-SYMBOL.
  6620             20  CF-MORTG-MIB-COMM          PIC X(5).
  6621             20  CF-MORTG-MIB-TERM          PIC X(5).
  6622         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6623             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6624         16  FILLER                         PIC X(03).
  6625         16  CF-MP-CHECK-NO-CONTROL.
  6626             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6627                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6628                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 127
* EL689.cbl
  6629                                                ' ' LOW-VALUES.
  6630                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6631                                               VALUE '3'.
  6632         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6633         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6634         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6635             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6636                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6637             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6638                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6639             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6640                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6641             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6642                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6643             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6644                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6645             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6646                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6647         16  CF-MORTG-BILLING-AREA.
  6648             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6649                                            PIC X.
  6650         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6651         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6652         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6653         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6654             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6655             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6656         16  FILLER                         PIC X.
  6657         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6658             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6659             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6660         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6661         16  FILLER                         PIC X(8).
  6662         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6663         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6664         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6665         16  CF-ACH-COMPANY-ID.
  6666             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6667                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6668                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6669                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6670             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6671         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6672             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6673         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6674             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6675             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6676         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6677         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6678         16  FILLER                         PIC X(536).
  6679
  6680****************************************************************
  6681*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6682****************************************************************
  6683
  6684     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6685         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6686             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 128
* EL689.cbl
  6687                 24  CF-FEMALE-FT           PIC 99.
  6688                 24  CF-FEMALE-IN           PIC 99.
  6689             20  CF-FEMALE-MIN-WT           PIC 999.
  6690             20  CF-FEMALE-MAX-WT           PIC 999.
  6691         16  FILLER                         PIC X(428).
  6692
  6693     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6694         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6695             20  CF-MALE-HEIGHT.
  6696                 24  CF-MALE-FT             PIC 99.
  6697                 24  CF-MALE-IN             PIC 99.
  6698             20  CF-MALE-MIN-WT             PIC 999.
  6699             20  CF-MALE-MAX-WT             PIC 999.
  6700         16  FILLER                         PIC X(428).
  6701******************************************************************
  6702*             AUTOMATIC ACTIVITY RECORD                          *
  6703******************************************************************
  6704     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6705         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6706             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6707             20  CF-SYS-LETTER-ID           PIC X(04).
  6708             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6709             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6710             20  CF-SYS-RESET-SW            PIC X(01).
  6711             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6712             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6713
  6714         16  FILLER                         PIC X(50).
  6715
  6716         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6717             20  CF-USER-ACTIVE-SW          PIC X(01).
  6718             20  CF-USER-LETTER-ID          PIC X(04).
  6719             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6720             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6721             20  CF-USER-RESET-SW           PIC X(01).
  6722             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6723             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6724             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6725
  6726         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 129
* EL689.cbl
  6728*    COPY ERCCOMP.
  6729******************************************************************
  6730*                                                                *
  6731*                                                                *
  6732*                            ERCCOMP                             *
  6733*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6734*                            VMOD=2.019                          *
  6735*                                                                *
  6736*   ONLINE CREDIT SYSTEM                                         *
  6737*                                                                *
  6738*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6739*                                                                *
  6740*   FILE TYPE = VSAM,KSDS                                        *
  6741*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6742*                                                                *
  6743*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6744*       ALTERNATE PATH = NONE                                    *
  6745*                                                                *
  6746*   LOG = NO                                                     *
  6747*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6748*                                                                *
  6749******************************************************************
  6750*                   C H A N G E   L O G
  6751*
  6752* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6753*-----------------------------------------------------------------
  6754*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6755* EFFECTIVE    NUMBER
  6756*-----------------------------------------------------------------
  6757* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6758* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6759* 092205    2005050300006  PEMA  ADD LEASE FEE
  6760* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6761* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6762* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6763* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6764* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6765* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  6766******************************************************************
  6767
  6768 01  COMPENSATION-MASTER.
  6769     12  CO-RECORD-ID                          PIC XX.
  6770         88  VALID-CO-ID                          VALUE 'CO'.
  6771
  6772     12  CO-CONTROL-PRIMARY.
  6773         16  CO-COMPANY-CD                     PIC X.
  6774         16  CO-CONTROL.
  6775             20  CO-CTL-1.
  6776                 24  CO-CARR-GROUP.
  6777                     28  CO-CARRIER            PIC X.
  6778                     28  CO-GROUPING.
  6779                         32  CO-GROUP-PREFIX   PIC XXX.
  6780                         32  CO-GROUP-PRIME    PIC XXX.
  6781                 24  CO-RESP-NO.
  6782                     28  CO-RESP-PREFIX        PIC X(4).
  6783                     28  CO-RESP-PRIME         PIC X(6).
  6784             20  CO-CTL-2.
  6785                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 130
* EL689.cbl
  6786                     28  CO-ACCT-PREFIX        PIC X(4).
  6787                     28  CO-ACCT-PRIME         PIC X(6).
  6788         16  CO-TYPE                           PIC X.
  6789             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6790             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6791             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6792
  6793     12  CO-MAINT-INFORMATION.
  6794         16  CO-LAST-MAINT-DT                  PIC XX.
  6795         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6796         16  CO-LAST-MAINT-USER                PIC X(4).
  6797     12  FILLER                                PIC XX.
  6798     12  CO-STMT-TYPE                          PIC XXX.
  6799     12  CO-COMP-TYPE                          PIC X.
  6800         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6801     12  CO-STMT-OWNER                         PIC X(4).
  6802     12  CO-BALANCE-CONTROL                    PIC X.
  6803         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6804         88  CO-NO-BALANCE                        VALUE 'N'.
  6805
  6806     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6807         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6808         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6809         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6810
  6811     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6812         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6813         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6814
  6815     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6816     12  CO-GA-DIRECT-DEP                      PIC X.
  6817     12  CO-FUTURE-SPACE                       PIC X.
  6818         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6819
  6820     12  CO-ACCT-NAME                          PIC X(30).
  6821     12  CO-MAIL-NAME                          PIC X(30).
  6822     12  CO-ADDR-1                             PIC X(30).
  6823     12  CO-ADDR-2                             PIC X(30).
  6824     12  CO-ADDR-3.
  6825         16  CO-ADDR-CITY                      PIC X(27).
  6826         16  CO-ADDR-STATE                     PIC XX.
  6827     12  CO-CSO-1099                           PIC X.
  6828     12  CO-ZIP.
  6829         16  CO-ZIP-PRIME.
  6830             20  CO-ZIP-PRI-1ST                PIC X.
  6831                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6832             20  FILLER                        PIC X(4).
  6833         16  CO-ZIP-PLUS4                      PIC X(4).
  6834     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6835         16  CO-CAN-POSTAL-1                   PIC XXX.
  6836         16  CO-CAN-POSTAL-2                   PIC XXX.
  6837         16  FILLER                            PIC XXX.
  6838     12  CO-SOC-SEC                            PIC X(13).
  6839     12  CO-TELEPHONE.
  6840         16  CO-AREA-CODE                      PIC XXX.
  6841         16  CO-PREFIX                         PIC XXX.
  6842         16  CO-PHONE                          PIC X(4).
  6843
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 131
* EL689.cbl
  6844     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  6845
  6846     12  CO-AR-BAL-LEVEL                       PIC X.
  6847         88  CO-AR-REF-LVL                        VALUE '1'.
  6848         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6849         88  CO-AR-BILL-LVL                       VALUE '2'.
  6850         88  CO-AR-AGT-LVL                        VALUE '3'.
  6851         88  CO-AR-FR-LVL                         VALUE '4'.
  6852
  6853     12  CO-AR-NORMAL-PRINT                    PIC X.
  6854         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6855         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6856
  6857     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6858
  6859     12  CO-AR-REPORTING                       PIC X.
  6860         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6861         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6862
  6863     12  CO-AR-PULL-CHECK                      PIC X.
  6864         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6865         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6866
  6867     12  CO-AR-BALANCE-PRINT                   PIC X.
  6868         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6869
  6870     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6871         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6872         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6873         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6874
  6875     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6876
  6877     12  CO-USER-CODE                          PIC X.
  6878     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6879
  6880******************************************************************
  6881*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6882*    THE LAST MONTH END RUN.
  6883******************************************************************
  6884
  6885     12  CO-LAST-ACTIVITY-DATE.
  6886         16  CO-ACT-YEAR                       PIC 99.
  6887         16  CO-ACT-MONTH                      PIC 99.
  6888         16  CO-ACT-DAY                        PIC 99.
  6889
  6890     12  CO-LAST-STMT-DT.
  6891         16  CO-LAST-STMT-YEAR                 PIC 99.
  6892         16  CO-LAST-STMT-MONTH                PIC 99.
  6893         16  CO-LAST-STMT-DAY                  PIC 99.
  6894
  6895     12  CO-MO-END-TOTALS.
  6896         16  CO-MONTHLY-TOTALS.
  6897             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6898             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6899             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6900             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6901             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 132
* EL689.cbl
  6902
  6903         16  CO-AGING-TOTALS.
  6904             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6905             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6906             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6907             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6908
  6909         16  CO-YTD-TOTALS.
  6910             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6911             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6912
  6913         16  CO-OVER-UNDER-TOTALS.
  6914             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6915             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6916
  6917     12  CO-MISCELLANEOUS-TOTALS.
  6918         16  CO-FICA-TOTALS.
  6919             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6920             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6921
  6922         16  CO-CLAIM-TOTALS.
  6923             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  6924             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  6925
  6926******************************************************************
  6927*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  6928*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  6929******************************************************************
  6930
  6931     12  CO-CURRENT-TOTALS.
  6932         16  CO-CURRENT-LAST-STMT-DT.
  6933             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  6934             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  6935             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  6936
  6937         16  CO-CURRENT-MONTHLY-TOTALS.
  6938             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  6939             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  6940             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  6941             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  6942             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  6943
  6944         16  CO-CURRENT-AGING-TOTALS.
  6945             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  6946             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  6947             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  6948             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  6949
  6950         16  CO-CURRENT-YTD-TOTALS.
  6951             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  6952             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  6953
  6954     12  CO-PAID-COMM-TOTALS.
  6955         16  CO-YTD-PAID-COMMS.
  6956             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  6957             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  6958
  6959     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 133
* EL689.cbl
  6960         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  6961         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  6962
  6963     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  6964         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  6965         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  6966         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  6967         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  6968         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  6969         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  6970         88  CO-FINAL-LETTER                  VALUE 'F'.
  6971         88  CO-RECONCILING                   VALUE 'R'.
  6972         88  CO-PHONE-CALL                    VALUE 'P'.
  6973         88  CO-LEGAL                         VALUE 'L'.
  6974         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  6975         88  CO-WRITE-OFF                     VALUE 'W'.
  6976         88  CO-NO-ACTION                     VALUE 'N' ' '.
  6977
  6978     12  CO-CSR-CODE                       PIC X(4).
  6979
  6980     12  CO-GA-STATUS-INFO.
  6981         16  CO-GA-EFFECTIVE-DT            PIC XX.
  6982         16  CO-GA-TERMINATION-DT          PIC XX.
  6983         16  CO-GA-STATUS-CODE             PIC X.
  6984             88  CO-GA-ACTIVE                 VALUE 'A'.
  6985             88  CO-GA-INACTIVE               VALUE 'I'.
  6986             88  CO-GA-PENDING                VALUE 'P'.
  6987         16  CO-GA-COMMENTS.
  6988             20  CO-GA-COMMENT-1           PIC X(40).
  6989             20  CO-GA-COMMENT-2           PIC X(40).
  6990             20  CO-GA-COMMENT-3           PIC X(40).
  6991             20  CO-GA-COMMENT-4           PIC X(40).
  6992
  6993     12  CO-RPTCD2                         PIC X(10).
  6994     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  6995         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  6996         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  6997
  6998     12  CO-TYPE-AGENT                     PIC X(01).
  6999         88  CO-CORPORATION                   VALUE 'C'.
  7000         88  CO-PARTNERSHIP                   VALUE 'P'.
  7001         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7002         88  CO-TRUST                         VALUE 'T'.
  7003         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7004
  7005     12  CO-FAXNO.
  7006         16  CO-FAX-AREA-CODE                  PIC XXX.
  7007         16  CO-FAX-PREFIX                     PIC XXX.
  7008         16  CO-FAX-PHONE                      PIC X(4).
  7009
  7010     12  CO-BANK-INFORMATION.
  7011         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7012         16  CO-BANK-TRANSIT-NON REDEFINES
  7013             CO-BANK-TRANSIT-NO                PIC 9(8).
  7014
  7015         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7016     12  CO-MISC-DEDUCT-INFO REDEFINES
  7017                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 134
* EL689.cbl
  7018         16  CO-MD-GL-ACCT                     PIC X(10).
  7019         16  CO-MD-DIV                         PIC XX.
  7020         16  CO-MD-CENTER                      PIC X(4).
  7021         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7022         16  CO-CREATE-AP-CHECK                PIC X.
  7023         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7024         16  FILLER                            PIC XXX.
  7025     12  CO-ACH-STATUS                         PIC X.
  7026         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7027         88  CO-ACH-PENDING                        VALUE 'P'.
  7028
  7029     12  CO-BILL-SW                            PIC X.
  7030     12  CO-CONTROL-NAME                       PIC X(30).
  7031     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7032     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7033     12  CO-CLP-STATE                          PIC XX.
  7034     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7035     12  CO-SPP-REFUND-EDIT                    PIC X.
  7036
  7037******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 135
* EL689.cbl
  7039*    COPY ERCMAIL.
  7040******************************************************************
  7041*                                                                *
  7042*                                                                *
  7043*                            ERCMAIL                             *
  7044*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7045*                            VMOD=2.003                          *
  7046*                                                                *
  7047*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  7048*                                                                *
  7049*   FILE TYPE = VSAM,KSDS                                        *
  7050*   RECORD SIZE = 374   RECFORM = FIX                            *
  7051*                                                                *
  7052*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  7053*   ALTERNATE PATH    = NOT USED                                 *
  7054*                                                                *
  7055*   LOG = YES                                                    *
  7056*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7057******************************************************************
  7058*                   C H A N G E   L O G
  7059*
  7060* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7061*-----------------------------------------------------------------
  7062*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7063* EFFECTIVE    NUMBER
  7064*-----------------------------------------------------------------
  7065* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7066* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7067* 111108                   PEMA  ADD CRED BENE ADDR2
  7068******************************************************************
  7069
  7070 01  MAILING-DATA.
  7071     12  MA-RECORD-ID                      PIC XX.
  7072         88  VALID-MA-ID                       VALUE 'MA'.
  7073
  7074     12  MA-CONTROL-PRIMARY.
  7075         16  MA-COMPANY-CD                 PIC X.
  7076         16  MA-CARRIER                    PIC X.
  7077         16  MA-GROUPING.
  7078             20  MA-GROUPING-PREFIX        PIC XXX.
  7079             20  MA-GROUPING-PRIME         PIC XXX.
  7080         16  MA-STATE                      PIC XX.
  7081         16  MA-ACCOUNT.
  7082             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7083             20  MA-ACCOUNT-PRIME          PIC X(6).
  7084         16  MA-CERT-EFF-DT                PIC XX.
  7085         16  MA-CERT-NO.
  7086             20  MA-CERT-PRIME             PIC X(10).
  7087             20  MA-CERT-SFX               PIC X.
  7088
  7089     12  FILLER                            PIC XX.
  7090
  7091     12  MA-ACCESS-CONTROL.
  7092         16  MA-SOURCE-SYSTEM              PIC XX.
  7093             88  MA-FROM-CREDIT                VALUE 'CR'.
  7094             88  MA-FROM-VSI                   VALUE 'VS'.
  7095             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7096             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 136
* EL689.cbl
  7097         16  MA-RECORD-ADD-DT              PIC XX.
  7098         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7099         16  MA-LAST-MAINT-DT              PIC XX.
  7100         16  MA-LAST-MAINT-BY              PIC XXXX.
  7101         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7102
  7103     12  MA-PROFILE-INFO.
  7104         16  MA-QUALIFY-CODE-1             PIC XX.
  7105         16  MA-QUALIFY-CODE-2             PIC XX.
  7106         16  MA-QUALIFY-CODE-3             PIC XX.
  7107         16  MA-QUALIFY-CODE-4             PIC XX.
  7108         16  MA-QUALIFY-CODE-5             PIC XX.
  7109
  7110         16  MA-INSURED-LAST-NAME          PIC X(15).
  7111         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7112         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7113         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7114         16  MA-INSURED-BIRTH-DT           PIC XX.
  7115         16  MA-INSURED-SEX                PIC X.
  7116             88  MA-SEX-MALE                   VALUE 'M'.
  7117             88  MA-SEX-FEMALE                 VALUE 'F'.
  7118         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7119
  7120         16  MA-ADDRESS-CORRECTED          PIC X.
  7121         16  MA-JOINT-BIRTH-DT             PIC XX.
  7122*        16  FILLER                        PIC X(12).
  7123
  7124         16  MA-ADDRESS-LINE-1             PIC X(30).
  7125         16  MA-ADDRESS-LINE-2             PIC X(30).
  7126         16  MA-CITY-STATE.
  7127             20  MA-CITY                   PIC X(28).
  7128             20  MA-ADDR-STATE             PIC XX.
  7129         16  MA-ZIP.
  7130             20  MA-ZIP-CODE.
  7131                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7132                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7133                 24  FILLER                PIC X(4).
  7134             20  MA-ZIP-PLUS4              PIC X(4).
  7135         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7136             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7137             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7138             20  FILLER                    PIC X(3).
  7139
  7140         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7141
  7142         16  FILLER                        PIC XXX.
  7143*        16  FILLER                        PIC X(10).
  7144
  7145     12  MA-CRED-BENE-INFO.
  7146         16  MA-CRED-BENE-NAME                 PIC X(25).
  7147         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7148         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7149         16  MA-CRED-BENE-CTYST.
  7150             20  MA-CRED-BENE-CITY             PIC X(28).
  7151             20  MA-CRED-BENE-STATE            PIC XX.
  7152         16  MA-CRED-BENE-ZIP.
  7153             20  MA-CB-ZIP-CODE.
  7154                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 137
* EL689.cbl
  7155                     88  MA-CB-CANADIAN-POST-CODE
  7156                                           VALUE 'A' THRU 'Z'.
  7157                 24  FILLER                    PIC X(4).
  7158             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7159         16  MA-CB-CANADIAN-POSTAL-CODE
  7160                            REDEFINES MA-CRED-BENE-ZIP.
  7161             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7162             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7163             20  FILLER                        PIC X(3).
  7164     12  MA-POST-CARD-MAIL-DATA.
  7165         16  MA-MAIL-DATA OCCURS 7.
  7166             20  MA-MAIL-TYPE              PIC X.
  7167                 88  MA-12MO-MAILING           VALUE '1'.
  7168                 88  MA-EXP-MAILING            VALUE '2'.
  7169             20  MA-MAIL-STATUS            PIC X.
  7170                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7171                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7172                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7173             20  MA-MAIL-DATE              PIC XX.
  7174     12  FILLER                            PIC XX.
  7175     12  FILLER                            PIC XX.
  7176*    12  FILLER                            PIC X(30).
  7177******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 138
* EL689.cbl
  7179*    COPY ERCPNDB.
  7180******************************************************************
  7181*                                                                *
  7182*                                                                *
  7183*                            ERCPNDB.                            *
  7184*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7185*                            VMOD=2.025                          *
  7186*                                                                *
  7187*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  7188*                                                                *
  7189******************************************************************
  7190*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  7191*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  7192******************************************************************
  7193*                                                                *
  7194*                                                                *
  7195*   FILE TYPE = VSAM,KSDS                                        *
  7196*   RECORD SIZE = 585  RECFORM = FIXED                           *
  7197*                                                                *
  7198*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  7199*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  7200*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  7201*                                                 RKP=13,LEN=36  *
  7202*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  7203*                                      AND CHG-SEQ.)             *
  7204*                                                RKP=49,LEN=11   *
  7205*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  7206*                                      AND CHG-SEQ.)             *
  7207*                                                RKP=60,LEN=15   *
  7208*                                                                *
  7209*   LOG = NO                                                     *
  7210*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7211******************************************************************
  7212******************************************************************
  7213*                   C H A N G E   L O G
  7214*
  7215* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7216*-----------------------------------------------------------------
  7217*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7218* EFFECTIVE    NUMBER
  7219*-----------------------------------------------------------------
  7220* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7221* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7222* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7223* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  7224* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  7225* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  7226* 032306                   PEMA  ADD BOW LOAN NUMBER
  7227* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  7228* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7229* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7230* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7231* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  7232* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7233* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7234* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  7235******************************************************************
  7236
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 139
* EL689.cbl
  7237 01  PENDING-BUSINESS.
  7238     12  PB-RECORD-ID                     PIC XX.
  7239         88  VALID-PB-ID                        VALUE 'PB'.
  7240
  7241     12  PB-CONTROL-PRIMARY.
  7242         16  PB-COMPANY-CD                PIC X.
  7243         16  PB-ENTRY-BATCH               PIC X(6).
  7244         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  7245         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  7246
  7247     12  PB-CONTROL-BY-ACCOUNT.
  7248         16  PB-COMPANY-CD-A1             PIC X.
  7249         16  PB-CARRIER                   PIC X.
  7250         16  PB-GROUPING.
  7251             20  PB-GROUPING-PREFIX       PIC XXX.
  7252             20  PB-GROUPING-PRIME        PIC XXX.
  7253         16  PB-STATE                     PIC XX.
  7254         16  PB-ACCOUNT.
  7255             20  PB-ACCOUNT-PREFIX        PIC X(4).
  7256             20  PB-ACCOUNT-PRIME         PIC X(6).
  7257         16  PB-CERT-EFF-DT               PIC XX.
  7258         16  PB-CERT-NO.
  7259             20  PB-CERT-PRIME            PIC X(10).
  7260             20  PB-CERT-SFX              PIC X.
  7261         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  7262
  7263         16  PB-RECORD-TYPE               PIC X.
  7264             88  PB-MAILING-DATA                VALUE '0'.
  7265             88  PB-ISSUE                       VALUE '1'.
  7266             88  PB-CANCELLATION                VALUE '2'.
  7267             88  PB-BATCH-TRAILER               VALUE '9'.
  7268
  7269     12  PB-CONTROL-BY-ORIG-BATCH.
  7270         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  7271         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  7272         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  7273         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  7274
  7275     12  PB-CONTROL-BY-CSR.
  7276         16  PB-CSR-COMPANY-CD            PIC X.
  7277         16  PB-CSR-ID                    PIC X(4).
  7278         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  7279         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  7280         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  7281******************************************************************
  7282*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  7283******************************************************************
  7284
  7285     12  PB-LAST-MAINT-DT                 PIC XX.
  7286     12  PB-LAST-MAINT-BY                 PIC X(4).
  7287     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7288
  7289     12  PB-RECORD-BODY                   PIC X(375).
  7290
  7291     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  7292         16  PB-CERT-ORIGIN               PIC X.
  7293             88  CLASIC-CREATED-CERT         VALUE '1'.
  7294         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 140
* EL689.cbl
  7295             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  7296             20  PB-I-INSURED-FIRST-NAME.
  7297                 24  PB-I-INSURED-1ST-INIT PIC X.
  7298                 24  FILLER                PIC X(9).
  7299             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  7300         16  PB-I-AGE                     PIC S99   COMP-3.
  7301         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  7302         16  PB-I-BIRTHDAY                PIC XX.
  7303         16  PB-I-INSURED-SEX             PIC X.
  7304             88  PB-SEX-MALE     VALUE 'M'.
  7305             88  PB-SEX-FEMALE   VALUE 'F'.
  7306
  7307         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  7308         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  7309         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  7310         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  7311         16  PB-I-SKIP-CODE               PIC X.
  7312             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  7313             88  PB-SKIP-JULY              VALUE '1'.
  7314             88  PB-SKIP-AUGUST            VALUE '2'.
  7315             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  7316             88  PB-SKIP-JULY-AUG          VALUE '4'.
  7317             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  7318             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  7319             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  7320             88  PB-SKIP-JUNE              VALUE '8'.
  7321             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  7322             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  7323             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  7324         16  PB-I-TERM-TYPE               PIC X.
  7325             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  7326             88  PB-PAID-WEEKLY            VALUE 'W'.
  7327             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  7328             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  7329             88  PB-PAID-13-YEARLY         VALUE 'T'.
  7330         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  7331         16  PB-I-POLICY-FORM-NO          PIC X(12).
  7332         16  PB-I-DATA-ENTRY-SW           PIC X.
  7333             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  7334             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  7335             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  7336             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  7337         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  7338         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  7339*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  7340         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  7341         16  FILLER                       PIC X.
  7342
  7343         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  7344             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  7345             88  PB-INVALID-LIFE             VALUE '  ' '00'
  7346                                                   '90' THRU '99'.
  7347         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  7348                                          PIC XX.
  7349         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  7350         16  PB-I-AMOUNT-FINANCED REDEFINES
  7351                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  7352         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 141
* EL689.cbl
  7353         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  7354                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  7355         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7356         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  7357         16  PB-I-CLP-AMOUNT REDEFINES
  7358                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  7359         16  PB-I-LF-CALC-FLAG            PIC X.
  7360             88 PB-COMP-LF-PREM               VALUE '?'.
  7361         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  7362         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  7363         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  7364         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  7365         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  7366         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  7367         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  7368         16  PB-I-LF-ABBR                 PIC XXX.
  7369         16  PB-I-LF-INPUT-CD             PIC XX.
  7370
  7371         16  PB-I-AH-BENEFIT-CD           PIC XX.
  7372             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  7373             88  PB-INVALID-AH               VALUE '  ' '00'
  7374                                                   '90' THRU '99'.
  7375         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  7376         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7377         16  PB-I-AH-CALC-FLAG            PIC X.
  7378             88 PB-COMP-AH-PREM                  VALUE '?'.
  7379         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  7380         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  7381         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  7382         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  7383         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  7384         16  PB-I-AH-ABBR                 PIC XXX.
  7385         16  PB-I-AH-INPUT-CD             PIC XXX.
  7386
  7387         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  7388         16  PB-I-REIN-TABLE              PIC XXX.
  7389         16  PB-I-BUSINESS-TYPE           PIC 99.
  7390         16  PB-I-INDV-GRP-CD             PIC X.
  7391         16  PB-I-MORT-CODE.
  7392             20  PB-I-TABLE               PIC X.
  7393             20  PB-I-INTEREST            PIC XX.
  7394             20  PB-I-MORT-TYP            PIC X.
  7395         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  7396         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  7397         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  7398         16  PB-I-INDV-GRP-OVRD           PIC X.
  7399         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  7400         16  PB-I-SIG-SW                  PIC X.
  7401             88  PB-POLICY-SIGNED             VALUE 'Y'.
  7402         16  PB-I-RATE-CLASS              PIC XX.
  7403         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  7404         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  7405         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  7406         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  7407         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  7408         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  7409         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  7410         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 142
* EL689.cbl
  7411         16  PB-I-OB-FLAG                 PIC X.
  7412             88  PB-I-OB                      VALUE 'B'.
  7413             88  PB-I-SUMMARY                 VALUE 'Z'.
  7414         16  PB-I-ENTRY-STATUS            PIC X.
  7415             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  7416                                              'M' '5' '9' '2'.
  7417             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  7418             88  PB-I-POLICY-PENDING          VALUE '2'.
  7419             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  7420             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  7421             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  7422             88  PB-I-REIN-ONLY               VALUE '9'.
  7423             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  7424             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  7425             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  7426             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  7427         16  PB-I-INT-CODE                PIC X.
  7428             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  7429             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  7430         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  7431         16  PB-I-SOC-SEC-NO              PIC X(11).
  7432         16  PB-I-MEMBER-NO               PIC X(12).
  7433         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  7434*        16  PB-I-LOAN-OFFICER            PIC XXX.
  7435         16  PB-I-OLD-LOF                 PIC XXX.
  7436         16  PB-I-LF-EXPIRE-DT            PIC XX.
  7437         16  PB-I-AH-EXPIRE-DT            PIC XX.
  7438         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  7439         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  7440         16  PB-I-LIFE-INDICATOR          PIC X.
  7441             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  7442         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  7443         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  7444                                          PIC S9(5)V99    COMP-3.
  7445         16  PB-I-MAIL-ADDRS-SW           PIC X.
  7446             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  7447             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  7448         16  PB-I-1ST-PMT-DT              PIC XX.
  7449         16  PB-I-JOINT-INSURED.
  7450             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  7451             20 PB-I-JOINT-FIRST-NAME.
  7452                24  PB-I-JOINT-FIRST-INIT PIC X.
  7453                24  FILLER                PIC X(9).
  7454             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  7455*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  7456         16  PB-I-BENEFICIARY-NAME.
  7457             20  PB-I-BANK-NUMBER         PIC X(10).
  7458             20  FILLER                   PIC X(15).
  7459         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  7460         16  PB-I-REFERENCE               PIC X(12).
  7461         16  FILLER REDEFINES PB-I-REFERENCE.
  7462             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  7463             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  7464             20  PB-I-CLP-STATE           PIC XX.
  7465         16  PB-I-UNDERWRITING-STATUS     PIC X.
  7466             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  7467             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  7468             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 143
* EL689.cbl
  7469         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  7470         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  7471         16  PB-I-RESIDENT-STATE          PIC XX.
  7472         16  PB-I-RATE-CODE               PIC X(4).
  7473         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  7474         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7475         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7476         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  7477         16  PB-I-BANK-NOCHRGB            PIC 99.
  7478         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  7479         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  7480
  7481     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  7482         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  7483             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  7484         16  PB-C-CANCEL-ORIGIN           PIC X.
  7485             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  7486         16  PB-C-LF-CANCEL-DT            PIC XX.
  7487         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7488         16  PB-C-LF-CALC-REQ             PIC X.
  7489             88 PB-COMP-LF-CANCEL            VALUE '?'.
  7490         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  7491         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  7492         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  7493             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  7494         16  PB-C-AH-CANCEL-DT            PIC XX.
  7495         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7496         16  PB-C-AH-CALC-REQ             PIC X.
  7497             88 PB-COMP-AH-CANCEL            VALUE '?'.
  7498         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  7499         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  7500         16  PB-C-LAST-NAME               PIC X(15).
  7501         16  PB-C-REFUND-SW               PIC X.
  7502             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  7503             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  7504         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  7505         16  PB-C-PAYEE-CODE              PIC X(6).
  7506         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  7507         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  7508         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  7509         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  7510         16  PB-C-REFERENCE               PIC X(12).
  7511         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7512         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7513         16  PB-C-POST-CARD-IND           PIC X.
  7514         16  PB-C-CANCEL-REASON           PIC X.
  7515         16  PB-C-REF-INTERFACE-SW        PIC X.
  7516         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  7517         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  7518         16  FILLER                       PIC X(01).
  7519*        16  FILLER                       PIC X(18).
  7520         16  PB-C-POLICY-FORM-NO          PIC X(12).
  7521*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  7522         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  7523         16  PB-CANCELED-CERT-DATA.
  7524             20  PB-CI-INSURED-NAME.
  7525                 24  PB-CI-LAST-NAME      PIC X(15).
  7526                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 144
* EL689.cbl
  7527             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  7528             20  PB-CI-INSURED-SEX        PIC X.
  7529             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  7530             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  7531             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  7532             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  7533             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7534             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  7535             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  7536             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  7537             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  7538             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7539             20  PB-CI-RATE-CLASS         PIC XX.
  7540             20  PB-CI-RATE-DEV-LF        PIC XXX.
  7541             20  PB-CI-RATE-DEV-AH        PIC XXX.
  7542             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  7543             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  7544             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  7545             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  7546             20  PB-CI-LF-ABBR            PIC X(3).
  7547             20  PB-CI-AH-ABBR            PIC X(3).
  7548             20  PB-CI-OB-FLAG            PIC X.
  7549                 88  PB-CI-OB                VALUE 'B'.
  7550             20  PB-CI-LF-POLICY-STATUS   PIC X.
  7551                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  7552                                           'M' '4' '5' '9' '2'.
  7553                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  7554                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  7555                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  7556                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  7557                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  7558                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  7559                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  7560                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  7561                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  7562                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  7563                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  7564                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  7565             20  PB-CI-AH-POLICY-STATUS   PIC X.
  7566                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  7567                                           'M' '4' '5' '9' '2'.
  7568                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  7569                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  7570                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  7571                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  7572                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  7573                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  7574                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  7575                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  7576                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  7577                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  7578                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  7579                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  7580             20  PB-CI-PAY-FREQUENCY      PIC 99.
  7581             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  7582             20  PB-CI-SOC-SEC-NO         PIC X(11).
  7583             20  PB-CI-MEMBER-NO          PIC X(12).
  7584             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 145
* EL689.cbl
  7585                 88  PB-CI-ADD-ON                  VALUE 'A'.
  7586                 88  PB-CI-SIMPLE                  VALUE 'S'.
  7587             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  7588             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  7589             20  PB-CI-COMP-EXCP-SW       PIC X.
  7590                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  7591                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  7592             20  PB-CI-ENTRY-STATUS       PIC X.
  7593             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  7594             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  7595             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  7596             20  PB-CI-DEATH-DT           PIC XX.
  7597             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  7598             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  7599             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7600             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7601             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  7602             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  7603             20  PB-CI-ENTRY-DT              PIC XX.
  7604             20  PB-CI-ENTRY-BATCH           PIC X(6).
  7605             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  7606             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  7607             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  7608             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  7609             20  PB-CI-OLD-LOF               PIC XXX.
  7610*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  7611             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  7612             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  7613             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  7614             20  PB-CI-INDV-GRP-CD           PIC X.
  7615             20  PB-CI-BENEFICIARY-NAME.
  7616                 24  PB-CI-BANK-NUMBER       PIC X(10).
  7617                 24  FILLER                  PIC X(15).
  7618             20  PB-CI-NOTE-SW               PIC X.
  7619             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  7620             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  7621             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  7622             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  7623             20  PB-CI-LOAN-OFFICER          PIC X(5).
  7624             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  7625             20  PB-CI-FIRST-NAME            PIC X(10).
  7626             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  7627
  7628         16  FILLER                       PIC X(13).
  7629*032306  16  FILLER                       PIC X(27).
  7630*        16  FILLER                       PIC X(46).
  7631
  7632     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  7633         16  FILLER                       PIC X(10).
  7634         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  7635         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  7636         16  PB-M-INSURED-MID-INIT        PIC X.
  7637         16  PB-M-INSURED-AGE             PIC 99.
  7638         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  7639         16  PB-M-INSURED-SEX             PIC X.
  7640         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  7641         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  7642         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 146
* EL689.cbl
  7643         16  PB-M-INSURED-CITY-STATE.
  7644             20  PB-M-INSURED-CITY        PIC X(28).
  7645             20  PB-M-INSURED-STATE       PIC XX.
  7646         16  PB-M-INSURED-ZIP-CODE.
  7647             20  PB-M-INSURED-ZIP-PRIME.
  7648                 24  PB-M-INSURED-ZIP-1   PIC X.
  7649                     88  PB-M-CANADIAN-POST-CODE
  7650                                             VALUE 'A' THRU 'Z'.
  7651                 24  FILLER               PIC X(4).
  7652             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  7653         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  7654                                        PB-M-INSURED-ZIP-CODE.
  7655             20  PM-M-INS-CAN-POST1       PIC XXX.
  7656             20  PM-M-INS-CAN-POST2       PIC XXX.
  7657             20  FILLER                   PIC XXX.
  7658         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  7659         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  7660         16  PB-M-CRED-BENE-NAME          PIC X(30).
  7661         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  7662         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  7663         16  PB-M-CRED-BENE-CITYST.
  7664             20  PB-M-CRED-BENE-CITY      PIC X(28).
  7665             20  PB-M-CRED-BENE-STATE     PIC XX.
  7666         16  FILLER                       PIC X(92).
  7667
  7668     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  7669         16  FILLER                       PIC X(10).
  7670         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7671         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7672         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7673         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7674         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7675         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7676         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7677         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7678         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7679         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7680         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7681         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7682         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  7683         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  7684         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  7685         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  7686         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  7687         16  PB-ACCOUNT-NAME              PIC X(30).
  7688         16  PB-PREM-REF-RPT-FLAG         PIC X.
  7689         16  PB-REFERENCE                 PIC X(12).
  7690         16  PB-B-RECEIVED-DT             PIC XX.
  7691         16  FILLER                       PIC X(234).
  7692
  7693     12  PB-RECORD-STATUS.
  7694         16  PB-CREDIT-SELECT-DT          PIC XX.
  7695         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  7696         16  PB-BILLED-DT                 PIC XX.
  7697         16  PB-BILLING-STATUS            PIC X.
  7698             88  PB-ENTRY-REVERSED            VALUE 'R'.
  7699             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  7700             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 147
* EL689.cbl
  7701         16  PB-RECORD-BILL               PIC X.
  7702             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  7703             88  PB-RECORD-RETURNED           VALUE 'R'.
  7704             88  PB-RECORD-ENDORSED           VALUE 'E'.
  7705             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  7706             88  PB-OVERRIDE-AH               VALUE 'A'.
  7707             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  7708         16  PB-BATCH-ENTRY               PIC X.
  7709             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  7710             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  7711             88  PB-REISSUED-CERT             VALUE 'E'.
  7712             88  PB-MONTHLY-CERT              VALUE 'M'.
  7713             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  7714             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  7715             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  7716         16  PB-FORCE-CODE                PIC X.
  7717             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  7718             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  7719             88  PB-CANCEL-FORCE              VALUE '8'.
  7720             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  7721             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  7722             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  7723             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  7724             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  7725             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  7726             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  7727         16  PB-FATAL-FLAG                PIC X.
  7728             88  PB-FATAL-ERRORS              VALUE 'X'.
  7729         16  PB-FORCE-ER-CD               PIC X.
  7730             88  PB-FORCE-ERRORS              VALUE 'F'.
  7731             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  7732         16  PB-WARN-ER-CD                PIC X.
  7733             88  PB-WARNING-ERRORS            VALUE 'W'.
  7734         16  FILLER                       PIC X.
  7735         16  PB-OUT-BAL-CD                PIC X.
  7736             88  PB-OUT-OF-BAL                VALUE 'O'.
  7737         16  PB-LIFE-OVERRIDE-L1          PIC X.
  7738         16  PB-AH-OVERRIDE-L1            PIC X.
  7739         16  PB-INPUT-DT                  PIC XX.
  7740         16  PB-INPUT-BY                  PIC X(4).
  7741         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  7742         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  7743         16  PB-TOLERANCE-REJECT-SW       PIC X.
  7744         16  PB-LF-EARNING-METHOD         PIC X.
  7745         16  PB-AH-EARNING-METHOD         PIC X.
  7746         16  PB-LF-TERM-CALC-METHOD       PIC X.
  7747         16  PB-AH-TERM-CALC-METHOD       PIC X.
  7748         16  PB-REIN-CD                   PIC XXX.
  7749         16  PB-LF-REFUND-TYPE            PIC X.
  7750         16  PB-AH-REFUND-TYPE            PIC X.
  7751         16  PB-ACCT-EFF-DT               PIC XX.
  7752         16  PB-ACCT-EXP-DT               PIC XX.
  7753         16  PB-COMPANY-ID                PIC X(3).
  7754         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7755         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7756         16  PB-SV-CARRIER                PIC X.
  7757         16  PB-SV-GROUPING               PIC X(6).
  7758         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 148
* EL689.cbl
  7759         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  7760         16  PB-GA-BILLING-INFO.
  7761             20  PB-GA-BILL-DT OCCURS 5 TIMES
  7762                                          PIC XX.
  7763         16  PB-SV-REMIT-TO  REDEFINES
  7764             PB-GA-BILLING-INFO           PIC X(10).
  7765         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  7766         16  PB-I-LOAN-OFFICER            PIC X(5).
  7767         16  PB-I-VIN                     PIC X(17).
  7768
  7769         16  FILLER                       PIC X(04).
  7770         16  IMNET-BYPASS-SW              PIC X.
  7771
  7772******************************************************************
  7773*                COMMON EDIT ERRORS                              *
  7774******************************************************************
  7775
  7776     12  PB-COMMON-ERRORS.
  7777         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  7778                                           PIC S9(4)     COMP.
  7779
  7780******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 149
* EL689.cbl
  7782*    COPY ERCPYAJ.
  7783******************************************************************
  7784*                                                                *
  7785*                            ERCPYAJ                             *
  7786*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7787*                            VMOD=2.015                          *
  7788*                                                                *
  7789*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7790*                                                                *
  7791*                                                                *
  7792*   FILE TYPE = VSAM,KSDS                                        *
  7793*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7794*                                                                *
  7795*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7796*       ALTERNATE PATHS = NONE                                   *
  7797*                                                                *
  7798*   LOG = YES                                                    *
  7799*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7800******************************************************************
  7801******************************************************************
  7802*                   C H A N G E   L O G
  7803*
  7804* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7805*-----------------------------------------------------------------
  7806*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7807* EFFECTIVE    NUMBER
  7808*-----------------------------------------------------------------
  7809* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7810* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7811******************************************************************
  7812
  7813 01  PENDING-PAY-ADJ.
  7814     12  PY-RECORD-ID                     PIC XX.
  7815         88  VALID-PY-ID                        VALUE 'PY'.
  7816
  7817     12  PY-CONTROL-PRIMARY.
  7818         16  PY-COMPANY-CD                PIC X.
  7819         16  PY-CARRIER                   PIC X.
  7820         16  PY-GROUPING                  PIC X(6).
  7821         16  PY-FIN-RESP                  PIC X(10).
  7822         16  PY-ACCOUNT                   PIC X(10).
  7823         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7824                                          PIC X(10).
  7825         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7826         16  PY-RECORD-TYPE               PIC X.
  7827             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7828             88  PY-DEPOSIT                   VALUE 'D'.
  7829             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7830             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7831             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7832             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7833             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7834             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7835             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7836             88  PY-FICA-ENTRY                VALUE 'F'.
  7837             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7838             88  PY-POLICY-FEE                VALUE 'W'.
  7839             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 150
* EL689.cbl
  7840
  7841     12  PY-PYMT-TYPE                     PIC X.
  7842             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7843             88  PY-REINS-PYMT                VALUE 'R'.
  7844             88  PY-EXP-PYMT                  VALUE 'E'.
  7845
  7846     12  PY-BIL-INV                       PIC X(6).
  7847     12  PY-REF-NO                        PIC X(12).
  7848
  7849     12  PY-LAST-MAINT-DT                 PIC XX.
  7850     12  PY-LAST-MAINT-BY                 PIC X(4).
  7851     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7852
  7853     12  PY-PYADJ-RECORD.
  7854         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7855         16  PY-ENTRY-COMMENT             PIC X(30).
  7856         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7857             20  PY-GL-ACCOUNT            PIC X(10).
  7858             20  PY-GL-STATE              PIC X(02).
  7859             20  PY-GL-CANC-SW            PIC X(01).
  7860                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7861                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7862             20  PY-GL-COMMENT            PIC X(10).
  7863             20  FILLER      REDEFINES PY-GL-COMMENT.
  7864                 24  PY-GL-CHECK-NO       PIC 9(06).
  7865                 24  FILLER               PIC X(04).
  7866             20  FILLER                   PIC X(07).
  7867         16  PY-SAVE-ACCOUNT              PIC X(10).
  7868         16  PY-SAVE-TYPE                 PIC X(01).
  7869
  7870         16  PY-LETTERS.
  7871             20  PY-LETTER OCCURS 3 TIMES
  7872                           INDEXED BY PY-LET-NDX
  7873                                          PIC X(04).
  7874
  7875         16  PY-ERCOMP-TYPE               PIC X.
  7876             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7877             88  PY-GA-TYPE                   VALUE 'G'.
  7878             88  PY-BANK-TYPE                 VALUE 'B'.
  7879         16  FILLER                       PIC X(05).
  7880
  7881     12  PY-RECORD-STATUS.
  7882         16  PY-CREDIT-SELECT-DT          PIC XX.
  7883         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7884         16  PY-BILLED-DATE               PIC XX.
  7885         16  PY-REPORTED-DT               PIC XX.
  7886         16  PY-PMT-APPLIED               PIC X.
  7887             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7888             88  PY-GA-PMT                    VALUE 'G'.
  7889             88  PY-OVWRITE-PMT               VALUE 'O'.
  7890             88  PY-NON-AR-PMT                VALUE 'N'.
  7891         16  FILLER                       PIC X(5).
  7892         16  PY-INPUT-DT                  PIC XX.
  7893         16  PY-CHECK-NUMBER              PIC X(6).
  7894         16  PY-VOID-SW                   PIC X.
  7895             88  PY-CHECK-VOIDED              VALUE 'V'.
  7896         16  PY-CHECK-ORIGIN-SW           PIC X.
  7897             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 151
* EL689.cbl
  7898             88  PY-REFUND-CHECK              VALUE 'R'.
  7899             88  PY-GA-CHECK                  VALUE 'G'.
  7900             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7901             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7902         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7903         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7904         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7905         16  PY-BILL-FLAG                 PIC X.
  7906             88  PY-BILLED                    VALUE 'B'.
  7907         16  PY-AR-FLAG                   PIC X.
  7908             88  PY-AR-CYCLE                  VALUE 'C'.
  7909             88  PY-AR-MONTH-END              VALUE 'M'.
  7910         16  PY-AR-DATE                   PIC XX.
  7911
  7912     12  PY-GL-CODES.
  7913         16  PY-GL-DB                     PIC X(14).
  7914         16  PY-GL-CR                     PIC X(14).
  7915         16  PY-GL-FLAG                   PIC X.
  7916         16  PY-GL-DATE                   PIC XX.
  7917
  7918     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7919     12  FILLER                           PIC X(3).
  7920******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 152
* EL689.cbl
  7922*    COPY ELCTEXT.
  7923******************************************************************
  7924*                                                                *
  7925*                                                                *
  7926*                            ELCTEXT.                            *
  7927*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7928*                            VMOD=2.008                          *
  7929*                                                                *
  7930*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  7931*                                     FORM LETTERS,              *
  7932*                                     CERT FORM DISPLAY.
  7933*                                                                *
  7934*   FILE TYPE = VSAM,KSDS                                        *
  7935*   RECORD SIZE = 100   RECFORM = FIXED                          *
  7936*                                                                *
  7937*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  7938*       ALTERNATE INDEX = NONE                                   *
  7939*                                                                *
  7940*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  7941*       ALTERNATE INDEX = NONE                                   *
  7942*                                                                *
  7943*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  7944*       ALTERNATE INDEX = NONE                                   *
  7945*                                                                *
  7946*   LOG = NO                                                     *
  7947*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7948******************************************************************
  7949 01  TEXT-FILES.
  7950     12  TEXT-FILE-ID                PIC XX.
  7951         88  FORMS-FILE-TEXT            VALUE 'TF'.
  7952         88  LETTER-FILE-TEXT           VALUE 'TL'.
  7953         88  HELP-FILE-TEXT             VALUE 'TH'.
  7954
  7955     12  TX-CONTROL-PRIMARY.
  7956         16  TX-COMPANY-CD           PIC X.
  7957             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  7958         16  TX-ACCESS-CD-GENL       PIC X(12).
  7959
  7960         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7961             20  TX-LETTER-NO        PIC X(4).
  7962             20  FILLER              PIC X(8).
  7963
  7964         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7965             20  TX-FORM-NO          PIC X(12).
  7966
  7967         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7968             20  TX-HELP-TYPE        PIC X.
  7969                 88  HELP-FOR-GENERAL   VALUE ' '.
  7970                 88  HELP-BY-SCREEN     VALUE 'S'.
  7971                 88  HELP-BY-ERROR      VALUE 'E'.
  7972             20  TX-SCREEN-OR-ERROR  PIC X(4).
  7973                 88  GENERAL-INFO-HELP  VALUE '0000'.
  7974             20  TX-HELP-FOR-COMPANY  PIC XXX.
  7975                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  7976             20  FILLER              PIC X(4).
  7977
  7978         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  7979
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 153
* EL689.cbl
  7980     12  TX-PROCESS-CONTROL          PIC XX.
  7981         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  7982
  7983     12  TX-TEXT-LINE                PIC X(70).
  7984
  7985     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  7986         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  7987         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  7988         88  TX-VALID-FORM-SQUEEZE-VALUE
  7989                                        VALUE 'Y' ' '.
  7990
  7991     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  7992         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  7993         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  7994         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  7995         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  7996         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  7997         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  7998         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  7999                                              'K' 'N' ' '
  8000                                              'Z'.
  8001
  8002     12  TX-ARCHIVE-SW               PIC X.
  8003         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  8004         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  8005         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  8006
  8007     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  8008     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  8009
  8010     12  TX-BSR-CODE                 PIC X.
  8011         88  TX-BSR-LETTER              VALUE 'B'.
  8012         88  TX-NON-BSR-LETTER          VALUE ' '.
  8013
  8014     12  FILLER                      PIC X.
  8015*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 154
* EL689.cbl
  8017*    COPY ERCENDT.
  8018******************************************************************
  8019*                                                                *
  8020*                                                                *
  8021*                            ERCENDT.                            *
  8022*                            VMOD=2.001                          *
  8023*                                                                *
  8024*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  8025*                                                                *
  8026*   FILE TYPE = VSAM,KSDS                                        *
  8027*   RECORD SIZE = 579  RECFORM = FIXED                           *
  8028*                                                                *
  8029*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  8030*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  8031*                                                                *
  8032*   LOG = NO                                                     *
  8033*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8034******************************************************************
  8035*-----------------------------------------------------------------
  8036*                   C H A N G E   L O G
  8037*
  8038* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8039*-----------------------------------------------------------------
  8040*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8041* EFFECTIVE    NUMBER
  8042*-----------------------------------------------------------------
  8043* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  8044*                                WITH OPEN CLAIMS
  8045* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  8046* 110612    2012101700002  AJRA  ADD NEW FIELDS
  8047* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8048*-----------------------------------------------------------------
  8049 01  ENDORSEMENT-RECORD.
  8050     12  EN-RECORD-ID                PIC XX.
  8051         88  VALID-EN-ID                VALUE 'EN'.
  8052     12  EN-CONTROL-PRIMARY.
  8053         16  EN-COMPANY-CD           PIC X.
  8054         16  EN-CARRIER              PIC X.
  8055         16  EN-GROUPING             PIC X(6).
  8056         16  EN-STATE                PIC XX.
  8057         16  EN-ACCOUNT              PIC X(10).
  8058         16  EN-CERT-EFF-DT          PIC XX.
  8059         16  EN-CERT-NO.
  8060             20  EN-CERT-PRIME       PIC X(10).
  8061             20  EN-CERT-SFX         PIC X.
  8062         16  EN-REC-TYPE             PIC X.
  8063             88  EN-ISSUE               VALUE 'I'.
  8064             88  EN-CANCELLATION        VALUE 'C'.
  8065         16  EN-SEQ-NO               PIC 9(04) BINARY.
  8066     12  EN-CONTROL-BY-ARCH-NO.
  8067         16  EN-COMPANY-CD-A1              PIC X.
  8068         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  8069     12  EN-LAST-MAINT-DT            PIC XX.
  8070     12  EN-LAST-MAINT-BY            PIC X(4).
  8071     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  8072     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  8073     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  8074         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 155
* EL689.cbl
  8075         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  8076         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  8077         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  8078         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  8079         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  8080         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  8081         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  8082         16  EN-LF-ORIG-BENCD        PIC XX.
  8083         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  8084         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  8085         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  8086         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  8087         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  8088         16  EN-LF-ORIG-EXP-DT       PIC XX.
  8089*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  8090         16  EN-ORIG-CRED-BENE       PIC X(25).
  8091         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  8092         16  FILLER                  PIC X.
  8093         16  EN-AH-ORIG-BENCD        PIC XX.
  8094         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  8095         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  8096         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  8097         16  EN-AH-ORIG-EXP-DT       PIC XX.
  8098*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  8099*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  8100         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  8101         16  F                       PIC X(09).
  8102         16  EN-AH-ORIG-CP           PIC 99.
  8103         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  8104         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  8105         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  8106         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  8107         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  8108         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  8109         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  8110         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  8111         16  EN-LF-NEW-BENCD         PIC XX.
  8112         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  8113         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8114         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8115         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  8116         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  8117         16  EN-LF-NEW-EXP-DT        PIC XX.
  8118         16  EN-NEW-CRED-BENE        PIC X(25).
  8119         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8120         16  FILLER                  PIC X.
  8121         16  EN-AH-NEW-BENCD         PIC XX.
  8122         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  8123         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8124         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8125         16  EN-AH-NEW-EXP-DT        PIC XX.
  8126*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  8127*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  8128*        16  F                       PIC X(12).
  8129         16  EN-AH-NEW-CP            PIC 99.
  8130         16  EN-SIG-SW               PIC X.
  8131         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8132         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 156
* EL689.cbl
  8133         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  8134         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  8135         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  8136         16  FILLER                  PIC X(33).
  8137     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  8138         16  EN-LF-ORIG-REF-DT       PIC XX.
  8139         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8140         16  EN-AH-ORIG-REF-DT       PIC XX.
  8141         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8142         16  EN-LF-NEW-REF-DT        PIC XX.
  8143         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8144         16  EN-AH-NEW-REF-DT        PIC XX.
  8145         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8146         16  EN-FLAG-CERT            PIC X.
  8147         16  EN-INS-LAST-NAME        PIC X(15).
  8148         16  EN-INS-FIRST-NAME       PIC X(10).
  8149         16  EN-INS-MIDDLE-INIT      PIC X.
  8150         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8151         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8152         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8153         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8154         16  FILLER                  PIC X(262).
  8155     12  EN-MONEY-SW             PIC X.
  8156     12  EN-HEALTH-APP           PIC X.
  8157     12  EN-VOUCHER-SW           PIC X.
  8158     12  EN-PAYEE                PIC X(14).
  8159     12  EN-INPUT-DT             PIC XX.
  8160     12  EN-PROCESS-DT           PIC XX.
  8161     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  8162     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  8163     12  EN-REASON-CODES.
  8164         16  F OCCURS 12.
  8165             20  EN-REASON-CODE  PIC X(4).
  8166     12  EN-TEMPLATE-USED        PIC X(8).
  8167     12  EN-DOCU-TYPE            PIC X.
  8168         88  EN-VERI-DOCU          VALUE 'V'.
  8169         88  EN-GCE-DOCU           VALUE 'G'.
  8170         88  EN-CANC-DOCU          VALUE 'C'.
  8171     12  EN-COMMENTS1            PIC X(13).
  8172     12  EN-COMMENTS2            PIC X(70).
  8173     12  EN-COMM-CHGBK           PIC X.
  8174         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  8175         88  EN-CHG-ACCT           VALUE 'Y'.
  8176     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  8177     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  8178     12  EN-BATCH-NUMBER         PIC X(6).
  8179     12  EN-ACCT-SUMM            PIC X.
  8180     12  EN-CSO-SUMM             PIC X.
  8181     12  FILLER                  PIC X(13).
  8182******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 157
* EL689.cbl
  8184*    COPY ERCNOTE.
  8185******************************************************************
  8186*                                                                *
  8187*                                                                *
  8188*                            ERCNOTE                             *
  8189*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8190*                            VMOD=2.003                          *
  8191*                                                                *
  8192*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  8193*                                                                *
  8194*        FILE TYPE= VSAM,KSDS                                    *
  8195*        RECORD SIZE = 825    RECFORM = FIXED                    *
  8196*                                                                *
  8197*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  8198*                                                                *
  8199*        LOG = YES                                               *
  8200*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  8201*                                                                *
  8202******************************************************************
  8203*                   C H A N G E   L O G
  8204*
  8205* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8206*-----------------------------------------------------------------
  8207*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8208* EFFECTIVE    NUMBER
  8209*-----------------------------------------------------------------
  8210* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  8211*                                FILE WILL CONTAIN BILLING NOTES O
  8212******************************************************************
  8213
  8214 01  CERTIFICATE-NOTE.
  8215     12  CN-RECORD-ID                PIC  XX.
  8216         88  VALID-CN-ID                  VALUE 'CN'.
  8217
  8218     12  CN-CONTROL-PRIMARY.
  8219         16  CN-COMPANY-CD           PIC X.
  8220         16  CN-CARRIER              PIC X.
  8221         16  CN-GROUPING.
  8222             20 CN-GROUPING-PREFIX   PIC XXX.
  8223             20 CN-GROUPING-PRIME    PIC XXX.
  8224         16  CN-STATE                PIC XX.
  8225         16  CN-ACCOUNT.
  8226             20 CN-ACCOUNT-PREFIX    PIC X(4).
  8227             20 CN-ACCOUNT-PRIME     PIC X(6).
  8228         16  CN-CERT-EFF-DT          PIC XX.
  8229         16  CN-CERT-NO.
  8230             20  CN-CERT-PRIME       PIC X(10).
  8231             20  CN-CERT-SFX         PIC X.
  8232
  8233     12  CN-BILLING-START-LINE-NO    PIC 99.
  8234     12  CN-BILLING-END-LINE-NO      PIC 99.
  8235
  8236     12  CN-LINES.
  8237         16  CN-LINE OCCURS 10       PIC X(77).
  8238
  8239     12  CN-LAST-MAINT-DT            PIC XX.
  8240     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  8241     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 158
* EL689.cbl
  8242     12  FILLER                      PIC X(6).
  8243******************************************************************
  8244*    COPY ELCEOBC.
  8245******************************************************************
  8246*                                                                *
  8247*                                                                *
  8248*                            ELCEOBC                             *
  8249*                            VMOD=2.001                          *
  8250*                                                                *
  8251*   CLAIM SYSTEM EOB CODE TABLE                                  *
  8252*                                                                *
  8253*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  8254*   VSAM EOB CODE TABLE                                          *
  8255*                                                                *
  8256*   FILE DESCRIPTION = EOB CODE TABLE                            *
  8257*                                                                *
  8258*   FILE TYPE = VSAM,KSDS                                        *
  8259*   RECORD SIZE = 350   RECFORM = FIX                            *
  8260*                                                                *
  8261*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  8262*                                                                *
  8263*   LOG = NO                                                     *
  8264*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8265*                                                                *
  8266*                                                                *
  8267******************************************************************
  8268*                   C H A N G E   L O G
  8269*
  8270* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8271*-----------------------------------------------------------------
  8272*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8273* EFFECTIVE    NUMBER
  8274*-----------------------------------------------------------------
  8275* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  8276* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  8277* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  8278******************************************************************
  8279 01  EOB-CODES.
  8280     12  EO-RECORD-ID                      PIC XX.
  8281         88  VALID-DN-ID                      VALUE 'EO'.
  8282     12  EO-CONTROL-PRIMARY.
  8283         16  EO-COMPANY-CD                 PIC X.
  8284         16  EO-RECORD-TYPE                PIC X.
  8285             88  EO-EOB-RECS                  VALUE '1'.
  8286             88  EO-VERIF-RECS                VALUE '2'.
  8287             88  EO-GCE-RECS                  VALUE '3'.
  8288             88  EO-CANC-RECS                 VALUE '4'.
  8289             88  EO-BILL-NOTE-RECS            VALUE '5'.
  8290         16  EO-EOB-CODE                   PIC X(4).
  8291         16  FILLER                        PIC X(9).
  8292     12  EO-MAINT-INFORMATION.
  8293         16  EO-LAST-MAINT-DT              PIC XX.
  8294         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  8295         16  EO-LAST-MAINT-USER            PIC X(4).
  8296         16  FILLER                        PIC XX.
  8297     12  EO-DESCRIPTION                    PIC X(275).
  8298     12  FILLER                            PIC X(46).
  8299******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 159
* EL689.cbl
  8301*    COPY ELCENCC.
  8302******************************************************************
  8303*                                                                *
  8304*                                                                *
  8305*                            ELCENCC                             *
  8306*                            VMOD=2.001                          *
  8307*                                                                *
  8308*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  8309*                                                                *
  8310*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  8311*   A NAPERSOFT DOCUMENT                                         *
  8312*                                                                *
  8313*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  8314*                                                                *
  8315*   FILE TYPE = VSAM,KSDS                                        *
  8316*   RECORD SIZE = 400   RECFORM = FIX                            *
  8317*                                                                *
  8318*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  8319*                                                                *
  8320*   LOG = NO                                                     *
  8321*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8322*                                                                *
  8323*                                                                *
  8324******************************************************************
  8325*                   C H A N G E   L O G
  8326*
  8327* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8328*-----------------------------------------------------------------
  8329*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8330* EFFECTIVE    NUMBER
  8331*-----------------------------------------------------------------
  8332* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  8333******************************************************************
  8334 01  ENCLOSURE-CODES.
  8335     12  NC-RECORD-ID                      PIC XX.
  8336         88  VALID-NC-ID                      VALUE 'NC'.
  8337     12  NC-CONTROL-PRIMARY.
  8338         16  NC-COMPANY-CD                 PIC X.
  8339         16  NC-REC-TYPE                   PIC X.
  8340             88  NC-CLAIMS                   VALUE '1'.
  8341             88  NC-ADMIN                    VALUE '2'.
  8342         16  NC-ENC-CODE                   PIC X(5).
  8343         16  FILLER                        PIC X(09).
  8344     12  NC-MAINT-INFORMATION.
  8345         16  NC-LAST-MAINT-DT              PIC XX.
  8346         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  8347         16  NC-LAST-MAINT-USER            PIC X(4).
  8348         16  FILLER                        PIC XX.
  8349     12  NC-OUTPUT-STACK                   PIC XXX.
  8350     12  NC-ENCLOSURE-LINE                 PIC X(100).
  8351     12  NC-ATTACHMENTS                    PIC X(100).
  8352     12  NC-FUTURE                         PIC X(50).
  8353     12  FILLER                            PIC X(117).
  8354******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 160
* EL689.cbl
  8356 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  8357                          ACCOUNT-MASTER LETTER-ARCHIVE
  8358                          LETTER-ARCHIVE-TEXT
  8359                          CERTIFICATE-MASTER CHECK-RECORDS
  8360                          CONTROL-FILE COMPENSATION-MASTER
  8361                          MAILING-DATA PENDING-BUSINESS
  8362                          PENDING-PAY-ADJ TEXT-FILES
  8363                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  8364                          EOB-CODES ENCLOSURE-CODES.
  8365 0000-DFHEXIT SECTION.
  8366     MOVE '9#                    $   ' TO DFHEIV0.
  8367     MOVE 'EL689' TO DFHEIV1.
  8368     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8369     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  8370
  8371     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8372     MOVE '5'                    TO DC-OPTION-CODE.
  8373     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  8374     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  8375     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  8376                                    W-CURRENT-SAVE.
  8377     MOVE DC-GREG-DATE-A-EDIT    TO W-SAVE-EDIT-A-DATE
  8378     MOVE DC-DAY-OF-WEEK         TO W-SAVE-CYCLE-DAY-OF-WEEK
  8379
  8380     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8381     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  8382                                 TO EMI-SAVE-AREA.
  8383
  8384     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  8385                                    W-TS-TERM-SCREEN.
  8386
  8387     IF  EIBCALEN EQUAL 0
  8388         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  8389         GO TO 8300-SEND-TEXT
  8390     END-IF.
  8391     set P to address of KIXSYS
  8392     CALL "getenv" using by value P returning var-ptr
  8393     if var-ptr = null then
  8394        display ' kixsys not set '
  8395     else
  8396        set address of var to var-ptr
  8397        move 0 to env-var-len
  8398        inspect var tallying env-var-len
  8399          for characters before X'00'
  8400*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  8401        unstring var (1:env-var-len) delimited by '/'
  8402           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8403              WS-KIX-SYS
  8404        end-unstring
  8405*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  8406*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8407     end-if
  8408     set P to address of KIXHOST
  8409     CALL "getenv" using by value P returning var-ptr
  8410     if var-ptr = null then
  8411        display ' kixhost not set '
  8412     else
  8413        set address of var to var-ptr
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 161
* EL689.cbl
  8414        move 0 to env-var-len
  8415        inspect var tallying env-var-len
  8416          for characters before X'00'
  8417*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  8418        MOVE var(1:env-var-len)  to ws-kixhost
  8419*       unstring var (1:env-var-len) delimited by '/'
  8420*          into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8421*             WS-KIX-SYS
  8422*       end-unstring
  8423        DISPLAY ' WS KIX HOST ' WS-KIXSYS
  8424*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8425     end-if
  8426
  8427**** This routine will connect to the Logic Database on SQL Server
  8428**** and call a stored procedure to determine the next business da
  8429
  8430     PERFORM 4500-CONNECT-TO-DB  THRU 4500-EXIT
  8431     IF SQLCODE = 0
  8432        PERFORM 4600-GET-NEXT-BUS-DT  THRU 4600-EXIT
  8433        IF SQLCODE = 0
  8434            MOVE WS-NEXT-BUS-DT TO W-SAVE-NEXT-BUS-DT-EDIT-A
  8435                                   W-EDIT-A-DATE
  8436            MOVE W-EDIT-A-YY    TO DC-YMD-YEAR
  8437            MOVE W-EDIT-A-MM    TO DC-YMD-MONTH
  8438            MOVE W-EDIT-A-DD    TO DC-YMD-DAY
  8439            MOVE '3'            TO DC-OPTION-CODE
  8440            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8441            IF NO-CONVERSION-ERROR
  8442               MOVE DC-BIN-DATE-1 TO W-SAVE-BIN-NEXT-BUS-DT
  8443            ELSE
  8444               MOVE W-SAVE-BIN-DATE TO DC-BIN-DATE-1
  8445               MOVE '6'         TO DC-OPTION-CODE
  8446               MOVE ZEROS       TO DC-ELAPSED-MONTHS
  8447               IF W-SAVE-CYCLE-DAY-OF-WEEK = 6
  8448                  MOVE 3        TO DC-ELAPSED-DAYS
  8449               ELSE
  8450                 IF W-SAVE-CYCLE-DAY-OF-WEEK = 7
  8451                    MOVE 2     TO DC-ELAPSED-DAYS
  8452                 ELSE
  8453                    MOVE 1     TO DC-ELAPSED-DAYS
  8454                 END-IF
  8455               END-IF
  8456               PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8457               IF NO-CONVERSION-ERROR
  8458                   MOVE DC-BIN-DATE-2 TO W-SAVE-BIN-NEXT-BUS-DT
  8459                   MOVE DC-GREG-DATE-A-EDIT TO
  8460                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8461               ELSE
  8462                   MOVE W-SAVE-BIN-DATE TO W-SAVE-BIN-NEXT-BUS-DT
  8463                   MOVE W-SAVE-EDIT-A-DATE TO
  8464                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8465               END-IF
  8466            END-IF
  8467        ELSE
  8468            MOVE W-SAVE-BIN-DATE TO DC-BIN-DATE-1
  8469            MOVE '6'         TO DC-OPTION-CODE
  8470            MOVE ZEROS       TO DC-ELAPSED-MONTHS
  8471            IF W-SAVE-CYCLE-DAY-OF-WEEK = 6
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 162
* EL689.cbl
  8472               MOVE 3        TO DC-ELAPSED-DAYS
  8473            ELSE
  8474              IF W-SAVE-CYCLE-DAY-OF-WEEK = 7
  8475                 MOVE 2     TO DC-ELAPSED-DAYS
  8476              ELSE
  8477                 MOVE 1     TO DC-ELAPSED-DAYS
  8478              END-IF
  8479            END-IF
  8480            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8481            IF NO-CONVERSION-ERROR
  8482                MOVE DC-BIN-DATE-2 TO W-SAVE-BIN-NEXT-BUS-DT
  8483                MOVE DC-GREG-DATE-A-EDIT TO
  8484                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8485            ELSE
  8486                MOVE W-SAVE-BIN-DATE TO W-SAVE-BIN-NEXT-BUS-DT
  8487                MOVE W-SAVE-EDIT-A-DATE TO
  8488                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8489            END-IF
  8490        END-IF
  8491     ELSE
  8492        MOVE W-SAVE-BIN-DATE TO DC-BIN-DATE-1
  8493        MOVE '6'         TO DC-OPTION-CODE
  8494        MOVE ZEROS       TO DC-ELAPSED-MONTHS
  8495        IF W-SAVE-CYCLE-DAY-OF-WEEK = 6
  8496           MOVE 3        TO DC-ELAPSED-DAYS
  8497        ELSE
  8498          IF W-SAVE-CYCLE-DAY-OF-WEEK = 7
  8499             MOVE 2     TO DC-ELAPSED-DAYS
  8500          ELSE
  8501             MOVE 1     TO DC-ELAPSED-DAYS
  8502          END-IF
  8503        END-IF
  8504        PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8505        IF NO-CONVERSION-ERROR
  8506            MOVE DC-BIN-DATE-2 TO W-SAVE-BIN-NEXT-BUS-DT
  8507            MOVE DC-GREG-DATE-A-EDIT TO
  8508                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8509        ELSE
  8510            MOVE W-SAVE-BIN-DATE TO W-SAVE-BIN-NEXT-BUS-DT
  8511            MOVE W-SAVE-EDIT-A-DATE TO
  8512                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8513        END-IF
  8514     END-IF
  8515     PERFORM 4700-DISCONNECT THRU 4700-EXIT
  8516
  8517     IF  PI-689-CREATE-NO-SCREENS
  8518         GO TO 0600-BYPASS-SCREEN-CNTL
  8519     END-IF.
  8520
  8521     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  8522         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  8523             MOVE PI-SAVED-PROGRAM-5
  8524                                 TO PI-SAVED-PROGRAM-6
  8525             MOVE PI-SAVED-PROGRAM-4
  8526                                 TO PI-SAVED-PROGRAM-5
  8527             MOVE PI-SAVED-PROGRAM-3
  8528                                 TO PI-SAVED-PROGRAM-4
  8529             MOVE PI-SAVED-PROGRAM-2
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 163
* EL689.cbl
  8530                                 TO PI-SAVED-PROGRAM-3
  8531             MOVE PI-SAVED-PROGRAM-1
  8532                                 TO PI-SAVED-PROGRAM-2
  8533             MOVE PI-RETURN-TO-PROGRAM
  8534                                 TO PI-SAVED-PROGRAM-1
  8535             MOVE PI-CALLING-PROGRAM
  8536                                 TO PI-RETURN-TO-PROGRAM
  8537             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  8538             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8539             MOVE LOW-VALUES     TO EL689AO
  8540             PERFORM 9905-INITIALIZE-SECURITY THRU 9905-EXIT
  8541             IF PI-689-ARCHIVE-NUMBER NOT NUMERIC
  8542                MOVE ZEROS       TO PI-689-ARCHIVE-NUMBEr
  8543             END-IF
  8544             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6311'
  8545                     AND
  8546                 PI-689-KEY-DATA-FIELDS GREATER THAN LOW-VALUES
  8547                 GO TO 0400-EL6311-INCOMING
  8548             ELSE
  8549                 MOVE PI-689-ARCHIVE-NUMBER
  8550                                 TO W-INCOMING-ARCHIVE
  8551                 MOVE LOW-VALUES TO PI-1042-WA
  8552                                    PI-689-WORK-AREA
  8553                 MOVE ZEROS      TO PI-CURRENT-LINE
  8554                                    PI-TEMP-STOR-ITEMS
  8555                                    PI-TOTAL-LINES
  8556                                    PI-UPDATE-SW
  8557                                    PI-689-NUMBER-LABEL-LINES
  8558                                    PI-689-NUMBER-TEXT-RECORDS
  8559                                    PI-689-ERROR
  8560                 MOVE SPACES     TO PI-689-PRINT-SW
  8561                                    PI-689-ALT-PRINTER-ID
  8562                                    PI-689-LBL-OVERRIDE
  8563                                    PI-COMM-CONTROL
  8564                                    PI-689-FORM-NUMBER
  8565                                    PI-689-TEMP-STOR-ID
  8566                                    PI-689-LABEL-SOURCE
  8567                                    PI-689-USE-SCREEN-IND
  8568                 MOVE '2'        TO PI-ACTION
  8569                 MOVE -1         TO MAINTL
  8570                 MOVE PI-LOWER-CASE-LETTERS
  8571                                 TO W-LC-CASE-IND
  8572                 IF  W-INCOMING-ARCHIVE NUMERIC
  8573                         AND
  8574                     W-INCOMING-ARCH-NO GREATER THAN ZEROS
  8575                     MOVE 'S'    TO MAINTI
  8576                     MOVE +1     TO MAINTL
  8577                     MOVE AL-UANON
  8578                                 TO MAINTA
  8579                     MOVE W-INCOMING-ARCH-NO
  8580                                 TO ARCHNUMI
  8581                     MOVE +8     TO ARCHNUML
  8582                     MOVE AL-UNNON
  8583                                 TO ARCHNUMA
  8584                     GO TO 1000-SHOW
  8585                 ELSE
  8586                     GO TO 0450-SPECIAL-INPUT-PROCESS
  8587                 END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 164
* EL689.cbl
  8588             END-IF
  8589         ELSE
  8590             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  8591             MOVE PI-RETURN-TO-PROGRAM
  8592                                     TO PI-CALLING-PROGRAM
  8593             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  8594             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  8595             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  8596             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  8597             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  8598             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  8599             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  8600             PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  8601             MOVE LOW-VALUES         TO EL689AO
  8602             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8603             SET W-RG-NDX            TO PI-CURRENT-LINE
  8604             PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  8605                 VARYING
  8606                     W-SC-NDX FROM 1 BY 1
  8607                 UNTIL
  8608                     W-SC-NDX GREATER THAN
  8609                     W-NUM-LINES-PER-SCREEN
  8610             MOVE PI-689-ALT-PRINTER-ID
  8611                                     TO PRINTERO
  8612             MOVE AL-UANON           TO PRINTERA
  8613             MOVE -1                 TO PRINTERL
  8614             GO TO 8100-SEND-INITIAL-MAP
  8615         END-IF
  8616     END-IF.
  8617
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 165
* EL689.cbl
  8619 0200-RECEIVE.
  8620
  8621     MOVE PI-689-FATAL-CTR       TO EMI-FATAL-CTR
  8622     MOVE PI-689-FORCABLE-CTR    TO EMI-FORCABLE-CTR
  8623     IF  EMI-FATAL-CTR GREATER THAN ZEROS
  8624             OR
  8625         EMI-FORCABLE-CTR GREATER THAN ZEROS
  8626         MOVE 'Y'                TO W-HOLD-IND.
  8627
  8628     MOVE W-TRANSACTION          TO EIBTRNID.
  8629     MOVE EMI-SAVE-AREA          TO ERROR-MESSAGE-INTERFACE-BLOCK.
  8630     MOVE ZEROS                  TO W-LAST-ERROR.
  8631     MOVE LOW-VALUES             TO EL689AI.
  8632     MOVE '104A'                 TO W-TS-ID-TEXT.
  8633     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  8634                                    W-TS-TERM-SCREEN.
  8635
  8636
  8637* EXEC CICS HANDLE AID
  8638*        CLEAR    (9300-DFHCLEAR)
  8639*        PA1      (9200-PA)
  8640*        PA2      (9200-PA)
  8641*        PA3      (9200-PA)
  8642*    END-EXEC.
  8643*    MOVE '"&=!"#               V! " #00008539' TO DFHEIV0
  8644     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  8645     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  8646     MOVE X'2220233030303038353339' TO DFHEIV0(25:11)
  8647     CALL 'kxdfhei1' USING DFHEIV0
  8648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8649
  8650
  8651
  8652* EXEC CICS HANDLE CONDITION
  8653*        PGMIDERR (9700-PGMID-ERROR)
  8654*        ERROR    (9800-ABEND)
  8655*        MAPFAIL  (0325-MAPFAIL)
  8656*    END-EXEC.
  8657*    MOVE '"$L.?                 ! # #00008546' TO DFHEIV0
  8658     MOVE X'22244C2E3F20202020202020' TO DFHEIV0(1:12)
  8659     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8660     MOVE X'2320233030303038353436' TO DFHEIV0(25:11)
  8661     CALL 'kxdfhei1' USING DFHEIV0
  8662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8663
  8664
  8665
  8666* EXEC CICS SYNCPOINT
  8667*    END-EXEC.
  8668*    MOVE '6"                    !   #00008552' TO DFHEIV0
  8669     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  8670     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8671     MOVE X'2020233030303038353532' TO DFHEIV0(25:11)
  8672     CALL 'kxdfhei1' USING DFHEIV0
  8673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8674
  8675
  8676     IF PI-LOWER-CASE-LETTERS = 'Y'
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 166
* EL689.cbl
  8677*    IF  W-LC-USE-BOTH-CASES
  8678
  8679* EXEC CICS RECEIVE
  8680*            MAP      (W-MAP)
  8681*            MAPSET   (W-MAPSET)
  8682*            INTO     (EL689AI)
  8683*            ASIS
  8684*        END-EXEC
  8685     MOVE LENGTH OF
  8686      EL689AI
  8687       TO DFHEIV11
  8688*    MOVE '8"TAI  L              ''   #00008557' TO DFHEIV0
  8689     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8690     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8691     MOVE X'2020233030303038353537' TO DFHEIV0(25:11)
  8692     CALL 'kxdfhei1' USING DFHEIV0,
  8693           W-MAP,
  8694           EL689AI,
  8695           DFHEIV11,
  8696           W-MAPSET,
  8697           DFHEIV99,
  8698           DFHEIV99
  8699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8700     ELSE
  8701
  8702* EXEC CICS RECEIVE
  8703*            MAP      (W-MAP)
  8704*            MAPSET   (W-MAPSET)
  8705*            INTO     (EL689AI)
  8706*        END-EXEC.
  8707     MOVE LENGTH OF
  8708      EL689AI
  8709       TO DFHEIV11
  8710*    MOVE '8"T I  L              ''   #00008564' TO DFHEIV0
  8711     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8712     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8713     MOVE X'2020233030303038353634' TO DFHEIV0(25:11)
  8714     CALL 'kxdfhei1' USING DFHEIV0,
  8715           W-MAP,
  8716           EL689AI,
  8717           DFHEIV11,
  8718           W-MAPSET,
  8719           DFHEIV99,
  8720           DFHEIV99
  8721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8722
  8723
  8724     IF  NOT DISPLAY-CAP
  8725         MOVE 'READ'             TO SM-READ
  8726         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8727         MOVE ER-9097            TO EMI-ERROR
  8728         MOVE -1                 TO MAINTL
  8729         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8730         GO TO 8100-SEND-INITIAL-MAP.
  8731
  8732     INSPECT MAINTI CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
  8733
  8734     IF  ENTERPFL EQUAL 0
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 167
* EL689.cbl
  8735         GO TO 0300-CHECK-PFKEYS.
  8736
  8737     IF  EIBAID NOT EQUAL DFHENTER
  8738         MOVE ER-0004            TO EMI-ERROR
  8739         GO TO 0320-INPUT-ERROR.
  8740
  8741     IF  ENTERPFI NUMERIC
  8742             AND
  8743         ENTERPFI GREATER THAN 0
  8744             AND
  8745         ENTERPFI LESS THAN 25
  8746         MOVE PF-VALUES (ENTERPFI)
  8747                                 TO EIBAID
  8748     ELSE
  8749         MOVE ER-0029            TO EMI-ERROR
  8750         GO TO 0320-INPUT-ERROR.
  8751
  8752 0300-CHECK-PFKEYS.
  8753
  8754     IF  EIBAID EQUAL DFHPF23
  8755         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8756         MOVE ZEROS              TO PI-TOTAL-LINES
  8757                                    PI-CURRENT-LINE
  8758         MOVE EIBAID             TO PI-ENTRY-CD-1
  8759         MOVE W-XCTL-005         TO W-CALL-PGM
  8760         GO TO 9400-XCTL.
  8761
  8762     IF  EIBAID EQUAL DFHPF24
  8763         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8764         MOVE ZEROS              TO PI-TOTAL-LINES
  8765                                    PI-CURRENT-LINE
  8766         MOVE W-XCTL-626         TO W-CALL-PGM
  8767         GO TO 9400-XCTL.
  8768
  8769     MOVE SPACES                 TO W-KEY-FIELDS-CHANGED-IND
  8770                                    W-FORM-CHANGED-IND.
  8771
  8772     IF  PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  8773             OR
  8774         PI-SHOW-MODE
  8775         NEXT SENTENCE
  8776     ELSE
  8777         IF  PI-689-FORM-NUMBER GREATER THAN SPACES
  8778                 AND
  8779             FORML NOT EQUAL ZEROS
  8780                 AND
  8781             PI-689-FORM-NUMBER NOT EQUAL FORMI
  8782             MOVE FORMI          TO PI-689-FORM-NUMBER
  8783             MOVE LOW-VALUES     TO EL689AI
  8784                                    PI-1042-WA
  8785                                    PI-689-FOLLOW-UP-DATE
  8786                                    PI-689-PRINT-RESTRICTION
  8787                                    PI-689-RESEND-DATE-1
  8788                                    PI-689-RESEND1-EDIT
  8789                                    PI-689-FOLLOW-UP-DATE
  8790                                    PI-689-FOLLOW-UP-EDIT
  8791                                    PI-689-ERROR-IND
  8792             MOVE ZEROS          TO PI-689-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 168
* EL689.cbl
  8793                                    PI-689-NUMBER-COPIES
  8794                                    PI-689-NUMBER-LABEL-LINES
  8795                                    PI-689-NUMBER-TEXT-RECORDS
  8796                                    PI-CURRENT-LINE
  8797                                    PI-TEMP-STOR-ITEMS
  8798                                    PI-TOTAL-LINES
  8799                                    PI-UPDATE-SW
  8800             MOVE SPACES         TO PI-689-PRINT-SW
  8801                                    PI-689-ALT-PRINTER-ID
  8802                                    PI-COMM-CONTROL
  8803                                    PI-689-TEMP-STOR-ID
  8804                                    PI-689-USE-SCREEN-IND
  8805                                    PI-689-RESEND-LETR-1
  8806                                    PI-CERT-FORM-ID
  8807                                    PI-CERT-REQ-IND
  8808                                    PI-REASON-REQ-IND
  8809             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8810             MOVE DFHENTER       TO EIBAID
  8811             MOVE 'Y'            TO W-FORM-CHANGED-IND
  8812             GO TO 0330-FUNCTION-CHECK
  8813         ELSE
  8814             IF  PI-689-DATA-SOURCE NOT EQUAL DATASORI
  8815                     OR
  8816                 (PI-689-LABEL-SOURCE NOT EQUAL ADDRSI
  8817                         AND
  8818                     (PI-689-LABEL-SOURCE NOT EQUAL SPACES
  8819                             OR
  8820                         ADDRSI NOT EQUAL LOW-VALUES))
  8821                     OR
  8822                 PI-689-CARRIER NOT EQUAL CARRIERI
  8823                     OR
  8824                 PI-689-GROUPING NOT EQUAL GROUPI
  8825                     OR
  8826                 PI-689-STATE NOT EQUAL STATEI
  8827                     OR
  8828                 PI-689-ACCOUNT NOT EQUAL ACCTI
  8829                     OR
  8830                 PI-689-CERT-PRIME NOT EQUAL CERTI
  8831                     OR
  8832                 PI-689-CERT-SFX NOT EQUAL SFXI
  8833                     OR
  8834                 PI-689-TYPE NOT EQUAL TYPEI
  8835                     OR
  8836                 PI-689-DATE-EDIT NOT EQUAL DATEI
  8837                     OR
  8838                 PI-689-RESP-PERSON NOT EQUAL RPERSONI
  8839                     OR
  8840                 PI-689-SEQ-EDIT NOT EQUAL SEQI
  8841                     OR
  8842                 PI-689-ENTRY-BATCH NOT EQUAL BENTRYI
  8843                     OR
  8844                 PI-689-BCSEQ-EDIT NOT EQUAL BCSEQI
  8845                 MOVE 'Y'        TO W-KEY-FIELDS-CHANGED-IND
  8846                 MOVE DFHENTER   TO EIBAID
  8847                 GO TO 0330-FUNCTION-CHECK.
  8848
  8849*    IF  EIBAID EQUAL DFHPF1
  8850*        MOVE +7                 TO W-ROLL-COUNTER
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 169
* EL689.cbl
  8851*        GO TO 4000-ROLL-PAGE.
  8852
  8853*    IF  EIBAID EQUAL DFHPF2
  8854*        MOVE -7                 TO W-ROLL-COUNTER
  8855*        GO TO 4000-ROLL-PAGE.
  8856
  8857*    IF  EIBAID EQUAL DFHPF3
  8858*        IF  W-HOLD-ON
  8859*            MOVE ER-7245        TO EMI-ERROR
  8860*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8861*            MOVE -1             TO MAINTL
  8862*            MOVE AL-UABON       TO MAINTA
  8863*            GO TO 8200-SEND-DATAONLY
  8864*        ELSE
  8865*            GO TO 0330-FUNCTION-CHECK.
  8866*    IF (EIBAID = DFHPF8)
  8867*       AND (PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR
  8868*         'CAGB' OR 'DLVA' OR 'ECCA' OR 'KRHA' OR 'ALWA')
  8869*       MOVE ER-0029             TO EMI-ERROR
  8870*       GO TO 0320-INPUT-ERROR
  8871*    END-IF
  8872*    IF EIBAID = DFHPF4 OR DFHPF8
  8873*        IF  W-HOLD-ON
  8874*            MOVE ER-7245        TO EMI-ERROR
  8875*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8876*            MOVE -1             TO MAINTL
  8877*            MOVE AL-UABON       TO MAINTA
  8878*            GO TO 8200-SEND-DATAONLY
  8879*        ELSE
  8880*            GO TO 0330-FUNCTION-CHECK.
  8881
  8882*    IF  EIBAID = DFHPF5
  8883*        COMPUTE W-ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  8884*        GO TO 4000-ROLL-PAGE.
  8885
  8886*    IF  EIBAID = DFHPF6
  8887*        MOVE PI-TOTAL-LINES     TO W-ROLL-COUNTER
  8888*        GO TO 4000-ROLL-PAGE.
  8889
  8890     IF  EIBAID EQUAL DFHPF7
  8891         IF PI-PROMPT-IND EQUAL 'Y'
  8892             MOVE ER-0894        TO EMI-ERROR
  8893             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8894             MOVE -1             TO MAINTL
  8895             MOVE AL-UABON       TO MAINTA
  8896             GO TO 8200-SEND-DATAONLY
  8897         END-IF
  8898     END-IF.
  8899
  8900     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  8901         IF  W-HOLD-ON
  8902             MOVE ER-7245        TO EMI-ERROR
  8903             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8904             MOVE -1             TO MAINTL
  8905             MOVE AL-UABON       TO MAINTA
  8906             GO TO 8200-SEND-DATAONLY
  8907         ELSE
  8908             GO TO 0330-FUNCTION-CHECK.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 170
* EL689.cbl
  8909
  8910     IF  EIBAID EQUAL DFHENTER
  8911         GO TO 0330-FUNCTION-CHECK.
  8912
  8913     MOVE ER-0029                TO EMI-ERROR.
  8914
  8915 0320-INPUT-ERROR.
  8916
  8917     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8918
  8919     IF  ENTERPFL EQUAL 0
  8920         MOVE -1                 TO MAINTL
  8921         MOVE AL-UABON           TO MAINTA
  8922     ELSE
  8923         MOVE AL-UNBON           TO ENTERPFA
  8924         MOVE -1                 TO ENTERPFL.
  8925
  8926     GO TO 8200-SEND-DATAONLY.
  8927
  8928 0325-MAPFAIL.
  8929***********************************************************
  8930*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  8931*      LETTERS ON A 3275 PRINTER.                         *
  8932***********************************************************
  8933
  8934     PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  8935
  8936     SET W-RG-NDX                TO PI-CURRENT-LINE.
  8937     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  8938             VARYING
  8939         W-SC-NDX FROM 1 BY 1
  8940             UNTIL
  8941         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
  8942
  8943     MOVE -1                     TO MAINTL.
  8944     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 171
* EL689.cbl
  8946 0330-FUNCTION-CHECK.
  8947
  8948     IF  MAINTI EQUAL 'S'
  8949*        IF EIBAID = DFHPF4 OR DFHPF8
  8950*            GO TO 7900-PRINT-LETTER-NOW
  8951*        ELSE
  8952             GO TO 1000-SHOW.
  8953
  8954     IF  NOT MODIFY-CAP
  8955         MOVE 'UPDATE'           TO SM-READ
  8956         PERFORM 9995-SECURITY-VIOLATION
  8957         MOVE ER-0070            TO EMI-ERROR
  8958         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8959         MOVE -1                 TO MAINTL
  8960         GO TO 8100-SEND-INITIAL-MAP.
  8961
  8962     IF  W-FORM-CHANGED
  8963             OR
  8964         W-KEY-FIELDS-CHANGED
  8965         GO TO 0330-EDIT.
  8966
  8967     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8968
  8969
  8970*    IF  EIBAID EQUAL DFHPF3
  8971*        IF  PI-NO-CARRIER-SECURITY
  8972*                AND
  8973*            PI-NO-ACCOUNT-SECURITY
  8974*            GO TO 5000-EDIT-MODE.
  8975
  8976     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  8977         IF  PI-NO-CARRIER-SECURITY
  8978                 AND
  8979             PI-NO-ACCOUNT-SECURITY
  8980             GO TO 5400-LETTER-RELEASE
  8981         ELSE
  8982             IF  PI-689-PRINT-PERFORMED
  8983                 GO TO 5400-LETTER-RELEASE
  8984             ELSE
  8985                 MOVE AL-UNBON TO ENTERPFA
  8986                 MOVE -1       TO ENTERPFL
  8987                 MOVE ER-2398  TO EMI-ERROR
  8988                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8989                 GO TO 8200-SEND-DATAONLY.
  8990
  8991*    IF  EIBAID = DFHPF4 OR DFHPF8
  8992*        GO TO 7900-PRINT-LETTER-NOW.
  8993
  8994 0330-EDIT.
  8995
  8996     IF  W-SC-TEXTL (1) NOT EQUAL ZEROS
  8997             OR
  8998         W-SC-TEXTL (2) NOT EQUAL ZEROS
  8999             OR
  9000         W-SC-TEXTL (3) NOT EQUAL ZEROS
  9001             OR
  9002         W-SC-TEXTL (4) NOT EQUAL ZEROS
  9003             OR
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 172
* EL689.cbl
  9004         W-SC-TEXTL (5) NOT EQUAL ZEROS
  9005             OR
  9006         W-SC-TEXTL (6) NOT EQUAL ZEROS
  9007             OR
  9008         W-SC-TEXTL (7) NOT EQUAL ZEROS
  9009             OR
  9010         W-SC-TEXTL (8) NOT EQUAL ZEROS
  9011             OR
  9012         W-SC-TEXTL (9) NOT EQUAL ZEROS
  9013             OR
  9014         W-SC-TEXTL (10) NOT EQUAL ZEROS
  9015             OR
  9016         W-SC-TEXTL (11) NOT EQUAL ZEROS
  9017         IF  W-KEY-FIELDS-CHANGED
  9018                 OR
  9019             W-FORM-CHANGED
  9020             MOVE ER-7250        TO EMI-ERROR
  9021             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9022             MOVE -1             TO MAINTL
  9023             MOVE AL-UABON       TO MAINTA
  9024         ELSE
  9025             PERFORM 4100-SET-NDX THRU 4100-EXIT
  9026             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
  9027                     VARYING
  9028                 W-SC-NDX FROM 1 BY 1
  9029                     UNTIL
  9030                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
  9031             MOVE ER-7398        TO EMI-ERROR
  9032             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9033             MOVE -1             TO MAINTL
  9034             MOVE AL-UABON       TO MAINTA
  9035             GO TO 8200-SEND-DATAONLY.
  9036
  9037     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  9038
  9039     IF  W-KEY-FIELDS-CHANGED
  9040             OR
  9041         PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  9042         PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  9043         IF  MAINTI EQUAL 'C'
  9044             GO TO 2000-CREATE
  9045         ELSE
  9046             NEXT SENTENCE
  9047     ELSE
  9048         IF  W-FORM-CHANGED
  9049             PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  9050             IF  MAINTI EQUAL 'C'
  9051                 GO TO 2000-CREATE
  9052             ELSE
  9053                 NEXT SENTENCE
  9054         ELSE
  9055             MOVE -1             TO MAINTL
  9056             GO TO 8200-SEND-DATAONLY.
  9057
  9058     MOVE ER-0023                TO EMI-ERROR.
  9059     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9060     MOVE -1                     TO MAINTL.
  9061     MOVE AL-UABON               TO MAINTA.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 173
* EL689.cbl
  9062     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 174
* EL689.cbl
  9064 0350-EDIT-ROUTINE.
  9065
  9066     IF  MAINTI EQUAL 'C'
  9067             AND
  9068         FORML EQUAL ZEROS
  9069         MOVE -1                 TO FORML
  9070         MOVE ER-0177            TO EMI-ERROR
  9071         MOVE AL-UABON           TO FORMA
  9072         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9073
  9074     IF PRTNOWL > ZEROS
  9075        IF PRTNOWI = 'Y' OR 'N' OR 'P' OR ' '
  9076           MOVE PRTNOWI          TO PI-PRINT-NOW
  9077           MOVE AL-UANON         TO PRTNOWA
  9078        END-IF
  9079     END-IF
  9080     IF ENDARCHL > ZEROS
  9081        IF ENDARCHI NUMERIC
  9082            MOVE ENDARCHI       TO PI-ENDT-ARCH-NO
  9083            MOVE AL-UNNON       TO ENDARCHA
  9084            MOVE ENDARCHI       TO W-ERENDT-ARCHIVE
  9085            MOVE PI-COMPANY-CD  TO W-ERENDT-COMPANY-CD-A1
  9086            MOVE 'N'            TO W-VALID-ENDT-SW
  9087            PERFORM 0355-CHECK-ERENDT THRU 0355-EXIT
  9088            IF NOT W-VALID-ENDT
  9089                MOVE -1         TO ENDARCHL
  9090                MOVE ER-1565    TO EMI-ERROR
  9091                MOVE AL-UNBON   TO ENDARCHA
  9092                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9093            END-IF
  9094        END-IF
  9095     ELSE
  9096        MOVE ZEROS              TO PI-ENDT-ARCH-NO
  9097     END-IF
  9098     MOVE SPACES                 TO PI-689-PRINT-RESTRICTION
  9099*    IF  PRTRESTL NOT EQUAL ZEROS
  9100*        PERFORM 0360-EDIT-PRINT-RESTRICTIONS THRU 0360-EXIT.
  9101
  9102     IF  FOLLOWL NOT EQUAL ZEROS
  9103         MOVE FOLLOWI            TO W-DEEDIT-FIELD
  9104         PERFORM 8600-DEEDIT
  9105         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9106         MOVE '4'                TO DC-OPTION-CODE
  9107         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9108         IF  DATE-CONVERSION-ERROR
  9109             MOVE ER-0182        TO EMI-ERROR
  9110             MOVE -1             TO FOLLOWL
  9111             MOVE AL-UABON       TO FOLLOWA
  9112             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9113         ELSE
  9114             MOVE DC-GREG-DATE-1-EDIT
  9115                                 TO FOLLOWO
  9116                                    PI-689-FOLLOW-UP-EDIT
  9117             MOVE AL-UANON       TO FOLLOWA
  9118             MOVE DC-BIN-DATE-1  TO PI-689-FOLLOW-UP-DATE
  9119     ELSE
  9120         MOVE LOW-VALUES         TO PI-689-FOLLOW-UP-DATE.
  9121
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 175
* EL689.cbl
  9122     IF  PI-689-FOLLOW-UP-DATE NOT EQUAL LOW-VALUES
  9123         IF  PI-689-FOLLOW-UP-DATE LESS THAN
  9124                 W-SAVE-BIN-DATE
  9125             MOVE ER-0533        TO EMI-ERROR
  9126             MOVE AL-UABON       TO FOLLOWA
  9127             MOVE -1             TO FOLLOWL
  9128             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9129
  9130     IF  RESEND1L NOT EQUAL ZEROS
  9131         MOVE RESEND1I           TO W-DEEDIT-FIELD
  9132         PERFORM 8600-DEEDIT
  9133         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9134         MOVE '4'                TO DC-OPTION-CODE
  9135         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9136         IF  DATE-CONVERSION-ERROR
  9137             MOVE ER-0185        TO EMI-ERROR
  9138             MOVE -1             TO RESEND1L
  9139             MOVE AL-UABON       TO RESEND1A
  9140             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9141         ELSE
  9142             MOVE DC-GREG-DATE-1-EDIT
  9143                                 TO RESEND1O
  9144                                    PI-689-RESEND1-EDIT
  9145             MOVE AL-UANON       TO RESEND1A
  9146             MOVE DC-BIN-DATE-1  TO PI-689-RESEND-DATE-1
  9147     ELSE
  9148         MOVE LOW-VALUES         TO PI-689-RESEND-DATE-1.
  9149
  9150     IF  PI-689-RESEND-DATE-1 NOT EQUAL LOW-VALUES
  9151         IF  PI-689-RESEND-DATE-1 NOT GREATER THAN
  9152                 W-SAVE-BIN-DATE
  9153             MOVE ER-0537        TO EMI-ERROR
  9154             MOVE AL-UABON       TO RESEND1A
  9155             MOVE -1             TO RESEND1L
  9156             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9157
  9158     IF ENCL > ZEROS
  9159        MOVE FUNCTION UPPER-CASE(ENCI) TO ENCI
  9160                                          PI-ENCLOSURE-CD
  9161        MOVE SPACES             TO W-ELENCC-KEY
  9162        MOVE PI-COMPANY-CD      TO W-ENCC-COMPANY-CD
  9163        MOVE '2'                TO W-ENCC-REC-TYPE
  9164        MOVE ENCI               TO W-ENCC-ENC-CODE
  9165
  9166
  9167* EXEC CICS READ
  9168*           DATASET    (W-ENCC-FILE-ID)
  9169*           SET        (ADDRESS OF ENCLOSURE-CODES)
  9170*           RIDFLD     (W-ELENCC-KEY)
  9171*           RESP       (W-RESPONSE)
  9172*       END-EXEC
  9173*    MOVE '&"S        E          (  N#00009012' TO DFHEIV0
  9174     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9175     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9176     MOVE X'204E233030303039303132' TO DFHEIV0(25:11)
  9177     CALL 'kxdfhei1' USING DFHEIV0,
  9178           W-ENCC-FILE-ID,
  9179           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 176
* EL689.cbl
  9180           DFHEIV99,
  9181           W-ELENCC-KEY,
  9182           DFHEIV99,
  9183           DFHEIV99,
  9184           DFHEIV99
  9185     SET ADDRESS OF ENCLOSURE-CODES TO
  9186         DFHEIV20
  9187     MOVE EIBRESP  TO W-RESPONSE
  9188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9189
  9190        IF RESP-NORMAL
  9191           MOVE ENCI             TO PI-ENCLOSURE-CD
  9192                                    W-ENCLOSURE-CD
  9193           MOVE AL-UANON         TO ENCA
  9194        ELSE
  9195           MOVE ER-1560          TO EMI-ERROR
  9196           MOVE -1               TO ENCL
  9197           MOVE AL-UABON         TO ENCA
  9198           PERFORM 9900-ERROR-FORMAT
  9199                                 THRU 9900-EXIT
  9200        END-IF
  9201     END-IF
  9202
  9203
  9204     IF NOT PI-CREATE-LABELS
  9205         MOVE PI-LABEL-CONTROL   TO ADDRLBLI
  9206         MOVE AL-PANON           TO ADDRLBLA
  9207         GO TO 0350-BYPASS-OVERRIDE.
  9208
  9209     IF  ADDRLBLL GREATER THAN ZEROS
  9210          INSPECT ADDRLBLI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9211          IF ADDRLBLI = 'N' OR 'Y'
  9212              MOVE ADDRLBLI      TO PI-689-LBL-OVERRIDE
  9213              MOVE AL-UANON      TO ADDRLBLA
  9214          ELSE
  9215             MOVE ER-3783        TO EMI-ERROR
  9216             MOVE -1             TO ADDRLBLL
  9217             MOVE AL-UABON       TO ADDRLBLA
  9218             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9219
  9220 0350-BYPASS-OVERRIDE.
  9221
  9222     IF  PI-BYPASS-LABELS
  9223             OR
  9224         FORMI EQUAL '9999'
  9225             OR
  9226         PI-689-LABELS-OVERRIDEN
  9227         MOVE SPACES             TO PI-689-LABEL-SOURCE
  9228         MOVE LOW-VALUES         TO ADDRSI
  9229         MOVE AL-UANOF           TO ADDRSA
  9230         MOVE ZEROS              TO ADDRSL
  9231     ELSE
  9232         IF  ADDRSL GREATER THAN ZEROS
  9233             MOVE ADDRSI         TO W-LABEL-SOURCE
  9234             IF  W-LABEL-SOURCE-VALID
  9235                 MOVE ADDRSI     TO PI-689-LABEL-SOURCE
  9236             ELSE
  9237                 MOVE -1         TO ADDRSL
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 177
* EL689.cbl
  9238                 MOVE ER-0176    TO EMI-ERROR
  9239                 MOVE AL-UABON   TO ADDRSA
  9240                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9241         ELSE
  9242             IF  MAINTI EQUAL 'C'
  9243                 MOVE -1         TO ADDRSL
  9244                 MOVE ER-0176    TO EMI-ERROR
  9245                 MOVE AL-UABON   TO ADDRSA
  9246                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9247
  9248     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  9249     IF  PRINTERL GREATER ZERO
  9250         INSPECT PRINTERI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9251         MOVE AL-UANON           TO PRINTERA
  9252         MOVE PRINTERI           TO PI-689-ALT-PRINTER-ID
  9253                                    PI-ALT-DMD-PRT-ID
  9254     ELSE
  9255         IF  PI-NO-CARRIER-SECURITY
  9256                 AND
  9257             PI-NO-ACCOUNT-SECURITY
  9258             IF  PI-PROCESSOR-PRINTER GREATER THAN SPACES
  9259                 MOVE PI-PROCESSOR-PRINTER
  9260                                 TO PI-689-ALT-PRINTER-ID
  9261                                    PRINTERI
  9262                 MOVE AL-UABON   TO PRINTERA
  9263             ELSE
  9264                 MOVE PI-COMPANY-ID
  9265                                 TO W-CNTL-COMPANY-ID
  9266                 MOVE '1'        TO W-CNTL-RECORD-TYPE
  9267                 MOVE SPACES     TO W-CNTL-GENL
  9268                 MOVE ZEROS      TO W-CNTL-SEQ-NO
  9269
  9270* EXEC CICS HANDLE CONDITION
  9271*                     NOTOPEN    (8040-CNTL-NOT-OPEN)
  9272*                     NOTFND     (7945-NOT-FOUND)
  9273*                END-EXEC
  9274*    MOVE '"$JI                  ! $ #00009098' TO DFHEIV0
  9275     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9276     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9277     MOVE X'2420233030303039303938' TO DFHEIV0(25:11)
  9278     CALL 'kxdfhei1' USING DFHEIV0
  9279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9280
  9281* EXEC CICS READ
  9282*                     DATASET    (W-CNTL-FILE-ID)
  9283*                     SET        (ADDRESS OF CONTROL-FILE)
  9284*                     RIDFLD     (W-CNTL-KEY)
  9285*                END-EXEC
  9286*    MOVE '&"S        E          (   #00009102' TO DFHEIV0
  9287     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9288     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9289     MOVE X'2020233030303039313032' TO DFHEIV0(25:11)
  9290     CALL 'kxdfhei1' USING DFHEIV0,
  9291           W-CNTL-FILE-ID,
  9292           DFHEIV20,
  9293           DFHEIV99,
  9294           W-CNTL-KEY,
  9295           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 178
* EL689.cbl
  9296           DFHEIV99,
  9297           DFHEIV99
  9298     SET ADDRESS OF CONTROL-FILE TO
  9299         DFHEIV20
  9300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9301                 MOVE CF-FORMS-PRINTER-ID
  9302                                 TO PI-689-ALT-PRINTER-ID
  9303                                    PRINTERI
  9304                                    W-TS-TERM-TEXT
  9305                 MOVE AL-UABON   TO PRINTERA
  9306         ELSE
  9307             MOVE AL-UABON       TO PRINTERA
  9308             MOVE -1             TO PRINTERL
  9309             MOVE ER-9283        TO EMI-ERROR
  9310             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9311
  9312     IF  COPIESL NOT EQUAL ZEROS
  9313         IF  COPIESI NOT NUMERIC
  9314                 OR
  9315             COPIESI EQUAL '0'
  9316             MOVE ER-0184        TO EMI-ERROR
  9317             MOVE -1             TO COPIESL
  9318             MOVE AL-UABON       TO COPIESA
  9319             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9320         ELSE
  9321             MOVE COPIESI        TO PI-689-NUMBER-COPIES
  9322             MOVE AL-UANON       TO COPIESA
  9323     ELSE
  9324         IF FORMI EQUAL '9999'
  9325             MOVE 1              TO PI-689-NUMBER-COPIES
  9326                                    COPIESL
  9327                                    COPIESO.
  9328
  9329     IF  FORML NOT EQUAL ZEROS
  9330         INSPECT FORMI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9331         MOVE FORMI              TO PI-689-FORM-NUMBER.
  9332
  9333     MOVE SPACES                 TO W-HOLD-IND.
  9334
  9335     IF PI-CERT-REQ-IND = 'Y'
  9336       IF  CERTIDL NOT EQUAL ZEROS
  9337         IF CERTIDI NUMERIC
  9338             MOVE AL-UANON      TO CERTIDA
  9339             MOVE CERTIDI       TO PI-CERT-FORM-ID
  9340         ELSE
  9341             MOVE ER-1778       TO EMI-ERROR
  9342             MOVE -1            TO CERTIDL
  9343             MOVE AL-UABON      TO CERTIDA
  9344             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9345         END-IF
  9346       ELSE
  9347          MOVE ER-0715       TO EMI-ERROR
  9348          MOVE -1            TO CERTIDL
  9349          MOVE AL-UABON      TO CERTIDA
  9350          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9351       END-IF
  9352     END-IF.
  9353
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 179
* EL689.cbl
  9354     IF PI-REASON-REQ-IND = 'Y'
  9355        IF PI-ENDT-ARCH-NO NOT > ZERO
  9356          MOVE ER-9840       TO EMI-ERROR
  9357          MOVE -1            TO FORML
  9358          MOVE AL-UABON      TO FORMA
  9359          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9360        END-IF
  9361     END-IF.
  9362
  9363     IF  NOT EMI-NO-ERRORS
  9364         IF  EMI-ERROR EQUAL ER-7250
  9365             GO TO 0350-EXIT
  9366         ELSE
  9367            MOVE -1             TO MAINTL
  9368            GO TO 8200-SEND-DATAONLY.
  9369
  9370 0350-EXIT.
  9371      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 180
* EL689.cbl
  9373 0355-CHECK-ERENDT.
  9374
  9375*     EXEC CICS GETMAIN
  9376*          SET      (ADDRESS OF ENDORSEMENT-RECORD)
  9377*          LENGTH   (W-ENDT-LENGTH)
  9378*     END-EXEC
  9379
  9380
  9381* EXEC CICS READ
  9382*         DATASET    ('ERENDT2')
  9383*         SET        (ADDRESS OF ENDORSEMENT-RECORD)
  9384*         RIDFLD     (W-ERENDT-KEY-BY-ARCH)
  9385*         RESP       (W-RESPONSE)
  9386*    END-EXEC
  9387     MOVE 'ERENDT2' TO DFHEIV1
  9388*    MOVE '&"S        E          (  N#00009186' TO DFHEIV0
  9389     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9390     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9391     MOVE X'204E233030303039313836' TO DFHEIV0(25:11)
  9392     CALL 'kxdfhei1' USING DFHEIV0,
  9393           DFHEIV1,
  9394           DFHEIV20,
  9395           DFHEIV99,
  9396           W-ERENDT-KEY-BY-ARCH,
  9397           DFHEIV99,
  9398           DFHEIV99,
  9399           DFHEIV99
  9400     SET ADDRESS OF ENDORSEMENT-RECORD TO
  9401         DFHEIV20
  9402     MOVE EIBRESP  TO W-RESPONSE
  9403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9404
  9405     IF (RESP-NORMAL)
  9406         IF PI-RETURN-TO-PROGRAM EQUAL 'EL6311'  AND
  9407            EN-COMPANY-CD  =  PI-COMPANY-CD      AND
  9408            EN-CARRIER     =  PI-689-CARRIER     AND
  9409            EN-GROUPING    =  PI-689-GROUPING    AND
  9410            EN-STATE       =  PI-689-STATE       AND
  9411            EN-ACCOUNT     =  PI-689-ACCOUNT     AND
  9412            EN-CERT-EFF-DT =  PI-689-EFF-DATE    AND
  9413            EN-CERT-NO     =  PI-689-CERT-NO
  9414               SET W-VALID-ENDT TO TRUE
  9415         END-IF
  9416         IF PI-RETURN-TO-PROGRAM EQUAL 'EL1273'  AND
  9417            EN-COMPANY-CD  =  PI-COMPANY-CD      AND
  9418            EN-CARRIER     =  PI-CARRIER         AND
  9419            EN-GROUPING    =  PI-GROUPING        AND
  9420            EN-STATE       =  PI-STATE           AND
  9421            EN-ACCOUNT     =  PI-ACCOUNT         AND
  9422            EN-CERT-EFF-DT =  PI-CERT-EFF-DT     AND
  9423            EN-CERT-NO     =  PI-CERT-NO
  9424               SET W-VALID-ENDT TO TRUE
  9425         END-IF
  9426     END-IF
  9427      .
  9428
  9429 0355-EXIT.
  9430      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 181
* EL689.cbl
  9432 0360-EDIT-PRINT-RESTRICTIONS.
  9433
  9434*    INSPECT PRTRESTI CONVERTING W-LOWER-CASE
  9435*                                TO W-UPPER-CASE.
  9436*
  9437*    IF  (PI-689-PRINT-RESTRICTION EQUAL ' ' OR 'F'
  9438*                                     OR 'P' OR LOW-VALUES)
  9439*            AND
  9440*        PRTRESTI EQUAL 'C'
  9441*            AND
  9442*        PI-689-CONTROL NOT GREATER THAN ZEROS
  9443*        MOVE ER-7243            TO EMI-ERROR
  9444*        MOVE -1                 TO PRTRESTL
  9445*        MOVE AL-UABON           TO PRTRESTA
  9446*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9447*        GO TO 0360-EXIT.
  9448*
  9449*    IF  PRTRESTL NOT EQUAL ZEROS
  9450*        IF PRTRESTI = 'C' OR 'F' OR 'P'
  9451*            MOVE PRTRESTI       TO PI-689-PRINT-RESTRICTION
  9452*            MOVE AL-UANON       TO PRTRESTA
  9453*        ELSE
  9454*            IF  PRTRESTI EQUAL ' '
  9455*                MOVE SPACES     TO PI-689-PRINT-RESTRICTION
  9456*                MOVE AL-UANON   TO PRTRESTA
  9457*            ELSE
  9458*                MOVE ER-7393    TO EMI-ERROR
  9459*                MOVE -1         TO PRTRESTL
  9460*                MOVE AL-UABON   TO PRTRESTA
  9461*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9462*
  9463*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
  9464*            AND
  9465*        W-HOLD-ON
  9466*            AND
  9467*        PI-689-CONTROL NOT GREATER THAN ZEROS
  9468*        MOVE ER-7243            TO EMI-ERROR
  9469*        MOVE -1                 TO PRTRESTL
  9470*        MOVE AL-UABON           TO PRTRESTA
  9471*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9472     .
  9473 0360-EXIT.
  9474      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 182
* EL689.cbl
  9476 0400-EL6311-INCOMING.
  9477
  9478     MOVE ZEROS                  TO PI-CURRENT-LINE
  9479                                    PI-TEMP-STOR-ITEMS
  9480                                    PI-TOTAL-LINES
  9481                                    PI-UPDATE-SW
  9482                                    PI-689-NUMBER-LABEL-LINES
  9483                                    PI-689-ERROR
  9484                                    PI-689-NUMBER-TEXT-RECORDS.
  9485     MOVE SPACES                 TO PI-689-PRINT-SW
  9486                                    PI-689-ALT-PRINTER-ID
  9487                                    PI-COMM-CONTROL
  9488                                    PI-689-FORM-NUMBER
  9489                                    PI-689-TEMP-STOR-ID
  9490                                    PI-689-LABEL-SOURCE
  9491                                    PI-689-USE-SCREEN-IND.
  9492
  9493     IF PI-CREATE-LABELS
  9494         MOVE  AL-UANON          TO ADDRLBLA
  9495         MOVE  +1                TO ADDRLBLL.
  9496
  9497     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  9498                                    PI-689-LBL-OVERRIDE.
  9499
  9500     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
  9501     MOVE '2'                    TO PI-ACTION.
  9502     MOVE -1                     TO MAINTL.
  9503
  9504     MOVE AL-UANON               TO PRTNOWA.
  9505     MOVE +1                     TO PRTNOWL.
  9506     MOVE 'N'                    TO PRTNOWI
  9507                                    PI-PRINT-NOW.
  9508
  9509     IF  PI-689-CARRIER NOT EQUAL LOW-VALUES
  9510         MOVE AL-UANON           TO CARRIERA
  9511         MOVE +1                 TO CARRIERL
  9512         MOVE PI-689-CARRIER     TO CARRIERI.
  9513
  9514     IF  PI-689-GROUPING NOT EQUAL LOW-VALUES
  9515         MOVE +6                 TO GROUPL
  9516         MOVE AL-UANON           TO GROUPA
  9517         MOVE PI-689-GROUPING    TO GROUPI.
  9518
  9519     IF  PI-689-STATE NOT EQUAL LOW-VALUES
  9520         MOVE +2                 TO STATEL
  9521         MOVE AL-UANON           TO STATEA
  9522         MOVE PI-689-STATE       TO STATEI.
  9523
  9524     IF  PI-689-ACCOUNT NOT EQUAL LOW-VALUES
  9525         MOVE +10                TO ACCTL
  9526         MOVE AL-UANON           TO ACCTA
  9527         MOVE PI-689-ACCOUNT     TO ACCTI.
  9528
  9529     IF  PI-689-CERT-PRIME NOT EQUAL LOW-VALUES
  9530         MOVE +10                TO CERTL
  9531         MOVE AL-UANON           TO CERTA
  9532         MOVE PI-689-CERT-PRIME  TO CERTI.
  9533
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 183
* EL689.cbl
  9534     IF  PI-689-CERT-SFX NOT EQUAL LOW-VALUES
  9535         MOVE +1                 TO SFXL
  9536         MOVE AL-UANON           TO SFXA
  9537         MOVE PI-689-CERT-SFX    TO SFXI.
  9538
  9539     IF  PI-689-ENTRY-BATCH NOT EQUAL LOW-VALUES
  9540         MOVE +6                 TO BENTRYL
  9541         MOVE AL-UANON           TO BENTRYA
  9542         MOVE PI-689-ENTRY-BATCH TO BENTRYI.
  9543
  9544     MOVE +4                     TO BCSEQL.
  9545     MOVE AL-UANON               TO BCSEQA.
  9546     MOVE PI-689-CHG-SEQ-NO      TO BCSEQI.
  9547
  9548     IF  PI-689-SEQ-NO NOT EQUAL ZEROS
  9549         MOVE +8                 TO SEQL
  9550         MOVE AL-UANON           TO SEQA
  9551         MOVE PI-689-SEQ-NO      TO SEQI.
  9552
  9553     IF  PI-689-EFF-DATE NOT EQUAL LOW-VALUES
  9554         MOVE PI-689-EFF-DATE    TO DC-BIN-DATE-1
  9555         MOVE ' '                TO DC-OPTION-CODE
  9556         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9557         MOVE +8                 TO DATEL
  9558         MOVE DC-GREG-DATE-1-EDIT
  9559                                 TO DATEI
  9560         MOVE AL-UANON           TO DATEA.
  9561
  9562     MOVE -1                     TO MAINTL.
  9563     MOVE '4'                    TO DATASORI
  9564                                    PI-689-DATA-SOURCE.
  9565     MOVE +1                     TO DATASORL.
  9566     MOVE AL-UANON               TO DATASORA.
  9567
  9568     GO TO 8100-SEND-INITIAL-MAP.
  9569
  9570 0400-EXIT.
  9571      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 184
* EL689.cbl
  9573 0450-SPECIAL-INPUT-PROCESS.
  9574
  9575     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6501'
  9576             AND
  9577         PI-CARRIER GREATER THAN LOW-VALUES
  9578         MOVE '1'                TO DATASORI
  9579                                    PI-689-DATA-SOURCE
  9580         MOVE PI-CARRIER         TO CARRIERI
  9581         MOVE PI-GROUPING        TO GROUPI
  9582         MOVE PI-STATE           TO STATEI
  9583         MOVE PI-ACCOUNT         TO ACCTI
  9584         MOVE PI-CERT-EFF-DT     TO DC-BIN-DATE-1
  9585         MOVE ' '                TO DC-OPTION-CODE
  9586         PERFORM 9500-LINK-DATE-CONVERT
  9587             THRU 9500-EXIT
  9588         MOVE DC-GREG-DATE-1-EDIT
  9589                                 TO DATEI
  9590         MOVE 'N'                TO PRTNOWI
  9591                                    PI-PRINT-NOW
  9592         MOVE AL-UANON           TO ACCTA
  9593                                    CARRIERA
  9594                                    DATEA
  9595                                    DATASORA
  9596                                    GROUPA
  9597                                    STATEA
  9598                                    PRTNOWA
  9599         MOVE +1                 TO CARRIERL
  9600                                    DATASORL
  9601                                    PRTNOWL
  9602         MOVE -1                 TO MAINTL
  9603         MOVE +6                 TO GROUPL
  9604         MOVE +2                 TO STATEL
  9605         MOVE +8                 TO DATEL
  9606         MOVE +10                TO ACCTL
  9607     ELSE
  9608         IF  PI-RETURN-TO-PROGRAM EQUAL 'EL652'
  9609                 AND
  9610             PI-CARRIER GREATER THAN LOW-VALUES
  9611             MOVE '3'            TO DATASORI
  9612                                    PI-689-DATA-SOURCE
  9613             MOVE PI-CR-CARRIER  TO CARRIERI
  9614             MOVE PI-CR-GROUPING TO GROUPI
  9615             MOVE PI-CR-ACCOUNT  TO ACCTI
  9616             MOVE PI-CR-FIN-RESP TO RPERSONI
  9617             MOVE PI-CR-TYPE     TO TYPEI
  9618             MOVE 'N'            TO PRTNOWI
  9619                                    PI-PRINT-NOW
  9620             MOVE AL-UANON       TO CARRIERA
  9621                                    GROUPA
  9622                                    ACCTA
  9623                                    DATASORA
  9624                                    RPERSONA
  9625                                    TYPEA
  9626                                    PRTNOWA
  9627             MOVE +1             TO CARRIERL
  9628                                    DATASORL
  9629                                    TYPEL
  9630                                    PRTNOWL
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 185
* EL689.cbl
  9631             MOVE -1             TO MAINTL
  9632             MOVE +6             TO GROUPL
  9633             MOVE +10            TO ACCTL
  9634                                    RPERSONL
  9635         ELSE
  9636             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL1273'
  9637                     AND
  9638                 PI-CARRIER GREATER THAN LOW-VALUES
  9639                 MOVE '2'        TO DATASORI
  9640                                    PI-689-DATA-SOURCE
  9641                 MOVE PI-CARRIER TO CARRIERI
  9642                 MOVE PI-GROUPING
  9643                                 TO GROUPI
  9644                 MOVE PI-STATE   TO STATEI
  9645                 MOVE PI-ACCOUNT TO ACCTI
  9646                 MOVE PI-CERT-PRIME
  9647                                 TO CERTI
  9648                 MOVE PI-CERT-SFX
  9649                                 TO SFXI
  9650                 MOVE PI-CERT-EFF-DT
  9651                                 TO DC-BIN-DATE-1
  9652                 MOVE ' '        TO DC-OPTION-CODE
  9653                 PERFORM 9500-LINK-DATE-CONVERT
  9654                     THRU 9500-EXIT
  9655                 MOVE DC-GREG-DATE-1-EDIT
  9656                                 TO DATEI
  9657                 MOVE 'N'        TO PRTNOWI
  9658                                    PI-PRINT-NOW
  9659                 MOVE AL-UANON   TO CARRIERA
  9660                                    GROUPA
  9661                                    STATEA
  9662                                    ACCTA
  9663                                    CERTA
  9664                                    SFXA
  9665                                    DATEA
  9666                                    ADDRSA
  9667                                    DATASORA
  9668                                    PRTNOWA
  9669                 MOVE +1         TO CARRIERL
  9670                                    SFXL
  9671                                    DATASORL
  9672                                    ADDRSL
  9673                                    PRTNOWL
  9674                 MOVE -1         TO MAINTL
  9675                 MOVE +6         TO GROUPL
  9676                 MOVE +2         TO STATEL
  9677                 MOVE +8         TO DATEL
  9678                 MOVE +10        TO ACCTL
  9679                                    CERTL.
  9680
  9681     IF PI-CREATE-LABELS
  9682         MOVE  AL-UANON          TO ADDRLBLA
  9683         MOVE  +1                TO ADDRLBLL.
  9684
  9685     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  9686                                    PI-689-LBL-OVERRIDE.
  9687
  9688     MOVE LOW-VALUES             TO PI-689-KEY-DATA-FIELDS.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 186
* EL689.cbl
  9689     GO TO 8100-SEND-INITIAL-MAP.
  9690
  9691 0450-EXIT.
  9692      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 187
* EL689.cbl
  9694 0600-BYPASS-SCREEN-CNTL.
  9695***************************************************************
  9696*     THIS ROUTINE WILL PROCESS A NEW LETTER REQUIREMENT      *
  9697*     WITH THE INFORMATION FOUND IN THE PI AREA WITHOUT       *
  9698*     PERFORMING ANY SCREEN IO.                               *
  9699***************************************************************
  9700
  9701
  9702* EXEC CICS HANDLE CONDITION
  9703*        PGMIDERR (9700-PGMID-ERROR)
  9704*        MAPFAIL  (0325-MAPFAIL)
  9705*        ERROR    (9800-ABEND)
  9706*    END-EXEC.
  9707*    MOVE '"$L?.                 ! % #00009489' TO DFHEIV0
  9708     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  9709     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9710     MOVE X'2520233030303039343839' TO DFHEIV0(25:11)
  9711     CALL 'kxdfhei1' USING DFHEIV0
  9712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9713
  9714
  9715     MOVE LOW-VALUES             TO EL689AI.
  9716
  9717     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM
  9718
  9719     MOVE PI-689-FORM-NUMBER     TO FORMI.
  9720     MOVE +4                     TO FORML.
  9721
  9722     IF  PI-689-NUMBER-COPIES GREATER THAN ZERO
  9723         MOVE PI-689-NUMBER-COPIES
  9724                                 TO COPIESI
  9725         MOVE +1                 TO COPIESL.
  9726
  9727     MOVE PI-689-LABEL-SOURCE    TO ADDRSI.
  9728     MOVE +1                     TO ADDRSL.
  9729     MOVE PI-689-DATA-SOURCE     TO DATASORI.
  9730     MOVE +1                     TO DATASORL.
  9731
  9732*    IF  PI-689-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
  9733*        MOVE PI-689-PRINT-RESTRICTION
  9734*                                TO PRTRESTI
  9735*        MOVE +1                 TO PRTRESTL.
  9736
  9737     MOVE SPACES                 TO PI-689-PRINT-SW
  9738                                    PI-689-LBL-OVERRIDE.
  9739     MOVE ZEROS                  TO PI-TOTAL-LINES
  9740                                    PI-CURRENT-LINE
  9741                                    PI-TEMP-STOR-ITEMS
  9742                                    PI-UPDATE-SW
  9743                                    PI-689-ERROR
  9744                                    PI-689-NUMBER-LABEL-LINES
  9745                                    PI-689-NUMBER-TEXT-RECORDS.
  9746
  9747     IF  PI-689-ALT-PRINTER-ID NOT EQUAL LOW-VALUES
  9748         MOVE +4                 TO PRINTERL
  9749         MOVE PI-689-ALT-PRINTER-ID
  9750                                 TO PRINTERI PI-ALT-DMD-PRT-ID.
  9751
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 188
* EL689.cbl
  9752     MOVE SPACES                 TO PI-689-ALT-PRINTER-ID.
  9753
  9754     IF  PI-689-SOURCE-VARIABLE
  9755         PERFORM 0700-GET-VARIABLE-LABEL THRU 0700-EXIT.
  9756
  9757     MOVE SPACES                 TO W-CNTL-KEY
  9758     MOVE LOW-VALUES             TO W-ACCT-KEY
  9759                                    W-CERT-KEY
  9760                                    W-CHEK-KEY
  9761                                    W-COMP-KEY
  9762                                    W-MAIL-KEY
  9763                                    W-PNDB-KEY
  9764                                    W-PNDB2-KEY
  9765                                    W-PYAJ-KEY.
  9766
  9767     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9768     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  9769                                    W-CERT-COMPANY-CD
  9770                                    W-CHEK-COMPANY-CD
  9771                                    W-COMP-COMPANY-CD
  9772                                    W-MAIL-COMPANY-CD
  9773                                    W-PNDB-COMPANY-CD
  9774                                    W-PNDB2-COMPANY-CD
  9775                                    W-PYAJ-COMPANY-CD.
  9776
  9777     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
  9778         MOVE PI-689-CARRIER     TO W-ACCT-CARRIER
  9779                                    W-CERT-CARRIER
  9780                                    W-MAIL-CARRIER
  9781                                    W-CERT-CARRIER
  9782                                    W-COMP-CARRIER
  9783                                    W-CHEK-CARRIER
  9784                                    W-PNDB2-CARRIER
  9785                                    W-PYAJ-CARRIER.
  9786
  9787     IF  PI-689-GROUPING GREATER THAN LOW-VALUES
  9788         MOVE PI-689-GROUPING    TO W-ACCT-GROUPING
  9789                                    W-CERT-GROUPING
  9790                                    W-CHEK-GROUPING
  9791                                    W-COMP-GROUPING
  9792                                    W-MAIL-GROUPING
  9793                                    W-PNDB2-GROUPING
  9794                                    W-PYAJ-GROUPING.
  9795
  9796     IF  PI-689-STATE GREATER THAN LOW-VALUES
  9797         MOVE PI-689-STATE       TO W-ACCT-STATE
  9798                                    W-CERT-STATE
  9799                                    W-CHEK-STATE
  9800                                    W-MAIL-STATE
  9801                                    W-PNDB2-STATE.
  9802
  9803     IF  PI-689-ACCOUNT GREATER THAN LOW-VALUES
  9804         IF PI-689-DATA-SOURCE = '3' OR '6'
  9805             MOVE PI-689-ACCOUNT TO W-COMP-ACCOUNT
  9806                                    W-PYAJ-ACCOUNT
  9807         ELSE
  9808             MOVE PI-689-ACCOUNT TO W-ACCT-ACCOUNT
  9809                                    W-CERT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 189
* EL689.cbl
  9810                                    W-CHEK-ACCOUNT
  9811                                    W-MAIL-ACCOUNT
  9812                                    W-PNDB2-ACCOUNT.
  9813
  9814     IF  PI-689-EFF-DATE GREATER THAN LOW-VALUES
  9815         MOVE PI-689-EFF-DATE    TO W-CERT-EFF-DT
  9816                                    W-CHEK-EFF-DT
  9817                                    W-MAIL-EFF-DT
  9818                                    W-PNDB2-EFF-DT.
  9819
  9820     IF  PI-689-CERT-PRIME GREATER THAN LOW-VALUES
  9821         MOVE PI-689-CERT-PRIME  TO W-CERT-CERT-PRIME
  9822                                    W-CHEK-CERT-PRIME
  9823                                    W-MAIL-CERT-PRIME
  9824                                    W-PNDB2-CERT-PRIME
  9825
  9826         IF  PI-689-CERT-SFX GREATER THAN LOW-VALUES
  9827             MOVE PI-689-CERT-SFX
  9828                                 TO W-CERT-CERT-SFX
  9829                                    W-CHEK-CERT-SFX
  9830                                    W-MAIL-CERT-SFX
  9831                                    W-PNDB2-CERT-SFX
  9832         ELSE
  9833             MOVE SPACES         TO W-CERT-CERT-SFX
  9834                                    W-CHEK-CERT-SFX
  9835                                    W-MAIL-CERT-SFX
  9836                                    W-PNDB2-CERT-SFX.
  9837
  9838     IF  PI-689-RESP-PERSON GREATER THAN LOW-VALUES
  9839         IF PI-689-DATA-SOURCE = '3' OR '6'
  9840             MOVE PI-689-RESP-PERSON
  9841                                 TO W-COMP-RESP-PERSON
  9842                                    W-PYAJ-FIN-RESP.
  9843
  9844     IF  PI-689-TYPE GREATER THAN LOW-VALUES
  9845         IF PI-689-DATA-SOURCE = '3' OR '6'
  9846             MOVE PI-689-TYPE    TO W-COMP-TYPE
  9847                                    W-PYAJ-RECORD-TYPE
  9848         ELSE
  9849             MOVE PI-689-TYPE    TO W-PNDB2-TYPE.
  9850
  9851     IF  PI-689-SEQ-NO GREATER THAN ZEROS
  9852         MOVE PI-689-SEQ-NO      TO W-PNDB-SEQ-NO
  9853                                    W-PYAJ-FILE-SEQ-NO
  9854                                    W-CHEK-SEQ-NO.
  9855
  9856     IF  PI-689-CHG-SEQ-NO GREATER THAN ZEROS
  9857         MOVE PI-689-CHG-SEQ-NO  TO W-PNDB-CHG-SEQ-NO
  9858                                    W-PNDB2-ALT-CHG-SEQ-NO.
  9859
  9860     IF  PI-689-ENTRY-BATCH GREATER THAN LOW-VALUES
  9861         MOVE PI-689-ENTRY-BATCH TO W-PNDB-ENTRY.
  9862
  9863     IF  PI-689-NO-ERRORS-DETECTED
  9864         PERFORM 2000-CREATE THRU 2000-EXIT
  9865         IF  NOT PI-689-FATAL-ERROR
  9866                 AND
  9867             NOT PI-689-ERR-DETECTED-PREV
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 190
* EL689.cbl
  9868             IF  PI-689-PRINT-ONLY
  9869                 PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9870             ELSE
  9871                 IF  PI-689-PRINT-FIRST
  9872                     PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9873                     IF  NOT PI-689-FATAL-ERROR
  9874                         IF  PI-689-ARCHIVE-LETTER
  9875                             PERFORM 5400-LETTER-RELEASE
  9876                                 THRU 5400-EXIT
  9877                         ELSE
  9878                             MOVE ER-7390
  9879                                 TO PI-689-ERROR
  9880                     ELSE
  9881                         NEXT SENTENCE
  9882                 ELSE
  9883                     IF  NOT PI-689-ARCHIVE-LETTER
  9884                         MOVE ER-7390
  9885                                 TO PI-689-ERROR
  9886                     ELSE
  9887                         PERFORM 5400-LETTER-RELEASE
  9888                             THRU 5400-EXIT
  9889                         IF  NOT PI-689-FATAL-ERROR
  9890                             IF  PI-689-PRINT-SECOND
  9891                                 PERFORM 7900-PRINT-LETTER-NOW
  9892                                     THRU 7900-EXIT.
  9893
  9894 0600-EXIT.
  9895     EXIT.
  9896
  9897 0620-RETURN-TO-CALLER.
  9898
  9899     MOVE PROGRAM-INTERFACE-BLOCK
  9900                                 TO DFHCOMMAREA.
  9901
  9902* EXEC CICS RETURN
  9903*    END-EXEC.
  9904*    MOVE '.(                    ''   #00009681' TO DFHEIV0
  9905     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9906     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9907     MOVE X'2020233030303039363831' TO DFHEIV0(25:11)
  9908     CALL 'kxdfhei1' USING DFHEIV0,
  9909           DFHEIV99,
  9910           DFHEIV99,
  9911           DFHEIV99,
  9912           DFHEIV99,
  9913           DFHEIV99,
  9914           DFHEIV99
  9915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9916
  9917
  9918 0700-GET-VARIABLE-LABEL.
  9919
  9920     IF  PI-689-VARIABLE-DATA-1 NOT GREATER THAN SPACES
  9921         MOVE '(VARIABLE NOT PROVIDED)'
  9922                                 TO W-RC-TEXT (1)
  9923                                    W-VG-TEXT (48)
  9924         GO TO 0700-EXIT.
  9925
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 191
* EL689.cbl
  9926     MOVE PI-689-VARIABLE-DATA-1 TO W-RC-TEXT (1)
  9927                                    W-VG-TEXT (48).
  9928     MOVE PI-689-VARIABLE-DATA-2 TO W-RC-TEXT (2)
  9929                                    W-VG-TEXT (49).
  9930     MOVE PI-689-VARIABLE-DATA-3 TO W-RC-TEXT (3)
  9931                                    W-VG-TEXT (50).
  9932     MOVE PI-689-VARIABLE-DATA-4 TO W-RC-TEXT (4)
  9933                                    W-VG-TEXT (51).
  9934     SET W-RG-NDX                TO +5.
  9935
  9936 0700-EXIT.
  9937     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 192
* EL689.cbl
  9939 0800-EDIT-KEY-FIELDS.
  9940***************************************************************
  9941*     THIS ROUTINE WILL DECIDE WHAT FIELDS ARE NECESSARY      *
  9942*     FROM THE DATA SOURCE FIELD.  IF A NECESSARY FIELD       *
  9943*     IS NOT PROVIDED AN ERROR WILL PREVENT FURTHER           *
  9944*     PROCESSING.                                             *
  9945***************************************************************
  9946     MOVE SPACES                 TO W-CNTL-KEY
  9947     MOVE LOW-VALUES             TO W-ACCT-KEY
  9948                                    W-CERT-KEY
  9949                                    W-CHEK-KEY
  9950                                    W-COMP-KEY
  9951                                    W-MAIL-KEY
  9952                                    W-PNDB-KEY
  9953                                    W-PNDB2-KEY
  9954                                    W-PYAJ-KEY.
  9955
  9956     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9957     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  9958                                    W-CERT-COMPANY-CD
  9959                                    W-CHEK-COMPANY-CD
  9960                                    W-COMP-COMPANY-CD
  9961                                    W-MAIL-COMPANY-CD
  9962                                    W-PNDB-COMPANY-CD
  9963                                    W-PNDB2-COMPANY-CD
  9964                                    W-PYAJ-COMPANY-CD.
  9965
  9966     PERFORM 0900-EDIT-CARRIER THRU 0900-EXIT.
  9967     PERFORM 0905-EDIT-GROUPING THRU 0905-EXIT.
  9968     PERFORM 0910-EDIT-STATE THRU 0910-EXIT.
  9969     PERFORM 0915-EDIT-ACCOUNT THRU 0915-EXIT.
  9970     PERFORM 0920-EDIT-EXP-DATE THRU 0920-EXIT.
  9971     PERFORM 0925-EDIT-EFF-DATE THRU 0925-EXIT.
  9972     PERFORM 0930-EDIT-CERTIFICATE THRU 0930-EXIT.
  9973     PERFORM 0935-EDIT-RESP-PERSON THRU 0935-EXIT.
  9974     PERFORM 0940-EDIT-ACCOUNT THRU 0940-EXIT.
  9975     PERFORM 0945-EDIT-TYPE THRU 0945-EXIT.
  9976     PERFORM 0950-EDIT-ENTRY THRU 0950-EXIT.
  9977     PERFORM 0955-EDIT-SEQUENCE THRU 0955-EXIT.
  9978     PERFORM 0960-EDIT-BATCH-SEQ THRU 0960-EXIT.
  9979     PERFORM 0965-EDIT-TYPE THRU 0965-EXIT.
  9980     PERFORM 0970-EDIT-CSO THRU 0970-EXIT.
  9981
  9982     IF  DATASORI NUMERIC
  9983         MOVE DATASORI           TO W-DATA-SOURCE
  9984                                    PI-689-DATA-SOURCE
  9985         GO TO 0800-SOURCE-ACCOUNT
  9986               0800-SOURCE-CERTIFICATE
  9987               0800-SOURCE-COMPENSATION
  9988               0800-SOURCE-PENDING
  9989               0800-SOURCE-CHEK
  9990               0800-SOURCE-PAYMENTS-ADJS
  9991                                 DEPENDING ON W-DATA-SOURCE.
  9992
  9993     IF  FORMI NOT EQUAL '9999'
  9994         MOVE ER-7365            TO EMI-ERROR
  9995         MOVE -1                 TO MAINTL
  9996         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 193
* EL689.cbl
  9997         GO TO 8200-SEND-DATAONLY
  9998
  9999     ELSE
 10000         GO TO 0800-EXIT.
 10001
 10002 0800-SOURCE-ACCOUNT.
 10003
 10004     IF  W-ACCT-COMPANY-CD EQUAL LOW-VALUES
 10005             OR
 10006         W-ACCT-CARRIER EQUAL LOW-VALUES
 10007             OR
 10008         W-ACCT-GROUPING EQUAL LOW-VALUES
 10009             OR
 10010         W-ACCT-STATE EQUAL LOW-VALUES
 10011             OR
 10012         W-ACCT-ACCOUNT EQUAL LOW-VALUES
 10013             OR
 10014         W-ACCT-EXP-DT EQUAL LOW-VALUES
 10015         MOVE ER-7376            TO EMI-ERROR
 10016         MOVE -1                 TO MAINTL
 10017         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10018
 10019     GO TO 0800-ERROR-TEST.
 10020
 10021 0800-SOURCE-CERTIFICATE.
 10022
 10023     IF  W-CERT-COMPANY-CD EQUAL LOW-VALUES
 10024             OR
 10025         W-CERT-CARRIER EQUAL LOW-VALUES
 10026             OR
 10027         W-CERT-GROUPING EQUAL LOW-VALUES
 10028             OR
 10029         W-CERT-STATE EQUAL LOW-VALUES
 10030             OR
 10031         W-CERT-ACCOUNT EQUAL LOW-VALUES
 10032             OR
 10033         W-CERT-EFF-DT EQUAL LOW-VALUES
 10034             OR
 10035         W-CERT-CERT-NO EQUAL LOW-VALUES
 10036         MOVE ER-7377            TO EMI-ERROR
 10037         MOVE -1                 TO MAINTL
 10038         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10039
 10040     GO TO 0800-ERROR-TEST.
 10041
 10042 0800-SOURCE-COMPENSATION.
 10043
 10044     IF  W-COMP-COMPANY-CD EQUAL LOW-VALUES
 10045             OR
 10046         W-COMP-CARRIER EQUAL LOW-VALUES
 10047             OR
 10048         W-COMP-GROUPING EQUAL LOW-VALUES
 10049             OR
 10050         W-COMP-RESP-PERSON EQUAL LOW-VALUES
 10051             OR
 10052         W-COMP-TYPE EQUAL LOW-VALUES
 10053             OR
 10054         (W-COMP-TYPE EQUAL 'A'
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 194
* EL689.cbl
 10055                 AND
 10056             W-COMP-ACCOUNT EQUAL LOW-VALUES)
 10057         MOVE ER-7378            TO EMI-ERROR
 10058         MOVE -1                 TO MAINTL
 10059         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10060
 10061     GO TO 0800-ERROR-TEST.
 10062
 10063 0800-SOURCE-PENDING.
 10064
 10065     IF  BENTRYL EQUAL ZEROS
 10066         IF  W-PNDB2-COMPANY-CD EQUAL LOW-VALUES
 10067                 OR
 10068             W-PNDB2-CARRIER EQUAL LOW-VALUES
 10069                 OR
 10070             W-PNDB2-GROUPING EQUAL LOW-VALUES
 10071                 OR
 10072             W-PNDB2-STATE EQUAL LOW-VALUES
 10073                 OR
 10074             W-PNDB2-ACCOUNT EQUAL LOW-VALUES
 10075                 OR
 10076             W-PNDB2-EFF-DT EQUAL LOW-VALUES
 10077                 OR
 10078             W-PNDB2-CERT-NO EQUAL LOW-VALUES
 10079                 OR
 10080             W-PNDB2-TYPE EQUAL LOW-VALUES
 10081                 OR
 10082             W-PNDB2-ALT-CHG-SEQ-NO NOT = ZEROS
 10083             MOVE ER-7379        TO EMI-ERROR
 10084             MOVE -1             TO MAINTL
 10085             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10086         ELSE
 10087             NEXT SENTENCE
 10088     ELSE
 10089         IF  W-PNDB-COMPANY-CD EQUAL LOW-VALUES
 10090                 OR
 10091             W-PNDB-ENTRY EQUAL LOW-VALUES
 10092                 OR
 10093             W-PNDB-SEQ-NO EQUAL ZEROS
 10094             MOVE ER-7379        TO EMI-ERROR
 10095             MOVE -1             TO MAINTL
 10096             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10097
 10098     GO TO 0800-ERROR-TEST.
 10099
 10100 0800-SOURCE-CHEK.
 10101
 10102     IF  W-CHEK-COMPANY-CD EQUAL LOW-VALUES
 10103             OR
 10104         W-CHEK-CARRIER EQUAL LOW-VALUES
 10105             OR
 10106         W-CHEK-GROUPING EQUAL LOW-VALUES
 10107             OR
 10108         W-CHEK-STATE EQUAL LOW-VALUES
 10109             OR
 10110         W-CHEK-ACCOUNT EQUAL LOW-VALUES
 10111             OR
 10112         W-CHEK-EFF-DT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 195
* EL689.cbl
 10113             OR
 10114         W-CHEK-CERT-NO EQUAL LOW-VALUES
 10115         MOVE ER-7381            TO EMI-ERROR
 10116         MOVE -1                 TO MAINTL
 10117         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10118
 10119     GO TO 0800-ERROR-TEST.
 10120
 10121 0800-SOURCE-PAYMENTS-ADJS.
 10122
 10123     IF  W-PYAJ-COMPANY-CD EQUAL LOW-VALUES
 10124             OR
 10125         W-PYAJ-CARRIER EQUAL LOW-VALUES
 10126             OR
 10127         W-PYAJ-GROUPING EQUAL LOW-VALUES
 10128             OR
 10129         W-PYAJ-FIN-RESP EQUAL LOW-VALUES
 10130             OR
 10131         W-PYAJ-ACCOUNT EQUAL LOW-VALUES
 10132             OR
 10133         W-PYAJ-RECORD-TYPE EQUAL LOW-VALUES
 10134         MOVE ER-7396            TO EMI-ERROR
 10135         MOVE -1                 TO MAINTL
 10136         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10137
 10138     GO TO 0800-ERROR-TEST.
 10139
 10140 0800-ERROR-TEST.
 10141
 10142     IF  NOT EMI-NO-ERRORS
 10143         IF  EMI-ERROR EQUAL ER-7250
 10144             GO TO 0800-EXIT
 10145         ELSE
 10146             GO TO 8200-SEND-DATAONLY.
 10147
 10148 0800-EXIT.
 10149     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 196
* EL689.cbl
 10151 0900-EDIT-CARRIER.
 10152
 10153     IF  CARRIERL EQUAL ZEROES
 10154         MOVE LOW-VALUES         TO PI-689-CARRIER
 10155                                    W-ACCT-CARRIER
 10156                                    W-CERT-CARRIER
 10157                                    W-COMP-CARRIER
 10158                                    W-CHEK-CARRIER
 10159                                    W-MAIL-CARRIER
 10160                                    W-PNDB2-CARRIER
 10161                                    W-PYAJ-CARRIER
 10162     ELSE
 10163         PERFORM 0990-CARRIER-VALIDITY-CHECK THRU 0990-EXIT.
 10164
 10165 0900-EXIT.
 10166     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 197
* EL689.cbl
 10168 0905-EDIT-GROUPING.
 10169
 10170     IF  GROUPL EQUAL ZEROES
 10171         MOVE LOW-VALUES         TO PI-689-GROUPING
 10172                                    W-ACCT-GROUPING
 10173                                    W-CERT-GROUPING
 10174                                    W-CHEK-GROUPING
 10175                                    W-COMP-GROUPING
 10176                                    W-MAIL-GROUPING
 10177                                    W-PNDB2-GROUPING
 10178                                    W-PYAJ-GROUPING
 10179     ELSE
 10180         MOVE AL-UANON           TO GROUPA
 10181         MOVE GROUPI             TO PI-689-GROUPING
 10182                                    W-ACCT-GROUPING
 10183                                    W-CERT-GROUPING
 10184                                    W-CHEK-GROUPING
 10185                                    W-COMP-GROUPING
 10186                                    W-MAIL-GROUPING
 10187                                    W-PNDB2-GROUPING
 10188                                    W-PYAJ-GROUPING.
 10189
 10190 0905-EXIT.
 10191     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 198
* EL689.cbl
 10193 0910-EDIT-STATE.
 10194
 10195     IF  STATEL EQUAL ZEROES
 10196         MOVE LOW-VALUES         TO PI-689-STATE
 10197                                    W-ACCT-STATE
 10198                                    W-CERT-STATE
 10199                                    W-CHEK-STATE
 10200                                    W-MAIL-STATE
 10201                                    W-PNDB2-STATE
 10202     ELSE
 10203         PERFORM 0994-STATE-VALIDITY-CHECK THRU 0994-EXIT.
 10204
 10205 0910-EXIT.
 10206     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 199
* EL689.cbl
 10208 0915-EDIT-ACCOUNT.
 10209
 10210     IF  ACCTL EQUAL ZEROES
 10211         MOVE LOW-VALUES         TO PI-689-ACCOUNT
 10212                                    W-ACCT-ACCOUNT
 10213                                    W-CERT-ACCOUNT
 10214                                    W-CHEK-ACCOUNT
 10215                                    W-COMP-ACCOUNT
 10216                                    W-MAIL-ACCOUNT
 10217                                    W-PNDB2-ACCOUNT
 10218                                    W-PYAJ-ACCOUNT
 10219     ELSE
 10220         MOVE AL-UANON           TO ACCTA
 10221         MOVE ACCTI              TO PI-689-ACCOUNT
 10222                                    W-ACCT-ACCOUNT
 10223                                    W-CERT-ACCOUNT
 10224                                    W-CHEK-ACCOUNT
 10225                                    W-COMP-ACCOUNT
 10226                                    W-MAIL-ACCOUNT
 10227                                    W-PYAJ-ACCOUNT
 10228                                    W-PNDB2-ACCOUNT.
 10229
 10230 0915-EXIT.
 10231     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 200
* EL689.cbl
 10233 0920-EDIT-EXP-DATE.
 10234
 10235     IF  DATEL NOT EQUAL ZEROS
 10236         IF  DATEI EQUAL '99/99/99' OR '999999'
 10237             MOVE '99/99/99'     TO DATEO
 10238                                    PI-689-DATE-EDIT
 10239             MOVE AL-UANON       TO DATEA
 10240             MOVE HIGH-VALUES    TO PI-689-EXP-DATE
 10241                                    W-ACCT-EXP-DT
 10242         ELSE
 10243             MOVE DATEI          TO W-DEEDIT-FIELD
 10244             PERFORM 8600-DEEDIT
 10245             MOVE W-DEEDIT-FIELD-V0
 10246                                 TO DC-GREG-DATE-1-MDY
 10247             MOVE '4'            TO DC-OPTION-CODE
 10248             PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10249             IF  DATE-CONVERSION-ERROR
 10250                 MOVE ER-0454    TO EMI-ERROR
 10251                 MOVE -1         TO DATEL
 10252                 MOVE AL-UABON   TO DATEA
 10253                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10254             ELSE
 10255                 MOVE DC-GREG-DATE-1-EDIT
 10256                                 TO DATEO
 10257                                    PI-689-DATE-EDIT
 10258                 MOVE AL-UANON   TO DATEA
 10259                 MOVE DC-BIN-DATE-1
 10260                                 TO PI-689-EXP-DATE
 10261                                    W-ACCT-EXP-DT
 10262     ELSE
 10263         MOVE LOW-VALUES         TO PI-689-EXP-DATE
 10264                                    W-ACCT-EXP-DT
 10265                                    PI-689-DATE-EDIT.
 10266
 10267 0920-EXIT.
 10268     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 201
* EL689.cbl
 10270 0925-EDIT-EFF-DATE.
 10271
 10272     IF  CERTL EQUAL ZERO
 10273             AND
 10274         DATASORI NOT EQUAL '2'
 10275         GO TO 0925-EXIT.
 10276
 10277     IF  DATEL NOT EQUAL ZEROS
 10278         MOVE DATEI              TO W-DEEDIT-FIELD
 10279         PERFORM 8600-DEEDIT
 10280         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 10281         MOVE '4'                TO DC-OPTION-CODE
 10282         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10283
 10284         IF  DATE-CONVERSION-ERROR
 10285             MOVE ER-0215        TO EMI-ERROR
 10286             MOVE -1             TO DATEL
 10287             MOVE AL-UABON       TO DATEA
 10288             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10289         ELSE
 10290             MOVE DC-GREG-DATE-1-EDIT
 10291                                 TO DATEO
 10292                                    PI-689-DATE-EDIT
 10293             MOVE AL-UANON       TO DATEA
 10294             MOVE DC-BIN-DATE-1  TO PI-689-EFF-DATE
 10295                                    W-CERT-EFF-DT
 10296                                    W-CHEK-EFF-DT
 10297                                    W-MAIL-EFF-DT
 10298                                    W-PNDB2-EFF-DT
 10299     ELSE
 10300         MOVE LOW-VALUES         TO PI-689-EFF-DATE
 10301                                    W-PNDB2-EFF-DT
 10302                                    W-CHEK-EFF-DT
 10303                                    W-MAIL-EFF-DT
 10304                                    W-CERT-EFF-DT
 10305                                    PI-689-DATE-EDIT.
 10306
 10307 0925-EXIT.
 10308     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 202
* EL689.cbl
 10310 0930-EDIT-CERTIFICATE.
 10311
 10312     IF  CERTL EQUAL ZEROES
 10313         MOVE LOW-VALUES         TO PI-689-CERT-PRIME
 10314                                    W-CERT-CERT-PRIME
 10315                                    W-CHEK-CERT-PRIME
 10316                                    W-MAIL-CERT-PRIME
 10317                                    W-PNDB2-CERT-PRIME
 10318                                    PI-689-CERT-SFX
 10319                                    W-CERT-CERT-SFX
 10320                                    W-CHEK-CERT-SFX
 10321                                    W-MAIL-CERT-SFX
 10322                                    W-PNDB2-CERT-SFX
 10323     ELSE
 10324         MOVE AL-UANON           TO CERTA
 10325         MOVE CERTI              TO PI-689-CERT-PRIME
 10326                                    W-CERT-CERT-PRIME
 10327                                    W-CHEK-CERT-PRIME
 10328                                    W-MAIL-CERT-PRIME
 10329                                    W-PNDB2-CERT-PRIME
 10330         IF  SFXL EQUAL ZEROES
 10331                 OR
 10332             SFXI EQUAL LOW-VALUES
 10333             MOVE SPACES         TO PI-689-CERT-SFX
 10334                                    W-CERT-CERT-SFX
 10335                                    W-CHEK-CERT-SFX
 10336                                    W-MAIL-CERT-SFX
 10337                                    W-PNDB2-CERT-SFX
 10338         ELSE
 10339             MOVE AL-UANON       TO SFXA
 10340             MOVE SFXI           TO PI-689-CERT-SFX
 10341                                    W-CERT-CERT-SFX
 10342                                    W-CHEK-CERT-SFX
 10343                                    W-MAIL-CERT-SFX
 10344                                    W-PNDB2-CERT-SFX.
 10345
 10346 0930-EXIT.
 10347     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 203
* EL689.cbl
 10349 0935-EDIT-RESP-PERSON.
 10350
 10351     IF  RPERSONL EQUAL ZEROES
 10352         MOVE LOW-VALUES         TO PI-689-RESP-PERSON
 10353                                    W-COMP-RESP-PERSON
 10354                                    W-PYAJ-FIN-RESP
 10355     ELSE
 10356         MOVE AL-UANON           TO RPERSONA
 10357         MOVE RPERSONI           TO PI-689-RESP-PERSON
 10358                                    W-PYAJ-FIN-RESP
 10359                                    W-COMP-RESP-PERSON.
 10360
 10361 0935-EXIT.
 10362     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 204
* EL689.cbl
 10364 0940-EDIT-ACCOUNT.
 10365
 10366     IF  ACCTL EQUAL ZEROES
 10367         MOVE LOW-VALUES         TO PI-689-ACCOUNT
 10368                                    W-COMP-ACCOUNT
 10369                                    W-PYAJ-ACCOUNT
 10370     ELSE
 10371         MOVE AL-UANON           TO ACCTA
 10372         MOVE ACCTI              TO PI-689-ACCOUNT
 10373                                    W-PYAJ-ACCOUNT
 10374                                    W-COMP-ACCOUNT.
 10375
 10376 0940-EXIT.
 10377     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 205
* EL689.cbl
 10379 0945-EDIT-TYPE.
 10380
 10381     IF  TYPEL EQUAL ZEROES
 10382         MOVE LOW-VALUES         TO PI-689-TYPE
 10383                                    W-COMP-TYPE
 10384                                    W-PYAJ-RECORD-TYPE
 10385     ELSE
 10386         INSPECT TYPEI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
 10387         IF TYPEI = 'C' OR 'G' OR 'A'
 10388             MOVE AL-UANON       TO TYPEA
 10389             MOVE TYPEI          TO PI-689-TYPE
 10390                                    W-COMP-TYPE
 10391                                    W-PYAJ-RECORD-TYPE
 10392         ELSE
 10393             MOVE ER-7368        TO EMI-ERROR
 10394             MOVE -1             TO TYPEL
 10395             MOVE AL-UABON       TO TYPEA
 10396             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10397
 10398 0945-EXIT.
 10399     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 206
* EL689.cbl
 10401 0950-EDIT-ENTRY.
 10402
 10403     IF  BENTRYL EQUAL ZEROES
 10404         MOVE LOW-VALUES         TO PI-689-ENTRY-BATCH
 10405                                    W-PNDB-ENTRY
 10406     ELSE
 10407         MOVE AL-UANON           TO BENTRYA
 10408         MOVE BENTRYI            TO PI-689-ENTRY-BATCH
 10409                                    W-PNDB-ENTRY.
 10410
 10411 0950-EXIT.
 10412     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 207
* EL689.cbl
 10414 0955-EDIT-SEQUENCE.
 10415
 10416     IF  SEQL NOT EQUAL ZEROS
 10417         IF  SEQI NOT NUMERIC
 10418                 OR
 10419             SEQI EQUAL '0'
 10420             MOVE ER-7367        TO EMI-ERROR
 10421             MOVE -1             TO SEQL
 10422             MOVE AL-UABON       TO SEQA
 10423             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10424         ELSE
 10425             MOVE AL-UANON       TO SEQA
 10426             MOVE SEQI           TO PI-689-SEQ-NO
 10427                                    W-CHEK-SEQ-NO
 10428                                    W-PYAJ-FILE-SEQ-NO
 10429                                    W-PNDB-SEQ-NO
 10430                                    PI-689-SEQ-EDIT
 10431     ELSE
 10432         MOVE LOW-VALUES         TO PI-689-SEQ-EDIT.
 10433
 10434 0955-EXIT.
 10435     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 208
* EL689.cbl
 10437 0960-EDIT-BATCH-SEQ.
 10438
 10439     IF  BCSEQL NOT EQUAL ZEROS
 10440         IF  BCSEQI NOT NUMERIC
 10441             MOVE ER-7368        TO EMI-ERROR
 10442             MOVE -1             TO BCSEQL
 10443             MOVE AL-UABON       TO BCSEQA
 10444             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10445         ELSE
 10446             MOVE AL-UANON       TO BCSEQA
 10447             MOVE BCSEQI         TO PI-689-CHG-SEQ-NO
 10448                                    W-PNDB-CHG-SEQ-NO
 10449                                    W-PNDB2-ALT-CHG-SEQ-NO
 10450                                    PI-689-BCSEQ-EDIT
 10451     ELSE
 10452         MOVE LOW-VALUES         TO PI-689-BCSEQ-EDIT.
 10453
 10454 0960-EXIT.
 10455     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 209
* EL689.cbl
 10457 0965-EDIT-TYPE.
 10458
 10459     IF  TYPEL EQUAL ZEROES
 10460         MOVE LOW-VALUES         TO PI-689-TYPE
 10461                                    W-PNDB2-TYPE
 10462     ELSE
 10463         IF  DATASORI NOT EQUAL '4'
 10464             GO TO 0965-EXIT
 10465         ELSE
 10466             IF TYPEI = '0' OR '1' OR '2' OR '3'
 10467                 MOVE AL-UANON   TO TYPEA
 10468                 MOVE TYPEI      TO PI-689-TYPE
 10469                                    W-PNDB2-TYPE
 10470             ELSE
 10471                 MOVE ER-7370    TO EMI-ERROR
 10472                 MOVE -1         TO TYPEL
 10473                 MOVE AL-UABON   TO TYPEA
 10474                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10475
 10476 0965-EXIT.
 10477     EXIT.
 10478
 10479 0970-EDIT-CSO.
 10480
 10481     IF ENDARCHL > ZEROS
 10482        IF ENDARCHI NUMERIC
 10483            MOVE ENDARCHI       TO PI-ENDT-ARCH-NO
 10484            MOVE AL-UNNON       TO ENDARCHA
 10485            MOVE ENDARCHI       TO W-ERENDT-ARCHIVE
 10486            MOVE PI-COMPANY-CD  TO W-ERENDT-COMPANY-CD-A1
 10487            MOVE 'N'            TO W-VALID-ENDT-SW
 10488            PERFORM 0355-CHECK-ERENDT THRU 0355-EXIT
 10489            IF NOT W-VALID-ENDT
 10490                MOVE -1         TO ENDARCHL
 10491                MOVE ER-1565    TO EMI-ERROR
 10492                MOVE AL-UNBON   TO ENDARCHA
 10493                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10494            END-IF
 10495        END-IF
 10496     ELSE
 10497        MOVE ZEROS              TO PI-ENDT-ARCH-NO
 10498     END-IF
 10499
 10500     IF PI-CERT-REQ-IND = 'Y'
 10501       IF  CERTIDL NOT EQUAL ZEROS
 10502         IF CERTIDI NUMERIC
 10503             MOVE AL-UANON      TO CERTIDA
 10504             MOVE CERTIDI       TO PI-CERT-FORM-ID
 10505         ELSE
 10506             MOVE ER-1778       TO EMI-ERROR
 10507             MOVE -1            TO CERTIDL
 10508             MOVE AL-UABON      TO CERTIDA
 10509             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10510         END-IF
 10511       ELSE
 10512          MOVE ER-0715       TO EMI-ERROR
 10513          MOVE -1            TO CERTIDL
 10514          MOVE AL-UABON      TO CERTIDA
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 210
* EL689.cbl
 10515          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10516       END-IF
 10517     END-IF.
 10518
 10519 0970-EXIT.
 10520      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 211
* EL689.cbl
 10522 0990-CARRIER-VALIDITY-CHECK.
 10523
 10524     IF  CARRIERI EQUAL SPACES
 10525         GO TO 0990-EXIT.
 10526
 10527     MOVE SPACES                 TO W-CNTL-KEY.
 10528     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10529     MOVE '6'                    TO W-CNTL-RECORD-TYPE.
 10530     MOVE CARRIERI               TO W-CNTL-GEN4.
 10531     MOVE +0                     TO W-CNTL-SEQ-NO.
 10532
 10533
 10534* EXEC CICS HANDLE CONDITION
 10535*        NOTFND  (0990-CARRIER-NOT-FOUND)
 10536*        NOTOPEN (8040-CNTL-NOT-OPEN)
 10537*    END-EXEC.
 10538*    MOVE '"$IJ                  ! & #00010299' TO DFHEIV0
 10539     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
 10540     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10541     MOVE X'2620233030303130323939' TO DFHEIV0(25:11)
 10542     CALL 'kxdfhei1' USING DFHEIV0
 10543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10544
 10545
 10546
 10547* EXEC CICS READ
 10548*        DATASET (W-CNTL-FILE-ID)
 10549*        SET     (ADDRESS OF CONTROL-FILE)
 10550*        RIDFLD  (W-CNTL-KEY)
 10551*    END-EXEC.
 10552*    MOVE '&"S        E          (   #00010304' TO DFHEIV0
 10553     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10554     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10555     MOVE X'2020233030303130333034' TO DFHEIV0(25:11)
 10556     CALL 'kxdfhei1' USING DFHEIV0,
 10557           W-CNTL-FILE-ID,
 10558           DFHEIV20,
 10559           DFHEIV99,
 10560           W-CNTL-KEY,
 10561           DFHEIV99,
 10562           DFHEIV99,
 10563           DFHEIV99
 10564     SET ADDRESS OF CONTROL-FILE TO
 10565         DFHEIV20
 10566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10567
 10568
 10569     IF  PI-NO-CARRIER-SECURITY
 10570             OR
 10571         PI-CARRIER-SECURITY EQUAL CARRIERI
 10572         MOVE AL-UANON           TO CARRIERA
 10573         MOVE CARRIERI           TO PI-689-CARRIER
 10574                                    W-ACCT-CARRIER
 10575                                    W-CERT-CARRIER
 10576                                    W-CHEK-CARRIER
 10577                                    W-COMP-CARRIER
 10578                                    W-MAIL-CARRIER
 10579                                    W-PNDB2-CARRIER
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 212
* EL689.cbl
 10580                                    W-PYAJ-CARRIER
 10581     ELSE
 10582         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
 10583         MOVE ER-9095            TO EMI-ERROR
 10584         MOVE -1                 TO MAINTL
 10585         MOVE AL-UANON           TO MAINTA
 10586         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10587
 10588     GO TO 0990-EXIT.
 10589
 10590 0990-CARRIER-NOT-FOUND.
 10591
 10592     MOVE -1                     TO CARRIERL.
 10593     MOVE AL-UABON               TO CARRIERA.
 10594     MOVE ER-2208                TO EMI-ERROR.
 10595     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10596
 10597 0990-EXIT.
 10598     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 213
* EL689.cbl
 10600 0994-STATE-VALIDITY-CHECK.
 10601
 10602     IF  STATEI EQUAL SPACES
 10603         GO TO 0994-EXIT.
 10604
 10605     MOVE SPACES                 TO W-CNTL-KEY.
 10606     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10607     MOVE '3'                    TO W-CNTL-RECORD-TYPE.
 10608     MOVE STATEI                 TO W-CNTL-GEN1.
 10609     MOVE +0                     TO W-CNTL-SEQ-NO.
 10610
 10611
 10612* EXEC CICS HANDLE CONDITION
 10613*        NOTFND  (0994-STATE-NOT-FOUND)
 10614*        NOTOPEN (8040-CNTL-NOT-OPEN)
 10615*    END-EXEC.
 10616*    MOVE '"$IJ                  ! '' #00010352' TO DFHEIV0
 10617     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
 10618     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10619     MOVE X'2720233030303130333532' TO DFHEIV0(25:11)
 10620     CALL 'kxdfhei1' USING DFHEIV0
 10621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10622
 10623
 10624
 10625* EXEC CICS READ
 10626*        DATASET (W-CNTL-FILE-ID)
 10627*        SET     (ADDRESS OF CONTROL-FILE)
 10628*        RIDFLD  (W-CNTL-KEY)
 10629*    END-EXEC.
 10630*    MOVE '&"S        E          (   #00010357' TO DFHEIV0
 10631     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10632     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10633     MOVE X'2020233030303130333537' TO DFHEIV0(25:11)
 10634     CALL 'kxdfhei1' USING DFHEIV0,
 10635           W-CNTL-FILE-ID,
 10636           DFHEIV20,
 10637           DFHEIV99,
 10638           W-CNTL-KEY,
 10639           DFHEIV99,
 10640           DFHEIV99,
 10641           DFHEIV99
 10642     SET ADDRESS OF CONTROL-FILE TO
 10643         DFHEIV20
 10644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10645
 10646
 10647     MOVE AL-UANON               TO STATEA.
 10648     MOVE STATEI                 TO PI-689-STATE
 10649                                    W-ACCT-STATE
 10650                                    W-CERT-STATE
 10651                                    W-CHEK-STATE
 10652                                    W-MAIL-STATE
 10653                                    W-PNDB2-STATE.
 10654
 10655     GO TO 0994-EXIT.
 10656
 10657 0994-STATE-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 214
* EL689.cbl
 10658
 10659     MOVE -1                     TO STATEL.
 10660     MOVE AL-UABON               TO STATEA.
 10661     MOVE ER-2209                TO EMI-ERROR.
 10662     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10663
 10664 0994-EXIT.
 10665     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 215
* EL689.cbl
 10667 1000-SHOW.
 10668***************************************************************
 10669*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
 10670*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN.  IF THE       *
 10671*     HEADER RECORD IS FOUND THE TEXT IS THEN READ AND        *
 10672*     WILL BE INSERTED INTO THE W-TS-TABLE AND DISPLAYED.     *
 10673***************************************************************
 10674
 10675     MOVE SPACES                 TO W-RECORD-TABLE.
 10676
 10677     IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 10678          MOVE PI-689-LBL-OVERRIDE
 10679                                 TO ADDRLBLI
 10680          MOVE +1                TO ADDRLBLL
 10681          MOVE AL-UANON          TO ADDRLBLA
 10682     ELSE
 10683          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 10684          MOVE +1                TO ADDRLBLL
 10685          MOVE AL-UANON          TO ADDRLBLA.
 10686
 10687     IF  ARCHNUML EQUAL ZEROS
 10688         MOVE -1                 TO ARCHNUML
 10689         MOVE AL-UNBON           TO ARCHNUMA
 10690         MOVE ER-0174            TO EMI-ERROR
 10691         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10692         GO TO 8200-SEND-DATAONLY.
 10693
 10694     IF  ARCHNUMI NOT NUMERIC
 10695         MOVE -1                 TO ARCHNUML
 10696         MOVE AL-UNBON           TO ARCHNUMA
 10697         MOVE ER-0175            TO EMI-ERROR
 10698         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10699         GO TO 8200-SEND-DATAONLY.
 10700
 10701     IF  PI-SHOW-MODE
 10702
 10703         IF  PI-689-ARCHIVE-NUMBER EQUAL ARCHNUMI
 10704             MOVE -1             TO MAINTL
 10705             GO TO 8200-SEND-DATAONLY
 10706         ELSE
 10707             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT.
 10708
 10709     MOVE +0                     TO W-ARCH-SEQ-NO
 10710                                    W-ARCT-SEQ-NO.
 10711     MOVE PI-COMPANY-CD          TO W-ARCH-COMPANY-CD
 10712                                    W-ARCT-COMPANY-CD.
 10713     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 10714                                    W-ARCT-NUMBER
 10715                                    PI-689-ARCHIVE-NUMBER.
 10716     MOVE ' '                    TO W-ARCT-REC-TYPE.
 10717     MOVE '1'                    TO PI-ACTION.
 10718     MOVE SPACES                 TO PI-689-PRINT-SW
 10719                                    PI-689-FORM-NUMBER
 10720                                    W-DELETE-KEY.
 10721     SET W-RG-NDX                TO W-ZEROS.
 10722
 10723
 10724* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 216
* EL689.cbl
 10725*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 10726*         NOTFND     (1070-ARCH-NOT-FOUND)
 10727*         ENDFILE    (1070-ARCH-NOT-FOUND)
 10728*    END-EXEC.
 10729*    MOVE '"$JI''                 ! ( #00010439' TO DFHEIV0
 10730     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 10731     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10732     MOVE X'2820233030303130343339' TO DFHEIV0(25:11)
 10733     CALL 'kxdfhei1' USING DFHEIV0
 10734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10735
 10736
 10737
 10738* EXEC CICS READ
 10739*        DATASET (W-ARCH-FILE-ID)
 10740*        SET     (ADDRESS OF LETTER-ARCHIVE)
 10741*        RIDFLD  (W-ARCH-KEY)
 10742*    END-EXEC.
 10743*    MOVE '&"S        E          (   #00010445' TO DFHEIV0
 10744     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10745     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10746     MOVE X'2020233030303130343435' TO DFHEIV0(25:11)
 10747     CALL 'kxdfhei1' USING DFHEIV0,
 10748           W-ARCH-FILE-ID,
 10749           DFHEIV20,
 10750           DFHEIV99,
 10751           W-ARCH-KEY,
 10752           DFHEIV99,
 10753           DFHEIV99,
 10754           DFHEIV99
 10755     SET ADDRESS OF LETTER-ARCHIVE TO
 10756         DFHEIV20
 10757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10758
 10759
 10760     PERFORM 1040-FORMAT-HEADER-DATA THRU 1040-EXIT.
 10761
 10762*    EXEC CICS HANDLE CONDITION
 10763*         NOTOPEN    (8015-ARCT-NOT-OPEN)
 10764*         NOTFND     (1020-ARCT-ENDBR)
 10765*         ENDFILE    (1020-ARCT-ENDBR)
 10766*    END-EXEC.
 10767*
 10768*1005-START-BROWSE.
 10769*
 10770*    EXEC CICS STARTBR
 10771*         DATASET    (W-ARCT-FILE-ID)
 10772*         RIDFLD     (W-ARCT-KEY)
 10773*         GTEQ
 10774*    END-EXEC.
 10775*
 10776*    MOVE 'Y'                    TO W-ARCT-BROWSE-STARTED.
 10777*
 10778*1010-READ-NEXT.
 10779*
 10780*    EXEC CICS READNEXT
 10781*         SET       (ADDRESS OF LETTER-ARCHIVE-TEXT)
 10782*         DATASET   (W-ARCT-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 217
* EL689.cbl
 10783*         RIDFLD    (W-ARCT-KEY)
 10784*    END-EXEC.
 10785*
 10786*    IF  W-ARCH-PARTIAL-KEY EQUAL W-ARCT-PARTIAL-KEY
 10787*        IF  LT-ADDRESS-DATA
 10788*            IF  PI-CREATE-LABELS  AND
 10789*                NOT PI-689-LABELS-OVERRIDEN
 10790*                PERFORM 1050-MOVE-LABELS THRU 1050-EXIT
 10791*                        VARYING
 10792*                    LT-NDX FROM 1 BY 1
 10793*                        UNTIL
 10794*                    LT-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 10795*                GO TO 1010-READ-NEXT
 10796*            ELSE
 10797*                MOVE LT-CONTROL-PRIMARY
 10798*                                TO W-DELETE-KEY
 10799*                GO TO 1010-READ-NEXT
 10800*        ELSE
 10801*            PERFORM 1030-TEXT-BUILD THRU 1030-EXIT
 10802*                    VARYING
 10803*                LT-NDX FROM 1 BY 1
 10804*                    UNTIL
 10805*                LT-NDX GREATER THAN LT-NUM-LINES-ON-RECORD
 10806*                    OR
 10807*                LT-NDX GREATER THAN +20
 10808*            GO TO 1010-READ-NEXT.
 10809*
 10810*1020-ARCT-ENDBR.
 10811*
 10812*    IF  W-ARCT-BROWSE-STARTED EQUAL 'Y'
 10813*        EXEC CICS ENDBR
 10814*             DATASET   (W-ARCT-FILE-ID)
 10815*        END-EXEC.
 10816*
 10817*    IF  W-RG-NDX EQUAL ZEROS
 10818*        GO TO 1080-ARCHIVE-TEXT-NOT-FOUND.
 10819*
 10820*    IF  PI-689-NUMBER-LABEL-LINES GREATER THAN +0
 10821*            AND
 10822*        PI-BYPASS-LABELS
 10823*        MOVE W-DELETE-KEY       TO W-ARCT-KEY
 10824*        PERFORM 1060-DELETE-ADDRESS-RECORD THRU 1060-EXIT
 10825*        MOVE +0                 TO PI-689-NUMBER-LABEL-LINES.
 10826*
 10827*    SET PI-TOTAL-LINES          TO W-RG-NDX.
 10828*    MOVE 1                      TO PI-CURRENT-LINE.
 10829*    SET W-RG-NDX                TO +1.
 10830*
 10831*    PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10832*            VARYING
 10833*        W-SC-NDX FROM 1 BY 1
 10834*            UNTIL
 10835*        W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 10836
 10837     MOVE -1                     TO MAINTL.
 10838     GO TO 8100-SEND-INITIAL-MAP.
 10839
 10840 1020-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 218
* EL689.cbl
 10841     EXIT.
 10842
 10843 1030-TEXT-BUILD.
 10844
 10845     SET W-RG-NDX UP BY 1.
 10846     MOVE LT-SKIP-CONTROL (LT-NDX)
 10847                                 TO W-PRINT-CONTROL.
 10848
 10849     IF  W-PRINT-CONTROL EQUAL 99
 10850         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 10851         SET W-RG-NDX UP BY 1
 10852     ELSE
 10853         SET W-RG-NDX UP BY W-PRINT-CONTROL.
 10854
 10855     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 10856     MOVE LT-SKIP-CONTROL (LT-NDX)
 10857                                 TO W-RC-PC (W-RG-NDX).
 10858     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 10859
 10860 1030-EXIT.
 10861     EXIT.
 10862
 10863 1040-FORMAT-HEADER-DATA.
 10864
 10865     MOVE LA-ACCOUNT-A2          TO ACCTO.
 10866     MOVE LA-ADDR-SOURCE         TO ADDRSO.
 10867     MOVE LA-CARRIER-A2          TO CARRIERO.
 10868     MOVE LA-CERT-NO-A2          TO CERTO.
 10869     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
 10870     MOVE LA-DATA-SOURCE         TO DATASORO.
 10871
 10872     IF  LA-EFFECT-DATE-A2 EQUAL LOW-VALUES
 10873         MOVE ZEROES             TO DATEO
 10874
 10875     ELSE
 10876         MOVE LA-EFFECT-DATE-A2  TO DC-BIN-DATE-1
 10877         MOVE ' '                TO DC-OPTION-CODE
 10878         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10879         MOVE DC-GREG-DATE-1-EDIT
 10880                                 TO DATEO.
 10881
 10882     IF  LA-FOLLOW-UP-DATE EQUAL LOW-VALUES
 10883         MOVE ZEROES             TO FOLLOWO
 10884     ELSE
 10885         MOVE LA-FOLLOW-UP-DATE  TO DC-BIN-DATE-1
 10886         MOVE ' '                TO DC-OPTION-CODE
 10887         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10888         MOVE DC-GREG-DATE-1-EDIT
 10889                                 TO FOLLOWO.
 10890
 10891     MOVE LA-FORM-A3             TO FORMO.
 10892     MOVE LA-GROUPING-A2         TO GROUPO.
 10893     MOVE LA-NO-OF-COPIES        TO COPIESO
 10894                                    PI-689-NUMBER-COPIES.
 10895
 10896*    IF LA-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
 10897*        MOVE LA-PRINT-RESTRICTION
 10898*                                TO PRTRESTO
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 219
* EL689.cbl
 10899*    ELSE
 10900*        MOVE SPACES             TO PRTRESTO.
 10901
 10902     IF  LA-RESEND-DATE = LOW-VALUES
 10903         MOVE ZEROES             TO RESEND1O
 10904     ELSE
 10905         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
 10906         MOVE ' '                TO DC-OPTION-CODE
 10907         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10908         MOVE DC-GREG-DATE-1-EDIT
 10909                                 TO RESEND1O.
 10910
 10911     MOVE LA-STATE-A2            TO STATEO.
 10912
 10913     MOVE LA-NUMBER-LABEL-LINES  TO PI-689-NUMBER-LABEL-LINES.
 10914
 10915 1040-EXIT.
 10916     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 220
* EL689.cbl
 10918 1050-MOVE-LABELS.
 10919
 10920     SET W-RG-NDX                TO LT-NDX.
 10921     MOVE ZEROS                  TO W-RC-PC (W-RG-NDX).
 10922     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 10923     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 10924
 10925 1050-EXIT.
 10926     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 221
* EL689.cbl
 10928 1060-DELETE-ADDRESS-RECORD.
 10929
 10930
 10931* EXEC CICS DELETE
 10932*        DATASET (W-ARCT-FILE-ID)
 10933*        RIDFLD  (W-DELETE-KEY)
 10934*    END-EXEC.
 10935*    MOVE '&(  R                 &   #00010621' TO DFHEIV0
 10936     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 10937     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10938     MOVE X'2020233030303130363231' TO DFHEIV0(25:11)
 10939     CALL 'kxdfhei1' USING DFHEIV0,
 10940           W-ARCT-FILE-ID,
 10941           W-DELETE-KEY,
 10942           DFHEIV99,
 10943           DFHEIV99,
 10944           DFHEIV99
 10945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10946
 10947
 10948
 10949* EXEC CICS READ
 10950*        DATASET (W-ARCH-FILE-ID)
 10951*        SET     (ADDRESS OF LETTER-ARCHIVE)
 10952*        RIDFLD  (W-ARCH-KEY)
 10953*        UPDATE
 10954*    END-EXEC.
 10955*    MOVE '&"S        EU         (   #00010626' TO DFHEIV0
 10956     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10957     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10958     MOVE X'2020233030303130363236' TO DFHEIV0(25:11)
 10959     CALL 'kxdfhei1' USING DFHEIV0,
 10960           W-ARCH-FILE-ID,
 10961           DFHEIV20,
 10962           DFHEIV99,
 10963           W-ARCH-KEY,
 10964           DFHEIV99,
 10965           DFHEIV99,
 10966           DFHEIV99
 10967     SET ADDRESS OF LETTER-ARCHIVE TO
 10968         DFHEIV20
 10969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10970
 10971
 10972     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES.
 10973
 10974
 10975* EXEC CICS REWRITE
 10976*         FROM      (LETTER-ARCHIVE)
 10977*         DATASET   (W-ARCH-FILE-ID)
 10978*    END-EXEC.
 10979     MOVE LENGTH OF
 10980      LETTER-ARCHIVE
 10981       TO DFHEIV11
 10982*    MOVE '&& L                  %   #00010635' TO DFHEIV0
 10983     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10984     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10985     MOVE X'2020233030303130363335' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 222
* EL689.cbl
 10986     CALL 'kxdfhei1' USING DFHEIV0,
 10987           W-ARCH-FILE-ID,
 10988           LETTER-ARCHIVE,
 10989           DFHEIV11,
 10990           DFHEIV99
 10991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10992
 10993
 10994 1060-EXIT.
 10995     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 223
* EL689.cbl
 10997 1070-ARCH-NOT-FOUND.
 10998
 10999     MOVE ER-7371                TO EMI-ERROR.
 11000     MOVE -1                     TO ARCHNUML.
 11001     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11002     GO TO 8100-SEND-INITIAL-MAP.
 11003
 11004 1080-ARCHIVE-TEXT-NOT-FOUND.
 11005
 11006     MOVE ER-7372                TO EMI-ERROR.
 11007     MOVE -1                     TO ARCHNUML.
 11008     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11009     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 224
* EL689.cbl
 11011 2000-CREATE.
 11012***************************************************************
 11013*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
 11014*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
 11015*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
 11016*    WILL BE DISPLAYED ON THE SCREEN.                         *
 11017*                                                             *
 11018***************************************************************
 11019
 11020***************************************************************
 11021*    CHECK TO SEE IF IT IS THE SAME REQUEST OR NOT.           *
 11022*    IF IT IS A NEW REQUEST AND A LETTER WAS PRINTED          *
 11023*    THEN FORCE AN ERROR.                                     *
 11024***************************************************************
 11025
 11026     IF  PI-689-CREATE-NO-SCREENS
 11027         GO TO 2000-GET-TEXT.
 11028
 11029     IF  PI-CREATE-MODE
 11030         IF  PI-689-PRINT-PERFORMED
 11031                 AND
 11032             FORMI NOT EQUAL 9999
 11033             MOVE ER-0279    TO EMI-ERROR
 11034             MOVE -1         TO MAINTL
 11035             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11036             GO TO 8200-SEND-DATAONLY.
 11037
 11038     IF  ARCHNUML GREATER THAN ZEROS
 11039         MOVE ER-9320            TO EMI-ERROR
 11040         MOVE -1                 TO ARCHNUML
 11041         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11042         GO TO 8200-SEND-DATAONLY.
 11043
 11044***************************************************************
 11045*    IF  A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE     *
 11046*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
 11047***************************************************************
 11048
 11049     IF  FORMI EQUAL '9999'
 11050         MOVE 16                 TO PI-TOTAL-LINES
 11051         MOVE 1                  TO PI-CURRENT-LINE
 11052         MOVE SPACES             TO W-FILE-TABLE
 11053                                    W-LINE-CONTROL-RECORD
 11054                                    W-RECORD-TABLE
 11055                                    W-SINGLE-LINE
 11056                                    W-SQUEEZED-LINE
 11057                                    W-TS-WORK-AREA
 11058                                    W-TX-TABLE
 11059         PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 11060         MOVE '3'                TO PI-ACTION
 11061         MOVE FORMI              TO PI-689-FORM-NUMBER
 11062                                    PI-COMM-CONTROL
 11063         MOVE ZEROS              TO PI-UPDATE-SW
 11064         MOVE W-PGM-EL1042       TO W-CALL-PGM
 11065         GO TO 9400-XCTL.
 11066
 11067 2000-GET-TEXT.
 11068
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 225
* EL689.cbl
 11069     MOVE SPACES                 TO W-FILE-TABLE
 11070                                    W-LINE-CONTROL-RECORD
 11071                                    W-RECORD-TABLE
 11072                                    W-SINGLE-LINE
 11073                                    W-SQUEEZED-LINE
 11074                                    W-TS-WORK-AREA
 11075                                    W-TX-TABLE.
 11076     SET W-TG-NDX                TO +1
 11077     MOVE ZEROS                  TO W-INITIAL-COLUMN
 11078                                    W-LINE-COUNT
 11079                                    W-LINE-INDENT-1
 11080                                    W-LINE-INDENT-2
 11081                                    W-LINE-INDENT-3
 11082                                    W-LINE-INDENT-4
 11083                                    W-LINE-INDENT-5
 11084                                    W-PAGE
 11085                                    W-PARAGRAPH-INDENT
 11086                                    W-TOP-MARGIN
 11087                                    W-WORK-INDENT.
 11088     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
 11089     MOVE +70                    TO W-LAST-COLUMN.
 11090     MOVE +56                    TO W-MAX-LINES-PER-PAGE.
 11091     MOVE +1                     TO W-START-COLUMN.
 11092     MOVE +71                    TO W-TOO-FAR.
 11093
 11094     MOVE PI-COMPANY-CD          TO W-TEXT-COMPANY-CD.
 11095     MOVE FORMI                  TO W-TEXT-LETTER.
 11096     MOVE W-TEXT-PARTIAL-KEY     TO W-TEXT-SAVE-KEY.
 11097     MOVE 'N'                    TO W-TEXT-BROWSED-SW.
 11098
 11099
 11100* EXEC CICS HANDLE CONDITION
 11101*         NOTFND     (2001-NOT-FOUND)
 11102*         ENDFILE    (2001-NOT-FOUND)
 11103*         NOTOPEN    (8050-TEXT-NOT-OPEN)
 11104*    END-EXEC.
 11105*    MOVE '"$I''J                 ! ) #00010745' TO DFHEIV0
 11106     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
 11107     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11108     MOVE X'2920233030303130373435' TO DFHEIV0(25:11)
 11109     CALL 'kxdfhei1' USING DFHEIV0
 11110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11111
 11112
 11113
 11114* EXEC CICS STARTBR
 11115*         DATASET    (W-TEXT-FILE-ID)
 11116*         RIDFLD     (W-TEXT-KEY)
 11117*         GTEQ
 11118*    END-EXEC.
 11119     MOVE 0
 11120       TO DFHEIV11
 11121*    MOVE '&,         G          &   #00010751' TO DFHEIV0
 11122     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11123     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11124     MOVE X'2020233030303130373531' TO DFHEIV0(25:11)
 11125     CALL 'kxdfhei1' USING DFHEIV0,
 11126           W-TEXT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 226
* EL689.cbl
 11127           W-TEXT-KEY,
 11128           DFHEIV99,
 11129           DFHEIV11,
 11130           DFHEIV99
 11131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11132
 11133
 11134
 11135* EXEC CICS HANDLE CONDITION
 11136*         ENDFILE    (2000-ENDBR)
 11137*    END-EXEC.
 11138*    MOVE '"$''                   ! * #00010757' TO DFHEIV0
 11139     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 11140     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11141     MOVE X'2A20233030303130373537' TO DFHEIV0(25:11)
 11142     CALL 'kxdfhei1' USING DFHEIV0
 11143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11144
 11145
 11146 2000-READ-NEXT.
 11147
 11148     IF  W-TG-NDX GREATER THAN W-MAX-LINES
 11149         MOVE ER-0051            TO EMI-ERROR
 11150         MOVE -1                 TO MAINTL
 11151         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11152         GO TO 2000-ENDBR.
 11153
 11154
 11155* EXEC CICS READNEXT
 11156*         DATASET    (W-TEXT-FILE-ID)
 11157*         SET        (ADDRESS OF TEXT-FILES)
 11158*         RIDFLD     (W-TEXT-KEY)
 11159*    END-EXEC.
 11160     MOVE 0
 11161       TO DFHEIV11
 11162*    MOVE '&.S                   )   #00010769' TO DFHEIV0
 11163     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11164     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11165     MOVE X'2020233030303130373639' TO DFHEIV0(25:11)
 11166     CALL 'kxdfhei1' USING DFHEIV0,
 11167           W-TEXT-FILE-ID,
 11168           DFHEIV20,
 11169           DFHEIV99,
 11170           W-TEXT-KEY,
 11171           DFHEIV99,
 11172           DFHEIV11,
 11173           DFHEIV99,
 11174           DFHEIV99
 11175     SET ADDRESS OF TEXT-FILES TO
 11176         DFHEIV20
 11177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11178
 11179
 11180     IF  W-TEXT-PARTIAL-KEY NOT EQUAL W-TEXT-SAVE-KEY
 11181         GO TO 2000-ENDBR.
 11182
 11183     MOVE 'Y'                    TO W-TEXT-BROWSED-SW.
 11184
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 227
* EL689.cbl
 11185     MOVE TX-FORM-SQUEEZE-CONTROL
 11186                                 TO W-FORM-SQUEEZE-IND.
 11187
 11188     IF  PI-689-ARCHIVE-SW NOT GREATER THAN SPACES
 11189         MOVE TX-ARCHIVE-SW      TO PI-689-ARCHIVE-SW.
 11190
 11191     IF  TX-FORM-CONTROL-LINE
 11192         PERFORM 2100-PROCESS-FORM-CONTROL-LINE THRU 2100-EXIT
 11193         GO TO 2000-READ-NEXT.
 11194
 11195     IF  TX-LINE-SQUEEZE-CONTROL EQUAL 'Z'
 11196         PERFORM 2150-PROCESS-Z-CONTROLS THRU 2150-EXIT
 11197         GO TO 2000-READ-NEXT.
 11198
 11199     MOVE TX-TEXT-LINE           TO W-TX-TEXT (W-TG-NDX).
 11200     MOVE TX-PROCESS-CONTROL     TO W-TX-PC (W-TG-NDX).
 11201     PERFORM 2200-CHECK-FOR-VARIABLE THRU 2200-EXIT.
 11202     MOVE TX-LINE-SQUEEZE-CONTROL
 11203                                 TO W-TX-SC (W-TG-NDX).
 11204
 11205     SET W-TG-NDX UP BY 1.
 11206     GO TO 2000-READ-NEXT.
 11207
 11208 2000-ENDBR.
 11209
 11210
 11211* EXEC CICS ENDBR
 11212*        DATASET     (W-TEXT-FILE-ID)
 11213*    END-EXEC.
 11214     MOVE 0
 11215       TO DFHEIV11
 11216*    MOVE '&2                    $   #00010805' TO DFHEIV0
 11217     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11218     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11219     MOVE X'2020233030303130383035' TO DFHEIV0(25:11)
 11220     CALL 'kxdfhei1' USING DFHEIV0,
 11221           W-TEXT-FILE-ID,
 11222           DFHEIV11,
 11223           DFHEIV99
 11224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11225
 11226
 11227     IF  W-TEXT-BROWSE-NOT-STARTED
 11228         MOVE ER-0006            TO EMI-ERROR
 11229         MOVE -1                 TO FORML
 11230         MOVE AL-UABON           TO FORMA
 11231         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11232         GO TO 8350-SEND-DATAONLY-ERASEAUP.
 11233
 11234     SET  W-TOTAL-TX-LINES       TO W-TG-NDX.
 11235     SUBTRACT +1 FROM W-TOTAL-TX-LINES.
 11236     MOVE 1                      TO PI-CURRENT-LINE.
 11237
 11238     IF  COPIESL NOT GREATER THAN ZEROS
 11239         MOVE +1                 TO COPIESI
 11240                                    PI-689-NUMBER-COPIES
 11241         MOVE +1                 TO COPIESL
 11242         MOVE AL-UNNON           TO COPIESA.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 228
* EL689.cbl
 11243
 11244***************************************************************
 11245*    IF IT IS A FORM WITH VARIABLES, THEN RESOLVE ALL OF      *
 11246*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
 11247***************************************************************
 11248
 11249     PERFORM 6000-RESOLVE-VARIABLES THRU 6000-EXIT.
 11250
 11251*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
 11252*        IF  PI-689-CONTROL NOT GREATER THAN ZEROS
 11253*            MOVE ER-7243        TO EMI-ERROR
 11254*            MOVE -1             TO PRTRESTL
 11255*            MOVE AL-UABON       TO PRTRESTA
 11256*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11257
 11258     IF  PI-CREATE-LABELS AND
 11259         NOT  PI-689-LABELS-OVERRIDEN
 11260         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 11261         SET W-RG-NDX UP BY +1
 11262     ELSE
 11263         SET W-RG-NDX            TO +1.
 11264
 11265     MOVE W-TOP-FORM             TO W-RC-TEXT (W-RG-NDX).
 11266     SET W-RG-NDX UP BY W-TOP-MARGIN.
 11267
 11268     PERFORM 7400-CREATE-LETTER THRU 7400-EXIT.
 11269
 11270     SET PI-TOTAL-LINES          TO W-RG-NDX.
 11271
 11272     IF  W-FIRST-BAD-VARIABLE-FOUND
 11273         SET W-RG-NDX            TO W-FIRST-BAD-VARIABLE
 11274         MOVE W-FIRST-BAD-VARIABLE
 11275                                 TO PI-CURRENT-LINE
 11276     ELSE
 11277         SET W-RG-NDX            TO 1.
 11278
 11279     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 11280             VARYING
 11281         W-SC-NDX FROM 1 BY 1
 11282             UNTIL
 11283         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 11284     IF  PI-689-CREATE-NO-SCREENS
 11285         GO TO 2000-EXIT
 11286     ELSE
 11287         IF  W-FORM-CHANGED
 11288             MOVE '3'            TO PI-ACTION
 11289             MOVE -1             TO MAINTL
 11290             GO TO 8100-SEND-INITIAL-MAP
 11291         ELSE
 11292             MOVE '3'            TO PI-ACTION
 11293             MOVE -1             TO MAINTL
 11294             GO TO 8350-SEND-DATAONLY-ERASEAUP.
 11295
 11296 2000-EXIT.
 11297     EXIT.
 11298
 11299 2001-NOT-FOUND.
 11300
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 229
* EL689.cbl
 11301     MOVE ER-0006                TO EMI-ERROR.
 11302     MOVE -1                     TO FORML.
 11303     MOVE AL-UABON               TO FORMA.
 11304     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11305     GO TO 8350-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 230
* EL689.cbl
 11307 2100-PROCESS-FORM-CONTROL-LINE.
 11308
 11309     MOVE TX-TEXT-LINE           TO W-LINE-CONTROL-RECORD.
 11310
 11311     IF  W-LC-LINE-WIDTH NUMERIC
 11312             AND
 11313         W-LC-LINE-WIDTH GREATER THAN ZEROS
 11314         COMPUTE W-INITIAL-COLUMN
 11315             = (70 - W-LC-LINE-WIDTH) / 2
 11316         COMPUTE W-START-COLUMN = W-INITIAL-COLUMN + 1
 11317         COMPUTE W-LAST-COLUMN ROUNDED
 11318             = W-INITIAL-COLUMN + W-LC-LINE-WIDTH
 11319         COMPUTE W-TOO-FAR = W-LAST-COLUMN + 1
 11320     ELSE
 11321         MOVE 70                 TO W-LC-LINE-WIDTH.
 11322
 11323     IF  W-LC-PARAGRAPH-INDENT NUMERIC
 11324             AND
 11325         W-LC-PARAGRAPH-INDENT GREATER THAN ZEROS
 11326         MOVE W-LC-PARAGRAPH-INDENT
 11327                                 TO W-PARAGRAPH-INDENT.
 11328
 11329     IF  W-LC-MAX-LINES-PER-PAGE NUMERIC
 11330             AND
 11331         W-LC-MAX-LINES-PER-PAGE GREATER THAN ZEROS
 11332         MOVE W-LC-MAX-LINES-PER-PAGE
 11333                                 TO W-MAX-LINES-PER-PAGE.
 11334
 11335     IF  W-LC-LINE-ADJUST NUMERIC
 11336             AND
 11337         W-LC-LINE-ADJUST GREATER THAN ZEROS
 11338         COMPUTE W-TOTAL-LINE-LENGTH
 11339             = W-LC-LINE-WIDTH + (W-LC-LINE-ADJUST * 2)
 11340         IF  W-TOTAL-LINE-LENGTH LESS THAN +71
 11341             ADD W-LC-LINE-ADJUST
 11342                                 TO W-INITIAL-COLUMN
 11343                                    W-LAST-COLUMN
 11344                                    W-START-COLUMN
 11345                                    W-TOO-FAR.
 11346
 11347     IF  W-LC-LINE-INDENT-1 NUMERIC
 11348             AND
 11349         W-LC-LINE-INDENT-1 LESS THAN W-LC-LINE-WIDTH
 11350         MOVE W-LC-LINE-INDENT-1 TO W-LINE-INDENT-1
 11351     ELSE
 11352         MOVE +0                 TO W-LINE-INDENT-1.
 11353
 11354     IF  W-LC-LINE-INDENT-2 NUMERIC
 11355             AND
 11356         W-LC-LINE-INDENT-2 LESS THAN W-LC-LINE-WIDTH
 11357         MOVE W-LC-LINE-INDENT-2 TO W-LINE-INDENT-2
 11358     ELSE
 11359         MOVE +0                 TO W-LINE-INDENT-2.
 11360
 11361     IF  W-LC-LINE-INDENT-3 NUMERIC
 11362             AND
 11363         W-LC-LINE-INDENT-3 LESS THAN W-LC-LINE-WIDTH
 11364         MOVE W-LC-LINE-INDENT-3 TO W-LINE-INDENT-3
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 231
* EL689.cbl
 11365     ELSE
 11366         MOVE +0                 TO W-LINE-INDENT-3.
 11367
 11368     IF  W-LC-LINE-INDENT-4 NUMERIC
 11369             AND
 11370         W-LC-LINE-INDENT-4 LESS THAN W-LC-LINE-WIDTH
 11371         MOVE W-LC-LINE-INDENT-4 TO W-LINE-INDENT-4
 11372     ELSE
 11373         MOVE +0                 TO W-LINE-INDENT-4.
 11374
 11375     IF  W-LC-LINE-INDENT-5 NUMERIC
 11376             AND
 11377         W-LC-LINE-INDENT-5 LESS THAN W-LC-LINE-WIDTH
 11378         MOVE W-LC-LINE-INDENT-5 TO W-LINE-INDENT-5
 11379
 11380     ELSE
 11381         MOVE +0                 TO W-LINE-INDENT-5.
 11382
 11383     IF  W-LC-TOP-MARGIN NUMERIC
 11384         MOVE W-LC-TOP-MARGIN    TO W-TOP-MARGIN
 11385     ELSE
 11386         MOVE +0                 TO W-TOP-MARGIN.
 11387
 11388     IF W-LC-CASE-IND = 'Y' OR 'N'
 11389         NEXT SENTENCE
 11390     ELSE
 11391         MOVE PI-LOWER-CASE-LETTERS
 11392                                 TO W-LC-CASE-IND.
 11393
 11394 2100-EXIT.
 11395     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 232
* EL689.cbl
 11397 2150-PROCESS-Z-CONTROLS.
 11398
 11399     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
 11400
 11401     IF PI-689-RESEND-DATE-1 = LOW-VALUES
 11402        IF W-DAYS-TO-RESEND NUMERIC
 11403           IF W-DAYS-TO-RESEND > ZEROS
 11404              MOVE '6'           TO DC-OPTION-CODE
 11405              MOVE W-SAVE-BIN-NEXT-BUS-DT
 11406                                 TO DC-BIN-DATE-1
 11407              MOVE ZEROS         TO DC-ELAPSED-MONTHS
 11408              MOVE W-DAYS-TO-RESEND
 11409                                 TO DC-ELAPSED-DAYS
 11410              PERFORM 9500-LINK-DATE-CONVERT
 11411                                 THRU 9500-EXIT
 11412              IF NO-CONVERSION-ERROR
 11413                 MOVE DC-BIN-DATE-2
 11414                                 TO PI-689-RESEND-DATE-1
 11415                 MOVE DC-GREG-DATE-1-EDIT
 11416                                 TO RESEND1O
 11417                                    PI-689-RESEND1-EDIT
 11418                 MOVE AL-UANON
 11419                                 TO RESEND1A
 11420                 MOVE +8         TO RESEND1L
 11421              ELSE
 11422                 MOVE ER-3770
 11423                                 TO EMI-ERROR
 11424                 MOVE -1         TO MAINTL
 11425                 PERFORM 9900-ERROR-FORMAT
 11426                                 THRU 9900-EXIT
 11427                 GO TO 8200-SEND-DATAONLY
 11428              END-IF
 11429           END-IF
 11430        END-IF
 11431     END-IF
 11432     IF W-FORM-TO-RESEND NOT = SPACES AND ZEROS
 11433        MOVE W-FORM-TO-RESEND    TO PI-689-RESEND-LETR-1
 11434     END-IF
 11435     IF  PI-689-FOLLOW-UP-DATE EQUAL LOW-VALUES
 11436         IF  W-DAYS-TO-FOLLOW-UP NUMERIC
 11437            IF  W-DAYS-TO-FOLLOW-UP >= ZEROS
 11438                 MOVE '6'        TO DC-OPTION-CODE
 11439                 MOVE W-SAVE-BIN-DATE
 11440                                 TO DC-BIN-DATE-1
 11441                 MOVE ZEROS      TO DC-ELAPSED-MONTHS
 11442                 MOVE W-DAYS-TO-FOLLOW-UP
 11443                                 TO DC-ELAPSED-DAYS
 11444                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 11445                 IF  NO-CONVERSION-ERROR
 11446                     MOVE DC-BIN-DATE-2
 11447                                 TO PI-689-FOLLOW-UP-DATE
 11448                     MOVE DC-GREG-DATE-1-EDIT
 11449                                 TO FOLLOWO
 11450                     MOVE AL-UANON
 11451                                 TO FOLLOWA
 11452                     MOVE +8     TO FOLLOWL
 11453                 ELSE
 11454                     MOVE ER-3771
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 233
* EL689.cbl
 11455                                 TO EMI-ERROR
 11456                     MOVE -1     TO MAINTL
 11457                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11458                     GO TO 8200-SEND-DATAONLY.
 11459
 11460     IF  COPIESI NOT NUMERIC
 11461             OR
 11462         COPIESI NOT GREATER THAN ZEROS
 11463         IF  W-NUMBER-OF-COPIES NUMERIC
 11464             IF  W-NUMBER-OF-COPIES GREATER THAN ZEROS
 11465                 MOVE W-NUMBER-OF-COPIES
 11466                                 TO COPIESI
 11467                                    PI-689-NUMBER-COPIES
 11468                 MOVE AL-UNNON   TO COPIESA
 11469                 MOVE +1         TO COPIESL
 11470             ELSE
 11471                 MOVE +1         TO COPIESI
 11472                                    PI-689-NUMBER-COPIES
 11473                 MOVE AL-UNNON   TO COPIESA
 11474                 MOVE +1         TO COPIESL
 11475         ELSE
 11476             MOVE +1             TO COPIESI
 11477                                    PI-689-NUMBER-COPIES
 11478             MOVE AL-UNNON       TO COPIESA
 11479             MOVE +1             TO COPIESL.
 11480
 11481     IF W-PROMPT-LETTER EQUAL 'Y'
 11482         MOVE 'Y'                TO PI-PROMPT-IND
 11483         MOVE ER-0894            TO EMI-ERROR
 11484         MOVE -1                 TO MAINTL
 11485         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11486     END-IF.
 11487
 11488     MOVE W-ENCLOSURE-CD                TO PI-ENCLOSURE-CD
 11489                                           ENCO
 11490     MOVE AL-UANON                      TO ENCA
 11491     MOVE +3                            TO ENCL
 11492
 11493     IF W-PRINT-CERTIFICATE = 'Y'
 11494        MOVE 'Y' TO PI-CERT-REQ-IND
 11495        IF CERTIDL > ZEROS
 11496            IF CERTIDI NUMERIC
 11497              MOVE AL-UANON      TO CERTIDA
 11498              MOVE CERTIDI       TO PI-CERT-FORM-ID
 11499            ELSE
 11500              MOVE ER-1778       TO EMI-ERROR
 11501              MOVE -1            TO CERTIDL
 11502              MOVE AL-UABON      TO CERTIDA
 11503              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11504           END-IF
 11505        ELSE
 11506              MOVE ER-0715       TO EMI-ERROR
 11507              MOVE -1            TO CERTIDL
 11508              MOVE AL-UABON      TO CERTIDA
 11509              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11510        END-IF
 11511     END-IF.
 11512
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 234
* EL689.cbl
 11513     IF W-REASONS-REQUIRED = 'Y'
 11514        MOVE 'Y' TO PI-REASON-REQ-IND
 11515        IF PI-ENDT-ARCH-NO NOT > ZERO
 11516          MOVE ER-9840       TO EMI-ERROR
 11517          MOVE -1            TO FORML
 11518          MOVE AL-UABON      TO FORMA
 11519          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11520        END-IF
 11521     END-IF.
 11522
 11523*    IF  PI-689-PRINT-RESTRICTION NOT = 'C' AND 'F' AND 'P' AND
 11524*                                       SPACES
 11525*        IF  W-PRINT-RESTRICTED
 11526*            MOVE W-PRINT-RESTRICTED-IND
 11527*                                TO PRTRESTI
 11528*                                   PI-689-PRINT-RESTRICTION
 11529*            MOVE AL-UANON       TO PRTRESTA
 11530*            MOVE +1             TO PRTRESTL.
 11531     .
 11532 2150-EXIT.
 11533     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 235
* EL689.cbl
 11535 2200-CHECK-FOR-VARIABLE.
 11536
 11537     IF  W-TX-TEXT (W-TG-NDX) EQUAL SPACES
 11538         GO TO 2200-EXIT.
 11539
 11540     SET W-TX-NDX                TO +1.
 11541
 11542 2200-CONTINUE.
 11543
 11544     SEARCH W-TX-CHAR
 11545         VARYING
 11546             W-TX-NDX
 11547         AT END
 11548             GO TO 2200-EXIT
 11549         WHEN
 11550             W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 11551             NEXT SENTENCE.
 11552
 11553     SET W-TX-NDX UP BY +1.
 11554
 11555     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 11556         PERFORM 2220-BUILD-VARIABLE-NUMBER THRU 2220-EXIT
 11557         GO TO 2200-CONTINUE.
 11558
 11559 2200-EXIT.
 11560     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 236
* EL689.cbl
 11562 2220-BUILD-VARIABLE-NUMBER.
 11563
 11564     SET W-TX-NDX UP BY +1.
 11565     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V1.
 11566     SET W-TX-NDX UP BY +1.
 11567     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V2.
 11568     SET W-TX-NDX UP BY +1.
 11569     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V3.
 11570
 11571     IF  W-VAR-RELATIVE-NUM NUMERIC
 11572         SET W-FILE-NDX TO W-VARIABLE-SOURCE (W-VAR-RELATIVE-NUM)
 11573         MOVE 'Y' TO W-FILE-USE-IND (W-FILE-NDX).
 11574
 11575 2220-EXIT.
 11576     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 237
* EL689.cbl
 11578 4000-ROLL-PAGE.
 11579
 11580     IF  ENTERPFL NOT EQUAL ZEROS
 11581         MOVE -1                 TO ENTERPFL
 11582     ELSE
 11583         MOVE -1                 TO MAINTL.
 11584
 11585     IF  PI-TOTAL-LINES EQUAL 0
 11586         MOVE ER-0047            TO EMI-ERROR
 11587         MOVE -1                 TO MAINTL
 11588         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11589         GO TO 8200-SEND-DATAONLY.
 11590
 11591     COMPUTE W-TEMP-CURRENT-LINE EQUAL
 11592         PI-CURRENT-LINE + W-ROLL-COUNTER.
 11593
 11594     IF  W-TEMP-CURRENT-LINE NEGATIVE
 11595             OR
 11596         W-TEMP-CURRENT-LINE EQUAL ZEROS
 11597         MOVE ER-0067            TO EMI-ERROR
 11598         MOVE -1                 TO MAINTL
 11599         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11600         MOVE 1                  TO W-TEMP-CURRENT-LINE.
 11601
 11602*    IF  W-TEMP-CURRENT-LINE GREATER THAN PI-TOTAL-LINES
 11603*            AND
 11604*        (EIBAID EQUAL DFHPF1 OR DFHPF6)
 11605*        MOVE ER-0066            TO EMI-ERROR
 11606*        MOVE -1                 TO MAINTL
 11607*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11608*        COMPUTE W-TEMP-CURRENT-LINE
 11609*            = PI-TOTAL-LINES + 1 - W-NUM-LINES-PER-SCREEN
 11610*        IF  W-TEMP-CURRENT-LINE NEGATIVE
 11611*                OR
 11612*            W-TEMP-CURRENT-LINE = ZEROS
 11613*            MOVE 1 TO W-TEMP-CURRENT-LINE.
 11614
 11615     IF  EMI-ERROR NOT EQUAL ER-0191
 11616             AND
 11617         MAINTI NOT EQUAL 'S'
 11618         PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
 11619         PERFORM 4100-SET-NDX THRU 4100-EXIT
 11620         PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11621                 VARYING
 11622             W-SC-NDX FROM 1 BY 1
 11623                 UNTIL
 11624             W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 11625
 11626     IF  EMI-ERROR EQUAL ER-0066 OR ER-0067 OR ER-0000 OR
 11627                         ER-0191
 11628         NEXT SENTENCE
 11629     ELSE
 11630         GO TO 8200-SEND-DATAONLY.
 11631
 11632     MOVE W-TEMP-CURRENT-LINE    TO PI-CURRENT-LINE
 11633     SET W-RG-NDX                TO PI-CURRENT-LINE
 11634     MOVE LOW-VALUES             TO EL689RI
 11635*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 238
* EL689.cbl
 11636     PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
 11637     SET W-RG-NDX                TO PI-CURRENT-LINE
 11638     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 11639             VARYING
 11640         W-SC-NDX FROM 1 BY 1
 11641             UNTIL
 11642         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 11643
 11644     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 239
* EL689.cbl
 11646 4100-SET-NDX.
 11647
 11648     IF  PI-CURRENT-LINE EQUAL 0
 11649         SET W-RG-NDX            TO 1
 11650     ELSE
 11651         SET W-RG-NDX            TO PI-CURRENT-LINE.
 11652
 11653 4100-EXIT.
 11654      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 240
* EL689.cbl
 11656 4200-UPDATE-TABLE-FROM-SCREEN.
 11657
 11658     IF  W-SC-TEXTL (W-SC-NDX) NOT EQUAL ZEROS
 11659         MOVE ZEROS              TO W-SC-TEXTL (W-SC-NDX)
 11660         IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11661             IF  PI-TOTAL-LINES EQUAL W-MAX-LINES
 11662                 MOVE ER-0051    TO EMI-ERROR
 11663                 MOVE -1         TO MAINTL
 11664                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11665                 GO TO 8200-SEND-DATAONLY
 11666             ELSE
 11667                 MOVE W-SC-TEXT (W-SC-NDX)
 11668                                 TO W-RC-TEXT (W-RG-NDX)
 11669                 ADD 1           TO PI-TOTAL-LINES
 11670         ELSE
 11671             MOVE W-SC-TEXT (W-SC-NDX)
 11672                                 TO W-RC-TEXT (W-RG-NDX).
 11673
 11674     SET W-RG-NDX UP BY 1.
 11675
 11676 4200-EXIT.
 11677      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 241
* EL689.cbl
 11679
 11680
 11681 4500-CONNECT-TO-DB.
 11682
 11683     MOVE 'NTCSO2_LOGIC'         TO SVR
 11684     MOVE 'sa'                   TO USR
 11685     MOVE 'ntcso2'               TO PASS
 11686
 11687     STRING
 11688         USR DELIMITED SPACE
 11689         "." DELIMITED SIZE
 11690         PASS DELIMITED SPACE INTO USR-PASS
 11691     END-STRING
 11692
 11693     EXEC SQL
 11694        CONNECT TO :SVR USER :USR-PASS
 11695     END-EXEC
 11696
 11697     IF SQLCODE NOT = 0
 11698        DISPLAY "ERROR: CANNOT CONNECT "
 11699        DISPLAY SQLCODE
 11700        DISPLAY SQLERRMC
 11701        GO TO 4500-EXIT
 11702     END-IF
 11703
 11704     .
 11705 4500-EXIT.
 11706     EXIT.
 11707
 11708
 11709
 11710 4600-GET-NEXT-BUS-DT.
 11711
 11712     MOVE W-SAVE-EDIT-A-DATE     TO WS-CYCLE-DATE
 11713     MOVE SPACES                 TO WS-NEXT-BUS-DT
 11714
 11715     IF WS-KIXHOST = 'logictest'
 11716        EXEC SQL
 11717          CALL NaperTestCalcNextBusDt
 11718                        @cycledate = :WS-CYCLE-DATE,
 11719                        @nextbusdate = :WS-NEXT-BUS-DT OUT
 11720        END-EXEC
 11721     ELSE
 11722        EXEC SQL
 11723          CALL NaperProdCalcNextBusDt
 11724                        @cycledate = :WS-CYCLE-DATE,
 11725                        @nextbusdate = :WS-NEXT-BUS-DT OUT
 11726        END-EXEC
 11727     END-IF
 11728
 11729     IF SQLCODE NOT = 0
 11730        DISPLAY "ERROR: DID NOT RETURN NEXT BUS DT "
 11731        DISPLAY ' SQL RETURN CODE ' SQLCODE
 11732        DISPLAY ' SQL ERR MESS    ' SQLERRMC
 11733        GO TO 4600-EXIT
 11734     END-IF
 11735
 11736     .
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 242
* EL689.cbl
 11737 4600-EXIT.
 11738     EXIT.
 11739
 11740
 11741
 11742 4700-DISCONNECT.
 11743
 11744     EXEC SQL
 11745        DISCONNECT
 11746     END-EXEC
 11747     .
 11748 4700-EXIT.
 11749     EXIT.
 11750
 11751 5000-EDIT-MODE.
 11752***************************************************************
 11753*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
 11754*    AND THE W-TS-TABLE OF LETTER TEXT.  IT WILL THEN         *
 11755*    TRANSFER TO THE W-TEXT-EDITOR PROGRAM.                   *
 11756***************************************************************
 11757
 11758     IF  PI-SHOW-MODE
 11759         MOVE ER-0188            TO EMI-ERROR
 11760         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11761         MOVE -1                 TO MAINTL
 11762         MOVE AL-UABON           TO MAINTA
 11763         GO TO 8200-SEND-DATAONLY.
 11764
 11765     IF  PI-CURRENT-LINE EQUAL ZEROS
 11766         MOVE ER-0187            TO EMI-ERROR
 11767         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11768         MOVE -1                 TO MAINTL
 11769         GO TO 8200-SEND-DATAONLY.
 11770
 11771     PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 11772     PERFORM 4100-SET-NDX THRU 4100-EXIT.
 11773     PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11774             VARYING
 11775         W-SC-NDX FROM 1 BY 1
 11776             UNTIL
 11777         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 11778
 11779     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 11780
 11781     MOVE PI-689-FORM-NUMBER     TO PI-COMM-CONTROL.
 11782     MOVE ZEROS                  TO PI-UPDATE-SW.
 11783     MOVE '1'                    TO PI-ENTRY-CD-1.
 11784     MOVE W-PGM-EL1042           TO W-CALL-PGM.
 11785     GO TO 9400-XCTL.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 243
* EL689.cbl
 11787 5400-LETTER-RELEASE.
 11788***************************************************************
 11789*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
 11790*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS IN       *
 11791*    THE ARCHIVE FILE.                                        *
 11792*    THE FUNCTIONS BELOW WILL BE PERFORMED.                   *
 11793*        1. CHECK SECURITY.                                   *
 11794*        2. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS.        *
 11795*        3. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
 11796*        4. WRITE THE NEW ARCHIVE RECORDS FROM W-TS-TABLE.    *
 11797*        5. RESET INSURED'S CONTROL FIELDS AND RETURN THE     *
 11798*           ARCHIVE NUMBER USED  TO FILE THE RECORDS.         *
 11799***************************************************************
 11800
 11801     IF  NOT MODIFY-CAP
 11802         MOVE ER-0070            TO EMI-ERROR
 11803         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11804         MOVE -1                 TO MAINTL
 11805         GO TO 8200-SEND-DATAONLY.
 11806
 11807     IF  PI-SHOW-MODE
 11808         MOVE ER-0188            TO EMI-ERROR
 11809         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11810         MOVE -1                 TO MAINTL
 11811         MOVE AL-UABON           TO MAINTA
 11812         GO TO 8200-SEND-DATAONLY.
 11813
 11814      IF  ARCHNUML GREATER THAN ZEROS
 11815          MOVE ER-9320            TO EMI-ERROR
 11816          MOVE -1                 TO ARCHNUML
 11817          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11818          GO TO 8200-SEND-DATAONLY.
 11819
 11820*     IF  PI-CURRENT-LINE EQUAL ZEROS
 11821*        MOVE ER-0187            TO EMI-ERROR
 11822*        MOVE -1                 TO MAINTL
 11823*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11824*        GO TO 8200-SEND-DATAONLY.
 11825
 11826*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 11827*
 11828*    IF  NOT PI-689-CREATE-NO-SCREENS
 11829*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 11830*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11831*                VARYING
 11832*            W-SC-NDX FROM 1 BY 1
 11833*                UNTIL
 11834*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 11835*        IF  EMI-FATAL-CTR GREATER THAN ZEROS
 11836*                OR
 11837*            PI-689-FATAL-ERROR
 11838*            GO TO 8200-SEND-DATAONLY.
 11839*
 11840*    MOVE SPACES                 TO W-REMAINING-VAR-SW.
 11841*    PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 11842*            VARYING
 11843*        W-RVS-NDX FROM +1 BY +1
 11844*            UNTIL
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 244
* EL689.cbl
 11845*        W-RVS-NDX > +36500
 11846*            OR
 11847*        W-REMAINING-VAR-FOUND.
 11848*
 11849*    IF  NOT PI-689-CREATE-NO-SCREENS
 11850*        IF  W-REMAINING-VAR-FOUND
 11851*            GO TO 4000-ROLL-PAGE.
 11852
 11853*    MOVE SPACES                 TO W-CNTL-KEY.
 11854*    MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11855*    MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 11856*    MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 11857*
 11858*    EXEC CICS HANDLE CONDITION
 11859*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11860*         NOTFND     (5470-CNTL-NOT-FOUND)
 11861*    END-EXEC.
 11862*
 11863*    EXEC CICS READ
 11864*         DATASET    (W-CNTL-FILE-ID)
 11865*         SET        (ADDRESS OF CONTROL-FILE)
 11866*         RIDFLD     (W-CNTL-KEY)
 11867*         UPDATE
 11868*    END-EXEC.
 11869*
 11870*    IF  CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
 11871*        MOVE ZEROS              TO CF-CREDIT-LAST-ARCH-NUM
 11872*                                   CF-CREDIT-START-ARCH-NUM.
 11873*
 11874*    ADD 1                       TO CF-CREDIT-LAST-ARCH-NUM.
 11875*    MOVE CF-CREDIT-LAST-ARCH-NUM
 11876*                                TO W-ARCH-NUMBER
 11877*                                   W-ARCT-NUMBER.
 11878*
 11879*    EXEC CICS REWRITE
 11880*         FROM      (CONTROL-FILE)
 11881*         DATASET   (W-CNTL-FILE-ID)
 11882*    END-EXEC
 11883
 11884*    EXEC CICS HANDLE CONDITION
 11885*         NOTOPEN   (8010-ARCH-NOT-OPEN)
 11886*    END-EXEC.
 11887*
 11888*    EXEC CICS GETMAIN
 11889*       SET      (ADDRESS OF LETTER-ARCHIVE)
 11890*       LENGTH   (W-ARCH-LENGTH)
 11891*    END-EXEC
 11892*
 11893*    MOVE SPACES                 TO LETTER-ARCHIVE
 11894*    MOVE 'LA'                   TO LA-RECORD-ID.
 11895*    MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
 11896*                                   LA-ARCHIVE-NO-A2
 11897*                                   LA-ARCHIVE-NO-A3
 11898*                                   LA-ARCHIVE-NO-A4
 11899*                                   LA-ARCHIVE-NO-A5
 11900*                                   LA-ARCHIVE-NO-A6
 11901*                                   PI-689-ARCHIVE-NUMBER.
 11902*    MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 245
* EL689.cbl
 11903*                                   LA-COMPANY-CD-A2
 11904*                                   LA-COMPANY-CD-A3
 11905*                                   LA-COMPANY-CD-A4
 11906*                                   LA-COMPANY-CD-A5
 11907*                                   LA-COMPANY-CD-A6.
 11908*    MOVE PI-689-CARRIER         TO LA-CARRIER-A2
 11909*                                   LA-CARRIER-A3
 11910*                                   LA-CARRIER-A4
 11911*                                   LA-CARRIER-A5.
 11912*    MOVE PI-689-EFF-DATE        TO LA-EFFECT-DATE-A2.
 11913*    MOVE PI-689-GROUPING        TO LA-GROUPING-A2
 11914*                                   LA-GROUPING-A3
 11915*                                   LA-GROUPING-A4
 11916*                                   LA-GROUPING-A5.
 11917*    MOVE PI-689-ACCOUNT         TO LA-ACCOUNT-A2
 11918*                                   LA-ACCOUNT-A3
 11919*                                   LA-ACCOUNT-A4
 11920*                                   LA-ACCOUNT-A5.
 11921*    MOVE PI-689-STATE           TO LA-STATE-A2
 11922*                                   LA-STATE-A3
 11923*                                   LA-STATE-A4
 11924*                                   LA-STATE-A5.
 11925*
 11926*    IF  PI-689-DATA-SOURCE EQUAL '3'
 11927*            AND
 11928*        PI-689-RESP-PERSON GREATER THAN SPACES
 11929*        MOVE PI-689-RESP-PERSON
 11930*                                TO LA-RESP-PERSON-A2
 11931*        MOVE PI-689-TYPE        TO LA-TYPE-A2
 11932*    ELSE
 11933*        IF  PI-689-CERT-PRIME GREATER THAN SPACES
 11934*            MOVE PI-689-CERT-PRIME
 11935*                                TO LA-CERT-PRIME-A2
 11936*            MOVE PI-689-CERT-SFX
 11937*                                TO LA-CERT-SUFFIX-A2
 11938*        ELSE
 11939*            MOVE LOW-VALUE      TO LA-RESP-PERSON-A2
 11940*                                   LA-TYPE-A2.
 11941*
 11942*    IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 11943*        MOVE PI-689-ENTRY-BATCH TO LA-ENTRY-A6
 11944*        IF  PI-689-CONTROL GREATER THAN ZEROS
 11945*                AND
 11946*            PI-689-PRINT-RESTRICTION EQUAL 'C'
 11947*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 11948*            MOVE 'CK'           TO LA-FILLER
 11949*        ELSE
 11950*            NEXT SENTENCE
 11951*    ELSE
 11952*        IF  PI-689-CONTROL GREATER THAN ZEROS
 11953*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 11954*            MOVE 'CK'           TO LA-FILLER
 11955*        ELSE
 11956*            MOVE LOW-VALUES     TO LA-ENTRY-A6.
 11957*
 11958*    MOVE ZEROS                  TO W-SEQ-CTR.
 11959*
 11960*    MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 246
* EL689.cbl
 11961*
 11962*    MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
 11963*                                   LA-INITIAL-PRINT-DATE
 11964*                                   LA-SENT-DATE
 11965*                                   LA-REPLY-DATE.
 11966*    MOVE 'A'                    TO LA-STATUS.
 11967*
 11968*    IF  PI-689-NUMBER-COPIES NOT NUMERIC
 11969*            OR
 11970*        PI-689-NUMBER-COPIES EQUAL ZEROS
 11971*        MOVE  1                 TO LA-NO-OF-COPIES
 11972*    ELSE
 11973*        MOVE PI-689-NUMBER-COPIES
 11974*                                TO LA-NO-OF-COPIES.
 11975*
 11976*    MOVE PI-689-FORM-NUMBER     TO LA-FORM-A3.
 11977*    MOVE PI-689-FOLLOW-UP-DATE  TO LA-FOLLOW-UP-DATE.
 11978*    MOVE PI-689-PRINT-RESTRICTION
 11979*                                TO LA-PRINT-RESTRICTION
 11980*    MOVE PI-689-LABEL-SOURCE    TO LA-ADDR-SOURCE.
 11981*    MOVE PI-689-DATA-SOURCE     TO LA-DATA-SOURCE.
 11982*    MOVE PI-689-RESEND-DATE-1   TO LA-RESEND-DATE
 11983*    MOVE PI-689-RESEND-LETR-1   TO LA-RESEND-LETR
 11984*    MOVE W-CURRENT-SAVE         TO LA-CREATION-DATE.
 11985*
 11986*    IF  PI-689-PRINT-PERFORMED
 11987*        MOVE SPACES             TO PI-689-PRINT-SW
 11988*        MOVE W-CURRENT-SAVE     TO LA-INITIAL-PRINT-DATE
 11989*        IF  LA-RESEND-DATE = LOW-VALUES
 11990*            MOVE 'C'            TO LA-STATUS.
 11991*
 11992*    MOVE PI-689-NUMBER-LABEL-LINES
 11993*                                TO LA-NUMBER-LABEL-LINES.
 11994*    MOVE ZEROS                  TO PI-689-NUMBER-TEXT-RECORDS.
 11995*
 11996*    PERFORM 5410-CREATE-TEXT-RECORDS THRU 5410-EXIT.
 11997*
 11998*    MOVE PI-689-NUMBER-TEXT-RECORDS
 11999*    MOVE ZEROS                  TO LA-NO-OF-TEXT-RECORDS.
 12000*
 12001*    EXEC CICS HANDLE CONDITION
 12002*        DUPREC    (5460-DUPLICATE-ARCHIVE-RCD)
 12003*    END-EXEC.
 12004*
 12005*    PERFORM 5650-WRITE-ARCHIVE THRU 5650-EXIT.
 12006*    MOVE ER-0280                TO EMI-ERROR.
 12007*    MOVE -1                     TO MAINTL.
 12008*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12009*    MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 12010*    MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1).
 12011     .
 12012 5400-END.
 12013     DISPLAY ' MADE IT TO 5400 '
 12014     MOVE SPACES                 TO BL-INPUT
 12015     MOVE ZEROS                  TO BL-ARCHIVE-NO
 12016     MOVE PI-689-DATA-SOURCE     TO BL-DATA-SRCE
 12017     MOVE PI-689-CARRIER         TO BL-CARRIER
 12018     MOVE PI-689-GROUPING        TO BL-GROUP
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 247
* EL689.cbl
 12019     MOVE PI-689-STATE           TO BL-STATE
 12020     MOVE PI-689-ACCOUNT         TO BL-ACCOUNT
 12021     IF PI-689-EFF-DATE NOT = LOW-VALUES
 12022        MOVE PI-689-EFF-DATE     TO DC-BIN-DATE-1
 12023        MOVE ' '                 TO DC-OPTION-CODE
 12024        PERFORM 9500-LINK-DATE-CONVERT
 12025                                 THRU 9500-EXIT
 12026        IF NO-CONVERSION-ERROR
 12027           MOVE DC-GREG-DATE-1-EDIT
 12028                                 TO BL-EFF-DT
 12029        END-IF
 12030     END-IF
 12031     MOVE PI-689-CERT-NO         TO BL-CERT-NO
 12032     MOVE PI-689-ENTRY-BATCH     TO BL-BATCH-NO
 12033     MOVE PI-689-SEQ-NO          TO BL-BATCH-SEQ
 12034     MOVE PI-689-RESP-PERSON     TO BL-RESP-NO
 12035     MOVE PI-689-FORM-NUMBER     TO BL-LETTER-ID
 12036     MOVE PI-689-NUMBER-COPIES   TO BL-NO-OF-COPIES
 12037     IF PI-ENDT-ARCH-NO > ZERO
 12038         MOVE PI-ENDT-ARCH-NO    TO BL-ENDT-ARCH-NO
 12039     END-IF
 12040     MOVE 'LETTER  '             TO BL-SOURCE-SCREEN
 12041     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
 12042*    MOVE 'ALWA'                 TO BL-PROC-ID
 12043     MOVE PI-COMPANY-ID          TO BL-COMP-ID
 12044*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
 12045     MOVE PI-ENCLOSURE-CD        TO BL-ENC-CD
 12046     IF PI-689-RESEND-DATE-1 NOT = LOW-VALUES
 12047        MOVE PI-689-RESEND-DATE-1 TO DC-BIN-DATE-1
 12048        MOVE ' '                 TO DC-OPTION-CODE
 12049        PERFORM 9500-LINK-DATE-CONVERT
 12050                                 THRU 9500-EXIT
 12051        IF NO-CONVERSION-ERROR
 12052           MOVE DC-GREG-DATE-B-EDIT
 12053                                 TO BL-RESEND-DT
 12054        END-IF
 12055     END-IF
 12056     IF PI-689-FOLLOW-UP-DATE NOT = LOW-VALUES
 12057        MOVE PI-689-FOLLOW-UP-DATE TO DC-BIN-DATE-1
 12058        MOVE ' '                 TO DC-OPTION-CODE
 12059        PERFORM 9500-LINK-DATE-CONVERT
 12060                                 THRU 9500-EXIT
 12061        IF NO-CONVERSION-ERROR
 12062           MOVE DC-GREG-DATE-B-EDIT
 12063                                 TO BL-FOLLOW-UP-DT
 12064        END-IF
 12065     END-IF
 12066*    MOVE IFF-COMMENTS           TO BL-COMMENTS
 12067*    MOVE 'TEST COMMENTS'        TO BL-COMMENTS
 12068     MOVE PI-CERT-FORM-ID        TO BL-CERT-FORM-ID
 12069     if eibaid = dfhpf7
 12070        move 'B'                 TO BL-WRITE-ERARCH
 12071     else
 12072        move 'T'                 to bl-write-erarch
 12073     end-if
 12074    DISPLAY ' ABOUT TO LINK TO NSRASBL '
 12075*****************************************
 12076* Invoke the LETTER business logic
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 248
* EL689.cbl
 12077*****************************************
 12078
 12079* exec cics link
 12080*       program('NSRASBL')
 12081*       commarea(srch-commarea)
 12082*    end-exec.
 12083     MOVE LENGTH OF
 12084      srch-commarea
 12085       TO DFHEIV11
 12086     MOVE 'NSRASBL' TO DFHEIV1
 12087*    MOVE '."C                   (   #00011660' TO DFHEIV0
 12088     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12089     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12090     MOVE X'2020233030303131363630' TO DFHEIV0(25:11)
 12091     CALL 'kxdfhei1' USING DFHEIV0,
 12092           DFHEIV1,
 12093           srch-commarea,
 12094           DFHEIV11,
 12095           DFHEIV99,
 12096           DFHEIV99,
 12097           DFHEIV99,
 12098           DFHEIV99
 12099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12100
 12101     DISPLAY ' MADE IT BACK FROM NSRASBL ' bl-status ' '
 12102        bl-message ' ' bl-archive-no
 12103     move bl-archive-no to w-arch-number
 12104
 12105     if eibaid = dfhpf7
 12106        PERFORM 5440-ADD-BILLING-NOTE THRU 5440-EXIT
 12107        MOVE ER-0280                TO EMI-ERROR
 12108        MOVE -1                     TO MAINTL
 12109        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12110        MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 12111        MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1)
 12112        MOVE '2'                    TO PI-ACTION
 12113        MOVE ZEROS                  TO PI-TOTAL-LINES
 12114                                       PI-CURRENT-LINE
 12115        MOVE SPACES                 TO PI-689-PRINT-SW
 12116                                       PI-689-FORM-NUMBER
 12117        GO TO 9300-DFHCLEAR
 12118     else
 12119        move w-arch-number          to archnumo
 12120        MOVE ER-1818                TO EMI-ERROR
 12121        MOVE -1                     TO MAINTL
 12122        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12123     end-if
 12124     MOVE -1                     TO MAINTL
 12125     GO TO 8200-SEND-DATAONLY
 12126     .
 12127 5400-EXIT.
 12128     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 249
* EL689.cbl
 12130 5410-CREATE-TEXT-RECORDS.
 12131
 12132*    EXEC CICS HANDLE CONDITION
 12133*         NOTOPEN   (8015-ARCT-NOT-OPEN)
 12134*         DUPREC    (5465-DUPLICATE-ARCH-TEXT)
 12135*    END-EXEC.
 12136*
 12137*    IF  PI-689-CREATE-NO-SCREENS
 12138*        IF  PI-689-GET-ARCT-MAIN
 12139*            EXEC CICS GETMAIN
 12140*                 SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 12141*                 LENGTH   (W-ARCT-LENGTH)
 12142*            END-EXEC
 12143*            SET LCP-WS-ADDR-PNTR TO ADDRESS OF
 12144*                                    LETTER-ARCHIVE-TEXT
 12145*            MOVE LCP-WS-ADDR-COMP
 12146*                                TO PI-689-ARCT-POINTER
 12147*        ELSE
 12148*            MOVE PI-689-ARCT-POINTER
 12149*                                TO LCP-WS-ADDR-COMP
 12150*            SET ADDRESS OF LETTER-ARCHIVE-TEXT
 12151*                                TO LCP-WS-ADDR-PNTR
 12152*    ELSE
 12153*        EXEC CICS GETMAIN
 12154*             SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 12155*             LENGTH   (W-ARCT-LENGTH)
 12156*        END-EXEC.
 12157*
 12158*    PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 12159*
 12160*    MOVE ZEROS                  TO W-SEQ-CTR
 12161*
 12162*    IF  PI-CREATE-LABELS AND
 12163*        NOT PI-689-LABELS-OVERRIDEN
 12164*        MOVE '1'                TO LT-RECORD-TYPE
 12165*        MOVE +0                 TO LT-LINE-SEQ-NO
 12166*        PERFORM 5600-FORMAT-ADDRESS-LINE THRU 5600-EXIT
 12167*                VARYING
 12168*            W-RG-NDX FROM 1 BY 1
 12169*                UNTIL
 12170*            W-RG-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 12171*        PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12172*        PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT
 12173*    ELSE
 12174*        SET W-RG-NDX            TO +1.
 12175*
 12176*    SET LT-NDX                  TO W-ZEROS.
 12177*
 12178*    PERFORM 5500-FORMAT-TEXT THRU 5500-EXIT
 12179*            VARYING
 12180*        W-RG-NDX FROM W-RG-NDX BY +1
 12181*            UNTIL
 12182*        W-RG-NDX GREATER THAN PI-TOTAL-LINES.
 12183
 12184 5410-EXIT.
 12185     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 250
* EL689.cbl
 12187 5415-INITIALIZE-TEXT.
 12188
 12189     MOVE SPACES                 TO LETTER-ARCHIVE-TEXT.
 12190     MOVE 'LT'                   TO LT-RECORD-ID.
 12191
 12192     MOVE LA-ARCHIVE-NO          TO LT-ARCHIVE-NO.
 12193     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
 12194
 12195     MOVE ZEROS                  TO LT-LINE-SEQ-NO
 12196                                    LT-NUM-LINES-ON-RECORD.
 12197
 12198 5415-EXIT.
 12199     EXIT.
 12200
 12201 5440-ADD-BILLING-NOTE.
 12202
 12203     MOVE LOW-VALUES             TO W-ELEOBC-KEY
 12204     MOVE PI-COMPANY-CD          TO W-EOBC-COMPANY-CD
 12205     MOVE '5'                    TO W-EOBC-REC-TYPE
 12206
 12207
 12208* EXEC CICS STARTBR
 12209*        DATASET   ('ELEOBC')
 12210*        RIDFLD    (W-ELEOBC-KEY)
 12211*        GTEQ
 12212*        RESP      (W-RESPONSE)
 12213*    END-EXEC
 12214     MOVE 'ELEOBC' TO DFHEIV1
 12215     MOVE 0
 12216       TO DFHEIV11
 12217*    MOVE '&,         G          &  N#00011770' TO DFHEIV0
 12218     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12219     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12220     MOVE X'204E233030303131373730' TO DFHEIV0(25:11)
 12221     CALL 'kxdfhei1' USING DFHEIV0,
 12222           DFHEIV1,
 12223           W-ELEOBC-KEY,
 12224           DFHEIV99,
 12225           DFHEIV11,
 12226           DFHEIV99
 12227     MOVE EIBRESP  TO W-RESPONSE
 12228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12229
 12230     IF NOT RESP-NORMAL
 12231        GO TO 5440-EXIT
 12232     END-IF
 12233      .
 12234 5440-READNEXT-ELEOBC.
 12235
 12236
 12237* EXEC CICS READNEXT
 12238*       INTO    (EOB-CODES)
 12239*       DATASET ('ELEOBC')
 12240*       RIDFLD  (W-ELEOBC-KEY)
 12241*       RESP    (W-RESPONSE)
 12242*    END-EXEC
 12243     MOVE LENGTH OF
 12244      EOB-CODES
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 251
* EL689.cbl
 12245       TO DFHEIV12
 12246     MOVE 'ELEOBC' TO DFHEIV1
 12247     MOVE 0
 12248       TO DFHEIV11
 12249*    MOVE '&.IL                  )  N#00011783' TO DFHEIV0
 12250     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12251     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12252     MOVE X'204E233030303131373833' TO DFHEIV0(25:11)
 12253     CALL 'kxdfhei1' USING DFHEIV0,
 12254           DFHEIV1,
 12255           EOB-CODES,
 12256           DFHEIV12,
 12257           W-ELEOBC-KEY,
 12258           DFHEIV99,
 12259           DFHEIV11,
 12260           DFHEIV99,
 12261           DFHEIV99
 12262     MOVE EIBRESP  TO W-RESPONSE
 12263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12264
 12265     IF RESP-NORMAL
 12266         IF EO-RECORD-TYPE NOT = '5'
 12267             GO TO 5440-EXIT
 12268         END-IF
 12269     ELSE
 12270         GO TO 5440-EXIT
 12271     END-IF
 12272
 12273     IF EO-RECORD-TYPE = '5' AND
 12274        EO-EOB-CODE = PI-689-FORM-NUMBER
 12275           CONTINUE
 12276     ELSE
 12277         GO TO 5440-READNEXT-ELEOBC
 12278     END-IF
 12279
 12280     MOVE SPACES TO W-BILLING-NOTE
 12281     MOVE EO-DESCRIPTION TO W-BN-NOTE
 12282     MOVE PI-689-FORM-NUMBER TO W-BN-LTRID
 12283     MOVE W-SAVE-DATE TO W-BN-DATE
 12284     MOVE PI-PROCESSOR-ID TO W-BN-USERID
 12285     MOVE +25 TO W-LEN
 12286
 12287     PERFORM 5441-UPDATE-BILLING-NOTE THRU 5441-EXIT
 12288     .
 12289 5440-EXIT.
 12290     EXIT.
 12291
 12292 5441-UPDATE-BILLING-NOTE.
 12293
 12294     MOVE PI-COMPANY-CD          TO W-SV-COMPANY-CD
 12295     MOVE PI-689-CARRIER         TO W-SV-CARRIER
 12296     MOVE PI-689-GROUPING        TO W-SV-GROUPING
 12297     MOVE PI-689-STATE           TO W-SV-STATE
 12298     MOVE PI-689-ACCOUNT         TO W-SV-ACCOUNT
 12299     MOVE PI-689-EFF-DATE        TO W-SV-CERT-EFF-DT
 12300     MOVE PI-689-CERT-PRIME      TO W-SV-CERT-PRIME
 12301     MOVE PI-689-CERT-SFX        TO W-SV-CERT-SFX
 12302     MOVE W-SAVE-KEY             TO W-ERNOTE-KEY
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 252
* EL689.cbl
 12303
 12304
 12305* EXEC CICS READ
 12306*       DATASET    (W-NOTE-FILE-ID)
 12307*       RIDFLD     (W-ERNOTE-KEY)
 12308*       INTO       (CERTIFICATE-NOTE)
 12309*       RESP       (W-RESPONSE)
 12310*       UPDATE
 12311*    END-EXEC
 12312     MOVE LENGTH OF
 12313      CERTIFICATE-NOTE
 12314       TO DFHEIV11
 12315*    MOVE '&"IL       EU         (  N#00011829' TO DFHEIV0
 12316     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12317     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12318     MOVE X'204E233030303131383239' TO DFHEIV0(25:11)
 12319     CALL 'kxdfhei1' USING DFHEIV0,
 12320           W-NOTE-FILE-ID,
 12321           CERTIFICATE-NOTE,
 12322           DFHEIV11,
 12323           W-ERNOTE-KEY,
 12324           DFHEIV99,
 12325           DFHEIV99,
 12326           DFHEIV99
 12327     MOVE EIBRESP  TO W-RESPONSE
 12328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12329
 12330     IF RESP-NORMAL
 12331       IF CN-BILLING-START-LINE-NO NOT NUMERIC
 12332          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 12333       END-IF
 12334       IF CN-BILLING-END-LINE-NO NOT NUMERIC
 12335          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 12336       END-IF
 12337       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
 12338           (NOTE-SUB > +10) OR
 12339           (CN-LINE (NOTE-SUB) (1:W-LEN) =
 12340                             W-BILLING-NOTE (1:W-LEN))
 12341       END-PERFORM
 12342       IF CN-LINE (NOTE-SUB) (1:W-LEN) =
 12343                              W-BILLING-NOTE (1:W-LEN)
 12344
 12345* EXEC CICS UNLOCK
 12346*           DATASET    (W-NOTE-FILE-ID)
 12347*        END-EXEC
 12348*    MOVE '&*                    #   #00011851' TO DFHEIV0
 12349     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12350     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12351     MOVE X'2020233030303131383531' TO DFHEIV0(25:11)
 12352     CALL 'kxdfhei1' USING DFHEIV0,
 12353           W-NOTE-FILE-ID,
 12354           DFHEIV99
 12355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12356       ELSE
 12357         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
 12358           (NOTE-SUB > +10) OR
 12359           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
 12360         END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 253
* EL689.cbl
 12361         IF (NOTE-SUB < +11)
 12362           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
 12363              NOTE-SUB <= CN-BILLING-END-LINE-NO
 12364                MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB)
 12365           ELSE
 12366             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 12367              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
 12368                MOVE W-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
 12369                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
 12370             ELSE
 12371               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 12372                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
 12373                     MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB)
 12374                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
 12375               ELSE
 12376                 IF (CN-BILLING-END-LINE-NO = ZEROS)
 12377                   MOVE W-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
 12378                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
 12379                                       CN-BILLING-START-LINE-NO
 12380                 ELSE
 12381                    PERFORM 5442-SQUEEZE-IT-IN THRU 5442-EXIT
 12382                 END-IF
 12383               END-IF
 12384             END-IF
 12385           END-IF
 12386           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
 12387           MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
 12388           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 12389
 12390* EXEC CICS REWRITE
 12391*             DATASET    (W-NOTE-FILE-ID)
 12392*             FROM       (CERTIFICATE-NOTE)
 12393*             RESP       (W-RESPONSE)
 12394*          END-EXEC
 12395     MOVE LENGTH OF
 12396      CERTIFICATE-NOTE
 12397       TO DFHEIV11
 12398*    MOVE '&& L                  %  N#00011887' TO DFHEIV0
 12399     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12400     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12401     MOVE X'204E233030303131383837' TO DFHEIV0(25:11)
 12402     CALL 'kxdfhei1' USING DFHEIV0,
 12403           W-NOTE-FILE-ID,
 12404           CERTIFICATE-NOTE,
 12405           DFHEIV11,
 12406           DFHEIV99
 12407     MOVE EIBRESP  TO W-RESPONSE
 12408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12409           PERFORM 5445-CERTIFICATE-UPDATE THRU 5445-EXIT
 12410         END-IF
 12411       END-IF
 12412     ELSE
 12413        MOVE SPACES              TO CERTIFICATE-NOTE
 12414        MOVE 'CN'                TO CN-RECORD-ID
 12415        MOVE W-SAVE-KEY          TO CN-CONTROL-PRIMARY
 12416                                    W-ERNOTE-KEY
 12417        MOVE 01                  TO CN-BILLING-START-LINE-NO
 12418                                    CN-BILLING-END-LINE-NO
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 254
* EL689.cbl
 12419        MOVE W-BILLING-NOTE      TO CN-LINE (01)
 12420        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
 12421        MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
 12422        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 12423
 12424* EXEC CICS WRITE
 12425*          DATASET    (W-NOTE-FILE-ID)
 12426*          FROM       (CERTIFICATE-NOTE)
 12427*          RIDFLD     (W-ERNOTE-KEY)
 12428*          RESP       (W-RESPONSE)
 12429*       END-EXEC
 12430     MOVE LENGTH OF
 12431      CERTIFICATE-NOTE
 12432       TO DFHEIV11
 12433*    MOVE '&$ L                  ''  N#00011906' TO DFHEIV0
 12434     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12435     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12436     MOVE X'204E233030303131393036' TO DFHEIV0(25:11)
 12437     CALL 'kxdfhei1' USING DFHEIV0,
 12438           W-NOTE-FILE-ID,
 12439           CERTIFICATE-NOTE,
 12440           DFHEIV11,
 12441           W-ERNOTE-KEY,
 12442           DFHEIV99,
 12443           DFHEIV99
 12444     MOVE EIBRESP  TO W-RESPONSE
 12445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12446
 12447        PERFORM 5445-CERTIFICATE-UPDATE THRU 5445-EXIT
 12448     END-IF
 12449
 12450     .
 12451 5441-EXIT.
 12452     EXIT.
 12453
 12454
 12455 5442-SQUEEZE-IT-IN.
 12456
 12457     IF NOTE-SUB < CN-BILLING-START-LINE-NO
 12458        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
 12459           NOTE-SUB = +10
 12460           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
 12461           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
 12462             MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
 12463             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
 12464             MOVE +9 TO NOTE-SUB
 12465           END-IF
 12466        END-PERFORM
 12467     ELSE
 12468        IF NOTE-SUB > CN-BILLING-END-LINE-NO
 12469           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
 12470             UNTIL NOTE-SUB = +1
 12471             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
 12472             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
 12473                MOVE W-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
 12474                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
 12475                MOVE +2          TO NOTE-SUB
 12476             END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 255
* EL689.cbl
 12477           END-PERFORM
 12478        END-IF
 12479     END-IF
 12480
 12481     .
 12482 5442-EXIT.
 12483     EXIT.
 12484
 12485 5445-CERTIFICATE-UPDATE.
 12486
 12487     MOVE W-SAVE-KEY         TO W-CERT-KEY
 12488
 12489
 12490* EXEC CICS READ
 12491*        DATASET  (W-CERT-FILE-ID)
 12492*        RIDFLD   (W-CERT-KEY)
 12493*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 12494*        RESP     (W-RESPONSE)
 12495*        UPDATE
 12496*    END-EXEC
 12497*    MOVE '&"S        EU         (  N#00011955' TO DFHEIV0
 12498     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12499     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12500     MOVE X'204E233030303131393535' TO DFHEIV0(25:11)
 12501     CALL 'kxdfhei1' USING DFHEIV0,
 12502           W-CERT-FILE-ID,
 12503           DFHEIV20,
 12504           DFHEIV99,
 12505           W-CERT-KEY,
 12506           DFHEIV99,
 12507           DFHEIV99,
 12508           DFHEIV99
 12509     SET ADDRESS OF CERTIFICATE-MASTER TO
 12510         DFHEIV20
 12511     MOVE EIBRESP  TO W-RESPONSE
 12512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12513
 12514     IF RESP-NORMAL
 12515        EVALUATE CM-NOTE-SW
 12516           WHEN '2'
 12517           WHEN '3'
 12518           WHEN '6'
 12519           WHEN '7'
 12520              SET NO-CERT-RW     TO TRUE
 12521           WHEN ' '
 12522              MOVE '2'           TO CM-NOTE-SW
 12523           WHEN '1'
 12524              MOVE '3'           TO CM-NOTE-SW
 12525           WHEN '4'
 12526              MOVE '6'           TO CM-NOTE-SW
 12527           WHEN '5'
 12528              MOVE '7'           TO CM-NOTE-SW
 12529        END-EVALUATE
 12530     END-IF
 12531     IF NOT NO-CERT-RW
 12532
 12533* EXEC CICS REWRITE
 12534*          FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 256
* EL689.cbl
 12535*          DATASET  (W-CERT-FILE-ID)
 12536*          RESP     (W-RESPONSE)
 12537*       END-EXEC
 12538     MOVE LENGTH OF
 12539      CERTIFICATE-MASTER
 12540       TO DFHEIV11
 12541*    MOVE '&& L                  %  N#00011981' TO DFHEIV0
 12542     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12543     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12544     MOVE X'204E233030303131393831' TO DFHEIV0(25:11)
 12545     CALL 'kxdfhei1' USING DFHEIV0,
 12546           W-CERT-FILE-ID,
 12547           CERTIFICATE-MASTER,
 12548           DFHEIV11,
 12549           DFHEIV99
 12550     MOVE EIBRESP  TO W-RESPONSE
 12551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12552     ELSE
 12553
 12554* EXEC CICS UNLOCK
 12555*          DATASET  (W-CERT-FILE-ID)
 12556*       END-EXEC
 12557*    MOVE '&*                    #   #00011987' TO DFHEIV0
 12558     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12559     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12560     MOVE X'2020233030303131393837' TO DFHEIV0(25:11)
 12561     CALL 'kxdfhei1' USING DFHEIV0,
 12562           W-CERT-FILE-ID,
 12563           DFHEIV99
 12564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12565     END-IF
 12566
 12567     .
 12568 5445-EXIT.
 12569     EXIT.
 12570
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 257
* EL689.cbl
 12572 5460-DUPLICATE-ARCHIVE-RCD.
 12573
 12574     IF  NOT PI-689-CREATE-NO-SCREENS
 12575
 12576* EXEC CICS SYNCPOINT ROLLBACK
 12577*        END-EXEC.
 12578*    MOVE '6"R                   !   #00012000' TO DFHEIV0
 12579     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 12580     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12581     MOVE X'2020233030303132303030' TO DFHEIV0(25:11)
 12582     CALL 'kxdfhei1' USING DFHEIV0
 12583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12584
 12585
 12586     MOVE ER-9426                TO EMI-ERROR.
 12587     MOVE -1                     TO MAINTL.
 12588     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12589     GO TO 8200-SEND-DATAONLY.
 12590
 12591 5465-DUPLICATE-ARCH-TEXT.
 12592
 12593     IF  NOT PI-689-CREATE-NO-SCREENS
 12594
 12595* EXEC CICS SYNCPOINT ROLLBACK
 12596*        END-EXEC.
 12597*    MOVE '6"R                   !   #00012011' TO DFHEIV0
 12598     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 12599     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12600     MOVE X'2020233030303132303131' TO DFHEIV0(25:11)
 12601     CALL 'kxdfhei1' USING DFHEIV0
 12602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12603
 12604
 12605     MOVE ER-7369                TO EMI-ERROR.
 12606     MOVE -1                     TO MAINTL.
 12607     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12608     GO TO 8200-SEND-DATAONLY.
 12609
 12610 5470-CNTL-NOT-FOUND.
 12611
 12612     MOVE ER-9299                TO EMI-ERROR.
 12613     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12614     MOVE -1                     TO MAINTL.
 12615     MOVE AL-UANON               TO MAINTA.
 12616     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 258
* EL689.cbl
 12618 5500-FORMAT-TEXT.
 12619
 12620     SET LT-NDX UP BY +1.
 12621
 12622     IF  W-RC-TEXT (W-RG-NDX) EQUAL W-TOP-FORM
 12623         SET W-RG-NDX UP BY 1
 12624         MOVE 99                 TO LT-SKIP-CONTROL (LT-NDX)
 12625         MOVE W-RC-TEXT (W-RG-NDX)
 12626                                 TO LT-TEXT-LINE (LT-NDX)
 12627     ELSE
 12628         IF  W-RC-TEXT (W-RG-NDX) EQUAL SPACES
 12629             MOVE ZEROS          TO W-PRINT-CONTROL
 12630             PERFORM 5505-FIND-USED-LINE THRU 5505-EXIT
 12631                     VARYING
 12632                 W-RG-NDX FROM W-RG-NDX BY 1
 12633                     UNTIL
 12634                 W-RG-NDX GREATER THAN PI-TOTAL-LINES
 12635                     OR
 12636                 W-RC-TEXT (W-RG-NDX) GREATER THAN SPACES
 12637             IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 12638                 GO TO 5500-WRITE-TEST
 12639             ELSE
 12640                 MOVE W-PRINT-CONTROL
 12641                                 TO LT-SKIP-CONTROL (LT-NDX)
 12642                 MOVE W-RC-TEXT (W-RG-NDX)
 12643                                 TO LT-TEXT-LINE (LT-NDX)
 12644         ELSE
 12645             MOVE W-RC-TEXT (W-RG-NDX)
 12646                                 TO LT-TEXT-LINE (LT-NDX)
 12647             MOVE ZEROS          TO W-PRINT-CONTROL.
 12648
 12649     ADD +1                      TO LT-NUM-LINES-ON-RECORD.
 12650
 12651 5500-WRITE-TEST.
 12652
 12653     IF  W-RG-NDX NOT LESS THAN PI-TOTAL-LINES
 12654         IF  LT-TEXT-RECORD NOT EQUAL SPACES
 12655             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 12656             MOVE '2'            TO LT-RECORD-TYPE
 12657             ADD +1              TO W-SEQ-CTR
 12658             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 12659             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12660         ELSE
 12661             NEXT SENTENCE
 12662     ELSE
 12663         IF  LT-NDX EQUAL +20
 12664             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 12665             MOVE '2'            TO LT-RECORD-TYPE
 12666             ADD +1              TO W-SEQ-CTR
 12667             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 12668             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12669             SET LT-NDX          TO W-ZEROS
 12670             PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 12671
 12672 5500-EXIT.
 12673      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 259
* EL689.cbl
 12675 5505-FIND-USED-LINE.
 12676
 12677     ADD +1                      TO W-PRINT-CONTROL.
 12678
 12679 5505-EXIT.
 12680      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 260
* EL689.cbl
 12682 5600-FORMAT-ADDRESS-LINE.
 12683
 12684     SET LT-NDX                  TO W-RG-NDX.
 12685     MOVE W-RC-TEXT (W-RG-NDX)   TO LT-TEXT-LINE (LT-NDX).
 12686
 12687 5600-EXIT.
 12688     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 261
* EL689.cbl
 12690 5650-WRITE-ARCHIVE.
 12691
 12692
 12693* EXEC CICS WRITE
 12694*         DATASET   (W-ARCH-FILE-ID)
 12695*         FROM      (LETTER-ARCHIVE)
 12696*         RIDFLD    (LA-CONTROL-PRIMARY)
 12697*    END-EXEC.
 12698     MOVE LENGTH OF
 12699      LETTER-ARCHIVE
 12700       TO DFHEIV11
 12701*    MOVE '&$ L                  ''   #00012101' TO DFHEIV0
 12702     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12703     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12704     MOVE X'2020233030303132313031' TO DFHEIV0(25:11)
 12705     CALL 'kxdfhei1' USING DFHEIV0,
 12706           W-ARCH-FILE-ID,
 12707           LETTER-ARCHIVE,
 12708           DFHEIV11,
 12709           LA-CONTROL-PRIMARY,
 12710           DFHEIV99,
 12711           DFHEIV99
 12712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12713
 12714
 12715 5650-EXIT.
 12716     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 262
* EL689.cbl
 12718 5655-WRITE-ARCHIVE-TEXT.
 12719
 12720
 12721* EXEC CICS WRITE
 12722*         DATASET   (W-ARCT-FILE-ID)
 12723*         FROM      (LETTER-ARCHIVE-TEXT)
 12724*         RIDFLD    (LT-CONTROL-PRIMARY)
 12725*    END-EXEC.
 12726     MOVE LENGTH OF
 12727      LETTER-ARCHIVE-TEXT
 12728       TO DFHEIV11
 12729*    MOVE '&$ L                  ''   #00012112' TO DFHEIV0
 12730     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12731     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12732     MOVE X'2020233030303132313132' TO DFHEIV0(25:11)
 12733     CALL 'kxdfhei1' USING DFHEIV0,
 12734           W-ARCT-FILE-ID,
 12735           LETTER-ARCHIVE-TEXT,
 12736           DFHEIV11,
 12737           LT-CONTROL-PRIMARY,
 12738           DFHEIV99,
 12739           DFHEIV99
 12740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12741
 12742
 12743 5655-EXIT.
 12744     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 263
* EL689.cbl
 12746 6000-RESOLVE-VARIABLES.
 12747***************************************************************
 12748*    THIS ROUTINE WILL FORMAT THE SYSTEM DEFINED SYMBOLS      *
 12749*    WITH DATA PERTAINING TO THE FORM WITH VARIABLES.         *
 12750*    THIS ROUTINE IS PERFORM THRU 6000-EXIT IN ORDER TO       *
 12751*    RESOLVE ALL OF THE SYMBOLS.                              *
 12752*                                                             *
 12753***************************************************************
 12754
 12755     PERFORM 6200-GET-COMPANY-DATA THRU 6200-EXIT.
 12756     PERFORM 6250-GET-CNTL2-DATA THRU 6250-EXIT.
 12757     PERFORM 6400-GET-PENDING-DATA THRU 6400-EXIT.
 12758     PERFORM 6450-GET-CERT-DATA THRU 6450-EXIT.
 12759     PERFORM 6500-GET-ACCOUNT-DATA THRU 6500-EXIT
 12760*    PERFORM 6350-GET-CSR-DATA   THRU 6350-EXIT
 12761     PERFORM 6600-GET-COMPENSATION-DATA THRU 6600-EXIT.
 12762     PERFORM 6700-GET-MAIL-DATA THRU 6700-EXIT.
 12763     PERFORM 6300-GET-CARRIER-DATA THRU 6300-EXIT.
 12764     PERFORM 6750-GET-LIFE-BENEFIT-DATA THRU 6750-EXIT.
 12765     PERFORM 6800-GET-A-H-BENEFIT-DATA THRU 6800-EXIT.
 12766     PERFORM 6850-GET-CHECK-DATA THRU 6850-EXIT.
 12767     PERFORM 6900-GET-PYAJ-DATA THRU 6900-EXIT.
 12768     PERFORM 6950-MOVE-SYSTEM-DATA THRU 6950-EXIT.
 12769
 12770     MOVE SPACES                 TO W-REVERSE-DATE-SW.
 12771
 12772 6000-EXIT.
 12773     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 264
* EL689.cbl
 12775 6200-GET-COMPANY-DATA.
 12776
 12777     IF  ADDRSI EQUAL '3'
 12778             AND
 12779         PI-CREATE-LABELS
 12780             AND
 12781         NOT PI-689-LABELS-OVERRIDEN
 12782         NEXT SENTENCE
 12783     ELSE
 12784         IF  W-FILE-NOT-USED (1)
 12785             GO TO 6200-EXIT.
 12786
 12787     MOVE SPACES                 TO W-CNTL-KEY.
 12788     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 12789     MOVE +0                     TO W-CNTL-SEQ-NO.
 12790     MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 12791
 12792
 12793* EXEC CICS HANDLE CONDITION
 12794*         NOTOPEN   (8040-CNTL-NOT-OPEN)
 12795*         NOTFND    (6200-CNTL1-NOT-FOUND)
 12796*    END-EXEC.
 12797*    MOVE '"$JI                  ! + #00012167' TO DFHEIV0
 12798     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12799     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12800     MOVE X'2B20233030303132313637' TO DFHEIV0(25:11)
 12801     CALL 'kxdfhei1' USING DFHEIV0
 12802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12803
 12804
 12805
 12806* EXEC CICS READ
 12807*         DATASET   (W-CNTL-FILE-ID)
 12808*         SET       (ADDRESS OF CONTROL-FILE)
 12809*         RIDFLD    (W-CNTL-KEY)
 12810*    END-EXEC.
 12811*    MOVE '&"S        E          (   #00012172' TO DFHEIV0
 12812     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12813     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12814     MOVE X'2020233030303132313732' TO DFHEIV0(25:11)
 12815     CALL 'kxdfhei1' USING DFHEIV0,
 12816           W-CNTL-FILE-ID,
 12817           DFHEIV20,
 12818           DFHEIV99,
 12819           W-CNTL-KEY,
 12820           DFHEIV99,
 12821           DFHEIV99,
 12822           DFHEIV99
 12823     SET ADDRESS OF CONTROL-FILE TO
 12824         DFHEIV20
 12825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12826
 12827
 12828     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12829     MOVE CF-CL-MAIL-TO-NAME     TO W-LABEL-LINES (1)
 12830                                    W-VG-TEXT (25).
 12831     MOVE CF-CL-IN-CARE-OF       TO W-LABEL-LINES (2).
 12832     MOVE CF-CL-ADDR-LINE-1      TO W-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 265
* EL689.cbl
 12833     MOVE CF-CL-ADDR-LINE-2      TO W-LABEL-LINES (4).
 12834     MOVE CF-CL-CITY-STATE       TO W-LABEL-LINES (5).
 12835
 12836     IF  CF-CL-CAN-POST-CODE
 12837         MOVE CF-CL-CANADIAN-POSTAL-CODE
 12838                                 TO W-CANADIAN-POSTAL-CODES
 12839         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12840         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12841         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12842                                    W-LAB-CAN-FILLER (6)
 12843         GO TO 6200-CONTINUE.
 12844
 12845     IF CF-CL-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 12846         MOVE CF-CL-ZIP-CODE     TO W-WORK-ZIP
 12847         MOVE SPACES             TO W-LABEL-ZIP (6)
 12848         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12849
 12850         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12851             MOVE '-'            TO W-LABEL-DASH (6)
 12852             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12853             GO TO 6200-CONTINUE
 12854         ELSE
 12855             MOVE SPACES         TO W-LABEL-DASH (6)
 12856                                    W-LABEL-2ND-ZIP (6)
 12857             GO TO 6200-CONTINUE.
 12858
 12859     IF  CF-CL-ZIP-CODE-NUM NOT NUMERIC
 12860         GO TO 6200-CONTINUE.
 12861
 12862     MOVE CF-CL-ZIP-CODE-NUM     TO W-WORK-ZIP-NUMERIC.
 12863
 12864     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 12865         COMPUTE W-WORK-ZIP-NUMERIC
 12866             = W-WORK-ZIP-NUMERIC * 10000.
 12867
 12868     MOVE SPACES                 TO W-LABEL-ZIP (6).
 12869     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 12870
 12871     IF  W-WORK-ZIP4 GREATER THAN '0000'
 12872         MOVE '-'                TO W-LABEL-DASH (6)
 12873         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 12874         GO TO 6200-CONTINUE
 12875     ELSE
 12876         MOVE SPACES             TO W-LABEL-DASH (6)
 12877                                    W-LABEL-2ND-ZIP (6)
 12878         GO TO 6200-CONTINUE.
 12879
 12880 6200-CONTINUE.
 12881
 12882     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12883
 12884     IF  ADDRSI EQUAL '3'
 12885             AND
 12886         PI-CREATE-LABELS
 12887             AND
 12888         NOT PI-689-LABELS-OVERRIDEN
 12889         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (1)
 12890         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (2)
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 266
* EL689.cbl
 12891         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (3)
 12892         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (04)
 12893         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (5)
 12894         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (6)
 12895         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12896         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12897         SET W-RG-NDX UP BY +1
 12898     ELSE
 12899         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (1)
 12900         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (2)
 12901         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (3)
 12902         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (4)
 12903         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (5)
 12904         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (6).
 12905
 12906     GO TO 6200-EXIT.
 12907
 12908 6200-CNTL1-NOT-FOUND.
 12909
 12910     MOVE ER-9299                TO EMI-ERROR.
 12911     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12912     MOVE -1                     TO ADDRSL.
 12913     MOVE AL-UANON               TO ADDRSA.
 12914     GO TO 8200-SEND-DATAONLY.
 12915
 12916 6200-EXIT.
 12917     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 267
* EL689.cbl
 12919 6250-GET-CNTL2-DATA.
 12920
 12921     IF  PI-PROCESSOR-ID EQUAL W-LGXX-ID
 12922         GO TO 6250-EXIT.
 12923
 12924     IF  W-FILE-NOT-USED (11)
 12925         GO TO 6250-EXIT.
 12926
 12927     MOVE SPACES                 TO W-CNTL-KEY.
 12928     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 12929     MOVE +0                     TO W-CNTL-SEQ-NO.
 12930     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 12931     MOVE PI-PROCESSOR-ID        TO W-CNTL-GENL.
 12932
 12933
 12934* EXEC CICS HANDLE CONDITION
 12935*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 12936*         NOTFND     (6250-CNTL2-NOT-FOUND)
 12937*    END-EXEC.
 12938*    MOVE '"$JI                  ! , #00012283' TO DFHEIV0
 12939     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12940     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12941     MOVE X'2C20233030303132323833' TO DFHEIV0(25:11)
 12942     CALL 'kxdfhei1' USING DFHEIV0
 12943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12944
 12945
 12946
 12947* EXEC CICS READ
 12948*         DATASET    (W-CNTL-FILE-ID)
 12949*         SET        (ADDRESS OF CONTROL-FILE)
 12950*         RIDFLD     (W-CNTL-KEY)
 12951*    END-EXEC.
 12952*    MOVE '&"S        E          (   #00012288' TO DFHEIV0
 12953     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12954     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12955     MOVE X'2020233030303132323838' TO DFHEIV0(25:11)
 12956     CALL 'kxdfhei1' USING DFHEIV0,
 12957           W-CNTL-FILE-ID,
 12958           DFHEIV20,
 12959           DFHEIV99,
 12960           W-CNTL-KEY,
 12961           DFHEIV99,
 12962           DFHEIV99,
 12963           DFHEIV99
 12964     SET ADDRESS OF CONTROL-FILE TO
 12965         DFHEIV20
 12966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12967
 12968
 12969     MOVE CF-PROCESSOR           TO W-VG-TEXT (153).
 12970     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (151).
 12971     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (152).
 12972     GO TO 6250-EXIT.
 12973
 12974 6250-CNTL2-NOT-FOUND.
 12975
 12976     MOVE ER-9299                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 268
* EL689.cbl
 12977     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12978     MOVE -1                     TO MAINTL.
 12979     MOVE AL-UANON               TO MAINTA.
 12980     GO TO 8200-SEND-DATAONLY.
 12981
 12982 6250-EXIT.
 12983     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 269
* EL689.cbl
 12985 6300-GET-CARRIER-DATA.
 12986
 12987     IF  ADDRSI EQUAL '2'
 12988             AND
 12989         PI-CREATE-LABELS
 12990             AND
 12991         NOT PI-689-LABELS-OVERRIDEN
 12992         NEXT SENTENCE
 12993     ELSE
 12994         IF  W-FILE-NOT-USED (4)
 12995             GO TO 6300-EXIT.
 12996
 12997     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
 12998         MOVE SPACES             TO W-CNTL-KEY
 12999         MOVE PI-COMPANY-ID      TO W-CNTL-COMPANY-ID
 13000         MOVE +0                 TO W-CNTL-SEQ-NO
 13001         MOVE '6'                TO W-CNTL-RECORD-TYPE
 13002         MOVE PI-689-CARRIER     TO W-CNTL-GEN4
 13003     ELSE
 13004         MOVE ER-9327            TO EMI-ERROR
 13005         MOVE -1                 TO CARRIERL
 13006         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13007         GO TO 6300-EXIT.
 13008
 13009
 13010* EXEC CICS HANDLE CONDITION
 13011*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 13012*         NOTFND     (6300-CNTL6-NOT-FOUND)
 13013*    END-EXEC.
 13014*    MOVE '"$JI                  ! - #00012334' TO DFHEIV0
 13015     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13016     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13017     MOVE X'2D20233030303132333334' TO DFHEIV0(25:11)
 13018     CALL 'kxdfhei1' USING DFHEIV0
 13019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13020
 13021
 13022
 13023* EXEC CICS READ
 13024*         DATASET    (W-CNTL-FILE-ID)
 13025*         SET        (ADDRESS OF CONTROL-FILE)
 13026*         RIDFLD     (W-CNTL-KEY)
 13027*    END-EXEC.
 13028*    MOVE '&"S        E          (   #00012339' TO DFHEIV0
 13029     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13030     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13031     MOVE X'2020233030303132333339' TO DFHEIV0(25:11)
 13032     CALL 'kxdfhei1' USING DFHEIV0,
 13033           W-CNTL-FILE-ID,
 13034           DFHEIV20,
 13035           DFHEIV99,
 13036           W-CNTL-KEY,
 13037           DFHEIV99,
 13038           DFHEIV99,
 13039           DFHEIV99
 13040     SET ADDRESS OF CONTROL-FILE TO
 13041         DFHEIV20
 13042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 270
* EL689.cbl
 13043
 13044
 13045     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13046     MOVE CF-MAIL-TO-NAME        TO W-LABEL-LINES (1).
 13047     MOVE CF-IN-CARE-OF          TO W-LABEL-LINES (2).
 13048     MOVE CF-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 13049     MOVE CF-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 13050     MOVE CF-CITY-STATE          TO W-LABEL-LINES (5).
 13051
 13052     IF  CF-CANADIAN-POST-CODE
 13053         MOVE CF-CANADIAN-POSTAL-CODE
 13054                                 TO W-CANADIAN-POSTAL-CODES
 13055         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13056         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13057         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13058                                    W-LAB-CAN-FILLER (6)
 13059         GO TO 6300-CONTINUE.
 13060
 13061     IF CF-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 13062         MOVE CF-ZIP-CODE        TO W-WORK-ZIP
 13063         MOVE SPACES             TO W-LABEL-ZIP (6)
 13064         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13065         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13066             MOVE '-'            TO W-LABEL-DASH (6)
 13067             MOVE W-WORK-ZIP4
 13068                                 TO W-LABEL-2ND-ZIP (6)
 13069             GO TO 6300-CONTINUE
 13070         ELSE
 13071             MOVE SPACES         TO W-LABEL-DASH (6)
 13072                                    W-LABEL-2ND-ZIP (6)
 13073             GO TO 6300-CONTINUE.
 13074
 13075     IF  CF-ZIP-CODE-NUM NOT NUMERIC
 13076         GO TO 6300-CONTINUE.
 13077
 13078     MOVE CF-ZIP-CODE-NUM TO W-WORK-ZIP-NUMERIC.
 13079
 13080     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 13081         COMPUTE W-WORK-ZIP-NUMERIC
 13082             = W-WORK-ZIP-NUMERIC * 10000.
 13083
 13084     MOVE SPACES                 TO W-LABEL-ZIP (6).
 13085     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 13086
 13087     IF  W-WORK-ZIP4 GREATER THAN '0000'
 13088         MOVE '-'                TO W-LABEL-DASH (6)
 13089         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 13090         GO TO 6300-CONTINUE
 13091     ELSE
 13092         MOVE SPACES             TO W-LABEL-DASH (6)
 13093                                    W-LABEL-2ND-ZIP (6)
 13094         GO TO 6300-CONTINUE.
 13095
 13096 6300-CONTINUE.
 13097
 13098     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13099
 13100     IF  ADDRSI EQUAL '2'
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 271
* EL689.cbl
 13101             AND
 13102         PI-CREATE-LABELS
 13103             AND
 13104         NOT PI-689-LABELS-OVERRIDEN
 13105         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (20)
 13106         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (21)
 13107         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (22)
 13108         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (23)
 13109         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (24)
 13110         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (25)
 13111         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13112         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13113         SET W-RG-NDX UP BY +1
 13114     ELSE
 13115         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (20)
 13116         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (21)
 13117         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (22)
 13118         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (23)
 13119         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (24)
 13120         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (25).
 13121
 13122     IF  W-FULL-DATA
 13123         MOVE ZEROS              TO W-PHONE-IN
 13124         MOVE CF-PHONE-NO        TO W-PHONE-IN
 13125         MOVE W-PHI-AREA         TO W-PO-AREA
 13126         MOVE W-PHI-PFX          TO W-PO-PFX
 13127         MOVE W-PHI-SFX          TO W-PO-SFX
 13128         MOVE W-PHONE-OUT        TO W-VG-TEXT (26).
 13129
 13130     GO TO 6300-EXIT.
 13131
 13132 6300-CNTL6-NOT-FOUND.
 13133
 13134     MOVE ER-9298                TO EMI-ERROR.
 13135     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13136     MOVE -1                     TO ADDRSL.
 13137     MOVE AL-UANON               TO ADDRSA.
 13138     GO TO 8200-SEND-DATAONLY.
 13139
 13140 6300-EXIT.
 13141     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 272
* EL689.cbl
 13143 6350-GET-CSR-DATA.
 13144     IF W-VG-TEXT (148) (1:4) = '****' OR SPACES
 13145        GO TO 6350-EXIT
 13146     END-IF
 13147*    IF W-FILE-NOT-USED (11)
 13148*       GO TO 6350-EXIT
 13149*    END-IF
 13150     MOVE SPACES                 TO W-CNTL-KEY
 13151     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
 13152     MOVE +0                     TO W-CNTL-SEQ-NO
 13153     MOVE '2'                    TO W-CNTL-RECORD-TYPE
 13154     MOVE CO-CSR-CODE            TO W-CNTL-GENL
 13155
 13156* EXEC CICS HANDLE CONDITION
 13157*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 13158*         NOTFND     (6350-CNTL2-NOT-FOUND)
 13159*    END-EXEC
 13160*    MOVE '"$JI                  ! . #00012455' TO DFHEIV0
 13161     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13162     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13163     MOVE X'2E20233030303132343535' TO DFHEIV0(25:11)
 13164     CALL 'kxdfhei1' USING DFHEIV0
 13165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13166
 13167* EXEC CICS READ
 13168*         DATASET    (W-CNTL-FILE-ID)
 13169*         SET        (ADDRESS OF CONTROL-FILE)
 13170*         RIDFLD     (W-CNTL-KEY)
 13171*    END-EXEC
 13172*    MOVE '&"S        E          (   #00012459' TO DFHEIV0
 13173     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13174     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13175     MOVE X'2020233030303132343539' TO DFHEIV0(25:11)
 13176     CALL 'kxdfhei1' USING DFHEIV0,
 13177           W-CNTL-FILE-ID,
 13178           DFHEIV20,
 13179           DFHEIV99,
 13180           W-CNTL-KEY,
 13181           DFHEIV99,
 13182           DFHEIV99,
 13183           DFHEIV99
 13184     SET ADDRESS OF CONTROL-FILE TO
 13185         DFHEIV20
 13186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13187     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 13188     GO TO 6350-EXIT
 13189     .
 13190 6350-CNTL2-NOT-FOUND.
 13191     MOVE ER-9299                TO EMI-ERROR.
 13192     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13193     MOVE -1                     TO MAINTL.
 13194     MOVE AL-UANON               TO MAINTA.
 13195     GO TO 8200-SEND-DATAONLY.
 13196 6350-EXIT.
 13197     EXIT.
 13198 6400-GET-PENDING-DATA.
 13199
 13200     IF (ADDRSI EQUAL '7')
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 273
* EL689.cbl
 13201        AND (PI-CREATE-LABELS)
 13202        AND (NOT PI-689-LABELS-OVERRIDEN)
 13203        CONTINUE
 13204     ELSE
 13205        IF PI-689-DATA-SOURCE = '4'
 13206           CONTINUE
 13207        ELSE
 13208           IF W-FILE-NOT-USED (9)
 13209              GO TO 6400-EXIT
 13210           END-IF
 13211        END-IF
 13212     END-IF
 13213     IF  W-PNDB-ENTRY EQUAL LOW-VALUES
 13214         MOVE ER-9327            TO EMI-ERROR
 13215         MOVE -1                 TO MAINTL
 13216         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13217         GO TO 6400-EXIT.
 13218
 13219 6400-READ-PNDB-ONLY.
 13220
 13221
 13222* EXEC CICS HANDLE CONDITION
 13223*         NOTOPEN (8060-PNDB-NOT-OPEN)
 13224*         NOTFND  (8070-PNDB-NOT-FOUND)
 13225*    END-EXEC.
 13226*    MOVE '"$JI                  ! / #00012498' TO DFHEIV0
 13227     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13228     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13229     MOVE X'2F20233030303132343938' TO DFHEIV0(25:11)
 13230     CALL 'kxdfhei1' USING DFHEIV0
 13231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13232
 13233
 13234
 13235* EXEC CICS READ
 13236*         DATASET (W-PNDB-FILE-ID)
 13237*         SET     (ADDRESS OF PENDING-BUSINESS)
 13238*         RIDFLD  (W-PNDB-KEY)
 13239*    END-EXEC.
 13240*    MOVE '&"S        E          (   #00012503' TO DFHEIV0
 13241     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13242     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13243     MOVE X'2020233030303132353033' TO DFHEIV0(25:11)
 13244     CALL 'kxdfhei1' USING DFHEIV0,
 13245           W-PNDB-FILE-ID,
 13246           DFHEIV20,
 13247           DFHEIV99,
 13248           W-PNDB-KEY,
 13249           DFHEIV99,
 13250           DFHEIV99,
 13251           DFHEIV99
 13252     SET ADDRESS OF PENDING-BUSINESS TO
 13253         DFHEIV20
 13254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13255
 13256
 13257     MOVE 'Y'                    TO W-PNDB-FOUND-SW.
 13258
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 274
* EL689.cbl
 13259     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 13260         MOVE PB-SV-CARRIER      TO PB-CARRIER
 13261                                    PI-689-CARRIER
 13262         MOVE PB-SV-GROUPING     TO PB-GROUPING
 13263                                    PI-689-GROUPING
 13264         MOVE PB-SV-STATE        TO PB-STATE
 13265                                    PI-689-STATE
 13266         MOVE PB-CONTROL-BY-ACCOUNT
 13267                                 TO W-CERT-KEY
 13268                                    W-MAIL-KEY
 13269                                    W-ACCT-KEY
 13270         MOVE PB-ACCOUNT         TO PI-689-ACCOUNT
 13271         MOVE PB-CERT-EFF-DT     TO PI-689-EFF-DATE
 13272         MOVE PB-CERT-NO         TO PI-689-CERT-NO.
 13273
 13274 6400-ONLY-STOP.
 13275
 13276     MOVE PB-ENTRY-BATCH         TO W-VG-TEXT (130).
 13277
 13278     IF  NOT PB-ISSUE
 13279         GO TO 6400-CANCEL.
 13280
 13281     MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1.
 13282     MOVE SPACES                 TO DC-OPTION-CODE.
 13283     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13284
 13285     IF  NO-CONVERSION-ERROR
 13286         MOVE DC-GREG-DATE-1-EDIT
 13287                                 TO W-VG-TEXT (110).
 13288
 13289     MOVE PB-I-AGE               TO W-EDIT-3-0.
 13290     MOVE W-EDIT-3-0             TO W-VG-TEXT (124).
 13291     MOVE PB-I-LF-PREMIUM-AMT    TO W-EDIT-7-2.
 13292     MOVE W-EDIT-7-2             TO W-VG-TEXT (111).
 13293     MOVE PB-I-AH-PREMIUM-AMT    TO W-EDIT-7-2.
 13294     MOVE W-EDIT-7-2             TO W-VG-TEXT (112).
 13295     MOVE PB-I-LF-PREM-CALC      TO W-EDIT-7-2.
 13296     MOVE W-EDIT-7-2             TO W-VG-TEXT (113).
 13297     MOVE PB-I-AH-PREM-CALC      TO W-EDIT-7-2.
 13298     MOVE W-EDIT-7-2             TO W-VG-TEXT (114).
 13299     MOVE PB-I-LF-BENEFIT-AMT    TO W-EDIT-9-2.
 13300     MOVE W-EDIT-9-2             TO W-VG-TEXT (125).
 13301     MOVE PB-I-AH-BENEFIT-AMT    TO W-EDIT-7-2.
 13302     MOVE W-EDIT-7-2             TO W-VG-TEXT (126).
 13303     MOVE PB-I-LF-RATE           TO W-EDIT-2-5-S.
 13304     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (127).
 13305     MOVE PB-I-AH-RATE           TO W-EDIT-2-5-S.
 13306     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (128).
 13307     MOVE PB-I-LOAN-TERM         TO W-EDIT-3-0.
 13308     MOVE W-EDIT-3-0             TO W-VG-TEXT (129).
 13309
 13310     COMPUTE W-DIFFERENCE
 13311         = PB-I-LF-PREM-CALC - PB-I-LF-PREMIUM-AMT.
 13312
 13313     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13314     MOVE W-EDIT-7-2             TO W-VG-TEXT (115).
 13315
 13316     COMPUTE W-DIFFERENCE
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 275
* EL689.cbl
 13317         = PB-I-AH-PREM-CALC - PB-I-AH-PREMIUM-AMT.
 13318
 13319     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13320     MOVE W-EDIT-7-2             TO W-VG-TEXT (116).
 13321
 13322 6400-CANCEL.
 13323
 13324     IF  NOT PB-CANCELLATION
 13325         GO TO 6400-EXIT.
 13326
 13327     MOVE PB-CI-AH-PRIOR-CANCEL-DT
 13328                                 TO DC-BIN-DATE-1.
 13329     MOVE SPACES                 TO DC-OPTION-CODE.
 13330     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13331
 13332     IF  NO-CONVERSION-ERROR
 13333         MOVE DC-GREG-DATE-1-EDIT
 13334                                 TO W-VG-TEXT (117).
 13335
 13336     MOVE PB-C-LF-CANCEL-AMT     TO W-EDIT-7-2.
 13337     MOVE W-EDIT-7-2             TO W-VG-TEXT (118).
 13338     MOVE PB-C-AH-CANCEL-AMT     TO W-EDIT-7-2.
 13339     MOVE W-EDIT-7-2             TO W-VG-TEXT (119).
 13340     MOVE PB-C-LF-REF-CALC       TO W-EDIT-7-2.
 13341     MOVE W-EDIT-7-2             TO W-VG-TEXT (120).
 13342     MOVE PB-C-AH-REF-CALC       TO W-EDIT-7-2.
 13343     MOVE W-EDIT-7-2             TO W-VG-TEXT (121).
 13344     COMPUTE W-EDIT-7-2 = PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT
 13345     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 13346
 13347     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 13348        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 13349     END-IF
 13350     MOVE PB-C-NH-INT-ON-REFS    TO W-EDIT-7-2
 13351     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 13352     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
 13353     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-1
 13354        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-1
 13355     END-IF
 13356     MOVE SPACES                 TO DC-OPTION-CODE
 13357     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 13358
 13359     IF NO-CONVERSION-ERROR
 13360        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 13361     END-IF
 13362
 13363     COMPUTE W-DIFFERENCE = PB-C-LF-REF-CALC
 13364                           - PB-C-LF-CANCEL-AMT.
 13365
 13366     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13367     MOVE W-EDIT-7-2             TO W-VG-TEXT (122).
 13368
 13369     COMPUTE W-DIFFERENCE = PB-C-AH-REF-CALC
 13370                           - PB-C-AH-CANCEL-AMT.
 13371
 13372     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13373     MOVE W-EDIT-7-2             TO W-VG-TEXT (123).
 13374
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 276
* EL689.cbl
 13375 6400-EXIT.
 13376     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 277
* EL689.cbl
 13378 6450-GET-CERT-DATA.
 13379     IF  W-FILE-NOT-USED (8)
 13380         GO TO 6450-EXIT.
 13381
 13382     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 13383         MOVE ER-9327            TO EMI-ERROR
 13384         MOVE -1                 TO MAINTL
 13385         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13386         GO TO 6450-EXIT.
 13387
 13388 6450-READ-CERT-ONLY.
 13389
 13390
 13391* EXEC CICS HANDLE CONDITION
 13392*         NOTOPEN (8030-CERT-NOT-OPEN)
 13393*         NOTFND  (8035-CERT-NOT-FOUND)
 13394*    END-EXEC.
 13395*    MOVE '"$JI                  ! 0 #00012642' TO DFHEIV0
 13396     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13397     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13398     MOVE X'3020233030303132363432' TO DFHEIV0(25:11)
 13399     CALL 'kxdfhei1' USING DFHEIV0
 13400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13401
 13402
 13403
 13404* EXEC CICS READ
 13405*         DATASET (W-CERT-FILE-ID)
 13406*         SET     (ADDRESS OF CERTIFICATE-MASTER)
 13407*         RIDFLD  (W-CERT-KEY)
 13408*    END-EXEC.
 13409*    MOVE '&"S        E          (   #00012647' TO DFHEIV0
 13410     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13411     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13412     MOVE X'2020233030303132363437' TO DFHEIV0(25:11)
 13413     CALL 'kxdfhei1' USING DFHEIV0,
 13414           W-CERT-FILE-ID,
 13415           DFHEIV20,
 13416           DFHEIV99,
 13417           W-CERT-KEY,
 13418           DFHEIV99,
 13419           DFHEIV99,
 13420           DFHEIV99
 13421     SET ADDRESS OF CERTIFICATE-MASTER TO
 13422         DFHEIV20
 13423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13424
 13425
 13426     MOVE 'Y'                    TO W-CERT-FOUND-SW.
 13427
 13428 6450-ONLY-STOP.
 13429
 13430     MOVE CM-INSURED-LAST-NAME   TO W-VG-TEXT (108).
 13431
 13432     MOVE CM-BENEFICIARY         TO W-VG-TEXT (109).
 13433
 13434     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13435     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 278
* EL689.cbl
 13436     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13437     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13438     MOVE WS-NAME-WORK           TO W-VG-TEXT (95).
 13439
 13440     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13441     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13442     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13443     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 13444     MOVE WS-NAME-WORK           TO W-VG-TEXT (94).
 13445
 13446     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13447     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13448     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 13449     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13450     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13451     MOVE WS-NAME-WORK           TO W-VG-TEXT (90).
 13452
 13453     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13454     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13455     MOVE SPACES                 TO W-NAME-MIDDLE.
 13456     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13457     MOVE WS-NAME-WORK           TO W-VG-TEXT (104).
 13458
 13459     MOVE CM-INSURED-FIRST-NAME  TO W-VG-TEXT (91).
 13460     MOVE CM-INSURED-INITIAL2    TO W-VG-TEXT (92).
 13461
 13462     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13463     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13464     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13465     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13466     MOVE WS-NAME-WORK           TO W-VG-TEXT (103)
 13467                                    W-LABEL-JOINT-NAME.
 13468
 13469     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13470     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13471     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13472     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 13473     MOVE WS-NAME-WORK           TO W-VG-TEXT (102).
 13474
 13475     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13476     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13477     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 13478     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13479     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13480     MOVE WS-NAME-WORK           TO W-VG-TEXT (99).
 13481
 13482     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13483     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13484     MOVE SPACES                 TO W-NAME-MIDDLE.
 13485     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13486     MOVE WS-NAME-WORK           TO W-VG-TEXT (105).
 13487
 13488     MOVE CM-JT-FIRST-NAME       TO W-VG-TEXT (100).
 13489     MOVE CM-JT-INITIAL          TO W-VG-TEXT (101).
 13490
 13491     COMPUTE W-WORK-AMOUNT
 13492         = CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT.
 13493     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 279
* EL689.cbl
 13494     MOVE W-EDIT-9-2             TO W-VG-TEXT (97).
 13495     MOVE CM-AH-PREMIUM-AMT      TO W-EDIT-7-2.
 13496     MOVE W-EDIT-7-2             TO W-VG-TEXT (98).
 13497
 13498     IF  CM-SEX-FEMAL
 13499         MOVE 'MS.'              TO W-VG-TEXT (96)
 13500
 13501     ELSE
 13502         MOVE 'MR.'              TO W-VG-TEXT (96).
 13503
 13504     MOVE CM-CARRIER OF CERTIFICATE-MASTER
 13505                                 TO W-VG-TEXT (70).
 13506     MOVE CM-GROUPING            TO W-VG-TEXT (71).
 13507     MOVE CM-ACCOUNT             TO W-VG-TEXT (72).
 13508     MOVE CM-CERT-NO             TO W-VG-TEXT (73).
 13509     MOVE CM-INSURED-ISSUE-AGE   TO W-DISPLAY-3.
 13510     MOVE W-DISPLAY-3            TO W-VG-TEXT (83).
 13511     MOVE CM-LOAN-NUMBER         TO W-VG-TEXT (86).
 13512     MOVE CM-LOAN-BALANCE        TO W-EDIT-7-2.
 13513     MOVE W-EDIT-7-2             TO W-VG-TEXT (87).
 13514     MOVE CM-MEMBER-NO           TO W-VG-TEXT (88).
 13515     MOVE CM-SOC-SEC-NO          TO W-VG-TEXT (89).
 13516     MOVE CM-POLICY-FORM-NO      TO W-VG-TEXT (83).
 13517     MOVE CM-LF-ORIG-TERM        TO W-EDIT-3-0.
 13518     MOVE W-EDIT-3-0             TO W-VG-TEXT (77).
 13519     MOVE CM-LF-BENEFIT-AMT      TO W-EDIT-9-2.
 13520     MOVE W-EDIT-9-2             TO W-VG-TEXT (79).
 13521     MOVE CM-AH-ORIG-TERM        TO W-EDIT-3-0.
 13522     MOVE W-EDIT-3-0             TO W-VG-TEXT (78).
 13523     MOVE CM-AH-BENEFIT-AMT      TO W-EDIT-7-2.
 13524     MOVE W-EDIT-7-2             TO W-VG-TEXT (80).
 13525     MOVE CM-AH-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 13526     MOVE W-EDIT-7-2             TO W-VG-TEXT (107).
 13527     MOVE CM-LF-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 13528     MOVE W-EDIT-7-2             TO W-VG-TEXT (106).
 13529     IF PI-689-DATA-SOURCE NOT = '4'
 13530     COMPUTE W-EDIT-7-2 = CM-LF-ITD-CANCEL-AMT
 13531        + CM-AH-ITD-CANCEL-AMT
 13532     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 13533     IF CM-NH-INT-ON-REFS NOT NUMERIC
 13534        MOVE ZEROS               TO CM-NH-INT-ON-REFS
 13535     END-IF
 13536     MOVE CM-NH-INT-ON-REFS      TO W-EDIT-7-2
 13537     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 13538     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
 13539     IF CM-AH-CANCEL-DT > DC-BIN-DATE-1
 13540        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
 13541     END-IF
 13542     MOVE SPACES                 TO DC-OPTION-CODE
 13543     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 13544
 13545     IF NO-CONVERSION-ERROR
 13546        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 13547     END-IF
 13548     END-IF
 13549     COMPUTE W-WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 13550     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
 13551     MOVE W-EDIT-9-2             TO W-VG-TEXT (93).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 280
* EL689.cbl
 13552
 13553     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1.
 13554     MOVE SPACES                 TO DC-OPTION-CODE.
 13555     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13556
 13557     IF  NO-CONVERSION-ERROR
 13558         MOVE DC-GREG-DATE-1-EDIT
 13559                                 TO W-VG-TEXT (81).
 13560
 13561     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1.
 13562     MOVE SPACES                 TO DC-OPTION-CODE.
 13563     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13564
 13565     IF  NO-CONVERSION-ERROR
 13566         MOVE DC-GREG-DATE-1-EDIT
 13567                                 TO W-VG-TEXT (82).
 13568
 13569     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13570     MOVE SPACES                 TO DC-OPTION-CODE.
 13571     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13572
 13573     IF  NO-CONVERSION-ERROR
 13574         MOVE DC-GREG-DATE-1-EDIT
 13575                                 TO W-VG-TEXT (74).
 13576
 13577     MOVE CM-LF-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 13578
 13579     IF  CM-PMT-EXTENSION-DAYS NUMERIC
 13580         MOVE CM-PMT-EXTENSION-DAYS
 13581                                 TO DC-ELAPSED-DAYS
 13582     ELSE
 13583         MOVE ZEROS              TO DC-ELAPSED-DAYS.
 13584
 13585     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13586     MOVE '6'                    TO DC-OPTION-CODE.
 13587     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13588
 13589     IF  NO-CONVERSION-ERROR
 13590         MOVE DC-GREG-DATE-1-EDIT
 13591                                 TO W-VG-TEXT (75).
 13592
 13593     MOVE CM-AH-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 13594     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13595     MOVE '6'                    TO DC-OPTION-CODE.
 13596     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13597
 13598     IF  NO-CONVERSION-ERROR
 13599         MOVE DC-GREG-DATE-1-EDIT
 13600                                 TO W-VG-TEXT (76).
 13601
 13602 6450-EXIT.
 13603     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 281
* EL689.cbl
 13605 6500-GET-ACCOUNT-DATA.
 13606
 13607     IF  ADDRSI EQUAL '1'
 13608             AND
 13609         PI-CREATE-LABELS
 13610             AND
 13611         NOT PI-689-LABELS-OVERRIDEN
 13612         NEXT SENTENCE
 13613     ELSE
 13614         IF  W-FILE-NOT-USED (6)
 13615             GO TO 6500-EXIT
 13616         END-IF
 13617     END-IF.
 13618
 13619 6500-READ-ACCT-ONLY.
 13620
 13621     IF  W-ACCT-ACCOUNT EQUAL LOW-VALUES
 13622         MOVE ER-9327            TO EMI-ERROR
 13623         MOVE -1                 TO MAINTL
 13624         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13625         GO TO 6500-EXIT.
 13626
 13627
 13628* EXEC CICS HANDLE CONDITION
 13629*         NOTOPEN    (8020-ACCT-NOT-OPEN)
 13630*         NOTFND     (6500-ACCT-NOT-FOUND)
 13631*         ENDFILE    (6500-ONLY-STOP)
 13632*    END-EXEC.
 13633*    MOVE '"$JI''                 ! 1 #00012854' TO DFHEIV0
 13634     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 13635     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13636     MOVE X'3120233030303132383534' TO DFHEIV0(25:11)
 13637     CALL 'kxdfhei1' USING DFHEIV0
 13638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13639
 13640
 13641
 13642* EXEC CICS STARTBR
 13643*         RIDFLD     (W-ACCT-KEY)
 13644*         DATASET    (W-ACCT-FILE-ID)
 13645*         KEYLENGTH  (20)
 13646*         GENERIC
 13647*    END-EXEC.
 13648     MOVE 20
 13649       TO DFHEIV11
 13650     MOVE 0
 13651       TO DFHEIV12
 13652*    MOVE '&,   KG    G          &   #00012860' TO DFHEIV0
 13653     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 13654     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13655     MOVE X'2020233030303132383630' TO DFHEIV0(25:11)
 13656     CALL 'kxdfhei1' USING DFHEIV0,
 13657           W-ACCT-FILE-ID,
 13658           W-ACCT-KEY,
 13659           DFHEIV11,
 13660           DFHEIV12,
 13661           DFHEIV99
 13662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 282
* EL689.cbl
 13663
 13664
 13665     MOVE W-ACCT-PARTIAL-KEY     TO W-ACCT-SAVE-KEY.
 13666     MOVE 'Y'                    TO W-ACCT-BROWSE-STARTED-SW.
 13667
 13668 6500-READNEXT.
 13669
 13670
 13671* EXEC CICS READNEXT
 13672*         DATASET    (W-ACCT-FILE-ID)
 13673*         SET        (ADDRESS OF ACCOUNT-MASTER)
 13674*         RIDFLD     (W-ACCT-KEY)
 13675*    END-EXEC.
 13676     MOVE 0
 13677       TO DFHEIV11
 13678*    MOVE '&.S                   )   #00012872' TO DFHEIV0
 13679     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13680     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13681     MOVE X'2020233030303132383732' TO DFHEIV0(25:11)
 13682     CALL 'kxdfhei1' USING DFHEIV0,
 13683           W-ACCT-FILE-ID,
 13684           DFHEIV20,
 13685           DFHEIV99,
 13686           W-ACCT-KEY,
 13687           DFHEIV99,
 13688           DFHEIV11,
 13689           DFHEIV99,
 13690           DFHEIV99
 13691     SET ADDRESS OF ACCOUNT-MASTER TO
 13692         DFHEIV20
 13693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13694
 13695
 13696     IF  W-ACCT-PARTIAL-KEY NOT EQUAL W-ACCT-SAVE-KEY
 13697         IF  PRIOR-MATCH-ACCT-PKEY
 13698             CONTINUE
 13699*            GO TO 6500-ONLY-STOP
 13700         ELSE
 13701             IF  W-FILE-NOT-USED (6)
 13702                 PERFORM 6500-ENDBR
 13703                 GO TO 6500-EXIT
 13704             ELSE
 13705                 GO TO 6500-ACCT-NOT-FOUND
 13706             END-IF
 13707         END-IF
 13708     ELSE
 13709         SET PRIOR-MATCH-ACCT-PKEY TO TRUE
 13710         MOVE AM-CARRIER           TO WS-SAV-AM-CARRIER
 13711         MOVE AM-ACCOUNT           TO WS-SAV-AM-ACCOUNT
 13712         MOVE AM-DEFN-1            TO WS-SAV-AM-DEFN-1
 13713         MOVE AM-REMIT-TO          TO WS-SAV-AM-REMIT-TO
 13714         MOVE AM-NAME              TO WS-SAV-AM-NAME
 13715         MOVE AM-PERSON            TO WS-SAV-AM-PERSON
 13716         MOVE AM-ADDRS             TO WS-SAV-AM-ADDRS
 13717         MOVE SPACES               TO WS-SAV-AM-CITY
 13718*        MOVE AM-CITY              TO WS-SAV-AM-CITY
 13719         STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 13720            DELIMITED BY '  ' INTO WS-SAV-AM-CITY
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 283
* EL689.cbl
 13721         END-STRING
 13722         MOVE AM-ZIP               TO WS-SAV-AM-ZIP
 13723         MOVE AM-TEL-NO            TO WS-SAV-AM-TEL-NO
 13724         MOVE AM-CONTROL-NAME      TO WS-SAV-AM-CONTROL-NAME
 13725         MOVE AM-CSR-CODE          TO WS-SAV-AM-CSR-CODE
 13726         MOVE AM-ACCOUNT           TO WS-SAV-AM-ERACCT-ACCOUNT
 13727         GO TO 6500-READNEXT
 13728     END-IF
 13729     .
 13730 6500-ONLY-STOP.
 13731
 13732     IF  NOT PI-NO-CARRIER-SECURITY
 13733             AND
 13734         PI-CARRIER-SECURITY NOT = WS-SAV-AM-CARRIER
 13735         MOVE -1                 TO CARRIERL
 13736         MOVE AL-UANON           TO CARRIERA
 13737         MOVE ER-9095            TO EMI-ERROR
 13738         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13739         PERFORM 6500-ENDBR
 13740         GO TO 8200-SEND-DATAONLY.
 13741
 13742     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13743     MOVE WS-SAV-AM-NAME         TO W-LABEL-LINES (1).
 13744     MOVE WS-SAV-AM-PERSON       TO W-LABEL-LINES (2).
 13745     MOVE WS-SAV-AM-ADDRS        TO W-LABEL-LINES (3).
 13746     MOVE WS-SAV-AM-CITY         TO W-LABEL-LINES (4).
 13747
 13748     MOVE WS-SAV-AM-ZIP          TO W-WORK-ZIP.
 13749     MOVE SPACES                 TO W-LABEL-ZIP (5).
 13750
 13751     IF  SAVE-AM-CANADIAN-POST-CODE
 13752         MOVE WS-SAV-AM-CANADIAN-POSTAL-CODE
 13753                                 TO W-CANADIAN-POSTAL-CODES
 13754         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 13755         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 13756         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 13757                                    W-LAB-CAN-FILLER (5)
 13758     ELSE
 13759         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 13760
 13761         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13762             MOVE '-'            TO W-LABEL-DASH (5)
 13763             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 13764         ELSE
 13765             MOVE SPACES         TO W-LABEL-DASH (5)
 13766                                    W-LABEL-2ND-ZIP (5).
 13767
 13768     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13769
 13770     IF  ADDRSI EQUAL '1'
 13771             AND
 13772         PI-CREATE-LABELS
 13773             AND
 13774         NOT PI-689-LABELS-OVERRIDEN
 13775         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 13776                                    W-VG-TEXT (40)
 13777         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 13778                                    W-VG-TEXT (41)
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 284
* EL689.cbl
 13779         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 13780                                    W-VG-TEXT (42)
 13781         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13782                                    W-VG-TEXT (43)
 13783         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13784                                    W-VG-TEXT (44)
 13785         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13786                                    W-VG-TEXT (45)
 13787         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13788         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13789         SET W-RG-NDX UP BY +1
 13790     ELSE
 13791         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (40)
 13792         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (41)
 13793         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (42)
 13794         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (43)
 13795         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (44)
 13796         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (45).
 13797
 13798     IF  WS-SAV-AM-TEL-NO NOT NUMERIC
 13799             OR
 13800         WS-SAV-AM-TEL-NO EQUAL ZEROS
 13801         MOVE SPACES             TO W-VG-TEXT (46)
 13802     ELSE
 13803         MOVE ZEROS                  TO W-PHONE-IN
 13804         MOVE WS-SAV-AM-AREA-CODE    TO W-PO-AREA
 13805         MOVE WS-SAV-AM-TEL-PRE      TO W-PO-PFX
 13806         MOVE WS-SAV-AM-TEL-NBR      TO W-PO-SFX
 13807         MOVE W-PHONE-OUT            TO W-VG-TEXT (46).
 13808
 13809     IF WS-SAV-AM-CONTROL-NAME (1:1) NOT = LOW-VALUES
 13810        MOVE WS-SAV-AM-CONTROL-NAME  TO W-VG-TEXT (47)
 13811     ELSE
 13812        MOVE SPACES                   TO W-VG-TEXT (47)
 13813     END-IF.
 13814     MOVE WS-SAV-AM-CSR-CODE     TO W-VG-TEXT (48)
 13815     MOVE WS-SAV-AM-ERACCT-ACCOUNT
 13816                                 TO W-VG-TEXT (49)
 13817
 13818     MOVE WS-SAV-AM-ACCOUNT      TO W-VG-TEXT (72)
 13819     PERFORM 6500-ENDBR.
 13820
 13821     GO TO 6500-EXIT.
 13822
 13823 6500-ENDBR.
 13824
 13825     IF  W-ACCT-BROWSE-STARTED
 13826         MOVE 'N'                TO W-ACCT-BROWSE-STARTED-SW
 13827
 13828* EXEC CICS ENDBR
 13829*            DATASET (W-ACCT-FILE-ID)
 13830*        END-EXEC
 13831     MOVE 0
 13832       TO DFHEIV11
 13833*    MOVE '&2                    $   #00013009' TO DFHEIV0
 13834     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13835     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13836     MOVE X'2020233030303133303039' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 285
* EL689.cbl
 13837     CALL 'kxdfhei1' USING DFHEIV0,
 13838           W-ACCT-FILE-ID,
 13839           DFHEIV11,
 13840           DFHEIV99
 13841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13842     END-IF.
 13843
 13844 6500-ACCT-NOT-FOUND.
 13845
 13846     PERFORM 6500-ENDBR.
 13847
 13848     IF  DATASORI NOT EQUAL '1'
 13849         MOVE ER-0179            TO EMI-ERROR
 13850         GO TO 6500-EXIT.
 13851
 13852     MOVE ER-0179                TO EMI-ERROR.
 13853     MOVE -1                     TO MAINTL.
 13854     MOVE AL-UNBON               TO MAINTA.
 13855     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13856     GO TO 8200-SEND-DATAONLY.
 13857
 13858 6500-EXIT.
 13859     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 286
* EL689.cbl
 13861 6600-GET-COMPENSATION-DATA.
 13862
 13863     IF  ADDRSI EQUAL '4'
 13864             AND
 13865         PI-CREATE-LABELS
 13866             AND
 13867         NOT PI-689-LABELS-OVERRIDEN
 13868         NEXT SENTENCE
 13869     ELSE
 13870         IF  W-FILE-NOT-USED (10)
 13871             GO TO 6600-EXIT.
 13872
 13873     IF  W-COMP-RESP-PERSON GREATER THAN LOW-VALUES
 13874         MOVE W-COMP-KEY         TO W-COMP-SAVE-KEY
 13875         GO TO 6600-START.
 13876
 13877     IF  PI-ZERO-CARRIER
 13878             OR
 13879         PI-ZERO-CAR-GROUP
 13880         MOVE ZEROS              TO W-COMP-CARRIER.
 13881
 13882     IF  PI-ZERO-GROUPING
 13883             OR
 13884         PI-ZERO-CAR-GROUP
 13885         MOVE ZEROS              TO W-COMP-GROUPING.
 13886
 13887     IF  W-FILE-NOT-USED (6)
 13888         PERFORM 6500-READ-ACCT-ONLY THRU 6500-READNEXT
 13889         IF  EMI-ERROR EQUAL ER-0179
 13890             MOVE ER-9327        TO EMI-ERROR
 13891             MOVE -1             TO MAINTL
 13892             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13893             GO TO 6600-EXIT.
 13894
 13895     MOVE  'A'                   TO W-COMP-TYPE.
 13896
 13897     IF  WS-SAV-AM-REMIT-TO GREATER THAN ZEROS
 13898         MOVE WS-SAV-AM-AGT (WS-SAV-AM-REMIT-TO)
 13899                                 TO W-COMP-RESP-PERSON
 13900     ELSE
 13901         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 13902
 13903     PERFORM VARYING W-NDX FROM +1 BY +1 UNTIL
 13904        (W-NDX > +10)
 13905            OR
 13906         (WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'S' OR 'F')
 13907     END-PERFORM
 13908
 13909     IF  WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'S' OR 'F'
 13910         MOVE WS-SAV-AM-AGT (W-NDX)  TO W-COMP-ACCOUNT
 13911     ELSE
 13912         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 13913
 13914     PERFORM 6500-ENDBR.
 13915     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 13916
 13917     IF  W-COMP-RESP-PERSON EQUAL LOW-VALUES
 13918         MOVE ER-9327            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 287
* EL689.cbl
 13919         MOVE -1                 TO MAINTL
 13920         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13921         GO TO 6600-EXIT.
 13922
 13923 6600-START.
 13924
 13925
 13926* EXEC CICS HANDLE CONDITION
 13927*         NOTOPEN (8080-COMP-NOT-OPEN)
 13928*         NOTFND  (6600-COMP-NOT-FOUND)
 13929*    END-EXEC.
 13930*    MOVE '"$JI                  ! 2 #00013095' TO DFHEIV0
 13931     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13932     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13933     MOVE X'3220233030303133303935' TO DFHEIV0(25:11)
 13934     CALL 'kxdfhei1' USING DFHEIV0
 13935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13936
 13937
 13938
 13939* EXEC CICS STARTBR
 13940*         RIDFLD  (W-COMP-KEY)
 13941*         DATASET (W-COMP-FILE-ID)
 13942*    END-EXEC.
 13943     MOVE 0
 13944       TO DFHEIV11
 13945*    MOVE '&,         G          &   #00013100' TO DFHEIV0
 13946     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13947     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13948     MOVE X'2020233030303133313030' TO DFHEIV0(25:11)
 13949     CALL 'kxdfhei1' USING DFHEIV0,
 13950           W-COMP-FILE-ID,
 13951           W-COMP-KEY,
 13952           DFHEIV99,
 13953           DFHEIV11,
 13954           DFHEIV99
 13955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13956
 13957
 13958     MOVE 'Y'                    TO W-COMP-BROWSE-SW.
 13959
 13960 6600-READNEXT.
 13961
 13962
 13963* EXEC CICS READNEXT
 13964*         DATASET (W-COMP-FILE-ID)
 13965*         SET     (ADDRESS OF COMPENSATION-MASTER)
 13966*         RIDFLD  (W-COMP-KEY)
 13967*    END-EXEC.
 13968     MOVE 0
 13969       TO DFHEIV11
 13970*    MOVE '&.S                   )   #00013109' TO DFHEIV0
 13971     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13972     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13973     MOVE X'2020233030303133313039' TO DFHEIV0(25:11)
 13974     CALL 'kxdfhei1' USING DFHEIV0,
 13975           W-COMP-FILE-ID,
 13976           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 288
* EL689.cbl
 13977           DFHEIV99,
 13978           W-COMP-KEY,
 13979           DFHEIV99,
 13980           DFHEIV11,
 13981           DFHEIV99,
 13982           DFHEIV99
 13983     SET ADDRESS OF COMPENSATION-MASTER TO
 13984         DFHEIV20
 13985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13986
 13987
 13988     IF CO-CONTROL-PRIMARY
 13989           NOT = W-COMP-SAVE-KEY
 13990        GO TO 6600-COMP-NOT-FOUND.
 13991
 13992     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13993     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1)
 13994                                    W-VG-TEXT (140).
 13995     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 13996     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 13997     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 13998*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 13999     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14000        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14001     END-STRING
 14002
 14003     MOVE CO-ZIP                 TO W-WORK-ZIP.
 14004
 14005     IF  CO-CANADIAN-POST-CODE
 14006         MOVE CO-CANADIAN-POSTAL-CODE
 14007                                 TO W-CANADIAN-POSTAL-CODES
 14008         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14009         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14010         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14011                                    W-LAB-CAN-FILLER (6)
 14012     ELSE
 14013         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14014
 14015         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14016             MOVE '-'            TO W-LABEL-DASH (6)
 14017             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14018         ELSE
 14019             MOVE SPACES         TO W-LABEL-DASH (6)
 14020                                    W-LABEL-2ND-ZIP (6).
 14021
 14022     IF  CO-TELEPHONE NOT NUMERIC
 14023             OR
 14024         CO-TELEPHONE = ZEROS
 14025         MOVE SPACES             TO W-VG-TEXT (147)
 14026     ELSE
 14027         MOVE ZEROS              TO W-PHONE-IN
 14028         MOVE CO-AREA-CODE       TO W-PO-AREA
 14029         MOVE CO-PREFIX          TO W-PO-PFX
 14030         MOVE CO-PHONE           TO W-PO-SFX
 14031         MOVE W-PHONE-OUT        TO W-VG-TEXT (147).
 14032
 14033     IF (CO-FAXNO NOT NUMERIC)
 14034        OR (CO-FAXNO = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 289
* EL689.cbl
 14035        MOVE SPACES              TO W-VG-TEXT (182)
 14036     ELSE
 14037        MOVE ZEROS               TO W-PHONE-IN
 14038        MOVE CO-FAX-AREA-CODE    TO W-PO-AREA
 14039        MOVE CO-FAX-PREFIX       TO W-PO-PFX
 14040        MOVE CO-FAX-PHONE        TO W-PO-SFX
 14041        MOVE W-PHONE-OUT         TO W-VG-TEXT (182)
 14042     END-IF
 14043     IF CO-GA-STATUS-CODE NOT = 'A' AND 'I' AND 'P'
 14044        MOVE SPACES              TO W-VG-TEXT (183)
 14045     ELSE
 14046        EVALUATE CO-GA-STATUS-CODE
 14047           WHEN 'A'
 14048              MOVE 'ACTIVE'      TO W-VG-TEXT (183)
 14049           WHEN 'I'
 14050              MOVE 'INACTIVE'    TO W-VG-TEXT (183)
 14051           WHEN 'P'
 14052              MOVE 'PENDING'     TO W-VG-TEXT (183)
 14053        END-EVALUATE
 14054     END-IF
 14055     IF CO-BILL-SW NOT = 'B' AND 'R' AND 'T' AND 'S'
 14056        MOVE SPACES              TO W-VG-TEXT (181)
 14057     ELSE
 14058        EVALUATE CO-BILL-SW
 14059           WHEN 'B'
 14060              MOVE 'BILLED'      TO W-VG-TEXT (181)
 14061           WHEN 'R'
 14062              MOVE 'REMIT'       TO W-VG-TEXT (181)
 14063           WHEN 'T'
 14064              MOVE 'T'           TO W-VG-TEXT (181)
 14065           WHEN 'S'
 14066              MOVE 'S'           TO W-VG-TEXT (181)
 14067        END-EVALUATE
 14068     END-IF
 14069     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14070
 14071     IF  ADDRSI EQUAL '4'
 14072             AND
 14073         PI-CREATE-LABELS
 14074             AND
 14075         NOT PI-689-LABELS-OVERRIDEN
 14076         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 14077                                    W-VG-TEXT (141)
 14078         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 14079                                    W-VG-TEXT (142)
 14080         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 14081                                    W-VG-TEXT (143)
 14082         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 14083                                    W-VG-TEXT (144)
 14084         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 14085                                    W-VG-TEXT (145)
 14086         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 14087                                    W-VG-TEXT (146)
 14088         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 14089         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 14090         SET W-RG-NDX UP BY +1
 14091     ELSE
 14092         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (141)
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 290
* EL689.cbl
 14093         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (142)
 14094         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (143)
 14095         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (144)
 14096         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (145)
 14097         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (146).
 14098
 14099     PERFORM 6630-GET-CSR-NAME THRU 6630-EXIT.
 14100
 14101     MOVE CO-RESP-NO             TO W-VG-TEXT (180).
 14102     MOVE CO-END-BAL             TO W-EDIT-7-2-NEGATIVE.
 14103     MOVE W-EDIT-7-2-NEGATIVE    TO W-VG-TEXT (150).
 14104
 14105     MOVE CO-LAST-STMT-DT        TO DC-GREG-DATE-1-YMD.
 14106     MOVE '3'                    TO DC-OPTION-CODE.
 14107     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 14108
 14109     IF  NO-CONVERSION-ERROR
 14110         MOVE DC-GREG-DATE-1-ALPHA
 14111                                 TO W-VG-TEXT (149).
 14112
 14113     PERFORM 6620-GET-G-DATA THRU 6620-EXIT.
 14114     PERFORM 6626-GET-B-DATA     THRU 6626-EXIT
 14115
 14116     PERFORM 6600-ENDBR.
 14117     GO TO 6600-EXIT.
 14118
 14119 6600-ENDBR.
 14120
 14121     IF  W-COMP-BROWSE-STARTED
 14122         MOVE 'N'                      TO W-COMP-BROWSE-SW
 14123
 14124* EXEC CICS ENDBR
 14125*             DATASET(W-COMP-FILE-ID)
 14126*        END-EXEC.
 14127     MOVE 0
 14128       TO DFHEIV11
 14129*    MOVE '&2                    $   #00013250' TO DFHEIV0
 14130     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14131     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14132     MOVE X'2020233030303133323530' TO DFHEIV0(25:11)
 14133     CALL 'kxdfhei1' USING DFHEIV0,
 14134           W-COMP-FILE-ID,
 14135           DFHEIV11,
 14136           DFHEIV99
 14137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14138
 14139
 14140 6600-COMP-NOT-FOUND.
 14141
 14142     PERFORM 6600-ENDBR.
 14143
 14144     IF ADDRSL GREATER ZERO
 14145         IF ADDRSI = '4'
 14146            IF PI-689-TYPE EQUAL LOW-VALUES OR SPACES
 14147                MOVE ER-7378                TO EMI-ERROR
 14148                MOVE -1                     TO TYPEL
 14149                MOVE AL-UNBON               TO TYPEA
 14150                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 291
* EL689.cbl
 14151                GO TO 8200-SEND-DATAONLY
 14152            ELSE
 14153                MOVE ER-2114                TO EMI-ERROR
 14154                MOVE -1                     TO ADDRSL
 14155                MOVE AL-UNBON               TO ADDRSA
 14156                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14157                GO TO 8200-SEND-DATAONLY.
 14158
 14159 6600-EXIT.
 14160     EXIT.
 14161 6620-GET-G-DATA.
 14162
 14163     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY.
 14164
 14165     IF  CO-RPTCD2 GREATER THAN SPACES
 14166         MOVE SPACES             TO W-COMP-RESP-PERSON
 14167         MOVE CO-RPTCD2          TO W-COMP-WORK-AREA
 14168         MOVE +10                TO W-CWA-NDX
 14169         PERFORM 6622-FIND-LAST-NON-SPACE
 14170         SET W-COMP-NDX          TO +10
 14171         PERFORM 6625-FILL-IN-RESP-PERSON.
 14172         INSPECT W-COMP-RESP-PERSON CONVERTING SPACES TO ZEROS.
 14173
 14174     MOVE LOW-VALUES             TO W-COMP-ACCOUNT.
 14175     MOVE 'G'                    TO W-COMP-TYPE.
 14176     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 14177
 14178
 14179* EXEC CICS RESETBR
 14180*         RIDFLD  (W-COMP-KEY)
 14181*         DATASET (W-COMP-FILE-ID)
 14182*    END-EXEC.
 14183     MOVE 0
 14184       TO DFHEIV11
 14185*    MOVE '&4         G          &   #00013292' TO DFHEIV0
 14186     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 14187     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14188     MOVE X'2020233030303133323932' TO DFHEIV0(25:11)
 14189     CALL 'kxdfhei1' USING DFHEIV0,
 14190           W-COMP-FILE-ID,
 14191           W-COMP-KEY,
 14192           DFHEIV99,
 14193           DFHEIV11,
 14194           DFHEIV99
 14195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14196
 14197
 14198
 14199* EXEC CICS READNEXT
 14200*         DATASET (W-COMP-FILE-ID)
 14201*         SET     (ADDRESS OF COMPENSATION-MASTER)
 14202*         RIDFLD  (W-COMP-KEY)
 14203*    END-EXEC.
 14204     MOVE 0
 14205       TO DFHEIV11
 14206*    MOVE '&.S                   )   #00013297' TO DFHEIV0
 14207     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14208     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 292
* EL689.cbl
 14209     MOVE X'2020233030303133323937' TO DFHEIV0(25:11)
 14210     CALL 'kxdfhei1' USING DFHEIV0,
 14211           W-COMP-FILE-ID,
 14212           DFHEIV20,
 14213           DFHEIV99,
 14214           W-COMP-KEY,
 14215           DFHEIV99,
 14216           DFHEIV11,
 14217           DFHEIV99,
 14218           DFHEIV99
 14219     SET ADDRESS OF COMPENSATION-MASTER TO
 14220         DFHEIV20
 14221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14222
 14223
 14224     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 14225         GO TO 6620-EXIT.
 14226
 14227     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14228     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 14229     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 14230     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 14231     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 14232*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 14233     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14234        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14235     END-STRING
 14236
 14237     MOVE CO-ZIP                 TO W-WORK-ZIP.
 14238
 14239     IF  CO-CANADIAN-POST-CODE
 14240         MOVE CO-CANADIAN-POSTAL-CODE
 14241                                 TO W-CANADIAN-POSTAL-CODES
 14242         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14243         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14244         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14245                                    W-LAB-CAN-FILLER (6)
 14246     ELSE
 14247         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14248         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14249             MOVE '-'            TO W-LABEL-DASH (6)
 14250             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14251         ELSE
 14252             MOVE SPACES         TO W-LABEL-DASH (6)
 14253                                    W-LABEL-2ND-ZIP (6).
 14254
 14255     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14256
 14257     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (174).
 14258     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (175).
 14259     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (176).
 14260     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (177).
 14261     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (178).
 14262     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (179).
 14263
 14264 6620-EXIT.
 14265     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 293
* EL689.cbl
 14267 6622-FIND-LAST-NON-SPACE.
 14268
 14269     IF  W-CWA-CHAR (W-CWA-NDX) EQUAL SPACES
 14270         SUBTRACT +1 FROM W-CWA-NDX
 14271         GO TO 6622-FIND-LAST-NON-SPACE.
 14272
 14273 6622-EXIT.
 14274     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 294
* EL689.cbl
 14276 6625-FILL-IN-RESP-PERSON.
 14277
 14278     MOVE W-CWA-CHAR (W-CWA-NDX) TO W-COMP-RP-CHAR (W-COMP-NDX)
 14279     SET W-COMP-NDX DOWN BY +1.
 14280     SUBTRACT +1 FROM W-CWA-NDX.
 14281
 14282     IF  W-CWA-NDX GREATER THAN ZEROS
 14283         GO TO 6625-FILL-IN-RESP-PERSON.
 14284
 14285 6625-EXIT.
 14286     EXIT.
 14287 6626-GET-B-DATA.
 14288     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY
 14289     IF W-FILE-USED (8)
 14290        PERFORM 6450-READ-CERT-ONLY
 14291        IF W-CERT-FOUND
 14292           MOVE CM-BENEFICIARY (1:10)
 14293                                 TO W-COMP-RESP-PERSON
 14294        ELSE
 14295           MOVE SPACES           TO W-COMP-RESP-PERSON
 14296           GO TO 6626-EXIT
 14297        END-IF
 14298     ELSE
 14299        MOVE CM-BENEFICIARY (1:10)
 14300                                 TO W-COMP-RESP-PERSON
 14301     END-IF
 14302     MOVE LOW-VALUES             TO W-COMP-ACCOUNT
 14303     MOVE 'B'                    TO W-COMP-TYPE
 14304     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY
 14305
 14306
 14307* EXEC CICS RESETBR
 14308*         RIDFLD  (W-COMP-KEY)
 14309*         DATASET (W-COMP-FILE-ID)
 14310*    END-EXEC.
 14311     MOVE 0
 14312       TO DFHEIV11
 14313*    MOVE '&4         G          &   #00013385' TO DFHEIV0
 14314     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 14315     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14316     MOVE X'2020233030303133333835' TO DFHEIV0(25:11)
 14317     CALL 'kxdfhei1' USING DFHEIV0,
 14318           W-COMP-FILE-ID,
 14319           W-COMP-KEY,
 14320           DFHEIV99,
 14321           DFHEIV11,
 14322           DFHEIV99
 14323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14324
 14325
 14326
 14327* EXEC CICS READNEXT
 14328*         DATASET (W-COMP-FILE-ID)
 14329*         SET     (ADDRESS OF COMPENSATION-MASTER)
 14330*         RIDFLD  (W-COMP-KEY)
 14331*    END-EXEC.
 14332     MOVE 0
 14333       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 295
* EL689.cbl
 14334*    MOVE '&.S                   )   #00013390' TO DFHEIV0
 14335     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14336     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14337     MOVE X'2020233030303133333930' TO DFHEIV0(25:11)
 14338     CALL 'kxdfhei1' USING DFHEIV0,
 14339           W-COMP-FILE-ID,
 14340           DFHEIV20,
 14341           DFHEIV99,
 14342           W-COMP-KEY,
 14343           DFHEIV99,
 14344           DFHEIV11,
 14345           DFHEIV99,
 14346           DFHEIV99
 14347     SET ADDRESS OF COMPENSATION-MASTER TO
 14348         DFHEIV20
 14349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14350
 14351
 14352     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 14353         GO TO 6626-EXIT.
 14354
 14355     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14356     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 14357     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 14358     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 14359     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 14360*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 14361     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14362        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14363     END-STRING
 14364
 14365     MOVE CO-ZIP                 TO W-WORK-ZIP.
 14366
 14367     IF  CO-CANADIAN-POST-CODE
 14368         MOVE CO-CANADIAN-POSTAL-CODE
 14369                                 TO W-CANADIAN-POSTAL-CODES
 14370         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14371         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14372         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14373                                    W-LAB-CAN-FILLER (6)
 14374     ELSE
 14375         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14376         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14377             MOVE '-'            TO W-LABEL-DASH (6)
 14378             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14379         ELSE
 14380             MOVE SPACES         TO W-LABEL-DASH (6)
 14381                                    W-LABEL-2ND-ZIP (6).
 14382
 14383     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14384
 14385     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (184).
 14386     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (185).
 14387     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (186).
 14388     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (187).
 14389     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (188).
 14390     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (189).
 14391
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 296
* EL689.cbl
 14392 6626-EXIT.
 14393     EXIT.
 14394 6630-GET-CSR-NAME.
 14395
 14396     MOVE SPACES                 TO W-CNTL-KEY.
 14397     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 14398     MOVE +0                     TO W-CNTL-SEQ-NO.
 14399     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 14400     MOVE CO-CSR-CODE            TO W-CNTL-GENL.
 14401
 14402
 14403* EXEC CICS HANDLE CONDITION
 14404*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 14405*         NOTFND     (6630-CNTL2-NOT-FOUND)
 14406*    END-EXEC.
 14407*    MOVE '"$JI                  ! 3 #00013446' TO DFHEIV0
 14408     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14409     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14410     MOVE X'3320233030303133343436' TO DFHEIV0(25:11)
 14411     CALL 'kxdfhei1' USING DFHEIV0
 14412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14413
 14414
 14415
 14416* EXEC CICS READ
 14417*         DATASET    (W-CNTL-FILE-ID)
 14418*         SET        (ADDRESS OF CONTROL-FILE)
 14419*         RIDFLD     (W-CNTL-KEY)
 14420*    END-EXEC.
 14421*    MOVE '&"S        E          (   #00013451' TO DFHEIV0
 14422     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14423     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14424     MOVE X'2020233030303133343531' TO DFHEIV0(25:11)
 14425     CALL 'kxdfhei1' USING DFHEIV0,
 14426           W-CNTL-FILE-ID,
 14427           DFHEIV20,
 14428           DFHEIV99,
 14429           W-CNTL-KEY,
 14430           DFHEIV99,
 14431           DFHEIV99,
 14432           DFHEIV99
 14433     SET ADDRESS OF CONTROL-FILE TO
 14434         DFHEIV20
 14435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14436
 14437
 14438     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (148).
 14439     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 14440     GO TO 6630-EXIT.
 14441
 14442 6630-CNTL2-NOT-FOUND.
 14443
 14444*    MOVE ER-8965                TO EMI-ERROR.
 14445*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14446*    MOVE -1                     TO MAINTL.
 14447*    MOVE AL-UANON               TO MAINTA.
 14448*    GO TO 8200-SEND-DATAONLY
 14449     .
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 297
* EL689.cbl
 14450 6630-EXIT.
 14451     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 298
* EL689.cbl
 14453 6700-GET-MAIL-DATA.
 14454
 14455     IF  ADDRSI EQUAL '5'
 14456             AND
 14457         PI-CREATE-LABELS
 14458             AND
 14459         NOT PI-689-LABELS-OVERRIDEN
 14460         NEXT SENTENCE
 14461     ELSE
 14462         IF  W-FILE-NOT-USED (5)
 14463             GO TO 6700-EXIT.
 14464
 14465     IF  W-MAIL-CERT-NO EQUAL LOW-VALUES
 14466         MOVE ER-9327            TO EMI-ERROR
 14467         MOVE -1                 TO MAINTL
 14468         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14469         GO TO 6700-EXIT.
 14470
 14471
 14472* EXEC CICS HANDLE CONDITION
 14473*         NOTOPEN (8090-MAIL-NOT-OPEN)
 14474*         NOTFND  (6700-MAIL-NOT-FOUND)
 14475*    END-EXEC.
 14476*    MOVE '"$JI                  ! 4 #00013490' TO DFHEIV0
 14477     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14478     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14479     MOVE X'3420233030303133343930' TO DFHEIV0(25:11)
 14480     CALL 'kxdfhei1' USING DFHEIV0
 14481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14482
 14483
 14484
 14485* EXEC CICS READ
 14486*         DATASET(W-MAIL-FILE-ID)
 14487*         SET    (ADDRESS OF MAILING-DATA)
 14488*         RIDFLD (W-MAIL-KEY)
 14489*    END-EXEC.
 14490*    MOVE '&"S        E          (   #00013495' TO DFHEIV0
 14491     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14492     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14493     MOVE X'2020233030303133343935' TO DFHEIV0(25:11)
 14494     CALL 'kxdfhei1' USING DFHEIV0,
 14495           W-MAIL-FILE-ID,
 14496           DFHEIV20,
 14497           DFHEIV99,
 14498           W-MAIL-KEY,
 14499           DFHEIV99,
 14500           DFHEIV99,
 14501           DFHEIV99
 14502     SET ADDRESS OF MAILING-DATA TO
 14503         DFHEIV20
 14504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14505
 14506
 14507     MOVE MA-INSURED-LAST-NAME   TO W-NAME-LAST.
 14508     MOVE MA-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 14509     MOVE MA-INSURED-MIDDLE-INIT TO W-NAME-MIDDLE.
 14510     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 299
* EL689.cbl
 14511
 14512     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14513     MOVE WS-NAME-WORK           TO W-LABEL-LINES (1).
 14514     MOVE W-LABEL-JOINT-NAME     TO W-LABEL-LINES (2).
 14515     MOVE MA-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 14516     MOVE MA-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 14517*    MOVE MA-CITY-STATE          TO W-LABEL-LINES (5).
 14518     STRING MA-CITY ' ' MA-ADDR-STATE
 14519        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14520     END-STRING
 14521
 14522     MOVE MA-ZIP                 TO W-WORK-ZIP.
 14523     MOVE SPACES                 TO W-LABEL-ZIP (6).
 14524
 14525     IF  MA-CANADIAN-POST-CODE
 14526         MOVE MA-CANADIAN-POSTAL-CODE
 14527                                 TO W-CANADIAN-POSTAL-CODES
 14528         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14529         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14530         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14531                                    W-LAB-CAN-FILLER (6)
 14532     ELSE
 14533         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14534         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14535             MOVE '-'            TO W-LABEL-DASH (6)
 14536             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14537         ELSE
 14538             MOVE SPACES         TO W-LABEL-DASH (6)
 14539                                    W-LABEL-2ND-ZIP (6).
 14540
 14541     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14542
 14543     IF  ADDRSI EQUAL '5'
 14544             AND
 14545         PI-CREATE-LABELS
 14546             AND
 14547         NOT PI-689-LABELS-OVERRIDEN
 14548         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 14549                                    W-VG-TEXT (31)
 14550         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 14551                                    W-VG-TEXT (32)
 14552         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 14553                                    W-VG-TEXT (33)
 14554         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 14555                                    W-VG-TEXT (34)
 14556         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 14557                                    W-VG-TEXT (35)
 14558         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 14559                                    W-VG-TEXT (36)
 14560         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 14561         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 14562         SET W-RG-NDX UP BY +1
 14563     ELSE
 14564         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (31)
 14565         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (32)
 14566         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (33)
 14567         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (34)
 14568         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (35)
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 300
* EL689.cbl
 14569         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (36).
 14570     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14571     MOVE MA-CRED-BENE-NAME      TO W-LABEL-LINES (1)
 14572     MOVE MA-CRED-BENE-ADDR      TO W-LABEL-LINES (2)
 14573     MOVE MA-CRED-BENE-ADDR2     TO W-LABEL-LINES (3)
 14574     STRING MA-CRED-BENE-CITY ' ' MA-CRED-BENE-STATE
 14575        DELIMITED BY '  ' INTO W-LABEL-LINES (4)
 14576     END-STRING
 14577
 14578     MOVE MA-CRED-BENE-ZIP       TO W-WORK-ZIP
 14579     MOVE SPACES                 TO W-LABEL-ZIP (5)
 14580
 14581     IF  MA-CB-CANADIAN-POST-CODE
 14582         MOVE MA-CB-CANADIAN-POSTAL-CODE
 14583                                 TO W-CANADIAN-POSTAL-CODES
 14584         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 14585         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 14586         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 14587                                    W-LAB-CAN-FILLER (5)
 14588     ELSE
 14589         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 14590         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14591             MOVE '-'            TO W-LABEL-DASH (5)
 14592             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 14593         ELSE
 14594             MOVE SPACES         TO W-LABEL-DASH (5)
 14595                                    W-LABEL-2ND-ZIP (5)
 14596         END-IF
 14597     END-IF
 14598     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT
 14599     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (37)
 14600     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (50)
 14601     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (51)
 14602     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (52)
 14603     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (53)
 14604     GO TO 6700-EXIT.
 14605
 14606 6700-MAIL-NOT-FOUND.
 14607
 14608     IF  ADDRSL GREATER ZERO
 14609         IF ADDRSI = '5'
 14610            MOVE ER-3000         TO EMI-ERROR
 14611            MOVE -1              TO ADDRSL
 14612            MOVE AL-UNBON        TO ADDRSA
 14613            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14614            GO TO 8200-SEND-DATAONLY.
 14615
 14616 6700-EXIT.
 14617     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 301
* EL689.cbl
 14619 6750-GET-LIFE-BENEFIT-DATA.
 14620
 14621     IF  W-FILE-NOT-USED (2)
 14622         GO TO 6750-EXIT.
 14623
 14624     MOVE SPACES                 TO W-CNTL-GEN2.
 14625
 14626     IF  DATASORI EQUAL '2'
 14627         IF  W-FILE-NOT-USED (8)
 14628             PERFORM 6450-READ-CERT-ONLY
 14629             IF  W-CERT-FOUND
 14630                 MOVE CM-LF-BENEFIT-CD
 14631                                 TO W-BEN-HOLD
 14632                                    W-CNTL-GEN2
 14633             ELSE
 14634                 NEXT SENTENCE
 14635         ELSE
 14636             MOVE CM-LF-BENEFIT-CD
 14637                                 TO W-BEN-HOLD
 14638                                    W-CNTL-GEN2
 14639     ELSE
 14640         IF  DATASORI EQUAL '4'
 14641             IF  W-FILE-NOT-USED (9)
 14642                 PERFORM 6400-READ-PNDB-ONLY
 14643                 IF  W-PNDB-FOUND
 14644                     IF  PI-689-TYPE = '1'
 14645                         MOVE PB-I-LF-BENEFIT-CD
 14646                                 TO W-BEN-HOLD
 14647                                    W-CNTL-GEN2
 14648                     ELSE
 14649                         MOVE PB-CI-LF-BENEFIT-CD
 14650                                 TO W-BEN-HOLD
 14651                                    W-CNTL-GEN2
 14652             ELSE
 14653                 NEXT SENTENCE
 14654         ELSE
 14655             IF  W-FILE-USED (8)
 14656                 MOVE CM-LF-BENEFIT-CD
 14657                                 TO W-BEN-HOLD
 14658                                    W-CNTL-GEN2
 14659             ELSE
 14660                 IF  W-FILE-USED (9)
 14661                     IF  PI-689-TYPE = '1'
 14662                         MOVE PB-I-LF-BENEFIT-CD
 14663                                 TO W-BEN-HOLD
 14664                                    W-CNTL-GEN2
 14665                     ELSE
 14666                         MOVE PB-CI-LF-BENEFIT-CD
 14667                                 TO W-BEN-HOLD
 14668                                    W-CNTL-GEN2.
 14669
 14670     IF  W-CNTL-GEN2 EQUAL SPACES
 14671         MOVE ER-9327            TO EMI-ERROR
 14672         MOVE -1                 TO MAINTL
 14673         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14674         GO TO 6750-EXIT.
 14675
 14676     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 302
* EL689.cbl
 14677     MOVE '4'                    TO W-CNTL-RECORD-TYPE.
 14678     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 14679
 14680
 14681* EXEC CICS HANDLE CONDITION
 14682*         NOTOPEN (8040-CNTL-NOT-OPEN)
 14683*         NOTFND  (6750-EXIT)
 14684*    END-EXEC.
 14685*    MOVE '"$JI                  ! 5 #00013674' TO DFHEIV0
 14686     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14687     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14688     MOVE X'3520233030303133363734' TO DFHEIV0(25:11)
 14689     CALL 'kxdfhei1' USING DFHEIV0
 14690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14691
 14692
 14693
 14694* EXEC CICS READ
 14695*         DATASET (W-CNTL-FILE-ID)
 14696*         SET     (ADDRESS OF CONTROL-FILE)
 14697*         GTEQ
 14698*         RIDFLD  (W-CNTL-KEY)
 14699*    END-EXEC.
 14700*    MOVE '&"S        G          (   #00013679' TO DFHEIV0
 14701     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14702     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14703     MOVE X'2020233030303133363739' TO DFHEIV0(25:11)
 14704     CALL 'kxdfhei1' USING DFHEIV0,
 14705           W-CNTL-FILE-ID,
 14706           DFHEIV20,
 14707           DFHEIV99,
 14708           W-CNTL-KEY,
 14709           DFHEIV99,
 14710           DFHEIV99,
 14711           DFHEIV99
 14712     SET ADDRESS OF CONTROL-FILE TO
 14713         DFHEIV20
 14714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14715
 14716
 14717     MOVE 1                      TO W-NDX.
 14718
 14719 6750-LOOP.
 14720
 14721     IF  W-NDX = 9
 14722         GO TO 6750-EXIT.
 14723
 14724     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 14725         ADD 1                   TO W-NDX
 14726         GO TO 6750-LOOP.
 14727
 14728     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 14729         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 14730                                 TO W-VG-TEXT (11).
 14731
 14732 6750-EXIT.
 14733     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 303
* EL689.cbl
 14735 6800-GET-A-H-BENEFIT-DATA.
 14736
 14737     IF  W-FILE-NOT-USED (3)
 14738         GO TO 6800-EXIT.
 14739
 14740     MOVE SPACES                 TO W-CNTL-GEN2.
 14741
 14742     IF  DATASORI EQUAL '2'
 14743         IF  W-FILE-NOT-USED (8)
 14744             PERFORM 6450-READ-CERT-ONLY
 14745             IF  W-CERT-FOUND
 14746                 MOVE CM-AH-BENEFIT-CD
 14747                                 TO W-BEN-HOLD
 14748                                    W-CNTL-GEN2
 14749             ELSE
 14750                 NEXT SENTENCE
 14751         ELSE
 14752             MOVE CM-AH-BENEFIT-CD
 14753                                 TO W-BEN-HOLD
 14754                                    W-CNTL-GEN2
 14755     ELSE
 14756         IF  DATASORI EQUAL '4'
 14757             IF  W-FILE-NOT-USED (9)
 14758                 PERFORM 6400-READ-PNDB-ONLY
 14759                 IF  W-PNDB-FOUND
 14760                     IF  PI-689-TYPE = '1'
 14761                         MOVE PB-I-AH-BENEFIT-CD
 14762                                 TO W-BEN-HOLD
 14763                                    W-CNTL-GEN2
 14764                     ELSE
 14765                         MOVE PB-CI-AH-BENEFIT-CD
 14766                                 TO W-BEN-HOLD
 14767                                    W-CNTL-GEN2
 14768             ELSE
 14769                 NEXT SENTENCE
 14770         ELSE
 14771             IF  W-FILE-USED (8)
 14772                 MOVE CM-AH-BENEFIT-CD
 14773                                 TO W-BEN-HOLD
 14774                                    W-CNTL-GEN2
 14775             ELSE
 14776                 IF  W-FILE-USED (9)
 14777                     IF  PI-689-TYPE = '1'
 14778                         MOVE PB-I-AH-BENEFIT-CD
 14779                                 TO W-BEN-HOLD
 14780                                    W-CNTL-GEN2
 14781                     ELSE
 14782                         MOVE PB-CI-AH-BENEFIT-CD
 14783                                 TO W-BEN-HOLD
 14784                                    W-CNTL-GEN2.
 14785
 14786     IF  W-CNTL-GEN2 EQUAL SPACES
 14787         MOVE ER-9327            TO EMI-ERROR
 14788         MOVE -1                 TO MAINTL
 14789         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14790         GO TO 6800-EXIT.
 14791
 14792     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 304
* EL689.cbl
 14793     MOVE '5'                    TO W-CNTL-RECORD-TYPE.
 14794     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 14795
 14796
 14797* EXEC CICS HANDLE CONDITION
 14798*         NOTOPEN (8040-CNTL-NOT-OPEN)
 14799*         NOTFND  (6800-EXIT)
 14800*    END-EXEC.
 14801*    MOVE '"$JI                  ! 6 #00013765' TO DFHEIV0
 14802     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14803     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14804     MOVE X'3620233030303133373635' TO DFHEIV0(25:11)
 14805     CALL 'kxdfhei1' USING DFHEIV0
 14806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14807
 14808
 14809
 14810* EXEC CICS READ
 14811*         DATASET (W-CNTL-FILE-ID)
 14812*         SET     (ADDRESS OF CONTROL-FILE)
 14813*         RIDFLD  (W-CNTL-KEY)
 14814*         GTEQ
 14815*    END-EXEC.
 14816*    MOVE '&"S        G          (   #00013770' TO DFHEIV0
 14817     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14818     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14819     MOVE X'2020233030303133373730' TO DFHEIV0(25:11)
 14820     CALL 'kxdfhei1' USING DFHEIV0,
 14821           W-CNTL-FILE-ID,
 14822           DFHEIV20,
 14823           DFHEIV99,
 14824           W-CNTL-KEY,
 14825           DFHEIV99,
 14826           DFHEIV99,
 14827           DFHEIV99
 14828     SET ADDRESS OF CONTROL-FILE TO
 14829         DFHEIV20
 14830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14831
 14832
 14833     MOVE 1                      TO W-NDX.
 14834
 14835 6800-LOOP-AH.
 14836
 14837     IF  W-NDX = 9
 14838         GO TO 6800-EXIT.
 14839
 14840     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 14841         ADD 1                   TO W-NDX
 14842         GO TO 6800-LOOP-AH.
 14843
 14844     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 14845         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 14846                                 TO W-VG-TEXT (15)
 14847         MOVE CF-BENEFIT-ALPHA (W-NDX)
 14848                                 TO W-BENEFIT-WORK
 14849         MOVE W-ELIM-DAYS        TO W-VG-TEXT (16).
 14850
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 305
* EL689.cbl
 14851 6800-EXIT.
 14852     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 306
* EL689.cbl
 14854 6850-GET-CHECK-DATA.
 14855
 14856     IF  ADDRSI EQUAL '6'
 14857             AND
 14858         PI-CREATE-LABELS
 14859             AND
 14860         NOT PI-689-LABELS-OVERRIDEN
 14861         NEXT SENTENCE
 14862     ELSE
 14863         IF  W-FILE-NOT-USED (12)
 14864             GO TO 6850-EXIT.
 14865
 14866     IF  W-CHEK-CERT-NO EQUAL LOW-VALUES
 14867         MOVE ER-9327            TO EMI-ERROR
 14868         MOVE -1                 TO MAINTL
 14869         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14870         GO TO 6850-EXIT.
 14871
 14872
 14873* EXEC CICS HANDLE CONDITION
 14874*         NOTOPEN (8045-CHEK-NOT-OPEN)
 14875*         NOTFND  (6850-CHEK-NOT-FOUND)
 14876*    END-EXEC.
 14877*    MOVE '"$JI                  ! 7 #00013816' TO DFHEIV0
 14878     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14879     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14880     MOVE X'3720233030303133383136' TO DFHEIV0(25:11)
 14881     CALL 'kxdfhei1' USING DFHEIV0
 14882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14883
 14884
 14885
 14886* EXEC CICS READ
 14887*         DATASET (W-CHEK-FILE-ID)
 14888*         SET     (ADDRESS OF CHECK-RECORDS)
 14889*         RIDFLD  (W-CHEK-KEY)
 14890*    END-EXEC.
 14891*    MOVE '&"S        E          (   #00013821' TO DFHEIV0
 14892     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14893     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14894     MOVE X'2020233030303133383231' TO DFHEIV0(25:11)
 14895     CALL 'kxdfhei1' USING DFHEIV0,
 14896           W-CHEK-FILE-ID,
 14897           DFHEIV20,
 14898           DFHEIV99,
 14899           W-CHEK-KEY,
 14900           DFHEIV99,
 14901           DFHEIV99,
 14902           DFHEIV99
 14903     SET ADDRESS OF CHECK-RECORDS TO
 14904         DFHEIV20
 14905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14906
 14907
 14908     MOVE CH-CHECK-NO            TO W-VG-TEXT (158).
 14909     MOVE CH-AMOUNT-PAID         TO W-EDIT-7-2.
 14910     MOVE W-EDIT-7-2             TO W-VG-TEXT (157).
 14911     MOVE CH-CHECK-QUE-CONTROL   TO W-DISPLAY-8
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 307
* EL689.cbl
 14912                                    PI-689-CONTROL.
 14913     MOVE W-DISPLAY-8            TO W-VG-TEXT (165).
 14914     MOVE CH-REASON-FOR-CHECK    TO W-VG-TEXT (166).
 14915
 14916     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14917     MOVE CH-PAYEE-NAME-1        TO W-LABEL-LINES (1).
 14918     MOVE CH-PAYEE-NAME-2        TO W-LABEL-LINES (2).
 14919     MOVE CH-PAYEE-ADDRESS-1     TO W-LABEL-LINES (3).
 14920     MOVE CH-PAYEE-ADDRESS-2     TO W-LABEL-LINES (4).
 14921     MOVE CH-PAYEE-CITY-ST       TO W-LABEL-LINES (5).
 14922
 14923     MOVE CH-PAYEE-ZIP           TO W-WORK-ZIP.
 14924     MOVE SPACES                 TO W-LABEL-ZIP (6).
 14925
 14926     IF  CH-CANADIAN-POST-CODE
 14927         MOVE CH-CANADIAN-POSTAL-CODE
 14928                                 TO W-CANADIAN-POSTAL-CODES
 14929         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14930         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14931         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14932                                    W-LAB-CAN-FILLER (6)
 14933     ELSE
 14934         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14935         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14936             MOVE '-'            TO W-LABEL-DASH (6)
 14937             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14938         ELSE
 14939             MOVE SPACES         TO W-LABEL-DASH (6)
 14940                                    W-LABEL-2ND-ZIP (6).
 14941
 14942     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14943
 14944     IF  ADDRSI EQUAL '6'
 14945             AND
 14946         PI-CREATE-LABELS
 14947             AND
 14948         NOT PI-689-LABELS-OVERRIDEN
 14949         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 14950                                    W-VG-TEXT (159)
 14951         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 14952                                    W-VG-TEXT (160)
 14953         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 14954                                    W-VG-TEXT (161)
 14955         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 14956                                    W-VG-TEXT (162)
 14957         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 14958                                    W-VG-TEXT (163)
 14959         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 14960                                    W-VG-TEXT (164)
 14961         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 14962         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 14963         SET W-RG-NDX UP BY +1
 14964     ELSE
 14965         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (159)
 14966         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (160)
 14967         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (161)
 14968         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (162)
 14969         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (163)
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 308
* EL689.cbl
 14970         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (164).
 14971
 14972     GO TO 6850-EXIT.
 14973
 14974 6850-CHEK-NOT-FOUND.
 14975
 14976     IF  ADDRSL GREATER ZERO
 14977         IF ADDRSI = '6'
 14978            MOVE ER-2908         TO EMI-ERROR
 14979            MOVE -1              TO ADDRSL
 14980            MOVE AL-UNBON        TO ADDRSA
 14981            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14982            GO TO 8200-SEND-DATAONLY.
 14983
 14984 6850-EXIT.
 14985     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 309
* EL689.cbl
 14987 6900-GET-PYAJ-DATA.
 14988
 14989     IF  W-FILE-NOT-USED (13)
 14990         GO TO 6900-EXIT.
 14991
 14992     IF  W-PYAJ-FIN-RESP EQUAL LOW-VALUES
 14993         MOVE ER-9327            TO EMI-ERROR
 14994         MOVE -1                 TO MAINTL
 14995         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14996         GO TO 6900-EXIT.
 14997
 14998
 14999* EXEC CICS HANDLE CONDITION
 15000*         NOTOPEN (8085-PYAJ-NOT-OPEN)
 15001*         NOTFND  (6900-PYAJ-NOT-FOUND)
 15002*    END-EXEC.
 15003*    MOVE '"$JI                  ! 8 #00013917' TO DFHEIV0
 15004     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 15005     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15006     MOVE X'3820233030303133393137' TO DFHEIV0(25:11)
 15007     CALL 'kxdfhei1' USING DFHEIV0
 15008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15009
 15010
 15011 6900-READ-NEXT.
 15012
 15013
 15014* EXEC CICS READ
 15015*         DATASET (W-PYAJ-FILE-ID)
 15016*         SET     (ADDRESS OF PENDING-PAY-ADJ)
 15017*         RIDFLD  (W-PYAJ-KEY)
 15018*         GTEQ
 15019*    END-EXEC.
 15020*    MOVE '&"S        G          (   #00013924' TO DFHEIV0
 15021     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15022     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15023     MOVE X'2020233030303133393234' TO DFHEIV0(25:11)
 15024     CALL 'kxdfhei1' USING DFHEIV0,
 15025           W-PYAJ-FILE-ID,
 15026           DFHEIV20,
 15027           DFHEIV99,
 15028           W-PYAJ-KEY,
 15029           DFHEIV99,
 15030           DFHEIV99,
 15031           DFHEIV99
 15032     SET ADDRESS OF PENDING-PAY-ADJ TO
 15033         DFHEIV20
 15034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15035
 15036
 15037     IF  PY-COMPANY-CD NOT EQUAL W-PYAJ-COMPANY-CD
 15038             OR
 15039         PY-CARRIER NOT EQUAL W-PYAJ-CARRIER
 15040             OR
 15041         PY-GROUPING NOT EQUAL W-PYAJ-GROUPING
 15042             OR
 15043         PY-FIN-RESP NOT EQUAL W-PYAJ-FIN-RESP
 15044             OR
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 310
* EL689.cbl
 15045         PY-ACCOUNT NOT EQUAL W-PYAJ-ACCOUNT
 15046         GO TO 6900-PYAJ-NOT-FOUND.
 15047
 15048     IF  PI-689-SEQ-NO GREATER THAN ZEROS
 15049             AND
 15050         PY-FILE-SEQ-NO NOT EQUAL PI-689-SEQ-NO
 15051         GO TO 6900-PYAJ-NOT-FOUND.
 15052
 15053     IF  PY-RECORD-TYPE NOT EQUAL W-PYAJ-RECORD-TYPE
 15054         MOVE PY-CONTROL-PRIMARY TO W-PYAJ-KEY
 15055         ADD +1                  TO W-PYAJ-FILE-SEQ-NO
 15056         GO TO 6900-READ-NEXT.
 15057
 15058     MOVE PY-CHECK-NUMBER        TO W-DISPLAY-7.
 15059     MOVE W-DISPLAY-7            TO W-VG-TEXT (171).
 15060
 15061     MOVE PY-ENTRY-AMT           TO W-EDIT-7-2.
 15062     MOVE W-EDIT-7-2             TO W-VG-TEXT (170).
 15063
 15064     MOVE PY-CHECK-QUE-CONTROL   TO W-DISPLAY-8
 15065                                    PI-689-CONTROL.
 15066     MOVE W-DISPLAY-8            TO W-VG-TEXT (172).
 15067     MOVE PY-ENTRY-COMMENT       TO W-VG-TEXT (173).
 15068
 15069     GO TO 6900-EXIT.
 15070
 15071 6900-PYAJ-NOT-FOUND.
 15072
 15073     MOVE ER-7395                TO EMI-ERROR
 15074     MOVE -1                     TO DATASORL
 15075     MOVE AL-UNBON               TO DATASORA
 15076     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15077     GO TO 8200-SEND-DATAONLY.
 15078
 15079 6900-EXIT.
 15080     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 311
* EL689.cbl
 15082 6950-MOVE-SYSTEM-DATA.
 15083
 15084     IF  W-FILE-NOT-USED (7)
 15085         GO TO 6950-EXIT.
 15086
 15087     MOVE EIBDATE                TO W-DATE-WORK.
 15088     MOVE W-DT-WORK              TO DC-JULIAN-YYDDD.
 15089     MOVE '5'                    TO DC-OPTION-CODE.
 15090     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 15091     MOVE DC-GREG-DATE-1-EDIT    TO W-VG-TEXT (60).
 15092     MOVE DC-GREG-DATE-1-ALPHA   TO W-VG-TEXT (61).
 15093
 15094     MOVE FORMI                  TO W-VG-TEXT (62).
 15095
 15096     IF  PI-689-VARIABLE-DATA-1 GREATER THAN SPACES
 15097         MOVE PI-689-VARIABLE-DATA-1
 15098                                 TO W-VG-TEXT (63)
 15099         MOVE PI-689-VARIABLE-DATA-2
 15100                                 TO W-VG-TEXT (64)
 15101         MOVE PI-689-VARIABLE-DATA-3
 15102                                 TO W-VG-TEXT (65)
 15103         MOVE PI-689-VARIABLE-DATA-4
 15104                                 TO W-VG-TEXT (66)
 15105     ELSE
 15106         MOVE '(VARIABLE NOT PROVIDED)'
 15107                                 TO W-VG-TEXT (63).
 15108
 15109 6950-EXIT.
 15110     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 312
* EL689.cbl
 15112 7000-FORMAT-SCREEN.
 15113
 15114     IF  MAINTI EQUAL 'S'
 15115             OR
 15116         PI-SHOW-MODE
 15117         MOVE AL-PANOF           TO W-SC-TEXTA (W-SC-NDX)
 15118     ELSE
 15119         MOVE AL-UANOF           TO W-SC-TEXTA (W-SC-NDX).
 15120
 15121     IF  W-RG-NDX NOT GREATER THAN PI-689-NUMBER-LABEL-LINES
 15122         SET W-LINE23            TO W-RG-NDX
 15123         MOVE 'A'                TO W-LINE1
 15124     ELSE
 15125         SET W-LIN-NUM           TO W-RG-NDX
 15126         COMPUTE W-LIN-NUM
 15127             = W-LIN-NUM - PI-689-NUMBER-LABEL-LINES - 1.
 15128
 15129     MOVE W-LINE-NUM             TO W-SC-LINE (W-SC-NDX).
 15130     MOVE W-RC-TEXT (W-RG-NDX)   TO W-SC-TEXT (W-SC-NDX).
 15131     SET W-RG-NDX UP BY 1.
 15132
 15133 7000-EXIT.
 15134      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 313
* EL689.cbl
 15136 7100-FORMAT-LAST-NAME-1ST.
 15137*****************************************************************
 15138*             M O V E   N A M E   R O U T I N E                 *
 15139*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15140*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15141*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 15142*                  FIELD                   VALUE                *
 15143*           W-NAME-LAST    (CL15)      SMITH                    *
 15144*           W-NAME-FIRST   (CL15)      JOHN                     *
 15145*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 15146*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 15147*     CONTAIN                                                   *
 15148*                SMITH, JOHN ALLEN                              *
 15149*     OR                                                        *
 15150*                SMITH, JOHN A.                                 *
 15151*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 15152*     COPYBOOK, ELCNWA.                                         *
 15153*****************************************************************.
 15154
 15155     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 15156     MOVE ZERO                   TO WS-NAME-SW.
 15157     SET NWA-INDEX               TO +1.
 15158
 15159     IF  W-NAME-LAST EQUAL SPACES
 15160             AND
 15161         W-NAME-MIDDLE EQUAL SPACES
 15162         MOVE +1                 TO WS-NAME-SW.
 15163
 15164     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15165     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 15166
 15167     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15168     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 15169
 15170     SET NWA-INDEX UP BY +1.
 15171
 15172     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 15173         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 15174             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15175             SET NWA-INDEX UP BY +1
 15176             MOVE '.'            TO WS-NW (NWA-INDEX)
 15177             SET NWA-INDEX UP BY +2
 15178         ELSE
 15179             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15180             PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 15181
 15182 7100-EXIT.
 15183     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 314
* EL689.cbl
 15185 7110-MOVE-NAME.
 15186
 15187     IF  WS-NAME-SW GREATER THAN +1
 15188         GO TO 7110-EXIT.
 15189
 15190     IF  WS-NAME-WORK2 = SPACES
 15191         GO TO 7110-EXIT.
 15192
 15193     SET NWA-INDEX2            TO +1.
 15194     SET NWA-INDEX3            TO +2.
 15195
 15196 7110-MOVE-NAME-CYCLE.
 15197
 15198     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 15199
 15200     IF  NWA-INDEX LESS THAN +30
 15201         SET NWA-INDEX UP BY +1
 15202     ELSE
 15203         ADD +2                TO WS-NAME-SW
 15204         GO TO 7110-EXIT.
 15205
 15206     IF  NWA-INDEX2 LESS THAN +20
 15207         SET NWA-INDEX3 UP BY +1
 15208         SET NWA-INDEX2 UP BY +1.
 15209
 15210     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 15211             AND
 15212         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 15213         IF  WS-NAME-SW EQUAL ZERO
 15214             MOVE ','            TO WS-NW (NWA-INDEX)
 15215             SET NWA-INDEX UP BY +2
 15216             MOVE +1             TO WS-NAME-SW
 15217             GO TO 7110-EXIT
 15218         ELSE
 15219             GO TO 7110-EXIT.
 15220
 15221     GO TO 7110-MOVE-NAME-CYCLE.
 15222
 15223 7110-EXIT.
 15224     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 315
* EL689.cbl
 15226 7200-FORMAT-NAME-STRAIGHT.
 15227*****************************************************************
 15228*           M O V E   N A M E   R O U T I N E                   *
 15229*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15230*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15231*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 15232*                  FIELD                   VALUE                *
 15233*           W-NAME-LAST    (CL15)      SMITH                    *
 15234*           W-NAME-FIRST   (CL15)      JOHN                     *
 15235*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 15236*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 15237*     CONTAIN                                                   *
 15238*              JOHN A. SMITH                                    *
 15239*     OR                                                        *
 15240*              JOHN ALLEN SMITH                                 *
 15241*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 15242*     COPYBOOK, ELCNWA.                                         *
 15243*****************************************************************
 15244
 15245     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 15246     MOVE ZERO                   TO WS-NAME-SW.
 15247     SET NWA-INDEX               TO +1.
 15248
 15249     IF  W-NAME-FIRST EQUAL SPACES
 15250             AND
 15251         W-NAME-MIDDLE EQUAL SPACES
 15252         MOVE W-NAME-LAST        TO WS-NAME-WORK
 15253         GO TO 7200-EXIT.
 15254
 15255     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15256     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 15257
 15258     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 15259         SET NWA-INDEX UP BY +1
 15260
 15261         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 15262             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15263             SET NWA-INDEX UP BY +1
 15264             MOVE '.'            TO WS-NW (NWA-INDEX)
 15265             SET NWA-INDEX UP BY +1
 15266
 15267         ELSE
 15268             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15269             PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 15270
 15271     SET NWA-INDEX UP BY +1
 15272     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15273     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 15274
 15275 7200-EXIT.
 15276     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 316
* EL689.cbl
 15278 7290-MOVE-NAME.
 15279
 15280     IF  WS-NAME-SW GREATER THAN +1
 15281         GO TO 7290-EXIT.
 15282
 15283     IF  WS-NAME-WORK2 EQUAL SPACES
 15284         GO TO 7290-EXIT.
 15285
 15286     SET NWA-INDEX2            TO +1.
 15287     SET NWA-INDEX3            TO +2.
 15288
 15289 7290-MOVE-NAME-CYCLE.
 15290
 15291     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 15292
 15293     IF  NWA-INDEX LESS THAN +30
 15294         SET NWA-INDEX UP BY +1
 15295     ELSE
 15296         ADD +2                TO WS-NAME-SW
 15297         GO TO 7290-EXIT.
 15298
 15299     IF  NWA-INDEX2 LESS THAN +20
 15300         SET NWA-INDEX2 UP BY +1
 15301         SET NWA-INDEX3 UP BY +1.
 15302
 15303     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 15304             AND
 15305         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 15306         GO TO 7290-EXIT.
 15307
 15308     GO TO 7290-MOVE-NAME-CYCLE.
 15309
 15310 7290-EXIT.
 15311     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 317
* EL689.cbl
 15313 7300-LABEL-MOVE.
 15314
 15315     IF  W-LABEL-HOLD-AREA = SPACES
 15316         MOVE +0                 TO W-NUMB-LABEL-LINES
 15317         GO TO 7300-EXIT.
 15318
 15319     IF  W-LABEL-LINES (1) = SPACES
 15320         MOVE W-LABEL-LINES (2)  TO W-LABEL-LINES (1)
 15321         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 15322         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15323         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15324         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15325         MOVE SPACES             TO W-LABEL-LINES (6)
 15326         GO TO 7300-LABEL-MOVE.
 15327
 15328     IF  W-LABEL-LINES (2) = SPACES
 15329             AND
 15330         W-LABEL-LINES (3) = SPACES
 15331             AND
 15332         W-LABEL-LINES (4) = SPACES
 15333             AND
 15334         W-LABEL-LINES (5) = SPACES
 15335             AND
 15336         W-LABEL-LINES (6) = SPACES
 15337         MOVE 1                  TO W-NDX
 15338                                    W-NUMB-LABEL-LINES
 15339         GO TO 7300-EXIT.
 15340
 15341 7300-TRY-2.
 15342
 15343     IF  W-LABEL-LINES (2) = SPACES
 15344         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 15345         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15346         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15347         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15348         MOVE SPACES             TO W-LABEL-LINES (6)
 15349         GO TO 7300-TRY-2.
 15350
 15351     IF  W-LABEL-LINES (3) = SPACES
 15352             AND
 15353         W-LABEL-LINES (4) = SPACES
 15354             AND
 15355         W-LABEL-LINES (5) = SPACES
 15356             AND
 15357         W-LABEL-LINES (6) = SPACES
 15358         MOVE 2                  TO W-NDX
 15359         GO TO 7300-MOVE-ZIP.
 15360
 15361 7300-TRY-3.
 15362
 15363     IF  W-LABEL-LINES (3) = SPACES
 15364         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15365         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15366         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15367         MOVE SPACES             TO W-LABEL-LINES (6)
 15368         GO TO 7300-TRY-3.
 15369
 15370     IF  W-LABEL-LINES (4) = SPACES
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 318
* EL689.cbl
 15371             AND
 15372         W-LABEL-LINES (5) = SPACES
 15373             AND
 15374         W-LABEL-LINES (6) = SPACES
 15375         MOVE 3                   TO W-NDX
 15376         GO TO 7300-MOVE-ZIP.
 15377
 15378 7300-TRY-4.
 15379
 15380     IF  W-LABEL-LINES (4) = SPACES
 15381         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15382         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15383         MOVE SPACES             TO W-LABEL-LINES (6)
 15384         GO TO 7300-TRY-4.
 15385
 15386     IF  W-LABEL-LINES (5) = SPACES
 15387             AND
 15388         W-LABEL-LINES (6) = SPACES
 15389         MOVE 4                  TO W-NDX
 15390         GO TO 7300-MOVE-ZIP.
 15391
 15392 7300-TRY-5.
 15393
 15394     IF  W-LABEL-LINES (5) = SPACES
 15395         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15396         MOVE SPACES             TO W-LABEL-LINES (6)
 15397         GO TO 7300-TRY-5
 15398     ELSE
 15399         IF  W-LABEL-LINES (6) = SPACES
 15400             MOVE 5              TO W-NDX
 15401             GO TO 7300-MOVE-ZIP
 15402         ELSE
 15403             MOVE 6              TO W-NDX.
 15404
 15405 7300-MOVE-ZIP.
 15406
 15407     COMPUTE W-NDX2 = W-NDX - 1.
 15408
 15409     IF  W-LAST-ZIP (W-NDX2) = SPACES
 15410*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 15411
 15412         IF  W-LABEL-1ST-ZIP (W-NDX) NUMERIC
 15413                 MOVE W-LABEL-ZIP (W-NDX)
 15414                                 TO W-LAST-ZIP (W-NDX2)
 15415                 MOVE SPACES     TO W-LABEL-LINES (W-NDX)
 15416                 MOVE W-NDX2     TO W-NUMB-LABEL-LINES
 15417                 GO TO 7300-EXIT.
 15418
 15419     MOVE W-NDX                  TO W-NUMB-LABEL-LINES.
 15420
 15421 7300-EXIT.
 15422     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 319
* EL689.cbl
 15424 7400-CREATE-LETTER.
 15425****************************************************************
 15426*    THIS AREA CONTROLS THE PROCESSING OF INDIVIDUAL INPUT     *
 15427*    RECORDS.                                                  *
 15428****************************************************************
 15429
 15430     SET W-SQ-NDX                TO W-START-COLUMN.
 15431     MOVE SPACES                 TO W-SQUEEZED-LINE
 15432                                    W-WORK-LINE.
 15433     MOVE W-START-COLUMN         TO W-LAST-SQUEEZED-SPACE
 15434     MOVE +1                     TO W-LAST-WC-SPACE.
 15435     MOVE HIGH-VALUES            TO W-LAST-SQ-CHAR.
 15436
 15437     SET W-TG-NDX                TO +1.
 15438
 15439     PERFORM 7410-TEXT-LINE-PROCESS THRU 7410-EXIT
 15440            VARYING
 15441         W-TG-NDX FROM W-TG-NDX BY +1
 15442            UNTIL
 15443         W-TG-NDX GREATER THAN W-TOTAL-TX-LINES.
 15444
 15445     IF  W-FORM-SQUEEZE-ON
 15446             AND
 15447         W-SQUEEZED-LINE GREATER THAN SPACES
 15448         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT.
 15449
 15450     PERFORM 7640-PAGING THRU 7640-EXIT.
 15451
 15452 7400-EXIT.
 15453     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 320
* EL689.cbl
 15455 7410-TEXT-LINE-PROCESS.
 15456***************************************************************
 15457*    THIS ROUTINE SEARCHES THE TEXT WORK AREA FOR ANY         *
 15458*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 15459*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 15460*    DATA THAT WAS GENERATED PREVIOUSLY.  WHILE PERFORMING    *
 15461*    THIS FUNCTION THE ROUTINE MOVES EACH CHARACTER OR ITS    *
 15462*    VARIABLE REPLACEMENT TO A WORK LINE.                     *
 15463***************************************************************
 15464
 15465
 15466     SET W-WC-NDX                TO W-ZEROS.
 15467     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 15468
 15469     MOVE W-TX-SC (W-TG-NDX)     TO W-LINE-SQUEEZE-IND.
 15470
 15471     PERFORM 7420-TEXT-CHAR-PROCESS THRU 7420-EXIT
 15472             VARYING
 15473         W-TX-NDX FROM +1 BY +1
 15474             UNTIL
 15475         W-TX-NDX GREATER THAN +70.
 15476
 15477****************************************************************
 15478*    IF SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS    *
 15479*    EACH LINE OF TEXT IS PROCESSED ACCORDING TO THE INDICATED *
 15480*    LINE SQUEEZE CONTROL.                                     *
 15481****************************************************************
 15482     IF  W-FORM-SQUEEZE-ON
 15483
 15484         IF  W-WORK-LINE GREATER THAN SPACES
 15485                 OR
 15486             W-AS-IS
 15487             PERFORM 7450-SQUEEZING THRU 7450-EXIT
 15488
 15489         ELSE
 15490             NEXT SENTENCE
 15491****************************************************************
 15492*    IF NO SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS *
 15493*    EACH LINE OF TEXT IS PRINT AS IS EXCEPT FOR VARIABLES     *
 15494****************************************************************
 15495     ELSE
 15496         IF  W-WORK-LINE GREATER THAN SPACES
 15497             MOVE W-TX-PC (W-TG-NDX)
 15498                                 TO W-PRINT-CONTROL
 15499             MOVE W-WORK-LINE    TO W-SQUEEZED-LINE
 15500             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15501             MOVE SPACES         TO W-WORK-LINE.
 15502
 15503 7410-EXIT.
 15504     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 321
* EL689.cbl
 15506 7420-TEXT-CHAR-PROCESS.
 15507****************************************************************
 15508*    LOOKING FOR VARIABLE INDICATORS (**XXX) THIS SECTION      *
 15509*    CONTROLS THE CONVERSION OF THESE INDICATORS INTO THEIR    *
 15510*    ACTUAL VALUES.  IT MOVES THESE REPLACEMENTS AND THE       *
 15511*    REMAINING CHARACTERS TO THE WORK LINE.                    *
 15512****************************************************************
 15513
 15514     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 15515             AND
 15516         W-LAST-CHAR EQUAL '@'
 15517         PERFORM 7430-PROCESS-VARIABLE THRU 7430-EXIT.
 15518
 15519     SET W-WC-NDX UP BY +1.
 15520
 15521     IF  W-WC-NDX GREATER THAN +70
 15522         IF  W-FORM-SQUEEZE-ON
 15523                 AND
 15524             NOT W-AS-IS
 15525             PERFORM 7440-BACK-TO-NEAREST-WORD THRU 7440-EXIT
 15526                     VARYING
 15527                 W-WC-NDX FROM W-LAST-WC-SPACE BY +1
 15528                     UNTIL
 15529                 W-WC-NDX EQUAL +71
 15530             SET W-TX-NDX        TO W-LAST-TX-SPACE
 15531
 15532             IF  W-WORK-LINE GREATER THAN SPACES
 15533                 PERFORM 7450-SQUEEZING THRU 7450-EXIT
 15534                 MOVE SPACES     TO W-WORK-LINE
 15535                                    W-LINE-SQUEEZE-IND
 15536                 SET W-WC-NDX    TO +1
 15537             ELSE
 15538                 SET W-WC-NDX    TO +1
 15539         ELSE
 15540             PERFORM 7460-REMAIN-CHAR-CHECK THRU 7460-EXIT.
 15541
 15542     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15543                                 TO W-CHARACTER-TYPE.
 15544
 15545     SET W-WC-NDX2               TO W-WC-NDX.
 15546     SET W-WC-NDX2 DOWN BY +1.
 15547
 15548     IF  W-PUNCTUATION
 15549             AND
 15550         W-WC-NDX2 GREATER THAN W-ZEROS
 15551             AND
 15552         W-WORK-CHAR (W-WC-NDX2) EQUAL SPACES
 15553         SET W-WC-NDX DOWN BY +1.
 15554
 15555     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15556                                 TO W-LAST-CHAR
 15557                                    W-WORK-CHAR (W-WC-NDX).
 15558
 15559     IF  W-LAST-CHAR EQUAL SPACES
 15560         SET W-LAST-WC-SPACE     TO W-WC-NDX
 15561         SET W-LAST-TX-SPACE     TO W-TX-NDX.
 15562
 15563 7420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 322
* EL689.cbl
 15564     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 323
* EL689.cbl
 15566 7430-PROCESS-VARIABLE.
 15567******************************************************************
 15568*    THIS SECTION CHECKS ON ALL '@@XXX' FORMATED CHARACTER       *
 15569*    GROUPS.  IF IN PROPER FORMAT, EACH GROUP IS REPLACED WITH   *
 15570*    ITS CORRESPONDING VALUES.                                   *
 15571******************************************************************
 15572
 15573     SET W-TX-NDX UP BY +1.
 15574
 15575     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15576         MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15577                                 TO W-V1
 15578         SET W-TX-NDX UP BY +1
 15579
 15580         IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15581             MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15582                                 TO W-V2
 15583             SET W-TX-NDX UP BY +1
 15584             IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15585                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15586                                 TO W-V3
 15587                 SET W-TX-NDX UP BY +1
 15588                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15589                                 TO W-FIELD-SQUEEZE-IND
 15590                 GO TO 7430-CONTINUE
 15591             ELSE
 15592                 SET W-TX-NDX DOWN BY +3
 15593                 MOVE ER-0180    TO EMI-ERROR
 15594                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15595                 MOVE -1         TO MAINTL
 15596                 MOVE HIGH-VALUES
 15597                                 TO W-LAST-CHAR
 15598         ELSE
 15599             SET W-TX-NDX DOWN BY +2
 15600             MOVE ER-0180        TO EMI-ERROR
 15601             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15602             MOVE -1             TO MAINTL
 15603             MOVE HIGH-VALUES    TO W-LAST-CHAR
 15604     ELSE
 15605         SET W-TX-NDX DOWN BY +1
 15606         MOVE ER-7246            TO EMI-ERROR
 15607         MOVE -1                 TO MAINTL
 15608         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15609         MOVE HIGH-VALUES        TO W-LAST-CHAR.
 15610
 15611****************************************************************
 15612*    WHEN THE PROPER FORM IS NOT FOUND THE CHARACTERS INVOLVED *
 15613*    ARE TRANSFERRED INTACT AND A NOTE MADE INDICATING THIS    *
 15614*    ACTION.                                                   *
 15615****************************************************************
 15616
 15617     IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 15618         MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 15619         GO TO 7430-EXIT
 15620     ELSE
 15621         GO TO 7430-EXIT.
 15622
 15623 7430-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 324
* EL689.cbl
 15624
 15625     IF  W-VAR-RELATIVE-NUM LESS THAN 001
 15626             OR
 15627         W-VAR-RELATIVE-NUM GREATER THAN W-NUM-OF-VARIABLES
 15628         SET W-TX-NDX DOWN BY +4
 15629         MOVE ER-0180            TO EMI-ERROR
 15630         MOVE -1                 TO MAINTL
 15631         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15632         MOVE HIGH-VALUES        TO W-LAST-CHAR
 15633         IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 15634             MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 15635             GO TO 7430-EXIT
 15636         ELSE
 15637             GO TO 7430-EXIT.
 15638
 15639     SET W-VG-NDX                TO W-VAR-RELATIVE-NUM.
 15640
 15641     SET W-WC-NDX DOWN BY +1.
 15642
 15643     IF  (W-FORM-SQUEEZE-OFF
 15644                 AND
 15645             NOT W-SQUEEZE-FIELD)
 15646             OR
 15647         (W-FORM-SQUEEZE-ON
 15648                 AND
 15649             W-AS-IS)
 15650         PERFORM 7435-MOVE-VARIABLE-DIRECT THRU 7435-EXIT
 15651                 VARYING
 15652             W-VC-NDX FROM +1 BY +1
 15653                 UNTIL
 15654             W-VC-NDX GREATER THAN
 15655                 W-VARIABLE-SIZE (W-VG-NDX)
 15656
 15657         IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +5
 15658             SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 15659             SET W-TX-NDX DOWN BY +5
 15660             IF  W-TX-NDX GREATER THAN +70
 15661                 SET W-TX-NDX    TO +70
 15662                 GO TO 7430-EXIT
 15663             ELSE
 15664                 GO TO 7430-EXIT
 15665         ELSE
 15666             COMPUTE W-ADJUST-SHORT
 15667                 = 5 - W-VARIABLE-SIZE (W-VG-NDX)
 15668             SET W-WC-NDX UP BY W-ADJUST-SHORT
 15669             GO TO 7430-EXIT.
 15670
 15671     IF  W-SQUEEZE-FIELD
 15672         SET W-TX-NDX UP BY +1.
 15673
 15674     MOVE SPACES                 TO W-FIRST-CHAR-FOUND-IND.
 15675
 15676     PERFORM 7470-MOVE-CHAR THRU 7470-EXIT
 15677             VARYING
 15678         W-VC-NDX FROM +1 BY +1
 15679             UNTIL
 15680         W-VC-NDX GREATER THAN
 15681             W-VARIABLE-SIZE (W-VG-NDX).
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 325
* EL689.cbl
 15682
 15683     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 15684
 15685     IF  W-FORM-SQUEEZE-ON
 15686         GO TO 7430-EXIT.
 15687
 15688     IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +6
 15689         SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 15690         SET W-TX-NDX DOWN BY +6
 15691         IF  W-TX-NDX GREATER THAN +70
 15692             SET W-TX-NDX        TO +70.
 15693
 15694     IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 15695         SET W-WC-NDX DOWN BY +1.
 15696
 15697 7430-EXIT.
 15698     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 326
* EL689.cbl
 15700 7435-MOVE-VARIABLE-DIRECT.
 15701
 15702     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 15703             AND
 15704         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 15705             AND
 15706         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 15707             AND
 15708         (W-VC-NDX GREATER THAN +1
 15709                 AND
 15710             W-LAST-CHAR NOT EQUAL SPACE
 15711                 AND
 15712             NOT W-LAST-CHAR-PUNC)
 15713         IF  W-LC-USE-BOTH-CASES
 15714             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15715                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 15716         ELSE
 15717             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15718                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 15719
 15720     SET W-WC-NDX UP BY +1.
 15721     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15722                                 TO W-WORK-CHAR (W-WC-NDX)
 15723                                    W-LAST-CHAR.
 15724
 15725 7435-EXIT.
 15726     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 327
* EL689.cbl
 15728 7437-FIND-NEXT-CHARACTER.
 15729*DELIBERATELY LEFT BLANK.
 15730 7437-EXIT.
 15731     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 328
* EL689.cbl
 15733 7440-BACK-TO-NEAREST-WORD.
 15734
 15735     MOVE SPACES                 TO W-WORK-CHAR (W-WC-NDX).
 15736
 15737 7440-EXIT.
 15738     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 329
* EL689.cbl
 15740 7450-SQUEEZING.
 15741
 15742     IF  W-NEW-PARAGRAPH
 15743         PERFORM 7600-SET-PARA-INDENT THRU 7600-EXIT
 15744         MOVE SPACES             TO W-LINE-SQUEEZE-IND
 15745         IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15746             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15747             MOVE W-TX-PC (W-TG-NDX)
 15748                                 TO W-PRINT-CONTROL
 15749             MOVE SPACES         TO W-SQUEEZED-LINE
 15750             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 15751             SET W-SQ-NDX UP BY W-WORK-INDENT
 15752         ELSE
 15753             MOVE W-TX-PC (W-TG-NDX)
 15754                                 TO W-PRINT-CONTROL
 15755             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 15756             SET W-SQ-NDX UP BY W-WORK-INDENT
 15757     ELSE
 15758         IF  W-DO-NOT-ADJUST
 15759             MOVE SPACES         TO W-LINE-SQUEEZE-IND
 15760             IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15761                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15762                 MOVE W-WORK-LINE
 15763                                 TO W-SQUEEZED-LINE
 15764                 MOVE W-TX-PC (W-TG-NDX)
 15765                                 TO W-PRINT-CONTROL
 15766                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15767                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 15768                 MOVE SPACES     TO W-SQUEEZED-LINE
 15769                 GO TO 7450-EXIT
 15770             ELSE
 15771                 MOVE W-WORK-LINE
 15772                                 TO W-SQUEEZED-LINE
 15773                 MOVE W-TX-PC (W-TG-NDX)
 15774                                 TO W-PRINT-CONTROL
 15775                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15776                 MOVE SPACES     TO W-SQUEEZED-LINE
 15777                                    W-WORK-LINE
 15778                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 15779                 GO TO 7450-EXIT
 15780         ELSE
 15781             IF  W-ADJUST-TO-LINE-LENGTH
 15782                 MOVE SPACES     TO W-LINE-SQUEEZE-IND
 15783
 15784                 IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15785                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15786                     SET W-SQ-NDX
 15787                                 TO W-INITIAL-COLUMN
 15788                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 15789                             VARYING
 15790                         W-WC-NDX FROM 1 BY 1
 15791                             UNTIL
 15792                         W-SQ-NDX EQUAL W-TOO-FAR
 15793                     MOVE W-TX-PC (W-TG-NDX)
 15794                                 TO W-PRINT-CONTROL
 15795                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15796                     SET W-SQ-NDX
 15797                                 TO W-INITIAL-COLUMN
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 330
* EL689.cbl
 15798                     MOVE SPACES TO W-SQUEEZED-LINE
 15799                                    W-WORK-LINE
 15800                     GO TO 7450-EXIT
 15801                 ELSE
 15802                     SET W-SQ-NDX
 15803                                 TO W-INITIAL-COLUMN
 15804                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 15805                             VARYING
 15806                         W-WC-NDX FROM 1 BY 1
 15807                             UNTIL
 15808                         W-SQ-NDX EQUAL W-TOO-FAR
 15809                     MOVE W-TX-PC (W-TG-NDX)
 15810                                 TO W-PRINT-CONTROL
 15811                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15812                     MOVE SPACES TO W-SQUEEZED-LINE
 15813                                    W-WORK-LINE
 15814                     SET W-SQ-NDX
 15815                                 TO W-INITIAL-COLUMN
 15816                     GO TO 7450-EXIT
 15817             ELSE
 15818                 IF  W-CONTINUE-PARAGRAPH
 15819                     IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15820                         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15821                         PERFORM 7610-SET-CONP-INDENT
 15822                             THRU 7610-EXIT
 15823                         MOVE SPACES
 15824                                 TO W-LINE-SQUEEZE-IND
 15825                         MOVE W-TX-PC (W-TG-NDX)
 15826                                 TO W-PRINT-CONTROL
 15827                         MOVE SPACES
 15828                                 TO W-SQUEEZED-LINE
 15829                         SET W-SQ-NDX
 15830                                 TO W-INITIAL-COLUMN
 15831                         SET W-SQ-NDX UP BY W-WORK-INDENT
 15832                     ELSE
 15833                         PERFORM 7610-SET-CONP-INDENT
 15834                             THRU 7610-EXIT
 15835                         MOVE SPACES
 15836                                 TO W-LINE-SQUEEZE-IND
 15837                         MOVE W-TX-PC (W-TG-NDX)
 15838                                 TO W-PRINT-CONTROL
 15839                         MOVE SPACES
 15840                                 TO W-SQUEEZED-LINE
 15841                         SET W-SQ-NDX
 15842                                 TO W-INITIAL-COLUMN
 15843                         SET W-SQ-NDX UP BY W-WORK-INDENT.
 15844
 15845
 15846     PERFORM 7480-UPDATE-SQUEEZED-LINE THRU 7480-EXIT
 15847             VARYING
 15848         W-WC-NDX FROM +1 BY +1
 15849             UNTIL
 15850         W-WC-NDX GREATER THAN +70.
 15851
 15852 7450-EXIT.
 15853     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 331
* EL689.cbl
 15855 7460-REMAIN-CHAR-CHECK.
 15856
 15857     IF  W-TX-NDX EQUAL W-WC-NDX
 15858         MOVE W-TX-PC (W-TG-NDX)
 15859                                 TO W-PRINT-CONTROL
 15860         MOVE W-WORK-LINE        TO W-SQUEEZED-LINE
 15861         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15862         MOVE SPACES             TO W-WORK-LINE
 15863         SET W-WC-NDX            TO +1
 15864     ELSE
 15865         SET W-TX-NDX1           TO W-TX-NDX
 15866         SEARCH W-TX-CHAR
 15867             VARYING W-TX-NDX1
 15868             AT END
 15869                 MOVE W-TX-PC (W-TG-NDX)
 15870                                 TO W-PRINT-CONTROL
 15871                 MOVE W-WORK-LINE
 15872                                 TO W-SQUEEZED-LINE
 15873                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15874                 MOVE SPACES     TO W-WORK-LINE
 15875                 SET W-WC-NDX    TO +1
 15876                 SET W-TX-NDX    TO +1
 15877                 SET W-TG-NDX UP BY +1
 15878             WHEN
 15879                 W-TX-CHAR (W-TG-NDX W-TX-NDX1) NOT EQUAL SPACES
 15880                 MOVE ER-9427    TO EMI-ERROR
 15881                 MOVE -1         TO MAINTL
 15882                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15883                 MOVE W-TX-PC (W-TG-NDX)
 15884                                 TO W-PRINT-CONTROL
 15885                 MOVE W-WORK-LINE
 15886                                 TO W-SQUEEZED-LINE
 15887                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15888                 MOVE SPACES     TO W-WORK-LINE
 15889                 SET W-WC-NDX    TO +1.
 15890
 15891 7460-EXIT.
 15892     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 332
* EL689.cbl
 15894 7470-MOVE-CHAR.
 15895
 15896     IF  W-FIRST-CHAR-NOT-FOUND
 15897             AND
 15898         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 15899         MOVE SPACES             TO W-LAST-CHAR
 15900         GO TO 7470-EXIT.
 15901
 15902     MOVE 'Y'                    TO W-FIRST-CHAR-FOUND-IND.
 15903
 15904     IF  W-SQUEEZE-FIELD
 15905             AND
 15906         W-LAST-CHAR EQUAL SPACES
 15907             AND
 15908         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 15909         GO TO 7470-EXIT.
 15910
 15911     SET W-WC-NDX UP BY +1.
 15912
 15913     IF  W-WC-NDX GREATER THAN +70
 15914         IF  W-FORM-SQUEEZE-ON
 15915             GO TO 7470-EXIT
 15916         ELSE
 15917             MOVE ER-9427        TO EMI-ERROR
 15918             MOVE -1             TO MAINTL
 15919             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15920             GO TO 7470-EXIT.
 15921
 15922     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 15923             AND
 15924         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 15925             AND
 15926         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 15927             AND
 15928         (W-VC-NDX GREATER THAN +1
 15929                 AND
 15930             W-LAST-CHAR NOT EQUAL SPACE
 15931                 AND
 15932             NOT W-LAST-CHAR-PUNC)
 15933         IF  W-LC-USE-BOTH-CASES
 15934             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15935                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 15936         ELSE
 15937             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15938                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 15939
 15940     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15941                                 TO W-WORK-CHAR (W-WC-NDX)
 15942                                    W-LAST-CHAR.
 15943
 15944     IF  W-LAST-CHAR EQUAL SPACES
 15945         SET W-LAST-WC-SPACE     TO W-WC-NDX.
 15946
 15947 7470-EXIT.
 15948     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 333
* EL689.cbl
 15950 7480-UPDATE-SQUEEZED-LINE.
 15951****************************************************************
 15952*    THIS SECTION CONTROLS THE MOVEMENT FROM THE WORK LINE TO *
 15953*    THE SQUEEZED LINE.  DURING THIS PROCESS ALL EXTRA SPACES  *
 15954*    (DEFINED AS TWO OR MORE SPACES NOT FOLLOWING A END OF     *
 15955*    SENTENCE INDICATOR) ARE REMOVED.  IF THE LAST CHARACTER   *
 15956*    IS NOT A SPACE OR PUNCTUATION MARK AN UNFINISHED WORD IS  *
 15957*    ASSUMED.  EVERYTHING TO THE PREVIOUS SPACE IS REMOVED     *
 15958****************************************************************
 15959
 15960     SET W-SQ-NDX UP BY +1.
 15961
 15962     IF  W-SQ-NDX GREATER THAN W-LAST-COLUMN
 15963         MOVE W-SQ-CHAR (W-LAST-COLUMN)
 15964                                 TO W-CHARACTER-TYPE
 15965         IF  W-PUNCTUATION
 15966                 OR
 15967             W-SPACE
 15968             PERFORM 7485-FIND-NEXT-CHARACTER THRU 7485-EXIT
 15969             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15970             MOVE SPACES         TO W-SQUEEZED-LINE
 15971             SET W-SQ-NDX        TO W-START-COLUMN
 15972             SET W-SQ-NDX UP BY W-NEXT-INDENT
 15973             SET W-LAST-SQUEEZED-SPACE
 15974                                 TO W-SQ-NDX
 15975         ELSE
 15976             PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 15977             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15978             MOVE SPACES         TO W-SQUEEZED-LINE
 15979             SET W-SQ-NDX        TO W-START-COLUMN
 15980             SET W-SQ-NDX UP BY W-NEXT-INDENT
 15981             SET W-LAST-SQUEEZED-SPACE
 15982                                 TO W-SQ-NDX.
 15983
 15984     IF  W-WC-NDX GREATER THAN +70
 15985         GO TO 7480-EXIT.
 15986
 15987     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 15988
 15989     IF  W-END-OF-SENTENCE
 15990         MOVE 'Y'                TO W-END-OF-SENTENCE-IND
 15991         SET W-WORK-NDX          TO W-SQ-NDX
 15992         COMPUTE W-DISPLAY-NDX = W-WORK-NDX - 1
 15993         IF  W-DISPLAY-NDX EQUAL W-LAST-SQUEEZED-SPACE
 15994             SET W-SQ-NDX        TO W-LAST-SQUEEZED-SPACE
 15995         ELSE
 15996             NEXT SENTENCE
 15997     ELSE
 15998         IF  W-PUNCTUATION
 15999                 AND
 16000             W-LAST-SQ-CHAR EQUAL SPACES
 16001             SET W-SQ-NDX DOWN BY +1
 16002             MOVE SPACES         TO W-END-OF-SENTENCE-IND
 16003         ELSE
 16004             IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 16005                 IF  W-LAST-SQ-CHAR EQUAL SPACES
 16006                     IF  W-END-OF-SENTENCE-WORKING
 16007                         MOVE SPACES
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 334
* EL689.cbl
 16008                                 TO W-END-OF-SENTENCE-IND
 16009                         SET W-LAST-SQUEEZED-SPACE
 16010                                 TO W-SQ-NDX
 16011                     ELSE
 16012                         SET W-SQ-NDX DOWN BY +1
 16013                         GO TO 7480-EXIT
 16014                 ELSE
 16015                     SET W-LAST-SQUEEZED-SPACE
 16016                                 TO W-SQ-NDX
 16017             ELSE
 16018                 MOVE SPACES     TO W-END-OF-SENTENCE-IND.
 16019
 16020     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX)
 16021                                    W-LAST-SQ-CHAR.
 16022
 16023     IF  W-WC-NDX EQUAL +70
 16024             AND
 16025         W-WORK-CHAR (W-WC-NDX) GREATER THAN SPACES
 16026             AND
 16027         W-SQ-NDX NOT EQUAL W-LAST-COLUMN
 16028         SET W-SQ-NDX UP BY +1
 16029         SET W-LAST-SQUEEZED-SPACE
 16030                                 TO W-SQ-NDX
 16031         MOVE SPACES             TO W-SQ-CHAR (W-SQ-NDX)
 16032                                    W-LAST-SQ-CHAR.
 16033
 16034 7480-EXIT.
 16035     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 335
* EL689.cbl
 16037 7485-FIND-NEXT-CHARACTER.
 16038
 16039     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 16040
 16041     IF  W-PUNCTUATION
 16042         PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 16043     ELSE
 16044         SET W-WC-NDX            TO W-WC-NDX
 16045         SEARCH W-WORK-CHAR
 16046             VARYING W-WC-NDX
 16047             AT END
 16048                 GO TO 7485-EXIT
 16049             WHEN
 16050                 W-WORK-CHAR (W-WC-NDX) NOT EQUAL SPACES
 16051                 GO TO 7485-EXIT.
 16052
 16053 7485-EXIT.
 16054     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 336
* EL689.cbl
 16056 7490-REMOVE-LAST-WORD.
 16057
 16058*********  NOTE: W-WORK-LINE ALWAYS STARTS WITH A FULL WORD*******
 16059     IF  W-WC-NDX EQUAL +1
 16060         GO TO 7490-EXIT.
 16061
 16062     ADD +1                      TO W-LAST-SQUEEZED-SPACE.
 16063
 16064     PERFORM 7500-CLEAR-SQUEEZED-EXCESS THRU 7500-EXIT
 16065             VARYING
 16066         W-SQ-NDX FROM W-LAST-SQUEEZED-SPACE BY +1
 16067             UNTIL
 16068         W-SQ-NDX EQUAL W-TOO-FAR.
 16069
 16070     SET W-WORK-NDX              TO W-WC-NDX.
 16071     COMPUTE W-LAST-WC-SPACE
 16072         = W-WORK-NDX - W-TOO-FAR + W-LAST-SQUEEZED-SPACE.
 16073     SET W-WC-NDX                TO W-LAST-WC-SPACE.
 16074
 16075 7490-EXIT.
 16076     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 337
* EL689.cbl
 16078 7500-CLEAR-SQUEEZED-EXCESS.
 16079
 16080     MOVE SPACES                 TO W-SQ-CHAR (W-SQ-NDX).
 16081
 16082 7500-EXIT.
 16083     EXIT.
 16084
 16085 7505-MOVE-STRAIGHT.
 16086
 16087     SET W-SQ-NDX UP BY +1.
 16088
 16089     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX).
 16090
 16091 7505-EXIT.
 16092     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 338
* EL689.cbl
 16094 7510-MOVE-TO-TABLE.
 16095
 16096     IF  W-PRINT-CONTROL NOT NUMERIC
 16097         MOVE 00                 TO W-PRINT-CONTROL
 16098         ADD +1                  TO W-LINE-COUNT
 16099     ELSE
 16100         IF  W-PRINT-CONTROL EQUAL 99
 16101             PERFORM 7640-PAGING THRU 7640-EXIT
 16102             MOVE 00             TO W-PRINT-CONTROL
 16103             SET W-RG-NDX UP BY +1
 16104             MOVE W-TOP-FORM     TO W-RC-TEXT (W-RG-NDX)
 16105             MOVE +1             TO W-LINE-COUNT
 16106             SET W-RG-NDX UP BY W-TOP-MARGIN
 16107         ELSE
 16108           IF W-SQUEEZED-LINE (1:6) NOT EQUAL '&&&&&&'
 16109             COMPUTE W-LINE-COUNT
 16110                 = W-LINE-COUNT + W-PRINT-CONTROL + 1.
 16111
 16112     IF  W-LINE-COUNT GREATER THAN W-MAX-LINES-PER-PAGE
 16113         PERFORM 7640-PAGING THRU 7640-EXIT
 16114         MOVE 00                 TO W-PRINT-CONTROL
 16115         SET W-RG-NDX UP BY +1
 16116         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 16117         SET W-RG-NDX UP BY W-TOP-MARGIN
 16118         MOVE +1                 TO W-LINE-COUNT.
 16119
 16120     SET W-RG-NDX UP BY W-PRINT-CONTROL.
 16121     SET W-RG-NDX UP BY +1.
 16122     MOVE W-SQUEEZED-LINE        TO W-RC-TEXT (W-RG-NDX).
 16123     MOVE 00                     TO W-PRINT-CONTROL.
 16124
 16125     IF  W-FIRST-BAD-VARIABLE-FOUND
 16126             AND
 16127         W-FIRST-BAD-VARIABLE EQUAL ZEROS
 16128         SET W-FIRST-BAD-VARIABLE
 16129                                 TO W-RG-NDX.
 16130
 16131 7510-EXIT.
 16132     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 339
* EL689.cbl
 16134 7600-SET-PARA-INDENT.
 16135
 16136     IF  W-LINE-SQUEEZE-IND EQUAL 'P'
 16137         MOVE W-PARAGRAPH-INDENT TO W-WORK-INDENT
 16138     ELSE
 16139     IF  W-LINE-SQUEEZE-IND EQUAL 'Q'
 16140         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 16141         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16142     ELSE
 16143     IF  W-LINE-SQUEEZE-IND EQUAL 'R'
 16144         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 16145         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16146     ELSE
 16147     IF  W-LINE-SQUEEZE-IND EQUAL 'S'
 16148         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 16149         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16150     ELSE
 16151     IF  W-LINE-SQUEEZE-IND EQUAL 'T'
 16152         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 16153         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16154     ELSE
 16155     IF  W-LINE-SQUEEZE-IND EQUAL 'U'
 16156         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT
 16157         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT.
 16158
 16159     SET W-TG-NDX2               TO W-TG-NDX.
 16160     SET W-TG-NDX2 UP BY +1.
 16161
 16162     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 16163         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 16164     ELSE
 16165         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 16166
 16167 7600-EXIT.
 16168     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 340
* EL689.cbl
 16170 7610-SET-CONP-INDENT.
 16171
 16172     IF  W-LINE-SQUEEZE-IND EQUAL 'C'
 16173         MOVE +0                 TO W-WORK-INDENT
 16174     ELSE
 16175     IF  W-LINE-SQUEEZE-IND EQUAL 'D'
 16176         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 16177     ELSE
 16178     IF  W-LINE-SQUEEZE-IND EQUAL 'E'
 16179         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 16180     ELSE
 16181     IF  W-LINE-SQUEEZE-IND EQUAL 'F'
 16182         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 16183     ELSE
 16184     IF  W-LINE-SQUEEZE-IND EQUAL 'G'
 16185         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 16186     ELSE
 16187     IF  W-LINE-SQUEEZE-IND EQUAL 'H'
 16188         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT.
 16189
 16190     SET W-TG-NDX2               TO W-TG-NDX.
 16191     SET W-TG-NDX2 UP BY +1.
 16192
 16193     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 16194         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 16195     ELSE
 16196         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 16197
 16198 7610-EXIT.
 16199     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 341
* EL689.cbl
 16201 7630-NEXT-LINE.
 16202
 16203     IF  W-TX-SC (W-TG-NDX2) EQUAL ' '
 16204         MOVE ZEROS              TO W-NEXT-INDENT
 16205     ELSE
 16206     IF  W-TX-SC (W-TG-NDX2) EQUAL '1'
 16207         MOVE W-LINE-INDENT-1    TO W-NEXT-INDENT
 16208     ELSE
 16209     IF  W-TX-SC (W-TG-NDX2) EQUAL '2'
 16210         MOVE W-LINE-INDENT-2    TO W-NEXT-INDENT
 16211     ELSE
 16212     IF  W-TX-SC (W-TG-NDX2) EQUAL '3'
 16213         MOVE W-LINE-INDENT-3    TO W-NEXT-INDENT
 16214     ELSE
 16215     IF  W-TX-SC (W-TG-NDX2) EQUAL '4'
 16216         MOVE W-LINE-INDENT-4    TO W-NEXT-INDENT
 16217     ELSE
 16218     IF  W-TX-SC (W-TG-NDX2) EQUAL '5'
 16219         MOVE W-LINE-INDENT-5    TO W-NEXT-INDENT
 16220     ELSE
 16221         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 16222         SUBTRACT W-PARAGRAPH-INDENT
 16223                                  FROM W-NEXT-INDENT.
 16224
 16225 7630-EXIT.
 16226     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 342
* EL689.cbl
 16228 7640-PAGING.
 16229
 16230     IF  NOT W-LC-CREATE-PAGES
 16231         GO TO 7640-EXIT.
 16232
 16233     IF  W-LINE-COUNT GREATER ZEROS
 16234             AND
 16235         W-RG-NDX GREATER THAN +1
 16236         ADD +1                  TO W-PAGE
 16237         MOVE W-PAGE             TO W-PAGE-NUMBER
 16238         COMPUTE W-PAGE-LINE
 16239             = W-MAX-LINES-PER-PAGE - W-LINE-COUNT + 3
 16240         IF  W-PAGE-LINE GREATER THAN +2
 16241             SET W-RG-NDX UP BY W-PAGE-LINE
 16242             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX)
 16243         ELSE
 16244             SET W-RG-NDX UP BY +2
 16245             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX).
 16246
 16247 7640-EXIT.
 16248     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 343
* EL689.cbl
 16250 7700-READ-TEXT-TS.
 16251**************************************************************
 16252*  THIS PARAGRAPH READS THE TEMPORARY STORAGE RECORDS THAT   *
 16253*  CONTAIN THE TEXT THAT IS PAST BETWEEN EL689, EL6892       *
 16254*  AND EL1042.                                               *
 16255**************************************************************
 16256
 16257
 16258* EXEC CICS HANDLE CONDITION
 16259*         QIDERR     (7700-TS-ERROR)
 16260*         ITEMERR    (7700-TS-ERROR)
 16261*    END-EXEC.
 16262*    MOVE '"$N<                  ! 9 #00015151' TO DFHEIV0
 16263     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 16264     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16265     MOVE X'3920233030303135313531' TO DFHEIV0(25:11)
 16266     CALL 'kxdfhei1' USING DFHEIV0
 16267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16268
 16269
 16270     SET W-TS-NDX                TO 1.
 16271     MOVE 1                      TO W-TS-ITEM.
 16272
 16273 7700-LOOP.
 16274
 16275     IF  W-TS-ITEM GREATER THAN PI-TEMP-STOR-ITEMS
 16276         IF  PI-TEMP-STOR-ITEMS GREATER THAN ZEROS
 16277             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 16278             GO TO 7700-EXIT
 16279         ELSE
 16280             GO TO 7700-EXIT.
 16281
 16282
 16283* EXEC CICS READQ TS
 16284*         INTO     (W-TS-WORK-AREA)
 16285*         QUEUE    (W-TS-NAME-TEXT)
 16286*         LENGTH   (W-TS-LENGTH)
 16287*         ITEM     (W-TS-ITEM)
 16288*    END-EXEC.
 16289*    MOVE '*$II   L              ''   #00015168' TO DFHEIV0
 16290     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 16291     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16292     MOVE X'2020233030303135313638' TO DFHEIV0(25:11)
 16293     CALL 'kxdfhei1' USING DFHEIV0,
 16294           W-TS-NAME-TEXT,
 16295           W-TS-WORK-AREA,
 16296           W-TS-LENGTH,
 16297           W-TS-ITEM,
 16298           DFHEIV99,
 16299           DFHEIV99
 16300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16301
 16302
 16303     MOVE W-TS-WORK-AREA         TO W-TS-GROUP (W-TS-NDX).
 16304     SET W-TS-NDX UP BY 1.
 16305     ADD 1                       TO W-TS-ITEM.
 16306     GO TO 7700-LOOP.
 16307
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 344
* EL689.cbl
 16308 7700-TS-ERROR.
 16309
 16310     IF  EIBTRNID = W-TRANSACTION OR 'EX14'
 16311         MOVE ER-0033            TO EMI-ERROR
 16312         MOVE -1                 TO MAINTL
 16313         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16314         GO TO 8200-SEND-DATAONLY.
 16315
 16316 7700-EXIT.
 16317      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 345
* EL689.cbl
 16319 7740-RESTORE-SCREEN.
 16320
 16321     MOVE 'C'                    TO MAINTI.
 16322     MOVE +1                     TO MAINTL.
 16323     MOVE AL-UANON               TO MAINTA.
 16324
 16325     MOVE PI-689-FORM-NUMBER     TO FORMI.
 16326     MOVE +4                     TO FORML.
 16327     MOVE AL-UANON               TO FORMA.
 16328
 16329*    IF  PI-689-PRINT-RESTRICTION GREATER THAN SPACES
 16330*        MOVE PI-689-PRINT-RESTRICTION
 16331*                                TO PRTRESTL
 16332*        MOVE +1                 TO PRTRESTL
 16333*        MOVE AL-UANON           TO PRTRESTA.
 16334
 16335     IF  PI-689-FOLLOW-UP-EDIT GREATER THAN SPACES
 16336         MOVE PI-689-FOLLOW-UP-EDIT
 16337                                 TO FOLLOWI
 16338         MOVE +8                 TO FOLLOWL
 16339         MOVE AL-UANON           TO FOLLOWA.
 16340
 16341     IF  PI-689-RESEND1-EDIT GREATER THAN SPACES
 16342         MOVE PI-689-RESEND1-EDIT
 16343                                 TO RESEND1I
 16344         MOVE +8                 TO RESEND1L
 16345         MOVE AL-UANON           TO RESEND1A.
 16346     IF  PI-689-ALT-PRINTER-ID GREATER THAN SPACES
 16347         MOVE PI-689-ALT-PRINTER-ID
 16348                                 TO PRINTERI
 16349         MOVE +1                 TO PRINTERL
 16350         MOVE AL-UANON           TO PRINTERA.
 16351
 16352     IF  PI-BYPASS-LABELS
 16353          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 16354          MOVE +1                TO ADDRLBLL
 16355          MOVE AL-UANON          TO ADDRLBLA
 16356     ELSE
 16357          IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 16358               MOVE PI-689-LBL-OVERRIDE
 16359                                 TO ADDRLBLI
 16360               MOVE +1           TO ADDRLBLL
 16361               MOVE AL-UANON     TO ADDRLBLA.
 16362
 16363     IF  PI-689-NUMBER-COPIES GREATER THAN ZEROS
 16364         MOVE PI-689-NUMBER-COPIES   TO COPIESI
 16365         MOVE +1                     TO COPIESL
 16366         MOVE AL-UNNON               TO COPIESA.
 16367
 16368     IF  PI-689-LABEL-SOURCE GREATER THAN SPACES
 16369         MOVE PI-689-LABEL-SOURCE
 16370                                 TO ADDRSI
 16371         MOVE +1                 TO ADDRSL
 16372         MOVE AL-UANON           TO ADDRSA.
 16373
 16374     MOVE PI-689-DATA-SOURCE     TO DATASORI.
 16375     MOVE +1                     TO DATASORL.
 16376     MOVE AL-UANON               TO DATASORA.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 346
* EL689.cbl
 16377
 16378     IF  PI-689-CARRIER GREATER THAN SPACES
 16379         MOVE PI-689-CARRIER     TO CARRIERI
 16380         MOVE +1                 TO CARRIERL
 16381         MOVE AL-UANON           TO CARRIERA.
 16382
 16383     IF  PI-689-GROUPING GREATER THAN SPACES
 16384         MOVE PI-689-GROUPING    TO GROUPI
 16385         MOVE +6                 TO GROUPL
 16386         MOVE AL-UANON           TO GROUPA.
 16387
 16388     IF  PI-689-STATE GREATER THAN SPACES
 16389         MOVE PI-689-STATE       TO STATEI
 16390         MOVE +2                 TO STATEL
 16391         MOVE AL-UANON           TO STATEA.
 16392
 16393     IF  PI-689-ACCOUNT GREATER THAN SPACES
 16394         MOVE PI-689-ACCOUNT     TO ACCTI
 16395         MOVE +10                TO ACCTL
 16396         MOVE AL-UANON           TO ACCTA.
 16397
 16398     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 16399         MOVE PI-689-CERT-PRIME  TO CERTI
 16400         MOVE +10                TO CERTL
 16401         MOVE AL-UANON           TO CERTA.
 16402
 16403     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 16404         MOVE PI-689-CERT-SFX    TO SFXI
 16405         MOVE +1                 TO SFXL
 16406         MOVE AL-UANON           TO SFXA.
 16407
 16408     IF  PI-689-TYPE GREATER THAN SPACES
 16409         MOVE PI-689-TYPE        TO TYPEI
 16410         MOVE +1                 TO TYPEL
 16411         MOVE AL-UANON           TO TYPEA.
 16412
 16413     IF  PI-689-RESP-PERSON GREATER THAN SPACES
 16414         MOVE PI-689-RESP-PERSON TO RPERSONI
 16415         MOVE +10                TO RPERSONL
 16416         MOVE AL-UANON           TO RPERSONA.
 16417
 16418     IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 16419         MOVE PI-689-ENTRY-BATCH TO BENTRYI
 16420         MOVE +6                 TO BENTRYL
 16421         MOVE AL-UANON           TO BENTRYA.
 16422
 16423     IF  PI-689-SEQ-EDIT GREATER THAN SPACES
 16424         MOVE PI-689-SEQ-EDIT    TO SEQI
 16425         MOVE +8                 TO SEQL
 16426         MOVE AL-UNNON           TO SEQA.
 16427
 16428     IF  PI-689-BCSEQ-EDIT GREATER THAN SPACES
 16429         MOVE PI-689-BCSEQ-EDIT  TO BCSEQI
 16430         MOVE +4                 TO BCSEQL
 16431         MOVE AL-UNNON           TO BCSEQA.
 16432
 16433     IF  PI-689-DATE-EDIT GREATER THAN SPACES
 16434         MOVE PI-689-DATE-EDIT   TO DATEI
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 347
* EL689.cbl
 16435         MOVE +8                 TO DATEL
 16436         MOVE AL-UNNON           TO DATEA.
 16437
 16438     IF PI-CERT-FORM-ID GREATER THAN SPACES
 16439        MOVE PI-CERT-FORM-ID     TO CERTIDI
 16440        MOVE +5                  TO CERTIDL
 16441        MOVE AL-UNNON            TO CERTIDA
 16442     END-IF.
 16443
 16444     IF PI-PRINT-NOW GREATER THAN SPACES
 16445        MOVE PI-PRINT-NOW        TO PRTNOWI
 16446        MOVE +1                  TO PRTNOWL
 16447        MOVE AL-UNNON            TO PRTNOWA
 16448     END-IF.
 16449     IF PI-ENDT-ARCH-NO GREATER THAN ZERO
 16450        MOVE PI-ENDT-ARCH-NO     TO ENDARCHI
 16451        MOVE +8                  TO ENDARCHL
 16452        MOVE AL-UNNON            TO ENDARCHA
 16453     END-IF
 16454
 16455     MOVE PI-ENCLOSURE-CD        TO ENCI.
 16456     MOVE +3                     TO ENCL.
 16457     MOVE AL-UANON               TO ENCA.
 16458
 16459 7749-EXIT.
 16460     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 348
* EL689.cbl
 16462 7760-PUT-TEMP-STORAGE.
 16463**************************************************************
 16464*  THIS PARAGRAPH WRITES THE TEMPORARY STORAGE RECORDS THAT  *
 16465*  WILL CONTAIN THE CONTENTS OF THE TEXT TABLE FOR USE BY    *
 16466*  EL1042 AND EL6892.                                        *
 16467**************************************************************
 16468
 16469     SET W-TS-NDX                TO 1.
 16470     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 16471
 16472     MOVE -1                     TO MAINTL.
 16473     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 16474             VARYING
 16475         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 16476             UNTIL
 16477         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 16478
 16479 7760-EXIT.
 16480      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 349
* EL689.cbl
 16482 7780-DELETE-TEMP-STOR-TEXT.
 16483
 16484
 16485* EXEC CICS HANDLE CONDITION
 16486*         QIDERR      (7780-EXIT)
 16487*    END-EXEC.
 16488*    MOVE '"$N                   ! : #00015356' TO DFHEIV0
 16489     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 16490     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16491     MOVE X'3A20233030303135333536' TO DFHEIV0(25:11)
 16492     CALL 'kxdfhei1' USING DFHEIV0
 16493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16494
 16495
 16496
 16497* EXEC CICS DELETEQ TS
 16498*         QUEUE       (W-TS-NAME-TEXT)
 16499*    END-EXEC.
 16500*    MOVE '*&                    #   #00015360' TO DFHEIV0
 16501     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 16502     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16503     MOVE X'2020233030303135333630' TO DFHEIV0(25:11)
 16504     CALL 'kxdfhei1' USING DFHEIV0,
 16505           W-TS-NAME-TEXT,
 16506           DFHEIV99
 16507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16508
 16509
 16510 7780-EXIT.
 16511     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 350
* EL689.cbl
 16513 7840-WRITE-TS.
 16514
 16515     MOVE W-TS-GROUP (W-TS-NDX)  TO W-TS-WORK-AREA.
 16516     SET W-TS-NDX UP BY 1.
 16517     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 16518
 16519
 16520* EXEC CICS WRITEQ TS
 16521*         FROM    (W-TS-WORK-AREA)
 16522*         QUEUE   (W-TS-NAME-TEXT)
 16523*         LENGTH  (W-TS-LENGTH)
 16524*         ITEM    (PI-TEMP-STOR-ITEMS)
 16525*    END-EXEC.
 16526*    MOVE '*" I                  ''   #00015373' TO DFHEIV0
 16527     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 16528     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16529     MOVE X'2020233030303135333733' TO DFHEIV0(25:11)
 16530     CALL 'kxdfhei1' USING DFHEIV0,
 16531           W-TS-NAME-TEXT,
 16532           W-TS-WORK-AREA,
 16533           W-TS-LENGTH,
 16534           PI-TEMP-STOR-ITEMS,
 16535           DFHEIV99,
 16536           DFHEIV99
 16537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16538
 16539
 16540 7840-EXIT.
 16541     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 351
* EL689.cbl
 16543 7900-PRINT-LETTER-NOW.
 16544***************************************************************
 16545*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 16546*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 16547*     THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS.          *
 16548*     THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE.       *
 16549*     THE LETTER IS SAVED IN TEMP-STORAGE AND A START IS      *
 16550*     ISSUED FOR THE PRINT TRANSACTION.                       *
 16551***************************************************************
 16552
 16553*    IF (EIBAID = DFHPF4 OR DFHPF8)
 16554*            AND
 16555*        PI-SHOW-MODE
 16556*        IF  PRINTERL GREATER ZERO
 16557*            INSPECT PRINTERI CONVERTING W-LOWER-CASE TO
 16558*                                                    W-UPPER-CASE
 16559*            MOVE PRINTERI       TO PI-689-ALT-PRINTER-ID
 16560*                                   PI-ALT-DMD-PRT-ID.
 16561*
 16562*    IF  EIBAID EQUAL DFHPF8
 16563*            AND
 16564*        PI-SHOW-MODE
 16565*            AND
 16566*        LA-INITIAL-PRINT-DATE GREATER THAN LOW-VALUES
 16567*        MOVE ER-7247            TO EMI-ERROR
 16568*        MOVE -1                 TO MAINTL
 16569*        MOVE AL-UABON           TO MAINTA
 16570*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16571*        GO TO 8200-SEND-DATAONLY.
 16572
 16573     IF  PI-TOTAL-LINES EQUAL 0
 16574         MOVE ER-0187            TO EMI-ERROR
 16575         MOVE -1                 TO MAINTL
 16576         MOVE AL-UABON           TO MAINTA
 16577         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16578         GO TO 8200-SEND-DATAONLY.
 16579
 16580     IF  EMI-ERROR NOT EQUAL ER-0191
 16581         IF  PI-689-CREATE-NO-SCREENS
 16582*                OR
 16583*            (EIBAID = DFHPF4 OR DFHPF8)
 16584             SET W-RG-NDX        TO +1
 16585         ELSE
 16586             PERFORM 4100-SET-NDX THRU 4100-EXIT
 16587             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 16588                     VARYING
 16589                 W-SC-NDX FROM 1 BY 1
 16590                     UNTIL
 16591                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 16592
 16593     MOVE SPACES                 TO W-REMAINING-VAR-SW.
 16594
 16595     IF EIBAID NOT = DFHPF4 AND DFHPF8
 16596         PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 16597                 VARYING
 16598             W-RVS-NDX FROM +1 BY +1
 16599                 UNTIL
 16600             W-RVS-NDX GREATER THAN +36500
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 352
* EL689.cbl
 16601                 OR
 16602             W-REMAINING-VAR-FOUND
 16603         IF  W-REMAINING-VAR-FOUND
 16604             GO TO 4000-ROLL-PAGE.
 16605
 16606*    IF EIBAID = DFHPF4 OR DFHPF8
 16607*       PERFORM 7700-READ-TEXT-TS
 16608*                                THRU 7700-EXIT
 16609*
 16610*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 16611*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 16612*                VARYING
 16613*            W-SC-NDX FROM 1 BY 1
 16614*                UNTIL
 16615*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 16616*
 16617*       PERFORM 7760-PUT-TEMP-STORAGE
 16618*                                THRU 7760-EXIT
 16619*    END-IF
 16620     IF PI-689-ALT-PRINTER-ID NOT = SPACES AND LOW-VALUES
 16621         MOVE PI-689-ALT-PRINTER-ID
 16622                                 TO W-TS-TERM-TEXT
 16623     ELSE
 16624         IF PI-PROCESSOR-PRINTER NOT = SPACES AND LOW-VALUES
 16625             MOVE PI-PROCESSOR-PRINTER
 16626                                 TO W-TS-TERM-TEXT
 16627         ELSE
 16628             MOVE PI-COMPANY-ID  TO W-CNTL-COMPANY-ID
 16629             MOVE '1'            TO W-CNTL-RECORD-TYPE
 16630             MOVE SPACES         TO W-CNTL-GENL
 16631             MOVE ZEROS          TO W-CNTL-SEQ-NO
 16632
 16633* EXEC CICS HANDLE CONDITION
 16634*                 NOTOPEN    (8040-CNTL-NOT-OPEN)
 16635*                 NOTFND     (7945-NOT-FOUND)
 16636*            END-EXEC
 16637*    MOVE '"$JI                  ! ; #00015472' TO DFHEIV0
 16638     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 16639     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16640     MOVE X'3B20233030303135343732' TO DFHEIV0(25:11)
 16641     CALL 'kxdfhei1' USING DFHEIV0
 16642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16643
 16644* EXEC CICS READ
 16645*                 DATASET    (W-CNTL-FILE-ID)
 16646*                 SET        (ADDRESS OF CONTROL-FILE)
 16647*                 RIDFLD     (W-CNTL-KEY)
 16648*            END-EXEC
 16649*    MOVE '&"S        E          (   #00015476' TO DFHEIV0
 16650     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16651     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16652     MOVE X'2020233030303135343736' TO DFHEIV0(25:11)
 16653     CALL 'kxdfhei1' USING DFHEIV0,
 16654           W-CNTL-FILE-ID,
 16655           DFHEIV20,
 16656           DFHEIV99,
 16657           W-CNTL-KEY,
 16658           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 353
* EL689.cbl
 16659           DFHEIV99,
 16660           DFHEIV99
 16661     SET ADDRESS OF CONTROL-FILE TO
 16662         DFHEIV20
 16663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16664             MOVE CF-FORMS-PRINTER-ID
 16665                                 TO W-TS-TERM-TEXT.
 16666
 16667***********************************************************
 16668*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 16669*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 16670***********************************************************
 16671
 16672     SET W-TS-NDX                TO 1.
 16673     MOVE EIBTIME                TO W-TS-ID-TIME.
 16674     MOVE W-TS-NAME-TEXT         TO PI-689-TEMP-STOR-ID.
 16675     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 16676
 16677     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 16678             VARYING
 16679         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 16680             UNTIL
 16681         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 16682
 16683*    IF  EIBAID EQUAL DFHPF8
 16684*        MOVE '1'                TO PI-689-PRINT-SW
 16685*    ELSE
 16686         MOVE SPACES             TO PI-689-PRINT-SW.
 16687
 16688
 16689* EXEC CICS HANDLE CONDITION
 16690*         TERMIDERR  (7935-TERM-ERROR)
 16691*         TRANSIDERR (7940-TRAN-ERROR)
 16692*    END-EXEC.
 16693*    MOVE '"$[\                  ! < #00015505' TO DFHEIV0
 16694     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 16695     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16696     MOVE X'3C20233030303135353035' TO DFHEIV0(25:11)
 16697     CALL 'kxdfhei1' USING DFHEIV0
 16698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16699
 16700
 16701
 16702* EXEC CICS START
 16703*             INTERVAL    (0)
 16704*             TRANSID     (W-PRINT-TRANS)
 16705*             FROM        (PROGRAM-INTERFACE-BLOCK)
 16706*             LENGTH      (PI-COMM-LENGTH)
 16707*             TERMID      (W-TS-TERM-TEXT)
 16708*    END-EXEC.
 16709     MOVE 0 TO DFHEIV10
 16710*    MOVE '0(ILFT                1   #00015510' TO DFHEIV0
 16711     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 16712     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
 16713     MOVE X'2020233030303135353130' TO DFHEIV0(25:11)
 16714     CALL 'kxdfhei1' USING DFHEIV0,
 16715           DFHEIV10,
 16716           W-PRINT-TRANS,
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 354
* EL689.cbl
 16717           DFHEIV99,
 16718           PROGRAM-INTERFACE-BLOCK,
 16719           PI-COMM-LENGTH,
 16720           W-TS-TERM-TEXT,
 16721           DFHEIV99,
 16722           DFHEIV99,
 16723           DFHEIV99,
 16724           DFHEIV99,
 16725           DFHEIV99,
 16726           DFHEIV99,
 16727           DFHEIV99,
 16728           DFHEIV99,
 16729           DFHEIV99,
 16730           DFHEIV99
 16731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16732
 16733
 16734
 16735* EXEC CICS SYNCPOINT
 16736*    END-EXEC.
 16737*    MOVE '6"                    !   #00015518' TO DFHEIV0
 16738     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
 16739     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16740     MOVE X'2020233030303135353138' TO DFHEIV0(25:11)
 16741     CALL 'kxdfhei1' USING DFHEIV0
 16742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16743
 16744
 16745     IF  PI-689-CREATE-NO-SCREENS
 16746         GO TO 7900-EXIT.
 16747
 16748*    IF  EIBAID EQUAL DFHPF8
 16749*            AND
 16750*        PI-SHOW-MODE
 16751*            AND
 16752*        LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES
 16753*        PERFORM 7920-UPDATE-INITIAL-PRINT THRU 7920-EXIT.
 16754
 16755     MOVE ER-0189                TO EMI-ERROR.
 16756     MOVE -1                     TO MAINTL.
 16757
 16758     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16759     MOVE -1                     TO MAINTL
 16760     MOVE AL-UABON               TO MAINTA
 16761     MOVE '104A'                 TO W-TS-ID-TEXT
 16762     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 16763                                    W-TS-TERM-SCREEN
 16764     GO TO 8200-SEND-DATAONLY.
 16765
 16766 7900-EXIT.
 16767     EXIT.
 16768
 16769 7915-SEARCH-REMAINING-VARS.
 16770
 16771     IF  W-REC-CHAR (W-RVS-NDX) EQUAL '@'
 16772         SET W-RVS-NDX2          TO W-RVS-NDX
 16773         SET W-RVS-NDX2 UP BY +1
 16774         IF  W-REC-CHAR (W-RVS-NDX2) EQUAL '@'
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 355
* EL689.cbl
 16775             SET W-RVS-NDX2 UP BY +1
 16776             IF  W-REC-CHAR (W-RVS-NDX2) NUMERIC
 16777                 SET PI-CURRENT-LINE  TO W-RVS-NDX
 16778                 COMPUTE PI-CURRENT-LINE
 16779                     = PI-CURRENT-LINE / 73
 16780                 MOVE 'Y'        TO W-REMAINING-VAR-SW
 16781                 MOVE +0         TO W-ROLL-COUNTER
 16782                 MOVE ER-0191    TO EMI-ERROR
 16783                 MOVE -1         TO MAINTL
 16784                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16785
 16786 7915-EXIT.
 16787     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 356
* EL689.cbl
 16789 7920-UPDATE-INITIAL-PRINT.
 16790
 16791
 16792* EXEC CICS HANDLE CONDITION
 16793*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 16794*         NOTFND     (1070-ARCH-NOT-FOUND)
 16795*         ENDFILE    (1070-ARCH-NOT-FOUND)
 16796*    END-EXEC.
 16797*    MOVE '"$JI''                 ! = #00015567' TO DFHEIV0
 16798     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 16799     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16800     MOVE X'3D20233030303135353637' TO DFHEIV0(25:11)
 16801     CALL 'kxdfhei1' USING DFHEIV0
 16802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16803
 16804     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
 16805     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 16806
 16807* EXEC CICS READ
 16808*        DATASET (W-ARCH-FILE-ID)
 16809*        SET     (ADDRESS OF LETTER-ARCHIVE)
 16810*        RIDFLD  (W-ARCH-PARTIAL-KEY)
 16811*        UPDATE
 16812*    END-EXEC.
 16813*    MOVE '&"S        EU         (   #00015574' TO DFHEIV0
 16814     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16815     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16816     MOVE X'2020233030303135353734' TO DFHEIV0(25:11)
 16817     CALL 'kxdfhei1' USING DFHEIV0,
 16818           W-ARCH-FILE-ID,
 16819           DFHEIV20,
 16820           DFHEIV99,
 16821           W-ARCH-PARTIAL-KEY,
 16822           DFHEIV99,
 16823           DFHEIV99,
 16824           DFHEIV99
 16825     SET ADDRESS OF LETTER-ARCHIVE TO
 16826         DFHEIV20
 16827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16828
 16829
 16830     MOVE W-SAVE-BIN-DATE        TO LA-INITIAL-PRINT-DATE.
 16831
 16832     IF  LA-RESEND-DATE = LOW-VALUES
 16833         MOVE 'C'                TO LA-STATUS.
 16834
 16835
 16836* EXEC CICS REWRITE
 16837*         FROM      (LETTER-ARCHIVE)
 16838*         DATASET   (W-ARCH-FILE-ID)
 16839*    END-EXEC.
 16840     MOVE LENGTH OF
 16841      LETTER-ARCHIVE
 16842       TO DFHEIV11
 16843*    MOVE '&& L                  %   #00015586' TO DFHEIV0
 16844     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16845     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16846     MOVE X'2020233030303135353836' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 357
* EL689.cbl
 16847     CALL 'kxdfhei1' USING DFHEIV0,
 16848           W-ARCH-FILE-ID,
 16849           LETTER-ARCHIVE,
 16850           DFHEIV11,
 16851           DFHEIV99
 16852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16853
 16854
 16855 7920-EXIT.
 16856     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 358
* EL689.cbl
 16858 7935-TERM-ERROR.
 16859
 16860     MOVE ER-0412                TO EMI-ERROR.
 16861     MOVE SPACES                 TO PI-689-PRINT-SW.
 16862     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16863     MOVE -1                     TO MAINTL.
 16864     GO TO 8200-SEND-DATAONLY.
 16865
 16866 7940-TRAN-ERROR.
 16867
 16868     MOVE ER-0413                TO EMI-ERROR.
 16869     MOVE SPACES                 TO PI-689-PRINT-SW.
 16870     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16871     MOVE -1                     TO MAINTL.
 16872     GO TO 8200-SEND-DATAONLY.
 16873
 16874 7945-NOT-FOUND.
 16875
 16876     MOVE ER-0190                TO EMI-ERROR.
 16877     MOVE -1                     TO MAINTL.
 16878     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16879     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 359
* EL689.cbl
 16881 8010-ARCH-NOT-OPEN.
 16882
 16883     MOVE ER-7388                TO EMI-ERROR.
 16884     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16885     MOVE -1                     TO MAINTL.
 16886     GO TO 8200-SEND-DATAONLY.
 16887
 16888 8015-ARCT-NOT-OPEN.
 16889
 16890     MOVE ER-7373                TO EMI-ERROR.
 16891     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16892     MOVE -1                     TO MAINTL.
 16893     GO TO 8200-SEND-DATAONLY.
 16894
 16895 8020-ACCT-NOT-OPEN.
 16896
 16897     MOVE ER-0168 TO EMI-ERROR
 16898     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16899     MOVE -1                     TO MAINTL.
 16900     GO TO 8200-SEND-DATAONLY.
 16901
 16902 8030-CERT-NOT-OPEN.
 16903
 16904     MOVE ER-0169 TO EMI-ERROR.
 16905     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16906     MOVE -1                     TO MAINTL.
 16907     GO TO 8200-SEND-DATAONLY.
 16908
 16909 8035-CERT-NOT-FOUND.
 16910
 16911     MOVE ER-2369 TO EMI-ERROR.
 16912     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16913     MOVE -1                     TO MAINTL.
 16914     GO TO 8200-SEND-DATAONLY.
 16915
 16916 8040-CNTL-NOT-OPEN.
 16917
 16918     MOVE ER-0042                TO EMI-ERROR.
 16919     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16920     MOVE -1                     TO MAINTL.
 16921     GO TO 8200-SEND-DATAONLY.
 16922
 16923 8045-CHEK-NOT-OPEN.
 16924
 16925     MOVE ER-3775                TO EMI-ERROR.
 16926     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16927     MOVE -1                     TO MAINTL.
 16928     GO TO 8200-SEND-DATAONLY.
 16929
 16930 8050-TEXT-NOT-OPEN.
 16931
 16932     MOVE ER-0013                TO EMI-ERROR.
 16933     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16934     MOVE -1                     TO MAINTL.
 16935     GO TO 8200-SEND-DATAONLY.
 16936
 16937 8060-PNDB-NOT-OPEN.
 16938
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 360
* EL689.cbl
 16939     MOVE ER-2216 TO EMI-ERROR.
 16940     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16941     MOVE -1                     TO MAINTL.
 16942     GO TO 8200-SEND-DATAONLY.
 16943
 16944 8070-PNDB-NOT-FOUND.
 16945
 16946     MOVE ER-7374 TO EMI-ERROR.
 16947     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16948     MOVE -1                     TO MAINTL.
 16949     GO TO 8200-SEND-DATAONLY.
 16950
 16951 8080-COMP-NOT-OPEN.
 16952
 16953     MOVE ER-2055 TO EMI-ERROR
 16954     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16955     MOVE -1                     TO MAINTL.
 16956     GO TO 8200-SEND-DATAONLY.
 16957
 16958 8085-PYAJ-NOT-OPEN.
 16959
 16960     MOVE ER-2232 TO EMI-ERROR
 16961     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16962     MOVE -1                     TO MAINTL.
 16963     GO TO 8200-SEND-DATAONLY.
 16964
 16965 8090-MAIL-NOT-OPEN.
 16966
 16967     MOVE ER-2999                TO EMI-ERROR.
 16968     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16969     MOVE -1                     TO MAINTL.
 16970     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 361
* EL689.cbl
 16972 8100-SEND-INITIAL-MAP.
 16973
 16974     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 16975     IF  PI-689-CREATE-NO-SCREENS
 16976         MOVE '9999'             TO PI-689-ERROR
 16977         GO TO 0620-RETURN-TO-CALLER.
 16978
 16979     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 16980
 16981     IF  NOT EMI-NO-ERRORS
 16982         MOVE EMI-MESSAGE-AREA (1)
 16983                                 TO ERRMSGO
 16984     ELSE
 16985         MOVE SPACES             TO ERRMSGO.
 16986     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 16987                                 TO SYSO
 16988     MOVE WS-KIXHOST             TO HOSTO
 16989     IF PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR 'CAGB'
 16990        OR 'DLVA' OR 'ECCA' OR 'KRHA'
 16991        MOVE AL-SADOF            TO PF8HDA
 16992     END-IF
 16993     IF NOT PI-CREATE-LABELS
 16994         MOVE AL-PANON           TO ADDRLBLA.
 16995
 16996
 16997* EXEC CICS SEND
 16998*        MAP    (W-MAP)
 16999*        MAPSET (W-MAPSET)
 17000*        FROM   (EL689AO)
 17001*        ERASE
 17002*        CURSOR
 17003*    END-EXEC.
 17004     MOVE LENGTH OF
 17005      EL689AO
 17006       TO DFHEIV12
 17007     MOVE -1
 17008       TO DFHEIV11
 17009*    MOVE '8$     CT  E    H L F ,   #00015732' TO DFHEIV0
 17010     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 17011     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17012     MOVE X'2020233030303135373332' TO DFHEIV0(25:11)
 17013     CALL 'kxdfhei1' USING DFHEIV0,
 17014           W-MAP,
 17015           EL689AO,
 17016           DFHEIV12,
 17017           W-MAPSET,
 17018           DFHEIV99,
 17019           DFHEIV99,
 17020           DFHEIV99,
 17021           DFHEIV11,
 17022           DFHEIV99,
 17023           DFHEIV99,
 17024           DFHEIV99
 17025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17026
 17027
 17028     GO TO 9000-RETURN-TRANS.
 17029
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 362
* EL689.cbl
 17030 8100-EXIT.
 17031     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 363
* EL689.cbl
 17033 8200-SEND-DATAONLY.
 17034
 17035     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 17036     IF  PI-689-CREATE-NO-SCREENS
 17037         MOVE '9999'             TO PI-689-ERROR
 17038         GO TO 0620-RETURN-TO-CALLER.
 17039
 17040     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 17041
 17042     IF EMI-ERROR = ER-0715
 17043         DISPLAY 'ER 0715'
 17044         MOVE -1          TO CERTIDL
 17045         MOVE +0          TO MAINTL
 17046     END-IF
 17047
 17048     IF  NOT EMI-NO-ERRORS
 17049         MOVE EMI-MESSAGE-AREA (1)
 17050                                 TO ERRMSGO
 17051     ELSE
 17052         MOVE SPACES             TO ERRMSGO.
 17053
 17054
 17055* EXEC CICS SEND
 17056*        MAP    (W-MAP)
 17057*        MAPSET (W-MAPSET)
 17058*        FROM   (EL689AO)
 17059*        DATAONLY
 17060*        CURSOR
 17061*    END-EXEC.
 17062     MOVE LENGTH OF
 17063      EL689AO
 17064       TO DFHEIV12
 17065     MOVE -1
 17066       TO DFHEIV11
 17067*    MOVE '8$D    CT       H L F ,   #00015766' TO DFHEIV0
 17068     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 17069     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17070     MOVE X'2020233030303135373636' TO DFHEIV0(25:11)
 17071     CALL 'kxdfhei1' USING DFHEIV0,
 17072           W-MAP,
 17073           EL689AO,
 17074           DFHEIV12,
 17075           W-MAPSET,
 17076           DFHEIV99,
 17077           DFHEIV99,
 17078           DFHEIV99,
 17079           DFHEIV11,
 17080           DFHEIV99,
 17081           DFHEIV99,
 17082           DFHEIV99
 17083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17084
 17085
 17086     GO TO 9000-RETURN-TRANS.
 17087
 17088 8200-EXIT.
 17089     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 364
* EL689.cbl
 17091 8300-SEND-TEXT.
 17092
 17093     IF  PI-689-CREATE-NO-SCREENS
 17094         MOVE '9999'             TO PI-689-ERROR
 17095         GO TO 0620-RETURN-TO-CALLER.
 17096
 17097
 17098* EXEC CICS SEND TEXT
 17099*        FROM    (LOGOFF-TEXT)
 17100*        LENGTH  (LOGOFF-LENGTH)
 17101*        ERASE
 17102*        FREEKB
 17103*    END-EXEC.
 17104*    MOVE '8&      T  E F  H   F -   #00015785' TO DFHEIV0
 17105     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 17106     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 17107     MOVE X'2020233030303135373835' TO DFHEIV0(25:11)
 17108     CALL 'kxdfhei1' USING DFHEIV0,
 17109           LOGOFF-TEXT,
 17110           LOGOFF-LENGTH,
 17111           DFHEIV99,
 17112           DFHEIV99,
 17113           DFHEIV99,
 17114           DFHEIV99,
 17115           DFHEIV99,
 17116           DFHEIV99,
 17117           DFHEIV99,
 17118           DFHEIV99,
 17119           DFHEIV99,
 17120           DFHEIV99
 17121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17122
 17123
 17124     GO TO 9000-RETURN-TRANS.
 17125
 17126 8300-EXIT.
 17127     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 365
* EL689.cbl
 17129 8350-SEND-DATAONLY-ERASEAUP.
 17130
 17131     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 17132     PERFORM 7760-PUT-TEMP-STORAGE
 17133                                 THRU 7760-EXIT
 17134     IF  PI-689-CREATE-NO-SCREENS
 17135         MOVE '9999'             TO PI-689-ERROR
 17136         GO TO 0620-RETURN-TO-CALLER.
 17137
 17138     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 17139
 17140     IF EMI-ERROR = ER-0715
 17141         DISPLAY 'ER 0715'
 17142         MOVE -1          TO CERTIDL
 17143         MOVE +0          TO MAINTL
 17144     END-IF
 17145
 17146     IF  NOT EMI-NO-ERRORS
 17147         MOVE EMI-MESSAGE-AREA (1)
 17148                                 TO ERRMSGO
 17149     ELSE
 17150         MOVE SPACES             TO ERRMSGO.
 17151
 17152
 17153* EXEC CICS SEND
 17154*        MAP      (W-MAP)
 17155*        MAPSET   (W-MAPSET)
 17156*        FROM     (EL689AO)
 17157*        DATAONLY
 17158*        ERASEAUP
 17159*        CURSOR
 17160*    END-EXEC.
 17161     MOVE LENGTH OF
 17162      EL689AO
 17163       TO DFHEIV12
 17164     MOVE -1
 17165       TO DFHEIV11
 17166*    MOVE '8$D    CT  A    H L F ,   #00015820' TO DFHEIV0
 17167     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 17168     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17169     MOVE X'2020233030303135383230' TO DFHEIV0(25:11)
 17170     CALL 'kxdfhei1' USING DFHEIV0,
 17171           W-MAP,
 17172           EL689AO,
 17173           DFHEIV12,
 17174           W-MAPSET,
 17175           DFHEIV99,
 17176           DFHEIV99,
 17177           DFHEIV99,
 17178           DFHEIV11,
 17179           DFHEIV99,
 17180           DFHEIV99,
 17181           DFHEIV99
 17182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17183
 17184
 17185     GO TO 9000-RETURN-TRANS.
 17186
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 366
* EL689.cbl
 17187 8350-EXIT.
 17188     EXIT.
 17189
 17190 8600-DEEDIT.
 17191
 17192
 17193* EXEC CICS BIF DEEDIT
 17194*         FIELD    (W-DEEDIT-FIELD)
 17195*         LENGTH   (15)
 17196*    END-EXEC.
 17197     MOVE 15
 17198       TO DFHEIV11
 17199*    MOVE '@"L                   #   #00015836' TO DFHEIV0
 17200     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17201     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17202     MOVE X'2020233030303135383336' TO DFHEIV0(25:11)
 17203     CALL 'kxdfhei1' USING DFHEIV0,
 17204           W-DEEDIT-FIELD,
 17205           DFHEIV11
 17206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17207
 17208
 17209 8600-EXIT.
 17210     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 367
* EL689.cbl
 17212 9000-RETURN-TRANS.
 17213
 17214     MOVE EMI-FATAL-CTR      TO PI-689-FATAL-CTR
 17215     MOVE EMI-FORCABLE-CTR   TO PI-689-FORCABLE-CTR
 17216     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 17217     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
 17218
 17219* EXEC CICS RETURN
 17220*        TRANSID    (W-TRANSACTION)
 17221*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 17222*        LENGTH     (PI-COMM-LENGTH)
 17223*    END-EXEC.
 17224*    MOVE '.(CT                  ''   #00015850' TO DFHEIV0
 17225     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 17226     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17227     MOVE X'2020233030303135383530' TO DFHEIV0(25:11)
 17228     CALL 'kxdfhei1' USING DFHEIV0,
 17229           W-TRANSACTION,
 17230           PROGRAM-INTERFACE-BLOCK,
 17231           PI-COMM-LENGTH,
 17232           DFHEIV99,
 17233           DFHEIV99,
 17234           DFHEIV99
 17235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17236
 17237*    MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 17238*    MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 17239*    GO TO 0200-RECEIVE.
 17240
 17241 9000-EXIT.
 17242     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 368
* EL689.cbl
 17244 9200-PA.
 17245
 17246     MOVE ER-0008                TO EMI-ERROR.
 17247     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17248     MOVE -1                     TO MAINTL.
 17249     GO TO 8200-SEND-DATAONLY.
 17250
 17251 9200-EXIT.
 17252     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 369
* EL689.cbl
 17254 9300-DFHCLEAR.
 17255
 17256     IF PI-RETURN-TO-PROGRAM = 'EL689' OR 'EL690'
 17257         MOVE '2'                TO PI-ACTION.
 17258
 17259     IF  PI-CLEAR-MODE
 17260         MOVE PI-RETURN-TO-PROGRAM
 17261                                 TO W-CALL-PGM
 17262         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 17263         GO TO 9400-XCTL
 17264     ELSE
 17265         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 17266         MOVE LOW-VALUES         TO EL689AO
 17267                                    PI-1042-WA
 17268                                    PI-689-WORK-AREA
 17269         MOVE ZEROS              TO PI-CURRENT-LINE
 17270                                    PI-TEMP-STOR-ITEMS
 17271                                    PI-TOTAL-LINES
 17272                                    PI-UPDATE-SW
 17273                                    PI-689-NUMBER-LABEL-LINES
 17274         MOVE SPACES             TO PI-689-PRINT-SW
 17275                                    PI-689-ALT-PRINTER-ID
 17276                                    PI-COMM-CONTROL
 17277                                    PI-689-FORM-NUMBER
 17278                                    PI-689-TEMP-STOR-ID
 17279                                    PI-689-LABEL-SOURCE
 17280                                    PI-689-USE-SCREEN-IND
 17281         MOVE '2'                TO PI-ACTION
 17282         MOVE -1                 TO MAINTL
 17283         GO TO 8100-SEND-INITIAL-MAP.
 17284
 17285 9300-EXIT.
 17286     EXIT.
 17287
 17288 9400-XCTL.
 17289
 17290
 17291* EXEC CICS XCTL
 17292*        PROGRAM  (W-CALL-PGM)
 17293*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 17294*        LENGTH   (PI-COMM-LENGTH)
 17295*    END-EXEC.
 17296*    MOVE '.$C                   %   #00015908' TO DFHEIV0
 17297     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 17298     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17299     MOVE X'2020233030303135393038' TO DFHEIV0(25:11)
 17300     CALL 'kxdfhei1' USING DFHEIV0,
 17301           W-CALL-PGM,
 17302           PROGRAM-INTERFACE-BLOCK,
 17303           PI-COMM-LENGTH,
 17304           DFHEIV99
 17305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17306
 17307
 17308 9400-EXIT.
 17309     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 370
* EL689.cbl
 17311 9500-LINK-DATE-CONVERT.
 17312
 17313     IF  DC-BIN-DATE-1 EQUAL HIGH-VALUES
 17314             AND
 17315         DC-OPTION-CODE EQUAL ' '
 17316         MOVE '99/99/99'         TO DC-GREG-DATE-1-EDIT
 17317         GO TO 9500-EXIT.
 17318
 17319
 17320* EXEC CICS LINK
 17321*        PROGRAM    ('ELDATCV')
 17322*        COMMAREA   (DATE-CONVERSION-DATA)
 17323*        LENGTH     (DC-COMM-LENGTH)
 17324*    END-EXEC.
 17325     MOVE 'ELDATCV' TO DFHEIV1
 17326*    MOVE '."C                   (   #00015925' TO DFHEIV0
 17327     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17328     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17329     MOVE X'2020233030303135393235' TO DFHEIV0(25:11)
 17330     CALL 'kxdfhei1' USING DFHEIV0,
 17331           DFHEIV1,
 17332           DATE-CONVERSION-DATA,
 17333           DC-COMM-LENGTH,
 17334           DFHEIV99,
 17335           DFHEIV99,
 17336           DFHEIV99,
 17337           DFHEIV99
 17338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17339
 17340
 17341     IF  NO-CONVERSION-ERROR
 17342             AND
 17343         PI-COMPANY-ID EQUAL 'AUK'
 17344             AND
 17345         W-REVERSE-DATE
 17346         MOVE DC-GREG-DATE-1-EDIT
 17347                                 TO W-EDIT-DATE-1
 17348         MOVE W-ED1-MM           TO W-ED2-MM
 17349         MOVE W-ED1-DD           TO W-ED2-DD
 17350         MOVE W-ED1-YY           TO W-ED2-YY
 17351         MOVE W-EDIT-DATE-2      TO DC-GREG-DATE-1-EDIT.
 17352
 17353 9500-EXIT.
 17354     EXIT.
 17355
 17356 9600-FORMAT-DATE-TIME.
 17357
 17358     MOVE W-SAVE-DATE            TO RUNDTEO.
 17359     MOVE EIBTIME                TO W-TIME-IN.
 17360     MOVE W-TIME-OUT             TO RUNTIMEO.
 17361     MOVE PI-COMPANY-ID          TO COMPANYO.
 17362     MOVE PI-PROCESSOR-ID        TO USERIDO.
 17363     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 17364
 17365 9600-EXIT.
 17366     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 371
* EL689.cbl
 17368 9700-PGMID-ERROR.
 17369
 17370     IF  PI-689-CREATE-NO-SCREENS
 17371         MOVE '9999'             TO PI-689-ERROR
 17372         GO TO 0620-RETURN-TO-CALLER.
 17373
 17374
 17375* EXEC CICS  HANDLE CONDITION
 17376*        PGMIDERR  (8300-SEND-TEXT)
 17377*    END-EXEC.
 17378*    MOVE '"$L                   ! > #00015964' TO DFHEIV0
 17379     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 17380     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17381     MOVE X'3E20233030303135393634' TO DFHEIV0(25:11)
 17382     CALL 'kxdfhei1' USING DFHEIV0
 17383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17384
 17385
 17386     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
 17387     MOVE ' '                    TO PI-ENTRY-CD-1.
 17388     MOVE W-XCTL-005             TO W-CALL-PGM
 17389                                    LOGOFF-PGM.
 17390     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 17391
 17392     PERFORM 9400-XCTL THRU 9400-EXIT.
 17393
 17394 9700-EXIT.
 17395     EXIT.
 17396
 17397 9800-ABEND.
 17398
 17399     IF  PI-689-CREATE-NO-SCREENS
 17400         MOVE '9999'             TO PI-689-ERROR
 17401         GO TO 0620-RETURN-TO-CALLER.
 17402
 17403     MOVE W-LINK-004             TO W-CALL-PGM.
 17404     MOVE DFHEIBLK               TO EMI-LINE1
 17405
 17406
 17407* EXEC CICS  LINK
 17408*        PROGRAM   (W-CALL-PGM)
 17409*        COMMAREA  (EMI-LINE1)
 17410*        LENGTH    (72)
 17411*    END-EXEC.
 17412     MOVE 72
 17413       TO DFHEIV11
 17414*    MOVE '."C                   (   #00015988' TO DFHEIV0
 17415     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17416     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17417     MOVE X'2020233030303135393838' TO DFHEIV0(25:11)
 17418     CALL 'kxdfhei1' USING DFHEIV0,
 17419           W-CALL-PGM,
 17420           EMI-LINE1,
 17421           DFHEIV11,
 17422           DFHEIV99,
 17423           DFHEIV99,
 17424           DFHEIV99,
 17425           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 372
* EL689.cbl
 17426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17427
 17428
 17429     GO TO 8200-SEND-DATAONLY.
 17430
 17431 9800-EXIT.
 17432     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 373
* EL689.cbl
 17434 9900-ERROR-FORMAT.
 17435
 17436     IF  PI-689-CREATE-NO-SCREENS
 17437         MOVE EMI-ERROR          TO PI-689-ERROR
 17438         IF  PI-689-FATAL-ERROR
 17439             GO TO 0620-RETURN-TO-CALLER
 17440         ELSE
 17441             GO TO 9900-EXIT.
 17442
 17443     IF  EMI-ERROR EQUAL ER-9097
 17444         NEXT SENTENCE
 17445     ELSE
 17446         IF  EMI-ERRORS-COMPLETE
 17447                 OR
 17448             EMI-ERROR EQUAL W-LAST-ERROR
 17449             GO TO 9900-EXIT.
 17450
 17451     MOVE W-LINK-001             TO W-CALL-PGM.
 17452
 17453
 17454* EXEC CICS LINK
 17455*        PROGRAM    (W-CALL-PGM)
 17456*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17457*        LENGTH     (EMI-COMM-LENGTH)
 17458*    END-EXEC.
 17459*    MOVE '."C                   (   #00016018' TO DFHEIV0
 17460     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17461     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17462     MOVE X'2020233030303136303138' TO DFHEIV0(25:11)
 17463     CALL 'kxdfhei1' USING DFHEIV0,
 17464           W-CALL-PGM,
 17465           ERROR-MESSAGE-INTERFACE-BLOCK,
 17466           EMI-COMM-LENGTH,
 17467           DFHEIV99,
 17468           DFHEIV99,
 17469           DFHEIV99,
 17470           DFHEIV99
 17471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17472
 17473
 17474     IF  EMI-SEVERITY (2) EQUAL 'X'
 17475             AND
 17476         EMI-SEVERITY (1) NOT EQUAL 'X'
 17477         MOVE EMI-MESSAGE-AREA (2)
 17478                                 TO EMI-MESSAGE-AREA (1).
 17479
 17480     MOVE EMI-ERROR              TO W-LAST-ERROR.
 17481
 17482 9900-EXIT.
 17483     EXIT.
 17484
 17485 9905-INITIALIZE-SECURITY.
 17486******************************************************************
 17487*                                                                *
 17488*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
 17489*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
 17490*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
 17491*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 374
* EL689.cbl
 17492*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
 17493*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
 17494*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
 17495*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
 17496*                                                                *
 17497*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
 17498*       IS ALSO PROVIDED BY THIS LOGIC.                          *
 17499*                                                                *
 17500******************************************************************
 17501
 17502     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
 17503         MOVE 'Y'                TO PI-DISPLAY-CAP
 17504                                    PI-MODIFY-CAP
 17505     ELSE
 17506
 17507* EXEC CICS READQ TS
 17508*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
 17509*            INTO   (SECURITY-CONTROL)
 17510*            LENGTH (SC-COMM-LENGTH)
 17511*            ITEM   (1)
 17512*        END-EXEC
 17513     MOVE 1
 17514       TO DFHEIV11
 17515*    MOVE '*$II   L              ''   #00016056' TO DFHEIV0
 17516     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 17517     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17518     MOVE X'2020233030303136303536' TO DFHEIV0(25:11)
 17519     CALL 'kxdfhei1' USING DFHEIV0,
 17520           PI-SECURITY-TEMP-STORE-ID,
 17521           SECURITY-CONTROL,
 17522           SC-COMM-LENGTH,
 17523           DFHEIV11,
 17524           DFHEIV99,
 17525           DFHEIV99
 17526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17527         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
 17528                                 TO PI-DISPLAY-CAP
 17529         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
 17530                                 TO PI-MODIFY-CAP.
 17531
 17532 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 375
* EL689.cbl
 17534 9995-SECURITY-VIOLATION.
 17535
 17536     MOVE EIBDATE                TO SM-JUL-DATE.
 17537     MOVE EIBTRMID               TO SM-TERMID.
 17538     MOVE W-THIS-PGM             TO SM-PGM.
 17539     MOVE EIBTIME                TO W-TIME-IN.
 17540     MOVE W-TIME-OUT             TO SM-TIME.
 17541     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
 17542
 17543
 17544* EXEC CICS LINK
 17545*         PROGRAM  ('EL003')
 17546*         COMMAREA (SECURITY-MESSAGE)
 17547*         LENGTH   (80)
 17548*    END-EXEC.
 17549     MOVE 'EL003' TO DFHEIV1
 17550     MOVE 80
 17551       TO DFHEIV11
 17552*    MOVE '."C                   (   #00016078' TO DFHEIV0
 17553     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17554     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17555     MOVE X'2020233030303136303738' TO DFHEIV0(25:11)
 17556     CALL 'kxdfhei1' USING DFHEIV0,
 17557           DFHEIV1,
 17558           SECURITY-MESSAGE,
 17559           DFHEIV11,
 17560           DFHEIV99,
 17561           DFHEIV99,
 17562           DFHEIV99,
 17563           DFHEIV99
 17564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17565
 17566
 17567 9995-EXIT.
 17568     EXIT.
 17569
 17570 9999-GOBACK.
 17571
 17572
 17573* GOBACK.
 17574     MOVE '9%                    "   ' TO DFHEIV0
 17575     MOVE 'EL689' TO DFHEIV1
 17576     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17577     GOBACK.
 17578
 17579 9999-EXIT.
 17580     EXIT.
 17581
 17582 9999-DFHBACK SECTION.
 17583     MOVE '9%                    "   ' TO DFHEIV0
 17584     MOVE 'EL689' TO DFHEIV1
 17585     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17586     GOBACK.
 17587 9999-DFHEXIT.
 17588     IF DFHEIGDJ EQUAL 0001
 17589         NEXT SENTENCE
 17590     ELSE IF DFHEIGDJ EQUAL 2
 17591         GO TO 9300-DFHCLEAR,
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 376
* EL689.cbl
 17592               9200-PA,
 17593               9200-PA,
 17594               9200-PA
 17595         DEPENDING ON DFHEIGDI
 17596     ELSE IF DFHEIGDJ EQUAL 3
 17597         GO TO 9700-PGMID-ERROR,
 17598               9800-ABEND,
 17599               0325-MAPFAIL
 17600         DEPENDING ON DFHEIGDI
 17601     ELSE IF DFHEIGDJ EQUAL 4
 17602         GO TO 8040-CNTL-NOT-OPEN,
 17603               7945-NOT-FOUND
 17604         DEPENDING ON DFHEIGDI
 17605     ELSE IF DFHEIGDJ EQUAL 5
 17606         GO TO 9700-PGMID-ERROR,
 17607               0325-MAPFAIL,
 17608               9800-ABEND
 17609         DEPENDING ON DFHEIGDI
 17610     ELSE IF DFHEIGDJ EQUAL 6
 17611         GO TO 0990-CARRIER-NOT-FOUND,
 17612               8040-CNTL-NOT-OPEN
 17613         DEPENDING ON DFHEIGDI
 17614     ELSE IF DFHEIGDJ EQUAL 7
 17615         GO TO 0994-STATE-NOT-FOUND,
 17616               8040-CNTL-NOT-OPEN
 17617         DEPENDING ON DFHEIGDI
 17618     ELSE IF DFHEIGDJ EQUAL 8
 17619         GO TO 8010-ARCH-NOT-OPEN,
 17620               1070-ARCH-NOT-FOUND,
 17621               1070-ARCH-NOT-FOUND
 17622         DEPENDING ON DFHEIGDI
 17623     ELSE IF DFHEIGDJ EQUAL 9
 17624         GO TO 2001-NOT-FOUND,
 17625               2001-NOT-FOUND,
 17626               8050-TEXT-NOT-OPEN
 17627         DEPENDING ON DFHEIGDI
 17628     ELSE IF DFHEIGDJ EQUAL 10
 17629         GO TO 2000-ENDBR
 17630         DEPENDING ON DFHEIGDI
 17631     ELSE IF DFHEIGDJ EQUAL 11
 17632         GO TO 8040-CNTL-NOT-OPEN,
 17633               6200-CNTL1-NOT-FOUND
 17634         DEPENDING ON DFHEIGDI
 17635     ELSE IF DFHEIGDJ EQUAL 12
 17636         GO TO 8040-CNTL-NOT-OPEN,
 17637               6250-CNTL2-NOT-FOUND
 17638         DEPENDING ON DFHEIGDI
 17639     ELSE IF DFHEIGDJ EQUAL 13
 17640         GO TO 8040-CNTL-NOT-OPEN,
 17641               6300-CNTL6-NOT-FOUND
 17642         DEPENDING ON DFHEIGDI
 17643     ELSE IF DFHEIGDJ EQUAL 14
 17644         GO TO 8040-CNTL-NOT-OPEN,
 17645               6350-CNTL2-NOT-FOUND
 17646         DEPENDING ON DFHEIGDI
 17647     ELSE IF DFHEIGDJ EQUAL 15
 17648         GO TO 8060-PNDB-NOT-OPEN,
 17649               8070-PNDB-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 377
* EL689.cbl
 17650         DEPENDING ON DFHEIGDI
 17651     ELSE IF DFHEIGDJ EQUAL 16
 17652         GO TO 8030-CERT-NOT-OPEN,
 17653               8035-CERT-NOT-FOUND
 17654         DEPENDING ON DFHEIGDI
 17655     ELSE IF DFHEIGDJ EQUAL 17
 17656         GO TO 8020-ACCT-NOT-OPEN,
 17657               6500-ACCT-NOT-FOUND,
 17658               6500-ONLY-STOP
 17659         DEPENDING ON DFHEIGDI
 17660     ELSE IF DFHEIGDJ EQUAL 18
 17661         GO TO 8080-COMP-NOT-OPEN,
 17662               6600-COMP-NOT-FOUND
 17663         DEPENDING ON DFHEIGDI
 17664     ELSE IF DFHEIGDJ EQUAL 19
 17665         GO TO 8040-CNTL-NOT-OPEN,
 17666               6630-CNTL2-NOT-FOUND
 17667         DEPENDING ON DFHEIGDI
 17668     ELSE IF DFHEIGDJ EQUAL 20
 17669         GO TO 8090-MAIL-NOT-OPEN,
 17670               6700-MAIL-NOT-FOUND
 17671         DEPENDING ON DFHEIGDI
 17672     ELSE IF DFHEIGDJ EQUAL 21
 17673         GO TO 8040-CNTL-NOT-OPEN,
 17674               6750-EXIT
 17675         DEPENDING ON DFHEIGDI
 17676     ELSE IF DFHEIGDJ EQUAL 22
 17677         GO TO 8040-CNTL-NOT-OPEN,
 17678               6800-EXIT
 17679         DEPENDING ON DFHEIGDI
 17680     ELSE IF DFHEIGDJ EQUAL 23
 17681         GO TO 8045-CHEK-NOT-OPEN,
 17682               6850-CHEK-NOT-FOUND
 17683         DEPENDING ON DFHEIGDI
 17684     ELSE IF DFHEIGDJ EQUAL 24
 17685         GO TO 8085-PYAJ-NOT-OPEN,
 17686               6900-PYAJ-NOT-FOUND
 17687         DEPENDING ON DFHEIGDI
 17688     ELSE IF DFHEIGDJ EQUAL 25
 17689         GO TO 7700-TS-ERROR,
 17690               7700-TS-ERROR
 17691         DEPENDING ON DFHEIGDI
 17692     ELSE IF DFHEIGDJ EQUAL 26
 17693         GO TO 7780-EXIT
 17694         DEPENDING ON DFHEIGDI
 17695     ELSE IF DFHEIGDJ EQUAL 27
 17696         GO TO 8040-CNTL-NOT-OPEN,
 17697               7945-NOT-FOUND
 17698         DEPENDING ON DFHEIGDI
 17699     ELSE IF DFHEIGDJ EQUAL 28
 17700         GO TO 7935-TERM-ERROR,
 17701               7940-TRAN-ERROR
 17702         DEPENDING ON DFHEIGDI
 17703     ELSE IF DFHEIGDJ EQUAL 29
 17704         GO TO 8010-ARCH-NOT-OPEN,
 17705               1070-ARCH-NOT-FOUND,
 17706               1070-ARCH-NOT-FOUND
 17707         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 12-Feb-14 13:28 Page 378
* EL689.cbl
 17708     ELSE IF DFHEIGDJ EQUAL 30
 17709         GO TO 8300-SEND-TEXT
 17710         DEPENDING ON DFHEIGDI.
 17711     MOVE '9%                    "   ' TO DFHEIV0
 17712     MOVE 'EL689' TO DFHEIV1
 17713     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17714     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      232188     Code:       60355
